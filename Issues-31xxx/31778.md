# Issue 31778: Interface to Mathics

archive/issues_031541.json:
```json
{
    "assignees": [],
    "body": "*Mathics* is an open source interpreter for the *Wolfram Language*. From the introduction of its reference manual:\n\n    Mathics \u2014 to be pronounced like \u201cMathematics\u201d without the\n    \u201cemat\u201d \u2014 is a general-purpose computer algebra system (CAS).\n    It is meant to be a free, light-weight alternative to\nMathematica\u00ae. It is free both as in \u201cfree beer\u201d and as in\n\u201cfreedom\u201d. There are various online mirrors running\n    Mathics but it is also possible to run Mathics locally.\n    A list of mirrors can be found at the Mathics homepage,\n    http://mathics.github.io.\n\n    The programming language of Mathics is meant to resemble\n    Wolfram\u2019s famous Mathematica\u00ae as much as possible. However,\n    Mathics is in no way affiliated or supported by Wolfram.\n    Mathics will probably never have the power to compete with\n    Mathematica\u00ae in industrial applications; yet, it might be\n    an interesting alternative for educational purposes.\n\nThe aim of this ticket is to implement an interface to Mathics.\nSuch an interface has the advantage that functions written in\nWolfram Language can be used in Sage on systems that miss a\nMathematica\u00ae licence.\n\nMoreover, there are many classical software packages written in\nWolfram Language that eventually could be used inside Sage\nin order to participate from their functionality. Currently,\nfor example, Mathics developers are working to get\n[KnotTheory](http://katlas.math.toronto.edu/wiki/Setup)\nand [FeynCalc](https://feyncalc.github.io/) running.\n\n\nTo install Mathics inside Sage just run:\n\n```bash\n./configure --enable-download-from-upstream-url\nmake mathics\n```\n\n\nThanks to the developers of Mathics to support this interface!\n\nDepends on #29009\nDepends on #31676\nDepends on #31775\n\nKeywords: **Mathics Mathematica Wolfram Language interface**\n\nBranch/Commit: **[5e68c59](https://github.com/sagemath/sagetrac-mirror/commit/5e68c59a618f29aa1d98a515360acbae7ebdb629)**\n\nReviewer: **Dima Pasechnik**\n\nAuthor: **Sebastian Oehms**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31778_\n\n",
    "closed_at": "2021-09-13T22:22:28Z",
    "created_at": "2021-05-05T09:27:02Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20interfaces%3A%20optional",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Interface to Mathics",
    "type": "issue",
    "updated_at": "2021-09-13T22:22:28Z",
    "url": "https://github.com/sagemath/sage/issues/31778",
    "user": "https://github.com/soehms"
}
```
*Mathics* is an open source interpreter for the *Wolfram Language*. From the introduction of its reference manual:

    Mathics — to be pronounced like “Mathematics” without the
    “emat” — is a general-purpose computer algebra system (CAS).
    It is meant to be a free, light-weight alternative to
Mathematica®. It is free both as in “free beer” and as in
“freedom”. There are various online mirrors running
    Mathics but it is also possible to run Mathics locally.
    A list of mirrors can be found at the Mathics homepage,
    http://mathics.github.io.

    The programming language of Mathics is meant to resemble
    Wolfram’s famous Mathematica® as much as possible. However,
    Mathics is in no way affiliated or supported by Wolfram.
    Mathics will probably never have the power to compete with
    Mathematica® in industrial applications; yet, it might be
    an interesting alternative for educational purposes.

The aim of this ticket is to implement an interface to Mathics.
Such an interface has the advantage that functions written in
Wolfram Language can be used in Sage on systems that miss a
Mathematica® licence.

Moreover, there are many classical software packages written in
Wolfram Language that eventually could be used inside Sage
in order to participate from their functionality. Currently,
for example, Mathics developers are working to get
[KnotTheory](http://katlas.math.toronto.edu/wiki/Setup)
and [FeynCalc](https://feyncalc.github.io/) running.


To install Mathics inside Sage just run:

```bash
./configure --enable-download-from-upstream-url
make mathics
```


Thanks to the developers of Mathics to support this interface!

Depends on #29009
Depends on #31676
Depends on #31775

Keywords: **Mathics Mathematica Wolfram Language interface**

Branch/Commit: **[5e68c59](https://github.com/sagemath/sagetrac-mirror/commit/5e68c59a618f29aa1d98a515360acbae7ebdb629)**

Reviewer: **Dima Pasechnik**

Author: **Sebastian Oehms**

_Issue created by migration from https://trac.sagemath.org/ticket/31778_





---

archive/issue_events_420036.json:
```json
{
    "actor": "https://github.com/soehms",
    "created_at": "2021-05-05T09:27:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31778#event-420036"
}
```



---

archive/issue_events_420037.json:
```json
{
    "actor": "https://github.com/soehms",
    "created_at": "2021-05-05T09:27:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20interfaces%3A%20optional",
    "label_color": "0000ff",
    "label_name": "component: interfaces: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31778#event-420037"
}
```



---

archive/issue_events_420038.json:
```json
{
    "actor": "https://github.com/soehms",
    "created_at": "2021-05-05T09:27:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31778#event-420038"
}
```



---

archive/issue_events_420039.json:
```json
{
    "actor": "https://github.com/soehms",
    "created_at": "2021-05-05T09:27:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31778#event-420039"
}
```



---

archive/issue_comments_514029.json:
```json
{
    "body": "Branch: **[u/soehms/mathics_interface](https://github.com/sagemath/sagetrac-mirror/tree/u/soehms/mathics_interface)**",
    "created_at": "2021-05-05T09:30:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514029",
    "user": "https://github.com/soehms"
}
```

Branch: **[u/soehms/mathics_interface](https://github.com/sagemath/sagetrac-mirror/tree/u/soehms/mathics_interface)**



---

archive/issue_comments_514030.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nThe initial version for the interface is an adaption of the corresponding interface for Mathematica. But in contrast it directly uses the Mathics library functionality instead of Pexpect. It contains all doctests inherited from the Mathematica module but also additional ones which are more Mathics specific. Furthermore, the coverage of doctests is complete.\n\nTwo of the Mathematica doctests use `FindMinimum` which doesn't seem to be available in Mathics. I mark them as `not tested`. 25 doctests had differences to the output that once has been produced by Mathematica. Most of them are caused by a different way of formatting. I've accepted them all, since they where either minor or a task for Mathics developers to decide if they are acceptable or not (see also [this comment ](https://github.com/mathics/Mathics/issues/1235#issuecomment-814899766) in [Mathics issue 1235](https://github.com/mathics/Mathics/issues/1235)). Explicitly these are:\n\n```\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 37, in sage.interfaces.mathics\nFailed example:\n    mobj = mathics(x^2-1); mobj       # optional - mathics\nExpected:\n    x^2 - 1\nGot:\n    -1 + x ^ 2\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 39, in sage.interfaces.mathics\nFailed example:\n    mobj.Factor()                     # optional - mathics\nExpected:\n    (x + 1)*(x - 1)\nGot:\n    (-1 + x) (1 + x)\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 51, in sage.interfaces.mathics\nFailed example:\n    mobj2 = mobj.Factor(); mobj2          # optional - mathics\nExpected:\n    (-1 + x)*(1 + x)\nGot:\n    (-1 + x) (1 + x)\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 66, in sage.interfaces.mathics\nFailed example:\n    mathics('Factor[x^2-1]')          # optional - mathics\nExpected:\n    (-1 + x)*(1 + x)\nGot:\n    (-1 + x) (1 + x)\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 78, in sage.interfaces.mathics\nFailed example:\n    mathics.eval('x^2 - 1')           # optional - mathics\nExpected:\n                   2\n             -1 + x\nGot:\n    '-1 + x ^ 2'\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 137, in sage.interfaces.mathics\nFailed example:\n    eqn                               # optional - mathics\nExpected:\n    5 + 3*x == 14\nGot:\n    5 + 3 x == 14\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 142, in sage.interfaces.mathics\nFailed example:\n    print(sys)                        # optional - mathics\nExpected:\n               2\n             {x  - 3 y == 3, 2 x - y == 1}\nGot:\n    {x ^ 2 - 3 y == 3, 2 x - y == 1}\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 167, in sage.interfaces.mathics\nFailed example:\n    v = m([eq1, eq2]); v              # optional - mathics\nExpected:\n    {x^2 - 3*y == 3, 2*x - y == 1}\nGot:\n    {x ^ 2 - 3 y == 3, 2 x - y == 1}\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 193, in sage.interfaces.mathics\nFailed example:\n    eqn.FindRoot(['x', 2])            # optional - mathics\nExpected:\n    {x -> 1.512134551657842}\nGot:\n    {x -> 1.51213}\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 223, in sage.interfaces.mathics\nFailed example:\n    print(g)                           # optional - mathics\nExpected:\n                               2       100       101    200\n             100 + 315 x - 85 x  + 25 x    + 12 x    + x\nGot:\n    100 + 315 x - 85 x ^ 2 + 25 x ^ 100 + 12 x ^ 101 + x ^ 200\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 226, in sage.interfaces.mathics\nFailed example:\n    g                                  # optional - mathics\nExpected:\n    100 + 315*x - 85*x^2 + 25*x^100 + 12*x^101 + x^200\nGot:\n    100 + 315 x - 85 x ^ 2 + 25 x ^ 100 + 12 x ^ 101 + x ^ 200\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 228, in sage.interfaces.mathics\nFailed example:\n    print(g.Factor())                  # optional - mathics\nExpected:\n                          100               100\n             (20 - 5 x + x   ) (5 + 17 x + x   )\nGot:\n    (5 + 17 x + x ^ 100) (20 - 5 x + x ^ 100)\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 235, in sage.interfaces.mathics\nFailed example:\n    print(f.Factor())                  # optional - mathics\nExpected:\n              3                  2    3\n             x  (x - y) (-2 x + x  + y )\nGot:\n    x ^ 3 (x - y) (-2 x + x ^ 2 + y ^ 3)\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 275, in sage.interfaces.mathics\nFailed example:\n    print(x)                  # optional - mathics\nExpected:\n             Pi\n             --\n             2\nGot:\n    Pi / 2\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 327, in sage.interfaces.mathics\nFailed example:\n    math_bessel_K(2,I)                      # optional - mathics\nExpected:\n    -2.59288617549119697817 + 0.18048997206696202663*I\nGot:\n    -2.5928861754911969782 + 0.18048997206696202663 I\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 341, in sage.interfaces.mathics\nFailed example:\n    slist3 = mlist.sage(); slist3         # optional - mathics\nExpected:\n    [[1, 2], 3.00000000000000, I + 4]\nGot:\n    [[1, 2], 3.00000000000000, 4.00000000000000 + 1.00000000000000*I]\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 360, in sage.interfaces.mathics\nFailed example:\n    mathics('Pi/2').N(10)           # optional -- mathics\nExpected:\n    1.5707963268\nGot:\n    1.570796327\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 362, in sage.interfaces.mathics\nFailed example:\n    mathics('Pi').N(10)             # optional -- mathics\nExpected:\n    3.1415926536\nGot:\n    3.141592654\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 364, in sage.interfaces.mathics\nFailed example:\n    mathics('Pi').N(50)             # optional -- mathics\nExpected:\n    3.14159265358979323846264338327950288419716939937511\nGot:\n    3.1415926535897932384626433832795028841971693993751\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 366, in sage.interfaces.mathics\nFailed example:\n    str(mathics('Pi*x^2-1/2').N())  # optional -- mathics\nExpected:\n                    2\n    -0.5 + 3.14159 x\nGot:\n    '-0.5 + 3.14159 x ^ 2.'\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 670, in sage.interfaces.mathics.Mathics.chdir\nFailed example:\n    mathics('Directory[]')      # optional - mathics\nExpected:\n    \"/\"\nGot:\n    /\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 1015, in sage.interfaces.mathics.MathicsElement._sage_\nFailed example:\n    s = m.sage(); s       # optional - mathics\nExpected:\n    [[1.00000000000000, 4], pi, 3.20000000000000*e100, I]\nGot:\n    [[1.00000000000000, 4], pi, 3.20000000000000*e100, 1.00000000000000*I]\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 1019, in sage.interfaces.mathics.MathicsElement._sage_\nFailed example:\n    s[3]^2                # optional - mathics\nExpected:\n    -1\nGot:\n    -1.00000000000000\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 1155, in sage.interfaces.mathics.MathicsElement._rich_repr_\nFailed example:\n    P._rich_repr_(dm)                              # optional - mathics\nExpected:\n    OutputImagePng container\nGot:\n    OutputImageSvg container\n**********************************************************************\nFile \"src/sage/interfaces/mathics.py\", line 1195, in sage.interfaces.mathics.MathicsElement.show\nFailed example:\n    show(Q)                                    # optional - mathics\nExpected:\n    <html><script type=\"math/tex\">\\frac{\\sin (x \\cos (y))}{\\sqrt{1-x^2}}</script></html>\nGot:\n    Sin[x Cos[y]] / Sqrt[1 - x ^ 2]\n**********************************************************************\n```\n\n\nObserve that the graphical support of Mathics is restricted to `SVG`. For the usage in Sage it would be preferable to have `PNG` possible, as well, or to convert it here to `PNG` (for example using `svg2rlg` introducing a new dependency to `svglib`).\n\n\n\n\nSage package integration is initialized using:\n\n```\nsage -package create Mathics3 --pypi --type optional\n```\n\nI rename the created package `Mathics3` to `mathics` to match Sage package naming conventions.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ea877d9ee384bfa2794af3c20a070e7e42bb3f7f\">ea877d9</a></td><td><code>29009: initial version</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e7d6c32d5a7d76ef7e337978a9db971d7fd1e89a\">e7d6c32</a></td><td><code>29009: add comment to doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d06d3d70181a38e97323353dbff40a1f09a97ea4\">d06d3d7</a></td><td><code>Merge branch 'u/soehms/mpmath_divmod_29009' of trac.sagemath.org:sage into mathics_interface</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e8203807cfee4f0951820b1f6bfc82a0561d33e\">3e82038</a></td><td><code>31676: initial version</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/507eb6212a52143acfaa43e8628ec8537744d278\">507eb62</a></td><td><code>Merge branch 'u/soehms/mpmath_hash' of trac.sagemath.org:sage into mathics_interface</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e621dead0fd109bde132c655995e9c1f9e61bdba\">e621dea</a></td><td><code>31775: initial version</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/84b8c14e15a7df43351307fd5ae9697b10a3180a\">84b8c14</a></td><td><code>Merge branch 'u/soehms/complex_interfaces_31775' of trac.sagemath.org:sage into mathics_interface</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/85a3a0e5c3a0adf5bc03d9c417db3f5de68ac5d7\">85a3a0e</a></td><td><code>31778: initial version</code></td></tr></table>\n",
    "created_at": "2021-05-05T09:41:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514030",
    "user": "https://github.com/soehms"
}
```

<div id="comment:2" align="right">Comment 2</div>

The initial version for the interface is an adaption of the corresponding interface for Mathematica. But in contrast it directly uses the Mathics library functionality instead of Pexpect. It contains all doctests inherited from the Mathematica module but also additional ones which are more Mathics specific. Furthermore, the coverage of doctests is complete.

Two of the Mathematica doctests use `FindMinimum` which doesn't seem to be available in Mathics. I mark them as `not tested`. 25 doctests had differences to the output that once has been produced by Mathematica. Most of them are caused by a different way of formatting. I've accepted them all, since they where either minor or a task for Mathics developers to decide if they are acceptable or not (see also [this comment ](https://github.com/mathics/Mathics/issues/1235#issuecomment-814899766) in [Mathics issue 1235](https://github.com/mathics/Mathics/issues/1235)). Explicitly these are:

```
**********************************************************************
File "src/sage/interfaces/mathics.py", line 37, in sage.interfaces.mathics
Failed example:
    mobj = mathics(x^2-1); mobj       # optional - mathics
Expected:
    x^2 - 1
Got:
    -1 + x ^ 2
**********************************************************************
File "src/sage/interfaces/mathics.py", line 39, in sage.interfaces.mathics
Failed example:
    mobj.Factor()                     # optional - mathics
Expected:
    (x + 1)*(x - 1)
Got:
    (-1 + x) (1 + x)
**********************************************************************
File "src/sage/interfaces/mathics.py", line 51, in sage.interfaces.mathics
Failed example:
    mobj2 = mobj.Factor(); mobj2          # optional - mathics
Expected:
    (-1 + x)*(1 + x)
Got:
    (-1 + x) (1 + x)
**********************************************************************
File "src/sage/interfaces/mathics.py", line 66, in sage.interfaces.mathics
Failed example:
    mathics('Factor[x^2-1]')          # optional - mathics
Expected:
    (-1 + x)*(1 + x)
Got:
    (-1 + x) (1 + x)
**********************************************************************
File "src/sage/interfaces/mathics.py", line 78, in sage.interfaces.mathics
Failed example:
    mathics.eval('x^2 - 1')           # optional - mathics
Expected:
                   2
             -1 + x
Got:
    '-1 + x ^ 2'
**********************************************************************
File "src/sage/interfaces/mathics.py", line 137, in sage.interfaces.mathics
Failed example:
    eqn                               # optional - mathics
Expected:
    5 + 3*x == 14
Got:
    5 + 3 x == 14
**********************************************************************
File "src/sage/interfaces/mathics.py", line 142, in sage.interfaces.mathics
Failed example:
    print(sys)                        # optional - mathics
Expected:
               2
             {x  - 3 y == 3, 2 x - y == 1}
Got:
    {x ^ 2 - 3 y == 3, 2 x - y == 1}
**********************************************************************
File "src/sage/interfaces/mathics.py", line 167, in sage.interfaces.mathics
Failed example:
    v = m([eq1, eq2]); v              # optional - mathics
Expected:
    {x^2 - 3*y == 3, 2*x - y == 1}
Got:
    {x ^ 2 - 3 y == 3, 2 x - y == 1}
**********************************************************************
File "src/sage/interfaces/mathics.py", line 193, in sage.interfaces.mathics
Failed example:
    eqn.FindRoot(['x', 2])            # optional - mathics
Expected:
    {x -> 1.512134551657842}
Got:
    {x -> 1.51213}
**********************************************************************
File "src/sage/interfaces/mathics.py", line 223, in sage.interfaces.mathics
Failed example:
    print(g)                           # optional - mathics
Expected:
                               2       100       101    200
             100 + 315 x - 85 x  + 25 x    + 12 x    + x
Got:
    100 + 315 x - 85 x ^ 2 + 25 x ^ 100 + 12 x ^ 101 + x ^ 200
**********************************************************************
File "src/sage/interfaces/mathics.py", line 226, in sage.interfaces.mathics
Failed example:
    g                                  # optional - mathics
Expected:
    100 + 315*x - 85*x^2 + 25*x^100 + 12*x^101 + x^200
Got:
    100 + 315 x - 85 x ^ 2 + 25 x ^ 100 + 12 x ^ 101 + x ^ 200
**********************************************************************
File "src/sage/interfaces/mathics.py", line 228, in sage.interfaces.mathics
Failed example:
    print(g.Factor())                  # optional - mathics
Expected:
                          100               100
             (20 - 5 x + x   ) (5 + 17 x + x   )
Got:
    (5 + 17 x + x ^ 100) (20 - 5 x + x ^ 100)
**********************************************************************
File "src/sage/interfaces/mathics.py", line 235, in sage.interfaces.mathics
Failed example:
    print(f.Factor())                  # optional - mathics
Expected:
              3                  2    3
             x  (x - y) (-2 x + x  + y )
Got:
    x ^ 3 (x - y) (-2 x + x ^ 2 + y ^ 3)
**********************************************************************
File "src/sage/interfaces/mathics.py", line 275, in sage.interfaces.mathics
Failed example:
    print(x)                  # optional - mathics
Expected:
             Pi
             --
             2
Got:
    Pi / 2
**********************************************************************
File "src/sage/interfaces/mathics.py", line 327, in sage.interfaces.mathics
Failed example:
    math_bessel_K(2,I)                      # optional - mathics
Expected:
    -2.59288617549119697817 + 0.18048997206696202663*I
Got:
    -2.5928861754911969782 + 0.18048997206696202663 I
**********************************************************************
File "src/sage/interfaces/mathics.py", line 341, in sage.interfaces.mathics
Failed example:
    slist3 = mlist.sage(); slist3         # optional - mathics
Expected:
    [[1, 2], 3.00000000000000, I + 4]
Got:
    [[1, 2], 3.00000000000000, 4.00000000000000 + 1.00000000000000*I]
**********************************************************************
File "src/sage/interfaces/mathics.py", line 360, in sage.interfaces.mathics
Failed example:
    mathics('Pi/2').N(10)           # optional -- mathics
Expected:
    1.5707963268
Got:
    1.570796327
**********************************************************************
File "src/sage/interfaces/mathics.py", line 362, in sage.interfaces.mathics
Failed example:
    mathics('Pi').N(10)             # optional -- mathics
Expected:
    3.1415926536
Got:
    3.141592654
**********************************************************************
File "src/sage/interfaces/mathics.py", line 364, in sage.interfaces.mathics
Failed example:
    mathics('Pi').N(50)             # optional -- mathics
Expected:
    3.14159265358979323846264338327950288419716939937511
Got:
    3.1415926535897932384626433832795028841971693993751
**********************************************************************
File "src/sage/interfaces/mathics.py", line 366, in sage.interfaces.mathics
Failed example:
    str(mathics('Pi*x^2-1/2').N())  # optional -- mathics
Expected:
                    2
    -0.5 + 3.14159 x
Got:
    '-0.5 + 3.14159 x ^ 2.'
**********************************************************************
File "src/sage/interfaces/mathics.py", line 670, in sage.interfaces.mathics.Mathics.chdir
Failed example:
    mathics('Directory[]')      # optional - mathics
Expected:
    "/"
Got:
    /
**********************************************************************
File "src/sage/interfaces/mathics.py", line 1015, in sage.interfaces.mathics.MathicsElement._sage_
Failed example:
    s = m.sage(); s       # optional - mathics
Expected:
    [[1.00000000000000, 4], pi, 3.20000000000000*e100, I]
Got:
    [[1.00000000000000, 4], pi, 3.20000000000000*e100, 1.00000000000000*I]
**********************************************************************
File "src/sage/interfaces/mathics.py", line 1019, in sage.interfaces.mathics.MathicsElement._sage_
Failed example:
    s[3]^2                # optional - mathics
Expected:
    -1
Got:
    -1.00000000000000
**********************************************************************
File "src/sage/interfaces/mathics.py", line 1155, in sage.interfaces.mathics.MathicsElement._rich_repr_
Failed example:
    P._rich_repr_(dm)                              # optional - mathics
Expected:
    OutputImagePng container
Got:
    OutputImageSvg container
**********************************************************************
File "src/sage/interfaces/mathics.py", line 1195, in sage.interfaces.mathics.MathicsElement.show
Failed example:
    show(Q)                                    # optional - mathics
Expected:
    <html><script type="math/tex">\frac{\sin (x \cos (y))}{\sqrt{1-x^2}}</script></html>
Got:
    Sin[x Cos[y]] / Sqrt[1 - x ^ 2]
**********************************************************************
```


Observe that the graphical support of Mathics is restricted to `SVG`. For the usage in Sage it would be preferable to have `PNG` possible, as well, or to convert it here to `PNG` (for example using `svg2rlg` introducing a new dependency to `svglib`).




Sage package integration is initialized using:

```
sage -package create Mathics3 --pypi --type optional
```

I rename the created package `Mathics3` to `mathics` to match Sage package naming conventions.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ea877d9ee384bfa2794af3c20a070e7e42bb3f7f">ea877d9</a></td><td><code>29009: initial version</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e7d6c32d5a7d76ef7e337978a9db971d7fd1e89a">e7d6c32</a></td><td><code>29009: add comment to doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d06d3d70181a38e97323353dbff40a1f09a97ea4">d06d3d7</a></td><td><code>Merge branch 'u/soehms/mpmath_divmod_29009' of trac.sagemath.org:sage into mathics_interface</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e8203807cfee4f0951820b1f6bfc82a0561d33e">3e82038</a></td><td><code>31676: initial version</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/507eb6212a52143acfaa43e8628ec8537744d278">507eb62</a></td><td><code>Merge branch 'u/soehms/mpmath_hash' of trac.sagemath.org:sage into mathics_interface</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e621dead0fd109bde132c655995e9c1f9e61bdba">e621dea</a></td><td><code>31775: initial version</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/84b8c14e15a7df43351307fd5ae9697b10a3180a">84b8c14</a></td><td><code>Merge branch 'u/soehms/complex_interfaces_31775' of trac.sagemath.org:sage into mathics_interface</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/85a3a0e5c3a0adf5bc03d9c417db3f5de68ac5d7">85a3a0e</a></td><td><code>31778: initial version</code></td></tr></table>




---

archive/issue_comments_514031.json:
```json
{
    "body": "Dependencies: **#29009 #31676 #31775**",
    "created_at": "2021-05-05T09:41:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514031",
    "user": "https://github.com/soehms"
}
```

Dependencies: **#29009 #31676 #31775**



---

archive/issue_comments_514032.json:
```json
{
    "body": "Commit: **[85a3a0e](https://github.com/sagemath/sagetrac-mirror/commit/85a3a0e5c3a0adf5bc03d9c417db3f5de68ac5d7)**",
    "created_at": "2021-05-05T09:41:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514032",
    "user": "https://github.com/soehms"
}
```

Commit: **[85a3a0e](https://github.com/sagemath/sagetrac-mirror/commit/85a3a0e5c3a0adf5bc03d9c417db3f5de68ac5d7)**



---

archive/issue_comments_514033.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nThanks for undertaking this, Sebastian Oehms!\n\nKnow that I'll help out whereever and however I can.",
    "created_at": "2021-05-05T09:57:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514033",
    "user": "https://github.com/rocky"
}
```

<div id="comment:3" align="right">Comment 3</div>

Thanks for undertaking this, Sebastian Oehms!

Know that I'll help out whereever and however I can.



---

archive/issue_comments_514034.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nThe problem with the order of terms and factors is that usually the evaluation of algebraic expressions is delegated to sympy, so we cannot from Mathics warrant a specific order. A way to make tests compatible with both backends (WMA and Mathics) could be to write tests that check that a difference between two equivalent expressions is zero. \n\nRegarding format, it is possible to use an init file/ set of commands to overwrite the standard behavior of MakeBoxes over `Times` or `Power`. \n\nAbout images, notice that to produce png`s, you can load one of the optional backend modules:\npymathics-matplotlib or pymathics-asymptote. To load the modules, you need to install one of the following libraries:\n\nhttps://github.com/mathics3/pymathics-matplotlib \nhttps://github.com/mathics3/pymathics-asymptote\n\nand then run inside Mathics either `LoadModule[\"pymathics-matplotlib\"]` or\n`LoadModule[\"pymathics-asymptote\"]`. \nBoth are work in progress, but produces pngs for basic plots and graphics.",
    "created_at": "2021-05-05T10:33:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514034",
    "user": "https://github.com/mmatera"
}
```

<div id="comment:4" align="right">Comment 4</div>

The problem with the order of terms and factors is that usually the evaluation of algebraic expressions is delegated to sympy, so we cannot from Mathics warrant a specific order. A way to make tests compatible with both backends (WMA and Mathics) could be to write tests that check that a difference between two equivalent expressions is zero. 

Regarding format, it is possible to use an init file/ set of commands to overwrite the standard behavior of MakeBoxes over `Times` or `Power`. 

About images, notice that to produce png`s, you can load one of the optional backend modules:
pymathics-matplotlib or pymathics-asymptote. To load the modules, you need to install one of the following libraries:

https://github.com/mathics3/pymathics-matplotlib 
https://github.com/mathics3/pymathics-asymptote

and then run inside Mathics either `LoadModule["pymathics-matplotlib"]` or
`LoadModule["pymathics-asymptote"]`. 
Both are work in progress, but produces pngs for basic plots and graphics.



---

archive/issue_comments_514035.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nReplying to [@mmatera](#comment%3A4):\n> \n> The problem with the order of terms and factors is that usually the evaluation of algebraic expressions is delegated to sympy, so we cannot from Mathics warrant a specific order. \n\nThis is related to something I noticed a while ago and have been meaning to fix. I thought I recorded it as an issue and I think I had a local branch for it, but I can't find the issue or branch. The closest I can find is https://github.com/mathics/Mathics/issues/1098 from Jan 3, 2021 and I have just renamed the title to make it more in line with what I have in mind.\n\nWe *should* be canonicalize output along the lines of standard formatting conventions and practice: if I have an expression in a variable, in `StandardOutput` format the higher powers of the variable come first in order and any constant comes last. It gets a little more complicated when there are combinations of variables. \n\nInterestingly, on parsing we *do* canonicalize the input seen, *and it is in the opposite order*!  But this is the way WL does it too.\n\n\nHowever WL seems to canonicalize its `StandardOutput` too so you don't notice the reversal between what is *parsed* in input (as opposed to written by the user) and what is formatted on output. \n\nWere this done, we would have both more natural looking, predicatble, and more WL-compatible output.",
    "created_at": "2021-05-05T11:13:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514035",
    "user": "https://github.com/rocky"
}
```

<div id="comment:5" align="right">Comment 5</div>

Replying to [@mmatera](#comment%3A4):
> 
> The problem with the order of terms and factors is that usually the evaluation of algebraic expressions is delegated to sympy, so we cannot from Mathics warrant a specific order. 

This is related to something I noticed a while ago and have been meaning to fix. I thought I recorded it as an issue and I think I had a local branch for it, but I can't find the issue or branch. The closest I can find is https://github.com/mathics/Mathics/issues/1098 from Jan 3, 2021 and I have just renamed the title to make it more in line with what I have in mind.

We *should* be canonicalize output along the lines of standard formatting conventions and practice: if I have an expression in a variable, in `StandardOutput` format the higher powers of the variable come first in order and any constant comes last. It gets a little more complicated when there are combinations of variables. 

Interestingly, on parsing we *do* canonicalize the input seen, *and it is in the opposite order*!  But this is the way WL does it too.


However WL seems to canonicalize its `StandardOutput` too so you don't notice the reversal between what is *parsed* in input (as opposed to written by the user) and what is formatted on output. 

Were this done, we would have both more natural looking, predicatble, and more WL-compatible output.



---

archive/issue_comments_514036.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nTo be more clear about the differences to the Mathematica results in the doctests: These are not a real problem for this interface. I just listed them for documentation reason before I erased them. So, please don't spend too much time with this.\n\nConcerning the `PNG` format: I will check this out using your optional backend modules. But, is there something standing against just converting `SVG` to `PNG`?",
    "created_at": "2021-05-05T13:32:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514036",
    "user": "https://github.com/soehms"
}
```

<div id="comment:6" align="right">Comment 6</div>

To be more clear about the differences to the Mathematica results in the doctests: These are not a real problem for this interface. I just listed them for documentation reason before I erased them. So, please don't spend too much time with this.

Concerning the `PNG` format: I will check this out using your optional backend modules. But, is there something standing against just converting `SVG` to `PNG`?



---

archive/issue_comments_514037.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -44,4 +44,4 @@\n ```\n \n \n-\n+Thanks to the developers of Mathics to support this interface!\n``````\n",
    "created_at": "2021-05-05T13:32:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514037",
    "user": "https://github.com/soehms"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -44,4 +44,4 @@
 ```
 
 
-
+Thanks to the developers of Mathics to support this interface!
``````




---

archive/issue_comments_514038.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nWith respect to: \n\n> But note that the current stable release contains an incompatibility to *mpmath* running on a Sage backend \n\nIf it will help simplify things, (and personally I think it will), we can put out another release shortly. I generally would like to do so roughly every month that there are significant changes and I think in the last month there have been. \n\nIt is better to have many smaller releases as opposed to larger releases over a longer periods of time, especially as we are in a period of great flux and we are making great strides towards reducing the overall flakiness.",
    "created_at": "2021-05-05T14:17:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514038",
    "user": "https://github.com/rocky"
}
```

<div id="comment:7" align="right">Comment 7</div>

With respect to: 

> But note that the current stable release contains an incompatibility to *mpmath* running on a Sage backend 

If it will help simplify things, (and personally I think it will), we can put out another release shortly. I generally would like to do so roughly every month that there are significant changes and I think in the last month there have been. 

It is better to have many smaller releases as opposed to larger releases over a longer periods of time, especially as we are in a period of great flux and we are making great strides towards reducing the overall flakiness.



---

archive/issue_comments_514039.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nReplying to [@soehms](#comment%3A6):\n> To be more clear about the differences to the Mathematica results in the doctests: These are not a real problem for this interface. I just listed them for documentation reason before I erased them. So, please don't spend too much time with this.\n> \n> Concerning the `PNG` format: I will check this out using your optional backend modules. But, is there something standing against just converting `SVG` to `PNG`?\n\nNatively, mathics is able to produce asymptote and SVG graphics, with the first having much better support than the second. Then, to get a png we need to compile the asymptote code to produce the image. But to do that, we need to install a lot of dependencies. The other way around is to use matplotlib, but this requires a new implementation. This is why we have this in external packages.",
    "created_at": "2021-05-05T16:34:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514039",
    "user": "https://github.com/mmatera"
}
```

<div id="comment:8" align="right">Comment 8</div>

Replying to [@soehms](#comment%3A6):
> To be more clear about the differences to the Mathematica results in the doctests: These are not a real problem for this interface. I just listed them for documentation reason before I erased them. So, please don't spend too much time with this.
> 
> Concerning the `PNG` format: I will check this out using your optional backend modules. But, is there something standing against just converting `SVG` to `PNG`?

Natively, mathics is able to produce asymptote and SVG graphics, with the first having much better support than the second. Then, to get a png we need to compile the asymptote code to produce the image. But to do that, we need to install a lot of dependencies. The other way around is to use matplotlib, but this requires a new implementation. This is why we have this in external packages.



---

archive/issue_comments_514040.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nReplying to [@rocky](#comment%3A7):\n\n> If it will help simplify things, (and personally I think it will), we can put out another release shortly. I generally would like to do so roughly every month that there are significant changes and I think in the last month there have been. \n> \n\nThat would be great! Thanks!",
    "created_at": "2021-05-06T09:21:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514040",
    "user": "https://github.com/soehms"
}
```

<div id="comment:9" align="right">Comment 9</div>

Replying to [@rocky](#comment%3A7):

> If it will help simplify things, (and personally I think it will), we can put out another release shortly. I generally would like to do so roughly every month that there are significant changes and I think in the last month there have been. 
> 

That would be great! Thanks!



---

archive/issue_comments_514041.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nReplying to [@mmatera](#comment%3A8):\n\n> Natively, mathics is able to produce asymptote and SVG graphics, with the first having much better support than the second. Then, to get a png we need to compile the asymptote code to produce the image. But to do that, we need to install a lot of dependencies. The other way around is to use matplotlib, but this requires a new implementation. This is why we have this in external packages.\n> \n\nI see! But, I think we can postpone the `PNG` availability to a follow up ticket. This is not essential to start with the interface. At least, if you convert to Sage objects you can do plotting there.",
    "created_at": "2021-05-06T09:24:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514041",
    "user": "https://github.com/soehms"
}
```

<div id="comment:10" align="right">Comment 10</div>

Replying to [@mmatera](#comment%3A8):

> Natively, mathics is able to produce asymptote and SVG graphics, with the first having much better support than the second. Then, to get a png we need to compile the asymptote code to produce the image. But to do that, we need to install a lot of dependencies. The other way around is to use matplotlib, but this requires a new implementation. This is why we have this in external packages.
> 

I see! But, I think we can postpone the `PNG` availability to a follow up ticket. This is not essential to start with the interface. At least, if you convert to Sage objects you can do plotting there.



---

archive/issue_comments_514042.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nReplying to [@soehms](#comment%3A9):\n> Replying to [@rocky](#comment%3A7):\n> \n> > If it will help simplify things, (and personally I think it will), we can put out another release shortly. I generally would like to do so roughly every month that there are significant changes and I think in the last month there have been. \n> > \n\n> \n> That would be great! Thanks!\n\n\nOk tentatively then we can plan on a release the weekend of May 15-16, assuming that Mauricio is on board with this.",
    "created_at": "2021-05-06T16:40:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514042",
    "user": "https://github.com/rocky"
}
```

<div id="comment:11" align="right">Comment 11</div>

Replying to [@soehms](#comment%3A9):
> Replying to [@rocky](#comment%3A7):
> 
> > If it will help simplify things, (and personally I think it will), we can put out another release shortly. I generally would like to do so roughly every month that there are significant changes and I think in the last month there have been. 
> > 

> 
> That would be great! Thanks!


Ok tentatively then we can plan on a release the weekend of May 15-16, assuming that Mauricio is on board with this.



---

archive/issue_comments_514043.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nReplying to [@rocky](#comment%3A11):\n> Replying to [@soehms](#comment%3A9):\n> > Replying to [@rocky](#comment%3A7):\n> > \n> > > If it will help simplify things, (and personally I think it will), we can put out another release shortly. I generally would like to do so roughly every month that there are significant changes and I think in the last month there have been. \n> > > \n\n> > \n> > That would be great! Thanks!\n\n[Mathics3 2.2.0](https://pypi.org/project/Mathics3/) has been released. Hopefully it addresses the problems with the last release. The next release should aslo add `FindMinimum`.",
    "created_at": "2021-05-15T16:44:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514043",
    "user": "https://github.com/rocky"
}
```

<div id="comment:12" align="right">Comment 12</div>

Replying to [@rocky](#comment%3A11):
> Replying to [@soehms](#comment%3A9):
> > Replying to [@rocky](#comment%3A7):
> > 
> > > If it will help simplify things, (and personally I think it will), we can put out another release shortly. I generally would like to do so roughly every month that there are significant changes and I think in the last month there have been. 
> > > 

> > 
> > That would be great! Thanks!

[Mathics3 2.2.0](https://pypi.org/project/Mathics3/) has been released. Hopefully it addresses the problems with the last release. The next release should aslo add `FindMinimum`.



---

archive/issue_comments_514044.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nReplying to [@rocky](#comment%3A12):\n> [Mathics3 2.2.0](https://pypi.org/project/Mathics3/) has been released. Hopefully it addresses the problems with the last release. \n\nThanks! These problems are solved. But on sytsems where `lxml` is not present I'm getting a startup message `lxml.html is not available...`, now, which distrubes the first doctest:\n\n\n```sage\nFile \"src/sage/interfaces/mathics.py\", line 37, in sage.interfaces.mathics\nFailed example:\n    mobj = mathics(x^2-1); mobj       # optional - mathics\nExpected:\n    -1 + x ^ 2\nGot:\n    lxml.html is not available...\n    -1 + x ^ 2\n**********************************************************************\n1 item had failures:\n   1 of  87 in sage.interfaces.mathics\n    [222 tests, 1 failure, 9.45 s]\n```\n\n\nIs this something essential? If not: is there a way to supress this message in `MathicsSession`? Or, is there a missing dependency?",
    "created_at": "2021-05-17T06:17:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514044",
    "user": "https://github.com/soehms"
}
```

<div id="comment:13" align="right">Comment 13</div>

Replying to [@rocky](#comment%3A12):
> [Mathics3 2.2.0](https://pypi.org/project/Mathics3/) has been released. Hopefully it addresses the problems with the last release. 

Thanks! These problems are solved. But on sytsems where `lxml` is not present I'm getting a startup message `lxml.html is not available...`, now, which distrubes the first doctest:


```sage
File "src/sage/interfaces/mathics.py", line 37, in sage.interfaces.mathics
Failed example:
    mobj = mathics(x^2-1); mobj       # optional - mathics
Expected:
    -1 + x ^ 2
Got:
    lxml.html is not available...
    -1 + x ^ 2
**********************************************************************
1 item had failures:
   1 of  87 in sage.interfaces.mathics
    [222 tests, 1 failure, 9.45 s]
```


Is this something essential? If not: is there a way to supress this message in `MathicsSession`? Or, is there a missing dependency?



---

archive/issue_comments_514045.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nThis dependency was newly added to the last release when an HTML import feature was added. \n\nIt shouldn't be necessary. Perhaps down the line, loading various types of files will moved to packages outside of the Mathics core. \n\nWhen https://github.com/mathics/Mathics/pull/1379 lands, it should address this by making the `lxml` package optional. And next release we may have a `FindMinimum` as well.\n\nFor now though, I don't know what to suggest. Sigh.\n\nAlso, after this gets into sage, we should figure out how to incorporate sage testing into a broader set of tests we do. (We need this for other packages as well.)",
    "created_at": "2021-05-17T11:51:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514045",
    "user": "https://github.com/rocky"
}
```

<div id="comment:14" align="right">Comment 14</div>

This dependency was newly added to the last release when an HTML import feature was added. 

It shouldn't be necessary. Perhaps down the line, loading various types of files will moved to packages outside of the Mathics core. 

When https://github.com/mathics/Mathics/pull/1379 lands, it should address this by making the `lxml` package optional. And next release we may have a `FindMinimum` as well.

For now though, I don't know what to suggest. Sigh.

Also, after this gets into sage, we should figure out how to incorporate sage testing into a broader set of tests we do. (We need this for other packages as well.)



---

archive/issue_comments_514046.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nI just thought of some more possibilities. \n\n1. install `lxml` in sage. If sage already has something for parsing HTML, then maybe we can use that in the next release of Mathics.\n2. If `lxml` is not installed, provide your own `lxml` import stub with submodule `html` and a `parse` function in it.",
    "created_at": "2021-05-17T12:35:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514046",
    "user": "https://github.com/rocky"
}
```

<div id="comment:15" align="right">Comment 15</div>

I just thought of some more possibilities. 

1. install `lxml` in sage. If sage already has something for parsing HTML, then maybe we can use that in the next release of Mathics.
2. If `lxml` is not installed, provide your own `lxml` import stub with submodule `html` and a `parse` function in it.



---

archive/issue_comments_514047.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nReplying to [@rocky](#comment%3A15):\n> When https://github.com/mathics/Mathics/pull/1379 lands, it should address this by making the lxml package optional. And next release we may have a FindMinimum as well.\n\nThats fine!\n\n> install lxml in sage ...\n\nIf `lxml` is optional in Mathics then it doesn't make sense to do anything in Sage (especially outside this interface) just to avoid this message. If a Sage user wants to use the optional functionality of Mathics via the interface then he can install it manually by `sage -pip install lxml`.\n\n> If sage already has something for parsing HTML, then maybe we can use that in the next release of Mathics.\n\n\nAFAIK, html parsers that can be used per default in Sage are those of the following libraries:\n\n```sage\nsage: import html\nsage: import html5lib\n```",
    "created_at": "2021-05-17T16:47:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514047",
    "user": "https://github.com/soehms"
}
```

<div id="comment:16" align="right">Comment 16</div>

Replying to [@rocky](#comment%3A15):
> When https://github.com/mathics/Mathics/pull/1379 lands, it should address this by making the lxml package optional. And next release we may have a FindMinimum as well.

Thats fine!

> install lxml in sage ...

If `lxml` is optional in Mathics then it doesn't make sense to do anything in Sage (especially outside this interface) just to avoid this message. If a Sage user wants to use the optional functionality of Mathics via the interface then he can install it manually by `sage -pip install lxml`.

> If sage already has something for parsing HTML, then maybe we can use that in the next release of Mathics.


AFAIK, html parsers that can be used per default in Sage are those of the following libraries:

```sage
sage: import html
sage: import html5lib
```



---

archive/issue_comments_514048.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nOk. We'll go with one of those, probably `html`,  which comes built in to Python in the version ranges we support, and most likely works just fine.",
    "created_at": "2021-05-17T18:00:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514048",
    "user": "https://github.com/rocky"
}
```

<div id="comment:17" align="right">Comment 17</div>

Ok. We'll go with one of those, probably `html`,  which comes built in to Python in the version ranges we support, and most likely works just fine.



---

archive/issue_comments_514049.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5dca2f62f5cd450cc2609d64cb7f60b1d2ddab43\">5dca2f6</a></td><td><code>Merge branch 'u/soehms/mathics_interface' of trac.sagemath.org:sage into mathics_interface_31778</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1051c6f82b6eb6a8aefebef9e6358f45d95f167a\">1051c6f</a></td><td><code>31778: update Mathics3 to version 2.2.0</code></td></tr></table>\n",
    "created_at": "2021-05-18T06:53:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514049",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18" align="right">Comment 18</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5dca2f62f5cd450cc2609d64cb7f60b1d2ddab43">5dca2f6</a></td><td><code>Merge branch 'u/soehms/mathics_interface' of trac.sagemath.org:sage into mathics_interface_31778</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1051c6f82b6eb6a8aefebef9e6358f45d95f167a">1051c6f</a></td><td><code>31778: update Mathics3 to version 2.2.0</code></td></tr></table>




---

archive/issue_comments_514050.json:
```json
{
    "body": "Changed commit from **[85a3a0e](https://github.com/sagemath/sagetrac-mirror/commit/85a3a0e5c3a0adf5bc03d9c417db3f5de68ac5d7)** to **[1051c6f](https://github.com/sagemath/sagetrac-mirror/commit/1051c6f82b6eb6a8aefebef9e6358f45d95f167a)**",
    "created_at": "2021-05-18T06:53:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514050",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[85a3a0e](https://github.com/sagemath/sagetrac-mirror/commit/85a3a0e5c3a0adf5bc03d9c417db3f5de68ac5d7)** to **[1051c6f](https://github.com/sagemath/sagetrac-mirror/commit/1051c6f82b6eb6a8aefebef9e6358f45d95f167a)**



---

archive/issue_comments_514051.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -31,17 +31,10 @@\n \n To install Mathics inside Sage just run:\n \n-```\n-sage -pip install Mathics3\n-```\n-\n-But note that the current stable release contains an incompatibility to *mpmath* running on a Sage backend (see [this comment](https://github.com/mathics/Mathics/issues/1169#issuecomment-808583939) in [Mathics issue 1169](https://github.com/mathics/Mathics/issues/1169)).\n-\n-Thus, until the fix for this will be released you have to install it in the following way:\n-\n-```\n-sage -pip install git+git://github.com/mathics/Mathics.git#egg=Mathics3\n-```\n+{{{'!bash\n+./configure --enable-download-from-upstream-url\n+sage -i mathics\n+}}}\n \n \n Thanks to the developers of Mathics to support this interface!\n``````\n",
    "created_at": "2021-05-18T06:55:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514051",
    "user": "https://github.com/soehms"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -31,17 +31,10 @@
 
 To install Mathics inside Sage just run:
 
-```
-sage -pip install Mathics3
-```
-
-But note that the current stable release contains an incompatibility to *mpmath* running on a Sage backend (see [this comment](https://github.com/mathics/Mathics/issues/1169#issuecomment-808583939) in [Mathics issue 1169](https://github.com/mathics/Mathics/issues/1169)).
-
-Thus, until the fix for this will be released you have to install it in the following way:
-
-```
-sage -pip install git+git://github.com/mathics/Mathics.git#egg=Mathics3
-```
+{{{'!bash
+./configure --enable-download-from-upstream-url
+sage -i mathics
+}}}
 
 
 Thanks to the developers of Mathics to support this interface!
``````




---

archive/issue_comments_514052.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nWith the current commit there are three expected doctest failures (one concerning `lxml` and two with respect to `FindMiminum`)  which sould disappear with the next Mathics release.",
    "created_at": "2021-05-18T06:55:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514052",
    "user": "https://github.com/soehms"
}
```

<div id="comment:19" align="right">Comment 19</div>

With the current commit there are three expected doctest failures (one concerning `lxml` and two with respect to `FindMiminum`)  which sould disappear with the next Mathics release.



---

archive/issue_comments_514053.json:
```json
{
    "body": "Author: **Sebastian Oehms**",
    "created_at": "2021-05-18T06:55:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514053",
    "user": "https://github.com/soehms"
}
```

Author: **Sebastian Oehms**



---

archive/issue_comments_514054.json:
```json
{
    "body": "Changed commit from **[1051c6f](https://github.com/sagemath/sagetrac-mirror/commit/1051c6f82b6eb6a8aefebef9e6358f45d95f167a)** to **[cdd4328](https://github.com/sagemath/sagetrac-mirror/commit/cdd4328915640991c9d829659155da54271d3136)**",
    "created_at": "2021-07-15T06:39:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514054",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1051c6f](https://github.com/sagemath/sagetrac-mirror/commit/1051c6f82b6eb6a8aefebef9e6358f45d95f167a)** to **[cdd4328](https://github.com/sagemath/sagetrac-mirror/commit/cdd4328915640991c9d829659155da54271d3136)**



---

archive/issue_comments_514055.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/529a722b57260b74a195f285d6634d49a9999a7a\">529a722</a></td><td><code>Merge branch 'u/soehms/mathics_interface' of trac.sagemath.org:sage into mathics_interface_31778</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cdd4328915640991c9d829659155da54271d3136\">cdd4328</a></td><td><code>31778: upgrade to Mathics3 3.1.0</code></td></tr></table>\n",
    "created_at": "2021-07-15T06:39:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514055",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:20" align="right">Comment 20</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/529a722b57260b74a195f285d6634d49a9999a7a">529a722</a></td><td><code>Merge branch 'u/soehms/mathics_interface' of trac.sagemath.org:sage into mathics_interface_31778</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cdd4328915640991c9d829659155da54271d3136">cdd4328</a></td><td><code>31778: upgrade to Mathics3 3.1.0</code></td></tr></table>




---

archive/issue_comments_514056.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nThe upgrade to version 3.1.0 fixes the `lxml` issue, but not the one with `FindMiminum`.",
    "created_at": "2021-07-15T07:15:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514056",
    "user": "https://github.com/soehms"
}
```

<div id="comment:21" align="right">Comment 21</div>

The upgrade to version 3.1.0 fixes the `lxml` issue, but not the one with `FindMiminum`.



---

archive/issue_comments_514057.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -31,10 +31,10 @@\n \n To install Mathics inside Sage just run:\n \n-{{{'!bash\n+```bash\n ./configure --enable-download-from-upstream-url\n sage -i mathics\n-}}}\n+```\n \n \n Thanks to the developers of Mathics to support this interface!\n``````\n",
    "created_at": "2021-07-15T07:18:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514057",
    "user": "https://github.com/soehms"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -31,10 +31,10 @@
 
 To install Mathics inside Sage just run:
 
-{{{'!bash
+```bash
 ./configure --enable-download-from-upstream-url
 sage -i mathics
-}}}
+```
 
 
 Thanks to the developers of Mathics to support this interface!
``````




---

archive/issue_comments_514058.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a30242a2fb89676c454cf16d90340401bc0d52b8\">a30242a</a></td><td><code>31778: dependency to mathics_scanner added</code></td></tr></table>\n",
    "created_at": "2021-07-16T08:17:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514058",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23" align="right">Comment 23</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a30242a2fb89676c454cf16d90340401bc0d52b8">a30242a</a></td><td><code>31778: dependency to mathics_scanner added</code></td></tr></table>




---

archive/issue_comments_514059.json:
```json
{
    "body": "Changed commit from **[cdd4328](https://github.com/sagemath/sagetrac-mirror/commit/cdd4328915640991c9d829659155da54271d3136)** to **[a30242a](https://github.com/sagemath/sagetrac-mirror/commit/a30242a2fb89676c454cf16d90340401bc0d52b8)**",
    "created_at": "2021-07-16T08:17:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514059",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[cdd4328](https://github.com/sagemath/sagetrac-mirror/commit/cdd4328915640991c9d829659155da54271d3136)** to **[a30242a](https://github.com/sagemath/sagetrac-mirror/commit/a30242a2fb89676c454cf16d90340401bc0d52b8)**



---

archive/issue_events_420040.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31778#event-420040"
}
```



---

archive/issue_events_420041.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31778#event-420041"
}
```



---

archive/issue_comments_514060.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8cac39978e4762befc9511840d46195e6484c248\">8cac399</a></td><td><code>Merge branch 'u/soehms/mathics_interface' of trac.sagemath.org:sage into mathics_interface_31778</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1565c92099dbde2d1dc59ddff22006696aa51dfe\">1565c92</a></td><td><code>31778: update to Mathics3 4.0.0</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a95d91cac85809e3f0895a683422c7248ba0ab2c\">a95d91c</a></td><td><code>31778: ignore FindMinimum doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5e68c59a618f29aa1d98a515360acbae7ebdb629\">5e68c59</a></td><td><code>31778: add dependency importlib_metadata (because of Python 3.7)</code></td></tr></table>\n",
    "created_at": "2021-09-07T10:07:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514060",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25" align="right">Comment 25</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8cac39978e4762befc9511840d46195e6484c248">8cac399</a></td><td><code>Merge branch 'u/soehms/mathics_interface' of trac.sagemath.org:sage into mathics_interface_31778</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1565c92099dbde2d1dc59ddff22006696aa51dfe">1565c92</a></td><td><code>31778: update to Mathics3 4.0.0</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a95d91cac85809e3f0895a683422c7248ba0ab2c">a95d91c</a></td><td><code>31778: ignore FindMinimum doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5e68c59a618f29aa1d98a515360acbae7ebdb629">5e68c59</a></td><td><code>31778: add dependency importlib_metadata (because of Python 3.7)</code></td></tr></table>




---

archive/issue_comments_514061.json:
```json
{
    "body": "Changed commit from **[a30242a](https://github.com/sagemath/sagetrac-mirror/commit/a30242a2fb89676c454cf16d90340401bc0d52b8)** to **[5e68c59](https://github.com/sagemath/sagetrac-mirror/commit/5e68c59a618f29aa1d98a515360acbae7ebdb629)**",
    "created_at": "2021-09-07T10:07:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514061",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[a30242a](https://github.com/sagemath/sagetrac-mirror/commit/a30242a2fb89676c454cf16d90340401bc0d52b8)** to **[5e68c59](https://github.com/sagemath/sagetrac-mirror/commit/5e68c59a618f29aa1d98a515360acbae7ebdb629)**



---

archive/issue_events_420042.json:
```json
{
    "actor": "https://github.com/soehms",
    "created_at": "2021-09-07T10:14:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31778#event-420042"
}
```



---

archive/issue_comments_514062.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nThe commits above contain an update to the current release of Mathics3 introducing two new dependencies to `pint` and `palettable`. Still, the Mathematica function `FindMinimum` is not present in this version. But anyway, I think this is not necessary for a start with the interface. Thus, I marked the corresponding doctests to be ignored.\n\nI've started a [workflow](https://github.com/soehms/sage/actions/runs/1203951924) which is identical to `tox-optional.yml` except that the matrix for the optional packages is reduced to `mathics`.\n\nIt seems that there are no failures which are related to the new package except on debian buster one failing doctest on `mathics.py`. This was caused by the missing dependency to `importlib_metadata` which is needed for Sage on Python 3.7 and which is added in the current commit. Rerunning the [debian buster test](https://github.com/soehms/sage/actions/runs/1207317942) looks good now, as well.\n\nTherefore, I think the ticket is ready for review, right now!",
    "created_at": "2021-09-07T10:14:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514062",
    "user": "https://github.com/soehms"
}
```

<div id="comment:26" align="right">Comment 26</div>

The commits above contain an update to the current release of Mathics3 introducing two new dependencies to `pint` and `palettable`. Still, the Mathematica function `FindMinimum` is not present in this version. But anyway, I think this is not necessary for a start with the interface. Thus, I marked the corresponding doctests to be ignored.

I've started a [workflow](https://github.com/soehms/sage/actions/runs/1203951924) which is identical to `tox-optional.yml` except that the matrix for the optional packages is reduced to `mathics`.

It seems that there are no failures which are related to the new package except on debian buster one failing doctest on `mathics.py`. This was caused by the missing dependency to `importlib_metadata` which is needed for Sage on Python 3.7 and which is added in the current commit. Rerunning the [debian buster test](https://github.com/soehms/sage/actions/runs/1207317942) looks good now, as well.

Therefore, I think the ticket is ready for review, right now!



---

archive/issue_comments_514063.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -33,7 +33,7 @@\n \n ```bash\n ./configure --enable-download-from-upstream-url\n-sage -i mathics\n+make mathics\n ```\n \n \n``````\n",
    "created_at": "2021-09-07T12:26:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514063",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -33,7 +33,7 @@
 
 ```bash
 ./configure --enable-download-from-upstream-url
-sage -i mathics
+make mathics
 ```
 
 
``````




---

archive/issue_comments_514064.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nlooks good to me, thanks",
    "created_at": "2021-09-07T12:35:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514064",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:28" align="right">Comment 28</div>

looks good to me, thanks



---

archive/issue_comments_514065.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2021-09-07T12:35:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514065",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_events_420043.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-09-07T12:35:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31778#event-420043"
}
```



---

archive/issue_events_420044.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-09-07T12:35:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31778#event-420044"
}
```



---

archive/issue_comments_514066.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nReplying to [@dimpase](#comment%3A28):\n> looks good to me, thanks\n\nMany thanks, as well!",
    "created_at": "2021-09-07T14:26:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514066",
    "user": "https://github.com/soehms"
}
```

<div id="comment:29" align="right">Comment 29</div>

Replying to [@dimpase](#comment%3A28):
> looks good to me, thanks

Many thanks, as well!



---

archive/issue_comments_514067.json:
```json
{
    "body": "Changed branch from **[u/soehms/mathics_interface](https://github.com/sagemath/sagetrac-mirror/tree/u/soehms/mathics_interface)** to **[5e68c59](https://github.com/sagemath/sagetrac-mirror/commit/5e68c59a618f29aa1d98a515360acbae7ebdb629)**",
    "created_at": "2021-09-13T22:22:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31778#issuecomment-514067",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/soehms/mathics_interface](https://github.com/sagemath/sagetrac-mirror/tree/u/soehms/mathics_interface)** to **[5e68c59](https://github.com/sagemath/sagetrac-mirror/commit/5e68c59a618f29aa1d98a515360acbae7ebdb629)**



---

archive/issue_events_420045.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-09-13T22:22:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31778#event-420045"
}
```



---

archive/issue_events_420046.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "39800ba89f21d95aa6f00dd3c110ed9d5ece9ceb",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-09-13T22:22:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31778",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31778#event-420046"
}
```
