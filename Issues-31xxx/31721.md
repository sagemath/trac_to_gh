# Issue 31721: Endow parents with __pow__

archive/issues_031484.json:
```json
{
    "assignees": [],
    "body": "We equip `structure/parent.pyx` with a method `__pow__` which possibly delegates to the corresponding category. Moreover, we move the `__pow__` in `rings/ring.pyx` to the category file `categories/rings.py` so that any ring can benefit from it and not only those which inherit from `rings/ring.pyx`.\n\nCC:  @tscrim @mkoeppe @slel\n\nBranch/Commit: **[`b873bcb`](https://github.com/sagemath/sagetrac-mirror/commit/b873bcbe33571dc020c08b05c0390777148b1b53)**\n\nReviewer: **Travis Scrimshaw, Michael Jung, Vincent Delecroix**\n\nAuthor: **Michael Jung, Vincent Delecroix**\n\nComponent: **categories**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31721_\n\n",
    "closed_at": "2021-06-19T20:58:06Z",
    "created_at": "2021-04-23T17:31:13Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20categories",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Endow parents with __pow__",
    "type": "issue",
    "updated_at": "2021-06-19T20:58:06Z",
    "url": "https://github.com/sagemath/sage/issues/31721",
    "user": "https://github.com/mjungmath"
}
```
We equip `structure/parent.pyx` with a method `__pow__` which possibly delegates to the corresponding category. Moreover, we move the `__pow__` in `rings/ring.pyx` to the category file `categories/rings.py` so that any ring can benefit from it and not only those which inherit from `rings/ring.pyx`.

CC:  @tscrim @mkoeppe @slel

Branch/Commit: **[`b873bcb`](https://github.com/sagemath/sagetrac-mirror/commit/b873bcbe33571dc020c08b05c0390777148b1b53)**

Reviewer: **Travis Scrimshaw, Michael Jung, Vincent Delecroix**

Author: **Michael Jung, Vincent Delecroix**

Component: **categories**

_Issue created by migration from https://trac.sagemath.org/ticket/31721_





---

archive/issue_events_434348.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-04-23T17:31:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-434348"
}
```



---

archive/issue_events_434349.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-04-23T17:31:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20categories",
    "label_color": "0000ff",
    "label_name": "c: categories",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-434349"
}
```



---

archive/issue_events_434350.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-04-23T17:31:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-434350"
}
```



---

archive/issue_events_434351.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-04-23T17:31:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-434351"
}
```



---

archive/issue_comments_510196.json:
```json
{
    "body": "Branch: **[u/gh-mjungmath/power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/power_method_for_parents)**",
    "created_at": "2021-04-23T17:40:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510196",
    "user": "https://github.com/mjungmath"
}
```

Branch: **[u/gh-mjungmath/power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/power_method_for_parents)**



---

archive/issue_comments_510197.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/64599379f79086962d2349568c508887e0926d2a\"><code>6459937</code></a></td><td><code>#Trac 31721: `__pow__` for parents and move `__pow__` in rings</code></td></tr></table>\n",
    "created_at": "2021-04-23T17:40:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510197",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/64599379f79086962d2349568c508887e0926d2a"><code>6459937</code></a></td><td><code>#Trac 31721: `__pow__` for parents and move `__pow__` in rings</code></td></tr></table>




---

archive/issue_events_434352.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-04-23T17:40:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-434352"
}
```



---

archive/issue_comments_510198.json:
```json
{
    "body": "Commit: **[`6459937`](https://github.com/sagemath/sagetrac-mirror/commit/64599379f79086962d2349568c508887e0926d2a)**",
    "created_at": "2021-04-23T17:40:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510198",
    "user": "https://github.com/mjungmath"
}
```

Commit: **[`6459937`](https://github.com/sagemath/sagetrac-mirror/commit/64599379f79086962d2349568c508887e0926d2a)**



---

archive/issue_comments_510199.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nWaiting for patchbot, but unless patchbot does not object, this is ready for review.",
    "created_at": "2021-04-23T17:45:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510199",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:3" align="right">comment:3</div>

Waiting for patchbot, but unless patchbot does not object, this is ready for review.



---

archive/issue_comments_510200.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nIs it not possible to define `__pow__` directly in the category? Why do we need an indirection via `_pow_`? For elements, it is perfectly understandable since things might have to go through coercion when parents mismatch. But here, what is the point?",
    "created_at": "2021-04-23T18:40:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510200",
    "user": "https://github.com/videlec"
}
```

<div id="comment:4" align="right">comment:4</div>

Is it not possible to define `__pow__` directly in the category? Why do we need an indirection via `_pow_`? For elements, it is perfectly understandable since things might have to go through coercion when parents mismatch. But here, what is the point?



---

archive/issue_comments_510201.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@videlec](#comment%3A4):\n> Is it not possible to define `__pow__` directly in the category? Why do we need an indirection via `_pow_`? For elements, it is perfectly understandable since things might have to go through coercion when parents mismatch. But here, what is the point?\n\nI just mimicked the behavior of `__mul__` for parents. But perhaps you're right and this is not necessary here because no preprocessing is needed.\n\nTravis, do you know more?",
    "created_at": "2021-04-23T19:02:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510201",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@videlec](#comment%3A4):
> Is it not possible to define `__pow__` directly in the category? Why do we need an indirection via `_pow_`? For elements, it is perfectly understandable since things might have to go through coercion when parents mismatch. But here, what is the point?

I just mimicked the behavior of `__mul__` for parents. But perhaps you're right and this is not necessary here because no preprocessing is needed.

Travis, do you know more?



---

archive/issue_comments_510202.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nOkay, it turns out that this indeed doesn't work. I have renamed `_pow_` to `__pow__` in `rings.py` and removed the changes in `parent.pyx` and now get the following error:\n\n```\nsage: ZZ**2                                                                     \n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-5-98b583f923b1> in <module>\n----> 1 ZZ**Integer(2)\n\n~/Projekte/sage-devel/local/lib/python3.8/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__pow__ (build/cythonized/sage/rings/integer.c:15218)()\n   2206             return coercion_model.bin_op(left, right, operator.pow)\n   2207         # left is a non-Element: do the powering with a Python int\n-> 2208         return left ** int(right)\n   2209 \n   2210     cpdef _pow_(self, other):\n\nTypeError: unsupported operand type(s) for ** or pow(): 'sage.rings.integer_ring.IntegerRing_class' and 'int'\n```\n\nwhile this works\n\n```\nsage: ZZ.__pow__(2)                                                             \nAmbient free module of rank 2 over the principal ideal domain Integer Ring\n```\n\nApparently the coercion framework tries to play man in the middle.",
    "created_at": "2021-04-23T19:28:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510202",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:6" align="right">comment:6</div>

Okay, it turns out that this indeed doesn't work. I have renamed `_pow_` to `__pow__` in `rings.py` and removed the changes in `parent.pyx` and now get the following error:

```
sage: ZZ**2                                                                     
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-5-98b583f923b1> in <module>
----> 1 ZZ**Integer(2)

~/Projekte/sage-devel/local/lib/python3.8/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__pow__ (build/cythonized/sage/rings/integer.c:15218)()
   2206             return coercion_model.bin_op(left, right, operator.pow)
   2207         # left is a non-Element: do the powering with a Python int
-> 2208         return left ** int(right)
   2209 
   2210     cpdef _pow_(self, other):

TypeError: unsupported operand type(s) for ** or pow(): 'sage.rings.integer_ring.IntegerRing_class' and 'int'
```

while this works

```
sage: ZZ.__pow__(2)                                                             
Ambient free module of rank 2 over the principal ideal domain Integer Ring
```

Apparently the coercion framework tries to play man in the middle.



---

archive/issue_comments_510203.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/04d282d6a2c2b1b0325119df446e3439d9a9fad4\"><code>04d282d</code></a></td><td><code>Trac #31721: improve error message + fix doctests</code></td></tr></table>\n",
    "created_at": "2021-04-23T21:51:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510203",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/04d282d6a2c2b1b0325119df446e3439d9a9fad4"><code>04d282d</code></a></td><td><code>Trac #31721: improve error message + fix doctests</code></td></tr></table>




---

archive/issue_comments_510204.json:
```json
{
    "body": "Changed commit from **[`6459937`](https://github.com/sagemath/sagetrac-mirror/commit/64599379f79086962d2349568c508887e0926d2a)** to **[`04d282d`](https://github.com/sagemath/sagetrac-mirror/commit/04d282d6a2c2b1b0325119df446e3439d9a9fad4)**",
    "created_at": "2021-04-23T21:51:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510204",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6459937`](https://github.com/sagemath/sagetrac-mirror/commit/64599379f79086962d2349568c508887e0926d2a)** to **[`04d282d`](https://github.com/sagemath/sagetrac-mirror/commit/04d282d6a2c2b1b0325119df446e3439d9a9fad4)**



---

archive/issue_comments_510205.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThe coercion framework works on `Element`s and finds common `Parent`s. Outright, it doesn't get involved. Instead, this is something Python does with trying by swapping the order of the two inputs.\n\nI strongly dislike the `__pow__` implemented in the parent. It will override anything that can be done in a category. Category stuff is called lower in the MRO than an any concrete class. So it restricts any future parent implementation for no reason.\n\nThat being said, `Parent`s should *not* be implementing a `_pow_` because there is no reason to standardize input to the same object. It doesn't make sense.\n\nI don't think the `_pow_int` in the `Fields` category is ever called. So it is good to remove it.\n\nSame comment as in the other ticket about nailing categories into memory should be avoided and the changes to `free_module.py`.",
    "created_at": "2021-04-24T05:52:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510205",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:8" align="right">comment:8</div>

The coercion framework works on `Element`s and finds common `Parent`s. Outright, it doesn't get involved. Instead, this is something Python does with trying by swapping the order of the two inputs.

I strongly dislike the `__pow__` implemented in the parent. It will override anything that can be done in a category. Category stuff is called lower in the MRO than an any concrete class. So it restricts any future parent implementation for no reason.

That being said, `Parent`s should *not* be implementing a `_pow_` because there is no reason to standardize input to the same object. It doesn't make sense.

I don't think the `_pow_int` in the `Fields` category is ever called. So it is good to remove it.

Same comment as in the other ticket about nailing categories into memory should be avoided and the changes to `free_module.py`.



---

archive/issue_comments_510206.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nBut then I am clueless. If `__pow__` for `parent.pyx` is not desirable and `__pow__` for `rings.py` causes the above error, how do we proceed?",
    "created_at": "2021-04-24T07:05:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510206",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:9" align="right">comment:9</div>

But then I am clueless. If `__pow__` for `parent.pyx` is not desirable and `__pow__` for `rings.py` causes the above error, how do we proceed?



---

archive/issue_comments_510207.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nThere is basically one very technical issue preventing this from working. Compare `ZZ` with `QQ`. For `QQ` to work, you need to first specify that the `mod` parameter is `None`. Then it works. What is different for `ZZ`? It is a parent that is an extension class (i.e., is a `cdef` class). You can see a big difference between the two when you look at the MRO's.\n\nNow, how does an extension class emulate being in a category, it uses `__getattr__`. However, methods like `__pow__` are special in Python and don't necessarily follow the usual rules. This also applies to infix binary operators like `**`. Here, I believe what is happening is it first sees explicitly (without a call to `__getattr__`) that `ZZ` does not have a `__pow__` method, so it then calls `Integer.__pow__(ZZ, n)`, leading to the error.\n\nYou seemed surprised that `ZZ.__pow__(2)` still works, but that involves a call to the `__getattr__`. Things are functioning normally there.\n\nHere is perhaps the interesting thing. What you implemented actually works and might be the best solution because it gets around this issue by letting Python know that every `Parent` has a `__pow__` method and to call that (first). So we have to emulate the `Parent.__mul__` implementation (which is a slightly different issue dealing with inheritance, but likely suffers from the same complications). I also strongly dislike the workaround there too. So I cannot object to this.",
    "created_at": "2021-04-24T08:22:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510207",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:10" align="right">comment:10</div>

There is basically one very technical issue preventing this from working. Compare `ZZ` with `QQ`. For `QQ` to work, you need to first specify that the `mod` parameter is `None`. Then it works. What is different for `ZZ`? It is a parent that is an extension class (i.e., is a `cdef` class). You can see a big difference between the two when you look at the MRO's.

Now, how does an extension class emulate being in a category, it uses `__getattr__`. However, methods like `__pow__` are special in Python and don't necessarily follow the usual rules. This also applies to infix binary operators like `**`. Here, I believe what is happening is it first sees explicitly (without a call to `__getattr__`) that `ZZ` does not have a `__pow__` method, so it then calls `Integer.__pow__(ZZ, n)`, leading to the error.

You seemed surprised that `ZZ.__pow__(2)` still works, but that involves a call to the `__getattr__`. Things are functioning normally there.

Here is perhaps the interesting thing. What you implemented actually works and might be the best solution because it gets around this issue by letting Python know that every `Parent` has a `__pow__` method and to call that (first). So we have to emulate the `Parent.__mul__` implementation (which is a slightly different issue dealing with inheritance, but likely suffers from the same complications). I also strongly dislike the workaround there too. So I cannot object to this.



---

archive/issue_comments_510208.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThat is subtle. Thank you for investigating this!\n\nSo, should I just repair the doctests and that's it?",
    "created_at": "2021-04-24T08:53:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510208",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:11" align="right">comment:11</div>

That is subtle. Thank you for investigating this!

So, should I just repair the doctests and that's it?



---

archive/issue_comments_510209.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nUp to the stuff in `free_module.py`, almost. I would include `ZZ^3` as an example somewhere too, along with some (short) explanation about why we do this.",
    "created_at": "2021-04-24T09:10:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510209",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:12" align="right">comment:12</div>

Up to the stuff in `free_module.py`, almost. I would include `ZZ^3` as an example somewhere too, along with some (short) explanation about why we do this.



---

archive/issue_comments_510210.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nAs for `free_module.py` I have a different idea. At the current stage, all generic ring methods such as `is_field` are in `ring.pyx`, but not every ring might inherit from this. I suggest to move them to the category. In effect, all `R in _Fields` checks can be replaced by a quicker `R.is_field()` check since the existence of this method is guaranteed. This also avoids cluttering the memory with \u00b4_Fields = Fields()` which is used very often in Sage code.\n\nI'll open another ticket for this soon.",
    "created_at": "2021-04-24T09:17:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510210",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:13" align="right">comment:13</div>

As for `free_module.py` I have a different idea. At the current stage, all generic ring methods such as `is_field` are in `ring.pyx`, but not every ring might inherit from this. I suggest to move them to the category. In effect, all `R in _Fields` checks can be replaced by a quicker `R.is_field()` check since the existence of this method is guaranteed. This also avoids cluttering the memory with ´_Fields = Fields()` which is used very often in Sage code.

I'll open another ticket for this soon.



---

archive/issue_comments_510211.json:
```json
{
    "body": "Changed commit from **[`04d282d`](https://github.com/sagemath/sagetrac-mirror/commit/04d282d6a2c2b1b0325119df446e3439d9a9fad4)** to none",
    "created_at": "2021-04-24T09:28:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510211",
    "user": "https://github.com/mjungmath"
}
```

Changed commit from **[`04d282d`](https://github.com/sagemath/sagetrac-mirror/commit/04d282d6a2c2b1b0325119df446e3439d9a9fad4)** to none



---

archive/issue_comments_510212.json:
```json
{
    "body": "Changed branch from **[u/gh-mjungmath/power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/power_method_for_parents)** to **[u/public/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/public/31721_power_method_for_parents)**",
    "created_at": "2021-04-24T09:28:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510212",
    "user": "https://github.com/mjungmath"
}
```

Changed branch from **[u/gh-mjungmath/power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/power_method_for_parents)** to **[u/public/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/public/31721_power_method_for_parents)**



---

archive/issue_comments_510213.json:
```json
{
    "body": "Changed branch from **[u/public/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/public/31721_power_method_for_parents)** to **[u/gh-mjungmath/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/31721_power_method_for_parents)**",
    "created_at": "2021-04-24T09:31:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510213",
    "user": "https://github.com/mjungmath"
}
```

Changed branch from **[u/public/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/public/31721_power_method_for_parents)** to **[u/gh-mjungmath/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/31721_power_method_for_parents)**



---

archive/issue_comments_510214.json:
```json
{
    "body": "Changed branch from **[u/gh-mjungmath/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/31721_power_method_for_parents)** to **[public/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/public/31721_power_method_for_parents)**",
    "created_at": "2021-04-24T09:32:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510214",
    "user": "https://github.com/mjungmath"
}
```

Changed branch from **[u/gh-mjungmath/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/31721_power_method_for_parents)** to **[public/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/public/31721_power_method_for_parents)**



---

archive/issue_comments_510215.json:
```json
{
    "body": "Commit: **[`f1a90be`](https://github.com/sagemath/sagetrac-mirror/commit/f1a90be746908eec59c7a53d5295c992cb09fdda)**",
    "created_at": "2021-04-24T09:32:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510215",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`f1a90be`](https://github.com/sagemath/sagetrac-mirror/commit/f1a90be746908eec59c7a53d5295c992cb09fdda)**



---

archive/issue_comments_510216.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f1a90be746908eec59c7a53d5295c992cb09fdda\"><code>f1a90be</code></a></td><td><code>Trac 31721: `__pow__` method for parents + `_pow_` implementation for categories/rings.py</code></td></tr></table>\n",
    "created_at": "2021-04-24T09:32:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510216",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f1a90be746908eec59c7a53d5295c992cb09fdda"><code>f1a90be</code></a></td><td><code>Trac 31721: `__pow__` method for parents + `_pow_` implementation for categories/rings.py</code></td></tr></table>




---

archive/issue_comments_510217.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nIs that explaination enough or do you prefer more? Moreover, I put a reference to this ticket if someone is interested in more details.",
    "created_at": "2021-04-24T09:33:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510217",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:18" align="right">comment:18</div>

Is that explaination enough or do you prefer more? Moreover, I put a reference to this ticket if someone is interested in more details.



---

archive/issue_comments_510218.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@mjungmath](#comment%3A13):\n> As for `free_module.py` I have a different idea. At the current stage, all generic ring methods such as `is_field` are in `ring.pyx`, but not every ring might inherit from this. I suggest to move them to the category. In effect, all `R in _Fields` checks can be replaced by a quicker `R.is_field()` check since the existence of this method is guaranteed. This also avoids cluttering the memory with \u00b4_Fields = Fields()` which is used very often in Sage code.\n> \n> I'll open another ticket for this soon.\n\nSee #31722.",
    "created_at": "2021-04-24T09:39:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510218",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@mjungmath](#comment%3A13):
> As for `free_module.py` I have a different idea. At the current stage, all generic ring methods such as `is_field` are in `ring.pyx`, but not every ring might inherit from this. I suggest to move them to the category. In effect, all `R in _Fields` checks can be replaced by a quicker `R.is_field()` check since the existence of this method is guaranteed. This also avoids cluttering the memory with ´_Fields = Fields()` which is used very often in Sage code.
> 
> I'll open another ticket for this soon.

See #31722.



---

archive/issue_comments_510219.json:
```json
{
    "body": "Changed commit from **[`f1a90be`](https://github.com/sagemath/sagetrac-mirror/commit/f1a90be746908eec59c7a53d5295c992cb09fdda)** to **[`adfa666`](https://github.com/sagemath/sagetrac-mirror/commit/adfa6664155aee9a320d1eb05d01ae773013c04d)**",
    "created_at": "2021-04-24T11:28:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510219",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f1a90be`](https://github.com/sagemath/sagetrac-mirror/commit/f1a90be746908eec59c7a53d5295c992cb09fdda)** to **[`adfa666`](https://github.com/sagemath/sagetrac-mirror/commit/adfa6664155aee9a320d1eb05d01ae773013c04d)**



---

archive/issue_comments_510220.json:
```json
{
    "body": "<div id=\"comment:20\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/adfa6664155aee9a320d1eb05d01ae773013c04d\"><code>adfa666</code></a></td><td><code>Trac #31721: improved documentation</code></td></tr></table>\n",
    "created_at": "2021-04-24T11:28:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510220",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:20"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/adfa6664155aee9a320d1eb05d01ae773013c04d"><code>adfa666</code></a></td><td><code>Trac #31721: improved documentation</code></td></tr></table>




---

archive/issue_comments_510221.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI don't really like that explanation, as well as the text preceding the `ZZ` example. I would do something like this:\n\n```\n        This is a power method that directly calls another attribute\n        ``_pow_`` (single underscore). This is because extension classes \n        cannot inherit ``__pow__`` from the the parent methods of the\n        category and the redirection via ``__getattr__`` is not called\n        from Python when performing ``**``. Subsequently, ``__pow__``\n        cannot be inherited from the category but ``_pow_`` can.\n        See :trac:`31721`.\n```\n\n```\n        TESTS:\n\n        We check that this works for extension classes::\n\n            sage: ZZ^3\n            Ambient free module of rank 3 over the principal ideal domain\n             Integer Ring\n            sage: isinstance(ZZ, Rings.ParentMethods)  # it is an extension class\n            False\n```",
    "created_at": "2021-04-24T22:25:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510221",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:21" align="right">comment:21</div>

I don't really like that explanation, as well as the text preceding the `ZZ` example. I would do something like this:

```
        This is a power method that directly calls another attribute
        ``_pow_`` (single underscore). This is because extension classes 
        cannot inherit ``__pow__`` from the the parent methods of the
        category and the redirection via ``__getattr__`` is not called
        from Python when performing ``**``. Subsequently, ``__pow__``
        cannot be inherited from the category but ``_pow_`` can.
        See :trac:`31721`.
```

```
        TESTS:

        We check that this works for extension classes::

            sage: ZZ^3
            Ambient free module of rank 3 over the principal ideal domain
             Integer Ring
            sage: isinstance(ZZ, Rings.ParentMethods)  # it is an extension class
            False
```



---

archive/issue_comments_510222.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f52821d4091611c257bad341337cf87fde2ce126\"><code>f52821d</code></a></td><td><code>Trac #31721: documentation improved</code></td></tr></table>\n",
    "created_at": "2021-04-25T09:15:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510222",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f52821d4091611c257bad341337cf87fde2ce126"><code>f52821d</code></a></td><td><code>Trac #31721: documentation improved</code></td></tr></table>




---

archive/issue_comments_510223.json:
```json
{
    "body": "Changed commit from **[`adfa666`](https://github.com/sagemath/sagetrac-mirror/commit/adfa6664155aee9a320d1eb05d01ae773013c04d)** to **[`f52821d`](https://github.com/sagemath/sagetrac-mirror/commit/f52821d4091611c257bad341337cf87fde2ce126)**",
    "created_at": "2021-04-25T09:15:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510223",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`adfa666`](https://github.com/sagemath/sagetrac-mirror/commit/adfa6664155aee9a320d1eb05d01ae773013c04d)** to **[`f52821d`](https://github.com/sagemath/sagetrac-mirror/commit/f52821d4091611c257bad341337cf87fde2ce126)**



---

archive/issue_comments_510224.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nThank you Travis! Here we go.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f52821d4091611c257bad341337cf87fde2ce126\"><code>f52821d</code></a></td><td><code>Trac #31721: documentation improved</code></td></tr></table>\n",
    "created_at": "2021-04-25T09:15:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510224",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:23" align="right">comment:23</div>

Thank you Travis! Here we go.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f52821d4091611c257bad341337cf87fde2ce126"><code>f52821d</code></a></td><td><code>Trac #31721: documentation improved</code></td></tr></table>




---

archive/issue_comments_510225.json:
```json
{
    "body": "Changed commit from **[`f52821d`](https://github.com/sagemath/sagetrac-mirror/commit/f52821d4091611c257bad341337cf87fde2ce126)** to **[`5a35e2a`](https://github.com/sagemath/sagetrac-mirror/commit/5a35e2a19457b5849c2073f5a0483a4f5ea241d8)**",
    "created_at": "2021-04-25T10:55:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510225",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f52821d`](https://github.com/sagemath/sagetrac-mirror/commit/f52821d4091611c257bad341337cf87fde2ce126)** to **[`5a35e2a`](https://github.com/sagemath/sagetrac-mirror/commit/5a35e2a19457b5849c2073f5a0483a4f5ea241d8)**



---

archive/issue_comments_510226.json:
```json
{
    "body": "<div id=\"comment:24\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ccb3b1c2fbb5691d0336b58e5398471831b21f37\"><code>ccb3b1c</code></a></td><td><code>Trac #31721: turn is_field and is_integral_domain into cpdef functions (completely doctested)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5a35e2a19457b5849c2073f5a0483a4f5ea241d8\"><code>5a35e2a</code></a></td><td><code>Trac #31721: add is_field and is_integral_domain to category of rings (tests on magmas fail)</code></td></tr></table>\n",
    "created_at": "2021-04-25T10:55:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510226",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:24"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ccb3b1c2fbb5691d0336b58e5398471831b21f37"><code>ccb3b1c</code></a></td><td><code>Trac #31721: turn is_field and is_integral_domain into cpdef functions (completely doctested)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5a35e2a19457b5849c2073f5a0483a4f5ea241d8"><code>5a35e2a</code></a></td><td><code>Trac #31721: add is_field and is_integral_domain to category of rings (tests on magmas fail)</code></td></tr></table>




---

archive/issue_comments_510227.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nSorry, wrong ticket number...",
    "created_at": "2021-04-25T10:56:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510227",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:25" align="right">comment:25</div>

Sorry, wrong ticket number...



---

archive/issue_comments_510228.json:
```json
{
    "body": "<div id=\"comment:26\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/06b3ec28a1e3b055a0788c2001ae1b6ee6007f3b\"><code>06b3ec2</code></a></td><td><code>Trac 31721: `__pow__` method for parents + `_pow_` implementation for categories/rings.py</code></td></tr></table>\n",
    "created_at": "2021-04-25T11:00:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510228",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:26"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/06b3ec28a1e3b055a0788c2001ae1b6ee6007f3b"><code>06b3ec2</code></a></td><td><code>Trac 31721: `__pow__` method for parents + `_pow_` implementation for categories/rings.py</code></td></tr></table>




---

archive/issue_comments_510229.json:
```json
{
    "body": "Changed commit from **[`5a35e2a`](https://github.com/sagemath/sagetrac-mirror/commit/5a35e2a19457b5849c2073f5a0483a4f5ea241d8)** to **[`06b3ec2`](https://github.com/sagemath/sagetrac-mirror/commit/06b3ec28a1e3b055a0788c2001ae1b6ee6007f3b)**",
    "created_at": "2021-04-25T11:00:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510229",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5a35e2a`](https://github.com/sagemath/sagetrac-mirror/commit/5a35e2a19457b5849c2073f5a0483a4f5ea241d8)** to **[`06b3ec2`](https://github.com/sagemath/sagetrac-mirror/commit/06b3ec28a1e3b055a0788c2001ae1b6ee6007f3b)**



---

archive/issue_comments_510230.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nWhy `if isinstance(self, Parent)` is inside the `try/except` block?",
    "created_at": "2021-04-25T15:44:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510230",
    "user": "https://github.com/videlec"
}
```

<div id="comment:27" align="right">comment:27</div>

Why `if isinstance(self, Parent)` is inside the `try/except` block?



---

archive/issue_comments_510231.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nWouldn't it be possible to call `__pow__` from the category by providing the following default implementation in `Parent`\n\n```\ndef __pow__(self, x, mod):\n    return self.getattr_from_category('__pow__')(x, mod)\n```",
    "created_at": "2021-04-25T15:55:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510231",
    "user": "https://github.com/videlec"
}
```

<div id="comment:28" align="right">comment:28</div>

Wouldn't it be possible to call `__pow__` from the category by providing the following default implementation in `Parent`

```
def __pow__(self, x, mod):
    return self.getattr_from_category('__pow__')(x, mod)
```



---

archive/issue_comments_510232.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nConcrete implementation with `__pow__` in `public/31721_double_underscore` (a bit more subtle than [comment:28]).",
    "created_at": "2021-04-25T17:20:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510232",
    "user": "https://github.com/videlec"
}
```

<div id="comment:29" align="right">comment:29</div>

Concrete implementation with `__pow__` in `public/31721_double_underscore` (a bit more subtle than [comment:28]).



---

archive/issue_events_434353.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-04-25T17:33:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-434353"
}
```



---

archive/issue_events_434354.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-04-25T17:33:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-434354"
}
```



---

archive/issue_comments_510233.json:
```json
{
    "body": "Changed commit from **[`06b3ec2`](https://github.com/sagemath/sagetrac-mirror/commit/06b3ec28a1e3b055a0788c2001ae1b6ee6007f3b)** to **[`93c1628`](https://github.com/sagemath/sagetrac-mirror/commit/93c1628ee9bc710f8388e7dae5ffe5c561052473)**",
    "created_at": "2021-04-25T18:26:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510233",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`06b3ec2`](https://github.com/sagemath/sagetrac-mirror/commit/06b3ec28a1e3b055a0788c2001ae1b6ee6007f3b)** to **[`93c1628`](https://github.com/sagemath/sagetrac-mirror/commit/93c1628ee9bc710f8388e7dae5ffe5c561052473)**



---

archive/issue_comments_510234.json:
```json
{
    "body": "<div id=\"comment:31\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/93c1628ee9bc710f8388e7dae5ffe5c561052473\"><code>93c1628</code></a></td><td><code>Trac 31721: `__pow__` method for parents + `_pow_` implementation for categories/rings.py</code></td></tr></table>\n",
    "created_at": "2021-04-25T18:26:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510234",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/93c1628ee9bc710f8388e7dae5ffe5c561052473"><code>93c1628</code></a></td><td><code>Trac 31721: `__pow__` method for parents + `_pow_` implementation for categories/rings.py</code></td></tr></table>




---

archive/issue_comments_510235.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nSorry, the changes of `is_field` are not supposed to be there. That was for #31722. I accidentally merged them.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/93c1628ee9bc710f8388e7dae5ffe5c561052473\"><code>93c1628</code></a></td><td><code>Trac 31721: `__pow__` method for parents + `_pow_` implementation for categories/rings.py</code></td></tr></table>\n",
    "created_at": "2021-04-25T18:26:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510235",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:32" align="right">comment:32</div>

Sorry, the changes of `is_field` are not supposed to be there. That was for #31722. I accidentally merged them.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/93c1628ee9bc710f8388e7dae5ffe5c561052473"><code>93c1628</code></a></td><td><code>Trac 31721: `__pow__` method for parents + `_pow_` implementation for categories/rings.py</code></td></tr></table>




---

archive/issue_comments_510236.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nWe could use `getattr_from_category`, although I think that is slower than calling `_pow_` (but I haven't tested it). Now, it is quite likely that this doesn't need to be so optimized (unlike perhaps `__mul__`). It definitely would make the code more natural. So that would be a better IMO.",
    "created_at": "2021-04-25T23:50:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510236",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:33" align="right">comment:33</div>

We could use `getattr_from_category`, although I think that is slower than calling `_pow_` (but I haven't tested it). Now, it is quite likely that this doesn't need to be so optimized (unlike perhaps `__mul__`). It definitely would make the code more natural. So that would be a better IMO.



---

archive/issue_comments_510237.json:
```json
{
    "body": "Changed commit from **[`93c1628`](https://github.com/sagemath/sagetrac-mirror/commit/93c1628ee9bc710f8388e7dae5ffe5c561052473)** to **[`fa5057c`](https://github.com/sagemath/sagetrac-mirror/commit/fa5057ce25fcc2d7dc6e7d22a9881470f341fe7a)**",
    "created_at": "2021-04-27T07:42:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510237",
    "user": "https://github.com/videlec"
}
```

Changed commit from **[`93c1628`](https://github.com/sagemath/sagetrac-mirror/commit/93c1628ee9bc710f8388e7dae5ffe5c561052473)** to **[`fa5057c`](https://github.com/sagemath/sagetrac-mirror/commit/fa5057ce25fcc2d7dc6e7d22a9881470f341fe7a)**



---

archive/issue_events_434355.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-04-27T07:42:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-434355"
}
```



---

archive/issue_events_434356.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-04-27T07:42:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-434356"
}
```



---

archive/issue_comments_510238.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nPlease have a look\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fa5057ce25fcc2d7dc6e7d22a9881470f341fe7a\"><code>fa5057c</code></a></td><td><code>Trac 31721: `__pow__` method for parents</code></td></tr></table>\n",
    "created_at": "2021-04-27T07:42:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510238",
    "user": "https://github.com/videlec"
}
```

<div id="comment:34" align="right">comment:34</div>

Please have a look

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fa5057ce25fcc2d7dc6e7d22a9881470f341fe7a"><code>fa5057c</code></a></td><td><code>Trac 31721: `__pow__` method for parents</code></td></tr></table>




---

archive/issue_comments_510239.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1 @@\n-We equip `structure/parent.pyx` with a method `__pow__` which delegates to a concrete implementation `_pow_`, for example in the corresponding category.\n-\n-Moreover, we move the `__pow__` in `rings/ring.pyx` to the category file `categories/rings.py` so that any ring can benefit from it and not only those which inherit from `rings/ring.pyx`.\n+We equip `structure/parent.pyx` with a method `__pow__` which possibly delegates to the corresponding category. Moreover, we move the `__pow__` in `rings/ring.pyx` to the category file `categories/rings.py` so that any ring can benefit from it and not only those which inherit from `rings/ring.pyx`.\n``````\n",
    "created_at": "2021-04-27T07:42:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510239",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1 @@
-We equip `structure/parent.pyx` with a method `__pow__` which delegates to a concrete implementation `_pow_`, for example in the corresponding category.
-
-Moreover, we move the `__pow__` in `rings/ring.pyx` to the category file `categories/rings.py` so that any ring can benefit from it and not only those which inherit from `rings/ring.pyx`.
+We equip `structure/parent.pyx` with a method `__pow__` which possibly delegates to the corresponding category. Moreover, we move the `__pow__` in `rings/ring.pyx` to the category file `categories/rings.py` so that any ring can benefit from it and not only those which inherit from `rings/ring.pyx`.
``````




---

archive/issue_comments_510240.json:
```json
{
    "body": "Changed branch from **[public/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/public/31721_power_method_for_parents)** to **[public/31721_double_underscore](https://github.com/sagemath/sagetrac-mirror/tree/public/31721_double_underscore)**",
    "created_at": "2021-04-27T07:42:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510240",
    "user": "https://github.com/videlec"
}
```

Changed branch from **[public/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/public/31721_power_method_for_parents)** to **[public/31721_double_underscore](https://github.com/sagemath/sagetrac-mirror/tree/public/31721_double_underscore)**



---

archive/issue_comments_510241.json:
```json
{
    "body": "Changed author from **Michael Jung** to **Michael Jung, Vincent Delecroix**",
    "created_at": "2021-04-27T07:42:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510241",
    "user": "https://github.com/videlec"
}
```

Changed author from **Michael Jung** to **Michael Jung, Vincent Delecroix**



---

archive/issue_comments_510242.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nWhat exactly is the purpose of that line?\n\n```diff\n        try:\n+            meth = super(Parent, (<Parent> self)).__pow__\n        except AttributeError:\n```",
    "created_at": "2021-04-27T08:53:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510242",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:35" align="right">comment:35</div>

What exactly is the purpose of that line?

```diff
        try:
+            meth = super(Parent, (<Parent> self)).__pow__
        except AttributeError:
```



---

archive/issue_comments_510243.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nIn the case the parent is a Python class, you get the `__pow__` from the category this way.\n\n```\nsage: class MyParent(Parent):\n....:     def __init__(self):\n....:         Parent.__init__(self, category=CommutativeRings())\nsage: M = MyParent()\nsage: super(Parent, M).__pow__\n<bound method Rings.ParentMethods.__pow__ of <__main__.MyParent_with_category object at 0x7f1930f0e4f0>>\n```",
    "created_at": "2021-04-27T08:59:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510243",
    "user": "https://github.com/videlec"
}
```

<div id="comment:36" align="right">comment:36</div>

In the case the parent is a Python class, you get the `__pow__` from the category this way.

```
sage: class MyParent(Parent):
....:     def __init__(self):
....:         Parent.__init__(self, category=CommutativeRings())
sage: M = MyParent()
sage: super(Parent, M).__pow__
<bound method Rings.ParentMethods.__pow__ of <__main__.MyParent_with_category object at 0x7f1930f0e4f0>>
```



---

archive/issue_comments_510244.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nLet me add a comment in the code.",
    "created_at": "2021-04-27T09:00:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510244",
    "user": "https://github.com/videlec"
}
```

<div id="comment:37" align="right">comment:37</div>

Let me add a comment in the code.



---

archive/issue_comments_510245.json:
```json
{
    "body": "Changed commit from **[`fa5057c`](https://github.com/sagemath/sagetrac-mirror/commit/fa5057ce25fcc2d7dc6e7d22a9881470f341fe7a)** to **[`27422d3`](https://github.com/sagemath/sagetrac-mirror/commit/27422d323a7db31f3fc2068f6aeb3100b3e4d6ae)**",
    "created_at": "2021-04-27T09:03:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510245",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`fa5057c`](https://github.com/sagemath/sagetrac-mirror/commit/fa5057ce25fcc2d7dc6e7d22a9881470f341fe7a)** to **[`27422d3`](https://github.com/sagemath/sagetrac-mirror/commit/27422d323a7db31f3fc2068f6aeb3100b3e4d6ae)**



---

archive/issue_comments_510246.json:
```json
{
    "body": "<div id=\"comment:38\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/27422d323a7db31f3fc2068f6aeb3100b3e4d6ae\"><code>27422d3</code></a></td><td><code>31721: more comments</code></td></tr></table>\n",
    "created_at": "2021-04-27T09:03:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510246",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:38"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/27422d323a7db31f3fc2068f6aeb3100b3e4d6ae"><code>27422d3</code></a></td><td><code>31721: more comments</code></td></tr></table>




---

archive/issue_comments_510247.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nBut\n\n```diff\n+                meth = (<Parent> self).getattr_from_category('__pow__')\n```\n\nworks in any case, no? Is \n\n```diff\n+            meth = super(Parent, (<Parent> self)).__pow__\n```\n\nsomewhat faster in the Python case?",
    "created_at": "2021-04-27T09:11:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510247",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:39" align="right">comment:39</div>

But

```diff
+                meth = (<Parent> self).getattr_from_category('__pow__')
```

works in any case, no? Is 

```diff
+            meth = super(Parent, (<Parent> self)).__pow__
```

somewhat faster in the Python case?



---

archive/issue_comments_510248.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nFor the following reason (I am adding a doctest)\n\n```\nsage: class A:\n....:    def __pow__(self, n):\n....:        return 'Apow'\nsage: class MyParent(A, Parent):\n....:    pass\nsage: MyParent()^2\n'Apow'\n```",
    "created_at": "2021-04-27T10:46:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510248",
    "user": "https://github.com/videlec"
}
```

<div id="comment:40" align="right">comment:40</div>

For the following reason (I am adding a doctest)

```
sage: class A:
....:    def __pow__(self, n):
....:        return 'Apow'
sage: class MyParent(A, Parent):
....:    pass
sage: MyParent()^2
'Apow'
```



---

archive/issue_comments_510249.json:
```json
{
    "body": "<div id=\"comment:41\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e8d34270e0b74d33776f958360a0cdad60a0b74c\"><code>e8d3427</code></a></td><td><code>clarify comment and doctest for multiple inheritance</code></td></tr></table>\n",
    "created_at": "2021-04-27T10:50:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510249",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:41"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e8d34270e0b74d33776f958360a0cdad60a0b74c"><code>e8d3427</code></a></td><td><code>clarify comment and doctest for multiple inheritance</code></td></tr></table>




---

archive/issue_comments_510250.json:
```json
{
    "body": "Changed commit from **[`27422d3`](https://github.com/sagemath/sagetrac-mirror/commit/27422d323a7db31f3fc2068f6aeb3100b3e4d6ae)** to **[`e8d3427`](https://github.com/sagemath/sagetrac-mirror/commit/e8d34270e0b74d33776f958360a0cdad60a0b74c)**",
    "created_at": "2021-04-27T10:50:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510250",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`27422d3`](https://github.com/sagemath/sagetrac-mirror/commit/27422d323a7db31f3fc2068f6aeb3100b3e4d6ae)** to **[`e8d3427`](https://github.com/sagemath/sagetrac-mirror/commit/e8d34270e0b74d33776f958360a0cdad60a0b74c)**



---

archive/issue_comments_510251.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nWhen the parent is a Python class and the category does not define a `__pow__` then we catch two `AttributeError` in `Parent.__pow__`.",
    "created_at": "2021-04-27T10:51:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510251",
    "user": "https://github.com/videlec"
}
```

<div id="comment:42" align="right">comment:42</div>

When the parent is a Python class and the category does not define a `__pow__` then we catch two `AttributeError` in `Parent.__pow__`.



---

archive/issue_comments_510252.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nOh right, multiple inheritances. I just lost that out of sight. Perfect, thanks!",
    "created_at": "2021-04-27T11:01:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510252",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:43" align="right">comment:43</div>

Oh right, multiple inheritances. I just lost that out of sight. Perfect, thanks!



---

archive/issue_comments_510253.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nI agree, this looks more natural. Travis, any comments? Otherwise I would give it a positive review when patchbot is giving us his blessing.\n\nWhat about `__mul__` by the way? Shouldn't that be changed accordingly? Not in this ticket of course, but perhaps in a follow-up?",
    "created_at": "2021-04-27T11:06:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510253",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:44" align="right">comment:44</div>

I agree, this looks more natural. Travis, any comments? Otherwise I would give it a positive review when patchbot is giving us his blessing.

What about `__mul__` by the way? Shouldn't that be changed accordingly? Not in this ticket of course, but perhaps in a follow-up?



---

archive/issue_comments_510254.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nAfter this ticket, all rings have `__pow__`, but the construction is broken\n\n```\nsage: ZZ.cartesian_product(ZZ)^3\nTraceback (most recent call last):\n...\nAttributeError: 'CartesianProduct_with_category' object has no attribute 'is_field'\n```\nThis will hopefully be fixed after #31722.",
    "created_at": "2021-04-27T20:02:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510254",
    "user": "https://github.com/videlec"
}
```

<div id="comment:45" align="right">comment:45</div>

After this ticket, all rings have `__pow__`, but the construction is broken

```
sage: ZZ.cartesian_product(ZZ)^3
Traceback (most recent call last):
...
AttributeError: 'CartesianProduct_with_category' object has no attribute 'is_field'
```
This will hopefully be fixed after #31722.



---

archive/issue_comments_510255.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nConcerning `__mul__`, I don't have any opinion.",
    "created_at": "2021-04-27T20:03:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510255",
    "user": "https://github.com/videlec"
}
```

<div id="comment:46" align="right">comment:46</div>

Concerning `__mul__`, I don't have any opinion.



---

archive/issue_comments_510256.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nReplying to [@videlec](#comment%3A45):\n> After this ticket, all rings have `__pow__`, but the construction is broken\n> \n> ```\n> sage: ZZ.cartesian_product(ZZ)^3\n> Traceback (most recent call last):\n> ...\n> AttributeError: 'CartesianProduct_with_category' object has no attribute 'is_field'\n> ```\n> This will hopefully be fixed after #31722.\n\nYeah, this is really annoying. Happens all over the place in Sage.\n\n---\n\nAs for the ticket, LGTM.",
    "created_at": "2021-04-28T00:14:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510256",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:47" align="right">comment:47</div>

Replying to [@videlec](#comment%3A45):
> After this ticket, all rings have `__pow__`, but the construction is broken
> 
> ```
> sage: ZZ.cartesian_product(ZZ)^3
> Traceback (most recent call last):
> ...
> AttributeError: 'CartesianProduct_with_category' object has no attribute 'is_field'
> ```
> This will hopefully be fixed after #31722.

Yeah, this is really annoying. Happens all over the place in Sage.

---

As for the ticket, LGTM.



---

archive/issue_comments_510257.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw, Michael Jung, Vincent Delecroix**",
    "created_at": "2021-04-28T00:14:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510257",
    "user": "https://github.com/mjungmath"
}
```

Reviewer: **Travis Scrimshaw, Michael Jung, Vincent Delecroix**



---

archive/issue_events_434357.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-04-28T00:14:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-434357"
}
```



---

archive/issue_events_434358.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-04-28T00:14:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-434358"
}
```



---

archive/issue_comments_510258.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nI would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.\n\nI also wonder if this would be better put in `CategoryObject` instead of `Parent`. However, that might cause slowdowns with elements, thus we'd need to be a lot more careful with testing. This at least is a clear improvement. Hence, that can be done on a followup and considered at the same time as `__mul__`, which might have other considerations as well.",
    "created_at": "2021-04-28T02:39:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510258",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:48" align="right">comment:48</div>

I would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.

I also wonder if this would be better put in `CategoryObject` instead of `Parent`. However, that might cause slowdowns with elements, thus we'd need to be a lot more careful with testing. This at least is a clear improvement. Hence, that can be done on a followup and considered at the same time as `__mul__`, which might have other considerations as well.



---

archive/issue_comments_510259.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nReplying to [@tscrim](#comment%3A48):\n> I would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.\n\nDefinitely true.\n\n> I also wonder if this would be better put in `CategoryObject` instead of `Parent`. However, that might cause slowdowns with elements, thus we'd need to be a lot more careful with testing. This at least is a clear improvement. Hence, that can be done on a followup and considered at the same time as `__mul__`, which might have other considerations as well.\n\nThat is a good suggestion. Since `Element` has its own `__pow__` I don't think there would be any slowdown.",
    "created_at": "2021-04-28T06:24:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510259",
    "user": "https://github.com/videlec"
}
```

<div id="comment:49" align="right">comment:49</div>

Replying to [@tscrim](#comment%3A48):
> I would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.

Definitely true.

> I also wonder if this would be better put in `CategoryObject` instead of `Parent`. However, that might cause slowdowns with elements, thus we'd need to be a lot more careful with testing. This at least is a clear improvement. Hence, that can be done on a followup and considered at the same time as `__mul__`, which might have other considerations as well.

That is a good suggestion. Since `Element` has its own `__pow__` I don't think there would be any slowdown.



---

archive/issue_comments_510260.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nReplying to [@videlec](#comment%3A49):\n> That is a good suggestion. Since `Element` has its own `__pow__` I don't think there would be any slowdown.\n\nThat's indeed something for another ticket. Who opens it?\n\nReplying to [@tscrim](#comment%3A48):\n>I would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.\n\nFor example? It's already more than in my first draft.",
    "created_at": "2021-04-28T07:10:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510260",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:50" align="right">comment:50</div>

Replying to [@videlec](#comment%3A49):
> That is a good suggestion. Since `Element` has its own `__pow__` I don't think there would be any slowdown.

That's indeed something for another ticket. Who opens it?

Replying to [@tscrim](#comment%3A48):
>I would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.

For example? It's already more than in my first draft.



---

archive/issue_comments_510261.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nReplying to [@mjungmath](#comment%3A50):\n> Replying to [@videlec](#comment%3A49):\n> > That is a good suggestion. Since `Element` has its own `__pow__` I don't think there would be any slowdown.\n\n> \n> That's indeed something for another ticket. Who opens it?\n\n#31746\n\n> Replying to [@tscrim](#comment%3A48):\n> >I would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.\n\n> \n> For example? It's already more than in my first draft.\n\nI added that as a task for #31746 too.",
    "created_at": "2021-04-28T07:26:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510261",
    "user": "https://github.com/videlec"
}
```

<div id="comment:51" align="right">comment:51</div>

Replying to [@mjungmath](#comment%3A50):
> Replying to [@videlec](#comment%3A49):
> > That is a good suggestion. Since `Element` has its own `__pow__` I don't think there would be any slowdown.

> 
> That's indeed something for another ticket. Who opens it?

#31746

> Replying to [@tscrim](#comment%3A48):
> >I would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.

> 
> For example? It's already more than in my first draft.

I added that as a task for #31746 too.



---

archive/issue_comments_510262.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nReplying to [@mjungmath](#comment%3A50):\n> Replying to [@tscrim](#comment%3A48):\n> >I would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.\n\n> \n> For example? It's already more than in my first draft.\n\nThat doesn't necessarily mean it is sufficient. Perhaps something like:\n\n```\nRedirect ``__pow__`` either from the MRO or from the category. This\nimplementation is so extension classes will call the method from\nthe appropriate category.\n```\nThat way it at least gives some reason for why this implementation exists.",
    "created_at": "2021-04-29T05:28:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510262",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:52" align="right">comment:52</div>

Replying to [@mjungmath](#comment%3A50):
> Replying to [@tscrim](#comment%3A48):
> >I would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.

> 
> For example? It's already more than in my first draft.

That doesn't necessarily mean it is sufficient. Perhaps something like:

```
Redirect ``__pow__`` either from the MRO or from the category. This
implementation is so extension classes will call the method from
the appropriate category.
```
That way it at least gives some reason for why this implementation exists.



---

archive/issue_comments_510263.json:
```json
{
    "body": "Changed commit from **[`e8d3427`](https://github.com/sagemath/sagetrac-mirror/commit/e8d34270e0b74d33776f958360a0cdad60a0b74c)** to **[`b873bcb`](https://github.com/sagemath/sagetrac-mirror/commit/b873bcbe33571dc020c08b05c0390777148b1b53)**",
    "created_at": "2021-04-29T07:08:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510263",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e8d3427`](https://github.com/sagemath/sagetrac-mirror/commit/e8d34270e0b74d33776f958360a0cdad60a0b74c)** to **[`b873bcb`](https://github.com/sagemath/sagetrac-mirror/commit/b873bcbe33571dc020c08b05c0390777148b1b53)**



---

archive/issue_comments_510264.json:
```json
{
    "body": "<div id=\"comment:53\"></div>\n\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b873bcbe33571dc020c08b05c0390777148b1b53\"><code>b873bcb</code></a></td><td><code>some doc</code></td></tr></table>\n",
    "created_at": "2021-04-29T07:08:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510264",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:53"></div>

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b873bcbe33571dc020c08b05c0390777148b1b53"><code>b873bcb</code></a></td><td><code>some doc</code></td></tr></table>




---

archive/issue_events_434359.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2021-04-29T07:08:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-434359"
}
```



---

archive/issue_events_434360.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2021-04-29T07:08:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-434360"
}
```



---

archive/issue_comments_510265.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nThank you.",
    "created_at": "2021-04-30T00:43:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510265",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:54" align="right">comment:54</div>

Thank you.



---

archive/issue_events_434361.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-04-30T00:43:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-434361"
}
```



---

archive/issue_events_434362.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-04-30T00:43:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-434362"
}
```



---

archive/issue_events_434363.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-06-19T20:58:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-434363"
}
```



---

archive/issue_events_434364.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "afae1ae23be188324ee3e465b26bb82c494e3956",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-06-19T20:58:06Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-434364"
}
```



---

archive/issue_comments_510266.json:
```json
{
    "body": "Changed branch from **[public/31721_double_underscore](https://github.com/sagemath/sagetrac-mirror/tree/public/31721_double_underscore)** to **[`b873bcb`](https://github.com/sagemath/sagetrac-mirror/commit/b873bcbe33571dc020c08b05c0390777148b1b53)**",
    "created_at": "2021-06-19T20:58:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-510266",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/31721_double_underscore](https://github.com/sagemath/sagetrac-mirror/tree/public/31721_double_underscore)** to **[`b873bcb`](https://github.com/sagemath/sagetrac-mirror/commit/b873bcbe33571dc020c08b05c0390777148b1b53)**
