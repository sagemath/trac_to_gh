# Issue 31721: Endow parents with __pow__

archive/issues_031484.json:
```json
{
    "body": "We equip `structure/parent.pyx` with a method `__pow__` which possibly delegates to the corresponding category. Moreover, we move the `__pow__` in `rings/ring.pyx` to the category file `categories/rings.py` so that any ring can benefit from it and not only those which inherit from `rings/ring.pyx`.\n\n**CC:**  @tscrim @mkoeppe @slel\n\n**Branch/Commit:** [b873bcbe33571dc020c08b05c0390777148b1b53](https://github.com/sagemath/sagetrac-mirror/commit/b873bcbe33571dc020c08b05c0390777148b1b53)\n\n**Reviewer:** Travis Scrimshaw, Michael Jung, Vincent Delecroix\n\n**Author:** Michael Jung, Vincent Delecroix\n\nIssue created by migration from https://trac.sagemath.org/ticket/31721\n\n",
    "closed_at": "2021-06-19T20:58:06Z",
    "created_at": "2021-04-23T17:31:13Z",
    "labels": [
        "component: categories",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.4",
    "title": "Endow parents with __pow__",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/31721",
    "user": "https://github.com/mjungmath"
}
```
We equip `structure/parent.pyx` with a method `__pow__` which possibly delegates to the corresponding category. Moreover, we move the `__pow__` in `rings/ring.pyx` to the category file `categories/rings.py` so that any ring can benefit from it and not only those which inherit from `rings/ring.pyx`.

**CC:**  @tscrim @mkoeppe @slel

**Branch/Commit:** [b873bcbe33571dc020c08b05c0390777148b1b53](https://github.com/sagemath/sagetrac-mirror/commit/b873bcbe33571dc020c08b05c0390777148b1b53)

**Reviewer:** Travis Scrimshaw, Michael Jung, Vincent Delecroix

**Author:** Michael Jung, Vincent Delecroix

Issue created by migration from https://trac.sagemath.org/ticket/31721





---

archive/issue_comments_513023.json:
```json
{
    "body": "**Branch:** [u/gh-mjungmath/power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/power_method_for_parents)",
    "created_at": "2021-04-23T17:40:01Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513023",
    "user": "https://github.com/mjungmath"
}
```

**Branch:** [u/gh-mjungmath/power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/power_method_for_parents)



---

archive/issue_comments_513024.json:
```json
{
    "body": "<a id='comment:2'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/64599379f79086962d2349568c508887e0926d2a\">6459937</a></td><td><code>#Trac 31721: `__pow__` for parents and move `__pow__` in rings</code></td></tr></table>\n",
    "created_at": "2021-04-23T17:40:16Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513024",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:2'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/64599379f79086962d2349568c508887e0926d2a">6459937</a></td><td><code>#Trac 31721: `__pow__` for parents and move `__pow__` in rings</code></td></tr></table>




---

archive/issue_events_284875.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-04-23T17:40:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-284875"
}
```



---

archive/issue_comments_513025.json:
```json
{
    "body": "**Commit:** [64599379f79086962d2349568c508887e0926d2a](https://github.com/sagemath/sagetrac-mirror/commit/64599379f79086962d2349568c508887e0926d2a)",
    "created_at": "2021-04-23T17:40:16Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513025",
    "user": "https://github.com/mjungmath"
}
```

**Commit:** [64599379f79086962d2349568c508887e0926d2a](https://github.com/sagemath/sagetrac-mirror/commit/64599379f79086962d2349568c508887e0926d2a)



---

archive/issue_comments_513026.json:
```json
{
    "body": "<a id='comment:3'></a>\nWaiting for patchbot, but unless patchbot does not object, this is ready for review.",
    "created_at": "2021-04-23T17:45:24Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513026",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:3'></a>
Waiting for patchbot, but unless patchbot does not object, this is ready for review.



---

archive/issue_comments_513027.json:
```json
{
    "body": "<a id='comment:4'></a>\nIs it not possible to define `__pow__` directly in the category? Why do we need an indirection via `_pow_`? For elements, it is perfectly understandable since things might have to go through coercion when parents mismatch. But here, what is the point?",
    "created_at": "2021-04-23T18:40:30Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513027",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>
Is it not possible to define `__pow__` directly in the category? Why do we need an indirection via `_pow_`? For elements, it is perfectly understandable since things might have to go through coercion when parents mismatch. But here, what is the point?



---

archive/issue_comments_513028.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [vdelecroix](#comment%3A4):\n> Is it not possible to define `__pow__` directly in the category? Why do we need an indirection via `_pow_`? For elements, it is perfectly understandable since things might have to go through coercion when parents mismatch. But here, what is the point?\n\n\nI just mimicked the behavior of `__mul__` for parents. But perhaps you're right and this is not necessary here because no preprocessing is needed.\n\nTravis, do you know more?",
    "created_at": "2021-04-23T19:02:39Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513028",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:5'></a>
Replying to [vdelecroix](#comment%3A4):
> Is it not possible to define `__pow__` directly in the category? Why do we need an indirection via `_pow_`? For elements, it is perfectly understandable since things might have to go through coercion when parents mismatch. But here, what is the point?


I just mimicked the behavior of `__mul__` for parents. But perhaps you're right and this is not necessary here because no preprocessing is needed.

Travis, do you know more?



---

archive/issue_comments_513029.json:
```json
{
    "body": "<a id='comment:6'></a>\nOkay, it turns out that this indeed doesn't work. I have renamed `_pow_` to `__pow__` in `rings.py` and removed the changes in `parent.pyx` and now get the following error:\n\n```\nsage: ZZ**2                                                                     \n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-5-98b583f923b1> in <module>\n----> 1 ZZ**Integer(2)\n\n~/Projekte/sage-devel/local/lib/python3.8/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__pow__ (build/cythonized/sage/rings/integer.c:15218)()\n   2206             return coercion_model.bin_op(left, right, operator.pow)\n   2207         # left is a non-Element: do the powering with a Python int\n-> 2208         return left ** int(right)\n   2209 \n   2210     cpdef _pow_(self, other):\n\nTypeError: unsupported operand type(s) for ** or pow(): 'sage.rings.integer_ring.IntegerRing_class' and 'int'\n```\n\nwhile this works\n\n```\nsage: ZZ.__pow__(2)                                                             \nAmbient free module of rank 2 over the principal ideal domain Integer Ring\n```\n\nApparently the coercion framework tries to play man in the middle.",
    "created_at": "2021-04-23T19:28:16Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513029",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:6'></a>
Okay, it turns out that this indeed doesn't work. I have renamed `_pow_` to `__pow__` in `rings.py` and removed the changes in `parent.pyx` and now get the following error:

```
sage: ZZ**2                                                                     
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-5-98b583f923b1> in <module>
----> 1 ZZ**Integer(2)

~/Projekte/sage-devel/local/lib/python3.8/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__pow__ (build/cythonized/sage/rings/integer.c:15218)()
   2206             return coercion_model.bin_op(left, right, operator.pow)
   2207         # left is a non-Element: do the powering with a Python int
-> 2208         return left ** int(right)
   2209 
   2210     cpdef _pow_(self, other):

TypeError: unsupported operand type(s) for ** or pow(): 'sage.rings.integer_ring.IntegerRing_class' and 'int'
```

while this works

```
sage: ZZ.__pow__(2)                                                             
Ambient free module of rank 2 over the principal ideal domain Integer Ring
```

Apparently the coercion framework tries to play man in the middle.



---

archive/issue_comments_513030.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/04d282d6a2c2b1b0325119df446e3439d9a9fad4\">04d282d</a></td><td><code>Trac #31721: improve error message + fix doctests</code></td></tr></table>\n",
    "created_at": "2021-04-23T21:51:10Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513030",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/04d282d6a2c2b1b0325119df446e3439d9a9fad4">04d282d</a></td><td><code>Trac #31721: improve error message + fix doctests</code></td></tr></table>




---

archive/issue_comments_513031.json:
```json
{
    "body": "**Changing commit** from \"[64599379f79086962d2349568c508887e0926d2a](https://github.com/sagemath/sagetrac-mirror/commit/64599379f79086962d2349568c508887e0926d2a)\" to \"[04d282d6a2c2b1b0325119df446e3439d9a9fad4](https://github.com/sagemath/sagetrac-mirror/commit/04d282d6a2c2b1b0325119df446e3439d9a9fad4)\".",
    "created_at": "2021-04-23T21:51:10Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513031",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[64599379f79086962d2349568c508887e0926d2a](https://github.com/sagemath/sagetrac-mirror/commit/64599379f79086962d2349568c508887e0926d2a)" to "[04d282d6a2c2b1b0325119df446e3439d9a9fad4](https://github.com/sagemath/sagetrac-mirror/commit/04d282d6a2c2b1b0325119df446e3439d9a9fad4)".



---

archive/issue_comments_513032.json:
```json
{
    "body": "<a id='comment:8'></a>\nThe coercion framework works on `Element`s and finds common `Parent`s. Outright, it doesn't get involved. Instead, this is something Python does with trying by swapping the order of the two inputs.\n\nI strongly dislike the `__pow__` implemented in the parent. It will override anything that can be done in a category. Category stuff is called lower in the MRO than an any concrete class. So it restricts any future parent implementation for no reason.\n\nThat being said, `Parent`s should *not* be implementing a `_pow_` because there is no reason to standardize input to the same object. It doesn't make sense.\n\nI don't think the `_pow_int` in the `Fields` category is ever called. So it is good to remove it.\n\nSame comment as in the other ticket about nailing categories into memory should be avoided and the changes to `free_module.py`.",
    "created_at": "2021-04-24T05:52:49Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513032",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>
The coercion framework works on `Element`s and finds common `Parent`s. Outright, it doesn't get involved. Instead, this is something Python does with trying by swapping the order of the two inputs.

I strongly dislike the `__pow__` implemented in the parent. It will override anything that can be done in a category. Category stuff is called lower in the MRO than an any concrete class. So it restricts any future parent implementation for no reason.

That being said, `Parent`s should *not* be implementing a `_pow_` because there is no reason to standardize input to the same object. It doesn't make sense.

I don't think the `_pow_int` in the `Fields` category is ever called. So it is good to remove it.

Same comment as in the other ticket about nailing categories into memory should be avoided and the changes to `free_module.py`.



---

archive/issue_comments_513033.json:
```json
{
    "body": "<a id='comment:9'></a>\nBut then I am clueless. If `__pow__` for `parent.pyx` is not desirable and `__pow__` for `rings.py` causes the above error, how do we proceed?",
    "created_at": "2021-04-24T07:05:52Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513033",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:9'></a>
But then I am clueless. If `__pow__` for `parent.pyx` is not desirable and `__pow__` for `rings.py` causes the above error, how do we proceed?



---

archive/issue_comments_513034.json:
```json
{
    "body": "<a id='comment:10'></a>\nThere is basically one very technical issue preventing this from working. Compare `ZZ` with `QQ`. For `QQ` to work, you need to first specify that the `mod` parameter is `None`. Then it works. What is different for `ZZ`? It is a parent that is an extension class (i.e., is a `cdef` class). You can see a big difference between the two when you look at the MRO's.\n\nNow, how does an extension class emulate being in a category, it uses `__getattr__`. However, methods like `__pow__` are special in Python and don't necessarily follow the usual rules. This also applies to infix binary operators like `**`. Here, I believe what is happening is it first sees explicitly (without a call to `__getattr__`) that `ZZ` does not have a `__pow__` method, so it then calls `Integer.__pow__(ZZ, n)`, leading to the error.\n\nYou seemed surprised that `ZZ.__pow__(2)` still works, but that involves a call to the `__getattr__`. Things are functioning normally there.\n\nHere is perhaps the interesting thing. What you implemented actually works and might be the best solution because it gets around this issue by letting Python know that every `Parent` has a `__pow__` method and to call that (first). So we have to emulate the `Parent.__mul__` implementation (which is a slightly different issue dealing with inheritance, but likely suffers from the same complications). I also strongly dislike the workaround there too. So I cannot object to this.",
    "created_at": "2021-04-24T08:22:32Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513034",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>
There is basically one very technical issue preventing this from working. Compare `ZZ` with `QQ`. For `QQ` to work, you need to first specify that the `mod` parameter is `None`. Then it works. What is different for `ZZ`? It is a parent that is an extension class (i.e., is a `cdef` class). You can see a big difference between the two when you look at the MRO's.

Now, how does an extension class emulate being in a category, it uses `__getattr__`. However, methods like `__pow__` are special in Python and don't necessarily follow the usual rules. This also applies to infix binary operators like `**`. Here, I believe what is happening is it first sees explicitly (without a call to `__getattr__`) that `ZZ` does not have a `__pow__` method, so it then calls `Integer.__pow__(ZZ, n)`, leading to the error.

You seemed surprised that `ZZ.__pow__(2)` still works, but that involves a call to the `__getattr__`. Things are functioning normally there.

Here is perhaps the interesting thing. What you implemented actually works and might be the best solution because it gets around this issue by letting Python know that every `Parent` has a `__pow__` method and to call that (first). So we have to emulate the `Parent.__mul__` implementation (which is a slightly different issue dealing with inheritance, but likely suffers from the same complications). I also strongly dislike the workaround there too. So I cannot object to this.



---

archive/issue_comments_513035.json:
```json
{
    "body": "<a id='comment:11'></a>\nThat is subtle. Thank you for investigating this!\n\nSo, should I just repair the doctests and that's it?",
    "created_at": "2021-04-24T08:53:37Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513035",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:11'></a>
That is subtle. Thank you for investigating this!

So, should I just repair the doctests and that's it?



---

archive/issue_comments_513036.json:
```json
{
    "body": "<a id='comment:12'></a>\nUp to the stuff in `free_module.py`, almost. I would include `ZZ^3` as an example somewhere too, along with some (short) explanation about why we do this.",
    "created_at": "2021-04-24T09:10:17Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513036",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>
Up to the stuff in `free_module.py`, almost. I would include `ZZ^3` as an example somewhere too, along with some (short) explanation about why we do this.



---

archive/issue_comments_513037.json:
```json
{
    "body": "<a id='comment:13'></a>\nAs for `free_module.py` I have a different idea. At the current stage, all generic ring methods such as `is_field` are in `ring.pyx`, but not every ring might inherit from this. I suggest to move them to the category. In effect, all `R in _Fields` checks can be replaced by a quicker `R.is_field()` check since the existence of this method is guaranteed. This also avoids cluttering the memory with \u00b4_Fields = Fields()` which is used very often in Sage code.\n\nI'll open another ticket for this soon.",
    "created_at": "2021-04-24T09:17:08Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513037",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:13'></a>
As for `free_module.py` I have a different idea. At the current stage, all generic ring methods such as `is_field` are in `ring.pyx`, but not every ring might inherit from this. I suggest to move them to the category. In effect, all `R in _Fields` checks can be replaced by a quicker `R.is_field()` check since the existence of this method is guaranteed. This also avoids cluttering the memory with ´_Fields = Fields()` which is used very often in Sage code.

I'll open another ticket for this soon.



---

archive/issue_comments_513038.json:
```json
{
    "body": "**Changing commit** from \"[04d282d6a2c2b1b0325119df446e3439d9a9fad4](https://github.com/sagemath/sagetrac-mirror/commit/04d282d6a2c2b1b0325119df446e3439d9a9fad4)\" to \"\".",
    "created_at": "2021-04-24T09:28:18Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513038",
    "user": "https://github.com/mjungmath"
}
```

**Changing commit** from "[04d282d6a2c2b1b0325119df446e3439d9a9fad4](https://github.com/sagemath/sagetrac-mirror/commit/04d282d6a2c2b1b0325119df446e3439d9a9fad4)" to "".



---

archive/issue_comments_513039.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-mjungmath/power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/power_method_for_parents)\" to \"[u/public/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/public/31721_power_method_for_parents)\".",
    "created_at": "2021-04-24T09:28:18Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513039",
    "user": "https://github.com/mjungmath"
}
```

**Changing branch** from "[u/gh-mjungmath/power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/power_method_for_parents)" to "[u/public/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/public/31721_power_method_for_parents)".



---

archive/issue_comments_513040.json:
```json
{
    "body": "**Changing branch** from \"[u/public/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/public/31721_power_method_for_parents)\" to \"[u/gh-mjungmath/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/31721_power_method_for_parents)\".",
    "created_at": "2021-04-24T09:31:42Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513040",
    "user": "https://github.com/mjungmath"
}
```

**Changing branch** from "[u/public/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/public/31721_power_method_for_parents)" to "[u/gh-mjungmath/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/31721_power_method_for_parents)".



---

archive/issue_comments_513041.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-mjungmath/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/31721_power_method_for_parents)\" to \"[public/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/public/31721_power_method_for_parents)\".",
    "created_at": "2021-04-24T09:32:19Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513041",
    "user": "https://github.com/mjungmath"
}
```

**Changing branch** from "[u/gh-mjungmath/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/31721_power_method_for_parents)" to "[public/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/public/31721_power_method_for_parents)".



---

archive/issue_comments_513042.json:
```json
{
    "body": "**Commit:** [f1a90be746908eec59c7a53d5295c992cb09fdda](https://github.com/sagemath/sagetrac-mirror/commit/f1a90be746908eec59c7a53d5295c992cb09fdda)",
    "created_at": "2021-04-24T09:32:36Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513042",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [f1a90be746908eec59c7a53d5295c992cb09fdda](https://github.com/sagemath/sagetrac-mirror/commit/f1a90be746908eec59c7a53d5295c992cb09fdda)



---

archive/issue_comments_513043.json:
```json
{
    "body": "<a id='comment:17'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f1a90be746908eec59c7a53d5295c992cb09fdda\">f1a90be</a></td><td><code>Trac 31721: `__pow__` method for parents + `_pow_` implementation for categories/rings.py</code></td></tr></table>\n",
    "created_at": "2021-04-24T09:32:36Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513043",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f1a90be746908eec59c7a53d5295c992cb09fdda">f1a90be</a></td><td><code>Trac 31721: `__pow__` method for parents + `_pow_` implementation for categories/rings.py</code></td></tr></table>




---

archive/issue_comments_513044.json:
```json
{
    "body": "<a id='comment:18'></a>\nIs that explaination enough or do you prefer more? Moreover, I put a reference to this ticket if someone is interested in more details.",
    "created_at": "2021-04-24T09:33:22Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513044",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:18'></a>
Is that explaination enough or do you prefer more? Moreover, I put a reference to this ticket if someone is interested in more details.



---

archive/issue_comments_513045.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [gh-mjungmath](#comment%3A13):\n> As for `free_module.py` I have a different idea. At the current stage, all generic ring methods such as `is_field` are in `ring.pyx`, but not every ring might inherit from this. I suggest to move them to the category. In effect, all `R in _Fields` checks can be replaced by a quicker `R.is_field()` check since the existence of this method is guaranteed. This also avoids cluttering the memory with \u00b4_Fields = Fields()` which is used very often in Sage code.\n> \n> I'll open another ticket for this soon.\n\n\nSee #31722.",
    "created_at": "2021-04-24T09:39:28Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513045",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:19'></a>
Replying to [gh-mjungmath](#comment%3A13):
> As for `free_module.py` I have a different idea. At the current stage, all generic ring methods such as `is_field` are in `ring.pyx`, but not every ring might inherit from this. I suggest to move them to the category. In effect, all `R in _Fields` checks can be replaced by a quicker `R.is_field()` check since the existence of this method is guaranteed. This also avoids cluttering the memory with ´_Fields = Fields()` which is used very often in Sage code.
> 
> I'll open another ticket for this soon.


See #31722.



---

archive/issue_comments_513046.json:
```json
{
    "body": "**Changing commit** from \"[f1a90be746908eec59c7a53d5295c992cb09fdda](https://github.com/sagemath/sagetrac-mirror/commit/f1a90be746908eec59c7a53d5295c992cb09fdda)\" to \"[adfa6664155aee9a320d1eb05d01ae773013c04d](https://github.com/sagemath/sagetrac-mirror/commit/adfa6664155aee9a320d1eb05d01ae773013c04d)\".",
    "created_at": "2021-04-24T11:28:43Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513046",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[f1a90be746908eec59c7a53d5295c992cb09fdda](https://github.com/sagemath/sagetrac-mirror/commit/f1a90be746908eec59c7a53d5295c992cb09fdda)" to "[adfa6664155aee9a320d1eb05d01ae773013c04d](https://github.com/sagemath/sagetrac-mirror/commit/adfa6664155aee9a320d1eb05d01ae773013c04d)".



---

archive/issue_comments_513047.json:
```json
{
    "body": "<a id='comment:20'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/adfa6664155aee9a320d1eb05d01ae773013c04d\">adfa666</a></td><td><code>Trac #31721: improved documentation</code></td></tr></table>\n",
    "created_at": "2021-04-24T11:28:43Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513047",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/adfa6664155aee9a320d1eb05d01ae773013c04d">adfa666</a></td><td><code>Trac #31721: improved documentation</code></td></tr></table>




---

archive/issue_comments_513048.json:
```json
{
    "body": "<a id='comment:21'></a>\nI don't really like that explanation, as well as the text preceding the `ZZ` example. I would do something like this:\n\n```\n        This is a power method that directly calls another attribute\n        ``_pow_`` (single underscore). This is because extension classes \n        cannot inherit ``__pow__`` from the the parent methods of the\n        category and the redirection via ``__getattr__`` is not called\n        from Python when performing ``**``. Subsequently, ``__pow__``\n        cannot be inherited from the category but ``_pow_`` can.\n        See :trac:`31721`.\n```\n\n```\n        TESTS:\n\n        We check that this works for extension classes::\n\n            sage: ZZ^3\n            Ambient free module of rank 3 over the principal ideal domain\n             Integer Ring\n            sage: isinstance(ZZ, Rings.ParentMethods)  # it is an extension class\n            False\n```",
    "created_at": "2021-04-24T22:25:48Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513048",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:21'></a>
I don't really like that explanation, as well as the text preceding the `ZZ` example. I would do something like this:

```
        This is a power method that directly calls another attribute
        ``_pow_`` (single underscore). This is because extension classes 
        cannot inherit ``__pow__`` from the the parent methods of the
        category and the redirection via ``__getattr__`` is not called
        from Python when performing ``**``. Subsequently, ``__pow__``
        cannot be inherited from the category but ``_pow_`` can.
        See :trac:`31721`.
```

```
        TESTS:

        We check that this works for extension classes::

            sage: ZZ^3
            Ambient free module of rank 3 over the principal ideal domain
             Integer Ring
            sage: isinstance(ZZ, Rings.ParentMethods)  # it is an extension class
            False
```



---

archive/issue_comments_513049.json:
```json
{
    "body": "<a id='comment:22'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f52821d4091611c257bad341337cf87fde2ce126\">f52821d</a></td><td><code>Trac #31721: documentation improved</code></td></tr></table>\n",
    "created_at": "2021-04-25T09:15:05Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513049",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f52821d4091611c257bad341337cf87fde2ce126">f52821d</a></td><td><code>Trac #31721: documentation improved</code></td></tr></table>




---

archive/issue_comments_513050.json:
```json
{
    "body": "**Changing commit** from \"[adfa6664155aee9a320d1eb05d01ae773013c04d](https://github.com/sagemath/sagetrac-mirror/commit/adfa6664155aee9a320d1eb05d01ae773013c04d)\" to \"[f52821d4091611c257bad341337cf87fde2ce126](https://github.com/sagemath/sagetrac-mirror/commit/f52821d4091611c257bad341337cf87fde2ce126)\".",
    "created_at": "2021-04-25T09:15:05Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513050",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[adfa6664155aee9a320d1eb05d01ae773013c04d](https://github.com/sagemath/sagetrac-mirror/commit/adfa6664155aee9a320d1eb05d01ae773013c04d)" to "[f52821d4091611c257bad341337cf87fde2ce126](https://github.com/sagemath/sagetrac-mirror/commit/f52821d4091611c257bad341337cf87fde2ce126)".



---

archive/issue_comments_513051.json:
```json
{
    "body": "<a id='comment:23'></a>\nThank you Travis! Here we go.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f52821d4091611c257bad341337cf87fde2ce126\">f52821d</a></td><td><code>Trac #31721: documentation improved</code></td></tr></table>\n",
    "created_at": "2021-04-25T09:15:19Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513051",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:23'></a>
Thank you Travis! Here we go.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f52821d4091611c257bad341337cf87fde2ce126">f52821d</a></td><td><code>Trac #31721: documentation improved</code></td></tr></table>




---

archive/issue_comments_513052.json:
```json
{
    "body": "**Changing commit** from \"[f52821d4091611c257bad341337cf87fde2ce126](https://github.com/sagemath/sagetrac-mirror/commit/f52821d4091611c257bad341337cf87fde2ce126)\" to \"[5a35e2a19457b5849c2073f5a0483a4f5ea241d8](https://github.com/sagemath/sagetrac-mirror/commit/5a35e2a19457b5849c2073f5a0483a4f5ea241d8)\".",
    "created_at": "2021-04-25T10:55:51Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513052",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[f52821d4091611c257bad341337cf87fde2ce126](https://github.com/sagemath/sagetrac-mirror/commit/f52821d4091611c257bad341337cf87fde2ce126)" to "[5a35e2a19457b5849c2073f5a0483a4f5ea241d8](https://github.com/sagemath/sagetrac-mirror/commit/5a35e2a19457b5849c2073f5a0483a4f5ea241d8)".



---

archive/issue_comments_513053.json:
```json
{
    "body": "<a id='comment:24'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ccb3b1c2fbb5691d0336b58e5398471831b21f37\">ccb3b1c</a></td><td><code>Trac #31721: turn is_field and is_integral_domain into cpdef functions (completely doctested)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5a35e2a19457b5849c2073f5a0483a4f5ea241d8\">5a35e2a</a></td><td><code>Trac #31721: add is_field and is_integral_domain to category of rings (tests on magmas fail)</code></td></tr></table>\n",
    "created_at": "2021-04-25T10:55:51Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513053",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ccb3b1c2fbb5691d0336b58e5398471831b21f37">ccb3b1c</a></td><td><code>Trac #31721: turn is_field and is_integral_domain into cpdef functions (completely doctested)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5a35e2a19457b5849c2073f5a0483a4f5ea241d8">5a35e2a</a></td><td><code>Trac #31721: add is_field and is_integral_domain to category of rings (tests on magmas fail)</code></td></tr></table>




---

archive/issue_comments_513054.json:
```json
{
    "body": "<a id='comment:25'></a>\nSorry, wrong ticket number...",
    "created_at": "2021-04-25T10:56:37Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513054",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:25'></a>
Sorry, wrong ticket number...



---

archive/issue_comments_513055.json:
```json
{
    "body": "<a id='comment:26'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/06b3ec28a1e3b055a0788c2001ae1b6ee6007f3b\">06b3ec2</a></td><td><code>Trac 31721: `__pow__` method for parents + `_pow_` implementation for categories/rings.py</code></td></tr></table>\n",
    "created_at": "2021-04-25T11:00:35Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513055",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/06b3ec28a1e3b055a0788c2001ae1b6ee6007f3b">06b3ec2</a></td><td><code>Trac 31721: `__pow__` method for parents + `_pow_` implementation for categories/rings.py</code></td></tr></table>




---

archive/issue_comments_513056.json:
```json
{
    "body": "**Changing commit** from \"[5a35e2a19457b5849c2073f5a0483a4f5ea241d8](https://github.com/sagemath/sagetrac-mirror/commit/5a35e2a19457b5849c2073f5a0483a4f5ea241d8)\" to \"[06b3ec28a1e3b055a0788c2001ae1b6ee6007f3b](https://github.com/sagemath/sagetrac-mirror/commit/06b3ec28a1e3b055a0788c2001ae1b6ee6007f3b)\".",
    "created_at": "2021-04-25T11:00:35Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513056",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[5a35e2a19457b5849c2073f5a0483a4f5ea241d8](https://github.com/sagemath/sagetrac-mirror/commit/5a35e2a19457b5849c2073f5a0483a4f5ea241d8)" to "[06b3ec28a1e3b055a0788c2001ae1b6ee6007f3b](https://github.com/sagemath/sagetrac-mirror/commit/06b3ec28a1e3b055a0788c2001ae1b6ee6007f3b)".



---

archive/issue_comments_513057.json:
```json
{
    "body": "<a id='comment:27'></a>\nWhy `if isinstance(self, Parent)` is inside the `try/except` block?",
    "created_at": "2021-04-25T15:44:13Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513057",
    "user": "https://github.com/videlec"
}
```

<a id='comment:27'></a>
Why `if isinstance(self, Parent)` is inside the `try/except` block?



---

archive/issue_comments_513058.json:
```json
{
    "body": "<a id='comment:28'></a>\nWouldn't it be possible to call `__pow__` from the category by providing the following default implementation in `Parent`\n\n```\ndef __pow__(self, x, mod):\n    return self.getattr_from_category('__pow__')(x, mod)\n```",
    "created_at": "2021-04-25T15:55:26Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513058",
    "user": "https://github.com/videlec"
}
```

<a id='comment:28'></a>
Wouldn't it be possible to call `__pow__` from the category by providing the following default implementation in `Parent`

```
def __pow__(self, x, mod):
    return self.getattr_from_category('__pow__')(x, mod)
```



---

archive/issue_comments_513059.json:
```json
{
    "body": "<a id='comment:29'></a>\nConcrete implementation with `__pow__` in `public/31721_double_underscore` (a bit more subtle than [comment:28]).",
    "created_at": "2021-04-25T17:20:03Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513059",
    "user": "https://github.com/videlec"
}
```

<a id='comment:29'></a>
Concrete implementation with `__pow__` in `public/31721_double_underscore` (a bit more subtle than [comment:28]).



---

archive/issue_events_284876.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-04-25T17:33:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-284876"
}
```



---

archive/issue_events_284877.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-04-25T17:33:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-284877"
}
```



---

archive/issue_comments_513060.json:
```json
{
    "body": "**Changing commit** from \"[06b3ec28a1e3b055a0788c2001ae1b6ee6007f3b](https://github.com/sagemath/sagetrac-mirror/commit/06b3ec28a1e3b055a0788c2001ae1b6ee6007f3b)\" to \"[93c1628ee9bc710f8388e7dae5ffe5c561052473](https://github.com/sagemath/sagetrac-mirror/commit/93c1628ee9bc710f8388e7dae5ffe5c561052473)\".",
    "created_at": "2021-04-25T18:26:08Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513060",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[06b3ec28a1e3b055a0788c2001ae1b6ee6007f3b](https://github.com/sagemath/sagetrac-mirror/commit/06b3ec28a1e3b055a0788c2001ae1b6ee6007f3b)" to "[93c1628ee9bc710f8388e7dae5ffe5c561052473](https://github.com/sagemath/sagetrac-mirror/commit/93c1628ee9bc710f8388e7dae5ffe5c561052473)".



---

archive/issue_comments_513061.json:
```json
{
    "body": "<a id='comment:31'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/93c1628ee9bc710f8388e7dae5ffe5c561052473\">93c1628</a></td><td><code>Trac 31721: `__pow__` method for parents + `_pow_` implementation for categories/rings.py</code></td></tr></table>\n",
    "created_at": "2021-04-25T18:26:08Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513061",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/93c1628ee9bc710f8388e7dae5ffe5c561052473">93c1628</a></td><td><code>Trac 31721: `__pow__` method for parents + `_pow_` implementation for categories/rings.py</code></td></tr></table>




---

archive/issue_comments_513062.json:
```json
{
    "body": "<a id='comment:32'></a>\nSorry, the changes of `is_field` are not supposed to be there. That was for #31722. I accidentally merged them.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/93c1628ee9bc710f8388e7dae5ffe5c561052473\">93c1628</a></td><td><code>Trac 31721: `__pow__` method for parents + `_pow_` implementation for categories/rings.py</code></td></tr></table>\n",
    "created_at": "2021-04-25T18:26:57Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513062",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:32'></a>
Sorry, the changes of `is_field` are not supposed to be there. That was for #31722. I accidentally merged them.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/93c1628ee9bc710f8388e7dae5ffe5c561052473">93c1628</a></td><td><code>Trac 31721: `__pow__` method for parents + `_pow_` implementation for categories/rings.py</code></td></tr></table>




---

archive/issue_comments_513063.json:
```json
{
    "body": "<a id='comment:33'></a>\nWe could use `getattr_from_category`, although I think that is slower than calling `_pow_` (but I haven't tested it). Now, it is quite likely that this doesn't need to be so optimized (unlike perhaps `__mul__`). It definitely would make the code more natural. So that would be a better IMO.",
    "created_at": "2021-04-25T23:50:08Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513063",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:33'></a>
We could use `getattr_from_category`, although I think that is slower than calling `_pow_` (but I haven't tested it). Now, it is quite likely that this doesn't need to be so optimized (unlike perhaps `__mul__`). It definitely would make the code more natural. So that would be a better IMO.



---

archive/issue_comments_513064.json:
```json
{
    "body": "**Changing commit** from \"[93c1628ee9bc710f8388e7dae5ffe5c561052473](https://github.com/sagemath/sagetrac-mirror/commit/93c1628ee9bc710f8388e7dae5ffe5c561052473)\" to \"[fa5057ce25fcc2d7dc6e7d22a9881470f341fe7a](https://github.com/sagemath/sagetrac-mirror/commit/fa5057ce25fcc2d7dc6e7d22a9881470f341fe7a)\".",
    "created_at": "2021-04-27T07:42:19Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513064",
    "user": "https://github.com/videlec"
}
```

**Changing commit** from "[93c1628ee9bc710f8388e7dae5ffe5c561052473](https://github.com/sagemath/sagetrac-mirror/commit/93c1628ee9bc710f8388e7dae5ffe5c561052473)" to "[fa5057ce25fcc2d7dc6e7d22a9881470f341fe7a](https://github.com/sagemath/sagetrac-mirror/commit/fa5057ce25fcc2d7dc6e7d22a9881470f341fe7a)".



---

archive/issue_events_284878.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-04-27T07:42:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-284878"
}
```



---

archive/issue_events_284879.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-04-27T07:42:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-284879"
}
```



---

archive/issue_comments_513065.json:
```json
{
    "body": "<a id='comment:34'></a>\nPlease have a look\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fa5057ce25fcc2d7dc6e7d22a9881470f341fe7a\">fa5057c</a></td><td><code>Trac 31721: `__pow__` method for parents</code></td></tr></table>\n",
    "created_at": "2021-04-27T07:42:19Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513065",
    "user": "https://github.com/videlec"
}
```

<a id='comment:34'></a>
Please have a look

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fa5057ce25fcc2d7dc6e7d22a9881470f341fe7a">fa5057c</a></td><td><code>Trac 31721: `__pow__` method for parents</code></td></tr></table>




---

archive/issue_comments_513066.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1 @@\n-We equip `structure/parent.pyx` with a method `__pow__` which delegates to a concrete implementation `_pow_`, for example in the corresponding category.\n-\n-Moreover, we move the `__pow__` in `rings/ring.pyx` to the category file `categories/rings.py` so that any ring can benefit from it and not only those which inherit from `rings/ring.pyx`.\n+We equip `structure/parent.pyx` with a method `__pow__` which possibly delegates to the corresponding category. Moreover, we move the `__pow__` in `rings/ring.pyx` to the category file `categories/rings.py` so that any ring can benefit from it and not only those which inherit from `rings/ring.pyx`.\n``````\n",
    "created_at": "2021-04-27T07:42:19Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513066",
    "user": "https://github.com/videlec"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1 @@
-We equip `structure/parent.pyx` with a method `__pow__` which delegates to a concrete implementation `_pow_`, for example in the corresponding category.
-
-Moreover, we move the `__pow__` in `rings/ring.pyx` to the category file `categories/rings.py` so that any ring can benefit from it and not only those which inherit from `rings/ring.pyx`.
+We equip `structure/parent.pyx` with a method `__pow__` which possibly delegates to the corresponding category. Moreover, we move the `__pow__` in `rings/ring.pyx` to the category file `categories/rings.py` so that any ring can benefit from it and not only those which inherit from `rings/ring.pyx`.
``````




---

archive/issue_comments_513067.json:
```json
{
    "body": "**Changing branch** from \"[public/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/public/31721_power_method_for_parents)\" to \"[public/31721_double_underscore](https://github.com/sagemath/sagetrac-mirror/tree/public/31721_double_underscore)\".",
    "created_at": "2021-04-27T07:42:19Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513067",
    "user": "https://github.com/videlec"
}
```

**Changing branch** from "[public/31721_power_method_for_parents](https://github.com/sagemath/sagetrac-mirror/tree/public/31721_power_method_for_parents)" to "[public/31721_double_underscore](https://github.com/sagemath/sagetrac-mirror/tree/public/31721_double_underscore)".



---

archive/issue_comments_513068.json:
```json
{
    "body": "**Changing author** from \"Michael Jung\" to \"Michael Jung, Vincent Delecroix\".",
    "created_at": "2021-04-27T07:42:19Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513068",
    "user": "https://github.com/videlec"
}
```

**Changing author** from "Michael Jung" to "Michael Jung, Vincent Delecroix".



---

archive/issue_comments_513069.json:
```json
{
    "body": "<a id='comment:35'></a>\nWhat exactly is the purpose of that line?\n\n```diff\n        try:\n+            meth = super(Parent, (<Parent> self)).__pow__\n        except AttributeError:\n```",
    "created_at": "2021-04-27T08:53:42Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513069",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:35'></a>
What exactly is the purpose of that line?

```diff
        try:
+            meth = super(Parent, (<Parent> self)).__pow__
        except AttributeError:
```



---

archive/issue_comments_513070.json:
```json
{
    "body": "<a id='comment:36'></a>\nIn the case the parent is a Python class, you get the `__pow__` from the category this way.\n\n```\nsage: class MyParent(Parent):\n....:     def __init__(self):\n....:         Parent.__init__(self, category=CommutativeRings())\nsage: M = MyParent()\nsage: super(Parent, M).__pow__\n<bound method Rings.ParentMethods.__pow__ of <__main__.MyParent_with_category object at 0x7f1930f0e4f0>>\n```",
    "created_at": "2021-04-27T08:59:57Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513070",
    "user": "https://github.com/videlec"
}
```

<a id='comment:36'></a>
In the case the parent is a Python class, you get the `__pow__` from the category this way.

```
sage: class MyParent(Parent):
....:     def __init__(self):
....:         Parent.__init__(self, category=CommutativeRings())
sage: M = MyParent()
sage: super(Parent, M).__pow__
<bound method Rings.ParentMethods.__pow__ of <__main__.MyParent_with_category object at 0x7f1930f0e4f0>>
```



---

archive/issue_comments_513071.json:
```json
{
    "body": "<a id='comment:37'></a>\nLet me add a comment in the code.",
    "created_at": "2021-04-27T09:00:28Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513071",
    "user": "https://github.com/videlec"
}
```

<a id='comment:37'></a>
Let me add a comment in the code.



---

archive/issue_comments_513072.json:
```json
{
    "body": "**Changing commit** from \"[fa5057ce25fcc2d7dc6e7d22a9881470f341fe7a](https://github.com/sagemath/sagetrac-mirror/commit/fa5057ce25fcc2d7dc6e7d22a9881470f341fe7a)\" to \"[27422d323a7db31f3fc2068f6aeb3100b3e4d6ae](https://github.com/sagemath/sagetrac-mirror/commit/27422d323a7db31f3fc2068f6aeb3100b3e4d6ae)\".",
    "created_at": "2021-04-27T09:03:37Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513072",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[fa5057ce25fcc2d7dc6e7d22a9881470f341fe7a](https://github.com/sagemath/sagetrac-mirror/commit/fa5057ce25fcc2d7dc6e7d22a9881470f341fe7a)" to "[27422d323a7db31f3fc2068f6aeb3100b3e4d6ae](https://github.com/sagemath/sagetrac-mirror/commit/27422d323a7db31f3fc2068f6aeb3100b3e4d6ae)".



---

archive/issue_comments_513073.json:
```json
{
    "body": "<a id='comment:38'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/27422d323a7db31f3fc2068f6aeb3100b3e4d6ae\">27422d3</a></td><td><code>31721: more comments</code></td></tr></table>\n",
    "created_at": "2021-04-27T09:03:37Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513073",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/27422d323a7db31f3fc2068f6aeb3100b3e4d6ae">27422d3</a></td><td><code>31721: more comments</code></td></tr></table>




---

archive/issue_comments_513074.json:
```json
{
    "body": "<a id='comment:39'></a>\nBut\n\n```diff\n+                meth = (<Parent> self).getattr_from_category('__pow__')\n```\n\nworks in any case, no? Is \n\n```diff\n+            meth = super(Parent, (<Parent> self)).__pow__\n```\n\nsomewhat faster in the Python case?",
    "created_at": "2021-04-27T09:11:41Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513074",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:39'></a>
But

```diff
+                meth = (<Parent> self).getattr_from_category('__pow__')
```

works in any case, no? Is 

```diff
+            meth = super(Parent, (<Parent> self)).__pow__
```

somewhat faster in the Python case?



---

archive/issue_comments_513075.json:
```json
{
    "body": "<a id='comment:40'></a>\nFor the following reason (I am adding a doctest)\n\n```\nsage: class A:\n....:    def __pow__(self, n):\n....:        return 'Apow'\nsage: class MyParent(A, Parent):\n....:    pass\nsage: MyParent()^2\n'Apow'\n```",
    "created_at": "2021-04-27T10:46:09Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513075",
    "user": "https://github.com/videlec"
}
```

<a id='comment:40'></a>
For the following reason (I am adding a doctest)

```
sage: class A:
....:    def __pow__(self, n):
....:        return 'Apow'
sage: class MyParent(A, Parent):
....:    pass
sage: MyParent()^2
'Apow'
```



---

archive/issue_comments_513076.json:
```json
{
    "body": "<a id='comment:41'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e8d34270e0b74d33776f958360a0cdad60a0b74c\">e8d3427</a></td><td><code>clarify comment and doctest for multiple inheritance</code></td></tr></table>\n",
    "created_at": "2021-04-27T10:50:08Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513076",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e8d34270e0b74d33776f958360a0cdad60a0b74c">e8d3427</a></td><td><code>clarify comment and doctest for multiple inheritance</code></td></tr></table>




---

archive/issue_comments_513077.json:
```json
{
    "body": "**Changing commit** from \"[27422d323a7db31f3fc2068f6aeb3100b3e4d6ae](https://github.com/sagemath/sagetrac-mirror/commit/27422d323a7db31f3fc2068f6aeb3100b3e4d6ae)\" to \"[e8d34270e0b74d33776f958360a0cdad60a0b74c](https://github.com/sagemath/sagetrac-mirror/commit/e8d34270e0b74d33776f958360a0cdad60a0b74c)\".",
    "created_at": "2021-04-27T10:50:08Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513077",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[27422d323a7db31f3fc2068f6aeb3100b3e4d6ae](https://github.com/sagemath/sagetrac-mirror/commit/27422d323a7db31f3fc2068f6aeb3100b3e4d6ae)" to "[e8d34270e0b74d33776f958360a0cdad60a0b74c](https://github.com/sagemath/sagetrac-mirror/commit/e8d34270e0b74d33776f958360a0cdad60a0b74c)".



---

archive/issue_comments_513078.json:
```json
{
    "body": "<a id='comment:42'></a>\nWhen the parent is a Python class and the category does not define a `__pow__` then we catch two `AttributeError` in `Parent.__pow__`.",
    "created_at": "2021-04-27T10:51:36Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513078",
    "user": "https://github.com/videlec"
}
```

<a id='comment:42'></a>
When the parent is a Python class and the category does not define a `__pow__` then we catch two `AttributeError` in `Parent.__pow__`.



---

archive/issue_comments_513079.json:
```json
{
    "body": "<a id='comment:43'></a>\nOh right, multiple inheritances. I just lost that out of sight. Perfect, thanks!",
    "created_at": "2021-04-27T11:01:06Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513079",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:43'></a>
Oh right, multiple inheritances. I just lost that out of sight. Perfect, thanks!



---

archive/issue_comments_513080.json:
```json
{
    "body": "<a id='comment:44'></a>\nI agree, this looks more natural. Travis, any comments? Otherwise I would give it a positive review when patchbot is giving us his blessing.\n\nWhat about `__mul__` by the way? Shouldn't that be changed accordingly? Not in this ticket of course, but perhaps in a follow-up?",
    "created_at": "2021-04-27T11:06:32Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513080",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:44'></a>
I agree, this looks more natural. Travis, any comments? Otherwise I would give it a positive review when patchbot is giving us his blessing.

What about `__mul__` by the way? Shouldn't that be changed accordingly? Not in this ticket of course, but perhaps in a follow-up?



---

archive/issue_comments_513081.json:
```json
{
    "body": "<a id='comment:45'></a>\nAfter this ticket, all rings have `__pow__`, but the construction is broken\n\n```\nsage: ZZ.cartesian_product(ZZ)^3\nTraceback (most recent call last):\n...\nAttributeError: 'CartesianProduct_with_category' object has no attribute 'is_field'\n```\nThis will hopefully be fixed after #31722.",
    "created_at": "2021-04-27T20:02:50Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513081",
    "user": "https://github.com/videlec"
}
```

<a id='comment:45'></a>
After this ticket, all rings have `__pow__`, but the construction is broken

```
sage: ZZ.cartesian_product(ZZ)^3
Traceback (most recent call last):
...
AttributeError: 'CartesianProduct_with_category' object has no attribute 'is_field'
```
This will hopefully be fixed after #31722.



---

archive/issue_comments_513082.json:
```json
{
    "body": "<a id='comment:46'></a>\nConcerning `__mul__`, I don't have any opinion.",
    "created_at": "2021-04-27T20:03:16Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513082",
    "user": "https://github.com/videlec"
}
```

<a id='comment:46'></a>
Concerning `__mul__`, I don't have any opinion.



---

archive/issue_comments_513083.json:
```json
{
    "body": "<a id='comment:47'></a>\nReplying to [vdelecroix](#comment%3A45):\n> After this ticket, all rings have `__pow__`, but the construction is broken\n> \n> ```\n> sage: ZZ.cartesian_product(ZZ)^3\n> Traceback (most recent call last):\n> ...\n> AttributeError: 'CartesianProduct_with_category' object has no attribute 'is_field'\n> ```\n> This will hopefully be fixed after #31722.\n\n\nYeah, this is really annoying. Happens all over the place in Sage.\n\n---\n\nAs for the ticket, LGTM.",
    "created_at": "2021-04-28T00:14:55Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513083",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:47'></a>
Replying to [vdelecroix](#comment%3A45):
> After this ticket, all rings have `__pow__`, but the construction is broken
> 
> ```
> sage: ZZ.cartesian_product(ZZ)^3
> Traceback (most recent call last):
> ...
> AttributeError: 'CartesianProduct_with_category' object has no attribute 'is_field'
> ```
> This will hopefully be fixed after #31722.


Yeah, this is really annoying. Happens all over the place in Sage.

---

As for the ticket, LGTM.



---

archive/issue_comments_513084.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw, Michael Jung, Vincent Delecroix",
    "created_at": "2021-04-28T00:14:55Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513084",
    "user": "https://github.com/mjungmath"
}
```

**Reviewer:** Travis Scrimshaw, Michael Jung, Vincent Delecroix



---

archive/issue_events_284880.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-04-28T00:14:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-284880"
}
```



---

archive/issue_events_284881.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-04-28T00:14:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-284881"
}
```



---

archive/issue_comments_513085.json:
```json
{
    "body": "<a id='comment:48'></a>\nI would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.\n\nI also wonder if this would be better put in `CategoryObject` instead of `Parent`. However, that might cause slowdowns with elements, thus we'd need to be a lot more careful with testing. This at least is a clear improvement. Hence, that can be done on a followup and considered at the same time as `__mul__`, which might have other considerations as well.",
    "created_at": "2021-04-28T02:39:48Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513085",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:48'></a>
I would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.

I also wonder if this would be better put in `CategoryObject` instead of `Parent`. However, that might cause slowdowns with elements, thus we'd need to be a lot more careful with testing. This at least is a clear improvement. Hence, that can be done on a followup and considered at the same time as `__mul__`, which might have other considerations as well.



---

archive/issue_comments_513086.json:
```json
{
    "body": "<a id='comment:49'></a>\nReplying to [tscrim](#comment%3A48):\n> I would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.\n\n\nDefinitely true.\n\n> I also wonder if this would be better put in `CategoryObject` instead of `Parent`. However, that might cause slowdowns with elements, thus we'd need to be a lot more careful with testing. This at least is a clear improvement. Hence, that can be done on a followup and considered at the same time as `__mul__`, which might have other considerations as well.\n\n\nThat is a good suggestion. Since `Element` has its own `__pow__` I don't think there would be any slowdown.",
    "created_at": "2021-04-28T06:24:54Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513086",
    "user": "https://github.com/videlec"
}
```

<a id='comment:49'></a>
Replying to [tscrim](#comment%3A48):
> I would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.


Definitely true.

> I also wonder if this would be better put in `CategoryObject` instead of `Parent`. However, that might cause slowdowns with elements, thus we'd need to be a lot more careful with testing. This at least is a clear improvement. Hence, that can be done on a followup and considered at the same time as `__mul__`, which might have other considerations as well.


That is a good suggestion. Since `Element` has its own `__pow__` I don't think there would be any slowdown.



---

archive/issue_comments_513087.json:
```json
{
    "body": "<a id='comment:50'></a>\nReplying to [vdelecroix](#comment%3A49):\n> That is a good suggestion. Since `Element` has its own `__pow__` I don't think there would be any slowdown.\n\n\nThat's indeed something for another ticket. Who opens it?\n\nReplying to [tscrim](#comment%3A48):\n>I would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.\n\n\nFor example? It's already more than in my first draft.",
    "created_at": "2021-04-28T07:10:42Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513087",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:50'></a>
Replying to [vdelecroix](#comment%3A49):
> That is a good suggestion. Since `Element` has its own `__pow__` I don't think there would be any slowdown.


That's indeed something for another ticket. Who opens it?

Replying to [tscrim](#comment%3A48):
>I would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.


For example? It's already more than in my first draft.



---

archive/issue_comments_513088.json:
```json
{
    "body": "<a id='comment:51'></a>\nReplying to [gh-mjungmath](#comment%3A50):\n> Replying to [vdelecroix](#comment%3A49):\n> > That is a good suggestion. Since `Element` has its own `__pow__` I don't think there would be any slowdown.\n\n> \n> That's indeed something for another ticket. Who opens it?\n\n\n#31746\n\n> Replying to [tscrim](#comment%3A48):\n> >I would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.\n\n> \n> For example? It's already more than in my first draft.\n\n\nI added that as a task for #31746 too.",
    "created_at": "2021-04-28T07:26:52Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513088",
    "user": "https://github.com/videlec"
}
```

<a id='comment:51'></a>
Replying to [gh-mjungmath](#comment%3A50):
> Replying to [vdelecroix](#comment%3A49):
> > That is a good suggestion. Since `Element` has its own `__pow__` I don't think there would be any slowdown.

> 
> That's indeed something for another ticket. Who opens it?


#31746

> Replying to [tscrim](#comment%3A48):
> >I would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.

> 
> For example? It's already more than in my first draft.


I added that as a task for #31746 too.



---

archive/issue_comments_513089.json:
```json
{
    "body": "<a id='comment:52'></a>\nReplying to [gh-mjungmath](#comment%3A50):\n> Replying to [tscrim](#comment%3A48):\n> >I would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.\n\n> \n> For example? It's already more than in my first draft.\n\n\nThat doesn't necessarily mean it is sufficient. Perhaps something like:\n\n```\nRedirect ``__pow__`` either from the MRO or from the category. This\nimplementation is so extension classes will call the method from\nthe appropriate category.\n```\nThat way it at least gives some reason for why this implementation exists.",
    "created_at": "2021-04-29T05:28:48Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513089",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:52'></a>
Replying to [gh-mjungmath](#comment%3A50):
> Replying to [tscrim](#comment%3A48):
> >I would had preferred the `Parent.__pow__` method to have a little bit more in its docstring about what it does since its implementation is a little terse IMO, even with the comments.

> 
> For example? It's already more than in my first draft.


That doesn't necessarily mean it is sufficient. Perhaps something like:

```
Redirect ``__pow__`` either from the MRO or from the category. This
implementation is so extension classes will call the method from
the appropriate category.
```
That way it at least gives some reason for why this implementation exists.



---

archive/issue_comments_513090.json:
```json
{
    "body": "**Changing commit** from \"[e8d34270e0b74d33776f958360a0cdad60a0b74c](https://github.com/sagemath/sagetrac-mirror/commit/e8d34270e0b74d33776f958360a0cdad60a0b74c)\" to \"[b873bcbe33571dc020c08b05c0390777148b1b53](https://github.com/sagemath/sagetrac-mirror/commit/b873bcbe33571dc020c08b05c0390777148b1b53)\".",
    "created_at": "2021-04-29T07:08:40Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513090",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e8d34270e0b74d33776f958360a0cdad60a0b74c](https://github.com/sagemath/sagetrac-mirror/commit/e8d34270e0b74d33776f958360a0cdad60a0b74c)" to "[b873bcbe33571dc020c08b05c0390777148b1b53](https://github.com/sagemath/sagetrac-mirror/commit/b873bcbe33571dc020c08b05c0390777148b1b53)".



---

archive/issue_comments_513091.json:
```json
{
    "body": "<a id='comment:53'></a>\n**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b873bcbe33571dc020c08b05c0390777148b1b53\">b873bcb</a></td><td><code>some doc</code></td></tr></table>\n",
    "created_at": "2021-04-29T07:08:40Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513091",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:53'></a>
**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b873bcbe33571dc020c08b05c0390777148b1b53">b873bcb</a></td><td><code>some doc</code></td></tr></table>




---

archive/issue_events_284882.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2021-04-29T07:08:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-284882"
}
```



---

archive/issue_events_284883.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2021-04-29T07:08:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-284883"
}
```



---

archive/issue_comments_513092.json:
```json
{
    "body": "<a id='comment:54'></a>\nThank you.",
    "created_at": "2021-04-30T00:43:02Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513092",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:54'></a>
Thank you.



---

archive/issue_events_284884.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-04-30T00:43:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-284884"
}
```



---

archive/issue_events_284885.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-04-30T00:43:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-284885"
}
```



---

archive/issue_events_284886.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-06-19T20:58:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-284886"
}
```



---

archive/issue_events_284887.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "afae1ae23be188324ee3e465b26bb82c494e3956",
    "created_at": "2021-06-19T20:58:06Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31721#event-284887"
}
```



---

archive/issue_comments_513093.json:
```json
{
    "body": "**Changing branch** from \"[public/31721_double_underscore](https://github.com/sagemath/sagetrac-mirror/tree/public/31721_double_underscore)\" to \"[b873bcbe33571dc020c08b05c0390777148b1b53](https://github.com/sagemath/sagetrac-mirror/commit/b873bcbe33571dc020c08b05c0390777148b1b53)\".",
    "created_at": "2021-06-19T20:58:06Z",
    "issue": "https://github.com/sagemath/sage/issues/31721",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31721#issuecomment-513093",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/31721_double_underscore](https://github.com/sagemath/sagetrac-mirror/tree/public/31721_double_underscore)" to "[b873bcbe33571dc020c08b05c0390777148b1b53](https://github.com/sagemath/sagetrac-mirror/commit/b873bcbe33571dc020c08b05c0390777148b1b53)".
