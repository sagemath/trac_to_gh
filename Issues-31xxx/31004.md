# Issue 31004: src/tox.ini: Rename pycodestyle to pycodestyle-minimal, add full pycodestyle as recommendation

archive/issues_030767.json:
```json
{
    "body": "The current pycodestyle configuration only covers a few rules that are also enforced by the patchbot. While this is a good starting point, IDEs pick up this configuration and only show warnings for these rules. In order to make sage's code adhere more to the pep8 recommendations, it is desirable to get warnings for all code style errors. Thus, in this ticket, we enable all pycodestyle warnings. These can be tested as usually by calling `pycodestyle` or `tox -e pycodestyle`. Moreover, the current minimal ruleset is tested via the new environment `tox -e pycodestyle-minimal`, which is also used in the new lint github action workflow.\n\nCC:  @mkoeppe @jplab @fchapoton\n\nBranch/Commit: a0d9b590b243182a7e461f8b01f9a10707546257\n\nReviewer: Matthias Koeppe, Tobias Diez\n\nAuthor: Tobias Diez, Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/31004\n\n",
    "closed_at": "2021-01-17T13:46:02Z",
    "created_at": "2020-12-04T12:19:51Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "src/tox.ini: Rename pycodestyle to pycodestyle-minimal, add full pycodestyle as recommendation",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31004",
    "user": "https://github.com/tobiasdiez"
}
```
The current pycodestyle configuration only covers a few rules that are also enforced by the patchbot. While this is a good starting point, IDEs pick up this configuration and only show warnings for these rules. In order to make sage's code adhere more to the pep8 recommendations, it is desirable to get warnings for all code style errors. Thus, in this ticket, we enable all pycodestyle warnings. These can be tested as usually by calling `pycodestyle` or `tox -e pycodestyle`. Moreover, the current minimal ruleset is tested via the new environment `tox -e pycodestyle-minimal`, which is also used in the new lint github action workflow.

CC:  @mkoeppe @jplab @fchapoton

Branch/Commit: a0d9b590b243182a7e461f8b01f9a10707546257

Reviewer: Matthias Koeppe, Tobias Diez

Author: Tobias Diez, Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/31004





---

archive/issue_comments_469196.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-12-04T12:20:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469196",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_469197.json:
```json
{
    "body": "<a id='comment:2'></a>This is a good idea. Two points:\n\n1) I think using `pycodestyle-minimal` would be more tox-ic (tox factor conditions)\n\n\n2) I think `envlist` at the top should do `pycodestyle-minimal`, not `pycodestyle`. This affects the default when `-e` is not used.",
    "created_at": "2020-12-04T18:06:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469197",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>This is a good idea. Two points:

1) I think using `pycodestyle-minimal` would be more tox-ic (tox factor conditions)


2) I think `envlist` at the top should do `pycodestyle-minimal`, not `pycodestyle`. This affects the default when `-e` is not used.



---

archive/issue_comments_469198.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2020-12-04T18:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469198",
    "user": "https://github.com/mkoeppe"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_469199.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-05T11:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469199",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_469200.json:
```json
{
    "body": "<a id='comment:6'></a>Thanks for the review! I've now implemented your suggestions.",
    "created_at": "2020-12-05T11:36:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469200",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:6'></a>Thanks for the review! I've now implemented your suggestions.



---

archive/issue_comments_469201.json:
```json
{
    "body": "<a id='comment:7'></a>In `lint.yml`, I think you don't need to install `relint` or `pycodestyle` because tox will take care of that in its virtual environment",
    "created_at": "2020-12-05T17:55:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469201",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>In `lint.yml`, I think you don't need to install `relint` or `pycodestyle` because tox will take care of that in its virtual environment



---

archive/issue_comments_469202.json:
```json
{
    "body": "<a id='comment:8'></a>Also, the help message shown by `sage -advanced` needs some cosmetic adjustments because the longest environment name is longer now",
    "created_at": "2020-12-05T17:58:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469202",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>Also, the help message shown by `sage -advanced` needs some cosmetic adjustments because the longest environment name is longer now



---

archive/issue_comments_469203.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-12-06T00:11:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469203",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_469204.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:7 mkoeppe]:\n> In `lint.yml`, I think you don't need to install `relint` or `pycodestyle` because tox will take care of that in its virtual environment\n\n\nYou are probably right, but that's not really related to this ticket.",
    "created_at": "2020-12-07T21:20:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469204",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:10'></a>Replying to [comment:7 mkoeppe]:
> In `lint.yml`, I think you don't need to install `relint` or `pycodestyle` because tox will take care of that in its virtual environment


You are probably right, but that's not really related to this ticket.



---

archive/issue_comments_469205.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:8 mkoeppe]:\n> Also, the help message shown by `sage -advanced` needs some cosmetic adjustments because the longest environment name is longer now\n\n\nI'm not sure what you mean, but `sage -advanced` doesn't show any tox-related infos for me (but the indent for example ecl is off). Maybe it's because I also get the following error when running `sage`:\n\n```\n/mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 3: __requires__: command not found\n/mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: syntax error near unexpected token `'pkg_resources''\n/mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: `__import__('pkg_resources').require('sage==9.3b2')'\n```",
    "created_at": "2020-12-07T21:27:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469205",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:11'></a>Replying to [comment:8 mkoeppe]:
> Also, the help message shown by `sage -advanced` needs some cosmetic adjustments because the longest environment name is longer now


I'm not sure what you mean, but `sage -advanced` doesn't show any tox-related infos for me (but the indent for example ecl is off). Maybe it's because I also get the following error when running `sage`:

```
/mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 3: __requires__: command not found
/mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: syntax error near unexpected token `'pkg_resources''
/mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: `__import__('pkg_resources').require('sage==9.3b2')'
```



---

archive/issue_comments_469206.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-12-07T21:27:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469206",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_469207.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:11 gh-tobiasdiez]:\n> I also get the following error when running `sage`:\n> \n> ```\n> /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 3: __requires__: command not found\n> /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: syntax error near unexpected token `'pkg_resources''\n> /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: `__import__('pkg_resources').require('sage==9.3b2')'\n> ```\n\n\nThis is an interesting error - something seems to be rewriting this shell scripts as if it is a Python script - perhaps the newest version of pip?",
    "created_at": "2020-12-07T22:59:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469207",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>Replying to [comment:11 gh-tobiasdiez]:
> I also get the following error when running `sage`:
> 
> ```
> /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 3: __requires__: command not found
> /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: syntax error near unexpected token `'pkg_resources''
> /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: `__import__('pkg_resources').require('sage==9.3b2')'
> ```


This is an interesting error - something seems to be rewriting this shell scripts as if it is a Python script - perhaps the newest version of pip?



---

archive/issue_comments_469208.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-07T23:24:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469208",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_469209.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:8 mkoeppe]:\n> Also, the help message shown by `sage -advanced` needs some cosmetic adjustments because the longest environment name is longer now\n\nDone",
    "created_at": "2020-12-07T23:24:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469209",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>Replying to [comment:8 mkoeppe]:
> Also, the help message shown by `sage -advanced` needs some cosmetic adjustments because the longest environment name is longer now

Done



---

archive/issue_comments_469210.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-The current pycodestyle configuration only covers a few rules that are also enforced by the patchbot. While this is a good starting point, IDEs pick up this configuration and only show warnings for these rules. In order to make sage's code adhere more to the pep8 recommendations, it is desirable to get warnings for all code style errors. Thus, in this ticket, we enable all pycodestyle warnings. These can be tested as usually by calling \\`pycodestyle\\` or \\`tox -e pycodestyle\\`. Moreover, the current minimal ruleset is tested via the new environment \\`tox -e pycodestyle_minimal\\`, which is also used in the new lint github action workflow.\n+The current pycodestyle configuration only covers a few rules that are also enforced by the patchbot. While this is a good starting point, IDEs pick up this configuration and only show warnings for these rules. In order to make sage's code adhere more to the pep8 recommendations, it is desirable to get warnings for all code style errors. Thus, in this ticket, we enable all pycodestyle warnings. These can be tested as usually by calling \\`pycodestyle\\` or \\`tox -e pycodestyle\\`. Moreover, the current minimal ruleset is tested via the new environment \\`tox -e pycodestyle-minimal\\`, which is also used in the new lint github action workflow.\n \n Author: Tobias Diez\n \n```\n",
    "created_at": "2020-12-07T23:26:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469210",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,4 @@
-The current pycodestyle configuration only covers a few rules that are also enforced by the patchbot. While this is a good starting point, IDEs pick up this configuration and only show warnings for these rules. In order to make sage's code adhere more to the pep8 recommendations, it is desirable to get warnings for all code style errors. Thus, in this ticket, we enable all pycodestyle warnings. These can be tested as usually by calling \`pycodestyle\` or \`tox -e pycodestyle\`. Moreover, the current minimal ruleset is tested via the new environment \`tox -e pycodestyle_minimal\`, which is also used in the new lint github action workflow.
+The current pycodestyle configuration only covers a few rules that are also enforced by the patchbot. While this is a good starting point, IDEs pick up this configuration and only show warnings for these rules. In order to make sage's code adhere more to the pep8 recommendations, it is desirable to get warnings for all code style errors. Thus, in this ticket, we enable all pycodestyle warnings. These can be tested as usually by calling \`pycodestyle\` or \`tox -e pycodestyle\`. Moreover, the current minimal ruleset is tested via the new environment \`tox -e pycodestyle-minimal\`, which is also used in the new lint github action workflow.
 
 Author: Tobias Diez
 
```




---

archive/issue_comments_469211.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:15 mkoeppe]:\n> Replying to [comment:8 mkoeppe]:\n> > Also, the help message shown by `sage -advanced` needs some cosmetic adjustments because the longest environment name is longer now\n\n> Done\n\nThanks!",
    "created_at": "2020-12-07T23:31:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469211",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:18'></a>Replying to [comment:15 mkoeppe]:
> Replying to [comment:8 mkoeppe]:
> > Also, the help message shown by `sage -advanced` needs some cosmetic adjustments because the longest environment name is longer now

> Done

Thanks!



---

archive/issue_comments_469212.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [comment:13 mkoeppe]:\n> Replying to [comment:11 gh-tobiasdiez]:\n> > I also get the following error when running `sage`:\n> > \n> > ```\n> > /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 3: __requires__: command not found\n> > /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: syntax error near unexpected token `'pkg_resources''\n> > /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: `__import__('pkg_resources').require('sage==9.3b2')'\n> > ```\n\n> \n> This is an interesting error - something seems to be rewriting this shell scripts as if it is a Python script - perhaps the newest version of pip?\n\n\nMaybe because I invoke `sage` from within `pipenv shell` (to activate the correct venv)?",
    "created_at": "2020-12-07T23:32:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469212",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:19'></a>Replying to [comment:13 mkoeppe]:
> Replying to [comment:11 gh-tobiasdiez]:
> > I also get the following error when running `sage`:
> > 
> > ```
> > /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 3: __requires__: command not found
> > /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: syntax error near unexpected token `'pkg_resources''
> > /mnt/d/Programming/sage/src/.venv/bin/sage-version.sh: line 4: `__import__('pkg_resources').require('sage==9.3b2')'
> > ```

> 
> This is an interesting error - something seems to be rewriting this shell scripts as if it is a Python script - perhaps the newest version of pip?


Maybe because I invoke `sage` from within `pipenv shell` (to activate the correct venv)?



---

archive/issue_comments_469213.json:
```json
{
    "body": "<a id='comment:20'></a>Let's investigate this in #31049. It's not related to this ticket.",
    "created_at": "2020-12-14T18:14:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469213",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>Let's investigate this in #31049. It's not related to this ticket.



---

archive/issue_comments_469214.json:
```json
{
    "body": "<a id='comment:21'></a>Ready for review...",
    "created_at": "2020-12-14T18:15:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469214",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>Ready for review...



---

archive/issue_comments_469215.json:
```json
{
    "body": "<a id='comment:22'></a>Is there a reviewer for my changes on this ticket?",
    "created_at": "2020-12-22T15:54:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469215",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'></a>Is there a reviewer for my changes on this ticket?



---

archive/issue_comments_469216.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-01-06T12:27:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469216",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_469217.json:
```json
{
    "body": "<a id='comment:23'></a>The other changes look good to me as well. Thanks!",
    "created_at": "2021-01-06T12:27:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469217",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:23'></a>The other changes look good to me as well. Thanks!



---

archive/issue_events_080966.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-01-17T13:46:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31004#event-80966"
}
```



---

archive/issue_comments_469218.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-01-17T13:46:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31004",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31004#issuecomment-469218",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
