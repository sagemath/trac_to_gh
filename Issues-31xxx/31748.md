# Issue 31748: PolyhedralComplex

archive/issues_031511.json:
```json
{
    "body": "Create (geometric) `PolyhedralComplex`, whose cells are Sage Polyhedra. \n\nCC:  @mkoeppe @jhpalmieri @jplab @tscrim\n\nKeywords: polyhedral complex\n\nBranch/Commit: 32d34b71534cea23b6b4cb382ce13064c5b5e928\n\nReviewer: John Palmieri, Travis Scrimshaw\n\nAuthor: Yuan Zhou\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/31748\n\n",
    "closed_at": "2021-07-24T15:28:35Z",
    "created_at": "2021-04-28T14:32:30Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "PolyhedralComplex",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31748",
    "user": "https://github.com/yuan-zhou"
}
```
Create (geometric) `PolyhedralComplex`, whose cells are Sage Polyhedra. 

CC:  @mkoeppe @jhpalmieri @jplab @tscrim

Keywords: polyhedral complex

Branch/Commit: 32d34b71534cea23b6b4cb382ce13064c5b5e928

Reviewer: John Palmieri, Travis Scrimshaw

Author: Yuan Zhou

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/31748





---

archive/issue_comments_480920.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Create (geometric) PolyhedralComplex, whose cells are Sage Polyhedra.\n+Create (geometric) `PolyhedralComplex`, whose cells are Sage Polyhedra. \n \n Comment: 1\n \n``````\n",
    "created_at": "2021-04-28T15:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480920",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Create (geometric) PolyhedralComplex, whose cells are Sage Polyhedra.
+Create (geometric) `PolyhedralComplex`, whose cells are Sage Polyhedra. 
 
 Comment: 1
 
``````




---

archive/issue_comments_480921.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2021-04-28T15:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480921",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_480922.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-28T15:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480922",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480923.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-29T06:39:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480923",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480924.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-04-29T06:42:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480924",
    "user": "https://github.com/yuan-zhou"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_480925.json:
```json
{
    "body": "<a id='comment:6'></a>add author name so that the patchbot runs",
    "created_at": "2021-04-29T19:50:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480925",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>add author name so that the patchbot runs



---

archive/issue_comments_480926.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-29T21:12:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480926",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480927.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-01T06:51:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480927",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480928.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-04T22:33:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480928",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480929.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-06T00:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480929",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480930.json:
```json
{
    "body": "<a id='comment:12'></a>Ready for review.\n\nI don't have much experience with abstract complexes. I'd like to know if this is going in the right direction with Sage homology.\n\nI'm also wondering what other methods of `PolyhedralComplex` could be interesting. Maybe interactions between `PolyhedralComplex` and `SimplicialComplex` such as `PolyhedralComplex.subdivide()` and `SimplicialComplex.geometric_realization()`? And interactions between `PolyhedralComplex` and rational polyhedral fan?\n\nNote that the methods `wedge`, `chain_complex` and `alexander_whitney` are currently missing, as I don't know how to implement them.\n\nAny advice or comment is greatly appreciated! Thanks.",
    "created_at": "2021-05-06T01:06:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480930",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:12'></a>Ready for review.

I don't have much experience with abstract complexes. I'd like to know if this is going in the right direction with Sage homology.

I'm also wondering what other methods of `PolyhedralComplex` could be interesting. Maybe interactions between `PolyhedralComplex` and `SimplicialComplex` such as `PolyhedralComplex.subdivide()` and `SimplicialComplex.geometric_realization()`? And interactions between `PolyhedralComplex` and rational polyhedral fan?

Note that the methods `wedge`, `chain_complex` and `alexander_whitney` are currently missing, as I don't know how to implement them.

Any advice or comment is greatly appreciated! Thanks.



---

archive/issue_comments_480931.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-09T17:34:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480931",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480932.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-13T21:00:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480932",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480933.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:12 yzh]:\n> Ready for review.\n> \n> I don't have much experience with abstract complexes. I'd like to know if this is going in the right direction with Sage homology.\n\n\nIt looks good to me so far, thank you for all of the work you've done.\n\n> Note that the methods `wedge`, `chain_complex` and `alexander_whitney` are currently missing, as I don't know how to implement them.\n\n\nI don't know anything about polyhedral complexes. The wedge is the one-point union, and to construct this, you're going to have to translate the two complexes so that they share a point. Is that acceptable? I could imagine taking a complex which has a point (x_1, x_2) and another complex which has a point (y_1, y_2), and forming the join by embedding both in a larger ambient space so that (x_1, x_2) -> (x_1, x_2, y_1, y_2) <- (y_1, y_2) \u2014\u00a0the first complex lies in the first coordinates, the second in the last coordinates. I don't know if that's a sensible construction from the point of view of people who actually work with these objects.\n\n`chain_complex` \u2014\u00a0is there a standard way to produce a chain complex from a polyhedral complex? I would hope so, and I would hope that it's written down somewhere. We shouldn't invent something from scratch. Can we have a method that triangulates the complex and produces a simplicial complex? How hard would that be? I found this: https://sites.millersville.edu/rumble/slides/Seville-Feb-2018.pdf. Is it helpful?\n\n`alexander_whitney` \u2014\u00a0I don't know how to handle this (although maybe the Umble slides describe it), and in any case, it's tied to a map of chain complexes, so there is no need to worry about it until the chain complex situation is resolved.",
    "created_at": "2021-05-27T23:30:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480933",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:16'></a>Replying to [comment:12 yzh]:
> Ready for review.
> 
> I don't have much experience with abstract complexes. I'd like to know if this is going in the right direction with Sage homology.


It looks good to me so far, thank you for all of the work you've done.

> Note that the methods `wedge`, `chain_complex` and `alexander_whitney` are currently missing, as I don't know how to implement them.


I don't know anything about polyhedral complexes. The wedge is the one-point union, and to construct this, you're going to have to translate the two complexes so that they share a point. Is that acceptable? I could imagine taking a complex which has a point (x_1, x_2) and another complex which has a point (y_1, y_2), and forming the join by embedding both in a larger ambient space so that (x_1, x_2) -> (x_1, x_2, y_1, y_2) <- (y_1, y_2) — the first complex lies in the first coordinates, the second in the last coordinates. I don't know if that's a sensible construction from the point of view of people who actually work with these objects.

`chain_complex` — is there a standard way to produce a chain complex from a polyhedral complex? I would hope so, and I would hope that it's written down somewhere. We shouldn't invent something from scratch. Can we have a method that triangulates the complex and produces a simplicial complex? How hard would that be? I found this: https://sites.millersville.edu/rumble/slides/Seville-Feb-2018.pdf. Is it helpful?

`alexander_whitney` — I don't know how to handle this (although maybe the Umble slides describe it), and in any case, it's tied to a map of chain complexes, so there is no need to worry about it until the chain complex situation is resolved.



---

archive/issue_comments_480934.json:
```json
{
    "body": "<a id='comment:17'></a>By the way, is it possible to have a class of abstract polyhedral complexes, in addition to these more concrete complexes? Maybe it would be nice to view the product of two simplicial complexes as an \"abstract\" polyhedral complex without having to choose embeddings of the simplicial complexes.",
    "created_at": "2021-05-27T23:38:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480934",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:17'></a>By the way, is it possible to have a class of abstract polyhedral complexes, in addition to these more concrete complexes? Maybe it would be nice to view the product of two simplicial complexes as an "abstract" polyhedral complex without having to choose embeddings of the simplicial complexes.



---

archive/issue_comments_480935.json:
```json
{
    "body": "<a id='comment:18'></a>That would be #31842 - `CombinatorialPolyhedralComplex`",
    "created_at": "2021-05-27T23:42:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480935",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>That would be #31842 - `CombinatorialPolyhedralComplex`



---

archive/issue_comments_480936.json:
```json
{
    "body": "<a id='comment:19'></a>I am also wondering where delta complexes fit in this story. Is every abstract polyhedral complex a delta complex?",
    "created_at": "2021-05-27T23:43:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480936",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>I am also wondering where delta complexes fit in this story. Is every abstract polyhedral complex a delta complex?



---

archive/issue_comments_480937.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:16 jhpalmieri]:\n> `chain_complex` \u2014\u00a0is there a standard way to produce a chain complex from a polyhedral complex? I would hope so, and I would hope that it's written down somewhere. We shouldn't invent something from scratch. Can we have a method that triangulates the complex and produces a simplicial complex? How hard would that be? I found this: https://sites.millersville.edu/rumble/slides/Seville-Feb-2018.pdf. Is it helpful?\n\n\nMy quick thought for the case of a *polytope* complex this is you could take any simplicial complex equivalent to the top-dimensional polytopes to get an equivalent simplicial complex. Then the generalized Stokes theorem would allow you to compute a differential via that simplicial decomposition. Moreover, we should be able to do this with a combinatorial description (i.e., just using the vertices of the polytope complex).\n\nFor a polyhedral complex, then we have issues with noncompactness to address. Although in the notes John linked to, they define a polyhedral complex to be with polytope faces. So I think we should be slightly careful about naming to distinguish which objects we allow.\n\nThere's a wikipedia stub page about this as well: https://en.wikipedia.org/wiki/Polyhedral_complex The ability to plot [tropical varieties](https://en.wikipedia.org/wiki/Tropical_geometry) would be great to have. (Reminder to myself, I still need to implement tropical polynomials...) It might be good to also link this to special cases such as fans.",
    "created_at": "2021-05-27T23:59:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480937",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:20'></a>Replying to [comment:16 jhpalmieri]:
> `chain_complex` — is there a standard way to produce a chain complex from a polyhedral complex? I would hope so, and I would hope that it's written down somewhere. We shouldn't invent something from scratch. Can we have a method that triangulates the complex and produces a simplicial complex? How hard would that be? I found this: https://sites.millersville.edu/rumble/slides/Seville-Feb-2018.pdf. Is it helpful?


My quick thought for the case of a *polytope* complex this is you could take any simplicial complex equivalent to the top-dimensional polytopes to get an equivalent simplicial complex. Then the generalized Stokes theorem would allow you to compute a differential via that simplicial decomposition. Moreover, we should be able to do this with a combinatorial description (i.e., just using the vertices of the polytope complex).

For a polyhedral complex, then we have issues with noncompactness to address. Although in the notes John linked to, they define a polyhedral complex to be with polytope faces. So I think we should be slightly careful about naming to distinguish which objects we allow.

There's a wikipedia stub page about this as well: https://en.wikipedia.org/wiki/Polyhedral_complex The ability to plot [tropical varieties](https://en.wikipedia.org/wiki/Tropical_geometry) would be great to have. (Reminder to myself, I still need to implement tropical polynomials...) It might be good to also link this to special cases such as fans.



---

archive/issue_comments_480938.json:
```json
{
    "body": "<a id='comment:21'></a>`@`tscrim `@`jhpalmieri Thank you very much for the feedback! I have yet to study those references.\n\nReplying to [comment:16 jhpalmieri]:\n>\n> Can we have a method that triangulates the complex and produces a simplicial complex? \n>\n\nDo you mean the method `PolyhedralComplex.subdivide(make_simplicial=True)`? It produces a **geometric** simplicial complex. \nThen, #31842 - `CombinatorialPolyhedralComplex` will take care of making it abstract.",
    "created_at": "2021-05-28T00:46:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480938",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:21'></a>`@`tscrim `@`jhpalmieri Thank you very much for the feedback! I have yet to study those references.

Replying to [comment:16 jhpalmieri]:
>
> Can we have a method that triangulates the complex and produces a simplicial complex? 
>

Do you mean the method `PolyhedralComplex.subdivide(make_simplicial=True)`? It produces a **geometric** simplicial complex. 
Then, #31842 - `CombinatorialPolyhedralComplex` will take care of making it abstract.



---

archive/issue_comments_480939.json:
```json
{
    "body": "<a id='comment:22'></a>Replying to [comment:20 tscrim]:\n> It might be good to also link this to special cases such as fans.\n\nI considered to link between `PolyhedralComplex` and `RationalPolyhedralFan`. However, I really didn't want to restrict to the rational case only.",
    "created_at": "2021-05-28T00:54:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480939",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:22'></a>Replying to [comment:20 tscrim]:
> It might be good to also link this to special cases such as fans.

I considered to link between `PolyhedralComplex` and `RationalPolyhedralFan`. However, I really didn't want to restrict to the rational case only.



---

archive/issue_comments_480940.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:19 mkoeppe]:\n> I am also wondering where delta complexes fit in this story. Is every abstract polyhedral complex a delta complex?\n\n\nThe cells in a Delta-complex are all simplices, but maybe any triangulation of an abstract polyhedral complex will always be a Delta-complex. The boundary of a simplex in a Delta-complex is not determined by its vertices: you can make a Delta-complex model of a 2-sphere out of two triangles with a common boundary. Is that allowed in an abstract polyhedral complex?",
    "created_at": "2021-05-28T00:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480940",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:23'></a>Replying to [comment:19 mkoeppe]:
> I am also wondering where delta complexes fit in this story. Is every abstract polyhedral complex a delta complex?


The cells in a Delta-complex are all simplices, but maybe any triangulation of an abstract polyhedral complex will always be a Delta-complex. The boundary of a simplex in a Delta-complex is not determined by its vertices: you can make a Delta-complex model of a 2-sphere out of two triangles with a common boundary. Is that allowed in an abstract polyhedral complex?



---

archive/issue_comments_480941.json:
```json
{
    "body": "<a id='comment:24'></a>In my opinion, we can merge this and then refine later. What do others think?",
    "created_at": "2021-05-28T23:29:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480941",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:24'></a>In my opinion, we can merge this and then refine later. What do others think?



---

archive/issue_comments_480942.json:
```json
{
    "body": "<a id='comment:25'></a>No objection here. It looks great to me!\n\nMinor comment: Shouldn't `disjoint_union` raise an error if the input is not disjoint?\n\nTypos: interoir->interior, complexe->complex",
    "created_at": "2021-05-28T23:57:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480942",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>No objection here. It looks great to me!

Minor comment: Shouldn't `disjoint_union` raise an error if the input is not disjoint?

Typos: interoir->interior, complexe->complex



---

archive/issue_comments_480943.json:
```json
{
    "body": "<a id='comment:26'></a>> Minor comment: Shouldn't `disjoint_union` raise an error if the input is not disjoint?\n\nIt does.\n\n```\nsage: pc = PolyhedralComplex([Polyhedron(vertices=[(1, 1), (0, 0), (1, 2)])])                     \nsage: pc2 = PolyhedralComplex([Polyhedron(vertices=[(1, 1), (0, 0), (0, 1)])])                    \nsage: pc.disjoint_union(pc2) \nValueError: The given cells are not face-to-face\n```",
    "created_at": "2021-05-29T01:44:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480943",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:26'></a>> Minor comment: Shouldn't `disjoint_union` raise an error if the input is not disjoint?

It does.

```
sage: pc = PolyhedralComplex([Polyhedron(vertices=[(1, 1), (0, 0), (1, 2)])])                     
sage: pc2 = PolyhedralComplex([Polyhedron(vertices=[(1, 1), (0, 0), (0, 1)])])                    
sage: pc.disjoint_union(pc2) 
ValueError: The given cells are not face-to-face
```



---

archive/issue_comments_480944.json:
```json
{
    "body": "<a id='comment:27'></a>But\n\n```\nsage: pc3 = PolyhedralComplex([Polyhedron(vertices=[(1, 1), (0, 0), (1, 0)])])\nsage: pc2.disjoint_union(pc3)\nPolyhedral complex with 2 maximal cells\n```",
    "created_at": "2021-05-29T01:48:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480944",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>But

```
sage: pc3 = PolyhedralComplex([Polyhedron(vertices=[(1, 1), (0, 0), (1, 0)])])
sage: pc2.disjoint_union(pc3)
Polyhedral complex with 2 maximal cells
```



---

archive/issue_comments_480945.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-29T01:51:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480945",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480946.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:27 mkoeppe]:\n> But\n> \n> ```\n> sage: pc3 = PolyhedralComplex([Polyhedron(vertices=[(1, 1), (0, 0), (1, 0)])])\n> sage: pc2.disjoint_union(pc3)\n> Polyhedral complex with 2 maximal cells\n> ```\n\nThat looks correct to me.",
    "created_at": "2021-05-29T01:54:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480946",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:29'></a>Replying to [comment:27 mkoeppe]:
> But
> 
> ```
> sage: pc3 = PolyhedralComplex([Polyhedron(vertices=[(1, 1), (0, 0), (1, 0)])])
> sage: pc2.disjoint_union(pc3)
> Polyhedral complex with 2 maximal cells
> ```

That looks correct to me.



---

archive/issue_comments_480947.json:
```json
{
    "body": "<a id='comment:30'></a>Ah, do you mean that `pc2.disjoint_union(pc2)` should raise an error?",
    "created_at": "2021-05-29T01:55:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480947",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:30'></a>Ah, do you mean that `pc2.disjoint_union(pc2)` should raise an error?



---

archive/issue_comments_480948.json:
```json
{
    "body": "<a id='comment:31'></a>pc2 and pc3 are not disjoint, so this should be an error",
    "created_at": "2021-05-29T01:56:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480948",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'></a>pc2 and pc3 are not disjoint, so this should be an error



---

archive/issue_comments_480949.json:
```json
{
    "body": "<a id='comment:32'></a>\n```\nsage: pc0 = PolyhedralComplex()\nsage: pc0.ambient_dimension()\n-1\nsage: pc0.add_cell(Polyhedron(vertices=[(1, 1), (0, 0), (1, 0)]))\nValueError: The given cell is not a polyhedron in the same ambient space.\n```\nI think it would be better to add a keyword argument `ambient_dim` to `__init__` so that one can set up an empty complex in the intended ambient space",
    "created_at": "2021-05-29T01:59:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480949",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:32'></a>
```
sage: pc0 = PolyhedralComplex()
sage: pc0.ambient_dimension()
-1
sage: pc0.add_cell(Polyhedron(vertices=[(1, 1), (0, 0), (1, 0)]))
ValueError: The given cell is not a polyhedron in the same ambient space.
```
I think it would be better to add a keyword argument `ambient_dim` to `__init__` so that one can set up an empty complex in the intended ambient space



---

archive/issue_comments_480950.json:
```json
{
    "body": "<a id='comment:33'></a>Good point! What I implemented in `disjoint_union` is actually the union, but not the disjoint union.\nReplying to [comment:31 mkoeppe]:\n> pc2 and pc3 are not disjoint, so this should be an error",
    "created_at": "2021-05-29T02:12:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480950",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:33'></a>Good point! What I implemented in `disjoint_union` is actually the union, but not the disjoint union.
Replying to [comment:31 mkoeppe]:
> pc2 and pc3 are not disjoint, so this should be an error



---

archive/issue_comments_480951.json:
```json
{
    "body": "<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-29T03:08:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480951",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480952.json:
```json
{
    "body": "<a id='comment:35'></a>My comments have all been addressed, thanks!",
    "created_at": "2021-05-29T03:46:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480952",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:35'></a>My comments have all been addressed, thanks!



---

archive/issue_comments_480953.json:
```json
{
    "body": "<a id='comment:36'></a>I agree that we can merge this without implementing the homology stuff. I have a few comments that should be addressed first:\n\n- It feels like there is a lot of overlap with the `SimplicialComplex` code. Do we want to refactor things to common base classes and/or use inheritance?\n- The bullet points for `backend` in `PolyhedralComplex`'s doc are over-indented (back them up 2 spaces).\n- Not every method has a doctest, even if all they currently do is raise a `NotImplementedError`.\n- It would be good to include a message when you raise an error (see, e.g., the `ValueError` in `PolyhedralComplex.__init__`).\n- Error messages should start with a lowercase and not end with a period/full-stop. This is a Python convention we generally try to follow\n- Be consistent with how you do your documentation. I would not use the `:param` format personally.\n- I think the `_an_element_` should raise an `EmptySetError` if it has no elements.",
    "created_at": "2021-05-29T09:10:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480953",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:36'></a>I agree that we can merge this without implementing the homology stuff. I have a few comments that should be addressed first:

- It feels like there is a lot of overlap with the `SimplicialComplex` code. Do we want to refactor things to common base classes and/or use inheritance?
- The bullet points for `backend` in `PolyhedralComplex`'s doc are over-indented (back them up 2 spaces).
- Not every method has a doctest, even if all they currently do is raise a `NotImplementedError`.
- It would be good to include a message when you raise an error (see, e.g., the `ValueError` in `PolyhedralComplex.__init__`).
- Error messages should start with a lowercase and not end with a period/full-stop. This is a Python convention we generally try to follow
- Be consistent with how you do your documentation. I would not use the `:param` format personally.
- I think the `_an_element_` should raise an `EmptySetError` if it has no elements.



---

archive/issue_comments_480954.json:
```json
{
    "body": "<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-30T01:54:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480954",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480955.json:
```json
{
    "body": "<a id='comment:38'></a>Thanks, Travis! I revised the code according to your comments (expect for 1). \n\nI agree that `PolyhedralComplex` and `SimplicialComplex` have many overlapping methods. As you may have noticed, these are methods required by the parent class `GenericCellComplex`. However, as one is geometric and the other is abstract, and due to the different ways that cells are stored inside the two complexes, I don't see how one can easily factor out a common base class etc.",
    "created_at": "2021-05-30T02:01:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480955",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:38'></a>Thanks, Travis! I revised the code according to your comments (expect for 1). 

I agree that `PolyhedralComplex` and `SimplicialComplex` have many overlapping methods. As you may have noticed, these are methods required by the parent class `GenericCellComplex`. However, as one is geometric and the other is abstract, and due to the different ways that cells are stored inside the two complexes, I don't see how one can easily factor out a common base class etc.



---

archive/issue_comments_480956.json:
```json
{
    "body": "<a id='comment:39'></a>Typo: \"poyhedron\" on about line 8.\n\nI might change `has_maximal_cell` to `is_maximal_cell`. What do you think?\n\nAs far as refactoring goes, I see similar code but not identical code, so it would some work to reorganize things. That can be done on another ticket, in my opinion.",
    "created_at": "2021-05-30T02:16:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480956",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:39'></a>Typo: "poyhedron" on about line 8.

I might change `has_maximal_cell` to `is_maximal_cell`. What do you think?

As far as refactoring goes, I see similar code but not identical code, so it would some work to reorganize things. That can be done on another ticket, in my opinion.



---

archive/issue_comments_480957.json:
```json
{
    "body": "<a id='comment:40'></a>Replying to [comment:39 jhpalmieri]:\n> Typo: \"poyhedron\" on about line 8.\n\nThanks for catching that!\n> I might change `has_maximal_cell` to `is_maximal_cell`. What do you think?\n\nI once heard that `self.is_xxx(other)` means that \"`self` is xxx of `other`\". Therefore, in this case, I would think that `cell.is_maximal_cell(polyhedralcomplex)` and `polyhedralcomplex.has_maximal_cell(cell)`. If this is not the convention in `sage/homology`, I'm happy to change the name to `is_maximal_cell`.\n> As far as refactoring goes, I see similar code but not identical code, so it would some work to reorganize things. That can be done on another ticket, in my opinion.\n\n:)",
    "created_at": "2021-05-30T02:55:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480957",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:40'></a>Replying to [comment:39 jhpalmieri]:
> Typo: "poyhedron" on about line 8.

Thanks for catching that!
> I might change `has_maximal_cell` to `is_maximal_cell`. What do you think?

I once heard that `self.is_xxx(other)` means that "`self` is xxx of `other`". Therefore, in this case, I would think that `cell.is_maximal_cell(polyhedralcomplex)` and `polyhedralcomplex.has_maximal_cell(cell)`. If this is not the convention in `sage/homology`, I'm happy to change the name to `is_maximal_cell`.
> As far as refactoring goes, I see similar code but not identical code, so it would some work to reorganize things. That can be done on another ticket, in my opinion.

:)



---

archive/issue_comments_480958.json:
```json
{
    "body": "<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-30T02:56:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480958",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480959.json:
```json
{
    "body": "<a id='comment:42'></a>Replying to [comment:40 yzh]:\n> Replying to [comment:39 jhpalmieri]:\n> > I might change `has_maximal_cell` to `is_maximal_cell`. What do you think?\n\n> I once heard that `self.is_xxx(other)` means that \"`self` is xxx of `other`\". Therefore, in this case, I would think that `cell.is_maximal_cell(polyhedralcomplex)` and `polyhedralcomplex.has_maximal_cell(cell)`. If this is not the convention in `sage/homology`, I'm happy to change the name to `is_maximal_cell`.\n\nIn `simplicial_complex.py`, the methods `is_face` and `is_shelling_order` use `is...` the way I'm suggesting. It's common for `is_xxx(self)` to be used the way you say, but not universal, and absolutely not universal for `is_xxx(self, x, y, z)`, with more arguments.",
    "created_at": "2021-05-31T03:57:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480959",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:42'></a>Replying to [comment:40 yzh]:
> Replying to [comment:39 jhpalmieri]:
> > I might change `has_maximal_cell` to `is_maximal_cell`. What do you think?

> I once heard that `self.is_xxx(other)` means that "`self` is xxx of `other`". Therefore, in this case, I would think that `cell.is_maximal_cell(polyhedralcomplex)` and `polyhedralcomplex.has_maximal_cell(cell)`. If this is not the convention in `sage/homology`, I'm happy to change the name to `is_maximal_cell`.

In `simplicial_complex.py`, the methods `is_face` and `is_shelling_order` use `is...` the way I'm suggesting. It's common for `is_xxx(self)` to be used the way you say, but not universal, and absolutely not universal for `is_xxx(self, x, y, z)`, with more arguments.



---

archive/issue_comments_480960.json:
```json
{
    "body": "<a id='comment:43'></a>A few things to do before I would set a positive review:\n\n- Add doctests for the `NotImplementedError` raising methods.\n- Change `has_maximal_cell` to `is_maximal_cell` because that is what the docstring is saying. If this was `has_maximal_cell`, I would expect it not to take any other arguments.\n- You can test plotting:\n  {{{\nsage: poset.plot(element_labels=d)                    # not tested\n  }}}\n- Change:\n  {{{#!diff\n-TESTS on nonbounded polyhedral complex::\n+For a nonbounded polyhedral complex::\n  }}}\n- Add a `TestSuite(foo).run()` to the `__init__` doctests. (Not really necessary, but I like to see such a test there.)",
    "created_at": "2021-06-05T08:22:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480960",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:43'></a>A few things to do before I would set a positive review:

- Add doctests for the `NotImplementedError` raising methods.
- Change `has_maximal_cell` to `is_maximal_cell` because that is what the docstring is saying. If this was `has_maximal_cell`, I would expect it not to take any other arguments.
- You can test plotting:
  {{{
sage: poset.plot(element_labels=d)                    # not tested
  }}}
- Change:
  {{{#!diff
-TESTS on nonbounded polyhedral complex::
+For a nonbounded polyhedral complex::
  }}}
- Add a `TestSuite(foo).run()` to the `__init__` doctests. (Not really necessary, but I like to see such a test there.)



---

archive/issue_comments_480961.json:
```json
{
    "body": "<a id='comment:44'></a>Also under discussion at #30400 and #31925: create a new directory `sage/topology` and move all files which deal with topological spaces there, leaving `sage/homology` for chain complexes and related tools. So perhaps this could be placed in `sage/topology` as well.",
    "created_at": "2021-06-07T21:44:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480961",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:44'></a>Also under discussion at #30400 and #31925: create a new directory `sage/topology` and move all files which deal with topological spaces there, leaving `sage/homology` for chain complexes and related tools. So perhaps this could be placed in `sage/topology` as well.



---

archive/issue_comments_480962.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-06-23T02:17:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480962",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_480963.json:
```json
{
    "body": "<a id='comment:45'></a>In light of #31925 I would actually suggest to move `PolyhedralComplex` to `sage.geometry.polyhedral_complex` -- where already similar modules exist: `fan`, `triangulation`, `voronoi_diagram`, `hyperplane_arrangement`.",
    "created_at": "2021-06-23T02:17:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480963",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:45'></a>In light of #31925 I would actually suggest to move `PolyhedralComplex` to `sage.geometry.polyhedral_complex` -- where already similar modules exist: `fan`, `triangulation`, `voronoi_diagram`, `hyperplane_arrangement`.



---

archive/issue_comments_480964.json:
```json
{
    "body": "<a id='comment:46'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-11T18:33:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480964",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:46'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480965.json:
```json
{
    "body": "<a id='comment:47'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-11T20:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480965",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:47'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480966.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-07-11T20:20:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480966",
    "user": "https://github.com/yuan-zhou"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_480967.json:
```json
{
    "body": "<a id='comment:49'></a>I made some reviewer changes to the documentation to standardize it a bit. If my changes are good, then I think we can set a positive review.\n\n---\nNew commits:",
    "created_at": "2021-07-12T00:45:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480967",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:49'></a>I made some reviewer changes to the documentation to standardize it a bit. If my changes are good, then I think we can set a positive review.

---
New commits:



---

archive/issue_comments_480968.json:
```json
{
    "body": "<a id='comment:50'></a>there is a red patchbot plugin (pyflakes)",
    "created_at": "2021-07-12T07:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480968",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:50'></a>there is a red patchbot plugin (pyflakes)



---

archive/issue_comments_480969.json:
```json
{
    "body": "<a id='comment:51'></a>Replying to [comment:50 chapoton]:\n> there is a red patchbot plugin (pyflakes)\n\n\nIn particular:\n\n```\nsrc/sage/geometry/polyhedral_complex.py:117:1 'sage.structure.sage_object.SageObject' imported but unused\nsrc/sage/geometry/polyhedral_complex.py:119:1 'sage.rings.rational_field.QQ' imported but unused\nsrc/sage/geometry/polyhedral_complex.py:326:13 local variable 'cells' is assigned to but never used\nsrc/sage/geometry/polyhedral_complex.py:967:13 local variable 'cells' is assigned to but never used\n```",
    "created_at": "2021-07-12T15:44:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480969",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:51'></a>Replying to [comment:50 chapoton]:
> there is a red patchbot plugin (pyflakes)


In particular:

```
src/sage/geometry/polyhedral_complex.py:117:1 'sage.structure.sage_object.SageObject' imported but unused
src/sage/geometry/polyhedral_complex.py:119:1 'sage.rings.rational_field.QQ' imported but unused
src/sage/geometry/polyhedral_complex.py:326:13 local variable 'cells' is assigned to but never used
src/sage/geometry/polyhedral_complex.py:967:13 local variable 'cells' is assigned to but never used
```



---

archive/issue_comments_480970.json:
```json
{
    "body": "<a id='comment:52'></a>These changes should fix those problems. Should I push a branch? What do you think of just calling `self.cells()` instead of `cells = self.cells()`?\n\n```diff\ndiff --git a/src/sage/geometry/polyhedral_complex.py b/src/sage/geometry/polyhedral_complex.py\nindex 351bfe65b3..06dc60380c 100644\n--- a/src/sage/geometry/polyhedral_complex.py\n+++ b/src/sage/geometry/polyhedral_complex.py\n@@ -114,9 +114,7 @@ from sage.topology.cell_complex import GenericCellComplex\n from sage.geometry.polyhedron.constructor import Polyhedron\n from sage.geometry.polyhedron.base import is_Polyhedron\n from sage.modules.free_module_element import vector\n-from sage.structure.sage_object import SageObject\n from sage.rings.integer_ring import ZZ\n-from sage.rings.rational_field import QQ\n from sage.graphs.graph import Graph\n from sage.combinat.posets.posets import Poset\n from sage.misc.misc import powerset\n@@ -323,7 +321,7 @@ class PolyhedralComplex(GenericCellComplex):\n         self._face_poset = None\n \n         if maximality_check:\n-            cells = self.cells()    # compute self._cells and self._face_poset\n+            self.cells()    # compute self._cells and self._face_poset\n             self._maximal_cells = cells_list_to_cells_dict(\n                                       self._face_poset.maximal_elements())\n         if face_to_face_check:\n@@ -964,7 +962,7 @@ class PolyhedralComplex(GenericCellComplex):\n             Finite poset containing 9 elements\n         \"\"\"\n         if self._face_poset is None:\n-            cells = self.cells()    # poset is obtained and cached in cells()\n+            self.cells()    # poset is obtained and cached in cells()\n         return self._face_poset\n \n     def is_subcomplex(self, other):\n```",
    "created_at": "2021-07-12T19:56:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480970",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:52'></a>These changes should fix those problems. Should I push a branch? What do you think of just calling `self.cells()` instead of `cells = self.cells()`?

```diff
diff --git a/src/sage/geometry/polyhedral_complex.py b/src/sage/geometry/polyhedral_complex.py
index 351bfe65b3..06dc60380c 100644
--- a/src/sage/geometry/polyhedral_complex.py
+++ b/src/sage/geometry/polyhedral_complex.py
@@ -114,9 +114,7 @@ from sage.topology.cell_complex import GenericCellComplex
 from sage.geometry.polyhedron.constructor import Polyhedron
 from sage.geometry.polyhedron.base import is_Polyhedron
 from sage.modules.free_module_element import vector
-from sage.structure.sage_object import SageObject
 from sage.rings.integer_ring import ZZ
-from sage.rings.rational_field import QQ
 from sage.graphs.graph import Graph
 from sage.combinat.posets.posets import Poset
 from sage.misc.misc import powerset
@@ -323,7 +321,7 @@ class PolyhedralComplex(GenericCellComplex):
         self._face_poset = None
 
         if maximality_check:
-            cells = self.cells()    # compute self._cells and self._face_poset
+            self.cells()    # compute self._cells and self._face_poset
             self._maximal_cells = cells_list_to_cells_dict(
                                       self._face_poset.maximal_elements())
         if face_to_face_check:
@@ -964,7 +962,7 @@ class PolyhedralComplex(GenericCellComplex):
             Finite poset containing 9 elements
         """
         if self._face_poset is None:
-            cells = self.cells()    # poset is obtained and cached in cells()
+            self.cells()    # poset is obtained and cached in cells()
         return self._face_poset
 
     def is_subcomplex(self, other):
```



---

archive/issue_comments_480971.json:
```json
{
    "body": "<a id='comment:53'></a>Thanks for the fixes! Calling `self.cells()` looks good to me.",
    "created_at": "2021-07-12T21:41:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480971",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:53'></a>Thanks for the fixes! Calling `self.cells()` looks good to me.



---

archive/issue_comments_480972.json:
```json
{
    "body": "<a id='comment:54'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-12T21:46:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480972",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:54'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480973.json:
```json
{
    "body": "<a id='comment:55'></a>I'm happy. Positive review from everyone else?",
    "created_at": "2021-07-12T22:37:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480973",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:55'></a>I'm happy. Positive review from everyone else?



---

archive/issue_comments_480974.json:
```json
{
    "body": "<a id='comment:56'></a>LGTM.",
    "created_at": "2021-07-12T22:46:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480974",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:56'></a>LGTM.



---

archive/issue_comments_480975.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-07-12T22:46:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480975",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_480976.json:
```json
{
    "body": "<a id='comment:57'></a>On 32-bit:\n\n```\n**********************************************************************\nFile \"src/sage/geometry/polyhedral_complex.py\", line 1407, in sage.geometry.polyhedral_complex.PolyhedralComplex.relative_boundary_cells\nFailed example:\n    [p.vertices() for p in pc_lower_dim.relative_boundary_cells()]\nExpected:\n    [(A vertex at (0, 2),), (A vertex at (1, 2),)]\nGot:\n    [(A vertex at (1, 2),), (A vertex at (0, 2),)]\n**********************************************************************\n1 item had failures:\n   1 of  17 in sage.geometry.polyhedral_complex.PolyhedralComplex.relative_boundary_cells\n    [451 tests, 1 failure, 14.88 s]\n----------------------------------------------------------------------\nsage -t --long --random-seed=0 src/sage/geometry/polyhedral_complex.py  # 1 doctest failed\n----------------------------------------------------------------------\n\n```",
    "created_at": "2021-07-22T21:23:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480976",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:57'></a>On 32-bit:

```
**********************************************************************
File "src/sage/geometry/polyhedral_complex.py", line 1407, in sage.geometry.polyhedral_complex.PolyhedralComplex.relative_boundary_cells
Failed example:
    [p.vertices() for p in pc_lower_dim.relative_boundary_cells()]
Expected:
    [(A vertex at (0, 2),), (A vertex at (1, 2),)]
Got:
    [(A vertex at (1, 2),), (A vertex at (0, 2),)]
**********************************************************************
1 item had failures:
   1 of  17 in sage.geometry.polyhedral_complex.PolyhedralComplex.relative_boundary_cells
    [451 tests, 1 failure, 14.88 s]
----------------------------------------------------------------------
sage -t --long --random-seed=0 src/sage/geometry/polyhedral_complex.py  # 1 doctest failed
----------------------------------------------------------------------

```



---

archive/issue_comments_480977.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-07-22T21:23:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480977",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_480978.json:
```json
{
    "body": "<a id='comment:58'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-22T22:53:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480978",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:58'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480979.json:
```json
{
    "body": "<a id='comment:59'></a>Trivial fix of added `sorted` to doctest.",
    "created_at": "2021-07-22T22:53:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480979",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:59'></a>Trivial fix of added `sorted` to doctest.



---

archive/issue_comments_480980.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2021-07-22T22:53:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480980",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_083764.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-07-24T15:28:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31748#event-83764"
}
```



---

archive/issue_comments_480981.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-07-24T15:28:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31748#issuecomment-480981",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
