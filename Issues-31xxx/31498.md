# Issue 31498: upgrade GAP to 4.11.1 or newer

archive/issues_031261.json:
```json
{
    "body": "CC:  @antonio-rojas @embray @kiwifb @mkoeppe @slel @tobihan @videlec\n\nKeywords: upgrade, gap\n\nthe current GAP release is 4.11.1. Time to upgrade - previous upgrade\nwas in #29314.\n\nHere we also upgrade libsemigroups, in lockstep with GAP, to 1.1.0.\n\nGAP tarball is now hosted on [GitHub](GitHub); we also need to install more GAP packages to satsify needs of updated GAP package digraph and semigroups. \n\nFinally, we fix a bug in TestSuite for abelian groups\n\nIssue created by migration from https://trac.sagemath.org/ticket/31498\n\n",
    "closed_at": "2021-06-20T08:14:22Z",
    "created_at": "2021-03-15T11:40:42Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "upgrade GAP to 4.11.1 or newer",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31498",
    "user": "https://github.com/dimpase"
}
```
CC:  @antonio-rojas @embray @kiwifb @mkoeppe @slel @tobihan @videlec

Keywords: upgrade, gap

the current GAP release is 4.11.1. Time to upgrade - previous upgrade
was in #29314.

Here we also upgrade libsemigroups, in lockstep with GAP, to 1.1.0.

GAP tarball is now hosted on [GitHub](GitHub); we also need to install more GAP packages to satsify needs of updated GAP package digraph and semigroups. 

Finally, we fix a bug in TestSuite for abelian groups

Issue created by migration from https://trac.sagemath.org/ticket/31498





---

archive/issue_comments_446175.json:
```json
{
    "body": "Changing keywords from \"\" to \"upgrade, gap\".",
    "created_at": "2021-03-16T01:29:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446175",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "upgrade, gap".



---

archive/issue_comments_446176.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-05-13T21:51:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446176",
    "user": "https://github.com/dimpase"
}
```

New commits:



---

archive/issue_comments_446177.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-13T23:04:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446177",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_446178.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-14T08:45:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446178",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_446179.json:
```json
{
    "body": "what remains is to fix this weird error - something is emitting that string of `*` whcih overrides the test output. Not reproducible at `sage:` prompt:\n\n```\nFile \"src/sage/tests/gap_packages.py\", line 8, in sage.tests.gap_packages\nFailed example:\n    test_packages(pkgs, only_failures=True)    # optional - gap_packages\nExpected:\n    ...\n      Status   Package   GAP Output\n    +--------+---------+------------+\nGot:\n      Status   Package   GAP Output\n    +--------+---------+------------+\n**********************************************************************\n```\n\nbut\n\n```\nsage: from sage.tests.gap_packages import all_installed_packages, test_packages                                                                                                                                                                                                   \nsage: pkgs = all_installed_packages(ignore_dot_gap=True)                                                                                                                                                                                                                          \nsage: test_packages(pkgs, only_failures=True)                                                                                                                                                                                                                                     \n  Status   Package   GAP Output\n+--------+---------+------------+\nsage:   \n```",
    "created_at": "2021-05-14T08:51:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446179",
    "user": "https://github.com/dimpase"
}
```

what remains is to fix this weird error - something is emitting that string of `*` whcih overrides the test output. Not reproducible at `sage:` prompt:

```
File "src/sage/tests/gap_packages.py", line 8, in sage.tests.gap_packages
Failed example:
    test_packages(pkgs, only_failures=True)    # optional - gap_packages
Expected:
    ...
      Status   Package   GAP Output
    +--------+---------+------------+
Got:
      Status   Package   GAP Output
    +--------+---------+------------+
**********************************************************************
```

but

```
sage: from sage.tests.gap_packages import all_installed_packages, test_packages                                                                                                                                                                                                   
sage: pkgs = all_installed_packages(ignore_dot_gap=True)                                                                                                                                                                                                                          
sage: test_packages(pkgs, only_failures=True)                                                                                                                                                                                                                                     
  Status   Package   GAP Output
+--------+---------+------------+
sage:   
```



---

archive/issue_comments_446180.json:
```json
{
    "body": "Replying to [comment:5 dimpase]:\n> what remains is to fix this weird error - something is emitting that string of `*` whcih overrides the test output.\n\n\nIsn't that just the usual test failure output? It seems to me that the actual issue is the \"...\" wildcard on the first line - there is no newline before the \"Status\" line so it doesn't match.",
    "created_at": "2021-05-14T09:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446180",
    "user": "https://github.com/antonio-rojas"
}
```

Replying to [comment:5 dimpase]:
> what remains is to fix this weird error - something is emitting that string of `*` whcih overrides the test output.


Isn't that just the usual test failure output? It seems to me that the actual issue is the "..." wildcard on the first line - there is no newline before the "Status" line so it doesn't match.



---

archive/issue_comments_446181.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-14T09:19:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446181",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_446182.json:
```json
{
    "body": "another test to fix:\n\n```\nsage -t --warn-long 50.1 --random-seed=0 src/sage/groups/abelian_gps/abelian_group_gap.py\n**********************************************************************\nFile \"src/sage/groups/abelian_gps/abelian_group_gap.py\", line 201, in sage.groups.abelian_gps.abelian_group_gap.AbelianGroupElement_polycyclic\nFailed example:\n    TestSuite(G.an_element()).run()       # optional - gap_packages\nExpected nothing\nGot:\n    Failure in _test_pickling:\n    Traceback (most recent call last):\n      File \"/home/scratch2/dimpase/sage/sage/local/lib64/python3.8/site-packages/sage/misc/sage_unittest.py\", line 297, in run\n        test_method(tester=tester)\n      File \"sage/structure/sage_object.pyx\", line 647, in sage.structure.sage_object.SageObject._test_pickling (build/cythonized/sage/structure/sage_object.c:5023)\n        tester.assertEqual(loads(dumps(self)), self)\n      File \"sage/misc/persist.pyx\", line 935, in sage.misc.persist.loads (build/cythonized/sage/misc/persist.c:7536)\n        return unpickler.load()\n      File \"sage/structure/parent.pyx\", line 898, in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9335)\n        return mor._call_(x)\n      File \"sage/structure/coerce_maps.pyx\", line 161, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4622)\n        raise\n      File \"sage/structure/coerce_maps.pyx\", line 156, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4514)\n        return C._element_constructor(x)\n      File \"/home/scratch2/dimpase/sage/sage/local/lib64/python3.8/site-packages/sage/groups/abelian_gps/abelian_group_gap.py\", line 368, in _element_constructor_\n        x *= gens_gap[i]**(exp[i] % orders[i])\n      File \"sage/rings/integer.pyx\", line 3413, in sage.rings.integer.Integer.__mod__ (build/cythonized/sage/rings/integer.c:22616)\n        raise ZeroDivisionError(\"Integer modulo by zero\")\n    ZeroDivisionError: Integer modulo by zero\n    ------------------------------------------------------------\n    The following tests failed: _test_pickling\n**********************************************************************\n```",
    "created_at": "2021-05-14T09:20:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446182",
    "user": "https://github.com/dimpase"
}
```

another test to fix:

```
sage -t --warn-long 50.1 --random-seed=0 src/sage/groups/abelian_gps/abelian_group_gap.py
**********************************************************************
File "src/sage/groups/abelian_gps/abelian_group_gap.py", line 201, in sage.groups.abelian_gps.abelian_group_gap.AbelianGroupElement_polycyclic
Failed example:
    TestSuite(G.an_element()).run()       # optional - gap_packages
Expected nothing
Got:
    Failure in _test_pickling:
    Traceback (most recent call last):
      File "/home/scratch2/dimpase/sage/sage/local/lib64/python3.8/site-packages/sage/misc/sage_unittest.py", line 297, in run
        test_method(tester=tester)
      File "sage/structure/sage_object.pyx", line 647, in sage.structure.sage_object.SageObject._test_pickling (build/cythonized/sage/structure/sage_object.c:5023)
        tester.assertEqual(loads(dumps(self)), self)
      File "sage/misc/persist.pyx", line 935, in sage.misc.persist.loads (build/cythonized/sage/misc/persist.c:7536)
        return unpickler.load()
      File "sage/structure/parent.pyx", line 898, in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9335)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 161, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4622)
        raise
      File "sage/structure/coerce_maps.pyx", line 156, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4514)
        return C._element_constructor(x)
      File "/home/scratch2/dimpase/sage/sage/local/lib64/python3.8/site-packages/sage/groups/abelian_gps/abelian_group_gap.py", line 368, in _element_constructor_
        x *= gens_gap[i]**(exp[i] % orders[i])
      File "sage/rings/integer.pyx", line 3413, in sage.rings.integer.Integer.__mod__ (build/cythonized/sage/rings/integer.c:22616)
        raise ZeroDivisionError("Integer modulo by zero")
    ZeroDivisionError: Integer modulo by zero
    ------------------------------------------------------------
    The following tests failed: _test_pickling
**********************************************************************
```



---

archive/issue_comments_446183.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-14T11:49:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446183",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_446184.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-05-14T12:14:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446184",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_446185.json:
```json
{
    "body": "please review...",
    "created_at": "2021-05-27T11:15:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446185",
    "user": "https://github.com/dimpase"
}
```

please review...



---

archive/issue_comments_446186.json:
```json
{
    "body": "I won't lie, I am not quite ready for this in sage-on-gentoo. I have been under rather heavy stress so far this year and I am not doing as much as I want.",
    "created_at": "2021-05-27T11:31:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446186",
    "user": "https://github.com/kiwifb"
}
```

I won't lie, I am not quite ready for this in sage-on-gentoo. I have been under rather heavy stress so far this year and I am not doing as much as I want.



---

archive/issue_comments_446187.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-05-30T09:24:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446187",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_446188.json:
```json
{
    "body": "Tell me about it ;-) \n\nBut I think we should have people bang away at this asap and not later in the release cycle.",
    "created_at": "2021-05-30T09:24:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446188",
    "user": "https://github.com/vbraun"
}
```

Tell me about it ;-) 

But I think we should have people bang away at this asap and not later in the release cycle.



---

archive/issue_comments_446189.json:
```json
{
    "body": "Thanks!",
    "created_at": "2021-05-30T11:54:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446189",
    "user": "https://github.com/dimpase"
}
```

Thanks!



---

archive/issue_comments_446190.json:
```json
{
    "body": "There is a small merge conflict with #31489, and a failure\n\n```\nsage -t --long --warn-long 43.1 --random-seed=0 src/sage/tests/gap_packages.py\n**********************************************************************\nFile \"src/sage/tests/gap_packages.py\", line 9, in sage.tests.gap_packages\nFailed example:\n    for p in pkgs:\n        pkg = p.split('-')[0]\n        if not libgap.LoadPackage(pkg):\n            raise\nException raised:\n    Traceback (most recent call last):\n      File \"/home/release/Sage/local/lib64/python3.9/site-packages/sage/doctest/forker.py\", line 714, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/release/Sage/local/lib64/python3.9/site-packages/sage/doctest/forker.py\", line 1133, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.tests.gap_packages[3]>\", line 4, in <module>\n        raise\n    RuntimeError: No active exception to reraise\n**********************************************************************\n1 item had failures:\n   1 of   6 in sage.tests.gap_packages\n    [12 tests, 1 failure, 0.26 s]\n----------------------------------------------------------------------\nsage -t --long --warn-long 43.1 --random-seed=0 src/sage/tests/gap_packages.py  # 1 doctest failed\n----------------------------------------------------------------------\n```",
    "created_at": "2021-05-30T16:57:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446190",
    "user": "https://github.com/vbraun"
}
```

There is a small merge conflict with #31489, and a failure

```
sage -t --long --warn-long 43.1 --random-seed=0 src/sage/tests/gap_packages.py
**********************************************************************
File "src/sage/tests/gap_packages.py", line 9, in sage.tests.gap_packages
Failed example:
    for p in pkgs:
        pkg = p.split('-')[0]
        if not libgap.LoadPackage(pkg):
            raise
Exception raised:
    Traceback (most recent call last):
      File "/home/release/Sage/local/lib64/python3.9/site-packages/sage/doctest/forker.py", line 714, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/release/Sage/local/lib64/python3.9/site-packages/sage/doctest/forker.py", line 1133, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.tests.gap_packages[3]>", line 4, in <module>
        raise
    RuntimeError: No active exception to reraise
**********************************************************************
1 item had failures:
   1 of   6 in sage.tests.gap_packages
    [12 tests, 1 failure, 0.26 s]
----------------------------------------------------------------------
sage -t --long --warn-long 43.1 --random-seed=0 src/sage/tests/gap_packages.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

archive/issue_comments_446191.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-05-30T16:57:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446191",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_446192.json:
```json
{
    "body": "Replying to [comment:16 vbraun]:\n> There is a small merge conflict with #31489, and a failure\n> \n> ```\n> sage -t --long --warn-long 43.1 --random-seed=0 src/sage/tests/gap_packages.py\n> ...\n> ```\n\n\nI only see this if I manually uninstall gap_packages. But this meant to be with them installed?\n\n```\n96396e238d4 (Volker Braun     2013-07-22 17:05:24 -0400   2) Test the optional GAP packages\n```\n\nGAP doesn't have a clean way to uninstall packages. \n\nI can rebase over  #31489 if it helps.",
    "created_at": "2021-06-01T10:27:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446192",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:16 vbraun]:
> There is a small merge conflict with #31489, and a failure
> 
> ```
> sage -t --long --warn-long 43.1 --random-seed=0 src/sage/tests/gap_packages.py
> ...
> ```


I only see this if I manually uninstall gap_packages. But this meant to be with them installed?

```
96396e238d4 (Volker Braun     2013-07-22 17:05:24 -0400   2) Test the optional GAP packages
```

GAP doesn't have a clean way to uninstall packages. 

I can rebase over  #31489 if it helps.



---

archive/issue_comments_446193.json:
```json
{
    "body": "these test_packages stuff is a mess. We have two different functions\nthat both claim to `Return list of all installed packages.`,  `test_packages()`, and `all_installed_packages()` which differ in the output format - the former outputs `table` (sic!)\nand the latter does not check whether these packages actually may be loaded (so it's largely meaningless).\n\nMay we do it on another ticket?",
    "created_at": "2021-06-01T11:24:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446193",
    "user": "https://github.com/dimpase"
}
```

these test_packages stuff is a mess. We have two different functions
that both claim to `Return list of all installed packages.`,  `test_packages()`, and `all_installed_packages()` which differ in the output format - the former outputs `table` (sic!)
and the latter does not check whether these packages actually may be loaded (so it's largely meaningless).

May we do it on another ticket?



---

archive/issue_comments_446194.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-06-01T23:46:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446194",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_446195.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-06-01T23:50:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446195",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_446196.json:
```json
{
    "body": "I believe the test is fixed now.",
    "created_at": "2021-06-01T23:50:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446196",
    "user": "https://github.com/dimpase"
}
```

I believe the test is fixed now.



---

archive/issue_comments_446197.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-06-02T00:02:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446197",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_446198.json:
```json
{
    "body": "OK, now it depends on #31489 and should cleanly merge: the only change from #31489 is done in comment:22",
    "created_at": "2021-06-02T00:03:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446198",
    "user": "https://github.com/dimpase"
}
```

OK, now it depends on #31489 and should cleanly merge: the only change from #31489 is done in comment:22



---

archive/issue_comments_446199.json:
```json
{
    "body": "I have not merged the full branch of #31489 here, though.",
    "created_at": "2021-06-02T00:06:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446199",
    "user": "https://github.com/dimpase"
}
```

I have not merged the full branch of #31489 here, though.



---

archive/issue_comments_446200.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-06-08T15:41:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446200",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_446201.json:
```json
{
    "body": "rebased on 9.4.beta1",
    "created_at": "2021-06-08T15:41:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446201",
    "user": "https://github.com/dimpase"
}
```

rebased on 9.4.beta1



---

archive/issue_comments_446202.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-06-11T03:46:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446202",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_446203.json:
```json
{
    "body": "Let's try to get this into the next beta.",
    "created_at": "2021-06-11T03:46:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446203",
    "user": "https://github.com/tscrim"
}
```

Let's try to get this into the next beta.



---

archive/issue_events_082745.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-06-20T08:14:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31498#event-82745"
}
```



---

archive/issue_comments_446204.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-06-20T08:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446204",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_446205.json:
```json
{
    "body": "I am a bit dumbfounded by this upgrade in a way. There are strange particulars to it in sage-on-gentoo. I cannot build the doc.\n\n```\n[categorie] /var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/lib/sage/categories/finite_coxeter_groups.py:docstring of sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.permutahedron:50: WARNING: Exception occurred in plotting finite_coxeter_groups-1\n[categorie]  from /var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/doc/en/reference/categories/sage/categories/finite_coxeter_groups.rst:\n[categorie] Traceback (most recent call last):\n[categorie]   File \"/usr/lib/python3.9/site-packages/matplotlib/sphinxext/plot_directive.py\", line 483, in run_code\n[categorie]     exec(code, ns)\n[categorie]   File \"<string>\", line 1, in <module>\n[categorie]   File \"sage/misc/lazy_import.pyx\", line 362, in sage.misc.lazy_import.LazyImport.__call__ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/misc/lazy_import.c:4041)\n[categorie]     return self.get_object()(*args, **kwds)\n[categorie]   File \"/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/lib/sage/combinat/root_system/coxeter_group.py\", line 135, in CoxeterGroup\n[categorie]     return CoxeterMatrixGroup(cartan_type, base_ring, index_set)\n[categorie]   File \"sage/misc/classcall_metaclass.pyx\", line 322, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/misc/classcall_metaclass.c:1743)\n[categorie]     return cls.classcall(cls, *args, **kwds)\n[categorie]   File \"/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/lib/sage/groups/matrix_gps/coxeter_group.py\", line 230, in __classcall_private__\n[categorie]     return super(CoxeterMatrixGroup, cls).__classcall__(cls,\n[categorie]   File \"sage/misc/cachefunc.pyx\", line 1001, in sage.misc.cachefunc.CachedFunction.__call__ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/misc/cachefunc.c:6087)\n[categorie]     w = self.f(*args, **kwds)\n[categorie]   File \"/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/lib/sage/structure/unique_representation.py\", line 1007, in __classcall__\n[categorie]     instance = typecall(cls, *args, **options)\n[categorie]   File \"sage/misc/classcall_metaclass.pyx\", line 486, in sage.misc.classcall_metaclass.typecall (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/misc/classcall_metaclass.c:2207)\n[categorie]     return (<PyTypeObject*>type).tp_call(cls, args, kwds)\n[categorie]   File \"/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/lib/sage/groups/matrix_gps/coxeter_group.py\", line 273, in __init__\n[categorie]     one = MS.one()\n[categorie]   File \"sage/misc/cachefunc.pyx\", line 2310, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/misc/cachefunc.c:12918)\n[categorie]     self.cache = f(self._instance)\n[categorie]   File \"/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/lib/sage/matrix/matrix_space.py\", line 1608, in identity_matrix\n[categorie]     A = self.zero_matrix().__copy__()\n[categorie]   File \"sage/misc/cachefunc.pyx\", line 2310, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/misc/cachefunc.c:12918)\n[categorie]     self.cache = f(self._instance)\n[categorie]   File \"/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/lib/sage/matrix/matrix_space.py\", line 1766, in zero_matrix\n[categorie]     zero = self.base_ring().zero()\n[categorie]   File \"sage/misc/cachefunc.pyx\", line 2310, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/misc/cachefunc.c:12918)\n[categorie]     self.cache = f(self._instance)\n[categorie]   File \"/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/lib/sage/rings/universal_cyclotomic_field.py\", line 1397, in zero\n[categorie]     return self.element_class(self, libgap.zero())\n[categorie]   File \"sage/libs/gap/libgap.pyx\", line 618, in sage.libs.gap.libgap.Gap.zero (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/libs/gap/libgap.c:6277)\n[categorie]     return self(0)\n[categorie]   File \"sage/structure/parent.pyx\", line 898, in sage.structure.parent.Parent.__call__ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/structure/parent.c:9342)\n[categorie]     return mor._call_(x)\n[categorie]   File \"sage/structure/coerce_maps.pyx\", line 161, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/structure/coerce_maps.c:4628)\n[categorie]     raise\n[categorie]   File \"sage/structure/coerce_maps.pyx\", line 156, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/structure/coerce_maps.c:4520)\n[categorie]     return C._element_constructor(x)\n[categorie]   File \"sage/libs/gap/libgap.pyx\", line 298, in sage.libs.gap.libgap.Gap._element_constructor_ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/libs/gap/libgap.c:3391)\n[categorie]     initialize()\n[categorie]   File \"sage/libs/gap/util.pyx\", line 314, in sage.libs.gap.util.initialize (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/libs/gap/util.c:5897)\n[categorie]     with atomic_write(workspace) as f:\n[categorie]   File \"sage/libs/gap/util.pyx\", line 316, in sage.libs.gap.util.initialize (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/libs/gap/util.c:5852)\n[categorie]     gap_eval('SaveWorkspace(\"{0}\")'.format(f.name))\n[categorie]   File \"sage/libs/gap/util.pyx\", line 398, in sage.libs.gap.util.gap_eval (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/libs/gap/util.c:6068)\n[categorie]     GAP_Enter()\n[categorie] sage.libs.gap.util.GAPError: Error, reached the pre-set memory limit\n[categorie] (change it with the -o command line option)\n[graphs   ] The inventory files are in ../../build_doc/inventory/en/reference/graphs.\nBuild finished. The built documents can be found in /var/tmp/portage/sci-mathematics/sage-9999/work/build_doc/inventory/en/reference/graphs\n[functions] building [inventory]: targets for 20 source files that are out of date\n[functions] updating environment: [new config] 20 added, 0 changed, 0 removed\n[finite_ri] The inventory files are in ../../build_doc/inventory/en/reference/finite_rings.\nBuild finished. The built documents can be found in /var/tmp/portage/sci-mathematics/sage-9999/work/build_doc/inventory/en/reference/finite_rings\n[function_] The inventory files are in ../../build_doc/inventory/en/reference/function_fields.\nBuild finished. The built documents can be found in /var/tmp/portage/sci-mathematics/sage-9999/work/build_doc/inventory/en/reference/function_fields\n[game_theo] building [inventory]: targets for 6 source files that are out of date\n[game_theo] updating environment: [new config] 6 added, 0 changed, 0 removed\n[games    ] building [inventory]: targets for 5 source files that are out of date\n[games    ] updating environment: [new config] 5 added, 0 changed, 0 removed\n[game_theo] The inventory files are in ../../build_doc/inventory/en/reference/game_theory.\nBuild finished. The built documents can be found in /var/tmp/portage/sci-mathematics/sage-9999/work/build_doc/inventory/en/reference/game_theory\n[categorie] The inventory files are in ../../build_doc/inventory/en/reference/categories.\nError building the documentation.\nTraceback (most recent call last):\n  File \"/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/sage_docbuild/__main__.py\", line 2, in <module>\n    main()\n  File \"/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/sage_docbuild/__init__.py\", line 1813, in main\n    builder()\n  File \"/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/sage_docbuild/__init__.py\", line 345, in _wrapper\n    getattr(get_builder(document), 'inventory')(*args, **kwds)\n  File \"/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/sage_docbuild/__init__.py\", line 582, in _wrapper\n    self._build_everything_except_bibliography(format, *args, **kwds)\n  File \"/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/sage_docbuild/__init__.py\", line 565, in _build_everything_except_bibliography\n    build_many(build_ref_doc, non_references)\n  File \"/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/sage_docbuild/__init__.py\", line 297, in build_many\n    _build_many(target, args, processes=processes)\n  File \"/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/sage_docbuild/utils.py\", line 289, in build_many\n    raise worker_exc.original_exception\nOSError: /var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/lib/sage/categories/finite_coxeter_groups.py:docstring of sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.permutahedron:50: WARNING: Exception occurred in plotting finite_coxeter_groups-1\n```\nIn sage-on-gentoo, I do separate gap packages and the source of error is more precisely ctbllib-1.3.1+ (I say + because there is a 1.3.2 now in its upstream and the result is the same with it). If I downgrade ctbllib to 1.2_p2 the documentation builds.\n\nThe error message suggests to increase the memory limit. This is set somewhere in `sage/interface/gap.py` and I pushed it from the current `400MB` to `2000MB` without improvement.\n\nI am probably missing something but what?",
    "created_at": "2021-06-20T10:57:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446205",
    "user": "https://github.com/kiwifb"
}
```

I am a bit dumbfounded by this upgrade in a way. There are strange particulars to it in sage-on-gentoo. I cannot build the doc.

```
[categorie] /var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/lib/sage/categories/finite_coxeter_groups.py:docstring of sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.permutahedron:50: WARNING: Exception occurred in plotting finite_coxeter_groups-1
[categorie]  from /var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/doc/en/reference/categories/sage/categories/finite_coxeter_groups.rst:
[categorie] Traceback (most recent call last):
[categorie]   File "/usr/lib/python3.9/site-packages/matplotlib/sphinxext/plot_directive.py", line 483, in run_code
[categorie]     exec(code, ns)
[categorie]   File "<string>", line 1, in <module>
[categorie]   File "sage/misc/lazy_import.pyx", line 362, in sage.misc.lazy_import.LazyImport.__call__ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/misc/lazy_import.c:4041)
[categorie]     return self.get_object()(*args, **kwds)
[categorie]   File "/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/lib/sage/combinat/root_system/coxeter_group.py", line 135, in CoxeterGroup
[categorie]     return CoxeterMatrixGroup(cartan_type, base_ring, index_set)
[categorie]   File "sage/misc/classcall_metaclass.pyx", line 322, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/misc/classcall_metaclass.c:1743)
[categorie]     return cls.classcall(cls, *args, **kwds)
[categorie]   File "/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/lib/sage/groups/matrix_gps/coxeter_group.py", line 230, in __classcall_private__
[categorie]     return super(CoxeterMatrixGroup, cls).__classcall__(cls,
[categorie]   File "sage/misc/cachefunc.pyx", line 1001, in sage.misc.cachefunc.CachedFunction.__call__ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/misc/cachefunc.c:6087)
[categorie]     w = self.f(*args, **kwds)
[categorie]   File "/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/lib/sage/structure/unique_representation.py", line 1007, in __classcall__
[categorie]     instance = typecall(cls, *args, **options)
[categorie]   File "sage/misc/classcall_metaclass.pyx", line 486, in sage.misc.classcall_metaclass.typecall (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/misc/classcall_metaclass.c:2207)
[categorie]     return (<PyTypeObject*>type).tp_call(cls, args, kwds)
[categorie]   File "/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/lib/sage/groups/matrix_gps/coxeter_group.py", line 273, in __init__
[categorie]     one = MS.one()
[categorie]   File "sage/misc/cachefunc.pyx", line 2310, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/misc/cachefunc.c:12918)
[categorie]     self.cache = f(self._instance)
[categorie]   File "/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/lib/sage/matrix/matrix_space.py", line 1608, in identity_matrix
[categorie]     A = self.zero_matrix().__copy__()
[categorie]   File "sage/misc/cachefunc.pyx", line 2310, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/misc/cachefunc.c:12918)
[categorie]     self.cache = f(self._instance)
[categorie]   File "/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/lib/sage/matrix/matrix_space.py", line 1766, in zero_matrix
[categorie]     zero = self.base_ring().zero()
[categorie]   File "sage/misc/cachefunc.pyx", line 2310, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/misc/cachefunc.c:12918)
[categorie]     self.cache = f(self._instance)
[categorie]   File "/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/lib/sage/rings/universal_cyclotomic_field.py", line 1397, in zero
[categorie]     return self.element_class(self, libgap.zero())
[categorie]   File "sage/libs/gap/libgap.pyx", line 618, in sage.libs.gap.libgap.Gap.zero (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/libs/gap/libgap.c:6277)
[categorie]     return self(0)
[categorie]   File "sage/structure/parent.pyx", line 898, in sage.structure.parent.Parent.__call__ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/structure/parent.c:9342)
[categorie]     return mor._call_(x)
[categorie]   File "sage/structure/coerce_maps.pyx", line 161, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/structure/coerce_maps.c:4628)
[categorie]     raise
[categorie]   File "sage/structure/coerce_maps.pyx", line 156, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/structure/coerce_maps.c:4520)
[categorie]     return C._element_constructor(x)
[categorie]   File "sage/libs/gap/libgap.pyx", line 298, in sage.libs.gap.libgap.Gap._element_constructor_ (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/libs/gap/libgap.c:3391)
[categorie]     initialize()
[categorie]   File "sage/libs/gap/util.pyx", line 314, in sage.libs.gap.util.initialize (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/libs/gap/util.c:5897)
[categorie]     with atomic_write(workspace) as f:
[categorie]   File "sage/libs/gap/util.pyx", line 316, in sage.libs.gap.util.initialize (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/libs/gap/util.c:5852)
[categorie]     gap_eval('SaveWorkspace("{0}")'.format(f.name))
[categorie]   File "sage/libs/gap/util.pyx", line 398, in sage.libs.gap.util.gap_eval (/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/cythonized/sage/libs/gap/util.c:6068)
[categorie]     GAP_Enter()
[categorie] sage.libs.gap.util.GAPError: Error, reached the pre-set memory limit
[categorie] (change it with the -o command line option)
[graphs   ] The inventory files are in ../../build_doc/inventory/en/reference/graphs.
Build finished. The built documents can be found in /var/tmp/portage/sci-mathematics/sage-9999/work/build_doc/inventory/en/reference/graphs
[functions] building [inventory]: targets for 20 source files that are out of date
[functions] updating environment: [new config] 20 added, 0 changed, 0 removed
[finite_ri] The inventory files are in ../../build_doc/inventory/en/reference/finite_rings.
Build finished. The built documents can be found in /var/tmp/portage/sci-mathematics/sage-9999/work/build_doc/inventory/en/reference/finite_rings
[function_] The inventory files are in ../../build_doc/inventory/en/reference/function_fields.
Build finished. The built documents can be found in /var/tmp/portage/sci-mathematics/sage-9999/work/build_doc/inventory/en/reference/function_fields
[game_theo] building [inventory]: targets for 6 source files that are out of date
[game_theo] updating environment: [new config] 6 added, 0 changed, 0 removed
[games    ] building [inventory]: targets for 5 source files that are out of date
[games    ] updating environment: [new config] 5 added, 0 changed, 0 removed
[game_theo] The inventory files are in ../../build_doc/inventory/en/reference/game_theory.
Build finished. The built documents can be found in /var/tmp/portage/sci-mathematics/sage-9999/work/build_doc/inventory/en/reference/game_theory
[categorie] The inventory files are in ../../build_doc/inventory/en/reference/categories.
Error building the documentation.
Traceback (most recent call last):
  File "/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/sage_docbuild/__main__.py", line 2, in <module>
    main()
  File "/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/sage_docbuild/__init__.py", line 1813, in main
    builder()
  File "/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/sage_docbuild/__init__.py", line 345, in _wrapper
    getattr(get_builder(document), 'inventory')(*args, **kwds)
  File "/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/sage_docbuild/__init__.py", line 582, in _wrapper
    self._build_everything_except_bibliography(format, *args, **kwds)
  File "/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/sage_docbuild/__init__.py", line 565, in _build_everything_except_bibliography
    build_many(build_ref_doc, non_references)
  File "/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/sage_docbuild/__init__.py", line 297, in build_many
    _build_many(target, args, processes=processes)
  File "/var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/sage_docbuild/utils.py", line 289, in build_many
    raise worker_exc.original_exception
OSError: /var/tmp/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_9/build/lib/sage/categories/finite_coxeter_groups.py:docstring of sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.permutahedron:50: WARNING: Exception occurred in plotting finite_coxeter_groups-1
```
In sage-on-gentoo, I do separate gap packages and the source of error is more precisely ctbllib-1.3.1+ (I say + because there is a 1.3.2 now in its upstream and the result is the same with it). If I downgrade ctbllib to 1.2_p2 the documentation builds.

The error message suggests to increase the memory limit. This is set somewhere in `sage/interface/gap.py` and I pushed it from the current `400MB` to `2000MB` without improvement.

I am probably missing something but what?



---

archive/issue_comments_446206.json:
```json
{
    "body": "Whats the output of `_get_gap_memory_pool_size_MB`? \n\nGAP needs swap due to how they reserve the memory pool.",
    "created_at": "2021-06-20T13:26:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446206",
    "user": "https://github.com/vbraun"
}
```

Whats the output of `_get_gap_memory_pool_size_MB`? 

GAP needs swap due to how they reserve the memory pool.



---

archive/issue_comments_446207.json:
```json
{
    "body": "Replying to [comment:31 vbraun]:\n> Whats the output of `_get_gap_memory_pool_size_MB`? \n> \n> GAP needs swap due to how they reserve the memory pool.\n\n\n568MB if I leave it to the default. With the changes for my last attempt, it should be 2001MB. But what puzzles me is the influence of `ctbllib`. So, I am wondering if the message is in fact unhelpful for the issue at hand.",
    "created_at": "2021-06-20T21:39:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31498",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31498#issuecomment-446207",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:31 vbraun]:
> Whats the output of `_get_gap_memory_pool_size_MB`? 
> 
> GAP needs swap due to how they reserve the memory pool.


568MB if I leave it to the default. With the changes for my last attempt, it should be 2001MB. But what puzzles me is the influence of `ctbllib`. So, I am wondering if the message is in fact unhelpful for the issue at hand.
