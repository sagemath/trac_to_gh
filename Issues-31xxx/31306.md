# Issue 31306: sage.repl: Replace use of SAGE_EXTCODE by importlib.resources

archive/issues_031069.json:
```json
{
    "body": "We eliminate direct reading of files from the package directories of sagelib by using `importlib.resources` (available since python 3.7) \n- `git grep 'SAGE_EXTCODE' src/sage`\n- `git grep '__file__' src/sage`\n\nThis will help make sagelib `zip_safe` (https://setuptools.readthedocs.io/en/latest/userguide/miscellaneous.html#setting-the-zip-safe-flag)\n\nIn this ticket, we take care of `sage.repl`, moving data needed by its doctests from `SAGE_EXTCODE` (= `src/sage/ext_data`) into the package directory. (Thus, we avoid a dependency on support for resources in namespace packages brought by Python 3.10(?) or the backport package `importlib-resources`, see https://github.com/python/importlib_resources/pull/196)\n\nFollow-up tickets will deal with other parts of the library. In the end, the directory `src/sage/ext_data` will be eliminated.\n\nReferences:\n- https://docs.python.org/3/library/importlib.html#module-importlib.resources\n- https://importlib-resources.readthedocs.io/en/latest/migration.html\n- https://importlib-resources.readthedocs.io/en/latest/using.html\n\n\n\n**CC:**  @tobiasdiez @fchapoton @kiwifb @dimpase @soehms @tscrim\n\n**Branch/Commit:** [d925cd2f322cf8230a6e9f86bef03ce020fc12bf](https://github.com/sagemath/sagetrac-mirror/commit/d925cd2f322cf8230a6e9f86bef03ce020fc12bf)\n\n**Reviewer:** Dima Pasechnik\n\n**Author:** Matthias Koeppe\n\nIssue created by migration from https://trac.sagemath.org/ticket/31306\n\n",
    "closed_at": "2022-01-31T23:31:37Z",
    "created_at": "2021-01-30T18:16:23Z",
    "labels": [
        "component: refactoring",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.6",
    "title": "sage.repl: Replace use of SAGE_EXTCODE by importlib.resources",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31306",
    "user": "https://github.com/mkoeppe"
}
```
We eliminate direct reading of files from the package directories of sagelib by using `importlib.resources` (available since python 3.7) 
- `git grep 'SAGE_EXTCODE' src/sage`
- `git grep '__file__' src/sage`

This will help make sagelib `zip_safe` (https://setuptools.readthedocs.io/en/latest/userguide/miscellaneous.html#setting-the-zip-safe-flag)

In this ticket, we take care of `sage.repl`, moving data needed by its doctests from `SAGE_EXTCODE` (= `src/sage/ext_data`) into the package directory. (Thus, we avoid a dependency on support for resources in namespace packages brought by Python 3.10(?) or the backport package `importlib-resources`, see https://github.com/python/importlib_resources/pull/196)

Follow-up tickets will deal with other parts of the library. In the end, the directory `src/sage/ext_data` will be eliminated.

References:
- https://docs.python.org/3/library/importlib.html#module-importlib.resources
- https://importlib-resources.readthedocs.io/en/latest/migration.html
- https://importlib-resources.readthedocs.io/en/latest/using.html



**CC:**  @tobiasdiez @fchapoton @kiwifb @dimpase @soehms @tscrim

**Branch/Commit:** [d925cd2f322cf8230a6e9f86bef03ce020fc12bf](https://github.com/sagemath/sagetrac-mirror/commit/d925cd2f322cf8230a6e9f86bef03ce020fc12bf)

**Reviewer:** Dima Pasechnik

**Author:** Matthias Koeppe

Issue created by migration from https://trac.sagemath.org/ticket/31306





---

archive/issue_events_285360.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31306#event-285360"
}
```



---

archive/issue_events_285361.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31306#event-285361"
}
```



---

archive/issue_comments_506200.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,10 +1,8 @@\n-We eliminate direct reading of files from the package directories of sagelib by using `importlib.resources`. \n+We eliminate direct reading of files from the package directories of sagelib by using `importlib.resources` (available since python 3.7) \n - `git grep 'SAGE_EXTCODE' src/sage`\n - `git grep '__file__' src/sage`\n \n This will help make sagelib `zip_safe` (https://setuptools.readthedocs.io/en/latest/userguide/miscellaneous.html#setting-the-zip-safe-flag)\n-\n-(requires python 3.7 (hence the dependency on #30551) or add the backport package `importlib_resources` if we want to support 3.6 - but that does not support resources within native namespace packages)\n \n References:\n - https://docs.python.org/3/library/importlib.html#module-importlib.resources\n``````\n",
    "created_at": "2021-12-06T02:04:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506200",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,10 +1,8 @@
-We eliminate direct reading of files from the package directories of sagelib by using `importlib.resources`. 
+We eliminate direct reading of files from the package directories of sagelib by using `importlib.resources` (available since python 3.7) 
 - `git grep 'SAGE_EXTCODE' src/sage`
 - `git grep '__file__' src/sage`
 
 This will help make sagelib `zip_safe` (https://setuptools.readthedocs.io/en/latest/userguide/miscellaneous.html#setting-the-zip-safe-flag)
-
-(requires python 3.7 (hence the dependency on #30551) or add the backport package `importlib_resources` if we want to support 3.6 - but that does not support resources within native namespace packages)
 
 References:
 - https://docs.python.org/3/library/importlib.html#module-importlib.resources
``````




---

archive/issue_comments_506201.json:
```json
{
    "body": "**Changing dependencies** from \"#30551\" to \"#30551, #31386\".",
    "created_at": "2021-12-06T02:04:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506201",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#30551" to "#30551, #31386".



---

archive/issue_comments_506202.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/replace_use_of_sage_extcode_by_importlib_resources](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/replace_use_of_sage_extcode_by_importlib_resources)",
    "created_at": "2021-12-06T02:57:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506202",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/replace_use_of_sage_extcode_by_importlib_resources](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/replace_use_of_sage_extcode_by_importlib_resources)



---

archive/issue_comments_506203.json:
```json
{
    "body": "**Commit:** [b2cb173ba4080b77d80e845313ed0cc325d13e92](https://github.com/sagemath/sagetrac-mirror/commit/b2cb173ba4080b77d80e845313ed0cc325d13e92)",
    "created_at": "2021-12-06T03:31:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506203",
    "user": "https://github.com/mkoeppe"
}
```

**Commit:** [b2cb173ba4080b77d80e845313ed0cc325d13e92](https://github.com/sagemath/sagetrac-mirror/commit/b2cb173ba4080b77d80e845313ed0cc325d13e92)



---

archive/issue_events_285362.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-06T03:31:03Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "rename": {
        "from": "Replace use of SAGE_EXTCODE by importlib.resources",
        "to": "sage.repl: Replace use of SAGE_EXTCODE by importlib.resources"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31306#event-285362"
}
```



---

archive/issue_comments_506204.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/77c957f44881baa2f9b9c9a41a94098d9b9a0d7d\">77c957f</a></td><td><code>src/doc/en/developer/packaging_sage_library.rst: Put hierarchy section one level higher</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9375ef85a66d83c62fe9658c7e99beff873db651\">9375ef8</a></td><td><code>pkgs/sagemath-standard/tox.ini: Use SAGE_VENV or venv symlink to find wheels</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6fc11169fb777a699b6c0dd7d99c6197eb9a1f9\">c6fc111</a></td><td><code>Prettier diagram</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7d6a44ce9551bfcdde44897c9676281028bafbdb\">7d6a44c</a></td><td><code>Use :mod: as markup for packages/modules</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f83d424d1270d03643d41c47d697c0931b0627dc\">f83d424</a></td><td><code>Improve ABC example</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/817a8d0ccc1b65d7bd2d38b2e4b8bcb572ced84f\">817a8d0</a></td><td><code>src/doc/en/developer/packaging_sage_library.rst: More :mod: and :class: markup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b555735c504a86cb0f465afad5daee82db69d77f\">b555735</a></td><td><code>src/doc/en/developer/packaging_sage_library.rst: Link to pypi.org and to documentation of packaging metadata</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/81e9c9a2f3ecad50854d98fe541869b64b4ea2f4\">81e9c9a</a></td><td><code>Merge #32899</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/af47b5f535ba4199128a3575732aaadc92252558\">af47b5f</a></td><td><code>Merge #31386</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b2cb173ba4080b77d80e845313ed0cc325d13e92\">b2cb173</a></td><td><code>src/sage/repl/rich_output/: Move example files here from src/sage/ext_data, use importlib.resources</code></td></tr></table>\n",
    "created_at": "2021-12-06T03:31:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506204",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>
**Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/77c957f44881baa2f9b9c9a41a94098d9b9a0d7d">77c957f</a></td><td><code>src/doc/en/developer/packaging_sage_library.rst: Put hierarchy section one level higher</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9375ef85a66d83c62fe9658c7e99beff873db651">9375ef8</a></td><td><code>pkgs/sagemath-standard/tox.ini: Use SAGE_VENV or venv symlink to find wheels</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6fc11169fb777a699b6c0dd7d99c6197eb9a1f9">c6fc111</a></td><td><code>Prettier diagram</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7d6a44ce9551bfcdde44897c9676281028bafbdb">7d6a44c</a></td><td><code>Use :mod: as markup for packages/modules</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f83d424d1270d03643d41c47d697c0931b0627dc">f83d424</a></td><td><code>Improve ABC example</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/817a8d0ccc1b65d7bd2d38b2e4b8bcb572ced84f">817a8d0</a></td><td><code>src/doc/en/developer/packaging_sage_library.rst: More :mod: and :class: markup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b555735c504a86cb0f465afad5daee82db69d77f">b555735</a></td><td><code>src/doc/en/developer/packaging_sage_library.rst: Link to pypi.org and to documentation of packaging metadata</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/81e9c9a2f3ecad50854d98fe541869b64b4ea2f4">81e9c9a</a></td><td><code>Merge #32899</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/af47b5f535ba4199128a3575732aaadc92252558">af47b5f</a></td><td><code>Merge #31386</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b2cb173ba4080b77d80e845313ed0cc325d13e92">b2cb173</a></td><td><code>src/sage/repl/rich_output/: Move example files here from src/sage/ext_data, use importlib.resources</code></td></tr></table>




---

archive/issue_comments_506205.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f63cce4ed14254a74ebf5627f88495db3896576\">0f63cce</a></td><td><code>src/sage/repl/display/formatter.py: Replace use of SAGE_EXTCODE in doctest by importlib.resources</code></td></tr></table>\n",
    "created_at": "2021-12-06T03:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506205",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f63cce4ed14254a74ebf5627f88495db3896576">0f63cce</a></td><td><code>src/sage/repl/display/formatter.py: Replace use of SAGE_EXTCODE in doctest by importlib.resources</code></td></tr></table>




---

archive/issue_comments_506206.json:
```json
{
    "body": "**Changing commit** from \"[b2cb173ba4080b77d80e845313ed0cc325d13e92](https://github.com/sagemath/sagetrac-mirror/commit/b2cb173ba4080b77d80e845313ed0cc325d13e92)\" to \"[0f63cce4ed14254a74ebf5627f88495db3896576](https://github.com/sagemath/sagetrac-mirror/commit/0f63cce4ed14254a74ebf5627f88495db3896576)\".",
    "created_at": "2021-12-06T03:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506206",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b2cb173ba4080b77d80e845313ed0cc325d13e92](https://github.com/sagemath/sagetrac-mirror/commit/b2cb173ba4080b77d80e845313ed0cc325d13e92)" to "[0f63cce4ed14254a74ebf5627f88495db3896576](https://github.com/sagemath/sagetrac-mirror/commit/0f63cce4ed14254a74ebf5627f88495db3896576)".



---

archive/issue_comments_506207.json:
```json
{
    "body": "**Author:** Matthias Koeppe",
    "created_at": "2021-12-06T03:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506207",
    "user": "https://github.com/mkoeppe"
}
```

**Author:** Matthias Koeppe



---

archive/issue_events_285363.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-06T03:56:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31306#event-285363"
}
```



---

archive/issue_comments_506208.json:
```json
{
    "body": "**Changing dependencies** from \"#30551, #31386\" to \"#31386\".",
    "created_at": "2021-12-06T03:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506208",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#30551, #31386" to "#31386".



---

archive/issue_comments_506209.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,6 +3,8 @@\n - `git grep '__file__' src/sage`\n \n This will help make sagelib `zip_safe` (https://setuptools.readthedocs.io/en/latest/userguide/miscellaneous.html#setting-the-zip-safe-flag)\n+\n+In this ticket, we take care of `sage.repl`. Follow-up tickets will deal with other parts of the library.\n \n References:\n - https://docs.python.org/3/library/importlib.html#module-importlib.resources\n``````\n",
    "created_at": "2021-12-06T17:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506209",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,6 +3,8 @@
 - `git grep '__file__' src/sage`
 
 This will help make sagelib `zip_safe` (https://setuptools.readthedocs.io/en/latest/userguide/miscellaneous.html#setting-the-zip-safe-flag)
+
+In this ticket, we take care of `sage.repl`. Follow-up tickets will deal with other parts of the library.
 
 References:
 - https://docs.python.org/3/library/importlib.html#module-importlib.resources
``````




---

archive/issue_comments_506210.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/09787af8a65445158522c07c8e76b01eacd5fdbe\">09787af</a></td><td><code>Merge tag '9.5.beta8' into t/31306/replace_use_of_sage_extcode_by_importlib_resources</code></td></tr></table>\n",
    "created_at": "2021-12-12T18:16:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506210",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/09787af8a65445158522c07c8e76b01eacd5fdbe">09787af</a></td><td><code>Merge tag '9.5.beta8' into t/31306/replace_use_of_sage_extcode_by_importlib_resources</code></td></tr></table>




---

archive/issue_comments_506211.json:
```json
{
    "body": "**Changing commit** from \"[0f63cce4ed14254a74ebf5627f88495db3896576](https://github.com/sagemath/sagetrac-mirror/commit/0f63cce4ed14254a74ebf5627f88495db3896576)\" to \"[09787af8a65445158522c07c8e76b01eacd5fdbe](https://github.com/sagemath/sagetrac-mirror/commit/09787af8a65445158522c07c8e76b01eacd5fdbe)\".",
    "created_at": "2021-12-12T18:16:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506211",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0f63cce4ed14254a74ebf5627f88495db3896576](https://github.com/sagemath/sagetrac-mirror/commit/0f63cce4ed14254a74ebf5627f88495db3896576)" to "[09787af8a65445158522c07c8e76b01eacd5fdbe](https://github.com/sagemath/sagetrac-mirror/commit/09787af8a65445158522c07c8e76b01eacd5fdbe)".



---

archive/issue_comments_506212.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -10,6 +10,6 @@\n - https://docs.python.org/3/library/importlib.html#module-importlib.resources\n - https://importlib-resources.readthedocs.io/en/latest/migration.html\n - https://importlib-resources.readthedocs.io/en/latest/using.html\n+- https://github.com/python/importlib_resources/pull/196 - Add support for resources in namespace packages\n \n \n-\n``````\n",
    "created_at": "2021-12-17T03:36:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506212",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -10,6 +10,6 @@
 - https://docs.python.org/3/library/importlib.html#module-importlib.resources
 - https://importlib-resources.readthedocs.io/en/latest/migration.html
 - https://importlib-resources.readthedocs.io/en/latest/using.html
+- https://github.com/python/importlib_resources/pull/196 - Add support for resources in namespace packages
 
 
-
``````




---

archive/issue_comments_506213.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,12 +4,13 @@\n \n This will help make sagelib `zip_safe` (https://setuptools.readthedocs.io/en/latest/userguide/miscellaneous.html#setting-the-zip-safe-flag)\n \n-In this ticket, we take care of `sage.repl`. Follow-up tickets will deal with other parts of the library.\n+In this ticket, we take care of `sage.repl`, moving data needed by its doctests from `SAGE_EXTCODE` (= `src/sage/ext_data`) into the package directory. (Thus, we avoid a dependency on support for resources in namespace packages brought by Python 3.10(?) or the backport package `importlib-resources`, see https://github.com/python/importlib_resources/pull/196)\n+\n+Follow-up tickets will deal with other parts of the library. In the end, the directory `src/sage/ext_data` will be eliminated.\n \n References:\n - https://docs.python.org/3/library/importlib.html#module-importlib.resources\n - https://importlib-resources.readthedocs.io/en/latest/migration.html\n - https://importlib-resources.readthedocs.io/en/latest/using.html\n-- https://github.com/python/importlib_resources/pull/196 - Add support for resources in namespace packages\n \n \n``````\n",
    "created_at": "2021-12-17T16:35:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506213",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,12 +4,13 @@
 
 This will help make sagelib `zip_safe` (https://setuptools.readthedocs.io/en/latest/userguide/miscellaneous.html#setting-the-zip-safe-flag)
 
-In this ticket, we take care of `sage.repl`. Follow-up tickets will deal with other parts of the library.
+In this ticket, we take care of `sage.repl`, moving data needed by its doctests from `SAGE_EXTCODE` (= `src/sage/ext_data`) into the package directory. (Thus, we avoid a dependency on support for resources in namespace packages brought by Python 3.10(?) or the backport package `importlib-resources`, see https://github.com/python/importlib_resources/pull/196)
+
+Follow-up tickets will deal with other parts of the library. In the end, the directory `src/sage/ext_data` will be eliminated.
 
 References:
 - https://docs.python.org/3/library/importlib.html#module-importlib.resources
 - https://importlib-resources.readthedocs.io/en/latest/migration.html
 - https://importlib-resources.readthedocs.io/en/latest/using.html
-- https://github.com/python/importlib_resources/pull/196 - Add support for resources in namespace packages
 
 
``````




---

archive/issue_comments_506214.json:
```json
{
    "body": "<a id='comment:13'></a>\nThe testsuite failures are unrelated",
    "created_at": "2021-12-17T16:37:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506214",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>
The testsuite failures are unrelated



---

archive/issue_comments_506215.json:
```json
{
    "body": "<a id='comment:14'></a>\nlgtm",
    "created_at": "2021-12-18T00:04:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506215",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:14'></a>
lgtm



---

archive/issue_events_285364.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-12-18T00:04:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31306#event-285364"
}
```



---

archive/issue_events_285365.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-12-18T00:04:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31306#event-285365"
}
```



---

archive/issue_comments_506216.json:
```json
{
    "body": "**Reviewer:** Dima Pasechnik",
    "created_at": "2021-12-18T00:04:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506216",
    "user": "https://github.com/dimpase"
}
```

**Reviewer:** Dima Pasechnik



---

archive/issue_comments_506217.json:
```json
{
    "body": "<a id='comment:15'></a>\nThanks!",
    "created_at": "2021-12-18T00:57:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506217",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>
Thanks!



---

archive/issue_comments_506218.json:
```json
{
    "body": "**Changing commit** from \"[09787af8a65445158522c07c8e76b01eacd5fdbe](https://github.com/sagemath/sagetrac-mirror/commit/09787af8a65445158522c07c8e76b01eacd5fdbe)\" to \"[9873958f9f942637116a8742b8a179117c95b20e](https://github.com/sagemath/sagetrac-mirror/commit/9873958f9f942637116a8742b8a179117c95b20e)\".",
    "created_at": "2021-12-23T21:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506218",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[09787af8a65445158522c07c8e76b01eacd5fdbe](https://github.com/sagemath/sagetrac-mirror/commit/09787af8a65445158522c07c8e76b01eacd5fdbe)" to "[9873958f9f942637116a8742b8a179117c95b20e](https://github.com/sagemath/sagetrac-mirror/commit/9873958f9f942637116a8742b8a179117c95b20e)".



---

archive/issue_comments_506219.json:
```json
{
    "body": "<a id='comment:16'></a>\n**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9873958f9f942637116a8742b8a179117c95b20e\">9873958</a></td><td><code>Merge tag '9.5.beta9' into t/31306/replace_use_of_sage_extcode_by_importlib_resources</code></td></tr></table>\n",
    "created_at": "2021-12-23T21:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506219",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9873958f9f942637116a8742b8a179117c95b20e">9873958</a></td><td><code>Merge tag '9.5.beta9' into t/31306/replace_use_of_sage_extcode_by_importlib_resources</code></td></tr></table>




---

archive/issue_events_285366.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2021-12-23T21:25:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31306#event-285366"
}
```



---

archive/issue_events_285367.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2021-12-23T21:25:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31306#event-285367"
}
```



---

archive/issue_events_285368.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-23T21:25:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31306#event-285368"
}
```



---

archive/issue_events_285369.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-23T21:25:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31306#event-285369"
}
```



---

archive/issue_comments_506220.json:
```json
{
    "body": "<a id='comment:17'></a>\ntrivial merge",
    "created_at": "2021-12-23T21:25:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506220",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>
trivial merge



---

archive/issue_events_285370.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-10T00:37:38Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31306#event-285370"
}
```



---

archive/issue_events_285371.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-10T00:37:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31306#event-285371"
}
```



---

archive/issue_events_285372.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2022-01-23T01:57:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31306#event-285372"
}
```



---

archive/issue_events_285373.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2022-01-23T01:57:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31306#event-285373"
}
```



---

archive/issue_comments_506221.json:
```json
{
    "body": "<a id='comment:19'></a>\n**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d925cd2f322cf8230a6e9f86bef03ce020fc12bf\">d925cd2</a></td><td><code>Merge tag '9.5.rc3' into t/31306/replace_use_of_sage_extcode_by_importlib_resources</code></td></tr></table>\n",
    "created_at": "2022-01-23T01:57:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506221",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d925cd2f322cf8230a6e9f86bef03ce020fc12bf">d925cd2</a></td><td><code>Merge tag '9.5.rc3' into t/31306/replace_use_of_sage_extcode_by_importlib_resources</code></td></tr></table>




---

archive/issue_comments_506222.json:
```json
{
    "body": "**Changing commit** from \"[9873958f9f942637116a8742b8a179117c95b20e](https://github.com/sagemath/sagetrac-mirror/commit/9873958f9f942637116a8742b8a179117c95b20e)\" to \"[d925cd2f322cf8230a6e9f86bef03ce020fc12bf](https://github.com/sagemath/sagetrac-mirror/commit/d925cd2f322cf8230a6e9f86bef03ce020fc12bf)\".",
    "created_at": "2022-01-23T01:57:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506222",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9873958f9f942637116a8742b8a179117c95b20e](https://github.com/sagemath/sagetrac-mirror/commit/9873958f9f942637116a8742b8a179117c95b20e)" to "[d925cd2f322cf8230a6e9f86bef03ce020fc12bf](https://github.com/sagemath/sagetrac-mirror/commit/d925cd2f322cf8230a6e9f86bef03ce020fc12bf)".



---

archive/issue_comments_506223.json:
```json
{
    "body": "**Changing dependencies** from \"#31386\" to \"\".",
    "created_at": "2022-01-23T01:58:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506223",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#31386" to "".



---

archive/issue_events_285374.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-23T01:58:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31306#event-285374"
}
```



---

archive/issue_events_285375.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-23T01:58:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31306#event-285375"
}
```



---

archive/issue_comments_506224.json:
```json
{
    "body": "<a id='comment:21'></a>\nOK, Volker has started merging stuff for 9.6 including this. And I get \n\n```\n$ sage -t --long --random-seed=241985268132368173591124256826068888319 /usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py\ntoo many failed tests, not using stored timings\nRunning doctests with ID 2022-01-31-20-37-00-111581fe.\nUsing --optional=pip,sage\nFeatures to be detected: 4ti2,benzene,bliss,buckygen,conway_polynomials,csdp,database_cremona_ellcurve,database_cremona_mini_ellcurve,database_jones_numfield,database_knotinfo,dvipng,graphviz,imagemagick,jupymake,kenzo,latte_int,lrslib,mcqd,meataxe,pandoc,pdf2svg,plantri,pynormaliz,python_igraph,rubiks,sage.combinat,sage.geometry.polyhedron,sage.graphs,sage.groups,sage.plot,sage.rings.number_field,sage.rings.padics,sage.rings.real_double,sage.symbolic,sage_numerical_backends_coin,sagemath_doc_html,sphinx,tdlib\nDoctesting 1 file.\nsage -t --long --random-seed=241985268132368173591124256826068888319 /usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py\n**********************************************************************\nFile \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py\", line 248, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate\nFailed example:\n    backend.validate(dm.types.OutputSceneWavefront.example())\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[15]>\", line 1, in <module>\n        backend.validate(dm.types.OutputSceneWavefront.example())\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_graphics3d.py\", line 354, in example\n        scene_obj = OutputBuffer.from_file(filename)\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 114, in from_file\n        buf._chmod_readonly(buf._filename)\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 146, in _chmod_readonly\n        os.chmod(filename, mode)\n    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example_wavefront_scene.obj'\n**********************************************************************\nFile \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py\", line 249, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate\nFailed example:\n    backend.validate(dm.types.OutputSceneCanvas3d.example())\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[16]>\", line 1, in <module>\n        backend.validate(dm.types.OutputSceneCanvas3d.example())\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_graphics3d.py\", line 161, in example\n        return cls(OutputBuffer.from_file(filename))\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 114, in from_file\n        buf._chmod_readonly(buf._filename)\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 146, in _chmod_readonly\n        os.chmod(filename, mode)\n    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example.canvas3d'\n**********************************************************************\nFile \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py\", line 250, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate\nFailed example:\n    backend.validate(dm.types.OutputVideoOgg.example())\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[17]>\", line 1, in <module>\n        backend.validate(dm.types.OutputVideoOgg.example())\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_video.py\", line 75, in example\n        return cls(OutputBuffer.from_file(filename),\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 114, in from_file\n        buf._chmod_readonly(buf._filename)\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 146, in _chmod_readonly\n        os.chmod(filename, mode)\n    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example.ogv'\n**********************************************************************\nFile \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py\", line 251, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate\nFailed example:\n    backend.validate(dm.types.OutputVideoWebM.example())\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[18]>\", line 1, in <module>\n        backend.validate(dm.types.OutputVideoWebM.example())\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_video.py\", line 75, in example\n        return cls(OutputBuffer.from_file(filename),\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 114, in from_file\n        buf._chmod_readonly(buf._filename)\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 146, in _chmod_readonly\n        os.chmod(filename, mode)\n    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example.webm'\n**********************************************************************\nFile \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py\", line 252, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate\nFailed example:\n    backend.validate(dm.types.OutputVideoMp4.example())\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[19]>\", line 1, in <module>\n        backend.validate(dm.types.OutputVideoMp4.example())\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_video.py\", line 75, in example\n        return cls(OutputBuffer.from_file(filename),\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 114, in from_file\n        buf._chmod_readonly(buf._filename)\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 146, in _chmod_readonly\n        os.chmod(filename, mode)\n    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example.mp4'\n**********************************************************************\nFile \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py\", line 253, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate\nFailed example:\n    backend.validate(dm.types.OutputVideoFlash.example())\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[20]>\", line 1, in <module>\n        backend.validate(dm.types.OutputVideoFlash.example())\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_video.py\", line 75, in example\n        return cls(OutputBuffer.from_file(filename),\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 114, in from_file\n        buf._chmod_readonly(buf._filename)\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 146, in _chmod_readonly\n        os.chmod(filename, mode)\n    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example.flv'\n**********************************************************************\nFile \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py\", line 254, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate\nFailed example:\n    backend.validate(dm.types.OutputVideoMatroska.example())\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[21]>\", line 1, in <module>\n        backend.validate(dm.types.OutputVideoMatroska.example())\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_video.py\", line 75, in example\n        return cls(OutputBuffer.from_file(filename),\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 114, in from_file\n        buf._chmod_readonly(buf._filename)\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 146, in _chmod_readonly\n        os.chmod(filename, mode)\n    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example.mkv'\n**********************************************************************\nFile \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py\", line 255, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate\nFailed example:\n    backend.validate(dm.types.OutputVideoAvi.example())\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[22]>\", line 1, in <module>\n        backend.validate(dm.types.OutputVideoAvi.example())\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_video.py\", line 75, in example\n        return cls(OutputBuffer.from_file(filename),\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 114, in from_file\n        buf._chmod_readonly(buf._filename)\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 146, in _chmod_readonly\n        os.chmod(filename, mode)\n    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example.avi'\n**********************************************************************\nFile \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py\", line 256, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate\nFailed example:\n    backend.validate(dm.types.OutputVideoWmv.example())\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[23]>\", line 1, in <module>\n        backend.validate(dm.types.OutputVideoWmv.example())\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_video.py\", line 75, in example\n        return cls(OutputBuffer.from_file(filename),\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 114, in from_file\n        buf._chmod_readonly(buf._filename)\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 146, in _chmod_readonly\n        os.chmod(filename, mode)\n    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example.wmv'\n**********************************************************************\nFile \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py\", line 257, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate\nFailed example:\n    backend.validate(dm.types.OutputVideoQuicktime.example())\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[24]>\", line 1, in <module>\n        backend.validate(dm.types.OutputVideoQuicktime.example())\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_video.py\", line 75, in example\n        return cls(OutputBuffer.from_file(filename),\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 114, in from_file\n        buf._chmod_readonly(buf._filename)\n      File \"/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py\", line 146, in _chmod_readonly\n        os.chmod(filename, mode)\n    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example.mov'\n**********************************************************************\n```\nAnd it comes down to that block https://github.com/sagemath/sage/blob/develop/src/sage/repl/rich_output/buffer.py#L139 - `chmod` is not done if the file is in the `SAGE_EXTCODE` folder but executed otherwise. Of course all those files have been moved out of `SAGE_EXTCODE`.",
    "created_at": "2022-01-31T08:02:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506224",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:21'></a>
OK, Volker has started merging stuff for 9.6 including this. And I get 

```
$ sage -t --long --random-seed=241985268132368173591124256826068888319 /usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py
too many failed tests, not using stored timings
Running doctests with ID 2022-01-31-20-37-00-111581fe.
Using --optional=pip,sage
Features to be detected: 4ti2,benzene,bliss,buckygen,conway_polynomials,csdp,database_cremona_ellcurve,database_cremona_mini_ellcurve,database_jones_numfield,database_knotinfo,dvipng,graphviz,imagemagick,jupymake,kenzo,latte_int,lrslib,mcqd,meataxe,pandoc,pdf2svg,plantri,pynormaliz,python_igraph,rubiks,sage.combinat,sage.geometry.polyhedron,sage.graphs,sage.groups,sage.plot,sage.rings.number_field,sage.rings.padics,sage.rings.real_double,sage.symbolic,sage_numerical_backends_coin,sagemath_doc_html,sphinx,tdlib
Doctesting 1 file.
sage -t --long --random-seed=241985268132368173591124256826068888319 /usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py
**********************************************************************
File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py", line 248, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate
Failed example:
    backend.validate(dm.types.OutputSceneWavefront.example())
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[15]>", line 1, in <module>
        backend.validate(dm.types.OutputSceneWavefront.example())
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_graphics3d.py", line 354, in example
        scene_obj = OutputBuffer.from_file(filename)
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 114, in from_file
        buf._chmod_readonly(buf._filename)
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 146, in _chmod_readonly
        os.chmod(filename, mode)
    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example_wavefront_scene.obj'
**********************************************************************
File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py", line 249, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate
Failed example:
    backend.validate(dm.types.OutputSceneCanvas3d.example())
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[16]>", line 1, in <module>
        backend.validate(dm.types.OutputSceneCanvas3d.example())
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_graphics3d.py", line 161, in example
        return cls(OutputBuffer.from_file(filename))
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 114, in from_file
        buf._chmod_readonly(buf._filename)
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 146, in _chmod_readonly
        os.chmod(filename, mode)
    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example.canvas3d'
**********************************************************************
File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py", line 250, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate
Failed example:
    backend.validate(dm.types.OutputVideoOgg.example())
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[17]>", line 1, in <module>
        backend.validate(dm.types.OutputVideoOgg.example())
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_video.py", line 75, in example
        return cls(OutputBuffer.from_file(filename),
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 114, in from_file
        buf._chmod_readonly(buf._filename)
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 146, in _chmod_readonly
        os.chmod(filename, mode)
    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example.ogv'
**********************************************************************
File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py", line 251, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate
Failed example:
    backend.validate(dm.types.OutputVideoWebM.example())
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[18]>", line 1, in <module>
        backend.validate(dm.types.OutputVideoWebM.example())
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_video.py", line 75, in example
        return cls(OutputBuffer.from_file(filename),
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 114, in from_file
        buf._chmod_readonly(buf._filename)
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 146, in _chmod_readonly
        os.chmod(filename, mode)
    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example.webm'
**********************************************************************
File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py", line 252, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate
Failed example:
    backend.validate(dm.types.OutputVideoMp4.example())
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[19]>", line 1, in <module>
        backend.validate(dm.types.OutputVideoMp4.example())
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_video.py", line 75, in example
        return cls(OutputBuffer.from_file(filename),
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 114, in from_file
        buf._chmod_readonly(buf._filename)
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 146, in _chmod_readonly
        os.chmod(filename, mode)
    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example.mp4'
**********************************************************************
File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py", line 253, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate
Failed example:
    backend.validate(dm.types.OutputVideoFlash.example())
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[20]>", line 1, in <module>
        backend.validate(dm.types.OutputVideoFlash.example())
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_video.py", line 75, in example
        return cls(OutputBuffer.from_file(filename),
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 114, in from_file
        buf._chmod_readonly(buf._filename)
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 146, in _chmod_readonly
        os.chmod(filename, mode)
    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example.flv'
**********************************************************************
File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py", line 254, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate
Failed example:
    backend.validate(dm.types.OutputVideoMatroska.example())
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[21]>", line 1, in <module>
        backend.validate(dm.types.OutputVideoMatroska.example())
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_video.py", line 75, in example
        return cls(OutputBuffer.from_file(filename),
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 114, in from_file
        buf._chmod_readonly(buf._filename)
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 146, in _chmod_readonly
        os.chmod(filename, mode)
    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example.mkv'
**********************************************************************
File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py", line 255, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate
Failed example:
    backend.validate(dm.types.OutputVideoAvi.example())
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[22]>", line 1, in <module>
        backend.validate(dm.types.OutputVideoAvi.example())
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_video.py", line 75, in example
        return cls(OutputBuffer.from_file(filename),
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 114, in from_file
        buf._chmod_readonly(buf._filename)
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 146, in _chmod_readonly
        os.chmod(filename, mode)
    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example.avi'
**********************************************************************
File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py", line 256, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate
Failed example:
    backend.validate(dm.types.OutputVideoWmv.example())
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[23]>", line 1, in <module>
        backend.validate(dm.types.OutputVideoWmv.example())
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_video.py", line 75, in example
        return cls(OutputBuffer.from_file(filename),
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 114, in from_file
        buf._chmod_readonly(buf._filename)
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 146, in _chmod_readonly
        os.chmod(filename, mode)
    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example.wmv'
**********************************************************************
File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/backend_doctest.py", line 257, in sage.repl.rich_output.backend_doctest.BackendDoctest.validate
Failed example:
    backend.validate(dm.types.OutputVideoQuicktime.example())
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.rich_output.backend_doctest.BackendDoctest.validate[24]>", line 1, in <module>
        backend.validate(dm.types.OutputVideoQuicktime.example())
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/output_video.py", line 75, in example
        return cls(OutputBuffer.from_file(filename),
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 114, in from_file
        buf._chmod_readonly(buf._filename)
      File "/usr/lib/python3.10/site-packages/sage/repl/rich_output/buffer.py", line 146, in _chmod_readonly
        os.chmod(filename, mode)
    PermissionError: [Errno 1] Operation not permitted: '/usr/lib/python3.10/site-packages/sage/repl/rich_output/example.mov'
**********************************************************************
```
And it comes down to that block https://github.com/sagemath/sage/blob/develop/src/sage/repl/rich_output/buffer.py#L139 - `chmod` is not done if the file is in the `SAGE_EXTCODE` folder but executed otherwise. Of course all those files have been moved out of `SAGE_EXTCODE`.



---

archive/issue_comments_506225.json:
```json
{
    "body": "<a id='comment:22'></a>\nI also have\n\n```\nsage -t --long --random-seed=241985268132368173591124256826068888319 /usr/lib/python3.10/site-packages/sage/repl/rich_output/output_graphics3d.py  # 25 doctests failed\nsage -t --long --random-seed=241985268132368173591124256826068888319 /usr/lib/python3.10/site-packages/sage/repl/rich_output/output_video.py  # 14 doctests failed\n```\nbecause of the same thing. I guess it doesn't fail on user space build because you can safely `chmod` anything.",
    "created_at": "2022-01-31T08:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506225",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:22'></a>
I also have

```
sage -t --long --random-seed=241985268132368173591124256826068888319 /usr/lib/python3.10/site-packages/sage/repl/rich_output/output_graphics3d.py  # 25 doctests failed
sage -t --long --random-seed=241985268132368173591124256826068888319 /usr/lib/python3.10/site-packages/sage/repl/rich_output/output_video.py  # 14 doctests failed
```
because of the same thing. I guess it doesn't fail on user space build because you can safely `chmod` anything.



---

archive/issue_comments_506226.json:
```json
{
    "body": "<a id='comment:23'></a>\nFollow up at #33256.",
    "created_at": "2022-01-31T09:17:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506226",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:23'></a>
Follow up at #33256.



---

archive/issue_comments_506227.json:
```json
{
    "body": "<a id='comment:24'></a>\nWow, doctesting of `/usr/lib/python3.10/site-packages/sage/`...",
    "created_at": "2022-01-31T12:54:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506227",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:24'></a>
Wow, doctesting of `/usr/lib/python3.10/site-packages/sage/`...



---

archive/issue_comments_506228.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [dimpase](#comment%3A24):\n> Wow, doctesting of `/usr/lib/python3.10/site-packages/sage/`...\n\n\nIs it the `python3.10` or the `/usr/lib/` that makes you go \"wow\"? I can do the `python3.9` flavor too if you want. I have been doctesting system installed sage and reporting from those tests for the last 10 years so I may be a bit blaz\u00e9 about it.",
    "created_at": "2022-01-31T18:37:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506228",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:25'></a>
Replying to [dimpase](#comment%3A24):
> Wow, doctesting of `/usr/lib/python3.10/site-packages/sage/`...


Is it the `python3.10` or the `/usr/lib/` that makes you go "wow"? I can do the `python3.9` flavor too if you want. I have been doctesting system installed sage and reporting from those tests for the last 10 years so I may be a bit blaz about it.



---

archive/issue_comments_506229.json:
```json
{
    "body": "<a id='comment:26'></a>\nit's about /usr/lib",
    "created_at": "2022-01-31T21:12:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506229",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:26'></a>
it's about /usr/lib



---

archive/issue_comments_506230.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/replace_use_of_sage_extcode_by_importlib_resources](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/replace_use_of_sage_extcode_by_importlib_resources)\" to \"[d925cd2f322cf8230a6e9f86bef03ce020fc12bf](https://github.com/sagemath/sagetrac-mirror/commit/d925cd2f322cf8230a6e9f86bef03ce020fc12bf)\".",
    "created_at": "2022-01-31T23:31:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31306#issuecomment-506230",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mkoeppe/replace_use_of_sage_extcode_by_importlib_resources](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/replace_use_of_sage_extcode_by_importlib_resources)" to "[d925cd2f322cf8230a6e9f86bef03ce020fc12bf](https://github.com/sagemath/sagetrac-mirror/commit/d925cd2f322cf8230a6e9f86bef03ce020fc12bf)".



---

archive/issue_events_285376.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-01-31T23:31:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31306#event-285376"
}
```



---

archive/issue_events_285377.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-01-31T23:31:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31306",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31306#event-285377"
}
```
