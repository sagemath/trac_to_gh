# Issue 31146: cygwin-standard: fpylll build fails

archive/issues_030909.json:
```json
{
    "body": "https://github.com/kliem/sage/runs/1625789472\n\n```\n  building 'fpylll.config' extension\n  gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -O2 -g -march=native -O2 -g -march=native -Isrc/fpylll/fplll -I/opt/sage-255cf51a4f41b054d32a39562102877b0b18969f/include -I/opt/sage-255cf51a4f41b054d32a39562102877b0b18969f/lib/python3.8/site-packages/numpy/core/include -I/opt/sage-255cf51a4f41b054d32a39562102877b0b18969f/include/python3.8 -c build/src/fpylll/config.cpp -o build/temp.cygwin-3.1.7-x86_64-3.8/build/src/fpylll/config.o -std=c++11 -O2 -g -march=native\n  build/src/fpylll/config.cpp: In function 'int __pyx_pymod_exec_config(PyObject*)':\n  build/src/fpylll/config.cpp:1807:37: error: 'FPLLL_WITH_RECURSIVE_ENUM' was not declared in this scope\n   1807 |   __pyx_t_4 = __Pyx_PyBool_FromLong(FPLLL_WITH_RECURSIVE_ENUM); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 40, __pyx_L1_error)\n        |                                     ^~~~~~~~~~~~~~~~~~~~~~~~~\n  error: command 'gcc' failed with exit status 1\n  Building wheel for fpylll (setup.py): finished with status 'error'\n```\n\nCC:  @malb @kliem\n\nBranch/Commit: 1d379f723676354b7ea9c6e7bf314bf877a6ed8a\n\nUpstream: Fixed upstream, in a later stable release.\n\nReviewer: Martin Albrecht\n\nAuthor: Matthias Koeppe\n\nDependencies: #31127\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/31146\n\n",
    "closed_at": "2021-01-24T10:38:00Z",
    "created_at": "2021-01-01T20:54:47Z",
    "labels": [
        "component: packages: standard",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "cygwin-standard: fpylll build fails",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31146",
    "user": "https://github.com/mkoeppe"
}
```
https://github.com/kliem/sage/runs/1625789472

```
  building 'fpylll.config' extension
  gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -O2 -g -march=native -O2 -g -march=native -Isrc/fpylll/fplll -I/opt/sage-255cf51a4f41b054d32a39562102877b0b18969f/include -I/opt/sage-255cf51a4f41b054d32a39562102877b0b18969f/lib/python3.8/site-packages/numpy/core/include -I/opt/sage-255cf51a4f41b054d32a39562102877b0b18969f/include/python3.8 -c build/src/fpylll/config.cpp -o build/temp.cygwin-3.1.7-x86_64-3.8/build/src/fpylll/config.o -std=c++11 -O2 -g -march=native
  build/src/fpylll/config.cpp: In function 'int __pyx_pymod_exec_config(PyObject*)':
  build/src/fpylll/config.cpp:1807:37: error: 'FPLLL_WITH_RECURSIVE_ENUM' was not declared in this scope
   1807 |   __pyx_t_4 = __Pyx_PyBool_FromLong(FPLLL_WITH_RECURSIVE_ENUM); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 40, __pyx_L1_error)
        |                                     ^~~~~~~~~~~~~~~~~~~~~~~~~
  error: command 'gcc' failed with exit status 1
  Building wheel for fpylll (setup.py): finished with status 'error'
```

CC:  @malb @kliem

Branch/Commit: 1d379f723676354b7ea9c6e7bf314bf877a6ed8a

Upstream: Fixed upstream, in a later stable release.

Reviewer: Martin Albrecht

Author: Matthias Koeppe

Dependencies: #31127

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/31146





---

archive/issue_comments_617968.json:
```json
{
    "body": "<a id='comment:1'></a>\n`FPLLL_WITH_RECURISVE_ENUM` is something that's set in `fplll_config.h` by `configure`. Is configure somehow not run on cygwin? Can I see `fplll_config.h` produced by this run somewhere?",
    "created_at": "2021-01-04T11:24:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617968",
    "user": "https://github.com/malb"
}
```

<a id='comment:1'></a>
`FPLLL_WITH_RECURISVE_ENUM` is something that's set in `fplll_config.h` by `configure`. Is configure somehow not run on cygwin? Can I see `fplll_config.h` produced by this run somewhere?



---

archive/issue_comments_617969.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe `sage-local` artifact (huge!) generated by the build should contain it",
    "created_at": "2021-01-06T19:09:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617969",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
The `sage-local` artifact (huge!) generated by the build should contain it



---

archive/issue_comments_617970.json:
```json
{
    "body": "<a id='comment:3'></a>\nHave you managed to download this? It is reportedly 7.4 GB but I'm only able to download 2.0GB.",
    "created_at": "2021-01-08T16:55:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617970",
    "user": "https://github.com/malb"
}
```

<a id='comment:3'></a>
Have you managed to download this? It is reportedly 7.4 GB but I'm only able to download 2.0GB.



---

archive/issue_comments_617971.json:
```json
{
    "body": "<a id='comment:4'></a>\nYes, I could download it but it turns out that it does not contain the package build directory; I'll investigate",
    "created_at": "2021-01-08T18:03:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617971",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>
Yes, I could download it but it turns out that it does not contain the package build directory; I'll investigate



---

archive/issue_comments_617972.json:
```json
{
    "body": "<a id='comment:5'></a>\nActually it's there, it is in sage-local-iv.tar",
    "created_at": "2021-01-08T18:07:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617972",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
Actually it's there, it is in sage-local-iv.tar



---

archive/issue_comments_617973.json:
```json
{
    "body": "<a id='comment:6'></a>\nAttachment [fpylll-0.5.4.zip](tarball://root/attachments/some-uuid/ticket31146/fpylll-0.5.4.zip) by @malb created at 2021-01-10 11:17:29\n\nSorry, I need the `fplll_config.h` file in FPLLL (without the \"y\"), and perhaps `config.log` It should define `FPLLL_WITH_RECURISVE_ENUM` but reportedly it doesn't. Which is odd.",
    "created_at": "2021-01-10T11:17:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617973",
    "user": "https://github.com/malb"
}
```

<a id='comment:6'></a>
Attachment [fpylll-0.5.4.zip](tarball://root/attachments/some-uuid/ticket31146/fpylll-0.5.4.zip) by @malb created at 2021-01-10 11:17:29

Sorry, I need the `fplll_config.h` file in FPLLL (without the "y"), and perhaps `config.log` It should define `FPLLL_WITH_RECURISVE_ENUM` but reportedly it doesn't. Which is odd.



---

archive/issue_comments_617974.json:
```json
{
    "body": "<a id='comment:7'></a>\nAttachment [fplll_config.h](tarball://root/attachments/some-uuid/ticket31146/fplll_config.h) by @mkoeppe created at 2021-01-10 18:32:03\n\nHere you go. The `config.log` from the `fplll` build was not saved by the run - it only keeps the build trees of failing packages.",
    "created_at": "2021-01-10T18:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617974",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
Attachment [fplll_config.h](tarball://root/attachments/some-uuid/ticket31146/fplll_config.h) by @mkoeppe created at 2021-01-10 18:32:03

Here you go. The `config.log` from the `fplll` build was not saved by the run - it only keeps the build trees of failing packages.



---

archive/issue_comments_617975.json:
```json
{
    "body": "<a id='comment:8'></a>\nTa, found the bug. Cutting a new release.",
    "created_at": "2021-01-11T14:46:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617975",
    "user": "https://github.com/malb"
}
```

<a id='comment:8'></a>
Ta, found the bug. Cutting a new release.



---

archive/issue_comments_617976.json:
```json
{
    "body": "<a id='comment:9'></a>\nWhat branch should base mine on?",
    "created_at": "2021-01-11T14:49:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617976",
    "user": "https://github.com/malb"
}
```

<a id='comment:9'></a>
What branch should base mine on?



---

archive/issue_comments_617977.json:
```json
{
    "body": "Changing upstream from \"N/A\" to \"Fixed upstream, in a later stable release.\"",
    "created_at": "2021-01-11T15:05:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617977",
    "user": "https://github.com/malb"
}
```

Changing upstream from "N/A" to "Fixed upstream, in a later stable release."



---

archive/issue_comments_617978.json:
```json
{
    "body": "<a id='comment:10'></a>\nhttps://github.com/fplll/fpylll/releases/tag/0.5.5",
    "created_at": "2021-01-11T15:05:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617978",
    "user": "https://github.com/malb"
}
```

<a id='comment:10'></a>
https://github.com/fplll/fpylll/releases/tag/0.5.5



---

archive/issue_comments_617979.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [malb](#comment%3A9):\n> What branch should base mine on?\n\n\nTo test with the newest version of the GH Actions workflow, merge the branch of #31064 and push a tag to github",
    "created_at": "2021-01-11T17:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617979",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
Replying to [malb](#comment%3A9):
> What branch should base mine on?


To test with the newest version of the GH Actions workflow, merge the branch of #31064 and push a tag to github



---

archive/issue_comments_617980.json:
```json
{
    "body": "<a id='comment:12'></a>\nSorry, I'll need a bit of handholding here:\n\n- I'd check out u/mkoeppe/ci_cygwin__yml__adjust_to_new_script_packages__bootstrap___prereq from git://trac.sagemath.org/sage.git\n- Do my update\n- Push to [GitHub](GitHub)? Which branch? I also might not have push rights to the [GitHub](GitHub) repo",
    "created_at": "2021-01-11T17:37:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617980",
    "user": "https://github.com/malb"
}
```

<a id='comment:12'></a>
Sorry, I'll need a bit of handholding here:

- I'd check out u/mkoeppe/ci_cygwin__yml__adjust_to_new_script_packages__bootstrap___prereq from git://trac.sagemath.org/sage.git
- Do my update
- Push to [GitHub](GitHub)? Which branch? I also might not have push rights to the [GitHub](GitHub) repo



---

archive/issue_comments_617981.json:
```json
{
    "body": "<a id='comment:13'></a>\nOur GH Actions workflows run on every tag and on every pull request. The procedure is documented here: https://doc.sagemath.org/html/en/developer/portability_testing.html#automatic-parallel-tox-runs-on-github-actions\nAny fork of the Sage repository with GH Actions enabled works for this purpose. I am using my fork at https://github.com/mkoeppe/sage",
    "created_at": "2021-01-11T18:05:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617981",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>
Our GH Actions workflows run on every tag and on every pull request. The procedure is documented here: https://doc.sagemath.org/html/en/developer/portability_testing.html#automatic-parallel-tox-runs-on-github-actions
Any fork of the Sage repository with GH Actions enabled works for this purpose. I am using my fork at https://github.com/mkoeppe/sage



---

archive/issue_comments_617982.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/cygwin_standard__fpylll_build_fails\"",
    "created_at": "2021-01-16T01:05:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617982",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/cygwin_standard__fpylll_build_fails"



---

archive/issue_comments_617983.json:
```json
{
    "body": "Changing commit from \"\" to \"1d379f723676354b7ea9c6e7bf314bf877a6ed8a\"",
    "created_at": "2021-01-16T01:06:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617983",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "1d379f723676354b7ea9c6e7bf314bf877a6ed8a"



---

archive/issue_comments_617984.json:
```json
{
    "body": "<a id='comment:15'></a>\nNew commits:\n|                                                                                                                                          |                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|\n|[a34250e](https://git.sagemath.org/sage.git/commit?id=a34250e46bf10729792ddc91cc333662bc7c160a)|`correctly detect homebrew fplll`|\n|[36c157c](https://git.sagemath.org/sage.git/commit?id=36c157c4986eaf8d81361c783b55b4e2412976ee)|`trac #31127: correct version test`|\n|[fb33fd5](https://git.sagemath.org/sage.git/commit?id=fb33fd5fe00c84f3404985da7c0752b3e7028c12)|`Merge commit '36c157c4986eaf8d81361c783b55b4e2412976ee' of git://trac.sagemath.org/sage into t/31146/cygwin_standard__fpylll_build_fails`|\n|[1d379f7](https://git.sagemath.org/sage.git/commit?id=1d379f723676354b7ea9c6e7bf314bf877a6ed8a)|`build/pkgs/fpylll: Upgrade to 0.5.5`|",
    "created_at": "2021-01-16T01:06:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617984",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>
New commits:
|                                                                                                                                          |                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
|[a34250e](https://git.sagemath.org/sage.git/commit?id=a34250e46bf10729792ddc91cc333662bc7c160a)|`correctly detect homebrew fplll`|
|[36c157c](https://git.sagemath.org/sage.git/commit?id=36c157c4986eaf8d81361c783b55b4e2412976ee)|`trac #31127: correct version test`|
|[fb33fd5](https://git.sagemath.org/sage.git/commit?id=fb33fd5fe00c84f3404985da7c0752b3e7028c12)|`Merge commit '36c157c4986eaf8d81361c783b55b4e2412976ee' of git://trac.sagemath.org/sage into t/31146/cygwin_standard__fpylll_build_fails`|
|[1d379f7](https://git.sagemath.org/sage.git/commit?id=1d379f723676354b7ea9c6e7bf314bf877a6ed8a)|`build/pkgs/fpylll: Upgrade to 0.5.5`|



---

archive/issue_comments_617985.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2021-01-16T01:06:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617985",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_617986.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#31127\"",
    "created_at": "2021-01-16T01:06:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617986",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#31127"



---

archive/issue_comments_617987.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-01-16T01:19:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617987",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_617988.json:
```json
{
    "body": "Changing reviewer from \"\" to \"https://github.com/mkoeppe/sage/actions/runs/489285130, https://github.com/mkoeppe/sage/actions/runs/489285125, https://github.com/mkoeppe/sage/actions/runs/489285124\"",
    "created_at": "2021-01-16T01:19:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617988",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "" to "https://github.com/mkoeppe/sage/actions/runs/489285130, https://github.com/mkoeppe/sage/actions/runs/489285125, https://github.com/mkoeppe/sage/actions/runs/489285124"



---

archive/issue_comments_617989.json:
```json
{
    "body": "<a id='comment:17'></a>\nLooks good to me. Sorry for me not stepping up earlier, I had the patch prepared but apparently failed to push it.",
    "created_at": "2021-01-16T11:19:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617989",
    "user": "https://github.com/malb"
}
```

<a id='comment:17'></a>
Looks good to me. Sorry for me not stepping up earlier, I had the patch prepared but apparently failed to push it.



---

archive/issue_comments_617990.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-01-16T11:19:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617990",
    "user": "https://github.com/malb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_617991.json:
```json
{
    "body": "Changing reviewer from \"https://github.com/mkoeppe/sage/actions/runs/489285130, https://github.com/mkoeppe/sage/actions/runs/489285125, https://github.com/mkoeppe/sage/actions/runs/489285124\" to \"Martin Albrecht\"",
    "created_at": "2021-01-16T17:48:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617991",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "https://github.com/mkoeppe/sage/actions/runs/489285130, https://github.com/mkoeppe/sage/actions/runs/489285125, https://github.com/mkoeppe/sage/actions/runs/489285124" to "Martin Albrecht"



---

archive/issue_comments_617992.json:
```json
{
    "body": "<a id='comment:19'></a>\n`cygwin-standard` - https://github.com/mkoeppe/sage/runs/1713927049\n\n```\n  [fpylll-0.5.5] successfully installed.\n```",
    "created_at": "2021-01-16T19:19:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617992",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>
`cygwin-standard` - https://github.com/mkoeppe/sage/runs/1713927049

```
  [fpylll-0.5.5] successfully installed.
```



---

archive/issue_events_081377.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-01-24T10:38:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31146#event-81377"
}
```



---

archive/issue_comments_617993.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-01-24T10:38:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617993",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_617994.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/cygwin_standard__fpylll_build_fails\" to \"1d379f723676354b7ea9c6e7bf314bf877a6ed8a\"",
    "created_at": "2021-01-24T10:38:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31146",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31146#issuecomment-617994",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/cygwin_standard__fpylll_build_fails" to "1d379f723676354b7ea9c6e7bf314bf877a6ed8a"
