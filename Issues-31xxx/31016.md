# Issue 31016: Meta-ticket: Downstream patch upstreaming

archive/issues_030779.json:
```json
{
    "assignees": [],
    "body": "https://wiki.sagemath.org/days111\n\n- Arch: https://aur.archlinux.org/cgit/aur.git/tree/?h=sagemath-git\n\n- Gentoo: https://github.com/cschwan/sage-on-gentoo/tree/master/sci-mathematics/sage\n\n- Debian: https://salsa.debian.org/math-team/sagemath/tree/master/debian/patches\n\n- macOS: https://github.com/3-manifolds/Sage_macOS/tree/main/Sage_framework\n\n- void linux: https://github.com/void-linux/void-packages/tree/master/srcpkgs/sagemath\n\nSee also: https://wiki.sagemath.org/Distribution\n\nIssues:\n\n- #31041: `sage.misc.cython` -- `libdir` (gentoo)\n- #31032: some raw strings for pdf docbuilding (gentoo) \n- #21571: install `COPYING.txt` with documentation and find it there (gentoo)\n- #31037: Install missing tests (Arch) \n\n```\ncp -r sage/tests/books \"$pkgdir\"/$_pythonpath/sage/tests\n```\n- Make latte program prefix (or just \"count\" program name) configurable\n- #30296: mathjax\n- #31384: `cython_aliases`\n\nCC:  @tobihan @antonio-rojas @kiwifb @orlitzky @isuruf @jamesjer @slel @tornaria @culler\n\nKeywords: **sd111**\n\nComponent: **porting**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31016_\n\n",
    "created_at": "2020-12-06T16:44:01Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20porting",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Meta-ticket: Downstream patch upstreaming",
    "type": "issue",
    "updated_at": "2022-09-19T18:58:47Z",
    "url": "https://github.com/sagemath/sage/issues/31016",
    "user": "https://github.com/mkoeppe"
}
```
https://wiki.sagemath.org/days111

- Arch: https://aur.archlinux.org/cgit/aur.git/tree/?h=sagemath-git

- Gentoo: https://github.com/cschwan/sage-on-gentoo/tree/master/sci-mathematics/sage

- Debian: https://salsa.debian.org/math-team/sagemath/tree/master/debian/patches

- macOS: https://github.com/3-manifolds/Sage_macOS/tree/main/Sage_framework

- void linux: https://github.com/void-linux/void-packages/tree/master/srcpkgs/sagemath

See also: https://wiki.sagemath.org/Distribution

Issues:

- #31041: `sage.misc.cython` -- `libdir` (gentoo)
- #31032: some raw strings for pdf docbuilding (gentoo) 
- #21571: install `COPYING.txt` with documentation and find it there (gentoo)
- #31037: Install missing tests (Arch) 

```
cp -r sage/tests/books "$pkgdir"/$_pythonpath/sage/tests
```
- Make latte program prefix (or just "count" program name) configurable
- #30296: mathjax
- #31384: `cython_aliases`

CC:  @tobihan @antonio-rojas @kiwifb @orlitzky @isuruf @jamesjer @slel @tornaria @culler

Keywords: **sd111**

Component: **porting**

_Issue created by migration from https://trac.sagemath.org/ticket/31016_





---

archive/issue_events_424612.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-12-06T16:44:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31016#event-424612"
}
```



---

archive/issue_events_424613.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-12-06T16:44:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20porting",
    "label_color": "0000b0",
    "label_name": "c: porting",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31016#event-424613"
}
```



---

archive/issue_events_424614.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-12-06T16:44:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31016#event-424614"
}
```



---

archive/issue_comments_497024.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,13 @@\n https://wiki.sagemath.org/days111\n \n+- Arch: https://aur.archlinux.org/cgit/aur.git/tree/?h=sagemath-git\n+\n+- Gentoo: https://github.com/cschwan/sage-on-gentoo/tree/master/sci-mathematics/sage\n+\n+\n+\n+Issues:\n+\n+- sage.misc.cython -- libdir (gentoo)\n+\n+\n``````\n",
    "created_at": "2020-12-08T21:42:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497024",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,13 @@
 https://wiki.sagemath.org/days111
 
+- Arch: https://aur.archlinux.org/cgit/aur.git/tree/?h=sagemath-git
+
+- Gentoo: https://github.com/cschwan/sage-on-gentoo/tree/master/sci-mathematics/sage
+
+
+
+Issues:
+
+- sage.misc.cython -- libdir (gentoo)
+
+
``````




---

archive/issue_comments_497025.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,6 +4,7 @@\n \n - Gentoo: https://github.com/cschwan/sage-on-gentoo/tree/master/sci-mathematics/sage\n \n+- Debian: https://sources.debian.org/patches/sagemath/9.2-2/\n \n \n Issues:\n``````\n",
    "created_at": "2020-12-08T21:51:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497025",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,6 +4,7 @@
 
 - Gentoo: https://github.com/cschwan/sage-on-gentoo/tree/master/sci-mathematics/sage
 
+- Debian: https://sources.debian.org/patches/sagemath/9.2-2/
 
 
 Issues:
``````




---

archive/issue_comments_497026.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,11 +4,15 @@\n \n - Gentoo: https://github.com/cschwan/sage-on-gentoo/tree/master/sci-mathematics/sage\n \n-- Debian: https://sources.debian.org/patches/sagemath/9.2-2/\n \n \n Issues:\n \n - sage.misc.cython -- libdir (gentoo)\n \n+- # Install tests\n \n+```\n+  cp -r sage/doctest/tests \"$pkgdir\"/$_pythonpath/sage/doctest\n+  cp -r sage/tests/books \"$pkgdir\"/$_pythonpath/sage/tests\n+```\n``````\n",
    "created_at": "2020-12-08T22:22:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497026",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,11 +4,15 @@
 
 - Gentoo: https://github.com/cschwan/sage-on-gentoo/tree/master/sci-mathematics/sage
 
-- Debian: https://sources.debian.org/patches/sagemath/9.2-2/
 
 
 Issues:
 
 - sage.misc.cython -- libdir (gentoo)
 
+- # Install tests
 
+```
+  cp -r sage/doctest/tests "$pkgdir"/$_pythonpath/sage/doctest
+  cp -r sage/tests/books "$pkgdir"/$_pythonpath/sage/tests
+```
``````




---

archive/issue_comments_497027.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,3 +16,7 @@\n   cp -r sage/doctest/tests \"$pkgdir\"/$_pythonpath/sage/doctest\n   cp -r sage/tests/books \"$pkgdir\"/$_pythonpath/sage/tests\n ```\n+\n+- Make latte program prefix (or just \"count\" program name) configurable\n+\n+\n``````\n",
    "created_at": "2020-12-08T22:25:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497027",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,3 +16,7 @@
   cp -r sage/doctest/tests "$pkgdir"/$_pythonpath/sage/doctest
   cp -r sage/tests/books "$pkgdir"/$_pythonpath/sage/tests
 ```
+
+- Make latte program prefix (or just "count" program name) configurable
+
+
``````




---

archive/issue_comments_497028.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,7 +4,7 @@\n \n - Gentoo: https://github.com/cschwan/sage-on-gentoo/tree/master/sci-mathematics/sage\n \n-\n+- Debian: https://sources.debian.org/patches/sagemath/9.2-2/\n \n Issues:\n \n``````\n",
    "created_at": "2020-12-08T22:35:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497028",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,7 +4,7 @@
 
 - Gentoo: https://github.com/cschwan/sage-on-gentoo/tree/master/sci-mathematics/sage
 
-
+- Debian: https://sources.debian.org/patches/sagemath/9.2-2/
 
 Issues:
 
``````




---

archive/issue_comments_497029.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,6 +9,8 @@\n Issues:\n \n - sage.misc.cython -- libdir (gentoo)\n+- some raw strings for pdf docbuilding (gentoo)\n+- install `COPYING.txt` with documentation and find it there (gentoo)\n \n - # Install tests\n \n``````\n",
    "created_at": "2020-12-08T23:49:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497029",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,6 +9,8 @@
 Issues:
 
 - sage.misc.cython -- libdir (gentoo)
+- some raw strings for pdf docbuilding (gentoo)
+- install `COPYING.txt` with documentation and find it there (gentoo)
 
 - # Install tests
 
``````




---

archive/issue_comments_497030.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,4 +21,4 @@\n \n - Make latte program prefix (or just \"count\" program name) configurable\n \n-\n+- mathjax (see #30296)\n``````\n",
    "created_at": "2020-12-09T01:00:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497030",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,4 +21,4 @@
 
 - Make latte program prefix (or just "count" program name) configurable
 
-
+- mathjax (see #30296)
``````




---

archive/issue_comments_497031.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,7 +9,7 @@\n Issues:\n \n - sage.misc.cython -- libdir (gentoo)\n-- some raw strings for pdf docbuilding (gentoo)\n+- some raw strings for pdf docbuilding (gentoo) #31032\n - install `COPYING.txt` with documentation and find it there (gentoo)\n \n - # Install tests\n``````\n",
    "created_at": "2020-12-09T09:50:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497031",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,7 +9,7 @@
 Issues:
 
 - sage.misc.cython -- libdir (gentoo)
-- some raw strings for pdf docbuilding (gentoo)
+- some raw strings for pdf docbuilding (gentoo) #31032
 - install `COPYING.txt` with documentation and find it there (gentoo)
 
 - # Install tests
``````




---

archive/issue_comments_497032.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nShould I add my language selection options for building the documentation?",
    "created_at": "2020-12-09T09:50:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497032",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:8" align="right">comment:8</div>

Should I add my language selection options for building the documentation?



---

archive/issue_comments_497033.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nSome of the reasons we still run configure and make to build the Debian package:\n\n- In order to run the tests during package build we need a working sage (without installing it into the system).\n- We are still installing var/libs/sage/installed since it is (or at least used to be) needed to detect which optional packages are installed.\n- It is hard to keep track how to build the parts other than sagelib separately (doc, jupyter kernel...) and to set everything up for running the tests before system installation.\n\nWill #29013 and `./configure --with-python=no` help with these problems? Will there also be a `make install` for the non-python parts of sage?",
    "created_at": "2020-12-09T10:14:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497033",
    "user": "https://github.com/tobihan"
}
```

<div id="comment:9" align="right">comment:9</div>

Some of the reasons we still run configure and make to build the Debian package:

- In order to run the tests during package build we need a working sage (without installing it into the system).
- We are still installing var/libs/sage/installed since it is (or at least used to be) needed to detect which optional packages are installed.
- It is hard to keep track how to build the parts other than sagelib separately (doc, jupyter kernel...) and to set everything up for running the tests before system installation.

Will #29013 and `./configure --with-python=no` help with these problems? Will there also be a `make install` for the non-python parts of sage?



---

archive/issue_comments_497034.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@tobihan](#comment%3A9):\n> Some of the reasons we still run configure and make to build the Debian package:\n> \n> - In order to run the tests during package build we need a working sage (without installing it into the system).\n> - We are still installing var/libs/sage/installed since it is (or at least used to be) needed to detect which optional packages are installed.\n> - It is hard to keep track how to build the parts other than sagelib separately (doc, jupyter kernel...) and to set everything up for running the tests before system installation.\n\nThese are of course all valid points.  The second point will hopefully be resolved soon in the course of the modularization, as the build will no longer depend on the presence of optional libraries.\n\nI hope we can resolve the third point soon. For example, I hope that we can put the docbuild into a separate Python package - that's #29868.\n\n> Will #29013 and `./configure --with-python=no` help with these problems?\n\nYes, I think it would offer a good route of transition for Debian packaging of Sage.  With `./configure --with-python=no`, which would imply `./configure --with-sage-venv=no` (#30896), plain `make` would just install the non-Python parts of sage.\n\nYou could then install the Python library of sage following the standard way how you package Python packages in Debian.",
    "created_at": "2020-12-10T03:36:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497034",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@tobihan](#comment%3A9):
> Some of the reasons we still run configure and make to build the Debian package:
> 
> - In order to run the tests during package build we need a working sage (without installing it into the system).
> - We are still installing var/libs/sage/installed since it is (or at least used to be) needed to detect which optional packages are installed.
> - It is hard to keep track how to build the parts other than sagelib separately (doc, jupyter kernel...) and to set everything up for running the tests before system installation.

These are of course all valid points.  The second point will hopefully be resolved soon in the course of the modularization, as the build will no longer depend on the presence of optional libraries.

I hope we can resolve the third point soon. For example, I hope that we can put the docbuild into a separate Python package - that's #29868.

> Will #29013 and `./configure --with-python=no` help with these problems?

Yes, I think it would offer a good route of transition for Debian packaging of Sage.  With `./configure --with-python=no`, which would imply `./configure --with-sage-venv=no` (#30896), plain `make` would just install the non-Python parts of sage.

You could then install the Python library of sage following the standard way how you package Python packages in Debian.



---

archive/issue_comments_497035.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,6 +5,8 @@\n - Gentoo: https://github.com/cschwan/sage-on-gentoo/tree/master/sci-mathematics/sage\n \n - Debian: https://sources.debian.org/patches/sagemath/9.2-2/\n+\n+See also: https://wiki.sagemath.org/Distribution\n \n Issues:\n \n``````\n",
    "created_at": "2020-12-10T06:03:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497035",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,6 +5,8 @@
 - Gentoo: https://github.com/cschwan/sage-on-gentoo/tree/master/sci-mathematics/sage
 
 - Debian: https://sources.debian.org/patches/sagemath/9.2-2/
+
+See also: https://wiki.sagemath.org/Distribution
 
 Issues:
 
``````




---

archive/issue_comments_497036.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nAfter double checking we already fixed the installation of text files. It looks like you may have been looking at an old ebuild. If not, that's something that should be updated to be current on my side.",
    "created_at": "2020-12-10T21:51:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497036",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:12" align="right">comment:12</div>

After double checking we already fixed the installation of text files. It looks like you may have been looking at an old ebuild. If not, that's something that should be updated to be current on my side.



---

archive/issue_comments_497037.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,13 +14,6 @@\n - some raw strings for pdf docbuilding (gentoo) #31032\n - install `COPYING.txt` with documentation and find it there (gentoo)\n \n-- # Install tests\n-\n-```\n-  cp -r sage/doctest/tests \"$pkgdir\"/$_pythonpath/sage/doctest\n-  cp -r sage/tests/books \"$pkgdir\"/$_pythonpath/sage/tests\n-```\n-\n - Make latte program prefix (or just \"count\" program name) configurable\n \n - mathjax (see #30296)\n``````\n",
    "created_at": "2020-12-10T21:51:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497037",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,13 +14,6 @@
 - some raw strings for pdf docbuilding (gentoo) #31032
 - install `COPYING.txt` with documentation and find it there (gentoo)
 
-- # Install tests
-
-```
-  cp -r sage/doctest/tests "$pkgdir"/$_pythonpath/sage/doctest
-  cp -r sage/tests/books "$pkgdir"/$_pythonpath/sage/tests
-```
-
 - Make latte program prefix (or just "count" program name) configurable
 
 - mathjax (see #30296)
``````




---

archive/issue_comments_497038.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@kiwifb](#comment%3A12):\n> After double checking we already fixed the installation of text files. It looks like you may have been looking at an old ebuild. If not, that's something that should be updated to be current on my side.\n\nThose lines came from the Arch PKGBUILD. Indeed it looks like `doctest/tests` is already being installed by setup.py, but `tests/books` is not.",
    "created_at": "2020-12-10T22:11:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497038",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@kiwifb](#comment%3A12):
> After double checking we already fixed the installation of text files. It looks like you may have been looking at an old ebuild. If not, that's something that should be updated to be current on my side.

Those lines came from the Arch PKGBUILD. Indeed it looks like `doctest/tests` is already being installed by setup.py, but `tests/books` is not.



---

archive/issue_comments_497039.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nIndeed I don't have them installed! It looks like they are python files so they having an `__init__.py` file in the affected directories should fix the issue I think.",
    "created_at": "2020-12-10T22:16:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497039",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:14" align="right">comment:14</div>

Indeed I don't have them installed! It looks like they are python files so they having an `__init__.py` file in the affected directories should fix the issue I think.



---

archive/issue_comments_497040.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,6 +14,13 @@\n - some raw strings for pdf docbuilding (gentoo) #31032\n - install `COPYING.txt` with documentation and find it there (gentoo)\n \n+- Install missing tests (Arch)\n+\n+```\n+cp -r sage/tests/books \"$pkgdir\"/$_pythonpath/sage/tests\n+```\n+\t \t\n+\n - Make latte program prefix (or just \"count\" program name) configurable\n \n - mathjax (see #30296)\n``````\n",
    "created_at": "2020-12-10T22:49:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497040",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,6 +14,13 @@
 - some raw strings for pdf docbuilding (gentoo) #31032
 - install `COPYING.txt` with documentation and find it there (gentoo)
 
+- Install missing tests (Arch)
+
+```
+cp -r sage/tests/books "$pkgdir"/$_pythonpath/sage/tests
+```
+	 	
+
 - Make latte program prefix (or just "count" program name) configurable
 
 - mathjax (see #30296)
``````




---

archive/issue_comments_497041.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@kiwifb](#comment%3A14):\n> Indeed I don't have them installed! It looks like they are python files so they having an `__init__.py` file in the affected directories should fix the issue I think.\n\nPutting `__init__.py` solves 99% of the problem. There is just a text file which we should decide whether or not to ship (it is not tested). This is a README\nhttps://github.com/sagemath/sage/blob/develop/src/sage/tests/books/computational-mathematics-with-sagemath/README",
    "created_at": "2020-12-10T23:51:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497041",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@kiwifb](#comment%3A14):
> Indeed I don't have them installed! It looks like they are python files so they having an `__init__.py` file in the affected directories should fix the issue I think.

Putting `__init__.py` solves 99% of the problem. There is just a text file which we should decide whether or not to ship (it is not tested). This is a README
https://github.com/sagemath/sage/blob/develop/src/sage/tests/books/computational-mathematics-with-sagemath/README



---

archive/issue_comments_497042.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI should add that using `__init__.py` is my favored solution because it also means that `pycache` will be autogenerated when installing. If I ship non precompiled python files, Gentoo automated QA will be on my back to do it manually.",
    "created_at": "2020-12-10T23:54:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497042",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:17" align="right">comment:17</div>

I should add that using `__init__.py` is my favored solution because it also means that `pycache` will be autogenerated when installing. If I ship non precompiled python files, Gentoo automated QA will be on my back to do it manually.



---

archive/issue_comments_497043.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,7 +14,7 @@\n - some raw strings for pdf docbuilding (gentoo) #31032\n - install `COPYING.txt` with documentation and find it there (gentoo)\n \n-- Install missing tests (Arch)\n+- Install missing tests (Arch) #31037\n \n ```\n cp -r sage/tests/books \"$pkgdir\"/$_pythonpath/sage/tests\n``````\n",
    "created_at": "2020-12-11T00:06:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497043",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,7 +14,7 @@
 - some raw strings for pdf docbuilding (gentoo) #31032
 - install `COPYING.txt` with documentation and find it there (gentoo)
 
-- Install missing tests (Arch)
+- Install missing tests (Arch) #31037
 
 ```
 cp -r sage/tests/books "$pkgdir"/$_pythonpath/sage/tests
``````




---

archive/issue_comments_497044.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,17 +10,14 @@\n \n Issues:\n \n-- sage.misc.cython -- libdir (gentoo)\n-- some raw strings for pdf docbuilding (gentoo) #31032\n-- install `COPYING.txt` with documentation and find it there (gentoo)\n-\n-- Install missing tests (Arch) #31037\n+- #31041: `sage.misc.cython` -- `libdir` (gentoo)\n+- #31032: some raw strings for pdf docbuilding (gentoo) \n+- #21571: install `COPYING.txt` with documentation and find it there (gentoo)\n+- #31037: Install missing tests (Arch) \n \n ```\n cp -r sage/tests/books \"$pkgdir\"/$_pythonpath/sage/tests\n ```\n-\t \t\n+- Make latte program prefix (or just \"count\" program name) configurable\n+- #30296: mathjax\n \n-- Make latte program prefix (or just \"count\" program name) configurable\n-\n-- mathjax (see #30296)\n``````\n",
    "created_at": "2020-12-11T19:13:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497044",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,17 +10,14 @@
 
 Issues:
 
-- sage.misc.cython -- libdir (gentoo)
-- some raw strings for pdf docbuilding (gentoo) #31032
-- install `COPYING.txt` with documentation and find it there (gentoo)
-
-- Install missing tests (Arch) #31037
+- #31041: `sage.misc.cython` -- `libdir` (gentoo)
+- #31032: some raw strings for pdf docbuilding (gentoo) 
+- #21571: install `COPYING.txt` with documentation and find it there (gentoo)
+- #31037: Install missing tests (Arch) 
 
 ```
 cp -r sage/tests/books "$pkgdir"/$_pythonpath/sage/tests
 ```
-	 	
+- Make latte program prefix (or just "count" program name) configurable
+- #30296: mathjax
 
-- Make latte program prefix (or just "count" program name) configurable
-
-- mathjax (see #30296)
``````




---

archive/issue_comments_497045.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -20,4 +20,4 @@\n ```\n - Make latte program prefix (or just \"count\" program name) configurable\n - #30296: mathjax\n-\n+- #31384: `cython_aliases`\n``````\n",
    "created_at": "2021-03-23T06:10:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497045",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -20,4 +20,4 @@
 ```
 - Make latte program prefix (or just "count" program name) configurable
 - #30296: mathjax
-
+- #31384: `cython_aliases`
``````




---

archive/issue_comments_497046.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nSage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-04-07T19:29:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497046",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:21" align="right">comment:21</div>

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_events_424615.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-07T19:29:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31016#event-424615"
}
```



---

archive/issue_events_424616.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-07T19:29:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31016#event-424616"
}
```



---

archive/issue_events_424617.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-10T17:30:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31016#event-424617"
}
```



---

archive/issue_events_424618.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-10T17:30:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31016#event-424618"
}
```



---

archive/issue_comments_497047.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,6 +5,8 @@\n - Gentoo: https://github.com/cschwan/sage-on-gentoo/tree/master/sci-mathematics/sage\n \n - Debian: https://sources.debian.org/patches/sagemath/9.2-2/\n+\n+- macOS: https://github.com/3-manifolds/Sage_macOS/tree/main/Sage_framework\n \n See also: https://wiki.sagemath.org/Distribution\n \n``````\n",
    "created_at": "2022-01-17T19:20:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497047",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,6 +5,8 @@
 - Gentoo: https://github.com/cschwan/sage-on-gentoo/tree/master/sci-mathematics/sage
 
 - Debian: https://sources.debian.org/patches/sagemath/9.2-2/
+
+- macOS: https://github.com/3-manifolds/Sage_macOS/tree/main/Sage_framework
 
 See also: https://wiki.sagemath.org/Distribution
 
``````




---

archive/issue_comments_497048.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nbump to 9.6",
    "created_at": "2022-01-29T08:58:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497048",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:25" align="right">comment:25</div>

bump to 9.6



---

archive/issue_events_424619.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-29T08:58:50Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31016#event-424619"
}
```



---

archive/issue_events_424620.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-01-29T08:58:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31016#event-424620"
}
```



---

archive/issue_comments_497049.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nAs of yesterday sagemath-9.5 is available on official void repos, working for x86_64 (glibc and musl libc) and i686 (32 bit, glibc only).\n\nThe build template is here:\n\nhttps://github.com/void-linux/void-packages/tree/master/srcpkgs/sagemath\n\nNotes:\n\n- after a few months of playing with installing sage-as-distro, I finally switched to installing sage-as-lib as it was suggested, and it's really much easier. However, starting with sage-as-distro was better while we were working on the other package dependencies. Once all packages were available switching to sage-as-lib was really easy.\n- we are applying 15 patches; of those:\n  - the 11 starting with numbers in [patches](https://github.com/void-linux/void-packages/tree/master/srcpkgs/sagemath/patches) should IMO be straightforward to upstream (as-is, except maybe 08-dont_run_pytest--see_31924.patch). All of them are very short except the last two which are just improving on `# long` tagging (thus non-essential but nice to have). I'll try to open individual tickets here for these.\n  - two patches `trac-*` are taken from tickets with positive review #33189 and #33226.\n  - two patches `zzz-*` are void specific, although the one about loadable_module_extension() I can think of a way to fix it in a generic way. The one about threejs... well, I just need to ship threejs but whatever, that's a stupid test since nothing else requires threejs, I might as well ship an empty directory to pass the test!\n- The template itself:\n  - Removes `sage/libs/ratpoints.{pyx,pxd}` since these are not used anywhere; maybe ratpoints spkg can be made optional and compile these files only if ratpoints is available?\n  - Builds from `pkgs/sagemath-standard`, however bootstrapping this requires some non-obvious moves. Can we have a `bootstrap` script in this directory that does \"the right thing\"? Here is my snippet:\n\n     ```\n   \t pushd $wrksrc/build/pkgs/sagelib\n   \t PATH=../../bin:$PATH BOOTSTRAP_QUIET=no ./bootstrap\n   \t popd\n    ```\n  - Patches `setup.cfg` so that `sage-venv-config` is not installed; that should not be necessary, besides it's actively harmful since having it set means `sage-env` will mess up with PATH in an undesirable way. In fact it's very hard to understand what is going on with PATH in `sage-env` (I guess it's just that there are a zillion different cases to be supported, but it's quite opaque) and it's missing at least the case I end up requiring (see next point).\n  - Creates a custom `sage-env-config` script with a single line `PATH=$(dirname $SELF):$PATH`; we need this because scripts will be installed in a custom location not in system path (currently `/usr/lib/sagemath/bin`) with a symlink to the `sage` script placed in `/usr/bin`.\n  - Configures some paths by appending to `sage/env.py`, that file is kind of weird, mixing settings with code and it keeps configuration variables in two different places: the module dict itself, and the SAGE_ENV dict. There's like 3 users of SAGE_ENV, wouldn't it make sense to kill it for consistency? The only reason I had to touch variables is because I decided to place databases in `/usr/share/sagemath` instead of directly in `/usr/share`, my fault I guess.\n- Other notes\n  - Running setup.py needs `PYTHONPATH=../sage-setup`, I took that from arch. Should this (and the previous bootstrap step) be documented in `README.rst`?\n  - Building with multiple jobs works fine when setting `SAGE_NUM_THREADS` to the number of threads (also took that hint from arch, also nice to document).\n  - The jupyter kernel install is bad: it installs symlinks for the logo which point to the build directory, which won't exist at runtime. I replace the symlinks by hard copies. I also change the spec from running `/usr/bin/sage --python` to `/usr/bin/python` because that works regardless of where the sage script is installed (I hope I'm not missing anything with that.. it seems to work ok)\n  - Doctesting the built module (without install) works fine provided:\n  - We run the sage script in `build/scripts-*/sage` and either add `build/scripts-*` to PATH or do the `PATH=$(dirname $SELF):$PATH` trick I mentioned above.\n  - We set PYTHONPATH to `build/lib*`.\n  - We change directory to some other place (I create an empty temp dir). It turns out that if we set PYTHONPATH, then python will prepend $PWD to that (wtf?) so running from `pkgs/sagemath-standard` will make it pick the sage module from the wrong location (the source one, which doesn't contain the compiled extension modules). I don't know a way to avoid this $PWD misfeature.\n\n## What could be upstreamed from the above that might be useful\n- patches, as I mentioned above, this I will do in separate tickets\n- make ratpoints optional\n- have a `bootstrap` script in `pkgs/sagemath-standard`\n- do not install `sage-venv-config` ??? Or another way that results in `SAGE_VENV` unset.\n- do `PATH=$(dirname $SELF):$PATH` in `sage-env` (perhaps when `dirname $SELF` is not already in PATH, when `SAGE_LOCAL`, `SAGE_ROOT` and `SAGE_VENV` are unset, or something).\n- change jupyter install so that it makes hard copies of the logos instead of symlinks to build dir.",
    "created_at": "2022-02-04T15:47:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497049",
    "user": "https://github.com/tornaria"
}
```

<div id="comment:26" align="right">comment:26</div>

As of yesterday sagemath-9.5 is available on official void repos, working for x86_64 (glibc and musl libc) and i686 (32 bit, glibc only).

The build template is here:

https://github.com/void-linux/void-packages/tree/master/srcpkgs/sagemath

Notes:

- after a few months of playing with installing sage-as-distro, I finally switched to installing sage-as-lib as it was suggested, and it's really much easier. However, starting with sage-as-distro was better while we were working on the other package dependencies. Once all packages were available switching to sage-as-lib was really easy.
- we are applying 15 patches; of those:
  - the 11 starting with numbers in [patches](https://github.com/void-linux/void-packages/tree/master/srcpkgs/sagemath/patches) should IMO be straightforward to upstream (as-is, except maybe 08-dont_run_pytest--see_31924.patch). All of them are very short except the last two which are just improving on `# long` tagging (thus non-essential but nice to have). I'll try to open individual tickets here for these.
  - two patches `trac-*` are taken from tickets with positive review #33189 and #33226.
  - two patches `zzz-*` are void specific, although the one about loadable_module_extension() I can think of a way to fix it in a generic way. The one about threejs... well, I just need to ship threejs but whatever, that's a stupid test since nothing else requires threejs, I might as well ship an empty directory to pass the test!
- The template itself:
  - Removes `sage/libs/ratpoints.{pyx,pxd}` since these are not used anywhere; maybe ratpoints spkg can be made optional and compile these files only if ratpoints is available?
  - Builds from `pkgs/sagemath-standard`, however bootstrapping this requires some non-obvious moves. Can we have a `bootstrap` script in this directory that does "the right thing"? Here is my snippet:

     ```
   	 pushd $wrksrc/build/pkgs/sagelib
   	 PATH=../../bin:$PATH BOOTSTRAP_QUIET=no ./bootstrap
   	 popd
    ```
  - Patches `setup.cfg` so that `sage-venv-config` is not installed; that should not be necessary, besides it's actively harmful since having it set means `sage-env` will mess up with PATH in an undesirable way. In fact it's very hard to understand what is going on with PATH in `sage-env` (I guess it's just that there are a zillion different cases to be supported, but it's quite opaque) and it's missing at least the case I end up requiring (see next point).
  - Creates a custom `sage-env-config` script with a single line `PATH=$(dirname $SELF):$PATH`; we need this because scripts will be installed in a custom location not in system path (currently `/usr/lib/sagemath/bin`) with a symlink to the `sage` script placed in `/usr/bin`.
  - Configures some paths by appending to `sage/env.py`, that file is kind of weird, mixing settings with code and it keeps configuration variables in two different places: the module dict itself, and the SAGE_ENV dict. There's like 3 users of SAGE_ENV, wouldn't it make sense to kill it for consistency? The only reason I had to touch variables is because I decided to place databases in `/usr/share/sagemath` instead of directly in `/usr/share`, my fault I guess.
- Other notes
  - Running setup.py needs `PYTHONPATH=../sage-setup`, I took that from arch. Should this (and the previous bootstrap step) be documented in `README.rst`?
  - Building with multiple jobs works fine when setting `SAGE_NUM_THREADS` to the number of threads (also took that hint from arch, also nice to document).
  - The jupyter kernel install is bad: it installs symlinks for the logo which point to the build directory, which won't exist at runtime. I replace the symlinks by hard copies. I also change the spec from running `/usr/bin/sage --python` to `/usr/bin/python` because that works regardless of where the sage script is installed (I hope I'm not missing anything with that.. it seems to work ok)
  - Doctesting the built module (without install) works fine provided:
  - We run the sage script in `build/scripts-*/sage` and either add `build/scripts-*` to PATH or do the `PATH=$(dirname $SELF):$PATH` trick I mentioned above.
  - We set PYTHONPATH to `build/lib*`.
  - We change directory to some other place (I create an empty temp dir). It turns out that if we set PYTHONPATH, then python will prepend $PWD to that (wtf?) so running from `pkgs/sagemath-standard` will make it pick the sage module from the wrong location (the source one, which doesn't contain the compiled extension modules). I don't know a way to avoid this $PWD misfeature.

## What could be upstreamed from the above that might be useful
- patches, as I mentioned above, this I will do in separate tickets
- make ratpoints optional
- have a `bootstrap` script in `pkgs/sagemath-standard`
- do not install `sage-venv-config` ??? Or another way that results in `SAGE_VENV` unset.
- do `PATH=$(dirname $SELF):$PATH` in `sage-env` (perhaps when `dirname $SELF` is not already in PATH, when `SAGE_LOCAL`, `SAGE_ROOT` and `SAGE_VENV` are unset, or something).
- change jupyter install so that it makes hard copies of the logos instead of symlinks to build dir.



---

archive/issue_comments_497050.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,6 +7,8 @@\n - Debian: https://sources.debian.org/patches/sagemath/9.2-2/\n \n - macOS: https://github.com/3-manifolds/Sage_macOS/tree/main/Sage_framework\n+\n+- void linux: https://github.com/void-linux/void-packages/tree/master/srcpkgs/sagemath\n \n See also: https://wiki.sagemath.org/Distribution\n \n``````\n",
    "created_at": "2022-02-04T15:47:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497050",
    "user": "https://github.com/tornaria"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,6 +7,8 @@
 - Debian: https://sources.debian.org/patches/sagemath/9.2-2/
 
 - macOS: https://github.com/3-manifolds/Sage_macOS/tree/main/Sage_framework
+
+- void linux: https://github.com/void-linux/void-packages/tree/master/srcpkgs/sagemath
 
 See also: https://wiki.sagemath.org/Distribution
 
``````




---

archive/issue_comments_497051.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,7 +4,7 @@\n \n - Gentoo: https://github.com/cschwan/sage-on-gentoo/tree/master/sci-mathematics/sage\n \n-- Debian: https://sources.debian.org/patches/sagemath/9.2-2/\n+- Debian: https://salsa.debian.org/math-team/sagemath/tree/master/debian/patches\n \n - macOS: https://github.com/3-manifolds/Sage_macOS/tree/main/Sage_framework\n \n``````\n",
    "created_at": "2022-02-05T15:48:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497051",
    "user": "https://github.com/tobihan"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,7 +4,7 @@
 
 - Gentoo: https://github.com/cschwan/sage-on-gentoo/tree/master/sci-mathematics/sage
 
-- Debian: https://sources.debian.org/patches/sagemath/9.2-2/
+- Debian: https://salsa.debian.org/math-team/sagemath/tree/master/debian/patches
 
 - macOS: https://github.com/3-manifolds/Sage_macOS/tree/main/Sage_framework
 
``````




---

archive/issue_comments_497052.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@tornaria](#comment%3A26):\n> - Builds from `pkgs/sagemath-standard`, however bootstrapping this requires some non-obvious moves. Can we have a `bootstrap` script in this directory that does \"the right thing\"? Here is my snippet:\n> \n>      ```\n>    \t pushd $wrksrc/build/pkgs/sagelib\n>    \t PATH=../../bin:$PATH BOOTSTRAP_QUIET=no ./bootstrap\n>    \t popd\n>   ```\n\nThe `bootstrap` scripts do need access to `build/pkgs/` for package version information. The idea is that you bootstrap the whole repo using the top-level `bootstrap` script, not just one directory in `pkgs/`",
    "created_at": "2022-02-05T16:47:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497052",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@tornaria](#comment%3A26):
> - Builds from `pkgs/sagemath-standard`, however bootstrapping this requires some non-obvious moves. Can we have a `bootstrap` script in this directory that does "the right thing"? Here is my snippet:
> 
>      ```
>    	 pushd $wrksrc/build/pkgs/sagelib
>    	 PATH=../../bin:$PATH BOOTSTRAP_QUIET=no ./bootstrap
>    	 popd
>   ```

The `bootstrap` scripts do need access to `build/pkgs/` for package version information. The idea is that you bootstrap the whole repo using the top-level `bootstrap` script, not just one directory in `pkgs/`



---

archive/issue_comments_497053.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@tornaria](#comment%3A26):\n> - make ratpoints optional\n\nFrom build/pkgs/ratpoints/SPKG.rst:\n\n```\nNOTE: the ratpoints package has been assimilated by PARI/GP. Therefore,\nthis package (as Sage package) is deprecated. In the future, it will be\nremoved from Sage.\n```\n\nI think we should just do that",
    "created_at": "2022-02-05T16:49:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497053",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@tornaria](#comment%3A26):
> - make ratpoints optional

From build/pkgs/ratpoints/SPKG.rst:

```
NOTE: the ratpoints package has been assimilated by PARI/GP. Therefore,
this package (as Sage package) is deprecated. In the future, it will be
removed from Sage.
```

I think we should just do that



---

archive/issue_comments_497054.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@tornaria](#comment%3A26):\n> - Running setup.py needs `PYTHONPATH=../sage-setup`, I took that from arch. Should this (and the previous bootstrap step) be documented in `README.rst`?\n\nNo, `sage-setup` is declared as a `build-system requires` in pkgs/sagemath-standard/pyproject.toml.m4",
    "created_at": "2022-02-05T17:04:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497054",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@tornaria](#comment%3A26):
> - Running setup.py needs `PYTHONPATH=../sage-setup`, I took that from arch. Should this (and the previous bootstrap step) be documented in `README.rst`?

No, `sage-setup` is declared as a `build-system requires` in pkgs/sagemath-standard/pyproject.toml.m4



---

archive/issue_comments_497055.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@tornaria](#comment%3A26):\n> - The jupyter kernel install is bad\n\nSee #30306",
    "created_at": "2022-02-05T17:06:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497055",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@tornaria](#comment%3A26):
> - The jupyter kernel install is bad

See #30306



---

archive/issue_comments_497056.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@tornaria](#comment%3A26):\n> - Configures some paths by appending to `sage/env.py`, that file is kind of weird, mixing settings with code and it keeps configuration variables in two different places: the module dict itself, and the SAGE_ENV dict.\n\nDon't do that, put settings in `sage_conf.py` instead (see also #33295)",
    "created_at": "2022-02-05T17:27:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31016#issuecomment-497056",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@tornaria](#comment%3A26):
> - Configures some paths by appending to `sage/env.py`, that file is kind of weird, mixing settings with code and it keeps configuration variables in two different places: the module dict itself, and the SAGE_ENV dict.

Don't do that, put settings in `sage_conf.py` instead (see also #33295)



---

archive/issue_events_424621.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31016#event-424621"
}
```



---

archive/issue_events_424622.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31016#event-424622"
}
```



---

archive/issue_events_424623.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31016#event-424623"
}
```



---

archive/issue_events_424624.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31016",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31016#event-424624"
}
```
