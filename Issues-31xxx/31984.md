# Issue 31984: Can pynac's calculations of special functions cause std::abs to overflow?

archive/issues_031747.json:
```json
{
    "body": "The C++ function `std::abs` can overflow, because the twos-complement binary representation of an integer has a negative number (`-2^k`, where `k + 1` is the number of bits) whose negative requires an additional bit. Some bugs resulting from this are fixed in #31585, but the other occurrences of `std::abs` in the pynac source code should also be examined, to determine whether they are also buggy. \n\nThere is one other occurrence of `std::abs` in numeric.cpp, but it seems to be safe, because it is taking the absolute value of a floating-point `double`, not an integer. (Furthermore, this `double` is known to be less than `10^200`.)\n\nI think the remaining occurrences of `std::abs` are all in the file **inifcns_nstdsums.cpp**. (In particular, `std::abs(scale)` appears a few times, where `scale` is an `int` variable.) I think this code is computing the values of special functions that are defined by nested sums. (There is mention of \"G transformation\" and \"Hoelder convolution\".) It would be great if someone who understands this would take a look at the occurrences of `std::abs` in the file.  \n\nKeywords: pynac, overflow, absolute value, special functions\n\nStatus: new\n\nDependencies: #31585\n\nIssue created by migration from https://trac.sagemath.org/ticket/31984\n\n",
    "created_at": "2021-06-15T17:51:41Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Can pynac's calculations of special functions cause std::abs to overflow?",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31984",
    "user": "https://github.com/DaveWitteMorris"
}
```
The C++ function `std::abs` can overflow, because the twos-complement binary representation of an integer has a negative number (`-2^k`, where `k + 1` is the number of bits) whose negative requires an additional bit. Some bugs resulting from this are fixed in #31585, but the other occurrences of `std::abs` in the pynac source code should also be examined, to determine whether they are also buggy. 

There is one other occurrence of `std::abs` in numeric.cpp, but it seems to be safe, because it is taking the absolute value of a floating-point `double`, not an integer. (Furthermore, this `double` is known to be less than `10^200`.)

I think the remaining occurrences of `std::abs` are all in the file **inifcns_nstdsums.cpp**. (In particular, `std::abs(scale)` appears a few times, where `scale` is an `int` variable.) I think this code is computing the values of special functions that are defined by nested sums. (There is mention of "G transformation" and "Hoelder convolution".) It would be great if someone who understands this would take a look at the occurrences of `std::abs` in the file.  

Keywords: pynac, overflow, absolute value, special functions

Status: new

Dependencies: #31585

Issue created by migration from https://trac.sagemath.org/ticket/31984





---

archive/issue_comments_636337.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,6 @@\n-The C++ function `std::abs` can overflow, because the twos-complement binary representation has a negative number (all 1s) whose negative requires an additional bit. Some bugs resulting from this are fixed in #31585, but the other occurrences of `std::abs` in the pynac source code should also be examined, to determine whether they are also buggy. \n+The C++ function `std::abs` can overflow, because the twos-complement binary representation has a negative number (`-2^k`, where `k + 1` is the number of bits) whose negative requires an additional bit. Some bugs resulting from this are fixed in #31585, but the other occurrences of `std::abs` in the pynac source code should also be examined, to determine whether they are also buggy. \n \n (There is one other occurrence of `std::abs` in numeric.cpp, and several in inifcns_nstdsums.cpp.)\n-\n-Keywords: pynac, overflow, absolute value\n \n Dependencies: #31585\n \n``````\n",
    "created_at": "2021-06-16T14:04:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31984#issuecomment-636337",
    "user": "https://github.com/DaveWitteMorris"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,6 @@
-The C++ function `std::abs` can overflow, because the twos-complement binary representation has a negative number (all 1s) whose negative requires an additional bit. Some bugs resulting from this are fixed in #31585, but the other occurrences of `std::abs` in the pynac source code should also be examined, to determine whether they are also buggy. 
+The C++ function `std::abs` can overflow, because the twos-complement binary representation has a negative number (`-2^k`, where `k + 1` is the number of bits) whose negative requires an additional bit. Some bugs resulting from this are fixed in #31585, but the other occurrences of `std::abs` in the pynac source code should also be examined, to determine whether they are also buggy. 
 
 (There is one other occurrence of `std::abs` in numeric.cpp, and several in inifcns_nstdsums.cpp.)
-
-Keywords: pynac, overflow, absolute value
 
 Dependencies: #31585
 
``````




---

archive/issue_comments_636338.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n+The C++ function `std::abs` can overflow, because the twos-complement binary representation of an integer has a negative number (`-2^k`, where `k + 1` is the number of bits) whose negative requires an additional bit. Some bugs resulting from this are fixed in #31585, but the other occurrences of `std::abs` in the pynac source code should also be examined, to determine whether they are also buggy. \n \n+There is one other occurrence of `std::abs` in numeric.cpp, but it seems to be safe, because it is taking the absolute value of a floating-point `double`, not an integer. (Furthermore, this `double` is known to be less than `10^200`.)\n+\n+I think the remaining occurrences of `std::abs` are all in the file **inifcns_nstdsums.cpp**. (In particular, `std::abs(scale)` appears a few times, where `scale` is an `int` variable.) I think this code is computing the values of special functions that are defined by nested sums. (There is mention of \"G transformation\" and \"Hoelder convolution\".) It would be great if someone who understands this would take a look at the occurrences of `std::abs` in the file.  \n \n Dependencies: #31585\n \n``````\n",
    "created_at": "2021-06-17T02:22:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31984#issuecomment-636338",
    "user": "https://github.com/DaveWitteMorris"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,8 @@
+The C++ function `std::abs` can overflow, because the twos-complement binary representation of an integer has a negative number (`-2^k`, where `k + 1` is the number of bits) whose negative requires an additional bit. Some bugs resulting from this are fixed in #31585, but the other occurrences of `std::abs` in the pynac source code should also be examined, to determine whether they are also buggy. 
 
+There is one other occurrence of `std::abs` in numeric.cpp, but it seems to be safe, because it is taking the absolute value of a floating-point `double`, not an integer. (Furthermore, this `double` is known to be less than `10^200`.)
+
+I think the remaining occurrences of `std::abs` are all in the file **inifcns_nstdsums.cpp**. (In particular, `std::abs(scale)` appears a few times, where `scale` is an `int` variable.) I think this code is computing the values of special functions that are defined by nested sums. (There is mention of "G transformation" and "Hoelder convolution".) It would be great if someone who understands this would take a look at the occurrences of `std::abs` in the file.  
 
 Dependencies: #31585
 
``````




---

archive/issue_comments_636339.json:
```json
{
    "body": "Changing keywords from \"pynac, overflow, absolute value\" to \"pynac, overflow, absolute value, special functions\".",
    "created_at": "2021-06-17T02:22:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31984",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31984#issuecomment-636339",
    "user": "https://github.com/DaveWitteMorris"
}
```

Changing keywords from "pynac, overflow, absolute value" to "pynac, overflow, absolute value, special functions".



---

archive/issue_events_084574.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31984",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31984#event-84574"
}
```



---

archive/issue_events_084575.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T20:12:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31984",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31984#event-84575"
}
```



---

archive/issue_events_084576.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T20:12:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31984",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31984#event-84576"
}
```



---

archive/issue_events_084577.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31984",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31984#event-84577"
}
```



---

archive/issue_events_084578.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31984",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31984#event-84578"
}
```



---

archive/issue_events_084579.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31984",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31984#event-84579"
}
```



---

archive/issue_events_084580.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31984",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31984#event-84580"
}
```
