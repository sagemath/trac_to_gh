# Issue 31354: move Dedekind zeta function to the category of number fields

archive/issues_031117.json:
```json
{
    "body": "CC:  @JohnCremona @loefflerd @slel\n\nKeywords: zeta, QQ\n\nso that it works for QQ too.\n\nBefore this ticket:\n\n```\nsage: QQ.zeta_function()\nTraceback (most recent call last)\n...\nAttributeError: 'RationalField_with_category' object\nhas no attribute 'zeta_function'\n```\nAfter this ticket:\n\n```\nsage: QQ.zeta_function()\nPARI zeta function associated to Rational Field\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/31354\n\n",
    "closed_at": "2021-03-09T00:01:51Z",
    "created_at": "2021-02-07T11:07:03Z",
    "labels": [
        "component: number fields"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "move Dedekind zeta function to the category of number fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31354",
    "user": "https://github.com/fchapoton"
}
```
CC:  @JohnCremona @loefflerd @slel

Keywords: zeta, QQ

so that it works for QQ too.

Before this ticket:

```
sage: QQ.zeta_function()
Traceback (most recent call last)
...
AttributeError: 'RationalField_with_category' object
has no attribute 'zeta_function'
```
After this ticket:

```
sage: QQ.zeta_function()
PARI zeta function associated to Rational Field
```


Issue created by migration from https://trac.sagemath.org/ticket/31354





---

archive/issue_comments_443951.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-02-07T11:07:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31354#issuecomment-443951",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_443952.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-02-07T11:07:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31354#issuecomment-443952",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_443953.json:
```json
{
    "body": "Changing keywords from \"\" to \"zeta, QQ\".",
    "created_at": "2021-02-07T15:29:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31354#issuecomment-443953",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "zeta, QQ".



---

archive/issue_comments_443954.json:
```json
{
    "body": "green bot, please review",
    "created_at": "2021-02-07T15:35:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31354#issuecomment-443954",
    "user": "https://github.com/fchapoton"
}
```

green bot, please review



---

archive/issue_comments_443955.json:
```json
{
    "body": "Does this ticket just move existing code from on eplace to another?  For a meaningful review, please explain further the purpose",
    "created_at": "2021-02-07T16:01:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31354#issuecomment-443955",
    "user": "https://github.com/JohnCremona"
}
```

Does this ticket just move existing code from on eplace to another?  For a meaningful review, please explain further the purpose



---

archive/issue_comments_443956.json:
```json
{
    "body": "yes, this is just moving code around. Plus adding one doctest in TESTS:\n\nThe motivation: `QQ.zeta_function` was a not implemented method.\n\nNow QQ has a `zeta_function` method, as well as any member of the category of number fields.\n\nNo change in functionality for other number fields.\n\nSee also https://ask.sagemath.org/question/55607/",
    "created_at": "2021-02-07T16:27:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31354#issuecomment-443956",
    "user": "https://github.com/fchapoton"
}
```

yes, this is just moving code around. Plus adding one doctest in TESTS:

The motivation: `QQ.zeta_function` was a not implemented method.

Now QQ has a `zeta_function` method, as well as any member of the category of number fields.

No change in functionality for other number fields.

See also https://ask.sagemath.org/question/55607/



---

archive/issue_comments_443957.json:
```json
{
    "body": "Looks good to me.  I have not built the branch myself, and would like to, to make sure that the methods of the zeta function returned (which is of course the Riemann Zeta function) work.  That will take a little time...",
    "created_at": "2021-02-08T08:59:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31354#issuecomment-443957",
    "user": "https://github.com/JohnCremona"
}
```

Looks good to me.  I have not built the branch myself, and would like to, to make sure that the methods of the zeta function returned (which is of course the Riemann Zeta function) work.  That will take a little time...



---

archive/issue_comments_443958.json:
```json
{
    "body": "The docstring says that the algorithm defaults to 'gp' but (a) it doesn't, it defaults to 'pari', and (b)\n\n```\nsage: QQ.zeta_function(algorithm='gp')\n...\nAttributeError: 'RationalField_with_category' object has no attribute 'absolute_polynomial'\n```\nThis can be fixed by changing the line mentioning self.absolute_polynomial() to\n\n```\ns = 'nf = nfinit(%s);' % polygen(self) if self.degree() == 1 else self.absolute_polynomial()\n```\nwith also an additional import\n\n```\nfrom sage.rings.polynomial.polynomial_ring import polygen\n```\na few lines earlier.  Or -- perhaps better? -- add methods polynomial(), absolute_polynomial(), defining_polynomial() to the RationalField class, to avoid such things once and for all.  (I very often add methods to RationalField to match methods available for number fields.)\n\nAnd change the docstring to admit that 'pari' is the default -- so I am not sure why the default is 'None' which is the changed to 'pari' instead of being set to 'pari' i nthe first place!",
    "created_at": "2021-02-09T13:54:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31354#issuecomment-443958",
    "user": "https://github.com/JohnCremona"
}
```

The docstring says that the algorithm defaults to 'gp' but (a) it doesn't, it defaults to 'pari', and (b)

```
sage: QQ.zeta_function(algorithm='gp')
...
AttributeError: 'RationalField_with_category' object has no attribute 'absolute_polynomial'
```
This can be fixed by changing the line mentioning self.absolute_polynomial() to

```
s = 'nf = nfinit(%s);' % polygen(self) if self.degree() == 1 else self.absolute_polynomial()
```
with also an additional import

```
from sage.rings.polynomial.polynomial_ring import polygen
```
a few lines earlier.  Or -- perhaps better? -- add methods polynomial(), absolute_polynomial(), defining_polynomial() to the RationalField class, to avoid such things once and for all.  (I very often add methods to RationalField to match methods available for number fields.)

And change the docstring to admit that 'pari' is the default -- so I am not sure why the default is 'None' which is the changed to 'pari' instead of being set to 'pari' i nthe first place!



---

archive/issue_comments_443959.json:
```json
{
    "body": "As I have built the branch, I'll make the additional changes I suggested and update the branch.",
    "created_at": "2021-02-10T11:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31354#issuecomment-443959",
    "user": "https://github.com/JohnCremona"
}
```

As I have built the branch, I'll make the additional changes I suggested and update the branch.



---

archive/issue_comments_443960.json:
```json
{
    "body": "I updated the branch to u/cremona/31354 which has one commit on top of u/chapoton/31354.  I hope that is OK in terms of etiquette.  I think we can now be joint reviewers, Fr\u00e9d\u00e9ric?",
    "created_at": "2021-02-10T15:13:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31354#issuecomment-443960",
    "user": "https://github.com/JohnCremona"
}
```

I updated the branch to u/cremona/31354 which has one commit on top of u/chapoton/31354.  I hope that is OK in terms of etiquette.  I think we can now be joint reviewers, Frédéric?



---

archive/issue_comments_443961.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-10T16:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31354#issuecomment-443961",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_443962.json:
```json
{
    "body": "perfect etiquette. I am too tired for today",
    "created_at": "2021-02-10T19:21:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31354#issuecomment-443962",
    "user": "https://github.com/fchapoton"
}
```

perfect etiquette. I am too tired for today



---

archive/issue_comments_443963.json:
```json
{
    "body": "ok, this will do. Can we set to positive ?",
    "created_at": "2021-02-11T10:15:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31354#issuecomment-443963",
    "user": "https://github.com/fchapoton"
}
```

ok, this will do. Can we set to positive ?



---

archive/issue_comments_443964.json:
```json
{
    "body": "I will.  For another ticket perhaps: either change the name of the non default from gp to dokchitser or even get rid if it altogether.",
    "created_at": "2021-02-11T10:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31354#issuecomment-443964",
    "user": "https://github.com/JohnCremona"
}
```

I will.  For another ticket perhaps: either change the name of the non default from gp to dokchitser or even get rid if it altogether.



---

archive/issue_comments_443965.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-02-11T10:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31354#issuecomment-443965",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_443966.json:
```json
{
    "body": "Thanks. Yes, we should get rid of the legacy dokchitser implementations. And more generally, L-functions are in need of care.",
    "created_at": "2021-02-11T11:07:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31354#issuecomment-443966",
    "user": "https://github.com/fchapoton"
}
```

Thanks. Yes, we should get rid of the legacy dokchitser implementations. And more generally, L-functions are in need of care.



---

archive/issue_events_082139.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-03-09T00:01:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31354",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31354#event-82139"
}
```



---

archive/issue_comments_443967.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-03-09T00:01:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31354#issuecomment-443967",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
