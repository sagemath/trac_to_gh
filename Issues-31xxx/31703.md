# Issue 31703: Sheaves on manifolds

archive/issues_031466.json:
```json
{
    "assignees": [],
    "body": "We implement presheaves and sheaves over manifolds. Parts that can benefit from this implementation are:\n\n- charts\n- frames\n- vector bundle sections\n- tensor fields\n- scalar fields\n\nWe implement mix-in classes for the parents as well as for its elements, endowed with a restriction method and a `_domain` attribute. We use a qoset (poset) structure to benefit from digraphs which allow efficient relations between the restrictions. See also #31740, #31771 and #31680.\n\nDepends on #31785\n\nCC:  @egourgoulhon @tscrim @tobiasdiez @mkoeppe\n\nBranch/Commit: **[public/31703_sheaves](https://github.com/sagemath/sagetrac-mirror/tree/public/31703_sheaves) @ [865d37d](https://github.com/sagemath/sagetrac-mirror/commit/865d37d67e3b2a82b669fb2a818d05f05facc32f)**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31703_\n\n",
    "created_at": "2021-04-20T13:18:09Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20manifolds",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/needs%20info"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Sheaves on manifolds",
    "type": "issue",
    "updated_at": "2022-08-31T05:25:02Z",
    "url": "https://github.com/sagemath/sage/issues/31703",
    "user": "https://github.com/mjungmath"
}
```
We implement presheaves and sheaves over manifolds. Parts that can benefit from this implementation are:

- charts
- frames
- vector bundle sections
- tensor fields
- scalar fields

We implement mix-in classes for the parents as well as for its elements, endowed with a restriction method and a `_domain` attribute. We use a qoset (poset) structure to benefit from digraphs which allow efficient relations between the restrictions. See also #31740, #31771 and #31680.

Depends on #31785

CC:  @egourgoulhon @tscrim @tobiasdiez @mkoeppe

Branch/Commit: **[public/31703_sheaves](https://github.com/sagemath/sagetrac-mirror/tree/public/31703_sheaves) @ [865d37d](https://github.com/sagemath/sagetrac-mirror/commit/865d37d67e3b2a82b669fb2a818d05f05facc32f)**

_Issue created by migration from https://trac.sagemath.org/ticket/31703_





---

archive/issue_events_419085.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-04-20T13:18:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31703#event-419085"
}
```



---

archive/issue_events_419086.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-04-20T13:18:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20manifolds",
    "label_color": "0000ff",
    "label_name": "component: manifolds",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31703#event-419086"
}
```



---

archive/issue_events_419087.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-04-20T13:18:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31703#event-419087"
}
```



---

archive/issue_events_419088.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-04-20T13:18:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31703#event-419088"
}
```



---

archive/issue_comments_513039.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n As discussed in [#29234 comment:7](https://github.com/sagemath/sage/issues/29234#comment:7), sheaves will be a very useful addition to the manifolds code. In particular, they'd allow to unify tensor fields, scalar fields, vector bundle section etc. and thus get rid of code duplication since they all share the sheaf property.\n \n-My first intuition would be to implement them as a mix-in class.\n+My first intuition would be to implement them as a mix-in class, providing a `restriction` method and a graph\n \n-Possibly helpful: #31677, #31680\n+Possibly helpful: #31740.\n``````\n",
    "created_at": "2021-05-01T10:55:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513039",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 As discussed in [#29234 comment:7](https://github.com/sagemath/sage/issues/29234#comment:7), sheaves will be a very useful addition to the manifolds code. In particular, they'd allow to unify tensor fields, scalar fields, vector bundle section etc. and thus get rid of code duplication since they all share the sheaf property.
 
-My first intuition would be to implement them as a mix-in class.
+My first intuition would be to implement them as a mix-in class, providing a `restriction` method and a graph
 
-Possibly helpful: #31677, #31680
+Possibly helpful: #31740.
``````




---

archive/issue_comments_513040.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nSee [#30714 comment:10](https://github.com/sagemath/sage/issues/30714#comment:10).",
    "created_at": "2021-05-03T15:45:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513040",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:2" align="right">Comment 2</div>

See [#30714 comment:10](https://github.com/sagemath/sage/issues/30714#comment:10).



---

archive/issue_comments_513041.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,9 @@\n-As discussed in [#29234 comment:7](https://github.com/sagemath/sage/issues/29234#comment:7), sheaves will be a very useful addition to the manifolds code. In particular, they'd allow to unify tensor fields, scalar fields, vector bundle section etc. and thus get rid of code duplication since they all share the sheaf property.\n+We implement presheaves and sheaves over manifolds. Parts that can benefit from this implementation are:\n \n-My first intuition would be to implement them as a mix-in class, providing a `restriction` method and a graph\n+- charts\n+- frames\n+- vector bundle sections\n+- tensor fields\n+- scalar fields\n \n-Possibly helpful: #31740.\n+We implement mix-in classes for the parents as well as for its elements, endowed with a restriction method and a `_domain` attribute. We use a qoset (poset) structure to benefit from digraphs which allow efficient relations between the restrictions. See also #31740, #31771 and #31680.\n``````\n",
    "created_at": "2021-05-03T21:50:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513041",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,9 @@
-As discussed in [#29234 comment:7](https://github.com/sagemath/sage/issues/29234#comment:7), sheaves will be a very useful addition to the manifolds code. In particular, they'd allow to unify tensor fields, scalar fields, vector bundle section etc. and thus get rid of code duplication since they all share the sheaf property.
+We implement presheaves and sheaves over manifolds. Parts that can benefit from this implementation are:
 
-My first intuition would be to implement them as a mix-in class, providing a `restriction` method and a graph
+- charts
+- frames
+- vector bundle sections
+- tensor fields
+- scalar fields
 
-Possibly helpful: #31740.
+We implement mix-in classes for the parents as well as for its elements, endowed with a restriction method and a `_domain` attribute. We use a qoset (poset) structure to benefit from digraphs which allow efficient relations between the restrictions. See also #31740, #31771 and #31680.
``````




---

archive/issue_comments_513042.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nSounds like we should add a functorial construction.",
    "created_at": "2021-05-04T15:00:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513042",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">Comment 4</div>

Sounds like we should add a functorial construction.



---

archive/issue_comments_513043.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nReplying to [@mkoeppe](#comment%3A4):\n> Sounds like we should add a functorial construction. \n\nWhat do you mean?",
    "created_at": "2021-05-05T12:55:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513043",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:5" align="right">Comment 5</div>

Replying to [@mkoeppe](#comment%3A4):
> Sounds like we should add a functorial construction. 

What do you mean?



---

archive/issue_comments_513044.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\n... similar to what's happening in `sage.categories.homsets`",
    "created_at": "2021-05-06T02:17:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513044",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">Comment 6</div>

... similar to what's happening in `sage.categories.homsets`



---

archive/issue_comments_513045.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nI don't see how that might help us. We need something that is already compatible with the sheaf structure in the above classes.\n\nInstead of a mix-in class, we can do that all via the category framework.",
    "created_at": "2021-05-06T08:21:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513045",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:7" align="right">Comment 7</div>

I don't see how that might help us. We need something that is already compatible with the sheaf structure in the above classes.

Instead of a mix-in class, we can do that all via the category framework.



---

archive/issue_comments_513046.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nThe problem I see with the category approach is that the implementation will be probably too concrete.",
    "created_at": "2021-05-06T08:26:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513046",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:8" align="right">Comment 8</div>

The problem I see with the category approach is that the implementation will be probably too concrete.



---

archive/issue_comments_513047.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nI will upload a proposal with category approach and put it under consideration.",
    "created_at": "2021-05-06T08:35:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513047",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:9" align="right">Comment 9</div>

I will upload a proposal with category approach and put it under consideration.



---

archive/issue_comments_513048.json:
```json
{
    "body": "Branch: **[public/31703_sheaves](https://github.com/sagemath/sagetrac-mirror/tree/public/31703_sheaves)**",
    "created_at": "2021-05-06T11:07:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513048",
    "user": "https://github.com/mjungmath"
}
```

Branch: **[public/31703_sheaves](https://github.com/sagemath/sagetrac-mirror/tree/public/31703_sheaves)**



---

archive/issue_comments_513049.json:
```json
{
    "body": "Commit: **[ff599d4](https://github.com/sagemath/sagetrac-mirror/commit/ff599d42f5b9146a921269a6fa345bd11023782f)**",
    "created_at": "2021-05-06T11:07:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513049",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[ff599d4](https://github.com/sagemath/sagetrac-mirror/commit/ff599d42f5b9146a921269a6fa345bd11023782f)**



---

archive/issue_comments_513050.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ff599d42f5b9146a921269a6fa345bd11023782f\">ff599d4</a></td><td><code>Trac #31703: first attempt using category</code></td></tr></table>\n",
    "created_at": "2021-05-06T11:07:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513050",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11" align="right">Comment 11</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ff599d42f5b9146a921269a6fa345bd11023782f">ff599d4</a></td><td><code>Trac #31703: first attempt using category</code></td></tr></table>




---

archive/issue_comments_513051.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nDoes it make sense to keep track of the target category, i.e. sections of the presheaf over an open subset are objects of this category. Maybe as a generic parameter?",
    "created_at": "2021-05-06T11:28:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513051",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:12" align="right">Comment 12</div>

Does it make sense to keep track of the target category, i.e. sections of the presheaf over an open subset are objects of this category. Maybe as a generic parameter?



---

archive/issue_comments_513052.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nReplying to [@tobiasdiez](#comment%3A12):\n> Does it make sense to keep track of the target category, i.e. sections of the presheaf over an open subset are objects of this category. Maybe as a generic parameter?\n\nWhat do you mean?",
    "created_at": "2021-05-06T11:59:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513052",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:13" align="right">Comment 13</div>

Replying to [@tobiasdiez](#comment%3A12):
> Does it make sense to keep track of the target category, i.e. sections of the presheaf over an open subset are objects of this category. Maybe as a generic parameter?

What do you mean?



---

archive/issue_comments_513053.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nBut you are right. Strictly speaking, presheaves are families of section sets. The above proposal is very sloppy in that viewpoint. For now, it rather reflects something like the \"category of presheaf section sets\".",
    "created_at": "2021-05-06T12:05:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513053",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:14" align="right">Comment 14</div>

But you are right. Strictly speaking, presheaves are families of section sets. The above proposal is very sloppy in that viewpoint. For now, it rather reflects something like the "category of presheaf section sets".



---

archive/issue_comments_513054.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nI think this whole category approach was non-sense after all...",
    "created_at": "2021-05-06T12:32:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513054",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:15" align="right">Comment 15</div>

I think this whole category approach was non-sense after all...



---

archive/issue_comments_513055.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nWhat I meant is that your sections often have additional structure. For example, if you consider the presheaf $F$ of sections of a bundle of groups, then you can naturally multiply two such sections, i.e there are maps $F(U) \\times F(U) \\to F(U)$ for every open subset $U$ induced by the group multiplication. For example, the wedge product of differential forms can be described in such a way.",
    "created_at": "2021-05-06T12:33:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513055",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:16" align="right">Comment 16</div>

What I meant is that your sections often have additional structure. For example, if you consider the presheaf $F$ of sections of a bundle of groups, then you can naturally multiply two such sections, i.e there are maps $F(U) \times F(U) \to F(U)$ for every open subset $U$ induced by the group multiplication. For example, the wedge product of differential forms can be described in such a way.



---

archive/issue_comments_513056.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/29b601a6cb979dfc96f7d964de76b89e5df76dfe\">29b601a</a></td><td><code>Trac #31703: first attempt</code></td></tr></table>\n",
    "created_at": "2021-05-15T10:10:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513056",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17" align="right">Comment 17</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/29b601a6cb979dfc96f7d964de76b89e5df76dfe">29b601a</a></td><td><code>Trac #31703: first attempt</code></td></tr></table>




---

archive/issue_comments_513057.json:
```json
{
    "body": "Changed commit from **[ff599d4](https://github.com/sagemath/sagetrac-mirror/commit/ff599d42f5b9146a921269a6fa345bd11023782f)** to **[29b601a](https://github.com/sagemath/sagetrac-mirror/commit/29b601a6cb979dfc96f7d964de76b89e5df76dfe)**",
    "created_at": "2021-05-15T10:10:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513057",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ff599d4](https://github.com/sagemath/sagetrac-mirror/commit/ff599d42f5b9146a921269a6fa345bd11023782f)** to **[29b601a](https://github.com/sagemath/sagetrac-mirror/commit/29b601a6cb979dfc96f7d964de76b89e5df76dfe)**



---

archive/issue_comments_513058.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nReplying to [@tobiasdiez](#comment%3A16):\n> What I meant is that your sections often have additional structure. For example, if you consider the presheaf $F$ of sections of a bundle of groups, then you can naturally multiply two such sections, i.e there are maps $F(U) \\times F(U) \\to F(U)$ for every open subset $U$ induced by the group multiplication. For example, the wedge product of differential forms can be described in such a way.\n\nThis behavior will naturally be captured by the corresponding parent of sections.",
    "created_at": "2021-05-15T10:11:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513058",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:18" align="right">Comment 18</div>

Replying to [@tobiasdiez](#comment%3A16):
> What I meant is that your sections often have additional structure. For example, if you consider the presheaf $F$ of sections of a bundle of groups, then you can naturally multiply two such sections, i.e there are maps $F(U) \times F(U) \to F(U)$ for every open subset $U$ induced by the group multiplication. For example, the wedge product of differential forms can be described in such a way.

This behavior will naturally be captured by the corresponding parent of sections.



---

archive/issue_comments_513059.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nI have uploaded another approach. Feedback is welcome! :)",
    "created_at": "2021-05-15T10:12:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513059",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:19" align="right">Comment 19</div>

I have uploaded another approach. Feedback is welcome! :)



---

archive/issue_comments_513060.json:
```json
{
    "body": "Changed commit from **[29b601a](https://github.com/sagemath/sagetrac-mirror/commit/29b601a6cb979dfc96f7d964de76b89e5df76dfe)** to **[7e2a6f5](https://github.com/sagemath/sagetrac-mirror/commit/7e2a6f51eb8be17d3bcbbdd4ec40d99e1c3c3e79)**",
    "created_at": "2021-05-15T14:30:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513060",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[29b601a](https://github.com/sagemath/sagetrac-mirror/commit/29b601a6cb979dfc96f7d964de76b89e5df76dfe)** to **[7e2a6f5](https://github.com/sagemath/sagetrac-mirror/commit/7e2a6f51eb8be17d3bcbbdd4ec40d99e1c3c3e79)**



---

archive/issue_comments_513061.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7e2a6f51eb8be17d3bcbbdd4ec40d99e1c3c3e79\">7e2a6f5</a></td><td><code>Trac #31703: add sheaves</code></td></tr></table>\n",
    "created_at": "2021-05-15T14:30:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513061",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:20" align="right">Comment 20</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7e2a6f51eb8be17d3bcbbdd4ec40d99e1c3c3e79">7e2a6f5</a></td><td><code>Trac #31703: add sheaves</code></td></tr></table>




---

archive/issue_comments_513062.json:
```json
{
    "body": "Changed commit from **[7e2a6f5](https://github.com/sagemath/sagetrac-mirror/commit/7e2a6f51eb8be17d3bcbbdd4ec40d99e1c3c3e79)** to **[939700c](https://github.com/sagemath/sagetrac-mirror/commit/939700c344f3699ad123d2e15ebbeb2f354bf4c5)**",
    "created_at": "2021-05-15T14:44:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513062",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7e2a6f5](https://github.com/sagemath/sagetrac-mirror/commit/7e2a6f51eb8be17d3bcbbdd4ec40d99e1c3c3e79)** to **[939700c](https://github.com/sagemath/sagetrac-mirror/commit/939700c344f3699ad123d2e15ebbeb2f354bf4c5)**



---

archive/issue_comments_513063.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/939700c344f3699ad123d2e15ebbeb2f354bf4c5\">939700c</a></td><td><code>Trac #31703: add some examples</code></td></tr></table>\n",
    "created_at": "2021-05-15T14:44:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513063",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21" align="right">Comment 21</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/939700c344f3699ad123d2e15ebbeb2f354bf4c5">939700c</a></td><td><code>Trac #31703: add some examples</code></td></tr></table>




---

archive/issue_comments_513064.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nThis should reveal some more of the idea.",
    "created_at": "2021-05-15T14:50:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513064",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:22" align="right">Comment 22</div>

This should reveal some more of the idea.



---

archive/issue_comments_513065.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\n`_repr_` is probably not optimal, but at this stage I don't know how to do better.",
    "created_at": "2021-05-15T14:51:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513065",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:23" align="right">Comment 23</div>

`_repr_` is probably not optimal, but at this stage I don't know how to do better.



---

archive/issue_comments_513066.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nI think you will want to make `Presheaf` a subclass of `Parent`. `PresheafSection` would be its element class.",
    "created_at": "2021-05-16T16:27:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513066",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:24" align="right">Comment 24</div>

I think you will want to make `Presheaf` a subclass of `Parent`. `PresheafSection` would be its element class.



---

archive/issue_comments_513067.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nIn fact, `PresheafSection` shall be an element of a particular section set. For example: the (pre)sheaf of scalar fields is a family that assigns to each open subset the scalar field algebra on that open subset. Its elements, namely scalar fields, are the sections of the (pre)sheaf.\n\nThus, I don't think that a parent-element construction is what we want here, no?",
    "created_at": "2021-05-16T16:35:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513067",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:25" align="right">Comment 25</div>

In fact, `PresheafSection` shall be an element of a particular section set. For example: the (pre)sheaf of scalar fields is a family that assigns to each open subset the scalar field algebra on that open subset. Its elements, namely scalar fields, are the sections of the (pre)sheaf.

Thus, I don't think that a parent-element construction is what we want here, no?



---

archive/issue_comments_513068.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nFor the gluing property we need concrete 'empty' sections we can endow with restrictions. But those sections cannot be provided by the parent directly since the element constructor always wants an input (otherwise it returns the zero element). Using the element class is not helpful either, because the sheaf does not know the input signature.\n\nAny ideas how to elegantly circumvent this? Everything that comes into my mind is rather complicated.",
    "created_at": "2021-05-22T16:26:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513068",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:26" align="right">Comment 26</div>

For the gluing property we need concrete 'empty' sections we can endow with restrictions. But those sections cannot be provided by the parent directly since the element constructor always wants an input (otherwise it returns the zero element). Using the element class is not helpful either, because the sheaf does not know the input signature.

Any ideas how to elegantly circumvent this? Everything that comes into my mind is rather complicated.



---

archive/issue_comments_513069.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/061bda56881cef45ced093f42c32e002ab33a563\">061bda5</a></td><td><code>Trac #31703: concatenate</code></td></tr></table>\n",
    "created_at": "2021-05-22T19:33:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513069",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27" align="right">Comment 27</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/061bda56881cef45ced093f42c32e002ab33a563">061bda5</a></td><td><code>Trac #31703: concatenate</code></td></tr></table>




---

archive/issue_comments_513070.json:
```json
{
    "body": "Changed commit from **[939700c](https://github.com/sagemath/sagetrac-mirror/commit/939700c344f3699ad123d2e15ebbeb2f354bf4c5)** to **[061bda5](https://github.com/sagemath/sagetrac-mirror/commit/061bda56881cef45ced093f42c32e002ab33a563)**",
    "created_at": "2021-05-22T19:33:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513070",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[939700c](https://github.com/sagemath/sagetrac-mirror/commit/939700c344f3699ad123d2e15ebbeb2f354bf4c5)** to **[061bda5](https://github.com/sagemath/sagetrac-mirror/commit/061bda56881cef45ced093f42c32e002ab33a563)**



---

archive/issue_comments_513071.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/53e4430154e6834df9db8b9f39386e06bcce1eab\">53e4430</a></td><td><code>Trac #31703: copy restriction code from tensorfield.py</code></td></tr></table>\n",
    "created_at": "2021-05-22T20:55:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513071",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28" align="right">Comment 28</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/53e4430154e6834df9db8b9f39386e06bcce1eab">53e4430</a></td><td><code>Trac #31703: copy restriction code from tensorfield.py</code></td></tr></table>




---

archive/issue_comments_513072.json:
```json
{
    "body": "Changed commit from **[061bda5](https://github.com/sagemath/sagetrac-mirror/commit/061bda56881cef45ced093f42c32e002ab33a563)** to **[53e4430](https://github.com/sagemath/sagetrac-mirror/commit/53e4430154e6834df9db8b9f39386e06bcce1eab)**",
    "created_at": "2021-05-22T20:55:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513072",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[061bda5](https://github.com/sagemath/sagetrac-mirror/commit/061bda56881cef45ced093f42c32e002ab33a563)** to **[53e4430](https://github.com/sagemath/sagetrac-mirror/commit/53e4430154e6834df9db8b9f39386e06bcce1eab)**



---

archive/issue_comments_513073.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nTo circumvent the issue stated above, I delegated the constructions to an abstract method for now where the concrete implementation can take care of this. Though there are a lot of code snippets that fit better into this sheaf implementation because otherwise they would repeat. For example, `copy` shares a lot of common code.",
    "created_at": "2021-05-22T20:58:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513073",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:29" align="right">Comment 29</div>

To circumvent the issue stated above, I delegated the constructions to an abstract method for now where the concrete implementation can take care of this. Though there are a lot of code snippets that fit better into this sheaf implementation because otherwise they would repeat. For example, `copy` shares a lot of common code.



---

archive/issue_comments_513074.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2c9c72bd818cfefbf294710d1b8bdcfba0c8d555\">2c9c72b</a></td><td><code>Trac #31703: extension graph dict</code></td></tr></table>\n",
    "created_at": "2021-05-22T21:03:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513074",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:30" align="right">Comment 30</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2c9c72bd818cfefbf294710d1b8bdcfba0c8d555">2c9c72b</a></td><td><code>Trac #31703: extension graph dict</code></td></tr></table>




---

archive/issue_comments_513075.json:
```json
{
    "body": "Changed commit from **[53e4430](https://github.com/sagemath/sagetrac-mirror/commit/53e4430154e6834df9db8b9f39386e06bcce1eab)** to **[2c9c72b](https://github.com/sagemath/sagetrac-mirror/commit/2c9c72bd818cfefbf294710d1b8bdcfba0c8d555)**",
    "created_at": "2021-05-22T21:03:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513075",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[53e4430](https://github.com/sagemath/sagetrac-mirror/commit/53e4430154e6834df9db8b9f39386e06bcce1eab)** to **[2c9c72b](https://github.com/sagemath/sagetrac-mirror/commit/2c9c72bd818cfefbf294710d1b8bdcfba0c8d555)**



---

archive/issue_comments_513076.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nDo we really want to use restriction graphs an extension graphs as dictionaries, or is there a better solution available?",
    "created_at": "2021-05-23T13:14:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513076",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:31" align="right">Comment 31</div>

Do we really want to use restriction graphs an extension graphs as dictionaries, or is there a better solution available?



---

archive/issue_comments_513077.json:
```json
{
    "body": "Changed commit from **[2c9c72b](https://github.com/sagemath/sagetrac-mirror/commit/2c9c72bd818cfefbf294710d1b8bdcfba0c8d555)** to **[a884da1](https://github.com/sagemath/sagetrac-mirror/commit/a884da1edced4b426beb4477412dbda6a1306a16)**",
    "created_at": "2021-05-24T16:45:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513077",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2c9c72b](https://github.com/sagemath/sagetrac-mirror/commit/2c9c72bd818cfefbf294710d1b8bdcfba0c8d555)** to **[a884da1](https://github.com/sagemath/sagetrac-mirror/commit/a884da1edced4b426beb4477412dbda6a1306a16)**



---

archive/issue_comments_513078.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a884da1edced4b426beb4477412dbda6a1306a16\">a884da1</a></td><td><code>Trac #31703: turn sheaves into functors + provide helper methods instead of concrete implementation</code></td></tr></table>\n",
    "created_at": "2021-05-24T16:45:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513078",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:32" align="right">Comment 32</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a884da1edced4b426beb4477412dbda6a1306a16">a884da1</a></td><td><code>Trac #31703: turn sheaves into functors + provide helper methods instead of concrete implementation</code></td></tr></table>




---

archive/issue_comments_513079.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\n`@`Matthias: Is that what you had in mind when speaking of functorial properties?",
    "created_at": "2021-05-24T16:46:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513079",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:33" align="right">Comment 33</div>

`@`Matthias: Is that what you had in mind when speaking of functorial properties?



---

archive/issue_comments_513080.json:
```json
{
    "body": "Changed commit from **[a884da1](https://github.com/sagemath/sagetrac-mirror/commit/a884da1edced4b426beb4477412dbda6a1306a16)** to **[80eba04](https://github.com/sagemath/sagetrac-mirror/commit/80eba041c57d8a422b704aad3cfc49cd6ddefc0a)**",
    "created_at": "2021-05-24T17:09:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513080",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[a884da1](https://github.com/sagemath/sagetrac-mirror/commit/a884da1edced4b426beb4477412dbda6a1306a16)** to **[80eba04](https://github.com/sagemath/sagetrac-mirror/commit/80eba041c57d8a422b704aad3cfc49cd6ddefc0a)**



---

archive/issue_comments_513081.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/80eba041c57d8a422b704aad3cfc49cd6ddefc0a\">80eba04</a></td><td><code>Trac #31703: make copy, copy_from, set_restriction etc. entirely abstract</code></td></tr></table>\n",
    "created_at": "2021-05-24T17:09:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513081",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34" align="right">Comment 34</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/80eba041c57d8a422b704aad3cfc49cd6ddefc0a">80eba04</a></td><td><code>Trac #31703: make copy, copy_from, set_restriction etc. entirely abstract</code></td></tr></table>




---

archive/issue_comments_513082.json:
```json
{
    "body": "Changed commit from **[80eba04](https://github.com/sagemath/sagetrac-mirror/commit/80eba041c57d8a422b704aad3cfc49cd6ddefc0a)** to **[d4b1d33](https://github.com/sagemath/sagetrac-mirror/commit/d4b1d331731981df6e63c889e96b25c0412ced8e)**",
    "created_at": "2021-05-24T17:21:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513082",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[80eba04](https://github.com/sagemath/sagetrac-mirror/commit/80eba041c57d8a422b704aad3cfc49cd6ddefc0a)** to **[d4b1d33](https://github.com/sagemath/sagetrac-mirror/commit/d4b1d331731981df6e63c889e96b25c0412ced8e)**



---

archive/issue_comments_513083.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">Comment 35</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a5e09560bad6f6ec942c44087cb677ba5bc06652\">a5e0956</a></td><td><code>Trac #31703: set_restriction is presheaf property</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d4b1d331731981df6e63c889e96b25c0412ced8e\">d4b1d33</a></td><td><code>Trac #31703: update restriction graph for restrict method</code></td></tr></table>\n",
    "created_at": "2021-05-24T17:21:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513083",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:35" align="right">Comment 35</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a5e09560bad6f6ec942c44087cb677ba5bc06652">a5e0956</a></td><td><code>Trac #31703: set_restriction is presheaf property</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d4b1d331731981df6e63c889e96b25c0412ced8e">d4b1d33</a></td><td><code>Trac #31703: update restriction graph for restrict method</code></td></tr></table>




---

archive/issue_comments_513084.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b91fc1661d2b01d16ae5085e86893a0a7965d2df\">b91fc16</a></td><td><code>Trac #31703: semi-concrete implementation of set_restriction</code></td></tr></table>\n",
    "created_at": "2021-05-24T17:36:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513084",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:36" align="right">Comment 36</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b91fc1661d2b01d16ae5085e86893a0a7965d2df">b91fc16</a></td><td><code>Trac #31703: semi-concrete implementation of set_restriction</code></td></tr></table>




---

archive/issue_comments_513085.json:
```json
{
    "body": "Changed commit from **[d4b1d33](https://github.com/sagemath/sagetrac-mirror/commit/d4b1d331731981df6e63c889e96b25c0412ced8e)** to **[b91fc16](https://github.com/sagemath/sagetrac-mirror/commit/b91fc1661d2b01d16ae5085e86893a0a7965d2df)**",
    "created_at": "2021-05-24T17:36:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513085",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d4b1d33](https://github.com/sagemath/sagetrac-mirror/commit/d4b1d331731981df6e63c889e96b25c0412ced8e)** to **[b91fc16](https://github.com/sagemath/sagetrac-mirror/commit/b91fc1661d2b01d16ae5085e86893a0a7965d2df)**



---

archive/issue_comments_513086.json:
```json
{
    "body": "Dependencies: **#31785**",
    "created_at": "2021-05-24T20:05:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513086",
    "user": "https://github.com/mjungmath"
}
```

Dependencies: **#31785**



---

archive/issue_comments_513087.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\nPerhaps instead of passing a lambda function to `Presheaf`, define subclasses such as `ScalarFieldAlgebraPresheaf`. Then you can replace the method `scalar_field_algebra` with an attribute that is an instance of this class.",
    "created_at": "2021-05-24T20:33:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513087",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:38" align="right">Comment 38</div>

Perhaps instead of passing a lambda function to `Presheaf`, define subclasses such as `ScalarFieldAlgebraPresheaf`. Then you can replace the method `scalar_field_algebra` with an attribute that is an instance of this class.



---

archive/issue_comments_513088.json:
```json
{
    "body": "Changed commit from **[b91fc16](https://github.com/sagemath/sagetrac-mirror/commit/b91fc1661d2b01d16ae5085e86893a0a7965d2df)** to **[865d37d](https://github.com/sagemath/sagetrac-mirror/commit/865d37d67e3b2a82b669fb2a818d05f05facc32f)**",
    "created_at": "2021-05-24T21:04:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513088",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b91fc16](https://github.com/sagemath/sagetrac-mirror/commit/b91fc1661d2b01d16ae5085e86893a0a7965d2df)** to **[865d37d](https://github.com/sagemath/sagetrac-mirror/commit/865d37d67e3b2a82b669fb2a818d05f05facc32f)**



---

archive/issue_comments_513089.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f9081dc442e0da5c34d66fab36ccfbe716c0eba\">6f9081d</a></td><td><code>Trac #31703: contravariant nature of functor</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/865d37d67e3b2a82b669fb2a818d05f05facc32f\">865d37d</a></td><td><code>Trac #31703: add a bit of documentation</code></td></tr></table>\n",
    "created_at": "2021-05-24T21:04:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513089",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:39" align="right">Comment 39</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f9081dc442e0da5c34d66fab36ccfbe716c0eba">6f9081d</a></td><td><code>Trac #31703: contravariant nature of functor</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/865d37d67e3b2a82b669fb2a818d05f05facc32f">865d37d</a></td><td><code>Trac #31703: add a bit of documentation</code></td></tr></table>




---

archive/issue_comments_513090.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">Comment 40</div>\n\nReplying to [@mkoeppe](#comment%3A38):\n> Perhaps instead of passing a lambda function to `Presheaf`, define subclasses such as `ScalarFieldAlgebraPresheaf`. Then you can replace the method `scalar_field_algebra` with an attribute that is an instance of this class.\n\nThings might still work fine with scalar fields. But as soon as we have tensor fields, things get more complicated. For example tensor field modules *must* be constructed via the manifold's method `tensor_field_module` because the result depends on whether the manifold is parallelizable or not, and those finished constructions must be communicated back to the manifold again.",
    "created_at": "2021-05-24T21:25:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513090",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:40" align="right">Comment 40</div>

Replying to [@mkoeppe](#comment%3A38):
> Perhaps instead of passing a lambda function to `Presheaf`, define subclasses such as `ScalarFieldAlgebraPresheaf`. Then you can replace the method `scalar_field_algebra` with an attribute that is an instance of this class.

Things might still work fine with scalar fields. But as soon as we have tensor fields, things get more complicated. For example tensor field modules *must* be constructed via the manifold's method `tensor_field_module` because the result depends on whether the manifold is parallelizable or not, and those finished constructions must be communicated back to the manifold again.



---

archive/issue_comments_513091.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\nReplying to [@mkoeppe](#comment%3A38):\n> Perhaps instead of passing a lambda function to `Presheaf`, define subclasses such as `ScalarFieldAlgebraPresheaf`. Then you can replace the method `scalar_field_algebra` with an attribute that is an instance of this class.\n\nReplying to [@mjungmath](#comment%3A40):\n> Things might still work fine with scalar fields. But as soon as we have tensor fields, things get more complicated. For example tensor field modules *must* be constructed via the manifold's method `tensor_field_module` because the result depends on whether the manifold is parallelizable or not, and those finished constructions must be communicated back to the manifold again.\n\nTravis, Eric, what do you think about that?",
    "created_at": "2021-06-04T18:19:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513091",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:41" align="right">Comment 41</div>

Replying to [@mkoeppe](#comment%3A38):
> Perhaps instead of passing a lambda function to `Presheaf`, define subclasses such as `ScalarFieldAlgebraPresheaf`. Then you can replace the method `scalar_field_algebra` with an attribute that is an instance of this class.

Replying to [@mjungmath](#comment%3A40):
> Things might still work fine with scalar fields. But as soon as we have tensor fields, things get more complicated. For example tensor field modules *must* be constructed via the manifold's method `tensor_field_module` because the result depends on whether the manifold is parallelizable or not, and those finished constructions must be communicated back to the manifold again.

Travis, Eric, what do you think about that?



---

archive/issue_comments_513092.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">Comment 42</div>\n\nReplying to [@mjungmath](#comment%3A41):\n> \n> Travis, Eric, what do you think about that?\n\nFirst of all, I think it's a good idea to introduce sheaves. Regarding the lambda function in `Presheaf`, I agree with Michael's argument. Do you plan to re-implement some scalar field features, in particular the handling of restrictions, in this ticket?",
    "created_at": "2021-06-06T21:09:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513092",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:42" align="right">Comment 42</div>

Replying to [@mjungmath](#comment%3A41):
> 
> Travis, Eric, what do you think about that?

First of all, I think it's a good idea to introduce sheaves. Regarding the lambda function in `Presheaf`, I agree with Michael's argument. Do you plan to re-implement some scalar field features, in particular the handling of restrictions, in this ticket?



---

archive/issue_comments_513093.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">Comment 43</div>\n\nSee also `sage.schemes.toric.variety` for another place where sheaves already appear in Sage",
    "created_at": "2021-06-11T03:32:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513093",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:43" align="right">Comment 43</div>

See also `sage.schemes.toric.variety` for another place where sheaves already appear in Sage



---

archive/issue_events_419089.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31703#event-419089"
}
```



---

archive/issue_events_419090.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31703#event-419090"
}
```



---

archive/issue_events_419091.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-07-24T15:35:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31703#event-419091"
}
```



---

archive/issue_comments_513094.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">Comment 45</div>\n\nI could use some opinion. Also in which direction this ticket shall now develop. Some foundations are already laid.",
    "created_at": "2021-07-24T15:35:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31703#issuecomment-513094",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:45" align="right">Comment 45</div>

I could use some opinion. Also in which direction this ticket shall now develop. Some foundations are already laid.



---

archive/issue_events_419092.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31703#event-419092"
}
```



---

archive/issue_events_419093.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31703#event-419093"
}
```



---

archive/issue_events_419094.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-05T00:06:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31703#event-419094"
}
```



---

archive/issue_events_419095.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-05T00:06:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31703#event-419095"
}
```



---

archive/issue_events_419096.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T05:25:02Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31703#event-419096"
}
```



---

archive/issue_events_419097.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T05:25:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31703",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31703#event-419097"
}
```
