# Issue 31130: Latte error raising does not work

archive/issues_030893.json:
```json
{
    "body": "From #31046:\n\n```\nsage: P = Polyhedron(rays=[[1,0],[0,1]])                                                                                                                                            \nsage: P._volume_latte()                                                                                                                                                             \n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-2-abc8351118c1> in <module>\n----> 1 P._volume_latte()\n\n~/Applications/sage/local/lib/python3.8/site-packages/sage/geometry/polyhedron/base.py in _volume_latte(self, verbose, algorithm, **kwargs)\n   7888             raise ValueError(\"LattE integrale cannot be applied over inexact rings\")\n   7889         else:\n-> 7890             return integrate(self.cdd_Hrepresentation(), algorithm=algorithm, cdd=True, verbose=verbose, **kwargs)\n   7891 \n   7892     def _volume_normaliz(self, measure='induced'):\n\n~/Applications/sage/local/lib/python3.8/site-packages/sage/interfaces/latte.py in integrate(arg, polynomial, algorithm, raw_output, verbose, **kwds)\n    372             err = \", see error message above\"\n    373         else:\n--> 374             err = \":\\n\" + err\n    375         raise RuntimeError(\"LattE integrale program failed (exit code {})\".format(ret_code) + err.strip())\n    376 \n\nTypeError: can only concatenate str (not \"bytes\") to str\n```\n\nLatte probably raises an error here, which we fail to communicate. The `RuntimeError` was never tested.\n\nKeywords: latte, runtime error\n\nReviewer: Matthias Koeppe\n\nAuthor: Jonathan Kliem\n\nBranch: 7f8815a04e2d19d4469e835c0543307c702ff26d\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/31130\n\n",
    "closed_at": "2021-01-04T22:37:05Z",
    "created_at": "2020-12-29T09:33:24Z",
    "labels": [
        "component: geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Latte error raising does not work",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31130",
    "user": "https://github.com/kliem"
}
```
From #31046:

```
sage: P = Polyhedron(rays=[[1,0],[0,1]])                                                                                                                                            
sage: P._volume_latte()                                                                                                                                                             
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-2-abc8351118c1> in <module>
----> 1 P._volume_latte()

~/Applications/sage/local/lib/python3.8/site-packages/sage/geometry/polyhedron/base.py in _volume_latte(self, verbose, algorithm, **kwargs)
   7888             raise ValueError("LattE integrale cannot be applied over inexact rings")
   7889         else:
-> 7890             return integrate(self.cdd_Hrepresentation(), algorithm=algorithm, cdd=True, verbose=verbose, **kwargs)
   7891 
   7892     def _volume_normaliz(self, measure='induced'):

~/Applications/sage/local/lib/python3.8/site-packages/sage/interfaces/latte.py in integrate(arg, polynomial, algorithm, raw_output, verbose, **kwds)
    372             err = ", see error message above"
    373         else:
--> 374             err = ":\n" + err
    375         raise RuntimeError("LattE integrale program failed (exit code {})".format(ret_code) + err.strip())
    376 

TypeError: can only concatenate str (not "bytes") to str
```

Latte probably raises an error here, which we fail to communicate. The `RuntimeError` was never tested.

Keywords: latte, runtime error

Reviewer: Matthias Koeppe

Author: Jonathan Kliem

Branch: 7f8815a04e2d19d4469e835c0543307c702ff26d

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/31130





---

archive/issue_comments_471003.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2020-12-29T09:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-471003",
    "user": "https://github.com/kliem"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_471004.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-12-29T09:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-471004",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_471005.json:
```json
{
    "body": "Changing keywords from \"\" to \"latte, runtime error\".",
    "created_at": "2020-12-29T09:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-471005",
    "user": "https://github.com/kliem"
}
```

Changing keywords from "" to "latte, runtime error".



---

archive/issue_comments_471006.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-12-29T18:17:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-471006",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_471007.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2020-12-29T20:57:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-471007",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_471008.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-12-29T20:57:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-471008",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_471009.json:
```json
{
    "body": "<a id='comment:5'></a>Thanks and sorry: The second doctest that I added did not contain an error message and therefore is working fine with and without this ticket.\n\nI replaced by the doctest from this ticket that includes an error message now (and wasn't working before).",
    "created_at": "2020-12-29T20:59:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-471009",
    "user": "https://github.com/kliem"
}
```

<a id='comment:5'></a>Thanks and sorry: The second doctest that I added did not contain an error message and therefore is working fine with and without this ticket.

I replaced by the doctest from this ticket that includes an error message now (and wasn't working before).



---

archive/issue_comments_471010.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-12-29T21:10:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-471010",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_471011.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-01-04T22:37:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-471011",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_081331.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-01-04T22:37:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31130#event-81331"
}
```



---

archive/issue_comments_471012.json:
```json
{
    "body": "<a id='comment:8'></a>what about #31046 now ? can it be closed ?",
    "created_at": "2021-03-05T07:54:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-471012",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>what about #31046 now ? can it be closed ?



---

archive/issue_comments_471013.json:
```json
{
    "body": "<a id='comment:9'></a>I don't think so. #31046 reports some doctest failures. But we don't know which ones, because there is no proper error message. Now that this ticket is closed, we can hope that we can a proper report of this message.\n\nWell, we could also close #31046 and wait until the error shows up again.",
    "created_at": "2021-03-05T08:02:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-471013",
    "user": "https://github.com/kliem"
}
```

<a id='comment:9'></a>I don't think so. #31046 reports some doctest failures. But we don't know which ones, because there is no proper error message. Now that this ticket is closed, we can hope that we can a proper report of this message.

Well, we could also close #31046 and wait until the error shows up again.
