# Issue 31130: Latte error raising does not work

archive/issues_030893.json:
```json
{
    "body": "From #31046:\n\n```\nsage: P = Polyhedron(rays=[[1,0],[0,1]])                                                                                                                                            \nsage: P._volume_latte()                                                                                                                                                             \n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-2-abc8351118c1> in <module>\n----> 1 P._volume_latte()\n\n~/Applications/sage/local/lib/python3.8/site-packages/sage/geometry/polyhedron/base.py in _volume_latte(self, verbose, algorithm, **kwargs)\n   7888             raise ValueError(\"LattE integrale cannot be applied over inexact rings\")\n   7889         else:\n-> 7890             return integrate(self.cdd_Hrepresentation(), algorithm=algorithm, cdd=True, verbose=verbose, **kwargs)\n   7891 \n   7892     def _volume_normaliz(self, measure='induced'):\n\n~/Applications/sage/local/lib/python3.8/site-packages/sage/interfaces/latte.py in integrate(arg, polynomial, algorithm, raw_output, verbose, **kwds)\n    372             err = \", see error message above\"\n    373         else:\n--> 374             err = \":\\n\" + err\n    375         raise RuntimeError(\"LattE integrale program failed (exit code {})\".format(ret_code) + err.strip())\n    376 \n\nTypeError: can only concatenate str (not \"bytes\") to str\n```\n\nLatte probably raises an error here, which we fail to communicate. The `RuntimeError` was never tested.\n\nKeywords: latte, runtime error\n\nReviewer: Matthias Koeppe\n\nAuthor: Jonathan Kliem\n\nBranch: 7f8815a04e2d19d4469e835c0543307c702ff26d\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/31130\n\n",
    "closed_at": "2021-01-04T22:37:05Z",
    "created_at": "2020-12-29T09:33:24Z",
    "labels": [
        "component: geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Latte error raising does not work",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31130",
    "user": "https://github.com/kliem"
}
```
From #31046:

```
sage: P = Polyhedron(rays=[[1,0],[0,1]])                                                                                                                                            
sage: P._volume_latte()                                                                                                                                                             
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-2-abc8351118c1> in <module>
----> 1 P._volume_latte()

~/Applications/sage/local/lib/python3.8/site-packages/sage/geometry/polyhedron/base.py in _volume_latte(self, verbose, algorithm, **kwargs)
   7888             raise ValueError("LattE integrale cannot be applied over inexact rings")
   7889         else:
-> 7890             return integrate(self.cdd_Hrepresentation(), algorithm=algorithm, cdd=True, verbose=verbose, **kwargs)
   7891 
   7892     def _volume_normaliz(self, measure='induced'):

~/Applications/sage/local/lib/python3.8/site-packages/sage/interfaces/latte.py in integrate(arg, polynomial, algorithm, raw_output, verbose, **kwds)
    372             err = ", see error message above"
    373         else:
--> 374             err = ":\n" + err
    375         raise RuntimeError("LattE integrale program failed (exit code {})".format(ret_code) + err.strip())
    376 

TypeError: can only concatenate str (not "bytes") to str
```

Latte probably raises an error here, which we fail to communicate. The `RuntimeError` was never tested.

Keywords: latte, runtime error

Reviewer: Matthias Koeppe

Author: Jonathan Kliem

Branch: 7f8815a04e2d19d4469e835c0543307c702ff26d

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/31130





---

archive/issue_comments_618163.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|\n|[9b2a548](https://github.com/sagemath/sagetrac-mirror/commit/9b2a548c6cb78aae9240be82f75c946475fde8f7)|`raise correct runtime error on latte failure`|",
    "created_at": "2020-12-29T09:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-618163",
    "user": "https://github.com/kliem"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                              |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
|[9b2a548](https://github.com/sagemath/sagetrac-mirror/commit/9b2a548c6cb78aae9240be82f75c946475fde8f7)|`raise correct runtime error on latte failure`|



---

archive/issue_comments_618164.json:
```json
{
    "body": "Changing branch from \"\" to \"public/31130\"",
    "created_at": "2020-12-29T09:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-618164",
    "user": "https://github.com/kliem"
}
```

Changing branch from "" to "public/31130"



---

archive/issue_comments_618165.json:
```json
{
    "body": "Changing author from \"\" to \"Jonathan Kliem\"",
    "created_at": "2020-12-29T09:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-618165",
    "user": "https://github.com/kliem"
}
```

Changing author from "" to "Jonathan Kliem"



---

archive/issue_comments_618166.json:
```json
{
    "body": "Changing commit from \"\" to \"9b2a548c6cb78aae9240be82f75c946475fde8f7\"",
    "created_at": "2020-12-29T09:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-618166",
    "user": "https://github.com/kliem"
}
```

Changing commit from "" to "9b2a548c6cb78aae9240be82f75c946475fde8f7"



---

archive/issue_comments_618167.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-12-29T09:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-618167",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_618168.json:
```json
{
    "body": "Changing keywords from \"\" to \"latte, runtime error\".",
    "created_at": "2020-12-29T09:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-618168",
    "user": "https://github.com/kliem"
}
```

Changing keywords from "" to "latte, runtime error".



---

archive/issue_comments_618169.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Matthias Koeppe\"",
    "created_at": "2020-12-29T18:17:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-618169",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "" to "Matthias Koeppe"



---

archive/issue_comments_618170.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-12-29T18:17:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-618170",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_618171.json:
```json
{
    "body": "Changing commit from \"9b2a548c6cb78aae9240be82f75c946475fde8f7\" to \"7f8815a04e2d19d4469e835c0543307c702ff26d\"",
    "created_at": "2020-12-29T20:57:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-618171",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9b2a548c6cb78aae9240be82f75c946475fde8f7" to "7f8815a04e2d19d4469e835c0543307c702ff26d"



---

archive/issue_comments_618172.json:
```json
{
    "body": "<a id='comment:4'></a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n|                                                                                                                                           |                          |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|\n|[7f8815a](https://github.com/sagemath/sagetrac-mirror/commit/7f8815a04e2d19d4469e835c0543307c702ff26d)|`actually testing the bug`|",
    "created_at": "2020-12-29T20:57:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-618172",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
|                                                                                                                                           |                          |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|[7f8815a](https://github.com/sagemath/sagetrac-mirror/commit/7f8815a04e2d19d4469e835c0543307c702ff26d)|`actually testing the bug`|



---

archive/issue_comments_618173.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-12-29T20:57:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-618173",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_618174.json:
```json
{
    "body": "<a id='comment:5'></a>\nThanks and sorry: The second doctest that I added did not contain an error message and therefore is working fine with and without this ticket.\n\nI replaced by the doctest from this ticket that includes an error message now (and wasn't working before).",
    "created_at": "2020-12-29T20:59:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-618174",
    "user": "https://github.com/kliem"
}
```

<a id='comment:5'></a>
Thanks and sorry: The second doctest that I added did not contain an error message and therefore is working fine with and without this ticket.

I replaced by the doctest from this ticket that includes an error message now (and wasn't working before).



---

archive/issue_comments_618175.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-12-29T21:10:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-618175",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_618176.json:
```json
{
    "body": "Changing branch from \"public/31130\" to \"7f8815a04e2d19d4469e835c0543307c702ff26d\"",
    "created_at": "2021-01-04T22:37:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-618176",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/31130" to "7f8815a04e2d19d4469e835c0543307c702ff26d"



---

archive/issue_comments_618177.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-01-04T22:37:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-618177",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_091620.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-01-04T22:37:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31130#event-91620"
}
```



---

archive/issue_comments_618178.json:
```json
{
    "body": "Changing commit from \"7f8815a04e2d19d4469e835c0543307c702ff26d\" to \"\"",
    "created_at": "2021-03-05T07:54:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-618178",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "7f8815a04e2d19d4469e835c0543307c702ff26d" to ""



---

archive/issue_comments_618179.json:
```json
{
    "body": "<a id='comment:8'></a>\nwhat about #31046 now ? can it be closed ?",
    "created_at": "2021-03-05T07:54:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-618179",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>
what about #31046 now ? can it be closed ?



---

archive/issue_comments_618180.json:
```json
{
    "body": "<a id='comment:9'></a>\nI don't think so. #31046 reports some doctest failures. But we don't know which ones, because there is no proper error message. Now that this ticket is closed, we can hope that we can a proper report of this message.\n\nWell, we could also close #31046 and wait until the error shows up again.",
    "created_at": "2021-03-05T08:02:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31130",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31130#issuecomment-618180",
    "user": "https://github.com/kliem"
}
```

<a id='comment:9'></a>
I don't think so. #31046 reports some doctest failures. But we don't know which ones, because there is no proper error message. Now that this ticket is closed, we can hope that we can a proper report of this message.

Well, we could also close #31046 and wait until the error shows up again.
