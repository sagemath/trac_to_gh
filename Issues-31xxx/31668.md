# Issue 31668: Run TestSuite on polynomial rings

archive/issues_031431.json:
```json
{
    "body": "#27364 fixes a bug that `_test_construction` should have found -- except `TestSuite` is not called at all for any multivariate polynomial rings. \n\nWe add a bunch of `TestSuite` calls for the rings constructed as examples in `polynomial_ring_constructor`.\n\nMany tests are failing; we skip these tests to make this ticket mergeable. In follow-up tickets, these failures should be fixed.\n\nRelated:\n- https://groups.google.com/g/sage-devel/c/vGzNJKAQWbs/m/nhm1iIPWAwAJ\n- https://groups.google.com/g/sage-devel/c/xiH9d4oBwaI/m/9Q0U1bUlAwAJ\n\n\nCC:  @tscrim @videlec @dkrenn @mwageringel @mezzarobba @yuan-zhou @novoselt @nbruin\n\nBranch: [u/mkoeppe/run_testsuite_on_polynomial_rings](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/run_testsuite_on_polynomial_rings)\n\nReviewer: Vincent Delecroix\n\nAuthor: Matthias Koeppe\n\nStatus: needs_work\n\nCommit: 55b29808ee9b204ee2e8adf9321e632bd9718d90\n\nIssue created by migration from https://trac.sagemath.org/ticket/31668\n\n",
    "created_at": "2021-04-13T18:17:04Z",
    "labels": [
        "component: commutative algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Run TestSuite on polynomial rings",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31668",
    "user": "https://github.com/mkoeppe"
}
```
#27364 fixes a bug that `_test_construction` should have found -- except `TestSuite` is not called at all for any multivariate polynomial rings. 

We add a bunch of `TestSuite` calls for the rings constructed as examples in `polynomial_ring_constructor`.

Many tests are failing; we skip these tests to make this ticket mergeable. In follow-up tickets, these failures should be fixed.

Related:
- https://groups.google.com/g/sage-devel/c/vGzNJKAQWbs/m/nhm1iIPWAwAJ
- https://groups.google.com/g/sage-devel/c/xiH9d4oBwaI/m/9Q0U1bUlAwAJ


CC:  @tscrim @videlec @dkrenn @mwageringel @mezzarobba @yuan-zhou @novoselt @nbruin

Branch: [u/mkoeppe/run_testsuite_on_polynomial_rings](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/run_testsuite_on_polynomial_rings)

Reviewer: Vincent Delecroix

Author: Matthias Koeppe

Status: needs_work

Commit: 55b29808ee9b204ee2e8adf9321e632bd9718d90

Issue created by migration from https://trac.sagemath.org/ticket/31668





---

archive/issue_comments_630206.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/run_testsuite_on_polynomial_rings\"",
    "created_at": "2021-04-13T18:32:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630206",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/run_testsuite_on_polynomial_rings"



---

archive/issue_comments_630207.json:
```json
{
    "body": "Changing commit from \"\" to \"c23ae6910ba9802d104e4d233b8bab7385df69a2\"",
    "created_at": "2021-04-13T18:34:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630207",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "c23ae6910ba9802d104e4d233b8bab7385df69a2"



---

archive/issue_comments_630208.json:
```json
{
    "body": "<a id='comment:2'></a>\n\n```\nsage -t --random-seed=0 src/sage/rings/polynomial/polynomial_ring_constructor.py  # 12 doctests failed\n```\n\n---\nNew commits:\n|                                                                                                                                          |                                                                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|\n|[c23ae69](https://github.com/sagemath/sagetrac-mirror/commit/c23ae6910ba9802d104e4d233b8bab7385df69a2)|`src/sage/rings/polynomial/polynomial_ring_constructor.py: Add TestSuite calls`|",
    "created_at": "2021-04-13T18:34:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630208",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>

```
sage -t --random-seed=0 src/sage/rings/polynomial/polynomial_ring_constructor.py  # 12 doctests failed
```

---
New commits:
|                                                                                                                                          |                                                                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|
|[c23ae69](https://github.com/sagemath/sagetrac-mirror/commit/c23ae6910ba9802d104e4d233b8bab7385df69a2)|`src/sage/rings/polynomial/polynomial_ring_constructor.py: Add TestSuite calls`|



---

archive/issue_comments_630209.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#27364\"",
    "created_at": "2021-04-13T18:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630209",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#27364"



---

archive/issue_comments_630210.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe, ...\"",
    "created_at": "2021-04-26T17:12:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630210",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe, ..."



---

archive/issue_comments_630211.json:
```json
{
    "body": "<a id='comment:6'></a>\nOne more test to add here (from #27261): check that multipolynomial substitution works consistently and return objects in the right parent\n\n```\ndef test(base_ring):\n    R = base_ring['x, y']\n    S = base_ring['q, r']\n    x, y = R.gens()\n    q, r = S.gens()\n    polys = [R.zero(), R.one(), x, y, x + y]\n    assert all(p.subs(x=0).parent() is R for p in polys)\n    assert all(p.subs(y=0).parent() is R for p in polys)\n    assert all(p.subs(x=0, y=0).parent() is base_ring for p in polys)\n    assert all(p.subs(x=q, y=r).parent() is S for p in polys)\n```",
    "created_at": "2021-05-19T07:02:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630211",
    "user": "https://github.com/videlec"
}
```

<a id='comment:6'></a>
One more test to add here (from #27261): check that multipolynomial substitution works consistently and return objects in the right parent

```
def test(base_ring):
    R = base_ring['x, y']
    S = base_ring['q, r']
    x, y = R.gens()
    q, r = S.gens()
    polys = [R.zero(), R.one(), x, y, x + y]
    assert all(p.subs(x=0).parent() is R for p in polys)
    assert all(p.subs(y=0).parent() is R for p in polys)
    assert all(p.subs(x=0, y=0).parent() is base_ring for p in polys)
    assert all(p.subs(x=q, y=r).parent() is S for p in polys)
```



---

archive/issue_comments_630212.json:
```json
{
    "body": "Changing commit from \"c23ae6910ba9802d104e4d233b8bab7385df69a2\" to \"b4978ea8f2677ddc68bdc23392aeeeff0f887c10\"",
    "created_at": "2021-05-24T00:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630212",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c23ae6910ba9802d104e4d233b8bab7385df69a2" to "b4978ea8f2677ddc68bdc23392aeeeff0f887c10"



---

archive/issue_comments_630213.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|\n|[8f0c05b](https://github.com/sagemath/sagetrac-mirror/commit/8f0c05b731201eea8f6f0f34634241fbf3f619e8)|`src/sage/rings/polynomial/polynomial_ring_constructor.py: Add TestSuite calls`|\n|[b4978ea](https://github.com/sagemath/sagetrac-mirror/commit/b4978ea8f2677ddc68bdc23392aeeeff0f887c10)|`MPolynomial_element._test_subs: New`|",
    "created_at": "2021-05-24T00:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630213",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|
|[8f0c05b](https://github.com/sagemath/sagetrac-mirror/commit/8f0c05b731201eea8f6f0f34634241fbf3f619e8)|`src/sage/rings/polynomial/polynomial_ring_constructor.py: Add TestSuite calls`|
|[b4978ea](https://github.com/sagemath/sagetrac-mirror/commit/b4978ea8f2677ddc68bdc23392aeeeff0f887c10)|`MPolynomial_element._test_subs: New`|



---

archive/issue_comments_630214.json:
```json
{
    "body": "Changing commit from \"b4978ea8f2677ddc68bdc23392aeeeff0f887c10\" to \"0467ec455a298f37bc8e455c90dba5965600f5c8\"",
    "created_at": "2021-05-24T00:48:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630214",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b4978ea8f2677ddc68bdc23392aeeeff0f887c10" to "0467ec455a298f37bc8e455c90dba5965600f5c8"



---

archive/issue_comments_630215.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                         |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|\n|[0467ec4](https://github.com/sagemath/sagetrac-mirror/commit/0467ec455a298f37bc8e455c90dba5965600f5c8)|`MPolynomialRing_base.some_elements: New`|",
    "created_at": "2021-05-24T00:48:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630215",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|
|[0467ec4](https://github.com/sagemath/sagetrac-mirror/commit/0467ec455a298f37bc8e455c90dba5965600f5c8)|`MPolynomialRing_base.some_elements: New`|



---

archive/issue_comments_630216.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                         |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|\n|[07f710a](https://github.com/sagemath/sagetrac-mirror/commit/07f710ad10f9b9be4bfd81010fe50d1332176af3)|`MPolynomialRing_base.some_elements: New`|",
    "created_at": "2021-05-24T00:51:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630216",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|
|[07f710a](https://github.com/sagemath/sagetrac-mirror/commit/07f710ad10f9b9be4bfd81010fe50d1332176af3)|`MPolynomialRing_base.some_elements: New`|



---

archive/issue_comments_630217.json:
```json
{
    "body": "Changing commit from \"0467ec455a298f37bc8e455c90dba5965600f5c8\" to \"07f710ad10f9b9be4bfd81010fe50d1332176af3\"",
    "created_at": "2021-05-24T00:51:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630217",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0467ec455a298f37bc8e455c90dba5965600f5c8" to "07f710ad10f9b9be4bfd81010fe50d1332176af3"



---

archive/issue_comments_630218.json:
```json
{
    "body": "Changing dependencies from \"#27364\" to \"\"",
    "created_at": "2021-05-24T01:29:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630218",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#27364" to ""



---

archive/issue_comments_630219.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [vdelecroix](#comment%3A6):\n> One more test to add here (from #27261): check that multipolynomial substitution works consistently and return objects in the right parent\n> \n> ```\n> def test(base_ring):\n>     R = base_ring['x, y']\n>     S = base_ring['q, r']\n>     x, y = R.gens()\n>     q, r = S.gens()\n>     polys = [R.zero(), R.one(), x, y, x + y]\n>     assert all(p.subs(x=0).parent() is R for p in polys)\n>     assert all(p.subs(y=0).parent() is R for p in polys)\n>     assert all(p.subs(x=0, y=0).parent() is base_ring for p in polys)\n>     assert all(p.subs(x=q, y=r).parent() is S for p in polys)\n> ```\n\n\nI disagree with this logic - why the parent of the result depends on values used for substitution? If one always wants \"the minimal parent\", then after plugging in `x=0` one can end up in `base_ring[y]`. When the variables and their substitution values are computed in some fashion and then substituted into a bunch of different polynomials it is inconvenient that the result may have different type and so one has to consider multiple cases. I hit it because toric code breaks on certain examples because of this issue.",
    "created_at": "2021-05-24T01:58:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630219",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:12'></a>
Replying to [vdelecroix](#comment%3A6):
> One more test to add here (from #27261): check that multipolynomial substitution works consistently and return objects in the right parent
> 
> ```
> def test(base_ring):
>     R = base_ring['x, y']
>     S = base_ring['q, r']
>     x, y = R.gens()
>     q, r = S.gens()
>     polys = [R.zero(), R.one(), x, y, x + y]
>     assert all(p.subs(x=0).parent() is R for p in polys)
>     assert all(p.subs(y=0).parent() is R for p in polys)
>     assert all(p.subs(x=0, y=0).parent() is base_ring for p in polys)
>     assert all(p.subs(x=q, y=r).parent() is S for p in polys)
> ```


I disagree with this logic - why the parent of the result depends on values used for substitution? If one always wants "the minimal parent", then after plugging in `x=0` one can end up in `base_ring[y]`. When the variables and their substitution values are computed in some fashion and then substituted into a bunch of different polynomials it is inconvenient that the result may have different type and so one has to consider multiple cases. I hit it because toric code breaks on certain examples because of this issue.



---

archive/issue_comments_630220.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                  |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|\n|[235f64e](https://github.com/sagemath/sagetrac-mirror/commit/235f64ed0a851cf4062c544bab552063700927c6)|`src/sage/rings/polynomial/pbori/pbori.pyx: Skip failing test _test_zero_divisors`|\n|[f1b3ea5](https://github.com/sagemath/sagetrac-mirror/commit/f1b3ea5ca7689ff22b1012060a431fd4f1e186bb)|`PolynomialFunctor: Keep track of implementation`|",
    "created_at": "2021-05-24T02:04:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630220",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                  |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|
|[235f64e](https://github.com/sagemath/sagetrac-mirror/commit/235f64ed0a851cf4062c544bab552063700927c6)|`src/sage/rings/polynomial/pbori/pbori.pyx: Skip failing test _test_zero_divisors`|
|[f1b3ea5](https://github.com/sagemath/sagetrac-mirror/commit/f1b3ea5ca7689ff22b1012060a431fd4f1e186bb)|`PolynomialFunctor: Keep track of implementation`|



---

archive/issue_comments_630221.json:
```json
{
    "body": "Changing commit from \"07f710ad10f9b9be4bfd81010fe50d1332176af3\" to \"f1b3ea5ca7689ff22b1012060a431fd4f1e186bb\"",
    "created_at": "2021-05-24T02:04:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630221",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "07f710ad10f9b9be4bfd81010fe50d1332176af3" to "f1b3ea5ca7689ff22b1012060a431fd4f1e186bb"



---

archive/issue_comments_630222.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [novoselt](#comment%3A12):\n> Replying to [vdelecroix](#comment%3A6):\n> > {{{\n> > def test(base_ring):\n> >     R = base_ring['x, y']\n> >     S = base_ring['q, r']\n> >     x, y = R.gens()\n> >     q, r = S.gens()\n> >     polys = [R.zero(), R.one(), x, y, x + y]\n> >     assert all(p.subs(x=0).parent() is R for p in polys)\n> >     assert all(p.subs(y=0).parent() is R for p in polys)\n> >     assert all(p.subs(x=0, y=0).parent() is base_ring for p in polys)\n> >     assert all(p.subs(x=q, y=r).parent() is S for p in polys)\n> > }}}\n\n> \n> I disagree with this logic - why the parent of the result depends on values used for substitution? \n\n\nJust a quick comment -- the above only demonstrates that the parent of the result depends on the parents of the substituted values (not the values themselves), and which subset is substituted.",
    "created_at": "2021-05-24T02:25:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630222",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>
Replying to [novoselt](#comment%3A12):
> Replying to [vdelecroix](#comment%3A6):
> > {{{
> > def test(base_ring):
> >     R = base_ring['x, y']
> >     S = base_ring['q, r']
> >     x, y = R.gens()
> >     q, r = S.gens()
> >     polys = [R.zero(), R.one(), x, y, x + y]
> >     assert all(p.subs(x=0).parent() is R for p in polys)
> >     assert all(p.subs(y=0).parent() is R for p in polys)
> >     assert all(p.subs(x=0, y=0).parent() is base_ring for p in polys)
> >     assert all(p.subs(x=q, y=r).parent() is S for p in polys)
> > }}}

> 
> I disagree with this logic - why the parent of the result depends on values used for substitution? 


Just a quick comment -- the above only demonstrates that the parent of the result depends on the parents of the substituted values (not the values themselves), and which subset is substituted.



---

archive/issue_comments_630223.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [mkoeppe](#comment%3A15):\n> Replying to [novoselt](#comment%3A12):\n> > Replying to [vdelecroix](#comment%3A6):\n> > > {{{\n> > > def test(base_ring):\n> > >     R = base_ring['x, y']\n> > >     S = base_ring['q, r']\n> > >     x, y = R.gens()\n> > >     q, r = S.gens()\n> > >     polys = [R.zero(), R.one(), x, y, x + y]\n> > >     assert all(p.subs(x=0).parent() is R for p in polys)\n> > >     assert all(p.subs(y=0).parent() is R for p in polys)\n> > >     assert all(p.subs(x=0, y=0).parent() is base_ring for p in polys)\n> > >     assert all(p.subs(x=q, y=r).parent() is S for p in polys)\n> > > }}}\n\n> > \n> > I disagree with this logic - why the parent of the result depends on values used for substitution? \n\n> \n> Just a quick comment -- the above only demonstrates that the parent of the result depends on the parents of the substituted values (not the values themselves), and which subset is substituted.\n\n\nAnd more precisely, the rule for substitution is:\n- if the substitution is \"partial\" then the omitted variables are set to themselves\n- for a full substitution, the result of the parent is set to be the common_parent of the base_ring of the polynomial ring and the parents of values to be substituted",
    "created_at": "2021-05-24T06:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630223",
    "user": "https://github.com/videlec"
}
```

<a id='comment:16'></a>
Replying to [mkoeppe](#comment%3A15):
> Replying to [novoselt](#comment%3A12):
> > Replying to [vdelecroix](#comment%3A6):
> > > {{{
> > > def test(base_ring):
> > >     R = base_ring['x, y']
> > >     S = base_ring['q, r']
> > >     x, y = R.gens()
> > >     q, r = S.gens()
> > >     polys = [R.zero(), R.one(), x, y, x + y]
> > >     assert all(p.subs(x=0).parent() is R for p in polys)
> > >     assert all(p.subs(y=0).parent() is R for p in polys)
> > >     assert all(p.subs(x=0, y=0).parent() is base_ring for p in polys)
> > >     assert all(p.subs(x=q, y=r).parent() is S for p in polys)
> > > }}}

> > 
> > I disagree with this logic - why the parent of the result depends on values used for substitution? 

> 
> Just a quick comment -- the above only demonstrates that the parent of the result depends on the parents of the substituted values (not the values themselves), and which subset is substituted.


And more precisely, the rule for substitution is:
- if the substitution is "partial" then the omitted variables are set to themselves
- for a full substitution, the result of the parent is set to be the common_parent of the base_ring of the polynomial ring and the parents of values to be substituted



---

archive/issue_comments_630224.json:
```json
{
    "body": "<a id='comment:17'></a>\nNote that the parents of substituted polynomials should be fixed in #27261. We can either set it as a dependency of this ticket or I can split this part from #27261 into an independent ticket.",
    "created_at": "2021-05-24T06:45:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630224",
    "user": "https://github.com/videlec"
}
```

<a id='comment:17'></a>
Note that the parents of substituted polynomials should be fixed in #27261. We can either set it as a dependency of this ticket or I can split this part from #27261 into an independent ticket.



---

archive/issue_comments_630225.json:
```json
{
    "body": "<a id='comment:18'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------|\n|[5ec3a73](https://github.com/sagemath/sagetrac-mirror/commit/5ec3a7310e0476cd8fd7665c08795ef73fe3f518)|`src/sage/rings/polynomial/polynomial_ring_constructor.py: Skip the failing TestSuite tests`|",
    "created_at": "2021-05-24T06:46:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630225",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------|
|[5ec3a73](https://github.com/sagemath/sagetrac-mirror/commit/5ec3a7310e0476cd8fd7665c08795ef73fe3f518)|`src/sage/rings/polynomial/polynomial_ring_constructor.py: Skip the failing TestSuite tests`|



---

archive/issue_comments_630226.json:
```json
{
    "body": "Changing commit from \"f1b3ea5ca7689ff22b1012060a431fd4f1e186bb\" to \"5ec3a7310e0476cd8fd7665c08795ef73fe3f518\"",
    "created_at": "2021-05-24T06:46:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630226",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f1b3ea5ca7689ff22b1012060a431fd4f1e186bb" to "5ec3a7310e0476cd8fd7665c08795ef73fe3f518"



---

archive/issue_comments_630227.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-05-24T06:49:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630227",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_630228.json:
```json
{
    "body": "Changing author from \"Matthias Koeppe, ...\" to \"Matthias Koeppe\"",
    "created_at": "2021-05-24T06:49:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630228",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "Matthias Koeppe, ..." to "Matthias Koeppe"



---

archive/issue_comments_630229.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [vdelecroix](#comment%3A17):\n> Note that the parents of substituted polynomials should be fixed in #27261. We can either set it as a dependency of this ticket or I can split this part from #27261 into an independent ticket.\n\n\nI have prepared the present ticket for inclusion by disabling the failing tests.\n\nReady for review",
    "created_at": "2021-05-24T06:50:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630229",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>
Replying to [vdelecroix](#comment%3A17):
> Note that the parents of substituted polynomials should be fixed in #27261. We can either set it as a dependency of this ticket or I can split this part from #27261 into an independent ticket.


I have prepared the present ticket for inclusion by disabling the failing tests.

Ready for review



---

archive/issue_comments_630230.json:
```json
{
    "body": "<a id='comment:21'></a>\nWhy something that specific is needed in `rings/polynomial/polynomial_ring.py`?\n\n```\ndef construction(self):\n    ...\n    implementation = None\n    if 'NTL' in self._implementation_repr:\n        implementation = 'NTL'\n    ...\n```\n\nOn multi-variate polynomials with a single variable this test should fail\n\n```\n            # substituting one variable (in a polynomial ring with variables) with 0\n            d = {str(gens[0]): 0}\n            tester.assertEqual(self.subs(**d).parent(), self.parent())\n```",
    "created_at": "2021-05-24T07:04:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630230",
    "user": "https://github.com/videlec"
}
```

<a id='comment:21'></a>
Why something that specific is needed in `rings/polynomial/polynomial_ring.py`?

```
def construction(self):
    ...
    implementation = None
    if 'NTL' in self._implementation_repr:
        implementation = 'NTL'
    ...
```

On multi-variate polynomials with a single variable this test should fail

```
            # substituting one variable (in a polynomial ring with variables) with 0
            d = {str(gens[0]): 0}
            tester.assertEqual(self.subs(**d).parent(), self.parent())
```



---

archive/issue_comments_630231.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Vincent Delecroix\"",
    "created_at": "2021-05-24T07:04:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630231",
    "user": "https://github.com/videlec"
}
```

Changing reviewer from "" to "Vincent Delecroix"



---

archive/issue_comments_630232.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [vdelecroix](#comment%3A21):\n> Why something that specific is needed in `rings/polynomial/polynomial_ring.py`?\n> \n> ```\n> def construction(self):\n>     ...\n>     implementation = None\n>     if 'NTL' in self._implementation_repr:\n>         implementation = 'NTL'\n>     ...\n> ```\n\n\nThis is obviously not a complete solution. The parents don't keep track in a clean way what the implementation is. I have some other experimental code that tries to decode the element class, but it's all not very satisfying.",
    "created_at": "2021-05-24T07:06:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630232",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>
Replying to [vdelecroix](#comment%3A21):
> Why something that specific is needed in `rings/polynomial/polynomial_ring.py`?
> 
> ```
> def construction(self):
>     ...
>     implementation = None
>     if 'NTL' in self._implementation_repr:
>         implementation = 'NTL'
>     ...
> ```


This is obviously not a complete solution. The parents don't keep track in a clean way what the implementation is. I have some other experimental code that tries to decode the element class, but it's all not very satisfying.



---

archive/issue_comments_630233.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [mkoeppe](#comment%3A23):\n> Replying to [vdelecroix](#comment%3A21):\n> > Why something that specific is needed in `rings/polynomial/polynomial_ring.py`?\n> > \n> > ```\n> > def construction(self):\n> >     ...\n> >     implementation = None\n> >     if 'NTL' in self._implementation_repr:\n> >         implementation = 'NTL'\n> >     ...\n> > ```\n\n> \n> This is obviously not a complete solution. The parents don't keep track in a clean way what the implementation is. I have some other experimental code that tries to decode the element class, but it's all not very satisfying.\n\n\nCertainly not optimal, but something similar is implemented for `MatrixSpace` (from `matrix/matrix_class.py`) via `_has_default_implementation`.",
    "created_at": "2021-05-24T07:10:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630233",
    "user": "https://github.com/videlec"
}
```

<a id='comment:24'></a>
Replying to [mkoeppe](#comment%3A23):
> Replying to [vdelecroix](#comment%3A21):
> > Why something that specific is needed in `rings/polynomial/polynomial_ring.py`?
> > 
> > ```
> > def construction(self):
> >     ...
> >     implementation = None
> >     if 'NTL' in self._implementation_repr:
> >         implementation = 'NTL'
> >     ...
> > ```

> 
> This is obviously not a complete solution. The parents don't keep track in a clean way what the implementation is. I have some other experimental code that tries to decode the element class, but it's all not very satisfying.


Certainly not optimal, but something similar is implemented for `MatrixSpace` (from `matrix/matrix_class.py`) via `_has_default_implementation`.



---

archive/issue_comments_630234.json:
```json
{
    "body": "<a id='comment:25'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------|\n|[64cfc50](https://github.com/sagemath/sagetrac-mirror/commit/64cfc5052f5cae294ed7002c6d5743a06c7760e2)|`MPolynomial_element._test_subs: Test substituting 1 variable only in rings with > 1 variable`|",
    "created_at": "2021-05-24T07:12:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630234",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------|
|[64cfc50](https://github.com/sagemath/sagetrac-mirror/commit/64cfc5052f5cae294ed7002c6d5743a06c7760e2)|`MPolynomial_element._test_subs: Test substituting 1 variable only in rings with > 1 variable`|



---

archive/issue_comments_630235.json:
```json
{
    "body": "Changing commit from \"5ec3a7310e0476cd8fd7665c08795ef73fe3f518\" to \"64cfc5052f5cae294ed7002c6d5743a06c7760e2\"",
    "created_at": "2021-05-24T07:12:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630235",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5ec3a7310e0476cd8fd7665c08795ef73fe3f518" to "64cfc5052f5cae294ed7002c6d5743a06c7760e2"



---

archive/issue_comments_630236.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [vdelecroix](#comment%3A24):\n> Certainly not optimal, but something similar is implemented for `MatrixSpace` (from `matrix/matrix_class.py`) via `_has_default_implementation`.\n\n\nThanks for the pointer. \n\nPerhaps something for a follow-up ticket?",
    "created_at": "2021-05-24T07:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630236",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>
Replying to [vdelecroix](#comment%3A24):
> Certainly not optimal, but something similar is implemented for `MatrixSpace` (from `matrix/matrix_class.py`) via `_has_default_implementation`.


Thanks for the pointer. 

Perhaps something for a follow-up ticket?



---

archive/issue_comments_630237.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [mkoeppe](#comment%3A26):\n> Replying to [vdelecroix](#comment%3A24):\n> > Certainly not optimal, but something similar is implemented for `MatrixSpace` (from `matrix/matrix_class.py`) via `_has_default_implementation`.\n\n> \n> Thanks for the pointer. \n> \n> Perhaps something for a follow-up ticket?\n\n\nDefinitely: this is #31852. I was not convinced by the solution I used for `MatrixClass`. I secretly hoped that you had some alternative.",
    "created_at": "2021-05-24T07:30:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630237",
    "user": "https://github.com/videlec"
}
```

<a id='comment:27'></a>
Replying to [mkoeppe](#comment%3A26):
> Replying to [vdelecroix](#comment%3A24):
> > Certainly not optimal, but something similar is implemented for `MatrixSpace` (from `matrix/matrix_class.py`) via `_has_default_implementation`.

> 
> Thanks for the pointer. 
> 
> Perhaps something for a follow-up ticket?


Definitely: this is #31852. I was not convinced by the solution I used for `MatrixClass`. I secretly hoped that you had some alternative.



---

archive/issue_comments_630238.json:
```json
{
    "body": "<a id='comment:28'></a>\nAlso, the test suite does not catch invalid substitution such as\n\n```\nsage: QQ['x,y'].gen(0).subs(x=QQ['t'].gen())  # not intended to work\nt\n```",
    "created_at": "2021-05-24T07:33:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630238",
    "user": "https://github.com/videlec"
}
```

<a id='comment:28'></a>
Also, the test suite does not catch invalid substitution such as

```
sage: QQ['x,y'].gen(0).subs(x=QQ['t'].gen())  # not intended to work
t
```



---

archive/issue_comments_630239.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [vdelecroix](#comment%3A16):\n> Replying to [mkoeppe](#comment%3A15):\n> > Replying to [novoselt](#comment%3A12):\n> > > I disagree with this logic - why the parent of the result depends on values used for substitution? \n\n> > \n> > Just a quick comment -- the above only demonstrates that the parent of the result depends on the parents of the substituted values (not the values themselves), and which subset is substituted.\n\n> \n> And more precisely, the rule for substitution is:\n> - if the substitution is \"partial\" then the omitted variables are set to themselves\n> - for a full substitution, the result of the parent is set to be the common_parent of the base_ring of the polynomial ring and the parents of values to be substituted\n\n\nWhat is \"partial\"? How about this one:\n\n```\nsage: R.<x, y> = QQ[]\nsage: parent(x.subs(x=1))\nMultivariate Polynomial Ring in x, y over Rational Field\nsage: R.<x, y> = QQ[\"a, b\"][]\nsage: parent(x.subs(x=1))\nMultivariate Polynomial Ring in a, b over Rational Field\n```\nI also think that it makes sense to have the same results here\n\n```\nsage; R.<x, y> = QQ[\"a, b\"][]\nsage: p = x + y\nsage: parent(p.subs(x=1, y=2))\nMultivariate Polynomial Ring in a, b over Rational Field\nsage: parent(p.subs(x=1).subs(y=2))\nMultivariate Polynomial Ring in x, y over Multivariate Polynomial Ring in a, b over Rational Field\n```",
    "created_at": "2021-05-24T14:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630239",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:29'></a>
Replying to [vdelecroix](#comment%3A16):
> Replying to [mkoeppe](#comment%3A15):
> > Replying to [novoselt](#comment%3A12):
> > > I disagree with this logic - why the parent of the result depends on values used for substitution? 

> > 
> > Just a quick comment -- the above only demonstrates that the parent of the result depends on the parents of the substituted values (not the values themselves), and which subset is substituted.

> 
> And more precisely, the rule for substitution is:
> - if the substitution is "partial" then the omitted variables are set to themselves
> - for a full substitution, the result of the parent is set to be the common_parent of the base_ring of the polynomial ring and the parents of values to be substituted


What is "partial"? How about this one:

```
sage: R.<x, y> = QQ[]
sage: parent(x.subs(x=1))
Multivariate Polynomial Ring in x, y over Rational Field
sage: R.<x, y> = QQ["a, b"][]
sage: parent(x.subs(x=1))
Multivariate Polynomial Ring in a, b over Rational Field
```
I also think that it makes sense to have the same results here

```
sage; R.<x, y> = QQ["a, b"][]
sage: p = x + y
sage: parent(p.subs(x=1, y=2))
Multivariate Polynomial Ring in a, b over Rational Field
sage: parent(p.subs(x=1).subs(y=2))
Multivariate Polynomial Ring in x, y over Multivariate Polynomial Ring in a, b over Rational Field
```



---

archive/issue_comments_630240.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [novoselt](#comment%3A29):\n> Replying to [vdelecroix](#comment%3A16):\n> > Replying to [mkoeppe](#comment%3A15):\n> > > Replying to [novoselt](#comment%3A12):\n> > > > I disagree with this logic - why the parent of the result depends on values used for substitution? \n\n> > > \n> > > Just a quick comment -- the above only demonstrates that the parent of the result depends on the parents of the substituted values (not the values themselves), and which subset is substituted.\n\n> > \n> > And more precisely, the rule for substitution is:\n> > - if the substitution is \"partial\" then the omitted variables are set to themselves\n> > - for a full substitution, the result of the parent is set to be the common_parent of the base_ring of the polynomial ring and the parents of values to be substituted\n \n> \n> What is \"partial\"?\n\n\nPartial is when you do not substitute all variables. On `QQ[x,y]` if you only specify the value of `x`, let say `x=1` then `y` is set to `y`. In other words `p.subs(x=1)` is equivalent to `p(1, y)`. All the examples you wrote are perfectly valid and will be supported in the same way. The only example that is wrong and I want to disable is in [comment:28](#comment%3A28).",
    "created_at": "2021-05-24T17:40:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630240",
    "user": "https://github.com/videlec"
}
```

<a id='comment:30'></a>
Replying to [novoselt](#comment%3A29):
> Replying to [vdelecroix](#comment%3A16):
> > Replying to [mkoeppe](#comment%3A15):
> > > Replying to [novoselt](#comment%3A12):
> > > > I disagree with this logic - why the parent of the result depends on values used for substitution? 

> > > 
> > > Just a quick comment -- the above only demonstrates that the parent of the result depends on the parents of the substituted values (not the values themselves), and which subset is substituted.

> > 
> > And more precisely, the rule for substitution is:
> > - if the substitution is "partial" then the omitted variables are set to themselves
> > - for a full substitution, the result of the parent is set to be the common_parent of the base_ring of the polynomial ring and the parents of values to be substituted
 
> 
> What is "partial"?


Partial is when you do not substitute all variables. On `QQ[x,y]` if you only specify the value of `x`, let say `x=1` then `y` is set to `y`. In other words `p.subs(x=1)` is equivalent to `p(1, y)`. All the examples you wrote are perfectly valid and will be supported in the same way. The only example that is wrong and I want to disable is in [comment:28](#comment%3A28).



---

archive/issue_comments_630241.json:
```json
{
    "body": "<a id='comment:31'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|\n|[8b09245](https://github.com/sagemath/sagetrac-mirror/commit/8b09245398437d24b7aab7a1aa472545067dbbfc)|`MPolynomial_element._test_subs: Check that partial substitution by elements from another ring raises an exception`|",
    "created_at": "2021-05-24T18:17:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630241",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|
|[8b09245](https://github.com/sagemath/sagetrac-mirror/commit/8b09245398437d24b7aab7a1aa472545067dbbfc)|`MPolynomial_element._test_subs: Check that partial substitution by elements from another ring raises an exception`|



---

archive/issue_comments_630242.json:
```json
{
    "body": "Changing commit from \"64cfc5052f5cae294ed7002c6d5743a06c7760e2\" to \"8b09245398437d24b7aab7a1aa472545067dbbfc\"",
    "created_at": "2021-05-24T18:17:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630242",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "64cfc5052f5cae294ed7002c6d5743a06c7760e2" to "8b09245398437d24b7aab7a1aa472545067dbbfc"



---

archive/issue_comments_630243.json:
```json
{
    "body": "Changing commit from \"8b09245398437d24b7aab7a1aa472545067dbbfc\" to \"2529a15095b686dcb28b17e18e4565bbb5308df7\"",
    "created_at": "2021-05-24T18:36:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630243",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8b09245398437d24b7aab7a1aa472545067dbbfc" to "2529a15095b686dcb28b17e18e4565bbb5308df7"



---

archive/issue_comments_630244.json:
```json
{
    "body": "<a id='comment:32'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|\n|[da2beaa](https://github.com/sagemath/sagetrac-mirror/commit/da2beaaee15c03b7b00600e60eeac41499b6483f)|`Move _test_subs to superclass MPolynomial`|\n|[2529a15](https://github.com/sagemath/sagetrac-mirror/commit/2529a15095b686dcb28b17e18e4565bbb5308df7)|`BooleanPolynomialRing: Disable another failing TestSuite test`|",
    "created_at": "2021-05-24T18:36:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630244",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|
|[da2beaa](https://github.com/sagemath/sagetrac-mirror/commit/da2beaaee15c03b7b00600e60eeac41499b6483f)|`Move _test_subs to superclass MPolynomial`|
|[2529a15](https://github.com/sagemath/sagetrac-mirror/commit/2529a15095b686dcb28b17e18e4565bbb5308df7)|`BooleanPolynomialRing: Disable another failing TestSuite test`|



---

archive/issue_comments_630245.json:
```json
{
    "body": "<a id='comment:33'></a>\nThe example from comment 28 is now tested",
    "created_at": "2021-05-24T18:38:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630245",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'></a>
The example from comment 28 is now tested



---

archive/issue_comments_630246.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,3 +2,7 @@\n \n We add a bunch of `TestSuite` calls for the rings constructed as examples in `polynomial_ring_constructor`.\n \n+Many tests are failing; we skip these tests to make this ticket mergeable. In follow-up tickets, these failures should be fixed.\n+\n+\n+\n``````\n",
    "created_at": "2021-05-24T18:42:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630246",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,3 +2,7 @@
 
 We add a bunch of `TestSuite` calls for the rings constructed as examples in `polynomial_ring_constructor`.
 
+Many tests are failing; we skip these tests to make this ticket mergeable. In follow-up tickets, these failures should be fixed.
+
+
+
``````




---

archive/issue_comments_630247.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-05-24T21:29:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630247",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_630248.json:
```json
{
    "body": "<a id='comment:35'></a>\nAs expected, `QQ[x,y]` now fails its test suite. Great.\n\n```\nsage -t --long --random-seed=0 src/sage/rings/ring.pyx  # 2 doctests failed\nsage -t --long --random-seed=0 src/sage/rings/polynomial/polynomial_ring_constructor.py  # 4 doctests failed\n```",
    "created_at": "2021-05-24T21:29:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630248",
    "user": "https://github.com/videlec"
}
```

<a id='comment:35'></a>
As expected, `QQ[x,y]` now fails its test suite. Great.

```
sage -t --long --random-seed=0 src/sage/rings/ring.pyx  # 2 doctests failed
sage -t --long --random-seed=0 src/sage/rings/polynomial/polynomial_ring_constructor.py  # 4 doctests failed
```



---

archive/issue_comments_630249.json:
```json
{
    "body": "Changing commit from \"2529a15095b686dcb28b17e18e4565bbb5308df7\" to \"778d61e70c95f53cfe74d59fca94cbdfab9466a8\"",
    "created_at": "2021-05-24T22:37:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630249",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2529a15095b686dcb28b17e18e4565bbb5308df7" to "778d61e70c95f53cfe74d59fca94cbdfab9466a8"



---

archive/issue_comments_630250.json:
```json
{
    "body": "<a id='comment:36'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                  |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------|\n|[778d61e](https://github.com/sagemath/sagetrac-mirror/commit/778d61e70c95f53cfe74d59fca94cbdfab9466a8)|`src/sage/rings{ring.pyx,polynomial/polynomial_ring_constructor.py}: Skip failing TestSuite tests`|",
    "created_at": "2021-05-24T22:37:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630250",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                  |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------|
|[778d61e](https://github.com/sagemath/sagetrac-mirror/commit/778d61e70c95f53cfe74d59fca94cbdfab9466a8)|`src/sage/rings{ring.pyx,polynomial/polynomial_ring_constructor.py}: Skip failing TestSuite tests`|



---

archive/issue_comments_630251.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-05-24T22:38:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630251",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_630252.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,5 +4,7 @@\n \n Many tests are failing; we skip these tests to make this ticket mergeable. In follow-up tickets, these failures should be fixed.\n \n+Related:\n+- https://groups.google.com/g/sage-devel/c/vGzNJKAQWbs/m/nhm1iIPWAwAJ\n+- https://groups.google.com/g/sage-devel/c/xiH9d4oBwaI/m/9Q0U1bUlAwAJ\n \n-\n``````\n",
    "created_at": "2021-05-24T22:39:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630252",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,5 +4,7 @@
 
 Many tests are failing; we skip these tests to make this ticket mergeable. In follow-up tickets, these failures should be fixed.
 
+Related:
+- https://groups.google.com/g/sage-devel/c/vGzNJKAQWbs/m/nhm1iIPWAwAJ
+- https://groups.google.com/g/sage-devel/c/xiH9d4oBwaI/m/9Q0U1bUlAwAJ
 
-
``````




---

archive/issue_comments_630253.json:
```json
{
    "body": "<a id='comment:39'></a>\nReplying to [mkoeppe](#comment%3A23):\n> Replying to [vdelecroix](#comment%3A21):\n> > Why something that specific is needed in `rings/polynomial/polynomial_ring.py`?\n> > \n> > ```\n> > def construction(self):\n> >     ...\n> >     implementation = None\n> >     if 'NTL' in self._implementation_repr:\n> >         implementation = 'NTL'\n> >     ...\n> > ```\n\n> \n> This is obviously not a complete solution. The parents don't keep track in a clean way what the implementation is. I have some other experimental code that tries to decode the element class, but it's all not very satisfying.\n\n\nCould you at least add a `# NOTE:` to this code and possibly add a pointer to the ticket #31852.",
    "created_at": "2021-05-28T07:37:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630253",
    "user": "https://github.com/videlec"
}
```

<a id='comment:39'></a>
Replying to [mkoeppe](#comment%3A23):
> Replying to [vdelecroix](#comment%3A21):
> > Why something that specific is needed in `rings/polynomial/polynomial_ring.py`?
> > 
> > ```
> > def construction(self):
> >     ...
> >     implementation = None
> >     if 'NTL' in self._implementation_repr:
> >         implementation = 'NTL'
> >     ...
> > ```

> 
> This is obviously not a complete solution. The parents don't keep track in a clean way what the implementation is. I have some other experimental code that tries to decode the element class, but it's all not very satisfying.


Could you at least add a `# NOTE:` to this code and possibly add a pointer to the ticket #31852.



---

archive/issue_comments_630254.json:
```json
{
    "body": "<a id='comment:40'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                  |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|\n|[2e6a91b](https://github.com/sagemath/sagetrac-mirror/commit/2e6a91b8576d35589cf22fc3bb7eeac95546918c)|`PolynomialRing_integral_domain.construction: Add doctest and implementation note`|",
    "created_at": "2021-05-29T02:24:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630254",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                  |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|
|[2e6a91b](https://github.com/sagemath/sagetrac-mirror/commit/2e6a91b8576d35589cf22fc3bb7eeac95546918c)|`PolynomialRing_integral_domain.construction: Add doctest and implementation note`|



---

archive/issue_comments_630255.json:
```json
{
    "body": "Changing commit from \"778d61e70c95f53cfe74d59fca94cbdfab9466a8\" to \"2e6a91b8576d35589cf22fc3bb7eeac95546918c\"",
    "created_at": "2021-05-29T02:24:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630255",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "778d61e70c95f53cfe74d59fca94cbdfab9466a8" to "2e6a91b8576d35589cf22fc3bb7eeac95546918c"



---

archive/issue_comments_630256.json:
```json
{
    "body": "<a id='comment:41'></a>\nTiny doctest issue in the tests you introduced\n\n```\nsage -t --long --random-seed=0 src/sage/rings/polynomial/polynomial_ring.py\n**********************************************************************\nFile \"src/sage/rings/polynomial/polynomial_ring.py\", line 1964, in sage.rings.polynomial.polynomial_ring.PolynomialRing_commutative.construction\nFailed example:\n    R = PRing(ZZ, 'x'); R\nExpected nothing\nGot:\n    Univariate Polynomial Ring in x over Integer Ring\n**********************************************************************\nFile \"src/sage/rings/polynomial/polynomial_ring.py\", line 1970, in sage.rings.polynomial.polynomial_ring.PolynomialRing_commutative.construction\nFailed example:\n    R = PRing(ZZ, 'x', implementation='NTL'); R\nExpected nothing\nGot:\n    Univariate Polynomial Ring in x over Integer Ring (using NTL)\n**********************************************************************\n```",
    "created_at": "2021-05-30T08:07:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630256",
    "user": "https://github.com/videlec"
}
```

<a id='comment:41'></a>
Tiny doctest issue in the tests you introduced

```
sage -t --long --random-seed=0 src/sage/rings/polynomial/polynomial_ring.py
**********************************************************************
File "src/sage/rings/polynomial/polynomial_ring.py", line 1964, in sage.rings.polynomial.polynomial_ring.PolynomialRing_commutative.construction
Failed example:
    R = PRing(ZZ, 'x'); R
Expected nothing
Got:
    Univariate Polynomial Ring in x over Integer Ring
**********************************************************************
File "src/sage/rings/polynomial/polynomial_ring.py", line 1970, in sage.rings.polynomial.polynomial_ring.PolynomialRing_commutative.construction
Failed example:
    R = PRing(ZZ, 'x', implementation='NTL'); R
Expected nothing
Got:
    Univariate Polynomial Ring in x over Integer Ring (using NTL)
**********************************************************************
```



---

archive/issue_comments_630257.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-05-30T08:07:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630257",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_630258.json:
```json
{
    "body": "<a id='comment:43'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|\n|[55b2980](https://github.com/sagemath/sagetrac-mirror/commit/55b29808ee9b204ee2e8adf9321e632bd9718d90)|`src/sage/rings/polynomial/polynomial_ring.py: Fix up doctests`|",
    "created_at": "2021-05-30T08:13:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630258",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|
|[55b2980](https://github.com/sagemath/sagetrac-mirror/commit/55b29808ee9b204ee2e8adf9321e632bd9718d90)|`src/sage/rings/polynomial/polynomial_ring.py: Fix up doctests`|



---

archive/issue_comments_630259.json:
```json
{
    "body": "Changing commit from \"2e6a91b8576d35589cf22fc3bb7eeac95546918c\" to \"55b29808ee9b204ee2e8adf9321e632bd9718d90\"",
    "created_at": "2021-05-30T08:13:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630259",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2e6a91b8576d35589cf22fc3bb7eeac95546918c" to "55b29808ee9b204ee2e8adf9321e632bd9718d90"



---

archive/issue_comments_630260.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-05-30T08:13:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630260",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_630261.json:
```json
{
    "body": "<a id='comment:45'></a>\nCan we get this in please? The patchbot failures are unrelated",
    "created_at": "2021-06-06T21:12:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630261",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:45'></a>
Can we get this in please? The patchbot failures are unrelated



---

archive/issue_comments_630262.json:
```json
{
    "body": "<a id='comment:46'></a>\nSure. I did not receive any notification e-mail for your comments 43 and 44 in the ticket.",
    "created_at": "2021-06-06T21:24:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630262",
    "user": "https://github.com/videlec"
}
```

<a id='comment:46'></a>
Sure. I did not receive any notification e-mail for your comments 43 and 44 in the ticket.



---

archive/issue_comments_630263.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-06-06T21:24:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630263",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_630264.json:
```json
{
    "body": "<a id='comment:47'></a>\nThanks!",
    "created_at": "2021-06-06T21:25:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630264",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:47'></a>
Thanks!



---

archive/issue_comments_630265.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-06-06T22:34:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630265",
    "user": "https://github.com/tscrim"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_630266.json:
```json
{
    "body": "<a id='comment:48'></a>\nI don't really like having those `TestSuite` calls in the main part of the documentation for the likely very heavily used and read `PolynomialRing`. It adds a lot of clutter and will be confusing for any non-developer. These should all occur in after the `TESTS:` line, and I feel they are best grouped together so it is easier to tell if we have full coverage rather than spread across the file.",
    "created_at": "2021-06-06T22:34:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630266",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:48'></a>
I don't really like having those `TestSuite` calls in the main part of the documentation for the likely very heavily used and read `PolynomialRing`. It adds a lot of clutter and will be confusing for any non-developer. These should all occur in after the `TESTS:` line, and I feel they are best grouped together so it is easier to tell if we have full coverage rather than spread across the file.



---

archive/issue_comments_630267.json:
```json
{
    "body": "<a id='comment:49'></a>\nSorry, I will not work on changing this",
    "created_at": "2021-06-06T22:41:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31668#issuecomment-630267",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:49'></a>
Sorry, I will not work on changing this



---

archive/issue_events_093973.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T02:58:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31668#event-93973"
}
```



---

archive/issue_events_093974.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31668#event-93974"
}
```



---

archive/issue_events_093975.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31668#event-93975"
}
```



---

archive/issue_events_093976.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31668#event-93976"
}
```



---

archive/issue_events_093977.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31668#event-93977"
}
```



---

archive/issue_events_093978.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31668#event-93978"
}
```



---

archive/issue_events_093979.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31668",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31668#event-93979"
}
```
