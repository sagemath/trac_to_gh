# Issue 31505: Extend system package scripts to handle macports; tox.ini: Add macports environment

archive/issues_031268.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nBased on #30504, which added MacPorts package information, we update the system package scripts to include support for MacPorts.\n\nCurrent Sage builds just fine on a system with MacPorts. \nTo test this, we add `local-macports` environments to `tox.ini`:\n\n```\ntox -e local-macports-minimal\n```\nor\n\n```\ntox -e local-macports-standard             # uses /usr/bin/python3\n```\nor \n\n```\ntox -e local-macports-standard-python3.10  # uses python3.10 from macports\n```\n\nEach of these commands creates an isolated installation of MacPorts in a subdirectory of `.tox` (using https://guide.macports.org/#installing.macports.source.multiple\n); it will not use or modify `/opt/local`.  \n\n(There is also `tox -e local-macports-optlocal-standard`, which uses `sudo` to install things into the default location -- use at your own risk.)\n\nRequested at\n\n- [Ask Sage question 54790: Use OpenSSL from /opt/local/](https://ask.sagemath.org/question/54790)\n- [sage-support, 2020-12](https://groups.google.com/g/sage-support/c/_cfY37nFF84/m/1biGwJetBgAJ)\n- [sage-devel, 2022-04](https://groups.google.com/g/sage-devel/c/qTcF8tlWLcE/m/9QRODrv0CgAJ)\n\nUpstream: **Not yet reported upstream; Will do shortly.**\n\nCC:  @slel @kliem @jhpalmieri @dimpase @seblabbe @vbraun @zlscherr\n\nComponent: **porting**\n\nAuthor: **Matthias Koeppe**\n\nBranch/Commit: **[u/mkoeppe/tox_ini__add_macports_environment](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/tox_ini__add_macports_environment) @ [`476fa33`](https://github.com/sagemath/sagetrac-mirror/commit/476fa33e16780466a04556f1c87532465dbde898)**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31505_\n\n",
    "created_at": "2021-03-17T01:03:08Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20porting",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/needs%20review"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Extend system package scripts to handle macports; tox.ini: Add macports environment",
    "type": "issue",
    "updated_at": "2023-01-07T21:39:40Z",
    "url": "https://github.com/sagemath/sage/issues/31505",
    "user": "https://github.com/mkoeppe"
}
```
<div id="comment:0"></div>

Based on #30504, which added MacPorts package information, we update the system package scripts to include support for MacPorts.

Current Sage builds just fine on a system with MacPorts. 
To test this, we add `local-macports` environments to `tox.ini`:

```
tox -e local-macports-minimal
```
or

```
tox -e local-macports-standard             # uses /usr/bin/python3
```
or 

```
tox -e local-macports-standard-python3.10  # uses python3.10 from macports
```

Each of these commands creates an isolated installation of MacPorts in a subdirectory of `.tox` (using https://guide.macports.org/#installing.macports.source.multiple
); it will not use or modify `/opt/local`.  

(There is also `tox -e local-macports-optlocal-standard`, which uses `sudo` to install things into the default location -- use at your own risk.)

Requested at

- [Ask Sage question 54790: Use OpenSSL from /opt/local/](https://ask.sagemath.org/question/54790)
- [sage-support, 2020-12](https://groups.google.com/g/sage-support/c/_cfY37nFF84/m/1biGwJetBgAJ)
- [sage-devel, 2022-04](https://groups.google.com/g/sage-devel/c/qTcF8tlWLcE/m/9QRODrv0CgAJ)

Upstream: **Not yet reported upstream; Will do shortly.**

CC:  @slel @kliem @jhpalmieri @dimpase @seblabbe @vbraun @zlscherr

Component: **porting**

Author: **Matthias Koeppe**

Branch/Commit: **[u/mkoeppe/tox_ini__add_macports_environment](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/tox_ini__add_macports_environment) @ [`476fa33`](https://github.com/sagemath/sagetrac-mirror/commit/476fa33e16780466a04556f1c87532465dbde898)**

_Issue created by migration from https://trac.sagemath.org/ticket/31505_





---

archive/issue_events_431131.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-17T01:03:08Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431131"
}
```



---

archive/issue_events_431132.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-17T01:03:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20porting",
    "label_color": "0000b0",
    "label_name": "c: porting",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431132"
}
```



---

archive/issue_events_431133.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-17T01:03:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431133"
}
```



---

archive/issue_events_431134.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-17T01:03:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431134"
}
```



---

archive/issue_comments_505735.json:
```json
{
    "body": "Branch: **[u/mkoeppe/tox_ini__add_macports_environment](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/tox_ini__add_macports_environment)**",
    "created_at": "2021-03-17T02:27:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505735",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/tox_ini__add_macports_environment](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/tox_ini__add_macports_environment)**



---

archive/issue_comments_505736.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2021-03-17T02:30:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505736",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_505737.json:
```json
{
    "body": "Commit: **[`72c9241`](https://github.com/sagemath/sagetrac-mirror/commit/72c92412c8bd9fa903c24084ef2a42590eb30ae7)**",
    "created_at": "2021-03-17T02:30:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505737",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`72c9241`](https://github.com/sagemath/sagetrac-mirror/commit/72c92412c8bd9fa903c24084ef2a42590eb30ae7)**



---

archive/issue_comments_505738.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,12 @@\n \n https://guide.macports.org/#installing.macports.source.multiple\n \n+To test:\n+\n+```\n+tox -e local-macports-minimal\n+```\n+(It creates an isolated installation of MacPorts in a subdirectory of `.tox`; it will not use or modify `/opt/local`.)\n+\n+With package lists added in #30504, it will also support `tox -e local-macports-standard`.\n+\n``````\n",
    "created_at": "2021-03-17T02:30:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505738",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,12 @@
 
 https://guide.macports.org/#installing.macports.source.multiple
 
+To test:
+
+```
+tox -e local-macports-minimal
+```
+(It creates an isolated installation of MacPorts in a subdirectory of `.tox`; it will not use or modify `/opt/local`.)
+
+With package lists added in #30504, it will also support `tox -e local-macports-standard`.
+
``````




---

archive/issue_comments_505739.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ab5819bedfb6b6e239c279aff081ad4a46952f23\"><code>ab5819b</code></a></td><td><code>tox.ini: Add local-macports</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/81312710847e5dc581a4d0f53a7977f1a2477217\"><code>8131271</code></a></td><td><code>Add macports.txt</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/45dec6a4084543af8bd87a404bc2460b567f9a00\"><code>45dec6a</code></a></td><td><code>build/pkgs/_prereq/distros: Update file comments</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8e1393c8d28e29dc1ab3abc02f0f06961e9d0280\"><code>8e1393c</code></a></td><td><code>build/bin/sage-print-system-package-command: Handle macports install</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/72c92412c8bd9fa903c24084ef2a42590eb30ae7\"><code>72c9241</code></a></td><td><code>m4/sage_check_osx_supported.m4: Do not exit with error if fink or macports is found</code></td></tr></table>\n",
    "created_at": "2021-03-17T02:30:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505739",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ab5819bedfb6b6e239c279aff081ad4a46952f23"><code>ab5819b</code></a></td><td><code>tox.ini: Add local-macports</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/81312710847e5dc581a4d0f53a7977f1a2477217"><code>8131271</code></a></td><td><code>Add macports.txt</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/45dec6a4084543af8bd87a404bc2460b567f9a00"><code>45dec6a</code></a></td><td><code>build/pkgs/_prereq/distros: Update file comments</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8e1393c8d28e29dc1ab3abc02f0f06961e9d0280"><code>8e1393c</code></a></td><td><code>build/bin/sage-print-system-package-command: Handle macports install</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/72c92412c8bd9fa903c24084ef2a42590eb30ae7"><code>72c9241</code></a></td><td><code>m4/sage_check_osx_supported.m4: Do not exit with error if fink or macports is found</code></td></tr></table>




---

archive/issue_events_431135.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-17T02:30:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431135"
}
```



---

archive/issue_comments_505740.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b6f1596e6e250f2f4a3bf537051154f4fc1933f2\"><code>b6f1596</code></a></td><td><code>tox.ini (local-macports-optlocal): Use sudo</code></td></tr></table>\n",
    "created_at": "2021-03-17T21:16:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505740",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b6f1596e6e250f2f4a3bf537051154f4fc1933f2"><code>b6f1596</code></a></td><td><code>tox.ini (local-macports-optlocal): Use sudo</code></td></tr></table>




---

archive/issue_comments_505741.json:
```json
{
    "body": "Changed commit from **[`72c9241`](https://github.com/sagemath/sagetrac-mirror/commit/72c92412c8bd9fa903c24084ef2a42590eb30ae7)** to **[`b6f1596`](https://github.com/sagemath/sagetrac-mirror/commit/b6f1596e6e250f2f4a3bf537051154f4fc1933f2)**",
    "created_at": "2021-03-17T21:16:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505741",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`72c9241`](https://github.com/sagemath/sagetrac-mirror/commit/72c92412c8bd9fa903c24084ef2a42590eb30ae7)** to **[`b6f1596`](https://github.com/sagemath/sagetrac-mirror/commit/b6f1596e6e250f2f4a3bf537051154f4fc1933f2)**



---

archive/issue_comments_505742.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e9eeb0b471372b871b76a61c1787d8e6d17ebbd9\"><code>e9eeb0b</code></a></td><td><code>build/bin/sage-print-system-package-command (macports): Handle setup-build-env</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/218989037968aa4d94c2b151cb3183bd5840b184\"><code>2189890</code></a></td><td><code>build/bin/sage-guess-package-system: Detect macports</code></td></tr></table>\n",
    "created_at": "2021-03-18T19:05:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505742",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e9eeb0b471372b871b76a61c1787d8e6d17ebbd9"><code>e9eeb0b</code></a></td><td><code>build/bin/sage-print-system-package-command (macports): Handle setup-build-env</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/218989037968aa4d94c2b151cb3183bd5840b184"><code>2189890</code></a></td><td><code>build/bin/sage-guess-package-system: Detect macports</code></td></tr></table>




---

archive/issue_comments_505743.json:
```json
{
    "body": "Changed commit from **[`b6f1596`](https://github.com/sagemath/sagetrac-mirror/commit/b6f1596e6e250f2f4a3bf537051154f4fc1933f2)** to **[`2189890`](https://github.com/sagemath/sagetrac-mirror/commit/218989037968aa4d94c2b151cb3183bd5840b184)**",
    "created_at": "2021-03-18T19:05:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505743",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b6f1596`](https://github.com/sagemath/sagetrac-mirror/commit/b6f1596e6e250f2f4a3bf537051154f4fc1933f2)** to **[`2189890`](https://github.com/sagemath/sagetrac-mirror/commit/218989037968aa4d94c2b151cb3183bd5840b184)**



---

archive/issue_comments_505744.json:
```json
{
    "body": "Dependencies: **#30504**",
    "created_at": "2021-03-18T19:55:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505744",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#30504**



---

archive/issue_comments_505745.json:
```json
{
    "body": "Changed commit from **[`2189890`](https://github.com/sagemath/sagetrac-mirror/commit/218989037968aa4d94c2b151cb3183bd5840b184)** to **[`4acfc5c`](https://github.com/sagemath/sagetrac-mirror/commit/4acfc5c8bed0227762a73ff23204bdce2e88e5cf)**",
    "created_at": "2021-03-18T19:58:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505745",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2189890`](https://github.com/sagemath/sagetrac-mirror/commit/218989037968aa4d94c2b151cb3183bd5840b184)** to **[`4acfc5c`](https://github.com/sagemath/sagetrac-mirror/commit/4acfc5c8bed0227762a73ff23204bdce2e88e5cf)**



---

archive/issue_comments_505746.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4f7398e1556b5c1f337c1f8fa61ce30e79532202\"><code>4f7398e</code></a></td><td><code>Update repology info</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3386749297368a216d60f42e3b3d3de7d45bca38\"><code>3386749</code></a></td><td><code>30504: Rename and remove distros files from #29129 and #30619</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c272ec96ca8a3bea2ff1ac457a210d2d83832a2\"><code>7c272ec</code></a></td><td><code>Add MacPorts package info</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8c9f53cc58830fd476c01fbc015e71c1cb98b001\"><code>8c9f53c</code></a></td><td><code>30504: Add _recommended package info for MacPorts</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bf0a4d2a944e8ba8199bd3200f28dcf70afac9eb\"><code>bf0a4d2</code></a></td><td><code>30504: Use zmq-devel in MacPorts for zeromq</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e4244893ba5f8e421bc5c244992a8e14e258b9e8\"><code>e424489</code></a></td><td><code>30504: Fix gcc gfortran openblas info for MacPorts</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b8b709267c1c582cf9f2b4d276752bbf6ae8df57\"><code>b8b7092</code></a></td><td><code>build/pkgs/{gcc,gfortran}/distros/macports.txt: Fixup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4acfc5c8bed0227762a73ff23204bdce2e88e5cf\"><code>4acfc5c</code></a></td><td><code>Merge #30504</code></td></tr></table>\n",
    "created_at": "2021-03-18T19:58:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505746",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4f7398e1556b5c1f337c1f8fa61ce30e79532202"><code>4f7398e</code></a></td><td><code>Update repology info</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3386749297368a216d60f42e3b3d3de7d45bca38"><code>3386749</code></a></td><td><code>30504: Rename and remove distros files from #29129 and #30619</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c272ec96ca8a3bea2ff1ac457a210d2d83832a2"><code>7c272ec</code></a></td><td><code>Add MacPorts package info</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8c9f53cc58830fd476c01fbc015e71c1cb98b001"><code>8c9f53c</code></a></td><td><code>30504: Add _recommended package info for MacPorts</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bf0a4d2a944e8ba8199bd3200f28dcf70afac9eb"><code>bf0a4d2</code></a></td><td><code>30504: Use zmq-devel in MacPorts for zeromq</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e4244893ba5f8e421bc5c244992a8e14e258b9e8"><code>e424489</code></a></td><td><code>30504: Fix gcc gfortran openblas info for MacPorts</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b8b709267c1c582cf9f2b4d276752bbf6ae8df57"><code>b8b7092</code></a></td><td><code>build/pkgs/{gcc,gfortran}/distros/macports.txt: Fixup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4acfc5c8bed0227762a73ff23204bdce2e88e5cf"><code>4acfc5c</code></a></td><td><code>Merge #30504</code></td></tr></table>




---

archive/issue_comments_505747.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,7 +6,12 @@\n ```\n tox -e local-macports-minimal\n ```\n-(It creates an isolated installation of MacPorts in a subdirectory of `.tox`; it will not use or modify `/opt/local`.)\n+or\n \n-With package lists added in #30504, it will also support `tox -e local-macports-standard`.\n+```\n+tox -e local-macports-standard\n+```\n+It creates an isolated installation of MacPorts in a subdirectory of `.tox`; it will not use or modify `/opt/local`.  \n \n+(There is also `tox -e local-macports-optlocal`, which uses `sudo` to install things into the default location -- use at your own risk.)\n+\n``````\n",
    "created_at": "2021-03-18T20:00:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505747",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,7 +6,12 @@
 ```
 tox -e local-macports-minimal
 ```
-(It creates an isolated installation of MacPorts in a subdirectory of `.tox`; it will not use or modify `/opt/local`.)
+or
 
-With package lists added in #30504, it will also support `tox -e local-macports-standard`.
+```
+tox -e local-macports-standard
+```
+It creates an isolated installation of MacPorts in a subdirectory of `.tox`; it will not use or modify `/opt/local`.  
 
+(There is also `tox -e local-macports-optlocal`, which uses `sudo` to install things into the default location -- use at your own risk.)
+
``````




---

archive/issue_events_431136.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-18T20:02:21Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "title_is": "Extend system package scripts to handle macports; tox.ini: Add macports environment",
    "title_was": "tox.ini: Add macports environment",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431136"
}
```



---

archive/issue_comments_505748.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,9 @@\n+Based on #30504, which added MacPorts package information, we update the system package scripts to include support for MacPorts.\n \n-https://guide.macports.org/#installing.macports.source.multiple\n+We remove the outdated ban of the systems with MacPorts (and also fink) in the configure phase.  This unfair ban has in at least one case outraged a devoted user of that packaging system.\n \n-To test:\n+Current Sage builds just fine on a system with MacPorts. \n+To test this, we add `local-macports` environments to `tox.ini`:\n \n ```\n tox -e local-macports-minimal\n@@ -11,7 +13,8 @@\n ```\n tox -e local-macports-standard\n ```\n-It creates an isolated installation of MacPorts in a subdirectory of `.tox`; it will not use or modify `/opt/local`.  \n+It creates an isolated installation of MacPorts in a subdirectory of `.tox` (using https://guide.macports.org/#installing.macports.source.multiple\n+); it will not use or modify `/opt/local`.  \n \n (There is also `tox -e local-macports-optlocal`, which uses `sudo` to install things into the default location -- use at your own risk.)\n \n``````\n",
    "created_at": "2021-03-18T22:40:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505748",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,9 @@
+Based on #30504, which added MacPorts package information, we update the system package scripts to include support for MacPorts.
 
-https://guide.macports.org/#installing.macports.source.multiple
+We remove the outdated ban of the systems with MacPorts (and also fink) in the configure phase.  This unfair ban has in at least one case outraged a devoted user of that packaging system.
 
-To test:
+Current Sage builds just fine on a system with MacPorts. 
+To test this, we add `local-macports` environments to `tox.ini`:
 
 ```
 tox -e local-macports-minimal
@@ -11,7 +13,8 @@
 ```
 tox -e local-macports-standard
 ```
-It creates an isolated installation of MacPorts in a subdirectory of `.tox`; it will not use or modify `/opt/local`.  
+It creates an isolated installation of MacPorts in a subdirectory of `.tox` (using https://guide.macports.org/#installing.macports.source.multiple
+); it will not use or modify `/opt/local`.  
 
 (There is also `tox -e local-macports-optlocal`, which uses `sudo` to install things into the default location -- use at your own risk.)
 
``````




---

archive/issue_events_431137.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-18T22:40:55Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "title_is": "Remove outdated macports ban; Extend system package scripts to handle macports; tox.ini: Add macports environment",
    "title_was": "Extend system package scripts to handle macports; tox.ini: Add macports environment",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431137"
}
```



---

archive/issue_events_431138.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-18T22:41:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431138"
}
```



---

archive/issue_events_431139.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-18T22:41:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
    "label_color": "ff7700",
    "label_name": "p: critical / 2",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431139"
}
```



---

archive/issue_comments_505749.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nNo need for a `.macports-build-env` file similar to `.homebrew-build-env`?",
    "created_at": "2021-03-21T01:53:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505749",
    "user": "https://github.com/slel"
}
```

<div id="comment:13" align="right">comment:13</div>

No need for a `.macports-build-env` file similar to `.homebrew-build-env`?



---

archive/issue_comments_505750.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -18,3 +18,7 @@\n \n (There is also `tox -e local-macports-optlocal`, which uses `sudo` to install things into the default location -- use at your own risk.)\n \n+Requested at\n+\n+- [Ask Sage question 54790: Use OpenSSL from /opt/local/](https://ask.sagemath.org/question/54790)\n+- [sage-support, 2020-12](https://groups.google.com/g/sage-support/c/_cfY37nFF84/m/1biGwJetBgAJ)\n``````\n",
    "created_at": "2021-03-21T02:01:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505750",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -18,3 +18,7 @@
 
 (There is also `tox -e local-macports-optlocal`, which uses `sudo` to install things into the default location -- use at your own risk.)
 
+Requested at
+
+- [Ask Sage question 54790: Use OpenSSL from /opt/local/](https://ask.sagemath.org/question/54790)
+- [sage-support, 2020-12](https://groups.google.com/g/sage-support/c/_cfY37nFF84/m/1biGwJetBgAJ)
``````




---

archive/issue_comments_505751.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI don't think we need this - only 1 command is needed to prepare the build",
    "created_at": "2021-03-21T04:27:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505751",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">comment:15</div>

I don't think we need this - only 1 command is needed to prepare the build



---

archive/issue_comments_505752.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nThe `tox -e ...` commands run `./bootstrap && ./configure && make` or similar.\n\nCould they run `./bootstrap -q && ./configure -q && make -s V=0` instead?",
    "created_at": "2021-03-21T12:54:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505752",
    "user": "https://github.com/slel"
}
```

<div id="comment:16" align="right">comment:16</div>

The `tox -e ...` commands run `./bootstrap && ./configure && make` or similar.

Could they run `./bootstrap -q && ./configure -q && make -s V=0` instead?



---

archive/issue_comments_505753.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nOh in fact they already do. Sorry for the noise. I'm trying this out and will report.",
    "created_at": "2021-03-21T12:57:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505753",
    "user": "https://github.com/slel"
}
```

<div id="comment:17" align="right">comment:17</div>

Oh in fact they already do. Sorry for the noise. I'm trying this out and will report.



---

archive/issue_comments_505754.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nYes, `make` runs with `V=0`, but for the others I really want to see the output.",
    "created_at": "2021-03-21T16:24:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505754",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:18" align="right">comment:18</div>

Yes, `make` runs with `V=0`, but for the others I really want to see the output.



---

archive/issue_comments_505755.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nFor more quiet, you can use `tox -p auto -e local-macports-standard -- config.status` (logs will appear in `.tox/local-macports-standard/log`",
    "created_at": "2021-03-21T16:33:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505755",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:19" align="right">comment:19</div>

For more quiet, you can use `tox -p auto -e local-macports-standard -- config.status` (logs will appear in `.tox/local-macports-standard/log`



---

archive/issue_comments_505756.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nIn a fresh clone, I ran:\n\n```\n$ git trac checkout 31505\n$ git trac fetch 31496 && git merge FETCH_HEAD -m \"Merge 31496\"\n$ git trac fetch 31335 && git merge FETCH_HEAD -m \"Merge 31335\"\n$ git trac fetch 31474 && git merge FETCH_HEAD -m \"Merge 31474\"\n```\nand then got this for `local-macports-minimal`\n(I'm a bit surprised it succeeds so fast):\n\n```\n$ tox -p auto -e local-macports-minimal -- config.status\n\u2714 OK local-macports-minimal in 32 minutes, 29.252 seconds\n_________________________ summary _________________________\n  local-macports-minimal: commands succeeded\n  congratulations :)\n```\nAs for `local-macports-standard`, it is taking a lot longer.\nI'll report when it's done.",
    "created_at": "2021-03-22T10:32:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505756",
    "user": "https://github.com/slel"
}
```

<div id="comment:20" align="right">comment:20</div>

In a fresh clone, I ran:

```
$ git trac checkout 31505
$ git trac fetch 31496 && git merge FETCH_HEAD -m "Merge 31496"
$ git trac fetch 31335 && git merge FETCH_HEAD -m "Merge 31335"
$ git trac fetch 31474 && git merge FETCH_HEAD -m "Merge 31474"
```
and then got this for `local-macports-minimal`
(I'm a bit surprised it succeeds so fast):

```
$ tox -p auto -e local-macports-minimal -- config.status
✔ OK local-macports-minimal in 32 minutes, 29.252 seconds
_________________________ summary _________________________
  local-macports-minimal: commands succeeded
  congratulations :)
```
As for `local-macports-standard`, it is taking a lot longer.
I'll report when it's done.



---

archive/issue_comments_505757.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nLet's get this into 9.3 please",
    "created_at": "2021-03-24T01:29:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505757",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:22" align="right">comment:22</div>

Let's get this into 9.3 please



---

archive/issue_comments_505758.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nI tried `tox -e local-macports-standard` on OS X Big Sur, and it seems to have gotten stuck installing `sagelib`. I can't find the `logs/pkgs` directory, but `sagelib` is not listed in `.tox/local-macports-standard/local/var/lib/sage/installed`: the most recently modified file there is for `networkx`. There is also no appropriate directory in `local/lib/python3.8/site-packages/`. It looks like it's been stuck for hours now. (I'm not sure why it decided to use the Xcode Python 3.8 vs. the MacPorts Python 3.9, by the way.)",
    "created_at": "2021-03-26T16:19:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505758",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:24" align="right">comment:24</div>

I tried `tox -e local-macports-standard` on OS X Big Sur, and it seems to have gotten stuck installing `sagelib`. I can't find the `logs/pkgs` directory, but `sagelib` is not listed in `.tox/local-macports-standard/local/var/lib/sage/installed`: the most recently modified file there is for `networkx`. There is also no appropriate directory in `local/lib/python3.8/site-packages/`. It looks like it's been stuck for hours now. (I'm not sure why it decided to use the Xcode Python 3.8 vs. the MacPorts Python 3.9, by the way.)



---

archive/issue_comments_505759.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nOh, the package log files are in their usual place. Here is the sagelib log file (after I hit ctrl-C to end the process).",
    "created_at": "2021-03-26T18:25:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505759",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:26" align="right">comment:26</div>

Oh, the package log files are in their usual place. Here is the sagelib log file (after I hit ctrl-C to end the process).



---

archive/issue_comments_505760.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nAttachment: **[sagelib-9.3.beta9.log](https://github.com/sagemath/sage/files/ticket31505/sagelib-9.3.beta9.log)**\n\nReplying to [@jhpalmieri](#comment%3A24):\n> (I'm not sure why it decided to use the Xcode Python 3.8 vs. the MacPorts Python 3.9, by the way.)\n\nMacPorts does not install a `python3` executable, only versioned executables `python3.8`, `python3.9`. \n\nUnclear why it gets stuck in the build -- look like yet another library threads vs. python multiprocessing problem, like the ones that we chased in the parallel docbuild ticket not so long ago.\nDoes it go away if you repeat the build (it will not start from scratch)",
    "created_at": "2021-03-26T18:59:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505760",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:27" align="right">comment:27</div>

Attachment: **[sagelib-9.3.beta9.log](https://github.com/sagemath/sage/files/ticket31505/sagelib-9.3.beta9.log)**

Replying to [@jhpalmieri](#comment%3A24):
> (I'm not sure why it decided to use the Xcode Python 3.8 vs. the MacPorts Python 3.9, by the way.)

MacPorts does not install a `python3` executable, only versioned executables `python3.8`, `python3.9`. 

Unclear why it gets stuck in the build -- look like yet another library threads vs. python multiprocessing problem, like the ones that we chased in the parallel docbuild ticket not so long ago.
Does it go away if you repeat the build (it will not start from scratch)



---

archive/issue_comments_505761.json:
```json
{
    "body": "Changed commit from **[`4acfc5c`](https://github.com/sagemath/sagetrac-mirror/commit/4acfc5c8bed0227762a73ff23204bdce2e88e5cf)** to **[`f68ed3c`](https://github.com/sagemath/sagetrac-mirror/commit/f68ed3c5bb9ce276af78de075bab7c15abe4899f)**",
    "created_at": "2021-03-26T19:05:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505761",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4acfc5c`](https://github.com/sagemath/sagetrac-mirror/commit/4acfc5c8bed0227762a73ff23204bdce2e88e5cf)** to **[`f68ed3c`](https://github.com/sagemath/sagetrac-mirror/commit/f68ed3c5bb9ce276af78de075bab7c15abe4899f)**



---

archive/issue_comments_505762.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><code>[f68ed3c](https://github.com/sagemath/sagetrac-mirror/commit/f68ed3c5bb9ce276af78de075bab7c15abe4899f)</code></td><td><code>`tox.ini: Add configuration factors macports-python{3.8,3.9`}</code></td></tr></table>\n",
    "created_at": "2021-03-26T19:05:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505762",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><code>[f68ed3c](https://github.com/sagemath/sagetrac-mirror/commit/f68ed3c5bb9ce276af78de075bab7c15abe4899f)</code></td><td><code>`tox.ini: Add configuration factors macports-python{3.8,3.9`}</code></td></tr></table>




---

archive/issue_comments_505763.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nNow you can do `tox -e local-macports-standard-python3.9`",
    "created_at": "2021-03-26T19:05:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505763",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:29" align="right">comment:29</div>

Now you can do `tox -e local-macports-standard-python3.9`



---

archive/issue_comments_505764.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,12 +11,23 @@\n or\n \n ```\n-tox -e local-macports-standard\n+tox -e local-macports-standard             # uses /usr/bin/python unless configured otherwise\n ```\n-It creates an isolated installation of MacPorts in a subdirectory of `.tox` (using https://guide.macports.org/#installing.macports.source.multiple\n+or \n+\n+```\n+tox -e local-macports-standard-python3.8   # uses python3.8 from macports\n+```\n+or \n+\n+```\n+tox -e local-macports-standard-python3.9   # uses python3.9 from macports\n+```\n+\n+Each of these commands creates an isolated installation of MacPorts in a subdirectory of `.tox` (using https://guide.macports.org/#installing.macports.source.multiple\n ); it will not use or modify `/opt/local`.  \n \n-(There is also `tox -e local-macports-optlocal`, which uses `sudo` to install things into the default location -- use at your own risk.)\n+(There is also `tox -e local-macports-optlocal-standard`, which uses `sudo` to install things into the default location -- use at your own risk.)\n \n Requested at\n \n``````\n",
    "created_at": "2021-03-26T19:13:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505764",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,12 +11,23 @@
 or
 
 ```
-tox -e local-macports-standard
+tox -e local-macports-standard             # uses /usr/bin/python unless configured otherwise
 ```
-It creates an isolated installation of MacPorts in a subdirectory of `.tox` (using https://guide.macports.org/#installing.macports.source.multiple
+or 
+
+```
+tox -e local-macports-standard-python3.8   # uses python3.8 from macports
+```
+or 
+
+```
+tox -e local-macports-standard-python3.9   # uses python3.9 from macports
+```
+
+Each of these commands creates an isolated installation of MacPorts in a subdirectory of `.tox` (using https://guide.macports.org/#installing.macports.source.multiple
 ); it will not use or modify `/opt/local`.  
 
-(There is also `tox -e local-macports-optlocal`, which uses `sudo` to install things into the default location -- use at your own risk.)
+(There is also `tox -e local-macports-optlocal-standard`, which uses `sudo` to install things into the default location -- use at your own risk.)
 
 Requested at
 
``````




---

archive/issue_comments_505765.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\n`tox -e local-macports-standard-python3.9` doesn't work for me: it ends with\n\n```\nError building Sage.\n\nThe following package(s) may have failed to build (not necessarily\nduring this run of 'make all-build'):\n\n* package:         gmpy2-2.1.0b5\n  last build time: Mar 26 18:32\n  log file:        /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/logs/pkgs/gmpy2-2.1.0b5.log\n  build directory: /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/.tox/local-macports-standard-python3.9/local/var/tmp/sage/build/gmpy2-2.1.0b5\n\n* package:         rpy2-3.3.6\n  last build time: Mar 26 18:40\n  log file:        /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/logs/pkgs/rpy2-3.3.6.log\n  build directory: /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/.tox/local-macports-standard-python3.9/local/var/tmp/sage/build/rpy2-3.3.6\n\n* package:         cysignals-1.10.2\n  last build time: Mar 26 18:42\n  log file:        /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/logs/pkgs/cysignals-1.10.2.log\n  build directory: /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/.tox/local-macports-standard-python3.9/local/var/tmp/sage/build/cysignals-1.10.2\n\n* package:         pynac-0.7.27.p1\n  last build time: Mar 26 18:43\n  log file:        /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/logs/pkgs/pynac-0.7.27.p1.log\n  build directory: /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/.tox/local-macports-standard-python3.9/local/var/tmp/sage/build/pynac-0.7.27.p1\n\n* package:         cvxopt-1.2.5\n  last build time: Mar 26 18:44\n  log file:        /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/logs/pkgs/cvxopt-1.2.5.log\n  build directory: /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/.tox/local-macports-standard-python3.9/local/var/tmp/sage/build/cvxopt-1.2.5\n\nIt is safe to delete any log files and build directories, but they\ncontain information that is helpful for debugging build problems.\nWARNING: If you now run 'make' again, the build directory of the\nsame version of the package will, by default, be deleted. Set the\nenvironment variable SAGE_KEEP_BUILT_SPKGS=yes to prevent this.\n\nmake[1]: *** [all-build] Error 1\nmake: *** [build] Error 2\n```\nrpy2:\n\n```\nclang: error: unsupported option '-fopenmp'\n```\ngmpy2:\n\n```\nIn file included from src/gmpy2.c:461:\n./src/gmpy2.h:81:12: fatal error: 'gmp.h' file not found\n```\ncysignals:\n\n```\nld: illegal thread local variable reference to regular symbol _PARI_SIGINT_block for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nerror: command '/usr/bin/gcc' failed with exit code 1\nBuilding wheel for cysignals (setup.py): finished with status 'error'\n```\netc.",
    "created_at": "2021-03-27T02:20:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505765",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:31" align="right">comment:31</div>

`tox -e local-macports-standard-python3.9` doesn't work for me: it ends with

```
Error building Sage.

The following package(s) may have failed to build (not necessarily
during this run of 'make all-build'):

* package:         gmpy2-2.1.0b5
  last build time: Mar 26 18:32
  log file:        /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/logs/pkgs/gmpy2-2.1.0b5.log
  build directory: /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/.tox/local-macports-standard-python3.9/local/var/tmp/sage/build/gmpy2-2.1.0b5

* package:         rpy2-3.3.6
  last build time: Mar 26 18:40
  log file:        /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/logs/pkgs/rpy2-3.3.6.log
  build directory: /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/.tox/local-macports-standard-python3.9/local/var/tmp/sage/build/rpy2-3.3.6

* package:         cysignals-1.10.2
  last build time: Mar 26 18:42
  log file:        /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/logs/pkgs/cysignals-1.10.2.log
  build directory: /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/.tox/local-macports-standard-python3.9/local/var/tmp/sage/build/cysignals-1.10.2

* package:         pynac-0.7.27.p1
  last build time: Mar 26 18:43
  log file:        /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/logs/pkgs/pynac-0.7.27.p1.log
  build directory: /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/.tox/local-macports-standard-python3.9/local/var/tmp/sage/build/pynac-0.7.27.p1

* package:         cvxopt-1.2.5
  last build time: Mar 26 18:44
  log file:        /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/logs/pkgs/cvxopt-1.2.5.log
  build directory: /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/.tox/local-macports-standard-python3.9/local/var/tmp/sage/build/cvxopt-1.2.5

It is safe to delete any log files and build directories, but they
contain information that is helpful for debugging build problems.
WARNING: If you now run 'make' again, the build directory of the
same version of the package will, by default, be deleted. Set the
environment variable SAGE_KEEP_BUILT_SPKGS=yes to prevent this.

make[1]: *** [all-build] Error 1
make: *** [build] Error 2
```
rpy2:

```
clang: error: unsupported option '-fopenmp'
```
gmpy2:

```
In file included from src/gmpy2.c:461:
./src/gmpy2.h:81:12: fatal error: 'gmp.h' file not found
```
cysignals:

```
ld: illegal thread local variable reference to regular symbol _PARI_SIGINT_block for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
error: command '/usr/bin/gcc' failed with exit code 1
Building wheel for cysignals (setup.py): finished with status 'error'
```
etc.



---

archive/issue_comments_505766.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nThanks for testing! Is this on a system that also has homebrew in `/usr/local`?",
    "created_at": "2021-03-27T02:25:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505766",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:32" align="right">comment:32</div>

Thanks for testing! Is this on a system that also has homebrew in `/usr/local`?



---

archive/issue_comments_505767.json:
```json
{
    "body": "Changed commit from **[`f68ed3c`](https://github.com/sagemath/sagetrac-mirror/commit/f68ed3c5bb9ce276af78de075bab7c15abe4899f)** to **[`c6534e9`](https://github.com/sagemath/sagetrac-mirror/commit/c6534e9fd80565e35398df4f84ce6005e8897f9b)**",
    "created_at": "2021-03-27T02:29:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505767",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f68ed3c`](https://github.com/sagemath/sagetrac-mirror/commit/f68ed3c5bb9ce276af78de075bab7c15abe4899f)** to **[`c6534e9`](https://github.com/sagemath/sagetrac-mirror/commit/c6534e9fd80565e35398df4f84ce6005e8897f9b)**



---

archive/issue_comments_505768.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6534e9fd80565e35398df4f84ce6005e8897f9b\"><code>c6534e9</code></a></td><td><code>Merge tag '9.3.rc0' into t/31505/tox_ini__add_macports_environment</code></td></tr></table>\n",
    "created_at": "2021-03-27T02:29:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505768",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6534e9fd80565e35398df4f84ce6005e8897f9b"><code>c6534e9</code></a></td><td><code>Merge tag '9.3.rc0' into t/31505/tox_ini__add_macports_environment</code></td></tr></table>




---

archive/issue_comments_505769.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nFor making sure that no homebrew stuff from `/usr/local` leaks in, I have some work in #31552, #31562, #31567",
    "created_at": "2021-03-27T02:42:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505769",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:34" align="right">comment:34</div>

For making sure that no homebrew stuff from `/usr/local` leaks in, I have some work in #31552, #31562, #31567



---

archive/issue_comments_505770.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nYes, it has homebrew in `/usr/local`.",
    "created_at": "2021-03-27T02:53:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505770",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:35" align="right">comment:35</div>

Yes, it has homebrew in `/usr/local`.



---

archive/issue_comments_505771.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nCould you post config.log please?",
    "created_at": "2021-03-27T02:57:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505771",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:36" align="right">comment:36</div>

Could you post config.log please?



---

archive/issue_comments_505772.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nHere's config.log from `.tox/local-macports-standard/log`.",
    "created_at": "2021-03-27T03:09:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505772",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:37" align="right">comment:37</div>

Here's config.log from `.tox/local-macports-standard/log`.



---

archive/issue_comments_505773.json:
```json
{
    "body": "Attachment: **[config.log](https://github.com/sagemath/sage/files/ticket31505/config.log)**",
    "created_at": "2021-03-27T03:09:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505773",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[config.log](https://github.com/sagemath/sage/files/ticket31505/config.log)**



---

archive/issue_comments_505774.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nconfig.log has a lot of `/usr/local` - for gmp, ntl, boost.",
    "created_at": "2021-03-27T15:53:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505774",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:38" align="right">comment:38</div>

config.log has a lot of `/usr/local` - for gmp, ntl, boost.



---

archive/issue_comments_505775.json:
```json
{
    "body": "Changed dependencies from **#30504** to **#31567**",
    "created_at": "2021-03-28T01:59:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505775",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#30504** to **#31567**



---

archive/issue_comments_505776.json:
```json
{
    "body": "Changed commit from **[`c6534e9`](https://github.com/sagemath/sagetrac-mirror/commit/c6534e9fd80565e35398df4f84ce6005e8897f9b)** to **[`336a493`](https://github.com/sagemath/sagetrac-mirror/commit/336a49381df30edc01e32516e2f62e9e88c689ee)**",
    "created_at": "2021-03-28T02:07:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505776",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c6534e9`](https://github.com/sagemath/sagetrac-mirror/commit/c6534e9fd80565e35398df4f84ce6005e8897f9b)** to **[`336a493`](https://github.com/sagemath/sagetrac-mirror/commit/336a49381df30edc01e32516e2f62e9e88c689ee)**



---

archive/issue_comments_505777.json:
```json
{
    "body": "<div id=\"comment:40\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/440392440805bbdf01d42e3d5f487d61231aaabf\"><code>4403924</code></a></td><td><code>src/sage/interfaces/r.py: Mark all tests # optional - rpy2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/405ebb976c6c8ccffd5b5350f1c7ec660301d797\"><code>405ebb9</code></a></td><td><code>More # optional - rpy2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b7c157665b738e2f54a6bf217c0114c4180f7df9\"><code>b7c1576</code></a></td><td><code>Merge tag '9.3.beta8' into t/31409/cygwin_standard__r_build_fails_____downgrade_r__rpy2_to_optional</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce3b35fea3326528936af448d006119e6405626f\"><code>ce3b35f</code></a></td><td><code>More # optional - r</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/49c10c18991eed62d800f2fccc422a1a9e7555ce\"><code>49c10c1</code></a></td><td><code>Revert \"build/pkgs/{r,rpy2}: Downgrade to optional\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a67300bd66731b67fac776cfde1d8e0157392ef5\"><code>a67300b</code></a></td><td><code>Merge #30383</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f0a5fb5adafd3d4c82c9d736dc95f49c67e15c39\"><code>f0a5fb5</code></a></td><td><code>configure.ac: Add option --disable-r</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f04c13484c85c5d07e76cc9f306e70553fc74c6c\"><code>f04c134</code></a></td><td><code>Merge branch 't/30383/new_package_type__optional_enabled_by_default' into t/31409/cygwin_standard__r_build_fails_____downgrade_r__rpy2_to_optional</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7966b662147c5f58807e0f9492b35c95e9322b36\"><code>7966b66</code></a></td><td><code>Merge #31409</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/336a49381df30edc01e32516e2f62e9e88c689ee\"><code>336a493</code></a></td><td><code>Merge branch 't/31567/tox_ini__add_local_macos_nohomebrew_environments' into t/31505/tox_ini__add_macports_environment</code></td></tr></table>\n",
    "created_at": "2021-03-28T02:07:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505777",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:40"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/440392440805bbdf01d42e3d5f487d61231aaabf"><code>4403924</code></a></td><td><code>src/sage/interfaces/r.py: Mark all tests # optional - rpy2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/405ebb976c6c8ccffd5b5350f1c7ec660301d797"><code>405ebb9</code></a></td><td><code>More # optional - rpy2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b7c157665b738e2f54a6bf217c0114c4180f7df9"><code>b7c1576</code></a></td><td><code>Merge tag '9.3.beta8' into t/31409/cygwin_standard__r_build_fails_____downgrade_r__rpy2_to_optional</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce3b35fea3326528936af448d006119e6405626f"><code>ce3b35f</code></a></td><td><code>More # optional - r</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/49c10c18991eed62d800f2fccc422a1a9e7555ce"><code>49c10c1</code></a></td><td><code>Revert "build/pkgs/{r,rpy2}: Downgrade to optional"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a67300bd66731b67fac776cfde1d8e0157392ef5"><code>a67300b</code></a></td><td><code>Merge #30383</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f0a5fb5adafd3d4c82c9d736dc95f49c67e15c39"><code>f0a5fb5</code></a></td><td><code>configure.ac: Add option --disable-r</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f04c13484c85c5d07e76cc9f306e70553fc74c6c"><code>f04c134</code></a></td><td><code>Merge branch 't/30383/new_package_type__optional_enabled_by_default' into t/31409/cygwin_standard__r_build_fails_____downgrade_r__rpy2_to_optional</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7966b662147c5f58807e0f9492b35c95e9322b36"><code>7966b66</code></a></td><td><code>Merge #31409</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/336a49381df30edc01e32516e2f62e9e88c689ee"><code>336a493</code></a></td><td><code>Merge branch 't/31567/tox_ini__add_local_macos_nohomebrew_environments' into t/31505/tox_ini__add_macports_environment</code></td></tr></table>




---

archive/issue_comments_505778.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nI tried with the new branch and I'm still not succeeding. More problematically, and this has been true throughout, the process never ends \u2014\u00a0when it hits a problem, it just hangs and I have to hit ctrl-C to stop it.",
    "created_at": "2021-03-28T05:17:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505778",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:41" align="right">comment:41</div>

I tried with the new branch and I'm still not succeeding. More problematically, and this has been true throughout, the process never ends — when it hits a problem, it just hangs and I have to hit ctrl-C to stop it.



---

archive/issue_comments_505779.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nReplying to [@jhpalmieri](#comment%3A41):\n> More problematically, and this has been true throughout, the process never ends \u2014\u00a0when it hits a problem, it just hangs and I have to hit ctrl-C to stop it.\n\nCould this just be the behavior of `make -k`?  I use this throughout in runs via tox.",
    "created_at": "2021-03-28T06:49:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505779",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:42" align="right">comment:42</div>

Replying to [@jhpalmieri](#comment%3A41):
> More problematically, and this has been true throughout, the process never ends — when it hits a problem, it just hangs and I have to hit ctrl-C to stop it.

Could this just be the behavior of `make -k`?  I use this throughout in runs via tox.



---

archive/issue_comments_505780.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nReplying to [@mkoeppe](#comment%3A42):\n> Could this just be the behavior of `make -k`?  I use this throughout in runs via tox.\n\nI've opened #31574 to stop imposing this as a default",
    "created_at": "2021-03-28T16:48:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505780",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:43" align="right">comment:43</div>

Replying to [@mkoeppe](#comment%3A42):
> Could this just be the behavior of `make -k`?  I use this throughout in runs via tox.

I've opened #31574 to stop imposing this as a default



---

archive/issue_comments_505781.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nI don't know. For example, when there is an error building sagelib, that particular process never ends: there is no conclusion in the sagelib log file until I halt it, and then it ends with `KeyboardInterrupt`. Is that a symptom of using `make -k`? I've used `make -k` before when building Sage and it has always stopped when it was supposed to.",
    "created_at": "2021-03-28T17:32:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505781",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:44" align="right">comment:44</div>

I don't know. For example, when there is an error building sagelib, that particular process never ends: there is no conclusion in the sagelib log file until I halt it, and then it ends with `KeyboardInterrupt`. Is that a symptom of using `make -k`? I've used `make -k` before when building Sage and it has always stopped when it was supposed to.



---

archive/issue_comments_505782.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nThat sounds more like another instance of the multiprocessing bugs that we encountered recently in the docbuild, just this time affecting the parallel build of extension modules...",
    "created_at": "2021-03-28T17:55:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505782",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:45" align="right">comment:45</div>

That sounds more like another instance of the multiprocessing bugs that we encountered recently in the docbuild, just this time affecting the parallel build of extension modules...



---

archive/issue_comments_505783.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nProbably better to first try out #31567",
    "created_at": "2021-03-29T03:56:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505783",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:46" align="right">comment:46</div>

Probably better to first try out #31567



---

archive/issue_comments_505784.json:
```json
{
    "body": "Changed commit from **[`336a493`](https://github.com/sagemath/sagetrac-mirror/commit/336a49381df30edc01e32516e2f62e9e88c689ee)** to **[`cf91f97`](https://github.com/sagemath/sagetrac-mirror/commit/cf91f972e1d34ea30d725b217fe71adae324fe8d)**",
    "created_at": "2021-03-31T03:57:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505784",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`336a493`](https://github.com/sagemath/sagetrac-mirror/commit/336a49381df30edc01e32516e2f62e9e88c689ee)** to **[`cf91f97`](https://github.com/sagemath/sagetrac-mirror/commit/cf91f972e1d34ea30d725b217fe71adae324fe8d)**



---

archive/issue_comments_505785.json:
```json
{
    "body": "<div id=\"comment:47\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b5edde2e54cc58bd151880293e6454c3f92150fe\"><code>b5edde2</code></a></td><td><code>tox.ini (macos-nohomebrew): Fix typo in PILLOW_...</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dffcdbc75e46d08bcb1fd2ac9a5677a7a7312e2f\"><code>dffcdbc</code></a></td><td><code>tox.ini (macos-nohomebrew): Fix up pillow build by setting ZLIB_ROOT</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3779a2525d5bbf0987a1d4ad0e42b73fb5769bc0\"><code>3779a25</code></a></td><td><code>tox.ini (macos-nohomebrew): Disable more libraries to remove dependencies on homebrew</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7ff26dfad2f33fe2d020580a01db20efea20716f\"><code>7ff26df</code></a></td><td><code>git grep -l SAGE_SUITESPARSE | xargs sed -i .bak s/SAGE_SUITESPARSE_LOCALINSTALL/SAGE_SUITESPARSE_PREFIX/g</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/52537d120927ed57ce9659683fed15c405b1d1c7\"><code>52537d1</code></a></td><td><code>build/pkgs/cvxopt/spkg-install.in: Actually use the value of SAGE_SUITESPARSE_PREFIX</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ed1a089963e3215ddfe1216ad01237396364519b\"><code>ed1a089</code></a></td><td><code>Merge #31584</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cf91f972e1d34ea30d725b217fe71adae324fe8d\"><code>cf91f97</code></a></td><td><code>Merge #31567</code></td></tr></table>\n",
    "created_at": "2021-03-31T03:57:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505785",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:47"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b5edde2e54cc58bd151880293e6454c3f92150fe"><code>b5edde2</code></a></td><td><code>tox.ini (macos-nohomebrew): Fix typo in PILLOW_...</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dffcdbc75e46d08bcb1fd2ac9a5677a7a7312e2f"><code>dffcdbc</code></a></td><td><code>tox.ini (macos-nohomebrew): Fix up pillow build by setting ZLIB_ROOT</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3779a2525d5bbf0987a1d4ad0e42b73fb5769bc0"><code>3779a25</code></a></td><td><code>tox.ini (macos-nohomebrew): Disable more libraries to remove dependencies on homebrew</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7ff26dfad2f33fe2d020580a01db20efea20716f"><code>7ff26df</code></a></td><td><code>git grep -l SAGE_SUITESPARSE | xargs sed -i .bak s/SAGE_SUITESPARSE_LOCALINSTALL/SAGE_SUITESPARSE_PREFIX/g</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/52537d120927ed57ce9659683fed15c405b1d1c7"><code>52537d1</code></a></td><td><code>build/pkgs/cvxopt/spkg-install.in: Actually use the value of SAGE_SUITESPARSE_PREFIX</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ed1a089963e3215ddfe1216ad01237396364519b"><code>ed1a089</code></a></td><td><code>Merge #31584</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cf91f972e1d34ea30d725b217fe71adae324fe8d"><code>cf91f97</code></a></td><td><code>Merge #31567</code></td></tr></table>




---

archive/issue_comments_505786.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nIt seems that the macports builds don't exclude homebrew by default, so I had to use `tox -e macos-nohomebrew-local-macports-minimal` \u2014\u00a0I hope I got that right. I don't see many traces of `/usr/local` in the log files, but `openblas` failed to build, ending with\n\n```\nperl ./gensymbol osx x86_64 _ 1 0  0 0 0 0 \"\" \"\" 1 0 1 1 1 1 > osx.def\ngfortran-mp-10 -O2 -m128bit-long-double -Wall -frecursive -fno-optimize-sibling-calls -m64 -fPIC -msse3 -mssse3 -L/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc1/.tox/macos-nohomebrew-local-macports-minimal/local/lib -Wl,-rpath,/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc1/.tox/macos-nohomebrew-local-macports-minimal/local/lib  -all_load -headerpad_max_install_names -install_name \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc1/.tox/macos-nohomebrew-local-macports-minimal/local/var/tmp/sage/build/openblas-0.3.13/src/exports/../libopenblas.0.dylib\" -dynamiclib -o ../libopenblas_atomp-r0.3.13.dylib ../libopenblas_atomp-r0.3.13.a -Wl,-exported_symbols_list,osx.def  \n/bin/sh: gfortran-mp-10: command not found\n```\nI'll attach the log file.",
    "created_at": "2021-04-01T23:54:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505786",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:48" align="right">comment:48</div>

It seems that the macports builds don't exclude homebrew by default, so I had to use `tox -e macos-nohomebrew-local-macports-minimal` — I hope I got that right. I don't see many traces of `/usr/local` in the log files, but `openblas` failed to build, ending with

```
perl ./gensymbol osx x86_64 _ 1 0  0 0 0 0 "" "" 1 0 1 1 1 1 > osx.def
gfortran-mp-10 -O2 -m128bit-long-double -Wall -frecursive -fno-optimize-sibling-calls -m64 -fPIC -msse3 -mssse3 -L/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc1/.tox/macos-nohomebrew-local-macports-minimal/local/lib -Wl,-rpath,/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc1/.tox/macos-nohomebrew-local-macports-minimal/local/lib  -all_load -headerpad_max_install_names -install_name "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc1/.tox/macos-nohomebrew-local-macports-minimal/local/var/tmp/sage/build/openblas-0.3.13/src/exports/../libopenblas.0.dylib" -dynamiclib -o ../libopenblas_atomp-r0.3.13.dylib ../libopenblas_atomp-r0.3.13.a -Wl,-exported_symbols_list,osx.def  
/bin/sh: gfortran-mp-10: command not found
```
I'll attach the log file.



---

archive/issue_comments_505787.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nAttachment: **[openblas-0.3.13.log](https://github.com/sagemath/sage/files/ticket31505/openblas-0.3.13.log)**\n\nconfig.log too please",
    "created_at": "2021-04-01T23:56:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505787",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:49" align="right">comment:49</div>

Attachment: **[openblas-0.3.13.log](https://github.com/sagemath/sage/files/ticket31505/openblas-0.3.13.log)**

config.log too please



---

archive/issue_comments_505788.json:
```json
{
    "body": "Attachment: **[config.2.log](https://github.com/sagemath/sage/files/ticket31505/config.2.log)**\n\nfor nohomebrew macports-minimal",
    "created_at": "2021-04-02T00:07:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505788",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[config.2.log](https://github.com/sagemath/sage/files/ticket31505/config.2.log)**

for nohomebrew macports-minimal



---

archive/issue_comments_505789.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nI don't know if there are any helpful files in `.../local/var/tmp/build/sage/openblas/src`, but I can provide those, too.",
    "created_at": "2021-04-02T00:08:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505789",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:50" align="right">comment:50</div>

I don't know if there are any helpful files in `.../local/var/tmp/build/sage/openblas/src`, but I can provide those, too.



---

archive/issue_comments_505790.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nNo, I won't need those. I found the problem already",
    "created_at": "2021-04-02T00:35:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505790",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:51" align="right">comment:51</div>

No, I won't need those. I found the problem already



---

archive/issue_comments_505791.json:
```json
{
    "body": "<div id=\"comment:52\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3287a01cd2913e60e165a28fd3d8360c5b5a2aa8\"><code>3287a01</code></a></td><td><code>build/bin/sage-print-system-package-command (macports): Recommend FC as configure arg, not environment variable</code></td></tr><tr><td><code>[da6f752](https://github.com/sagemath/sagetrac-mirror/commit/da6f752e0e38fd1a72617f728193a628a8d4ffdd)</code></td><td><code>`tox.ini (macports): Pass FC as configure argument; add variants macports-gcc_{spkg,9,10,11`}</code></td></tr></table>\n",
    "created_at": "2021-04-02T01:56:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505791",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:52"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3287a01cd2913e60e165a28fd3d8360c5b5a2aa8"><code>3287a01</code></a></td><td><code>build/bin/sage-print-system-package-command (macports): Recommend FC as configure arg, not environment variable</code></td></tr><tr><td><code>[da6f752](https://github.com/sagemath/sagetrac-mirror/commit/da6f752e0e38fd1a72617f728193a628a8d4ffdd)</code></td><td><code>`tox.ini (macports): Pass FC as configure argument; add variants macports-gcc_{spkg,9,10,11`}</code></td></tr></table>




---

archive/issue_comments_505792.json:
```json
{
    "body": "Changed commit from **[`cf91f97`](https://github.com/sagemath/sagetrac-mirror/commit/cf91f972e1d34ea30d725b217fe71adae324fe8d)** to **[`da6f752`](https://github.com/sagemath/sagetrac-mirror/commit/da6f752e0e38fd1a72617f728193a628a8d4ffdd)**",
    "created_at": "2021-04-02T01:56:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505792",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`cf91f97`](https://github.com/sagemath/sagetrac-mirror/commit/cf91f972e1d34ea30d725b217fe71adae324fe8d)** to **[`da6f752`](https://github.com/sagemath/sagetrac-mirror/commit/da6f752e0e38fd1a72617f728193a628a8d4ffdd)**



---

archive/issue_comments_505793.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nReplying to [@jhpalmieri](#comment%3A48):\n> It seems that the macports builds don't exclude homebrew by default,\n\nYes, the additional isolation work to ignore homebrew in /usr/local is only done if you use the factors `macos-nohomebrew`. \n\n> so I had to use `tox -e macos-nohomebrew-local-macports-minimal` \u2014\u00a0I hope I got that right\n\nThis variant should work better now. What went wrong in the previous version is that it prescribed using the MacPorts-provided gfortran compiler, but in the configuration `macports-minimal` that one is not actually installed.",
    "created_at": "2021-04-02T02:21:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505793",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:53" align="right">comment:53</div>

Replying to [@jhpalmieri](#comment%3A48):
> It seems that the macports builds don't exclude homebrew by default,

Yes, the additional isolation work to ignore homebrew in /usr/local is only done if you use the factors `macos-nohomebrew`. 

> so I had to use `tox -e macos-nohomebrew-local-macports-minimal` — I hope I got that right

This variant should work better now. What went wrong in the previous version is that it prescribed using the MacPorts-provided gfortran compiler, but in the configuration `macports-minimal` that one is not actually installed.



---

archive/issue_comments_505794.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nGreat, `macos-nohomebrew-local-macports-minimal` now works. The `standard` version did not, although I'm trying again with the latest branch. (I've now lost the old log files, but a few packages complained about missing `png.h`.)\n\nShould the macports recipes automatically include `nohomebrew`? Conversely, and I haven't tried seriously installing macports on a system, so I don't know if this is an issue, but should homebrew builds also try to exclude macports?",
    "created_at": "2021-04-02T17:29:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505794",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:54" align="right">comment:54</div>

Great, `macos-nohomebrew-local-macports-minimal` now works. The `standard` version did not, although I'm trying again with the latest branch. (I've now lost the old log files, but a few packages complained about missing `png.h`.)

Should the macports recipes automatically include `nohomebrew`? Conversely, and I haven't tried seriously installing macports on a system, so I don't know if this is an issue, but should homebrew builds also try to exclude macports?



---

archive/issue_comments_505795.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nReplying to [@jhpalmieri](#comment%3A54):\n> Great, `macos-nohomebrew-local-macports-minimal` now works. \n\nThanks for testing!\n\n> Should the macports recipes automatically include `nohomebrew`? \n\nI thought about this yesterday but decided against it. I think it's useful for developers to be able to reproduce the build behavior on user machines that have both homebrew and macports installed.\n\n> Conversely, and I haven't tried seriously installing macports on a system, so I don't know if this is an issue, but should homebrew builds also try to exclude macports?\n\nI haven't tried yet with a global installation of macports. Given that macports by default does not install into `/usr/local`, there is much less potential for macports leaking into the build, although there could be packages that check the standard macports install location explicitly.",
    "created_at": "2021-04-02T17:37:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505795",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:55" align="right">comment:55</div>

Replying to [@jhpalmieri](#comment%3A54):
> Great, `macos-nohomebrew-local-macports-minimal` now works. 

Thanks for testing!

> Should the macports recipes automatically include `nohomebrew`? 

I thought about this yesterday but decided against it. I think it's useful for developers to be able to reproduce the build behavior on user machines that have both homebrew and macports installed.

> Conversely, and I haven't tried seriously installing macports on a system, so I don't know if this is an issue, but should homebrew builds also try to exclude macports?

I haven't tried yet with a global installation of macports. Given that macports by default does not install into `/usr/local`, there is much less potential for macports leaking into the build, although there could be packages that check the standard macports install location explicitly.



---

archive/issue_comments_505796.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nProbably for another ticket: Sage's build system doesn't find the macports `gpatch` program. The file `build/pkgs/patch/distros/macports.txt` says the right thing, but it looks like `spkg-configure.m4` doesn't look for a `gpatch` executable, only `patch`.",
    "created_at": "2021-04-02T23:48:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505796",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:56" align="right">comment:56</div>

Probably for another ticket: Sage's build system doesn't find the macports `gpatch` program. The file `build/pkgs/patch/distros/macports.txt` says the right thing, but it looks like `spkg-configure.m4` doesn't look for a `gpatch` executable, only `patch`.



---

archive/issue_comments_505797.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nWould this fix it?\n\n```diff\ndiff --git a/build/pkgs/patch/spkg-configure.m4 b/build/pkgs/patch/spkg-configure.m4\nindex 02adb910d9..31bb84dc9d 100644\n--- a/build/pkgs/patch/spkg-configure.m4\n+++ b/build/pkgs/patch/spkg-configure.m4\n@@ -1,7 +1,7 @@\n SAGE_SPKG_CONFIGURE(\n     [patch], [\n        AC_CACHE_CHECK([for GNU patch >= 2.7.0], [ac_cv_path_PATCH], [\n-        AC_PATH_PROGS_FEATURE_CHECK([PATCH], [patch], [\n+        AC_PATH_PROGS_FEATURE_CHECK([PATCH], [patch gpatch], [\n             patch_version=`$ac_path_PATCH --version 2>&1 \\\n                 | $SED -n -e 's/GNU patch *\\([[0-9]]*\\.[[0-9]]*\\.[[0-9]]*\\)/\\1/p'`\n             AS_IF([test -n \"$patch_version\"], [\n```",
    "created_at": "2021-04-02T23:52:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505797",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:57" align="right">comment:57</div>

Would this fix it?

```diff
diff --git a/build/pkgs/patch/spkg-configure.m4 b/build/pkgs/patch/spkg-configure.m4
index 02adb910d9..31bb84dc9d 100644
--- a/build/pkgs/patch/spkg-configure.m4
+++ b/build/pkgs/patch/spkg-configure.m4
@@ -1,7 +1,7 @@
 SAGE_SPKG_CONFIGURE(
     [patch], [
        AC_CACHE_CHECK([for GNU patch >= 2.7.0], [ac_cv_path_PATCH], [
-        AC_PATH_PROGS_FEATURE_CHECK([PATCH], [patch], [
+        AC_PATH_PROGS_FEATURE_CHECK([PATCH], [patch gpatch], [
             patch_version=`$ac_path_PATCH --version 2>&1 \
                 | $SED -n -e 's/GNU patch *\([[0-9]]*\.[[0-9]]*\.[[0-9]]*\)/\1/p'`
             AS_IF([test -n "$patch_version"], [
```



---

archive/issue_comments_505798.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nThis alone would not be a good fix. `configure` would certainly find `gpatch` after this change -- but then we would have to make sure that all of our code that uses `patch` instead uses the environment variable `PATCH` -- and also audit all SPKG whether they do the same. (In any case, it would be a different ticket.)",
    "created_at": "2021-04-02T23:58:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505798",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:58" align="right">comment:58</div>

This alone would not be a good fix. `configure` would certainly find `gpatch` after this change -- but then we would have to make sure that all of our code that uses `patch` instead uses the environment variable `PATCH` -- and also audit all SPKG whether they do the same. (In any case, it would be a different ticket.)



---

archive/issue_comments_505799.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nI opened #31595 for the `gpatch` issue.",
    "created_at": "2021-04-03T00:03:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505799",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:59" align="right">comment:59</div>

I opened #31595 for the `gpatch` issue.



---

archive/issue_comments_505800.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nI have encountered a problem with `local-macports-standard-python3.9`: rpy2 build fails with clang: error: unsupported option '-fopenmp' - this is now #31596",
    "created_at": "2021-04-03T02:54:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505800",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:60" align="right">comment:60</div>

I have encountered a problem with `local-macports-standard-python3.9`: rpy2 build fails with clang: error: unsupported option '-fopenmp' - this is now #31596



---

archive/issue_comments_505801.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nI see that too, with `macos-nohomebrew-local-macports-standard`.",
    "created_at": "2021-04-03T03:14:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505801",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:61" align="right">comment:61</div>

I see that too, with `macos-nohomebrew-local-macports-standard`.



---

archive/issue_comments_505802.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nI am testing with `EXTRA_CONFIGURE_ARGS=\"--disable-r\"` now",
    "created_at": "2021-04-03T03:16:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505802",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:62" align="right">comment:62</div>

I am testing with `EXTRA_CONFIGURE_ARGS="--disable-r"` now



---

archive/issue_comments_505803.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nI'm running into mild problems with `macos-nohomebrew-local-macports-standard`, in particular after I run it once, hit some problems, and then run `tox -r -e ...`:\n\n```\nError: Failed to activate icu: Image error: /Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/.tox/macos-nohomebrew-local-macports-stan already exists and does not belong to a registered port.  Unable to activate port icu. Use 'port -f activate icu' to force the activation.\n```\nIs there really supposed to be a file `.tox/macos-nohomebrew-local-macports-stan` (which there is), or was the correct name truncated and then not handled properly by `tox -r ...`?",
    "created_at": "2021-04-05T22:23:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505803",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:63" align="right">comment:63</div>

I'm running into mild problems with `macos-nohomebrew-local-macports-standard`, in particular after I run it once, hit some problems, and then run `tox -r -e ...`:

```
Error: Failed to activate icu: Image error: /Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc0/.tox/macos-nohomebrew-local-macports-stan already exists and does not belong to a registered port.  Unable to activate port icu. Use 'port -f activate icu' to force the activation.
```
Is there really supposed to be a file `.tox/macos-nohomebrew-local-macports-stan` (which there is), or was the correct name truncated and then not handled properly by `tox -r ...`?



---

archive/issue_comments_505804.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nNo, this looks like a bug in the MacPorts scripts, truncating some filenames.",
    "created_at": "2021-04-05T22:28:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505804",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:64" align="right">comment:64</div>

No, this looks like a bug in the MacPorts scripts, truncating some filenames.



---

archive/issue_comments_505805.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nReplying to [@jhpalmieri](#comment%3A44):\n> I don't know. For example, when there is an error building sagelib, that particular process never ends: there is no conclusion in the sagelib log file until I halt it, and then it ends with `KeyboardInterrupt`. Is that a symptom of using `make -k`? I've used `make -k` before when building Sage and it has always stopped when it was supposed to.\n\nI'm hitting this problem on another computer, this time running OS X Catalina. I don't know what to do except interrupt the process.",
    "created_at": "2021-04-06T17:08:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505805",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:65" align="right">comment:65</div>

Replying to [@jhpalmieri](#comment%3A44):
> I don't know. For example, when there is an error building sagelib, that particular process never ends: there is no conclusion in the sagelib log file until I halt it, and then it ends with `KeyboardInterrupt`. Is that a symptom of using `make -k`? I've used `make -k` before when building Sage and it has always stopped when it was supposed to.

I'm hitting this problem on another computer, this time running OS X Catalina. I don't know what to do except interrupt the process.



---

archive/issue_comments_505806.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nplease rebase",
    "created_at": "2021-04-07T20:01:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505806",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:66" align="right">comment:66</div>

please rebase



---

archive/issue_comments_505807.json:
```json
{
    "body": "<div id=\"comment:67\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/439d7464e10e1115c25a5f7cd499b8fa68e07a9b\"><code>439d746</code></a></td><td><code>Merge tag '9.3.rc2' into t/31505/tox_ini__add_macports_environment</code></td></tr></table>\n",
    "created_at": "2021-04-07T20:19:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505807",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:67"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/439d7464e10e1115c25a5f7cd499b8fa68e07a9b"><code>439d746</code></a></td><td><code>Merge tag '9.3.rc2' into t/31505/tox_ini__add_macports_environment</code></td></tr></table>




---

archive/issue_comments_505808.json:
```json
{
    "body": "Changed commit from **[`da6f752`](https://github.com/sagemath/sagetrac-mirror/commit/da6f752e0e38fd1a72617f728193a628a8d4ffdd)** to **[`439d746`](https://github.com/sagemath/sagetrac-mirror/commit/439d7464e10e1115c25a5f7cd499b8fa68e07a9b)**",
    "created_at": "2021-04-07T20:19:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505808",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`da6f752`](https://github.com/sagemath/sagetrac-mirror/commit/da6f752e0e38fd1a72617f728193a628a8d4ffdd)** to **[`439d746`](https://github.com/sagemath/sagetrac-mirror/commit/439d7464e10e1115c25a5f7cd499b8fa68e07a9b)**



---

archive/issue_comments_505809.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nI see a bug of sorts - /usr/local leaks into macports build, via GMP:\n\n```\n#define ABSOLUTE_GMP_H \"///usr/local/include/gmp.h\"\n```\nand this results in fpylll not finding `gmp.h`, for some reason",
    "created_at": "2021-04-07T22:50:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505809",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:68" align="right">comment:68</div>

I see a bug of sorts - /usr/local leaks into macports build, via GMP:

```
#define ABSOLUTE_GMP_H "///usr/local/include/gmp.h"
```
and this results in fpylll not finding `gmp.h`, for some reason



---

archive/issue_comments_505810.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nand `gmp` in `/opt/local` is not recognised by `./configure`",
    "created_at": "2021-04-07T22:57:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505810",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:69" align="right">comment:69</div>

and `gmp` in `/opt/local` is not recognised by `./configure`



---

archive/issue_comments_505811.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nYes, this should be fixed via #31348 (as in its ticket description, not the branch just added there)",
    "created_at": "2021-04-07T22:57:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505811",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:70" align="right">comment:70</div>

Yes, this should be fixed via #31348 (as in its ticket description, not the branch just added there)



---

archive/issue_comments_505812.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nGiven that the /usr/local leakage only affects users who have both MacPorts and /usr/local installed, perhaps we can get this ticket in as is?",
    "created_at": "2021-04-08T16:46:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505812",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:71" align="right">comment:71</div>

Given that the /usr/local leakage only affects users who have both MacPorts and /usr/local installed, perhaps we can get this ticket in as is?



---

archive/issue_comments_505813.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nI wish that `macos-nohomebrew-local-macports-standard` would succeed on at least one machine for me, but I keep hitting problems with sagelib. I'll try one more time and then upload the sagelib log file, but it will probably look like the one I uploaded before.",
    "created_at": "2021-04-08T18:49:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505813",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:72" align="right">comment:72</div>

I wish that `macos-nohomebrew-local-macports-standard` would succeed on at least one machine for me, but I keep hitting problems with sagelib. I'll try one more time and then upload the sagelib log file, but it will probably look like the one I uploaded before.



---

archive/issue_comments_505814.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nDo you set `MAKE` to `make -j...` or `SAGE_NUM_THREADS` by any chance? If so, it would be worth testing if the problem goes away if you unset these variables.\n\nAnother thing to try could be `export EXTRA_CONFIGURE_ARGS=\"--enable-editable\"`, which uses a simpler build system",
    "created_at": "2021-04-08T18:55:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505814",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:73" align="right">comment:73</div>

Do you set `MAKE` to `make -j...` or `SAGE_NUM_THREADS` by any chance? If so, it would be worth testing if the problem goes away if you unset these variables.

Another thing to try could be `export EXTRA_CONFIGURE_ARGS="--enable-editable"`, which uses a simpler build system



---

archive/issue_comments_505815.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\nI unset `MAKE` and `MAKEFLAGS`, and other than taking longer, I see the same thing. I'm attaching the sagelib log file (before hitting ctrl-c). I'll try with `--enable-editable`.",
    "created_at": "2021-04-09T02:15:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505815",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:74" align="right">comment:74</div>

I unset `MAKE` and `MAKEFLAGS`, and other than taking longer, I see the same thing. I'm attaching the sagelib log file (before hitting ctrl-c). I'll try with `--enable-editable`.



---

archive/issue_comments_505816.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nAttachment: **[sagelib-9.3.rc2.log](https://github.com/sagemath/sage/files/ticket31505/sagelib-9.3.rc2.log)**\n\nWith `--enable-editable`, it did at least end when building the Sage library failed. The end of the log file looks like this:\n\n```\n    g++ -bundle -undefined dynamic_lookup -Wl,-headerpad,0x1000 -L/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib -Wl,-rpath,/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib -O2 -g -march=native build/temp.macosx-10.14.6-x86_64-3.8/sage/symbolic/expression.o -lpynac -lgmp -o build/lib.macosx-10.14.6-x86_64-3.8/sage/symbolic/expression.cpython-38-darwin.so -lpari\n    ld: warning: dylib (/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/libpynac.dylib) was built for newer macOS version (10.15) than being linked (10.14.6)\n    ld: warning: dylib (/usr/local/lib/libgmp.dylib) was built for newer macOS version (10.15) than being linked (10.14.6)\n    error: command '/usr/bin/gcc' failed with exit code 1\nERROR: Command errored out with exit status 1: /Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/bin/python3 -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/src/setup.py'\"'\"'; __file__='\"'\"'/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/src/setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' --no-user-cfg develop --no-deps Check the logs for full command output.\nException information:\nTraceback (most recent call last):\n  File \"/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/python3.8/site-packages/pip/_internal/cli/base_command.py\", line 189, in _main\n    status = self.run(options, args)\n  File \"/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/python3.8/site-packages/pip/_internal/cli/req_command.py\", line 178, in wrapper\n    return func(self, options, args)\n  File \"/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/python3.8/site-packages/pip/_internal/commands/install.py\", line 391, in run\n    installed = install_given_reqs(\n  File \"/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/python3.8/site-packages/pip/_internal/req/__init__.py\", line 80, in install_given_reqs\n    requirement.install(\n  File \"/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/python3.8/site-packages/pip/_internal/req/req_install.py\", line 764, in install\n    install_editable_legacy(\n  File \"/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/python3.8/site-packages/pip/_internal/operations/install/editable_legacy.py\", line 49, in install_editable\n    call_subprocess(\n  File \"/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/python3.8/site-packages/pip/_internal/utils/subprocess.py\", line 258, in call_subprocess\n    raise InstallationSubprocessError(proc.returncode, command_desc)\npip._internal.exceptions.InstallationSubprocessError: Command errored out with exit status 1: /Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/bin/python3 -c 'import sys, setuptools, tokenize; sys.argv[0] = '\"'\"'/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/src/setup.py'\"'\"'; __file__='\"'\"'/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/src/setup.py'\"'\"';f=getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__);code=f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' --no-user-cfg develop --no-deps Check the logs for full command output.\nRemoved build tracker: '/private/var/folders/00/zrss7sdj3bzd23f2_gnspy2h0000gp/T/pip-req-tracker-jrbc7dbe'\n\nreal\t5m28.311s\nuser\t49m7.815s\nsys\t1m20.961s\n```\nThis was with the command `EXTRA_CONFIGURE_ARGS=\"--enable-editable --disable-r\" tox -r -e macos-nohomebrew-local-macports-standard`",
    "created_at": "2021-04-09T16:19:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505816",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:75" align="right">comment:75</div>

Attachment: **[sagelib-9.3.rc2.log](https://github.com/sagemath/sage/files/ticket31505/sagelib-9.3.rc2.log)**

With `--enable-editable`, it did at least end when building the Sage library failed. The end of the log file looks like this:

```
    g++ -bundle -undefined dynamic_lookup -Wl,-headerpad,0x1000 -L/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib -Wl,-rpath,/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib -O2 -g -march=native build/temp.macosx-10.14.6-x86_64-3.8/sage/symbolic/expression.o -lpynac -lgmp -o build/lib.macosx-10.14.6-x86_64-3.8/sage/symbolic/expression.cpython-38-darwin.so -lpari
    ld: warning: dylib (/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/libpynac.dylib) was built for newer macOS version (10.15) than being linked (10.14.6)
    ld: warning: dylib (/usr/local/lib/libgmp.dylib) was built for newer macOS version (10.15) than being linked (10.14.6)
    error: command '/usr/bin/gcc' failed with exit code 1
ERROR: Command errored out with exit status 1: /Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/bin/python3 -c 'import sys, setuptools, tokenize; sys.argv[0] = '"'"'/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/src/setup.py'"'"'; __file__='"'"'/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/src/setup.py'"'"';f=getattr(tokenize, '"'"'open'"'"', open)(__file__);code=f.read().replace('"'"'\r\n'"'"', '"'"'\n'"'"');f.close();exec(compile(code, __file__, '"'"'exec'"'"'))' --no-user-cfg develop --no-deps Check the logs for full command output.
Exception information:
Traceback (most recent call last):
  File "/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/python3.8/site-packages/pip/_internal/cli/base_command.py", line 189, in _main
    status = self.run(options, args)
  File "/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/python3.8/site-packages/pip/_internal/cli/req_command.py", line 178, in wrapper
    return func(self, options, args)
  File "/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/python3.8/site-packages/pip/_internal/commands/install.py", line 391, in run
    installed = install_given_reqs(
  File "/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/python3.8/site-packages/pip/_internal/req/__init__.py", line 80, in install_given_reqs
    requirement.install(
  File "/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/python3.8/site-packages/pip/_internal/req/req_install.py", line 764, in install
    install_editable_legacy(
  File "/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/python3.8/site-packages/pip/_internal/operations/install/editable_legacy.py", line 49, in install_editable
    call_subprocess(
  File "/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/python3.8/site-packages/pip/_internal/utils/subprocess.py", line 258, in call_subprocess
    raise InstallationSubprocessError(proc.returncode, command_desc)
pip._internal.exceptions.InstallationSubprocessError: Command errored out with exit status 1: /Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/bin/python3 -c 'import sys, setuptools, tokenize; sys.argv[0] = '"'"'/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/src/setup.py'"'"'; __file__='"'"'/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/src/setup.py'"'"';f=getattr(tokenize, '"'"'open'"'"', open)(__file__);code=f.read().replace('"'"'\r\n'"'"', '"'"'\n'"'"');f.close();exec(compile(code, __file__, '"'"'exec'"'"'))' --no-user-cfg develop --no-deps Check the logs for full command output.
Removed build tracker: '/private/var/folders/00/zrss7sdj3bzd23f2_gnspy2h0000gp/T/pip-req-tracker-jrbc7dbe'

real	5m28.311s
user	49m7.815s
sys	1m20.961s
```
This was with the command `EXTRA_CONFIGURE_ARGS="--enable-editable --disable-r" tox -r -e macos-nohomebrew-local-macports-standard`



---

archive/issue_comments_505817.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nThanks for testing!\n\nThis `error: command '/usr/bin/gcc' failed with exit code 1` without an actual gcc error message is really puzzling. \n\nAlso in the previous logs that you sent, there was such a message at the end but I didn't see an actual error either.\n\nCould you try what happens now if you do \n`SKIP_SYSTEM_PKG_INSTALL=1 SKIP_BOOTSTRAP=1 SKIP_CONFIGURE=1 EXTRA_CONFIGURE_ARGS=\"--enable-editable --disable-r\" tox -e macos-nohomebrew-local-macports-standard` (note, no `-r` for tox, so this should be fast)",
    "created_at": "2021-04-09T16:55:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505817",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:76" align="right">comment:76</div>

Thanks for testing!

This `error: command '/usr/bin/gcc' failed with exit code 1` without an actual gcc error message is really puzzling. 

Also in the previous logs that you sent, there was such a message at the end but I didn't see an actual error either.

Could you try what happens now if you do 
`SKIP_SYSTEM_PKG_INSTALL=1 SKIP_BOOTSTRAP=1 SKIP_CONFIGURE=1 EXTRA_CONFIGURE_ARGS="--enable-editable --disable-r" tox -e macos-nohomebrew-local-macports-standard` (note, no `-r` for tox, so this should be fast)



---

archive/issue_comments_505818.json:
```json
{
    "body": "Attachment: **[sagelib-9.3.rc2-delta.log](https://github.com/sagemath/sage/files/ticket31505/sagelib-9.3.rc2-delta.log)**",
    "created_at": "2021-04-09T17:38:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505818",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[sagelib-9.3.rc2-delta.log](https://github.com/sagemath/sage/files/ticket31505/sagelib-9.3.rc2-delta.log)**



---

archive/issue_comments_505819.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nIt fails again. I've attached the new part of the sagelib log.",
    "created_at": "2021-04-09T17:39:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505819",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:77" align="right">comment:77</div>

It fails again. I've attached the new part of the sagelib log.



---

archive/issue_comments_505820.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nNow error messages are there!\n\n```\n    building 'sage.libs.readline' extension\n    gcc -Wno-unused-result -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -iwithsysroot/System/Library/Frameworks/System.framework/PrivateHeaders -iwithsysroot/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.8/Headers -O2 -g -march=native -Isage/cpython -I/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/src -I/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.8/include/python3.8 -I/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/python3.8/site-packages/numpy/core/include -I/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/include -I/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.8/include/python3.8 -c sage/libs/readline.c -o build/temp.macosx-10.14.6-x86_64-3.8/sage/libs/readline.o\n    sage/libs/readline.c:1451:36: error: use of undeclared identifier 'rl_catch_signals'\n      __pyx_t_1 = __Pyx_PyInt_From_int(rl_catch_signals); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 88, __pyx_L1_error)\n```\n\n```\n    gcc -bundle -undefined dynamic_lookup -Wl,-headerpad,0x1000 -L/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib -Wl,-rpath,/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib -O2 -g -march=native build/temp.macosx-10.14.6-x86_64-3.8/sage/rings/complex_double.o -L/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/macports/lib -lm -lgmp -lpari -lgsl -lm -lopenblas -o build/lib.macosx-10.14.6-x86_64-3.8/sage/rings/complex_double.cpython-38-darwin.so -lpari\n    ld: warning: dylib (/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/macports/lib/libgmp.dylib) was built for newer macOS version (10.15) than being linked (10.14.6)\n    ld: warning: dylib (/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/macports/lib/libgsl.dylib) was built for newer macOS version (10.15) than being linked (10.14.6)\n    ld: warning: dylib (/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/macports/lib/libopenblas.dylib) was built for newer macOS version (10.15) than being linked (10.14.6)\n    ld: illegal data reference in _avma to thread local variable _avma in dylib /Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/libpari.dylib for architecture x86_64\n    clang: error: linker command failed with exit code 1 (use -v to see invocation)\n    error: command '/usr/bin/gcc' failed with exit code 1\n```",
    "created_at": "2021-04-09T17:53:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505820",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:78" align="right">comment:78</div>

Now error messages are there!

```
    building 'sage.libs.readline' extension
    gcc -Wno-unused-result -Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -iwithsysroot/System/Library/Frameworks/System.framework/PrivateHeaders -iwithsysroot/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.8/Headers -O2 -g -march=native -Isage/cpython -I/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/src -I/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.8/include/python3.8 -I/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/python3.8/site-packages/numpy/core/include -I/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/include -I/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.8/include/python3.8 -c sage/libs/readline.c -o build/temp.macosx-10.14.6-x86_64-3.8/sage/libs/readline.o
    sage/libs/readline.c:1451:36: error: use of undeclared identifier 'rl_catch_signals'
      __pyx_t_1 = __Pyx_PyInt_From_int(rl_catch_signals); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 88, __pyx_L1_error)
```

```
    gcc -bundle -undefined dynamic_lookup -Wl,-headerpad,0x1000 -L/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib -Wl,-rpath,/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib -O2 -g -march=native build/temp.macosx-10.14.6-x86_64-3.8/sage/rings/complex_double.o -L/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/macports/lib -lm -lgmp -lpari -lgsl -lm -lopenblas -o build/lib.macosx-10.14.6-x86_64-3.8/sage/rings/complex_double.cpython-38-darwin.so -lpari
    ld: warning: dylib (/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/macports/lib/libgmp.dylib) was built for newer macOS version (10.15) than being linked (10.14.6)
    ld: warning: dylib (/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/macports/lib/libgsl.dylib) was built for newer macOS version (10.15) than being linked (10.14.6)
    ld: warning: dylib (/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/macports/lib/libopenblas.dylib) was built for newer macOS version (10.15) than being linked (10.14.6)
    ld: illegal data reference in _avma to thread local variable _avma in dylib /Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.3.rc2/.tox/macos-nohomebrew-local-macports-standard/local/lib/libpari.dylib for architecture x86_64
    clang: error: linker command failed with exit code 1 (use -v to see invocation)
    error: command '/usr/bin/gcc' failed with exit code 1
```



---

archive/issue_comments_505821.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">comment:79</div>\n\nThe `readline` issue is probably just #29000 again. \n\n(Or we may want to create a `.macports-build-env` script, after all. https://guide.macports.org/#installing.shell only mentions setting `PATH` - but we may need to also set `CPATH` and `LIBRARY_PATH` if we want libraries to be found that do not come with .pc files.)",
    "created_at": "2021-04-09T18:24:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505821",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:79" align="right">comment:79</div>

The `readline` issue is probably just #29000 again. 

(Or we may want to create a `.macports-build-env` script, after all. https://guide.macports.org/#installing.shell only mentions setting `PATH` - but we may need to also set `CPATH` and `LIBRARY_PATH` if we want libraries to be found that do not come with .pc files.)



---

archive/issue_comments_505822.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\nAt this point I'm certainly happy removing the ban, but since I can't get the macports-standard tox build to work, I can't positively review the rest.",
    "created_at": "2021-04-10T18:20:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505822",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:80" align="right">comment:80</div>

At this point I'm certainly happy removing the ban, but since I can't get the macports-standard tox build to work, I can't positively review the rest.



---

archive/issue_events_431140.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-10T18:36:04Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "title_is": "Extend system package scripts to handle macports; tox.ini: Add macports environment",
    "title_was": "Remove outdated macports ban; Extend system package scripts to handle macports; tox.ini: Add macports environment",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431140"
}
```



---

archive/issue_comments_505823.json:
```json
{
    "body": "Changed dependencies from **#31567** to **#31567, #31641**",
    "created_at": "2021-04-10T18:36:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505823",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#31567** to **#31567, #31641**



---

archive/issue_comments_505824.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\nOK, I have split this part out to #31641",
    "created_at": "2021-04-10T18:36:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505824",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:81" align="right">comment:81</div>

OK, I have split this part out to #31641



---

archive/issue_events_431141.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-10T18:39:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
    "label_color": "ff7700",
    "label_name": "p: critical / 2",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431141"
}
```



---

archive/issue_events_431142.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-10T18:39:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431142"
}
```



---

archive/issue_events_431143.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-10T18:39:50Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431143"
}
```



---

archive/issue_events_431144.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-10T18:39:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431144"
}
```



---

archive/issue_events_431145.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-10T19:01:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431145"
}
```



---

archive/issue_events_431146.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-10T19:01:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431146"
}
```



---

archive/issue_comments_505825.json:
```json
{
    "body": "Work Issues: **rebase on #31534, #31641**",
    "created_at": "2021-04-10T19:01:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505825",
    "user": "https://github.com/mkoeppe"
}
```

Work Issues: **rebase on #31534, #31641**



---

archive/issue_comments_505826.json:
```json
{
    "body": "<div id=\"comment:84\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/617e8eb866608a32f847f252381285343cc155a7\"><code>617e8eb</code></a></td><td><code>tox.ini: In -maximal environments, use IGNORE_MISSING_SYSTEM_PACKAGES=yes for all non-current distributions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ab785af0aa359eb059e671371c8c980a5b636eaf\"><code>ab785af</code></a></td><td><code>tox.ini: Use IGNORE_MISSING_SYSTEM_PACKAGES=no for rolling distributions, but IGNORE_MISSING_SYSTEM_PACKAGES=yes for unstable distributions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/afc7266a873f480ecb7ed140e8633c2e18243cf1\"><code>afc7266</code></a></td><td><code>Merge tag '9.4.beta0' into t/31534/tox_ini__in__maximal_environments__use_ignore_missing_system_packages_yes_for_all_non_current_distributions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c787c3cb69c0644f119facea4084459976b25db6\"><code>c787c3c</code></a></td><td><code>Merge branch 't/31534/tox_ini__in__maximal_environments__use_ignore_missing_system_packages_yes_for_all_non_current_distributions' into t/31505/tox_ini__add_macports_environment</code></td></tr></table>\n",
    "created_at": "2021-05-27T22:17:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505826",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:84"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/617e8eb866608a32f847f252381285343cc155a7"><code>617e8eb</code></a></td><td><code>tox.ini: In -maximal environments, use IGNORE_MISSING_SYSTEM_PACKAGES=yes for all non-current distributions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ab785af0aa359eb059e671371c8c980a5b636eaf"><code>ab785af</code></a></td><td><code>tox.ini: Use IGNORE_MISSING_SYSTEM_PACKAGES=no for rolling distributions, but IGNORE_MISSING_SYSTEM_PACKAGES=yes for unstable distributions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/afc7266a873f480ecb7ed140e8633c2e18243cf1"><code>afc7266</code></a></td><td><code>Merge tag '9.4.beta0' into t/31534/tox_ini__in__maximal_environments__use_ignore_missing_system_packages_yes_for_all_non_current_distributions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c787c3cb69c0644f119facea4084459976b25db6"><code>c787c3c</code></a></td><td><code>Merge branch 't/31534/tox_ini__in__maximal_environments__use_ignore_missing_system_packages_yes_for_all_non_current_distributions' into t/31505/tox_ini__add_macports_environment</code></td></tr></table>




---

archive/issue_comments_505827.json:
```json
{
    "body": "Changed commit from **[`439d746`](https://github.com/sagemath/sagetrac-mirror/commit/439d7464e10e1115c25a5f7cd499b8fa68e07a9b)** to **[`c787c3c`](https://github.com/sagemath/sagetrac-mirror/commit/c787c3cb69c0644f119facea4084459976b25db6)**",
    "created_at": "2021-05-27T22:17:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505827",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`439d746`](https://github.com/sagemath/sagetrac-mirror/commit/439d7464e10e1115c25a5f7cd499b8fa68e07a9b)** to **[`c787c3c`](https://github.com/sagemath/sagetrac-mirror/commit/c787c3cb69c0644f119facea4084459976b25db6)**



---

archive/issue_comments_505828.json:
```json
{
    "body": "Changed dependencies from **#31567, #31641** to **#31534**",
    "created_at": "2021-05-27T22:18:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505828",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#31567, #31641** to **#31534**



---

archive/issue_comments_505829.json:
```json
{
    "body": "Changed work issues from **rebase on #31534, #31641** to none",
    "created_at": "2021-05-27T22:18:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505829",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **rebase on #31534, #31641** to none



---

archive/issue_comments_505830.json:
```json
{
    "body": "Changed commit from **[`c787c3c`](https://github.com/sagemath/sagetrac-mirror/commit/c787c3cb69c0644f119facea4084459976b25db6)** to **[`27b0064`](https://github.com/sagemath/sagetrac-mirror/commit/27b0064337dc42705da89a67518d17d67fa82dfa)**",
    "created_at": "2021-07-09T22:38:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505830",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c787c3c`](https://github.com/sagemath/sagetrac-mirror/commit/c787c3cb69c0644f119facea4084459976b25db6)** to **[`27b0064`](https://github.com/sagemath/sagetrac-mirror/commit/27b0064337dc42705da89a67518d17d67fa82dfa)**



---

archive/issue_comments_505831.json:
```json
{
    "body": "<div id=\"comment:86\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/27b0064337dc42705da89a67518d17d67fa82dfa\"><code>27b0064</code></a></td><td><code>Merge tag '9.4.beta4' into t/31505/tox_ini__add_macports_environment</code></td></tr></table>\n",
    "created_at": "2021-07-09T22:38:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505831",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:86"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/27b0064337dc42705da89a67518d17d67fa82dfa"><code>27b0064</code></a></td><td><code>Merge tag '9.4.beta4' into t/31505/tox_ini__add_macports_environment</code></td></tr></table>




---

archive/issue_comments_505832.json:
```json
{
    "body": "Changed dependencies from **#31534** to none",
    "created_at": "2021-07-09T22:38:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505832",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#31534** to none



---

archive/issue_comments_505833.json:
```json
{
    "body": "<div id=\"comment:88\" align=\"right\">comment:88</div>\n\nHow can we move forward here? Does this still need work?\nOr is it ready for review?",
    "created_at": "2021-07-21T07:41:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505833",
    "user": "https://github.com/slel"
}
```

<div id="comment:88" align="right">comment:88</div>

How can we move forward here? Does this still need work?
Or is it ready for review?



---

archive/issue_comments_505834.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">comment:89</div>\n\nI'd think after #31786 is merged, we can update `build/pkgs/gfortran/distros/macports.txt` and perhaps create a .macports-build-env as suggested in [comment:13](#comment%3A13), [comment:79](#comment%3A79).",
    "created_at": "2021-07-21T11:07:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505834",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:89" align="right">comment:89</div>

I'd think after #31786 is merged, we can update `build/pkgs/gfortran/distros/macports.txt` and perhaps create a .macports-build-env as suggested in [comment:13](#comment%3A13), [comment:79](#comment%3A79).



---

archive/issue_comments_505835.json:
```json
{
    "body": "Dependencies: **#31786**",
    "created_at": "2021-07-21T11:07:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505835",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#31786**



---

archive/issue_events_431147.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:26:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431147"
}
```



---

archive/issue_events_431148.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:26:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431148"
}
```



---

archive/issue_comments_505836.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">comment:91</div>\n\nTicket #31786 was merged in Sage 9.4.beta6.",
    "created_at": "2021-11-21T21:24:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505836",
    "user": "https://github.com/slel"
}
```

<div id="comment:91" align="right">comment:91</div>

Ticket #31786 was merged in Sage 9.4.beta6.



---

archive/issue_events_431149.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-23T04:18:37Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431149"
}
```



---

archive/issue_events_431150.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-23T04:18:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431150"
}
```



---

archive/issue_events_431151.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:45:28Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431151"
}
```



---

archive/issue_events_431152.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:45:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431152"
}
```



---

archive/issue_comments_505837.json:
```json
{
    "body": "<div id=\"comment:94\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e21e05356d6bb719db298621e6bf12bc1fbfeadb\"><code>e21e053</code></a></td><td><code>tox.ini: Add local-macports</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2de11f791d461e16c8a1394b0cb511ab3b9db652\"><code>2de11f7</code></a></td><td><code>Add macports.txt</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68dc2a25822da43c3958cb64e4f3f702d7fa8532\"><code>68dc2a2</code></a></td><td><code>build/pkgs/_prereq/distros: Update file comments</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a299cedf17ea6920907b1be231bf5464e40422ad\"><code>a299ced</code></a></td><td><code>build/bin/sage-print-system-package-command: Handle macports install</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/73cf4e2e2ae437e765910fe73d49516f6011d680\"><code>73cf4e2</code></a></td><td><code>tox.ini (local-macports-optlocal): Use sudo</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/73a339d86a8178c121c40d90f984196c626f98ab\"><code>73a339d</code></a></td><td><code>build/bin/sage-print-system-package-command (macports): Handle setup-build-env</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a193556ac4a705d0064aa706bf5b4687787bb891\"><code>a193556</code></a></td><td><code>build/bin/sage-guess-package-system: Detect macports</code></td></tr><tr><td><code>[f9ea55e](https://github.com/sagemath/sagetrac-mirror/commit/f9ea55edcf869b5526d996f653b3c7ae84ba98ba)</code></td><td><code>`tox.ini: Add configuration factors macports-python{3.8,3.9`}</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55910b90f13cd0011afe9d54bb372f065f500ea4\"><code>55910b9</code></a></td><td><code>build/bin/sage-print-system-package-command (macports): Recommend FC as configure arg, not environment variable</code></td></tr><tr><td><code>[e7e72fa](https://github.com/sagemath/sagetrac-mirror/commit/e7e72fa9d4a1ad49ec6a5f8f6459156bba92812c)</code></td><td><code>`tox.ini (macports): Pass FC as configure argument; add variants macports-gcc_{spkg,9,10,11`}</code></td></tr></table>\n",
    "created_at": "2022-04-15T17:44:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505837",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:94"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e21e05356d6bb719db298621e6bf12bc1fbfeadb"><code>e21e053</code></a></td><td><code>tox.ini: Add local-macports</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2de11f791d461e16c8a1394b0cb511ab3b9db652"><code>2de11f7</code></a></td><td><code>Add macports.txt</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68dc2a25822da43c3958cb64e4f3f702d7fa8532"><code>68dc2a2</code></a></td><td><code>build/pkgs/_prereq/distros: Update file comments</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a299cedf17ea6920907b1be231bf5464e40422ad"><code>a299ced</code></a></td><td><code>build/bin/sage-print-system-package-command: Handle macports install</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/73cf4e2e2ae437e765910fe73d49516f6011d680"><code>73cf4e2</code></a></td><td><code>tox.ini (local-macports-optlocal): Use sudo</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/73a339d86a8178c121c40d90f984196c626f98ab"><code>73a339d</code></a></td><td><code>build/bin/sage-print-system-package-command (macports): Handle setup-build-env</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a193556ac4a705d0064aa706bf5b4687787bb891"><code>a193556</code></a></td><td><code>build/bin/sage-guess-package-system: Detect macports</code></td></tr><tr><td><code>[f9ea55e](https://github.com/sagemath/sagetrac-mirror/commit/f9ea55edcf869b5526d996f653b3c7ae84ba98ba)</code></td><td><code>`tox.ini: Add configuration factors macports-python{3.8,3.9`}</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55910b90f13cd0011afe9d54bb372f065f500ea4"><code>55910b9</code></a></td><td><code>build/bin/sage-print-system-package-command (macports): Recommend FC as configure arg, not environment variable</code></td></tr><tr><td><code>[e7e72fa](https://github.com/sagemath/sagetrac-mirror/commit/e7e72fa9d4a1ad49ec6a5f8f6459156bba92812c)</code></td><td><code>`tox.ini (macports): Pass FC as configure argument; add variants macports-gcc_{spkg,9,10,11`}</code></td></tr></table>




---

archive/issue_comments_505838.json:
```json
{
    "body": "Changed commit from **[`27b0064`](https://github.com/sagemath/sagetrac-mirror/commit/27b0064337dc42705da89a67518d17d67fa82dfa)** to **[`e7e72fa`](https://github.com/sagemath/sagetrac-mirror/commit/e7e72fa9d4a1ad49ec6a5f8f6459156bba92812c)**",
    "created_at": "2022-04-15T17:44:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505838",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`27b0064`](https://github.com/sagemath/sagetrac-mirror/commit/27b0064337dc42705da89a67518d17d67fa82dfa)** to **[`e7e72fa`](https://github.com/sagemath/sagetrac-mirror/commit/e7e72fa9d4a1ad49ec6a5f8f6459156bba92812c)**



---

archive/issue_comments_505839.json:
```json
{
    "body": "Changed dependencies from **#31786** to none",
    "created_at": "2022-04-15T17:49:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505839",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#31786** to none



---

archive/issue_comments_505840.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,4 @@\n Based on #30504, which added MacPorts package information, we update the system package scripts to include support for MacPorts.\n-\n-We remove the outdated ban of the systems with MacPorts (and also fink) in the configure phase.  This unfair ban has in at least one case outraged a devoted user of that packaging system.\n \n Current Sage builds just fine on a system with MacPorts. \n To test this, we add `local-macports` environments to `tox.ini`:\n@@ -33,3 +31,4 @@\n \n - [Ask Sage question 54790: Use OpenSSL from /opt/local/](https://ask.sagemath.org/question/54790)\n - [sage-support, 2020-12](https://groups.google.com/g/sage-support/c/_cfY37nFF84/m/1biGwJetBgAJ)\n+- [sage-devel, 2022-04](https://groups.google.com/g/sage-devel/c/qTcF8tlWLcE/m/9QRODrv0CgAJ)\n``````\n",
    "created_at": "2022-04-15T17:49:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505840",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,4 @@
 Based on #30504, which added MacPorts package information, we update the system package scripts to include support for MacPorts.
-
-We remove the outdated ban of the systems with MacPorts (and also fink) in the configure phase.  This unfair ban has in at least one case outraged a devoted user of that packaging system.
 
 Current Sage builds just fine on a system with MacPorts. 
 To test this, we add `local-macports` environments to `tox.ini`:
@@ -33,3 +31,4 @@
 
 - [Ask Sage question 54790: Use OpenSSL from /opt/local/](https://ask.sagemath.org/question/54790)
 - [sage-support, 2020-12](https://groups.google.com/g/sage-support/c/_cfY37nFF84/m/1biGwJetBgAJ)
+- [sage-devel, 2022-04](https://groups.google.com/g/sage-devel/c/qTcF8tlWLcE/m/9QRODrv0CgAJ)
``````




---

archive/issue_comments_505841.json:
```json
{
    "body": "<div id=\"comment:96\" align=\"right\">comment:96</div>\n\nI must be doing something wrong:\n\n```\n% tox -e local-macports-standard\n_____________________________________________________ summary _____________________________________________________\nERROR:   local-macports-standard: unresolvable substitution(s):\n    commands: 'EXTRA_SAGE_PACKAGES'\nEnvironment variables are missing or defined recursively.\n```",
    "created_at": "2022-04-15T19:24:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505841",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:96" align="right">comment:96</div>

I must be doing something wrong:

```
% tox -e local-macports-standard
_____________________________________________________ summary _____________________________________________________
ERROR:   local-macports-standard: unresolvable substitution(s):
    commands: 'EXTRA_SAGE_PACKAGES'
Environment variables are missing or defined recursively.
```



---

archive/issue_comments_505842.json:
```json
{
    "body": "<div id=\"comment:97\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4bf4e4577aa070b0f3fb581e1cfad545225edb9f\"><code>4bf4e45</code></a></td><td><code>tox.ini (macports): Fix up use of ALL_EXTRA_SAGE_PACKAGES</code></td></tr></table>\n",
    "created_at": "2022-04-15T20:46:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505842",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:97"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4bf4e4577aa070b0f3fb581e1cfad545225edb9f"><code>4bf4e45</code></a></td><td><code>tox.ini (macports): Fix up use of ALL_EXTRA_SAGE_PACKAGES</code></td></tr></table>




---

archive/issue_comments_505843.json:
```json
{
    "body": "Changed commit from **[`e7e72fa`](https://github.com/sagemath/sagetrac-mirror/commit/e7e72fa9d4a1ad49ec6a5f8f6459156bba92812c)** to **[`4bf4e45`](https://github.com/sagemath/sagetrac-mirror/commit/4bf4e4577aa070b0f3fb581e1cfad545225edb9f)**",
    "created_at": "2022-04-15T20:46:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505843",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e7e72fa`](https://github.com/sagemath/sagetrac-mirror/commit/e7e72fa9d4a1ad49ec6a5f8f6459156bba92812c)** to **[`4bf4e45`](https://github.com/sagemath/sagetrac-mirror/commit/4bf4e4577aa070b0f3fb581e1cfad545225edb9f)**



---

archive/issue_comments_505844.json:
```json
{
    "body": "<div id=\"comment:98\" align=\"right\">comment:98</div>\n\nThanks for testing! I hadn't tested it yet after rebasing",
    "created_at": "2022-04-15T20:47:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505844",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:98" align="right">comment:98</div>

Thanks for testing! I hadn't tested it yet after rebasing



---

archive/issue_comments_505845.json:
```json
{
    "body": "<div id=\"comment:99\" align=\"right\">comment:99</div>\n\nThanks, now it's building. I don't know why it (Macports) is building Python 2.7, but I happened to look just now, and that's what it's doing.",
    "created_at": "2022-04-15T21:38:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505845",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:99" align="right">comment:99</div>

Thanks, now it's building. I don't know why it (Macports) is building Python 2.7, but I happened to look just now, and that's what it's doing.



---

archive/issue_comments_505846.json:
```json
{
    "body": "<div id=\"comment:100\" align=\"right\">comment:100</div>\n\nI don't know if this part of the description is still accurate:\n\n```\ntox -e local-macports-standard             # uses /usr/bin/python unless configured otherwise\n```\nThere is no `/usr/bin/python` on my OS X machine, just `/usr/bin/python3`.",
    "created_at": "2022-04-15T22:56:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505846",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:100" align="right">comment:100</div>

I don't know if this part of the description is still accurate:

```
tox -e local-macports-standard             # uses /usr/bin/python unless configured otherwise
```
There is no `/usr/bin/python` on my OS X machine, just `/usr/bin/python3`.



---

archive/issue_comments_505847.json:
```json
{
    "body": "<div id=\"comment:101\" align=\"right\">comment:101</div>\n\n`tox -e local-macports-standard` just failed for me (on macOS Big Sur 11.6) with\n\n```\n--->  Applying patches to gcc10\n--->  Configuring gcc10\nWarning: Applying '--without-build-config' workaround to Xcode none / CLT 13.2.0.0.1.1638488800\nWarning: If versions > 12.5 please check if it is still required\n--->  Building gcc10                                     \nError: Failed to build gcc10: command execution failed   \nError: See /Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-standard/macports/var/macports/logs/_Users_mkoeppe_s_sage_sage-rebasing_worktree-rebase_.tox_local-macports-standard_macports_var_macports_sources_rsync.macports.org_macports_release_tarballs_ports_lang_gcc10/gcc10/main.log for details.\nError: Follow https://guide.macports.org/#project.tickets if you believe there is a bug.\nError: Processing of port gcc10 failed\n```",
    "created_at": "2022-04-16T04:56:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505847",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:101" align="right">comment:101</div>

`tox -e local-macports-standard` just failed for me (on macOS Big Sur 11.6) with

```
--->  Applying patches to gcc10
--->  Configuring gcc10
Warning: Applying '--without-build-config' workaround to Xcode none / CLT 13.2.0.0.1.1638488800
Warning: If versions > 12.5 please check if it is still required
--->  Building gcc10                                     
Error: Failed to build gcc10: command execution failed   
Error: See /Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-standard/macports/var/macports/logs/_Users_mkoeppe_s_sage_sage-rebasing_worktree-rebase_.tox_local-macports-standard_macports_var_macports_sources_rsync.macports.org_macports_release_tarballs_ports_lang_gcc10/gcc10/main.log for details.
Error: Follow https://guide.macports.org/#project.tickets if you believe there is a bug.
Error: Processing of port gcc10 failed
```



---

archive/issue_comments_505848.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,7 +9,7 @@\n or\n \n ```\n-tox -e local-macports-standard             # uses /usr/bin/python unless configured otherwise\n+tox -e local-macports-standard             # uses /usr/bin/python3\n ```\n or \n \n``````\n",
    "created_at": "2022-04-16T06:24:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505848",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,7 +9,7 @@
 or
 
 ```
-tox -e local-macports-standard             # uses /usr/bin/python unless configured otherwise
+tox -e local-macports-standard             # uses /usr/bin/python3
 ```
 or 
 
``````




---

archive/issue_comments_505849.json:
```json
{
    "body": "<div id=\"comment:103\" align=\"right\">comment:103</div>\n\nReplying to [@mkoeppe](#comment%3A101):\n> `tox -e local-macports-standard` just failed for me (on macOS Big Sur 11.6) with\n> \n> ```\n> --->  Applying patches to gcc10\n> --->  Configuring gcc10\n> Warning: Applying '--without-build-config' workaround to Xcode none / CLT 13.2.0.0.1.1638488800\n> Warning: If versions > 12.5 please check if it is still required\n> --->  Building gcc10                                     \n> Error: Failed to build gcc10: command execution failed   \n> Error: See /Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-standard/macports/var/macports/logs/_Users_mkoeppe_s_sage_sage-rebasing_worktree-rebase_.tox_local-macports-standard_macports_var_macports_sources_rsync.macports.org_macports_release_tarballs_ports_lang_gcc10/gcc10/main.log for details.\n> Error: Follow https://guide.macports.org/#project.tickets if you believe there is a bug.\n> Error: Processing of port gcc10 failed\n> ```\n\nI see the same.",
    "created_at": "2022-04-16T15:56:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505849",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:103" align="right">comment:103</div>

Replying to [@mkoeppe](#comment%3A101):
> `tox -e local-macports-standard` just failed for me (on macOS Big Sur 11.6) with
> 
> ```
> --->  Applying patches to gcc10
> --->  Configuring gcc10
> Warning: Applying '--without-build-config' workaround to Xcode none / CLT 13.2.0.0.1.1638488800
> Warning: If versions > 12.5 please check if it is still required
> --->  Building gcc10                                     
> Error: Failed to build gcc10: command execution failed   
> Error: See /Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-standard/macports/var/macports/logs/_Users_mkoeppe_s_sage_sage-rebasing_worktree-rebase_.tox_local-macports-standard_macports_var_macports_sources_rsync.macports.org_macports_release_tarballs_ports_lang_gcc10/gcc10/main.log for details.
> Error: Follow https://guide.macports.org/#project.tickets if you believe there is a bug.
> Error: Processing of port gcc10 failed
> ```

I see the same.



---

archive/issue_comments_505850.json:
```json
{
    "body": "Changed commit from **[`4bf4e45`](https://github.com/sagemath/sagetrac-mirror/commit/4bf4e4577aa070b0f3fb581e1cfad545225edb9f)** to **[`18a3946`](https://github.com/sagemath/sagetrac-mirror/commit/18a394628b793358016cad8327fa31473c9a6d72)**",
    "created_at": "2022-04-16T17:28:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505850",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4bf4e45`](https://github.com/sagemath/sagetrac-mirror/commit/4bf4e4577aa070b0f3fb581e1cfad545225edb9f)** to **[`18a3946`](https://github.com/sagemath/sagetrac-mirror/commit/18a394628b793358016cad8327fa31473c9a6d72)**



---

archive/issue_comments_505851.json:
```json
{
    "body": "<div id=\"comment:104\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8c62ded1a591888c240eed69265e9f2a70f22dfc\"><code>8c62ded</code></a></td><td><code>tox.ini (local-macports): Update macports base version to 2.7.2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/18a394628b793358016cad8327fa31473c9a6d72\"><code>18a3946</code></a></td><td><code>build/pkgs/gfortran/distros/macports.txt: Switch to gcc11</code></td></tr></table>\n",
    "created_at": "2022-04-16T17:28:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505851",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:104"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8c62ded1a591888c240eed69265e9f2a70f22dfc"><code>8c62ded</code></a></td><td><code>tox.ini (local-macports): Update macports base version to 2.7.2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/18a394628b793358016cad8327fa31473c9a6d72"><code>18a3946</code></a></td><td><code>build/pkgs/gfortran/distros/macports.txt: Switch to gcc11</code></td></tr></table>




---

archive/issue_comments_505852.json:
```json
{
    "body": "<div id=\"comment:105\" align=\"right\">comment:105</div>\n\nWith the change to gcc11, I am getting a bit farther.\n\n```\n--->  Building R\nError: Failed to build R: command execution failed       \nError: See /opt/local/var/macports/logs/_opt_local_var_macports_sources_rsync.macports.org_macports_release_tarballs_ports_math_R/R/main.log for details.\nError: Follow https://guide.macports.org/#project.tickets if you believe there is a bug.\nError: Processing of port R failed\n```\napparently because of a failure in some pdf docbuild\n\n```\n:info:build Error: compiling TeX file 'reshape.tex' failed with message:\n:info:build Running 'texi2dvi' on 'reshape.tex' failed.\n:info:build LaTeX errors:\n:info:build ! LaTeX Error: File `fancyvrb.sty' not found.\n:info:build Type X to quit or <RETURN> to proceed,\n:info:build or enter new name. (Default extension: sty)\n:info:build ! Emergency stop.\n:info:build <read *> \n:info:build          \n:info:build l.19 \\begingroup\n:info:build                 ^^M\n:info:build !  ==> Fatal error occurred, no output PDF file produced!\n:info:build Execution halted\n:info:build make[1]: *** [vignettes] Error 1\n:info:build make[1]: Leaving directory `/opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_macports_release_tarballs_ports_math_R/R/work/R-4.1.3/src/library'\n:info:build make: *** [vignettes] Error 2\n```",
    "created_at": "2022-04-16T22:57:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505852",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:105" align="right">comment:105</div>

With the change to gcc11, I am getting a bit farther.

```
--->  Building R
Error: Failed to build R: command execution failed       
Error: See /opt/local/var/macports/logs/_opt_local_var_macports_sources_rsync.macports.org_macports_release_tarballs_ports_math_R/R/main.log for details.
Error: Follow https://guide.macports.org/#project.tickets if you believe there is a bug.
Error: Processing of port R failed
```
apparently because of a failure in some pdf docbuild

```
:info:build Error: compiling TeX file 'reshape.tex' failed with message:
:info:build Running 'texi2dvi' on 'reshape.tex' failed.
:info:build LaTeX errors:
:info:build ! LaTeX Error: File `fancyvrb.sty' not found.
:info:build Type X to quit or <RETURN> to proceed,
:info:build or enter new name. (Default extension: sty)
:info:build ! Emergency stop.
:info:build <read *> 
:info:build          
:info:build l.19 \begingroup
:info:build                 ^^M
:info:build !  ==> Fatal error occurred, no output PDF file produced!
:info:build Execution halted
:info:build make[1]: *** [vignettes] Error 1
:info:build make[1]: Leaving directory `/opt/local/var/macports/build/_opt_local_var_macports_sources_rsync.macports.org_macports_release_tarballs_ports_math_R/R/work/R-4.1.3/src/library'
:info:build make: *** [vignettes] Error 2
```



---

archive/issue_comments_505853.json:
```json
{
    "body": "<div id=\"comment:106\" align=\"right\">comment:106</div>\n\nI see\n\n```\nWarning: texlive-bin installs files outside the common directory structure.\n--->  Installing texlive-bin @2022.62882_0+x11\n--->  Activating texlive-bin @2022.62882_0+x11\nError: Failed to activate texlive-bin: can't create directory \"/Library/TeX/Distributions/.FactoryDefaults/MacPorts-Users_palmieri_Desktop_Sage_sage_builds_TESTING_sage-9.6.rc0_.tox_local-macports-standard_macports-TeXLive\": permission denied\nError: See /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.6.rc0/.tox/local-macports-standard/macports/var/macports/logs/_Users_palmieri_Desktop_Sage_sage_builds_TESTING_sage-9.6.rc0_.tox_local-macports-standard_macports_var_macports_sources_rsync.macports.org_macports_release_tarballs_ports_tex_texlive-bin/texlive-bin/main.log for details.\nError: Follow https://guide.macports.org/#project.tickets if you believe there is a bug.\nError: Processing of port R failed\n```\nI don't like the idea of this trying to install anything in `/Library`, and that looks like a problem.",
    "created_at": "2022-04-17T01:59:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505853",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:106" align="right">comment:106</div>

I see

```
Warning: texlive-bin installs files outside the common directory structure.
--->  Installing texlive-bin @2022.62882_0+x11
--->  Activating texlive-bin @2022.62882_0+x11
Error: Failed to activate texlive-bin: can't create directory "/Library/TeX/Distributions/.FactoryDefaults/MacPorts-Users_palmieri_Desktop_Sage_sage_builds_TESTING_sage-9.6.rc0_.tox_local-macports-standard_macports-TeXLive": permission denied
Error: See /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.6.rc0/.tox/local-macports-standard/macports/var/macports/logs/_Users_palmieri_Desktop_Sage_sage_builds_TESTING_sage-9.6.rc0_.tox_local-macports-standard_macports_var_macports_sources_rsync.macports.org_macports_release_tarballs_ports_tex_texlive-bin/texlive-bin/main.log for details.
Error: Follow https://guide.macports.org/#project.tickets if you believe there is a bug.
Error: Processing of port R failed
```
I don't like the idea of this trying to install anything in `/Library`, and that looks like a problem.



---

archive/issue_comments_505854.json:
```json
{
    "body": "<div id=\"comment:107\" align=\"right\">comment:107</div>\n\nYes, it looks like not all packages are prepared for installation in a custom prefix.\n\nI've tried installing in the default prefix (`/opt/local`) with sudo (that's `tox -e local-macports-optlocal-standard`), and installation of texlive went through without error. Just did `sudo /opt/local/bin/port install texlive-latex-extra` to get some of the missing files.",
    "created_at": "2022-04-17T02:47:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505854",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:107" align="right">comment:107</div>

Yes, it looks like not all packages are prepared for installation in a custom prefix.

I've tried installing in the default prefix (`/opt/local`) with sudo (that's `tox -e local-macports-optlocal-standard`), and installation of texlive went through without error. Just did `sudo /opt/local/bin/port install texlive-latex-extra` to get some of the missing files.



---

archive/issue_comments_505855.json:
```json
{
    "body": "Upstream: **Not yet reported upstream; Will do shortly.**",
    "created_at": "2022-04-17T03:11:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505855",
    "user": "https://github.com/mkoeppe"
}
```

Upstream: **Not yet reported upstream; Will do shortly.**



---

archive/issue_comments_505856.json:
```json
{
    "body": "Changed commit from **[`18a3946`](https://github.com/sagemath/sagetrac-mirror/commit/18a394628b793358016cad8327fa31473c9a6d72)** to **[`7ab30b4`](https://github.com/sagemath/sagetrac-mirror/commit/7ab30b4dad469b6f15438148f689252c640ac6d9)**",
    "created_at": "2022-04-17T06:08:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505856",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`18a3946`](https://github.com/sagemath/sagetrac-mirror/commit/18a394628b793358016cad8327fa31473c9a6d72)** to **[`7ab30b4`](https://github.com/sagemath/sagetrac-mirror/commit/7ab30b4dad469b6f15438148f689252c640ac6d9)**



---

archive/issue_comments_505857.json:
```json
{
    "body": "<div id=\"comment:109\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7ab30b4dad469b6f15438148f689252c640ac6d9\"><code>7ab30b4</code></a></td><td><code>tox.ini (macports): By default use FC=gfortran-mp-11</code></td></tr></table>\n",
    "created_at": "2022-04-17T06:08:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505857",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:109"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7ab30b4dad469b6f15438148f689252c640ac6d9"><code>7ab30b4</code></a></td><td><code>tox.ini (macports): By default use FC=gfortran-mp-11</code></td></tr></table>




---

archive/issue_comments_505858.json:
```json
{
    "body": "<div id=\"comment:110\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b91993318a58e73ace783a838b171b1f8208c9c0\"><code>b919933</code></a></td><td><code>build/bin/sage-print-system-package-command (macports): Also update to gcc11 here</code></td></tr></table>\n",
    "created_at": "2022-04-17T06:13:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505858",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:110"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b91993318a58e73ace783a838b171b1f8208c9c0"><code>b919933</code></a></td><td><code>build/bin/sage-print-system-package-command (macports): Also update to gcc11 here</code></td></tr></table>




---

archive/issue_comments_505859.json:
```json
{
    "body": "Changed commit from **[`7ab30b4`](https://github.com/sagemath/sagetrac-mirror/commit/7ab30b4dad469b6f15438148f689252c640ac6d9)** to **[`b919933`](https://github.com/sagemath/sagetrac-mirror/commit/b91993318a58e73ace783a838b171b1f8208c9c0)**",
    "created_at": "2022-04-17T06:13:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505859",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7ab30b4`](https://github.com/sagemath/sagetrac-mirror/commit/7ab30b4dad469b6f15438148f689252c640ac6d9)** to **[`b919933`](https://github.com/sagemath/sagetrac-mirror/commit/b91993318a58e73ace783a838b171b1f8208c9c0)**



---

archive/issue_comments_505860.json:
```json
{
    "body": "<div id=\"comment:111\" align=\"right\">comment:111</div>\n\nThis gets me to the Sage distribution build. Next error: `rpy2` fails\n\n```\n  gcc -bundle -undefined dynamic_lookup -Wl,-headerpad,0x1000 -L/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -Wl,-rpath,/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -L/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -Wl,-rpath,/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -g -O2 build/temp.macosx-10.14-x86_64-3.8/build/temp.macosx-10.14-x86_64-3.8/_rinterface_cffi_api.o -L/opt/local/lib -L/opt/local/lib -lpcre2-8 -llzma -lbz2 -lz -ldl -lm -liconv -licuuc -licui18n -o build/lib.macosx-10.14-x86_64-3.8/_rinterface_cffi_api.abi3.so -fopenmp -Wl,-headerpad_max_install_names -Wl,-syslibroot,/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch x86_64 -F/opt/local/Library/Frameworks/R.framework/.. -framework R\n  clang: error: unsupported option '-fopenmp'\n```",
    "created_at": "2022-04-17T06:38:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505860",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:111" align="right">comment:111</div>

This gets me to the Sage distribution build. Next error: `rpy2` fails

```
  gcc -bundle -undefined dynamic_lookup -Wl,-headerpad,0x1000 -L/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -Wl,-rpath,/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -L/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -Wl,-rpath,/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -g -O2 build/temp.macosx-10.14-x86_64-3.8/build/temp.macosx-10.14-x86_64-3.8/_rinterface_cffi_api.o -L/opt/local/lib -L/opt/local/lib -lpcre2-8 -llzma -lbz2 -lz -ldl -lm -liconv -licuuc -licui18n -o build/lib.macosx-10.14-x86_64-3.8/_rinterface_cffi_api.abi3.so -fopenmp -Wl,-headerpad_max_install_names -Wl,-syslibroot,/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch x86_64 -F/opt/local/Library/Frameworks/R.framework/.. -framework R
  clang: error: unsupported option '-fopenmp'
```



---

archive/issue_comments_505861.json:
```json
{
    "body": "<div id=\"comment:112\" align=\"right\">comment:112</div>\n\nAlso `sagelib` fails\n\n```\n4 warnings generated.\nld: illegal data reference in _avma to thread local variable _avma in dylib /Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib/libpari.dylib for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nerror: Command \"gcc -bundle -undefined dynamic_lookup -Wl,-headerpad,0x1000 -L/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -Wl,-rpath,/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -g -O2 build/temp.macosx-10.14-x86_64-3.8/build/cythonized/sage/libs/pari/convert_sage_complex_double.o -L/opt/local/lib -lgsl -lpari -lgmp -lm -lopenblas -o build/lib.macosx-10.14-x86_64-3.8/sage/libs/pari/convert_sage_complex_double.cpython-38-darwin.so -lpari\" failed with exit status 1\n```",
    "created_at": "2022-04-17T07:24:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505861",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:112" align="right">comment:112</div>

Also `sagelib` fails

```
4 warnings generated.
ld: illegal data reference in _avma to thread local variable _avma in dylib /Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib/libpari.dylib for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
error: Command "gcc -bundle -undefined dynamic_lookup -Wl,-headerpad,0x1000 -L/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -Wl,-rpath,/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -g -O2 build/temp.macosx-10.14-x86_64-3.8/build/cythonized/sage/libs/pari/convert_sage_complex_double.o -L/opt/local/lib -lgsl -lpari -lgmp -lm -lopenblas -o build/lib.macosx-10.14-x86_64-3.8/sage/libs/pari/convert_sage_complex_double.cpython-38-darwin.so -lpari" failed with exit status 1
```



---

archive/issue_comments_505862.json:
```json
{
    "body": "<div id=\"comment:113\" align=\"right\">comment:113</div>\n\nWith `tox -e local-macports-minimal`, `gfortran` fails. This unfortunately happens on this machine with ordinary Sage if I use `./configure --with-system-gfortran=no` with the error message\n\n```\nError: configuring for an unreleased macOS version x86_64-apple-darwin21.4.0\n```\nI don't know why this is called \"unreleased\".",
    "created_at": "2022-04-18T17:53:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505862",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:113" align="right">comment:113</div>

With `tox -e local-macports-minimal`, `gfortran` fails. This unfortunately happens on this machine with ordinary Sage if I use `./configure --with-system-gfortran=no` with the error message

```
Error: configuring for an unreleased macOS version x86_64-apple-darwin21.4.0
```
I don't know why this is called "unreleased".



---

archive/issue_comments_505863.json:
```json
{
    "body": "<div id=\"comment:114\" align=\"right\">comment:114</div>\n\nI guess our gcc/gfortran package is just too old. \n\nUnfortunately we don't see this on our GH Actions because there are no macOS 12 runners yet. Apparently one can request access - https://github.community/t/macos-12-runner-not-available/242185/9",
    "created_at": "2022-04-18T18:04:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505863",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:114" align="right">comment:114</div>

I guess our gcc/gfortran package is just too old. 

Unfortunately we don't see this on our GH Actions because there are no macOS 12 runners yet. Apparently one can request access - https://github.community/t/macos-12-runner-not-available/242185/9



---

archive/issue_comments_505864.json:
```json
{
    "body": "<div id=\"comment:115\" align=\"right\">comment:115</div>\n\nI've requested access to the macOS 12 runners for the `sagemath` GH organization.",
    "created_at": "2022-04-18T18:16:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505864",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:115" align="right">comment:115</div>

I've requested access to the macOS 12 runners for the `sagemath` GH organization.



---

archive/issue_comments_505865.json:
```json
{
    "body": "<div id=\"comment:116\" align=\"right\">comment:116</div>\n\nReplying to [@mkoeppe](#comment%3A111):\n> This gets me to the Sage distribution build. Next error: `rpy2` fails\n> \n> ```\n>   gcc -bundle -undefined dynamic_lookup -Wl,-headerpad,0x1000 -L/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -Wl,-rpath,/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -L/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -Wl,-rpath,/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -g -O2 build/temp.macosx-10.14-x86_64-3.8/build/temp.macosx-10.14-x86_64-3.8/_rinterface_cffi_api.o -L/opt/local/lib -L/opt/local/lib -lpcre2-8 -llzma -lbz2 -lz -ldl -lm -liconv -licuuc -licui18n -o build/lib.macosx-10.14-x86_64-3.8/_rinterface_cffi_api.abi3.so -fopenmp -Wl,-headerpad_max_install_names -Wl,-syslibroot,/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch x86_64 -F/opt/local/Library/Frameworks/R.framework/.. -framework R\n>   clang: error: unsupported option '-fopenmp'\n> ```\n\nThis compiler flag comes from the configuration of the macports-provided R.\n\n```\n(sage-buildsh) mkoeppe@egret:src$ /opt/local/bin/R CMD config --cppflags\n-I/opt/local/Library/Frameworks/R.framework/Resources/include\n(sage-buildsh) mkoeppe@egret:src$ /opt/local/bin/R CMD config --ldflags\n-fopenmp -L/opt/local/lib -Wl,-headerpad_max_install_names -Wl,-syslibroot,/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch x86_64 -F/opt/local/Library/Frameworks/R.framework/.. -framework R -L/opt/local/lib -lpcre2-8 -llzma -lbz2 -lz -ldl -lm -liconv -licuuc -licui18n\n(sage-buildsh) mkoeppe@egret:src$ /opt/local/bin/R CMD config CC\n/opt/local/bin/clang-mp-13\n```",
    "created_at": "2022-04-20T03:52:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505865",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:116" align="right">comment:116</div>

Replying to [@mkoeppe](#comment%3A111):
> This gets me to the Sage distribution build. Next error: `rpy2` fails
> 
> ```
>   gcc -bundle -undefined dynamic_lookup -Wl,-headerpad,0x1000 -L/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -Wl,-rpath,/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -L/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -Wl,-rpath,/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/.tox/local-macports-optlocal-standard/local/lib -g -O2 build/temp.macosx-10.14-x86_64-3.8/build/temp.macosx-10.14-x86_64-3.8/_rinterface_cffi_api.o -L/opt/local/lib -L/opt/local/lib -lpcre2-8 -llzma -lbz2 -lz -ldl -lm -liconv -licuuc -licui18n -o build/lib.macosx-10.14-x86_64-3.8/_rinterface_cffi_api.abi3.so -fopenmp -Wl,-headerpad_max_install_names -Wl,-syslibroot,/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch x86_64 -F/opt/local/Library/Frameworks/R.framework/.. -framework R
>   clang: error: unsupported option '-fopenmp'
> ```

This compiler flag comes from the configuration of the macports-provided R.

```
(sage-buildsh) mkoeppe@egret:src$ /opt/local/bin/R CMD config --cppflags
-I/opt/local/Library/Frameworks/R.framework/Resources/include
(sage-buildsh) mkoeppe@egret:src$ /opt/local/bin/R CMD config --ldflags
-fopenmp -L/opt/local/lib -Wl,-headerpad_max_install_names -Wl,-syslibroot,/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch x86_64 -F/opt/local/Library/Frameworks/R.framework/.. -framework R -L/opt/local/lib -lpcre2-8 -llzma -lbz2 -lz -ldl -lm -liconv -licuuc -licui18n
(sage-buildsh) mkoeppe@egret:src$ /opt/local/bin/R CMD config CC
/opt/local/bin/clang-mp-13
```



---

archive/issue_comments_505866.json:
```json
{
    "body": "<div id=\"comment:117\" align=\"right\">comment:117</div>\n\nReplying to [@jhpalmieri](#comment%3A113):\n> `gfortran` fails. This unfortunately happens on this machine with ordinary Sage if I use `./configure --with-system-gfortran=no` with the error message\n> \n> ```\n> Error: configuring for an unreleased macOS version x86_64-apple-darwin21.4.0\n> ```\n\nI've opened #33750 for the upgrade of gcc/gfortran",
    "created_at": "2022-04-24T05:23:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505866",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:117" align="right">comment:117</div>

Replying to [@jhpalmieri](#comment%3A113):
> `gfortran` fails. This unfortunately happens on this machine with ordinary Sage if I use `./configure --with-system-gfortran=no` with the error message
> 
> ```
> Error: configuring for an unreleased macOS version x86_64-apple-darwin21.4.0
> ```

I've opened #33750 for the upgrade of gcc/gfortran



---

archive/issue_comments_505867.json:
```json
{
    "body": "<div id=\"comment:118\" align=\"right\">comment:118</div>\n\nWith 9.6.rc3 + this ticket, `tox -e local-macports-minimal` more or less worked for me: the first time through it hung, but then I hit ctrl-c and ran it again, and it finished. `tox -e local-macports-standard` did not work.",
    "created_at": "2022-05-01T02:51:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505867",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:118" align="right">comment:118</div>

With 9.6.rc3 + this ticket, `tox -e local-macports-minimal` more or less worked for me: the first time through it hung, but then I hit ctrl-c and ran it again, and it finished. `tox -e local-macports-standard` did not work.



---

archive/issue_comments_505868.json:
```json
{
    "body": "<div id=\"comment:119\" align=\"right\">comment:119</div>\n\nRunning `tox -e local-macports-standard` ends with:\n\n```\n--->  Computing dependencies for gd2\n--->  Dependencies to be installed: fontconfig freetype brotli cmake curl libheif aom git gdk-pixbuf2 gobject-introspection cairo libjpeg-turbo tiff lerc rav1e cargo cargo-bootstrap rust libgit2 cargo-c x265 webp\nError: The following dependencies were not installed because all of them have unmet dependencies (likely due to a dependency cycle): fontconfig freetype brotli cmake curl libheif aom git gdk-pixbuf2 gobject-introspection cairo libjpeg-turbo tiff lerc rav1e cargo cargo-bootstrap rust libgit2 cargo-c x265 webp\nError: Follow https://guide.macports.org/#project.tickets if you believe there is a bug.\nError: Processing of port gd2 failed\nERROR: InvocationError for command /bin/bash -c 'case \"\" in 1|y*|Y*);; *)  port selfupdate &&  port upgrade outdated && PACKAGES=$(build/bin/sage-get-system-packages macports $(PATH=build/bin:$PATH build/bin/sage-package list --has-file=spkg-configure.m4 :standard:) _bootstrap    ); eval $(build/bin/sage-print-system-package-command macports  --yes --no-install-recommends install $PACKAGES) || [ \"$IGNORE_MISSING_SYSTEM_PACKAGES\" = yes ] && echo \"(ignoring errors)\" ;; esac' (exited with code 1)\n________________________________________ summary _________________________________________\nERROR:   local-macports-standard: commands failed\n```",
    "created_at": "2022-05-01T03:46:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505868",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:119" align="right">comment:119</div>

Running `tox -e local-macports-standard` ends with:

```
--->  Computing dependencies for gd2
--->  Dependencies to be installed: fontconfig freetype brotli cmake curl libheif aom git gdk-pixbuf2 gobject-introspection cairo libjpeg-turbo tiff lerc rav1e cargo cargo-bootstrap rust libgit2 cargo-c x265 webp
Error: The following dependencies were not installed because all of them have unmet dependencies (likely due to a dependency cycle): fontconfig freetype brotli cmake curl libheif aom git gdk-pixbuf2 gobject-introspection cairo libjpeg-turbo tiff lerc rav1e cargo cargo-bootstrap rust libgit2 cargo-c x265 webp
Error: Follow https://guide.macports.org/#project.tickets if you believe there is a bug.
Error: Processing of port gd2 failed
ERROR: InvocationError for command /bin/bash -c 'case "" in 1|y*|Y*);; *)  port selfupdate &&  port upgrade outdated && PACKAGES=$(build/bin/sage-get-system-packages macports $(PATH=build/bin:$PATH build/bin/sage-package list --has-file=spkg-configure.m4 :standard:) _bootstrap    ); eval $(build/bin/sage-print-system-package-command macports  --yes --no-install-recommends install $PACKAGES) || [ "$IGNORE_MISSING_SYSTEM_PACKAGES" = yes ] && echo "(ignoring errors)" ;; esac' (exited with code 1)
________________________________________ summary _________________________________________
ERROR:   local-macports-standard: commands failed
```



---

archive/issue_comments_505869.json:
```json
{
    "body": "<div id=\"comment:120\" align=\"right\">comment:120</div>\n\nI removed `/opt/local` after the upgrade to macOS Monterey, and `tox -e local-macports-optlocal-minimal` did a fresh installation of macports. The build succeeded.",
    "created_at": "2022-05-01T05:45:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505869",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:120" align="right">comment:120</div>

I removed `/opt/local` after the upgrade to macOS Monterey, and `tox -e local-macports-optlocal-minimal` did a fresh installation of macports. The build succeeded.



---

archive/issue_comments_505870.json:
```json
{
    "body": "Changed commit from **[`b919933`](https://github.com/sagemath/sagetrac-mirror/commit/b91993318a58e73ace783a838b171b1f8208c9c0)** to **[`6544ae2`](https://github.com/sagemath/sagetrac-mirror/commit/6544ae26b0acdf0a24f411c80dc75a25a2e3b760)**",
    "created_at": "2022-05-01T05:59:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505870",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b919933`](https://github.com/sagemath/sagetrac-mirror/commit/b91993318a58e73ace783a838b171b1f8208c9c0)** to **[`6544ae2`](https://github.com/sagemath/sagetrac-mirror/commit/6544ae26b0acdf0a24f411c80dc75a25a2e3b760)**



---

archive/issue_comments_505871.json:
```json
{
    "body": "<div id=\"comment:121\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><code>[9b63cdb](https://github.com/sagemath/sagetrac-mirror/commit/9b63cdb3fd67dcdc6a1a14af45e5b1e054b1bf7f)</code></td><td><code>`tox.ini: Add configuration factors macports-python{3.8,3.9`}</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c0cfbbfa319edd80ec741aea7ed57b502dc10bda\"><code>c0cfbbf</code></a></td><td><code>build/bin/sage-print-system-package-command (macports): Recommend FC as configure arg, not environment variable</code></td></tr><tr><td><code>[1c99ba2](https://github.com/sagemath/sagetrac-mirror/commit/1c99ba29a3f34ccad5780dfb5488c625eee9311a)</code></td><td><code>`tox.ini (macports): Pass FC as configure argument; add variants macports-gcc_{spkg,9,10,11`}</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b36b306ee46ec3031e781fed9cbeed9750885e7\"><code>8b36b30</code></a></td><td><code>tox.ini (macports): Fix up use of ALL_EXTRA_SAGE_PACKAGES</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/59429239c6d4085f0ddce6aba569608a11e307e0\"><code>5942923</code></a></td><td><code>tox.ini (local-macports): Update macports base version to 2.7.2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5e97276259e7302f72fd2e0d9d2956e8bff56b59\"><code>5e97276</code></a></td><td><code>build/pkgs/gfortran/distros/macports.txt: Switch to gcc11</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9fedf397fdf8935c4251e4f36a466448fabf9303\"><code>9fedf39</code></a></td><td><code>tox.ini (macports): By default use FC=gfortran-mp-11</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ead351529f76de74243afc1032fa2dec95c3d2d8\"><code>ead3515</code></a></td><td><code>build/bin/sage-print-system-package-command (macports): Also update to gcc11 here</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/336cd17e3ec289a7176417012a6370089fb418d4\"><code>336cd17</code></a></td><td><code>WIP</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6544ae26b0acdf0a24f411c80dc75a25a2e3b760\"><code>6544ae2</code></a></td><td><code>tox.ini (macports): Remove variants that tried to use real gcc</code></td></tr></table>\n",
    "created_at": "2022-05-01T05:59:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505871",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:121"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><code>[9b63cdb](https://github.com/sagemath/sagetrac-mirror/commit/9b63cdb3fd67dcdc6a1a14af45e5b1e054b1bf7f)</code></td><td><code>`tox.ini: Add configuration factors macports-python{3.8,3.9`}</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c0cfbbfa319edd80ec741aea7ed57b502dc10bda"><code>c0cfbbf</code></a></td><td><code>build/bin/sage-print-system-package-command (macports): Recommend FC as configure arg, not environment variable</code></td></tr><tr><td><code>[1c99ba2](https://github.com/sagemath/sagetrac-mirror/commit/1c99ba29a3f34ccad5780dfb5488c625eee9311a)</code></td><td><code>`tox.ini (macports): Pass FC as configure argument; add variants macports-gcc_{spkg,9,10,11`}</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b36b306ee46ec3031e781fed9cbeed9750885e7"><code>8b36b30</code></a></td><td><code>tox.ini (macports): Fix up use of ALL_EXTRA_SAGE_PACKAGES</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/59429239c6d4085f0ddce6aba569608a11e307e0"><code>5942923</code></a></td><td><code>tox.ini (local-macports): Update macports base version to 2.7.2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5e97276259e7302f72fd2e0d9d2956e8bff56b59"><code>5e97276</code></a></td><td><code>build/pkgs/gfortran/distros/macports.txt: Switch to gcc11</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9fedf397fdf8935c4251e4f36a466448fabf9303"><code>9fedf39</code></a></td><td><code>tox.ini (macports): By default use FC=gfortran-mp-11</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ead351529f76de74243afc1032fa2dec95c3d2d8"><code>ead3515</code></a></td><td><code>build/bin/sage-print-system-package-command (macports): Also update to gcc11 here</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/336cd17e3ec289a7176417012a6370089fb418d4"><code>336cd17</code></a></td><td><code>WIP</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6544ae26b0acdf0a24f411c80dc75a25a2e3b760"><code>6544ae2</code></a></td><td><code>tox.ini (macports): Remove variants that tried to use real gcc</code></td></tr></table>




---

archive/issue_comments_505872.json:
```json
{
    "body": "<div id=\"comment:122\" align=\"right\">comment:122</div>\n\n(That's after rebasing on 9.6rc3)",
    "created_at": "2022-05-01T05:59:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505872",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:122" align="right">comment:122</div>

(That's after rebasing on 9.6rc3)



---

archive/issue_comments_505873.json:
```json
{
    "body": "<div id=\"comment:123\" align=\"right\">comment:123</div>\n\nReplying to [@jhpalmieri](#comment%3A119):\n> Running `tox -e local-macports-standard` ends with:\n> \n> ```\n> --->  Computing dependencies for gd2\n> --->  Dependencies to be installed: fontconfig freetype brotli cmake curl libheif aom git gdk-pixbuf2 gobject-introspection cairo libjpeg-turbo tiff lerc rav1e cargo cargo-bootstrap rust libgit2 cargo-c x265 webp\n> ```\n\nI'm getting the same error with `tox -e local-macports-optlocal-standard`.",
    "created_at": "2022-05-01T07:42:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505873",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:123" align="right">comment:123</div>

Replying to [@jhpalmieri](#comment%3A119):
> Running `tox -e local-macports-standard` ends with:
> 
> ```
> --->  Computing dependencies for gd2
> --->  Dependencies to be installed: fontconfig freetype brotli cmake curl libheif aom git gdk-pixbuf2 gobject-introspection cairo libjpeg-turbo tiff lerc rav1e cargo cargo-bootstrap rust libgit2 cargo-c x265 webp
> ```

I'm getting the same error with `tox -e local-macports-optlocal-standard`.



---

archive/issue_comments_505874.json:
```json
{
    "body": "Changed commit from **[`6544ae2`](https://github.com/sagemath/sagetrac-mirror/commit/6544ae26b0acdf0a24f411c80dc75a25a2e3b760)** to **[`27eff2b`](https://github.com/sagemath/sagetrac-mirror/commit/27eff2ba095a385db8ab70434e1a4f8661bc6295)**",
    "created_at": "2022-05-01T07:44:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505874",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6544ae2`](https://github.com/sagemath/sagetrac-mirror/commit/6544ae26b0acdf0a24f411c80dc75a25a2e3b760)** to **[`27eff2b`](https://github.com/sagemath/sagetrac-mirror/commit/27eff2ba095a385db8ab70434e1a4f8661bc6295)**



---

archive/issue_comments_505875.json:
```json
{
    "body": "<div id=\"comment:124\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/27eff2ba095a385db8ab70434e1a4f8661bc6295\"><code>27eff2b</code></a></td><td><code>build/pkgs/libgd/distros/macports.txt: Disable</code></td></tr></table>\n",
    "created_at": "2022-05-01T07:44:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505875",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:124"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/27eff2ba095a385db8ab70434e1a4f8661bc6295"><code>27eff2b</code></a></td><td><code>build/pkgs/libgd/distros/macports.txt: Disable</code></td></tr></table>




---

archive/issue_comments_505876.json:
```json
{
    "body": "<div id=\"comment:125\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6cd79f10c19a26175cdb8b16fe30e52b9e827d0\"><code>c6cd79f</code></a></td><td><code>build/pkgs/python3/distros/macports.txt: Use python310</code></td></tr></table>\n",
    "created_at": "2022-05-01T07:50:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505876",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:125"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6cd79f10c19a26175cdb8b16fe30e52b9e827d0"><code>c6cd79f</code></a></td><td><code>build/pkgs/python3/distros/macports.txt: Use python310</code></td></tr></table>




---

archive/issue_comments_505877.json:
```json
{
    "body": "Changed commit from **[`27eff2b`](https://github.com/sagemath/sagetrac-mirror/commit/27eff2ba095a385db8ab70434e1a4f8661bc6295)** to **[`c6cd79f`](https://github.com/sagemath/sagetrac-mirror/commit/c6cd79f10c19a26175cdb8b16fe30e52b9e827d0)**",
    "created_at": "2022-05-01T07:50:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505877",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`27eff2b`](https://github.com/sagemath/sagetrac-mirror/commit/27eff2ba095a385db8ab70434e1a4f8661bc6295)** to **[`c6cd79f`](https://github.com/sagemath/sagetrac-mirror/commit/c6cd79f10c19a26175cdb8b16fe30e52b9e827d0)**



---

archive/issue_comments_505878.json:
```json
{
    "body": "<div id=\"comment:126\" align=\"right\">comment:126</div>\n\nNow it ends with `Error: The following dependencies were not installed because all of them have unmet dependencies (likely due to a dependency cycle): curl brotli cmake`",
    "created_at": "2022-05-01T16:18:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505878",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:126" align="right">comment:126</div>

Now it ends with `Error: The following dependencies were not installed because all of them have unmet dependencies (likely due to a dependency cycle): curl brotli cmake`



---

archive/issue_comments_505879.json:
```json
{
    "body": "<div id=\"comment:127\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a9094850ec0c9b206a224871401a5d6eb33a6962\"><code>a909485</code></a></td><td><code>Disable more broken macports packages</code></td></tr></table>\n",
    "created_at": "2022-05-01T16:39:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505879",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:127"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a9094850ec0c9b206a224871401a5d6eb33a6962"><code>a909485</code></a></td><td><code>Disable more broken macports packages</code></td></tr></table>




---

archive/issue_comments_505880.json:
```json
{
    "body": "Changed commit from **[`c6cd79f`](https://github.com/sagemath/sagetrac-mirror/commit/c6cd79f10c19a26175cdb8b16fe30e52b9e827d0)** to **[`a909485`](https://github.com/sagemath/sagetrac-mirror/commit/a9094850ec0c9b206a224871401a5d6eb33a6962)**",
    "created_at": "2022-05-01T16:39:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505880",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c6cd79f`](https://github.com/sagemath/sagetrac-mirror/commit/c6cd79f10c19a26175cdb8b16fe30e52b9e827d0)** to **[`a909485`](https://github.com/sagemath/sagetrac-mirror/commit/a9094850ec0c9b206a224871401a5d6eb33a6962)**



---

archive/issue_comments_505881.json:
```json
{
    "body": "Changed commit from **[`a909485`](https://github.com/sagemath/sagetrac-mirror/commit/a9094850ec0c9b206a224871401a5d6eb33a6962)** to **[`99feb0d`](https://github.com/sagemath/sagetrac-mirror/commit/99feb0db45fac76f048c56b8cb083442b99cb1b6)**",
    "created_at": "2022-05-01T17:18:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505881",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a909485`](https://github.com/sagemath/sagetrac-mirror/commit/a9094850ec0c9b206a224871401a5d6eb33a6962)** to **[`99feb0d`](https://github.com/sagemath/sagetrac-mirror/commit/99feb0db45fac76f048c56b8cb083442b99cb1b6)**



---

archive/issue_comments_505882.json:
```json
{
    "body": "<div id=\"comment:128\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/99feb0db45fac76f048c56b8cb083442b99cb1b6\"><code>99feb0d</code></a></td><td><code>Disable more broken macports packages</code></td></tr></table>\n",
    "created_at": "2022-05-01T17:18:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505882",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:128"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/99feb0db45fac76f048c56b8cb083442b99cb1b6"><code>99feb0d</code></a></td><td><code>Disable more broken macports packages</code></td></tr></table>




---

archive/issue_comments_505883.json:
```json
{
    "body": "Changed commit from **[`99feb0d`](https://github.com/sagemath/sagetrac-mirror/commit/99feb0db45fac76f048c56b8cb083442b99cb1b6)** to **[`7a2d875`](https://github.com/sagemath/sagetrac-mirror/commit/7a2d87519020f7ce44dc74ab74784b12246d73fb)**",
    "created_at": "2022-05-01T17:46:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505883",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`99feb0d`](https://github.com/sagemath/sagetrac-mirror/commit/99feb0db45fac76f048c56b8cb083442b99cb1b6)** to **[`7a2d875`](https://github.com/sagemath/sagetrac-mirror/commit/7a2d87519020f7ce44dc74ab74784b12246d73fb)**



---

archive/issue_comments_505884.json:
```json
{
    "body": "<div id=\"comment:129\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7a2d87519020f7ce44dc74ab74784b12246d73fb\"><code>7a2d875</code></a></td><td><code>Disable more broken macports packages</code></td></tr></table>\n",
    "created_at": "2022-05-01T17:46:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505884",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:129"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7a2d87519020f7ce44dc74ab74784b12246d73fb"><code>7a2d875</code></a></td><td><code>Disable more broken macports packages</code></td></tr></table>




---

archive/issue_comments_505885.json:
```json
{
    "body": "Changed commit from **[`7a2d875`](https://github.com/sagemath/sagetrac-mirror/commit/7a2d87519020f7ce44dc74ab74784b12246d73fb)** to **[`1fcbecf`](https://github.com/sagemath/sagetrac-mirror/commit/1fcbecf1893fb400a73eb9c55363a47b787ea4f0)**",
    "created_at": "2022-05-01T19:35:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505885",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7a2d875`](https://github.com/sagemath/sagetrac-mirror/commit/7a2d87519020f7ce44dc74ab74784b12246d73fb)** to **[`1fcbecf`](https://github.com/sagemath/sagetrac-mirror/commit/1fcbecf1893fb400a73eb9c55363a47b787ea4f0)**



---

archive/issue_comments_505886.json:
```json
{
    "body": "<div id=\"comment:130\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1fcbecf1893fb400a73eb9c55363a47b787ea4f0\"><code>1fcbecf</code></a></td><td><code>Disable more broken macports packages</code></td></tr></table>\n",
    "created_at": "2022-05-01T19:35:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505886",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:130"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1fcbecf1893fb400a73eb9c55363a47b787ea4f0"><code>1fcbecf</code></a></td><td><code>Disable more broken macports packages</code></td></tr></table>




---

archive/issue_comments_505887.json:
```json
{
    "body": "<div id=\"comment:131\" align=\"right\">comment:131</div>\n\nNow all packages that run into the issue with `cmake` appear to be disabled. Macports package installation finished without error now.",
    "created_at": "2022-05-01T19:36:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505887",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:131" align="right">comment:131</div>

Now all packages that run into the issue with `cmake` appear to be disabled. Macports package installation finished without error now.



---

archive/issue_comments_505888.json:
```json
{
    "body": "<div id=\"comment:132\" align=\"right\">comment:132</div>\n\nThere are a few installation notes\n\n```\n  gpatch has the following notes:\n    The patch tool provided by this port is prefixed with the character 'g' by default making it available as 'gpatch'.\n    \n    If you want to use 'patch' and other GNU coreutils by default, add this directory to the front of your PATH environment variable:\n        /opt/local/libexec/gnubin/\n\n  py310-tox has the following notes:\n    To make the Python 3.10 version of tox the one that is run when you execute the commands without a version suffix, e.g. 'tox', run:\n    \n    port select --set tox tox310\n  py310-virtualenv has the following notes:\n    The executable is installed as '/opt/local/bin/virtualenv-3.10'. To symlink it to '/opt/local/bin/virtualenv', run:\n    \n        sudo port select --set virtualenv virtualenv310\n  python310 has the following notes:\n    To make this the default Python or Python 3 (i.e., the version run by the 'python' or 'python3' commands), run one or both of:\n    \n        sudo port select --set python python310\n        sudo port select --set python3 python310\n```\n\nIn particular, `tox -e local-macports-optlocal-standard` uses `/usr/bin/python3` as the python.",
    "created_at": "2022-05-01T20:24:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505888",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:132" align="right">comment:132</div>

There are a few installation notes

```
  gpatch has the following notes:
    The patch tool provided by this port is prefixed with the character 'g' by default making it available as 'gpatch'.
    
    If you want to use 'patch' and other GNU coreutils by default, add this directory to the front of your PATH environment variable:
        /opt/local/libexec/gnubin/

  py310-tox has the following notes:
    To make the Python 3.10 version of tox the one that is run when you execute the commands without a version suffix, e.g. 'tox', run:
    
    port select --set tox tox310
  py310-virtualenv has the following notes:
    The executable is installed as '/opt/local/bin/virtualenv-3.10'. To symlink it to '/opt/local/bin/virtualenv', run:
    
        sudo port select --set virtualenv virtualenv310
  python310 has the following notes:
    To make this the default Python or Python 3 (i.e., the version run by the 'python' or 'python3' commands), run one or both of:
    
        sudo port select --set python python310
        sudo port select --set python3 python310
```

In particular, `tox -e local-macports-optlocal-standard` uses `/usr/bin/python3` as the python.



---

archive/issue_comments_505889.json:
```json
{
    "body": "<div id=\"comment:133\" align=\"right\">comment:133</div>\n\n`tox -e local-macports-optlocal-standard` succeeds.",
    "created_at": "2022-05-01T22:17:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505889",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:133" align="right">comment:133</div>

`tox -e local-macports-optlocal-standard` succeeds.



---

archive/issue_comments_505890.json:
```json
{
    "body": "<div id=\"comment:134\" align=\"right\">comment:134</div>\n\n`tox -e local-macports-optlocal-python3.10-standard` warns:\n\n```\nchecking ... whether /opt/local/bin/python3.10 is good... \nconfigure: WARNING: this is a misconfigured Python whose sysconfig compiler/linker flags contain -I or -L options, which may cause wrong versions of libraries to leak into the build of Python packages - see https://github.com/sagemath/sage/issues/31132\n```",
    "created_at": "2022-05-01T22:32:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505890",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:134" align="right">comment:134</div>

`tox -e local-macports-optlocal-python3.10-standard` warns:

```
checking ... whether /opt/local/bin/python3.10 is good... 
configure: WARNING: this is a misconfigured Python whose sysconfig compiler/linker flags contain -I or -L options, which may cause wrong versions of libraries to leak into the build of Python packages - see https://github.com/sagemath/sage/issues/31132
```



---

archive/issue_events_431153.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-01T22:32:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431153"
}
```



---

archive/issue_events_431154.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-01T22:32:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431154"
}
```



---

archive/issue_comments_505891.json:
```json
{
    "body": "Changed commit from **[`1fcbecf`](https://github.com/sagemath/sagetrac-mirror/commit/1fcbecf1893fb400a73eb9c55363a47b787ea4f0)** to **[`1e8e4bc`](https://github.com/sagemath/sagetrac-mirror/commit/1e8e4bce49ff91a359049ee5a8cd3c50196049b9)**",
    "created_at": "2022-05-01T22:52:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505891",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1fcbecf`](https://github.com/sagemath/sagetrac-mirror/commit/1fcbecf1893fb400a73eb9c55363a47b787ea4f0)** to **[`1e8e4bc`](https://github.com/sagemath/sagetrac-mirror/commit/1e8e4bce49ff91a359049ee5a8cd3c50196049b9)**



---

archive/issue_comments_505892.json:
```json
{
    "body": "<div id=\"comment:136\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1e8e4bce49ff91a359049ee5a8cd3c50196049b9\"><code>1e8e4bc</code></a></td><td><code>build/bin/sage-print-system-package-command [macports]: Do not describe variants that do not work</code></td></tr></table>\n",
    "created_at": "2022-05-01T22:52:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505892",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:136"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1e8e4bce49ff91a359049ee5a8cd3c50196049b9"><code>1e8e4bc</code></a></td><td><code>build/bin/sage-print-system-package-command [macports]: Do not describe variants that do not work</code></td></tr></table>




---

archive/issue_comments_505893.json:
```json
{
    "body": "<div id=\"comment:137\" align=\"right\">comment:137</div>\n\nReplying to [@mkoeppe](#comment%3A134):\n> `tox -e local-macports-optlocal-python3.10-standard` warns:\n> \n> ```\n> checking ... whether /opt/local/bin/python3.10 is good... \n> configure: WARNING: this is a misconfigured Python whose sysconfig compiler/linker flags contain -I or -L options, which may cause wrong versions of libraries to leak into the build of Python packages - see https://github.com/sagemath/sage/issues/31132\n> ```\n\n... and gmpy2 fails to build",
    "created_at": "2022-05-01T22:55:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505893",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:137" align="right">comment:137</div>

Replying to [@mkoeppe](#comment%3A134):
> `tox -e local-macports-optlocal-python3.10-standard` warns:
> 
> ```
> checking ... whether /opt/local/bin/python3.10 is good... 
> configure: WARNING: this is a misconfigured Python whose sysconfig compiler/linker flags contain -I or -L options, which may cause wrong versions of libraries to leak into the build of Python packages - see https://github.com/sagemath/sage/issues/31132
> ```

... and gmpy2 fails to build



---

archive/issue_comments_505894.json:
```json
{
    "body": "<div id=\"comment:138\" align=\"right\">comment:138</div>\n\nReplying to [@mkoeppe](#comment%3A137):\n> Replying to [@mkoeppe](#comment%3A134):\n> > `tox -e local-macports-optlocal-python3.10-standard` warns:\n> > \n> > ```\n> > checking ... whether /opt/local/bin/python3.10 is good... \n> > configure: WARNING: this is a misconfigured Python whose sysconfig compiler/linker flags contain -I or -L options, which may cause wrong versions of libraries to leak into the build of Python packages - see https://github.com/sagemath/sage/issues/31132\n> > ```\n> \n> ... and `gmpy2`, `cysignals`, `cvxopt` fail to build - similar to [comment:31](#comment%3A31)",
    "created_at": "2022-05-02T01:03:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505894",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:138" align="right">comment:138</div>

Replying to [@mkoeppe](#comment%3A137):
> Replying to [@mkoeppe](#comment%3A134):
> > `tox -e local-macports-optlocal-python3.10-standard` warns:
> > 
> > ```
> > checking ... whether /opt/local/bin/python3.10 is good... 
> > configure: WARNING: this is a misconfigured Python whose sysconfig compiler/linker flags contain -I or -L options, which may cause wrong versions of libraries to leak into the build of Python packages - see https://github.com/sagemath/sage/issues/31132
> > ```
> 
> ... and `gmpy2`, `cysignals`, `cvxopt` fail to build - similar to [comment:31](#comment%3A31)



---

archive/issue_comments_505895.json:
```json
{
    "body": "<div id=\"comment:139\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5bfc840d5de9bed57f2b22c8eb5c8f53a90a27d4\"><code>5bfc840</code></a></td><td><code>tox.ini (macports): Set CPATH, LIBRARY_PATH</code></td></tr></table>\n",
    "created_at": "2022-05-02T01:14:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505895",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:139"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5bfc840d5de9bed57f2b22c8eb5c8f53a90a27d4"><code>5bfc840</code></a></td><td><code>tox.ini (macports): Set CPATH, LIBRARY_PATH</code></td></tr></table>




---

archive/issue_comments_505896.json:
```json
{
    "body": "Changed commit from **[`1e8e4bc`](https://github.com/sagemath/sagetrac-mirror/commit/1e8e4bce49ff91a359049ee5a8cd3c50196049b9)** to **[`5bfc840`](https://github.com/sagemath/sagetrac-mirror/commit/5bfc840d5de9bed57f2b22c8eb5c8f53a90a27d4)**",
    "created_at": "2022-05-02T01:14:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505896",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1e8e4bc`](https://github.com/sagemath/sagetrac-mirror/commit/1e8e4bce49ff91a359049ee5a8cd3c50196049b9)** to **[`5bfc840`](https://github.com/sagemath/sagetrac-mirror/commit/5bfc840d5de9bed57f2b22c8eb5c8f53a90a27d4)**



---

archive/issue_comments_505897.json:
```json
{
    "body": "<div id=\"comment:140\" align=\"right\">comment:140</div>\n\nThis fixes gmpy2, cvxopt",
    "created_at": "2022-05-02T01:14:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505897",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:140" align="right">comment:140</div>

This fixes gmpy2, cvxopt



---

archive/issue_comments_505898.json:
```json
{
    "body": "Changed commit from **[`5bfc840`](https://github.com/sagemath/sagetrac-mirror/commit/5bfc840d5de9bed57f2b22c8eb5c8f53a90a27d4)** to **[`30c326c`](https://github.com/sagemath/sagetrac-mirror/commit/30c326c981897a58dcf1b12f1395ae1065be57d8)**",
    "created_at": "2022-05-02T02:41:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505898",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5bfc840`](https://github.com/sagemath/sagetrac-mirror/commit/5bfc840d5de9bed57f2b22c8eb5c8f53a90a27d4)** to **[`30c326c`](https://github.com/sagemath/sagetrac-mirror/commit/30c326c981897a58dcf1b12f1395ae1065be57d8)**



---

archive/issue_comments_505899.json:
```json
{
    "body": "<div id=\"comment:141\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/30c326c981897a58dcf1b12f1395ae1065be57d8\"><code>30c326c</code></a></td><td><code>build/pkgs/pari/distros/macports.txt: Disable</code></td></tr></table>\n",
    "created_at": "2022-05-02T02:41:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505899",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:141"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/30c326c981897a58dcf1b12f1395ae1065be57d8"><code>30c326c</code></a></td><td><code>build/pkgs/pari/distros/macports.txt: Disable</code></td></tr></table>




---

archive/issue_comments_505900.json:
```json
{
    "body": "Changed commit from **[`30c326c`](https://github.com/sagemath/sagetrac-mirror/commit/30c326c981897a58dcf1b12f1395ae1065be57d8)** to **[`c698722`](https://github.com/sagemath/sagetrac-mirror/commit/c69872294366bb80b1560505e2ca45cce170db4d)**",
    "created_at": "2022-05-02T06:35:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505900",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`30c326c`](https://github.com/sagemath/sagetrac-mirror/commit/30c326c981897a58dcf1b12f1395ae1065be57d8)** to **[`c698722`](https://github.com/sagemath/sagetrac-mirror/commit/c69872294366bb80b1560505e2ca45cce170db4d)**



---

archive/issue_comments_505901.json:
```json
{
    "body": "<div id=\"comment:142\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c69872294366bb80b1560505e2ca45cce170db4d\"><code>c698722</code></a></td><td><code>tox.ini (macports): Use isysroot</code></td></tr></table>\n",
    "created_at": "2022-05-02T06:35:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505901",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:142"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c69872294366bb80b1560505e2ca45cce170db4d"><code>c698722</code></a></td><td><code>tox.ini (macports): Use isysroot</code></td></tr></table>




---

archive/issue_comments_505902.json:
```json
{
    "body": "<div id=\"comment:143\" align=\"right\">comment:143</div>\n\nNow `tox -e local-macports-optlocal-python3.10-standard` succeeds. The trick was to block out the homebrew installation in `/usr/local`.",
    "created_at": "2022-05-02T06:37:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505902",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:143" align="right">comment:143</div>

Now `tox -e local-macports-optlocal-python3.10-standard` succeeds. The trick was to block out the homebrew installation in `/usr/local`.



---

archive/issue_comments_505903.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,12 +14,7 @@\n or \n \n ```\n-tox -e local-macports-standard-python3.8   # uses python3.8 from macports\n-```\n-or \n-\n-```\n-tox -e local-macports-standard-python3.9   # uses python3.9 from macports\n+tox -e local-macports-standard-python3.10  # uses python3.10 from macports\n ```\n \n Each of these commands creates an isolated installation of MacPorts in a subdirectory of `.tox` (using https://guide.macports.org/#installing.macports.source.multiple\n``````\n",
    "created_at": "2022-05-02T06:38:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505903",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,12 +14,7 @@
 or 
 
 ```
-tox -e local-macports-standard-python3.8   # uses python3.8 from macports
-```
-or 
-
-```
-tox -e local-macports-standard-python3.9   # uses python3.9 from macports
+tox -e local-macports-standard-python3.10  # uses python3.10 from macports
 ```
 
 Each of these commands creates an isolated installation of MacPorts in a subdirectory of `.tox` (using https://guide.macports.org/#installing.macports.source.multiple
``````




---

archive/issue_comments_505904.json:
```json
{
    "body": "Changed commit from **[`c698722`](https://github.com/sagemath/sagetrac-mirror/commit/c69872294366bb80b1560505e2ca45cce170db4d)** to **[`476fa33`](https://github.com/sagemath/sagetrac-mirror/commit/476fa33e16780466a04556f1c87532465dbde898)**",
    "created_at": "2022-08-02T17:37:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505904",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c698722`](https://github.com/sagemath/sagetrac-mirror/commit/c69872294366bb80b1560505e2ca45cce170db4d)** to **[`476fa33`](https://github.com/sagemath/sagetrac-mirror/commit/476fa33e16780466a04556f1c87532465dbde898)**



---

archive/issue_comments_505905.json:
```json
{
    "body": "<div id=\"comment:145\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/476fa33e16780466a04556f1c87532465dbde898\"><code>476fa33</code></a></td><td><code>Merge tag '9.7.beta7' into t/31505/tox_ini__add_macports_environment</code></td></tr></table>\n",
    "created_at": "2022-08-02T17:37:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505905",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:145"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/476fa33e16780466a04556f1c87532465dbde898"><code>476fa33</code></a></td><td><code>Merge tag '9.7.beta7' into t/31505/tox_ini__add_macports_environment</code></td></tr></table>




---

archive/issue_comments_505906.json:
```json
{
    "body": "<div id=\"comment:146\" align=\"right\">comment:146</div>\n\n`tox -e local-macports-optlocal-standard-python3.10 -- ptest ` builds without problems, and there is only a small number of doctest failures.\n\n```\nsage -t --random-seed=37353794756962291469199267391330052516 src/doc/en/constructions/calculus.rst  # Timed out\nsage -t --random-seed=37353794756962291469199267391330052516 src/sage/dynamics/arithmetic_dynamics/projective_ds.py  # Timed out\nsage -t --random-seed=37353794756962291469199267391330052516 src/sage/interfaces/macaulay2.py  # 1 doctest failed\nsage -t --random-seed=37353794756962291469199267391330052516 src/sage/libs/libecm.pyx  # 7 doctests failed\nsage -t --random-seed=37353794756962291469199267391330052516 src/sage/matrix/constructor.pyx  # 1 doctest failed\nsage -t --random-seed=37353794756962291469199267391330052516 src/sage/misc/sageinspect.py  # 1 doctest failed\nsage -t --random-seed=37353794756962291469199267391330052516 src/sage/plot/plot3d/parametric_plot3d.py  # Timed out\nsage -t --random-seed=37353794756962291469199267391330052516 src/sage/repl/attach.py  # 1 doctest failed\nsage -t --random-seed=37353794756962291469199267391330052516 src/sage/repl/display/formatter.py  # 1 doctest failed\nsage -t --random-seed=37353794756962291469199267391330052516 src/sage/repl/interface_magic.py  # 1 doctest failed\nsage -t --random-seed=37353794756962291469199267391330052516 src/sage/repl/interpreter.py  # 2 doctests failed\nsage -t --random-seed=37353794756962291469199267391330052516 src/sage/repl/ipython_tests.py  # 1 doctest failed\nsage -t --random-seed=37353794756962291469199267391330052516 src/sage/repl/rich_output/backend_ipython.py  # 1 doctest failed\nsage -t --random-seed=37353794756962291469199267391330052516 src/sage/repl/ipython_extension.py  # 1 doctest failed\nsage -t --random-seed=37353794756962291469199267391330052516 src/sage/structure/sage_object.pyx  # 1 doctest failed\nsage -t --random-seed=37353794756962291469199267391330052516 src/sage/tests/cmdline.py  # 4 doctests failed\nsage -t --random-seed=37353794756962291469199267391330052516 src/sage/typeset/ascii_art.py  # 1 doctest failed\n```\nMost of these failures are from the warning \"UserWarning: Attempting to work in a virtualenv. If you encounter problems, please install IPython inside the virtualenv.\"\n\nThe only real failures are:\n\n```\nsage -t --random-seed=37353794756962291469199267391330052516 src/sage/libs/libecm.pyx\n**********************************************************************\nFile \"src/sage/libs/libecm.pyx\", line 33, in sage.libs.libecm\nFailed example:\n    ecmfactor(2^128+1,1000,sigma=227140902)\nExpected:\n    (True, 5704689200685129054721, 227140902)\nGot:\n    (False, None)\n**********************************************************************\nFile \"src/sage/libs/libecm.pyx\", line 91, in sage.libs.libecm.ecmfactor\nFailed example:\n    ecmfactor(N, 2e5)\nExpected:\n    (True, 2349023, ...)\nGot:\n    (True, 187072209578355573530071658587684226515959365500927, 0)\n**********************************************************************\nFile \"src/sage/libs/libecm.pyx\", line 113, in sage.libs.libecm.ecmfactor\nFailed example:\n    ecmfactor(N, 1e3)\nExpected:\n    (False, None)\nGot:\n    (True, 170141183460469231731687303715884105727, 0)\n**********************************************************************\nFile \"src/sage/libs/libecm.pyx\", line 130, in sage.libs.libecm.ecmfactor\nFailed example:\n    ecmfactor(N, 100, verbose=True)\nExpected:\n    Performing one curve with B1=100\n    Found factor in step 1: 11\n    (True, 11, ...)\nGot:\n    Performing one curve with B1=100\n    Found factor in step 1: 479270685891287906588011710623477140055626627230262983486227930615309559797523855924635580611607650107391\n    (True,\n     479270685891287906588011710623477140055626627230262983486227930615309559797523855924635580611607650107391,\n     0)\n**********************************************************************\nFile \"src/sage/libs/libecm.pyx\", line 134, in sage.libs.libecm.ecmfactor\nFailed example:\n    ecmfactor(N/11, 100, verbose=True)\nExpected:\n    Performing one curve with B1=100\n    Found no factor.\n    (False, None)\nGot:\n    Performing one curve with B1=100\n    Found factor in step 1: 43570062353753446053455610056679740005056966111842089407838902783209959981593077811330507328327968191581\n    (True,\n     43570062353753446053455610056679740005056966111842089407838902783209959981593077811330507328327968191581,\n     0)\n**********************************************************************\nFile \"src/sage/libs/libecm.pyx\", line 144, in sage.libs.libecm.ecmfactor\nFailed example:\n    alarm(0.5); ecmfactor(2^521-1, 1e7)\nExpected:\n    Traceback (most recent call last):\n    ...\n    AlarmInterrupt\nGot:\n    (True,\n     6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151,\n     0)\n**********************************************************************\nFile \"src/sage/libs/libecm.pyx\", line 151, in sage.libs.libecm.ecmfactor\nFailed example:\n    ecmfactor(1, 100)\nExpected:\n    (True, 1, ...)\nGot:\n    (False, None)\n**********************************************************************\n2 items had failures:\n   1 of   9 in sage.libs.libecm\n   6 of  21 in sage.libs.libecm.ecmfactor\n    [28 tests, 7 failures, 0.93 s]\n```",
    "created_at": "2022-08-05T05:19:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505906",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:146" align="right">comment:146</div>

`tox -e local-macports-optlocal-standard-python3.10 -- ptest ` builds without problems, and there is only a small number of doctest failures.

```
sage -t --random-seed=37353794756962291469199267391330052516 src/doc/en/constructions/calculus.rst  # Timed out
sage -t --random-seed=37353794756962291469199267391330052516 src/sage/dynamics/arithmetic_dynamics/projective_ds.py  # Timed out
sage -t --random-seed=37353794756962291469199267391330052516 src/sage/interfaces/macaulay2.py  # 1 doctest failed
sage -t --random-seed=37353794756962291469199267391330052516 src/sage/libs/libecm.pyx  # 7 doctests failed
sage -t --random-seed=37353794756962291469199267391330052516 src/sage/matrix/constructor.pyx  # 1 doctest failed
sage -t --random-seed=37353794756962291469199267391330052516 src/sage/misc/sageinspect.py  # 1 doctest failed
sage -t --random-seed=37353794756962291469199267391330052516 src/sage/plot/plot3d/parametric_plot3d.py  # Timed out
sage -t --random-seed=37353794756962291469199267391330052516 src/sage/repl/attach.py  # 1 doctest failed
sage -t --random-seed=37353794756962291469199267391330052516 src/sage/repl/display/formatter.py  # 1 doctest failed
sage -t --random-seed=37353794756962291469199267391330052516 src/sage/repl/interface_magic.py  # 1 doctest failed
sage -t --random-seed=37353794756962291469199267391330052516 src/sage/repl/interpreter.py  # 2 doctests failed
sage -t --random-seed=37353794756962291469199267391330052516 src/sage/repl/ipython_tests.py  # 1 doctest failed
sage -t --random-seed=37353794756962291469199267391330052516 src/sage/repl/rich_output/backend_ipython.py  # 1 doctest failed
sage -t --random-seed=37353794756962291469199267391330052516 src/sage/repl/ipython_extension.py  # 1 doctest failed
sage -t --random-seed=37353794756962291469199267391330052516 src/sage/structure/sage_object.pyx  # 1 doctest failed
sage -t --random-seed=37353794756962291469199267391330052516 src/sage/tests/cmdline.py  # 4 doctests failed
sage -t --random-seed=37353794756962291469199267391330052516 src/sage/typeset/ascii_art.py  # 1 doctest failed
```
Most of these failures are from the warning "UserWarning: Attempting to work in a virtualenv. If you encounter problems, please install IPython inside the virtualenv."

The only real failures are:

```
sage -t --random-seed=37353794756962291469199267391330052516 src/sage/libs/libecm.pyx
**********************************************************************
File "src/sage/libs/libecm.pyx", line 33, in sage.libs.libecm
Failed example:
    ecmfactor(2^128+1,1000,sigma=227140902)
Expected:
    (True, 5704689200685129054721, 227140902)
Got:
    (False, None)
**********************************************************************
File "src/sage/libs/libecm.pyx", line 91, in sage.libs.libecm.ecmfactor
Failed example:
    ecmfactor(N, 2e5)
Expected:
    (True, 2349023, ...)
Got:
    (True, 187072209578355573530071658587684226515959365500927, 0)
**********************************************************************
File "src/sage/libs/libecm.pyx", line 113, in sage.libs.libecm.ecmfactor
Failed example:
    ecmfactor(N, 1e3)
Expected:
    (False, None)
Got:
    (True, 170141183460469231731687303715884105727, 0)
**********************************************************************
File "src/sage/libs/libecm.pyx", line 130, in sage.libs.libecm.ecmfactor
Failed example:
    ecmfactor(N, 100, verbose=True)
Expected:
    Performing one curve with B1=100
    Found factor in step 1: 11
    (True, 11, ...)
Got:
    Performing one curve with B1=100
    Found factor in step 1: 479270685891287906588011710623477140055626627230262983486227930615309559797523855924635580611607650107391
    (True,
     479270685891287906588011710623477140055626627230262983486227930615309559797523855924635580611607650107391,
     0)
**********************************************************************
File "src/sage/libs/libecm.pyx", line 134, in sage.libs.libecm.ecmfactor
Failed example:
    ecmfactor(N/11, 100, verbose=True)
Expected:
    Performing one curve with B1=100
    Found no factor.
    (False, None)
Got:
    Performing one curve with B1=100
    Found factor in step 1: 43570062353753446053455610056679740005056966111842089407838902783209959981593077811330507328327968191581
    (True,
     43570062353753446053455610056679740005056966111842089407838902783209959981593077811330507328327968191581,
     0)
**********************************************************************
File "src/sage/libs/libecm.pyx", line 144, in sage.libs.libecm.ecmfactor
Failed example:
    alarm(0.5); ecmfactor(2^521-1, 1e7)
Expected:
    Traceback (most recent call last):
    ...
    AlarmInterrupt
Got:
    (True,
     6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151,
     0)
**********************************************************************
File "src/sage/libs/libecm.pyx", line 151, in sage.libs.libecm.ecmfactor
Failed example:
    ecmfactor(1, 100)
Expected:
    (True, 1, ...)
Got:
    (False, None)
**********************************************************************
2 items had failures:
   1 of   9 in sage.libs.libecm
   6 of  21 in sage.libs.libecm.ecmfactor
    [28 tests, 7 failures, 0.93 s]
```



---

archive/issue_comments_505907.json:
```json
{
    "body": "<div id=\"comment:147\" align=\"right\">comment:147</div>\n\nGood enough to get this in?",
    "created_at": "2022-08-05T05:19:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505907",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:147" align="right">comment:147</div>

Good enough to get this in?



---

archive/issue_comments_505908.json:
```json
{
    "body": "<div id=\"comment:148\" align=\"right\">comment:148</div>\n\ndoes macports have its own ecm here in these errors? If so, we can avoid them by testing ecm more in spkg-configure.",
    "created_at": "2022-08-24T14:22:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505908",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:148" align="right">comment:148</div>

does macports have its own ecm here in these errors? If so, we can avoid them by testing ecm more in spkg-configure.



---

archive/issue_comments_505909.json:
```json
{
    "body": "<div id=\"comment:149\" align=\"right\">comment:149</div>\n\nYes, there is an ecm.",
    "created_at": "2022-08-24T15:19:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505909",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:149" align="right">comment:149</div>

Yes, there is an ecm.



---

archive/issue_comments_505910.json:
```json
{
    "body": "<div id=\"comment:150\" align=\"right\">comment:150</div>\n\nDo you want to work on this? I don't, hence my question in [comment:147](#comment%3A147)",
    "created_at": "2022-08-24T16:41:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505910",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:150" align="right">comment:150</div>

Do you want to work on this? I don't, hence my question in [comment:147](#comment%3A147)



---

archive/issue_comments_505911.json:
```json
{
    "body": "<div id=\"comment:151\" align=\"right\">comment:151</div>\n\nReplying to [@mkoeppe](#comment%3A150):\n> Do you want to work on this? I don't, hence my question in [comment:147](#comment%3A147)\n\nI'll see if I can fix this quickly.\nIf not, it can be merged as is, I guess.",
    "created_at": "2022-08-24T16:45:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505911",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:151" align="right">comment:151</div>

Replying to [@mkoeppe](#comment%3A150):
> Do you want to work on this? I don't, hence my question in [comment:147](#comment%3A147)

I'll see if I can fix this quickly.
If not, it can be merged as is, I guess.



---

archive/issue_comments_505912.json:
```json
{
    "body": "<div id=\"comment:152\" align=\"right\">comment:152</div>\n\nI tried `tox -e local-macports-standard` and got\n\n```\nError: Failed to install cmake-bootstrap: MacPorts requires root privileges for this action\nError: See /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.7.beta8/.tox/local-macports-standard/macports/var/macports/logs/_Users_palmieri_Desktop_Sage_sage_builds_TESTING_sage-9.7.beta8_.tox_local-macports-standard_macports_var_macports_sources_rsync.macports.org_macports_release_tarballs_ports_devel_cmake-bootstrap/cmake-bootstrap/main.log for details.\nError: Follow https://guide.macports.org/#project.tickets if you believe there is a bug.\nError: Processing of port gcc11 failed\n```\nSince I wasn't using `local-macports-optlocal-standard`, I wasn't expecting to need root privileges.",
    "created_at": "2022-08-24T17:24:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505912",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:152" align="right">comment:152</div>

I tried `tox -e local-macports-standard` and got

```
Error: Failed to install cmake-bootstrap: MacPorts requires root privileges for this action
Error: See /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.7.beta8/.tox/local-macports-standard/macports/var/macports/logs/_Users_palmieri_Desktop_Sage_sage_builds_TESTING_sage-9.7.beta8_.tox_local-macports-standard_macports_var_macports_sources_rsync.macports.org_macports_release_tarballs_ports_devel_cmake-bootstrap/cmake-bootstrap/main.log for details.
Error: Follow https://guide.macports.org/#project.tickets if you believe there is a bug.
Error: Processing of port gcc11 failed
```
Since I wasn't using `local-macports-optlocal-standard`, I wasn't expecting to need root privileges.



---

archive/issue_comments_505913.json:
```json
{
    "body": "<div id=\"comment:153\" align=\"right\">comment:153</div>\n\nI can confirm this. It seems to be a new macports bug.",
    "created_at": "2022-08-24T22:14:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505913",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:153" align="right">comment:153</div>

I can confirm this. It seems to be a new macports bug.



---

archive/issue_comments_505914.json:
```json
{
    "body": "<div id=\"comment:154\" align=\"right\">comment:154</div>\n\nregarding `ecm` errors, are they only for the library interface, whereas `sage/interfaces/ecm.py` tests OK?",
    "created_at": "2022-08-25T08:54:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505914",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:154" align="right">comment:154</div>

regarding `ecm` errors, are they only for the library interface, whereas `sage/interfaces/ecm.py` tests OK?



---

archive/issue_comments_505915.json:
```json
{
    "body": "<div id=\"comment:155\" align=\"right\">comment:155</div>\n\nIf I was careful in [comment:146](#comment%3A146) where I summarized the failures, then yes",
    "created_at": "2022-08-25T15:55:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505915",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:155" align="right">comment:155</div>

If I was careful in [comment:146](#comment%3A146) where I summarized the failures, then yes



---

archive/issue_comments_505916.json:
```json
{
    "body": "<div id=\"comment:156\" align=\"right\">comment:156</div>\n\nReplying to [@mkoeppe](#comment%3A153):\n> I can confirm this. It seems to be a new macports bug.\n\nhttps://ports.macports.org/port/cmake-bootstrap/ says to run `sudo port install cmake-bootstrap` - no idea why.\n\nI'm trying to test with `sudo` now.",
    "created_at": "2022-08-27T18:13:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505916",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:156" align="right">comment:156</div>

Replying to [@mkoeppe](#comment%3A153):
> I can confirm this. It seems to be a new macports bug.

https://ports.macports.org/port/cmake-bootstrap/ says to run `sudo port install cmake-bootstrap` - no idea why.

I'm trying to test with `sudo` now.



---

archive/issue_comments_505917.json:
```json
{
    "body": "<div id=\"comment:157\" align=\"right\">comment:157</div>\n\nHow does one pass `--enable-build-as-root` to tox?",
    "created_at": "2022-08-28T07:04:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505917",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:157" align="right">comment:157</div>

How does one pass `--enable-build-as-root` to tox?



---

archive/issue_comments_505918.json:
```json
{
    "body": "<div id=\"comment:158\" align=\"right\">comment:158</div>\n\nYou can set the environment variable `EXTRA_CONFIGURE_ARGS`",
    "created_at": "2022-08-28T15:20:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505918",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:158" align="right">comment:158</div>

You can set the environment variable `EXTRA_CONFIGURE_ARGS`



---

archive/issue_comments_505919.json:
```json
{
    "body": "<div id=\"comment:159\" align=\"right\">comment:159</div>\n\n`sudo  EXTRA_CONFIGURE_ARGS=\"--enable-build-as-root\" tox -e local-macports-standard` is very slow (single-thread?), and seems to hang on installing Pari - this is after installing all the pre-reqs - which was also very slow, and included building clang from source (sic!).\n\nCan't it use XCode's clang instead?",
    "created_at": "2022-08-29T09:04:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505919",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:159" align="right">comment:159</div>

`sudo  EXTRA_CONFIGURE_ARGS="--enable-build-as-root" tox -e local-macports-standard` is very slow (single-thread?), and seems to hang on installing Pari - this is after installing all the pre-reqs - which was also very slow, and included building clang from source (sic!).

Can't it use XCode's clang instead?



---

archive/issue_comments_505920.json:
```json
{
    "body": "<div id=\"comment:160\" align=\"right\">comment:160</div>\n\nanyway, macports in .tox/ was installed,so I chown'd it to the normal user, and proceeded without sudo. This pushed the build further,but still it is single thread. Waiting for tests to finish.",
    "created_at": "2022-08-29T15:00:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505920",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:160" align="right">comment:160</div>

anyway, macports in .tox/ was installed,so I chown'd it to the normal user, and proceeded without sudo. This pushed the build further,but still it is single thread. Waiting for tests to finish.



---

archive/issue_comments_505921.json:
```json
{
    "body": "<div id=\"comment:161\" align=\"right\">comment:161</div>\n\nReplying to [@dimpase](#comment%3A159):\n> `sudo  EXTRA_CONFIGURE_ARGS=\"--enable-build-as-root\" tox -e local-macports-standard` is very slow (single-thread?)\n\nYou could have set `MAKE=\"make -j16\" `",
    "created_at": "2022-08-29T15:06:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505921",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:161" align="right">comment:161</div>

Replying to [@dimpase](#comment%3A159):
> `sudo  EXTRA_CONFIGURE_ARGS="--enable-build-as-root" tox -e local-macports-standard` is very slow (single-thread?)

You could have set `MAKE="make -j16" `



---

archive/issue_comments_505922.json:
```json
{
    "body": "<div id=\"comment:162\" align=\"right\">comment:162</div>\n\nwith the latest beta8 merged, I am getting a sagelib building error \n\n```\n    error: Command \"gcc -isysroot /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk -Wno-unused-result \n-Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -iwithsysroot/System\n/Library/Frameworks/System.framework/PrivateHeaders -iwithsysroot/Applications/Xcode.app/Contents/Develop\ner/Library/Frameworks/Python3.framework/Versions/3.8/Headers -Werror=implicit-function-declaration -g -O2\n -I///Users/dima/software/sage/.tox/local-macports-standard/macports/include -Isage/cpython -Isage/libs/n\ntl -Isage/libs/arb -I/Users/dima/software/sage/.tox/local-macports-standard/local/lib/python3.8/site-pack\nages/cypari2 -Isage/libs/flint -I/Users/dima/software/sage/.tox/local-macports-standard/local/lib/python3\n.8/site-packages/cysignals -I/Users/dima/software/sage/src -I/Users/dima/software/sage/.tox/local-macport\ns-standard/local/lib/python3.8/site-packages/numpy/core/include -I/Applications/Xcode.app/Contents/Develo\nper/Library/Frameworks/Python3.framework/Versions/3.8/include/python3.8 -I/Users/dima/software/sage/.tox/\nlocal-macports-standard/local/include -I/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Pyt\nhon3.framework/Versions/3.8/include/python3.8 -c sage/rings/number_field/number_field_element_quadratic.c\npp -o build/temp.macosx-10.14-x86_64-cpython-38/sage/rings/number_field/number_field_element_quadratic.o \n-std=c++11\" failed with exit status 1\n    error: subprocess-exited-with-error\n    \n    \u00d7 python setup.py develop did not run successfully.\n    \u2502 exit code: 1\n    \u2570\u2500> See above for output.\n    \n    note: This error originates from a subprocess, and is likely not a problem with pip.\n    full command: /Users/dima/software/sage/.tox/local-macports-standard/local/bin/python3 -c '\n    exec(compile('\"'\"''\"'\"''\"'\"'\n    # This is <pip-setuptools-caller> -- a caller that pip uses to run setup.py\n    #\n    # - It imports setuptools before invoking setup.py, to enable projects that directly\n    #   import from `distutils.core` to work with newer packaging standards.\n    # - It provides a clear error message when setuptools is not installed.\n    # - It sets `sys.argv[0]` to the underlying `setup.py`, when invoking `setup.py` so\n    #   setuptools doesn'\"'\"'t think the script is `-c`. This avoids the following warning:\n    #     manifest_maker: standard file '\"'\"'-c'\"'\"' not found\".\n    # - It generates a shim setup.py, for handling setup.cfg-only projects.\n    import os, sys, tokenize\n    \n    try:\n        import setuptools\n    except ImportError as error:\n        print(\n            \"ERROR: Can not execute `setup.py` since setuptools is not available in \"\n            \"the build environment.\",\n            file=sys.stderr,\n        )\n        sys.exit(1)\n    \n    __file__ = %r\n    sys.argv[0] = __file__\n    \n    if os.path.exists(__file__):\n        filename = __file__\n        with tokenize.open(__file__) as f:\n            setup_py_code = f.read()\n    else:\n        filename = \"<auto-generated setuptools caller>\"\n        setup_py_code = \"from setuptools import setup; setup()\"\n    \n    exec(compile(setup_py_code, filename, \"exec\"))\n    '\"'\"''\"'\"''\"'\"' % ('\"'\"'/Users/dima/software/sage/src/setup.py'\"'\"',), \"<pip-setuptools-caller>\", \"exec\"))' --no-user-cfg develop --no-deps\n    cwd: /Users/dima/software/sage/src/\nerror: subprocess-exited-with-error\n\n\u00d7 python setup.py develop did not run successfully.\n\u2502 exit code: 1\n\u2570\u2500> See above for output.\n\nnote: This error originates from a subprocess, and is likely not a problem with pip.\n\n```",
    "created_at": "2022-08-29T20:09:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505922",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:162" align="right">comment:162</div>

with the latest beta8 merged, I am getting a sagelib building error 

```
    error: Command "gcc -isysroot /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk -Wno-unused-result 
-Wsign-compare -Wunreachable-code -fno-common -dynamic -DNDEBUG -g -fwrapv -O3 -Wall -iwithsysroot/System
/Library/Frameworks/System.framework/PrivateHeaders -iwithsysroot/Applications/Xcode.app/Contents/Develop
er/Library/Frameworks/Python3.framework/Versions/3.8/Headers -Werror=implicit-function-declaration -g -O2
 -I///Users/dima/software/sage/.tox/local-macports-standard/macports/include -Isage/cpython -Isage/libs/n
tl -Isage/libs/arb -I/Users/dima/software/sage/.tox/local-macports-standard/local/lib/python3.8/site-pack
ages/cypari2 -Isage/libs/flint -I/Users/dima/software/sage/.tox/local-macports-standard/local/lib/python3
.8/site-packages/cysignals -I/Users/dima/software/sage/src -I/Users/dima/software/sage/.tox/local-macport
s-standard/local/lib/python3.8/site-packages/numpy/core/include -I/Applications/Xcode.app/Contents/Develo
per/Library/Frameworks/Python3.framework/Versions/3.8/include/python3.8 -I/Users/dima/software/sage/.tox/
local-macports-standard/local/include -I/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Pyt
hon3.framework/Versions/3.8/include/python3.8 -c sage/rings/number_field/number_field_element_quadratic.c
pp -o build/temp.macosx-10.14-x86_64-cpython-38/sage/rings/number_field/number_field_element_quadratic.o 
-std=c++11" failed with exit status 1
    error: subprocess-exited-with-error
    
    × python setup.py develop did not run successfully.
    │ exit code: 1
    ╰─> See above for output.
    
    note: This error originates from a subprocess, and is likely not a problem with pip.
    full command: /Users/dima/software/sage/.tox/local-macports-standard/local/bin/python3 -c '
    exec(compile('"'"''"'"''"'"'
    # This is <pip-setuptools-caller> -- a caller that pip uses to run setup.py
    #
    # - It imports setuptools before invoking setup.py, to enable projects that directly
    #   import from `distutils.core` to work with newer packaging standards.
    # - It provides a clear error message when setuptools is not installed.
    # - It sets `sys.argv[0]` to the underlying `setup.py`, when invoking `setup.py` so
    #   setuptools doesn'"'"'t think the script is `-c`. This avoids the following warning:
    #     manifest_maker: standard file '"'"'-c'"'"' not found".
    # - It generates a shim setup.py, for handling setup.cfg-only projects.
    import os, sys, tokenize
    
    try:
        import setuptools
    except ImportError as error:
        print(
            "ERROR: Can not execute `setup.py` since setuptools is not available in "
            "the build environment.",
            file=sys.stderr,
        )
        sys.exit(1)
    
    __file__ = %r
    sys.argv[0] = __file__
    
    if os.path.exists(__file__):
        filename = __file__
        with tokenize.open(__file__) as f:
            setup_py_code = f.read()
    else:
        filename = "<auto-generated setuptools caller>"
        setup_py_code = "from setuptools import setup; setup()"
    
    exec(compile(setup_py_code, filename, "exec"))
    '"'"''"'"''"'"' % ('"'"'/Users/dima/software/sage/src/setup.py'"'"',), "<pip-setuptools-caller>", "exec"))' --no-user-cfg develop --no-deps
    cwd: /Users/dima/software/sage/src/
error: subprocess-exited-with-error

× python setup.py develop did not run successfully.
│ exit code: 1
╰─> See above for output.

note: This error originates from a subprocess, and is likely not a problem with pip.

```



---

archive/issue_comments_505923.json:
```json
{
    "body": "<div id=\"comment:163\" align=\"right\">comment:163</div>\n\nThe actual g++ error message is missing in what you pasted here",
    "created_at": "2022-08-29T20:25:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505923",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:163" align="right">comment:163</div>

The actual g++ error message is missing in what you pasted here



---

archive/issue_comments_505924.json:
```json
{
    "body": "<div id=\"comment:164\" align=\"right\">comment:164</div>\n\nright - I thought it's some kind of Python packaging error :-)\n\n```\n    INFO: compile options: '-I///Users/dima/software/sage/.tox/local-macports-standard/macports/include -\nIsage/cpython -Isage/libs/ntl -Isage/libs/arb -I/Users/dima/software/sage/.tox/local-macports-standard/lo\ncal/lib/python3.8/site-packages/cypari2 -Isage/libs/flint -I/Users/dima/software/sage/.tox/local-macports\n-standard/local/lib/python3.8/site-packages/cysignals -I/Users/dima/software/sage/src -I/Users/dima/softw\nare/sage/.tox/local-macports-standard/local/lib/python3.8/site-packages/numpy/core/include -I/Application\ns/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.8/include/python3.8 -I/Use\nrs/dima/software/sage/.tox/local-macports-standard/local/include -I/Applications/Xcode.app/Contents/Devel\noper/Library/Frameworks/Python3.framework/Versions/3.8/include/python3.8 -c'\n    extra options: '-std=c++11'\n    INFO: gcc: sage/rings/number_field/number_field_element_quadratic.cpp\n    In file included from sage/rings/number_field/number_field_element_quadratic.cpp:837:\n    In file included from sage/libs/flint/flint_wrap.h:42:\n    ///Users/dima/software/sage/.tox/local-macports-standard/macports/include/flint/fmpz_mod_poly.h:306:12: error: use of undeclared identifier '_fmpz_poly_deflation'; did you mean 'fmpz_mod_poly_deflation'?\n        return _fmpz_poly_deflation(input->coeffs, input->length);\n               ^~~~~~~~~~~~~~~~~~~~\n               fmpz_mod_poly_deflation\n    ///Users/dima/software/sage/.tox/local-macports-standard/macports/include/flint/fmpz_mod_poly.h:303:7: note: 'fmpz_mod_poly_deflation' declared here\n    ulong fmpz_mod_poly_deflation(const fmpz_mod_poly_t input,\n          ^\n    ///Users/dima/software/sage/.tox/local-macports-standard/macports/include/flint/fmpz_mod_poly.h:306:33: error: cannot initialize a parameter of type 'const fmpz_mod_poly_struct *' with an lvalue of type 'fmpz *const' (aka 'long *const')\n        return _fmpz_poly_deflation(input->coeffs, input->length);\n...\n```\n\nmacports comes with flint 2.9.0, so it seems there is some kind of  incompatibility with our 2.8.4.",
    "created_at": "2022-08-29T21:26:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505924",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:164" align="right">comment:164</div>

right - I thought it's some kind of Python packaging error :-)

```
    INFO: compile options: '-I///Users/dima/software/sage/.tox/local-macports-standard/macports/include -
Isage/cpython -Isage/libs/ntl -Isage/libs/arb -I/Users/dima/software/sage/.tox/local-macports-standard/lo
cal/lib/python3.8/site-packages/cypari2 -Isage/libs/flint -I/Users/dima/software/sage/.tox/local-macports
-standard/local/lib/python3.8/site-packages/cysignals -I/Users/dima/software/sage/src -I/Users/dima/softw
are/sage/.tox/local-macports-standard/local/lib/python3.8/site-packages/numpy/core/include -I/Application
s/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.8/include/python3.8 -I/Use
rs/dima/software/sage/.tox/local-macports-standard/local/include -I/Applications/Xcode.app/Contents/Devel
oper/Library/Frameworks/Python3.framework/Versions/3.8/include/python3.8 -c'
    extra options: '-std=c++11'
    INFO: gcc: sage/rings/number_field/number_field_element_quadratic.cpp
    In file included from sage/rings/number_field/number_field_element_quadratic.cpp:837:
    In file included from sage/libs/flint/flint_wrap.h:42:
    ///Users/dima/software/sage/.tox/local-macports-standard/macports/include/flint/fmpz_mod_poly.h:306:12: error: use of undeclared identifier '_fmpz_poly_deflation'; did you mean 'fmpz_mod_poly_deflation'?
        return _fmpz_poly_deflation(input->coeffs, input->length);
               ^~~~~~~~~~~~~~~~~~~~
               fmpz_mod_poly_deflation
    ///Users/dima/software/sage/.tox/local-macports-standard/macports/include/flint/fmpz_mod_poly.h:303:7: note: 'fmpz_mod_poly_deflation' declared here
    ulong fmpz_mod_poly_deflation(const fmpz_mod_poly_t input,
          ^
    ///Users/dima/software/sage/.tox/local-macports-standard/macports/include/flint/fmpz_mod_poly.h:306:33: error: cannot initialize a parameter of type 'const fmpz_mod_poly_struct *' with an lvalue of type 'fmpz *const' (aka 'long *const')
        return _fmpz_poly_deflation(input->coeffs, input->length);
...
```

macports comes with flint 2.9.0, so it seems there is some kind of  incompatibility with our 2.8.4.



---

archive/issue_comments_505925.json:
```json
{
    "body": "<div id=\"comment:165\" align=\"right\">comment:165</div>\n\nThe problem is that `-I///Users/dima/software/sage/.tox/local-macports-standard/macports/include` at the front of the command line. It's not supposed to be there",
    "created_at": "2022-08-29T21:37:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505925",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:165" align="right">comment:165</div>

The problem is that `-I///Users/dima/software/sage/.tox/local-macports-standard/macports/include` at the front of the command line. It's not supposed to be there



---

archive/issue_comments_505926.json:
```json
{
    "body": "<div id=\"comment:166\" align=\"right\">comment:166</div>\n\nReplying to [@mkoeppe](#comment%3A165):\n> The problem is that `-I///Users/dima/software/sage/.tox/local-macports-standard/macports/include` at the front of the command line. It's not supposed to be there\n\nthat's probably what `tox` is doing to create an isolated environment, no?",
    "created_at": "2022-08-29T21:55:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505926",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:166" align="right">comment:166</div>

Replying to [@mkoeppe](#comment%3A165):
> The problem is that `-I///Users/dima/software/sage/.tox/local-macports-standard/macports/include` at the front of the command line. It's not supposed to be there

that's probably what `tox` is doing to create an isolated environment, no?



---

archive/issue_comments_505927.json:
```json
{
    "body": "<div id=\"comment:167\" align=\"right\">comment:167</div>\n\nNo, this is the install location of macports within the tox environment. I set these variables:\n\n```\n+    local-macports:           MP_PREFIX={envdir}/macports\n+    local-macports:   PATH={env:MP_PREFIX}/bin:/usr/bin:/bin:/usr/sbin:/sbin\n+    local-macports:   CPATH={env:MP_PREFIX}/include\n+    local-macports:   LIBRARY_PATH={env:MP_PREFIX}/lib\n+    local-macports:   SETENV=eval $(build/bin/sage-print-system-package-command {env:SYSTEM} setup-build-env)\n```\nbut not `CFLAGS`.",
    "created_at": "2022-08-29T23:12:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505927",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:167" align="right">comment:167</div>

No, this is the install location of macports within the tox environment. I set these variables:

```
+    local-macports:           MP_PREFIX={envdir}/macports
+    local-macports:   PATH={env:MP_PREFIX}/bin:/usr/bin:/bin:/usr/sbin:/sbin
+    local-macports:   CPATH={env:MP_PREFIX}/include
+    local-macports:   LIBRARY_PATH={env:MP_PREFIX}/lib
+    local-macports:   SETENV=eval $(build/bin/sage-print-system-package-command {env:SYSTEM} setup-build-env)
```
but not `CFLAGS`.



---

archive/issue_comments_505928.json:
```json
{
    "body": "<div id=\"comment:168\" align=\"right\">comment:168</div>\n\nThen it's done by macports, not by tox.",
    "created_at": "2022-08-29T23:26:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505928",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:168" align="right">comment:168</div>

Then it's done by macports, not by tox.



---

archive/issue_comments_505929.json:
```json
{
    "body": "<div id=\"comment:169\" align=\"right\">comment:169</div>\n\nCould you check what the macports-installed `python3` gives when you ask it `python3 -m sysconfig`",
    "created_at": "2022-08-29T23:48:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505929",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:169" align="right">comment:169</div>

Could you check what the macports-installed `python3` gives when you ask it `python3 -m sysconfig`



---

archive/issue_comments_505930.json:
```json
{
    "body": "<div id=\"comment:170\" align=\"right\">comment:170</div>\n\nthere are 2 installations of python3.10 in .tox/local-macports-standard/:\n\n```\ndima@oucl13243 sage %  .tox/local-macports-standard/macports/bin/python3.10\nPython 3.10.6 (main, Aug 27 2022, 17:58:26) [Clang 13.1.6 (clang-1316.0.21.2.5)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> \ndima@oucl13243 sage %  .tox/local-macports-standard/bin/python3\nPython 3.10.6 (main, Aug 11 2022, 13:49:25) [Clang 13.1.6 (clang-1316.0.21.2.5)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n```\n\nThe latter is the only `python3` (without `.10`), though.",
    "created_at": "2022-08-30T07:22:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505930",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:170" align="right">comment:170</div>

there are 2 installations of python3.10 in .tox/local-macports-standard/:

```
dima@oucl13243 sage %  .tox/local-macports-standard/macports/bin/python3.10
Python 3.10.6 (main, Aug 27 2022, 17:58:26) [Clang 13.1.6 (clang-1316.0.21.2.5)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> 
dima@oucl13243 sage %  .tox/local-macports-standard/bin/python3
Python 3.10.6 (main, Aug 11 2022, 13:49:25) [Clang 13.1.6 (clang-1316.0.21.2.5)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
```

The latter is the only `python3` (without `.10`), though.



---

archive/issue_comments_505931.json:
```json
{
    "body": "Attachment: **[p1.gz](https://github.com/sagemath/sage/files/ticket31505/p1.gz)**\n\nsysconfig1",
    "created_at": "2022-08-30T07:24:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505931",
    "user": "https://github.com/dimpase"
}
```

Attachment: **[p1.gz](https://github.com/sagemath/sage/files/ticket31505/p1.gz)**

sysconfig1



---

archive/issue_comments_505932.json:
```json
{
    "body": "Attachment: **[p2.gz](https://github.com/sagemath/sage/files/ticket31505/p2.gz)**\n\nsysconf2",
    "created_at": "2022-08-30T07:24:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505932",
    "user": "https://github.com/dimpase"
}
```

Attachment: **[p2.gz](https://github.com/sagemath/sage/files/ticket31505/p2.gz)**

sysconf2



---

archive/issue_comments_505933.json:
```json
{
    "body": "<div id=\"comment:171\" align=\"right\">comment:171</div>\n\nattached are their outputs when run with `-m sysconfig`.\n\n(there is also python2.7.18 - hopefully we have stopped all python2's used in our build by now...)",
    "created_at": "2022-08-30T07:27:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31505#issuecomment-505933",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:171" align="right">comment:171</div>

attached are their outputs when run with `-m sysconfig`.

(there is also python2.7.18 - hopefully we have stopped all python2's used in our build by now...)



---

archive/issue_events_431155.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431155"
}
```



---

archive/issue_events_431156.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431156"
}
```



---

archive/issue_events_431157.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-07T21:39:40Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431157"
}
```



---

archive/issue_events_431158.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-07T21:39:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31505",
    "milestone_number": null,
    "milestone_title": "sage-9.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31505#event-431158"
}
```
