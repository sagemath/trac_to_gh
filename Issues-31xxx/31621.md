# Issue 31621: ubuntu-groovy-standard, debian-bullseye-standard: numerics-related sage testsuite errors

archive/issues_031384.json:
```json
{
    "body": "From https://groups.google.com/g/sage-release/c/6WjKQt_e_B8/m/dpx1qILOCwAJ (for 9.3.rc2):\n\n9.3.beta8> {debian-bullseye,ubuntu-groovy}-standard: cvxopt testsuite errors, numerics-related sage testsuite errors\n9.3.beta8> (is system BLAS feeling OK??)\n\nThe numerics failures on debian-bullseye have disappeared (or perhaps it is processor dependent, and we were luckier in this run), but show up in debian-sid this time. \nThe numerics failures on ubuntu-groovy are still present.\n\nAnother report for `debian-bullseye`: https://groups.google.com/g/sage-devel/c/kip6kYlL95Q/m/fjUbYwA-AwAJ\n\n**CC:**  @dimpase @jhpalmieri @videlec @kliem\n\n**Status:** new\n\nIssue created by migration from https://trac.sagemath.org/ticket/31621\n\n",
    "created_at": "2021-04-08T17:18:51Z",
    "labels": [
        "component: porting",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "ubuntu-groovy-standard, debian-bullseye-standard: numerics-related sage testsuite errors",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31621",
    "user": "https://github.com/mkoeppe"
}
```
From https://groups.google.com/g/sage-release/c/6WjKQt_e_B8/m/dpx1qILOCwAJ (for 9.3.rc2):

9.3.beta8> {debian-bullseye,ubuntu-groovy}-standard: cvxopt testsuite errors, numerics-related sage testsuite errors
9.3.beta8> (is system BLAS feeling OK??)

The numerics failures on debian-bullseye have disappeared (or perhaps it is processor dependent, and we were luckier in this run), but show up in debian-sid this time. 
The numerics failures on ubuntu-groovy are still present.

Another report for `debian-bullseye`: https://groups.google.com/g/sage-devel/c/kip6kYlL95Q/m/fjUbYwA-AwAJ

**CC:**  @dimpase @jhpalmieri @videlec @kliem

**Status:** new

Issue created by migration from https://trac.sagemath.org/ticket/31621





---

archive/issue_events_093393.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-10T17:42:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31621#event-93393"
}
```



---

archive/issue_comments_601151.json:
```json
{
    "body": "<a id='comment:1'></a>\nMoving to 9.4, as 9.3 has been released.",
    "created_at": "2021-05-10T17:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601151",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'></a>
Moving to 9.4, as 9.3 has been released.



---

archive/issue_events_093394.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31621#event-93394"
}
```



---

archive/issue_events_093395.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31621#event-93395"
}
```



---

archive/issue_comments_601152.json:
```json
{
    "body": "<a id='comment:4'></a>\nI saw what I think are the same failures on one OS X 11.5.2 machine (but not another one \u2014\u00a0I think it's CPU dependent). The failing machine says\n\n```\n% sysctl -n machdep.cpu.brand_string\nIntel(R) Xeon(R) W-2140B CPU @ 3.20GHz\n```\nI can provide other CPU info if you let me know what commands to run.",
    "created_at": "2021-09-22T21:39:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601152",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>
I saw what I think are the same failures on one OS X 11.5.2 machine (but not another one — I think it's CPU dependent). The failing machine says

```
% sysctl -n machdep.cpu.brand_string
Intel(R) Xeon(R) W-2140B CPU @ 3.20GHz
```
I can provide other CPU info if you let me know what commands to run.



---

archive/issue_comments_601153.json:
```json
{
    "body": "<a id='comment:5'></a>\nThe tests passed when I did `tox -e local-homebrew-macos-minimal -- ptestlong`. Any guesses for what homebrew package is causing the problem? What should I plug into `./configure --with-system-PKG=no`?",
    "created_at": "2021-09-23T20:18:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601153",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>
The tests passed when I did `tox -e local-homebrew-macos-minimal -- ptestlong`. Any guesses for what homebrew package is causing the problem? What should I plug into `./configure --with-system-PKG=no`?



---

archive/issue_comments_601154.json:
```json
{
    "body": "<a id='comment:6'></a>\nThese tests passed when I did `./configure --with-system-gsl=no --with-system-openblas=no`. \n\nJust using `./configure --with-system-gsl=no` failed to build: gsl's configure script failed with\n\n```\nconfigure: error: in `/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta1/local/var/tmp/sage/build/gsl-2.6/src':\nconfigure: error: C compiler cannot create executables\n```\nand gsl's config.log file said\n\n```\nld: library not found for -lopenblas\n```\n\nI'm trying now with `./configure --with-system-openblas=no`, which means that Sage will also build its own `gsl`, `r`, and `suitesparse`.\n\n(This computer is in my work office, and so I will not check its progress again until Monday.)",
    "created_at": "2021-09-24T21:57:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601154",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>
These tests passed when I did `./configure --with-system-gsl=no --with-system-openblas=no`. 

Just using `./configure --with-system-gsl=no` failed to build: gsl's configure script failed with

```
configure: error: in `/Users/jpalmier/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta1/local/var/tmp/sage/build/gsl-2.6/src':
configure: error: C compiler cannot create executables
```
and gsl's config.log file said

```
ld: library not found for -lopenblas
```

I'm trying now with `./configure --with-system-openblas=no`, which means that Sage will also build its own `gsl`, `r`, and `suitesparse`.

(This computer is in my work office, and so I will not check its progress again until Monday.)



---

archive/issue_comments_601155.json:
```json
{
    "body": "<a id='comment:7'></a>\nBy the way, I expect this to pass these tests \u2014 it should be equivalent to what I already did with `./configure --with-system-gsl=no --with-system-openblas=no` \u2014\u00a0but I want to see the output of `make ptestlong`.",
    "created_at": "2021-09-24T22:06:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601155",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
By the way, I expect this to pass these tests — it should be equivalent to what I already did with `./configure --with-system-gsl=no --with-system-openblas=no` — but I want to see the output of `make ptestlong`.



---

archive/issue_comments_601156.json:
```json
{
    "body": "<a id='comment:8'></a>\nAll tests passed when using that flag (`--with-system-openblas=no`).",
    "created_at": "2021-09-27T18:56:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601156",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>
All tests passed when using that flag (`--with-system-openblas=no`).



---

archive/issue_comments_601157.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -6,4 +6,4 @@\n The numerics failures on debian-bullseye have disappeared (or perhaps it is processor dependent, and we were luckier in this run), but show up in debian-sid this time. \n The numerics failures on ubuntu-groovy are still present.\n \n-\n+Another report for `debian-bullseye`: https://groups.google.com/g/sage-devel/c/kip6kYlL95Q/m/fjUbYwA-AwAJ\n``````\n",
    "created_at": "2021-10-16T17:48:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601157",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -6,4 +6,4 @@
 The numerics failures on debian-bullseye have disappeared (or perhaps it is processor dependent, and we were luckier in this run), but show up in debian-sid this time. 
 The numerics failures on ubuntu-groovy are still present.
 
-
+Another report for `debian-bullseye`: https://groups.google.com/g/sage-devel/c/kip6kYlL95Q/m/fjUbYwA-AwAJ
``````




---

archive/issue_events_093396.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "rename": {
        "from": "ubuntu-groovy-standard: numerics-related sage testsuite errors",
        "to": "ubuntu-groovy-standard, debian-bullseye-standard: numerics-related sage testsuite errors"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31621#event-93396"
}
```



---

archive/issue_comments_601158.json:
```json
{
    "body": "<a id='comment:11'></a>\nJohn, do you see on macOS the error reported by Vincent?\n\n```\nFile \"src/sage/matrix/matrix_double_dense.pyx\", line 1365, in\nsage.matrix.matrix_double_dense.Matrix_double_dense.?\nFailed example:\n     A.eigenvalues(algorithm='symmetric', tol=1.0e-5)  # tol 2e-15\nExpected:\n     [(-8.0, 22), (2.0, 77), (22.0, 1)]\nGot:\n     [(-13.81753974166025, 1),\n...\n```\n\n- it's one I know how to produce a standalone test for (as a short Fortran program linking OpenBLAS)",
    "created_at": "2021-10-16T22:37:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601158",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>
John, do you see on macOS the error reported by Vincent?

```
File "src/sage/matrix/matrix_double_dense.pyx", line 1365, in
sage.matrix.matrix_double_dense.Matrix_double_dense.?
Failed example:
     A.eigenvalues(algorithm='symmetric', tol=1.0e-5)  # tol 2e-15
Expected:
     [(-8.0, 22), (2.0, 77), (22.0, 1)]
Got:
     [(-13.81753974166025, 1),
...
```

- it's one I know how to produce a standalone test for (as a short Fortran program linking OpenBLAS)



---

archive/issue_comments_601159.json:
```json
{
    "body": "<a id='comment:12'></a>\nalso, what openblas version did you try on homebrew?\nthe bumped to 0.3.18 two weeks ago: https://github.com/Homebrew/homebrew-core/commit/63de340b1e397b67e7137519f45b02491b6e1f15",
    "created_at": "2021-10-16T22:56:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601159",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:12'></a>
also, what openblas version did you try on homebrew?
the bumped to 0.3.18 two weeks ago: https://github.com/Homebrew/homebrew-core/commit/63de340b1e397b67e7137519f45b02491b6e1f15



---

archive/issue_comments_601160.json:
```json
{
    "body": "<a id='comment:13'></a>\nI will check on Monday.",
    "created_at": "2021-10-17T00:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601160",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:13'></a>
I will check on Monday.



---

archive/issue_comments_601161.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [dimpase](#comment%3A11):\n> John, do you see on macOS the error reported by Vincent?\n> \n> ```\n> File \"src/sage/matrix/matrix_double_dense.pyx\", line 1365, in\n> sage.matrix.matrix_double_dense.Matrix_double_dense.?\n> Failed example:\n>      A.eigenvalues(algorithm='symmetric', tol=1.0e-5)  # tol 2e-15\n> Expected:\n>      [(-8.0, 22), (2.0, 77), (22.0, 1)]\n> Got:\n>      [(-13.81753974166025, 1),\n> ...\n> ```\n> \n> - it's one I know how to produce a standalone test for (as a short Fortran program linking OpenBLAS)\n> \n>  \n\n\nDima, even a standalone test with scipy would be already good enough. I would like to check if the Debian package is completely broken or simply used wrongly within sage. In both cases, it might be known from Debian developers.",
    "created_at": "2021-10-17T10:34:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601161",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'></a>
Replying to [dimpase](#comment%3A11):
> John, do you see on macOS the error reported by Vincent?
> 
> ```
> File "src/sage/matrix/matrix_double_dense.pyx", line 1365, in
> sage.matrix.matrix_double_dense.Matrix_double_dense.?
> Failed example:
>      A.eigenvalues(algorithm='symmetric', tol=1.0e-5)  # tol 2e-15
> Expected:
>      [(-8.0, 22), (2.0, 77), (22.0, 1)]
> Got:
>      [(-13.81753974166025, 1),
> ...
> ```
> 
> - it's one I know how to produce a standalone test for (as a short Fortran program linking OpenBLAS)
> 
>  


Dima, even a standalone test with scipy would be already good enough. I would like to check if the Debian package is completely broken or simply used wrongly within sage. In both cases, it might be known from Debian developers.



---

archive/attachments_021498.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "dev_test.f90",
    "asset_url": "tarball://root/attachments/some-uuid/ticket31621/dev_test.f90",
    "created_at": "2021-10-17T21:17:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.f90",
    "user": "https://github.com/dimpase"
}
```



---

archive/issue_comments_601162.json:
```json
{
    "body": "test Fortran program",
    "created_at": "2021-10-17T21:17:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601162",
    "user": "https://github.com/dimpase"
}
```

test Fortran program



---

archive/issue_comments_601163.json:
```json
{
    "body": "the failing example (spectrum of the adj. matrix of 100-vertex Higman-Sims graph)",
    "created_at": "2021-10-17T21:19:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601163",
    "user": "https://github.com/dimpase"
}
```

the failing example (spectrum of the adj. matrix of 100-vertex Higman-Sims graph)



---

archive/attachments_021499.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "HigmanSims.tst",
    "asset_url": "tarball://root/attachments/some-uuid/ticket31621/HigmanSims.tst",
    "created_at": "2021-10-17T21:19:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.tst",
    "user": "https://github.com/dimpase"
}
```



---

archive/issue_comments_601164.json:
```json
{
    "body": "smaller example (from Petersen graph)",
    "created_at": "2021-10-17T21:19:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601164",
    "user": "https://github.com/dimpase"
}
```

smaller example (from Petersen graph)



---

archive/attachments_021500.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "petersen.tst",
    "asset_url": "tarball://root/attachments/some-uuid/ticket31621/petersen.tst",
    "created_at": "2021-10-17T21:20:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.tst",
    "user": "https://github.com/dimpase"
}
```



---

archive/issue_comments_601165.json:
```json
{
    "body": "script to compute test data",
    "created_at": "2021-10-17T21:20:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601165",
    "user": "https://github.com/dimpase"
}
```

script to compute test data



---

archive/attachments_021501.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "graphdata.sage",
    "asset_url": "tarball://root/attachments/some-uuid/ticket31621/graphdata.sage",
    "created_at": "2021-10-17T21:28:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.sage",
    "user": "https://github.com/dimpase"
}
```



---

archive/issue_comments_601166.json:
```json
{
    "body": "<a id='comment:15'></a>\nI've uploaded an attempted test of OpenBLAS. Download the attachments and\n\n```\ngfortran dev_test.f90 -lopenblas\n./a.out <HigmanSims.tst\n```\n\nThe last line of the output should say `max. deviation of eigenvals: <small number>`, where `<small number>` is smaller than 10<sup>-13</sup> or so if all is good.\n \n(there is another, smaller, example, too, petersen.tst)\n\n\nPlease note I'm not sure I used exactly the same LAPACK function as in Sage failing test - there is one more function to try, `DSYEVR` if this one, `DSYEV`, would just work.",
    "created_at": "2021-10-17T21:28:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601166",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'></a>
I've uploaded an attempted test of OpenBLAS. Download the attachments and

```
gfortran dev_test.f90 -lopenblas
./a.out <HigmanSims.tst
```

The last line of the output should say `max. deviation of eigenvals: <small number>`, where `<small number>` is smaller than 10<sup>-13</sup> or so if all is good.
 
(there is another, smaller, example, too, petersen.tst)


Please note I'm not sure I used exactly the same LAPACK function as in Sage failing test - there is one more function to try, `DSYEVR` if this one, `DSYEV`, would just work.



---

archive/attachments_021502.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "dev_test_dsyevr.f90",
    "asset_url": "tarball://root/attachments/some-uuid/ticket31621/dev_test_dsyevr.f90",
    "created_at": "2021-10-18T10:54:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.f90",
    "user": "https://github.com/dimpase"
}
```



---

archive/issue_comments_601167.json:
```json
{
    "body": "test using LAPACK's dsyevr call",
    "created_at": "2021-10-18T10:54:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601167",
    "user": "https://github.com/dimpase"
}
```

test using LAPACK's dsyevr call



---

archive/issue_comments_601168.json:
```json
{
    "body": "<a id='comment:16'></a>\nplease also try the latter attachment (same instructions, different file name,  `dev_test_dsyevr.f90`",
    "created_at": "2021-10-18T10:55:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601168",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'></a>
please also try the latter attachment (same instructions, different file name,  `dev_test_dsyevr.f90`



---

archive/issue_comments_601169.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [vdelecroix](#comment%3A14):\n\n> Dima, even a standalone test with scipy would be already good enough. I would like to check if the Debian package is completely broken or simply used wrongly within sage. In both cases, it might be known from Debian developers.\n\n\nhere is a direct scipy test via Sage:\n\n```\nsage: import numpy as np\nsage: import scipy\nsage: import scipy.linalg\nsage: g=graphs.HigmanSimsGraph()\nsage: a=np.matrix(g.adjacency_matrix())\nsage: eig=scipy.linalg.lapack.dsyevr(a); eig[0]\narray([-8., -8., -8., -8., -8., -8., -8., -8., -8., -8., -8., -8., -8.,\n       -8., -8., -8., -8., -8., -8., -8., -8., -8.,  2.,  2.,  2.,  2.,\n        2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,\n        2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,\n        2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,\n        2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,\n        2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,\n        2.,  2.,  2.,  2.,  2.,  2.,  2.,  2., 22.])\n```",
    "created_at": "2021-10-18T14:27:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601169",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:17'></a>
Replying to [vdelecroix](#comment%3A14):

> Dima, even a standalone test with scipy would be already good enough. I would like to check if the Debian package is completely broken or simply used wrongly within sage. In both cases, it might be known from Debian developers.


here is a direct scipy test via Sage:

```
sage: import numpy as np
sage: import scipy
sage: import scipy.linalg
sage: g=graphs.HigmanSimsGraph()
sage: a=np.matrix(g.adjacency_matrix())
sage: eig=scipy.linalg.lapack.dsyevr(a); eig[0]
array([-8., -8., -8., -8., -8., -8., -8., -8., -8., -8., -8., -8., -8.,
       -8., -8., -8., -8., -8., -8., -8., -8., -8.,  2.,  2.,  2.,  2.,
        2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,
        2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,
        2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,
        2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,
        2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,
        2.,  2.,  2.,  2.,  2.,  2.,  2.,  2., 22.])
```



---

archive/issue_comments_601170.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [dimpase](#comment%3A11):\n> John, do you see on macOS the error reported by Vincent?\n> \n> ```\n> File \"src/sage/matrix/matrix_double_dense.pyx\", line 1365, in\n> sage.matrix.matrix_double_dense.Matrix_double_dense.?\n> Failed example:\n>      A.eigenvalues(algorithm='symmetric', tol=1.0e-5)  # tol 2e-15\n> Expected:\n>      [(-8.0, 22), (2.0, 77), (22.0, 1)]\n> Got:\n>      [(-13.81753974166025, 1),\n> ...\n> ```\n\n\nYes, I see this failure. This is with an un-updated version of OpenBLAS: 0.3.17 from 2021-09-23 according to `brew info openblas`. I will try upgrading.",
    "created_at": "2021-10-18T17:48:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601170",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:18'></a>
Replying to [dimpase](#comment%3A11):
> John, do you see on macOS the error reported by Vincent?
> 
> ```
> File "src/sage/matrix/matrix_double_dense.pyx", line 1365, in
> sage.matrix.matrix_double_dense.Matrix_double_dense.?
> Failed example:
>      A.eigenvalues(algorithm='symmetric', tol=1.0e-5)  # tol 2e-15
> Expected:
>      [(-8.0, 22), (2.0, 77), (22.0, 1)]
> Got:
>      [(-13.81753974166025, 1),
> ...
> ```


Yes, I see this failure. This is with an un-updated version of OpenBLAS: 0.3.17 from 2021-09-23 according to `brew info openblas`. I will try upgrading.



---

archive/issue_comments_601171.json:
```json
{
    "body": "<a id='comment:19'></a>\nI can't use the standalone test because I get `ld: library not found for -lopenblas`.",
    "created_at": "2021-10-18T17:50:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601171",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'></a>
I can't use the standalone test because I get `ld: library not found for -lopenblas`.



---

archive/issue_comments_601172.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [jhpalmieri](#comment%3A19):\n> I can't use the standalone test because I get `ld: library not found for -lopenblas`.\n\nYou'd need `-L` flag:\n\n```\ngfortran <...>.f90 -L/usr/local/opt/openblas/lib -lopenblas\n```",
    "created_at": "2021-10-18T18:29:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601172",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:20'></a>
Replying to [jhpalmieri](#comment%3A19):
> I can't use the standalone test because I get `ld: library not found for -lopenblas`.

You'd need `-L` flag:

```
gfortran <...>.f90 -L/usr/local/opt/openblas/lib -lopenblas
```



---

archive/issue_comments_601173.json:
```json
{
    "body": "<a id='comment:21'></a>\nThanks. When I run `./a.out <HigmanSims.tst`, the last line is the same with either test program: `max. deviation of eigenvals:    1.2878587085651816E-014`.",
    "created_at": "2021-10-18T18:57:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601173",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:21'></a>
Thanks. When I run `./a.out <HigmanSims.tst`, the last line is the same with either test program: `max. deviation of eigenvals:    1.2878587085651816E-014`.



---

archive/issue_comments_601174.json:
```json
{
    "body": "<a id='comment:22'></a>\nWith `petersen.tst` I get `max. deviation of eigenvals:    8.8817841970012523E-016`.",
    "created_at": "2021-10-18T18:57:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601174",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:22'></a>
With `petersen.tst` I get `max. deviation of eigenvals:    8.8817841970012523E-016`.



---

archive/issue_comments_601175.json:
```json
{
    "body": "<a id='comment:23'></a>\nOn the other hand, when I run the example in Sage in [comment:17](#comment%3A17), I get\n\n```\narray([-9.51662688, -9.01957761, -8.82571413, -8.53509523, -8.45449832,\n       -8.19421094, -8.06706488, -8.        , -8.        , -8.        ,\n       -8.        , -8.        , -8.        , -8.        , -8.        ,\n       -8.        , -8.        , -7.92742484, -7.63275394, -7.25448498,\n       -7.06795155, -6.90611622, -6.64469129, -6.54715317, -5.4872644 ,\n       -5.29660049, -4.69884647, -4.33752666, -4.30959029, -3.75213367,\n       -3.57502391, -2.92795773, -2.58101222, -2.57098415, -2.53138416,\n       -2.27048023, -2.16406448, -1.80261557, -1.75557973, -1.59188765,\n       -1.41796672, -1.35756654, -1.13476674, -0.92256797, -0.65109354,\n       -0.49437488, -0.27070739, -0.07512487,  0.17239949,  0.4835247 ,\n        0.54260365,  0.67677662,  1.03820124,  1.12679921,  1.41540993,\n        1.65236118,  1.75100574,  1.86305818,  1.99997232,  2.        ,\n        2.        ,  2.        ,  2.        ,  2.        ,  2.        ,\n        2.        ,  2.        ,  2.        ,  2.        ,  2.01296242,\n        2.23534418,  2.37464655,  2.50556135,  2.69055392,  2.73682618,\n        3.00360424,  3.18959084,  3.33877411,  3.4352485 ,  3.60531369,\n        3.74100246,  3.88461972,  3.98561053,  4.12222078,  4.2778004 ,\n        4.42940272,  4.49540354,  4.52975646,  4.83264503,  4.90738351,\n        5.1034719 ,  5.17889141,  5.6570698 ,  5.75157547,  6.26235796,\n        6.26836517,  7.08899349,  7.30672858,  8.74786038, 22.        ])\n```",
    "created_at": "2021-10-18T18:58:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601175",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:23'></a>
On the other hand, when I run the example in Sage in [comment:17](#comment%3A17), I get

```
array([-9.51662688, -9.01957761, -8.82571413, -8.53509523, -8.45449832,
       -8.19421094, -8.06706488, -8.        , -8.        , -8.        ,
       -8.        , -8.        , -8.        , -8.        , -8.        ,
       -8.        , -8.        , -7.92742484, -7.63275394, -7.25448498,
       -7.06795155, -6.90611622, -6.64469129, -6.54715317, -5.4872644 ,
       -5.29660049, -4.69884647, -4.33752666, -4.30959029, -3.75213367,
       -3.57502391, -2.92795773, -2.58101222, -2.57098415, -2.53138416,
       -2.27048023, -2.16406448, -1.80261557, -1.75557973, -1.59188765,
       -1.41796672, -1.35756654, -1.13476674, -0.92256797, -0.65109354,
       -0.49437488, -0.27070739, -0.07512487,  0.17239949,  0.4835247 ,
        0.54260365,  0.67677662,  1.03820124,  1.12679921,  1.41540993,
        1.65236118,  1.75100574,  1.86305818,  1.99997232,  2.        ,
        2.        ,  2.        ,  2.        ,  2.        ,  2.        ,
        2.        ,  2.        ,  2.        ,  2.        ,  2.01296242,
        2.23534418,  2.37464655,  2.50556135,  2.69055392,  2.73682618,
        3.00360424,  3.18959084,  3.33877411,  3.4352485 ,  3.60531369,
        3.74100246,  3.88461972,  3.98561053,  4.12222078,  4.2778004 ,
        4.42940272,  4.49540354,  4.52975646,  4.83264503,  4.90738351,
        5.1034719 ,  5.17889141,  5.6570698 ,  5.75157547,  6.26235796,
        6.26836517,  7.08899349,  7.30672858,  8.74786038, 22.        ])
```



---

archive/issue_comments_601176.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [jhpalmieri](#comment%3A21):\n> Thanks. When I run `./a.out <HigmanSims.tst`, the last line is the same with either test program: `max. deviation of eigenvals:    1.2878587085651816E-014`.\n\n\nWhich Fortran program do you compile? Please try  `dev_test_dsyevr.f90` if you did not.",
    "created_at": "2021-10-18T19:11:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601176",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:24'></a>
Replying to [jhpalmieri](#comment%3A21):
> Thanks. When I run `./a.out <HigmanSims.tst`, the last line is the same with either test program: `max. deviation of eigenvals:    1.2878587085651816E-014`.


Which Fortran program do you compile? Please try  `dev_test_dsyevr.f90` if you did not.



---

archive/issue_comments_601177.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [dimpase](#comment%3A24):\n> Replying to [jhpalmieri](#comment%3A21):\n> > Thanks. When I run `./a.out <HigmanSims.tst`, the last line is the same with either test program: `max. deviation of eigenvals:    1.2878587085651816E-014`.\n  \n> \n> Which Fortran program do you compile? Please try  `dev_test_dsyevr.f90` if you did not.\n\n\nI tried both (that's what I meant by \"either test program\").",
    "created_at": "2021-10-18T19:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601177",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:25'></a>
Replying to [dimpase](#comment%3A24):
> Replying to [jhpalmieri](#comment%3A21):
> > Thanks. When I run `./a.out <HigmanSims.tst`, the last line is the same with either test program: `max. deviation of eigenvals:    1.2878587085651816E-014`.
  
> 
> Which Fortran program do you compile? Please try  `dev_test_dsyevr.f90` if you did not.


I tried both (that's what I meant by "either test program").



---

archive/issue_comments_601178.json:
```json
{
    "body": "<a id='comment:26'></a>\nok, so the next step would be to try the \"normal\" scipy run. That is, you can print `a` to a file, and then start `./sage --python`, read `a` in, and then run all the other lines in [comment:17](#comment%3A17).",
    "created_at": "2021-10-18T19:32:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601178",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:26'></a>
ok, so the next step would be to try the "normal" scipy run. That is, you can print `a` to a file, and then start `./sage --python`, read `a` in, and then run all the other lines in [comment:17](#comment%3A17).



---

archive/issue_comments_601179.json:
```json
{
    "body": "<a id='comment:27'></a>\nand if the latter still returns incorrect results, I'd try a standalone scipy, built from source using openblas from homebrew.",
    "created_at": "2021-10-18T19:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601179",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:27'></a>
and if the latter still returns incorrect results, I'd try a standalone scipy, built from source using openblas from homebrew.



---

archive/issue_comments_601180.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [dimpase](#comment%3A26):\n> ok, so the next step would be to try the \"normal\" scipy run. That is, you can print `a` to a file, and then start `./sage --python`, read `a` in, and then run all the other lines in [comment:17](#comment%3A17).\n> \n\none quick way to do this is the following:\n\n```\nsage: import numpy as np\nsage: g=graphs.HigmanSimsGraph()\nsage: a=np.matrix(g.adjacency_matrix())\nsage: np.save('/tmp/x',a)\n```\nnow we have `a` in `/tmp/x.npy`. So start \n\n```\n./sage --python\n``` \nand at its `>>>` prompt do\n\n```\nimport numpy as np\na=np.load('/tmp/x.npy')\nimport scipy\nimport scipy.linalg\neig=scipy.linalg.lapack.dsyevr(a); eig[0]\n```",
    "created_at": "2021-10-18T20:01:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601180",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:28'></a>
Replying to [dimpase](#comment%3A26):
> ok, so the next step would be to try the "normal" scipy run. That is, you can print `a` to a file, and then start `./sage --python`, read `a` in, and then run all the other lines in [comment:17](#comment%3A17).
> 

one quick way to do this is the following:

```
sage: import numpy as np
sage: g=graphs.HigmanSimsGraph()
sage: a=np.matrix(g.adjacency_matrix())
sage: np.save('/tmp/x',a)
```
now we have `a` in `/tmp/x.npy`. So start 

```
./sage --python
``` 
and at its `>>>` prompt do

```
import numpy as np
a=np.load('/tmp/x.npy')
import scipy
import scipy.linalg
eig=scipy.linalg.lapack.dsyevr(a); eig[0]
```



---

archive/issue_comments_601181.json:
```json
{
    "body": "<a id='comment:29'></a>\nNeedless to say, it's a good idea to check that `/tmp/x.npy` is correct, so copying it on a machine where Sage is not broken and testing it as above might be good idea.",
    "created_at": "2021-10-18T20:03:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601181",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:29'></a>
Needless to say, it's a good idea to check that `/tmp/x.npy` is correct, so copying it on a machine where Sage is not broken and testing it as above might be good idea.



---

archive/issue_comments_601182.json:
```json
{
    "body": "<a id='comment:30'></a>\n> Replying to [dimpase](#comment%3A27):\n> and if the latter still returns incorrect results, I'd try a standalone scipy, built from source using openblas from homebrew.\n\n\nThis gives correct results (although I wrote the matrix `g.adjacency_matrix()` to a file and then read it back in and fed it into `np.matrix(...)`).",
    "created_at": "2021-10-18T20:07:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601182",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:30'></a>
> Replying to [dimpase](#comment%3A27):
> and if the latter still returns incorrect results, I'd try a standalone scipy, built from source using openblas from homebrew.


This gives correct results (although I wrote the matrix `g.adjacency_matrix()` to a file and then read it back in and fed it into `np.matrix(...)`).



---

archive/issue_comments_601183.json:
```json
{
    "body": "<a id='comment:31'></a>\nSo it's not OpenBLAS or SciPy themselves, right?\nSomething else in Sage upsets OpenBLAS (and only OpenBLAS from numpy, right?) on this particular CPU.",
    "created_at": "2021-10-18T20:19:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601183",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:31'></a>
So it's not OpenBLAS or SciPy themselves, right?
Something else in Sage upsets OpenBLAS (and only OpenBLAS from numpy, right?) on this particular CPU.



---

archive/issue_comments_601184.json:
```json
{
    "body": "<a id='comment:32'></a>\nFor what it's worth, I dumped `a` to a file using `np.save(FILE, a)`. Then I loaded it and ran the above list of commands.\n\n- works just fine with `./sage --python`\n- produces the wrong answer with `./sage`",
    "created_at": "2021-10-18T21:14:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601184",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:32'></a>
For what it's worth, I dumped `a` to a file using `np.save(FILE, a)`. Then I loaded it and ran the above list of commands.

- works just fine with `./sage --python`
- produces the wrong answer with `./sage`



---

archive/issue_comments_601185.json:
```json
{
    "body": "<a id='comment:33'></a>\nAnd naturally it works fine if I use a version of Sage built with `./configure --with-system-openblas=no`.",
    "created_at": "2021-10-18T21:21:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601185",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:33'></a>
And naturally it works fine if I use a version of Sage built with `./configure --with-system-openblas=no`.



---

archive/issue_comments_601186.json:
```json
{
    "body": "<a id='comment:34'></a>\nCould `gsl` be involved somehow, rather than `openblas`?",
    "created_at": "2021-10-18T21:22:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601186",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:34'></a>
Could `gsl` be involved somehow, rather than `openblas`?



---

archive/issue_comments_601187.json:
```json
{
    "body": "<a id='comment:35'></a>\nIt need not be something even dependent on openblas that creates this weird CPU state. It could be something using AVX-512, or OpenMP.\n\nUnfortunately Sage isn't modularised enough so that one could just load parts one by one, and check if the bug appears.",
    "created_at": "2021-10-18T21:47:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601187",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:35'></a>
It need not be something even dependent on openblas that creates this weird CPU state. It could be something using AVX-512, or OpenMP.

Unfortunately Sage isn't modularised enough so that one could just load parts one by one, and check if the bug appears.



---

archive/issue_comments_601188.json:
```json
{
    "body": "<a id='comment:36'></a>\nI built Sage with\n\n```\nexport CFLAGS=\"-L/usr/local/opt/openblas/lib\"\n./configure --with-system-gsl=no\n```\nand I am not seeing the errors. This is using homebrew's `openblas`.",
    "created_at": "2021-10-18T22:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601188",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:36'></a>
I built Sage with

```
export CFLAGS="-L/usr/local/opt/openblas/lib"
./configure --with-system-gsl=no
```
and I am not seeing the errors. This is using homebrew's `openblas`.



---

archive/issue_comments_601189.json:
```json
{
    "body": "<a id='comment:37'></a>\nInteresting. First, it's a bug either in spkg-install of GSL, as it demands that `cblas` is known to `pkg-config`, which is not the case here - it can get the same from `openblas`, or somewhere in our hacky procedure of creating .pc files from the one for `openblas`.\n\nSecond, Sage is still on GSL 2.6, but Homebrew is on GSL 2.7.\nThere is #32607 - which supposed to be fixing something GSL 2.7-related (but I am happily running GSL 2.7 on Linux with Sage...)\n\nMatthias has tickets to make GSL optional.",
    "created_at": "2021-10-18T22:40:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601189",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:37'></a>
Interesting. First, it's a bug either in spkg-install of GSL, as it demands that `cblas` is known to `pkg-config`, which is not the case here - it can get the same from `openblas`, or somewhere in our hacky procedure of creating .pc files from the one for `openblas`.

Second, Sage is still on GSL 2.6, but Homebrew is on GSL 2.7.
There is #32607 - which supposed to be fixing something GSL 2.7-related (but I am happily running GSL 2.7 on Linux with Sage...)

Matthias has tickets to make GSL optional.



---

archive/issue_comments_601190.json:
```json
{
    "body": "<a id='comment:38'></a>\nRegarding the 1st issue: if you fire up `./sage --buildsh`, and at its prompt, run\n`pkg-config --libs cblas`, what's the output?\n\nI suspect that \n\n```\nsdh_configure LIBS=\"`pkg-config --libs-only-l cblas` -lm\"\n```\nin GSL's spkg-install.in should be\n\n```\nsdh_configure LIBS=\"`pkg-config --libs cblas` -lm\"\n```\n\n(`--libs-only-l` doesn't print `-L` flags.)\n\nCan you try the latter line without `CFLAGS` ?",
    "created_at": "2021-10-18T22:46:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601190",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:38'></a>
Regarding the 1st issue: if you fire up `./sage --buildsh`, and at its prompt, run
`pkg-config --libs cblas`, what's the output?

I suspect that 

```
sdh_configure LIBS="`pkg-config --libs-only-l cblas` -lm"
```
in GSL's spkg-install.in should be

```
sdh_configure LIBS="`pkg-config --libs cblas` -lm"
```

(`--libs-only-l` doesn't print `-L` flags.)

Can you try the latter line without `CFLAGS` ?



---

archive/issue_comments_601191.json:
```json
{
    "body": "<a id='comment:39'></a>\nShould `pkgconf` be a dependency for `gsl`?",
    "created_at": "2021-10-18T22:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601191",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:39'></a>
Should `pkgconf` be a dependency for `gsl`?



---

archive/issue_comments_601192.json:
```json
{
    "body": "<a id='comment:40'></a>\nReplying to [dimpase](#comment%3A38):\n> Regarding the 1st issue: if you fire up `./sage --buildsh`, and at its prompt, run\n> `pkg-config --libs cblas`, what's the output?\n\n\n```\n -L/usr/local/Cellar/openblas/0.3.18/lib -lopenblas\n```\n> \n> I suspect that \n> \n> ```\n> sdh_configure LIBS=\"`pkg-config --libs-only-l cblas` -lm\"\n> ```\n> in GSL's spkg-install.in should be\n> \n> ```\n> sdh_configure LIBS=\"`pkg-config --libs cblas` -lm\"\n> ```\n> \n> (`--libs-only-l` doesn't print `-L` flags.)\n> \n> Can you try the latter line without `CFLAGS` ?\n\n\nWill do.",
    "created_at": "2021-10-18T22:52:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601192",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:40'></a>
Replying to [dimpase](#comment%3A38):
> Regarding the 1st issue: if you fire up `./sage --buildsh`, and at its prompt, run
> `pkg-config --libs cblas`, what's the output?


```
 -L/usr/local/Cellar/openblas/0.3.18/lib -lopenblas
```
> 
> I suspect that 
> 
> ```
> sdh_configure LIBS="`pkg-config --libs-only-l cblas` -lm"
> ```
> in GSL's spkg-install.in should be
> 
> ```
> sdh_configure LIBS="`pkg-config --libs cblas` -lm"
> ```
> 
> (`--libs-only-l` doesn't print `-L` flags.)
> 
> Can you try the latter line without `CFLAGS` ?


Will do.



---

archive/issue_comments_601193.json:
```json
{
    "body": "<a id='comment:41'></a>\nAs noted in #32587, GSL 2.7 may be built with an option to use old API. This does not happen on Homebrew, see https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gsl.rb\n\nHowever, on Debian Bullseye GSL is still version 2.6, so perhaps\nit's not the version alone that's reponsible.\nhttps://packages.debian.org/source/stable/gsl\n\n---\n\nVincent, could you check the GSL version you're using, and build Sage with system OpenBLAS, but\nwithout GSL, just as John did here?",
    "created_at": "2021-10-19T07:35:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601193",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:41'></a>
As noted in #32587, GSL 2.7 may be built with an option to use old API. This does not happen on Homebrew, see https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/gsl.rb

However, on Debian Bullseye GSL is still version 2.6, so perhaps
it's not the version alone that's reponsible.
https://packages.debian.org/source/stable/gsl

---

Vincent, could you check the GSL version you're using, and build Sage with system OpenBLAS, but
without GSL, just as John did here?



---

archive/issue_comments_601194.json:
```json
{
    "body": "<a id='comment:42'></a>\nReplying to [jhpalmieri](#comment%3A40):\n> Replying to [dimpase](#comment%3A38):\n> > Regarding the 1st issue: if you fire up `./sage --buildsh`, and at its prompt, run\n> > `pkg-config --libs cblas`, what's the output?\n\n> {{{\n> -L/usr/local/Cellar/openblas/0.3.18/lib -lopenblas\n> }}}\n> > \n> > I suspect that \n> > \n> > ```\n> > sdh_configure LIBS=\"`pkg-config --libs-only-l cblas` -lm\"\n> > ```\n> > in GSL's spkg-install.in should be\n> > \n> > ```\n> > sdh_configure LIBS=\"`pkg-config --libs cblas` -lm\"\n> > ```\n> > \n> > (`--libs-only-l` doesn't print `-L` flags.)\n> > \n> > Can you try the latter line without `CFLAGS` ?\n\n> \n> Will do.\n\n\nPerhaps one should leave that LIBS settings alone, and add LDFLAGS (it's weird that CFLAGS worked for you!) as follows:\n\n```\nsdh_configure LIBS=\"`pkg-config --libs-only-l cblas` -lm\" LDFLAGS=\"$LDFLAGS `pkg-config --libs-only-L cblas`\"\n```",
    "created_at": "2021-10-19T15:27:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601194",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:42'></a>
Replying to [jhpalmieri](#comment%3A40):
> Replying to [dimpase](#comment%3A38):
> > Regarding the 1st issue: if you fire up `./sage --buildsh`, and at its prompt, run
> > `pkg-config --libs cblas`, what's the output?

> {{{
> -L/usr/local/Cellar/openblas/0.3.18/lib -lopenblas
> }}}
> > 
> > I suspect that 
> > 
> > ```
> > sdh_configure LIBS="`pkg-config --libs-only-l cblas` -lm"
> > ```
> > in GSL's spkg-install.in should be
> > 
> > ```
> > sdh_configure LIBS="`pkg-config --libs cblas` -lm"
> > ```
> > 
> > (`--libs-only-l` doesn't print `-L` flags.)
> > 
> > Can you try the latter line without `CFLAGS` ?

> 
> Will do.


Perhaps one should leave that LIBS settings alone, and add LDFLAGS (it's weird that CFLAGS worked for you!) as follows:

```
sdh_configure LIBS="`pkg-config --libs-only-l cblas` -lm" LDFLAGS="$LDFLAGS `pkg-config --libs-only-L cblas`"
```



---

archive/issue_comments_601195.json:
```json
{
    "body": "<a id='comment:43'></a>\nReplying to [dimpase](#comment%3A42):\n> Perhaps one should leave that LIBS settings alone, and add LDFLAGS (it's weird that CFLAGS worked for you!) as follows:\n> \n> ```\n> sdh_configure LIBS=\"`pkg-config --libs-only-l cblas` -lm\" LDFLAGS=\"$LDFLAGS `pkg-config --libs-only-L cblas`\"\n> ``` \n\n\n`gsl` builds but the `sagelib` package fails to build this way: `ld: library not found for -lopenblas`.",
    "created_at": "2021-10-19T16:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601195",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:43'></a>
Replying to [dimpase](#comment%3A42):
> Perhaps one should leave that LIBS settings alone, and add LDFLAGS (it's weird that CFLAGS worked for you!) as follows:
> 
> ```
> sdh_configure LIBS="`pkg-config --libs-only-l cblas` -lm" LDFLAGS="$LDFLAGS `pkg-config --libs-only-L cblas`"
> ``` 


`gsl` builds but the `sagelib` package fails to build this way: `ld: library not found for -lopenblas`.



---

archive/issue_comments_601196.json:
```json
{
    "body": "<a id='comment:44'></a>\nhow about \n\n```diff\n--- a/.homebrew-build-env\n+++ b/.homebrew-build-env\n@@ -23,7 +23,7 @@ export PKG_CONFIG_PATH\n LIBRARY_PATH=\"$HOMEBREW/lib$LIBRARY_PATH\"\n [ -z \"$CPATH\" ] || CPATH=\":${CPATH}\"\n CPATH=\"$HOMEBREW/include$CPATH\"\n-for l in readline bzip2 ntl; do\n+for l in readline bzip2 ntl openblas; do\n     if [ -d \"$HOMEBREW/opt/$l/lib\" ]; then\n         LIBRARY_PATH=\"$HOMEBREW/opt/$l/lib:$LIBRARY_PATH\"\n     fi\n```\ni.e. change `.homebrew-build-env` as above, source it, and then run `make build` again.",
    "created_at": "2021-10-19T16:59:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601196",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:44'></a>
how about 

```diff
--- a/.homebrew-build-env
+++ b/.homebrew-build-env
@@ -23,7 +23,7 @@ export PKG_CONFIG_PATH
 LIBRARY_PATH="$HOMEBREW/lib$LIBRARY_PATH"
 [ -z "$CPATH" ] || CPATH=":${CPATH}"
 CPATH="$HOMEBREW/include$CPATH"
-for l in readline bzip2 ntl; do
+for l in readline bzip2 ntl openblas; do
     if [ -d "$HOMEBREW/opt/$l/lib" ]; then
         LIBRARY_PATH="$HOMEBREW/opt/$l/lib:$LIBRARY_PATH"
     fi
```
i.e. change `.homebrew-build-env` as above, source it, and then run `make build` again.



---

archive/issue_comments_601197.json:
```json
{
    "body": "<a id='comment:45'></a>\nI'm really confused now.\n\n- With the changes you suggested in [comment:42](#comment%3A42) and [comment:44](#comment%3A44) (set LDFLAGS and modify `.homebrew-build-env`), Sage builds, but the example in [comment:17](#comment%3A17) fails and I see the numerical failures in doctesting.\n- If instead I build Sage as in [comment:36](#comment%3A36) (exporting `CFLAGS`), then Sage builds (although with warnings \"clang: warning: argument unused during compilation: '-L/usr/local/opt/openblas/lib' [-Wunused-command-line-argument]\") and the example in [comment:17](#comment%3A17) works. `./sage -tp --long src/sage/matrix` succeeds: no numerical failures.",
    "created_at": "2021-10-19T18:59:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601197",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:45'></a>
I'm really confused now.

- With the changes you suggested in [comment:42](#comment%3A42) and [comment:44](#comment%3A44) (set LDFLAGS and modify `.homebrew-build-env`), Sage builds, but the example in [comment:17](#comment%3A17) fails and I see the numerical failures in doctesting.
- If instead I build Sage as in [comment:36](#comment%3A36) (exporting `CFLAGS`), then Sage builds (although with warnings "clang: warning: argument unused during compilation: '-L/usr/local/opt/openblas/lib' [-Wunused-command-line-argument]") and the example in [comment:17](#comment%3A17) works. `./sage -tp --long src/sage/matrix` succeeds: no numerical failures.



---

archive/issue_comments_601198.json:
```json
{
    "body": "<a id='comment:46'></a>\nprobably \"success\" with gsl comes from it not using openblas at all. You can check by running `otool -L `",
    "created_at": "2021-10-19T20:15:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601198",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:46'></a>
probably "success" with gsl comes from it not using openblas at all. You can check by running `otool -L `



---

archive/issue_comments_601199.json:
```json
{
    "body": "<a id='comment:47'></a>\n`% otool -L local/lib/libgsl.25.dylib` returns the same thing in each of the two cases (edited to replace the actual path with `$SAGE_ROOT`):\n\n```\n% otool -L local/lib/libgsl.25.dylib \nlocal/lib/libgsl.25.dylib:\n\t$SAGE_ROOT/local/lib/libgsl.25.dylib (compatibility version 26.0.0, current version 26.0.0)\n\t/usr/local/opt/openblas/lib/libopenblas.0.dylib (compatibility version 0.0.0, current version 0.0.0)\n\t/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1292.100.5)\n```",
    "created_at": "2021-10-19T21:00:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601199",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:47'></a>
`% otool -L local/lib/libgsl.25.dylib` returns the same thing in each of the two cases (edited to replace the actual path with `$SAGE_ROOT`):

```
% otool -L local/lib/libgsl.25.dylib 
local/lib/libgsl.25.dylib:
	$SAGE_ROOT/local/lib/libgsl.25.dylib (compatibility version 26.0.0, current version 26.0.0)
	/usr/local/opt/openblas/lib/libopenblas.0.dylib (compatibility version 0.0.0, current version 0.0.0)
	/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1292.100.5)
```



---

archive/issue_comments_601200.json:
```json
{
    "body": "<a id='comment:48'></a>\nSame with `otool -L local/lib/libgslcblas.0.dylib`.",
    "created_at": "2021-10-19T21:01:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601200",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:48'></a>
Same with `otool -L local/lib/libgslcblas.0.dylib`.



---

archive/issue_comments_601201.json:
```json
{
    "body": "<a id='comment:49'></a>\nI can only say that exporting `-L` flag in CFLAGS makes little sense to me.\nI'd like to see GSLs config.log when it's set, and when it's not (as in [comment:6](#comment%3A6) are you sure your CFLAGS didn't contain something wrong then?).",
    "created_at": "2021-10-19T21:52:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601201",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:49'></a>
I can only say that exporting `-L` flag in CFLAGS makes little sense to me.
I'd like to see GSLs config.log when it's set, and when it's not (as in [comment:6](#comment%3A6) are you sure your CFLAGS didn't contain something wrong then?).



---

archive/issue_comments_601202.json:
```json
{
    "body": "<a id='comment:50'></a>\n\n```\n% echo $CFLAGS\n-L/usr/local/opt/openblas/lib\n```\nBut this causes other changes in the Sage build: when I set `CFLAGS` manually, then Sage does not add `-O2 -g -march=native`. Maybe one of those flags makes a difference. I'll try to test it out.",
    "created_at": "2021-10-19T22:36:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601202",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:50'></a>

```
% echo $CFLAGS
-L/usr/local/opt/openblas/lib
```
But this causes other changes in the Sage build: when I set `CFLAGS` manually, then Sage does not add `-O2 -g -march=native`. Maybe one of those flags makes a difference. I'll try to test it out.



---

archive/attachments_021503.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "gsl-2.6.log.CFLAGS",
    "asset_url": "tarball://root/attachments/some-uuid/ticket31621/gsl-2.6.log.CFLAGS",
    "created_at": "2021-10-19T22:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.CFLAGS",
    "user": "https://github.com/jhpalmieri"
}
```



---

archive/issue_comments_601203.json:
```json
{
    "body": "",
    "created_at": "2021-10-19T22:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601203",
    "user": "https://github.com/jhpalmieri"
}
```





---

archive/attachments_021504.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "gsl-2.6.log.do-not-set-CFLAGS",
    "asset_url": "tarball://root/attachments/some-uuid/ticket31621/gsl-2.6.log.do-not-set-CFLAGS",
    "created_at": "2021-10-20T09:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.do-not-set-CFLAGS",
    "user": "https://github.com/dimpase"
}
```



---

archive/issue_comments_601204.json:
```json
{
    "body": "<a id='comment:51'></a>\nI guess it's `-march=native` to blame for this. Overwriting `CFLAGS` to exclude it for `gsl` makes a difference (see  #27122), and we saw this a number of times lately in regard of `openblas`. Not all Xeon CPUs are created equal. :/",
    "created_at": "2021-10-20T09:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601204",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:51'></a>
I guess it's `-march=native` to blame for this. Overwriting `CFLAGS` to exclude it for `gsl` makes a difference (see  #27122), and we saw this a number of times lately in regard of `openblas`. Not all Xeon CPUs are created equal. :/



---

archive/issue_comments_601205.json:
```json
{
    "body": "<a id='comment:52'></a>\nAfter a `make openblas` sage fails to start with\n\n```\n~/sage/local/lib/python3.9/site-packages/sage/matrix/matrix_space.py in <module>\n     42 \n---> 43 from . import matrix_modn_sparse\n        global matrix_modn_sparse = undefined\n     44\n\nImportError: /lib/x86_64-linux-gnu/libblas.so.3: undefined symbol: gotoblas\n```\nI thought that this would have solved my problem but instead created another one.",
    "created_at": "2021-10-20T17:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601205",
    "user": "https://github.com/videlec"
}
```

<a id='comment:52'></a>
After a `make openblas` sage fails to start with

```
~/sage/local/lib/python3.9/site-packages/sage/matrix/matrix_space.py in <module>
     42 
---> 43 from . import matrix_modn_sparse
        global matrix_modn_sparse = undefined
     44

ImportError: /lib/x86_64-linux-gnu/libblas.so.3: undefined symbol: gotoblas
```
I thought that this would have solved my problem but instead created another one.



---

archive/issue_comments_601206.json:
```json
{
    "body": "<a id='comment:53'></a>\nhave you rebuilt sagelib?\n\n```\nmake sagelib-clean && make build\n```",
    "created_at": "2021-10-20T19:26:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601206",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:53'></a>
have you rebuilt sagelib?

```
make sagelib-clean && make build
```



---

archive/issue_comments_601207.json:
```json
{
    "body": "<a id='comment:54'></a>\nSeparately from the other issues, should we change gsl's `spkg-install.in` to use\n\n```\nsdh_configure LIBS=\"`pkg-config --libs-only-l cblas` -lm\" LDFLAGS=\"$LDFLAGS `pkg-config --libs-only-L cblas`\"\n```\nas suggested in [comment:42](#comment%3A42)? And should `pkgconf` be a dependency for `gsl`, to make sure `pkg-config` is available for this command?",
    "created_at": "2021-10-21T19:52:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601207",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:54'></a>
Separately from the other issues, should we change gsl's `spkg-install.in` to use

```
sdh_configure LIBS="`pkg-config --libs-only-l cblas` -lm" LDFLAGS="$LDFLAGS `pkg-config --libs-only-L cblas`"
```
as suggested in [comment:42](#comment%3A42)? And should `pkgconf` be a dependency for `gsl`, to make sure `pkg-config` is available for this command?



---

archive/issue_comments_601208.json:
```json
{
    "body": "<a id='comment:55'></a>\nReplying to [jhpalmieri](#comment%3A54):\n> Separately from the other issues, should we change gsl's `spkg-install.in` to use\n> \n> ```\n> sdh_configure LIBS=\"`pkg-config --libs-only-l cblas` -lm\" LDFLAGS=\"$LDFLAGS `pkg-config --libs-only-L cblas`\"\n> ```\n> as suggested in [comment:42](#comment%3A42)?\n\nyes\n\n> And should `pkgconf` be a dependency for `gsl`, to make sure `pkg-config` is available for this command?\n\nyes (an order-only dependency, just like for `r`).",
    "created_at": "2021-10-22T09:55:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601208",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:55'></a>
Replying to [jhpalmieri](#comment%3A54):
> Separately from the other issues, should we change gsl's `spkg-install.in` to use
> 
> ```
> sdh_configure LIBS="`pkg-config --libs-only-l cblas` -lm" LDFLAGS="$LDFLAGS `pkg-config --libs-only-L cblas`"
> ```
> as suggested in [comment:42](#comment%3A42)?

yes

> And should `pkgconf` be a dependency for `gsl`, to make sure `pkg-config` is available for this command?

yes (an order-only dependency, just like for `r`).



---

archive/issue_comments_601209.json:
```json
{
    "body": "<a id='comment:56'></a>\nBy the way, if I build all of Sage with `export CFLAGS='-O2 -g'`, just with a plain `./configure` so using all of homebrew's packages, tests pass. So allowing  `-march=native` to remain (by not explicitly setting `CFLAGS`) on this machine causes problems in building parts of Sage.",
    "created_at": "2021-10-22T21:47:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601209",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:56'></a>
By the way, if I build all of Sage with `export CFLAGS='-O2 -g'`, just with a plain `./configure` so using all of homebrew's packages, tests pass. So allowing  `-march=native` to remain (by not explicitly setting `CFLAGS`) on this machine causes problems in building parts of Sage.



---

archive/issue_comments_601210.json:
```json
{
    "body": "<a id='comment:57'></a>\nShouldn't `CPPFLAGS` also be set using pkgconfig?",
    "created_at": "2021-10-23T22:56:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601210",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:57'></a>
Shouldn't `CPPFLAGS` also be set using pkgconfig?



---

archive/issue_comments_601211.json:
```json
{
    "body": "<a id='comment:58'></a>\n(in the branch of #32587)",
    "created_at": "2021-10-24T20:09:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601211",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:58'></a>
(in the branch of #32587)



---

archive/issue_comments_601212.json:
```json
{
    "body": "<a id='comment:59'></a>\nReplying to [mkoeppe](#comment%3A57):\n> Shouldn't `CPPFLAGS` also be set using pkgconfig?\n\n\nIt builds without that, but please modify that branch if you think it's a good idea.",
    "created_at": "2021-10-27T04:52:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601212",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:59'></a>
Replying to [mkoeppe](#comment%3A57):
> Shouldn't `CPPFLAGS` also be set using pkgconfig?


It builds without that, but please modify that branch if you think it's a good idea.



---

archive/issue_events_093397.json:
```json
{
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "label": "blocker",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31621#event-93397"
}
```



---

archive/issue_comments_601213.json:
```json
{
    "body": "<a id='comment:60'></a>\nStill the same in 9.5.beta6",
    "created_at": "2021-11-13T17:21:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601213",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:60'></a>
Still the same in 9.5.beta6



---

archive/issue_comments_601214.json:
```json
{
    "body": "<a id='comment:61'></a>\nWhat's the status here?",
    "created_at": "2021-12-21T17:02:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601214",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:61'></a>
What's the status here?



---

archive/issue_events_093398.json:
```json
{
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "label": "blocker",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31621#event-93398"
}
```



---

archive/issue_comments_601215.json:
```json
{
    "body": "<a id='comment:62'></a>\nWe can no longer test `ubuntu-groovy`, and the failures do not show up in any other Debian and Ubuntu variants tested in https://github.com/sagemath/sage/actions/runs/1673712139 (for 9.5.rc0). \n\nSo perhaps we can close it?",
    "created_at": "2022-01-10T23:03:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601215",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:62'></a>
We can no longer test `ubuntu-groovy`, and the failures do not show up in any other Debian and Ubuntu variants tested in https://github.com/sagemath/sage/actions/runs/1673712139 (for 9.5.rc0). 

So perhaps we can close it?



---

archive/issue_events_093399.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-28T23:11:40Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31621#event-93399"
}
```



---

archive/issue_events_093400.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-28T23:11:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31621#event-93400"
}
```



---

archive/issue_events_093401.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31621#event-93401"
}
```



---

archive/issue_events_093402.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31621#event-93402"
}
```



---

archive/issue_comments_601216.json:
```json
{
    "body": "<a id='comment:65'></a>\nSeen again in 9.7.rc0 on `debian-bullseye-standard`\nhttps://github.com/sagemath/sage/runs/8104739123?check_suite_focus=true",
    "created_at": "2022-09-02T04:36:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31621#issuecomment-601216",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:65'></a>
Seen again in 9.7.rc0 on `debian-bullseye-standard`
https://github.com/sagemath/sage/runs/8104739123?check_suite_focus=true



---

archive/issue_events_093403.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31621#event-93403"
}
```



---

archive/issue_events_093404.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31621",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31621#event-93404"
}
```
