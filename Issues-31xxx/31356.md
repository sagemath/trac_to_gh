# Issue 31356: Restructure docbuild as script packages sagemath_doc_html, sagemath_doc_pdf

archive/issues_031119.json:
```json
{
    "body": "The specific code in `Makefile.in` for the documentation and its dependencies is moved to the new script packages.\n\nIn preparation for #32759:\n- We introduce another installation tree (in addition to `SAGE_LOCAL` and `SAGE_VENV`), called `SAGE_DOCS`. When the installation tree variable is empty, we suppress building the package.\n- We introduce a mechanism to select an installation tree, the file `trees.txt`. Using this mechanism, we associate the new script packages with the installation tree `SAGE_DOCS`.\n\nNext step: \n- #32759 `./configure --disable-doc`\n- #29868 pip-installable packages `sagemath-doc-src`, `sagemath-doc-inventory`, `sagemath-doc-html`, `sagemath-doc-pdf`\n- rename `src/doc/bootstrap` to `build/pkgs/sagemath_doc_html/bootstrap`.\n\n\nCC:  @jhpalmieri\n\nBranch/Commit: fd298c4b7a6f845335b862f6dc2f8e18753937e7\n\nReviewer: John Palmieri\n\nAuthor: Matthias Koeppe\n\nDependencies: #30383\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/31356\n\n",
    "closed_at": "2021-11-14T17:06:30Z",
    "created_at": "2021-02-07T18:33:03Z",
    "labels": [
        "component: documentation"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Restructure docbuild as script packages sagemath_doc_html, sagemath_doc_pdf",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31356",
    "user": "https://github.com/mkoeppe"
}
```
The specific code in `Makefile.in` for the documentation and its dependencies is moved to the new script packages.

In preparation for #32759:
- We introduce another installation tree (in addition to `SAGE_LOCAL` and `SAGE_VENV`), called `SAGE_DOCS`. When the installation tree variable is empty, we suppress building the package.
- We introduce a mechanism to select an installation tree, the file `trees.txt`. Using this mechanism, we associate the new script packages with the installation tree `SAGE_DOCS`.

Next step: 
- #32759 `./configure --disable-doc`
- #29868 pip-installable packages `sagemath-doc-src`, `sagemath-doc-inventory`, `sagemath-doc-html`, `sagemath-doc-pdf`
- rename `src/doc/bootstrap` to `build/pkgs/sagemath_doc_html/bootstrap`.


CC:  @jhpalmieri

Branch/Commit: fd298c4b7a6f845335b862f6dc2f8e18753937e7

Reviewer: John Palmieri

Author: Matthias Koeppe

Dependencies: #30383

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/31356





---

archive/issue_events_082146.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31356#event-82146"
}
```



---

archive/issue_comments_474467.json:
```json
{
    "body": "<a id='comment:2'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474467",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_474468.json:
```json
{
    "body": "<a id='comment:3'></a>New commits:",
    "created_at": "2021-02-25T04:56:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474468",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>New commits:



---

archive/issue_comments_474469.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2021-02-25T05:40:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474469",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_474470.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-25T05:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474470",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_474471.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-25T05:48:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474471",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_474472.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,9 @@\n In particular, we make building the HTML documentation optional.\n+\n+Next step: \n+- #29868 pip-installable packages `sagemath-doc-src`, `sagemath-doc-inventory`, `sagemath-doc-html`, `sagemath-doc-pdf`\n+\n+\n \n Comment: 1\n \n``````\n",
    "created_at": "2021-03-10T01:54:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474472",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,9 @@
 In particular, we make building the HTML documentation optional.
+
+Next step: 
+- #29868 pip-installable packages `sagemath-doc-src`, `sagemath-doc-inventory`, `sagemath-doc-html`, `sagemath-doc-pdf`
+
+
 
 Comment: 1
 
``````




---

archive/issue_comments_474473.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,8 @@\n+In particular, we make building the HTML documentation disablable using `./configure --disable-doc` - in which case also various sphinx packages are deselected.\n+\n+Next step: \n+- #29868 pip-installable packages `sagemath-doc-src`, `sagemath-doc-inventory`, `sagemath-doc-html`, `sagemath-doc-pdf`\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-03-15T06:08:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474473",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,8 @@
+In particular, we make building the HTML documentation disablable using `./configure --disable-doc` - in which case also various sphinx packages are deselected.
+
+Next step: 
+- #29868 pip-installable packages `sagemath-doc-src`, `sagemath-doc-inventory`, `sagemath-doc-html`, `sagemath-doc-pdf`
+
 
 
 Comment: 1
``````




---

archive/issue_comments_474474.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-03-15T06:10:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474474",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_474475.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,10 @@\n+In particular, we make building the HTML documentation disablable using `./configure --disable-doc` - in which case also various sphinx packages are deselected.\n+\n+Also `src/doc/bootstrap` will be renamed `build/pkgs/sagemath_doc_html/bootstrap`.\n+\n+Next step: \n+- #29868 pip-installable packages `sagemath-doc-src`, `sagemath-doc-inventory`, `sagemath-doc-html`, `sagemath-doc-pdf`\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-03-23T06:03:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474475",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,10 @@
+In particular, we make building the HTML documentation disablable using `./configure --disable-doc` - in which case also various sphinx packages are deselected.
+
+Also `src/doc/bootstrap` will be renamed `build/pkgs/sagemath_doc_html/bootstrap`.
+
+Next step: 
+- #29868 pip-installable packages `sagemath-doc-src`, `sagemath-doc-inventory`, `sagemath-doc-html`, `sagemath-doc-pdf`
+
 
 
 Comment: 1
``````




---

archive/issue_comments_474476.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,10 @@\n+In particular, we make building the HTML documentation disablable using `./configure --disable-doc` - in which case also various sphinx packages are deselected.  (In this case, we also set `SAGE_SPKG_INSTALL_DOCS` explicitly = no, in order to disable the `pplpy` docbuild.)\n+\n+Also `src/doc/bootstrap` will be renamed `build/pkgs/sagemath_doc_html/bootstrap`.\n+\n+Next step: \n+- #29868 pip-installable packages `sagemath-doc-src`, `sagemath-doc-inventory`, `sagemath-doc-html`, `sagemath-doc-pdf`\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-03-27T02:56:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474476",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,10 @@
+In particular, we make building the HTML documentation disablable using `./configure --disable-doc` - in which case also various sphinx packages are deselected.  (In this case, we also set `SAGE_SPKG_INSTALL_DOCS` explicitly = no, in order to disable the `pplpy` docbuild.)
+
+Also `src/doc/bootstrap` will be renamed `build/pkgs/sagemath_doc_html/bootstrap`.
+
+Next step: 
+- #29868 pip-installable packages `sagemath-doc-src`, `sagemath-doc-inventory`, `sagemath-doc-html`, `sagemath-doc-pdf`
+
 
 
 Comment: 1
``````




---

archive/issue_events_082147.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31356#event-82147"
}
```



---

archive/issue_events_082148.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31356#event-82148"
}
```



---

archive/issue_comments_474477.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-10-29T23:55:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474477",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_474478.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-10-30T00:07:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474478",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_474479.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-30T05:16:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474479",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_474480.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-01T02:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474480",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_474481.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-11-09T00:19:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474481",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_474482.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,11 @@\n+In particular, we make building the HTML documentation disablable using `./configure --disable-doc` - in which case also various sphinx packages are deselected.  (In this case, we also set `SAGE_SPKG_INSTALL_DOCS` explicitly = no, in order to disable the `pplpy` docbuild.)\n+\n+Also \n+\n+Next step: \n+- #32759 `./configure --disable-doc`\n+- #29868 pip-installable packages `sagemath-doc-src`, `sagemath-doc-inventory`, `sagemath-doc-html`, `sagemath-doc-pdf`\n+- rename `src/doc/bootstrap` to `build/pkgs/sagemath_doc_html/bootstrap`.\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-11-09T00:21:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474482",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,11 @@
+In particular, we make building the HTML documentation disablable using `./configure --disable-doc` - in which case also various sphinx packages are deselected.  (In this case, we also set `SAGE_SPKG_INSTALL_DOCS` explicitly = no, in order to disable the `pplpy` docbuild.)
+
+Also 
+
+Next step: 
+- #32759 `./configure --disable-doc`
+- #29868 pip-installable packages `sagemath-doc-src`, `sagemath-doc-inventory`, `sagemath-doc-html`, `sagemath-doc-pdf`
+- rename `src/doc/bootstrap` to `build/pkgs/sagemath_doc_html/bootstrap`.
 
 
 Comment: 1
``````




---

archive/issue_comments_474483.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-11-09T00:21:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474483",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_474484.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-09T00:26:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474484",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_474485.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-09T01:27:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474485",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_474486.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,13 @@\n+The specific code in `Makefile.in` for the documentation and its dependencies is moved to the new script packages.\n+\n+In preparation for #32579:\n+- We introduce another installation tree (in addition to `SAGE_LOCAL` and `SAGE_VENV`), called `SAGE_DOCS`. When the installation tree variable is empty, we suppress building the package.\n+- We introduce a mechanism to select an installation tree, the file `trees.txt`. Using this mechanism, we associate the new script packages with the installation tree `SAGE_DOCS`.\n+\n+Next step: \n+- #32759 `./configure --disable-doc`\n+- #29868 pip-installable packages `sagemath-doc-src`, `sagemath-doc-inventory`, `sagemath-doc-html`, `sagemath-doc-pdf`\n+- rename `src/doc/bootstrap` to `build/pkgs/sagemath_doc_html/bootstrap`.\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-11-09T01:36:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474486",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,13 @@
+The specific code in `Makefile.in` for the documentation and its dependencies is moved to the new script packages.
+
+In preparation for #32579:
+- We introduce another installation tree (in addition to `SAGE_LOCAL` and `SAGE_VENV`), called `SAGE_DOCS`. When the installation tree variable is empty, we suppress building the package.
+- We introduce a mechanism to select an installation tree, the file `trees.txt`. Using this mechanism, we associate the new script packages with the installation tree `SAGE_DOCS`.
+
+Next step: 
+- #32759 `./configure --disable-doc`
+- #29868 pip-installable packages `sagemath-doc-src`, `sagemath-doc-inventory`, `sagemath-doc-html`, `sagemath-doc-pdf`
+- rename `src/doc/bootstrap` to `build/pkgs/sagemath_doc_html/bootstrap`.
 
 
 Comment: 1
``````




---

archive/issue_comments_474487.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,13 @@\n+The specific code in `Makefile.in` for the documentation and its dependencies is moved to the new script packages.\n+\n+In preparation for #32759:\n+- We introduce another installation tree (in addition to `SAGE_LOCAL` and `SAGE_VENV`), called `SAGE_DOCS`. When the installation tree variable is empty, we suppress building the package.\n+- We introduce a mechanism to select an installation tree, the file `trees.txt`. Using this mechanism, we associate the new script packages with the installation tree `SAGE_DOCS`.\n+\n+Next step: \n+- #32759 `./configure --disable-doc`\n+- #29868 pip-installable packages `sagemath-doc-src`, `sagemath-doc-inventory`, `sagemath-doc-html`, `sagemath-doc-pdf`\n+- rename `src/doc/bootstrap` to `build/pkgs/sagemath_doc_html/bootstrap`.\n \n \n Comment: 1\n``````\n",
    "created_at": "2021-11-09T01:37:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474487",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,13 @@
+The specific code in `Makefile.in` for the documentation and its dependencies is moved to the new script packages.
+
+In preparation for #32759:
+- We introduce another installation tree (in addition to `SAGE_LOCAL` and `SAGE_VENV`), called `SAGE_DOCS`. When the installation tree variable is empty, we suppress building the package.
+- We introduce a mechanism to select an installation tree, the file `trees.txt`. Using this mechanism, we associate the new script packages with the installation tree `SAGE_DOCS`.
+
+Next step: 
+- #32759 `./configure --disable-doc`
+- #29868 pip-installable packages `sagemath-doc-src`, `sagemath-doc-inventory`, `sagemath-doc-html`, `sagemath-doc-pdf`
+- rename `src/doc/bootstrap` to `build/pkgs/sagemath_doc_html/bootstrap`.
 
 
 Comment: 1
``````




---

archive/issue_comments_474488.json:
```json
{
    "body": "<a id='comment:24'></a>I feel like `trees.txt` should be `tree.txt`, unless there is some way to specify more than one tree there. Obviously not a big deal. I would like this file to be documented, though, and maybe a comment in `m4/sage_spkg_collect.m4` is the right place.",
    "created_at": "2021-11-09T05:44:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474488",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:24'></a>I feel like `trees.txt` should be `tree.txt`, unless there is some way to specify more than one tree there. Obviously not a big deal. I would like this file to be documented, though, and maybe a comment in `m4/sage_spkg_collect.m4` is the right place.



---

archive/issue_comments_474489.json:
```json
{
    "body": "<a id='comment:25'></a>Yes, actually several trees are allowed to be specified there.\nWe don't need this quite yet, but a separate environment for the Jupyter notebook could make sense; and then some packages such as `jupyter_core` would have to be installed in both `SAGE_VENV` and the new notebook environment.",
    "created_at": "2021-11-09T05:48:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474489",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>Yes, actually several trees are allowed to be specified there.
We don't need this quite yet, but a separate environment for the Jupyter notebook could make sense; and then some packages such as `jupyter_core` would have to be installed in both `SAGE_VENV` and the new notebook environment.



---

archive/issue_comments_474490.json:
```json
{
    "body": "<a id='comment:26'></a>I'll add a bit to the developer's guide",
    "created_at": "2021-11-09T05:50:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474490",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>I'll add a bit to the developer's guide



---

archive/issue_comments_474491.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-09T06:00:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474491",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_474492.json:
```json
{
    "body": "<a id='comment:28'></a>It's not clear to me what `./configure --enable-sagemath_doc_pdf` is supposed to do just by reading `./configure --help`. If I run `make`, will it also run `make doc-pdf`, or does it just do some prep work for the PDF build? I see this:\n\n```\n  --enable-sagemath_doc_pdf={no|if_installed (default)|yes}\n                          enable build and use of the optional package sagemath_doc_pdf\n                          * package info: ./sage -info sagemath_doc_pdf\n```\nand then unfortunately `./sage -info sagemath_doc_pdf` is not very useful.",
    "created_at": "2021-11-09T19:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474492",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:28'></a>It's not clear to me what `./configure --enable-sagemath_doc_pdf` is supposed to do just by reading `./configure --help`. If I run `make`, will it also run `make doc-pdf`, or does it just do some prep work for the PDF build? I see this:

```
  --enable-sagemath_doc_pdf={no|if_installed (default)|yes}
                          enable build and use of the optional package sagemath_doc_pdf
                          * package info: ./sage -info sagemath_doc_pdf
```
and then unfortunately `./sage -info sagemath_doc_pdf` is not very useful.



---

archive/issue_comments_474493.json:
```json
{
    "body": "<a id='comment:29'></a>I'll add `SPKG.rst` files to make the info more useful",
    "created_at": "2021-11-09T19:36:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474493",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>I'll add `SPKG.rst` files to make the info more useful



---

archive/issue_comments_474494.json:
```json
{
    "body": "<a id='comment:30'></a>I think that `sage_docbuild` should be a dependency of each of the new packages: I just got this error (`sagemath_doc_html-none.log`):\n\n```\n/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/local/var/lib/sage/venv-python3.9/bin/python3: No module named sage_docbuild\nmake doc-inventory--\ncd /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5 && ./sage --docbuild --no-pdf-links .o inventory \n/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/local/var/lib/sage/venv-python3.9/bin/python3: No module named sage_docbuild\nmake[6]: *** [doc-inventory--.o] Error 1\nmake[5]: *** [doc-inventory-reference] Error 2\n```",
    "created_at": "2021-11-09T19:57:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474494",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:30'></a>I think that `sage_docbuild` should be a dependency of each of the new packages: I just got this error (`sagemath_doc_html-none.log`):

```
/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/local/var/lib/sage/venv-python3.9/bin/python3: No module named sage_docbuild
make doc-inventory--
cd /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5 && ./sage --docbuild --no-pdf-links .o inventory 
/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/local/var/lib/sage/venv-python3.9/bin/python3: No module named sage_docbuild
make[6]: *** [doc-inventory--.o] Error 1
make[5]: *** [doc-inventory-reference] Error 2
```



---

archive/issue_comments_474495.json:
```json
{
    "body": "<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-09T20:02:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474495",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_474496.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-09T20:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474496",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_474497.json:
```json
{
    "body": "<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-09T20:23:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474497",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_474498.json:
```json
{
    "body": "<a id='comment:34'></a>I'm getting an error with the pdf build, one that I don't get with the `develop` branch: `en/reference/plotting` is failing, and the file `local/share/doc/sage/latex/en/reference/plotting/plotting.log` ends with\n\n```\nPackage pdftex.def Info: plot-23.pdf  used on input line 864.\n(pdftex.def)             Requested size: 462.52684pt x 346.89516pt.\n<plot-24.pdf, id=486, 462.52798pt x 346.89601pt>\nFile: plot-24.pdf Graphic file (type pdf)\n<use plot-24.pdf>\nPackage pdftex.def Info: plot-24.pdf  used on input line 884.\n(pdftex.def)             Requested size: 462.52684pt x 346.89516pt.\n\n[23 <./plot-22.pdf>] [24 <./plot-23.pdf>] [25 <./plot-24.pdf\n!pdfTeX error: pdflatex (file ./plot-24.pdf): PDF inclusion: type <cmd> cannot \nbe copied\n ==> Fatal error occurred, no output PDF file produced!\n```\nAny ideas?",
    "created_at": "2021-11-09T21:18:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474498",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:34'></a>I'm getting an error with the pdf build, one that I don't get with the `develop` branch: `en/reference/plotting` is failing, and the file `local/share/doc/sage/latex/en/reference/plotting/plotting.log` ends with

```
Package pdftex.def Info: plot-23.pdf  used on input line 864.
(pdftex.def)             Requested size: 462.52684pt x 346.89516pt.
<plot-24.pdf, id=486, 462.52798pt x 346.89601pt>
File: plot-24.pdf Graphic file (type pdf)
<use plot-24.pdf>
Package pdftex.def Info: plot-24.pdf  used on input line 884.
(pdftex.def)             Requested size: 462.52684pt x 346.89516pt.

[23 <./plot-22.pdf>] [24 <./plot-23.pdf>] [25 <./plot-24.pdf
!pdfTeX error: pdflatex (file ./plot-24.pdf): PDF inclusion: type <cmd> cannot 
be copied
 ==> Fatal error occurred, no output PDF file produced!
```
Any ideas?



---

archive/issue_comments_474499.json:
```json
{
    "body": "<a id='comment:35'></a>No idea, I haven't seen this failure",
    "created_at": "2021-11-09T21:40:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474499",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:35'></a>No idea, I haven't seen this failure



---

archive/issue_comments_474500.json:
```json
{
    "body": "<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-09T21:52:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474500",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_474501.json:
```json
{
    "body": "<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-09T21:55:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474501",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_474502.json:
```json
{
    "body": "<a id='comment:38'></a>I'm also getting an error with the html build:\n\n```\n[developer] The HTML pages are in local/share/doc/sage/html/en/developer.\nError building the documentation.\nTraceback (most recent call last):\n  File \"/usr/local/Cellar/python@3.9/3.9.7_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py\", line 197, in _run_module_as_main\n    return _run_code(code, main_globals, None,\n  File \"/usr/local/Cellar/python@3.9/3.9.7_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py\", line 87, in _run_code\n    exec(code, run_globals)\n  File \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/__main__.py\", line 2, in <module>\n    main()\n  File \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/__init__.py\", line 1814, in main\n    builder()\n  File \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/__init__.py\", line 133, in f\n    runsphinx()\n  File \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/sphinxbuild.py\", line 323, in runsphinx\n    sys.stderr.raise_errors()\n  File \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/sphinxbuild.py\", line 258, in raise_errors\n    raise OSError(self._error)\nOSError: /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/src/doc/en/developer/packaging.rst:721: WARNING: Duplicate explicit target name: \"section-dependencies\".\n```\nThis is after `make distclean && ./configure && make`.",
    "created_at": "2021-11-09T23:03:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474502",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:38'></a>I'm also getting an error with the html build:

```
[developer] The HTML pages are in local/share/doc/sage/html/en/developer.
Error building the documentation.
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.7_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.7_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/__main__.py", line 2, in <module>
    main()
  File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/__init__.py", line 1814, in main
    builder()
  File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/__init__.py", line 133, in f
    runsphinx()
  File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/sphinxbuild.py", line 323, in runsphinx
    sys.stderr.raise_errors()
  File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/sphinxbuild.py", line 258, in raise_errors
    raise OSError(self._error)
OSError: /Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/src/doc/en/developer/packaging.rst:721: WARNING: Duplicate explicit target name: "section-dependencies".
```
This is after `make distclean && ./configure && make`.



---

archive/issue_comments_474503.json:
```json
{
    "body": "<a id='comment:39'></a>Thanks, I see this one now too, after `make distclean`",
    "created_at": "2021-11-10T00:05:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474503",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:39'></a>Thanks, I see this one now too, after `make distclean`



---

archive/issue_comments_474504.json:
```json
{
    "body": "<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-10T00:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474504",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_474505.json:
```json
{
    "body": "<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-10T00:21:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474505",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_474506.json:
```json
{
    "body": "<a id='comment:42'></a>PDF builds for me without error",
    "created_at": "2021-11-10T02:28:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474506",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:42'></a>PDF builds for me without error



---

archive/issue_comments_474507.json:
```json
{
    "body": "<a id='comment:43'></a>I think that `sagemath_doc_html` should be a dependency for `sagemath_doc_pdf`. Otherwise both may try to build at the same time, and they may both try to build the inventory files at the same time, which could easily lead to race conditions.",
    "created_at": "2021-11-10T05:28:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474507",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:43'></a>I think that `sagemath_doc_html` should be a dependency for `sagemath_doc_pdf`. Otherwise both may try to build at the same time, and they may both try to build the inventory files at the same time, which could easily lead to race conditions.



---

archive/issue_comments_474508.json:
```json
{
    "body": "<a id='comment:44'></a>Yes, I agree",
    "created_at": "2021-11-10T05:34:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474508",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:44'></a>Yes, I agree



---

archive/issue_comments_474509.json:
```json
{
    "body": "<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-10T05:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474509",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_474510.json:
```json
{
    "body": "<a id='comment:46'></a>Everything now builds for me.",
    "created_at": "2021-11-10T22:37:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474510",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:46'></a>Everything now builds for me.



---

archive/issue_comments_474511.json:
```json
{
    "body": "<a id='comment:47'></a>Thanks for testing!",
    "created_at": "2021-11-10T22:50:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474511",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:47'></a>Thanks for testing!



---

archive/issue_comments_474512.json:
```json
{
    "body": "<a id='comment:48'></a>I think this is ready to go. Merge now or wait until 9.6? I can imagine it breaking something for unforeseen reasons.",
    "created_at": "2021-11-11T05:40:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474512",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:48'></a>I think this is ready to go. Merge now or wait until 9.6? I can imagine it breaking something for unforeseen reasons.



---

archive/issue_comments_474513.json:
```json
{
    "body": "<a id='comment:49'></a>I think we can merge it now",
    "created_at": "2021-11-11T05:49:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474513",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:49'></a>I think we can merge it now



---

archive/issue_comments_474514.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-11-11T17:18:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474514",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_474515.json:
```json
{
    "body": "<a id='comment:51'></a>Thank you!",
    "created_at": "2021-11-11T17:24:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474515",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:51'></a>Thank you!



---

archive/issue_comments_474516.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-11-14T17:06:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31356#issuecomment-474516",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_082149.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-14T17:06:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31356",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31356#event-82149"
}
```
