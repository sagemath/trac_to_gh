# Issue 31991: Meta-ticket: Efficient numerical computations with tensor trains

archive/issues_031754.json:
```json
{
    "body": "CC:  @mkoeppe @egourgoulhon @dimpase\n\nFollowing the progress with Ticket #30307, we propose to add computational functionalities with tensors via the tensor train decomposition, which is an idea originally named Matrix Product States in the quantum physics community and later popularized by Prof. Ivan Oseledets. As a computational tool, it represents tensors in compressed formats that would enable tensor operations with cost scaling only linearly in the number of dimensions.\n\n- Affleck et al., Valence bond ground states in isotropic quantum antiferromagnets (https://link.springer.com/article/10.1007/BF01218021)\n- Oseledets, Tensor-Train Decomposition, SIAM J. Sci. Comput., 33(5), 2295\u20132317 (https://epubs.siam.org/doi/abs/10.1137/090752286?journalCode=sjoce3).\n\nThis functionality is especially useful for high dimensional tasks to prevent the curse of dimensionality (such as in Riemannian optimization). Numerical packages are currently supported in MATLAB, Python, and C++. The MATLAB version is currently most versatile and robust.\n\nWe may consider internalizing this computational library for Sage, as an effort to formalize the currently available implementations. This addition can either be an additional child class under `tensor`, and overwrite the arithmetics; or a separate module. The backend is currently proposed to be `tensorflow`, however this may change / be flexible based on how the refactoring of `Components` progresses. \n\nOne can look at this github page for an example implementation in MATLAB (https://github.com/oseledets/TT-Toolbox).\n\nIdeally after the implementation of this ticket, users can specify a fixed rank tensor for a general manifold using `tensor.modules`, specify a ring and a frame, and perform useful and normally computationally intractable tasks using tensor train as a backend. Based on the progress of this ticket, one may also consider implementing other backends for storing a numerical tensor such as tensor rings and quantized tensor train.\n\nFor alternative tensor decomposition formats, please see the following survey papers:\n\n- Tucker format: (Falc\u00f3, Hackbusch, Nouy, Tree-based tensor formats, https://arxiv.org/abs/1810.01262)\n- Tensor ring: (https://arxiv.org/abs/1807.02513)\n- Quantized tensor train (see section 3.5.1): (https://refubium.fu-berlin.de/handle/fub188/3366)\n\nOther implementations:\n- http://tensorly.org/dev/user_guide/tensor_decomposition.html\n\n**Tickets:**\n\n- #31998 Package `ttpy` (tensor trains)\n- #31992 `FiniteRankFreeModuleMorphism`: Add method SVD (singular value decomposition)\n- #31997 Topological tensor spaces (modules)\n- #29619 tensors should have a sparse iterator\n- #30373 Parent methods `tensor` vs. `tensor_product`\n- #30235 Add construction methods to `FiniteRankFreeModule` and `CombinatorialFreeModule`\n- #30309 Meta-ticket: Unify free module elements API: methods `dict`, `monomial_coefficients`, etc.\n- #32034 Graphical representations of tensors\n\nIssue created by migration from https://trac.sagemath.org/ticket/31991\n\n",
    "created_at": "2021-06-16T17:27:03Z",
    "labels": [
        "component: linear algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Meta-ticket: Efficient numerical computations with tensor trains",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31991",
    "user": "https://github.com/honglizhaobob"
}
```
CC:  @mkoeppe @egourgoulhon @dimpase

Following the progress with Ticket #30307, we propose to add computational functionalities with tensors via the tensor train decomposition, which is an idea originally named Matrix Product States in the quantum physics community and later popularized by Prof. Ivan Oseledets. As a computational tool, it represents tensors in compressed formats that would enable tensor operations with cost scaling only linearly in the number of dimensions.

- Affleck et al., Valence bond ground states in isotropic quantum antiferromagnets (https://link.springer.com/article/10.1007/BF01218021)
- Oseledets, Tensor-Train Decomposition, SIAM J. Sci. Comput., 33(5), 2295–2317 (https://epubs.siam.org/doi/abs/10.1137/090752286?journalCode=sjoce3).

This functionality is especially useful for high dimensional tasks to prevent the curse of dimensionality (such as in Riemannian optimization). Numerical packages are currently supported in MATLAB, Python, and C++. The MATLAB version is currently most versatile and robust.

We may consider internalizing this computational library for Sage, as an effort to formalize the currently available implementations. This addition can either be an additional child class under `tensor`, and overwrite the arithmetics; or a separate module. The backend is currently proposed to be `tensorflow`, however this may change / be flexible based on how the refactoring of `Components` progresses. 

One can look at this github page for an example implementation in MATLAB (https://github.com/oseledets/TT-Toolbox).

Ideally after the implementation of this ticket, users can specify a fixed rank tensor for a general manifold using `tensor.modules`, specify a ring and a frame, and perform useful and normally computationally intractable tasks using tensor train as a backend. Based on the progress of this ticket, one may also consider implementing other backends for storing a numerical tensor such as tensor rings and quantized tensor train.

For alternative tensor decomposition formats, please see the following survey papers:

- Tucker format: (Falcó, Hackbusch, Nouy, Tree-based tensor formats, https://arxiv.org/abs/1810.01262)
- Tensor ring: (https://arxiv.org/abs/1807.02513)
- Quantized tensor train (see section 3.5.1): (https://refubium.fu-berlin.de/handle/fub188/3366)

Other implementations:
- http://tensorly.org/dev/user_guide/tensor_decomposition.html

**Tickets:**

- #31998 Package `ttpy` (tensor trains)
- #31992 `FiniteRankFreeModuleMorphism`: Add method SVD (singular value decomposition)
- #31997 Topological tensor spaces (modules)
- #29619 tensors should have a sparse iterator
- #30373 Parent methods `tensor` vs. `tensor_product`
- #30235 Add construction methods to `FiniteRankFreeModule` and `CombinatorialFreeModule`
- #30309 Meta-ticket: Unify free module elements API: methods `dict`, `monomial_coefficients`, etc.
- #32034 Graphical representations of tensors

Issue created by migration from https://trac.sagemath.org/ticket/31991





---

archive/issue_comments_453104.json:
```json
{
    "body": "Is `ttpy` still being maintained? I tried to install it (using `sage -pip install ttpy`) and ran into a Fortran issue:\n\n```\n    Error: Type mismatch between actual argument at (1) and actual argument at (2) (REAL(8)/COMPLEX(8)).\n    tt/tt-fort/ort.f90:271:22:\n    \n      271 |    call dgemv('t',n,r,1.d0,yy,n,x,1, 0.d0,gv,1)\n```",
    "created_at": "2021-06-16T17:41:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31991#issuecomment-453104",
    "user": "https://github.com/mkoeppe"
}
```

Is `ttpy` still being maintained? I tried to install it (using `sage -pip install ttpy`) and ran into a Fortran issue:

```
    Error: Type mismatch between actual argument at (1) and actual argument at (2) (REAL(8)/COMPLEX(8)).
    tt/tt-fort/ort.f90:271:22:
    
      271 |    call dgemv('t',n,r,1.d0,yy,n,x,1, 0.d0,gv,1)
```



---

archive/issue_comments_453105.json:
```json
{
    "body": "(This is with gfortran 11.1 on macOS; this may be similar to the many issues that we had when gfortran 10 came along - #29456)",
    "created_at": "2021-06-16T17:59:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31991#issuecomment-453105",
    "user": "https://github.com/mkoeppe"
}
```

(This is with gfortran 11.1 on macOS; this may be similar to the many issues that we had when gfortran 10 came along - #29456)



---

archive/issue_comments_453106.json:
```json
{
    "body": "Replying to [comment:6 mkoeppe]:\n> (This is with gfortran 11.1 on macOS; this may be similar to the many issues that we had when gfortran 10 came along - #29456)\n\n\nI didn't have an issue with downloading since I wasn't using pip but directly cloned the code on github. Based on their github's commit history it doesn't seem to be frequently maintained.. The MATLAB version is what I now use for my projects. I will update the MATLAB link in the ticket description.",
    "created_at": "2021-06-16T18:07:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31991#issuecomment-453106",
    "user": "https://github.com/honglizhaobob"
}
```

Replying to [comment:6 mkoeppe]:
> (This is with gfortran 11.1 on macOS; this may be similar to the many issues that we had when gfortran 10 came along - #29456)


I didn't have an issue with downloading since I wasn't using pip but directly cloned the code on github. Based on their github's commit history it doesn't seem to be frequently maintained.. The MATLAB version is what I now use for my projects. I will update the MATLAB link in the ticket description.



---

archive/issue_comments_453107.json:
```json
{
    "body": "Waouh! This looks promising!",
    "created_at": "2021-06-16T18:57:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31991#issuecomment-453107",
    "user": "https://github.com/egourgoulhon"
}
```

Waouh! This looks promising!



---

archive/issue_comments_453108.json:
```json
{
    "body": "I have opened an upstream issue for the compilation errors: https://github.com/oseledets/ttpy/issues/82",
    "created_at": "2021-06-16T19:01:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31991#issuecomment-453108",
    "user": "https://github.com/mkoeppe"
}
```

I have opened an upstream issue for the compilation errors: https://github.com/oseledets/ttpy/issues/82



---

archive/issue_comments_453109.json:
```json
{
    "body": "Replying to [comment:9 egourgoulhon]:\n> Waouh! This looks promising!\n\nTo make it clear: the above comment was about the ticket main goal and was not some ironical statement about the ttpy issue with gfortran ;-)",
    "created_at": "2021-06-16T19:12:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31991#issuecomment-453109",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:9 egourgoulhon]:
> Waouh! This looks promising!

To make it clear: the above comment was about the ticket main goal and was not some ironical statement about the ttpy issue with gfortran ;-)



---

archive/issue_comments_453110.json:
```json
{
    "body": "slightly modified description",
    "created_at": "2021-06-19T21:27:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31991#issuecomment-453110",
    "user": "https://github.com/honglizhaobob"
}
```

slightly modified description



---

archive/issue_events_084603.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31991",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31991#event-84603"
}
```



---

archive/issue_events_084604.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31991",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31991#event-84604"
}
```



---

archive/issue_events_084605.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31991",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31991#event-84605"
}
```



---

archive/issue_events_084606.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-01T21:16:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31991",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31991#event-84606"
}
```



---

archive/issue_events_084607.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-01T21:16:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31991",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31991#event-84607"
}
```



---

archive/issue_events_084608.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31991",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31991#event-84608"
}
```



---

archive/issue_events_084609.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31991",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31991#event-84609"
}
```
