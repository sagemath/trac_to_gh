# Issue 31075: Add configuration and documentation for code formatter "black"

archive/issues_030838.json:
```json
{
    "body": "The code formatter \"black\" is probably the most popular one for Python. We add basic configuration and documentation for it.\n\nI would actually propose to reformat the whole code base with black, and then require that people use it before checkin their code (checked via the official github action). In this way one could get rid of all the formatting problems once and for all. This global reformat probably needs to be done by the release manager to prevent merge conflicts.\n\nCC:  @mkoeppe @fchapoton\n\nBranch: [public/build/black](https://github.com/sagemath/sagetrac-mirror/tree/public/build/black)\n\nAuthor: Tobias Diez\n\nStatus: needs_work\n\nCommit: 79249c2c3c3b7ebcbd632dfa8830e0a745306dbc\n\nIssue created by migration from https://trac.sagemath.org/ticket/31075\n\n",
    "created_at": "2020-12-18T14:23:31Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-wishlist",
    "title": "Add configuration and documentation for code formatter \"black\"",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31075",
    "user": "https://github.com/tobiasdiez"
}
```
The code formatter "black" is probably the most popular one for Python. We add basic configuration and documentation for it.

I would actually propose to reformat the whole code base with black, and then require that people use it before checkin their code (checked via the official github action). In this way one could get rid of all the formatting problems once and for all. This global reformat probably needs to be done by the release manager to prevent merge conflicts.

CC:  @mkoeppe @fchapoton

Branch: [public/build/black](https://github.com/sagemath/sagetrac-mirror/tree/public/build/black)

Author: Tobias Diez

Status: needs_work

Commit: 79249c2c3c3b7ebcbd632dfa8830e0a745306dbc

Issue created by migration from https://trac.sagemath.org/ticket/31075





---

archive/issue_comments_617079.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-12-18T14:23:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31075#issuecomment-617079",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_617080.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe section in the documentation should probably mention how to run it through `sage -tox`. In this case, no installation with pip is necessary - pip takes care of it",
    "created_at": "2020-12-18T18:46:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31075#issuecomment-617080",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
The section in the documentation should probably mention how to run it through `sage -tox`. In this case, no installation with pip is necessary - pip takes care of it



---

archive/issue_comments_617081.json:
```json
{
    "body": "Changing commit from \"b1f4ca2dc3c5c9fc1d49bbce32bba1809fe61b74\" to \"79249c2c3c3b7ebcbd632dfa8830e0a745306dbc\"",
    "created_at": "2020-12-18T21:47:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31075#issuecomment-617081",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b1f4ca2dc3c5c9fc1d49bbce32bba1809fe61b74" to "79249c2c3c3b7ebcbd632dfa8830e0a745306dbc"



---

archive/issue_comments_617082.json:
```json
{
    "body": "<a id='comment:3'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------|\n|[79249c2](https://github.com/sagemath/sagetrac-mirror/commit/79249c2c3c3b7ebcbd632dfa8830e0a745306dbc)|`Add tox instructions`|",
    "created_at": "2020-12-18T21:47:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31075#issuecomment-617082",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------|
|[79249c2](https://github.com/sagemath/sagetrac-mirror/commit/79249c2c3c3b7ebcbd632dfa8830e0a745306dbc)|`Add tox instructions`|



---

archive/issue_comments_617083.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [mkoeppe](#comment%3A2):\n> The section in the documentation should probably mention how to run it through `sage -tox`. In this case, no installation with pip is necessary - pip takes care of it\n\n\nGood idea. Added, also for pycodestyle.",
    "created_at": "2020-12-18T21:48:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31075#issuecomment-617083",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:4'></a>
Replying to [mkoeppe](#comment%3A2):
> The section in the documentation should probably mention how to run it through `sage -tox`. In this case, no installation with pip is necessary - pip takes care of it


Good idea. Added, also for pycodestyle.



---

archive/issue_comments_617084.json:
```json
{
    "body": "<a id='comment:5'></a>\nPerhaps `@`chapoton could comment on the current status and plans regarding code style in sagelib.  There seems to be a plan but I don't know if it is written anywhere.",
    "created_at": "2020-12-19T17:48:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31075#issuecomment-617084",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
Perhaps `@`chapoton could comment on the current status and plans regarding code style in sagelib.  There seems to be a plan but I don't know if it is written anywhere.



---

archive/issue_comments_617085.json:
```json
{
    "body": "<a id='comment:6'></a>\nComments concerning a plan how to proceed with the code style are welcome indeed.",
    "created_at": "2021-01-06T12:31:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31075#issuecomment-617085",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:6'></a>
Comments concerning a plan how to proceed with the code style are welcome indeed.



---

archive/issue_comments_617086.json:
```json
{
    "body": "<a id='comment:7'></a>\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-15T22:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31075#issuecomment-617086",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_091394.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31075",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31075#event-91394"
}
```



---

archive/issue_comments_617087.json:
```json
{
    "body": "<a id='comment:8'></a>\nI think requiring black's code formatting style should be discussed on sage-devel.  I'm personally against various choices they make (mainly the excessive newlines).",
    "created_at": "2021-04-28T08:26:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31075#issuecomment-617087",
    "user": "https://github.com/roed314"
}
```

<a id='comment:8'></a>
I think requiring black's code formatting style should be discussed on sage-devel.  I'm personally against various choices they make (mainly the excessive newlines).



---

archive/issue_comments_617088.json:
```json
{
    "body": "<a id='comment:9'></a>\n`@`mkoeppe, chapoton, how should we proceed with this?",
    "created_at": "2021-05-18T07:38:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31075#issuecomment-617088",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:9'></a>
`@`mkoeppe, chapoton, how should we proceed with this?



---

archive/issue_comments_617089.json:
```json
{
    "body": "<a id='comment:10'></a>\nfrom me, a **strong negative vote** on using black",
    "created_at": "2021-05-18T07:46:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31075#issuecomment-617089",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>
from me, a **strong negative vote** on using black



---

archive/issue_comments_617090.json:
```json
{
    "body": "<a id='comment:11'></a>\nI agree: I would prefer not to use black as a commit hook.  I find that it adds a lot of unnecessary whitespace.  As an example, here's a diff produced by black that I find makes the code less readable:\n\n```\n-verbose(\"Approximants of %r on %r towards %r\"%(self, self.domain(), G), level=3)\n+verbose(\n+    \"Approximants of %r on %r towards %r\" % (self, self.domain(), G), level=3\n+)\n```\n\nI also don't think it's worth making a change across Sage that will break everyone's outstanding branches.",
    "created_at": "2021-05-18T20:24:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31075#issuecomment-617090",
    "user": "https://github.com/roed314"
}
```

<a id='comment:11'></a>
I agree: I would prefer not to use black as a commit hook.  I find that it adds a lot of unnecessary whitespace.  As an example, here's a diff produced by black that I find makes the code less readable:

```
-verbose("Approximants of %r on %r towards %r"%(self, self.domain(), G), level=3)
+verbose(
+    "Approximants of %r on %r towards %r" % (self, self.domain(), G), level=3
+)
```

I also don't think it's worth making a change across Sage that will break everyone's outstanding branches.



---

archive/issue_comments_617091.json:
```json
{
    "body": "<a id='comment:12'></a>\nAlso, the branch on this ticket gives a merge failure.",
    "created_at": "2021-05-18T20:26:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31075#issuecomment-617091",
    "user": "https://github.com/roed314"
}
```

<a id='comment:12'></a>
Also, the branch on this ticket gives a merge failure.



---

archive/issue_comments_617092.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-05-20T15:30:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31075#issuecomment-617092",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_617093.json:
```json
{
    "body": "<a id='comment:13'></a>\nred branch => needs work",
    "created_at": "2021-05-20T15:30:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31075",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31075#issuecomment-617093",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'></a>
red branch => needs work



---

archive/issue_events_091395.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:39:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31075",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31075#event-91395"
}
```



---

archive/issue_events_091396.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:39:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31075",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31075#event-91396"
}
```
