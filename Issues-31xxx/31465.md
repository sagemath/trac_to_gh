# Issue 31465: Division with remainder for univariate polynomial matrices

archive/issues_031228.json:
```json
{
    "assignees": [],
    "body": "New functionality: division with remainder for matrices over the univariate polynomials. The existing functions for weak Popov form, and the forthcoming functions for Popov form and truncated matrix inverse expansions, should allow to easily add this tool, in good generality:\n* left division or right division,\n* core tool: handling a divisor matrix in square, nonsingular, reduced form (column reduced if right division),\n* general case (rectangular, arbitrary-rank divisor) reducing to the core tool via computing the Popov form and the associated transformation.\n\nDepends on #31463\nDepends on #31472\n\nAssignee: **@ke456**\n\nCC:  @ke456\n\nKeywords: **polynomial matrix, division with remainder**\n\nBranch: **[7caf510](https://github.com/sagemath/sagetrac-mirror/commit/7caf5107509c3e576459eda97a9f9a47fde27904)**\n\nReviewer: **Seung Gyu Hyun**\n\nAuthor: **Vincent Neiger**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31465_\n\n",
    "closed_at": "2021-08-29T09:37:40Z",
    "created_at": "2021-03-07T20:22:22Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20algebra",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Division with remainder for univariate polynomial matrices",
    "type": "issue",
    "updated_at": "2021-09-26T01:47:33Z",
    "url": "https://github.com/sagemath/sage/issues/31465",
    "user": "https://github.com/vneiger"
}
```
New functionality: division with remainder for matrices over the univariate polynomials. The existing functions for weak Popov form, and the forthcoming functions for Popov form and truncated matrix inverse expansions, should allow to easily add this tool, in good generality:
* left division or right division,
* core tool: handling a divisor matrix in square, nonsingular, reduced form (column reduced if right division),
* general case (rectangular, arbitrary-rank divisor) reducing to the core tool via computing the Popov form and the associated transformation.

Depends on #31463
Depends on #31472

Assignee: **@ke456**

CC:  @ke456

Keywords: **polynomial matrix, division with remainder**

Branch: **[7caf510](https://github.com/sagemath/sagetrac-mirror/commit/7caf5107509c3e576459eda97a9f9a47fde27904)**

Reviewer: **Seung Gyu Hyun**

Author: **Vincent Neiger**

_Issue created by migration from https://trac.sagemath.org/ticket/31465_





---

archive/issue_events_401493.json:
```json
{
    "actor": "https://github.com/vneiger",
    "created_at": "2021-03-07T20:22:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401493"
}
```



---

archive/issue_events_401494.json:
```json
{
    "actor": "https://github.com/vneiger",
    "created_at": "2021-03-07T20:22:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "component: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401494"
}
```



---

archive/issue_events_401495.json:
```json
{
    "actor": "https://github.com/vneiger",
    "created_at": "2021-03-07T20:22:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401495"
}
```



---

archive/issue_events_401496.json:
```json
{
    "actor": "https://github.com/vneiger",
    "created_at": "2021-03-07T20:22:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401496"
}
```



---

archive/issue_events_401497.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-24T02:04:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401497"
}
```



---

archive/issue_events_401498.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-24T02:04:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401498"
}
```



---

archive/issue_comments_508290.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nSage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-24T02:04:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508290",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'>Comment 1:</a>
Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_401499.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401499"
}
```



---

archive/issue_events_401500.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401500"
}
```



---

archive/issue_comments_508291.json:
```json
{
    "body": "Branch: **[u/gh-vneiger/division_with_remainder_for_univariate_polynomial_matrices](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-vneiger/division_with_remainder_for_univariate_polynomial_matrices)**",
    "created_at": "2021-08-02T08:43:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508291",
    "user": "https://github.com/vneiger"
}
```

Branch: **[u/gh-vneiger/division_with_remainder_for_univariate_polynomial_matrices](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-vneiger/division_with_remainder_for_univariate_polynomial_matrices)**



---

archive/issue_comments_508292.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/75a48511166c5acaa08f1f9b4fdb3d1b43628f87\">75a4851</a></td><td><code>just adding the author's note at the top; until here, only merging previous changes because system solution will be needed here</code></td></tr></table>\n",
    "created_at": "2021-08-02T08:46:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508292",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:4'>Comment 4:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/75a48511166c5acaa08f1f9b4fdb3d1b43628f87">75a4851</a></td><td><code>just adding the author's note at the top; until here, only merging previous changes because system solution will be needed here</code></td></tr></table>




---

archive/issue_comments_508293.json:
```json
{
    "body": "Commit: **[75a4851](https://github.com/sagemath/sagetrac-mirror/commit/75a48511166c5acaa08f1f9b4fdb3d1b43628f87)**",
    "created_at": "2021-08-02T08:46:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508293",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[75a4851](https://github.com/sagemath/sagetrac-mirror/commit/75a48511166c5acaa08f1f9b4fdb3d1b43628f87)**



---

archive/issue_comments_508294.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f07d50daaf9b43c3da18ed5b63e8f2b995d15d91\">f07d50d</a></td><td><code>two main helper functions done</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f2f50929fb79a6a9c5c08e77c691fa035d0e9516\">f2f5092</a></td><td><code>some progress, all three base cases done; remains to test and finalize main procedure</code></td></tr></table>\n",
    "created_at": "2021-08-02T23:38:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508294",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:5'>Comment 5:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f07d50daaf9b43c3da18ed5b63e8f2b995d15d91">f07d50d</a></td><td><code>two main helper functions done</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f2f50929fb79a6a9c5c08e77c691fa035d0e9516">f2f5092</a></td><td><code>some progress, all three base cases done; remains to test and finalize main procedure</code></td></tr></table>




---

archive/issue_comments_508295.json:
```json
{
    "body": "Changed commit from **[75a4851](https://github.com/sagemath/sagetrac-mirror/commit/75a48511166c5acaa08f1f9b4fdb3d1b43628f87)** to **[f2f5092](https://github.com/sagemath/sagetrac-mirror/commit/f2f50929fb79a6a9c5c08e77c691fa035d0e9516)**",
    "created_at": "2021-08-02T23:38:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508295",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[75a4851](https://github.com/sagemath/sagetrac-mirror/commit/75a48511166c5acaa08f1f9b4fdb3d1b43628f87)** to **[f2f5092](https://github.com/sagemath/sagetrac-mirror/commit/f2f50929fb79a6a9c5c08e77c691fa035d0e9516)**



---

archive/issue_comments_508296.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d9b61c30fa7ce58e94ec8e1942ea35d3ae5bffac\">d9b61c3</a></td><td><code>some improvements in reduce, and added doc + tests</code></td></tr></table>\n",
    "created_at": "2021-08-04T09:46:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508296",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:6'>Comment 6:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d9b61c30fa7ce58e94ec8e1942ea35d3ae5bffac">d9b61c3</a></td><td><code>some improvements in reduce, and added doc + tests</code></td></tr></table>




---

archive/issue_comments_508297.json:
```json
{
    "body": "Changed commit from **[f2f5092](https://github.com/sagemath/sagetrac-mirror/commit/f2f50929fb79a6a9c5c08e77c691fa035d0e9516)** to **[d9b61c3](https://github.com/sagemath/sagetrac-mirror/commit/d9b61c30fa7ce58e94ec8e1942ea35d3ae5bffac)**",
    "created_at": "2021-08-04T09:46:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508297",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[f2f5092](https://github.com/sagemath/sagetrac-mirror/commit/f2f50929fb79a6a9c5c08e77c691fa035d0e9516)** to **[d9b61c3](https://github.com/sagemath/sagetrac-mirror/commit/d9b61c30fa7ce58e94ec8e1942ea35d3ae5bffac)**



---

archive/issue_comments_508298.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7d71d4d4d55971f660fe4e48158585f9a446ebfa\">7d71d4d</a></td><td><code>finalized left and right quo_rem</code></td></tr></table>\n",
    "created_at": "2021-08-04T11:14:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508298",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:7'>Comment 7:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7d71d4d4d55971f660fe4e48158585f9a446ebfa">7d71d4d</a></td><td><code>finalized left and right quo_rem</code></td></tr></table>




---

archive/issue_comments_508299.json:
```json
{
    "body": "Changed commit from **[d9b61c3](https://github.com/sagemath/sagetrac-mirror/commit/d9b61c30fa7ce58e94ec8e1942ea35d3ae5bffac)** to **[7d71d4d](https://github.com/sagemath/sagetrac-mirror/commit/7d71d4d4d55971f660fe4e48158585f9a446ebfa)**",
    "created_at": "2021-08-04T11:14:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508299",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d9b61c3](https://github.com/sagemath/sagetrac-mirror/commit/d9b61c30fa7ce58e94ec8e1942ea35d3ae5bffac)** to **[7d71d4d](https://github.com/sagemath/sagetrac-mirror/commit/7d71d4d4d55971f660fe4e48158585f9a446ebfa)**



---

archive/issue_events_401501.json:
```json
{
    "actor": "https://github.com/vneiger",
    "created_at": "2021-08-04T11:16:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401501"
}
```



---

archive/issue_comments_508300.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nFunctionalities are done, as expected, with an extra method for ``reduce`` in order to provide this directly to the user. Documentation is written, along with many tests.\n\nThere might still be some minor doc improvements to do, but a first round of review could be useful at this stage.",
    "created_at": "2021-08-04T11:16:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508300",
    "user": "https://github.com/vneiger"
}
```

<a id='comment:8'>Comment 8:</a>
Functionalities are done, as expected, with an extra method for ``reduce`` in order to provide this directly to the user. Documentation is written, along with many tests.

There might still be some minor doc improvements to do, but a first round of review could be useful at this stage.



---

archive/issue_events_401502.json:
```json
{
    "actor": "https://github.com/vneiger",
    "created_at": "2021-08-04T11:16:37Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401502"
}
```



---

archive/issue_events_401503.json:
```json
{
    "actor": "https://github.com/vneiger",
    "created_at": "2021-08-04T11:16:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401503"
}
```



---

archive/issue_comments_508301.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nKevin agreed to review the ticket.",
    "created_at": "2021-08-04T21:59:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508301",
    "user": "https://github.com/vneiger"
}
```

<a id='comment:9'>Comment 9:</a>
Kevin agreed to review the ticket.



---

archive/issue_comments_508302.json:
```json
{
    "body": "Assignee: **@ke456**",
    "created_at": "2021-08-04T21:59:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508302",
    "user": "https://github.com/vneiger"
}
```

Assignee: **@ke456**



---

archive/issue_comments_508303.json:
```json
{
    "body": "Changed commit from **[7d71d4d](https://github.com/sagemath/sagetrac-mirror/commit/7d71d4d4d55971f660fe4e48158585f9a446ebfa)** to **[e385437](https://github.com/sagemath/sagetrac-mirror/commit/e3854372a951c30b914e07d8551f9eb8a2ae7c55)**",
    "created_at": "2021-08-07T16:44:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508303",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7d71d4d](https://github.com/sagemath/sagetrac-mirror/commit/7d71d4d4d55971f660fe4e48158585f9a446ebfa)** to **[e385437](https://github.com/sagemath/sagetrac-mirror/commit/e3854372a951c30b914e07d8551f9eb8a2ae7c55)**



---

archive/issue_comments_508304.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e3854372a951c30b914e07d8551f9eb8a2ae7c55\">e385437</a></td><td><code>minor improvements to doc and code</code></td></tr></table>\n",
    "created_at": "2021-08-07T16:44:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508304",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:10'>Comment 10:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e3854372a951c30b914e07d8551f9eb8a2ae7c55">e385437</a></td><td><code>minor improvements to doc and code</code></td></tr></table>




---

archive/issue_comments_508305.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nAfter small fixes and improvements in the documentation and examples, this is ready for review. One question: is the doc clear enough on the use of `reduce` for `right_quo_rem` in the third situation described in the function documentation? Should it be better if more detailed, or less detailed? Thanks.",
    "created_at": "2021-08-07T16:47:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508305",
    "user": "https://github.com/vneiger"
}
```

<a id='comment:11'>Comment 11:</a>
After small fixes and improvements in the documentation and examples, this is ready for review. One question: is the doc clear enough on the use of `reduce` for `right_quo_rem` in the third situation described in the function documentation? Should it be better if more detailed, or less detailed? Thanks.



---

archive/issue_comments_508306.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nThe documentation and tests look good. To answer the question above, I think it's the use of reduce is clear and well outlined. However, the approach of using the appropriate shifts should be verified.",
    "created_at": "2021-08-08T00:27:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508306",
    "user": "https://github.com/ke456"
}
```

<a id='comment:12'>Comment 12:</a>
The documentation and tests look good. To answer the question above, I think it's the use of reduce is clear and well outlined. However, the approach of using the appropriate shifts should be verified.



---

archive/issue_comments_508307.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nOk, I just checked the details (unfortunately I am not aware of a reference for this), and here is the proof of correctness.\n\nStarting from any pair of matrices `A` and `B` with the same number of columns (recall `A` is `self`), we want to prove that: there is a \"valid remainder `R`\" in the division of `A` by `B` if and only if the `s`-normal form of `A` with respect to `B` is such a valid remainder, for the shift `s` chosen as the negation of the column degrees of `B`. Recall that \"valid remainder\" means that `A = QB + R` for some matrices `Q` and `R` and `R` has column degrees (strictly) bounded from above by the column degrees of `B`, or equivalently, `R` has (strictly) negative `s`-row degree.\n\nWithout loss of generality we can prove this for the case of a vector `A`, instead of a matrix (just apply the following argument to each row separately).\n\n* First case: there is no valid remainder. Then, obviously, the `s`-normal form of `A` cannot be a valid remainder.\n* Second case: there is a valid remainder. That means we can write `A = QB + R` with `R` having negative `s`-row degree. We want to prove that the `s`-normal form `N` of `A` with respect to `B` is also a valid remainder, i.e. `N` has negative `s`-row degree. If `N` has `s`-row degree smaller than or equal to that of `R`, then the conclusion follows by definition of `R`. Now assume `N` has `s`-row degree strictly larger than that of `R`. So the `s`-row degree and `s`-leading position of `N-R` are equal respectively to `s`-row degree and `s`-leading position of `N`. On the other hand, since both `R` and `N` are equal up to a left-multiple of `B`, `N-R` is in the row space of `B`, so the `s`-leading position of `N-R` is among the `s`-leading positions of the rows of the `s`-Popov form `P` of `B` (this is a consequence of the extended predictable degree property). This means that the `s`-leading position of `N` is among the `s`-leading positions of the rows of `P`; and since `N` is reduced modulo `P`, the `s`-row degree of `N` is less than the `s`-row degree of the row of `P` having that same `s`-leading position. Since `P` is the `s`-Popov form of `B`, and the `s`-row degree of `B` is uniformly zero, `P` has nonpositive `s`-row degree, and therefore `N` has negative `s`-row degree, which contradicts our assumption.",
    "created_at": "2021-08-08T16:35:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508307",
    "user": "https://github.com/vneiger"
}
```

<a id='comment:13'>Comment 13:</a>
Ok, I just checked the details (unfortunately I am not aware of a reference for this), and here is the proof of correctness.

Starting from any pair of matrices `A` and `B` with the same number of columns (recall `A` is `self`), we want to prove that: there is a "valid remainder `R`" in the division of `A` by `B` if and only if the `s`-normal form of `A` with respect to `B` is such a valid remainder, for the shift `s` chosen as the negation of the column degrees of `B`. Recall that "valid remainder" means that `A = QB + R` for some matrices `Q` and `R` and `R` has column degrees (strictly) bounded from above by the column degrees of `B`, or equivalently, `R` has (strictly) negative `s`-row degree.

Without loss of generality we can prove this for the case of a vector `A`, instead of a matrix (just apply the following argument to each row separately).

* First case: there is no valid remainder. Then, obviously, the `s`-normal form of `A` cannot be a valid remainder.
* Second case: there is a valid remainder. That means we can write `A = QB + R` with `R` having negative `s`-row degree. We want to prove that the `s`-normal form `N` of `A` with respect to `B` is also a valid remainder, i.e. `N` has negative `s`-row degree. If `N` has `s`-row degree smaller than or equal to that of `R`, then the conclusion follows by definition of `R`. Now assume `N` has `s`-row degree strictly larger than that of `R`. So the `s`-row degree and `s`-leading position of `N-R` are equal respectively to `s`-row degree and `s`-leading position of `N`. On the other hand, since both `R` and `N` are equal up to a left-multiple of `B`, `N-R` is in the row space of `B`, so the `s`-leading position of `N-R` is among the `s`-leading positions of the rows of the `s`-Popov form `P` of `B` (this is a consequence of the extended predictable degree property). This means that the `s`-leading position of `N` is among the `s`-leading positions of the rows of `P`; and since `N` is reduced modulo `P`, the `s`-row degree of `N` is less than the `s`-row degree of the row of `P` having that same `s`-leading position. Since `P` is the `s`-Popov form of `B`, and the `s`-row degree of `B` is uniformly zero, `P` has nonpositive `s`-row degree, and therefore `N` has negative `s`-row degree, which contradicts our assumption.



---

archive/issue_events_401504.json:
```json
{
    "actor": "https://github.com/ke456",
    "created_at": "2021-08-08T16:43:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401504"
}
```



---

archive/issue_events_401505.json:
```json
{
    "actor": "https://github.com/ke456",
    "created_at": "2021-08-08T16:43:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401505"
}
```



---

archive/issue_comments_508308.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nI have not read the proof in great detail, but it seems correct. With this, I believe the goal of the ticket has been met.",
    "created_at": "2021-08-08T16:43:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508308",
    "user": "https://github.com/ke456"
}
```

<a id='comment:14'>Comment 14:</a>
I have not read the proof in great detail, but it seems correct. With this, I believe the goal of the ticket has been met.



---

archive/issue_events_401506.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2021-08-08T20:14:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401506"
}
```



---

archive/issue_events_401507.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2021-08-08T20:14:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401507"
}
```



---

archive/issue_comments_508309.json:
```json
{
    "body": "Changed commit from **[e385437](https://github.com/sagemath/sagetrac-mirror/commit/e3854372a951c30b914e07d8551f9eb8a2ae7c55)** to **[7caf510](https://github.com/sagemath/sagetrac-mirror/commit/7caf5107509c3e576459eda97a9f9a47fde27904)**",
    "created_at": "2021-08-08T20:14:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508309",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[e385437](https://github.com/sagemath/sagetrac-mirror/commit/e3854372a951c30b914e07d8551f9eb8a2ae7c55)** to **[7caf510](https://github.com/sagemath/sagetrac-mirror/commit/7caf5107509c3e576459eda97a9f9a47fde27904)**



---

archive/issue_comments_508310.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7caf5107509c3e576459eda97a9f9a47fde27904\">7caf510</a></td><td><code>fixes doc style (removing empty lines)</code></td></tr></table>\n",
    "created_at": "2021-08-08T20:14:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508310",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:15'>Comment 15:</a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7caf5107509c3e576459eda97a9f9a47fde27904">7caf510</a></td><td><code>fixes doc style (removing empty lines)</code></td></tr></table>




---

archive/issue_comments_508311.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nThanks for reviewing. I see there were minor issues with the doc code style (if I understood the log correctly). This commit tries to fix this.",
    "created_at": "2021-08-08T20:17:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508311",
    "user": "https://github.com/vneiger"
}
```

<a id='comment:16'>Comment 16:</a>
Thanks for reviewing. I see there were minor issues with the doc code style (if I understood the log correctly). This commit tries to fix this.



---

archive/issue_events_401508.json:
```json
{
    "actor": "https://github.com/vneiger",
    "created_at": "2021-08-08T22:28:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401508"
}
```



---

archive/issue_events_401509.json:
```json
{
    "actor": "https://github.com/vneiger",
    "created_at": "2021-08-08T22:28:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401509"
}
```



---

archive/issue_events_401510.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401510"
}
```



---

archive/issue_events_401511.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401511"
}
```



---

archive/issue_comments_508312.json:
```json
{
    "body": "Changed branch from **[u/gh-vneiger/division_with_remainder_for_univariate_polynomial_matrices](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-vneiger/division_with_remainder_for_univariate_polynomial_matrices)** to **[7caf510](https://github.com/sagemath/sagetrac-mirror/commit/7caf5107509c3e576459eda97a9f9a47fde27904)**",
    "created_at": "2021-08-29T09:37:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508312",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/gh-vneiger/division_with_remainder_for_univariate_polynomial_matrices](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-vneiger/division_with_remainder_for_univariate_polynomial_matrices)** to **[7caf510](https://github.com/sagemath/sagetrac-mirror/commit/7caf5107509c3e576459eda97a9f9a47fde27904)**



---

archive/issue_events_401512.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-08-29T09:37:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401512"
}
```



---

archive/issue_events_401513.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "519e9ca7b590c9a053cd5fa50162cfd0fd5490cb",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-08-29T09:37:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31465#event-401513"
}
```



---

archive/issue_comments_508313.json:
```json
{
    "body": "Changed commit from **[7caf510](https://github.com/sagemath/sagetrac-mirror/commit/7caf5107509c3e576459eda97a9f9a47fde27904)** to none",
    "created_at": "2021-09-26T01:45:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508313",
    "user": "https://github.com/mkoeppe"
}
```

Changed commit from **[7caf510](https://github.com/sagemath/sagetrac-mirror/commit/7caf5107509c3e576459eda97a9f9a47fde27904)** to none



---

archive/issue_comments_508314.json:
```json
{
    "body": "Dependencies: **#31463**",
    "created_at": "2021-09-26T01:45:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508314",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#31463**



---

archive/issue_comments_508315.json:
```json
{
    "body": "Changed dependencies from **#31463** to **#31463, #31472**",
    "created_at": "2021-09-26T01:47:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31465#issuecomment-508315",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#31463** to **#31463, #31472**
