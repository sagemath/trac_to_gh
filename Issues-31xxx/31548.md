# Issue 31548: Create matrix class for FLINT's nmod_mat module

archive/issues_031311.json:
```json
{
    "body": "This tickets adds a new class for dense matrices over `Zmod(N)` implemented using FLINT's `nmod_mat_t` type, along with some supporting ancillary changes:\n\n* Changed echelon form over `Zmod(N)` for composite `N` to return the Howell form (see the introduction and Chapter 4 of [Storjohann's thesis](https://cs.uwaterloo.ca/~astorjoh/diss2up.pdf)).  Since this echelon form can have more rows than the input matrix, made some supporting changes including a new method `_echelon_copy`.\n* Changed rank over `Zmod(N)` to return the number of leading 1s in Howell form (it raised a `NotImplementedError` before), and `pivots` to be the locations of these leading 1s.  There is also a method `_pivots` for accessing the columns where the leading entry is not 1.\n* Matrices modulo composite `N` have improved speed and functionality for inversion, `charpoly`, `det`, `minpoly`, `echelon_form`, `solve_right` and `right_kernel_matrix`.  There is also a new method `minpoly_ideal` for the ideal vanishing on a matrix (the natural generalization of the minimal polynomial, which generates this ideal when it is principal).\n* Changed `stack` and `augment` to return a matrix over a common base ring of the two inputs, rather than just using the top/left matrix to determine the base ring.\n* A new method `_change_implementation` on matrices, together with rough heuristics for matrices on matrices mod `N` in determining when it's worth switching between FLINT and linbox (linbox is faster for large matrices, FLINT for smaller, and FLINT offers extra functionality for matrices modulo composite integers).\n* Support multiplication of matrices with different implementations\n* Add FLINT's `ulong_extras` for number theoretic functions on longs\n* Add some iterators related to split primes in cyclotomic fields in support of changes to `matrix_cyclo_dense` (which uses a multimodular approach), and moved the `_reduction_matrix` method to the base field which will yield better caching behavior.\n* Fix some doctests that relate to choosing different solutions in `solve_right` and getting different random matrices with a different implementation.\n\n**CC:**  @edgarcosta\n\n**Branch:** [u/roed/nmod_mat](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/nmod_mat)\n\n**Commit:** [a3c8e38bc674e3e7fa8c93ab04f71548fd28aac8](https://github.com/sagemath/sagetrac-mirror/commit/a3c8e38bc674e3e7fa8c93ab04f71548fd28aac8)\n\n**Reviewer:** Travis Scrimshaw\n\n**Author:** David Roe, Edgar Costa\n\n**Status:** needs_work\n\n**Dependencies:** #31069\n\nIssue created by migration from https://trac.sagemath.org/ticket/31548\n\n",
    "created_at": "2021-03-24T15:54:33Z",
    "labels": [
        "component: linear algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Create matrix class for FLINT's nmod_mat module",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31548",
    "user": "https://github.com/roed314"
}
```
This tickets adds a new class for dense matrices over `Zmod(N)` implemented using FLINT's `nmod_mat_t` type, along with some supporting ancillary changes:

* Changed echelon form over `Zmod(N)` for composite `N` to return the Howell form (see the introduction and Chapter 4 of [Storjohann's thesis](https://cs.uwaterloo.ca/~astorjoh/diss2up.pdf)).  Since this echelon form can have more rows than the input matrix, made some supporting changes including a new method `_echelon_copy`.
* Changed rank over `Zmod(N)` to return the number of leading 1s in Howell form (it raised a `NotImplementedError` before), and `pivots` to be the locations of these leading 1s.  There is also a method `_pivots` for accessing the columns where the leading entry is not 1.
* Matrices modulo composite `N` have improved speed and functionality for inversion, `charpoly`, `det`, `minpoly`, `echelon_form`, `solve_right` and `right_kernel_matrix`.  There is also a new method `minpoly_ideal` for the ideal vanishing on a matrix (the natural generalization of the minimal polynomial, which generates this ideal when it is principal).
* Changed `stack` and `augment` to return a matrix over a common base ring of the two inputs, rather than just using the top/left matrix to determine the base ring.
* A new method `_change_implementation` on matrices, together with rough heuristics for matrices on matrices mod `N` in determining when it's worth switching between FLINT and linbox (linbox is faster for large matrices, FLINT for smaller, and FLINT offers extra functionality for matrices modulo composite integers).
* Support multiplication of matrices with different implementations
* Add FLINT's `ulong_extras` for number theoretic functions on longs
* Add some iterators related to split primes in cyclotomic fields in support of changes to `matrix_cyclo_dense` (which uses a multimodular approach), and moved the `_reduction_matrix` method to the base field which will yield better caching behavior.
* Fix some doctests that relate to choosing different solutions in `solve_right` and getting different random matrices with a different implementation.

**CC:**  @edgarcosta

**Branch:** [u/roed/nmod_mat](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/nmod_mat)

**Commit:** [a3c8e38bc674e3e7fa8c93ab04f71548fd28aac8](https://github.com/sagemath/sagetrac-mirror/commit/a3c8e38bc674e3e7fa8c93ab04f71548fd28aac8)

**Reviewer:** Travis Scrimshaw

**Author:** David Roe, Edgar Costa

**Status:** needs_work

**Dependencies:** #31069

Issue created by migration from https://trac.sagemath.org/ticket/31548





---

archive/issue_comments_627349.json:
```json
{
    "body": "**Branch:** [u/roed/nmod_mat](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/nmod_mat)",
    "created_at": "2021-03-24T15:55:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627349",
    "user": "https://github.com/roed314"
}
```


**Branch:** [u/roed/nmod_mat](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/nmod_mat)



---

archive/issue_comments_627350.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/763533df7ba71d606038dac0983c5c24165f40f2\">763533d</a></td><td><code>Fix bug in cinit</code></td></tr></table>\n",
    "created_at": "2021-03-24T16:08:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627350",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/763533df7ba71d606038dac0983c5c24165f40f2">763533d</a></td><td><code>Fix bug in cinit</code></td></tr></table>




---

archive/issue_comments_627351.json:
```json
{
    "body": "**Commit:** [763533df7ba71d606038dac0983c5c24165f40f2](https://github.com/sagemath/sagetrac-mirror/commit/763533df7ba71d606038dac0983c5c24165f40f2)",
    "created_at": "2021-03-24T16:08:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627351",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Commit:** [763533df7ba71d606038dac0983c5c24165f40f2](https://github.com/sagemath/sagetrac-mirror/commit/763533df7ba71d606038dac0983c5c24165f40f2)



---

archive/issue_comments_627352.json:
```json
{
    "body": "**Changing commit** from \"[763533df7ba71d606038dac0983c5c24165f40f2](https://github.com/sagemath/sagetrac-mirror/commit/763533df7ba71d606038dac0983c5c24165f40f2)\" to \"[8cdf9b16b1cd248f211a3d86eec61c30a6ef702b](https://github.com/sagemath/sagetrac-mirror/commit/8cdf9b16b1cd248f211a3d86eec61c30a6ef702b)\".",
    "created_at": "2021-03-24T18:28:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627352",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[763533df7ba71d606038dac0983c5c24165f40f2](https://github.com/sagemath/sagetrac-mirror/commit/763533df7ba71d606038dac0983c5c24165f40f2)" to "[8cdf9b16b1cd248f211a3d86eec61c30a6ef702b](https://github.com/sagemath/sagetrac-mirror/commit/8cdf9b16b1cd248f211a3d86eec61c30a6ef702b)".



---

archive/issue_comments_627353.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8cdf9b16b1cd248f211a3d86eec61c30a6ef702b\">8cdf9b1</a></td><td><code>Add some functions to Matrix_nmod_dense</code></td></tr></table>\n",
    "created_at": "2021-03-24T18:28:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627353",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8cdf9b16b1cd248f211a3d86eec61c30a6ef702b">8cdf9b1</a></td><td><code>Add some functions to Matrix_nmod_dense</code></td></tr></table>




---

archive/issue_comments_627354.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c6e9d34e2b12bea82ab5fb928e0f17423548f32\">9c6e9d3</a></td><td><code>level 1 and level 2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/518a32f9a7b27b0c18d89a2873d6c0139c67efe9\">518a32f</a></td><td><code>Updating todos</code></td></tr></table>\n",
    "created_at": "2021-03-24T19:03:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627354",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c6e9d34e2b12bea82ab5fb928e0f17423548f32">9c6e9d3</a></td><td><code>level 1 and level 2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/518a32f9a7b27b0c18d89a2873d6c0139c67efe9">518a32f</a></td><td><code>Updating todos</code></td></tr></table>




---

archive/issue_comments_627355.json:
```json
{
    "body": "**Changing commit** from \"[8cdf9b16b1cd248f211a3d86eec61c30a6ef702b](https://github.com/sagemath/sagetrac-mirror/commit/8cdf9b16b1cd248f211a3d86eec61c30a6ef702b)\" to \"[518a32f9a7b27b0c18d89a2873d6c0139c67efe9](https://github.com/sagemath/sagetrac-mirror/commit/518a32f9a7b27b0c18d89a2873d6c0139c67efe9)\".",
    "created_at": "2021-03-24T19:03:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627355",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[8cdf9b16b1cd248f211a3d86eec61c30a6ef702b](https://github.com/sagemath/sagetrac-mirror/commit/8cdf9b16b1cd248f211a3d86eec61c30a6ef702b)" to "[518a32f9a7b27b0c18d89a2873d6c0139c67efe9](https://github.com/sagemath/sagetrac-mirror/commit/518a32f9a7b27b0c18d89a2873d6c0139c67efe9)".



---

archive/issue_comments_627356.json:
```json
{
    "body": "**Changing commit** from \"[518a32f9a7b27b0c18d89a2873d6c0139c67efe9](https://github.com/sagemath/sagetrac-mirror/commit/518a32f9a7b27b0c18d89a2873d6c0139c67efe9)\" to \"[936668af2821a939e4ae200f384611bf42bd00f5](https://github.com/sagemath/sagetrac-mirror/commit/936668af2821a939e4ae200f384611bf42bd00f5)\".",
    "created_at": "2021-03-24T19:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627356",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[518a32f9a7b27b0c18d89a2873d6c0139c67efe9](https://github.com/sagemath/sagetrac-mirror/commit/518a32f9a7b27b0c18d89a2873d6c0139c67efe9)" to "[936668af2821a939e4ae200f384611bf42bd00f5](https://github.com/sagemath/sagetrac-mirror/commit/936668af2821a939e4ae200f384611bf42bd00f5)".



---

archive/issue_comments_627357.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/936668af2821a939e4ae200f384611bf42bd00f5\">936668a</a></td><td><code>Add todos</code></td></tr></table>\n",
    "created_at": "2021-03-24T19:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627357",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:5'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/936668af2821a939e4ae200f384611bf42bd00f5">936668a</a></td><td><code>Add todos</code></td></tr></table>




---

archive/issue_comments_627358.json:
```json
{
    "body": "**Changing commit** from \"[936668af2821a939e4ae200f384611bf42bd00f5](https://github.com/sagemath/sagetrac-mirror/commit/936668af2821a939e4ae200f384611bf42bd00f5)\" to \"[aaf0680040c96e439877eac471bd3e2cd4515a94](https://github.com/sagemath/sagetrac-mirror/commit/aaf0680040c96e439877eac471bd3e2cd4515a94)\".",
    "created_at": "2021-03-24T19:47:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627358",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[936668af2821a939e4ae200f384611bf42bd00f5](https://github.com/sagemath/sagetrac-mirror/commit/936668af2821a939e4ae200f384611bf42bd00f5)" to "[aaf0680040c96e439877eac471bd3e2cd4515a94](https://github.com/sagemath/sagetrac-mirror/commit/aaf0680040c96e439877eac471bd3e2cd4515a94)".



---

archive/issue_comments_627359.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aaf0680040c96e439877eac471bd3e2cd4515a94\">aaf0680</a></td><td><code>Update todo</code></td></tr></table>\n",
    "created_at": "2021-03-24T19:47:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627359",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aaf0680040c96e439877eac471bd3e2cd4515a94">aaf0680</a></td><td><code>Update todo</code></td></tr></table>




---

archive/issue_comments_627360.json:
```json
{
    "body": "**Changing commit** from \"[aaf0680040c96e439877eac471bd3e2cd4515a94](https://github.com/sagemath/sagetrac-mirror/commit/aaf0680040c96e439877eac471bd3e2cd4515a94)\" to \"[fb023491c50c1097963987e007f5d088e9e73515](https://github.com/sagemath/sagetrac-mirror/commit/fb023491c50c1097963987e007f5d088e9e73515)\".",
    "created_at": "2021-03-24T19:49:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627360",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[aaf0680040c96e439877eac471bd3e2cd4515a94](https://github.com/sagemath/sagetrac-mirror/commit/aaf0680040c96e439877eac471bd3e2cd4515a94)" to "[fb023491c50c1097963987e007f5d088e9e73515](https://github.com/sagemath/sagetrac-mirror/commit/fb023491c50c1097963987e007f5d088e9e73515)".



---

archive/issue_comments_627361.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fb023491c50c1097963987e007f5d088e9e73515\">fb02349</a></td><td><code>Reorder todos</code></td></tr></table>\n",
    "created_at": "2021-03-24T19:49:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627361",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fb023491c50c1097963987e007f5d088e9e73515">fb02349</a></td><td><code>Reorder todos</code></td></tr></table>




---

archive/issue_comments_627362.json:
```json
{
    "body": "**Changing commit** from \"[fb023491c50c1097963987e007f5d088e9e73515](https://github.com/sagemath/sagetrac-mirror/commit/fb023491c50c1097963987e007f5d088e9e73515)\" to \"[cecbe3010e5438cdc77667507fe2dcfb2f170eb3](https://github.com/sagemath/sagetrac-mirror/commit/cecbe3010e5438cdc77667507fe2dcfb2f170eb3)\".",
    "created_at": "2021-03-25T16:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627362",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[fb023491c50c1097963987e007f5d088e9e73515](https://github.com/sagemath/sagetrac-mirror/commit/fb023491c50c1097963987e007f5d088e9e73515)" to "[cecbe3010e5438cdc77667507fe2dcfb2f170eb3](https://github.com/sagemath/sagetrac-mirror/commit/cecbe3010e5438cdc77667507fe2dcfb2f170eb3)".



---

archive/issue_comments_627363.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/31d05e43989eac7fa5c80edfd40857bf50e4ad85\">31d05e4</a></td><td><code>inverses, swap rows and columns</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d69baff52e0904a356199c4da79520c7e74fd4a5\">d69baff</a></td><td><code>richmp</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba439fc946628764a9981a206bd2328c254e9161\">ba439fc</a></td><td><code>Merge branch 'u/roed/nmod_mat' of git://trac.sagemath.org/sage into nmod_mat</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9285ed3ddc9f33a7063397ba97089d7383cb4c35\">9285ed3</a></td><td><code>Merge branch 'u/roed/nmod_mat' of git://trac.sagemath.org/sage into nmod_mat</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6a3d32a4914bf66b24515cfc53af639619419b47\">6a3d32a</a></td><td><code>justifying flags</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a90423a2b820e7d08fedbd7e0e7fd71dd875bbca\">a90423a</a></td><td><code>Merge branch 'u/roed/nmod_mat' of git://trac.sagemath.org/sage into nmod_mat</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c7c68cd6c8674f4291a96a330e0a98631a96f503\">c7c68cd</a></td><td><code>some progress</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61821e8de5e4394a3dcfb97d17a00b732fbd32e8\">61821e8</a></td><td><code>fixing various things</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cecbe3010e5438cdc77667507fe2dcfb2f170eb3\">cecbe30</a></td><td><code>Merge branch 'u/edgarcosta/nmod_mat' of git://trac.sagemath.org/sage into t/31548/nmod_mat</code></td></tr></table>\n",
    "created_at": "2021-03-25T16:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627363",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/31d05e43989eac7fa5c80edfd40857bf50e4ad85">31d05e4</a></td><td><code>inverses, swap rows and columns</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d69baff52e0904a356199c4da79520c7e74fd4a5">d69baff</a></td><td><code>richmp</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba439fc946628764a9981a206bd2328c254e9161">ba439fc</a></td><td><code>Merge branch 'u/roed/nmod_mat' of git://trac.sagemath.org/sage into nmod_mat</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9285ed3ddc9f33a7063397ba97089d7383cb4c35">9285ed3</a></td><td><code>Merge branch 'u/roed/nmod_mat' of git://trac.sagemath.org/sage into nmod_mat</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6a3d32a4914bf66b24515cfc53af639619419b47">6a3d32a</a></td><td><code>justifying flags</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a90423a2b820e7d08fedbd7e0e7fd71dd875bbca">a90423a</a></td><td><code>Merge branch 'u/roed/nmod_mat' of git://trac.sagemath.org/sage into nmod_mat</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c7c68cd6c8674f4291a96a330e0a98631a96f503">c7c68cd</a></td><td><code>some progress</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61821e8de5e4394a3dcfb97d17a00b732fbd32e8">61821e8</a></td><td><code>fixing various things</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cecbe3010e5438cdc77667507fe2dcfb2f170eb3">cecbe30</a></td><td><code>Merge branch 'u/edgarcosta/nmod_mat' of git://trac.sagemath.org/sage into t/31548/nmod_mat</code></td></tr></table>




---

archive/issue_comments_627364.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eb56a5eca717c8929ee22b43ced2e89a9ffa9d9e\">eb56a5e</a></td><td><code>Add all definitions to FLINT's ulong_extras, optimize matrix inversion, change default class for matrix mod n</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/db33b05407674b601d914aa9e13deca6b1280cb2\">db33b05</a></td><td><code>Charpoly for Z/n</code></td></tr></table>\n",
    "created_at": "2021-03-26T17:17:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627364",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eb56a5eca717c8929ee22b43ced2e89a9ffa9d9e">eb56a5e</a></td><td><code>Add all definitions to FLINT's ulong_extras, optimize matrix inversion, change default class for matrix mod n</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/db33b05407674b601d914aa9e13deca6b1280cb2">db33b05</a></td><td><code>Charpoly for Z/n</code></td></tr></table>




---

archive/issue_comments_627365.json:
```json
{
    "body": "**Changing commit** from \"[cecbe3010e5438cdc77667507fe2dcfb2f170eb3](https://github.com/sagemath/sagetrac-mirror/commit/cecbe3010e5438cdc77667507fe2dcfb2f170eb3)\" to \"[db33b05407674b601d914aa9e13deca6b1280cb2](https://github.com/sagemath/sagetrac-mirror/commit/db33b05407674b601d914aa9e13deca6b1280cb2)\".",
    "created_at": "2021-03-26T17:17:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627365",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[cecbe3010e5438cdc77667507fe2dcfb2f170eb3](https://github.com/sagemath/sagetrac-mirror/commit/cecbe3010e5438cdc77667507fe2dcfb2f170eb3)" to "[db33b05407674b601d914aa9e13deca6b1280cb2](https://github.com/sagemath/sagetrac-mirror/commit/db33b05407674b601d914aa9e13deca6b1280cb2)".



---

archive/issue_events_093338.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-27T02:13:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31548#event-93338"
}
```




---

archive/issue_comments_627366.json:
```json
{
    "body": "<a id='comment:10'></a>\nSage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-27T02:13:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627366",
    "user": "https://github.com/mkoeppe"
}
```


<a id='comment:10'></a>
Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_627367.json:
```json
{
    "body": "<a id='comment:11'></a>\n**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/33dd3950a3fe7afada7359a68c6a9537ddd195d6\">33dd395</a></td><td><code>comment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b922d8eb2c0441a56afbb05c605626278414a277\">b922d8e</a></td><td><code>Merge branch 'u/roed/nmod_mat' of git://trac.sagemath.org/sage into nmod_mat</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c1961a223c074ea026d3ecff1ff076fa4a6bdd54\">c1961a2</a></td><td><code>right kernel matrix</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b1d5396e095e80fd9857092b4412b0841c476b3d\">b1d5396</a></td><td><code>Merge branch 'u/roed/nmod_mat' of git://trac.sagemath.org/sage into nmod_mat</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b9965be799b4612afbdec8f8b75e05a6037a173d\">b9965be</a></td><td><code>remove comment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/10452071cf97d5f4c85ca926c46e7dd1dfa0ca00\">1045207</a></td><td><code>touch up right kernel</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fb619b0ab2ccdb99d85fd353c9a757bd40c16b71\">fb619b0</a></td><td><code>work around echenolize</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/45de1c83ffcf3f6e95192be8f78a547786c95479\">45de1c8</a></td><td><code>remove stack</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bf8aaabd9aece08be06f49997a3f1942dc041b8b\">bf8aaab</a></td><td><code>Merge branch 'u/edgarcosta/nmod_mat' of git://trac.sagemath.org/sage into t/31548/nmod_mat</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3eb1cd4bd49e263e96d86c261d07afa2e7916275\">3eb1cd4</a></td><td><code>Fix import</code></td></tr></table>\n",
    "created_at": "2021-03-29T21:17:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627367",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:11'></a>
**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/33dd3950a3fe7afada7359a68c6a9537ddd195d6">33dd395</a></td><td><code>comment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b922d8eb2c0441a56afbb05c605626278414a277">b922d8e</a></td><td><code>Merge branch 'u/roed/nmod_mat' of git://trac.sagemath.org/sage into nmod_mat</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c1961a223c074ea026d3ecff1ff076fa4a6bdd54">c1961a2</a></td><td><code>right kernel matrix</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b1d5396e095e80fd9857092b4412b0841c476b3d">b1d5396</a></td><td><code>Merge branch 'u/roed/nmod_mat' of git://trac.sagemath.org/sage into nmod_mat</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b9965be799b4612afbdec8f8b75e05a6037a173d">b9965be</a></td><td><code>remove comment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/10452071cf97d5f4c85ca926c46e7dd1dfa0ca00">1045207</a></td><td><code>touch up right kernel</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fb619b0ab2ccdb99d85fd353c9a757bd40c16b71">fb619b0</a></td><td><code>work around echenolize</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/45de1c83ffcf3f6e95192be8f78a547786c95479">45de1c8</a></td><td><code>remove stack</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bf8aaabd9aece08be06f49997a3f1942dc041b8b">bf8aaab</a></td><td><code>Merge branch 'u/edgarcosta/nmod_mat' of git://trac.sagemath.org/sage into t/31548/nmod_mat</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3eb1cd4bd49e263e96d86c261d07afa2e7916275">3eb1cd4</a></td><td><code>Fix import</code></td></tr></table>




---

archive/issue_comments_627368.json:
```json
{
    "body": "**Changing commit** from \"[db33b05407674b601d914aa9e13deca6b1280cb2](https://github.com/sagemath/sagetrac-mirror/commit/db33b05407674b601d914aa9e13deca6b1280cb2)\" to \"[3eb1cd4bd49e263e96d86c261d07afa2e7916275](https://github.com/sagemath/sagetrac-mirror/commit/3eb1cd4bd49e263e96d86c261d07afa2e7916275)\".",
    "created_at": "2021-03-29T21:17:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627368",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[db33b05407674b601d914aa9e13deca6b1280cb2](https://github.com/sagemath/sagetrac-mirror/commit/db33b05407674b601d914aa9e13deca6b1280cb2)" to "[3eb1cd4bd49e263e96d86c261d07afa2e7916275](https://github.com/sagemath/sagetrac-mirror/commit/3eb1cd4bd49e263e96d86c261d07afa2e7916275)".



---

archive/issue_comments_627369.json:
```json
{
    "body": "**Dependencies:** #31069",
    "created_at": "2021-03-30T06:00:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627369",
    "user": "https://github.com/roed314"
}
```


**Dependencies:** #31069



---

archive/issue_comments_627370.json:
```json
{
    "body": "**Changing commit** from \"[3eb1cd4bd49e263e96d86c261d07afa2e7916275](https://github.com/sagemath/sagetrac-mirror/commit/3eb1cd4bd49e263e96d86c261d07afa2e7916275)\" to \"[aed23614745507fa84876489c00f5abc77990c72](https://github.com/sagemath/sagetrac-mirror/commit/aed23614745507fa84876489c00f5abc77990c72)\".",
    "created_at": "2021-03-30T17:51:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627370",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[3eb1cd4bd49e263e96d86c261d07afa2e7916275](https://github.com/sagemath/sagetrac-mirror/commit/3eb1cd4bd49e263e96d86c261d07afa2e7916275)" to "[aed23614745507fa84876489c00f5abc77990c72](https://github.com/sagemath/sagetrac-mirror/commit/aed23614745507fa84876489c00f5abc77990c72)".



---

archive/issue_comments_627371.json:
```json
{
    "body": "<a id='comment:13'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8c71a1c694075d021008794ef3a6fd461ec4dc0e\">8c71a1c</a></td><td><code>31069: flint version upgrade</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a32be02fdbfdf48b5f93b18e4b5b124ba190a136\">a32be02</a></td><td><code>Merge branch 'public/31069' of git://trac.sagemath.org/sage into t/31548/nmod_mat</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aed23614745507fa84876489c00f5abc77990c72\">aed2361</a></td><td><code>Working on solve_right</code></td></tr></table>\n",
    "created_at": "2021-03-30T17:51:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627371",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:13'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8c71a1c694075d021008794ef3a6fd461ec4dc0e">8c71a1c</a></td><td><code>31069: flint version upgrade</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a32be02fdbfdf48b5f93b18e4b5b124ba190a136">a32be02</a></td><td><code>Merge branch 'public/31069' of git://trac.sagemath.org/sage into t/31548/nmod_mat</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aed23614745507fa84876489c00f5abc77990c72">aed2361</a></td><td><code>Working on solve_right</code></td></tr></table>




---

archive/issue_comments_627372.json:
```json
{
    "body": "**Changing commit** from \"[aed23614745507fa84876489c00f5abc77990c72](https://github.com/sagemath/sagetrac-mirror/commit/aed23614745507fa84876489c00f5abc77990c72)\" to \"[5e9b8a7b06100833a6dc3a1f9efdca7592fbdcb6](https://github.com/sagemath/sagetrac-mirror/commit/5e9b8a7b06100833a6dc3a1f9efdca7592fbdcb6)\".",
    "created_at": "2021-04-07T07:05:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627372",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[aed23614745507fa84876489c00f5abc77990c72](https://github.com/sagemath/sagetrac-mirror/commit/aed23614745507fa84876489c00f5abc77990c72)" to "[5e9b8a7b06100833a6dc3a1f9efdca7592fbdcb6](https://github.com/sagemath/sagetrac-mirror/commit/5e9b8a7b06100833a6dc3a1f9efdca7592fbdcb6)".



---

archive/issue_comments_627373.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b378635cce4fcec55f0f2af1c31322e955da70a\">8b37863</a></td><td><code>Working on minpoly</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/15410058ca9360c1a3a71f6cfb8d98f3b170c195\">1541005</a></td><td><code>int64</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a4b815a08d176fefa0f044d74a5630fa7d1b50c\">8a4b815</a></td><td><code>import</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1f40b95cf38d5cdd94188611954f572b60f550c7\">1f40b95</a></td><td><code>int64</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2d157e14d4a31d5bedbb2b978c7af9fbd4911d52\">2d157e1</a></td><td><code>Merge branch 'u/edgarcosta/nmod_mat' of git://trac.sagemath.org/sage into t/31548/nmod_mat</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5e9b8a7b06100833a6dc3a1f9efdca7592fbdcb6\">5e9b8a7</a></td><td><code>Minpoly</code></td></tr></table>\n",
    "created_at": "2021-04-07T07:05:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627373",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b378635cce4fcec55f0f2af1c31322e955da70a">8b37863</a></td><td><code>Working on minpoly</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/15410058ca9360c1a3a71f6cfb8d98f3b170c195">1541005</a></td><td><code>int64</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a4b815a08d176fefa0f044d74a5630fa7d1b50c">8a4b815</a></td><td><code>import</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1f40b95cf38d5cdd94188611954f572b60f550c7">1f40b95</a></td><td><code>int64</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2d157e14d4a31d5bedbb2b978c7af9fbd4911d52">2d157e1</a></td><td><code>Merge branch 'u/edgarcosta/nmod_mat' of git://trac.sagemath.org/sage into t/31548/nmod_mat</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5e9b8a7b06100833a6dc3a1f9efdca7592fbdcb6">5e9b8a7</a></td><td><code>Minpoly</code></td></tr></table>




---

archive/issue_comments_627374.json:
```json
{
    "body": "**Changing commit** from \"[5e9b8a7b06100833a6dc3a1f9efdca7592fbdcb6](https://github.com/sagemath/sagetrac-mirror/commit/5e9b8a7b06100833a6dc3a1f9efdca7592fbdcb6)\" to \"[fc48eca590a15e596660601f61c4eba80bf1b249](https://github.com/sagemath/sagetrac-mirror/commit/fc48eca590a15e596660601f61c4eba80bf1b249)\".",
    "created_at": "2021-04-08T21:05:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627374",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[5e9b8a7b06100833a6dc3a1f9efdca7592fbdcb6](https://github.com/sagemath/sagetrac-mirror/commit/5e9b8a7b06100833a6dc3a1f9efdca7592fbdcb6)" to "[fc48eca590a15e596660601f61c4eba80bf1b249](https://github.com/sagemath/sagetrac-mirror/commit/fc48eca590a15e596660601f61c4eba80bf1b249)".



---

archive/issue_comments_627375.json:
```json
{
    "body": "<a id='comment:15'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc48eca590a15e596660601f61c4eba80bf1b249\">fc48eca</a></td><td><code>Working on documentation</code></td></tr></table>\n",
    "created_at": "2021-04-08T21:05:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627375",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:15'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc48eca590a15e596660601f61c4eba80bf1b249">fc48eca</a></td><td><code>Working on documentation</code></td></tr></table>




---

archive/issue_comments_627376.json:
```json
{
    "body": "**Changing commit** from \"[fc48eca590a15e596660601f61c4eba80bf1b249](https://github.com/sagemath/sagetrac-mirror/commit/fc48eca590a15e596660601f61c4eba80bf1b249)\" to \"[64e44fc055b8a7f2fb69207d5e145771e4e22847](https://github.com/sagemath/sagetrac-mirror/commit/64e44fc055b8a7f2fb69207d5e145771e4e22847)\".",
    "created_at": "2021-04-13T17:56:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627376",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[fc48eca590a15e596660601f61c4eba80bf1b249](https://github.com/sagemath/sagetrac-mirror/commit/fc48eca590a15e596660601f61c4eba80bf1b249)" to "[64e44fc055b8a7f2fb69207d5e145771e4e22847](https://github.com/sagemath/sagetrac-mirror/commit/64e44fc055b8a7f2fb69207d5e145771e4e22847)".



---

archive/issue_comments_627377.json:
```json
{
    "body": "<a id='comment:16'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/64e44fc055b8a7f2fb69207d5e145771e4e22847\">64e44fc</a></td><td><code>Fixing bugs and adding documentation to matrices mod n</code></td></tr></table>\n",
    "created_at": "2021-04-13T17:56:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627377",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:16'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/64e44fc055b8a7f2fb69207d5e145771e4e22847">64e44fc</a></td><td><code>Fixing bugs and adding documentation to matrices mod n</code></td></tr></table>




---

archive/issue_comments_627378.json:
```json
{
    "body": "<a id='comment:17'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e5c4c1e1b8dfda617f4b1e16f807ba42807a3387\">e5c4c1e</a></td><td><code>Working on documentation</code></td></tr></table>\n",
    "created_at": "2021-04-16T19:04:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627378",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:17'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e5c4c1e1b8dfda617f4b1e16f807ba42807a3387">e5c4c1e</a></td><td><code>Working on documentation</code></td></tr></table>




---

archive/issue_comments_627379.json:
```json
{
    "body": "**Changing commit** from \"[64e44fc055b8a7f2fb69207d5e145771e4e22847](https://github.com/sagemath/sagetrac-mirror/commit/64e44fc055b8a7f2fb69207d5e145771e4e22847)\" to \"[e5c4c1e1b8dfda617f4b1e16f807ba42807a3387](https://github.com/sagemath/sagetrac-mirror/commit/e5c4c1e1b8dfda617f4b1e16f807ba42807a3387)\".",
    "created_at": "2021-04-16T19:04:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627379",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[64e44fc055b8a7f2fb69207d5e145771e4e22847](https://github.com/sagemath/sagetrac-mirror/commit/64e44fc055b8a7f2fb69207d5e145771e4e22847)" to "[e5c4c1e1b8dfda617f4b1e16f807ba42807a3387](https://github.com/sagemath/sagetrac-mirror/commit/e5c4c1e1b8dfda617f4b1e16f807ba42807a3387)".



---

archive/issue_comments_627380.json:
```json
{
    "body": "**Changing commit** from \"[e5c4c1e1b8dfda617f4b1e16f807ba42807a3387](https://github.com/sagemath/sagetrac-mirror/commit/e5c4c1e1b8dfda617f4b1e16f807ba42807a3387)\" to \"[1a7bb38565f649d78c24122033a732b517d27f3f](https://github.com/sagemath/sagetrac-mirror/commit/1a7bb38565f649d78c24122033a732b517d27f3f)\".",
    "created_at": "2021-04-16T22:25:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627380",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[e5c4c1e1b8dfda617f4b1e16f807ba42807a3387](https://github.com/sagemath/sagetrac-mirror/commit/e5c4c1e1b8dfda617f4b1e16f807ba42807a3387)" to "[1a7bb38565f649d78c24122033a732b517d27f3f](https://github.com/sagemath/sagetrac-mirror/commit/1a7bb38565f649d78c24122033a732b517d27f3f)".



---

archive/issue_comments_627381.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dad23f516324d5002a7f4eefd735322816e8747f\">dad23f5</a></td><td><code>Working on picking appropriate matrix types and fixing some bugs</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1a7bb38565f649d78c24122033a732b517d27f3f\">1a7bb38</a></td><td><code>Fixing some bugs</code></td></tr></table>\n",
    "created_at": "2021-04-16T22:25:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627381",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dad23f516324d5002a7f4eefd735322816e8747f">dad23f5</a></td><td><code>Working on picking appropriate matrix types and fixing some bugs</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1a7bb38565f649d78c24122033a732b517d27f3f">1a7bb38</a></td><td><code>Fixing some bugs</code></td></tr></table>




---

archive/issue_comments_627382.json:
```json
{
    "body": "**Changing commit** from \"[1a7bb38565f649d78c24122033a732b517d27f3f](https://github.com/sagemath/sagetrac-mirror/commit/1a7bb38565f649d78c24122033a732b517d27f3f)\" to \"[6f41da9cadc509baa5d221e354a7eaa797574bed](https://github.com/sagemath/sagetrac-mirror/commit/6f41da9cadc509baa5d221e354a7eaa797574bed)\".",
    "created_at": "2021-04-20T07:40:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627382",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[1a7bb38565f649d78c24122033a732b517d27f3f](https://github.com/sagemath/sagetrac-mirror/commit/1a7bb38565f649d78c24122033a732b517d27f3f)" to "[6f41da9cadc509baa5d221e354a7eaa797574bed](https://github.com/sagemath/sagetrac-mirror/commit/6f41da9cadc509baa5d221e354a7eaa797574bed)".



---

archive/issue_comments_627383.json:
```json
{
    "body": "<a id='comment:19'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f41da9cadc509baa5d221e354a7eaa797574bed\">6f41da9</a></td><td><code>Fixing doctest problems from switching default implementation to flint for small matrices</code></td></tr></table>\n",
    "created_at": "2021-04-20T07:40:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627383",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:19'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f41da9cadc509baa5d221e354a7eaa797574bed">6f41da9</a></td><td><code>Fixing doctest problems from switching default implementation to flint for small matrices</code></td></tr></table>




---

archive/issue_comments_627384.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2021-04-20T07:41:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627384",
    "user": "https://github.com/roed314"
}
```


**Changing status** from new to needs_review.



---

archive/issue_comments_627385.json:
```json
{
    "body": "<a id='comment:20'></a>\nMarking for patchbot to test....",
    "created_at": "2021-04-20T07:41:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627385",
    "user": "https://github.com/roed314"
}
```


<a id='comment:20'></a>
Marking for patchbot to test....



---

archive/issue_comments_627386.json:
```json
{
    "body": "**Author:** David Roe, Edgar Costa",
    "created_at": "2021-04-20T07:41:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627386",
    "user": "https://github.com/roed314"
}
```


**Author:** David Roe, Edgar Costa



---

archive/issue_comments_627387.json:
```json
{
    "body": "<a id='comment:21'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d0507c40a70edb79662579890db723165b622fa1\">d0507c4</a></td><td><code>Working on fixing reduction matrix bug</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9748ffc23e3e3b163ae65207f1790de020040dda\">9748ffc</a></td><td><code>Add deprecation warning to _reduction_matrix</code></td></tr></table>\n",
    "created_at": "2021-04-22T19:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627387",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:21'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d0507c40a70edb79662579890db723165b622fa1">d0507c4</a></td><td><code>Working on fixing reduction matrix bug</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9748ffc23e3e3b163ae65207f1790de020040dda">9748ffc</a></td><td><code>Add deprecation warning to _reduction_matrix</code></td></tr></table>




---

archive/issue_comments_627388.json:
```json
{
    "body": "**Changing commit** from \"[6f41da9cadc509baa5d221e354a7eaa797574bed](https://github.com/sagemath/sagetrac-mirror/commit/6f41da9cadc509baa5d221e354a7eaa797574bed)\" to \"[9748ffc23e3e3b163ae65207f1790de020040dda](https://github.com/sagemath/sagetrac-mirror/commit/9748ffc23e3e3b163ae65207f1790de020040dda)\".",
    "created_at": "2021-04-22T19:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627388",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[6f41da9cadc509baa5d221e354a7eaa797574bed](https://github.com/sagemath/sagetrac-mirror/commit/6f41da9cadc509baa5d221e354a7eaa797574bed)" to "[9748ffc23e3e3b163ae65207f1790de020040dda](https://github.com/sagemath/sagetrac-mirror/commit/9748ffc23e3e3b163ae65207f1790de020040dda)".



---

archive/issue_comments_627389.json:
```json
{
    "body": "<a id='comment:22'></a>\nIf you aren't yet ready for comments, I apologize. However, I made a quick skim over things before I realized you set this as needs review for the patchbot.\n\nFor `def _change_implementation`, wouldn't it make more sense to be `cdef` or `cpdef` since it should be called entirely from internal stuff? Also, in that implementation, I don't think we should use `self.list()` for spare matrices. I also generally find using `sage.matrix.matrix_space.MatrixSpace` unstable and think it is better to have a direct import.\n\nI know you said this is for the patchbot, but it would be good to have doctests for `_solve_right_modn`. I would also add\n\n```\ncdef list X\ncdef Py_ssize_t n\n```\nchange\n\n```diff\n-            X = self.matrix_space(B.ncols(), self.ncols())(X)\n-            return X.T\n+            return self.matrix_space(B.ncols(), self.ncols())(X).T\n```\n(perhaps casting the result as a matrix too), and mark `B` as a `Matrix`.\n\nI am not sure about the name of the files being `matrix_nmod_dense` and the subsequently the name of the class. It conflicts with the `matrix_modn_*` files and I feel it is too generic given that it is for a specific implementation.\n\nWhy is `poly_crt` in the matrix file?\n\n`can't` -> `cannot` as we want to make the writing formal.\n\nIt would be good to implement a `get_is_zero_unsafe` method.",
    "created_at": "2021-04-23T01:40:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627389",
    "user": "https://github.com/tscrim"
}
```


<a id='comment:22'></a>
If you aren't yet ready for comments, I apologize. However, I made a quick skim over things before I realized you set this as needs review for the patchbot.

For `def _change_implementation`, wouldn't it make more sense to be `cdef` or `cpdef` since it should be called entirely from internal stuff? Also, in that implementation, I don't think we should use `self.list()` for spare matrices. I also generally find using `sage.matrix.matrix_space.MatrixSpace` unstable and think it is better to have a direct import.

I know you said this is for the patchbot, but it would be good to have doctests for `_solve_right_modn`. I would also add

```
cdef list X
cdef Py_ssize_t n
```
change

```diff
-            X = self.matrix_space(B.ncols(), self.ncols())(X)
-            return X.T
+            return self.matrix_space(B.ncols(), self.ncols())(X).T
```
(perhaps casting the result as a matrix too), and mark `B` as a `Matrix`.

I am not sure about the name of the files being `matrix_nmod_dense` and the subsequently the name of the class. It conflicts with the `matrix_modn_*` files and I feel it is too generic given that it is for a specific implementation.

Why is `poly_crt` in the matrix file?

`can't` -> `cannot` as we want to make the writing formal.

It would be good to implement a `get_is_zero_unsafe` method.



---

archive/issue_comments_627390.json:
```json
{
    "body": "<a id='comment:23'></a>\nNo problem!  I'm still working on stuff, so comments are easily incorporated.  I also realized that the patchbot won't test this since it relies on spkgs until #31069 is merged.\n\nDo you think `matrix_modn_flint` and `Matrix_modn_flint` would be better?\n\nThe `poly_crt` function is left over from an earlier implementation of `charpoly` or `minpoly` (I forget which).  I will take care of it.\n\nThanks!",
    "created_at": "2021-04-23T02:08:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627390",
    "user": "https://github.com/roed314"
}
```


<a id='comment:23'></a>
No problem!  I'm still working on stuff, so comments are easily incorporated.  I also realized that the patchbot won't test this since it relies on spkgs until #31069 is merged.

Do you think `matrix_modn_flint` and `Matrix_modn_flint` would be better?

The `poly_crt` function is left over from an earlier implementation of `charpoly` or `minpoly` (I forget which).  I will take care of it.

Thanks!



---

archive/issue_comments_627391.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [roed](#comment%3A23):\n> No problem!  I'm still working on stuff, so comments are easily incorporated.  I also realized that the patchbot won't test this since it relies on spkgs until #31069 is merged.\n\n\nYea, I didn't quite realize that either. ^^;;\n\n> Do you think `matrix_modn_flint` and `Matrix_modn_flint` would be better?\n\n\nThe former for the name of the file, the latter for the name of the class considering the other matrix classes in Sage.\n\nLet me know if there is anything I can do to help too.",
    "created_at": "2021-04-23T02:16:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627391",
    "user": "https://github.com/tscrim"
}
```


<a id='comment:24'></a>
Replying to [roed](#comment%3A23):
> No problem!  I'm still working on stuff, so comments are easily incorporated.  I also realized that the patchbot won't test this since it relies on spkgs until #31069 is merged.


Yea, I didn't quite realize that either. ^^;;

> Do you think `matrix_modn_flint` and `Matrix_modn_flint` would be better?


The former for the name of the file, the latter for the name of the class considering the other matrix classes in Sage.

Let me know if there is anything I can do to help too.



---

archive/issue_comments_627392.json:
```json
{
    "body": "**Changing commit** from \"[9748ffc23e3e3b163ae65207f1790de020040dda](https://github.com/sagemath/sagetrac-mirror/commit/9748ffc23e3e3b163ae65207f1790de020040dda)\" to \"[465f51de75fc202f7c5c9b636e39501e2dda3b0a](https://github.com/sagemath/sagetrac-mirror/commit/465f51de75fc202f7c5c9b636e39501e2dda3b0a)\".",
    "created_at": "2021-04-26T18:11:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627392",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[9748ffc23e3e3b163ae65207f1790de020040dda](https://github.com/sagemath/sagetrac-mirror/commit/9748ffc23e3e3b163ae65207f1790de020040dda)" to "[465f51de75fc202f7c5c9b636e39501e2dda3b0a](https://github.com/sagemath/sagetrac-mirror/commit/465f51de75fc202f7c5c9b636e39501e2dda3b0a)".



---

archive/issue_comments_627393.json:
```json
{
    "body": "<a id='comment:25'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cd1b853a077f49303bd0b104cfec5ff768356517\">cd1b853</a></td><td><code>Merge branch 'u/roed/nmod_mat' of trac.sagemath.org:sage into t/31548/nmod_mat</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6e2b75a86538a647c83af05b3336b5ef384192a9\">6e2b75a</a></td><td><code>Merge branch 'u/roed/nmod_mat' of trac.sagemath.org:sage into t/31548/nmod_mat</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ee10b06f426b75a04e5339e0ece5dae8c958c978\">ee10b06</a></td><td><code>Working on documentation and fixing tests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/465f51de75fc202f7c5c9b636e39501e2dda3b0a\">465f51d</a></td><td><code>Working on documentation</code></td></tr></table>\n",
    "created_at": "2021-04-26T18:11:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627393",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:25'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cd1b853a077f49303bd0b104cfec5ff768356517">cd1b853</a></td><td><code>Merge branch 'u/roed/nmod_mat' of trac.sagemath.org:sage into t/31548/nmod_mat</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6e2b75a86538a647c83af05b3336b5ef384192a9">6e2b75a</a></td><td><code>Merge branch 'u/roed/nmod_mat' of trac.sagemath.org:sage into t/31548/nmod_mat</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ee10b06f426b75a04e5339e0ece5dae8c958c978">ee10b06</a></td><td><code>Working on documentation and fixing tests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/465f51de75fc202f7c5c9b636e39501e2dda3b0a">465f51d</a></td><td><code>Working on documentation</code></td></tr></table>




---

archive/issue_comments_627394.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [tscrim](#comment%3A22):\n> For `def _change_implementation`, wouldn't it make more sense to be `cdef` or `cpdef` since it should be called entirely from internal stuff? Also, in that implementation, I don't think we should use `self.list()` for spare matrices. I also generally find using `sage.matrix.matrix_space.MatrixSpace` unstable and think it is better to have a direct import.\n\n\nEven for a 2 by 2 matrix where the calling overhead is most substantial, changing to `cpdef` makes a negligible difference:\n\n```\nsage: A = random_matrix(Zmod(120), 2)                                                                                                               \nsage: A                                                                                                                                             \n[ 32 108]\n[  2 112]\nsage: %time B = A._change_implementation(\"linbox\") # using def                                                                                                \nCPU times: user 339 \u00b5s, sys: 8 \u00b5s, total: 347 \u00b5s\nWall time: 350 \u00b5s\n```\n\n```\nsage: A = random_matrix(Zmod(120), 2) # using cpdef                                                                                                                                                                                                                       \nsage: %time B = A._change_implementation(\"linbox\")                                                                                                                                                                                                            \nCPU times: user 334 \u00b5s, sys: 5 \u00b5s, total: 339 \u00b5s\nWall time: 343 \u00b5s\n```\nI don't think it's worth the cost of recompiling everything depending on `matrix0.pxd`, and the risk of developers accidentally using `def` instead of `cpdef` on a matrix class in the future.\n\nI agree about sparse matrices, but currently in `sage.matrix.matrix_space.get_matrix_class` we don't allow the `implementation` keyword for sparse matrices, so the issue is moot.  I'd be happy to have more sparse matrices in Sage eventually, but for now there's no way to even test a version of `_change_implementation` in `Matrix_sparse`.\n\nI'm not sure what you mean by using `sage.matrix.matrix_space.MatrixSpace` unstable.  Do you mean switching to `from sage.matrix.matrix_space import MatrixSpace`?  I was just copying what's done a couple dozen lines above in `matrix2.pyx`, but I'm happy to make this change if desired.\n> \n> I know you said this is for the patchbot, but it would be good to have doctests for `_solve_right_modn`. \n\n\nAgreed.  I've added them.\n\n> I would also add\n> \n> ```\n> cdef list X\n> cdef Py_ssize_t n\n> ```\n> change\n> \n> ```diff\n> -            X = self.matrix_space(B.ncols(), self.ncols())(X)\n> -            return X.T\n> +            return self.matrix_space(B.ncols(), self.ncols())(X).T\n> ```\n> (perhaps casting the result as a matrix too), and mark `B` as a `Matrix`.\n\n\nI've added the `cdef Py_ssize_t n` since that can speed up the loop, and made the change you suggested in the diff.  I don't think it's necessary to mark `X` as a list or `B` as a matrix, since I'm not calling any functions that will benefit from knowing the types (and the runtime is surely dominated by the call to Pari's `matsolvemod`)\n\n> I am not sure about the name of the files being `matrix_nmod_dense` and the subsequently the name of the class. It conflicts with the `matrix_modn_*` files and I feel it is too generic given that it is for a specific implementation.\n\n\nAgreed.  I've changed it to `matrix_modn_dense_flint`.\n\n> Why is `poly_crt` in the matrix file?\n\n\nI've created #31731 and removed it from this ticket.\n\n> `can't` -> `cannot` as we want to make the writing formal.\n> \n> It would be good to implement a `get_is_zero_unsafe` method.\n\n\nBoth done.",
    "created_at": "2021-04-26T19:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627394",
    "user": "https://github.com/roed314"
}
```


<a id='comment:26'></a>
Replying to [tscrim](#comment%3A22):
> For `def _change_implementation`, wouldn't it make more sense to be `cdef` or `cpdef` since it should be called entirely from internal stuff? Also, in that implementation, I don't think we should use `self.list()` for spare matrices. I also generally find using `sage.matrix.matrix_space.MatrixSpace` unstable and think it is better to have a direct import.


Even for a 2 by 2 matrix where the calling overhead is most substantial, changing to `cpdef` makes a negligible difference:

```
sage: A = random_matrix(Zmod(120), 2)                                                                                                               
sage: A                                                                                                                                             
[ 32 108]
[  2 112]
sage: %time B = A._change_implementation("linbox") # using def                                                                                                
CPU times: user 339 µs, sys: 8 µs, total: 347 µs
Wall time: 350 µs
```

```
sage: A = random_matrix(Zmod(120), 2) # using cpdef                                                                                                                                                                                                                       
sage: %time B = A._change_implementation("linbox")                                                                                                                                                                                                            
CPU times: user 334 µs, sys: 5 µs, total: 339 µs
Wall time: 343 µs
```
I don't think it's worth the cost of recompiling everything depending on `matrix0.pxd`, and the risk of developers accidentally using `def` instead of `cpdef` on a matrix class in the future.

I agree about sparse matrices, but currently in `sage.matrix.matrix_space.get_matrix_class` we don't allow the `implementation` keyword for sparse matrices, so the issue is moot.  I'd be happy to have more sparse matrices in Sage eventually, but for now there's no way to even test a version of `_change_implementation` in `Matrix_sparse`.

I'm not sure what you mean by using `sage.matrix.matrix_space.MatrixSpace` unstable.  Do you mean switching to `from sage.matrix.matrix_space import MatrixSpace`?  I was just copying what's done a couple dozen lines above in `matrix2.pyx`, but I'm happy to make this change if desired.
> 
> I know you said this is for the patchbot, but it would be good to have doctests for `_solve_right_modn`. 


Agreed.  I've added them.

> I would also add
> 
> ```
> cdef list X
> cdef Py_ssize_t n
> ```
> change
> 
> ```diff
> -            X = self.matrix_space(B.ncols(), self.ncols())(X)
> -            return X.T
> +            return self.matrix_space(B.ncols(), self.ncols())(X).T
> ```
> (perhaps casting the result as a matrix too), and mark `B` as a `Matrix`.


I've added the `cdef Py_ssize_t n` since that can speed up the loop, and made the change you suggested in the diff.  I don't think it's necessary to mark `X` as a list or `B` as a matrix, since I'm not calling any functions that will benefit from knowing the types (and the runtime is surely dominated by the call to Pari's `matsolvemod`)

> I am not sure about the name of the files being `matrix_nmod_dense` and the subsequently the name of the class. It conflicts with the `matrix_modn_*` files and I feel it is too generic given that it is for a specific implementation.


Agreed.  I've changed it to `matrix_modn_dense_flint`.

> Why is `poly_crt` in the matrix file?


I've created #31731 and removed it from this ticket.

> `can't` -> `cannot` as we want to make the writing formal.
> 
> It would be good to implement a `get_is_zero_unsafe` method.


Both done.



---

archive/issue_comments_627395.json:
```json
{
    "body": "<a id='comment:27'></a>\nAll tests pass in `matrix modules rings modular crypto`.  I'm happy to run tests on all of Sage if people are happy with the changes in principle.",
    "created_at": "2021-04-26T19:11:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627395",
    "user": "https://github.com/roed314"
}
```


<a id='comment:27'></a>
All tests pass in `matrix modules rings modular crypto`.  I'm happy to run tests on all of Sage if people are happy with the changes in principle.



---

archive/issue_comments_627396.json:
```json
{
    "body": "<a id='comment:28'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/760e0c9f68abda66b02dd96f7fd67f9ea9fabe23\">760e0c9</a></td><td><code>Small fixes</code></td></tr></table>\n",
    "created_at": "2021-04-26T19:40:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627396",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:28'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/760e0c9f68abda66b02dd96f7fd67f9ea9fabe23">760e0c9</a></td><td><code>Small fixes</code></td></tr></table>




---

archive/issue_comments_627397.json:
```json
{
    "body": "**Changing commit** from \"[465f51de75fc202f7c5c9b636e39501e2dda3b0a](https://github.com/sagemath/sagetrac-mirror/commit/465f51de75fc202f7c5c9b636e39501e2dda3b0a)\" to \"[760e0c9f68abda66b02dd96f7fd67f9ea9fabe23](https://github.com/sagemath/sagetrac-mirror/commit/760e0c9f68abda66b02dd96f7fd67f9ea9fabe23)\".",
    "created_at": "2021-04-26T19:40:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627397",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[465f51de75fc202f7c5c9b636e39501e2dda3b0a](https://github.com/sagemath/sagetrac-mirror/commit/465f51de75fc202f7c5c9b636e39501e2dda3b0a)" to "[760e0c9f68abda66b02dd96f7fd67f9ea9fabe23](https://github.com/sagemath/sagetrac-mirror/commit/760e0c9f68abda66b02dd96f7fd67f9ea9fabe23)".



---

archive/issue_comments_627398.json:
```json
{
    "body": "<a id='comment:29'></a>\n(I accidentally made a comment instead of editing the ticket description)\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/760e0c9f68abda66b02dd96f7fd67f9ea9fabe23\">760e0c9</a></td><td><code>Small fixes</code></td></tr></table>\n",
    "created_at": "2021-04-26T19:42:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627398",
    "user": "https://github.com/roed314"
}
```


<a id='comment:29'></a>
(I accidentally made a comment instead of editing the ticket description)

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/760e0c9f68abda66b02dd96f7fd67f9ea9fabe23">760e0c9</a></td><td><code>Small fixes</code></td></tr></table>




---

archive/issue_comments_627399.json:
```json
{
    "body": "<a id='comment:30'></a>\nThis ticket is now actually ready for review, though the patchbot won't run currently (since it depends on #31069 which changes spkgs).",
    "created_at": "2021-04-26T19:43:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627399",
    "user": "https://github.com/roed314"
}
```


<a id='comment:30'></a>
This ticket is now actually ready for review, though the patchbot won't run currently (since it depends on #31069 which changes spkgs).



---

archive/issue_comments_627400.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,11 @@\n+This tickets adds a new class for dense matrices over `Zmod(N)` implemented using FLINT's `nmod_mat_t` type, along with some supporting ancillary changes:\n \n+* Changed echelon form over `Zmod(N)` for composite `N` to return the Howell form (see the introduction and Chapter 4 of [Storjohann's thesis](https://cs.uwaterloo.ca/~astorjoh/diss2up.pdf)).  Since this echelon form can have more rows than the input matrix, made some supporting changes including a new method `_echelon_copy`.\n+* Changed rank over `Zmod(N)` to return the number of leading 1s in Howell form (it raised a `NotImplementedError` before), and `pivots` to be the locations of these leading 1s.  There is also a method `_pivots` for accessing the columns where the leading entry is not 1.\n+* Matrices modulo composite `N` have improved speed and functionality for inversion, `charpoly`, `det`, `minpoly`, `echelon_form`, `solve_right` and `right_kernel_matrix`.  There is also a new method `minpoly_ideal` for the ideal vanishing on a matrix (the natural generalization of the minimal polynomial, which generates this ideal when it is principal).\n+* Changed `stack` and `augment` to return a matrix over a common base ring of the two inputs, rather than just using the top/left matrix to determine the base ring.\n+* A new method `_change_implementation` on matrices, together with rough heuristics for matrices on matrices mod `N` in determining when it's worth switching between FLINT and linbox (linbox is faster for large matrices, FLINT for smaller, and FLINT offers extra functionality for matrices modulo composite integers).\n+* Support multiplication of matrices with different implementations\n+* Add FLINT's `ulong_extras` for number theoretic functions on longs\n+* Add some iterators related to split primes in cyclotomic fields in support of changes to `matrix_cyclo_dense` (which uses a multimodular approach), and moved the `_reduction_matrix` method to the base field which will yield better caching behavior.\n+* Fix some doctests that relate to choosing different solutions in `solve_right` and getting different random matrices with a different implementation.\n``````\n",
    "created_at": "2021-04-27T00:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627400",
    "user": "https://github.com/roed314"
}
```


**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,11 @@
+This tickets adds a new class for dense matrices over `Zmod(N)` implemented using FLINT's `nmod_mat_t` type, along with some supporting ancillary changes:
 
+* Changed echelon form over `Zmod(N)` for composite `N` to return the Howell form (see the introduction and Chapter 4 of [Storjohann's thesis](https://cs.uwaterloo.ca/~astorjoh/diss2up.pdf)).  Since this echelon form can have more rows than the input matrix, made some supporting changes including a new method `_echelon_copy`.
+* Changed rank over `Zmod(N)` to return the number of leading 1s in Howell form (it raised a `NotImplementedError` before), and `pivots` to be the locations of these leading 1s.  There is also a method `_pivots` for accessing the columns where the leading entry is not 1.
+* Matrices modulo composite `N` have improved speed and functionality for inversion, `charpoly`, `det`, `minpoly`, `echelon_form`, `solve_right` and `right_kernel_matrix`.  There is also a new method `minpoly_ideal` for the ideal vanishing on a matrix (the natural generalization of the minimal polynomial, which generates this ideal when it is principal).
+* Changed `stack` and `augment` to return a matrix over a common base ring of the two inputs, rather than just using the top/left matrix to determine the base ring.
+* A new method `_change_implementation` on matrices, together with rough heuristics for matrices on matrices mod `N` in determining when it's worth switching between FLINT and linbox (linbox is faster for large matrices, FLINT for smaller, and FLINT offers extra functionality for matrices modulo composite integers).
+* Support multiplication of matrices with different implementations
+* Add FLINT's `ulong_extras` for number theoretic functions on longs
+* Add some iterators related to split primes in cyclotomic fields in support of changes to `matrix_cyclo_dense` (which uses a multimodular approach), and moved the `_reduction_matrix` method to the base field which will yield better caching behavior.
+* Fix some doctests that relate to choosing different solutions in `solve_right` and getting different random matrices with a different implementation.
``````




---

archive/issue_comments_627401.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2021-06-24T23:20:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627401",
    "user": "https://github.com/tscrim"
}
```


**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_627402.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2021-06-24T23:20:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627402",
    "user": "https://github.com/tscrim"
}
```


**Changing status** from needs_review to needs_work.



---

archive/issue_comments_627403.json:
```json
{
    "body": "<a id='comment:33'></a>\nNeeds rebase.",
    "created_at": "2021-06-24T23:20:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627403",
    "user": "https://github.com/tscrim"
}
```


<a id='comment:33'></a>
Needs rebase.



---

archive/issue_comments_627404.json:
```json
{
    "body": "**Changing commit** from \"[760e0c9f68abda66b02dd96f7fd67f9ea9fabe23](https://github.com/sagemath/sagetrac-mirror/commit/760e0c9f68abda66b02dd96f7fd67f9ea9fabe23)\" to \"[a3c8e38bc674e3e7fa8c93ab04f71548fd28aac8](https://github.com/sagemath/sagetrac-mirror/commit/a3c8e38bc674e3e7fa8c93ab04f71548fd28aac8)\".",
    "created_at": "2021-06-25T15:37:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627404",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[760e0c9f68abda66b02dd96f7fd67f9ea9fabe23](https://github.com/sagemath/sagetrac-mirror/commit/760e0c9f68abda66b02dd96f7fd67f9ea9fabe23)" to "[a3c8e38bc674e3e7fa8c93ab04f71548fd28aac8](https://github.com/sagemath/sagetrac-mirror/commit/a3c8e38bc674e3e7fa8c93ab04f71548fd28aac8)".



---

archive/issue_comments_627405.json:
```json
{
    "body": "<a id='comment:34'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a3c8e38bc674e3e7fa8c93ab04f71548fd28aac8\">a3c8e38</a></td><td><code>Merge branch 'u/roed/nmod_mat' of git://trac.sagemath.org/sage into t/31548/nmod_mat</code></td></tr></table>\n",
    "created_at": "2021-06-25T15:37:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627405",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:34'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a3c8e38bc674e3e7fa8c93ab04f71548fd28aac8">a3c8e38</a></td><td><code>Merge branch 'u/roed/nmod_mat' of git://trac.sagemath.org/sage into t/31548/nmod_mat</code></td></tr></table>




---

archive/issue_events_093339.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31548#event-93339"
}
```




---

archive/issue_events_093340.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31548#event-93340"
}
```




---

archive/issue_comments_627406.json:
```json
{
    "body": "<a id='comment:35'></a>\nSetting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31548#issuecomment-627406",
    "user": "https://github.com/mkoeppe"
}
```


<a id='comment:35'></a>
Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_events_093341.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31548#event-93341"
}
```




---

archive/issue_events_093342.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31548#event-93342"
}
```




---

archive/issue_events_093343.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31548#event-93343"
}
```




---

archive/issue_events_093344.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31548#event-93344"
}
```




---

archive/issue_events_093345.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31548#event-93345"
}
```




---

archive/issue_events_093346.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31548",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31548#event-93346"
}
```

