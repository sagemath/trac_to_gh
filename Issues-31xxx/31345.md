# Issue 31345: Improve Selmer Group method for number fields

archive/issues_031108.json:
```json
{
    "assignees": [],
    "body": "If `K` is a number field and `S` a finite set of primes of `K`, then for any `m > 1` there is a finite multiplicative abelian group of exponent at most `m` called the `m`-Selmer group, denoted `K(S, m)`, a subgroup of `K<sup>*/(K</sup>*)^m`.\n\nThe existing method `K.selmer_group(m)` returns a list of elements of `K^*` which generate `K(S, m)`, with no access to the group structure.  There is also a utility method `K.selmer_group_iterator(m)` which I wrote ages ago to make it easy to iterate through all the elements of the group.  There is no method to determine whether a given element of `K^*` represents an element of `K(S, m)` and if so express it in terms of the generators.\n\nFor many applications of mine I have needed something better, and for `m = p` prime I have code for a function `pSelmerGroup(K, S, p)` which returns a quadruple `(KSp, KSp_gens, from_KSp, to_KS_p)` where `KSp` is an abstract vector space over `GF(p)`, `KSp_gens` is a set of elements of `K^*` which generate `K(S, p)` (similar to `K.selmer_group(S, p)`), `from_KSp` is a map from the abstract `KSp` to `K^*` (the easy one) and `to_KSp` is the harder map from a subset of `K^*` to the vector space.\n\nTogether with some utilities this is about 560 lines of code, with docstrings but no doctest yet.  I intend to add this to Sage.\n\nThere are two issues: (1) it would make sense to have `K.selmer_group(S, p)` return the quadruple as above, but this would not be backwards compatible; (2) the new functionality is only for prime `p`, not general `m`.  I have no plans for a general version, giving a finite abelian group rather than a vector space, though for elliptic curve applications the cases `m = 4`, `m = 6`, `m = 12` are all useful.  There's a version of the Chinese Remainder Theorem at play here so `m = 6` is easy using `m = 2` and `m = 3`, and `m = 12` is easy given `m = 3` and `m = 4`, while `m = 4` requires real work.  I implemented these cases some time ago in Magma, where I also implemented the prime case, so it is possible.\n\nI am not sure how to solve the backwards compatibility issue.  Places in Sage itself will be easy to handle (there are not many), but to avoid breaking user code will be harder unless I use a new name for the new method, perhaps `K.selmer_space(S, p)`, though \"Selmer space\" is not standard terminology.  I'll think of something by the time I have a patch ready for review.\n\nComponent: **number fields**\n\nAuthor: **John Cremona**\n\nBranch/Commit: **[`257a47d`](https://github.com/sagemath/sagetrac-mirror/commit/257a47d10358b5c6e971ba93aa7eb5779ff413fc)**\n\nReviewer: **David Roe**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31345_\n\n",
    "closed_at": "2021-05-27T20:29:56Z",
    "created_at": "2021-02-05T14:45:50Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20number%20fields",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Improve Selmer Group method for number fields",
    "type": "issue",
    "updated_at": "2021-05-27T20:29:56Z",
    "url": "https://github.com/sagemath/sage/issues/31345",
    "user": "https://github.com/JohnCremona"
}
```
If `K` is a number field and `S` a finite set of primes of `K`, then for any `m > 1` there is a finite multiplicative abelian group of exponent at most `m` called the `m`-Selmer group, denoted `K(S, m)`, a subgroup of `K<sup>*/(K</sup>*)^m`.

The existing method `K.selmer_group(m)` returns a list of elements of `K^*` which generate `K(S, m)`, with no access to the group structure.  There is also a utility method `K.selmer_group_iterator(m)` which I wrote ages ago to make it easy to iterate through all the elements of the group.  There is no method to determine whether a given element of `K^*` represents an element of `K(S, m)` and if so express it in terms of the generators.

For many applications of mine I have needed something better, and for `m = p` prime I have code for a function `pSelmerGroup(K, S, p)` which returns a quadruple `(KSp, KSp_gens, from_KSp, to_KS_p)` where `KSp` is an abstract vector space over `GF(p)`, `KSp_gens` is a set of elements of `K^*` which generate `K(S, p)` (similar to `K.selmer_group(S, p)`), `from_KSp` is a map from the abstract `KSp` to `K^*` (the easy one) and `to_KSp` is the harder map from a subset of `K^*` to the vector space.

Together with some utilities this is about 560 lines of code, with docstrings but no doctest yet.  I intend to add this to Sage.

There are two issues: (1) it would make sense to have `K.selmer_group(S, p)` return the quadruple as above, but this would not be backwards compatible; (2) the new functionality is only for prime `p`, not general `m`.  I have no plans for a general version, giving a finite abelian group rather than a vector space, though for elliptic curve applications the cases `m = 4`, `m = 6`, `m = 12` are all useful.  There's a version of the Chinese Remainder Theorem at play here so `m = 6` is easy using `m = 2` and `m = 3`, and `m = 12` is easy given `m = 3` and `m = 4`, while `m = 4` requires real work.  I implemented these cases some time ago in Magma, where I also implemented the prime case, so it is possible.

I am not sure how to solve the backwards compatibility issue.  Places in Sage itself will be easy to handle (there are not many), but to avoid breaking user code will be harder unless I use a new name for the new method, perhaps `K.selmer_space(S, p)`, though "Selmer space" is not standard terminology.  I'll think of something by the time I have a patch ready for review.

Component: **number fields**

Author: **John Cremona**

Branch/Commit: **[`257a47d`](https://github.com/sagemath/sagetrac-mirror/commit/257a47d10358b5c6e971ba93aa7eb5779ff413fc)**

Reviewer: **David Roe**

_Issue created by migration from https://trac.sagemath.org/ticket/31345_





---

archive/issue_events_428891.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-02-05T14:45:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31345#event-428891"
}
```



---

archive/issue_events_428892.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-02-05T14:45:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20number%20fields",
    "label_color": "0000ff",
    "label_name": "c: number fields",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31345#event-428892"
}
```



---

archive/issue_events_428893.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-02-05T14:45:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31345#event-428893"
}
```



---

archive/issue_events_428894.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-02-05T14:45:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31345#event-428894"
}
```



---

archive/issue_comments_502538.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,11 +1,11 @@\n-Ik K is a number field and S a finite set of primes of K, then for any m>1 there is a finite multiplcative abelian group of exponent at most m called the m-Selmer group, denoted K(S,m), a subgroup of `K<sup>*/(K</sup>*)^m`.\n+If `K` is a number field and `S` a finite set of primes of `K`, then for any `m > 1` there is a finite multiplicative abelian group of exponent at most `m` called the `m`-Selmer group, denoted `K(S, m)`, a subgroup of `K<sup>*/(K</sup>*)^m`.\n \n-The existing method K.selmer_group(m) returns a list of elements of `K^*` which generate K(S,m), with no access to the group structure.  There is also a utility method K.selmer_group_iterator(m) which I wrote ages ago to make it easy to iterate through all the elements of the group.  There is no method to determine whether a given element of `K^*` represents an element of K(S,m) and if so express it i terms of the generators.\n+The existing method `K.selmer_group(m)` returns a list of elements of `K^*` which generate `K(S, m)`, with no access to the group structure.  There is also a utility method `K.selmer_group_iterator(m)` which I wrote ages ago to make it easy to iterate through all the elements of the group.  There is no method to determine whether a given element of `K^*` represents an element of `K(S, m)` and if so express it in terms of the generators.\n \n-For many applications of mine I have needed something better, and m=p prime I have code for a function pSelmerGroup(K, S, p) which returns a quadruple (KSp, KSp_gens, from_KSp, to_KS_p) where KSp is an abstract vector space over GF(p), KSp_gens is a set of elements of `K^*` which generate K(S,p) (similar to K.selmer_group(S,p)), from_KSp is a map from the abstract KSp to `K^*` (the easy one) and to_KSp is the harder map from a subset of `K^*` to the vector space.\n+For many applications of mine I have needed something better, and for `m = p` prime I have code for a function `pSelmerGroup(K, S, p)` which returns a quadruple `(KSp, KSp_gens, from_KSp, to_KS_p)` where `KSp` is an abstract vector space over `GF(p)`, `KSp_gens` is a set of elements of `K^*` which generate `K(S, p)` (similar to `K.selmer_group(S, p)`), `from_KSp` is a map from the abstract `KSp` to `K^*` (the easy one) and `to_KSp` is the harder map from a subset of `K^*` to the vector space.\n \n Together with some utilities this is about 560 lines of code, with docstrings but no doctest yet.  I intend to add this to Sage.\n \n-There are two issues: (1) it would make sense to have K.selmer_group(S, p) return the quadruple as above, but this would not be backwards compatible; (2) the new functionality is only for prime p, not general m.  I have no plans for a general version, giving a finite abelian group rather than a vector space, though for elliptic curve applications the cases m=4, m=6, m=12 are all useful.  There's a version of the Chinese Remainder Theorem at play here so m=6 is easyusing m=2,3, and m=12 is easy given m=3,4, while m=4 requires real work.  I implemented these cases some time ago in Magma, where I also implemented the prime case, so it is possible.\n+There are two issues: (1) it would make sense to have `K.selmer_group(S, p)` return the quadruple as above, but this would not be backwards compatible; (2) the new functionality is only for prime `p`, not general `m`.  I have no plans for a general version, giving a finite abelian group rather than a vector space, though for elliptic curve applications the cases `m = 4`, `m = 6`, `m = 12` are all useful.  There's a version of the Chinese Remainder Theorem at play here so `m = 6` is easy using `m = 2` and `m = 3`, and `m = 12` is easy given `m = 3` and `m = 4`, while `m = 4` requires real work.  I implemented these cases some time ago in Magma, where I also implemented the prime case, so it is possible.\n \n-I am not sure how to solve the backwards compatibility issue.  Places in Sage itself will be easy to handle (there are not many), but to avoid breaking user code will be harder unless I use a new name for the new method, perhaps K.selmer_space(S, p), though \"Selmer space\" is not standard terminology.  I'll think of something by the time I have a patch ready for review.\n+I am not sure how to solve the backwards compatibility issue.  Places in Sage itself will be easy to handle (there are not many), but to avoid breaking user code will be harder unless I use a new name for the new method, perhaps `K.selmer_space(S, p)`, though \"Selmer space\" is not standard terminology.  I'll think of something by the time I have a patch ready for review.\n``````\n",
    "created_at": "2021-02-07T20:05:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502538",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,11 +1,11 @@
-Ik K is a number field and S a finite set of primes of K, then for any m>1 there is a finite multiplcative abelian group of exponent at most m called the m-Selmer group, denoted K(S,m), a subgroup of `K<sup>*/(K</sup>*)^m`.
+If `K` is a number field and `S` a finite set of primes of `K`, then for any `m > 1` there is a finite multiplicative abelian group of exponent at most `m` called the `m`-Selmer group, denoted `K(S, m)`, a subgroup of `K<sup>*/(K</sup>*)^m`.
 
-The existing method K.selmer_group(m) returns a list of elements of `K^*` which generate K(S,m), with no access to the group structure.  There is also a utility method K.selmer_group_iterator(m) which I wrote ages ago to make it easy to iterate through all the elements of the group.  There is no method to determine whether a given element of `K^*` represents an element of K(S,m) and if so express it i terms of the generators.
+The existing method `K.selmer_group(m)` returns a list of elements of `K^*` which generate `K(S, m)`, with no access to the group structure.  There is also a utility method `K.selmer_group_iterator(m)` which I wrote ages ago to make it easy to iterate through all the elements of the group.  There is no method to determine whether a given element of `K^*` represents an element of `K(S, m)` and if so express it in terms of the generators.
 
-For many applications of mine I have needed something better, and m=p prime I have code for a function pSelmerGroup(K, S, p) which returns a quadruple (KSp, KSp_gens, from_KSp, to_KS_p) where KSp is an abstract vector space over GF(p), KSp_gens is a set of elements of `K^*` which generate K(S,p) (similar to K.selmer_group(S,p)), from_KSp is a map from the abstract KSp to `K^*` (the easy one) and to_KSp is the harder map from a subset of `K^*` to the vector space.
+For many applications of mine I have needed something better, and for `m = p` prime I have code for a function `pSelmerGroup(K, S, p)` which returns a quadruple `(KSp, KSp_gens, from_KSp, to_KS_p)` where `KSp` is an abstract vector space over `GF(p)`, `KSp_gens` is a set of elements of `K^*` which generate `K(S, p)` (similar to `K.selmer_group(S, p)`), `from_KSp` is a map from the abstract `KSp` to `K^*` (the easy one) and `to_KSp` is the harder map from a subset of `K^*` to the vector space.
 
 Together with some utilities this is about 560 lines of code, with docstrings but no doctest yet.  I intend to add this to Sage.
 
-There are two issues: (1) it would make sense to have K.selmer_group(S, p) return the quadruple as above, but this would not be backwards compatible; (2) the new functionality is only for prime p, not general m.  I have no plans for a general version, giving a finite abelian group rather than a vector space, though for elliptic curve applications the cases m=4, m=6, m=12 are all useful.  There's a version of the Chinese Remainder Theorem at play here so m=6 is easyusing m=2,3, and m=12 is easy given m=3,4, while m=4 requires real work.  I implemented these cases some time ago in Magma, where I also implemented the prime case, so it is possible.
+There are two issues: (1) it would make sense to have `K.selmer_group(S, p)` return the quadruple as above, but this would not be backwards compatible; (2) the new functionality is only for prime `p`, not general `m`.  I have no plans for a general version, giving a finite abelian group rather than a vector space, though for elliptic curve applications the cases `m = 4`, `m = 6`, `m = 12` are all useful.  There's a version of the Chinese Remainder Theorem at play here so `m = 6` is easy using `m = 2` and `m = 3`, and `m = 12` is easy given `m = 3` and `m = 4`, while `m = 4` requires real work.  I implemented these cases some time ago in Magma, where I also implemented the prime case, so it is possible.
 
-I am not sure how to solve the backwards compatibility issue.  Places in Sage itself will be easy to handle (there are not many), but to avoid breaking user code will be harder unless I use a new name for the new method, perhaps K.selmer_space(S, p), though "Selmer space" is not standard terminology.  I'll think of something by the time I have a patch ready for review.
+I am not sure how to solve the backwards compatibility issue.  Places in Sage itself will be easy to handle (there are not many), but to avoid breaking user code will be harder unless I use a new name for the new method, perhaps `K.selmer_space(S, p)`, though "Selmer space" is not standard terminology.  I'll think of something by the time I have a patch ready for review.
``````




---

archive/issue_comments_502539.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThanks for tidying up the description.\n\nWhat do you think about the name of the new method?   Preferable -- at least in the end -- would be to rename the current method called ``selmer_group`` to ``selmer_generators`` (which is a more accurate description) and have the new one called ``selmer_group``.  But that obviously breaks backwards compatibility.  I do not see how to manage this using the Deprecation mechanism, so please tell me how to do that if it can be done.  \n\nMeanwhile what I will do is this:  I'll change the method selmer_group to generators, at the same time adding the line selmer_group = selmer_generators in the number field class and changing all uses to this method within Sage source code to use the new name;  I will call my new method selmer_space.  Then at some future point we can possibly make selmer_group the same as selmer_space instead of selmer_generators.",
    "created_at": "2021-02-08T11:03:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502539",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:2" align="right">comment:2</div>

Thanks for tidying up the description.

What do you think about the name of the new method?   Preferable -- at least in the end -- would be to rename the current method called ``selmer_group`` to ``selmer_generators`` (which is a more accurate description) and have the new one called ``selmer_group``.  But that obviously breaks backwards compatibility.  I do not see how to manage this using the Deprecation mechanism, so please tell me how to do that if it can be done.  

Meanwhile what I will do is this:  I'll change the method selmer_group to generators, at the same time adding the line selmer_group = selmer_generators in the number field class and changing all uses to this method within Sage source code to use the new name;  I will call my new method selmer_space.  Then at some future point we can possibly make selmer_group the same as selmer_space instead of selmer_generators.



---

archive/issue_events_428895.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-02-09T12:08:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31345#event-428895"
}
```



---

archive/issue_comments_502540.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThe main new code is in a new file selmer_group.py, with interface via new methods selmer_space for both number fields and the rational field.\n\nTowards the backwards compatibility, here is what I did:  I changed the name of the existing method selmer_group (in those two places and in polynomial_quotient_ring) to selmer_generators, but also for compatibility added an alias in all three places so that the method selmer_group still works.  In a small number of places where the old selmer_group method was used I changed it to selmer_generators.\n\nI think there will be a couple of follow-up tickets to sort out things I spotted but which I did not want to complicate this ticket with. (1) Where the selmer_generators method is used in (elliptic curve) gal_rep_number_field, it is possible that the loop should be through all nontrivial elements of the selmer group, not just the generators. (2) In the etale algebra code in polynomial_quotient_ring, written (I think) ages ago by Robert Miller, there should be a non-hidden method to compute the decomposition as a sum of number fields, which does not refer to any set S of primes; and the hidden function which does this now looks rather inefficiently coded as well as probably being incorrect (at one point it computes an isomorphism from a field D_abs to itself but I think it means to compute one from D to D_abs or vice versa).  Those two issues are best dealt with *after* this is merged.\n\nI do have some application of my own waiting in the wings which will use this new improved Selmer group.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/557591c49f5d5b6e5b7a74a67f22c13235f4fd90\"><code>557591c</code></a></td><td><code>#31345: implementation of Selmer groups of number fields</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/99dce60f1c4a7025a87d187f482bf437a351729f\"><code>99dce60</code></a></td><td><code>fix docstring issues</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ddadaac2ad4c303bb78a12a98e081fd49df764b1\"><code>ddadaac</code></a></td><td><code>Merge remote-tracking branch 'trac/develop' into 31345-KSp</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d7c7378dee5ca1bb4d219bb4bc4b3423a98a50cd\"><code>d7c7378</code></a></td><td><code>#31345: check in new file, previously forgotten</code></td></tr></table>\n",
    "created_at": "2021-02-09T12:08:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502540",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:3" align="right">comment:3</div>

The main new code is in a new file selmer_group.py, with interface via new methods selmer_space for both number fields and the rational field.

Towards the backwards compatibility, here is what I did:  I changed the name of the existing method selmer_group (in those two places and in polynomial_quotient_ring) to selmer_generators, but also for compatibility added an alias in all three places so that the method selmer_group still works.  In a small number of places where the old selmer_group method was used I changed it to selmer_generators.

I think there will be a couple of follow-up tickets to sort out things I spotted but which I did not want to complicate this ticket with. (1) Where the selmer_generators method is used in (elliptic curve) gal_rep_number_field, it is possible that the loop should be through all nontrivial elements of the selmer group, not just the generators. (2) In the etale algebra code in polynomial_quotient_ring, written (I think) ages ago by Robert Miller, there should be a non-hidden method to compute the decomposition as a sum of number fields, which does not refer to any set S of primes; and the hidden function which does this now looks rather inefficiently coded as well as probably being incorrect (at one point it computes an isomorphism from a field D_abs to itself but I think it means to compute one from D to D_abs or vice versa).  Those two issues are best dealt with *after* this is merged.

I do have some application of my own waiting in the wings which will use this new improved Selmer group.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/557591c49f5d5b6e5b7a74a67f22c13235f4fd90"><code>557591c</code></a></td><td><code>#31345: implementation of Selmer groups of number fields</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/99dce60f1c4a7025a87d187f482bf437a351729f"><code>99dce60</code></a></td><td><code>fix docstring issues</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ddadaac2ad4c303bb78a12a98e081fd49df764b1"><code>ddadaac</code></a></td><td><code>Merge remote-tracking branch 'trac/develop' into 31345-KSp</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d7c7378dee5ca1bb4d219bb4bc4b3423a98a50cd"><code>d7c7378</code></a></td><td><code>#31345: check in new file, previously forgotten</code></td></tr></table>




---

archive/issue_comments_502541.json:
```json
{
    "body": "Commit: **[`d7c7378`](https://github.com/sagemath/sagetrac-mirror/commit/d7c7378dee5ca1bb4d219bb4bc4b3423a98a50cd)**",
    "created_at": "2021-02-09T12:08:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502541",
    "user": "https://github.com/JohnCremona"
}
```

Commit: **[`d7c7378`](https://github.com/sagemath/sagetrac-mirror/commit/d7c7378dee5ca1bb4d219bb4bc4b3423a98a50cd)**



---

archive/issue_comments_502542.json:
```json
{
    "body": "Branch: **[u/cremona/31345](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/31345)**",
    "created_at": "2021-02-09T12:08:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502542",
    "user": "https://github.com/JohnCremona"
}
```

Branch: **[u/cremona/31345](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/31345)**



---

archive/issue_events_428896.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31345#event-428896"
}
```



---

archive/issue_events_428897.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31345#event-428897"
}
```



---

archive/issue_comments_502543.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-15T22:07:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502543",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_502544.json:
```json
{
    "body": "Reviewer: **David Roe**",
    "created_at": "2021-04-28T20:30:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502544",
    "user": "https://github.com/roed314"
}
```

Reviewer: **David Roe**



---

archive/issue_events_428898.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2021-04-28T20:30:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31345#event-428898"
}
```



---

archive/issue_events_428899.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2021-04-28T20:30:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31345#event-428899"
}
```



---

archive/issue_comments_502545.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nOverall it looks good.  As a followup ticket, it shouldn't be too hard to make things work for `m=4` using #31548, which makes `left_kernel` function for matrices mod 4.\n\n* I would suggest having selmer_group print a deprecation warning (from sage.misc.superseded), so that we can switch it from selmer_generators to selmer_space eventually.\n* The Sage docstring convention seems to be to start on the line after the triple quotes\n* Your version of the copyright notice is different than what I'm used to in Sage; I would probably copy the copyright notice from another file (e.g. number_field.py)\n* Does ideal_generator ever return a negative integer, and if so would it be better to return the absolute value in this case?\n* `coords_in_C_p` will return an incorrect result if passed an ideal that has coordinate in a p-index location that's not divisible by `n//p` (since you're just doing floor division).  You should probably add a test like `all(coords[i] % n == 0 for (i, n) in p_indices)`.\n* Similarly, `root_ideal` doesn't check that the input is a p-th power.\n* Typos  in the docstring for `pSelmerGroup`: `th p'th powers` and `al ist`\n* There's an indentation problem in `selmer_space` over Q (`In general there is one generator...`), which also needs another newline afterward\n* There are some grammar problems in the error message `for at all prime in`",
    "created_at": "2021-04-28T20:30:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502545",
    "user": "https://github.com/roed314"
}
```

<div id="comment:5" align="right">comment:5</div>

Overall it looks good.  As a followup ticket, it shouldn't be too hard to make things work for `m=4` using #31548, which makes `left_kernel` function for matrices mod 4.

* I would suggest having selmer_group print a deprecation warning (from sage.misc.superseded), so that we can switch it from selmer_generators to selmer_space eventually.
* The Sage docstring convention seems to be to start on the line after the triple quotes
* Your version of the copyright notice is different than what I'm used to in Sage; I would probably copy the copyright notice from another file (e.g. number_field.py)
* Does ideal_generator ever return a negative integer, and if so would it be better to return the absolute value in this case?
* `coords_in_C_p` will return an incorrect result if passed an ideal that has coordinate in a p-index location that's not divisible by `n//p` (since you're just doing floor division).  You should probably add a test like `all(coords[i] % n == 0 for (i, n) in p_indices)`.
* Similarly, `root_ideal` doesn't check that the input is a p-th power.
* Typos  in the docstring for `pSelmerGroup`: `th p'th powers` and `al ist`
* There's an indentation problem in `selmer_space` over Q (`In general there is one generator...`), which also needs another newline afterward
* There are some grammar problems in the error message `for at all prime in`



---

archive/issue_comments_502546.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThanks a lot for the review (at last!).  I will deal with the issues you raise.",
    "created_at": "2021-04-29T07:50:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502546",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:6" align="right">comment:6</div>

Thanks a lot for the review (at last!).  I will deal with the issues you raise.



---

archive/issue_comments_502547.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@roed314](#comment%3A5):\n> Overall it looks good.  As a followup ticket, it shouldn't be too hard to make things work for `m=4` using #31548, which makes `left_kernel` function for matrices mod 4.\n> \n> * I would suggest having selmer_group print a deprecation warning (from sage.misc.superseded), so that we can switch it from selmer_generators to selmer_space eventually.\n\nNot yet fixed.  Currently I just use assignment selmer_group = selmer_group_generators and to implement this suggestion I think it would have to be a genuine separate method with full docstring, which I have not yet done.\n\n> * The Sage docstring convention seems to be to start on the line after the triple quotes\n\nUnfortunately emacs python-mode disagrees so I always have to fix these manually and often miss some.  I think I have fixed them now.\n\n> * Your version of the copyright notice is different than what I'm used to in Sage; I would probably copy the copyright notice from another file (e.g. number_field.py)\n\nOops, I left in what I had from when it was a separate piece of my own code.  I copied from number_field.py (changing name).\n\n> * Does ideal_generator ever return a negative integer, and if so would it be better to return the absolute value in this case?\n\nIt's an internal function, so no -- but I put in I.abs() for the case where I is an integer rather than an ideal.  But this is an internal function so does not do checking of its input.  I have also added an underscore prefix to the function name, and also for the two coords_in functions.\n\n> * `coords_in_C_p` will return an incorrect result if passed an ideal that has coordinate in a p-index location that's not divisible by `n//p` (since you're just doing floor division).  You should probably add a test like `all(coords[i] % n == 0 for (i, n) in p_indices)`.\n\nThanks for catching that, I have put in tthe second part of the test for being p-torsion, which also ensures that the division is exact.  This should not matter in practice since the function will only be called with ideals whose p'th power is principal, but it is still good to check properly.\n\n\n> * Similarly, `root_ideal` doesn't check that the input is a p-th power.\n\nCheck added.\n\n> * Typos  in the docstring for `pSelmerGroup`: `th p'th powers` and `al ist`\n\nFixed\n\n> * There's an indentation problem in `selmer_space` over Q (`In general there is one generator...`), which also needs another newline afterward\n\nFixed\n\n> * There are some grammar problems in the error message `for at all prime in`\n\nFixed.\n\nOK, I have fixed all but the deprecation, which I will come back to after building the documentation to check on all the docstrings.",
    "created_at": "2021-05-01T14:51:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502547",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@roed314](#comment%3A5):
> Overall it looks good.  As a followup ticket, it shouldn't be too hard to make things work for `m=4` using #31548, which makes `left_kernel` function for matrices mod 4.
> 
> * I would suggest having selmer_group print a deprecation warning (from sage.misc.superseded), so that we can switch it from selmer_generators to selmer_space eventually.

Not yet fixed.  Currently I just use assignment selmer_group = selmer_group_generators and to implement this suggestion I think it would have to be a genuine separate method with full docstring, which I have not yet done.

> * The Sage docstring convention seems to be to start on the line after the triple quotes

Unfortunately emacs python-mode disagrees so I always have to fix these manually and often miss some.  I think I have fixed them now.

> * Your version of the copyright notice is different than what I'm used to in Sage; I would probably copy the copyright notice from another file (e.g. number_field.py)

Oops, I left in what I had from when it was a separate piece of my own code.  I copied from number_field.py (changing name).

> * Does ideal_generator ever return a negative integer, and if so would it be better to return the absolute value in this case?

It's an internal function, so no -- but I put in I.abs() for the case where I is an integer rather than an ideal.  But this is an internal function so does not do checking of its input.  I have also added an underscore prefix to the function name, and also for the two coords_in functions.

> * `coords_in_C_p` will return an incorrect result if passed an ideal that has coordinate in a p-index location that's not divisible by `n//p` (since you're just doing floor division).  You should probably add a test like `all(coords[i] % n == 0 for (i, n) in p_indices)`.

Thanks for catching that, I have put in tthe second part of the test for being p-torsion, which also ensures that the division is exact.  This should not matter in practice since the function will only be called with ideals whose p'th power is principal, but it is still good to check properly.


> * Similarly, `root_ideal` doesn't check that the input is a p-th power.

Check added.

> * Typos  in the docstring for `pSelmerGroup`: `th p'th powers` and `al ist`

Fixed

> * There's an indentation problem in `selmer_space` over Q (`In general there is one generator...`), which also needs another newline afterward

Fixed

> * There are some grammar problems in the error message `for at all prime in`

Fixed.

OK, I have fixed all but the deprecation, which I will come back to after building the documentation to check on all the docstrings.



---

archive/issue_comments_502548.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5fef1dfd461f517f5016a4bdc8505ca5870459c\"><code>f5fef1d</code></a></td><td><code>Merge branch 'develop' into 31345-KSp</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1658dda7eaf9b2af083b8f7e0c3f09390f982513\"><code>1658dda</code></a></td><td><code>#31345 revisions after review</code></td></tr></table>\n",
    "created_at": "2021-05-01T16:18:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502548",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5fef1dfd461f517f5016a4bdc8505ca5870459c"><code>f5fef1d</code></a></td><td><code>Merge branch 'develop' into 31345-KSp</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1658dda7eaf9b2af083b8f7e0c3f09390f982513"><code>1658dda</code></a></td><td><code>#31345 revisions after review</code></td></tr></table>




---

archive/issue_comments_502549.json:
```json
{
    "body": "Changed commit from **[`d7c7378`](https://github.com/sagemath/sagetrac-mirror/commit/d7c7378dee5ca1bb4d219bb4bc4b3423a98a50cd)** to **[`1658dda`](https://github.com/sagemath/sagetrac-mirror/commit/1658dda7eaf9b2af083b8f7e0c3f09390f982513)**",
    "created_at": "2021-05-01T16:18:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502549",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d7c7378`](https://github.com/sagemath/sagetrac-mirror/commit/d7c7378dee5ca1bb4d219bb4bc4b3423a98a50cd)** to **[`1658dda`](https://github.com/sagemath/sagetrac-mirror/commit/1658dda7eaf9b2af083b8f7e0c3f09390f982513)**



---

archive/issue_comments_502550.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI have still not addressed teh deprecation question, but all else should be fixed.",
    "created_at": "2021-05-01T16:19:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502550",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:9" align="right">comment:9</div>

I have still not addressed teh deprecation question, but all else should be fixed.



---

archive/issue_comments_502551.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\none trivial failing doctest in src/sage/rings/rational_field.py",
    "created_at": "2021-05-02T14:05:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502551",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:10" align="right">comment:10</div>

one trivial failing doctest in src/sage/rings/rational_field.py



---

archive/issue_comments_502552.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@fchapoton](#comment%3A10):\n> one trivial failing doctest in src/sage/rings/rational_field.py\n\nSorry to be dim, but I see that error but don't know why it is occurring: it complains that there is an extra <BLANKLINE> before the ValueError message.",
    "created_at": "2021-05-03T13:19:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502552",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@fchapoton](#comment%3A10):
> one trivial failing doctest in src/sage/rings/rational_field.py

Sorry to be dim, but I see that error but don't know why it is occurring: it complains that there is an extra <BLANKLINE> before the ValueError message.



---

archive/issue_comments_502553.json:
```json
{
    "body": "Changed commit from **[`1658dda`](https://github.com/sagemath/sagetrac-mirror/commit/1658dda7eaf9b2af083b8f7e0c3f09390f982513)** to **[`cfbe590`](https://github.com/sagemath/sagetrac-mirror/commit/cfbe5905c988cdae10d708acaa5b85e7d4e74c51)**",
    "created_at": "2021-05-03T13:53:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502553",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1658dda`](https://github.com/sagemath/sagetrac-mirror/commit/1658dda7eaf9b2af083b8f7e0c3f09390f982513)** to **[`cfbe590`](https://github.com/sagemath/sagetrac-mirror/commit/cfbe5905c988cdae10d708acaa5b85e7d4e74c51)**



---

archive/issue_comments_502554.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cfbe5905c988cdae10d708acaa5b85e7d4e74c51\"><code>cfbe590</code></a></td><td><code>#31345 fix typo in error message</code></td></tr></table>\n",
    "created_at": "2021-05-03T13:53:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502554",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cfbe5905c988cdae10d708acaa5b85e7d4e74c51"><code>cfbe590</code></a></td><td><code>#31345 fix typo in error message</code></td></tr></table>




---

archive/issue_comments_502555.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nOK, fixed.  (The BLANKLINE distracted me from the actual error, which was just that I had corrected the grammar in the error message.)",
    "created_at": "2021-05-03T13:54:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502555",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:13" align="right">comment:13</div>

OK, fixed.  (The BLANKLINE distracted me from the actual error, which was just that I had corrected the grammar in the error message.)



---

archive/issue_comments_502556.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nFor the deprecation, I'd suggest just using `deprecated_function_alias` from `sage.misc.superseded`.  I understand about emacs being a bit misconfigured for Sage's docstring conventions: I always have to add 4 spaces manually in EXAMPLE blocks.  I think you just missed one more: `class_number` in `number_field.py`.\n\nOtherwise, it looks good!",
    "created_at": "2021-05-05T03:33:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502556",
    "user": "https://github.com/roed314"
}
```

<div id="comment:14" align="right">comment:14</div>

For the deprecation, I'd suggest just using `deprecated_function_alias` from `sage.misc.superseded`.  I understand about emacs being a bit misconfigured for Sage's docstring conventions: I always have to add 4 spaces manually in EXAMPLE blocks.  I think you just missed one more: `class_number` in `number_field.py`.

Otherwise, it looks good!



---

archive/issue_comments_502557.json:
```json
{
    "body": "<div id=\"comment:15\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9aa52e29d1de9967e129976712d28b6bcd557602\"><code>9aa52e2</code></a></td><td><code>#31345: added deprecation aliases</code></td></tr></table>\n",
    "created_at": "2021-05-05T10:02:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502557",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:15"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9aa52e29d1de9967e129976712d28b6bcd557602"><code>9aa52e2</code></a></td><td><code>#31345: added deprecation aliases</code></td></tr></table>




---

archive/issue_comments_502558.json:
```json
{
    "body": "Changed commit from **[`cfbe590`](https://github.com/sagemath/sagetrac-mirror/commit/cfbe5905c988cdae10d708acaa5b85e7d4e74c51)** to **[`9aa52e2`](https://github.com/sagemath/sagetrac-mirror/commit/9aa52e29d1de9967e129976712d28b6bcd557602)**",
    "created_at": "2021-05-05T10:02:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502558",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`cfbe590`](https://github.com/sagemath/sagetrac-mirror/commit/cfbe5905c988cdae10d708acaa5b85e7d4e74c51)** to **[`9aa52e2`](https://github.com/sagemath/sagetrac-mirror/commit/9aa52e29d1de9967e129976712d28b6bcd557602)**



---

archive/issue_comments_502559.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI added deprecation aliases in both places, and also fixed the docstring formatting issue raised (and one other I found).\n\nThe deprecation aliases seem to work as expected, in tha if you call QQ.selmer_group() or K.selmer_group() for a number field K, then it outputs a message asking the user to use selmer_generators() instead, before calling selmer_generators().  It is not perfect, since it does not also recommend that the user might want to use selmer_space() instead for extra functionality -- I don't think that the deprecation alias machinery can handle that -- and also, I noticed that the deprecation warning appears every time you call the deprecated method, not just the first time.  But neither of these should hold up this enhancement.",
    "created_at": "2021-05-05T10:06:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502559",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:16" align="right">comment:16</div>

I added deprecation aliases in both places, and also fixed the docstring formatting issue raised (and one other I found).

The deprecation aliases seem to work as expected, in tha if you call QQ.selmer_group() or K.selmer_group() for a number field K, then it outputs a message asking the user to use selmer_generators() instead, before calling selmer_generators().  It is not perfect, since it does not also recommend that the user might want to use selmer_space() instead for extra functionality -- I don't think that the deprecation alias machinery can handle that -- and also, I noticed that the deprecation warning appears every time you call the deprecated method, not just the first time.  But neither of these should hold up this enhancement.



---

archive/issue_events_428900.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-05-05T10:06:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31345#event-428900"
}
```



---

archive/issue_events_428901.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-05-05T10:06:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31345#event-428901"
}
```



---

archive/issue_comments_502560.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nPerhaps I could also add a separate deprecation warning to the selmer_generators() method too, when it is called with a prime, alerting the user to the selmer_space() method which gives more functionality?",
    "created_at": "2021-05-05T12:43:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502560",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:17" align="right">comment:17</div>

Perhaps I could also add a separate deprecation warning to the selmer_generators() method too, when it is called with a prime, alerting the user to the selmer_space() method which gives more functionality?



---

archive/issue_comments_502561.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI don't think we need to use a deprecation warning on `selmer_generators`.  If you want to make `selmer_space` more findable, you could add a `SEEALSO` block to `selmer_generators`.  You could also use the more general `deprecation` function in `selmer_group` and point to `selmer_space` in the message, but that would require writing out the function instead of just using `selmer_group = deprecated_function_alias...`.",
    "created_at": "2021-05-05T14:01:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502561",
    "user": "https://github.com/roed314"
}
```

<div id="comment:18" align="right">comment:18</div>

I don't think we need to use a deprecation warning on `selmer_generators`.  If you want to make `selmer_space` more findable, you could add a `SEEALSO` block to `selmer_generators`.  You could also use the more general `deprecation` function in `selmer_group` and point to `selmer_space` in the message, but that would require writing out the function instead of just using `selmer_group = deprecated_function_alias...`.



---

archive/issue_comments_502562.json:
```json
{
    "body": "Changed commit from **[`9aa52e2`](https://github.com/sagemath/sagetrac-mirror/commit/9aa52e29d1de9967e129976712d28b6bcd557602)** to **[`df80c65`](https://github.com/sagemath/sagetrac-mirror/commit/df80c65389e7c5e5801108e7ff08d8df0ff3c84b)**",
    "created_at": "2021-05-07T08:01:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502562",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9aa52e2`](https://github.com/sagemath/sagetrac-mirror/commit/9aa52e29d1de9967e129976712d28b6bcd557602)** to **[`df80c65`](https://github.com/sagemath/sagetrac-mirror/commit/df80c65389e7c5e5801108e7ff08d8df0ff3c84b)**



---

archive/issue_comments_502563.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/df80c65389e7c5e5801108e7ff08d8df0ff3c84b\"><code>df80c65</code></a></td><td><code>#31345: removed the additions Deprecation Warnings introduced in the previous commit, and added two SEEALSO blocks</code></td></tr></table>\n",
    "created_at": "2021-05-07T08:01:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502563",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/df80c65389e7c5e5801108e7ff08d8df0ff3c84b"><code>df80c65</code></a></td><td><code>#31345: removed the additions Deprecation Warnings introduced in the previous commit, and added two SEEALSO blocks</code></td></tr></table>




---

archive/issue_comments_502564.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@roed314](#comment%3A18):\n> I don't think we need to use a deprecation warning on `selmer_generators`.  If you want to make `selmer_space` more findable, you could add a `SEEALSO` block to `selmer_generators`.  You could also use the more general `deprecation` function in `selmer_group` and point to `selmer_space` in the message, but that would require writing out the function instead of just using `selmer_group = deprecated_function_alias...`.\n\nOK, I removed the additional deprecation warnings introduced, converted the NOTE block cross-referencing to selmer_space into a SEEALSO block, and added a similar SEEALSO block for the RationalField case.\n\nI hope this can finally be given a green light now!",
    "created_at": "2021-05-07T08:04:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502564",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@roed314](#comment%3A18):
> I don't think we need to use a deprecation warning on `selmer_generators`.  If you want to make `selmer_space` more findable, you could add a `SEEALSO` block to `selmer_generators`.  You could also use the more general `deprecation` function in `selmer_group` and point to `selmer_space` in the message, but that would require writing out the function instead of just using `selmer_group = deprecated_function_alias...`.

OK, I removed the additional deprecation warnings introduced, converted the NOTE block cross-referencing to selmer_space into a SEEALSO block, and added a similar SEEALSO block for the RationalField case.

I hope this can finally be given a green light now!



---

archive/issue_comments_502565.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\ndoc does not build, because the seealso block is not correctly indented.",
    "created_at": "2021-05-07T11:14:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502565",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:21" align="right">comment:21</div>

doc does not build, because the seealso block is not correctly indented.



---

archive/issue_comments_502566.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@fchapoton](#comment%3A21):\n> doc does not build, because the seealso block is not correctly indented.\n\nDammit I already spent time fixing that exact issue and thought I had. I'll get back onto it.",
    "created_at": "2021-05-07T12:01:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502566",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@fchapoton](#comment%3A21):
> doc does not build, because the seealso block is not correctly indented.

Dammit I already spent time fixing that exact issue and thought I had. I'll get back onto it.



---

archive/issue_comments_502567.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nPlease tell me why the SEEALSO block in rational_field.py is OK but the one in number_field.py is not, since they are indented the same way as far as I can see.",
    "created_at": "2021-05-07T12:57:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502567",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:23" align="right">comment:23</div>

Please tell me why the SEEALSO block in rational_field.py is OK but the one in number_field.py is not, since they are indented the same way as far as I can see.



---

archive/issue_comments_502568.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nboth are wrong, I think",
    "created_at": "2021-05-07T13:04:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502568",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:24" align="right">comment:24</div>

both are wrong, I think



---

archive/issue_comments_502569.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@fchapoton](#comment%3A24):\n> both are wrong, I think\n\nFixed.  I think.  I'm sure this is the indentation I put in originally, then I saw an error message and changed it.\n\nThis sort of error is extremely tedious to fix since the error message is insufficient and it takes 5-10 minutes for each \"make\" even if you only touch one file.",
    "created_at": "2021-05-07T13:49:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502569",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@fchapoton](#comment%3A24):
> both are wrong, I think

Fixed.  I think.  I'm sure this is the indentation I put in originally, then I saw an error message and changed it.

This sort of error is extremely tedious to fix since the error message is insufficient and it takes 5-10 minutes for each "make" even if you only touch one file.



---

archive/issue_comments_502570.json:
```json
{
    "body": "Changed commit from **[`df80c65`](https://github.com/sagemath/sagetrac-mirror/commit/df80c65389e7c5e5801108e7ff08d8df0ff3c84b)** to **[`257a47d`](https://github.com/sagemath/sagetrac-mirror/commit/257a47d10358b5c6e971ba93aa7eb5779ff413fc)**",
    "created_at": "2021-05-07T13:49:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502570",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`df80c65`](https://github.com/sagemath/sagetrac-mirror/commit/df80c65389e7c5e5801108e7ff08d8df0ff3c84b)** to **[`257a47d`](https://github.com/sagemath/sagetrac-mirror/commit/257a47d10358b5c6e971ba93aa7eb5779ff413fc)**



---

archive/issue_comments_502571.json:
```json
{
    "body": "<div id=\"comment:26\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/257a47d10358b5c6e971ba93aa7eb5779ff413fc\"><code>257a47d</code></a></td><td><code>#31345: fix indentation in 2 docstrings</code></td></tr></table>\n",
    "created_at": "2021-05-07T13:49:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502571",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:26"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/257a47d10358b5c6e971ba93aa7eb5779ff413fc"><code>257a47d</code></a></td><td><code>#31345: fix indentation in 2 docstrings</code></td></tr></table>




---

archive/issue_comments_502572.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nlooks good now\n\nI agree that the error message is sometimes not so clear\n\nNote that `sage -docbuild` can be launched on a single file, or on just one component like combinat or schemes.",
    "created_at": "2021-05-07T15:01:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502572",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:27" align="right">comment:27</div>

looks good now

I agree that the error message is sometimes not so clear

Note that `sage -docbuild` can be launched on a single file, or on just one component like combinat or schemes.



---

archive/issue_comments_502573.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\ngreen bot. I will let David give the final word.",
    "created_at": "2021-05-07T16:53:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502573",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:28" align="right">comment:28</div>

green bot. I will let David give the final word.



---

archive/issue_comments_502574.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nLooks good to me!",
    "created_at": "2021-05-08T04:50:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502574",
    "user": "https://github.com/roed314"
}
```

<div id="comment:29" align="right">comment:29</div>

Looks good to me!



---

archive/issue_events_428902.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2021-05-08T04:50:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31345#event-428902"
}
```



---

archive/issue_events_428903.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2021-05-08T04:50:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31345#event-428903"
}
```



---

archive/issue_comments_502575.json:
```json
{
    "body": "Changed branch from **[u/cremona/31345](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/31345)** to **[`257a47d`](https://github.com/sagemath/sagetrac-mirror/commit/257a47d10358b5c6e971ba93aa7eb5779ff413fc)**",
    "created_at": "2021-05-27T20:29:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31345#issuecomment-502575",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/cremona/31345](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/31345)** to **[`257a47d`](https://github.com/sagemath/sagetrac-mirror/commit/257a47d10358b5c6e971ba93aa7eb5779ff413fc)**



---

archive/issue_events_428904.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-05-27T20:29:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31345#event-428904"
}
```



---

archive/issue_events_428905.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "21274d870afa99d28fb250eff47a3e5291c1c9d5",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-05-27T20:29:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31345",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31345#event-428905"
}
```
