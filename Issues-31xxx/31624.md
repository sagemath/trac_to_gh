# Issue 31624: fedora-34-standard: eclib, singular, ipykernel build failures with system ntl, zeromq

archive/issues_031387.json:
```json
{
    "body": "from https://groups.google.com/g/sage-release/c/6WjKQt_e_B8/m/dpx1qILOCwAJ (for 9.3.rc2):\n\n9.3.beta8> fedora-34-standard:\n9.3.beta8>   [eclib-20190909]   /usr/bin/ld: /usr/lib64/libntl.so: undefined reference to `std::__exception_ptr::exception_ptr::_M_release()`@`CXXABI_1.3.13'\n\nfedora-34-standard eclib problem is unchanged in 9.3.rc2, and also issues with ntl show up in singular\n\nSee also: https://groups.google.com/g/sage-release/c/PAeKAGNJIJA/m/Rrncqdp7AQAJ\n\n\nCC:  @dimpase @jamesjer @kiwifb @enriqueartal @orlitzky @malb\n\nReviewer: Volker Braun\n\nAuthor: Matthias Koeppe\n\nBranch: 31970444601c16300153cddbac6e0a1658883368\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/31624\n\n",
    "closed_at": "2021-05-09T20:34:38Z",
    "created_at": "2021-04-08T17:32:06Z",
    "labels": [
        "component: porting",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "fedora-34-standard: eclib, singular, ipykernel build failures with system ntl, zeromq",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31624",
    "user": "https://github.com/mkoeppe"
}
```
from https://groups.google.com/g/sage-release/c/6WjKQt_e_B8/m/dpx1qILOCwAJ (for 9.3.rc2):

9.3.beta8> fedora-34-standard:
9.3.beta8>   [eclib-20190909]   /usr/bin/ld: /usr/lib64/libntl.so: undefined reference to `std::__exception_ptr::exception_ptr::_M_release()`@`CXXABI_1.3.13'

fedora-34-standard eclib problem is unchanged in 9.3.rc2, and also issues with ntl show up in singular

See also: https://groups.google.com/g/sage-release/c/PAeKAGNJIJA/m/Rrncqdp7AQAJ


CC:  @dimpase @jamesjer @kiwifb @enriqueartal @orlitzky @malb

Reviewer: Volker Braun

Author: Matthias Koeppe

Branch: 31970444601c16300153cddbac6e0a1658883368

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/31624





---

archive/issue_events_083250.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-15T02:16:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31624#event-83250"
}
```



---

archive/issue_comments_629075.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,4 +5,5 @@\n \n fedora-34-standard eclib problem is unchanged in 9.3.rc2, and also issues with ntl show up in singular\n \n+See also: https://groups.google.com/g/sage-release/c/PAeKAGNJIJA/m/Rrncqdp7AQAJ\n \n``````\n",
    "created_at": "2021-05-06T17:18:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629075",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,4 +5,5 @@
 
 fedora-34-standard eclib problem is unchanged in 9.3.rc2, and also issues with ntl show up in singular
 
+See also: https://groups.google.com/g/sage-release/c/PAeKAGNJIJA/m/Rrncqdp7AQAJ
 
``````




---

archive/issue_comments_629076.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#29703\"",
    "created_at": "2021-05-06T17:18:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629076",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#29703"



---

archive/issue_comments_629077.json:
```json
{
    "body": "<a id='comment:3'></a>\nAs noted in #29703, upgrading our gcc spkg to 10.3 does not fix this issue.\n\nSo we should probably improve our `ntl/spkg-configure.m4` to make sure that it is usable. (Related: #31578, which will also modify `ntl/spkg-configure.m4`",
    "created_at": "2021-05-06T18:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629077",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>
As noted in #29703, upgrading our gcc spkg to 10.3 does not fix this issue.

So we should probably improve our `ntl/spkg-configure.m4` to make sure that it is usable. (Related: #31578, which will also modify `ntl/spkg-configure.m4`



---

archive/issue_events_083251.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-06T18:27:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31624#event-83251"
}
```



---

archive/issue_events_083252.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-06T18:27:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31624#event-83252"
}
```



---

archive/issue_comments_629078.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2021-05-06T18:27:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629078",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from major to critical.



---

archive/issue_comments_629079.json:
```json
{
    "body": "<a id='comment:5'></a>\nAs I wrote in https://groups.google.com/g/sage-release/c/PAeKAGNJIJA/m/guT9UeiYAgAJ, we could just have ntl's `spkg-configure.m4` reject system NTL if we reject system gcc.\nI'm preparing a patch for this",
    "created_at": "2021-05-06T18:40:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629079",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
As I wrote in https://groups.google.com/g/sage-release/c/PAeKAGNJIJA/m/guT9UeiYAgAJ, we could just have ntl's `spkg-configure.m4` reject system NTL if we reject system gcc.
I'm preparing a patch for this



---

archive/issue_comments_629080.json:
```json
{
    "body": "Changing priority from critical to blocker.",
    "created_at": "2021-05-06T18:40:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629080",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from critical to blocker.



---

archive/issue_comments_629081.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/fedora_34_standard__eclib__singular_build_failures_with_system_ntl\"",
    "created_at": "2021-05-06T18:51:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629081",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/fedora_34_standard__eclib__singular_build_failures_with_system_ntl"



---

archive/issue_comments_629082.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-05-06T18:52:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629082",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_629083.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2021-05-06T18:52:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629083",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_629084.json:
```json
{
    "body": "<a id='comment:7'></a>\nNew commits:\n|                                                                                                                                          |                                                        |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------|\n|[887e991](https://git.sagemath.org/sage.git/commit?id=887e9918d25e1adb7fa3b52514c491de152dcb78)|`build/pkgs/ntl/spkg-configure.m4: Add depcheck for gcc`|",
    "created_at": "2021-05-06T18:52:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629084",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
New commits:
|                                                                                                                                          |                                                        |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------|
|[887e991](https://git.sagemath.org/sage.git/commit?id=887e9918d25e1adb7fa3b52514c491de152dcb78)|`build/pkgs/ntl/spkg-configure.m4: Add depcheck for gcc`|



---

archive/issue_comments_629085.json:
```json
{
    "body": "Changing commit from \"\" to \"887e9918d25e1adb7fa3b52514c491de152dcb78\"",
    "created_at": "2021-05-06T18:52:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629085",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "887e9918d25e1adb7fa3b52514c491de152dcb78"



---

archive/issue_comments_629086.json:
```json
{
    "body": "<a id='comment:8'></a>\nAlso: \n\n```\n  [ipykernel-5.2.1] error installing, exit status 1. End of log file:\n  [ipykernel-5.2.1]       File \"/sage/local/lib64/python3.9/site-packages/zmq/backend/cython/__init__.py\", line 6, in <module>\n  [ipykernel-5.2.1]         from . import (constants, error, message, context,\n  [ipykernel-5.2.1]     ImportError: /sage/local/lib/libstdc++.so.6: version `GLIBCXX_3.4.29' not found (required by /lib64/libzmq.so.5)\n  [ipykernel-5.2.1]     Building wheel for ipykernel (PEP 517): finished with status 'error'\n  [ipykernel-5.2.1]     ERROR: Failed building wheel for ipykernel\n  [ipykernel-5.2.1]   Failed to build ipykernel\n```",
    "created_at": "2021-05-06T19:42:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629086",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
Also: 

```
  [ipykernel-5.2.1] error installing, exit status 1. End of log file:
  [ipykernel-5.2.1]       File "/sage/local/lib64/python3.9/site-packages/zmq/backend/cython/__init__.py", line 6, in <module>
  [ipykernel-5.2.1]         from . import (constants, error, message, context,
  [ipykernel-5.2.1]     ImportError: /sage/local/lib/libstdc++.so.6: version `GLIBCXX_3.4.29' not found (required by /lib64/libzmq.so.5)
  [ipykernel-5.2.1]     Building wheel for ipykernel (PEP 517): finished with status 'error'
  [ipykernel-5.2.1]     ERROR: Failed building wheel for ipykernel
  [ipykernel-5.2.1]   Failed to build ipykernel
```



---

archive/issue_comments_629087.json:
```json
{
    "body": "Changing commit from \"887e9918d25e1adb7fa3b52514c491de152dcb78\" to \"5594edd417e6a4bb7b1b21fb04b94512ddfe6be5\"",
    "created_at": "2021-05-06T19:44:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629087",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "887e9918d25e1adb7fa3b52514c491de152dcb78" to "5594edd417e6a4bb7b1b21fb04b94512ddfe6be5"



---

archive/issue_comments_629088.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|\n|[5594edd](https://git.sagemath.org/sage.git/commit/?id=5594edd417e6a4bb7b1b21fb04b94512ddfe6be5)|`build/pkgs/zeromq/spkg-configure.m4: Add depcheck for gcc`|",
    "created_at": "2021-05-06T19:44:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629088",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|
|[5594edd](https://git.sagemath.org/sage.git/commit/?id=5594edd417e6a4bb7b1b21fb04b94512ddfe6be5)|`build/pkgs/zeromq/spkg-configure.m4: Add depcheck for gcc`|



---

archive/issue_comments_629089.json:
```json
{
    "body": "<a id='comment:11'></a>\nWith these changes, `make build` succeeds.\nBut building the documentation reveals another error:\n\n```\n[dochtml]   File \"sage/matrix/matrix_modn_sparse.pyx\", line 1, in init sage.matrix.matrix_modn_sparse (build/cythonized/sage/matrix/matrix_modn_sparse.cpp:17097)\n[dochtml]   File \"sage/matrix/matrix_integer_sparse.pyx\", line 1, in init sage.matrix.matrix_integer_sparse (build/cythonized/sage/matrix/matrix_integer_sparse.cpp:17107)\n[dochtml]   File \"sage/matrix/matrix_integer_dense.pyx\", line 1, in init sage.matrix.matrix_integer_dense (build/cythonized/sage/matrix/matrix_integer_dense.cpp:57743)\n[dochtml] ImportError: /sage/local/lib/libstdc++.so.6: version `GLIBCXX_3.4.29' not found (required by /lib64/libvmaf.so.0)\n```",
    "created_at": "2021-05-06T23:57:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629089",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
With these changes, `make build` succeeds.
But building the documentation reveals another error:

```
[dochtml]   File "sage/matrix/matrix_modn_sparse.pyx", line 1, in init sage.matrix.matrix_modn_sparse (build/cythonized/sage/matrix/matrix_modn_sparse.cpp:17097)
[dochtml]   File "sage/matrix/matrix_integer_sparse.pyx", line 1, in init sage.matrix.matrix_integer_sparse (build/cythonized/sage/matrix/matrix_integer_sparse.cpp:17107)
[dochtml]   File "sage/matrix/matrix_integer_dense.pyx", line 1, in init sage.matrix.matrix_integer_dense (build/cythonized/sage/matrix/matrix_integer_dense.cpp:57743)
[dochtml] ImportError: /sage/local/lib/libstdc++.so.6: version `GLIBCXX_3.4.29' not found (required by /lib64/libvmaf.so.0)
```



---

archive/issue_comments_629090.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|\n|[df4274e](https://git.sagemath.org/sage.git/commit/?id=df4274ec4cd767a02df0f5819b20f3f6331382bb)|`build/pkgs/{freetype,libgd}/spkg-configure.m4: Add depcheck for gcc`|",
    "created_at": "2021-05-07T06:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629090",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|
|[df4274e](https://git.sagemath.org/sage.git/commit/?id=df4274ec4cd767a02df0f5819b20f3f6331382bb)|`build/pkgs/{freetype,libgd}/spkg-configure.m4: Add depcheck for gcc`|



---

archive/issue_comments_629091.json:
```json
{
    "body": "Changing commit from \"5594edd417e6a4bb7b1b21fb04b94512ddfe6be5\" to \"df4274ec4cd767a02df0f5819b20f3f6331382bb\"",
    "created_at": "2021-05-07T06:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629091",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5594edd417e6a4bb7b1b21fb04b94512ddfe6be5" to "df4274ec4cd767a02df0f5819b20f3f6331382bb"



---

archive/issue_comments_629092.json:
```json
{
    "body": "<a id='comment:13'></a>\nI found this error while building, I think that `--with-system-libgd=no --with-system-brial=no` (at least one of them) in `./configure` did work.\n\nReplying to [mkoeppe](#comment%3A11):\n> With these changes, `make build` succeeds.\n> But building the documentation reveals another error:\n> \n> ```\n> [dochtml]   File \"sage/matrix/matrix_modn_sparse.pyx\", line 1, in init sage.matrix.matrix_modn_sparse (build/cythonized/sage/matrix/matrix_modn_sparse.cpp:17097)\n> [dochtml]   File \"sage/matrix/matrix_integer_sparse.pyx\", line 1, in init sage.matrix.matrix_integer_sparse (build/cythonized/sage/matrix/matrix_integer_sparse.cpp:17107)\n> [dochtml]   File \"sage/matrix/matrix_integer_dense.pyx\", line 1, in init sage.matrix.matrix_integer_dense (build/cythonized/sage/matrix/matrix_integer_dense.cpp:57743)\n> [dochtml] ImportError: /sage/local/lib/libstdc++.so.6: version `GLIBCXX_3.4.29' not found (required by /lib64/libvmaf.so.0)\n> ```\n> \n\n>",
    "created_at": "2021-05-07T18:46:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629092",
    "user": "https://github.com/enriqueartal"
}
```

<a id='comment:13'></a>
I found this error while building, I think that `--with-system-libgd=no --with-system-brial=no` (at least one of them) in `./configure` did work.

Replying to [mkoeppe](#comment%3A11):
> With these changes, `make build` succeeds.
> But building the documentation reveals another error:
> 
> ```
> [dochtml]   File "sage/matrix/matrix_modn_sparse.pyx", line 1, in init sage.matrix.matrix_modn_sparse (build/cythonized/sage/matrix/matrix_modn_sparse.cpp:17097)
> [dochtml]   File "sage/matrix/matrix_integer_sparse.pyx", line 1, in init sage.matrix.matrix_integer_sparse (build/cythonized/sage/matrix/matrix_integer_sparse.cpp:17107)
> [dochtml]   File "sage/matrix/matrix_integer_dense.pyx", line 1, in init sage.matrix.matrix_integer_dense (build/cythonized/sage/matrix/matrix_integer_dense.cpp:57743)
> [dochtml] ImportError: /sage/local/lib/libstdc++.so.6: version `GLIBCXX_3.4.29' not found (required by /lib64/libvmaf.so.0)
> ```
> 

>



---

archive/issue_comments_629093.json:
```json
{
    "body": "<a id='comment:14'></a>\nI already did the `libgd` above and just ran into the `brial` issue too.",
    "created_at": "2021-05-07T18:48:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629093",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>
I already did the `libgd` above and just ran into the `brial` issue too.



---

archive/issue_comments_629094.json:
```json
{
    "body": "Changing commit from \"df4274ec4cd767a02df0f5819b20f3f6331382bb\" to \"04ca24245faf39d51bfd468aeb18cf73f70107f2\"",
    "created_at": "2021-05-07T18:50:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629094",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "df4274ec4cd767a02df0f5819b20f3f6331382bb" to "04ca24245faf39d51bfd468aeb18cf73f70107f2"



---

archive/issue_comments_629095.json:
```json
{
    "body": "<a id='comment:15'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                         |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|\n|[04ca242](https://git.sagemath.org/sage.git/commit/?id=04ca24245faf39d51bfd468aeb18cf73f70107f2)|`build/pkgs/brial/spkg-configure.m4: Add depcheck on gcc`|",
    "created_at": "2021-05-07T18:50:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629095",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|
|[04ca242](https://git.sagemath.org/sage.git/commit/?id=04ca24245faf39d51bfd468aeb18cf73f70107f2)|`build/pkgs/brial/spkg-configure.m4: Add depcheck on gcc`|



---

archive/issue_comments_629096.json:
```json
{
    "body": "Changing commit from \"04ca24245faf39d51bfd468aeb18cf73f70107f2\" to \"2012f7c31b3871769a0c49c277bcb579e29478cd\"",
    "created_at": "2021-05-07T19:11:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629096",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "04ca24245faf39d51bfd468aeb18cf73f70107f2" to "2012f7c31b3871769a0c49c277bcb579e29478cd"



---

archive/issue_comments_629097.json:
```json
{
    "body": "<a id='comment:16'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|\n|[2012f7c](https://git.sagemath.org/sage.git/commit/?id=2012f7c31b3871769a0c49c277bcb579e29478cd)|`build/pkgs/ppl/spkg-configure.m4: Add depcheck on gcc`|",
    "created_at": "2021-05-07T19:11:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629097",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|
|[2012f7c](https://git.sagemath.org/sage.git/commit/?id=2012f7c31b3871769a0c49c277bcb579e29478cd)|`build/pkgs/ppl/spkg-configure.m4: Add depcheck on gcc`|



---

archive/issue_comments_629098.json:
```json
{
    "body": "<a id='comment:17'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                         |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|\n|[cedbb31](https://git.sagemath.org/sage.git/commit/?id=cedbb31e02f260cb702c9ecfbeabe1659090408e)|`build/pkgs/fplll/spkg-configure.m4: Add depcheck on gcc`|",
    "created_at": "2021-05-07T19:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629098",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|
|[cedbb31](https://git.sagemath.org/sage.git/commit/?id=cedbb31e02f260cb702c9ecfbeabe1659090408e)|`build/pkgs/fplll/spkg-configure.m4: Add depcheck on gcc`|



---

archive/issue_comments_629099.json:
```json
{
    "body": "Changing commit from \"2012f7c31b3871769a0c49c277bcb579e29478cd\" to \"cedbb31e02f260cb702c9ecfbeabe1659090408e\"",
    "created_at": "2021-05-07T19:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629099",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2012f7c31b3871769a0c49c277bcb579e29478cd" to "cedbb31e02f260cb702c9ecfbeabe1659090408e"



---

archive/issue_comments_629100.json:
```json
{
    "body": "<a id='comment:18'></a>\nWith this I am running into an fplll build error:\n\n```\n[fplll-5.4.0] libtool: link: g++ -std=c++11 -O2 -g -fPIC -I/sage/local/include/ -Wl,-rpath-link -Wl,/sage/local/lib -Wl,-rpath -Wl,/sage/local/lib -o .libs/fplll main.o  -L/sage/local/lib ./.libs/libfplll.so -lmpfr -lgmp -pthread -Wl,-rpath -Wl,/sage/local/lib\n[fplll-5.4.0] libtool: link: g++ -std=c++11 -O2 -g -fPIC -I/sage/local/include/ -Wl,-rpath-link -Wl,/sage/local/lib -Wl,-rpath -Wl,/sage/local/lib -o .libs/latticegen latticegen.o  -L/sage/local/lib ./.libs/libfplll.so -lmpfr -lgmp -pthread -Wl,-rpath -Wl,/sage/local/lib\n[fplll-5.4.0] /usr/bin/ld: /usr/lib64/libqd.so.0: undefined reference to `std::__istream_extract(std::istream&, char*, long)@GLIBCXX_3.4.29'\n[fplll-5.4.0] collect2: error: ld returned 1 exit status\n[fplll-5.4.0] make[6]: *** [Makefile:1119: latticegen] Error 1\n[fplll-5.4.0] make[6]: *** Waiting for unfinished jobs....\n[fplll-5.4.0] /usr/bin/ld: /usr/lib64/libqd.so.0: undefined reference to `std::__istream_extract(std::istream&, char*, long)@GLIBCXX_3.4.29'\n[fplll-5.4.0] collect2: error: ld returned 1 exit status\n```",
    "created_at": "2021-05-07T20:30:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629100",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>
With this I am running into an fplll build error:

```
[fplll-5.4.0] libtool: link: g++ -std=c++11 -O2 -g -fPIC -I/sage/local/include/ -Wl,-rpath-link -Wl,/sage/local/lib -Wl,-rpath -Wl,/sage/local/lib -o .libs/fplll main.o  -L/sage/local/lib ./.libs/libfplll.so -lmpfr -lgmp -pthread -Wl,-rpath -Wl,/sage/local/lib
[fplll-5.4.0] libtool: link: g++ -std=c++11 -O2 -g -fPIC -I/sage/local/include/ -Wl,-rpath-link -Wl,/sage/local/lib -Wl,-rpath -Wl,/sage/local/lib -o .libs/latticegen latticegen.o  -L/sage/local/lib ./.libs/libfplll.so -lmpfr -lgmp -pthread -Wl,-rpath -Wl,/sage/local/lib
[fplll-5.4.0] /usr/bin/ld: /usr/lib64/libqd.so.0: undefined reference to `std::__istream_extract(std::istream&, char*, long)@GLIBCXX_3.4.29'
[fplll-5.4.0] collect2: error: ld returned 1 exit status
[fplll-5.4.0] make[6]: *** [Makefile:1119: latticegen] Error 1
[fplll-5.4.0] make[6]: *** Waiting for unfinished jobs....
[fplll-5.4.0] /usr/bin/ld: /usr/lib64/libqd.so.0: undefined reference to `std::__istream_extract(std::istream&, char*, long)@GLIBCXX_3.4.29'
[fplll-5.4.0] collect2: error: ld returned 1 exit status
```



---

archive/issue_comments_629101.json:
```json
{
    "body": "<a id='comment:20'></a>\nWe do not have an spkg for qd -- so we cannot fix this problem with spkg-configure.\nOpened #31792 for adding a package for it",
    "created_at": "2021-05-07T20:44:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629101",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>
We do not have an spkg for qd -- so we cannot fix this problem with spkg-configure.
Opened #31792 for adding a package for it



---

archive/issue_comments_629102.json:
```json
{
    "body": "<a id='comment:21'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                  |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|\n|[3197044](https://git.sagemath.org/sage.git/commit/?id=31970444601c16300153cddbac6e0a1658883368)|`build/pkgs/fplll/spkg-install.in: Configure --without-qd if we use gcc from spkg`|",
    "created_at": "2021-05-07T23:06:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629102",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                  |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|
|[3197044](https://git.sagemath.org/sage.git/commit/?id=31970444601c16300153cddbac6e0a1658883368)|`build/pkgs/fplll/spkg-install.in: Configure --without-qd if we use gcc from spkg`|



---

archive/issue_comments_629103.json:
```json
{
    "body": "Changing commit from \"cedbb31e02f260cb702c9ecfbeabe1659090408e\" to \"31970444601c16300153cddbac6e0a1658883368\"",
    "created_at": "2021-05-07T23:06:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629103",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "cedbb31e02f260cb702c9ecfbeabe1659090408e" to "31970444601c16300153cddbac6e0a1658883368"



---

archive/issue_comments_629104.json:
```json
{
    "body": "<a id='comment:22'></a>\nThis version works for me.\nLet's get it into Sage 9.3 please",
    "created_at": "2021-05-08T00:21:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629104",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'></a>
This version works for me.
Let's get it into Sage 9.3 please



---

archive/issue_comments_629105.json:
```json
{
    "body": "<a id='comment:23'></a>\nas #29703 is a dependency with 9.4 milestone, it does not seem to make sense to insist on 9.3 milestone here.",
    "created_at": "2021-05-08T09:25:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629105",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:23'></a>
as #29703 is a dependency with 9.4 milestone, it does not seem to make sense to insist on 9.3 milestone here.



---

archive/issue_comments_629106.json:
```json
{
    "body": "Changing dependencies from \"#29703\" to \"\"",
    "created_at": "2021-05-08T15:46:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629106",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#29703" to ""



---

archive/issue_comments_629107.json:
```json
{
    "body": "<a id='comment:24'></a>\nI forgot to remove the dependency.",
    "created_at": "2021-05-08T15:46:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629107",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'></a>
I forgot to remove the dependency.



---

archive/issue_comments_629108.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Volker Braun\"",
    "created_at": "2021-05-09T08:22:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629108",
    "user": "https://github.com/vbraun"
}
```

Changing reviewer from "" to "Volker Braun"



---

archive/issue_comments_629109.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-05-09T08:22:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629109",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_629110.json:
```json
{
    "body": "<a id='comment:26'></a>\nThanks!",
    "created_at": "2021-05-09T15:12:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629110",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>
Thanks!



---

archive/issue_comments_629111.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-05-09T20:34:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629111",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_083253.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-05-09T20:34:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31624#event-83253"
}
```



---

archive/issue_comments_629112.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/fedora_34_standard__eclib__singular_build_failures_with_system_ntl\" to \"31970444601c16300153cddbac6e0a1658883368\"",
    "created_at": "2021-05-09T20:34:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629112",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/fedora_34_standard__eclib__singular_build_failures_with_system_ntl" to "31970444601c16300153cddbac6e0a1658883368"



---

archive/issue_comments_629113.json:
```json
{
    "body": "Changing commit from \"31970444601c16300153cddbac6e0a1658883368\" to \"\"",
    "created_at": "2021-05-27T07:22:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629113",
    "user": "https://github.com/enriqueartal"
}
```

Changing commit from "31970444601c16300153cddbac6e0a1658883368" to ""



---

archive/issue_comments_629114.json:
```json
{
    "body": "<a id='comment:28'></a>\nI am not sure if it is related to this ticket, but I get a persistent error compiling libgd in 9.4.beta0 in Fedora 34: \n\n/usr/bin/ld: /usr/lib64/libvmaf.so.0: undefined reference to `std::__throw_bad_array_new_length()`@`GLIBCXX_3.4.29'\n\nFor 9.3 ./configure --with-system-zeromq=no --with-system-eclib=no --with-system-flint=no --with-system-flintqs=no --with-system-ntl=no --with-system-libgd=no --with-system-brial=no was ok",
    "created_at": "2021-05-27T07:22:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629114",
    "user": "https://github.com/enriqueartal"
}
```

<a id='comment:28'></a>
I am not sure if it is related to this ticket, but I get a persistent error compiling libgd in 9.4.beta0 in Fedora 34: 

/usr/bin/ld: /usr/lib64/libvmaf.so.0: undefined reference to `std::__throw_bad_array_new_length()`@`GLIBCXX_3.4.29'

For 9.3 ./configure --with-system-zeromq=no --with-system-eclib=no --with-system-flint=no --with-system-flintqs=no --with-system-ntl=no --with-system-libgd=no --with-system-brial=no was ok



---

archive/issue_comments_629115.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [enriqueartal](#comment%3A28):\n> I am not sure if it is related to this ticket, but I get a persistent error compiling libgd in 9.4.beta0 in Fedora 34: \n\n\ncan't you just use the system libgd?",
    "created_at": "2021-05-27T11:06:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629115",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:29'></a>
Replying to [enriqueartal](#comment%3A28):
> I am not sure if it is related to this ticket, but I get a persistent error compiling libgd in 9.4.beta0 in Fedora 34: 


can't you just use the system libgd?



---

archive/issue_comments_629116.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [dimpase](#comment%3A29):\n> Replying to [enriqueartal](#comment%3A28):\n> > I am not sure if it is related to this ticket, but I get a persistent error compiling libgd in 9.4.beta0 in Fedora 34: \n\n> \n> can't you just use the system libgd?\n> \n\nEven after ./configure --with-system-libgd=yes it tries to compile libgd-2.3.2",
    "created_at": "2021-05-28T05:57:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629116",
    "user": "https://github.com/enriqueartal"
}
```

<a id='comment:30'></a>
Replying to [dimpase](#comment%3A29):
> Replying to [enriqueartal](#comment%3A28):
> > I am not sure if it is related to this ticket, but I get a persistent error compiling libgd in 9.4.beta0 in Fedora 34: 

> 
> can't you just use the system libgd?
> 

Even after ./configure --with-system-libgd=yes it tries to compile libgd-2.3.2



---

archive/issue_comments_629117.json:
```json
{
    "body": "<a id='comment:31'></a>\n`libgd` is rejected because of g++11. Unfortunately building `libgd` ourselves appears to create similar issues with other libraries that are (optional) dependencies (not shipped with Sage). The best way to fix this is to fix the remaining issues that block our use of system gcc 11 (#31786). We could also try to fix up our `libgd` install scripts (see #27901)",
    "created_at": "2021-05-28T06:09:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31624#issuecomment-629117",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'></a>
`libgd` is rejected because of g++11. Unfortunately building `libgd` ourselves appears to create similar issues with other libraries that are (optional) dependencies (not shipped with Sage). The best way to fix this is to fix the remaining issues that block our use of system gcc 11 (#31786). We could also try to fix up our `libgd` install scripts (see #27901)
