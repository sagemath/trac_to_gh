# Issue 31513: jupyter: "%display latex" completely breaks @interact (and all of ipywidgets)

archive/issues_031276.json:
```json
{
    "assignees": [],
    "body": "In sage-9.1, this works fine with Jupyter:\n\n```\n%display latex\n\nthen in another cell\n\n@interact\ndef f(n=10):\n    print(n)\n```\nHowever, in sage-9.2, the output of Interact is **displayed as latex**, i.e., somebody changed %display latex in such a way that it also breaks widgets. \n\n```\n\ud835\ude78\ud835\ude97\ud835\ude9d\ud835\ude8e\ud835\ude9b\ud835\ude8a\ud835\ude8c\ud835\ude9d\ud835\ude92\ud835\ude9f\ud835\ude8e\ud835\ude8f\ud835\ude9e\ud835\ude97\ud835\ude8c\ud835\ude9d\ud835\ude92\ud835\ude98\ud835\ude97<\ud835\ude8f\ud835\ude9e\ud835\ude97\ud835\ude8c\ud835\ude9d\ud835\ude92\ud835\ude98\ud835\ude97\ud835\ude8f\ud835\ude8a\ud835\ude9d\ud835\udff6\ud835\udea1\ud835\udffd\ud835\ude8f\ud835\ude8f\ud835\udff9\ud835\ude8a\ud835\ude8a\ud835\udff8\ud835\udfff\ud835\ude8b\ud835\ude8f\ud835\udffd\ud835\udff6>\ud835\udea0\ud835\ude92\ud835\ude9d\ud835\ude91\ud835\udff7\ud835\udea0\ud835\ude92\ud835\ude8d\ud835\ude90\ud835\ude8e\ud835\ude9d\ud835\ude97:\ud835\ude78\ud835\ude97\ud835\ude9d\ud835\ude82\ud835\ude95\ud835\ude92\ud835\ude8d\ud835\ude8e\ud835\ude9b(\ud835\ude9f\ud835\ude8a\ud835\ude95\ud835\ude9e\ud835\ude8e=\ud835\udff7\ud835\udff6,\ud835\ude8d\ud835\ude8e\ud835\ude9c\ud835\ude8c\ud835\ude9b\ud835\ude92\ud835\ude99\ud835\ude9d\ud835\ude92\ud835\ude98\ud835\ude97='\ud835\ude97',\ud835\ude96\ud835\ude8a\ud835\udea1=\ud835\udff9\ud835\udff6,\ud835\ude96\ud835\ude92\ud835\ude97=\u23af\ud835\udff7\ud835\udff6)\n```\n\nThis is a really serious bug, since not only is `@`interact broken, in fact all of ipywidgets stops working the second you do \"%display latex\".\n\n\nDepends on #31536\n\nCC:  @dimpase @kwankyu @enriqueartal @jcamp0x2a @slel @vbraun\n\nReviewer: **Kwankyu Lee**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31513_\n\n",
    "closed_at": "2021-05-23T08:30:57Z",
    "created_at": "2021-03-18T18:22:34Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/component%3A%20notebook",
        "https://github.com/sagemath/sage/labels/invalid"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "jupyter: \"%display latex\" completely breaks @interact (and all of ipywidgets)",
    "type": "issue",
    "updated_at": "2021-05-23T08:30:57Z",
    "url": "https://github.com/sagemath/sage/issues/31513",
    "user": "https://github.com/williamstein"
}
```
In sage-9.1, this works fine with Jupyter:

```
%display latex

then in another cell

@interact
def f(n=10):
    print(n)
```
However, in sage-9.2, the output of Interact is **displayed as latex**, i.e., somebody changed %display latex in such a way that it also breaks widgets. 

```
𝙸𝚗𝚝𝚎𝚛𝚊𝚌𝚝𝚒𝚟𝚎𝚏𝚞𝚗𝚌𝚝𝚒𝚘𝚗<𝚏𝚞𝚗𝚌𝚝𝚒𝚘𝚗𝚏𝚊𝚝𝟶𝚡𝟽𝚏𝚏𝟹𝚊𝚊𝟸𝟿𝚋𝚏𝟽𝟶>𝚠𝚒𝚝𝚑𝟷𝚠𝚒𝚍𝚐𝚎𝚝𝚗:𝙸𝚗𝚝𝚂𝚕𝚒𝚍𝚎𝚛(𝚟𝚊𝚕𝚞𝚎=𝟷𝟶,𝚍𝚎𝚜𝚌𝚛𝚒𝚙𝚝𝚒𝚘𝚗='𝚗',𝚖𝚊𝚡=𝟹𝟶,𝚖𝚒𝚗=⎯𝟷𝟶)
```

This is a really serious bug, since not only is `@`interact broken, in fact all of ipywidgets stops working the second you do "%display latex".


Depends on #31536

CC:  @dimpase @kwankyu @enriqueartal @jcamp0x2a @slel @vbraun

Reviewer: **Kwankyu Lee**

_Issue created by migration from https://trac.sagemath.org/ticket/31513_





---

archive/issue_events_416184.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2021-03-18T18:22:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416184"
}
```



---

archive/issue_events_416185.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2021-03-18T18:22:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20notebook",
    "label_color": "000080",
    "label_name": "component: notebook",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416185"
}
```



---

archive/issue_events_416186.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2021-03-18T18:22:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416186"
}
```



---

archive/issue_events_416187.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2021-03-18T18:22:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416187"
}
```



---

archive/issue_comments_509126.json:
```json
{
    "body": "Attachment: **[Screen Shot 2021-03-18 at 11.22.11 AM.png](https://github.com/sagemath/sage/files/ticket31513/72e66ace791f0ab421ea4a5fb1aef08b.png)**\n\nScreenshot illustrating this bug.",
    "created_at": "2021-03-18T18:22:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509126",
    "user": "https://github.com/williamstein"
}
```

Attachment: **[Screen Shot 2021-03-18 at 11.22.11 AM.png](https://github.com/sagemath/sage/files/ticket31513/72e66ace791f0ab421ea4a5fb1aef08b.png)**

Screenshot illustrating this bug.



---

archive/issue_comments_509127.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -15,3 +15,5 @@\n \ud835\ude78\ud835\ude97\ud835\ude9d\ud835\ude8e\ud835\ude9b\ud835\ude8a\ud835\ude8c\ud835\ude9d\ud835\ude92\ud835\ude9f\ud835\ude8e\ud835\ude8f\ud835\ude9e\ud835\ude97\ud835\ude8c\ud835\ude9d\ud835\ude92\ud835\ude98\ud835\ude97<\ud835\ude8f\ud835\ude9e\ud835\ude97\ud835\ude8c\ud835\ude9d\ud835\ude92\ud835\ude98\ud835\ude97\ud835\ude8f\ud835\ude8a\ud835\ude9d\ud835\udff6\ud835\udea1\ud835\udffd\ud835\ude8f\ud835\ude8f\ud835\udff9\ud835\ude8a\ud835\ude8a\ud835\udff8\ud835\udfff\ud835\ude8b\ud835\ude8f\ud835\udffd\ud835\udff6>\ud835\udea0\ud835\ude92\ud835\ude9d\ud835\ude91\ud835\udff7\ud835\udea0\ud835\ude92\ud835\ude8d\ud835\ude90\ud835\ude8e\ud835\ude9d\ud835\ude97:\ud835\ude78\ud835\ude97\ud835\ude9d\ud835\ude82\ud835\ude95\ud835\ude92\ud835\ude8d\ud835\ude8e\ud835\ude9b(\ud835\ude9f\ud835\ude8a\ud835\ude95\ud835\ude9e\ud835\ude8e=\ud835\udff7\ud835\udff6,\ud835\ude8d\ud835\ude8e\ud835\ude9c\ud835\ude8c\ud835\ude9b\ud835\ude92\ud835\ude99\ud835\ude9d\ud835\ude92\ud835\ude98\ud835\ude97='\ud835\ude97',\ud835\ude96\ud835\ude8a\ud835\udea1=\ud835\udff9\ud835\udff6,\ud835\ude96\ud835\ude92\ud835\ude97=\u23af\ud835\udff7\ud835\udff6)\n ```\n \n+This is a really serious bug, since not only is `@`interact broken, in fact all of ipywidgets stops working the second you do \"%display latex\".\n+\n``````\n",
    "created_at": "2021-03-18T18:25:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509127",
    "user": "https://github.com/williamstein"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -15,3 +15,5 @@
 𝙸𝚗𝚝𝚎𝚛𝚊𝚌𝚝𝚒𝚟𝚎𝚏𝚞𝚗𝚌𝚝𝚒𝚘𝚗<𝚏𝚞𝚗𝚌𝚝𝚒𝚘𝚗𝚏𝚊𝚝𝟶𝚡𝟽𝚏𝚏𝟹𝚊𝚊𝟸𝟿𝚋𝚏𝟽𝟶>𝚠𝚒𝚝𝚑𝟷𝚠𝚒𝚍𝚐𝚎𝚝𝚗:𝙸𝚗𝚝𝚂𝚕𝚒𝚍𝚎𝚛(𝚟𝚊𝚕𝚞𝚎=𝟷𝟶,𝚍𝚎𝚜𝚌𝚛𝚒𝚙𝚝𝚒𝚘𝚗='𝚗',𝚖𝚊𝚡=𝟹𝟶,𝚖𝚒𝚗=⎯𝟷𝟶)
 ```
 
+This is a really serious bug, since not only is `@`interact broken, in fact all of ipywidgets stops working the second you do "%display latex".
+
``````




---

archive/issue_events_416188.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2021-03-18T18:25:22Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "title_is": "jupyter: \"%display latex\" completely breaks @interact (and all of ipywidgets)",
    "title_was": "jupyter: \"%display latex\" completely breaks @interact",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416188"
}
```



---

archive/issue_events_416189.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-18T19:14:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416189"
}
```



---

archive/issue_events_416190.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-18T19:14:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416190"
}
```



---

archive/issue_comments_509128.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nPerhaps introduced by ipython upgrade in #28197?",
    "created_at": "2021-03-19T05:01:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509128",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:4" align="right">Comment 4</div>

Perhaps introduced by ipython upgrade in #28197?



---

archive/issue_comments_509129.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nFWIW, `%display latex` also breaks `%matplotlib notebook`. For instance the following cell in a Jupyter notebook\n\n```\n%display latex\n%matplotlib notebook\nimport matplotlib.pyplot as plt\nplt.plot([1, 2, 3, 4])\nplt.ylabel('some numbers')\nplt.show()\n```\nyields\n\n```\n<\ud835\ude78\ud835\ude7f\ud835\udea2\ud835\ude9d\ud835\ude91\ud835\ude98\ud835\ude97.\ud835\ude8c\ud835\ude98\ud835\ude9b\ud835\ude8e.\ud835\ude8d\ud835\ude92\ud835\ude9c\ud835\ude99\ud835\ude95\ud835\ude8a\ud835\udea2.\ud835\ude79\ud835\ude8a\ud835\ude9f\ud835\ude8a\ud835\ude9c\ud835\ude8c\ud835\ude9b\ud835\ude92\ud835\ude99\ud835\ude9d\ud835\ude98\ud835\ude8b\ud835\ude93\ud835\ude8e\ud835\ude8c\ud835\ude9d>\n<\ud835\ude78\ud835\ude7f\ud835\udea2\ud835\ude9d\ud835\ude91\ud835\ude98\ud835\ude97.\ud835\ude8c\ud835\ude98\ud835\ude9b\ud835\ude8e.\ud835\ude8d\ud835\ude92\ud835\ude9c\ud835\ude99\ud835\ude95\ud835\ude8a\ud835\udea2.\ud835\ude77\ud835\ude83\ud835\ude7c\ud835\ude7b\ud835\ude98\ud835\ude8b\ud835\ude93\ud835\ude8e\ud835\ude8c\ud835\ude9d>\n```\ninstead of the pyplot window.\nIf one suppresses `%display latex` or replaces it by `%display plain`, then everything is fine: the interactive pyplot window appears, with the requested plot. \n\nContrary to the issue with `@interact`, this one is also there in Sage 9.1, except that the output is only\n\n```\n<\ud835\ude78\ud835\ude7f\ud835\udea2\ud835\ude9d\ud835\ude91\ud835\ude98\ud835\ude97.\ud835\ude8c\ud835\ude98\ud835\ude9b\ud835\ude8e.\ud835\ude8d\ud835\ude92\ud835\ude9c\ud835\ude99\ud835\ude95\ud835\ude8a\ud835\udea2.\ud835\ude77\ud835\ude83\ud835\ude7c\ud835\ude7b\ud835\ude98\ud835\ude8b\ud835\ude93\ud835\ude8e\ud835\ude8c\ud835\ude9d>\n```",
    "created_at": "2021-03-24T20:16:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509129",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:6" align="right">Comment 6</div>

FWIW, `%display latex` also breaks `%matplotlib notebook`. For instance the following cell in a Jupyter notebook

```
%display latex
%matplotlib notebook
import matplotlib.pyplot as plt
plt.plot([1, 2, 3, 4])
plt.ylabel('some numbers')
plt.show()
```
yields

```
<𝙸𝙿𝚢𝚝𝚑𝚘𝚗.𝚌𝚘𝚛𝚎.𝚍𝚒𝚜𝚙𝚕𝚊𝚢.𝙹𝚊𝚟𝚊𝚜𝚌𝚛𝚒𝚙𝚝𝚘𝚋𝚓𝚎𝚌𝚝>
<𝙸𝙿𝚢𝚝𝚑𝚘𝚗.𝚌𝚘𝚛𝚎.𝚍𝚒𝚜𝚙𝚕𝚊𝚢.𝙷𝚃𝙼𝙻𝚘𝚋𝚓𝚎𝚌𝚝>
```
instead of the pyplot window.
If one suppresses `%display latex` or replaces it by `%display plain`, then everything is fine: the interactive pyplot window appears, with the requested plot. 

Contrary to the issue with `@interact`, this one is also there in Sage 9.1, except that the output is only

```
<𝙸𝙿𝚢𝚝𝚑𝚘𝚗.𝚌𝚘𝚛𝚎.𝚍𝚒𝚜𝚙𝚕𝚊𝚢.𝙷𝚃𝙼𝙻𝚘𝚋𝚓𝚎𝚌𝚝>
```



---

archive/issue_comments_509130.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nHere is the bug.\n\nhttps://trac.sagemath.org/ticket/23330\n\n```diff\ndiff --git a/src/sage/repl/rich_output/backend_ipython.py b/src/sage/repl/rich_output/backend_ipython.py\nindex a2c17e2841..38ae60ce70 100644\n--- a/src/sage/repl/rich_output/backend_ipython.py\n+++ b/src/sage/repl/rich_output/backend_ipython.py\n@@ -544,6 +544,7 @@ class BackendIPythonNotebook(BackendIPython):\n             return ({u'text/plain': rich_output.unicode_art.get_unicode()}, {})\n         elif isinstance(rich_output, OutputLatex):\n             return ({u'text/html':  rich_output.mathjax(),\n+                     u'text/latex': rich_output.inline_equation(),\n                      u'text/plain': plain_text.text.get_unicode(),\n             }, {})\n         elif isinstance(rich_output, OutputHtml):\n```",
    "created_at": "2021-03-25T05:50:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509130",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:7" align="right">Comment 7</div>

Here is the bug.

https://trac.sagemath.org/ticket/23330

```diff
diff --git a/src/sage/repl/rich_output/backend_ipython.py b/src/sage/repl/rich_output/backend_ipython.py
index a2c17e2841..38ae60ce70 100644
--- a/src/sage/repl/rich_output/backend_ipython.py
+++ b/src/sage/repl/rich_output/backend_ipython.py
@@ -544,6 +544,7 @@ class BackendIPythonNotebook(BackendIPython):
             return ({u'text/plain': rich_output.unicode_art.get_unicode()}, {})
         elif isinstance(rich_output, OutputLatex):
             return ({u'text/html':  rich_output.mathjax(),
+                     u'text/latex': rich_output.inline_equation(),
                      u'text/plain': plain_text.text.get_unicode(),
             }, {})
         elif isinstance(rich_output, OutputHtml):
```



---

archive/issue_comments_509131.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nReplying to [@kwankyu](#comment%3A7):\n> Here is the bug.\n> \n> https://trac.sagemath.org/ticket/23330\n> \n\nShall we revert #23330? It looks more important to have ipywidgets working than a correct pdf export.",
    "created_at": "2021-03-25T07:16:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509131",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:8" align="right">Comment 8</div>

Replying to [@kwankyu](#comment%3A7):
> Here is the bug.
> 
> https://trac.sagemath.org/ticket/23330
> 

Shall we revert #23330? It looks more important to have ipywidgets working than a correct pdf export.



---

archive/issue_comments_509132.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nReplying to [@egourgoulhon](#comment%3A8):\n> Replying to [@kwankyu](#comment%3A7):\n> > Here is the bug.\n> > \n> > https://trac.sagemath.org/ticket/23330\n> > \n\n> Shall we revert #23330? It looks more important to have ipywidgets working than a correct pdf export. \n\nMoreover, in the spirit of #31536, `tex/latex` mime type is to be deprecated in favor of `tex/html`.",
    "created_at": "2021-03-25T07:24:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509132",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:9" align="right">Comment 9</div>

Replying to [@egourgoulhon](#comment%3A8):
> Replying to [@kwankyu](#comment%3A7):
> > Here is the bug.
> > 
> > https://trac.sagemath.org/ticket/23330
> > 

> Shall we revert #23330? It looks more important to have ipywidgets working than a correct pdf export. 

Moreover, in the spirit of #31536, `tex/latex` mime type is to be deprecated in favor of `tex/html`.



---

archive/issue_comments_509133.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nBTW, this points to the need to move to the default Jupyter rich output display for latex (i.e. use `_repr_latex_` instead of `%display latex`), since the pdf export works out of the box with `_repr_latex_` and there is no interference with ipywidgets.",
    "created_at": "2021-03-25T07:38:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509133",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:10" align="right">Comment 10</div>

BTW, this points to the need to move to the default Jupyter rich output display for latex (i.e. use `_repr_latex_` instead of `%display latex`), since the pdf export works out of the box with `_repr_latex_` and there is no interference with ipywidgets.



---

archive/issue_comments_509134.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nReplying to [@kwankyu](#comment%3A9):\n> Replying to [@egourgoulhon](#comment%3A8):\n> > Replying to [@kwankyu](#comment%3A7):\n> > > Here is the bug.\n> > > \n> > > https://trac.sagemath.org/ticket/23330\n> > > \n\n> > Shall we revert #23330? It looks more important to have ipywidgets working than a correct pdf export. \n\n> \n> Moreover, in the spirit of #31536, `tex/latex` mime type is to be deprecated in favor of `tex/html`.\n\nBut then, there cannot be pdf export of latex-typeset formulas from `text/html`.",
    "created_at": "2021-03-25T08:03:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509134",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:11" align="right">Comment 11</div>

Replying to [@kwankyu](#comment%3A9):
> Replying to [@egourgoulhon](#comment%3A8):
> > Replying to [@kwankyu](#comment%3A7):
> > > Here is the bug.
> > > 
> > > https://trac.sagemath.org/ticket/23330
> > > 

> > Shall we revert #23330? It looks more important to have ipywidgets working than a correct pdf export. 

> 
> Moreover, in the spirit of #31536, `tex/latex` mime type is to be deprecated in favor of `tex/html`.

But then, there cannot be pdf export of latex-typeset formulas from `text/html`.



---

archive/issue_comments_509135.json:
```json
{
    "body": "Author: **Eric Gourgoulhon**",
    "created_at": "2021-03-26T11:40:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509135",
    "user": "https://github.com/egourgoulhon"
}
```

Author: **Eric Gourgoulhon**



---

archive/issue_events_416191.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-03-26T11:40:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416191"
}
```



---

archive/issue_comments_509136.json:
```json
{
    "body": "Commit: **[046892e](https://github.com/sagemath/sagetrac-mirror/commit/046892eee8198c4112c45bf52f96131d8be9a40f)**",
    "created_at": "2021-03-26T11:40:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509136",
    "user": "https://github.com/egourgoulhon"
}
```

Commit: **[046892e](https://github.com/sagemath/sagetrac-mirror/commit/046892eee8198c4112c45bf52f96131d8be9a40f)**



---

archive/issue_comments_509137.json:
```json
{
    "body": "Branch: **[public/trac31513_display_latex_ipywidgets](https://github.com/sagemath/sagetrac-mirror/tree/public/trac31513_display_latex_ipywidgets)**",
    "created_at": "2021-03-26T11:40:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509137",
    "user": "https://github.com/egourgoulhon"
}
```

Branch: **[public/trac31513_display_latex_ipywidgets](https://github.com/sagemath/sagetrac-mirror/tree/public/trac31513_display_latex_ipywidgets)**



---

archive/issue_comments_509138.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nHere is a possible fix, which does not revert the pdf export fix introduced in #23330. I have instead modified `sage.repl.display.formatter.SageDisplayFormatter.format` so that IPython widgets are tried before Sage rich output. I've performed a few tests and things seem OK, but I am not completly sure about possible side effects of this fix. So please test it on your side. \n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/046892eee8198c4112c45bf52f96131d8be9a40f\">046892e</a></td><td><code>Change the order of IPython widgets and Sage rich output in SageDisplayFormatter.format</code></td></tr></table>\n",
    "created_at": "2021-03-26T11:40:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509138",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:12" align="right">Comment 12</div>

Here is a possible fix, which does not revert the pdf export fix introduced in #23330. I have instead modified `sage.repl.display.formatter.SageDisplayFormatter.format` so that IPython widgets are tried before Sage rich output. I've performed a few tests and things seem OK, but I am not completly sure about possible side effects of this fix. So please test it on your side. 

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/046892eee8198c4112c45bf52f96131d8be9a40f">046892e</a></td><td><code>Change the order of IPython widgets and Sage rich output in SageDisplayFormatter.format</code></td></tr></table>




---

archive/issue_comments_509139.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nReplying to [@egourgoulhon](#comment%3A11):\n> Replying to [@kwankyu](#comment%3A9):\n> > Moreover, in the spirit of #31536, `tex/latex` mime type is to be deprecated in favor of `tex/html`.\n\n> \n> But then, there cannot be pdf export of latex-typeset formulas from `text/html`.\n\nRight. `tex/latex` is the right mime type for pdf output. What I don't like is the use of `latex` for mathjax+html. I misdirected my arrow.",
    "created_at": "2021-03-26T15:42:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509139",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:13" align="right">Comment 13</div>

Replying to [@egourgoulhon](#comment%3A11):
> Replying to [@kwankyu](#comment%3A9):
> > Moreover, in the spirit of #31536, `tex/latex` mime type is to be deprecated in favor of `tex/html`.

> 
> But then, there cannot be pdf export of latex-typeset formulas from `text/html`.

Right. `tex/latex` is the right mime type for pdf output. What I don't like is the use of `latex` for mathjax+html. I misdirected my arrow.



---

archive/issue_comments_509140.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nReplying to [@egourgoulhon](#comment%3A12):\n> Here is a possible fix, which does not revert the pdf export fix introduced in #23330. I have instead modified `sage.repl.display.formatter.SageDisplayFormatter.format` so that IPython widgets are tried before Sage rich output. I've performed a few tests and things seem OK, but I am not completly sure about possible side effects of this fix. So please test it on your side. \n\nThen you bypass the test `set(sage_format.keys()).issubset(self.default_mime())` checked before calling `self.ipython_display_formatter(obj)`. I guess the author (Volker?) of the test thought the test is necessary before resorting to ipython for output.\n\nDo you understand the logic of the test? I don't. If you do, would you explain? As it is practically impossible to check all side effects of the change, I think we need to understand the logic correctly and be sure it is safe to bypass the test.",
    "created_at": "2021-03-26T15:58:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509140",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:14" align="right">Comment 14</div>

Replying to [@egourgoulhon](#comment%3A12):
> Here is a possible fix, which does not revert the pdf export fix introduced in #23330. I have instead modified `sage.repl.display.formatter.SageDisplayFormatter.format` so that IPython widgets are tried before Sage rich output. I've performed a few tests and things seem OK, but I am not completly sure about possible side effects of this fix. So please test it on your side. 

Then you bypass the test `set(sage_format.keys()).issubset(self.default_mime())` checked before calling `self.ipython_display_formatter(obj)`. I guess the author (Volker?) of the test thought the test is necessary before resorting to ipython for output.

Do you understand the logic of the test? I don't. If you do, would you explain? As it is practically impossible to check all side effects of the change, I think we need to understand the logic correctly and be sure it is safe to bypass the test.



---

archive/issue_comments_509141.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nReplying to [@kwankyu](#comment%3A14):\n> \n> Then you bypass the test `set(sage_format.keys()).issubset(self.default_mime())` checked before calling `self.ipython_display_formatter(obj)`. I guess the author (Volker?) of the test thought the test is necessary before resorting to ipython for output.\n> \n> Do you understand the logic of the test? \n\nNo. I have to look deeper. Certainly Volker should check this.",
    "created_at": "2021-03-26T17:20:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509141",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:15" align="right">Comment 15</div>

Replying to [@kwankyu](#comment%3A14):
> 
> Then you bypass the test `set(sage_format.keys()).issubset(self.default_mime())` checked before calling `self.ipython_display_formatter(obj)`. I guess the author (Volker?) of the test thought the test is necessary before resorting to ipython for output.
> 
> Do you understand the logic of the test? 

No. I have to look deeper. Certainly Volker should check this.



---

archive/issue_comments_509142.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nNow #31536 also contains fixes both for jupyter pdf export problem and this ticket.\n\nHope for no unexpected side effects..",
    "created_at": "2021-03-27T02:12:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509142",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:16" align="right">Comment 16</div>

Now #31536 also contains fixes both for jupyter pdf export problem and this ticket.

Hope for no unexpected side effects..



---

archive/issue_comments_509143.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nReplying to [@kwankyu](#comment%3A16):\n> Now #31536 also contains fixes both for jupyter pdf export problem and this ticket.\n> \n\nThis sounds nice! I'll look at it today.",
    "created_at": "2021-03-27T09:55:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509143",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:17" align="right">Comment 17</div>

Replying to [@kwankyu](#comment%3A16):
> Now #31536 also contains fixes both for jupyter pdf export problem and this ticket.
> 

This sounds nice! I'll look at it today.



---

archive/issue_comments_509144.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nMorally thats wrong, we should prefer our own formatter which gives e.g. the emacs backend a chance of handling things correctly. The problem is that ipython/jupyter doesn't have a blessed way of recognizing interact output, and moreover keeps adding more magic methods over time. The proposed patch is reasonable to me, hopefully the jupyter guys can keep `ipython_display_formatter` sufficently specific that only output is captured that is 100% ipython specific (like the current `@interact`s which cannot work anywhere else)\n\nNote that I didn't actually check this ticket for regressions.",
    "created_at": "2021-03-28T09:27:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509144",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:18" align="right">Comment 18</div>

Morally thats wrong, we should prefer our own formatter which gives e.g. the emacs backend a chance of handling things correctly. The problem is that ipython/jupyter doesn't have a blessed way of recognizing interact output, and moreover keeps adding more magic methods over time. The proposed patch is reasonable to me, hopefully the jupyter guys can keep `ipython_display_formatter` sufficently specific that only output is captured that is 100% ipython specific (like the current `@interact`s which cannot work anywhere else)

Note that I didn't actually check this ticket for regressions.



---

archive/issue_comments_509145.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nReplying to [@vbraun](#comment%3A18):\n> Morally thats wrong, we should prefer our own formatter which gives e.g. the emacs backend a chance of handling things correctly. The problem is that ipython/jupyter doesn't have a blessed way of recognizing interact output, and moreover keeps adding more magic methods over time. The proposed patch is reasonable to me, hopefully the jupyter guys can keep `ipython_display_formatter` sufficently specific that only output is captured that is 100% ipython specific (like the current `@interact`s which cannot work anywhere else)\n> \n\nThanks for your feedback.",
    "created_at": "2021-03-28T14:45:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509145",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:19" align="right">Comment 19</div>

Replying to [@vbraun](#comment%3A18):
> Morally thats wrong, we should prefer our own formatter which gives e.g. the emacs backend a chance of handling things correctly. The problem is that ipython/jupyter doesn't have a blessed way of recognizing interact output, and moreover keeps adding more magic methods over time. The proposed patch is reasonable to me, hopefully the jupyter guys can keep `ipython_display_formatter` sufficently specific that only output is captured that is 100% ipython specific (like the current `@interact`s which cannot work anywhere else)
> 

Thanks for your feedback.



---

archive/issue_comments_509146.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\n#31536 seems in a good shape and would be a better fix for the issue reported here.",
    "created_at": "2021-03-30T10:14:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509146",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:20" align="right">Comment 20</div>

#31536 seems in a good shape and would be a better fix for the issue reported here.



---

archive/issue_events_416192.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-03-30T10:14:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416192"
}
```



---

archive/issue_events_416193.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-03-30T10:14:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416193"
}
```



---

archive/issue_comments_509147.json:
```json
{
    "body": "Changed branch from **[public/trac31513_display_latex_ipywidgets](https://github.com/sagemath/sagetrac-mirror/tree/public/trac31513_display_latex_ipywidgets)** to none",
    "created_at": "2021-03-31T07:37:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509147",
    "user": "https://github.com/egourgoulhon"
}
```

Changed branch from **[public/trac31513_display_latex_ipywidgets](https://github.com/sagemath/sagetrac-mirror/tree/public/trac31513_display_latex_ipywidgets)** to none



---

archive/issue_comments_509148.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nNow that #31536 is ready, we should use it to fix the issue reported here. In particular, #31536 complies with the moral behaviour expressed in [comment:18](#comment%3A18).",
    "created_at": "2021-03-31T07:37:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509148",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:21" align="right">Comment 21</div>

Now that #31536 is ready, we should use it to fix the issue reported here. In particular, #31536 complies with the moral behaviour expressed in [comment:18](#comment%3A18).



---

archive/issue_events_416194.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-03-31T07:37:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416194"
}
```



---

archive/issue_events_416195.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-03-31T07:37:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416195"
}
```



---

archive/issue_comments_509149.json:
```json
{
    "body": "Changed author from **Eric Gourgoulhon** to none",
    "created_at": "2021-03-31T07:37:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509149",
    "user": "https://github.com/egourgoulhon"
}
```

Changed author from **Eric Gourgoulhon** to none



---

archive/issue_events_416196.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-03-31T07:37:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416196"
}
```



---

archive/issue_events_416197.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-03-31T07:37:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416197"
}
```



---

archive/issue_events_416198.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-03-31T07:37:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416198"
}
```



---

archive/issue_comments_509150.json:
```json
{
    "body": "Changed commit from **[046892e](https://github.com/sagemath/sagetrac-mirror/commit/046892eee8198c4112c45bf52f96131d8be9a40f)** to none",
    "created_at": "2021-03-31T07:37:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509150",
    "user": "https://github.com/egourgoulhon"
}
```

Changed commit from **[046892e](https://github.com/sagemath/sagetrac-mirror/commit/046892eee8198c4112c45bf52f96131d8be9a40f)** to none



---

archive/issue_comments_509151.json:
```json
{
    "body": "Dependencies: **#31536**",
    "created_at": "2021-03-31T17:00:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509151",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#31536**



---

archive/issue_events_416199.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2021-04-07T02:15:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416199"
}
```



---

archive/issue_events_416200.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2021-04-07T02:15:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416200"
}
```



---

archive/issue_comments_509152.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nfixed in Sage 9.3.rc2",
    "created_at": "2021-04-07T02:15:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509152",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:23" align="right">Comment 23</div>

fixed in Sage 9.3.rc2



---

archive/issue_comments_509153.json:
```json
{
    "body": "Reviewer: **Kwankyu Lee**",
    "created_at": "2021-05-23T08:30:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31513#issuecomment-509153",
    "user": "https://github.com/slel"
}
```

Reviewer: **Kwankyu Lee**



---

archive/issue_events_416201.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-05-23T08:30:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416201"
}
```



---

archive/issue_events_416202.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-05-23T08:30:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31513",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31513#event-416202"
}
```
