# Issue 31527: spkg-configure.m4 for polymake

archive/issues_031290.json:
```json
{
    "assignees": [],
    "body": "Polymake is available on a number of systems (https://repology.org/project/polymake/versions) and also on Homebrew via a custom tap: https://polymake.org/doku.php/download/start#binary_releases\n\nWe add system package info and `spkg-configure.m4`\n\nFixing broken distribution packages is beyond the scope of the ticket.\n\nDepends on #32605\n\nCC:  @videlec @jplab @kliem paffenholz@opt.tu-darmstadt.de @antonio-rojas @dimpase @orlitzky\n\nBranch/Commit: **[`03f17c9`](https://github.com/sagemath/sagetrac-mirror/commit/03f17c9f764eeebb1e1cdaa2004f8ce7fac9022e)**\n\nReviewer: **Antonio Rojas, Dima Pasechnik**\n\nAuthor: **Matthias Koeppe**\n\nComponent: **build: configure**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31527_\n\n",
    "closed_at": "2021-11-07T09:36:25Z",
    "created_at": "2021-03-20T04:55:42Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build%3A%20configure",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "spkg-configure.m4 for polymake",
    "type": "issue",
    "updated_at": "2021-11-07T09:36:25Z",
    "url": "https://github.com/sagemath/sage/issues/31527",
    "user": "https://github.com/mkoeppe"
}
```
Polymake is available on a number of systems (https://repology.org/project/polymake/versions) and also on Homebrew via a custom tap: https://polymake.org/doku.php/download/start#binary_releases

We add system package info and `spkg-configure.m4`

Fixing broken distribution packages is beyond the scope of the ticket.

Depends on #32605

CC:  @videlec @jplab @kliem paffenholz@opt.tu-darmstadt.de @antonio-rojas @dimpase @orlitzky

Branch/Commit: **[`03f17c9`](https://github.com/sagemath/sagetrac-mirror/commit/03f17c9f764eeebb1e1cdaa2004f8ce7fac9022e)**

Reviewer: **Antonio Rojas, Dima Pasechnik**

Author: **Matthias Koeppe**

Component: **build: configure**

_Issue created by migration from https://trac.sagemath.org/ticket/31527_





---

archive/issue_events_434628.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-20T04:55:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434628"
}
```



---

archive/issue_events_434629.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-20T04:55:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
    "label_color": "000080",
    "label_name": "c: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434629"
}
```



---

archive/issue_events_434630.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-20T04:55:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434630"
}
```



---

archive/issue_events_434631.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-20T04:55:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434631"
}
```



---

archive/issue_comments_506372.json:
```json
{
    "body": "Branch: **[u/mkoeppe/spkg_configure_m4_for_polymake](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/spkg_configure_m4_for_polymake)**",
    "created_at": "2021-03-20T05:25:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506372",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/spkg_configure_m4_for_polymake](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/spkg_configure_m4_for_polymake)**



---

archive/issue_comments_506373.json:
```json
{
    "body": "Dependencies: **#31335**",
    "created_at": "2021-03-20T06:10:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506373",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#31335**



---

archive/issue_comments_506374.json:
```json
{
    "body": "Commit: **[`2bbee93`](https://github.com/sagemath/sagetrac-mirror/commit/2bbee93956bd6e0f530fecc40cd5a00c2e279c4e)**",
    "created_at": "2021-03-20T06:10:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506374",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`2bbee93`](https://github.com/sagemath/sagetrac-mirror/commit/2bbee93956bd6e0f530fecc40cd5a00c2e279c4e)**



---

archive/issue_comments_506375.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40996b390baa360967e57f5778d5bfad361d4d94\"><code>40996b3</code></a></td><td><code>.homebrew-build-env: Use /usr/local/opt/polymake if it exists</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2bbee93956bd6e0f530fecc40cd5a00c2e279c4e\"><code>2bbee93</code></a></td><td><code>build/pkgs/polymake/spkg-configure.m4: New</code></td></tr></table>\n",
    "created_at": "2021-03-20T06:10:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506375",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40996b390baa360967e57f5778d5bfad361d4d94"><code>40996b3</code></a></td><td><code>.homebrew-build-env: Use /usr/local/opt/polymake if it exists</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2bbee93956bd6e0f530fecc40cd5a00c2e279c4e"><code>2bbee93</code></a></td><td><code>build/pkgs/polymake/spkg-configure.m4: New</code></td></tr></table>




---

archive/issue_comments_506376.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nWith polymake from Andreas's tap, need to do `export PERL5LIB=\"/usr/local/Cellar/polymake/4.3_1/libexec/perl5/lib/perl5/darwin-thread-multi-2level:/usr/local/Cellar/polymake/4.3_1/libexec/perl5/lib/perl5\"` (this is done in the `polymake` script but we use the callable library through jupymake)",
    "created_at": "2021-03-20T06:35:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506376",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

With polymake from Andreas's tap, need to do `export PERL5LIB="/usr/local/Cellar/polymake/4.3_1/libexec/perl5/lib/perl5/darwin-thread-multi-2level:/usr/local/Cellar/polymake/4.3_1/libexec/perl5/lib/perl5"` (this is done in the `polymake` script but we use the callable library through jupymake)



---

archive/issue_comments_506377.json:
```json
{
    "body": "Changed commit from **[`2bbee93`](https://github.com/sagemath/sagetrac-mirror/commit/2bbee93956bd6e0f530fecc40cd5a00c2e279c4e)** to **[`cd792c5`](https://github.com/sagemath/sagetrac-mirror/commit/cd792c5f3ba4cfafca937334a55a553754f42666)**",
    "created_at": "2021-03-20T06:40:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506377",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2bbee93`](https://github.com/sagemath/sagetrac-mirror/commit/2bbee93956bd6e0f530fecc40cd5a00c2e279c4e)** to **[`cd792c5`](https://github.com/sagemath/sagetrac-mirror/commit/cd792c5f3ba4cfafca937334a55a553754f42666)**



---

archive/issue_comments_506378.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/00b3109cd440cb56212b0a520f7e0e889356cc3c\"><code>00b3109</code></a></td><td><code>build/pkgs/sagelib/spkg-install: Set SETUPTOOLS_USE_DISTUTILS=local</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd23c0dde13d4a99b73f24d7cb4739dae9edf771\"><code>fd23c0d</code></a></td><td><code>build/pkgs/setuptools/patches: Add distutils patch from https://github.com/fxcoudert/cpython/commit/6511bf56.patch</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3601c510bbca6155f8e99eebf55b29e8cfe51527\"><code>3601c51</code></a></td><td><code>Adapt the patch to apply to the vendored distutils</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ad84cc0105665ac9c1988a3e8fa0914fd1eac73\"><code>9ad84cc</code></a></td><td><code>Merge branch 't/31344/homebrew__docbuild_crashes__libtcl_atforkprepare' into t/31335/homebrew__unused_packages__singular__pari_______in__usr_local_leak_into_sagelib_build</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ae4ea5530cab4742272b7bb5460cacd210b63544\"><code>ae4ea55</code></a></td><td><code>Merge branch 't/31344/homebrew__docbuild_crashes__libtcl_atforkprepare' into t/31335/homebrew__unused_packages__singular__pari_______in__usr_local_leak_into_sagelib_build</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/add7db48b2138f80fda1e8f5d4e50dbff1bc2e4c\"><code>add7db4</code></a></td><td><code>Merge tag '9.3.beta7' into t/31335/homebrew__unused_packages__singular__pari_______in__usr_local_leak_into_sagelib_build</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4e777e7c9ebe47d1b9f72d625deee6c01f77c14a\"><code>4e777e7</code></a></td><td><code>Merge tag '9.3.beta8' into t/31335/homebrew__unused_packages__singular__pari_______in__usr_local_leak_into_sagelib_build</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e03c5ac0a9d2d82dd864d6d6d9560eddabbcbba5\"><code>e03c5ac</code></a></td><td><code>build/bin/sage-build-env: Set SETUPTOOLS_USE_DISTUTILS here, not in build/pkgs/sagelib/spkg-install</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f1254534fc81bd6f5cd8b01c0de5e480442bc2c6\"><code>f125453</code></a></td><td><code>Merge #31335</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cd792c5f3ba4cfafca937334a55a553754f42666\"><code>cd792c5</code></a></td><td><code>build/pkgs/polymake/distros: Add more</code></td></tr></table>\n",
    "created_at": "2021-03-20T06:40:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506378",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/00b3109cd440cb56212b0a520f7e0e889356cc3c"><code>00b3109</code></a></td><td><code>build/pkgs/sagelib/spkg-install: Set SETUPTOOLS_USE_DISTUTILS=local</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd23c0dde13d4a99b73f24d7cb4739dae9edf771"><code>fd23c0d</code></a></td><td><code>build/pkgs/setuptools/patches: Add distutils patch from https://github.com/fxcoudert/cpython/commit/6511bf56.patch</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3601c510bbca6155f8e99eebf55b29e8cfe51527"><code>3601c51</code></a></td><td><code>Adapt the patch to apply to the vendored distutils</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ad84cc0105665ac9c1988a3e8fa0914fd1eac73"><code>9ad84cc</code></a></td><td><code>Merge branch 't/31344/homebrew__docbuild_crashes__libtcl_atforkprepare' into t/31335/homebrew__unused_packages__singular__pari_______in__usr_local_leak_into_sagelib_build</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ae4ea5530cab4742272b7bb5460cacd210b63544"><code>ae4ea55</code></a></td><td><code>Merge branch 't/31344/homebrew__docbuild_crashes__libtcl_atforkprepare' into t/31335/homebrew__unused_packages__singular__pari_______in__usr_local_leak_into_sagelib_build</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/add7db48b2138f80fda1e8f5d4e50dbff1bc2e4c"><code>add7db4</code></a></td><td><code>Merge tag '9.3.beta7' into t/31335/homebrew__unused_packages__singular__pari_______in__usr_local_leak_into_sagelib_build</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4e777e7c9ebe47d1b9f72d625deee6c01f77c14a"><code>4e777e7</code></a></td><td><code>Merge tag '9.3.beta8' into t/31335/homebrew__unused_packages__singular__pari_______in__usr_local_leak_into_sagelib_build</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e03c5ac0a9d2d82dd864d6d6d9560eddabbcbba5"><code>e03c5ac</code></a></td><td><code>build/bin/sage-build-env: Set SETUPTOOLS_USE_DISTUTILS here, not in build/pkgs/sagelib/spkg-install</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f1254534fc81bd6f5cd8b01c0de5e480442bc2c6"><code>f125453</code></a></td><td><code>Merge #31335</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cd792c5f3ba4cfafca937334a55a553754f42666"><code>cd792c5</code></a></td><td><code>build/pkgs/polymake/distros: Add more</code></td></tr></table>




---

archive/issue_comments_506379.json:
```json
{
    "body": "Changed dependencies from **#31335** to **#31335, #31482**",
    "created_at": "2021-03-20T07:02:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506379",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#31335** to **#31335, #31482**



---

archive/issue_comments_506380.json:
```json
{
    "body": "Changed commit from **[`cd792c5`](https://github.com/sagemath/sagetrac-mirror/commit/cd792c5f3ba4cfafca937334a55a553754f42666)** to **[`4fef65a`](https://github.com/sagemath/sagetrac-mirror/commit/4fef65aab6c0e30f40545c8c53b72b20af871cd9)**",
    "created_at": "2021-03-20T07:09:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506380",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`cd792c5`](https://github.com/sagemath/sagetrac-mirror/commit/cd792c5f3ba4cfafca937334a55a553754f42666)** to **[`4fef65a`](https://github.com/sagemath/sagetrac-mirror/commit/4fef65aab6c0e30f40545c8c53b72b20af871cd9)**



---

archive/issue_comments_506381.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55211fad5e633916a2ffaf113084f4dbbc579808\"><code>55211fa</code></a></td><td><code>build/pkgs/latte_int: Upgrade to 1.7.6</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/78daa99aea08f552a51dca6d55af5e2c5b340367\"><code>78daa99</code></a></td><td><code>build/pkgs/latte_int/dependencies: Make lrslib only an optional dependency</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/156fc9f34e22f20faa3451bdf9fcd673642d41fe\"><code>156fc9f</code></a></td><td><code>Merge #31482</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4fef65aab6c0e30f40545c8c53b72b20af871cd9\"><code>4fef65a</code></a></td><td><code>build/pkgs/polymake/dependencies: Make lrslib only an optional dependency</code></td></tr></table>\n",
    "created_at": "2021-03-20T07:09:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506381",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55211fad5e633916a2ffaf113084f4dbbc579808"><code>55211fa</code></a></td><td><code>build/pkgs/latte_int: Upgrade to 1.7.6</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/78daa99aea08f552a51dca6d55af5e2c5b340367"><code>78daa99</code></a></td><td><code>build/pkgs/latte_int/dependencies: Make lrslib only an optional dependency</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/156fc9f34e22f20faa3451bdf9fcd673642d41fe"><code>156fc9f</code></a></td><td><code>Merge #31482</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4fef65aab6c0e30f40545c8c53b72b20af871cd9"><code>4fef65a</code></a></td><td><code>build/pkgs/polymake/dependencies: Make lrslib only an optional dependency</code></td></tr></table>




---

archive/issue_comments_506382.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/35558b3e4c228794c59e8b6e868079dfd8cc5778\"><code>35558b3</code></a></td><td><code>build/pkgs/polymake/spkg-install.in: Only pass --with-lrs if it is installed</code></td></tr></table>\n",
    "created_at": "2021-03-20T07:50:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506382",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/35558b3e4c228794c59e8b6e868079dfd8cc5778"><code>35558b3</code></a></td><td><code>build/pkgs/polymake/spkg-install.in: Only pass --with-lrs if it is installed</code></td></tr></table>




---

archive/issue_comments_506383.json:
```json
{
    "body": "Changed commit from **[`4fef65a`](https://github.com/sagemath/sagetrac-mirror/commit/4fef65aab6c0e30f40545c8c53b72b20af871cd9)** to **[`35558b3`](https://github.com/sagemath/sagetrac-mirror/commit/35558b3e4c228794c59e8b6e868079dfd8cc5778)**",
    "created_at": "2021-03-20T07:50:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506383",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4fef65a`](https://github.com/sagemath/sagetrac-mirror/commit/4fef65aab6c0e30f40545c8c53b72b20af871cd9)** to **[`35558b3`](https://github.com/sagemath/sagetrac-mirror/commit/35558b3e4c228794c59e8b6e868079dfd8cc5778)**



---

archive/issue_comments_506384.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@mkoeppe](#comment:3):\n> With polymake from Andreas's tap, need to do `export PERL5LIB=\"/usr/local/Cellar/polymake/4.3_1/libexec/perl5/lib/perl5/darwin-thread-multi-2level:/usr/local/Cellar/polymake/4.3_1/libexec/perl5/lib/perl5\"` (this is done in the `polymake` script but we use the callable library through jupymake)\n\nSetting this globally unfortunately breaks autotools (`aclocal`) from homebrew:\n\n```\nUsage: DynaLoader::dl_find_symbol(libhandle, symbolname) at /usr/local/Cellar/polymake/4.3_1/libexec/perl5/lib/perl5/darwin-thread-multi-2level/XSLoader.pm line 89.\nCompilation failed in require at /usr/local/Cellar/polymake/4.3_1/libexec/perl5/lib/perl5/File/Path.pm line 6.\nBEGIN failed--compilation aborted at /usr/local/Cellar/polymake/4.3_1/libexec/perl5/lib/perl5/File/Path.pm line 6.\nCompilation failed in require at /usr/local/bin/aclocal line 33.\nBEGIN failed--compilation aborted at /usr/local/bin/aclocal line 33.\n```\nToo bad that `polymake-config` does not advertise the necessary Perl library path...",
    "created_at": "2021-03-20T16:55:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506384",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@mkoeppe](#comment:3):
> With polymake from Andreas's tap, need to do `export PERL5LIB="/usr/local/Cellar/polymake/4.3_1/libexec/perl5/lib/perl5/darwin-thread-multi-2level:/usr/local/Cellar/polymake/4.3_1/libexec/perl5/lib/perl5"` (this is done in the `polymake` script but we use the callable library through jupymake)

Setting this globally unfortunately breaks autotools (`aclocal`) from homebrew:

```
Usage: DynaLoader::dl_find_symbol(libhandle, symbolname) at /usr/local/Cellar/polymake/4.3_1/libexec/perl5/lib/perl5/darwin-thread-multi-2level/XSLoader.pm line 89.
Compilation failed in require at /usr/local/Cellar/polymake/4.3_1/libexec/perl5/lib/perl5/File/Path.pm line 6.
BEGIN failed--compilation aborted at /usr/local/Cellar/polymake/4.3_1/libexec/perl5/lib/perl5/File/Path.pm line 6.
Compilation failed in require at /usr/local/bin/aclocal line 33.
BEGIN failed--compilation aborted at /usr/local/bin/aclocal line 33.
```
Too bad that `polymake-config` does not advertise the necessary Perl library path...



---

archive/issue_comments_506385.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/93fcbd6fee3bfb9b502e8042bdf4e0fade1b8538\"><code>93fcbd6</code></a></td><td><code>build/pkgs/polymake/distros/debian.txt: Add libpolymake-dev</code></td></tr></table>\n",
    "created_at": "2021-03-20T21:41:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506385",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/93fcbd6fee3bfb9b502e8042bdf4e0fade1b8538"><code>93fcbd6</code></a></td><td><code>build/pkgs/polymake/distros/debian.txt: Add libpolymake-dev</code></td></tr></table>




---

archive/issue_comments_506386.json:
```json
{
    "body": "Changed commit from **[`35558b3`](https://github.com/sagemath/sagetrac-mirror/commit/35558b3e4c228794c59e8b6e868079dfd8cc5778)** to **[`93fcbd6`](https://github.com/sagemath/sagetrac-mirror/commit/93fcbd6fee3bfb9b502e8042bdf4e0fade1b8538)**",
    "created_at": "2021-03-20T21:41:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506386",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`35558b3`](https://github.com/sagemath/sagetrac-mirror/commit/35558b3e4c228794c59e8b6e868079dfd8cc5778)** to **[`93fcbd6`](https://github.com/sagemath/sagetrac-mirror/commit/93fcbd6fee3bfb9b502e8042bdf4e0fade1b8538)**



---

archive/issue_comments_506387.json:
```json
{
    "body": "Changed dependencies from **#31335, #31482** to none",
    "created_at": "2021-03-24T02:16:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506387",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#31335, #31482** to none



---

archive/issue_events_434632.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-02T20:21:54Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434632"
}
```



---

archive/issue_events_434633.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-02T20:21:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434633"
}
```



---

archive/issue_comments_506388.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nMoving this ticket to 9.4, as it seems unlikely that it will be merged in 9.3, which is in the release candidate stage",
    "created_at": "2021-04-02T20:21:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506388",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:12" align="right">comment:12</div>

Moving this ticket to 9.4, as it seems unlikely that it will be merged in 9.3, which is in the release candidate stage



---

archive/issue_comments_506389.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nSaving the continuation:\n\nJuPyMake/JuPyMake.cpp at master \u00b7 sebasguts/JuPyMake\nhttps://github.com/sebasguts/JuPyMake/blob/master/JuPyMake.cpp\n\njupyter-polymake/kernel.py at master \u00b7 polymake/jupyter-polymake\nhttps://github.com/polymake/jupyter-polymake/blob/master/jupyter_kernel_polymake/kernel.py\n\njupyter-kernel-polymake \u00b7 PyPI\nhttps://pypi.org/project/jupyter-kernel-polymake/\n\nFailed to install on OSX Mojave Mac::SystemDirectory is not installed. \u00b7 Issue #39 \u00b7 sqitchers/homebrew-sqitch\nhttps://github.com/sqitchers/homebrew-sqitch/issues/39\n\ntokuhirom/plenv: Perl binary manager\nhttps://github.com/tokuhirom/plenv\n\npolymake Downloads [polymake wiki]\nhttps://polymake.org/doku.php/download/start",
    "created_at": "2021-04-12T23:40:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506389",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:13" align="right">comment:13</div>

Saving the continuation:

JuPyMake/JuPyMake.cpp at master · sebasguts/JuPyMake
https://github.com/sebasguts/JuPyMake/blob/master/JuPyMake.cpp

jupyter-polymake/kernel.py at master · polymake/jupyter-polymake
https://github.com/polymake/jupyter-polymake/blob/master/jupyter_kernel_polymake/kernel.py

jupyter-kernel-polymake · PyPI
https://pypi.org/project/jupyter-kernel-polymake/

Failed to install on OSX Mojave Mac::SystemDirectory is not installed. · Issue #39 · sqitchers/homebrew-sqitch
https://github.com/sqitchers/homebrew-sqitch/issues/39

tokuhirom/plenv: Perl binary manager
https://github.com/tokuhirom/plenv

polymake Downloads [polymake wiki]
https://polymake.org/doku.php/download/start



---

archive/issue_comments_506390.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nPerlbrew\nhttps://perlbrew.pl/\n\ngugod/App-perlbrew: Manage perl installations in your $HOME\nhttps://github.com/gugod/App-perlbrew\n\nApp::perlbrew - Manage perl installations in your $HOME - metacpan.org\nhttps://metacpan.org/pod/App::perlbrew\n\npolymake Downloads [polymake wiki]\nhttps://polymake.org/doku.php/download/start#binary_releases\n\nperl:mongodb package versions - Repology\nhttps://repology.org/project/perl:mongodb/versions",
    "created_at": "2021-04-12T23:41:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506390",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:14" align="right">comment:14</div>

Perlbrew
https://perlbrew.pl/

gugod/App-perlbrew: Manage perl installations in your $HOME
https://github.com/gugod/App-perlbrew

App::perlbrew - Manage perl installations in your $HOME - metacpan.org
https://metacpan.org/pod/App::perlbrew

polymake Downloads [polymake wiki]
https://polymake.org/doku.php/download/start#binary_releases

perl:mongodb package versions - Repology
https://repology.org/project/perl:mongodb/versions



---

archive/issue_comments_506391.json:
```json
{
    "body": "<div id=\"comment:15\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b211f2aac6dda659a60da73812ce6e54aa1ec9fe\"><code>b211f2a</code></a></td><td><code>.homebrew-build-env: Use /usr/local/opt/polymake if it exists</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/27b4992b2df5258d196f97134021c3ee2bfdcf43\"><code>27b4992</code></a></td><td><code>build/pkgs/polymake/spkg-configure.m4: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d30256bb0a93b81278be7d7be2d2a82566f39463\"><code>d30256b</code></a></td><td><code>build/pkgs/polymake/spkg-configure.m4: If system polymake is in use, do not require Perl packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6860f90f8939d3d1089ddd0d9c67dda95c058242\"><code>6860f90</code></a></td><td><code>build/pkgs/polymake/distros: Add more</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f4eb33bd909c71d5857e5e9e45f14c7db1138d95\"><code>f4eb33b</code></a></td><td><code>build/pkgs/polymake/dependencies: Make lrslib only an optional dependency</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d93788a4417b503cc4f47927a4c45a24ab3f34c7\"><code>d93788a</code></a></td><td><code>build/pkgs/polymake/spkg-install.in: Only pass --with-lrs if it is installed</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ad9e2f8d94cd03e7ccea2474213b2f9b7213421\"><code>9ad9e2f</code></a></td><td><code>build/pkgs/polymake/distros/debian.txt: Add libpolymake-dev</code></td></tr></table>\n",
    "created_at": "2021-05-18T01:06:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506391",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:15"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b211f2aac6dda659a60da73812ce6e54aa1ec9fe"><code>b211f2a</code></a></td><td><code>.homebrew-build-env: Use /usr/local/opt/polymake if it exists</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/27b4992b2df5258d196f97134021c3ee2bfdcf43"><code>27b4992</code></a></td><td><code>build/pkgs/polymake/spkg-configure.m4: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d30256bb0a93b81278be7d7be2d2a82566f39463"><code>d30256b</code></a></td><td><code>build/pkgs/polymake/spkg-configure.m4: If system polymake is in use, do not require Perl packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6860f90f8939d3d1089ddd0d9c67dda95c058242"><code>6860f90</code></a></td><td><code>build/pkgs/polymake/distros: Add more</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f4eb33bd909c71d5857e5e9e45f14c7db1138d95"><code>f4eb33b</code></a></td><td><code>build/pkgs/polymake/dependencies: Make lrslib only an optional dependency</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d93788a4417b503cc4f47927a4c45a24ab3f34c7"><code>d93788a</code></a></td><td><code>build/pkgs/polymake/spkg-install.in: Only pass --with-lrs if it is installed</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ad9e2f8d94cd03e7ccea2474213b2f9b7213421"><code>9ad9e2f</code></a></td><td><code>build/pkgs/polymake/distros/debian.txt: Add libpolymake-dev</code></td></tr></table>




---

archive/issue_comments_506392.json:
```json
{
    "body": "Changed commit from **[`93fcbd6`](https://github.com/sagemath/sagetrac-mirror/commit/93fcbd6fee3bfb9b502e8042bdf4e0fade1b8538)** to **[`9ad9e2f`](https://github.com/sagemath/sagetrac-mirror/commit/9ad9e2f8d94cd03e7ccea2474213b2f9b7213421)**",
    "created_at": "2021-05-18T01:06:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506392",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`93fcbd6`](https://github.com/sagemath/sagetrac-mirror/commit/93fcbd6fee3bfb9b502e8042bdf4e0fade1b8538)** to **[`9ad9e2f`](https://github.com/sagemath/sagetrac-mirror/commit/9ad9e2f8d94cd03e7ccea2474213b2f9b7213421)**



---

archive/issue_events_434634.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-11T22:19:14Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434634"
}
```



---

archive/issue_events_434635.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-11T22:19:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434635"
}
```



---

archive/issue_comments_506393.json:
```json
{
    "body": "Dependencies: **#32605**",
    "created_at": "2021-10-08T16:21:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506393",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#32605**



---

archive/issue_comments_506394.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@mkoeppe](#comment:3):\n> With polymake from Andreas's tap, need to do `export PERL5LIB=\"[...]\"` (this is done in the `polymake` script but we use the callable library through jupymake)\n\nFixed in latest version of the homebrew formula according to https://github.com/polymake/polybundle/issues/19#issuecomment-938612849",
    "created_at": "2021-10-08T16:23:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506394",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@mkoeppe](#comment:3):
> With polymake from Andreas's tap, need to do `export PERL5LIB="[...]"` (this is done in the `polymake` script but we use the callable library through jupymake)

Fixed in latest version of the homebrew formula according to https://github.com/polymake/polybundle/issues/19#issuecomment-938612849



---

archive/issue_comments_506395.json:
```json
{
    "body": "Changed commit from **[`9ad9e2f`](https://github.com/sagemath/sagetrac-mirror/commit/9ad9e2f8d94cd03e7ccea2474213b2f9b7213421)** to **[`1832397`](https://github.com/sagemath/sagetrac-mirror/commit/1832397e7b28b5dd1876e76483dcdcf491efe24a)**",
    "created_at": "2021-10-08T16:51:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506395",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9ad9e2f`](https://github.com/sagemath/sagetrac-mirror/commit/9ad9e2f8d94cd03e7ccea2474213b2f9b7213421)** to **[`1832397`](https://github.com/sagemath/sagetrac-mirror/commit/1832397e7b28b5dd1876e76483dcdcf491efe24a)**



---

archive/issue_comments_506396.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2576f86d5b782b81746f5e8a961d848d5757082f\"><code>2576f86</code></a></td><td><code>build/make/Makefile.in: If a script package has no spkg-install, run \"sage -info\" and exit with error</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/feb8de7542cc2d97c1b43f114dc2d96db313a22d\"><code>feb8de7</code></a></td><td><code>build/pkgs/: Remove spkg-install scripts for dummy script packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8f782c01dbc947dcf386303444402b280346f14c\"><code>8f782c0</code></a></td><td><code>.github/workflows/tox-{optional,experimental}.yml: Do not try to test dummy script packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4b292bef2d14ad14c71baf0cba22d07d7a5b55d7\"><code>4b292be</code></a></td><td><code>build/pkgs/perl_mongodb/spkg-install: Remove</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a7b63520b3cc2daa5a7da2f6b7218f40211d92fc\"><code>a7b6352</code></a></td><td><code>build/bin/sage-spkg-info: Fix display of system packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e65b3092f97226196a5ea2de1b46508371745d00\"><code>e65b309</code></a></td><td><code>bootstrap: Do not provide ./configure --enable-SPKG options for dummy optional packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b485d469cb1f61774b3f098b1e4277e66bd712fd\"><code>b485d46</code></a></td><td><code>m4/sage_spkg_collect.m4: Do not advertise dummy optional packages as installable</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8c8e1c43a295228ecc3efd553df66507873727c3\"><code>8c8e1c4</code></a></td><td><code>Merge #31163</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/015b89911e606112327f57949e3bce7af1a0595b\"><code>015b899</code></a></td><td><code>build/bin/sage-print-system-package-command: Handle cpan</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1832397e7b28b5dd1876e76483dcdcf491efe24a\"><code>1832397</code></a></td><td><code>Merge #32605</code></td></tr></table>\n",
    "created_at": "2021-10-08T16:51:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506396",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2576f86d5b782b81746f5e8a961d848d5757082f"><code>2576f86</code></a></td><td><code>build/make/Makefile.in: If a script package has no spkg-install, run "sage -info" and exit with error</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/feb8de7542cc2d97c1b43f114dc2d96db313a22d"><code>feb8de7</code></a></td><td><code>build/pkgs/: Remove spkg-install scripts for dummy script packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8f782c01dbc947dcf386303444402b280346f14c"><code>8f782c0</code></a></td><td><code>.github/workflows/tox-{optional,experimental}.yml: Do not try to test dummy script packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4b292bef2d14ad14c71baf0cba22d07d7a5b55d7"><code>4b292be</code></a></td><td><code>build/pkgs/perl_mongodb/spkg-install: Remove</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a7b63520b3cc2daa5a7da2f6b7218f40211d92fc"><code>a7b6352</code></a></td><td><code>build/bin/sage-spkg-info: Fix display of system packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e65b3092f97226196a5ea2de1b46508371745d00"><code>e65b309</code></a></td><td><code>bootstrap: Do not provide ./configure --enable-SPKG options for dummy optional packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b485d469cb1f61774b3f098b1e4277e66bd712fd"><code>b485d46</code></a></td><td><code>m4/sage_spkg_collect.m4: Do not advertise dummy optional packages as installable</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8c8e1c43a295228ecc3efd553df66507873727c3"><code>8c8e1c4</code></a></td><td><code>Merge #31163</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/015b89911e606112327f57949e3bce7af1a0595b"><code>015b899</code></a></td><td><code>build/bin/sage-print-system-package-command: Handle cpan</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1832397e7b28b5dd1876e76483dcdcf491efe24a"><code>1832397</code></a></td><td><code>Merge #32605</code></td></tr></table>




---

archive/issue_comments_506397.json:
```json
{
    "body": "Changed dependencies from **#32605** to **#32605, #30887**",
    "created_at": "2021-10-08T21:04:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506397",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#32605** to **#32605, #30887**



---

archive/issue_comments_506398.json:
```json
{
    "body": "Changed commit from **[`1832397`](https://github.com/sagemath/sagetrac-mirror/commit/1832397e7b28b5dd1876e76483dcdcf491efe24a)** to **[`83a98be`](https://github.com/sagemath/sagetrac-mirror/commit/83a98bec74e09f0965341feb65c12f2bc74304f1)**",
    "created_at": "2021-10-08T21:05:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506398",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1832397`](https://github.com/sagemath/sagetrac-mirror/commit/1832397e7b28b5dd1876e76483dcdcf491efe24a)** to **[`83a98be`](https://github.com/sagemath/sagetrac-mirror/commit/83a98bec74e09f0965341feb65c12f2bc74304f1)**



---

archive/issue_comments_506399.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ea548d7db98083c0cb8c516d9777e031656b693f\"><code>ea548d7</code></a></td><td><code>sage.features.four_ti_2: New, use it in sage.interfaces.four_ti_2, sage.sandpiles</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f826ded5eaf52bd863c250cadfddd0a56b98f938\"><code>f826ded</code></a></td><td><code>build/pkgs/4ti2/spkg-configure.m4: Check for executable's with prefix 4ti2_ too</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/56016cee03601c3788407eded608138c1f676403\"><code>56016ce</code></a></td><td><code>use AC_LINK_IFELSE instead of obsolete AC_TRY_LINK</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2b45b77946483b06e853506c9013dfeae5d07902\"><code>2b45b77</code></a></td><td><code>sage.feature.join_feature: New, factored out from LatteFeature; use it to implement FourTi2Feature</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5c23cc9dfb4d124bc588c3763bf26a2b87ba7cc6\"><code>5c23cc9</code></a></td><td><code>DocTestReporter: Fix 'sage -t --optional=all'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1b8634de22051a749b8e54f3684dc2930a713f39\"><code>1b8634d</code></a></td><td><code>sage.doctest.external: Add 4ti2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d9d4f999789bcc5477cde60bb26af45dd6b31585\"><code>d9d4f99</code></a></td><td><code>Merge tag '9.4.beta6' into t/30887/public/30887</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/646e182e65fc247d0d2da9aabcad5f892a471a89\"><code>646e182</code></a></td><td><code>src/sage/features/four_ti_2.py: Move import of SAGE_ENV inside the `__init__` method, to remove confusion of sage.misc.dev_tools</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b090dc0c9ccc22f7d56d71220d48cf03eef7f905\"><code>b090dc0</code></a></td><td><code>Merge #30887</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/83a98bec74e09f0965341feb65c12f2bc74304f1\"><code>83a98be</code></a></td><td><code>src/sage/features/polymake.py: New</code></td></tr></table>\n",
    "created_at": "2021-10-08T21:05:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506399",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ea548d7db98083c0cb8c516d9777e031656b693f"><code>ea548d7</code></a></td><td><code>sage.features.four_ti_2: New, use it in sage.interfaces.four_ti_2, sage.sandpiles</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f826ded5eaf52bd863c250cadfddd0a56b98f938"><code>f826ded</code></a></td><td><code>build/pkgs/4ti2/spkg-configure.m4: Check for executable's with prefix 4ti2_ too</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/56016cee03601c3788407eded608138c1f676403"><code>56016ce</code></a></td><td><code>use AC_LINK_IFELSE instead of obsolete AC_TRY_LINK</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2b45b77946483b06e853506c9013dfeae5d07902"><code>2b45b77</code></a></td><td><code>sage.feature.join_feature: New, factored out from LatteFeature; use it to implement FourTi2Feature</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5c23cc9dfb4d124bc588c3763bf26a2b87ba7cc6"><code>5c23cc9</code></a></td><td><code>DocTestReporter: Fix 'sage -t --optional=all'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1b8634de22051a749b8e54f3684dc2930a713f39"><code>1b8634d</code></a></td><td><code>sage.doctest.external: Add 4ti2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d9d4f999789bcc5477cde60bb26af45dd6b31585"><code>d9d4f99</code></a></td><td><code>Merge tag '9.4.beta6' into t/30887/public/30887</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/646e182e65fc247d0d2da9aabcad5f892a471a89"><code>646e182</code></a></td><td><code>src/sage/features/four_ti_2.py: Move import of SAGE_ENV inside the `__init__` method, to remove confusion of sage.misc.dev_tools</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b090dc0c9ccc22f7d56d71220d48cf03eef7f905"><code>b090dc0</code></a></td><td><code>Merge #30887</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/83a98bec74e09f0965341feb65c12f2bc74304f1"><code>83a98be</code></a></td><td><code>src/sage/features/polymake.py: New</code></td></tr></table>




---

archive/issue_comments_506400.json:
```json
{
    "body": "Changed dependencies from **#32605, #30887** to **#32605, #30887, #32547**",
    "created_at": "2021-10-08T21:14:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506400",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#32605, #30887** to **#32605, #30887, #32547**



---

archive/issue_comments_506401.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ccd779a45403565f83636bbafc2b92a33f0bc509\"><code>ccd779a</code></a></td><td><code>#32547 : replace nonexistent llvm-toolchain with clang as Debian alternative to llvm spkg</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b2281fa04da5d24b6675d4622f4a04d8ee55e41d\"><code>b2281fa</code></a></td><td><code>Merge #32547</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2cbfe7e0f79782c4ebb51a2daf9a0b3a97cb2af\"><code>d2cbfe7</code></a></td><td><code>build/pkgs/polymake/distros/homebrew.txt: New</code></td></tr></table>\n",
    "created_at": "2021-10-08T21:20:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506401",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ccd779a45403565f83636bbafc2b92a33f0bc509"><code>ccd779a</code></a></td><td><code>#32547 : replace nonexistent llvm-toolchain with clang as Debian alternative to llvm spkg</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b2281fa04da5d24b6675d4622f4a04d8ee55e41d"><code>b2281fa</code></a></td><td><code>Merge #32547</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2cbfe7e0f79782c4ebb51a2daf9a0b3a97cb2af"><code>d2cbfe7</code></a></td><td><code>build/pkgs/polymake/distros/homebrew.txt: New</code></td></tr></table>




---

archive/issue_comments_506402.json:
```json
{
    "body": "Changed commit from **[`83a98be`](https://github.com/sagemath/sagetrac-mirror/commit/83a98bec74e09f0965341feb65c12f2bc74304f1)** to **[`d2cbfe7`](https://github.com/sagemath/sagetrac-mirror/commit/d2cbfe7e0f79782c4ebb51a2daf9a0b3a97cb2af)**",
    "created_at": "2021-10-08T21:20:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506402",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`83a98be`](https://github.com/sagemath/sagetrac-mirror/commit/83a98bec74e09f0965341feb65c12f2bc74304f1)** to **[`d2cbfe7`](https://github.com/sagemath/sagetrac-mirror/commit/d2cbfe7e0f79782c4ebb51a2daf9a0b3a97cb2af)**



---

archive/issue_comments_506403.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2021-10-08T21:21:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506403",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_events_434636.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-08T21:21:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434636"
}
```



---

archive/issue_comments_506404.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nTested successfully on homebrew",
    "created_at": "2021-10-08T21:22:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506404",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:25" align="right">comment:25</div>

Tested successfully on homebrew



---

archive/issue_comments_506405.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nTesting with `tox -e docker-ubuntu-groovy-maximal`, where `configure` accepts system polymake 4.1-4build1, gives many doctest failures of the form:\n\n```\n      File \"/sage/local/lib/python3.8/site-packages/sage/interfaces/polymake.py\", line 2598, in _start\n        InitializePolymake()          # Can only be called once\n    JuPyMake.PolymakeError: polymake::Main - /usr/lib/polymake/shared is not a symlink\n```\nIndeed: \n\n```\nls -l /usr/lib/polymake/\ntotal 12\n-rw-r--r-- 1 root root 2024 Aug 17  2020 config.ninja\ndrwxr-xr-x 2 root root 4096 Oct  8 21:18 lib\ndrwxr-xr-x 3 root root 4096 Oct  8 21:18 perlx\n```",
    "created_at": "2021-10-09T00:15:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506405",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:27" align="right">comment:27</div>

Testing with `tox -e docker-ubuntu-groovy-maximal`, where `configure` accepts system polymake 4.1-4build1, gives many doctest failures of the form:

```
      File "/sage/local/lib/python3.8/site-packages/sage/interfaces/polymake.py", line 2598, in _start
        InitializePolymake()          # Can only be called once
    JuPyMake.PolymakeError: polymake::Main - /usr/lib/polymake/shared is not a symlink
```
Indeed: 

```
ls -l /usr/lib/polymake/
total 12
-rw-r--r-- 1 root root 2024 Aug 17  2020 config.ninja
drwxr-xr-x 2 root root 4096 Oct  8 21:18 lib
drwxr-xr-x 3 root root 4096 Oct  8 21:18 perlx
```



---

archive/issue_events_434637.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-09T00:17:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434637"
}
```



---

archive/issue_events_434638.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-09T00:17:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434638"
}
```



---

archive/issue_comments_506406.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\n... so clearly we need to extend `spkg-configure.m4` to test that libpolymake has not been debianized to death",
    "created_at": "2021-10-09T00:17:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506406",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:28" align="right">comment:28</div>

... so clearly we need to extend `spkg-configure.m4` to test that libpolymake has not been debianized to death



---

archive/issue_comments_506407.json:
```json
{
    "body": "<div id=\"comment:29\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f1f362d207b2b72ae37c199133abd4b094b3e222\"><code>f1f362d</code></a></td><td><code>build/pkgs/polymake/spkg-configure.m4: Actually use POLYMAKE_VERSION_MIN</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6b5f8cf5cabe3beb7da6edab5d2faf95425c6a0\"><code>c6b5f8c</code></a></td><td><code>build/pkgs/polymake/spkg-configure.m4: Link and run a test program with libpolymake</code></td></tr></table>\n",
    "created_at": "2021-10-09T00:48:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506407",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:29"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f1f362d207b2b72ae37c199133abd4b094b3e222"><code>f1f362d</code></a></td><td><code>build/pkgs/polymake/spkg-configure.m4: Actually use POLYMAKE_VERSION_MIN</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6b5f8cf5cabe3beb7da6edab5d2faf95425c6a0"><code>c6b5f8c</code></a></td><td><code>build/pkgs/polymake/spkg-configure.m4: Link and run a test program with libpolymake</code></td></tr></table>




---

archive/issue_comments_506408.json:
```json
{
    "body": "Changed commit from **[`d2cbfe7`](https://github.com/sagemath/sagetrac-mirror/commit/d2cbfe7e0f79782c4ebb51a2daf9a0b3a97cb2af)** to **[`c6b5f8c`](https://github.com/sagemath/sagetrac-mirror/commit/c6b5f8cf5cabe3beb7da6edab5d2faf95425c6a0)**",
    "created_at": "2021-10-09T00:48:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506408",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d2cbfe7`](https://github.com/sagemath/sagetrac-mirror/commit/d2cbfe7e0f79782c4ebb51a2daf9a0b3a97cb2af)** to **[`c6b5f8c`](https://github.com/sagemath/sagetrac-mirror/commit/c6b5f8cf5cabe3beb7da6edab5d2faf95425c6a0)**



---

archive/issue_comments_506409.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nNow correctly rejects polymake on this system (`tox -e docker-ubuntu-groovy-maximal -- config.status`)",
    "created_at": "2021-10-09T00:49:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506409",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:30" align="right">comment:30</div>

Now correctly rejects polymake on this system (`tox -e docker-ubuntu-groovy-maximal -- config.status`)



---

archive/issue_comments_506410.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nSame on `ubuntu-impish-maximal` (with system polymake 4.3)",
    "created_at": "2021-10-09T00:58:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506410",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:31" align="right">comment:31</div>

Same on `ubuntu-impish-maximal` (with system polymake 4.3)



---

archive/issue_comments_506411.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nOn `fedora-34-maximal`:\n\n```\nconfigure:34443: checking whether libpolymake works\nconfigure:34479: g++ -o conftest  -I/usr/include/polymake/external -I/usr/include/arb -I/usr/include/eigen3 -I/usr/include/gfanlib -I/usr/include/nauty -I/usr/include -I/usr/include -DPOLYMAKE_VERSION=404 -fPIC -pipe -O2 -flto=auto -ffat-lto-objects -fexceptions -g -grecord-gcc-switches -pipe -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -Wno-unused-local-typedefs -std=c++14 -ftemplate-depth-200 -fno-strict-aliasing -fopenmp -Wshadow -Wlogical-op -Wconversion -Wzero-as-null-pointer-constant -Wno-parentheses -Wno-error=unused-function -Wno-stringop-overflow -Wno-array-bounds -Wno-maybe-uninitialized -Wno-free-nonheap-object -DPOLYMAKE_WITH_FLINT -O2 -DPOLYMAKE_DEBUG=0   -Dlinux   -I/usr/include -lpolymake -Wl,-z,relro -Wl,--as-needed -lnormaliz -ldl -fuse-ld=gold -fopenmp -L/usr/lib64 -Wl,-E  conftest.cpp -lmpfi -lmpc -lm4rie -llrcalc -lnauty -lhomfly -liml -lgiac -lecm -lpari -lcurl -lcliquer -lcddgmp -lbz2 -lflint -lmpfr -lglpk -lgmp -lm  -lntl -lLfunction >&5\ncc1plus: error: '-Wformat-security' ignored without '-Wformat' [-Werror=format-security]\ncc1plus: some warnings being treated as errors\n```",
    "created_at": "2021-10-09T01:36:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506411",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:32" align="right">comment:32</div>

On `fedora-34-maximal`:

```
configure:34443: checking whether libpolymake works
configure:34479: g++ -o conftest  -I/usr/include/polymake/external -I/usr/include/arb -I/usr/include/eigen3 -I/usr/include/gfanlib -I/usr/include/nauty -I/usr/include -I/usr/include -DPOLYMAKE_VERSION=404 -fPIC -pipe -O2 -flto=auto -ffat-lto-objects -fexceptions -g -grecord-gcc-switches -pipe -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -Wno-unused-local-typedefs -std=c++14 -ftemplate-depth-200 -fno-strict-aliasing -fopenmp -Wshadow -Wlogical-op -Wconversion -Wzero-as-null-pointer-constant -Wno-parentheses -Wno-error=unused-function -Wno-stringop-overflow -Wno-array-bounds -Wno-maybe-uninitialized -Wno-free-nonheap-object -DPOLYMAKE_WITH_FLINT -O2 -DPOLYMAKE_DEBUG=0   -Dlinux   -I/usr/include -lpolymake -Wl,-z,relro -Wl,--as-needed -lnormaliz -ldl -fuse-ld=gold -fopenmp -L/usr/lib64 -Wl,-E  conftest.cpp -lmpfi -lmpc -lm4rie -llrcalc -lnauty -lhomfly -liml -lgiac -lecm -lpari -lcurl -lcliquer -lcddgmp -lbz2 -lflint -lmpfr -lglpk -lgmp -lm  -lntl -lLfunction >&5
cc1plus: error: '-Wformat-security' ignored without '-Wformat' [-Werror=format-security]
cc1plus: some warnings being treated as errors
```



---

archive/issue_comments_506412.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nSame on `fedora-35-maximal`\n\nSo system polymake is rejected. This is correct because building jupymake would fail with the same error.",
    "created_at": "2021-10-09T02:07:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506412",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:33" align="right">comment:33</div>

Same on `fedora-35-maximal`

So system polymake is rejected. This is correct because building jupymake would fail with the same error.



---

archive/issue_comments_506413.json:
```json
{
    "body": "<div id=\"comment:34\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d9fc03e7c039d697247220fd527ec7d2bbf8f588\"><code>d9fc03e</code></a></td><td><code>build/pkgs/perl_cpan_polymake_prereq/distros/fedora.txt: perl-TermReadKey, not perl-Term-ReadKey</code></td></tr></table>\n",
    "created_at": "2021-10-09T02:39:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506413",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d9fc03e7c039d697247220fd527ec7d2bbf8f588"><code>d9fc03e</code></a></td><td><code>build/pkgs/perl_cpan_polymake_prereq/distros/fedora.txt: perl-TermReadKey, not perl-Term-ReadKey</code></td></tr></table>




---

archive/issue_comments_506414.json:
```json
{
    "body": "Changed commit from **[`c6b5f8c`](https://github.com/sagemath/sagetrac-mirror/commit/c6b5f8cf5cabe3beb7da6edab5d2faf95425c6a0)** to **[`d9fc03e`](https://github.com/sagemath/sagetrac-mirror/commit/d9fc03e7c039d697247220fd527ec7d2bbf8f588)**",
    "created_at": "2021-10-09T02:39:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506414",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c6b5f8c`](https://github.com/sagemath/sagetrac-mirror/commit/c6b5f8cf5cabe3beb7da6edab5d2faf95425c6a0)** to **[`d9fc03e`](https://github.com/sagemath/sagetrac-mirror/commit/d9fc03e7c039d697247220fd527ec7d2bbf8f588)**



---

archive/issue_comments_506415.json:
```json
{
    "body": "Changed commit from **[`d9fc03e`](https://github.com/sagemath/sagetrac-mirror/commit/d9fc03e7c039d697247220fd527ec7d2bbf8f588)** to **[`777d1b8`](https://github.com/sagemath/sagetrac-mirror/commit/777d1b8d20aa23c69faa7f7da7cb31c7c8078aa1)**",
    "created_at": "2021-10-09T02:49:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506415",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d9fc03e`](https://github.com/sagemath/sagetrac-mirror/commit/d9fc03e7c039d697247220fd527ec7d2bbf8f588)** to **[`777d1b8`](https://github.com/sagemath/sagetrac-mirror/commit/777d1b8d20aa23c69faa7f7da7cb31c7c8078aa1)**



---

archive/issue_comments_506416.json:
```json
{
    "body": "<div id=\"comment:35\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/777d1b8d20aa23c69faa7f7da7cb31c7c8078aa1\"><code>777d1b8</code></a></td><td><code>build/pkgs/polymake/distros/nix.txt: New</code></td></tr></table>\n",
    "created_at": "2021-10-09T02:49:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506416",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:35"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/777d1b8d20aa23c69faa7f7da7cb31c7c8078aa1"><code>777d1b8</code></a></td><td><code>build/pkgs/polymake/distros/nix.txt: New</code></td></tr></table>




---

archive/issue_events_434639.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-09T03:13:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434639"
}
```



---

archive/issue_events_434640.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-09T03:13:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434640"
}
```



---

archive/issue_comments_506417.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nneeds a rebase",
    "created_at": "2021-10-12T09:46:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506417",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:38" align="right">comment:38</div>

needs a rebase



---

archive/issue_comments_506418.json:
```json
{
    "body": "<div id=\"comment:39\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/edce768c1fbe256b13cab1d0161cefb3d3a076fb\"><code>edce768</code></a></td><td><code>Merge tag '9.5.beta3' into t/31527/spkg_configure_m4_for_polymake</code></td></tr></table>\n",
    "created_at": "2021-10-12T17:08:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506418",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:39"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/edce768c1fbe256b13cab1d0161cefb3d3a076fb"><code>edce768</code></a></td><td><code>Merge tag '9.5.beta3' into t/31527/spkg_configure_m4_for_polymake</code></td></tr></table>




---

archive/issue_comments_506419.json:
```json
{
    "body": "Changed commit from **[`777d1b8`](https://github.com/sagemath/sagetrac-mirror/commit/777d1b8d20aa23c69faa7f7da7cb31c7c8078aa1)** to **[`edce768`](https://github.com/sagemath/sagetrac-mirror/commit/edce768c1fbe256b13cab1d0161cefb3d3a076fb)**",
    "created_at": "2021-10-12T17:08:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506419",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`777d1b8`](https://github.com/sagemath/sagetrac-mirror/commit/777d1b8d20aa23c69faa7f7da7cb31c7c8078aa1)** to **[`edce768`](https://github.com/sagemath/sagetrac-mirror/commit/edce768c1fbe256b13cab1d0161cefb3d3a076fb)**



---

archive/issue_comments_506420.json:
```json
{
    "body": "Changed dependencies from **#32605, #30887, #32547** to **#32605**",
    "created_at": "2021-10-12T17:11:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506420",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#32605, #30887, #32547** to **#32605**



---

archive/issue_comments_506421.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\ngentoo's polymake is too old atm, it's 3.0_p2 there (and broken).",
    "created_at": "2021-10-12T20:04:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506421",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:41" align="right">comment:41</div>

gentoo's polymake is too old atm, it's 3.0_p2 there (and broken).



---

archive/issue_comments_506422.json:
```json
{
    "body": "Changed commit from **[`edce768`](https://github.com/sagemath/sagetrac-mirror/commit/edce768c1fbe256b13cab1d0161cefb3d3a076fb)** to **[`717f98b`](https://github.com/sagemath/sagetrac-mirror/commit/717f98bdb79b5a00820673e94e3096df66c12dab)**",
    "created_at": "2021-10-12T21:02:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506422",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`edce768`](https://github.com/sagemath/sagetrac-mirror/commit/edce768c1fbe256b13cab1d0161cefb3d3a076fb)** to **[`717f98b`](https://github.com/sagemath/sagetrac-mirror/commit/717f98bdb79b5a00820673e94e3096df66c12dab)**



---

archive/issue_comments_506423.json:
```json
{
    "body": "<div id=\"comment:42\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/717f98bdb79b5a00820673e94e3096df66c12dab\"><code>717f98b</code></a></td><td><code>build/pkgs/polymake/distros/gentoo.txt: Remove</code></td></tr></table>\n",
    "created_at": "2021-10-12T21:02:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506423",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:42"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/717f98bdb79b5a00820673e94e3096df66c12dab"><code>717f98b</code></a></td><td><code>build/pkgs/polymake/distros/gentoo.txt: Remove</code></td></tr></table>




---

archive/issue_comments_506424.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nLet's get this in please",
    "created_at": "2021-10-19T22:11:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506424",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:43" align="right">comment:43</div>

Let's get this in please



---

archive/issue_events_434641.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-10-20T10:44:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434641"
}
```



---

archive/issue_events_434642.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-10-20T10:44:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434642"
}
```



---

archive/issue_comments_506425.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nfails to recognize polymake on Fedora 34 with polymake package installed, due to\n`-Werror=format-security` in `g++` call from `./configure`.\n\n```\nconfigure:36908: checking for polymake-config >= 3.5\nconfigure:36984: result: /usr/bin/polymake-config\nconfigure:36989: checking whether libpolymake works\nconfigure:37025: g++ -o conftest  -I/usr/include/polymake/external -I/usr/include/arb -I/usr/include/eigen3 -I/usr/include/gfanlib -I/usr/include/nauty -I/usr/include -I/usr/include -DPOLYMAKE_VERSION=404 -fPIC -pipe -O2 -flto=auto -ffat-lto-objects -fexceptions -g -grecord-gcc-switches -pipe -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -Wno-unused-local-typedefs -std=c++14 -ftemplate-depth-200 -fno-strict-aliasing -fopenmp -Wshadow -Wlogical-op -Wconversion -Wzero-as-null-pointer-constant -Wno-parentheses -Wno-error=unused-function -Wno-stringop-overflow -Wno-array-bounds -Wno-maybe-uninitialized -Wno-free-nonheap-object -DPOLYMAKE_WITH_FLINT -O2 -DPOLYMAKE_DEBUG=0   -Dlinux   -I/usr/include -lpolymake -Wl,-z,relro -Wl,--as-needed -lnormaliz -ldl -fuse-ld=gold -fopenmp -L/usr/lib64 -Wl,-E  conftest.cpp -lmpfi -lmpc -lm4rie -llrcalc -lnauty -lhomfly -liml -lgiac -lecm -lpari -lcurl -lcliquer -lcddgmp -lbz2 -lflint -lmpfr -lglpk -lgmp -lm  -lntl -lLfunction >&5\ncc1plus: error: '-Wformat-security' ignored without '-Wformat' [-Werror=format-security]\ncc1plus: some warnings being treated as errors\n```\n\nAnd `Werror` gets there from `polymake-config --cflags` call.\n\n```\n$ polymake-config --cflags\n-DPOLYMAKE_VERSION=404 -fPIC -pipe -O2 -flto=auto -ffat-lto-objects -fexceptions -g -grecord-gcc-switches -pipe -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -Wno-unused-local-typedefs -std=c++14 -ftemplate-depth-200 -fno-strict-aliasing -fopenmp -Wshadow -Wlogical-op -Wconversion -Wzero-as-null-pointer-constant -Wno-parentheses -Wno-error=unused-function -Wno-stringop-overflow -Wno-array-bounds -Wno-maybe-uninitialized -Wno-free-nonheap-object -DPOLYMAKE_WITH_FLINT -O2 -DPOLYMAKE_DEBUG=0\n```",
    "created_at": "2021-10-20T10:44:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506425",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:44" align="right">comment:44</div>

fails to recognize polymake on Fedora 34 with polymake package installed, due to
`-Werror=format-security` in `g++` call from `./configure`.

```
configure:36908: checking for polymake-config >= 3.5
configure:36984: result: /usr/bin/polymake-config
configure:36989: checking whether libpolymake works
configure:37025: g++ -o conftest  -I/usr/include/polymake/external -I/usr/include/arb -I/usr/include/eigen3 -I/usr/include/gfanlib -I/usr/include/nauty -I/usr/include -I/usr/include -DPOLYMAKE_VERSION=404 -fPIC -pipe -O2 -flto=auto -ffat-lto-objects -fexceptions -g -grecord-gcc-switches -pipe -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -Wno-unused-local-typedefs -std=c++14 -ftemplate-depth-200 -fno-strict-aliasing -fopenmp -Wshadow -Wlogical-op -Wconversion -Wzero-as-null-pointer-constant -Wno-parentheses -Wno-error=unused-function -Wno-stringop-overflow -Wno-array-bounds -Wno-maybe-uninitialized -Wno-free-nonheap-object -DPOLYMAKE_WITH_FLINT -O2 -DPOLYMAKE_DEBUG=0   -Dlinux   -I/usr/include -lpolymake -Wl,-z,relro -Wl,--as-needed -lnormaliz -ldl -fuse-ld=gold -fopenmp -L/usr/lib64 -Wl,-E  conftest.cpp -lmpfi -lmpc -lm4rie -llrcalc -lnauty -lhomfly -liml -lgiac -lecm -lpari -lcurl -lcliquer -lcddgmp -lbz2 -lflint -lmpfr -lglpk -lgmp -lm  -lntl -lLfunction >&5
cc1plus: error: '-Wformat-security' ignored without '-Wformat' [-Werror=format-security]
cc1plus: some warnings being treated as errors
```

And `Werror` gets there from `polymake-config --cflags` call.

```
$ polymake-config --cflags
-DPOLYMAKE_VERSION=404 -fPIC -pipe -O2 -flto=auto -ffat-lto-objects -fexceptions -g -grecord-gcc-switches -pipe -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -Wno-unused-local-typedefs -std=c++14 -ftemplate-depth-200 -fno-strict-aliasing -fopenmp -Wshadow -Wlogical-op -Wconversion -Wzero-as-null-pointer-constant -Wno-parentheses -Wno-error=unused-function -Wno-stringop-overflow -Wno-array-bounds -Wno-maybe-uninitialized -Wno-free-nonheap-object -DPOLYMAKE_WITH_FLINT -O2 -DPOLYMAKE_DEBUG=0
```



---

archive/issue_comments_506426.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nIf I clean up CPPFLAGS as follows\n\n```diff\n--- a/build/pkgs/polymake/spkg-configure.m4\n+++ b/build/pkgs/polymake/spkg-configure.m4\n@@ -20,6 +20,7 @@ SAGE_SPKG_CONFIGURE([polymake], [\n            saved_LDFLAGS=\"$LDFLAGS\"\n            CXX=\"$($ac_cv_path_POLYMAKE_CONFIG --cc)\"\n            CPPFLAGS=\"$($ac_cv_path_POLYMAKE_CONFIG --includes) $($ac_cv_path_POLYMAKE_CONFIG --cflags) $CPPFLAGS\"\n+           CPPFLAGS=${CPPFLAGS//\\-Werror=format\\-security/}\n            LDFLAGS=\"-lpolymake $($ac_cv_path_POLYMAKE_CONFIG --ldflags) $LDFLAGS\"\n            AC_RUN_IFELSE([AC_LANG_PROGRAM([[\n                #include <polymake/Main.h>\n```\n then I still get\n\n\n```\nconfigure:36989: checking whether libpolymake works\nconfigure:37026: g++ -o conftest  -I/usr/include/polymake/external -I/usr/include/arb -I/usr/include/eigen3 -I/usr/include/gfanlib -I/usr/include/nauty -I/usr/include -I/usr/include -DPOLYMAKE_VERSION=404 -fPIC -pipe -O2 -flto=auto -ffat-lto-objects -fexceptions -g -grecord-gcc-switches -pipe  -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -Wno-unused-local-typedefs -std=c++14 -ftemplate-depth-200 -fno-strict-aliasing -fopenmp -Wshadow -Wlogical-op -Wconversion -Wzero-as-null-pointer-constant -Wno-parentheses -Wno-error=unused-function -Wno-stringop-overflow -Wno-array-bounds -Wno-maybe-uninitialized -Wno-free-nonheap-object -DPOLYMAKE_WITH_FLINT -O2 -DPOLYMAKE_DEBUG=0   -Dlinux   -I/usr/include -lpolymake -Wl,-z,relro -Wl,--as-needed -lnormaliz -ldl -fuse-ld=gold -fopenmp -L/usr/lib64 -Wl,-E  conftest.cpp -lmpfi -lmpc -lm4rie -llrcalc -lnauty -lhomfly -liml -lgiac -lecm -lpari -lcurl -lcliquer -lcddgmp -lbz2 -lflint -lmpfr -lglpk -lgmp -lm  -lntl -lLfunction >&5\nconfigure:37026: $? = 0\nconfigure:37026: ./conftest\nCan't locate Polymake/Main.pm in @INC (you may need to install the Polymake::Main module) (@INC contains: /share/polymake/perllib /lib64/polymake/perlx/5.32.1/x86_64-linux-thread-multi /lib64/polymake/perlx/5.32.1 /lib64/polymake/perlx /users/dimpase/perl5/lib/perl5/x86_64-linux-thread-multi /users/dimpase/perl5/lib/perl5 /usr/local/lib64/perl5/5.32 /usr/local/share/perl5/5.32 /usr/lib64/perl5/vendor_perl /usr/share/perl5/vendor_perl /usr/lib64/perl5 /usr/share/perl5) at /builddir/build/BUILD/polymake-4.4/lib/callable/src/perl/Main.cc line 146.\nBEGIN failed--compilation aborted at /builddir/build/BUILD/polymake-4.4/lib/callable/src/perl/Main.cc line 146.\nterminate called after throwing an instance of 'std::runtime_error'\n  what():  could not initialize the perl interpreter\n./configure: line 3495: 1808668 Aborted                 (core dumped) ./conftest$ac_exeext\nconfigure:37026: $? = 134\nconfigure: program exited with status 134\n```",
    "created_at": "2021-10-20T13:52:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506426",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:45" align="right">comment:45</div>

If I clean up CPPFLAGS as follows

```diff
--- a/build/pkgs/polymake/spkg-configure.m4
+++ b/build/pkgs/polymake/spkg-configure.m4
@@ -20,6 +20,7 @@ SAGE_SPKG_CONFIGURE([polymake], [
            saved_LDFLAGS="$LDFLAGS"
            CXX="$($ac_cv_path_POLYMAKE_CONFIG --cc)"
            CPPFLAGS="$($ac_cv_path_POLYMAKE_CONFIG --includes) $($ac_cv_path_POLYMAKE_CONFIG --cflags) $CPPFLAGS"
+           CPPFLAGS=${CPPFLAGS//\-Werror=format\-security/}
            LDFLAGS="-lpolymake $($ac_cv_path_POLYMAKE_CONFIG --ldflags) $LDFLAGS"
            AC_RUN_IFELSE([AC_LANG_PROGRAM([[
                #include <polymake/Main.h>
```
 then I still get


```
configure:36989: checking whether libpolymake works
configure:37026: g++ -o conftest  -I/usr/include/polymake/external -I/usr/include/arb -I/usr/include/eigen3 -I/usr/include/gfanlib -I/usr/include/nauty -I/usr/include -I/usr/include -DPOLYMAKE_VERSION=404 -fPIC -pipe -O2 -flto=auto -ffat-lto-objects -fexceptions -g -grecord-gcc-switches -pipe  -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1 -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -Wno-unused-local-typedefs -std=c++14 -ftemplate-depth-200 -fno-strict-aliasing -fopenmp -Wshadow -Wlogical-op -Wconversion -Wzero-as-null-pointer-constant -Wno-parentheses -Wno-error=unused-function -Wno-stringop-overflow -Wno-array-bounds -Wno-maybe-uninitialized -Wno-free-nonheap-object -DPOLYMAKE_WITH_FLINT -O2 -DPOLYMAKE_DEBUG=0   -Dlinux   -I/usr/include -lpolymake -Wl,-z,relro -Wl,--as-needed -lnormaliz -ldl -fuse-ld=gold -fopenmp -L/usr/lib64 -Wl,-E  conftest.cpp -lmpfi -lmpc -lm4rie -llrcalc -lnauty -lhomfly -liml -lgiac -lecm -lpari -lcurl -lcliquer -lcddgmp -lbz2 -lflint -lmpfr -lglpk -lgmp -lm  -lntl -lLfunction >&5
configure:37026: $? = 0
configure:37026: ./conftest
Can't locate Polymake/Main.pm in @INC (you may need to install the Polymake::Main module) (@INC contains: /share/polymake/perllib /lib64/polymake/perlx/5.32.1/x86_64-linux-thread-multi /lib64/polymake/perlx/5.32.1 /lib64/polymake/perlx /users/dimpase/perl5/lib/perl5/x86_64-linux-thread-multi /users/dimpase/perl5/lib/perl5 /usr/local/lib64/perl5/5.32 /usr/local/share/perl5/5.32 /usr/lib64/perl5/vendor_perl /usr/share/perl5/vendor_perl /usr/lib64/perl5 /usr/share/perl5) at /builddir/build/BUILD/polymake-4.4/lib/callable/src/perl/Main.cc line 146.
BEGIN failed--compilation aborted at /builddir/build/BUILD/polymake-4.4/lib/callable/src/perl/Main.cc line 146.
terminate called after throwing an instance of 'std::runtime_error'
  what():  could not initialize the perl interpreter
./configure: line 3495: 1808668 Aborted                 (core dumped) ./conftest$ac_exeext
configure:37026: $? = 134
configure: program exited with status 134
```



---

archive/issue_comments_506427.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nReplying to [@dimpase](#comment:44):\n> fails to recognize polymake on Fedora 34 with polymake package installed, due to\n> `-Werror=format-security` in `g++` call from `./configure`.\n\nYes, see [comment:33](#comment:33).",
    "created_at": "2021-10-20T15:49:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506427",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:46" align="right">comment:46</div>

Replying to [@dimpase](#comment:44):
> fails to recognize polymake on Fedora 34 with polymake package installed, due to
> `-Werror=format-security` in `g++` call from `./configure`.

Yes, see [comment:33](#comment:33).



---

archive/issue_events_434643.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-20T15:49:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434643"
}
```



---

archive/issue_events_434644.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-20T15:49:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434644"
}
```



---

archive/issue_comments_506428.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n Polymake is available on a number of systems (https://repology.org/project/polymake/versions) and also on Homebrew via a custom tap: https://polymake.org/doku.php/download/start#binary_releases\n \n We add system package info and `spkg-configure.m4`\n+\n+Fixing broken distribution packages is beyond the scope of the ticket.\n``````\n",
    "created_at": "2021-10-20T16:58:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506428",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 Polymake is available on a number of systems (https://repology.org/project/polymake/versions) and also on Homebrew via a custom tap: https://polymake.org/doku.php/download/start#binary_releases
 
 We add system package info and `spkg-configure.m4`
+
+Fixing broken distribution packages is beyond the scope of the ticket.
``````




---

archive/issue_events_434645.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-10-21T16:55:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
    "label_color": "000080",
    "label_name": "c: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434645"
}
```



---

archive/issue_events_434646.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-10-21T16:55:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build%3A%20configure",
    "label_color": "000080",
    "label_name": "c: build: configure",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434646"
}
```



---

archive/issue_comments_506429.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nIs there any Linux distro with working for the purposes of this ticket Polymake package?",
    "created_at": "2021-10-21T17:36:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506429",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:50" align="right">comment:50</div>

Is there any Linux distro with working for the purposes of this ticket Polymake package?



---

archive/issue_comments_506430.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nI don't remember if I tested with `arch`, `opensuse`, or `nix`.",
    "created_at": "2021-10-21T17:42:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506430",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:51" align="right">comment:51</div>

I don't remember if I tested with `arch`, `opensuse`, or `nix`.



---

archive/issue_comments_506431.json:
```json
{
    "body": "Reviewer: **Antonio Rojas**",
    "created_at": "2021-10-21T20:36:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506431",
    "user": "https://github.com/antonio-rojas"
}
```

Reviewer: **Antonio Rojas**



---

archive/issue_events_434647.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2021-10-21T20:36:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434647"
}
```



---

archive/issue_events_434648.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2021-10-21T20:36:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434648"
}
```



---

archive/issue_comments_506432.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nWorks fine on Arch. Picks up system polymake, Jupymake spkg installs correctly and all tests pass in `interfaces.polymake`",
    "created_at": "2021-10-21T20:36:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506432",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:52" align="right">comment:52</div>

Works fine on Arch. Picks up system polymake, Jupymake spkg installs correctly and all tests pass in `interfaces.polymake`



---

archive/issue_comments_506433.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nThanks!",
    "created_at": "2021-10-21T20:45:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506433",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:53" align="right">comment:53</div>

Thanks!



---

archive/issue_comments_506434.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nReplying to [@dimpase](#comment:50):\n> Is there any Linux distro with working for the purposes of this ticket Polymake package?\n\n>\n\nGentoo with https://github.com/gentoo/gentoo/pull/17925\n\n```\nsage -t --long --random-seed=0 src/sage/interfaces/polymake.py\n    [54 tests, 0.63 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 0.7 seconds\n    cpu time: 0.1 seconds\n    cumulative wall time: 0.6 seconds\nTraceback (most recent call last):\n  File \"/usr/lib/python-exec/python3.10/sage-runtests\", line 159, in <module>\n    exit_code_pytest = pytest.main(pytest_options + args)\nTypeError: can only concatenate list (not \"Namespace\") to list\n```",
    "created_at": "2021-10-21T21:03:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506434",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:54" align="right">comment:54</div>

Replying to [@dimpase](#comment:50):
> Is there any Linux distro with working for the purposes of this ticket Polymake package?

>

Gentoo with https://github.com/gentoo/gentoo/pull/17925

```
sage -t --long --random-seed=0 src/sage/interfaces/polymake.py
    [54 tests, 0.63 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 0.7 seconds
    cpu time: 0.1 seconds
    cumulative wall time: 0.6 seconds
Traceback (most recent call last):
  File "/usr/lib/python-exec/python3.10/sage-runtests", line 159, in <module>
    exit_code_pytest = pytest.main(pytest_options + args)
TypeError: can only concatenate list (not "Namespace") to list
```



---

archive/issue_comments_506435.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nExcellent!",
    "created_at": "2021-10-21T23:14:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506435",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:55" align="right">comment:55</div>

Excellent!



---

archive/issue_comments_506436.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nThe present branch appears to need `polymake` explictly listed in the list `--optional=`, if it's not installed. On arch I have:\n\n```\n$ ./sage -tp  src/sage/geometry/polyhedron/backend_polymake.py\nRunning doctests with ID 2021-10-22-08-52-35-89300609.\nGit branch: wip\nUsing --optional=arch,argcomplete,build,dochtml,jupymake,pip,sage,sage.rings.real_double,sage_spkg\nDoctesting 1 file using 4 threads.\nsage -t --warn-long 105.2 --random-seed=111795974516996210666725135263478181348 src/sage/geometry/polyhedron/backend_polymake.py\n    [9 tests, 0.52 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 0.6 seconds\n    cpu time: 0.5 seconds\n    cumulative wall time: 0.5 seconds\nPytest is not installed, skip checking tests that rely on it.\n```\nbut\n\n```\n$ ./sage -tp --optional=arch,argcomplete,build,dochtml,pip,sage,sage.rings.real_double,sage_spkg,polymake src/sage/geometry/polyhedron/backend_polymake.py\nRunning doctests with ID 2021-10-22-08-52-45-3599c25d.\nGit branch: wip\nUsing --optional=arch,argcomplete,build,dochtml,pip,polymake,sage,sage.rings.real_double,sage_spkg\nDoctesting 1 file using 4 threads.\nsage -t --warn-long 105.2 --random-seed=65107005796673777637867553513561507930 src/sage/geometry/polyhedron/backend_polymake.py\n**********************************************************************\nFile \"src/sage/geometry/polyhedron/backend_polymake.py\", line 665, in sage.geometry.polyhedron.backend_polymake.Polyhedron_polymake.__setstate__\nFailed example:\n    print(\"Possible output\"); P = polytopes.dodecahedron(backend='polymake')  # optional - polymake\nException raised:\n    Traceback (most recent call last):\n      File \"/home/dima/sagetrac-mirror/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/interface.py\", line 732, in __init__\n        self._name = parent._create(value, name=name)\n      File \"/home/dima/sagetrac-mirror/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/polymake.py\", line 549, in _create\n        self.set(name, value)\n      File \"/home/dima/sagetrac-mirror/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/polymake.py\", line 638, in set\n        self.eval(cmd)\n      File \"/home/dima/sagetrac-mirror/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/polymake.py\", line 2712, in eval\n        raise PolymakeError(error)\n    sage.interfaces.polymake.PolymakeError: C++/perl Interface module compilation failed; most likely due to a type mismatch.\n    Set the variable $Polymake::User::Verbose::cpp to a positive value and repeat for more details.\n\n\n    During handling of the above exception, another exception occurred:\n...\n   TypeError: C++/perl Interface module compilation failed; most likely due to a type mismatch.\n    Set the variable $Polymake::User::Verbose::cpp to a positive value and repeat for more details.\n\n**********************************************************************\n1 item had failures:\n   1 of  21 in sage.geometry.polyhedron.backend_polymake.Polyhedron_polymake.__setstate__\n    [106 tests, 1 failure, 13.32 s]\n----------------------------------------------------------------------\nsage -t --warn-long 105.2 --random-seed=65107005796673777637867553513561507930 src/sage/geometry/polyhedron/backend_polymake.py  # 1 doctest failed\n```\n\nthere is a similar test failure in `src/sage/geometry/polyhedron/base.py`",
    "created_at": "2021-10-22T08:57:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506436",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:56" align="right">comment:56</div>

The present branch appears to need `polymake` explictly listed in the list `--optional=`, if it's not installed. On arch I have:

```
$ ./sage -tp  src/sage/geometry/polyhedron/backend_polymake.py
Running doctests with ID 2021-10-22-08-52-35-89300609.
Git branch: wip
Using --optional=arch,argcomplete,build,dochtml,jupymake,pip,sage,sage.rings.real_double,sage_spkg
Doctesting 1 file using 4 threads.
sage -t --warn-long 105.2 --random-seed=111795974516996210666725135263478181348 src/sage/geometry/polyhedron/backend_polymake.py
    [9 tests, 0.52 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 0.6 seconds
    cpu time: 0.5 seconds
    cumulative wall time: 0.5 seconds
Pytest is not installed, skip checking tests that rely on it.
```
but

```
$ ./sage -tp --optional=arch,argcomplete,build,dochtml,pip,sage,sage.rings.real_double,sage_spkg,polymake src/sage/geometry/polyhedron/backend_polymake.py
Running doctests with ID 2021-10-22-08-52-45-3599c25d.
Git branch: wip
Using --optional=arch,argcomplete,build,dochtml,pip,polymake,sage,sage.rings.real_double,sage_spkg
Doctesting 1 file using 4 threads.
sage -t --warn-long 105.2 --random-seed=65107005796673777637867553513561507930 src/sage/geometry/polyhedron/backend_polymake.py
**********************************************************************
File "src/sage/geometry/polyhedron/backend_polymake.py", line 665, in sage.geometry.polyhedron.backend_polymake.Polyhedron_polymake.__setstate__
Failed example:
    print("Possible output"); P = polytopes.dodecahedron(backend='polymake')  # optional - polymake
Exception raised:
    Traceback (most recent call last):
      File "/home/dima/sagetrac-mirror/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/interface.py", line 732, in __init__
        self._name = parent._create(value, name=name)
      File "/home/dima/sagetrac-mirror/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/polymake.py", line 549, in _create
        self.set(name, value)
      File "/home/dima/sagetrac-mirror/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/polymake.py", line 638, in set
        self.eval(cmd)
      File "/home/dima/sagetrac-mirror/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/polymake.py", line 2712, in eval
        raise PolymakeError(error)
    sage.interfaces.polymake.PolymakeError: C++/perl Interface module compilation failed; most likely due to a type mismatch.
    Set the variable $Polymake::User::Verbose::cpp to a positive value and repeat for more details.


    During handling of the above exception, another exception occurred:
...
   TypeError: C++/perl Interface module compilation failed; most likely due to a type mismatch.
    Set the variable $Polymake::User::Verbose::cpp to a positive value and repeat for more details.

**********************************************************************
1 item had failures:
   1 of  21 in sage.geometry.polyhedron.backend_polymake.Polyhedron_polymake.__setstate__
    [106 tests, 1 failure, 13.32 s]
----------------------------------------------------------------------
sage -t --warn-long 105.2 --random-seed=65107005796673777637867553513561507930 src/sage/geometry/polyhedron/backend_polymake.py  # 1 doctest failed
```

there is a similar test failure in `src/sage/geometry/polyhedron/base.py`



---

archive/issue_events_434649.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-10-22T09:00:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434649"
}
```



---

archive/issue_events_434650.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-10-22T09:00:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434650"
}
```



---

archive/issue_comments_506437.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nWe see that tests mentioned in [comment:54](#comment:54) were not complete, as `polymake` was not in `--optional=` - if it were, we'd see many more tests (this is on Arch, again):\n\n```\n$ ./sage -tp --optional=arch,argcomplete,build,dochtml,pip,sage,sage.rings.real_double,sage_spkg,polymake src/sage/interfaces/polymake.py                 \nRunning doctests with ID 2021-10-22-08-58-24-8cc8a0d8.\nGit branch: wip\nUsing --optional=arch,argcomplete,build,dochtml,pip,polymake,sage,sage.rings.real_double,sage_spkg\nDoctesting 1 file using 4 threads.\nsage -t --warn-long 105.2 --random-seed=106731483408083137921384584724619392983 src/sage/interfaces/polymake.py\n    [253 tests, 5.28 s]\n----------------------------------------------------------------------\nAll tests passed!\n```",
    "created_at": "2021-10-22T09:00:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506437",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:57" align="right">comment:57</div>

We see that tests mentioned in [comment:54](#comment:54) were not complete, as `polymake` was not in `--optional=` - if it were, we'd see many more tests (this is on Arch, again):

```
$ ./sage -tp --optional=arch,argcomplete,build,dochtml,pip,sage,sage.rings.real_double,sage_spkg,polymake src/sage/interfaces/polymake.py                 
Running doctests with ID 2021-10-22-08-58-24-8cc8a0d8.
Git branch: wip
Using --optional=arch,argcomplete,build,dochtml,pip,polymake,sage,sage.rings.real_double,sage_spkg
Doctesting 1 file using 4 threads.
sage -t --warn-long 105.2 --random-seed=106731483408083137921384584724619392983 src/sage/interfaces/polymake.py
    [253 tests, 5.28 s]
----------------------------------------------------------------------
All tests passed!
```



---

archive/issue_comments_506438.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\n`jupymake` should be in `build/pkgs/polymake/dependencies`, as `polymake` tests fail if it's not installed.\n\nAs well, `spkg-configure.m4` perhaps needs to at least print a warning if system's polymake it selected, or, better, use some (missing?) mechanism to trigger installation of `jupymake` in this case.",
    "created_at": "2021-10-22T09:15:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506438",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:58" align="right">comment:58</div>

`jupymake` should be in `build/pkgs/polymake/dependencies`, as `polymake` tests fail if it's not installed.

As well, `spkg-configure.m4` perhaps needs to at least print a warning if system's polymake it selected, or, better, use some (missing?) mechanism to trigger installation of `jupymake` in this case.



---

archive/issue_comments_506439.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nReplying to [@dimpase](#comment:57):\n> we'd see many more tests (this is on Arch, again):\n>     [253 tests, 5.28 s]\n\nyes, with that long `--optional=` I see all 253 tests passed too (on Gentoo)",
    "created_at": "2021-10-22T11:24:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506439",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:59" align="right">comment:59</div>

Replying to [@dimpase](#comment:57):
> we'd see many more tests (this is on Arch, again):
>     [253 tests, 5.28 s]

yes, with that long `--optional=` I see all 253 tests passed too (on Gentoo)



---

archive/issue_comments_506440.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nReplying to [@dimpase](#comment:58):\n> `jupymake` should be in `build/pkgs/polymake/dependencies`, as `polymake` tests fail if it's not installed.\n\nNo, this makes no sense. `jupymake` depends (at compile time) on `polymake`.",
    "created_at": "2021-10-22T15:15:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506440",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:60" align="right">comment:60</div>

Replying to [@dimpase](#comment:58):
> `jupymake` should be in `build/pkgs/polymake/dependencies`, as `polymake` tests fail if it's not installed.

No, this makes no sense. `jupymake` depends (at compile time) on `polymake`.



---

archive/issue_comments_506441.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nReplying to [@dimpase](#comment:58):\n>  use some (missing?) mechanism to trigger installation of `jupymake` in this case.\n\nThis is a valid wishlist item.",
    "created_at": "2021-10-22T15:16:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506441",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:61" align="right">comment:61</div>

Replying to [@dimpase](#comment:58):
>  use some (missing?) mechanism to trigger installation of `jupymake` in this case.

This is a valid wishlist item.



---

archive/issue_comments_506442.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nthen tag jupymake-dependent tests as such.",
    "created_at": "2021-10-22T16:45:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506442",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:62" align="right">comment:62</div>

then tag jupymake-dependent tests as such.



---

archive/issue_comments_506443.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nThe failure in [comment:56](#comment:56), \n\n```\n   TypeError: C++/perl Interface module compilation failed; most likely due to a type mismatch.\n    Set the variable $Polymake::User::Verbose::cpp to a positive value and repeat for more details.\n```\nhas got nothing to do with jupymake vs. the polymake pexpect interface.\n\nLooks to me like a packaging bug in arch.",
    "created_at": "2021-10-22T17:14:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506443",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:63" align="right">comment:63</div>

The failure in [comment:56](#comment:56), 

```
   TypeError: C++/perl Interface module compilation failed; most likely due to a type mismatch.
    Set the variable $Polymake::User::Verbose::cpp to a positive value and repeat for more details.
```
has got nothing to do with jupymake vs. the polymake pexpect interface.

Looks to me like a packaging bug in arch.



---

archive/issue_comments_506444.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nReplying to [@mkoeppe](#comment:61):\n> Replying to [@dimpase](#comment:58):\n> >  use some (missing?) mechanism to trigger installation of `jupymake` in this case.\n\n> \n> This is a valid wishlist item.\n\nI have opened #32741 for this.",
    "created_at": "2021-10-22T17:52:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506444",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:64" align="right">comment:64</div>

Replying to [@mkoeppe](#comment:61):
> Replying to [@dimpase](#comment:58):
> >  use some (missing?) mechanism to trigger installation of `jupymake` in this case.

> 
> This is a valid wishlist item.

I have opened #32741 for this.



---

archive/issue_comments_506445.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nReplying to [@dimpase](#comment:41):\n> gentoo's polymake is too old atm, it's 3.0_p2 there (and broken).\n\nI've just updated it to polymake-4.5. Send bug reports if it's still broken.",
    "created_at": "2021-10-23T01:08:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506445",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:65" align="right">comment:65</div>

Replying to [@dimpase](#comment:41):
> gentoo's polymake is too old atm, it's 3.0_p2 there (and broken).

I've just updated it to polymake-4.5. Send bug reports if it's still broken.



---

archive/issue_events_434651.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-23T01:27:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434651"
}
```



---

archive/issue_events_434652.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-23T01:27:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434652"
}
```



---

archive/issue_comments_506446.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nReplying to [@mkoeppe](#comment:64):\n> Replying to [@mkoeppe](#comment:61):\n> > Replying to [@dimpase](#comment:58):\n> > >  use some (missing?) mechanism to trigger installation of `jupymake` in this case.\n\n> > \n> > This is a valid wishlist item.\n\n> \n> I have opened #32741 for this.\n\nI explained there to how to fix this in this particular case - with jupymake getting spkg-configure.m4",
    "created_at": "2021-10-23T09:20:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506446",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:67" align="right">comment:67</div>

Replying to [@mkoeppe](#comment:64):
> Replying to [@mkoeppe](#comment:61):
> > Replying to [@dimpase](#comment:58):
> > >  use some (missing?) mechanism to trigger installation of `jupymake` in this case.

> > 
> > This is a valid wishlist item.

> 
> I have opened #32741 for this.

I explained there to how to fix this in this particular case - with jupymake getting spkg-configure.m4



---

archive/issue_comments_506447.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nI hope #32741 is not preventing this ticket to get positive review. I mean all 253 tests passed on several systems.",
    "created_at": "2021-10-23T09:32:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506447",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:68" align="right">comment:68</div>

I hope #32741 is not preventing this ticket to get positive review. I mean all 253 tests passed on several systems.



---

archive/issue_comments_506448.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nwell, the reason for not giving it a positive review are doctests failing due to accidentally not having jupymake installed, which is not forced now.",
    "created_at": "2021-10-23T09:35:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506448",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:69" align="right">comment:69</div>

well, the reason for not giving it a positive review are doctests failing due to accidentally not having jupymake installed, which is not forced now.



---

archive/issue_comments_506449.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nDima, [comment:63](#comment:63) -- since you tested on arch, could you please investigate the failure mode?  These doctests are NOT dependent on jupymake.",
    "created_at": "2021-10-23T14:58:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506449",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:70" align="right">comment:70</div>

Dima, [comment:63](#comment:63) -- since you tested on arch, could you please investigate the failure mode?  These doctests are NOT dependent on jupymake.



---

archive/issue_comments_506450.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nLet's move this forward please",
    "created_at": "2021-10-31T21:36:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506450",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:71" align="right">comment:71</div>

Let's move this forward please



---

archive/issue_comments_506451.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nReplying to [@orlitzky](#comment:65):\n> Replying to [@dimpase](#comment:41):\n> > gentoo's polymake is too old atm, it's 3.0_p2 there (and broken).\n\n> \n> I've just updated it to polymake-4.5. Send bug reports if it's still broken.\n\n\n```\n# emerge --ask polymake\n\nThese are the packages that would be merged, in order:\n\nCalculating dependencies -\n\n!!! Problem resolving dependencies for sci-mathematics/polymake             ... done!\n\n!!! The ebuild selected to satisfy \"polymake\" has unmet requirements.\n- sci-mathematics/polymake-4.5::gentoo USE=\"cdd flint normaliz -bliss -libpolymake -lrs -nauty -ppl -singular\"\n\n  The following REQUIRED_USE flag constraints are unsatisfied:\n    exactly-one-of ( bliss nauty )\n\n```",
    "created_at": "2021-10-31T21:59:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506451",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:72" align="right">comment:72</div>

Replying to [@orlitzky](#comment:65):
> Replying to [@dimpase](#comment:41):
> > gentoo's polymake is too old atm, it's 3.0_p2 there (and broken).

> 
> I've just updated it to polymake-4.5. Send bug reports if it's still broken.


```
# emerge --ask polymake

These are the packages that would be merged, in order:

Calculating dependencies -

!!! Problem resolving dependencies for sci-mathematics/polymake             ... done!

!!! The ebuild selected to satisfy "polymake" has unmet requirements.
- sci-mathematics/polymake-4.5::gentoo USE="cdd flint normaliz -bliss -libpolymake -lrs -nauty -ppl -singular"

  The following REQUIRED_USE flag constraints are unsatisfied:
    exactly-one-of ( bliss nauty )

```



---

archive/issue_comments_506452.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nReplying to [@mkoeppe](#comment:71):\n> Let's move this forward please\n\nsorry, my arch lxc vm is gone (I guess I forgot to make it persistent?). Let me try \"native\" Gentoo instead.",
    "created_at": "2021-10-31T22:06:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506452",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:73" align="right">comment:73</div>

Replying to [@mkoeppe](#comment:71):
> Let's move this forward please

sorry, my arch lxc vm is gone (I guess I forgot to make it persistent?). Let me try "native" Gentoo instead.



---

archive/issue_comments_506453.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\nTime to work on #29283 (tox.ini: Add test environments using LXC)",
    "created_at": "2021-10-31T22:11:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506453",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:74" align="right">comment:74</div>

Time to work on #29283 (tox.ini: Add test environments using LXC)



---

archive/issue_comments_506454.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nReplying to [@dimpase](#comment:72):\n> Replying to [@orlitzky](#comment:65):\n> > Replying to [@dimpase](#comment:41):\n> > > gentoo's polymake is too old atm, it's 3.0_p2 there (and broken).\n\n> > \n> > I've just updated it to polymake-4.5. Send bug reports if it's still broken.\n\n```\nUSE=\"cdd flint normaliz libpolymake lrs nauty ppl singular\" emerge --ask polymake\n```\ndoesn't work, there is a problem with `lrs` (and Sage installs `polymake` with `lrs`)\nApparently, it's known to Sage, as `spkg-install.in` has a comment:\n\n```\n# Since polymake v3.4, it does not find our lrs installation if we do not provide --with-lrs explicitly.\n```\n\nOnce this is fixed in Gentoo (sorry, I don't grok its ebuilds), `distros/gentoo.txt` should be provided (with appropriate `[..]` options?).",
    "created_at": "2021-10-31T22:35:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506454",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:75" align="right">comment:75</div>

Replying to [@dimpase](#comment:72):
> Replying to [@orlitzky](#comment:65):
> > Replying to [@dimpase](#comment:41):
> > > gentoo's polymake is too old atm, it's 3.0_p2 there (and broken).

> > 
> > I've just updated it to polymake-4.5. Send bug reports if it's still broken.

```
USE="cdd flint normaliz libpolymake lrs nauty ppl singular" emerge --ask polymake
```
doesn't work, there is a problem with `lrs` (and Sage installs `polymake` with `lrs`)
Apparently, it's known to Sage, as `spkg-install.in` has a comment:

```
# Since polymake v3.4, it does not find our lrs installation if we do not provide --with-lrs explicitly.
```

Once this is fixed in Gentoo (sorry, I don't grok its ebuilds), `distros/gentoo.txt` should be provided (with appropriate `[..]` options?).



---

archive/issue_comments_506455.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nReplying to [@dimpase](#comment:72):\n> \n> ```\n> \n>   The following REQUIRED_USE flag constraints are unsatisfied:\n>     exactly-one-of ( bliss nauty )\n> \n> ```\n\nYou have to set `USE=bliss` or `USE=nauty`, but not both, to pick a backend for graph automorphism computations.",
    "created_at": "2021-10-31T22:55:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506455",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:76" align="right">comment:76</div>

Replying to [@dimpase](#comment:72):
> 
> ```
> 
>   The following REQUIRED_USE flag constraints are unsatisfied:
>     exactly-one-of ( bliss nauty )
> 
> ```

You have to set `USE=bliss` or `USE=nauty`, but not both, to pick a backend for graph automorphism computations.



---

archive/issue_comments_506456.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nReplying to [@orlitzky](#comment:76):\n> Replying to [@dimpase](#comment:72):\n> > \n> > ```\n> > \n> >   The following REQUIRED_USE flag constraints are unsatisfied:\n> >     exactly-one-of ( bliss nauty )\n> > \n> > ```\n\n> \n> You have to set `USE=bliss` or `USE=nauty`, but not both, to pick a backend for graph automorphism computations.\n\nsure, but the default `USE` flags shouldn't fail! As well, how about `lrs`?",
    "created_at": "2021-10-31T22:59:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506456",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:77" align="right">comment:77</div>

Replying to [@orlitzky](#comment:76):
> Replying to [@dimpase](#comment:72):
> > 
> > ```
> > 
> >   The following REQUIRED_USE flag constraints are unsatisfied:
> >     exactly-one-of ( bliss nauty )
> > 
> > ```

> 
> You have to set `USE=bliss` or `USE=nauty`, but not both, to pick a backend for graph automorphism computations.

sure, but the default `USE` flags shouldn't fail! As well, how about `lrs`?



---

archive/issue_comments_506457.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nReplying to [@dimpase](#comment:77):\n> \n> sure, but the default `USE` flags shouldn't fail! As well, how about `lrs`?\n\nThey don't \"fail,\" portage tells you to pick one because you have to pick one =P\n\nIf one is a significantly better choice than the other, we would normally enable that one by default, but I don't know enough about polymake to say that either is better.\n\nWhat's wrong with lrs?",
    "created_at": "2021-10-31T23:07:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506457",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:78" align="right">comment:78</div>

Replying to [@dimpase](#comment:77):
> 
> sure, but the default `USE` flags shouldn't fail! As well, how about `lrs`?

They don't "fail," portage tells you to pick one because you have to pick one =P

If one is a significantly better choice than the other, we would normally enable that one by default, but I don't know enough about polymake to say that either is better.

What's wrong with lrs?



---

archive/issue_comments_506458.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">comment:79</div>\n\n\n```\nUSE=\"cdd flint normaliz libpolymake lrs nauty ppl singular\" emerge --ask polymake\n\nThese are the packages that would be merged, in order:\n\nCalculating dependencies... done!\n[ebuild   R    ] sci-mathematics/polymake-4.5  USE=\"lrs*\" \n\nWould you like to merge these packages? [Yes/No] \n\n>>> Verifying ebuild manifests\n\n>>> Emerging (1 of 1) sci-mathematics/polymake-4.5::gentoo\n * polymake-4.5-minimal.tar.bz2 BLAKE2B SHA512 size ;-) ...            [ ok ]\n>>> Unpacking source...\n>>> Unpacking polymake-4.5-minimal.tar.bz2 to /var/tmp/portage/sci-mathematics/polymake-4.5/work\n>>> Source unpacked in /var/tmp/portage/sci-mathematics/polymake-4.5/work\n>>> Preparing source in /var/tmp/portage/sci-mathematics/polymake-4.5/work/polymake-4.5 ...\n>>> Source prepared.\n>>> Configuring source in /var/tmp/portage/sci-mathematics/polymake-4.5/work/polymake-4.5 ...\nchecking C++ compiler ... ok (x86_64-pc-linux-gnu-g++ is GCC 8.3.1)\nchecking C++ library ... ok (GNU libstdc++ 20190518, C++ 201402)\ndetermining architecture ... ok (x86_64)\ndetermining compiler flags ... ok\n   CFLAGS=-march=native -O3 -fomit-frame-pointer -pipe\n   CXXFLAGS=-march=native -O3 -fomit-frame-pointer -pipe -std=c++14 -ftemplate-depth-200 -fno-strict-aliasing -fopenmp -Wshadow -Wlogical-op -Wconversion -Wzero-as-null-pointer-constant -Wno-parentheses -Wno-error=unused-function\n   LDFLAGS=-Wl,-O1 -Wl,--as-needed -fuse-ld=gold -fopenmp\nchecking gmp installation ... ok\nchecking mpfr installation ... ok\nchecking boost installation ... ok\nchecking perl module XML::SAX ... ok\nchecking perl module Term::ReadKey ... ok\nchecking perl module Term::ReadLine ... ok\nchecking perl module JSON ... ok\nchecking shared perl library ... ok\n\nConfiguring bundled extensions:\nbundled extension java ... disabled by command-line\nbundled extension javaview ... disabled by command-line\nbundled extension scip ... disabled by command-line\nbundled extension soplex ... disabled by command-line\nbundled extension bliss ... disabled by command-line\nbundled extension cdd ... ok (0.94m @ /usr)\nbundled extension flint ... ok (ok (2.7.1 @ /usr))\nbundled extension libnormaliz ... ok (3.8.1 @ /usr)\nbundled extension lrs ... failed\n\nERROR:\nThe bundled extension lrs was explicitly requested but failed to configure.\nPlease recheck your argument (--with-lrs=/usr) and build/bundled.log .\nYou can also disable it by specifying --without-lrs instead.\n * ERROR: sci-mathematics/polymake-4.5::gentoo failed (configure phase):\n *   (no error message)\n * \n * Call stack:\n *     ebuild.sh, line 127:  Called src_configure\n *   environment, line 1598:  Called die\n * The specific snippet of code:\n *       ./configure --prefix=\"${EPREFIX}/usr\" --libdir=\"${EPREFIX}/usr/$(get_libdir)\" --libexecdir=\"${EPREFIX}/usr/$(get_libdir)/polymake\" $(usev !libpolymake \"--without-callable\") --without-java --without-javaview --without-native --without-scip --without-soplex $(use_with bliss bliss \"${EPREFIX}/usr\") $(use_with cdd cdd \"${EPREFIX}/usr\") $(use_with flint flint \"${EPREFIX}/usr\") $(use_with lrs lrs \"${EPREFIX}/usr\") $(use_with nauty nauty \"${EPREFIX}/usr\") $(use_with normaliz libnormaliz \"${EPREFIX}/usr\") $(use_with ppl ppl \"${EPREFIX}/usr\") $(use_with singular singular \"${EPREFIX}/usr\") || die\n * \n * If you need support, post the output of `emerge --info '=sci-mathematics/polymake-4.5::gentoo'`,\n * the complete build log and the output of `emerge -pqv '=sci-mathematics/polymake-4.5::gentoo'`.\n * The complete build log is located at '/var/tmp/portage/sci-mathematics/polymake-4.5/temp/build.log'.\n * The ebuild environment file is located at '/var/tmp/portage/sci-mathematics/polymake-4.5/temp/environment'.\n * Working directory: '/var/tmp/portage/sci-mathematics/polymake-4.5/work/polymake-4.5'\n * S: '/var/tmp/portage/sci-mathematics/polymake-4.5/work/polymake-4.5'\n\n>>> Failed to emerge sci-mathematics/polymake-4.5, Log file:\n\n>>>  '/var/tmp/portage/sci-mathematics/polymake-4.5/temp/build.log'\n\n * Messages for package sci-mathematics/polymake-4.5:\n\n * ERROR: sci-mathematics/polymake-4.5::gentoo failed (configure phase):\n *   (no error message)\n * \n * Call stack:\n *     ebuild.sh, line 127:  Called src_configure\n *   environment, line 1598:  Called die\n * The specific snippet of code:\n *       ./configure --prefix=\"${EPREFIX}/usr\" --libdir=\"${EPREFIX}/usr/$(get_libdir)\" --libexecdir=\"${EPREFIX}/usr/$(get_libdir)/polymake\" $(usev !libpolymake \"--without-callable\") --without-java --without-javaview --without-native --without-scip --without-soplex $(use_with bliss bliss \"${EPREFIX}/usr\") $(use_with cdd cdd \"${EPREFIX}/usr\") $(use_with flint flint \"${EPREFIX}/usr\") $(use_with lrs lrs \"${EPREFIX}/usr\") $(use_with nauty nauty \"${EPREFIX}/usr\") $(use_with normaliz libnormaliz \"${EPREFIX}/usr\") $(use_with ppl ppl \"${EPREFIX}/usr\") $(use_with singular singular \"${EPREFIX}/usr\") || die\n * \n * If you need support, post the output of `emerge --info '=sci-mathematics/polymake-4.5::gentoo'`,\n * the complete build log and the output of `emerge -pqv '=sci-mathematics/polymake-4.5::gentoo'`.\n * The complete build log is located at '/var/tmp/portage/sci-mathematics/polymake-4.5/temp/build.log'.\n * The ebuild environment file is located at '/var/tmp/portage/sci-mathematics/polymake-4.5/temp/environment'.\n * Working directory: '/var/tmp/portage/sci-mathematics/polymake-4.5/work/polymake-4.5'\n * S: '/var/tmp/portage/sci-mathematics/polymake-4.5/work/polymake-4.5'\nhilbert /tmp # \n\n```\n\nI guess one needs to do what's done in `spkg-install` to pass the `lrs` prefix more explicitly.",
    "created_at": "2021-10-31T23:39:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506458",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:79" align="right">comment:79</div>


```
USE="cdd flint normaliz libpolymake lrs nauty ppl singular" emerge --ask polymake

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R    ] sci-mathematics/polymake-4.5  USE="lrs*" 

Would you like to merge these packages? [Yes/No] 

>>> Verifying ebuild manifests

>>> Emerging (1 of 1) sci-mathematics/polymake-4.5::gentoo
 * polymake-4.5-minimal.tar.bz2 BLAKE2B SHA512 size ;-) ...            [ ok ]
>>> Unpacking source...
>>> Unpacking polymake-4.5-minimal.tar.bz2 to /var/tmp/portage/sci-mathematics/polymake-4.5/work
>>> Source unpacked in /var/tmp/portage/sci-mathematics/polymake-4.5/work
>>> Preparing source in /var/tmp/portage/sci-mathematics/polymake-4.5/work/polymake-4.5 ...
>>> Source prepared.
>>> Configuring source in /var/tmp/portage/sci-mathematics/polymake-4.5/work/polymake-4.5 ...
checking C++ compiler ... ok (x86_64-pc-linux-gnu-g++ is GCC 8.3.1)
checking C++ library ... ok (GNU libstdc++ 20190518, C++ 201402)
determining architecture ... ok (x86_64)
determining compiler flags ... ok
   CFLAGS=-march=native -O3 -fomit-frame-pointer -pipe
   CXXFLAGS=-march=native -O3 -fomit-frame-pointer -pipe -std=c++14 -ftemplate-depth-200 -fno-strict-aliasing -fopenmp -Wshadow -Wlogical-op -Wconversion -Wzero-as-null-pointer-constant -Wno-parentheses -Wno-error=unused-function
   LDFLAGS=-Wl,-O1 -Wl,--as-needed -fuse-ld=gold -fopenmp
checking gmp installation ... ok
checking mpfr installation ... ok
checking boost installation ... ok
checking perl module XML::SAX ... ok
checking perl module Term::ReadKey ... ok
checking perl module Term::ReadLine ... ok
checking perl module JSON ... ok
checking shared perl library ... ok

Configuring bundled extensions:
bundled extension java ... disabled by command-line
bundled extension javaview ... disabled by command-line
bundled extension scip ... disabled by command-line
bundled extension soplex ... disabled by command-line
bundled extension bliss ... disabled by command-line
bundled extension cdd ... ok (0.94m @ /usr)
bundled extension flint ... ok (ok (2.7.1 @ /usr))
bundled extension libnormaliz ... ok (3.8.1 @ /usr)
bundled extension lrs ... failed

ERROR:
The bundled extension lrs was explicitly requested but failed to configure.
Please recheck your argument (--with-lrs=/usr) and build/bundled.log .
You can also disable it by specifying --without-lrs instead.
 * ERROR: sci-mathematics/polymake-4.5::gentoo failed (configure phase):
 *   (no error message)
 * 
 * Call stack:
 *     ebuild.sh, line 127:  Called src_configure
 *   environment, line 1598:  Called die
 * The specific snippet of code:
 *       ./configure --prefix="${EPREFIX}/usr" --libdir="${EPREFIX}/usr/$(get_libdir)" --libexecdir="${EPREFIX}/usr/$(get_libdir)/polymake" $(usev !libpolymake "--without-callable") --without-java --without-javaview --without-native --without-scip --without-soplex $(use_with bliss bliss "${EPREFIX}/usr") $(use_with cdd cdd "${EPREFIX}/usr") $(use_with flint flint "${EPREFIX}/usr") $(use_with lrs lrs "${EPREFIX}/usr") $(use_with nauty nauty "${EPREFIX}/usr") $(use_with normaliz libnormaliz "${EPREFIX}/usr") $(use_with ppl ppl "${EPREFIX}/usr") $(use_with singular singular "${EPREFIX}/usr") || die
 * 
 * If you need support, post the output of `emerge --info '=sci-mathematics/polymake-4.5::gentoo'`,
 * the complete build log and the output of `emerge -pqv '=sci-mathematics/polymake-4.5::gentoo'`.
 * The complete build log is located at '/var/tmp/portage/sci-mathematics/polymake-4.5/temp/build.log'.
 * The ebuild environment file is located at '/var/tmp/portage/sci-mathematics/polymake-4.5/temp/environment'.
 * Working directory: '/var/tmp/portage/sci-mathematics/polymake-4.5/work/polymake-4.5'
 * S: '/var/tmp/portage/sci-mathematics/polymake-4.5/work/polymake-4.5'

>>> Failed to emerge sci-mathematics/polymake-4.5, Log file:

>>>  '/var/tmp/portage/sci-mathematics/polymake-4.5/temp/build.log'

 * Messages for package sci-mathematics/polymake-4.5:

 * ERROR: sci-mathematics/polymake-4.5::gentoo failed (configure phase):
 *   (no error message)
 * 
 * Call stack:
 *     ebuild.sh, line 127:  Called src_configure
 *   environment, line 1598:  Called die
 * The specific snippet of code:
 *       ./configure --prefix="${EPREFIX}/usr" --libdir="${EPREFIX}/usr/$(get_libdir)" --libexecdir="${EPREFIX}/usr/$(get_libdir)/polymake" $(usev !libpolymake "--without-callable") --without-java --without-javaview --without-native --without-scip --without-soplex $(use_with bliss bliss "${EPREFIX}/usr") $(use_with cdd cdd "${EPREFIX}/usr") $(use_with flint flint "${EPREFIX}/usr") $(use_with lrs lrs "${EPREFIX}/usr") $(use_with nauty nauty "${EPREFIX}/usr") $(use_with normaliz libnormaliz "${EPREFIX}/usr") $(use_with ppl ppl "${EPREFIX}/usr") $(use_with singular singular "${EPREFIX}/usr") || die
 * 
 * If you need support, post the output of `emerge --info '=sci-mathematics/polymake-4.5::gentoo'`,
 * the complete build log and the output of `emerge -pqv '=sci-mathematics/polymake-4.5::gentoo'`.
 * The complete build log is located at '/var/tmp/portage/sci-mathematics/polymake-4.5/temp/build.log'.
 * The ebuild environment file is located at '/var/tmp/portage/sci-mathematics/polymake-4.5/temp/environment'.
 * Working directory: '/var/tmp/portage/sci-mathematics/polymake-4.5/work/polymake-4.5'
 * S: '/var/tmp/portage/sci-mathematics/polymake-4.5/work/polymake-4.5'
hilbert /tmp # 

```

I guess one needs to do what's done in `spkg-install` to pass the `lrs` prefix more explicitly.



---

archive/issue_comments_506459.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\n> I guess one needs to do what's done in spkg-install to pass the lrs prefix more explicitly. \n\nYou may need to upgrade to lrslib-071b or lrslib-071b-r1. Those versions (I added them to the tree along with polymake-4.5) fix a critical bug in v071. I don't know if v062 works because it doesn't even build anymore. Comically, we can't remove it though because it's \"stable\" and no one has stabilized v071b on x86 yet.",
    "created_at": "2021-11-01T00:07:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506459",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:80" align="right">comment:80</div>

> I guess one needs to do what's done in spkg-install to pass the lrs prefix more explicitly. 

You may need to upgrade to lrslib-071b or lrslib-071b-r1. Those versions (I added them to the tree along with polymake-4.5) fix a critical bug in v071. I don't know if v062 works because it doesn't even build anymore. Comically, we can't remove it though because it's "stable" and no one has stabilized v071b on x86 yet.



---

archive/issue_comments_506460.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\nReplying to [@orlitzky](#comment:80):\n> > I guess one needs to do what's done in spkg-install to pass the lrs prefix more explicitly. \n\n> \n> You may need to upgrade to lrslib-071b or lrslib-071b-r1. Those versions (I added them to the tree along with polymake-4.5) fix a critical bug in v071. I don't know if v062 works because it doesn't even build anymore. Comically, we can't remove it though because it's \"stable\" and no one has stabilized v071b on x86 yet.\n\nThis does not take away the problem that polymake's configure fails, I cannot imagine it's due to lrs's version.",
    "created_at": "2021-11-01T09:07:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506460",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:81" align="right">comment:81</div>

Replying to [@orlitzky](#comment:80):
> > I guess one needs to do what's done in spkg-install to pass the lrs prefix more explicitly. 

> 
> You may need to upgrade to lrslib-071b or lrslib-071b-r1. Those versions (I added them to the tree along with polymake-4.5) fix a critical bug in v071. I don't know if v062 works because it doesn't even build anymore. Comically, we can't remove it though because it's "stable" and no one has stabilized v071b on x86 yet.

This does not take away the problem that polymake's configure fails, I cannot imagine it's due to lrs's version.



---

archive/issue_comments_506461.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">comment:82</div>\n\nOops, I take it back - lrslib-071b-r1 allows configure to pass.\n\nI don't know whether Gentoo has such a flexibility in configurations, but ideally it should refuse to even start building with an old lrs version.",
    "created_at": "2021-11-01T09:10:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506461",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:82" align="right">comment:82</div>

Oops, I take it back - lrslib-071b-r1 allows configure to pass.

I don't know whether Gentoo has such a flexibility in configurations, but ideally it should refuse to even start building with an old lrs version.



---

archive/issue_comments_506462.json:
```json
{
    "body": "<div id=\"comment:83\" align=\"right\">comment:83</div>\n\nbut I still have bad news, in Gentoo case in particular, but also\nin general. Perl's MongoDB module is at EOL.\n\n```\n# emerge dev-perl/MongoDB\nCalculating dependencies... done!\n\n!!! All ebuilds that could satisfy \"dev-perl/MongoDB\" have been masked.\n!!! One of the following masked packages is required to complete your request:\n- dev-perl/MongoDB-1.8.0::gentoo (masked by: package.mask)\n/usr/portage/profiles/package.mask:\n# Sam James <sam@gentoo.org> (2021-10-25)\n# Fails to build with glibc-2.30(!) and was abandoned upstream\n# a few years ago. No reverse dependencies in tree.\n# bug #728556. Removal on 2021-11-25.\n\n\nFor more information, see the MASKED PACKAGES section in the emerge\nman page or refer to the Gentoo Handbook.\n```\nhttps://packages.gentoo.org/packages/dev-perl/MongoDB mentions version 2.2.2, and\nhttps://metacpan.org/dist/MongoDB says\n\n```\n Changes for version v2.2.2 - 2020-08-13\n\n    !!! END OF LIFE NOTICE !!!\n        As of August 13, 2020, the MongoDB Perl driver has reached end of life and is no longer supported by MongoDB.\n\n```",
    "created_at": "2021-11-01T13:56:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506462",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:83" align="right">comment:83</div>

but I still have bad news, in Gentoo case in particular, but also
in general. Perl's MongoDB module is at EOL.

```
# emerge dev-perl/MongoDB
Calculating dependencies... done!

!!! All ebuilds that could satisfy "dev-perl/MongoDB" have been masked.
!!! One of the following masked packages is required to complete your request:
- dev-perl/MongoDB-1.8.0::gentoo (masked by: package.mask)
/usr/portage/profiles/package.mask:
# Sam James <sam@gentoo.org> (2021-10-25)
# Fails to build with glibc-2.30(!) and was abandoned upstream
# a few years ago. No reverse dependencies in tree.
# bug #728556. Removal on 2021-11-25.


For more information, see the MASKED PACKAGES section in the emerge
man page or refer to the Gentoo Handbook.
```
https://packages.gentoo.org/packages/dev-perl/MongoDB mentions version 2.2.2, and
https://metacpan.org/dist/MongoDB says

```
 Changes for version v2.2.2 - 2020-08-13

    !!! END OF LIFE NOTICE !!!
        As of August 13, 2020, the MongoDB Perl driver has reached end of life and is no longer supported by MongoDB.

```



---

archive/issue_comments_506463.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">comment:84</div>\n\nShouldn't `perl_cpan_polymake_prereq` (and other deps?) be in `SAGE_SPKG_DEPCHECK` for polymake?",
    "created_at": "2021-11-01T14:01:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506463",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:84" align="right">comment:84</div>

Shouldn't `perl_cpan_polymake_prereq` (and other deps?) be in `SAGE_SPKG_DEPCHECK` for polymake?



---

archive/issue_comments_506464.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">comment:85</div>\n\nMongoDB cannot deprive this ticket of positive review",
    "created_at": "2021-11-01T14:32:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506464",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:85" align="right">comment:85</div>

MongoDB cannot deprive this ticket of positive review



---

archive/issue_comments_506465.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">comment:86</div>\n\nWe should check that `polymake` is working, not only `polymake-config`.\n(As some Perl deps might be broken - e.g. I ran into\n\n```\n$ polymake\nWelcome to polymake version 4.5\nCopyright (c) 1997-2021\nEwgenij Gawrilow, Michael Joswig, and the polymake team\nTechnische Universit\u00e4t Berlin, Germany\nhttps://polymake.org\n\nThis is free software licensed under GPL; see the source for copying conditions.\nThere is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\nLoading applications now...polymake:  ERROR: \"/usr/share/polymake/apps/common/perllib/PolyDB.pm\", line 23: Can't locate MongoDB.pm in @INC (you may need to install the MongoDB module) (@INC contains: Polymake::Core::Application=ARRAY(0x5589c39eea50) /usr/share/polymake/perllib /usr/lib64/polymake/perlx/5.34.0/x86_64-linux-thread-multi /usr/lib64/polymake/perlx/5.34.0 /usr/lib64/polymake/perlx /etc/perl /usr/local/lib64/perl5/5.34/x86_64-linux-thread-multi /usr/local/lib64/perl5/5.34 /usr/lib64/perl5/vendor_perl/5.34/x86_64-linux-thread-multi /usr/lib64/perl5/vendor_perl/5.34 /usr/lib64/perl5/5.34/x86_64-linux-thread-multi /usr/lib64/perl5/5.34 /usr/lib64/perl5/5.32 /usr/lib64/perl5/vendor_perl/5.32 /usr/lib64/perl5/vendor_perl/5.30.3 /usr/lib64/perl5/vendor_perl/5.30.0)\n```",
    "created_at": "2021-11-01T14:35:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506465",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:86" align="right">comment:86</div>

We should check that `polymake` is working, not only `polymake-config`.
(As some Perl deps might be broken - e.g. I ran into

```
$ polymake
Welcome to polymake version 4.5
Copyright (c) 1997-2021
Ewgenij Gawrilow, Michael Joswig, and the polymake team
Technische Universität Berlin, Germany
https://polymake.org

This is free software licensed under GPL; see the source for copying conditions.
There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

Loading applications now...polymake:  ERROR: "/usr/share/polymake/apps/common/perllib/PolyDB.pm", line 23: Can't locate MongoDB.pm in @INC (you may need to install the MongoDB module) (@INC contains: Polymake::Core::Application=ARRAY(0x5589c39eea50) /usr/share/polymake/perllib /usr/lib64/polymake/perlx/5.34.0/x86_64-linux-thread-multi /usr/lib64/polymake/perlx/5.34.0 /usr/lib64/polymake/perlx /etc/perl /usr/local/lib64/perl5/5.34/x86_64-linux-thread-multi /usr/local/lib64/perl5/5.34 /usr/lib64/perl5/vendor_perl/5.34/x86_64-linux-thread-multi /usr/lib64/perl5/vendor_perl/5.34 /usr/lib64/perl5/5.34/x86_64-linux-thread-multi /usr/lib64/perl5/5.34 /usr/lib64/perl5/5.32 /usr/lib64/perl5/vendor_perl/5.32 /usr/lib64/perl5/vendor_perl/5.30.3 /usr/lib64/perl5/vendor_perl/5.30.0)
```



---

archive/issue_comments_506466.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nI was able to install the missing perl module on Gentoo by doing as root\n\n```\n# emerge App-cpanminus\n# cpanm MongoDB\n```\n\nthis needs another ticket.",
    "created_at": "2021-11-01T14:38:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506466",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:87" align="right">comment:87</div>

I was able to install the missing perl module on Gentoo by doing as root

```
# emerge App-cpanminus
# cpanm MongoDB
```

this needs another ticket.



---

archive/issue_comments_506467.json:
```json
{
    "body": "<div id=\"comment:88\" align=\"right\">comment:88</div>\n\nPlease see #32808 for Perl MongoDB package/spkg issues.",
    "created_at": "2021-11-01T14:54:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506467",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:88" align="right">comment:88</div>

Please see #32808 for Perl MongoDB package/spkg issues.



---

archive/issue_comments_506468.json:
```json
{
    "body": "Work Issues: **clarify Perl deps in spkg-configure.m4 (and elsewhere)**",
    "created_at": "2021-11-01T14:55:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506468",
    "user": "https://github.com/dimpase"
}
```

Work Issues: **clarify Perl deps in spkg-configure.m4 (and elsewhere)**



---

archive/issue_events_434653.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-01T14:55:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434653"
}
```



---

archive/issue_events_434654.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-01T14:55:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434654"
}
```



---

archive/issue_comments_506469.json:
```json
{
    "body": "<div id=\"comment:90\" align=\"right\">comment:90</div>\n\nSee also #31830 (`perl_cpan_polymake_prereq`: Update install instructions).",
    "created_at": "2021-11-01T15:51:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506469",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:90" align="right">comment:90</div>

See also #31830 (`perl_cpan_polymake_prereq`: Update install instructions).



---

archive/issue_comments_506470.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">comment:91</div>\n\nReplying to [@dimpase](#comment:84):\n> Shouldn't `perl_cpan_polymake_prereq` (and other deps?) be in `SAGE_SPKG_DEPCHECK` for polymake?\n\n`perl_cpan_polymake_prereq` does not make sense in `SAGE_SPKG_DEPCHECK` because it is a dummy script package -- we provide no spkg-install for it.\n\nYou can add `SAGE_SPKG_DEPCHECK` for `bliss`, `cddlib`, `lrslib`, `readline`, `ppl`, which bring shared libraries.",
    "created_at": "2021-11-01T15:56:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506470",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:91" align="right">comment:91</div>

Replying to [@dimpase](#comment:84):
> Shouldn't `perl_cpan_polymake_prereq` (and other deps?) be in `SAGE_SPKG_DEPCHECK` for polymake?

`perl_cpan_polymake_prereq` does not make sense in `SAGE_SPKG_DEPCHECK` because it is a dummy script package -- we provide no spkg-install for it.

You can add `SAGE_SPKG_DEPCHECK` for `bliss`, `cddlib`, `lrslib`, `readline`, `ppl`, which bring shared libraries.



---

archive/issue_comments_506471.json:
```json
{
    "body": "Changed commit from **[`717f98b`](https://github.com/sagemath/sagetrac-mirror/commit/717f98bdb79b5a00820673e94e3096df66c12dab)** to **[`03f17c9`](https://github.com/sagemath/sagetrac-mirror/commit/03f17c9f764eeebb1e1cdaa2004f8ce7fac9022e)**",
    "created_at": "2021-11-01T17:01:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506471",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`717f98b`](https://github.com/sagemath/sagetrac-mirror/commit/717f98bdb79b5a00820673e94e3096df66c12dab)** to **[`03f17c9`](https://github.com/sagemath/sagetrac-mirror/commit/03f17c9f764eeebb1e1cdaa2004f8ce7fac9022e)**



---

archive/issue_comments_506472.json:
```json
{
    "body": "<div id=\"comment:92\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/03f17c9f764eeebb1e1cdaa2004f8ce7fac9022e\"><code>03f17c9</code></a></td><td><code>build/pkgs/polymake/spkg-configure.m4: In AC_RUN_IFELSE for libpolymake, use shell_enable, set_application</code></td></tr></table>\n",
    "created_at": "2021-11-01T17:01:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506472",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:92"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/03f17c9f764eeebb1e1cdaa2004f8ce7fac9022e"><code>03f17c9</code></a></td><td><code>build/pkgs/polymake/spkg-configure.m4: In AC_RUN_IFELSE for libpolymake, use shell_enable, set_application</code></td></tr></table>




---

archive/issue_comments_506473.json:
```json
{
    "body": "<div id=\"comment:93\" align=\"right\">comment:93</div>\n\nReplying to [@dimpase](#comment:86):\n> We should check that `polymake` is working, not only `polymake-config`.\n> (As some Perl deps might be broken [...])\n\nI have instead added some initialization steps to the existing run test of the polymake library. Please try if it correctly rejects your broken installation",
    "created_at": "2021-11-01T17:02:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506473",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:93" align="right">comment:93</div>

Replying to [@dimpase](#comment:86):
> We should check that `polymake` is working, not only `polymake-config`.
> (As some Perl deps might be broken [...])

I have instead added some initialization steps to the existing run test of the polymake library. Please try if it correctly rejects your broken installation



---

archive/issue_comments_506474.json:
```json
{
    "body": "<div id=\"comment:94\" align=\"right\">comment:94</div>\n\nReplying to [@mkoeppe](#comment:91):\n> You can add `SAGE_SPKG_DEPCHECK` for `bliss`, `cddlib`, `lrslib`, `readline`, `ppl`, which bring shared libraries.\n\nHowever, this would reject polymake on homebrew, which does not provide all of these libraries. So let's not do this -- unless someone is actually running into shared library conflicts.",
    "created_at": "2021-11-01T17:07:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506474",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:94" align="right">comment:94</div>

Replying to [@mkoeppe](#comment:91):
> You can add `SAGE_SPKG_DEPCHECK` for `bliss`, `cddlib`, `lrslib`, `readline`, `ppl`, which bring shared libraries.

However, this would reject polymake on homebrew, which does not provide all of these libraries. So let's not do this -- unless someone is actually running into shared library conflicts.



---

archive/issue_events_434655.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-11-01T17:08:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434655"
}
```



---

archive/issue_events_434656.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-11-01T17:08:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434656"
}
```



---

archive/issue_comments_506475.json:
```json
{
    "body": "Changed work issues from **clarify Perl deps in spkg-configure.m4 (and elsewhere)** to none",
    "created_at": "2021-11-01T17:08:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506475",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **clarify Perl deps in spkg-configure.m4 (and elsewhere)** to none



---

archive/issue_comments_506476.json:
```json
{
    "body": "Changed reviewer from **Antonio Rojas** to **Antonio Rojas, Dima Pasechnik**",
    "created_at": "2021-11-01T17:08:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506476",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **Antonio Rojas** to **Antonio Rojas, Dima Pasechnik**



---

archive/issue_comments_506477.json:
```json
{
    "body": "<div id=\"comment:97\" align=\"right\">comment:97</div>\n\nTesting on arch using `EXTRA_CONFIGURE_ARGS=\"--disable-notebook\" tox -e docker-archlinux-latest-maximal`.\n\nThere seems to be a packaging bug that breaks polymake when `TERM` is set to `dumb` (as we do in the (deprecated) polymake pexpect interface):\n\n```\n[root@ab9af06251dd sage]# TERM=dumb polymake\nWelcome to polymake version 4.5\nCopyright (c) 1997-2021\nEwgenij Gawrilow, Michael Joswig, and the polymake team\nTechnische Universit\u00e4t Berlin, Germany\nhttps://polymake.org\n\nThis is free software licensed under GPL; see the source for copying conditions.\nThere is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\nLoading applications now...Can't locate object method \"new\" via package \"Term::ReadLine::Gnu\" at /usr/share/polymake/perllib/Polymake/Core/Shell.pm line 30.\n```",
    "created_at": "2021-11-01T19:07:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506477",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:97" align="right">comment:97</div>

Testing on arch using `EXTRA_CONFIGURE_ARGS="--disable-notebook" tox -e docker-archlinux-latest-maximal`.

There seems to be a packaging bug that breaks polymake when `TERM` is set to `dumb` (as we do in the (deprecated) polymake pexpect interface):

```
[root@ab9af06251dd sage]# TERM=dumb polymake
Welcome to polymake version 4.5
Copyright (c) 1997-2021
Ewgenij Gawrilow, Michael Joswig, and the polymake team
Technische Universität Berlin, Germany
https://polymake.org

This is free software licensed under GPL; see the source for copying conditions.
There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

Loading applications now...Can't locate object method "new" via package "Term::ReadLine::Gnu" at /usr/share/polymake/perllib/Polymake/Core/Shell.pm line 30.
```



---

archive/issue_comments_506478.json:
```json
{
    "body": "<div id=\"comment:98\" align=\"right\">comment:98</div>\n\nReplying to [@mkoeppe](#comment:93):\n> Replying to [@dimpase](#comment:86):\n> > We should check that `polymake` is working, not only `polymake-config`.\n> > (As some Perl deps might be broken [...])\n\n> \n> I have instead added some initialization steps to the existing run test of the polymake library. Please try if it correctly rejects your broken installation\n\nit does, I get the same error as from `polymake` in terminal. I get\n\n```\nconfigure:39826: ./conftest\nterminate called after throwing an instance of 'pm::perl::exception'\n  what():  \"/usr/share/polymake/apps/common/perllib/PolyDB.pm\", line 23: Can't locate MongoDB.pm in @INC (you may need to install the MongoDB module)\n...\n```\n\nHowever, I don't get why you need this extra hack, rather than the result of `perl_mongodb/spkg-configure.m4`, which could be added into `SAGE_SPKG_DEPCHECK`, and which duly reports\n\n```\nperl_mongodb-none:                           no suitable system package; optional\n```\nThese perl module packages aren't so dummy after all.",
    "created_at": "2021-11-01T23:25:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506478",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:98" align="right">comment:98</div>

Replying to [@mkoeppe](#comment:93):
> Replying to [@dimpase](#comment:86):
> > We should check that `polymake` is working, not only `polymake-config`.
> > (As some Perl deps might be broken [...])

> 
> I have instead added some initialization steps to the existing run test of the polymake library. Please try if it correctly rejects your broken installation

it does, I get the same error as from `polymake` in terminal. I get

```
configure:39826: ./conftest
terminate called after throwing an instance of 'pm::perl::exception'
  what():  "/usr/share/polymake/apps/common/perllib/PolyDB.pm", line 23: Can't locate MongoDB.pm in @INC (you may need to install the MongoDB module)
...
```

However, I don't get why you need this extra hack, rather than the result of `perl_mongodb/spkg-configure.m4`, which could be added into `SAGE_SPKG_DEPCHECK`, and which duly reports

```
perl_mongodb-none:                           no suitable system package; optional
```
These perl module packages aren't so dummy after all.



---

archive/issue_comments_506479.json:
```json
{
    "body": "<div id=\"comment:99\" align=\"right\">comment:99</div>\n\nReplying to [@mkoeppe](#comment:91):\n> Replying to [@dimpase](#comment:84):\n> > Shouldn't `perl_cpan_polymake_prereq` (and other deps?) be in `SAGE_SPKG_DEPCHECK` for polymake?\n\n> `perl_cpan_polymake_prereq` does not make sense in `SAGE_SPKG_DEPCHECK` because it is a dummy script package -- we provide no spkg-install for it.\n\nWhat do you mean it's `dummy` - it does the check for the needed modules!\nSee also [comment:98](#comment:98).",
    "created_at": "2021-11-01T23:28:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506479",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:99" align="right">comment:99</div>

Replying to [@mkoeppe](#comment:91):
> Replying to [@dimpase](#comment:84):
> > Shouldn't `perl_cpan_polymake_prereq` (and other deps?) be in `SAGE_SPKG_DEPCHECK` for polymake?

> `perl_cpan_polymake_prereq` does not make sense in `SAGE_SPKG_DEPCHECK` because it is a dummy script package -- we provide no spkg-install for it.

What do you mean it's `dummy` - it does the check for the needed modules!
See also [comment:98](#comment:98).



---

archive/issue_comments_506480.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\n\"Dummy\" means we have no `spkg-install` script; the package only exists for running the `spkg-configure.m4`.",
    "created_at": "2021-11-02T00:08:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506480",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:0" align="right">comment:0</div>

"Dummy" means we have no `spkg-install` script; the package only exists for running the `spkg-configure.m4`.



---

archive/issue_comments_506481.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThe `perl_mongodb` package is not required. Only users who want to use PolyDB need it.\nThat's why I split it out from `perl_cpan_polymake_prereq` in #31840.",
    "created_at": "2021-11-02T00:10:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506481",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

The `perl_mongodb` package is not required. Only users who want to use PolyDB need it.
That's why I split it out from `perl_cpan_polymake_prereq` in #31840.



---

archive/issue_comments_506482.json:
```json
{
    "body": "<div id=\"comment:102\" align=\"right\">comment:102</div>\n\nReplying to [@mkoeppe](#comment:100):\n> \"Dummy\" means we have no `spkg-install` script; the package only exists for running the `spkg-configure.m4`.\n\nanyhow, these packages do useful tests on suitability of system `polymake`, as we have discovered here, why not add them to `SAGE_SPKG_DEPCHECK` ?",
    "created_at": "2021-11-02T00:12:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506482",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:102" align="right">comment:102</div>

Replying to [@mkoeppe](#comment:100):
> "Dummy" means we have no `spkg-install` script; the package only exists for running the `spkg-configure.m4`.

anyhow, these packages do useful tests on suitability of system `polymake`, as we have discovered here, why not add them to `SAGE_SPKG_DEPCHECK` ?



---

archive/issue_comments_506483.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nYou are confused about `SAGE_SPKG_DEPCHECK`. This macro implements the logic \"dependency library B is installed from SPKG ==> must install package A from SPKG too\".",
    "created_at": "2021-11-02T00:13:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506483",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

You are confused about `SAGE_SPKG_DEPCHECK`. This macro implements the logic "dependency library B is installed from SPKG ==> must install package A from SPKG too".



---

archive/issue_comments_506484.json:
```json
{
    "body": "<div id=\"comment:104\" align=\"right\">comment:104</div>\n\nReplying to [@mkoeppe](#comment:101):\n> The `perl_mongodb` package is not required. Only users who want to use PolyDB need it.\n> That's why I split it out from `perl_cpan_polymake_prereq` in #31840.\n> \n\nI don't know what `PolyDB` is, it seems to be an integral part of polymake now.\n(At least on Gentoo there seems to be no option to have polymake not dependent on it)",
    "created_at": "2021-11-02T00:17:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506484",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:104" align="right">comment:104</div>

Replying to [@mkoeppe](#comment:101):
> The `perl_mongodb` package is not required. Only users who want to use PolyDB need it.
> That's why I split it out from `perl_cpan_polymake_prereq` in #31840.
> 

I don't know what `PolyDB` is, it seems to be an integral part of polymake now.
(At least on Gentoo there seems to be no option to have polymake not dependent on it)



---

archive/issue_comments_506485.json:
```json
{
    "body": "<div id=\"comment:105\" align=\"right\">comment:105</div>\n\nReplying to [@mkoeppe](#comment:103):\n> You are confused about `SAGE_SPKG_DEPCHECK`. This macro implements the logic \"dependency library B is installed from SPKG ==> must install package A from SPKG too\".\n\nNote that X->Y <=> \u00acY->\u00acX (i.e. A from system needs B from system)",
    "created_at": "2021-11-02T00:21:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506485",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:105" align="right">comment:105</div>

Replying to [@mkoeppe](#comment:103):
> You are confused about `SAGE_SPKG_DEPCHECK`. This macro implements the logic "dependency library B is installed from SPKG ==> must install package A from SPKG too".

Note that X->Y <=> ¬Y->¬X (i.e. A from system needs B from system)



---

archive/issue_comments_506486.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nAs I said, you are confused.",
    "created_at": "2021-11-02T00:21:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506486",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">comment:6</div>

As I said, you are confused.



---

archive/issue_comments_506487.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nNo, I wrote the macro `SAGE_SPKG_CONFIGURE`, in fact, and it's you who are confused. :-)\nIf I do\n\n```diff\n--- a/build/pkgs/polymake/spkg-configure.m4\n+++ b/build/pkgs/polymake/spkg-configure.m4\n@@ -1,6 +1,7 @@\n SAGE_SPKG_CONFIGURE([polymake], [\n     dnl Need polymake >= 3.5 for \"improve callable library compatibility with threads\"\n     m4_pushdef([POLYMAKE_VERSION_MIN], [3.5])\n+SAGE_SPKG_DEPCHECK([perl_mongodb], [\n     AC_CACHE_CHECK([for polymake-config >= ]POLYMAKE_VERSION_MIN, [ac_cv_path_POLYMAKE_CONFIG], [\n         AC_PATH_PROGS_FEATURE_CHECK([POLYMAKE_CONFIG], [polymake-config], [\n             polymake_config_version=$($ac_path_POLYMAKE_CONFIG --version 2>&1)\n@@ -41,5 +42,6 @@ SAGE_SPKG_CONFIGURE([polymake], [\n            LDFLAGS=\"$saved_LDFLAGS\"\n            AC_LANG_POP([C++])\n           ])\n+])\n     m4_popdef([POLYMAKE_VERSION_MIN])\n ])\n```\nthen I get\n\n```\n## --------------------------------------------------------- ##\n## Checking whether SageMath should install SPKG polymake... ##\n## --------------------------------------------------------- ##\nconfigure:39701: checking whether any of perl_mongodb is installed as or will be installed as SPKG\nconfigure:39706: result: yes; install polymake as well\nconfigure:39897: no suitable system package found for SPKG polymake\n```",
    "created_at": "2021-11-02T00:35:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506487",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">comment:7</div>

No, I wrote the macro `SAGE_SPKG_CONFIGURE`, in fact, and it's you who are confused. :-)
If I do

```diff
--- a/build/pkgs/polymake/spkg-configure.m4
+++ b/build/pkgs/polymake/spkg-configure.m4
@@ -1,6 +1,7 @@
 SAGE_SPKG_CONFIGURE([polymake], [
     dnl Need polymake >= 3.5 for "improve callable library compatibility with threads"
     m4_pushdef([POLYMAKE_VERSION_MIN], [3.5])
+SAGE_SPKG_DEPCHECK([perl_mongodb], [
     AC_CACHE_CHECK([for polymake-config >= ]POLYMAKE_VERSION_MIN, [ac_cv_path_POLYMAKE_CONFIG], [
         AC_PATH_PROGS_FEATURE_CHECK([POLYMAKE_CONFIG], [polymake-config], [
             polymake_config_version=$($ac_path_POLYMAKE_CONFIG --version 2>&1)
@@ -41,5 +42,6 @@ SAGE_SPKG_CONFIGURE([polymake], [
            LDFLAGS="$saved_LDFLAGS"
            AC_LANG_POP([C++])
           ])
+])
     m4_popdef([POLYMAKE_VERSION_MIN])
 ])
```
then I get

```
## --------------------------------------------------------- ##
## Checking whether SageMath should install SPKG polymake... ##
## --------------------------------------------------------- ##
configure:39701: checking whether any of perl_mongodb is installed as or will be installed as SPKG
configure:39706: result: yes; install polymake as well
configure:39897: no suitable system package found for SPKG polymake
```



---

archive/issue_comments_506488.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nYes, I agree that `checking whether any of perl_mongodb is installed as or will be installed as SPKG` message is misleading, but, well...",
    "created_at": "2021-11-02T00:36:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506488",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">comment:8</div>

Yes, I agree that `checking whether any of perl_mongodb is installed as or will be installed as SPKG` message is misleading, but, well...



---

archive/issue_comments_506489.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nBut it's late night in Europe, and your change there implements the wrong logic.",
    "created_at": "2021-11-02T00:37:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506489",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">comment:9</div>

But it's late night in Europe, and your change there implements the wrong logic.



---

archive/issue_comments_506490.json:
```json
{
    "body": "<div id=\"comment:110\" align=\"right\">comment:110</div>\n\nReplying to [@mkoeppe](#comment:109):\n> But it's late night in Europe, and your change there implements the wrong logic.\n> \n> \n\nit's not yet 1am here, and \nit's only wrong if `perl_mongodb` is optional for the latest polymake. Note that Gentoo builds polymake just fine, while there is no Perl MongoDB installed (and the result of the build is broken).",
    "created_at": "2021-11-02T00:41:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506490",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:110" align="right">comment:110</div>

Replying to [@mkoeppe](#comment:109):
> But it's late night in Europe, and your change there implements the wrong logic.
> 
> 

it's not yet 1am here, and 
it's only wrong if `perl_mongodb` is optional for the latest polymake. Note that Gentoo builds polymake just fine, while there is no Perl MongoDB installed (and the result of the build is broken).



---

archive/issue_comments_506491.json:
```json
{
    "body": "<div id=\"comment:111\" align=\"right\">comment:111</div>\n\n1. `perl_mongodb` *is* optional for polymake.\n\n2. Whether system `perl_mongodb` is available or not, we can use system `polymake`.\n\n3. Even if we add an installation script for `perl_mongodb`, installing it as an SPKG does NOT make it necessary to stop using the system polymake (which is what `SAGE_SPKG_DEPCHECK` implements).",
    "created_at": "2021-11-02T00:47:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506491",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:111" align="right">comment:111</div>

1. `perl_mongodb` *is* optional for polymake.

2. Whether system `perl_mongodb` is available or not, we can use system `polymake`.

3. Even if we add an installation script for `perl_mongodb`, installing it as an SPKG does NOT make it necessary to stop using the system polymake (which is what `SAGE_SPKG_DEPCHECK` implements).



---

archive/issue_comments_506492.json:
```json
{
    "body": "<div id=\"comment:112\" align=\"right\">comment:112</div>\n\nReplying to [@dimpase](#comment:98):\n> Replying to [@mkoeppe](#comment:93):\n> > Replying to [@dimpase](#comment:86):\n> > > We should check that `polymake` is working, not only `polymake-config`.\n> > > (As some Perl deps might be broken [...])\n\n> > \n> > I have instead added some initialization steps to the existing run test of the polymake library. Please try if it correctly rejects your broken installation\n\n> \n> it does, I get the same error as from `polymake` in terminal.\n\nGood, then `spkg-configure.m4` (= the scope of this ticket) does its job correctly.\n\n> However, I don't get why you need this extra hack\n\nNot a hack, just a proper runtest for the polymake library.",
    "created_at": "2021-11-02T01:40:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506492",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:112" align="right">comment:112</div>

Replying to [@dimpase](#comment:98):
> Replying to [@mkoeppe](#comment:93):
> > Replying to [@dimpase](#comment:86):
> > > We should check that `polymake` is working, not only `polymake-config`.
> > > (As some Perl deps might be broken [...])

> > 
> > I have instead added some initialization steps to the existing run test of the polymake library. Please try if it correctly rejects your broken installation

> 
> it does, I get the same error as from `polymake` in terminal.

Good, then `spkg-configure.m4` (= the scope of this ticket) does its job correctly.

> However, I don't get why you need this extra hack

Not a hack, just a proper runtest for the polymake library.



---

archive/issue_comments_506493.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI don't know how `Loading applications now...` works but I get\n\n```\nApplication polytope currently uses following contributed and third-party software packages:\n4ti2, bliss, cdd, flint, graphviz, libnormaliz, lrs, permlib, povray, ppl, qhull, singular, sketch, sympol, threejs, tikz, tosimplex\nFor more details:  show_credits;\npolytope > \n```\nso I guess I never touch PolyDB.pm somehow  (I use `dev-perl/MongoDB` for our docker images only)",
    "created_at": "2021-11-02T06:11:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506493",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:3" align="right">comment:3</div>

I don't know how `Loading applications now...` works but I get

```
Application polytope currently uses following contributed and third-party software packages:
4ti2, bliss, cdd, flint, graphviz, libnormaliz, lrs, permlib, povray, ppl, qhull, singular, sketch, sympol, threejs, tikz, tosimplex
For more details:  show_credits;
polytope > 
```
so I guess I never touch PolyDB.pm somehow  (I use `dev-perl/MongoDB` for our docker images only)



---

archive/issue_comments_506494.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI hope this ticket stays not about `perl_mongodb` in any way. Somehow it wasn't about `perl_mongodb` for Arch Linux users.",
    "created_at": "2021-11-02T06:27:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506494",
    "user": "https://github.com/sheerluck"
}
```

<div id="comment:4" align="right">comment:4</div>

I hope this ticket stays not about `perl_mongodb` in any way. Somehow it wasn't about `perl_mongodb` for Arch Linux users.



---

archive/issue_comments_506495.json:
```json
{
    "body": "<div id=\"comment:115\" align=\"right\">comment:115</div>\n\nReplying to [@mkoeppe](#comment:111):\n> 1. `perl_mongodb` *is* optional for polymake.\n> \n> 2. Whether system `perl_mongodb` is available or not, we can use system `polymake`.\n\nexcept that we can't in some cases, see above.\n\n> \n> 3. Even if we add an installation script for `perl_mongodb`, installing it as an SPKG does NOT make it necessary to stop using the system polymake (which is what `SAGE_SPKG_DEPCHECK` implements).\n\nHopefully this is not happening on my watch :-)\n\n---\n\nAnyhow it's good enough now.",
    "created_at": "2021-11-02T09:05:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506495",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:115" align="right">comment:115</div>

Replying to [@mkoeppe](#comment:111):
> 1. `perl_mongodb` *is* optional for polymake.
> 
> 2. Whether system `perl_mongodb` is available or not, we can use system `polymake`.

except that we can't in some cases, see above.

> 
> 3. Even if we add an installation script for `perl_mongodb`, installing it as an SPKG does NOT make it necessary to stop using the system polymake (which is what `SAGE_SPKG_DEPCHECK` implements).

Hopefully this is not happening on my watch :-)

---

Anyhow it's good enough now.



---

archive/issue_events_434657.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-02T09:05:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434657"
}
```



---

archive/issue_events_434658.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-02T09:05:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434658"
}
```



---

archive/issue_comments_506496.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThanks.",
    "created_at": "2021-11-02T17:40:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506496",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">comment:6</div>

Thanks.



---

archive/issue_events_434659.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-07T09:36:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434659"
}
```



---

archive/issue_events_434660.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a3b48105950a35e38c0f134102b9d36b9223d440",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-11-07T09:36:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31527#event-434660"
}
```



---

archive/issue_comments_506497.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/spkg_configure_m4_for_polymake](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/spkg_configure_m4_for_polymake)** to **[`03f17c9`](https://github.com/sagemath/sagetrac-mirror/commit/03f17c9f764eeebb1e1cdaa2004f8ce7fac9022e)**",
    "created_at": "2021-11-07T09:36:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31527#issuecomment-506497",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/spkg_configure_m4_for_polymake](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/spkg_configure_m4_for_polymake)** to **[`03f17c9`](https://github.com/sagemath/sagetrac-mirror/commit/03f17c9f764eeebb1e1cdaa2004f8ce7fac9022e)**
