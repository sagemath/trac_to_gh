# Issue 31699: setuptools/pip/pkgconfig/packaging/importlib-metadata upgrade for Sage 9.4

archive/issues_031462.json:
```json
{
    "body": "https://repology.org/projects/p/?inrepo=sagemath\n\n- https://setuptools.readthedocs.io/en/latest/history.html\n\n- https://pip.pypa.io/en/stable/news/\n  - Add a feature `--use-feature=in-tree-build` to build local projects in-place when installing. This is expected to become the default behavior in pip 21.3\n\nWe add two new packages that have become dependencies in the new versions: `toml`, `typing_extensions`.\n\n\n\nCC:  @kiwifb @jhpalmieri\n\nReviewer: Fran\u00e7ois Bissey, Dima Pasechnik\n\nAuthor: Matthias Koeppe\n\nBranch: 7a6d0b61e5fc52cd1e7dc37c03b1d370da1c8595\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/31699\n\n",
    "closed_at": "2021-06-19T20:58:22Z",
    "created_at": "2021-04-19T20:02:56Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "setuptools/pip/pkgconfig/packaging/importlib-metadata upgrade for Sage 9.4",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31699",
    "user": "https://github.com/mkoeppe"
}
```
https://repology.org/projects/p/?inrepo=sagemath

- https://setuptools.readthedocs.io/en/latest/history.html

- https://pip.pypa.io/en/stable/news/
  - Add a feature `--use-feature=in-tree-build` to build local projects in-place when installing. This is expected to become the default behavior in pip 21.3

We add two new packages that have become dependencies in the new versions: `toml`, `typing_extensions`.



CC:  @kiwifb @jhpalmieri

Reviewer: Fran√ßois Bissey, Dima Pasechnik

Author: Matthias Koeppe

Branch: 7a6d0b61e5fc52cd1e7dc37c03b1d370da1c8595

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/31699





---

archive/issue_comments_622824.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,2 @@\n https://repology.org/projects/p/?inrepo=sagemath\n+\n``````\n",
    "created_at": "2021-04-19T20:06:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622824",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,2 @@
 https://repology.org/projects/p/?inrepo=sagemath
+
``````




---

archive/issue_events_101983.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "rename": {
        "from": "setuptools/pip/pkgconfig upgrade for Sage 9.4",
        "to": "setuptools/pip/pkgconfig/packaging/importlib-metadata upgrade for Sage 9.4"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31699#event-101983"
}
```



---

archive/issue_comments_622825.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/setuptools_pip_pkgconfig_packaging_importlib_metadata_upgrade_for_sage_9_4\"",
    "created_at": "2021-04-20T16:57:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622825",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/setuptools_pip_pkgconfig_packaging_importlib_metadata_upgrade_for_sage_9_4"



---

archive/issue_comments_622826.json:
```json
{
    "body": "<a id='comment:3'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                         |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|\n|[b560ad2](https://github.com/sagemath/sagetrac-mirror/commit/b560ad2518dcd4f2a96bc19975ac695d607d15aa)|`build/pkgs/setuptools: Update to 56.2.0`|\n|[2006212](https://github.com/sagemath/sagetrac-mirror/commit/20062123bce97f985c34200fd0406a7433bed7fd)|`build/pkgs/pkgconfig: Update to 1.5.2`|\n|[012774f](https://github.com/sagemath/sagetrac-mirror/commit/012774f5f914574764e9d2845f9cbb1a25d141e6)|`build/pkgs/packaging: Update to 20.9`|\n|[fff89bc](https://github.com/sagemath/sagetrac-mirror/commit/fff89bc2ff73d2261dcb04af334d0e392933898d)|`build/pkgs/importlib_metadata: Update to 4.0.1`|\n|[e14a5ed](https://github.com/sagemath/sagetrac-mirror/commit/e14a5ede8ae98330caea1b9ffa54e115e0a0acce)|`build/pkgs/pip: Update to 21.1.1`|",
    "created_at": "2021-05-11T23:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622826",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|
|[b560ad2](https://github.com/sagemath/sagetrac-mirror/commit/b560ad2518dcd4f2a96bc19975ac695d607d15aa)|`build/pkgs/setuptools: Update to 56.2.0`|
|[2006212](https://github.com/sagemath/sagetrac-mirror/commit/20062123bce97f985c34200fd0406a7433bed7fd)|`build/pkgs/pkgconfig: Update to 1.5.2`|
|[012774f](https://github.com/sagemath/sagetrac-mirror/commit/012774f5f914574764e9d2845f9cbb1a25d141e6)|`build/pkgs/packaging: Update to 20.9`|
|[fff89bc](https://github.com/sagemath/sagetrac-mirror/commit/fff89bc2ff73d2261dcb04af334d0e392933898d)|`build/pkgs/importlib_metadata: Update to 4.0.1`|
|[e14a5ed](https://github.com/sagemath/sagetrac-mirror/commit/e14a5ede8ae98330caea1b9ffa54e115e0a0acce)|`build/pkgs/pip: Update to 21.1.1`|



---

archive/issue_comments_622827.json:
```json
{
    "body": "Changing commit from \"\" to \"e14a5ede8ae98330caea1b9ffa54e115e0a0acce\"",
    "created_at": "2021-05-11T23:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622827",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "e14a5ede8ae98330caea1b9ffa54e115e0a0acce"



---

archive/issue_comments_622828.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2021-05-11T23:21:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622828",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_622829.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-05-11T23:21:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622829",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_622830.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,7 @@\n https://repology.org/projects/p/?inrepo=sagemath\n \n+- https://setuptools.readthedocs.io/en/latest/history.html\n+\n+- https://pip.pypa.io/en/stable/news/\n+  - Add a feature `--use-feature=in-tree-build` to build local projects in-place when installing. This is expected to become the default behavior in pip 21.3\n+\n``````\n",
    "created_at": "2021-05-11T23:21:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622830",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,7 @@
 https://repology.org/projects/p/?inrepo=sagemath
 
+- https://setuptools.readthedocs.io/en/latest/history.html
+
+- https://pip.pypa.io/en/stable/news/
+  - Add a feature `--use-feature=in-tree-build` to build local projects in-place when installing. This is expected to become the default behavior in pip 21.3
+
``````




---

archive/issue_comments_622831.json:
```json
{
    "body": "Changing dependencies from \"#31612\" to \"\"",
    "created_at": "2021-05-11T23:21:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622831",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#31612" to ""



---

archive/issue_comments_622832.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-05-11T23:28:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622832",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_622833.json:
```json
{
    "body": "<a id='comment:6'></a>\nThis looks like just a package update ticket right. \n\nI guess the way `pip` is usually used, building in place probably doesn't matter. However, that's bucking the trend of every other build system that are going through extra effort to let you keep your source clean.",
    "created_at": "2021-05-11T23:28:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622833",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>
This looks like just a package update ticket right. 

I guess the way `pip` is usually used, building in place probably doesn't matter. However, that's bucking the trend of every other build system that are going through extra effort to let you keep your source clean.



---

archive/issue_comments_622834.json:
```json
{
    "body": "<a id='comment:7'></a>\n`importlib_metadata` has a \"build-system requires\": `setuptools_scm[toml]`",
    "created_at": "2021-05-11T23:30:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622834",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
`importlib_metadata` has a "build-system requires": `setuptools_scm[toml]`



---

archive/issue_comments_622835.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [fbissey](#comment%3A6):\n> I guess the way `pip` is usually used, building in place probably doesn't matter. However, that's bucking the trend of every other build system that are going through extra effort to let you keep your source clean.\n\n\nActually it's quite relevant for us in the context of the modularized trees. We currently cannot use pip for building wheels because it does not handle our symlinks correctly. This new feature has the potential for fixing this -- but I have not checked it.",
    "created_at": "2021-05-11T23:32:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622835",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
Replying to [fbissey](#comment%3A6):
> I guess the way `pip` is usually used, building in place probably doesn't matter. However, that's bucking the trend of every other build system that are going through extra effort to let you keep your source clean.


Actually it's quite relevant for us in the context of the modularized trees. We currently cannot use pip for building wheels because it does not handle our symlinks correctly. This new feature has the potential for fixing this -- but I have not checked it.



---

archive/issue_comments_622836.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [mkoeppe](#comment%3A7):\n> `importlib_metadata` has a \"build-system requires\": `setuptools_scm[toml]`\n\nand also an \"install-requires\": `typing-extensions`",
    "created_at": "2021-05-11T23:40:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622836",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>
Replying to [mkoeppe](#comment%3A7):
> `importlib_metadata` has a "build-system requires": `setuptools_scm[toml]`

and also an "install-requires": `typing-extensions`



---

archive/issue_comments_622837.json:
```json
{
    "body": "<a id='comment:10'></a>\nOK, that's a new package. I am not sure what the implication for `setuptools_scm` is. Does it need an extra plugin? Does it mean it needs to be installed a certain way? In which case why isn't it just a different package altogether?",
    "created_at": "2021-05-11T23:43:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622837",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:10'></a>
OK, that's a new package. I am not sure what the implication for `setuptools_scm` is. Does it need an extra plugin? Does it mean it needs to be installed a certain way? In which case why isn't it just a different package altogether?



---

archive/issue_comments_622838.json:
```json
{
    "body": "<a id='comment:11'></a>\nOK, I get it. We need to add a new package for `toml` so it can use it. Could as well put it directly in `build-system requires`. Never mind.",
    "created_at": "2021-05-11T23:48:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622838",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:11'></a>
OK, I get it. We need to add a new package for `toml` so it can use it. Could as well put it directly in `build-system requires`. Never mind.



---

archive/issue_comments_622839.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------|\n|[3386fa1](https://github.com/sagemath/sagetrac-mirror/commit/3386fa12fa5e377d79f17f96bbed9c2479308b36)|`build/pkgs/toml: New`|\n|[71aeec7](https://github.com/sagemath/sagetrac-mirror/commit/71aeec7be29d04c90ef8c1ccaff06d1feff35b1e)|`build/pkgs/typing_extensions: New`|\n|[ecdf3e1](https://github.com/sagemath/sagetrac-mirror/commit/ecdf3e17bf79246065033531d95181a96cacdd86)|`build/pkgs/importlib_metadata/dependencies: Update`|",
    "created_at": "2021-05-11T23:50:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622839",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------|
|[3386fa1](https://github.com/sagemath/sagetrac-mirror/commit/3386fa12fa5e377d79f17f96bbed9c2479308b36)|`build/pkgs/toml: New`|
|[71aeec7](https://github.com/sagemath/sagetrac-mirror/commit/71aeec7be29d04c90ef8c1ccaff06d1feff35b1e)|`build/pkgs/typing_extensions: New`|
|[ecdf3e1](https://github.com/sagemath/sagetrac-mirror/commit/ecdf3e17bf79246065033531d95181a96cacdd86)|`build/pkgs/importlib_metadata/dependencies: Update`|



---

archive/issue_comments_622840.json:
```json
{
    "body": "Changing commit from \"e14a5ede8ae98330caea1b9ffa54e115e0a0acce\" to \"ecdf3e17bf79246065033531d95181a96cacdd86\"",
    "created_at": "2021-05-11T23:50:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622840",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e14a5ede8ae98330caea1b9ffa54e115e0a0acce" to "ecdf3e17bf79246065033531d95181a96cacdd86"



---

archive/issue_comments_622841.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-05-12T00:02:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622841",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_622842.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,3 +5,6 @@\n - https://pip.pypa.io/en/stable/news/\n   - Add a feature `--use-feature=in-tree-build` to build local projects in-place when installing. This is expected to become the default behavior in pip 21.3\n \n+We add two new packages that have become dependencies in the new versions: `toml`, `typing_extensions`.\n+\n+\n``````\n",
    "created_at": "2021-05-12T00:02:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622842",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,3 +5,6 @@
 - https://pip.pypa.io/en/stable/news/
   - Add a feature `--use-feature=in-tree-build` to build local projects in-place when installing. This is expected to become the default behavior in pip 21.3
 
+We add two new packages that have become dependencies in the new versions: `toml`, `typing_extensions`.
+
+
``````




---

archive/issue_comments_622843.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Fran\u00e7ois Bissey\"",
    "created_at": "2021-05-12T00:08:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622843",
    "user": "https://github.com/kiwifb"
}
```

Changing reviewer from "" to "Fran√ßois Bissey"



---

archive/issue_comments_622844.json:
```json
{
    "body": "<a id='comment:14'></a>\nLGTM.",
    "created_at": "2021-05-12T00:08:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622844",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:14'></a>
LGTM.



---

archive/issue_comments_622845.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-05-12T00:08:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622845",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_622846.json:
```json
{
    "body": "<a id='comment:15'></a>\nThanks!",
    "created_at": "2021-05-12T00:23:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622846",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>
Thanks!



---

archive/issue_comments_622847.json:
```json
{
    "body": "<a id='comment:16'></a>\nWhere is the tarball for the new version of pkgconfig?",
    "created_at": "2021-05-28T05:24:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622847",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:16'></a>
Where is the tarball for the new version of pkgconfig?



---

archive/issue_comments_622848.json:
```json
{
    "body": "Changing commit from \"ecdf3e17bf79246065033531d95181a96cacdd86\" to \"ef12a3e489273a6c82c8629ab61b8032a82850a6\"",
    "created_at": "2021-05-28T05:29:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622848",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ecdf3e17bf79246065033531d95181a96cacdd86" to "ef12a3e489273a6c82c8629ab61b8032a82850a6"



---

archive/issue_comments_622849.json:
```json
{
    "body": "<a id='comment:17'></a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n|                                                                                                                                           |                                                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|\n|[ef12a3e](https://github.com/sagemath/sagetrac-mirror/commit/ef12a3e489273a6c82c8629ab61b8032a82850a6)|`build/pkgs/pkgconfig/checksums.ini: Add upstream_url`|",
    "created_at": "2021-05-28T05:29:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622849",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
|                                                                                                                                           |                                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|
|[ef12a3e](https://github.com/sagemath/sagetrac-mirror/commit/ef12a3e489273a6c82c8629ab61b8032a82850a6)|`build/pkgs/pkgconfig/checksums.ini: Add upstream_url`|



---

archive/issue_comments_622850.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2021-05-28T05:29:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622850",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_622851.json:
```json
{
    "body": "<a id='comment:18'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|\n|[7a6d0b6](https://github.com/sagemath/sagetrac-mirror/commit/7a6d0b61e5fc52cd1e7dc37c03b1d370da1c8595)|`build/pkgs/packaging/checksums.ini: Add upstream_url`|",
    "created_at": "2021-05-28T05:30:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622851",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|
|[7a6d0b6](https://github.com/sagemath/sagetrac-mirror/commit/7a6d0b61e5fc52cd1e7dc37c03b1d370da1c8595)|`build/pkgs/packaging/checksums.ini: Add upstream_url`|



---

archive/issue_comments_622852.json:
```json
{
    "body": "Changing commit from \"ef12a3e489273a6c82c8629ab61b8032a82850a6\" to \"7a6d0b61e5fc52cd1e7dc37c03b1d370da1c8595\"",
    "created_at": "2021-05-28T05:30:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622852",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ef12a3e489273a6c82c8629ab61b8032a82850a6" to "7a6d0b61e5fc52cd1e7dc37c03b1d370da1c8595"



---

archive/issue_comments_622853.json:
```json
{
    "body": "<a id='comment:19'></a>\nThanks for catching this!",
    "created_at": "2021-05-28T05:31:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622853",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>
Thanks for catching this!



---

archive/issue_comments_622854.json:
```json
{
    "body": "<a id='comment:20'></a>\nlgtm",
    "created_at": "2021-05-29T00:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622854",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:20'></a>
lgtm



---

archive/issue_comments_622855.json:
```json
{
    "body": "Changing reviewer from \"Fran\u00e7ois Bissey\" to \"Fran\u00e7ois Bissey, Dima Pasechnik\"",
    "created_at": "2021-05-29T00:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622855",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "Fran√ßois Bissey" to "Fran√ßois Bissey, Dima Pasechnik"



---

archive/issue_comments_622856.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-05-29T00:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622856",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_622857.json:
```json
{
    "body": "<a id='comment:21'></a>\nThanks!",
    "created_at": "2021-05-29T00:15:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622857",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>
Thanks!



---

archive/issue_comments_622858.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/setuptools_pip_pkgconfig_packaging_importlib_metadata_upgrade_for_sage_9_4\" to \"7a6d0b61e5fc52cd1e7dc37c03b1d370da1c8595\"",
    "created_at": "2021-06-19T20:58:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622858",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/setuptools_pip_pkgconfig_packaging_importlib_metadata_upgrade_for_sage_9_4" to "7a6d0b61e5fc52cd1e7dc37c03b1d370da1c8595"



---

archive/issue_comments_622859.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-06-19T20:58:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622859",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_101984.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-06-19T20:58:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31699#event-101984"
}
```



---

archive/issue_comments_622860.json:
```json
{
    "body": "Changing commit from \"7a6d0b61e5fc52cd1e7dc37c03b1d370da1c8595\" to \"\"",
    "created_at": "2021-06-21T14:19:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622860",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "7a6d0b61e5fc52cd1e7dc37c03b1d370da1c8595" to ""



---

archive/issue_comments_622861.json:
```json
{
    "body": "<a id='comment:23'></a>\nIt seems that the upgrade of pip broke something. Pip does not build with system python 3.8.2 on ubuntu 20.04, complaining about tornado missing gen. Undoing the upgrade fixes that.",
    "created_at": "2021-06-21T14:19:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622861",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:23'></a>
It seems that the upgrade of pip broke something. Pip does not build with system python 3.8.2 on ubuntu 20.04, complaining about tornado missing gen. Undoing the upgrade fixes that.



---

archive/issue_comments_622862.json:
```json
{
    "body": "<a id='comment:24'></a>\nfull log please",
    "created_at": "2021-06-21T15:03:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622862",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:24'></a>
full log please



---

archive/issue_comments_622863.json:
```json
{
    "body": "<a id='comment:25'></a>\nYes, there seems to be a weird interaction with our `tornado` installation in incremental builds. Removing the `tornado` installation in `site-packages` breaks the vicious cycle.",
    "created_at": "2021-06-21T15:04:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622863",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>
Yes, there seems to be a weird interaction with our `tornado` installation in incremental builds. Removing the `tornado` installation in `site-packages` breaks the vicious cycle.



---

archive/issue_comments_622864.json:
```json
{
    "body": "<a id='comment:26'></a>\nLet's see if a further upgrade of pip fixes the issues.\n\nThis item looks promising:\nhttps://pip.pypa.io/en/stable/news/#v21-1\n\"Prevent packages already-installed alongside with pip to be injected into an isolated build environment during build-time dependency population.\"",
    "created_at": "2021-06-21T15:15:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622864",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>
Let's see if a further upgrade of pip fixes the issues.

This item looks promising:
https://pip.pypa.io/en/stable/news/#v21-1
"Prevent packages already-installed alongside with pip to be injected into an isolated build environment during build-time dependency population."



---

archive/issue_comments_622865.json:
```json
{
    "body": "<a id='comment:27'></a>\nI've opened #32022 for the pip upgrade, haven't tried yet",
    "created_at": "2021-06-21T15:20:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31699#issuecomment-622865",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>
I've opened #32022 for the pip upgrade, haven't tried yet
