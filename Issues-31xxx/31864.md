# Issue 31864: Improved input output for backend polymake

archive/issues_031627.json:
```json
{
    "body": "From #26368.\n\nThe interface to polymake seems to have a significant delay. For input, we can avoid it, as polymake accepts nested lists of integers, rationals, floats.\n\nFor output we can avoid it, as at least for matrices and vectors, we can just parse the representation string.\n\nBefore:\n\n```\nsage: %time P = polytopes.hypercube(8, backend='polymake')                                                                                                                                                                                                                                                                                                                 \nCPU times: user 4.54 s, sys: 260 ms, total: 4.8 s\nWall time: 4.81 s\nsage: %time P = polytopes.hypercube(8, backend='polymake')                                                                                                                                                                                                                                                                                                                 \nCPU times: user 3.08 s, sys: 236 ms, total: 3.31 s\nWall time: 3.31 s\nsage: %time P1 = loads(dumps(P))                                                                                                                                                                                                                                                                                                                                           \nCPU times: user 805 ms, sys: 48 ms, total: 853 ms\nWall time: 853 ms\nsage: %time P = polytopes.dodecahedron(backend='polymake')                                                                                                                                                                                                                                                                                                                 \nCPU times: user 763 ms, sys: 48.2 ms, total: 811 ms\nWall time: 811 ms\nsage: %time P = polytopes.dodecahedron(backend='polymake')                                                                                                                                                                                                                                                                                                                 \nCPU times: user 661 ms, sys: 31.7 ms, total: 692 ms\nWall time: 692 ms\nsage: %time P1 = loads(dumps(P))                                                                                                                                                                                                                                                                                                                                           \nCPU times: user 62.9 ms, sys: 0 ns, total: 62.9 ms\nWall time: 62.6 ms\nsage: %time P = polytopes.dodecahedron(backend='polymake', exact=False)                                                                                                                                                                                                                                                                                                    \nCPU times: user 408 ms, sys: 19.6 ms, total: 428 ms\nWall time: 427 ms\n```\n\n\nAfter:\n\n```\nsage: %time P = polytopes.hypercube(8, backend='polymake')                                                                            \nCPU times: user 1.56 s, sys: 47.4 ms, total: 1.61 s\nWall time: 1.62 s\nsage: %time P = polytopes.hypercube(8, backend='polymake')                                                                            \nCPU times: user 69.1 ms, sys: 4.07 ms, total: 73.2 ms\nWall time: 72.8 ms\nsage: %time P1 = loads(dumps(P))                                                                                                      \nCPU times: user 36.5 ms, sys: 30 \u00b5s, total: 36.5 ms\nWall time: 36 ms\nsage: %time P = polytopes.dodecahedron(backend='polymake')                                                                            \nCPU times: user 206 ms, sys: 4.1 ms, total: 210 ms\nWall time: 209 ms\nsage: %time P = polytopes.dodecahedron(backend='polymake')                                                                            \nCPU times: user 67.9 ms, sys: 0 ns, total: 67.9 ms\nWall time: 67.2 ms\nsage: %time P1 = loads(dumps(P))                                                                                                      \nCPU times: user 39.2 ms, sys: 3.7 ms, total: 42.9 ms\nWall time: 41.8 ms\nsage: %time P = polytopes.dodecahedron(backend='polymake', exact=False)                                                               \nCPU times: user 78.3 ms, sys: 4.01 ms, total: 82.3 ms\nWall time: 81.3 ms\n```\n\nCC:  @mkoeppe\n\nKeywords: polymake, input, output\n\nBranch/Commit: e6fef555f7dfcf2418eb4398c66292ade2c494ce\n\nReviewer: Matthias Koeppe\n\nAuthor: Jonathan Kliem\n\nDependencies: #27745\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/31864\n\n",
    "closed_at": "2021-07-23T20:11:47Z",
    "created_at": "2021-05-27T07:32:27Z",
    "labels": [
        "component: geometry",
        "critical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Improved input output for backend polymake",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31864",
    "user": "https://github.com/kliem"
}
```
From #26368.

The interface to polymake seems to have a significant delay. For input, we can avoid it, as polymake accepts nested lists of integers, rationals, floats.

For output we can avoid it, as at least for matrices and vectors, we can just parse the representation string.

Before:

```
sage: %time P = polytopes.hypercube(8, backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 4.54 s, sys: 260 ms, total: 4.8 s
Wall time: 4.81 s
sage: %time P = polytopes.hypercube(8, backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 3.08 s, sys: 236 ms, total: 3.31 s
Wall time: 3.31 s
sage: %time P1 = loads(dumps(P))                                                                                                                                                                                                                                                                                                                                           
CPU times: user 805 ms, sys: 48 ms, total: 853 ms
Wall time: 853 ms
sage: %time P = polytopes.dodecahedron(backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 763 ms, sys: 48.2 ms, total: 811 ms
Wall time: 811 ms
sage: %time P = polytopes.dodecahedron(backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 661 ms, sys: 31.7 ms, total: 692 ms
Wall time: 692 ms
sage: %time P1 = loads(dumps(P))                                                                                                                                                                                                                                                                                                                                           
CPU times: user 62.9 ms, sys: 0 ns, total: 62.9 ms
Wall time: 62.6 ms
sage: %time P = polytopes.dodecahedron(backend='polymake', exact=False)                                                                                                                                                                                                                                                                                                    
CPU times: user 408 ms, sys: 19.6 ms, total: 428 ms
Wall time: 427 ms
```


After:

```
sage: %time P = polytopes.hypercube(8, backend='polymake')                                                                            
CPU times: user 1.56 s, sys: 47.4 ms, total: 1.61 s
Wall time: 1.62 s
sage: %time P = polytopes.hypercube(8, backend='polymake')                                                                            
CPU times: user 69.1 ms, sys: 4.07 ms, total: 73.2 ms
Wall time: 72.8 ms
sage: %time P1 = loads(dumps(P))                                                                                                      
CPU times: user 36.5 ms, sys: 30 Âµs, total: 36.5 ms
Wall time: 36 ms
sage: %time P = polytopes.dodecahedron(backend='polymake')                                                                            
CPU times: user 206 ms, sys: 4.1 ms, total: 210 ms
Wall time: 209 ms
sage: %time P = polytopes.dodecahedron(backend='polymake')                                                                            
CPU times: user 67.9 ms, sys: 0 ns, total: 67.9 ms
Wall time: 67.2 ms
sage: %time P1 = loads(dumps(P))                                                                                                      
CPU times: user 39.2 ms, sys: 3.7 ms, total: 42.9 ms
Wall time: 41.8 ms
sage: %time P = polytopes.dodecahedron(backend='polymake', exact=False)                                                               
CPU times: user 78.3 ms, sys: 4.01 ms, total: 82.3 ms
Wall time: 81.3 ms
```

CC:  @mkoeppe

Keywords: polymake, input, output

Branch/Commit: e6fef555f7dfcf2418eb4398c66292ade2c494ce

Reviewer: Matthias Koeppe

Author: Jonathan Kliem

Dependencies: #27745

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/31864





---

archive/issue_comments_451198.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-05-27T07:32:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31864#issuecomment-451198",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_451199.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-27T12:00:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31864#issuecomment-451199",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_451200.json:
```json
{
    "body": "<a id='comment:4'></a>I think it would be better to call `NumberFieldElement_quadratic._polymake_init_` instead of duplicating it",
    "created_at": "2021-05-27T16:39:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31864#issuecomment-451200",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>I think it would be better to call `NumberFieldElement_quadratic._polymake_init_` instead of duplicating it



---

archive/issue_comments_451201.json:
```json
{
    "body": "<a id='comment:5'></a>Good point.",
    "created_at": "2021-05-27T18:11:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31864#issuecomment-451201",
    "user": "https://github.com/kliem"
}
```

<a id='comment:5'></a>Good point.



---

archive/issue_comments_451202.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-27T18:17:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31864#issuecomment-451202",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_451203.json:
```json
{
    "body": "<a id='comment:7'></a>Is #31866 a dependency now?",
    "created_at": "2021-05-27T18:22:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31864#issuecomment-451203",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>Is #31866 a dependency now?



---

archive/issue_comments_451204.json:
```json
{
    "body": "<a id='comment:8'></a>New commits:",
    "created_at": "2021-05-27T18:24:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31864#issuecomment-451204",
    "user": "https://github.com/kliem"
}
```

<a id='comment:8'></a>New commits:



---

archive/issue_comments_451205.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:7 mkoeppe]:\n> Is #31866 a dependency now?\n\n\nNo, of course not. I am starting to pull in stuff into wrong branches...",
    "created_at": "2021-05-27T18:26:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31864#issuecomment-451205",
    "user": "https://github.com/kliem"
}
```

<a id='comment:9'></a>Replying to [comment:7 mkoeppe]:
> Is #31866 a dependency now?


No, of course not. I am starting to pull in stuff into wrong branches...



---

archive/issue_comments_451206.json:
```json
{
    "body": "<a id='comment:10'></a>This is a very nice improvement.",
    "created_at": "2021-05-27T18:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31864#issuecomment-451206",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>This is a very nice improvement.



---

archive/issue_comments_451207.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-05-27T18:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31864#issuecomment-451207",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_451208.json:
```json
{
    "body": "<a id='comment:11'></a>Thank you. Sometimes it is surprising what the bottle neck of a calculation is.",
    "created_at": "2021-05-27T18:41:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31864#issuecomment-451208",
    "user": "https://github.com/kliem"
}
```

<a id='comment:11'></a>Thank you. Sometimes it is surprising what the bottle neck of a calculation is.



---

archive/issue_comments_451209.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2021-07-19T00:20:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31864#issuecomment-451209",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from major to critical.



---

archive/issue_events_084160.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-07-23T20:11:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31864",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31864#event-84160"
}
```



---

archive/issue_comments_451210.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-07-23T20:11:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31864#issuecomment-451210",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
