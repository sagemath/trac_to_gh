# Issue 31691: Turn mixed form algebra into de Rham complex

archive/issues_031454.json:
```json
{
    "body": "We turn the algebra of mixed differential forms into a de Rham complex and add it to the category of `ChainComplexes`, see #31669.\n\nFurthermore, we add de Rham cohomology to SageManifolds with limited functionality. For now, the implementation will only consist of abstract elements that are given by representatives of mixed forms, i.e. we take closed mixed forms, put a bracket around it and do all computations in the algebra of mixed forms. \n\nCC:  @egourgoulhon @tscrim @mkoeppe @jhpalmieri\n\nKeywords: chain_complex\n\nBranch/Commit: 566176a74a480456b7836c13a173e217b721b70a\n\nReviewer: Travis Scrimshaw\n\nAuthor: Michael Jung\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/31691\n\n",
    "closed_at": "2021-06-06T13:17:50Z",
    "created_at": "2021-04-19T10:20:39Z",
    "labels": [
        "component: manifolds"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Turn mixed form algebra into de Rham complex",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31691",
    "user": "https://github.com/mjungmath"
}
```
We turn the algebra of mixed differential forms into a de Rham complex and add it to the category of `ChainComplexes`, see #31669.

Furthermore, we add de Rham cohomology to SageManifolds with limited functionality. For now, the implementation will only consist of abstract elements that are given by representatives of mixed forms, i.e. we take closed mixed forms, put a bracket around it and do all computations in the algebra of mixed forms. 

CC:  @egourgoulhon @tscrim @mkoeppe @jhpalmieri

Keywords: chain_complex

Branch/Commit: 566176a74a480456b7836c13a173e217b721b70a

Reviewer: Travis Scrimshaw

Author: Michael Jung

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/31691





---

archive/issue_comments_480184.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-We turn the algebra of mixed differential forms into a de Rham complex and add it to the category of `ChainComplexes`.\n+We turn the algebra of mixed differential forms into a de Rham complex and add it to the category of `ChainComplexes`, see #31669.\n \n Summary: Make mixed forms to de Rham complex\n \n```\n",
    "created_at": "2021-04-19T10:21:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480184",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,4 @@
-We turn the algebra of mixed differential forms into a de Rham complex and add it to the category of `ChainComplexes`.
+We turn the algebra of mixed differential forms into a de Rham complex and add it to the category of `ChainComplexes`, see #31669.
 
 Summary: Make mixed forms to de Rham complex
 
```




---

archive/issue_comments_480185.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-20T17:10:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480185",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480186.json:
```json
{
    "body": "<a id='comment:5'></a>Here is a first draft. Unfortunately I get an error with the current test:\n\n\n```\nsage: M = Manifold(2, 'M')\nsage: X.<x,y> = M.chart()\nsage: C = M.de_rham_complex()\nsage: d0 = C.differential(0); d0\nException raised:\n...\nValueError: Algebra of differentiable scalar fields on the 2-dimensional differentiable manifold M is not in Category of modules over Algebra of differentiable scalar fields on the 2-dimensional differentiable manifold M\n```\n\nThis is somewhat peculiar. Each algebra should automatically be a module over itself... Should I simply add the category to the scalar field algebra or does that need a broader fix?",
    "created_at": "2021-04-20T17:14:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480186",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:5'></a>Here is a first draft. Unfortunately I get an error with the current test:


```
sage: M = Manifold(2, 'M')
sage: X.<x,y> = M.chart()
sage: C = M.de_rham_complex()
sage: d0 = C.differential(0); d0
Exception raised:
...
ValueError: Algebra of differentiable scalar fields on the 2-dimensional differentiable manifold M is not in Category of modules over Algebra of differentiable scalar fields on the 2-dimensional differentiable manifold M
```

This is somewhat peculiar. Each algebra should automatically be a module over itself... Should I simply add the category to the scalar field algebra or does that need a broader fix?



---

archive/issue_comments_480187.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-20T17:17:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480187",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480188.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:5 gh-mjungmath]:\n> Here is a first draft. Unfortunately I get an error with the current test:\n> \n> \n> \n> ```\n> sage: M = Manifold(2, 'M')\n> sage: X.<x,y> = M.chart()\n> sage: C = M.de_rham_complex()\n> sage: d0 = C.differential(0); d0\n> Exception raised:\n> ...\n> ValueError: Algebra of differentiable scalar fields on the 2-dimensional differentiable manifold M is not in Category of modules over Algebra of differentiable scalar fields on the 2-dimensional differentiable manifold M\n> ```\n> \n> This is somewhat peculiar. Each algebra should automatically be a module over itself... Should I simply add the category to the scalar field algebra or does that need a broader fix?\n\n\nSee #31713.",
    "created_at": "2021-04-22T11:53:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480188",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:8'></a>Replying to [comment:5 gh-mjungmath]:
> Here is a first draft. Unfortunately I get an error with the current test:
> 
> 
> 
> ```
> sage: M = Manifold(2, 'M')
> sage: X.<x,y> = M.chart()
> sage: C = M.de_rham_complex()
> sage: d0 = C.differential(0); d0
> Exception raised:
> ...
> ValueError: Algebra of differentiable scalar fields on the 2-dimensional differentiable manifold M is not in Category of modules over Algebra of differentiable scalar fields on the 2-dimensional differentiable manifold M
> ```
> 
> This is somewhat peculiar. Each algebra should automatically be a module over itself... Should I simply add the category to the scalar field algebra or does that need a broader fix?


See #31713.



---

archive/issue_comments_480189.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-22T21:21:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480189",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480190.json:
```json
{
    "body": "<a id='comment:10'></a>This draft should already reflect what I have in mind. Comments are welcome.",
    "created_at": "2021-04-22T21:23:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480190",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:10'></a>This draft should already reflect what I have in mind. Comments are welcome.



---

archive/issue_comments_480191.json:
```json
{
    "body": "<a id='comment:11'></a>I must apologize. I was extremely sloppy here: differentials are *no* morphisms in the category of modules over scalar fields, they are morphisms in the category of modules over `K`!\n\nI'll fix this.",
    "created_at": "2021-04-23T09:34:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480191",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:11'></a>I must apologize. I was extremely sloppy here: differentials are *no* morphisms in the category of modules over scalar fields, they are morphisms in the category of modules over `K`!

I'll fix this.



---

archive/issue_comments_480192.json:
```json
{
    "body": "<a id='comment:12'></a>That was expected. Same problem, but now with differential form modules not considered as vector spaces.\n\nThere should be *some* way to define these morphisms, no?",
    "created_at": "2021-04-23T18:32:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480192",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:12'></a>That was expected. Same problem, but now with differential form modules not considered as vector spaces.

There should be *some* way to define these morphisms, no?



---

archive/issue_comments_480193.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-04-26T10:36:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480193",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_480194.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-04-26T10:37:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480194",
    "user": "https://github.com/mjungmath"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_480195.json:
```json
{
    "body": "<a id='comment:14'></a>Ready for review.",
    "created_at": "2021-04-26T10:37:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480195",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:14'></a>Ready for review.



---

archive/issue_comments_480196.json:
```json
{
    "body": "<a id='comment:15'></a>This is just a first step.\n\nMy idea (not for this ticket): Optimally, we want to cover our manifold by contractible chart domains. Therefore it would be helpful if we could determine whether an open subset is contractible or not. Perhaps this needs some input from the user. But then, we can probably check for exactness (I still have to think about it) and, other than that, construct Cech cohomology.",
    "created_at": "2021-04-26T10:44:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480196",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:15'></a>This is just a first step.

My idea (not for this ticket): Optimally, we want to cover our manifold by contractible chart domains. Therefore it would be helpful if we could determine whether an open subset is contractible or not. Perhaps this needs some input from the user. But then, we can probably check for exactness (I still have to think about it) and, other than that, construct Cech cohomology.



---

archive/issue_comments_480197.json:
```json
{
    "body": "<a id='comment:16'></a>P.S. I said \"simply connected\" in the first place, but of course I meant *contractible*.",
    "created_at": "2021-04-26T12:30:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480197",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:16'></a>P.S. I said "simply connected" in the first place, but of course I meant *contractible*.



---

archive/issue_comments_480198.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n+We turn the algebra of mixed differential forms into a de Rham complex and add it to the category of `ChainComplexes`, see #31669.\n \n+Furthermore, we add de Rham cohomology to SageManifolds with limited functionality. For now, the implementation will only consist of abstract elements that are given by representatives of mixed forms, i.e. we take closed mixed forms (with check?), put a bracket around it and do all computations in the algebra of mixed forms. \n \n Summary: Make mixed forms to de Rham complex\n \n```\n",
    "created_at": "2021-04-26T17:47:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480198",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,6 @@
+We turn the algebra of mixed differential forms into a de Rham complex and add it to the category of `ChainComplexes`, see #31669.
 
+Furthermore, we add de Rham cohomology to SageManifolds with limited functionality. For now, the implementation will only consist of abstract elements that are given by representatives of mixed forms, i.e. we take closed mixed forms (with check?), put a bracket around it and do all computations in the algebra of mixed forms. 
 
 Summary: Make mixed forms to de Rham complex
 
```




---

archive/issue_comments_480199.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n+We turn the algebra of mixed differential forms into a de Rham complex and add it to the category of `ChainComplexes`, see #31669.\n \n+Furthermore, we add de Rham cohomology to SageManifolds with limited functionality. For now, the implementation will only consist of abstract elements that are given by representatives of mixed forms, i.e. we take closed mixed forms, put a bracket around it and do all computations in the algebra of mixed forms. \n \n Summary: Make mixed forms to de Rham complex\n \n```\n",
    "created_at": "2021-04-26T17:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480199",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,6 @@
+We turn the algebra of mixed differential forms into a de Rham complex and add it to the category of `ChainComplexes`, see #31669.
 
+Furthermore, we add de Rham cohomology to SageManifolds with limited functionality. For now, the implementation will only consist of abstract elements that are given by representatives of mixed forms, i.e. we take closed mixed forms, put a bracket around it and do all computations in the algebra of mixed forms. 
 
 Summary: Make mixed forms to de Rham complex
 
```




---

archive/issue_comments_480200.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-28T07:22:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480200",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480201.json:
```json
{
    "body": "<a id='comment:22'></a>Patchbot green.",
    "created_at": "2021-04-28T11:33:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480201",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:22'></a>Patchbot green.



---

archive/issue_comments_480202.json:
```json
{
    "body": "<a id='comment:24'></a>I think it would be best to split off the cohomology ring into a separate file.\n\nDo you want to give a special (latex) name to `zero` and `one`?\n\nFor the class-level docstring of `DeRahmComologyRing`:\n\n```diff\n-Define the de Rham cohomology ring of a de Rham complex.\nThe de Rham cohomology ring of a de Rham complex.\n```\n\nI don't think you should assume that the parents are the same for `cup` (unlike what you can do for `_mul_`).\n\nIn your `cohomology()` method, you have both `\\left.` and `\\right.`. I don't understand the point of this.\n\nThe input block to `differential()` is over-indented. Also, remove the full-stop/period.",
    "created_at": "2021-04-30T06:21:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480202",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:24'></a>I think it would be best to split off the cohomology ring into a separate file.

Do you want to give a special (latex) name to `zero` and `one`?

For the class-level docstring of `DeRahmComologyRing`:

```diff
-Define the de Rham cohomology ring of a de Rham complex.
The de Rham cohomology ring of a de Rham complex.
```

I don't think you should assume that the parents are the same for `cup` (unlike what you can do for `_mul_`).

In your `cohomology()` method, you have both `\left.` and `\right.`. I don't understand the point of this.

The input block to `differential()` is over-indented. Also, remove the full-stop/period.



---

archive/issue_comments_480203.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [comment:24 tscrim]:\n> I think it would be best to split off the cohomology ring into a separate file.\n\n\nSounds reasonable.\n\n> \n> Do you want to give a special (latex) name to `zero` and `one`?\n> \n\n\nI don't think so. That would make more sense if we can distinguish cohomology classes properly.\n\n> For the class-level docstring of `DeRahmComologyRing`:\n> \n> ```diff\n> -Define the de Rham cohomology ring of a de Rham complex.\n> The de Rham cohomology ring of a de Rham complex.\n> ```\n\n\nThanks, done.\n\n> I don't think you should assume that the parents are the same for `cup` (unlike what you can do for `_mul_`).\n\n\nWhat do you mean?\n\n> In your `cohomology()` method, you have both `\\left.` and `\\right.`. I don't understand the point of this.\n\n\nThe point is that `\\middle/` has the appropriate size.\n\n> The input block to `differential()` is over-indented. Also, remove the full-stop/period.\n\n\nThanks, done.",
    "created_at": "2021-04-30T08:04:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480203",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:25'></a>Replying to [comment:24 tscrim]:
> I think it would be best to split off the cohomology ring into a separate file.


Sounds reasonable.

> 
> Do you want to give a special (latex) name to `zero` and `one`?
> 


I don't think so. That would make more sense if we can distinguish cohomology classes properly.

> For the class-level docstring of `DeRahmComologyRing`:
> 
> ```diff
> -Define the de Rham cohomology ring of a de Rham complex.
> The de Rham cohomology ring of a de Rham complex.
> ```


Thanks, done.

> I don't think you should assume that the parents are the same for `cup` (unlike what you can do for `_mul_`).


What do you mean?

> In your `cohomology()` method, you have both `\left.` and `\right.`. I don't understand the point of this.


The point is that `\middle/` has the appropriate size.

> The input block to `differential()` is over-indented. Also, remove the full-stop/period.


Thanks, done.



---

archive/issue_comments_480204.json:
```json
{
    "body": "<a id='comment:26'></a>Replying to [comment:25 gh-mjungmath]:\n> Replying to [comment:24 tscrim]:\n> > I don't think you should assume that the parents are the same for `cup` (unlike what you can do for `_mul_`).\n\n> \n> What do you mean?\n\n\nIf you take the `cup` with something the coerces in (perhaps `2`?) but is not actually an element of the same parent, then it will either fail or could end up with an element that is not actually in the ring. However, for `_mul_`, this can never happen because the coercion framework would make sure both arguments belong to the same parent.",
    "created_at": "2021-04-30T08:08:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480204",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:26'></a>Replying to [comment:25 gh-mjungmath]:
> Replying to [comment:24 tscrim]:
> > I don't think you should assume that the parents are the same for `cup` (unlike what you can do for `_mul_`).

> 
> What do you mean?


If you take the `cup` with something the coerces in (perhaps `2`?) but is not actually an element of the same parent, then it will either fail or could end up with an element that is not actually in the ring. However, for `_mul_`, this can never happen because the coercion framework would make sure both arguments belong to the same parent.



---

archive/issue_comments_480205.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:26 tscrim]:\n> Replying to [comment:25 gh-mjungmath]:\n> > Replying to [comment:24 tscrim]:\n> > > I don't think you should assume that the parents are the same for `cup` (unlike what you can do for `_mul_`).\n\n> > \n> > What do you mean?\n\n> \n> If you take the `cup` with something the coerces in (perhaps `2`?) but is not actually an element of the same parent, then it will either fail or could end up with an element that is not actually in the ring. However, for `_mul_`, this can never happen because the coercion framework would make sure both arguments belong to the same parent.\n\n\nCurrently, there is not even a natural coercion implemented. The only coercion that would be admissible is the one from closed differential forms (and everything that is contained in it) into cohomology, but we don't have that subspace implemented. Therefore, it wouldn't even work with `_mul_`.",
    "created_at": "2021-04-30T08:12:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480205",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:27'></a>Replying to [comment:26 tscrim]:
> Replying to [comment:25 gh-mjungmath]:
> > Replying to [comment:24 tscrim]:
> > > I don't think you should assume that the parents are the same for `cup` (unlike what you can do for `_mul_`).

> > 
> > What do you mean?

> 
> If you take the `cup` with something the coerces in (perhaps `2`?) but is not actually an element of the same parent, then it will either fail or could end up with an element that is not actually in the ring. However, for `_mul_`, this can never happen because the coercion framework would make sure both arguments belong to the same parent.


Currently, there is not even a natural coercion implemented. The only coercion that would be admissible is the one from closed differential forms (and everything that is contained in it) into cohomology, but we don't have that subspace implemented. Therefore, it wouldn't even work with `_mul_`.



---

archive/issue_comments_480206.json:
```json
{
    "body": "<a id='comment:28'></a>Replying to [comment:27 gh-mjungmath]:\n> Replying to [comment:26 tscrim]:\n> > Replying to [comment:25 gh-mjungmath]:\n> > > Replying to [comment:24 tscrim]:\n> > > > I don't think you should assume that the parents are the same for `cup` (unlike what you can do for `_mul_`).\n\n> > > \n> > > What do you mean?\n\n> > \n> > If you take the `cup` with something the coerces in (perhaps `2`?) but is not actually an element of the same parent, then it will either fail or could end up with an element that is not actually in the ring. However, for `_mul_`, this can never happen because the coercion framework would make sure both arguments belong to the same parent.\n\n> \n> Currently, there is not even a natural coercion implemented. The only coercion that would be admissible is the one from closed differential forms (and everything that is contained in it) into cohomology, but we don't have that subspace implemented. Therefore, it wouldn't even work with `_mul_`.\n\n\nHowever, it will fail with a much more reasonable message and it will be all setup for when there is a coercion implemented. Most importantly, it will handle the natural coercion from the scalar field into the ring, but `cup` will not. You should have `cup` simply redirect to `*`. This will also make it easier if this ever gets subclassed too.",
    "created_at": "2021-04-30T11:34:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480206",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:28'></a>Replying to [comment:27 gh-mjungmath]:
> Replying to [comment:26 tscrim]:
> > Replying to [comment:25 gh-mjungmath]:
> > > Replying to [comment:24 tscrim]:
> > > > I don't think you should assume that the parents are the same for `cup` (unlike what you can do for `_mul_`).

> > > 
> > > What do you mean?

> > 
> > If you take the `cup` with something the coerces in (perhaps `2`?) but is not actually an element of the same parent, then it will either fail or could end up with an element that is not actually in the ring. However, for `_mul_`, this can never happen because the coercion framework would make sure both arguments belong to the same parent.

> 
> Currently, there is not even a natural coercion implemented. The only coercion that would be admissible is the one from closed differential forms (and everything that is contained in it) into cohomology, but we don't have that subspace implemented. Therefore, it wouldn't even work with `_mul_`.


However, it will fail with a much more reasonable message and it will be all setup for when there is a coercion implemented. Most importantly, it will handle the natural coercion from the scalar field into the ring, but `cup` will not. You should have `cup` simply redirect to `*`. This will also make it easier if this ever gets subclassed too.



---

archive/issue_comments_480207.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:28 tscrim]:\n> However, it will fail with a much more reasonable message and it will be all setup for when there is a coercion implemented. Most importantly, it will handle the natural coercion from the scalar field into the ring, but `cup` will not. You should have `cup` simply redirect to `*`. This will also make it easier if this ever gets subclassed too.\n\n\nIt will get subclassed. My idea is that a characteristic class becomes a subclass of `DeRhamCohomologyClass` with a dedicated `representative` method.",
    "created_at": "2021-04-30T16:24:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480207",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:29'></a>Replying to [comment:28 tscrim]:
> However, it will fail with a much more reasonable message and it will be all setup for when there is a coercion implemented. Most importantly, it will handle the natural coercion from the scalar field into the ring, but `cup` will not. You should have `cup` simply redirect to `*`. This will also make it easier if this ever gets subclassed too.


It will get subclassed. My idea is that a characteristic class becomes a subclass of `DeRhamCohomologyClass` with a dedicated `representative` method.



---

archive/issue_comments_480208.json:
```json
{
    "body": "<a id='comment:30'></a>So your idea is good. I will redirect `cup` to the product.",
    "created_at": "2021-04-30T16:25:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480208",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:30'></a>So your idea is good. I will redirect `cup` to the product.



---

archive/issue_comments_480209.json:
```json
{
    "body": "<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-30T21:39:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480209",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480210.json:
```json
{
    "body": "<a id='comment:32'></a>Commit pushed. Wait for patchbot.",
    "created_at": "2021-04-30T21:41:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480210",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:32'></a>Commit pushed. Wait for patchbot.



---

archive/issue_comments_480211.json:
```json
{
    "body": "<a id='comment:33'></a>Green bot => positive review",
    "created_at": "2021-04-30T22:11:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480211",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:33'></a>Green bot => positive review



---

archive/issue_comments_480212.json:
```json
{
    "body": "<a id='comment:34'></a>Morally green?",
    "created_at": "2021-05-01T10:08:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480212",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:34'></a>Morally green?



---

archive/issue_comments_480213.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-05-02T01:44:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480213",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_480214.json:
```json
{
    "body": "<a id='comment:36'></a>Thanks for the review!",
    "created_at": "2021-05-08T13:25:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480214",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:36'></a>Thanks for the review!



---

archive/issue_events_083557.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-06-06T13:17:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31691#event-83557"
}
```



---

archive/issue_comments_480215.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-06-06T13:17:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31691",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31691#issuecomment-480215",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
