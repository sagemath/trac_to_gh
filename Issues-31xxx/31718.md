# Issue 31718: ManifoldSubset: Change some methods to generators

archive/issues_031481.json:
```json
{
    "body": "This ticket proposes to change some methods that currently return lists to generators - like the method `open_supersets` added in #31677. This is in line with the changes in the Python standard library when we moved from Python 2 to 3.\n\n`ManifoldSubset`:\n- `open_covers()` currently returns a list of lists\n  - change to generator of `ManifoldSubsetFiniteFamily` instances \n  - add optional argument `trivial` to simplify the common use case that only needs the nontrivial open covers\n\n- `subsets()` currently returns a `frozenset`\n  - change to generator of `ManifoldSubset` instances\n\nThese API changes will probably make some updates to sage.manifolds worksheets that are maintained outside of the Sage tree necessary.\n\n\nFollow-up for some methods of `Manifold` in #31720.\n\n\nCC:  @mjungmath @egourgoulhon @tscrim\n\nBranch/Commit: e026e7a68095577277de1b32df0f8c446b594aa7\n\nReviewer: Eric Gourgoulhon\n\nAuthor: Matthias Koeppe\n\nDependencies: #31680\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/31718\n\n",
    "closed_at": "2021-06-21T21:17:33Z",
    "created_at": "2021-04-22T20:45:20Z",
    "labels": [
        "component: manifolds"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "ManifoldSubset: Change some methods to generators",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31718",
    "user": "https://github.com/mkoeppe"
}
```
This ticket proposes to change some methods that currently return lists to generators - like the method `open_supersets` added in #31677. This is in line with the changes in the Python standard library when we moved from Python 2 to 3.

`ManifoldSubset`:
- `open_covers()` currently returns a list of lists
  - change to generator of `ManifoldSubsetFiniteFamily` instances 
  - add optional argument `trivial` to simplify the common use case that only needs the nontrivial open covers

- `subsets()` currently returns a `frozenset`
  - change to generator of `ManifoldSubset` instances

These API changes will probably make some updates to sage.manifolds worksheets that are maintained outside of the Sage tree necessary.


Follow-up for some methods of `Manifold` in #31720.


CC:  @mjungmath @egourgoulhon @tscrim

Branch/Commit: e026e7a68095577277de1b32df0f8c446b594aa7

Reviewer: Eric Gourgoulhon

Author: Matthias Koeppe

Dependencies: #31680

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/31718





---

archive/issue_comments_480599.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,7 +2,7 @@\n \n `ManifoldSubset`:\n - `open_covers()` currently returns a list of lists\n-  - change to generator of `FiniteManifoldSubsetFamily` instances \n+  - change to generator of `ManifoldSubsetFiniteFamily` instances \n \n - `subsets()` currently returns a `frozenset`\n   - change to generator of `ManifoldSubset` instances\n@@ -12,6 +12,7 @@\n   - change to generator of charts\n - `coord_changes()` currently returns a copy\n   - change to generator of pairs `((from, to), map)` ... so that `dict(M.coord_changes())` will create the copy\n+     \n \n Dependencies: #31680\n \n``````\n",
    "created_at": "2021-04-23T16:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31718#issuecomment-480599",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,7 +2,7 @@
 
 `ManifoldSubset`:
 - `open_covers()` currently returns a list of lists
-  - change to generator of `FiniteManifoldSubsetFamily` instances 
+  - change to generator of `ManifoldSubsetFiniteFamily` instances 
 
 - `subsets()` currently returns a `frozenset`
   - change to generator of `ManifoldSubset` instances
@@ -12,6 +12,7 @@
   - change to generator of charts
 - `coord_changes()` currently returns a copy
   - change to generator of pairs `((from, to), map)` ... so that `dict(M.coord_changes())` will create the copy
+     
 
 Dependencies: #31680
 
``````




---

archive/issue_comments_480600.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2021-04-23T16:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31718#issuecomment-480600",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_480601.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,19 @@\n+This ticket proposes to change some methods that currently return lists to generators - like the method `open_supersets` added in #31677. This is in line with the changes in the Python standard library when we moved from Python 2 to 3.\n \n+`ManifoldSubset`:\n+- `open_covers()` currently returns a list of lists\n+  - change to generator of `ManifoldSubsetFiniteFamily` instances \n+  - add optional argument `trivial` to simplify the common use case that only needs nontrivial open covers\n+\n+- `subsets()` currently returns a `frozenset`\n+  - change to generator of `ManifoldSubset` instances\n+\n+`Manifold`:\n+- `top_charts()` currently returns a list\n+  - change to generator of charts\n+- `coord_changes()` currently returns a copy\n+  - change to generator of pairs `((from, to), map)` ... so that `dict(M.coord_changes())` will create the copy\n+     \n \n Dependencies: #31680\n \n``````\n",
    "created_at": "2021-04-23T16:54:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31718#issuecomment-480601",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,19 @@
+This ticket proposes to change some methods that currently return lists to generators - like the method `open_supersets` added in #31677. This is in line with the changes in the Python standard library when we moved from Python 2 to 3.
 
+`ManifoldSubset`:
+- `open_covers()` currently returns a list of lists
+  - change to generator of `ManifoldSubsetFiniteFamily` instances 
+  - add optional argument `trivial` to simplify the common use case that only needs nontrivial open covers
+
+- `subsets()` currently returns a `frozenset`
+  - change to generator of `ManifoldSubset` instances
+
+`Manifold`:
+- `top_charts()` currently returns a list
+  - change to generator of charts
+- `coord_changes()` currently returns a copy
+  - change to generator of pairs `((from, to), map)` ... so that `dict(M.coord_changes())` will create the copy
+     
 
 Dependencies: #31680
 
``````




---

archive/issue_comments_480602.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2021-04-23T17:02:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31718#issuecomment-480602",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_480603.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-04-23T17:06:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31718#issuecomment-480603",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_480604.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,14 @@\n+This ticket proposes to change some methods that currently return lists to generators - like the method `open_supersets` added in #31677. This is in line with the changes in the Python standard library when we moved from Python 2 to 3.\n+\n+`ManifoldSubset`:\n+- `open_covers()` currently returns a list of lists\n+  - change to generator of `ManifoldSubsetFiniteFamily` instances \n+  - add optional argument `trivial` to simplify the common use case that only needs the nontrivial open covers\n+\n+- `subsets()` currently returns a `frozenset`\n+  - change to generator of `ManifoldSubset` instances\n+\n+Follow-up for some methods of `Manifold` in #31720.\n \n \n Dependencies: #31680\n``````\n",
    "created_at": "2021-04-23T17:06:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31718#issuecomment-480604",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,14 @@
+This ticket proposes to change some methods that currently return lists to generators - like the method `open_supersets` added in #31677. This is in line with the changes in the Python standard library when we moved from Python 2 to 3.
+
+`ManifoldSubset`:
+- `open_covers()` currently returns a list of lists
+  - change to generator of `ManifoldSubsetFiniteFamily` instances 
+  - add optional argument `trivial` to simplify the common use case that only needs the nontrivial open covers
+
+- `subsets()` currently returns a `frozenset`
+  - change to generator of `ManifoldSubset` instances
+
+Follow-up for some methods of `Manifold` in #31720.
 
 
 Dependencies: #31680
``````




---

archive/issue_comments_480605.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-23T17:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31718#issuecomment-480605",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480606.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,17 @@\n+This ticket proposes to change some methods that currently return lists to generators - like the method `open_supersets` added in #31677. This is in line with the changes in the Python standard library when we moved from Python 2 to 3.\n+\n+`ManifoldSubset`:\n+- `open_covers()` currently returns a list of lists\n+  - change to generator of `ManifoldSubsetFiniteFamily` instances \n+  - add optional argument `trivial` to simplify the common use case that only needs the nontrivial open covers\n+\n+- `subsets()` currently returns a `frozenset`\n+  - change to generator of `ManifoldSubset` instances\n+\n+These API changes will probably make some updates to sage.manifolds worksheets that are maintained outside of the Sage tree necessary.\n+\n+\n+Follow-up for some methods of `Manifold` in #31720.\n \n \n Dependencies: #31680\n``````\n",
    "created_at": "2021-04-24T19:15:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31718#issuecomment-480606",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,17 @@
+This ticket proposes to change some methods that currently return lists to generators - like the method `open_supersets` added in #31677. This is in line with the changes in the Python standard library when we moved from Python 2 to 3.
+
+`ManifoldSubset`:
+- `open_covers()` currently returns a list of lists
+  - change to generator of `ManifoldSubsetFiniteFamily` instances 
+  - add optional argument `trivial` to simplify the common use case that only needs the nontrivial open covers
+
+- `subsets()` currently returns a `frozenset`
+  - change to generator of `ManifoldSubset` instances
+
+These API changes will probably make some updates to sage.manifolds worksheets that are maintained outside of the Sage tree necessary.
+
+
+Follow-up for some methods of `Manifold` in #31720.
 
 
 Dependencies: #31680
``````




---

archive/issue_comments_480607.json:
```json
{
    "body": "<a id='comment:8'></a>LGTM. Thanks!",
    "created_at": "2021-04-25T08:28:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31718#issuecomment-480607",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:8'></a>LGTM. Thanks!



---

archive/issue_comments_480608.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-04-25T08:28:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31718#issuecomment-480608",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_480609.json:
```json
{
    "body": "<a id='comment:9'></a>Thanks for reviewing!",
    "created_at": "2021-04-25T10:27:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31718#issuecomment-480609",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>Thanks for reviewing!



---

archive/issue_comments_480610.json:
```json
{
    "body": "<a id='comment:10'></a>I assume it has a purpose, but just out of curiosity: why do you make a difference between families of manifold objects and families of manifold subsets? Do you have a further usage in mind other than just subsets? Because all the examples you provide are still with subsets.",
    "created_at": "2021-04-26T21:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31718#issuecomment-480610",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:10'></a>I assume it has a purpose, but just out of curiosity: why do you make a difference between families of manifold objects and families of manifold subsets? Do you have a further usage in mind other than just subsets? Because all the examples you provide are still with subsets.



---

archive/issue_comments_480611.json:
```json
{
    "body": "<a id='comment:11'></a>I can imagine this can be useful for frames whose domains cover the manifold? Perhaps this is a more suitable example for the non-subset case to show the difference?\n\nSome time ago I provided a helper function `_get_min_covering` (can be found in `manifolds/manifold.py`) to obtain a minimal amount of manifold objects necessary to cover the manifold. It looks like this method is more suited within the family class you just provided.\n\nAnother example in the field I could imagine is for orientations. An orientation is given by a family of charts/frames, too, but yet not implemented as such.",
    "created_at": "2021-04-26T21:27:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31718#issuecomment-480611",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:11'></a>I can imagine this can be useful for frames whose domains cover the manifold? Perhaps this is a more suitable example for the non-subset case to show the difference?

Some time ago I provided a helper function `_get_min_covering` (can be found in `manifolds/manifold.py`) to obtain a minimal amount of manifold objects necessary to cover the manifold. It looks like this method is more suited within the family class you just provided.

Another example in the field I could imagine is for orientations. An orientation is given by a family of charts/frames, too, but yet not implemented as such.



---

archive/issue_comments_480612.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:10 gh-mjungmath]:\n> I assume it has a purpose, but just out of curiosity: why do you make a difference between families of manifold objects and families of manifold subsets? Do you have a further usage in mind other than just subsets?\n\n\nYes, in #31732 I use `ManifoldObjectFiniteFamily` directly for the family of open covers. Its elements are `ManifoldSubsetFiniteFamily` instances.\n\nI agree that charts/frames are likely to benefit from becoming finite families too. This will also need a separate subclass because they are indexed not by names but by coordinate tuples.",
    "created_at": "2021-04-26T23:01:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31718#issuecomment-480612",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>Replying to [comment:10 gh-mjungmath]:
> I assume it has a purpose, but just out of curiosity: why do you make a difference between families of manifold objects and families of manifold subsets? Do you have a further usage in mind other than just subsets?


Yes, in #31732 I use `ManifoldObjectFiniteFamily` directly for the family of open covers. Its elements are `ManifoldSubsetFiniteFamily` instances.

I agree that charts/frames are likely to benefit from becoming finite families too. This will also need a separate subclass because they are indexed not by names but by coordinate tuples.



---

archive/issue_comments_480613.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:12 mkoeppe]:\n> Replying to [comment:10 gh-mjungmath]:\n> > I assume it has a purpose, but just out of curiosity: why do you make a difference between families of manifold objects and families of manifold subsets? Do you have a further usage in mind other than just subsets?\n\n> \n> Yes, in #31732 I use `ManifoldObjectFiniteFamily` directly for the family of open covers. Its elements are `ManifoldSubsetFiniteFamily` instances.\n\n\nAlright, that makes sense. Just a personal taste: I think its better to add some distinct examples to `ManifoldObjectFiniteFamily` to clarify the difference to `ManifoldSubsetFiniteFamily`.\n\n> I agree that charts/frames are likely to benefit from becoming finite families too. This will also need a separate subclass because they are indexed not by names but by coordinate tuples.\n\n\nRight. But don't you think it should rather be a new common parent class both inherit from?\n\nIn any case, this is something definitely need, indeed!",
    "created_at": "2021-04-27T09:14:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31718#issuecomment-480613",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:13'></a>Replying to [comment:12 mkoeppe]:
> Replying to [comment:10 gh-mjungmath]:
> > I assume it has a purpose, but just out of curiosity: why do you make a difference between families of manifold objects and families of manifold subsets? Do you have a further usage in mind other than just subsets?

> 
> Yes, in #31732 I use `ManifoldObjectFiniteFamily` directly for the family of open covers. Its elements are `ManifoldSubsetFiniteFamily` instances.


Alright, that makes sense. Just a personal taste: I think its better to add some distinct examples to `ManifoldObjectFiniteFamily` to clarify the difference to `ManifoldSubsetFiniteFamily`.

> I agree that charts/frames are likely to benefit from becoming finite families too. This will also need a separate subclass because they are indexed not by names but by coordinate tuples.


Right. But don't you think it should rather be a new common parent class both inherit from?

In any case, this is something definitely need, indeed!



---

archive/issue_comments_480614.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 gh-mjungmath]:\n> I think its better to add some distinct examples to `ManifoldObjectFiniteFamily` to clarify the difference to `ManifoldSubsetFiniteFamily`.\n\n\nSure, let's do that when we introduce some more applications to families.\n\n> Replying to [comment:12 mkoeppe]:\n> > I agree that charts/frames are likely to benefit from becoming finite families too. This will also need a separate subclass because they are indexed not by names but by coordinate tuples.\n\n> \n> Right. But don't you think it should rather be a new common parent class both inherit from?\n\n\nSure, that makes sense.\n\n> In any case, this is something definitely need, indeed!\n\n\nLet's take this discussion to #31720 (Manifold: Change some methods to generators), which introduces generators for charts. Families could be introduced in the same ticket -- but I will need some guidance there what the keys should be.",
    "created_at": "2021-04-27T17:43:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31718#issuecomment-480614",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>Replying to [comment:13 gh-mjungmath]:
> I think its better to add some distinct examples to `ManifoldObjectFiniteFamily` to clarify the difference to `ManifoldSubsetFiniteFamily`.


Sure, let's do that when we introduce some more applications to families.

> Replying to [comment:12 mkoeppe]:
> > I agree that charts/frames are likely to benefit from becoming finite families too. This will also need a separate subclass because they are indexed not by names but by coordinate tuples.

> 
> Right. But don't you think it should rather be a new common parent class both inherit from?


Sure, that makes sense.

> In any case, this is something definitely need, indeed!


Let's take this discussion to #31720 (Manifold: Change some methods to generators), which introduces generators for charts. Families could be introduced in the same ticket -- but I will need some guidance there what the keys should be.



---

archive/issue_events_083623.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-06-21T21:17:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31718",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31718#event-83623"
}
```



---

archive/issue_comments_480615.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-06-21T21:17:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31718",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31718#issuecomment-480615",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
