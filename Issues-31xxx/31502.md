# Issue 31502: GH Actions: Free more disk space

archive/issues_031265.json:
```json
{
    "body": "Some of the docker-based tests run out of disk space, for example\n`ubuntu-focal-standard` (https://github.com/mkoeppe/sage/runs/2116657496).\n\nWe uninstall some large unused preinstalled packages.\n\n\nCC:  @kliem @slel\n\nKeywords: docker\n\nBranch/Commit: 1bed9d5ab1be334afb41f2552b1e99a01e3355b1\n\nReviewer: Jonathan Kliem\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/31502\n\n",
    "closed_at": "2021-04-05T19:42:21Z",
    "created_at": "2021-03-16T01:56:52Z",
    "labels": [
        "component: porting",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "GH Actions: Free more disk space",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31502",
    "user": "https://github.com/mkoeppe"
}
```
Some of the docker-based tests run out of disk space, for example
`ubuntu-focal-standard` (https://github.com/mkoeppe/sage/runs/2116657496).

We uninstall some large unused preinstalled packages.


CC:  @kliem @slel

Keywords: docker

Branch/Commit: 1bed9d5ab1be334afb41f2552b1e99a01e3355b1

Reviewer: Jonathan Kliem

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/31502





---

archive/issue_comments_625763.json:
```json
{
    "body": "Changing keywords from \"\" to \"docker\".",
    "created_at": "2021-03-16T09:22:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625763",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "docker".



---

archive/issue_comments_625764.json:
```json
{
    "body": "<a id='comment:1'></a>Possibly related: #29849.",
    "created_at": "2021-03-16T09:22:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625764",
    "user": "https://github.com/slel"
}
```

<a id='comment:1'></a>Possibly related: #29849.



---

archive/issue_comments_625765.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/gh_actions__free_more_disk_space\"",
    "created_at": "2021-03-17T04:27:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625765",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/gh_actions__free_more_disk_space"



---

archive/issue_comments_625766.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-03-17T04:29:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625766",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_625767.json:
```json
{
    "body": "Changing commit from \"\" to \"1bed9d5ab1be334afb41f2552b1e99a01e3355b1\"",
    "created_at": "2021-03-17T04:29:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625767",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "1bed9d5ab1be334afb41f2552b1e99a01e3355b1"



---

archive/issue_comments_625768.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2021-03-17T04:29:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625768",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_625769.json:
```json
{
    "body": "<a id='comment:3'></a>New commits:",
    "created_at": "2021-03-17T04:29:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625769",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>New commits:



---

archive/issue_comments_625770.json:
```json
{
    "body": "<a id='comment:4'></a>This can be seen in action in https://github.com/mkoeppe/sage/runs/2127941282 (see output in \"free disk space\" and \"install test prerequisites\" - it frees about 7GB of space.",
    "created_at": "2021-03-17T19:46:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625770",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>This can be seen in action in https://github.com/mkoeppe/sage/runs/2127941282 (see output in "free disk space" and "install test prerequisites" - it frees about 7GB of space.



---

archive/issue_comments_625771.json:
```json
{
    "body": "Changing reviewer from \"\" to \"https://github.com/mkoeppe/sage/runs/2127941282\"",
    "created_at": "2021-03-17T19:46:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625771",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "" to "https://github.com/mkoeppe/sage/runs/2127941282"



---

archive/issue_comments_625772.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,5 @@\n Some of the docker-based tests run out of disk space, for example\n `ubuntu-focal-standard` (https://github.com/mkoeppe/sage/runs/2116657496).\n \n+We uninstall some large unused preinstalled packages.\n \n``````\n",
    "created_at": "2021-03-17T19:46:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625772",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,5 @@
 Some of the docker-based tests run out of disk space, for example
 `ubuntu-focal-standard` (https://github.com/mkoeppe/sage/runs/2116657496).
 
+We uninstall some large unused preinstalled packages.
 
``````




---

archive/issue_comments_625773.json:
```json
{
    "body": "<a id='comment:5'></a>Fixes `ubuntu-focal-standard` - as can be seen in https://github.com/mkoeppe/sage/runs/2135025352",
    "created_at": "2021-03-18T06:11:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625773",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>Fixes `ubuntu-focal-standard` - as can be seen in https://github.com/mkoeppe/sage/runs/2135025352



---

archive/issue_comments_625774.json:
```json
{
    "body": "<a id='comment:6'></a>LGTM.",
    "created_at": "2021-03-23T08:58:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625774",
    "user": "https://github.com/kliem"
}
```

<a id='comment:6'></a>LGTM.



---

archive/issue_comments_625775.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-03-23T08:58:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625775",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_625776.json:
```json
{
    "body": "Changing reviewer from \"https://github.com/mkoeppe/sage/runs/2127941282\" to \"Jonathan Kliem\"",
    "created_at": "2021-03-23T08:58:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625776",
    "user": "https://github.com/kliem"
}
```

Changing reviewer from "https://github.com/mkoeppe/sage/runs/2127941282" to "Jonathan Kliem"



---

archive/issue_comments_625777.json:
```json
{
    "body": "<a id='comment:7'></a>Thanks!",
    "created_at": "2021-03-23T17:19:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625777",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>Thanks!



---

archive/issue_comments_625778.json:
```json
{
    "body": "<a id='comment:8'></a>Setting priority to blocker to bring this ticket to the attention of the release bot.",
    "created_at": "2021-03-29T23:54:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625778",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>Setting priority to blocker to bring this ticket to the attention of the release bot.



---

archive/issue_comments_625779.json:
```json
{
    "body": "Changing priority from critical to blocker.",
    "created_at": "2021-03-29T23:54:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625779",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from critical to blocker.



---

archive/issue_comments_625780.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2021-04-01T00:12:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625780",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_625781.json:
```json
{
    "body": "<a id='comment:10'></a>Obviously a blocker because it blocks us from demonstrating that Sage builds and tests correctly on the supported platform `ubuntu-focal-standard`.",
    "created_at": "2021-04-01T00:12:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625781",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>Obviously a blocker because it blocks us from demonstrating that Sage builds and tests correctly on the supported platform `ubuntu-focal-standard`.



---

archive/issue_comments_625782.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [mkoeppe](#comment%3A10):\n> Obviously a blocker because it blocks us from demonstrating that Sage builds and tests correctly on the supported platform `ubuntu-focal-standard`.\n\n\nThis ticket only changes files in `.github/workflows/`\nThis ticket can't break anything but the github workflows itself (and it doesn't break those).",
    "created_at": "2021-04-01T06:15:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625782",
    "user": "https://github.com/kliem"
}
```

<a id='comment:11'></a>Replying to [mkoeppe](#comment%3A10):
> Obviously a blocker because it blocks us from demonstrating that Sage builds and tests correctly on the supported platform `ubuntu-focal-standard`.


This ticket only changes files in `.github/workflows/`
This ticket can't break anything but the github workflows itself (and it doesn't break those).



---

archive/issue_comments_625783.json:
```json
{
    "body": "<a id='comment:12'></a>How likely it is to break things is the wrong question. Instead, ask yourself: Is this ticket important enough so that everyone else's ticket should wait another week before it can get merged, so we can have an additional rc round.",
    "created_at": "2021-04-01T16:32:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625783",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:12'></a>How likely it is to break things is the wrong question. Instead, ask yourself: Is this ticket important enough so that everyone else's ticket should wait another week before it can get merged, so we can have an additional rc round.



---

archive/issue_comments_625784.json:
```json
{
    "body": "<a id='comment:13'></a>Yes, a fully working portability testing infrastructure is crucial to making a release that will be in use for the next 1/2 year.",
    "created_at": "2021-04-01T16:50:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625784",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>Yes, a fully working portability testing infrastructure is crucial to making a release that will be in use for the next 1/2 year.



---

archive/issue_comments_625785.json:
```json
{
    "body": "<a id='comment:14'></a>Here's an idea: If a positively reviewed ticket only modifies `/.github/` or `/tox.ini`, just merge it and don't count it to whatever batch size or limits you use in your merge scripts. -- After all, your build scripts do not test anything involving these files.",
    "created_at": "2021-04-01T16:55:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625785",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>Here's an idea: If a positively reviewed ticket only modifies `/.github/` or `/tox.ini`, just merge it and don't count it to whatever batch size or limits you use in your merge scripts. -- After all, your build scripts do not test anything involving these files.



---

archive/issue_comments_625786.json:
```json
{
    "body": "<a id='comment:15'></a>The same idea would probably also apply to `/.ci/`, `/.circleci/`, `/.gitlab-ci.yml`, and `/docker/` -- except these see a lot less activity as the maintainers seem to have disappeared.",
    "created_at": "2021-04-01T16:59:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625786",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>The same idea would probably also apply to `/.ci/`, `/.circleci/`, `/.gitlab-ci.yml`, and `/docker/` -- except these see a lot less activity as the maintainers seem to have disappeared.



---

archive/issue_comments_625787.json:
```json
{
    "body": "<a id='comment:16'></a>Look, I appreciate what you are doing. But you need more frequent releases, not a more drawn-out release process so we can wait until everyone has their pet ticket merged.",
    "created_at": "2021-04-01T19:58:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625787",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:16'></a>Look, I appreciate what you are doing. But you need more frequent releases, not a more drawn-out release process so we can wait until everyone has their pet ticket merged.



---

archive/issue_comments_625788.json:
```json
{
    "body": "<a id='comment:17'></a>Volker, I had hoped for a substantial response to comments 14/15.",
    "created_at": "2021-04-01T20:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625788",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>Volker, I had hoped for a substantial response to comments 14/15.



---

archive/issue_comments_625789.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/gh_actions__free_more_disk_space\" to \"1bed9d5ab1be334afb41f2552b1e99a01e3355b1\"",
    "created_at": "2021-04-05T19:42:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625789",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/gh_actions__free_more_disk_space" to "1bed9d5ab1be334afb41f2552b1e99a01e3355b1"



---

archive/issue_events_082758.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-04-05T19:42:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31502#event-82758"
}
```



---

archive/issue_comments_625790.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-04-05T19:42:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31502",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31502#issuecomment-625790",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
