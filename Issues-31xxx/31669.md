# Issue 31669: Category of chain complexes: (co)homology functor

archive/issues_031432.json:
```json
{
    "body": "In this ticket, we equip the category of chain complexes with a method `homology` yielding the associated homology. The corresponding homology functor will use this method.\n\nThis happens in view of \u010cech cohomology, Morse homology and de Rham cohomology on manifolds.\n\nComments and opinions are as always welcome.\n\nCC:  @mkoeppe @tscrim @egourgoulhon @jhpalmieri\n\nKeywords: homology\n\nBranch/Commit: 4bceb9b22e889380d36ad78097e82c921aa95309\n\nReviewer: Travis Scrimshaw\n\nAuthor: Michael Jung\n\nDependencies: #31691\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/31669\n\n",
    "closed_at": "2021-06-19T20:58:25Z",
    "created_at": "2021-04-14T14:22:05Z",
    "labels": [
        "component: categories"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Category of chain complexes: (co)homology functor",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31669",
    "user": "https://github.com/mjungmath"
}
```
In this ticket, we equip the category of chain complexes with a method `homology` yielding the associated homology. The corresponding homology functor will use this method.

This happens in view of Čech cohomology, Morse homology and de Rham cohomology on manifolds.

Comments and opinions are as always welcome.

CC:  @mkoeppe @tscrim @egourgoulhon @jhpalmieri

Keywords: homology

Branch/Commit: 4bceb9b22e889380d36ad78097e82c921aa95309

Reviewer: Travis Scrimshaw

Author: Michael Jung

Dependencies: #31691

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/31669





---

archive/issue_events_083490.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-15T02:16:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31669#event-83490"
}
```



---

archive/issue_comments_479849.json:
```json
{
    "body": "<a id='comment:3'></a>First draft. Comments are welcome.\n\n---\nNew commits:",
    "created_at": "2021-04-17T23:05:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479849",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:3'></a>First draft. Comments are welcome.

---
New commits:



---

archive/issue_comments_479850.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-17T23:20:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479850",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_479851.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,10 +1,8 @@\n-In this ticket, we equip the category of chain complexes with a method `homology` yielding the associated homology. The corresponding homology functor will use this method. We furthermore establish a new category of cochain complexes.\n+In this ticket, we equip the category of chain complexes with a method `homology` yielding the associated homology. The corresponding homology functor will use this method.\n \n This happens in view of \u010cech cohomology, Morse homology and de Rham cohomology on manifolds.\n \n Comments and opinions are as always welcome.\n-\n-Keywords: homology, cohomology\n \n Comment: 1\n \n``````\n",
    "created_at": "2021-04-18T10:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479851",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,10 +1,8 @@
-In this ticket, we equip the category of chain complexes with a method `homology` yielding the associated homology. The corresponding homology functor will use this method. We furthermore establish a new category of cochain complexes.
+In this ticket, we equip the category of chain complexes with a method `homology` yielding the associated homology. The corresponding homology functor will use this method.
 
 This happens in view of Čech cohomology, Morse homology and de Rham cohomology on manifolds.
 
 Comments and opinions are as always welcome.
-
-Keywords: homology, cohomology
 
 Comment: 1
 
``````




---

archive/issue_comments_479852.json:
```json
{
    "body": "Changing keywords from \"homology, cohomology\" to \"homology\".",
    "created_at": "2021-04-18T10:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479852",
    "user": "https://github.com/mjungmath"
}
```

Changing keywords from "homology, cohomology" to "homology".



---

archive/issue_comments_479853.json:
```json
{
    "body": "<a id='comment:5'></a>`chain_complex` doesn't make a distinction between chain and cochain complexes. Probably because it also allows multigrading.\n\nShould we remove the category of cochain complexes then? I mean, in a broad sense, cochain complexes can be seen as generalized chain complexes, no?\n\nBtw, is it customary to add a mathematical description in the category section?",
    "created_at": "2021-04-18T10:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479853",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:5'></a>`chain_complex` doesn't make a distinction between chain and cochain complexes. Probably because it also allows multigrading.

Should we remove the category of cochain complexes then? I mean, in a broad sense, cochain complexes can be seen as generalized chain complexes, no?

Btw, is it customary to add a mathematical description in the category section?



---

archive/issue_comments_479854.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-04-18T10:16:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479854",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_479855.json:
```json
{
    "body": "<a id='comment:7'></a>Here is a proposal without cochain complexes.\n\n---\nNew commits:",
    "created_at": "2021-04-18T10:16:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479855",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:7'></a>Here is a proposal without cochain complexes.

---
New commits:



---

archive/issue_comments_479856.json:
```json
{
    "body": "<a id='comment:9'></a>There is no difference as the degree of the chain map is part of the data of a chain complex. I agree that it is good to *not* have a category of cochain complexes.\n\nYou can add a very brief description to the category, but nobody really reads that part IMO.",
    "created_at": "2021-04-19T00:47:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479856",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>There is no difference as the degree of the chain map is part of the data of a chain complex. I agree that it is good to *not* have a category of cochain complexes.

You can add a very brief description to the category, but nobody really reads that part IMO.



---

archive/issue_comments_479857.json:
```json
{
    "body": "<a id='comment:10'></a>I have added a `differential` method to the category since this is a crucial ingredient for chain complexes. For consistency it might also be a good idea to turn differentials of `chain_complex` into morphisms in the category of modules like it is done in `commutative_dga`.",
    "created_at": "2021-04-19T08:51:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479857",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:10'></a>I have added a `differential` method to the category since this is a crucial ingredient for chain complexes. For consistency it might also be a good idea to turn differentials of `chain_complex` into morphisms in the category of modules like it is done in `commutative_dga`.



---

archive/issue_comments_479858.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-19T08:54:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479858",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_479859.json:
```json
{
    "body": "<a id='comment:12'></a>If there is nothing you'd like to add, that should be it. I added the above task as a `TODO` comment. Perhaps I even open a ticket.",
    "created_at": "2021-04-19T08:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479859",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:12'></a>If there is nothing you'd like to add, that should be it. I added the above task as a `TODO` comment. Perhaps I even open a ticket.



---

archive/issue_comments_479860.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-04-19T08:56:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479860",
    "user": "https://github.com/mjungmath"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_479861.json:
```json
{
    "body": "<a id='comment:14'></a>Rather than raise a `NotImplementedError`, it is better if you mark them as ``@`abstract_method`.\n\n`_apply_functor_to_morphism` is missing doctests.\n\nI would not change the title doc of `chain_complex.py`. It is possible that non-bounded chain complexes are added to that file eventually.\n\nShould we allow `HomologyFunctor` to have a default of `n=None` so it returns the entire homology?\n\nThis is a more of a question for John. When I think of cohomology, I think there should be some extra ring structure. If the degree of the differential is negative, can we generally assume there is a ring structure on the homology or is this something special based on the construction?",
    "created_at": "2021-04-21T06:36:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479861",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'></a>Rather than raise a `NotImplementedError`, it is better if you mark them as ``@`abstract_method`.

`_apply_functor_to_morphism` is missing doctests.

I would not change the title doc of `chain_complex.py`. It is possible that non-bounded chain complexes are added to that file eventually.

Should we allow `HomologyFunctor` to have a default of `n=None` so it returns the entire homology?

This is a more of a question for John. When I think of cohomology, I think there should be some extra ring structure. If the degree of the differential is negative, can we generally assume there is a ring structure on the homology or is this something special based on the construction?



---

archive/issue_comments_479862.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:14 tscrim]:\n> Rather than raise a `NotImplementedError`, it is better if you mark them as ``@`abstract_method`.\n> \n> `_apply_functor_to_morphism` is missing doctests.\n\n\nThat is because we don't have any examples to apply here, or do we?\n\n> I would not change the title doc of `chain_complex.py`. It is possible that non-bounded chain complexes are added to that file eventually.\n\n\nWell, that can be done if that finally happens, no?\n\n> Should we allow `HomologyFunctor` to have a default of `n=None` so it returns the entire homology?\n> \n> This is a more of a question for John. When I think of cohomology, I think there should be some extra ring structure. If the degree of the differential is negative, can we generally assume there is a ring structure on the homology or is this something special based on the construction?\n\n\nI agree, it should, and I will add it accordingly. For the moment however, neither `chain_complex` nor `commutative_dga` provide (co)homology in terms of a graded ring.",
    "created_at": "2021-04-21T10:58:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479862",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:15'></a>Replying to [comment:14 tscrim]:
> Rather than raise a `NotImplementedError`, it is better if you mark them as ``@`abstract_method`.
> 
> `_apply_functor_to_morphism` is missing doctests.


That is because we don't have any examples to apply here, or do we?

> I would not change the title doc of `chain_complex.py`. It is possible that non-bounded chain complexes are added to that file eventually.


Well, that can be done if that finally happens, no?

> Should we allow `HomologyFunctor` to have a default of `n=None` so it returns the entire homology?
> 
> This is a more of a question for John. When I think of cohomology, I think there should be some extra ring structure. If the degree of the differential is negative, can we generally assume there is a ring structure on the homology or is this something special based on the construction?


I agree, it should, and I will add it accordingly. For the moment however, neither `chain_complex` nor `commutative_dga` provide (co)homology in terms of a graded ring.



---

archive/issue_comments_479863.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:15 gh-mjungmath]:\n> Replying to [comment:14 tscrim]:\n> > Rather than raise a `NotImplementedError`, it is better if you mark them as ``@`abstract_method`.\n> > \n> > `_apply_functor_to_morphism` is missing doctests.\n\n> \n> That is because we don't have any examples to apply here, or do we?\n\n\nPerhaps I can add an example together with #31693.",
    "created_at": "2021-04-21T11:08:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479863",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:16'></a>Replying to [comment:15 gh-mjungmath]:
> Replying to [comment:14 tscrim]:
> > Rather than raise a `NotImplementedError`, it is better if you mark them as ``@`abstract_method`.
> > 
> > `_apply_functor_to_morphism` is missing doctests.

> 
> That is because we don't have any examples to apply here, or do we?


Perhaps I can add an example together with #31693.



---

archive/issue_comments_479864.json:
```json
{
    "body": "<a id='comment:17'></a>As for `_apply_functor_to_morphism` we could enforce a method `homology_raw` (cf. `commutative_dga`) which returns the homology as an actual quotient whose elements admit a `lift` method. Then the `_apply_functor_to_morphism` is rather generic:\n\nLift the homology element, apply the original morphism to it, reduce to the quotient.\n\nAt that end one could implement isomorphisms from the already lifted homology groups to the homology groups emerged as quotient.\n\nNot sure whether this is a feasible approach. Travis, what do you think?\n\nI would have wished that the homology already occurs as a quotient in the first place. Is there a reason why this hasn't been done so?",
    "created_at": "2021-04-21T15:49:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479864",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:17'></a>As for `_apply_functor_to_morphism` we could enforce a method `homology_raw` (cf. `commutative_dga`) which returns the homology as an actual quotient whose elements admit a `lift` method. Then the `_apply_functor_to_morphism` is rather generic:

Lift the homology element, apply the original morphism to it, reduce to the quotient.

At that end one could implement isomorphisms from the already lifted homology groups to the homology groups emerged as quotient.

Not sure whether this is a feasible approach. Travis, what do you think?

I would have wished that the homology already occurs as a quotient in the first place. Is there a reason why this hasn't been done so?



---

archive/issue_comments_479865.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-04-21T16:04:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479865",
    "user": "https://github.com/mjungmath"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_479866.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [comment:17 gh-mjungmath]:\n> I would have wished that the homology already occurs as a quotient in the first place. Is there a reason why this hasn't been done so?\n\n\nIt is *much* faster to compute the homology as an abstract group (by computing the Smith normal form of the boundary matrices) than to compute the cycles as a subgroup of the chains and then the homology as a quotient of the cycles.",
    "created_at": "2021-04-21T19:55:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479866",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'></a>Replying to [comment:17 gh-mjungmath]:
> I would have wished that the homology already occurs as a quotient in the first place. Is there a reason why this hasn't been done so?


It is *much* faster to compute the homology as an abstract group (by computing the Smith normal form of the boundary matrices) than to compute the cycles as a subgroup of the chains and then the homology as a quotient of the cycles.



---

archive/issue_comments_479867.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-22T08:50:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479867",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_479868.json:
```json
{
    "body": "<a id='comment:21'></a>Check out my new commit. This approach is a bit more generic. What do you think?",
    "created_at": "2021-04-22T08:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479868",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:21'></a>Check out my new commit. This approach is a bit more generic. What do you think?



---

archive/issue_comments_479869.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-22T08:55:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479869",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_479870.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-22T08:58:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479870",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_479871.json:
```json
{
    "body": "<a id='comment:24'></a>Even if we have no examples, it still needs a doctest (even if it just showing that it has not been defined).\n\nYes, we can change the title if that indeed happens, but right now, let's leave it alone.\n\nI don't like the idea of enforcing a `homology_raw`. Implementors should be free to implement what works best for them and their problem at hand as per John's comment. Things at the category level should be kept as generic as possible.\n\nIt would be better to have this as a generic implementation in the category by using some assumption on the chain complex and the corresponding morphisms. Of course, it would need a better name and could be the generic implementation, but I am not sure we want to force an option that homology needs to be realized as a quotient.",
    "created_at": "2021-04-23T00:46:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479871",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:24'></a>Even if we have no examples, it still needs a doctest (even if it just showing that it has not been defined).

Yes, we can change the title if that indeed happens, but right now, let's leave it alone.

I don't like the idea of enforcing a `homology_raw`. Implementors should be free to implement what works best for them and their problem at hand as per John's comment. Things at the category level should be kept as generic as possible.

It would be better to have this as a generic implementation in the category by using some assumption on the chain complex and the corresponding morphisms. Of course, it would need a better name and could be the generic implementation, but I am not sure we want to force an option that homology needs to be realized as a quotient.



---

archive/issue_comments_479872.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [comment:24 tscrim]:\n> Even if we have no examples, it still needs a doctest (even if it just showing that it has not been defined).\n> \n> Yes, we can change the title if that indeed happens, but right now, let's leave it alone.\n> \n> I don't like the idea of enforcing a `homology_raw`. Implementors should be free to implement what works best for them and their problem at hand as per John's comment. Things at the category level should be kept as generic as possible.\n> \n> It would be better to have this as a generic implementation in the category by using some assumption on the chain complex and the corresponding morphisms. Of course, it would need a better name and could be the generic implementation, but I am not sure we want to force an option that homology needs to be realized as a quotient.\n\n\nHave you checked my last commits? I already dropped most things you are referring to.\n\nInstead of `homology_raw`, I have introduced two methods: `lift_from_homology` and `reduce_to_homology` which lifts an homology class to a representative and reduces a cycle to its homology class respectively. These can be overwritten depending on the implementation.\n\nAs for renaming: I really don't care. I just think that it is way smoother if the title fits the content. What I meant: you can change it back as soon as the implementation has been generalized, at which point the documentation needs to be refactored anyway.",
    "created_at": "2021-04-23T07:07:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479872",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:25'></a>Replying to [comment:24 tscrim]:
> Even if we have no examples, it still needs a doctest (even if it just showing that it has not been defined).
> 
> Yes, we can change the title if that indeed happens, but right now, let's leave it alone.
> 
> I don't like the idea of enforcing a `homology_raw`. Implementors should be free to implement what works best for them and their problem at hand as per John's comment. Things at the category level should be kept as generic as possible.
> 
> It would be better to have this as a generic implementation in the category by using some assumption on the chain complex and the corresponding morphisms. Of course, it would need a better name and could be the generic implementation, but I am not sure we want to force an option that homology needs to be realized as a quotient.


Have you checked my last commits? I already dropped most things you are referring to.

Instead of `homology_raw`, I have introduced two methods: `lift_from_homology` and `reduce_to_homology` which lifts an homology class to a representative and reduces a cycle to its homology class respectively. These can be overwritten depending on the implementation.

As for renaming: I really don't care. I just think that it is way smoother if the title fits the content. What I meant: you can change it back as soon as the implementation has been generalized, at which point the documentation needs to be refactored anyway.



---

archive/issue_comments_479873.json:
```json
{
    "body": "<a id='comment:26'></a>Replying to [comment:25 gh-mjungmath]:\n> Replying to [comment:24 tscrim]:\n> > Even if we have no examples, it still needs a doctest (even if it just showing that it has not been defined).\n> > \n> > Yes, we can change the title if that indeed happens, but right now, let's leave it alone.\n> > \n> > I don't like the idea of enforcing a `homology_raw`. Implementors should be free to implement what works best for them and their problem at hand as per John's comment. Things at the category level should be kept as generic as possible.\n> > \n> > It would be better to have this as a generic implementation in the category by using some assumption on the chain complex and the corresponding morphisms. Of course, it would need a better name and could be the generic implementation, but I am not sure we want to force an option that homology needs to be realized as a quotient.\n\n> \n> Have you checked my last commits? I already dropped most things you are referring to.\n> \n> Instead of `homology_raw`, I have introduced two methods: `lift_from_homology` and `reduce_to_homology` which lifts an homology class to a representative and reduces a cycle to its homology class respectively. These can be overwritten depending on the implementation.\n\n\nOkay, I understand what you are trying to do. I didn't realize you were changing your approach with your last commit. It might be a slight abuse to have a functor for all `n`, but I think it should be fine.\n\n> As for renaming: I really don't care. I just think that it is way smoother if the title fits the content. What I meant: you can change it back as soon as the implementation has been generalized, at which point the documentation needs to be refactored anyway.\n\n\nI am still a -1 on changing the title docstring of `chain_complex.py`. That file is for chain complexes. Just because we happen to have only bounded ones implemented doesn't mean we need to limit it right now.",
    "created_at": "2021-04-23T08:50:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479873",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:26'></a>Replying to [comment:25 gh-mjungmath]:
> Replying to [comment:24 tscrim]:
> > Even if we have no examples, it still needs a doctest (even if it just showing that it has not been defined).
> > 
> > Yes, we can change the title if that indeed happens, but right now, let's leave it alone.
> > 
> > I don't like the idea of enforcing a `homology_raw`. Implementors should be free to implement what works best for them and their problem at hand as per John's comment. Things at the category level should be kept as generic as possible.
> > 
> > It would be better to have this as a generic implementation in the category by using some assumption on the chain complex and the corresponding morphisms. Of course, it would need a better name and could be the generic implementation, but I am not sure we want to force an option that homology needs to be realized as a quotient.

> 
> Have you checked my last commits? I already dropped most things you are referring to.
> 
> Instead of `homology_raw`, I have introduced two methods: `lift_from_homology` and `reduce_to_homology` which lifts an homology class to a representative and reduces a cycle to its homology class respectively. These can be overwritten depending on the implementation.


Okay, I understand what you are trying to do. I didn't realize you were changing your approach with your last commit. It might be a slight abuse to have a functor for all `n`, but I think it should be fine.

> As for renaming: I really don't care. I just think that it is way smoother if the title fits the content. What I meant: you can change it back as soon as the implementation has been generalized, at which point the documentation needs to be refactored anyway.


I am still a -1 on changing the title docstring of `chain_complex.py`. That file is for chain complexes. Just because we happen to have only bounded ones implemented doesn't mean we need to limit it right now.



---

archive/issue_comments_479874.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-23T20:44:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479874",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_479875.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-23T20:46:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479875",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_479876.json:
```json
{
    "body": "<a id='comment:29'></a>When #31691 has a positive review, I will add some examples for de Rham cohomology here.",
    "created_at": "2021-04-26T14:30:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479876",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:29'></a>When #31691 has a positive review, I will add some examples for de Rham cohomology here.



---

archive/issue_comments_479877.json:
```json
{
    "body": "<a id='comment:30'></a>Replying to [comment:26 tscrim]:\n> Replying to [comment:25 gh-mjungmath]:\n> > As for renaming: I really don't care. I just think that it is way smoother if the title fits the content. What I meant: you can change it back as soon as the implementation has been generalized, at which point the documentation needs to be refactored anyway.\n\n> \n> I am still a -1 on changing the title docstring of `chain_complex.py`. That file is for chain complexes. Just because we happen to have only bounded ones implemented doesn't mean we need to limit it right now.\n\n\nRegarding this, I don't know much about [kenzo](https://github.com/gheber/kenzo), but it is conceivable that it handles unbounded chain complexes, and I think we should leave the title of Sage's chain complex module as is, in case the Sage-kenzo interface develops further and we can directly access its chain complexes. (Kenzo certainly handles topological spaces which have nonzero homology in infinitely many dimensions, but I don't know the details of how it handles the associated chain complexes.)",
    "created_at": "2021-04-29T20:37:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479877",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:30'></a>Replying to [comment:26 tscrim]:
> Replying to [comment:25 gh-mjungmath]:
> > As for renaming: I really don't care. I just think that it is way smoother if the title fits the content. What I meant: you can change it back as soon as the implementation has been generalized, at which point the documentation needs to be refactored anyway.

> 
> I am still a -1 on changing the title docstring of `chain_complex.py`. That file is for chain complexes. Just because we happen to have only bounded ones implemented doesn't mean we need to limit it right now.


Regarding this, I don't know much about [kenzo](https://github.com/gheber/kenzo), but it is conceivable that it handles unbounded chain complexes, and I think we should leave the title of Sage's chain complex module as is, in case the Sage-kenzo interface develops further and we can directly access its chain complexes. (Kenzo certainly handles topological spaces which have nonzero homology in infinitely many dimensions, but I don't know the details of how it handles the associated chain complexes.)



---

archive/issue_comments_479878.json:
```json
{
    "body": "<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-06T18:27:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479878",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_479879.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-05-06T18:28:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479879",
    "user": "https://github.com/mjungmath"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_479880.json:
```json
{
    "body": "<a id='comment:33'></a>Ready for review.",
    "created_at": "2021-05-06T18:28:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479880",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:33'></a>Ready for review.



---

archive/issue_comments_479881.json:
```json
{
    "body": "<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-06T18:31:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479881",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_479882.json:
```json
{
    "body": "<a id='comment:35'></a>Is #31691 a dependency of this ticket?",
    "created_at": "2021-05-06T22:32:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479882",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:35'></a>Is #31691 a dependency of this ticket?



---

archive/issue_comments_479883.json:
```json
{
    "body": "<a id='comment:36'></a>Yes, I think it is.\n\nSome comments:\n\nDoctest failure:\n\n```\nsage -t --long --random-seed=0 src/sage/homology/hochschild_complex.py  # 1 doctest failed\n```\n\nI would use `_n` instead of `__n` as we don't need the name mangling.\n\nA useful construction is `Cat.or_subcategory(input_cat)`, which automatically returns `Cat` when `input_cat=None`.",
    "created_at": "2021-05-07T06:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479883",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:36'></a>Yes, I think it is.

Some comments:

Doctest failure:

```
sage -t --long --random-seed=0 src/sage/homology/hochschild_complex.py  # 1 doctest failed
```

I would use `_n` instead of `__n` as we don't need the name mangling.

A useful construction is `Cat.or_subcategory(input_cat)`, which automatically returns `Cat` when `input_cat=None`.



---

archive/issue_comments_479884.json:
```json
{
    "body": "<a id='comment:37'></a>Replying to [comment:36 tscrim]:\n> Yes, I think it is.\n\n\nIndeed. My mistake.\n\n> \n> Some comments:\n> \n> Doctest failure:\n> \n> ```\n> sage -t --long --random-seed=0 src/sage/homology/hochschild_complex.py  # 1 doctest failed\n> ```\n\n\nSaw it. I hope the Hochschild complex implementation provides a boundary map...\n\n> \n> I would use `_n` instead of `__n` as we don't need the name mangling.\n> \n\nCheck.\n\n> A useful construction is `Cat.or_subcategory(input_cat)`, which automatically returns `Cat` when `input_cat=None`.\n\n\nWhat do you propose?",
    "created_at": "2021-05-07T08:09:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479884",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:37'></a>Replying to [comment:36 tscrim]:
> Yes, I think it is.


Indeed. My mistake.

> 
> Some comments:
> 
> Doctest failure:
> 
> ```
> sage -t --long --random-seed=0 src/sage/homology/hochschild_complex.py  # 1 doctest failed
> ```


Saw it. I hope the Hochschild complex implementation provides a boundary map...

> 
> I would use `_n` instead of `__n` as we don't need the name mangling.
> 

Check.

> A useful construction is `Cat.or_subcategory(input_cat)`, which automatically returns `Cat` when `input_cat=None`.


What do you propose?



---

archive/issue_comments_479885.json:
```json
{
    "body": "<a id='comment:38'></a>Replying to [comment:36 tscrim]:\n> A useful construction is `Cat.or_subcategory(input_cat)`, which automatically returns `Cat` when `input_cat=None`.\n\n\nAh, you are probably referring to `GCAlgebra`. This `or_subcategory` seems also useful to improve the code for manifolds since this is similarly implemented as I did here.",
    "created_at": "2021-05-08T10:08:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479885",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:38'></a>Replying to [comment:36 tscrim]:
> A useful construction is `Cat.or_subcategory(input_cat)`, which automatically returns `Cat` when `input_cat=None`.


Ah, you are probably referring to `GCAlgebra`. This `or_subcategory` seems also useful to improve the code for manifolds since this is similarly implemented as I did here.



---

archive/issue_comments_479886.json:
```json
{
    "body": "<a id='comment:39'></a>But it seems like this is done all over Sage:\n\n```python\ndef __init__(..., category=None):\n    ...\n    if category is None:\n        category = SomeCategory()\n```",
    "created_at": "2021-05-08T10:16:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479886",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:39'></a>But it seems like this is done all over Sage:

```python
def __init__(..., category=None):
    ...
    if category is None:
        category = SomeCategory()
```



---

archive/issue_comments_479887.json:
```json
{
    "body": "<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-08T10:23:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479887",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_479888.json:
```json
{
    "body": "<a id='comment:41'></a>Looks to me like morally green...?",
    "created_at": "2021-05-08T13:19:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479888",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:41'></a>Looks to me like morally green...?



---

archive/issue_comments_479889.json:
```json
{
    "body": "<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-08T13:37:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479889",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_479890.json:
```json
{
    "body": "<a id='comment:43'></a>Ready for review. Patchbot is 'green'.",
    "created_at": "2021-05-10T11:01:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479890",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:43'></a>Ready for review. Patchbot is 'green'.



---

archive/issue_comments_479891.json:
```json
{
    "body": "<a id='comment:44'></a>Replying to [comment:39 gh-mjungmath]:\n> But it seems like this is done all over Sage:\n> \n> \n> ```python\n> def __init__(..., category=None):\n>     ...\n>     if category is None:\n>         category = SomeCategory()\n> ```\n\n\nYes, that is what I was referring too. However, just because it is used many places elsewhere doesn't mean you shouldn't use it. That is typically older code and is a weaker test. Someone could pass a weaker category than the code actually needs, which would be a problem.",
    "created_at": "2021-05-12T07:08:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479891",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:44'></a>Replying to [comment:39 gh-mjungmath]:
> But it seems like this is done all over Sage:
> 
> 
> ```python
> def __init__(..., category=None):
>     ...
>     if category is None:
>         category = SomeCategory()
> ```


Yes, that is what I was referring too. However, just because it is used many places elsewhere doesn't mean you shouldn't use it. That is typically older code and is a weaker test. Someone could pass a weaker category than the code actually needs, which would be a problem.



---

archive/issue_comments_479892.json:
```json
{
    "body": "<a id='comment:45'></a>I don't know whether `is_subcategory` is the state of the art here. Sometimes, categories are not compatible with each other. Or a subcategory (in the mathematical sense) is not recognized as such. I have a bad feeling that this can lead to undesired results.",
    "created_at": "2021-05-12T07:47:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479892",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:45'></a>I don't know whether `is_subcategory` is the state of the art here. Sometimes, categories are not compatible with each other. Or a subcategory (in the mathematical sense) is not recognized as such. I have a bad feeling that this can lead to undesired results.



---

archive/issue_comments_479893.json:
```json
{
    "body": "<a id='comment:46'></a>This is what we want to use. Please make the change to use it. If categories are incompatible, then there is a bigger issue that this will alert you to.",
    "created_at": "2021-05-12T08:01:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479893",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:46'></a>This is what we want to use. Please make the change to use it. If categories are incompatible, then there is a bigger issue that this will alert you to.



---

archive/issue_comments_479894.json:
```json
{
    "body": "<a id='comment:47'></a>I still don't think this is what we should use. For example, assume that the class represents an object in the category of groups. Now I want to inherit from this class and turn it into a ring. Passing `Rings()` to the initialization would then cause an error:\n\n```\nsage: Groups().or_subcategory(Rings())\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-2-38547a21b34f> in <module>\n----> 1 Groups().or_subcategory(Rings())\n\n/ext/sage/sage-9.2/local/lib/python3.8/site-packages/sage/categories/category.py in or_subcategory(self, category, join)\n   1876         else:\n   1877             if not category.is_subcategory(self):\n-> 1878                 raise ValueError(\"Subcategory of `{}` required; got `{}`\".format(self, category))\n   1879             return category\n   1880 \nValueError: Subcategory of `Category of groups` required; got `Category of rings\n```\n\nEven with `join=True` we get an undesired result:\n\n```\nsage: Groups().or_subcategory(Rings(), join=True)\nCategory of inverse rings\n```\n\nWhat we really want to do is overwrite the category in that case.",
    "created_at": "2021-05-12T08:32:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479894",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:47'></a>I still don't think this is what we should use. For example, assume that the class represents an object in the category of groups. Now I want to inherit from this class and turn it into a ring. Passing `Rings()` to the initialization would then cause an error:

```
sage: Groups().or_subcategory(Rings())
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-2-38547a21b34f> in <module>
----> 1 Groups().or_subcategory(Rings())

/ext/sage/sage-9.2/local/lib/python3.8/site-packages/sage/categories/category.py in or_subcategory(self, category, join)
   1876         else:
   1877             if not category.is_subcategory(self):
-> 1878                 raise ValueError("Subcategory of `{}` required; got `{}`".format(self, category))
   1879             return category
   1880 
ValueError: Subcategory of `Category of groups` required; got `Category of rings
```

Even with `join=True` we get an undesired result:

```
sage: Groups().or_subcategory(Rings(), join=True)
Category of inverse rings
```

What we really want to do is overwrite the category in that case.



---

archive/issue_comments_479895.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-05-12T22:24:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479895",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_479896.json:
```json
{
    "body": "<a id='comment:48'></a>That error is telling you that you are doing something mathematically nonsensical. A ring is not a (multiplicative) group because it doesn't have inverses. Thus, your example gives even more reason you want to use it.",
    "created_at": "2021-05-12T22:24:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479896",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:48'></a>That error is telling you that you are doing something mathematically nonsensical. A ring is not a (multiplicative) group because it doesn't have inverses. Thus, your example gives even more reason you want to use it.



---

archive/issue_comments_479897.json:
```json
{
    "body": "<a id='comment:49'></a>Right, Sage distinguishes between multiplicative and additive groups. Probably a bad example. The same error would occur for additive groups though, except that `join=True` gives what we want. But I am not sure whether we always want to join categories and never make it possible to overwrite them for inheritance purposes.\n\nI am sure you can somehow construct another example that leads to something undesirable. Besides, there must be a reason why `or_subcategory` is literally never used for that purpose.\n\nI'd appreciate an additional opinion here. Matthias?",
    "created_at": "2021-05-13T00:49:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479897",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:49'></a>Right, Sage distinguishes between multiplicative and additive groups. Probably a bad example. The same error would occur for additive groups though, except that `join=True` gives what we want. But I am not sure whether we always want to join categories and never make it possible to overwrite them for inheritance purposes.

I am sure you can somehow construct another example that leads to something undesirable. Besides, there must be a reason why `or_subcategory` is literally never used for that purpose.

I'd appreciate an additional opinion here. Matthias?



---

archive/issue_comments_479898.json:
```json
{
    "body": "<a id='comment:50'></a>I don't have an opinion about this particular situation, but in my experience, Travis knows the category code well, and I try to follow his advice.",
    "created_at": "2021-05-13T01:17:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479898",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:50'></a>I don't have an opinion about this particular situation, but in my experience, Travis knows the category code well, and I try to follow his advice.



---

archive/issue_comments_479899.json:
```json
{
    "body": "<a id='comment:51'></a>Replying to [comment:49 gh-mjungmath]:\n> Right, Sage distinguishes between multiplicative and additive groups. Probably a bad example. The same error would occur for additive groups though, except that `join=True` gives what we want.\n\n\nIt does not result in an error:\n\n```\nsage: from sage.categories.additive_groups import AdditiveGroups\nsage: AdditiveGroups().or_subcategory(Rings())\nCategory of rings\n```\n\n> But I am not sure whether we always want to join categories and never make it possible to overwrite them for inheritance purposes.\n\n\nI don't understand. Join categories are used all over the place in Sage. When creating a new category, we often (maybe even typically) build it as a join or a subcategory thereof.\n\n> I am sure you can somehow construct another example that leads to something undesirable.\n\n\nIf you do, then you are exposing a bug in the category hierarchy.\n\n> Besides, there must be a reason why `or_subcategory` is literally never used for that purpose.\n\n\nThis is used in many places in Sage:\n\n```\nuqtscrim@SMP-36PQ8T2:~/sage/src/sage$ grep -R -l \"or_subcategory\" *\nalgebras/lie_algebras/quotient.py\nalgebras/lie_algebras/nilpotent_lie_algebra.py\nalgebras/lie_algebras/structure_coefficients.py\nalgebras/lie_algebras/lie_algebra.py\nalgebras/lie_algebras/subalgebra.py\nalgebras/lie_algebras/abelian.py\nalgebras/tensor_algebra.py\nalgebras/lie_conformal_algebras/lie_conformal_algebra_with_basis.py\nalgebras/lie_conformal_algebras/graded_lie_conformal_algebra.py\nalgebras/lie_conformal_algebras/finitely_freely_generated_lca.py\nalgebras/lie_conformal_algebras/lie_conformal_algebra_with_structure_coefs.py\nalgebras/clifford_algebra.py\nalgebras/associated_graded.py\nalgebras/finite_dimensional_algebras/finite_dimensional_algebra.py\ncategories/examples/semigroups.py\ncategories/coxeter_groups.py\ncategories/category.py\ncombinat/free_module.py\ncombinat/diagram_algebras.py\ncombinat/posets/posets.py\ncombinat/crystals/subcrystal.py\ncombinat/crystals/virtual_crystal.py\ncombinat/combinat.py\ngroups/lie_gps/nilpotent_lie_group.py\ngroups/perm_gps/permgroup.py\ngroups/indexed_free_group.py\nhomology/simplicial_complex.py\nhomology/homology_vector_space_with_basis.py\nmanifolds/manifold.py\nmodules/with_basis/subquotient.py\nmodules/with_basis/morphism.py\nmonoids/indexed_free_monoid.py\nrings/function_field/order.py\nrings/function_field/valuation_ring.py\nrings/function_field/differential.py\nrings/function_field/function_field.py\nrings/lazy_laurent_series_ring.py\nrings/polynomial/ore_polynomial_ring.py\nrings/polynomial/ore_function_field.py\nrings/polynomial/polynomial_quotient_ring.py\nrings/asymptotic/asymptotics_multivariate_generating_functions.py\nsets/finite_set_maps.py\nsets/recursively_enumerated_set.pyx\nsets/non_negative_integers.py\ntensor/modules/finite_rank_free_module.py\n```\nOne of the most notable is in `combinat/free_module.py`, which is the base class of many algebras in Sage.",
    "created_at": "2021-05-13T02:27:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479899",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:51'></a>Replying to [comment:49 gh-mjungmath]:
> Right, Sage distinguishes between multiplicative and additive groups. Probably a bad example. The same error would occur for additive groups though, except that `join=True` gives what we want.


It does not result in an error:

```
sage: from sage.categories.additive_groups import AdditiveGroups
sage: AdditiveGroups().or_subcategory(Rings())
Category of rings
```

> But I am not sure whether we always want to join categories and never make it possible to overwrite them for inheritance purposes.


I don't understand. Join categories are used all over the place in Sage. When creating a new category, we often (maybe even typically) build it as a join or a subcategory thereof.

> I am sure you can somehow construct another example that leads to something undesirable.


If you do, then you are exposing a bug in the category hierarchy.

> Besides, there must be a reason why `or_subcategory` is literally never used for that purpose.


This is used in many places in Sage:

```
uqtscrim@SMP-36PQ8T2:~/sage/src/sage$ grep -R -l "or_subcategory" *
algebras/lie_algebras/quotient.py
algebras/lie_algebras/nilpotent_lie_algebra.py
algebras/lie_algebras/structure_coefficients.py
algebras/lie_algebras/lie_algebra.py
algebras/lie_algebras/subalgebra.py
algebras/lie_algebras/abelian.py
algebras/tensor_algebra.py
algebras/lie_conformal_algebras/lie_conformal_algebra_with_basis.py
algebras/lie_conformal_algebras/graded_lie_conformal_algebra.py
algebras/lie_conformal_algebras/finitely_freely_generated_lca.py
algebras/lie_conformal_algebras/lie_conformal_algebra_with_structure_coefs.py
algebras/clifford_algebra.py
algebras/associated_graded.py
algebras/finite_dimensional_algebras/finite_dimensional_algebra.py
categories/examples/semigroups.py
categories/coxeter_groups.py
categories/category.py
combinat/free_module.py
combinat/diagram_algebras.py
combinat/posets/posets.py
combinat/crystals/subcrystal.py
combinat/crystals/virtual_crystal.py
combinat/combinat.py
groups/lie_gps/nilpotent_lie_group.py
groups/perm_gps/permgroup.py
groups/indexed_free_group.py
homology/simplicial_complex.py
homology/homology_vector_space_with_basis.py
manifolds/manifold.py
modules/with_basis/subquotient.py
modules/with_basis/morphism.py
monoids/indexed_free_monoid.py
rings/function_field/order.py
rings/function_field/valuation_ring.py
rings/function_field/differential.py
rings/function_field/function_field.py
rings/lazy_laurent_series_ring.py
rings/polynomial/ore_polynomial_ring.py
rings/polynomial/ore_function_field.py
rings/polynomial/polynomial_quotient_ring.py
rings/asymptotic/asymptotics_multivariate_generating_functions.py
sets/finite_set_maps.py
sets/recursively_enumerated_set.pyx
sets/non_negative_integers.py
tensor/modules/finite_rank_free_module.py
```
One of the most notable is in `combinat/free_module.py`, which is the base class of many algebras in Sage.



---

archive/issue_comments_479900.json:
```json
{
    "body": "<a id='comment:52'></a>Replying to [comment:51 tscrim]:\n> Replying to [comment:49 gh-mjungmath]:\n> > Right, Sage distinguishes between multiplicative and additive groups. Probably a bad example. The same error would occur for additive groups though, except that `join=True` gives what we want.\n\n> \n> It does not result in an error:\n> \n> ```\n> sage: from sage.categories.additive_groups import AdditiveGroups\n> sage: AdditiveGroups().or_subcategory(Rings())\n> Category of rings\n> ```\n\n\nMh, you are right, it works. But according to the documentation this input should be invalid, too:\n\n```\nor_subcategory(category=None, join=False)\nReturn category or self if category is None.\n\nINPUT:\n\n    category \u2013 a sub category of self, tuple/list thereof, or None\n\n    join \u2013 a boolean (default: False)\n```\n\nIn that case, the documentation should be revised.",
    "created_at": "2021-05-13T09:27:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479900",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:52'></a>Replying to [comment:51 tscrim]:
> Replying to [comment:49 gh-mjungmath]:
> > Right, Sage distinguishes between multiplicative and additive groups. Probably a bad example. The same error would occur for additive groups though, except that `join=True` gives what we want.

> 
> It does not result in an error:
> 
> ```
> sage: from sage.categories.additive_groups import AdditiveGroups
> sage: AdditiveGroups().or_subcategory(Rings())
> Category of rings
> ```


Mh, you are right, it works. But according to the documentation this input should be invalid, too:

```
or_subcategory(category=None, join=False)
Return category or self if category is None.

INPUT:

    category – a sub category of self, tuple/list thereof, or None

    join – a boolean (default: False)
```

In that case, the documentation should be revised.



---

archive/issue_comments_479901.json:
```json
{
    "body": "<a id='comment:55'></a>I think the documentation of `or_subcategory` should be modified accordingly, at least the `INPUT` part.",
    "created_at": "2021-05-13T10:07:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479901",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:55'></a>I think the documentation of `or_subcategory` should be modified accordingly, at least the `INPUT` part.



---

archive/issue_comments_479902.json:
```json
{
    "body": "<a id='comment:56'></a>I apologize for my stubbornness. :D",
    "created_at": "2021-05-13T10:08:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479902",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:56'></a>I apologize for my stubbornness. :D



---

archive/issue_comments_479903.json:
```json
{
    "body": "<a id='comment:57'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-13T12:07:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479903",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:57'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_479904.json:
```json
{
    "body": "<a id='comment:58'></a>Here we go, and thank you for your patience, Travis!",
    "created_at": "2021-05-13T12:08:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479904",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:58'></a>Here we go, and thank you for your patience, Travis!



---

archive/issue_comments_479905.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-05-15T11:04:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479905",
    "user": "https://github.com/mjungmath"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_479906.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-05-23T05:30:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479906",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_479907.json:
```json
{
    "body": "<a id='comment:60'></a>LGTM. Thank you.",
    "created_at": "2021-05-23T05:30:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479907",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:60'></a>LGTM. Thank you.



---

archive/issue_comments_479908.json:
```json
{
    "body": "<a id='comment:61'></a>Thank you for the review! :)",
    "created_at": "2021-05-23T09:44:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479908",
    "user": "https://github.com/mjungmath"
}
```

<a id='comment:61'></a>Thank you for the review! :)



---

archive/issue_comments_479909.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-06-19T20:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31669#issuecomment-479909",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_083491.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-06-19T20:58:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31669",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31669#event-83491"
}
```
