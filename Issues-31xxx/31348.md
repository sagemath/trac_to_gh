# Issue 31348: build/pkgs/{gmp,mpfr}/spkg-configure.m4: Check pkg-config first

archive/issues_031111.json:
```json
{
    "body": "CC:  @dimpase @jhpalmieri @zlscherr @orlitzky\n\nKeywords: mpfr\n\nCurrently `gmp.pc`, which may be provided at least on some platforms, is not used at all -- neither by `configure` nor by `sage.env.cython_aliases`, `sage.misc.cython`.\n\nFor example, on homebrew, using it will provide the specific library search directory `-L/usr/local/Cellar/gmp/6.2.1/lib` instead of having to rely on `/usr/local/` (which is disabled when compiler/linker are invoked with `-isysroot`)\n\nCurrently, `gmp` is detected using `AC_CHECK_HEADER`, and the result is communicated to `sage-build-env-config` as variables `SAGE_GMP_PREFIX` and `SAGE_GMP_INCLUDE`; but it is not available in the runtime environment (`sage_conf.py`, `sage-env-config`).\n\nThe failures reported in \n- ticket:31335#comment:47 \n- https://groups.google.com/g/sage-release/c/6WjKQt_e_B8/m/H2I4HZ-YCwAJ (https://groups.google.com/g/sage-release/c/6WjKQt_e_B8/m/Uut_ZRaZCwAJ)\n- https://groups.google.com/g/sage-release/c/0q3kywk7RP8/m/uspq0xeuAgAJ\ncan be fixed by simply changing `sage.misc.cython` to pick up `gmp.pc`.  But to avoid unpleasant surprises, we need to make sure that it is used consistently when present.\n\n(After #32549, the relevant file is `build/pkgs/gmp/spkg-configure.m4`.)\n\nThe above applies to `mpfr` as well. See failure report in https://groups.google.com/g/sage-release/c/8ctwsUGl6LQ/m/Ob38Iyh1AAAJ\n\nSimilar situation with `readline` (#29000): The spkg-configure script already uses pkg-config - but forgets to tell the build system what it found.\n\nPrevious tickets: #27212\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/31348\n\n",
    "created_at": "2021-02-06T02:40:02Z",
    "labels": [
        "component: build: configure",
        "critical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "build/pkgs/{gmp,mpfr}/spkg-configure.m4: Check pkg-config first",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31348",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @dimpase @jhpalmieri @zlscherr @orlitzky

Keywords: mpfr

Currently `gmp.pc`, which may be provided at least on some platforms, is not used at all -- neither by `configure` nor by `sage.env.cython_aliases`, `sage.misc.cython`.

For example, on homebrew, using it will provide the specific library search directory `-L/usr/local/Cellar/gmp/6.2.1/lib` instead of having to rely on `/usr/local/` (which is disabled when compiler/linker are invoked with `-isysroot`)

Currently, `gmp` is detected using `AC_CHECK_HEADER`, and the result is communicated to `sage-build-env-config` as variables `SAGE_GMP_PREFIX` and `SAGE_GMP_INCLUDE`; but it is not available in the runtime environment (`sage_conf.py`, `sage-env-config`).

The failures reported in 
- ticket:31335#comment:47 
- https://groups.google.com/g/sage-release/c/6WjKQt_e_B8/m/H2I4HZ-YCwAJ (https://groups.google.com/g/sage-release/c/6WjKQt_e_B8/m/Uut_ZRaZCwAJ)
- https://groups.google.com/g/sage-release/c/0q3kywk7RP8/m/uspq0xeuAgAJ
can be fixed by simply changing `sage.misc.cython` to pick up `gmp.pc`.  But to avoid unpleasant surprises, we need to make sure that it is used consistently when present.

(After #32549, the relevant file is `build/pkgs/gmp/spkg-configure.m4`.)

The above applies to `mpfr` as well. See failure report in https://groups.google.com/g/sage-release/c/8ctwsUGl6LQ/m/Ob38Iyh1AAAJ

Similar situation with `readline` (#29000): The spkg-configure script already uses pkg-config - but forgets to tell the build system what it found.

Previous tickets: #27212


Issue created by migration from https://trac.sagemath.org/ticket/31348





---

archive/issue_comments_443878.json:
```json
{
    "body": "I started to play around with this a bit, and I can use python\u2019s pkgconfig to locate gmp and mpfr.  After doing that though, I get complaints about not being able to locagte -lntl, which I don\u2019t think I can find with pkgconfig since it doesn\u2019t have an ntl.pc file.\n\nThis may be a bit too hacky, but would it be possible in the build process to copy the various includes and libraries to SAGE_LOCAL/{include, lib} that are picked up by configure? That seems like it would solve a whole host of problems at the expense of if the user updates one of those libraries then the new version would not be picked up.",
    "created_at": "2021-02-09T02:14:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443878",
    "user": "https://github.com/zlscherr"
}
```

I started to play around with this a bit, and I can use python’s pkgconfig to locate gmp and mpfr.  After doing that though, I get complaints about not being able to locagte -lntl, which I don’t think I can find with pkgconfig since it doesn’t have an ntl.pc file.

This may be a bit too hacky, but would it be possible in the build process to copy the various includes and libraries to SAGE_LOCAL/{include, lib} that are picked up by configure? That seems like it would solve a whole host of problems at the expense of if the user updates one of those libraries then the new version would not be picked up.



---

archive/issue_comments_443879.json:
```json
{
    "body": "Replying to [comment:4 gh-zlscherr]:\n> I started to play around with this a bit, and I can use python\u2019s pkgconfig to locate gmp and mpfr.  After doing that though, I get complaints about not being able to locagte -lntl, which I don\u2019t think I can find with pkgconfig since it doesn\u2019t have an ntl.pc file.\n\n\nFor NTL, the configure script already determines `SAGE_NTL_PREFIX`.\nThis variable just needs to be used more.",
    "created_at": "2021-02-09T02:51:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443879",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:4 gh-zlscherr]:
> I started to play around with this a bit, and I can use python’s pkgconfig to locate gmp and mpfr.  After doing that though, I get complaints about not being able to locagte -lntl, which I don’t think I can find with pkgconfig since it doesn’t have an ntl.pc file.


For NTL, the configure script already determines `SAGE_NTL_PREFIX`.
This variable just needs to be used more.



---

archive/issue_comments_443880.json:
```json
{
    "body": "I've opened #31365 for NTL.",
    "created_at": "2021-02-09T02:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443880",
    "user": "https://github.com/mkoeppe"
}
```

I've opened #31365 for NTL.



---

archive/issue_comments_443881.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-04-07T21:00:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443881",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_443882.json:
```json
{
    "body": "I pushed very simple code for trying to deal with this.  It's probably better to use regular expressions, but I just wanted a proof of concept.  This allows make ptest to work with homebrew without having to source .homebrew-build-env.",
    "created_at": "2021-04-07T21:03:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443882",
    "user": "https://github.com/zlscherr"
}
```

I pushed very simple code for trying to deal with this.  It's probably better to use regular expressions, but I just wanted a proof of concept.  This allows make ptest to work with homebrew without having to source .homebrew-build-env.



---

archive/issue_comments_443883.json:
```json
{
    "body": "I've started getting [failures](https://math.mit.edu/~roed/31348.log) that are fixed by sourcing `.homebrew-build-env` even when I'm just changing Cython files and recompiling (not changing any spkgs).  Is this expected?",
    "created_at": "2021-04-26T05:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443883",
    "user": "https://github.com/roed314"
}
```

I've started getting [failures](https://math.mit.edu/~roed/31348.log) that are fixed by sourcing `.homebrew-build-env` even when I'm just changing Cython files and recompiling (not changing any spkgs).  Is this expected?



---

archive/issue_comments_443884.json:
```json
{
    "body": "Yes, this is part of what this ticket intends to fix.",
    "created_at": "2021-04-26T17:17:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443884",
    "user": "https://github.com/mkoeppe"
}
```

Yes, this is part of what this ticket intends to fix.



---

archive/issue_comments_443885.json:
```json
{
    "body": "Great, thanks for the clarification!",
    "created_at": "2021-04-26T18:00:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443885",
    "user": "https://github.com/roed314"
}
```

Great, thanks for the clarification!



---

archive/issue_events_082102.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-05-10T17:42:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31348#event-82102"
}
```



---

archive/issue_comments_443886.json:
```json
{
    "body": "Moving to 9.4, as 9.3 has been released.",
    "created_at": "2021-05-10T17:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443886",
    "user": "https://github.com/mkoeppe"
}
```

Moving to 9.4, as 9.3 has been released.



---

archive/issue_events_082103.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31348#event-82103"
}
```



---

archive/issue_events_082104.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31348#event-82104"
}
```



---

archive/issue_comments_443887.json:
```json
{
    "body": "some distros, like Fedora, have an unpleasant habit of not installing .pc files, while these are available.",
    "created_at": "2021-09-23T15:57:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443887",
    "user": "https://github.com/dimpase"
}
```

some distros, like Fedora, have an unpleasant habit of not installing .pc files, while these are available.



---

archive/issue_comments_443888.json:
```json
{
    "body": "Yes, the ticket is \"Check pkg-config first\", not \"Check pkg-config only\".",
    "created_at": "2021-09-23T15:59:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443888",
    "user": "https://github.com/mkoeppe"
}
```

Yes, the ticket is "Check pkg-config first", not "Check pkg-config only".



---

archive/issue_comments_443889.json:
```json
{
    "body": "IMO homebrew (and anyone else installing libgmp to a nonstandard directory) should be pestered to install it to the system's default location. I'm pretty sure that the gmp and mpir packages then conflict, but you don't need to install them both at the same time. In fact, mpir can probably be deprecated.\n\nUsing pkg-config just changes this potential problem (libraries in wrong locations) to another one (pc files in wrong locations) and adds an extra layer of indirection in the process. We may have to go ahead and fix it anyway, but we shouldn't lose track of the simple and easy way that this was all meant to work.",
    "created_at": "2021-09-23T17:00:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443889",
    "user": "https://github.com/orlitzky"
}
```

IMO homebrew (and anyone else installing libgmp to a nonstandard directory) should be pestered to install it to the system's default location. I'm pretty sure that the gmp and mpir packages then conflict, but you don't need to install them both at the same time. In fact, mpir can probably be deprecated.

Using pkg-config just changes this potential problem (libraries in wrong locations) to another one (pc files in wrong locations) and adds an extra layer of indirection in the process. We may have to go ahead and fix it anyway, but we shouldn't lose track of the simple and easy way that this was all meant to work.



---

archive/issue_comments_443890.json:
```json
{
    "body": "The problem on homebrew is really a very specific one, which I have explained in the ticket description: The GMP headers *are* installed in what you would call the \"standard location\" (`/usr/local/`), but when compiler/linker are invoked with `-isysroot`, then `/usr/local` is not a standard location. Yes, we fix it in the *build* environment using `.homebrew-build-env` but that does not affect the compiler use in the *runtime* environment.",
    "created_at": "2021-09-23T17:13:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443890",
    "user": "https://github.com/mkoeppe"
}
```

The problem on homebrew is really a very specific one, which I have explained in the ticket description: The GMP headers *are* installed in what you would call the "standard location" (`/usr/local/`), but when compiler/linker are invoked with `-isysroot`, then `/usr/local` is not a standard location. Yes, we fix it in the *build* environment using `.homebrew-build-env` but that does not affect the compiler use in the *runtime* environment.



---

archive/issue_comments_443891.json:
```json
{
    "body": "Replying to [comment:21 mjo]:\n> IMO homebrew (and anyone else installing libgmp to a nonstandard directory) should be pestered to install it to the system's default location. I'm pretty sure that the gmp and mpir packages then conflict, but you don't need to install them both at the same time. In fact, mpir can probably be deprecated.\n\n\nNo, brew does not install mpir in gmp-compatible mode, as far as\nI can tell from reading https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/mpir.rb\n- so there is no interference with gmp.",
    "created_at": "2021-09-23T18:27:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443891",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:21 mjo]:
> IMO homebrew (and anyone else installing libgmp to a nonstandard directory) should be pestered to install it to the system's default location. I'm pretty sure that the gmp and mpir packages then conflict, but you don't need to install them both at the same time. In fact, mpir can probably be deprecated.


No, brew does not install mpir in gmp-compatible mode, as far as
I can tell from reading https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/mpir.rb
- so there is no interference with gmp.



---

archive/issue_comments_443892.json:
```json
{
    "body": "Besides, we're getting rid of mpir spkg all together.",
    "created_at": "2021-09-23T18:28:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443892",
    "user": "https://github.com/dimpase"
}
```

Besides, we're getting rid of mpir spkg all together.



---

archive/issue_comments_443893.json:
```json
{
    "body": "This ticket has really nothing to do with MPIR. It's just (pre #32549) that the spkg-configure duties for gmp are done by MPIR's spkg-configure.",
    "created_at": "2021-09-23T18:29:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443893",
    "user": "https://github.com/mkoeppe"
}
```

This ticket has really nothing to do with MPIR. It's just (pre #32549) that the spkg-configure duties for gmp are done by MPIR's spkg-configure.



---

archive/issue_comments_443894.json:
```json
{
    "body": "Replying to [comment:22 mkoeppe]:\n> The problem on homebrew is really a very specific one, which I have explained in the ticket description: The GMP headers *are* installed in what you would call the \"standard location\" (`/usr/local/`), but when compiler/linker are invoked with `-isysroot`, then `/usr/local` is not a standard location. Yes, we fix it in the *build* environment using `.homebrew-build-env` but that does not affect the compiler use in the *runtime* environment.\n\n\nOh, the description makes it sounds like libgmp being in `/usr/local/Cellar/gmp/6.2.1/lib` is the problem. Is this another case of trying to use cython (which in turn uses the C toolchain) without sourcing `.homebrew-build-env` to make the C toolchain work?",
    "created_at": "2021-09-23T19:24:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443894",
    "user": "https://github.com/orlitzky"
}
```

Replying to [comment:22 mkoeppe]:
> The problem on homebrew is really a very specific one, which I have explained in the ticket description: The GMP headers *are* installed in what you would call the "standard location" (`/usr/local/`), but when compiler/linker are invoked with `-isysroot`, then `/usr/local` is not a standard location. Yes, we fix it in the *build* environment using `.homebrew-build-env` but that does not affect the compiler use in the *runtime* environment.


Oh, the description makes it sounds like libgmp being in `/usr/local/Cellar/gmp/6.2.1/lib` is the problem. Is this another case of trying to use cython (which in turn uses the C toolchain) without sourcing `.homebrew-build-env` to make the C toolchain work?



---

archive/issue_comments_443895.json:
```json
{
    "body": "It's really just the broken design of homebrew's `python3`. They use `-isysroot` in the build configuration of python, which goes into the compiler/flags of any extensions built via distutils/setuptools. Then they add back a few homebrew directories via `distutils.cfg`. It's hopelessly broken because these directories take priority over other user/package-provided include and linker directories. At build time, we work around it by disabling use of the system python's vendored distutils and use our own. \nAt runtime, we would be best off by using paths explicitly that can be discovered via pkg-config -- because in the Sage library we already do that for all other packages.",
    "created_at": "2021-09-25T01:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443895",
    "user": "https://github.com/mkoeppe"
}
```

It's really just the broken design of homebrew's `python3`. They use `-isysroot` in the build configuration of python, which goes into the compiler/flags of any extensions built via distutils/setuptools. Then they add back a few homebrew directories via `distutils.cfg`. It's hopelessly broken because these directories take priority over other user/package-provided include and linker directories. At build time, we work around it by disabling use of the system python's vendored distutils and use our own. 
At runtime, we would be best off by using paths explicitly that can be discovered via pkg-config -- because in the Sage library we already do that for all other packages.



---

archive/issue_comments_443896.json:
```json
{
    "body": "is this reported to Homebrew as a bug?",
    "created_at": "2021-09-25T07:30:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443896",
    "user": "https://github.com/dimpase"
}
```

is this reported to Homebrew as a bug?



---

archive/issue_comments_443897.json:
```json
{
    "body": "Replying to [comment:28 dimpase]:\n> is this reported to Homebrew as a bug?\n\nI didn't report it when I came across it in #31335. I figured a bug report titled \"distutils.cfg considered harmful\" would drain a lot of energy...",
    "created_at": "2021-09-25T17:02:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443897",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:28 dimpase]:
> is this reported to Homebrew as a bug?

I didn't report it when I came across it in #31335. I figured a bug report titled "distutils.cfg considered harmful" would drain a lot of energy...



---

archive/issue_comments_443898.json:
```json
{
    "body": "Replying to [comment:29 mkoeppe]:\n> Replying to [comment:28 dimpase]:\n> > is this reported to Homebrew as a bug?\n\n> I didn't report it when I came across it in #31335. I figured a bug report titled \"distutils.cfg considered harmful\" would drain a lot of energy... \n\nYou don't need to fight a battle, merely report the problem, please.",
    "created_at": "2021-09-26T08:12:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443898",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:29 mkoeppe]:
> Replying to [comment:28 dimpase]:
> > is this reported to Homebrew as a bug?

> I didn't report it when I came across it in #31335. I figured a bug report titled "distutils.cfg considered harmful" would drain a lot of energy... 

You don't need to fight a battle, merely report the problem, please.



---

archive/issue_comments_443899.json:
```json
{
    "body": "They're pretty quick with closing as wontfix if one doesn't also provide a patch",
    "created_at": "2021-09-27T19:18:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443899",
    "user": "https://github.com/mkoeppe"
}
```

They're pretty quick with closing as wontfix if one doesn't also provide a patch



---

archive/issue_comments_443900.json:
```json
{
    "body": "Replying to [comment:32 mkoeppe]:\n> They're pretty quick with closing as wontfix if one doesn't also provide a patch\n\n\nSprecht du kein Ruby, oder? :-)",
    "created_at": "2021-09-27T19:50:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443900",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:32 mkoeppe]:
> They're pretty quick with closing as wontfix if one doesn't also provide a patch


Sprecht du kein Ruby, oder? :-)



---

archive/issue_comments_443901.json:
```json
{
    "body": "Replying to [comment:31 dimpase]:\n> Replying to [comment:29 mkoeppe]:\n> > Replying to [comment:28 dimpase]:\n> > > is this reported to Homebrew as a bug?\n\n> > I didn't report it when I came across it in #31335. I figured a bug report titled \"distutils.cfg considered harmful\" would drain a lot of energy... \n> \n> You don't need to fight a battle, merely report the problem, please.\n\n\nI sent a first PR to reduce homebrew's `distutils.cfg` - https://github.com/Homebrew/homebrew-core/pull/91043",
    "created_at": "2021-12-12T00:15:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443901",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:31 dimpase]:
> Replying to [comment:29 mkoeppe]:
> > Replying to [comment:28 dimpase]:
> > > is this reported to Homebrew as a bug?

> > I didn't report it when I came across it in #31335. I figured a bug report titled "distutils.cfg considered harmful" would drain a lot of energy... 
> 
> You don't need to fight a battle, merely report the problem, please.


I sent a first PR to reduce homebrew's `distutils.cfg` - https://github.com/Homebrew/homebrew-core/pull/91043



---

archive/issue_comments_443902.json:
```json
{
    "body": "Changing keywords from \"\" to \"mpfr\".",
    "created_at": "2022-01-01T21:46:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443902",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "mpfr".



---

archive/issue_comments_443903.json:
```json
{
    "body": "Removed mpir from ticket summary after its removal in #32549, #32727.",
    "created_at": "2022-01-01T21:46:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443903",
    "user": "https://github.com/slel"
}
```

Removed mpir from ticket summary after its removal in #32549, #32727.



---

archive/issue_events_082105.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-10T00:37:38Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31348#event-82105"
}
```



---

archive/issue_events_082106.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-10T00:37:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31348#event-82106"
}
```



---

archive/issue_comments_443904.json:
```json
{
    "body": "Replying to [comment:34 mkoeppe]:\n> I sent a first PR to reduce homebrew's `distutils.cfg` - https://github.com/Homebrew/homebrew-core/pull/91043\n\n\nThey have merged a broader change now, eliminating all of `distutils.cfg` (https://github.com/Homebrew/homebrew-core/pull/91043#issuecomment-1032079055), at least for their Python 3.10 package. That's a good improvement, but it changes nothing for the present ticket.",
    "created_at": "2022-02-08T06:47:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443904",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:34 mkoeppe]:
> I sent a first PR to reduce homebrew's `distutils.cfg` - https://github.com/Homebrew/homebrew-core/pull/91043


They have merged a broader change now, eliminating all of `distutils.cfg` (https://github.com/Homebrew/homebrew-core/pull/91043#issuecomment-1032079055), at least for their Python 3.10 package. That's a good improvement, but it changes nothing for the present ticket.



---

archive/issue_events_082107.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31348#event-82107"
}
```



---

archive/issue_events_082108.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31348#event-82108"
}
```



---

archive/issue_comments_443905.json:
```json
{
    "body": "so this needs changes to gmp's and mpfr's `spkg-configure.m4` ? Anything else?",
    "created_at": "2022-05-20T13:19:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443905",
    "user": "https://github.com/dimpase"
}
```

so this needs changes to gmp's and mpfr's `spkg-configure.m4` ? Anything else?



---

archive/issue_comments_443906.json:
```json
{
    "body": "`sage.env.cython_aliases` also needs to be extended",
    "created_at": "2022-05-20T16:39:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443906",
    "user": "https://github.com/mkoeppe"
}
```

`sage.env.cython_aliases` also needs to be extended



---

archive/issue_comments_443907.json:
```json
{
    "body": "should we remove all the crud needed for gmp and mpfr without .pc files available?\n\nI suppose almost every platform we support nowadays will have them installed.",
    "created_at": "2022-05-30T10:59:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443907",
    "user": "https://github.com/dimpase"
}
```

should we remove all the crud needed for gmp and mpfr without .pc files available?

I suppose almost every platform we support nowadays will have them installed.



---

archive/issue_comments_443908.json:
```json
{
    "body": "Replying to [comment:43 dimpase]:\n> I suppose almost every platform we support nowadays will have them installed.\n\n\nThat would be worth checking.",
    "created_at": "2022-05-30T18:42:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31348#issuecomment-443908",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:43 dimpase]:
> I suppose almost every platform we support nowadays will have them installed.


That would be worth checking.



---

archive/issue_events_082109.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31348#event-82109"
}
```



---

archive/issue_events_082110.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31348",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31348#event-82110"
}
```
