# Issue 31851: Endomorphism rings of elliptic curves

archive/issues_031614.json:
```json
{
    "body": "Given an ordinary elliptic curve over a finite field, its endomorphism ring is an order in an imaginary quadratic field, which contains the order generated by the Frobenius (as computed by `frobenius_order`) but is in general larger. It would be nice to have an algorithm -- even a simple \"toy\" one -- to compute the endomorphism ring. This question came up on math.stackexchange, and there is working code linked from the answer:\n\n[https://math.stackexchange.com/questions/4147940/computing-the-endomorphism-ring-of-an-elliptic-curve-over-a-finite-field-in-sag](https://math.stackexchange.com/questions/4147940/computing-the-endomorphism-ring-of-an-elliptic-curve-over-a-finite-field-in-sag)\n\n(Even better, I guess, would be computing an explicit isogeny of smallish degree which generates the endomorphism ring.)\n\n**CC:**  @defeo @yyyyx4\n\n**Keywords:** endomorphisms, finite fields\n\nIssue created by migration from https://trac.sagemath.org/ticket/31851\n\n",
    "created_at": "2021-05-23T17:58:32Z",
    "labels": [
        "component: elliptic curves",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Endomorphism rings of elliptic curves",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31851",
    "user": "https://github.com/loefflerd"
}
```
Given an ordinary elliptic curve over a finite field, its endomorphism ring is an order in an imaginary quadratic field, which contains the order generated by the Frobenius (as computed by `frobenius_order`) but is in general larger. It would be nice to have an algorithm -- even a simple "toy" one -- to compute the endomorphism ring. This question came up on math.stackexchange, and there is working code linked from the answer:

[https://math.stackexchange.com/questions/4147940/computing-the-endomorphism-ring-of-an-elliptic-curve-over-a-finite-field-in-sag](https://math.stackexchange.com/questions/4147940/computing-the-endomorphism-ring-of-an-elliptic-curve-over-a-finite-field-in-sag)

(Even better, I guess, would be computing an explicit isogeny of smallish degree which generates the endomorphism ring.)

**CC:**  @defeo @yyyyx4

**Keywords:** endomorphisms, finite fields

Issue created by migration from https://trac.sagemath.org/ticket/31851





---

archive/issue_comments_516385.json:
```json
{
    "body": "<a id='comment:1'></a>\nI believe some variant of Kohel's algorithm should be fairly easy to implement, and possibly more efficient than the code in the Stackexchange answer. The bottlneck in most cases would be the factorization of the discriminant. Then you just iterate over the prime factors \u2113 of \u0394 that have valuation >1, and either compute \u2113-isogenies or compute the action of Frobenius on E[\u2113]. \n\nOf course, if \u2113 is too large you have a problem, but then the only way around is the Bisson-Sutherland algorithm.",
    "created_at": "2021-05-24T13:58:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31851#issuecomment-516385",
    "user": "https://github.com/defeo"
}
```

<a id='comment:1'></a>
I believe some variant of Kohel's algorithm should be fairly easy to implement, and possibly more efficient than the code in the Stackexchange answer. The bottlneck in most cases would be the factorization of the discriminant. Then you just iterate over the prime factors ℓ of Δ that have valuation >1, and either compute ℓ-isogenies or compute the action of Frobenius on E[ℓ]. 

Of course, if ℓ is too large you have a problem, but then the only way around is the Bisson-Sutherland algorithm.



---

archive/issue_comments_516386.json:
```json
{
    "body": "<a id='comment:2'></a>\nIt would be great to have an implementation of the fancier algorithms of Kohel or of Bisson-Sutherland. However, a simplistic and slow implementation is (IMHO) considerably better than having no implementation at all, as at present.",
    "created_at": "2021-05-24T17:36:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31851#issuecomment-516386",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:2'></a>
It would be great to have an implementation of the fancier algorithms of Kohel or of Bisson-Sutherland. However, a simplistic and slow implementation is (IMHO) considerably better than having no implementation at all, as at present.



---

archive/issue_events_290715.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31851",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31851#event-290715"
}
```



---

archive/issue_events_290716.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31851",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31851#event-290716"
}
```



---

archive/issue_events_290717.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31851",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31851#event-290717"
}
```



---

archive/issue_events_290718.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31851",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31851#event-290718"
}
```



---

archive/issue_events_290719.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T04:32:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31851",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31851#event-290719"
}
```



---

archive/issue_events_290720.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T04:32:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31851",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31851#event-290720"
}
```



---

archive/issue_events_290721.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T16:33:45Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31851",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31851#event-290721"
}
```



---

archive/issue_events_290722.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T16:33:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31851",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31851#event-290722"
}
```
