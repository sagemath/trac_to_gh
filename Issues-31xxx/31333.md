# Issue 31333: sage.env.sage_include_directories: Remove hard dependency on numpy

archive/issues_031096.json:
```json
{
    "body": "(extracted from and needed for #29865)\n\n`sage_include_directories` returns the basic list of include directories for compiling extensions, not including directories obtained through pkgconfig etc.  This basic list includes directories supplied by numpy. This is fine for the monolithic Sage library because `numpy` is a standard package; but in the course of modularization, we will have various distributions that do not need the dependency on numpy. \nWe use try/expect around the import and call to numpy.\n\n\n\nCC:  @kiwifb @tobiasdiez\n\nBranch/Commit: 4550eb6a753930c5818b63049f2eec197470ed1f\n\nReviewer: Fran\u00e7ois Bissey\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/31333\n\n",
    "closed_at": "2021-06-29T23:08:49Z",
    "created_at": "2021-02-03T22:57:29Z",
    "labels": [
        "component: refactoring"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "sage.env.sage_include_directories: Remove hard dependency on numpy",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31333",
    "user": "https://github.com/mkoeppe"
}
```
(extracted from and needed for #29865)

`sage_include_directories` returns the basic list of include directories for compiling extensions, not including directories obtained through pkgconfig etc.  This basic list includes directories supplied by numpy. This is fine for the monolithic Sage library because `numpy` is a standard package; but in the course of modularization, we will have various distributions that do not need the dependency on numpy. 
We use try/expect around the import and call to numpy.



CC:  @kiwifb @tobiasdiez

Branch/Commit: 4550eb6a753930c5818b63049f2eec197470ed1f

Reviewer: Fran√ßois Bissey

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/31333





---

archive/issue_comments_474013.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2021-02-04T00:04:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31333#issuecomment-474013",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_474014.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-02-04T00:04:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31333#issuecomment-474014",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_474015.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-\n+(extracted from #29865)\n \n Comment: 1\n \n```\n",
    "created_at": "2021-02-04T00:04:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31333#issuecomment-474015",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,4 @@
-
+(extracted from #29865)
 
 Comment: 1
 
```




---

archive/issue_comments_474016.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-04T00:22:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31333#issuecomment-474016",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_474017.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-02-04T00:22:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31333#issuecomment-474017",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_474018.json:
```json
{
    "body": "<a id='comment:5'></a>I think there should still be a log message if numpy couldn't be found, since otherwise errors further down the compile chain might be hard to track down.",
    "created_at": "2021-02-13T13:34:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31333#issuecomment-474018",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:5'></a>I think there should still be a log message if numpy couldn't be found, since otherwise errors further down the compile chain might be hard to track down.



---

archive/issue_events_082063.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-14T20:20:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31333",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31333#event-82063"
}
```



---

archive/issue_comments_474019.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-06-25T22:14:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31333#issuecomment-474019",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_474020.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,4 @@\n+(extracted from and needed for #29865)\n \n \n Comment: 1\n```\n",
    "created_at": "2021-06-25T22:14:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31333#issuecomment-474020",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,4 @@
+(extracted from and needed for #29865)
 
 
 Comment: 1
```




---

archive/issue_comments_474021.json:
```json
{
    "body": "<a id='comment:9'></a>The branch looks fine. Can the description be a bit more verbose on what this change will achieve? Obviously it makes the thing touched more resilient but for what purpose.",
    "created_at": "2021-06-26T01:07:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31333#issuecomment-474021",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>The branch looks fine. Can the description be a bit more verbose on what this change will achieve? Obviously it makes the thing touched more resilient but for what purpose.



---

archive/issue_comments_474022.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,8 @@\n+(extracted from and needed for #29865)\n+\n+\\`sage_include_directories\\` returns the basic list of include directories for compiling extensions, not including directories obtained through pkgconfig etc.  This basic list includes directories supplied by numpy. This is fine for the monolithic Sage library because \\`numpy\\` is a standard package; but in the course of modularization, we will have various distributions that do not need the dependency on numpy. \n+We use try/expect around the import and call to numpy.\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2021-06-26T01:18:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31333#issuecomment-474022",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,8 @@
+(extracted from and needed for #29865)
+
+\`sage_include_directories\` returns the basic list of include directories for compiling extensions, not including directories obtained through pkgconfig etc.  This basic list includes directories supplied by numpy. This is fine for the monolithic Sage library because \`numpy\` is a standard package; but in the course of modularization, we will have various distributions that do not need the dependency on numpy. 
+We use try/expect around the import and call to numpy.
+
 
 
 Comment: 1
```




---

archive/issue_comments_474023.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-06-26T01:19:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31333#issuecomment-474023",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_474024.json:
```json
{
    "body": "<a id='comment:11'></a>LGTM.",
    "created_at": "2021-06-26T01:19:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31333#issuecomment-474024",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:11'></a>LGTM.



---

archive/issue_comments_474025.json:
```json
{
    "body": "<a id='comment:12'></a>Thanks!",
    "created_at": "2021-06-26T01:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31333#issuecomment-474025",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>Thanks!



---

archive/issue_comments_474026.json:
```json
{
    "body": "<a id='comment:13'></a>\n```\n+    try:\n+        import numpy\n+        dirs.append(numpy.get_include())\n+    except ModuleNotFoundError:\n+        pass\n```\n\nShould this not better print an error message in case numpy is not found?",
    "created_at": "2021-06-26T05:25:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31333#issuecomment-474026",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:13'></a>
```
+    try:
+        import numpy
+        dirs.append(numpy.get_include())
+    except ModuleNotFoundError:
+        pass
```

Should this not better print an error message in case numpy is not found?



---

archive/issue_comments_474027.json:
```json
{
    "body": "<a id='comment:14'></a>No, the whole point of this ticket is that it's not an error.",
    "created_at": "2021-06-26T05:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31333#issuecomment-474027",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>No, the whole point of this ticket is that it's not an error.



---

archive/issue_events_082064.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-06-29T23:08:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31333",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31333#event-82064"
}
```



---

archive/issue_comments_474028.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-06-29T23:08:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31333#issuecomment-474028",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
