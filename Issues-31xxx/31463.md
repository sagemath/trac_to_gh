# Issue 31463: Univariate matrices: improve Weak Popov form; add Popov form

archive/issues_031226.json:
```json
{
    "assignees": [
        "https://github.com/ke456"
    ],
    "body": "**Improvements for weak Popov form**:\n* extend with an option allowing column-wise transformation into column weak Popov (for consistency with other functions),\n* sort the rows by increasing leading position (for consistency with other functions),\n* make some arbitrary but clearly stated choice for where zero rows are placed (typically, at the bottom of the weak Popov form).\n\nThe latter two changes will not impact performance since they only involve row permutation. They should not either impact code that uses the current version, since the current code only guarantees that the output is weak Popov, a fact not changed by the new specification.\n\n**Normalization into Popov form**: call the weak Popov form algorithm and then use Mulders and Storjohann algorithm to transform it into the canonical Popov form. Shifts should be supported, as well as working row-wise or column-wise.\n\n**Zero rows option**: for both weak Popov and Popov forms, add an option to allow the user to specify that they want a form with the zero rows removed (option set to False by default, for compatibility). The number of rows in the returned matrix is then the rank of the input matrix.\n\nCC:  @ke456\n\nKeywords: **polynomial matrix, canonical form**\n\nBranch/Commit: **[`b7e5f12`](https://github.com/sagemath/sagetrac-mirror/commit/b7e5f129f06975fe147b7e54ab0b290c53e4dc6a)**\n\nReviewer: **Seung Gyu Hyun**\n\nAuthor: **Vincent Neiger**\n\nComponent: **linear algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31463_\n\n",
    "closed_at": "2021-08-29T09:37:42Z",
    "created_at": "2021-03-07T19:53:24Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Univariate matrices: improve Weak Popov form; add Popov form",
    "type": "issue",
    "updated_at": "2021-08-29T09:37:42Z",
    "url": "https://github.com/sagemath/sage/issues/31463",
    "user": "https://github.com/vneiger"
}
```
**Improvements for weak Popov form**:
* extend with an option allowing column-wise transformation into column weak Popov (for consistency with other functions),
* sort the rows by increasing leading position (for consistency with other functions),
* make some arbitrary but clearly stated choice for where zero rows are placed (typically, at the bottom of the weak Popov form).

The latter two changes will not impact performance since they only involve row permutation. They should not either impact code that uses the current version, since the current code only guarantees that the output is weak Popov, a fact not changed by the new specification.

**Normalization into Popov form**: call the weak Popov form algorithm and then use Mulders and Storjohann algorithm to transform it into the canonical Popov form. Shifts should be supported, as well as working row-wise or column-wise.

**Zero rows option**: for both weak Popov and Popov forms, add an option to allow the user to specify that they want a form with the zero rows removed (option set to False by default, for compatibility). The number of rows in the returned matrix is then the rank of the input matrix.

CC:  @ke456

Keywords: **polynomial matrix, canonical form**

Branch/Commit: **[`b7e5f12`](https://github.com/sagemath/sagetrac-mirror/commit/b7e5f129f06975fe147b7e54ab0b290c53e4dc6a)**

Reviewer: **Seung Gyu Hyun**

Author: **Vincent Neiger**

Component: **linear algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/31463_





---

archive/issue_events_430545.json:
```json
{
    "actor": "https://github.com/vneiger",
    "created_at": "2021-03-07T19:53:24Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31463#event-430545"
}
```



---

archive/issue_events_430546.json:
```json
{
    "actor": "https://github.com/vneiger",
    "created_at": "2021-03-07T19:53:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "c: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31463#event-430546"
}
```



---

archive/issue_events_430547.json:
```json
{
    "actor": "https://github.com/vneiger",
    "created_at": "2021-03-07T19:53:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31463#event-430547"
}
```



---

archive/issue_events_430548.json:
```json
{
    "actor": "https://github.com/vneiger",
    "created_at": "2021-03-07T19:53:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31463#event-430548"
}
```



---

archive/issue_events_430549.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-24T02:04:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31463#event-430549"
}
```



---

archive/issue_events_430550.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-24T02:04:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31463#event-430550"
}
```



---

archive/issue_comments_505164.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nSage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-24T02:04:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505164",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_430551.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31463#event-430551"
}
```



---

archive/issue_events_430552.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31463#event-430552"
}
```



---

archive/issue_comments_505165.json:
```json
{
    "body": "Branch: **[u/gh-vneiger/univariate_matrices__improve_weak_popov_form__add_popov_form](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-vneiger/univariate_matrices__improve_weak_popov_form__add_popov_form)**",
    "created_at": "2021-07-27T12:55:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505165",
    "user": "https://github.com/vneiger"
}
```

Branch: **[u/gh-vneiger/univariate_matrices__improve_weak_popov_form__add_popov_form](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-vneiger/univariate_matrices__improve_weak_popov_form__add_popov_form)**



---

archive/issue_comments_505166.json:
```json
{
    "body": "Commit: **[`e6b65dd`](https://github.com/sagemath/sagetrac-mirror/commit/e6b65dddb129233067d2792b9aaef4b52fde0a28)**",
    "created_at": "2021-07-27T12:58:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505166",
    "user": "https://github.com/vneiger"
}
```

Commit: **[`e6b65dd`](https://github.com/sagemath/sagetrac-mirror/commit/e6b65dddb129233067d2792b9aaef4b52fde0a28)**



---

archive/issue_comments_505167.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nAll things above have been handled in a preliminary version, except for the transformation from weak Popov to (strong) Popov which is kept for later. Minor improvements/corrections are expected; documentation should be completed; and more tests should be done and some of them included in the documentation.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e6b65dddb129233067d2792b9aaef4b52fde0a28\"><code>e6b65dd</code></a></td><td><code>first version without tests yet; all things handled except transfo to Popov form</code></td></tr></table>\n",
    "created_at": "2021-07-27T12:58:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505167",
    "user": "https://github.com/vneiger"
}
```

<div id="comment:4" align="right">comment:4</div>

All things above have been handled in a preliminary version, except for the transformation from weak Popov to (strong) Popov which is kept for later. Minor improvements/corrections are expected; documentation should be completed; and more tests should be done and some of them included in the documentation.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e6b65dddb129233067d2792b9aaef4b52fde0a28"><code>e6b65dd</code></a></td><td><code>first version without tests yet; all things handled except transfo to Popov form</code></td></tr></table>




---

archive/issue_comments_505168.json:
```json
{
    "body": "Changed commit from **[`e6b65dd`](https://github.com/sagemath/sagetrac-mirror/commit/e6b65dddb129233067d2792b9aaef4b52fde0a28)** to **[`810048c`](https://github.com/sagemath/sagetrac-mirror/commit/810048c9a3389fb526c0d8043fc9635f893aae57)**",
    "created_at": "2021-07-27T17:10:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505168",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e6b65dd`](https://github.com/sagemath/sagetrac-mirror/commit/e6b65dddb129233067d2792b9aaef4b52fde0a28)** to **[`810048c`](https://github.com/sagemath/sagetrac-mirror/commit/810048c9a3389fb526c0d8043fc9635f893aae57)**



---

archive/issue_comments_505169.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0b5d84cae3c28f96f4373d485ec3fa805068703e\"><code>0b5d84c</code></a></td><td><code>minor refacto; noticing that existing algo is wrong when shift is negative</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c7c69e1612edadade90a474050167d61264d8e4d\"><code>c7c69e1</code></a></td><td><code>fix issue with shift having negative entries</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9cb203768197f620d3cc08f4a19d8dd0f5bb0bd2\"><code>9cb2037</code></a></td><td><code>improving documentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/810048c9a3389fb526c0d8043fc9635f893aae57\"><code>810048c</code></a></td><td><code>many fixes, better documentation</code></td></tr></table>\n",
    "created_at": "2021-07-27T17:10:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505169",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0b5d84cae3c28f96f4373d485ec3fa805068703e"><code>0b5d84c</code></a></td><td><code>minor refacto; noticing that existing algo is wrong when shift is negative</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c7c69e1612edadade90a474050167d61264d8e4d"><code>c7c69e1</code></a></td><td><code>fix issue with shift having negative entries</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9cb203768197f620d3cc08f4a19d8dd0f5bb0bd2"><code>9cb2037</code></a></td><td><code>improving documentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/810048c9a3389fb526c0d8043fc9635f893aae57"><code>810048c</code></a></td><td><code>many fixes, better documentation</code></td></tr></table>




---

archive/issue_comments_505170.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nSome testing has been done, and some minor corrections made. The documentation is fine now, it just misses some \"documentation tests\".",
    "created_at": "2021-07-27T17:11:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505170",
    "user": "https://github.com/vneiger"
}
```

<div id="comment:6" align="right">comment:6</div>

Some testing has been done, and some minor corrections made. The documentation is fine now, it just misses some "documentation tests".



---

archive/issue_comments_505171.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d8ce369aa5cb9cf3fef373847b37e15e1cf7264d\"><code>d8ce369</code></a></td><td><code>added numerous tests to documentation</code></td></tr></table>\n",
    "created_at": "2021-07-27T20:32:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505171",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d8ce369aa5cb9cf3fef373847b37e15e1cf7264d"><code>d8ce369</code></a></td><td><code>added numerous tests to documentation</code></td></tr></table>




---

archive/issue_comments_505172.json:
```json
{
    "body": "Changed commit from **[`810048c`](https://github.com/sagemath/sagetrac-mirror/commit/810048c9a3389fb526c0d8043fc9635f893aae57)** to **[`d8ce369`](https://github.com/sagemath/sagetrac-mirror/commit/d8ce369aa5cb9cf3fef373847b37e15e1cf7264d)**",
    "created_at": "2021-07-27T20:32:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505172",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`810048c`](https://github.com/sagemath/sagetrac-mirror/commit/810048c9a3389fb526c0d8043fc9635f893aae57)** to **[`d8ce369`](https://github.com/sagemath/sagetrac-mirror/commit/d8ce369aa5cb9cf3fef373847b37e15e1cf7264d)**



---

archive/issue_comments_505173.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6cc8850ae2ab9ff9e8f94f3481fd4652ecce0c18\"><code>6cc8850</code></a></td><td><code>added one test</code></td></tr></table>\n",
    "created_at": "2021-07-27T20:36:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505173",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6cc8850ae2ab9ff9e8f94f3481fd4652ecce0c18"><code>6cc8850</code></a></td><td><code>added one test</code></td></tr></table>




---

archive/issue_comments_505174.json:
```json
{
    "body": "Changed commit from **[`d8ce369`](https://github.com/sagemath/sagetrac-mirror/commit/d8ce369aa5cb9cf3fef373847b37e15e1cf7264d)** to **[`6cc8850`](https://github.com/sagemath/sagetrac-mirror/commit/6cc8850ae2ab9ff9e8f94f3481fd4652ecce0c18)**",
    "created_at": "2021-07-27T20:36:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505174",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d8ce369`](https://github.com/sagemath/sagetrac-mirror/commit/d8ce369aa5cb9cf3fef373847b37e15e1cf7264d)** to **[`6cc8850`](https://github.com/sagemath/sagetrac-mirror/commit/6cc8850ae2ab9ff9e8f94f3481fd4652ecce0c18)**



---

archive/issue_comments_505175.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad8417929fbd21db528f1de2b55754ff45318a5f\"><code>ad84179</code></a></td><td><code>all these tests are better over GF(7); also added one</code></td></tr></table>\n",
    "created_at": "2021-07-27T20:53:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505175",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad8417929fbd21db528f1de2b55754ff45318a5f"><code>ad84179</code></a></td><td><code>all these tests are better over GF(7); also added one</code></td></tr></table>




---

archive/issue_comments_505176.json:
```json
{
    "body": "Changed commit from **[`6cc8850`](https://github.com/sagemath/sagetrac-mirror/commit/6cc8850ae2ab9ff9e8f94f3481fd4652ecce0c18)** to **[`ad84179`](https://github.com/sagemath/sagetrac-mirror/commit/ad8417929fbd21db528f1de2b55754ff45318a5f)**",
    "created_at": "2021-07-27T20:53:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505176",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6cc8850`](https://github.com/sagemath/sagetrac-mirror/commit/6cc8850ae2ab9ff9e8f94f3481fd4652ecce0c18)** to **[`ad84179`](https://github.com/sagemath/sagetrac-mirror/commit/ad8417929fbd21db528f1de2b55754ff45318a5f)**



---

archive/issue_comments_505177.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0457e82fd1cea549273402f22132e41666e2f227\"><code>0457e82</code></a></td><td><code>fix typo and add one test</code></td></tr></table>\n",
    "created_at": "2021-07-27T20:57:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505177",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0457e82fd1cea549273402f22132e41666e2f227"><code>0457e82</code></a></td><td><code>fix typo and add one test</code></td></tr></table>




---

archive/issue_comments_505178.json:
```json
{
    "body": "Changed commit from **[`ad84179`](https://github.com/sagemath/sagetrac-mirror/commit/ad8417929fbd21db528f1de2b55754ff45318a5f)** to **[`0457e82`](https://github.com/sagemath/sagetrac-mirror/commit/0457e82fd1cea549273402f22132e41666e2f227)**",
    "created_at": "2021-07-27T20:57:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505178",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ad84179`](https://github.com/sagemath/sagetrac-mirror/commit/ad8417929fbd21db528f1de2b55754ff45318a5f)** to **[`0457e82`](https://github.com/sagemath/sagetrac-mirror/commit/0457e82fd1cea549273402f22132e41666e2f227)**



---

archive/issue_comments_505179.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nExcept for Popov form normalization, everything has been dealt with, including documentation and testing. Note that, to ensure backward compatibility, the computed weak Popov form is not ordered by default, unlike what was suggested in the ticket, but an option to get an ordered form is provided.",
    "created_at": "2021-07-27T20:59:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505179",
    "user": "https://github.com/vneiger"
}
```

<div id="comment:11" align="right">comment:11</div>

Except for Popov form normalization, everything has been dealt with, including documentation and testing. Note that, to ensure backward compatibility, the computed weak Popov form is not ordered by default, unlike what was suggested in the ticket, but an option to get an ordered form is provided.



---

archive/issue_comments_505180.json:
```json
{
    "body": "Changed commit from **[`0457e82`](https://github.com/sagemath/sagetrac-mirror/commit/0457e82fd1cea549273402f22132e41666e2f227)** to **[`9c1aea7`](https://github.com/sagemath/sagetrac-mirror/commit/9c1aea74da14521f2b6f76ed5b3e8abdb695d09b)**",
    "created_at": "2021-07-29T14:01:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505180",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0457e82`](https://github.com/sagemath/sagetrac-mirror/commit/0457e82fd1cea549273402f22132e41666e2f227)** to **[`9c1aea7`](https://github.com/sagemath/sagetrac-mirror/commit/9c1aea74da14521f2b6f76ed5b3e8abdb695d09b)**



---

archive/issue_comments_505181.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c1aea74da14521f2b6f76ed5b3e8abdb695d09b\"><code>9c1aea7</code></a></td><td><code>some minor style fixes; first version of popov_form including doctests</code></td></tr></table>\n",
    "created_at": "2021-07-29T14:01:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505181",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c1aea74da14521f2b6f76ed5b3e8abdb695d09b"><code>9c1aea7</code></a></td><td><code>some minor style fixes; first version of popov_form including doctests</code></td></tr></table>




---

archive/issue_comments_505182.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThe last commit does some minor fixes, and an implementation of Popov form normalization following the Mulders and Storjohann algorithm (first call weak Popov form, then normalize degrees by iterating on the rows). It seems to work well, and there is a good amount of doc tests already. It remains to write the corresponding documentation.",
    "created_at": "2021-07-29T14:03:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505182",
    "user": "https://github.com/vneiger"
}
```

<div id="comment:13" align="right">comment:13</div>

The last commit does some minor fixes, and an implementation of Popov form normalization following the Mulders and Storjohann algorithm (first call weak Popov form, then normalize degrees by iterating on the rows). It seems to work well, and there is a good amount of doc tests already. It remains to write the corresponding documentation.



---

archive/issue_comments_505183.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a41613f2441c59072514880fdaff501cc4ac1c4d\"><code>a41613f</code></a></td><td><code>documentation for Popov form and unification of documentation for weak Popov , reduced , Hermite</code></td></tr></table>\n",
    "created_at": "2021-07-29T17:23:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505183",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a41613f2441c59072514880fdaff501cc4ac1c4d"><code>a41613f</code></a></td><td><code>documentation for Popov form and unification of documentation for weak Popov , reduced , Hermite</code></td></tr></table>




---

archive/issue_comments_505184.json:
```json
{
    "body": "Changed commit from **[`9c1aea7`](https://github.com/sagemath/sagetrac-mirror/commit/9c1aea74da14521f2b6f76ed5b3e8abdb695d09b)** to **[`a41613f`](https://github.com/sagemath/sagetrac-mirror/commit/a41613f2441c59072514880fdaff501cc4ac1c4d)**",
    "created_at": "2021-07-29T17:23:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505184",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9c1aea7`](https://github.com/sagemath/sagetrac-mirror/commit/9c1aea74da14521f2b6f76ed5b3e8abdb695d09b)** to **[`a41613f`](https://github.com/sagemath/sagetrac-mirror/commit/a41613f2441c59072514880fdaff501cc4ac1c4d)**



---

archive/issue_comments_505185.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nDocumentation for Popov form is now ok. Some improvements have been done in the documentation for other related methods as well (Hermite, reduced, weak Popov): the definitions are in the verification method (`is_popov`, `is_reduced`, ..) while the computing method (`popov_form`, `reduced_form`, ..) just points to the relevant definition.",
    "created_at": "2021-07-29T17:25:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505185",
    "user": "https://github.com/vneiger"
}
```

<div id="comment:15" align="right">comment:15</div>

Documentation for Popov form is now ok. Some improvements have been done in the documentation for other related methods as well (Hermite, reduced, weak Popov): the definitions are in the verification method (`is_popov`, `is_reduced`, ..) while the computing method (`popov_form`, `reduced_form`, ..) just points to the relevant definition.



---

archive/issue_events_430553.json:
```json
{
    "actor": "https://github.com/ke456",
    "created_at": "2021-07-29T18:22:31Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "subject": "https://github.com/ke456",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31463#event-430553"
}
```



---

archive/issue_comments_505186.json:
```json
{
    "body": "Changed commit from **[`a41613f`](https://github.com/sagemath/sagetrac-mirror/commit/a41613f2441c59072514880fdaff501cc4ac1c4d)** to **[`075e75c`](https://github.com/sagemath/sagetrac-mirror/commit/075e75ced89f79a928089eef10c23ffadae37b1e)**",
    "created_at": "2021-07-29T18:28:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505186",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a41613f`](https://github.com/sagemath/sagetrac-mirror/commit/a41613f2441c59072514880fdaff501cc4ac1c4d)** to **[`075e75c`](https://github.com/sagemath/sagetrac-mirror/commit/075e75ced89f79a928089eef10c23ffadae37b1e)**



---

archive/issue_comments_505187.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/075e75ced89f79a928089eef10c23ffadae37b1e\"><code>075e75c</code></a></td><td><code>changes line</code></td></tr></table>\n",
    "created_at": "2021-07-29T18:28:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505187",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/075e75ced89f79a928089eef10c23ffadae37b1e"><code>075e75c</code></a></td><td><code>changes line</code></td></tr></table>




---

archive/issue_events_430554.json:
```json
{
    "actor": "https://github.com/vneiger",
    "created_at": "2021-07-29T18:28:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31463#event-430554"
}
```



---

archive/issue_comments_505188.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nThe comments and tests seem good, but maybe the documentation for reduced_form could be more clear about what reduced form is being computed (since it is not a canonical form). For example, is it randomly computed?\n\nThis function should also be simplified using the new weak_popov_form functionalities.",
    "created_at": "2021-07-29T18:43:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505188",
    "user": "https://github.com/ke456"
}
```

<div id="comment:19" align="right">comment:19</div>

The comments and tests seem good, but maybe the documentation for reduced_form could be more clear about what reduced form is being computed (since it is not a canonical form). For example, is it randomly computed?

This function should also be simplified using the new weak_popov_form functionalities.



---

archive/issue_comments_505189.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nThank you for noticing this, indeed `reduced_form` should be simplified, it does not need to distinguish row-wise and column-wise anymore thanks to the new `weak_popov_form` features. I'm going to fix this in a commit right now.\n\nAnd indeed, the documentation is unclear because it puts too much highlight on the fact that a reduced form is not unique (for example this is also the case for weak Popov forms, and this is not even mentioned in the weak Popov documentation).\n\nI think this is more confusing than helping, since it already appears clearly in the definitions and the class description that the Popov / Hermite forms are unique, but reduced forms and weak Popov forms are not. So my proposition would be to simply remove this confusing comment: does that sound better?",
    "created_at": "2021-07-29T20:43:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505189",
    "user": "https://github.com/vneiger"
}
```

<div id="comment:20" align="right">comment:20</div>

Thank you for noticing this, indeed `reduced_form` should be simplified, it does not need to distinguish row-wise and column-wise anymore thanks to the new `weak_popov_form` features. I'm going to fix this in a commit right now.

And indeed, the documentation is unclear because it puts too much highlight on the fact that a reduced form is not unique (for example this is also the case for weak Popov forms, and this is not even mentioned in the weak Popov documentation).

I think this is more confusing than helping, since it already appears clearly in the definitions and the class description that the Popov / Hermite forms are unique, but reduced forms and weak Popov forms are not. So my proposition would be to simply remove this confusing comment: does that sound better?



---

archive/issue_comments_505190.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/258d4352236a778cfb7fef8d4c7e196bc17173c0\"><code>258d435</code></a></td><td><code>reduced form simplification using new weak Popov</code></td></tr></table>\n",
    "created_at": "2021-07-29T20:49:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505190",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/258d4352236a778cfb7fef8d4c7e196bc17173c0"><code>258d435</code></a></td><td><code>reduced form simplification using new weak Popov</code></td></tr></table>




---

archive/issue_comments_505191.json:
```json
{
    "body": "Changed commit from **[`075e75c`](https://github.com/sagemath/sagetrac-mirror/commit/075e75ced89f79a928089eef10c23ffadae37b1e)** to **[`258d435`](https://github.com/sagemath/sagetrac-mirror/commit/258d4352236a778cfb7fef8d4c7e196bc17173c0)**",
    "created_at": "2021-07-29T20:49:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505191",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`075e75c`](https://github.com/sagemath/sagetrac-mirror/commit/075e75ced89f79a928089eef10c23ffadae37b1e)** to **[`258d435`](https://github.com/sagemath/sagetrac-mirror/commit/258d4352236a778cfb7fef8d4c7e196bc17173c0)**



---

archive/issue_comments_505192.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nYes, I think this is a sensible solution.",
    "created_at": "2021-07-29T21:57:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505192",
    "user": "https://github.com/ke456"
}
```

<div id="comment:22" align="right">comment:22</div>

Yes, I think this is a sensible solution.



---

archive/issue_comments_505193.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b7e5f129f06975fe147b7e54ab0b290c53e4dc6a\"><code>b7e5f12</code></a></td><td><code>fixing documentation of reduced form</code></td></tr></table>\n",
    "created_at": "2021-07-29T22:00:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505193",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b7e5f129f06975fe147b7e54ab0b290c53e4dc6a"><code>b7e5f12</code></a></td><td><code>fixing documentation of reduced form</code></td></tr></table>




---

archive/issue_comments_505194.json:
```json
{
    "body": "Changed commit from **[`258d435`](https://github.com/sagemath/sagetrac-mirror/commit/258d4352236a778cfb7fef8d4c7e196bc17173c0)** to **[`b7e5f12`](https://github.com/sagemath/sagetrac-mirror/commit/b7e5f129f06975fe147b7e54ab0b290c53e4dc6a)**",
    "created_at": "2021-07-29T22:00:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505194",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`258d435`](https://github.com/sagemath/sagetrac-mirror/commit/258d4352236a778cfb7fef8d4c7e196bc17173c0)** to **[`b7e5f12`](https://github.com/sagemath/sagetrac-mirror/commit/b7e5f129f06975fe147b7e54ab0b290c53e4dc6a)**



---

archive/issue_comments_505195.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nOk, done in the last commit. Is there any other thing that still needs to be verified or improved?",
    "created_at": "2021-07-29T22:01:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505195",
    "user": "https://github.com/vneiger"
}
```

<div id="comment:24" align="right">comment:24</div>

Ok, done in the last commit. Is there any other thing that still needs to be verified or improved?



---

archive/issue_comments_505196.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nI have checked again after the modifications and the functionality reflects the description of the ticket, and the testing, documentation, and style are okay as well.",
    "created_at": "2021-07-30T21:05:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505196",
    "user": "https://github.com/ke456"
}
```

<div id="comment:25" align="right">comment:25</div>

I have checked again after the modifications and the functionality reflects the description of the ticket, and the testing, documentation, and style are okay as well.



---

archive/issue_events_430555.json:
```json
{
    "actor": "https://github.com/ke456",
    "created_at": "2021-07-30T21:05:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31463#event-430555"
}
```



---

archive/issue_events_430556.json:
```json
{
    "actor": "https://github.com/ke456",
    "created_at": "2021-07-30T21:05:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31463#event-430556"
}
```



---

archive/issue_comments_505197.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nThanks for the reviewing. Then I suppose we can revert to milestone 9.4.",
    "created_at": "2021-07-30T21:09:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505197",
    "user": "https://github.com/vneiger"
}
```

<div id="comment:26" align="right">comment:26</div>

Thanks for the reviewing. Then I suppose we can revert to milestone 9.4.



---

archive/issue_events_430557.json:
```json
{
    "actor": "https://github.com/vneiger",
    "created_at": "2021-07-30T21:09:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31463#event-430557"
}
```



---

archive/issue_events_430558.json:
```json
{
    "actor": "https://github.com/vneiger",
    "created_at": "2021-07-30T21:09:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31463#event-430558"
}
```



---

archive/issue_events_430559.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31463#event-430559"
}
```



---

archive/issue_events_430560.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31463#event-430560"
}
```



---

archive/issue_events_430561.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-08-29T09:37:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31463#event-430561"
}
```



---

archive/issue_events_430562.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "8bf04b3c9918a18cb43ec842c3ee823c3cc91f1f",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-08-29T09:37:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31463#event-430562"
}
```



---

archive/issue_comments_505198.json:
```json
{
    "body": "Changed branch from **[u/gh-vneiger/univariate_matrices__improve_weak_popov_form__add_popov_form](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-vneiger/univariate_matrices__improve_weak_popov_form__add_popov_form)** to **[`b7e5f12`](https://github.com/sagemath/sagetrac-mirror/commit/b7e5f129f06975fe147b7e54ab0b290c53e4dc6a)**",
    "created_at": "2021-08-29T09:37:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31463#issuecomment-505198",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/gh-vneiger/univariate_matrices__improve_weak_popov_form__add_popov_form](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-vneiger/univariate_matrices__improve_weak_popov_form__add_popov_form)** to **[`b7e5f12`](https://github.com/sagemath/sagetrac-mirror/commit/b7e5f129f06975fe147b7e54ab0b290c53e4dc6a)**
