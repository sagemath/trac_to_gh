# Issue 31940: Absolutely simple endomorphism rings

archive/issues_031703.json:
```json
{
    "assignees": [],
    "body": "This commit adds the first functionality for endomorphism rings of jacobians of genus 2 curves over Q. There is a new class `EndomorphismRing`, and two methods of this class: `is_absolutely_field` which determines whether or not the endomorphism algebra is a field; and `is_absolutely_trivial`, which determines whether or not the ring is just the integer ring Z.\n\nOne corresponding attribute has been added to the Jacobian of the hyperelliptic curve: `is_generic`, which is a wrapper for `is_absolutely_trivial` above.\n\nThe algorithms are based on Lombardo's paper \"Computing the geometric endomorphism ring of a genus 2 Jacobian\".\n\nThis is needed for trac ticket #30837.\n\nCC:  @roed314 @nbruin @edgarcosta davide.lombardo@unipi.it\n\nKeywords: **hyperelliptic curves, jacobians, endomorphism rings**\n\nBranch/Commit: **[462db22](https://github.com/sagemath/sagetrac-mirror/commit/462db22ebabae2134de4a3d4f156bb68b698e2d9)**\n\nReviewer: **Edgar Costa, Nils Bruin**\n\nAuthor: **Barinder S. Banwait, Davide Lombardo**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31940_\n\n",
    "closed_at": "2021-08-29T09:36:20Z",
    "created_at": "2021-06-09T04:05:26Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20number%20theory",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Absolutely simple endomorphism rings",
    "type": "issue",
    "updated_at": "2021-08-29T09:36:20Z",
    "url": "https://github.com/sagemath/sage/issues/31940",
    "user": "https://github.com/BarinderBanwait"
}
```
This commit adds the first functionality for endomorphism rings of jacobians of genus 2 curves over Q. There is a new class `EndomorphismRing`, and two methods of this class: `is_absolutely_field` which determines whether or not the endomorphism algebra is a field; and `is_absolutely_trivial`, which determines whether or not the ring is just the integer ring Z.

One corresponding attribute has been added to the Jacobian of the hyperelliptic curve: `is_generic`, which is a wrapper for `is_absolutely_trivial` above.

The algorithms are based on Lombardo's paper "Computing the geometric endomorphism ring of a genus 2 Jacobian".

This is needed for trac ticket #30837.

CC:  @roed314 @nbruin @edgarcosta davide.lombardo@unipi.it

Keywords: **hyperelliptic curves, jacobians, endomorphism rings**

Branch/Commit: **[462db22](https://github.com/sagemath/sagetrac-mirror/commit/462db22ebabae2134de4a3d4f156bb68b698e2d9)**

Reviewer: **Edgar Costa, Nils Bruin**

Author: **Barinder S. Banwait, Davide Lombardo**

_Issue created by migration from https://trac.sagemath.org/ticket/31940_





---

archive/issue_events_422174.json:
```json
{
    "actor": "https://github.com/BarinderBanwait",
    "created_at": "2021-06-09T04:05:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-422174"
}
```



---

archive/issue_events_422175.json:
```json
{
    "actor": "https://github.com/BarinderBanwait",
    "created_at": "2021-06-09T04:05:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-422175"
}
```



---

archive/issue_comments_516927.json:
```json
{
    "body": "Branch: **[u/gh-BarinderBanwait/absolutely_simple_endomorphism_rings](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-BarinderBanwait/absolutely_simple_endomorphism_rings)**",
    "created_at": "2021-06-09T11:09:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516927",
    "user": "https://github.com/BarinderBanwait"
}
```

Branch: **[u/gh-BarinderBanwait/absolutely_simple_endomorphism_rings](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-BarinderBanwait/absolutely_simple_endomorphism_rings)**



---

archive/issue_comments_516928.json:
```json
{
    "body": "Changed keywords from **** to **hyperelliptic curves, jacobians, endomorphism rings**",
    "created_at": "2021-06-09T11:21:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516928",
    "user": "https://github.com/BarinderBanwait"
}
```

Changed keywords from **** to **hyperelliptic curves, jacobians, endomorphism rings**



---

archive/issue_events_422176.json:
```json
{
    "actor": "https://github.com/BarinderBanwait",
    "created_at": "2021-06-09T11:21:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-422176"
}
```



---

archive/issue_events_422177.json:
```json
{
    "actor": "https://github.com/BarinderBanwait",
    "created_at": "2021-06-09T11:21:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-422177"
}
```



---

archive/issue_events_422178.json:
```json
{
    "actor": "https://github.com/BarinderBanwait",
    "created_at": "2021-06-09T11:21:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-422178"
}
```



---

archive/issue_comments_516929.json:
```json
{
    "body": "Author: **Barinder S. Banwait and Davide Lombardo**",
    "created_at": "2021-06-09T11:21:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516929",
    "user": "https://github.com/BarinderBanwait"
}
```

Author: **Barinder S. Banwait and Davide Lombardo**



---

archive/issue_comments_516930.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n+This commit adds the first functionality for endomorphism rings of jacobians of genus 2 curves over Q. There is a new class `EndomorphismRing`, and two methods of this class: `is_absolutely_field` which determines whether or not the endomorphism algebra is a field; and `is_absolutely_trivial`, which determines whether or not the ring is just the integer ring Z.\n \n+Corresponding attributes have been added to the Jacobian of the hyperelliptic curve: `is_absolutely_simple` and `is_generic`.\n+\n+This is needed for trac ticket #30837, and in that sense is blocking this other work.\n``````\n",
    "created_at": "2021-06-09T11:21:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516930",
    "user": "https://github.com/BarinderBanwait"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,5 @@
+This commit adds the first functionality for endomorphism rings of jacobians of genus 2 curves over Q. There is a new class `EndomorphismRing`, and two methods of this class: `is_absolutely_field` which determines whether or not the endomorphism algebra is a field; and `is_absolutely_trivial`, which determines whether or not the ring is just the integer ring Z.
 
+Corresponding attributes have been added to the Jacobian of the hyperelliptic curve: `is_absolutely_simple` and `is_generic`.
+
+This is needed for trac ticket #30837, and in that sense is blocking this other work.
``````




---

archive/issue_comments_516931.json:
```json
{
    "body": "Commit: **[a8a8a20](https://github.com/sagemath/sagetrac-mirror/commit/a8a8a20832dcf8515186ef995f4e37b2a879a2a1)**",
    "created_at": "2021-06-09T11:21:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516931",
    "user": "https://github.com/BarinderBanwait"
}
```

Commit: **[a8a8a20](https://github.com/sagemath/sagetrac-mirror/commit/a8a8a20832dcf8515186ef995f4e37b2a879a2a1)**



---

archive/issue_events_422179.json:
```json
{
    "actor": "https://github.com/BarinderBanwait",
    "created_at": "2021-06-09T11:23:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20number%20theory",
    "label_color": "0000ff",
    "label_name": "component: number theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-422179"
}
```



---

archive/issue_comments_516932.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,6 @@\n \n Corresponding attributes have been added to the Jacobian of the hyperelliptic curve: `is_absolutely_simple` and `is_generic`.\n \n+The algorithms are based on Lombardo's paper \"Computing the geometric endomorphism ring of a genus 2 Jacobian\".\n+\n This is needed for trac ticket #30837, and in that sense is blocking this other work.\n``````\n",
    "created_at": "2021-06-09T11:38:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516932",
    "user": "https://github.com/BarinderBanwait"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,6 @@
 
 Corresponding attributes have been added to the Jacobian of the hyperelliptic curve: `is_absolutely_simple` and `is_generic`.
 
+The algorithms are based on Lombardo's paper "Computing the geometric endomorphism ring of a genus 2 Jacobian".
+
 This is needed for trac ticket #30837, and in that sense is blocking this other work.
``````




---

archive/issue_comments_516933.json:
```json
{
    "body": "Changed author from **Barinder S. Banwait and Davide Lombardo** to **Barinder S. Banwait, Davide Lombardo**",
    "created_at": "2021-06-09T11:48:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516933",
    "user": "https://github.com/BarinderBanwait"
}
```

Changed author from **Barinder S. Banwait and Davide Lombardo** to **Barinder S. Banwait, Davide Lombardo**



---

archive/issue_comments_516934.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nBlockers are for fixes without which it's unacceptable to ship a new release of sagemath. If a ticket is a dependency for another one, then you can just the other ticket to depend on it. That doesn't block releasing or working on the tickets; it just indicates that the dependency needs to be merged before the depending ticket. The dependent ticket should probably have its branch based on the dependency (which is one of the reasons to indicate the dependency on the ticket: knowing which order to merge branches in can save rebasing)",
    "created_at": "2021-06-09T16:37:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516934",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:6'>Comment 6:</a>
Blockers are for fixes without which it's unacceptable to ship a new release of sagemath. If a ticket is a dependency for another one, then you can just the other ticket to depend on it. That doesn't block releasing or working on the tickets; it just indicates that the dependency needs to be merged before the depending ticket. The dependent ticket should probably have its branch based on the dependency (which is one of the reasons to indicate the dependency on the ticket: knowing which order to merge branches in can save rebasing)



---

archive/issue_events_422180.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2021-06-09T16:37:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-422180"
}
```



---

archive/issue_events_422181.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2021-06-09T16:37:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-422181"
}
```



---

archive/issue_comments_516935.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nThanks for clarifying Nils -- I didn't realise 'blocker' meant 'release blocker', but in hindsight I should have guessed that. Apologies, and thanks for updating the dependency on the other ticket.",
    "created_at": "2021-06-09T16:46:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516935",
    "user": "https://github.com/BarinderBanwait"
}
```

<a id='comment:7'>Comment 7:</a>
Thanks for clarifying Nils -- I didn't realise 'blocker' meant 'release blocker', but in hindsight I should have guessed that. Apologies, and thanks for updating the dependency on the other ticket.



---

archive/issue_comments_516936.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad600bb293ffc07c3fbdd25679bc581993787e01\">ad600bb</a></td><td><code>Fixed doc strings</code></td></tr></table>\n",
    "created_at": "2021-06-30T06:29:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516936",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:9'>Comment 9:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad600bb293ffc07c3fbdd25679bc581993787e01">ad600bb</a></td><td><code>Fixed doc strings</code></td></tr></table>




---

archive/issue_comments_516937.json:
```json
{
    "body": "Changed commit from **[a8a8a20](https://github.com/sagemath/sagetrac-mirror/commit/a8a8a20832dcf8515186ef995f4e37b2a879a2a1)** to **[ad600bb](https://github.com/sagemath/sagetrac-mirror/commit/ad600bb293ffc07c3fbdd25679bc581993787e01)**",
    "created_at": "2021-06-30T06:29:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516937",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[a8a8a20](https://github.com/sagemath/sagetrac-mirror/commit/a8a8a20832dcf8515186ef995f4e37b2a879a2a1)** to **[ad600bb](https://github.com/sagemath/sagetrac-mirror/commit/ad600bb293ffc07c3fbdd25679bc581993787e01)**



---

archive/issue_comments_516938.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nI've updated the docstrings on the two modules `jacobian_endomorphisms.py` and `jacobian_generic.py`, both of which pass when locally running those modules individually, so I'm marking this as ready for review. The linter *is* failing, but those failures don't seem related to these changes.",
    "created_at": "2021-06-30T06:36:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516938",
    "user": "https://github.com/BarinderBanwait"
}
```

<a id='comment:10'>Comment 10:</a>
I've updated the docstrings on the two modules `jacobian_endomorphisms.py` and `jacobian_generic.py`, both of which pass when locally running those modules individually, so I'm marking this as ready for review. The linter *is* failing, but those failures don't seem related to these changes.



---

archive/issue_events_422182.json:
```json
{
    "actor": "https://github.com/BarinderBanwait",
    "created_at": "2021-06-30T06:36:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-422182"
}
```



---

archive/issue_comments_516939.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n This commit adds the first functionality for endomorphism rings of jacobians of genus 2 curves over Q. There is a new class `EndomorphismRing`, and two methods of this class: `is_absolutely_field` which determines whether or not the endomorphism algebra is a field; and `is_absolutely_trivial`, which determines whether or not the ring is just the integer ring Z.\n \n-Corresponding attributes have been added to the Jacobian of the hyperelliptic curve: `is_absolutely_simple` and `is_generic`.\n+One corresponding attribute has been added to the Jacobian of the hyperelliptic curve: `is_generic`, which is a wrapper for `is_absolutely_trivial` above.\n \n The algorithms are based on Lombardo's paper \"Computing the geometric endomorphism ring of a genus 2 Jacobian\".\n \n-This is needed for trac ticket #30837, and in that sense is blocking this other work.\n+This is needed for trac ticket #30837.\n``````\n",
    "created_at": "2021-06-30T10:15:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516939",
    "user": "https://github.com/BarinderBanwait"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,7 @@
 This commit adds the first functionality for endomorphism rings of jacobians of genus 2 curves over Q. There is a new class `EndomorphismRing`, and two methods of this class: `is_absolutely_field` which determines whether or not the endomorphism algebra is a field; and `is_absolutely_trivial`, which determines whether or not the ring is just the integer ring Z.
 
-Corresponding attributes have been added to the Jacobian of the hyperelliptic curve: `is_absolutely_simple` and `is_generic`.
+One corresponding attribute has been added to the Jacobian of the hyperelliptic curve: `is_generic`, which is a wrapper for `is_absolutely_trivial` above.
 
 The algorithms are based on Lombardo's paper "Computing the geometric endomorphism ring of a genus 2 Jacobian".
 
-This is needed for trac ticket #30837, and in that sense is blocking this other work.
+This is needed for trac ticket #30837.
``````




---

archive/issue_comments_516940.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nI left some comments in: https://github.com/sagemath/sagetrac-mirror/pull/2/files\nand I'm happy to look at this again once the comments have been addressed.",
    "created_at": "2021-07-09T17:32:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516940",
    "user": "https://github.com/edgarcosta"
}
```

<a id='comment:12'>Comment 12:</a>
I left some comments in: https://github.com/sagemath/sagetrac-mirror/pull/2/files
and I'm happy to look at this again once the comments have been addressed.



---

archive/issue_comments_516941.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nWhy doesn't `EndomorphismRing` inherit from `Homset`? It should also use `_repr_` rather than `__repr__`.\n\nI think you should not cache the result of `endomorphism_ring`. It should redirect to `Hom`, which does caching, and implement a `_Hom_` method as\n\n```python\ndef _Hom_(self, Y, category):\n    if self == Y:\n        from .jacobian_endomorphisms import EndomorphismRing\n        return EndomorphismRing(self)\n    return super()._Hom_(Y, category)\n```\nThat way someone doing `End(X)` or `Hom(X, X)` will get the endomorphism ring as well.\n\nA few things about the documentation:\n\n```diff\n     def is_generic(self, B=200):\n         r\"\"\"\n-        Returns whether the absolute endomorphism algebra of self is the\n+        Return whether the absolute endomorphism algebra of ``self`` is the\n         integer ring `\\ZZ`.\n \n         INPUT:\n \n-        - ``B`` -- the bound which appears in the statement of the algorithm\n-        from Lombardo's paper. Defaults to 200.\n+        - ``B`` -- (default: 200) the bound which appears in the statement of\n+          the algorithm from [Lom2019]_\n \n         OUTPUT:\n \n-            (bool): boolean indicating whether or not the absolute endomorphism\n-            ring is isomorphic to the integer ring.\n+        Boolean indicating whether or not the absolute endomorphism\n+        ring is isomorphic to the integer ring.\n \n-        EXAMPLES::\n+        EXAMPLES:\n \n-        This is LMFDB curve 603.a.603.2\n+        This is LMFDB curve 603.a.603.2::\n\n             sage: R.<x> = QQ[]\n             sage: f = 4*x^5 + x^4 - 4*x^3 + 2*x^2 + 4*x + 1\n             sage: C = HyperellipticCurve(f)\n```\nand similar changes. The biggest is when `EXAMPLES` is followed by text, it should be a single colon `:`, when something it to have Sage code after it, it should be a double colon `::`.\n\nThe `Codes up Lombardo's Algorithm 4.15` is not a really good explanation of what the function does. It is good to state `This is Algorithm 4.15 in [Lom2019]_.`, yet it is good to be more self-contained with a more descriptive version of what the function does.",
    "created_at": "2021-07-09T23:11:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516941",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'>Comment 13:</a>
Why doesn't `EndomorphismRing` inherit from `Homset`? It should also use `_repr_` rather than `__repr__`.

I think you should not cache the result of `endomorphism_ring`. It should redirect to `Hom`, which does caching, and implement a `_Hom_` method as

```python
def _Hom_(self, Y, category):
    if self == Y:
        from .jacobian_endomorphisms import EndomorphismRing
        return EndomorphismRing(self)
    return super()._Hom_(Y, category)
```
That way someone doing `End(X)` or `Hom(X, X)` will get the endomorphism ring as well.

A few things about the documentation:

```diff
     def is_generic(self, B=200):
         r"""
-        Returns whether the absolute endomorphism algebra of self is the
+        Return whether the absolute endomorphism algebra of ``self`` is the
         integer ring `\ZZ`.
 
         INPUT:
 
-        - ``B`` -- the bound which appears in the statement of the algorithm
-        from Lombardo's paper. Defaults to 200.
+        - ``B`` -- (default: 200) the bound which appears in the statement of
+          the algorithm from [Lom2019]_
 
         OUTPUT:
 
-            (bool): boolean indicating whether or not the absolute endomorphism
-            ring is isomorphic to the integer ring.
+        Boolean indicating whether or not the absolute endomorphism
+        ring is isomorphic to the integer ring.
 
-        EXAMPLES::
+        EXAMPLES:
 
-        This is LMFDB curve 603.a.603.2
+        This is LMFDB curve 603.a.603.2::

             sage: R.<x> = QQ[]
             sage: f = 4*x^5 + x^4 - 4*x^3 + 2*x^2 + 4*x + 1
             sage: C = HyperellipticCurve(f)
```
and similar changes. The biggest is when `EXAMPLES` is followed by text, it should be a single colon `:`, when something it to have Sage code after it, it should be a double colon `::`.

The `Codes up Lombardo's Algorithm 4.15` is not a really good explanation of what the function does. It is good to state `This is Algorithm 4.15 in [Lom2019]_.`, yet it is good to be more self-contained with a more descriptive version of what the function does.



---

archive/issue_comments_516942.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nBarinder emailed me:\n> I've been struggling to implement the lazy attributes you suggested, particularly in 'jacobian_endomorphisms.py' regarding the flags '_have_established_geometrically_field' and '_have_established_geometrically_trivial'. The problem is that these are not attributes in the conventional sense, and is related to the warning at the top of the file.\n\nI agree with you.\nPerhaps, `__endomorphism_ring` is the only one that makes sense, see https://github.com/sagemath/sagetrac-mirror/pull/2/files#r669811139\n\nWith that in mind, I would add include a `proof` flag in the input of the methods `is_absolutely_field`, `is_absolutely_trivial`, and `is_generic`,\nand raise an error if `proof=True` and you would be returning `False`. \n\nNote, I don't think you need to do this `is_geom_trivial_when_field` and `get_is_geom_irred` as these are not available to the user. However, I would say in documention string that any `False` returned by those functions is not proved.",
    "created_at": "2021-07-14T21:46:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516942",
    "user": "https://github.com/edgarcosta"
}
```

<a id='comment:14'>Comment 14:</a>
Barinder emailed me:
> I've been struggling to implement the lazy attributes you suggested, particularly in 'jacobian_endomorphisms.py' regarding the flags '_have_established_geometrically_field' and '_have_established_geometrically_trivial'. The problem is that these are not attributes in the conventional sense, and is related to the warning at the top of the file.

I agree with you.
Perhaps, `__endomorphism_ring` is the only one that makes sense, see https://github.com/sagemath/sagetrac-mirror/pull/2/files#r669811139

With that in mind, I would add include a `proof` flag in the input of the methods `is_absolutely_field`, `is_absolutely_trivial`, and `is_generic`,
and raise an error if `proof=True` and you would be returning `False`. 

Note, I don't think you need to do this `is_geom_trivial_when_field` and `get_is_geom_irred` as these are not available to the user. However, I would say in documention string that any `False` returned by those functions is not proved.



---

archive/issue_comments_516943.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nReplying to [@tscrim](#comment%3A13):\n> Why doesn't `EndomorphismRing` inherit from `Homset`? It should also use `_repr_` rather than `__repr__`.\n\nI don't think makes sense for this ticket. The ticket is not providing the ring in any shape or form, indeed, this ticket only provides a method to check if End = ZZ, and if not we cannot even prove it with the current method.",
    "created_at": "2021-07-16T18:05:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516943",
    "user": "https://github.com/edgarcosta"
}
```

<a id='comment:15'>Comment 15:</a>
Replying to [@tscrim](#comment%3A13):
> Why doesn't `EndomorphismRing` inherit from `Homset`? It should also use `_repr_` rather than `__repr__`.

I don't think makes sense for this ticket. The ticket is not providing the ring in any shape or form, indeed, this ticket only provides a method to check if End = ZZ, and if not we cannot even prove it with the current method.



---

archive/issue_comments_516944.json:
```json
{
    "body": "Changed commit from **[ad600bb](https://github.com/sagemath/sagetrac-mirror/commit/ad600bb293ffc07c3fbdd25679bc581993787e01)** to **[b7c94ea](https://github.com/sagemath/sagetrac-mirror/commit/b7c94ea8c830e265861c69601ee19e2699eb4791)**",
    "created_at": "2021-07-16T18:24:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516944",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ad600bb](https://github.com/sagemath/sagetrac-mirror/commit/ad600bb293ffc07c3fbdd25679bc581993787e01)** to **[b7c94ea](https://github.com/sagemath/sagetrac-mirror/commit/b7c94ea8c830e265861c69601ee19e2699eb4791)**



---

archive/issue_comments_516945.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b7c94ea8c830e265861c69601ee19e2699eb4791\">b7c94ea</a></td><td><code>address review comments</code></td></tr></table>\n",
    "created_at": "2021-07-16T18:24:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516945",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:16'>Comment 16:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b7c94ea8c830e265861c69601ee19e2699eb4791">b7c94ea</a></td><td><code>address review comments</code></td></tr></table>




---

archive/issue_comments_516946.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\n@tscrim: Thank you very much for your comments, most of which I have implemented in the latest commit; however as Edgar suggested I haven't added the inheritance of `Homset` to `EndomorphismRing`, and have used the `lazy_attribute` for caching which Edgar suggested.",
    "created_at": "2021-07-16T19:06:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516946",
    "user": "https://github.com/BarinderBanwait"
}
```

<a id='comment:17'>Comment 17:</a>
@tscrim: Thank you very much for your comments, most of which I have implemented in the latest commit; however as Edgar suggested I haven't added the inheritance of `Homset` to `EndomorphismRing`, and have used the `lazy_attribute` for caching which Edgar suggested.



---

archive/issue_comments_516947.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e5fb6e0cac6bef8801a84ef27f5de81f05971a8b\">e5fb6e0</a></td><td><code>fix failing tests</code></td></tr></table>\n",
    "created_at": "2021-07-17T09:29:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516947",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:18'>Comment 18:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e5fb6e0cac6bef8801a84ef27f5de81f05971a8b">e5fb6e0</a></td><td><code>fix failing tests</code></td></tr></table>




---

archive/issue_comments_516948.json:
```json
{
    "body": "Changed commit from **[b7c94ea](https://github.com/sagemath/sagetrac-mirror/commit/b7c94ea8c830e265861c69601ee19e2699eb4791)** to **[e5fb6e0](https://github.com/sagemath/sagetrac-mirror/commit/e5fb6e0cac6bef8801a84ef27f5de81f05971a8b)**",
    "created_at": "2021-07-17T09:29:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516948",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b7c94ea](https://github.com/sagemath/sagetrac-mirror/commit/b7c94ea8c830e265861c69601ee19e2699eb4791)** to **[e5fb6e0](https://github.com/sagemath/sagetrac-mirror/commit/e5fb6e0cac6bef8801a84ef27f5de81f05971a8b)**



---

archive/issue_comments_516949.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nReplying to [@edgarcosta](#comment%3A15):\n> Replying to [@tscrim](#comment%3A13):\n> > Why doesn't `EndomorphismRing` inherit from `Homset`? It should also use `_repr_` rather than `__repr__`.\n\n> \n> I don't think makes sense for this ticket. The ticket is not providing the ring in any shape or form, indeed, this ticket only provides a method to check if End = ZZ, and if not we cannot even prove it with the current method.\n\nIt is a `Homset`, and it will provide consistency with other such things within Sage. There isn't anything more you have to implement on top of it. Moreover, it will be much more naturally accessible via the `Hom` functor, which would handle the caching, and easy to extend to be an actual homset. No ring structure needs to be implemented for this. However, if you don't think it is for the best, then this will be fine. It is just outside of the framework of what we do elsewhere in Sage.\n\n@BarinderBanwait Please at least rename `__repr__` -> `_repr_` so it will work with the `rename()` method. This is standard for things inheriting from `SageObject`.\n\nOne other minor point <code>\\`False\\`</code> -> <code>\\`\\`False\\`\\`</code>.",
    "created_at": "2021-07-18T12:32:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516949",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:19'>Comment 19:</a>
Replying to [@edgarcosta](#comment%3A15):
> Replying to [@tscrim](#comment%3A13):
> > Why doesn't `EndomorphismRing` inherit from `Homset`? It should also use `_repr_` rather than `__repr__`.

> 
> I don't think makes sense for this ticket. The ticket is not providing the ring in any shape or form, indeed, this ticket only provides a method to check if End = ZZ, and if not we cannot even prove it with the current method.

It is a `Homset`, and it will provide consistency with other such things within Sage. There isn't anything more you have to implement on top of it. Moreover, it will be much more naturally accessible via the `Hom` functor, which would handle the caching, and easy to extend to be an actual homset. No ring structure needs to be implemented for this. However, if you don't think it is for the best, then this will be fine. It is just outside of the framework of what we do elsewhere in Sage.

@BarinderBanwait Please at least rename `__repr__` -> `_repr_` so it will work with the `rename()` method. This is standard for things inheriting from `SageObject`.

One other minor point <code>\`False\`</code> -> <code>\`\`False\`\`</code>.



---

archive/issue_comments_516950.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nReplying to [@tscrim](#comment%3A19):\n> Replying to [@edgarcosta](#comment%3A15):\n> > Replying to [@tscrim](#comment%3A13):\n> > > Why doesn't `EndomorphismRing` inherit from `Homset`? It should also use `_repr_` rather than `__repr__`.\n\n> > \n> > I don't think makes sense for this ticket. The ticket is not providing the ring in any shape or form, indeed, this ticket only provides a method to check if End = ZZ, and if not we cannot even prove it with the current method.\n\nIt sounds to me that this ticket shouldn't even be implementing a method \"endomorphism_ring\" at all. That slot should be reserved for a routine that actually implements \"endomorphism ring\" and returns a ring. I'm not so sure that `Homset` is the appropriate place to hook in to, unless we actually can make it act on the Jacobian and/or divisor class group of the curve. We have infrastructure in place that can already give the endomorphism ring (unproven) in terms of matrices, and therefore with ring structure, in the form of C.riemann_surface(prec=...).endomorphism_basis() -- and I think Edgar has some pretty good ideas for speeding this up considerably for hyperelliptic curves (it would involve implementing some of the other integration schemes than Gauss-Legendre)\n\nIt sounds like, for now, it should perhaps provide a method `endomorphism_ring_is_ZZ` on genus 2 curves or their jacobians to provide access. If you're not actually implementing endomorphism rings, you shouldn't be forcing design decisions on them: you'll just make it difficult for the next person who might.\n\nLooking at the code, it look like it has some further functionality, but as far as I can see, these are True/False checks. I think it's false advertising to hang these things under an \"endomorphism_ring\" attribute. They are much better as true/false checks on the original object.\n\nThe implementation already follows the pattern where the non-trivial work happens in stand-alone functions. Just get those merged and make them available. The appropriate interface can be worked out afterwards. I have serious doubts that this is the right moment to introduce `EndomorphismRing`, just as a container for some true/false questions, when the functionality to do much more is already present -- for instance, computing endomorphism rings numerically isn't limited to genus 2 or to curves defined over QQ (but of course, for analytic methds, the field must be embedded in CC)",
    "created_at": "2021-07-18T17:52:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516950",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:20'>Comment 20:</a>
Replying to [@tscrim](#comment%3A19):
> Replying to [@edgarcosta](#comment%3A15):
> > Replying to [@tscrim](#comment%3A13):
> > > Why doesn't `EndomorphismRing` inherit from `Homset`? It should also use `_repr_` rather than `__repr__`.

> > 
> > I don't think makes sense for this ticket. The ticket is not providing the ring in any shape or form, indeed, this ticket only provides a method to check if End = ZZ, and if not we cannot even prove it with the current method.

It sounds to me that this ticket shouldn't even be implementing a method "endomorphism_ring" at all. That slot should be reserved for a routine that actually implements "endomorphism ring" and returns a ring. I'm not so sure that `Homset` is the appropriate place to hook in to, unless we actually can make it act on the Jacobian and/or divisor class group of the curve. We have infrastructure in place that can already give the endomorphism ring (unproven) in terms of matrices, and therefore with ring structure, in the form of C.riemann_surface(prec=...).endomorphism_basis() -- and I think Edgar has some pretty good ideas for speeding this up considerably for hyperelliptic curves (it would involve implementing some of the other integration schemes than Gauss-Legendre)

It sounds like, for now, it should perhaps provide a method `endomorphism_ring_is_ZZ` on genus 2 curves or their jacobians to provide access. If you're not actually implementing endomorphism rings, you shouldn't be forcing design decisions on them: you'll just make it difficult for the next person who might.

Looking at the code, it look like it has some further functionality, but as far as I can see, these are True/False checks. I think it's false advertising to hang these things under an "endomorphism_ring" attribute. They are much better as true/false checks on the original object.

The implementation already follows the pattern where the non-trivial work happens in stand-alone functions. Just get those merged and make them available. The appropriate interface can be worked out afterwards. I have serious doubts that this is the right moment to introduce `EndomorphismRing`, just as a container for some true/false questions, when the functionality to do much more is already present -- for instance, computing endomorphism rings numerically isn't limited to genus 2 or to curves defined over QQ (but of course, for analytic methds, the field must be embedded in CC)



---

archive/issue_comments_516951.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nReplying to [@nbruin](#comment%3A20):\n> It sounds like, for now, it should perhaps provide a method `endomorphism_ring_is_ZZ` on genus 2 curves or their jacobians to provide access. If you're not actually implementing endomorphism rings, you shouldn't be forcing design decisions on them: you'll just make it difficult for the next person who might.\n> \n> Looking at the code, it look like it has some further functionality, but as far as I can see, these are True/False checks. I think it's false advertising to hang these things under an \"endomorphism_ring\" attribute. They are much better as true/false checks on the original object.\n\nThank you, Nils! I agree with your suggestion!\nI would suggest attaching the method to the Jacobian.",
    "created_at": "2021-07-18T19:29:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516951",
    "user": "https://github.com/edgarcosta"
}
```

<a id='comment:21'>Comment 21:</a>
Replying to [@nbruin](#comment%3A20):
> It sounds like, for now, it should perhaps provide a method `endomorphism_ring_is_ZZ` on genus 2 curves or their jacobians to provide access. If you're not actually implementing endomorphism rings, you shouldn't be forcing design decisions on them: you'll just make it difficult for the next person who might.
> 
> Looking at the code, it look like it has some further functionality, but as far as I can see, these are True/False checks. I think it's false advertising to hang these things under an "endomorphism_ring" attribute. They are much better as true/false checks on the original object.

Thank you, Nils! I agree with your suggestion!
I would suggest attaching the method to the Jacobian.



---

archive/issue_comments_516952.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3528482302bf08e15cda1591c83d943386a43fb\">d352848</a></td><td><code>address review comments, remove EndomorphismRing class</code></td></tr></table>\n",
    "created_at": "2021-07-23T05:58:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516952",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:22'>Comment 22:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3528482302bf08e15cda1591c83d943386a43fb">d352848</a></td><td><code>address review comments, remove EndomorphismRing class</code></td></tr></table>




---

archive/issue_comments_516953.json:
```json
{
    "body": "Changed commit from **[e5fb6e0](https://github.com/sagemath/sagetrac-mirror/commit/e5fb6e0cac6bef8801a84ef27f5de81f05971a8b)** to **[d352848](https://github.com/sagemath/sagetrac-mirror/commit/d3528482302bf08e15cda1591c83d943386a43fb)**",
    "created_at": "2021-07-23T05:58:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516953",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[e5fb6e0](https://github.com/sagemath/sagetrac-mirror/commit/e5fb6e0cac6bef8801a84ef27f5de81f05971a8b)** to **[d352848](https://github.com/sagemath/sagetrac-mirror/commit/d3528482302bf08e15cda1591c83d943386a43fb)**



---

archive/issue_comments_516954.json:
```json
{
    "body": "Changed commit from **[d352848](https://github.com/sagemath/sagetrac-mirror/commit/d3528482302bf08e15cda1591c83d943386a43fb)** to **[14b15c7](https://github.com/sagemath/sagetrac-mirror/commit/14b15c77a4a3eb82b70ff37ecde8ffb7a00b42c5)**",
    "created_at": "2021-07-23T06:00:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516954",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d352848](https://github.com/sagemath/sagetrac-mirror/commit/d3528482302bf08e15cda1591c83d943386a43fb)** to **[14b15c7](https://github.com/sagemath/sagetrac-mirror/commit/14b15c77a4a3eb82b70ff37ecde8ffb7a00b42c5)**



---

archive/issue_comments_516955.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/14b15c77a4a3eb82b70ff37ecde8ffb7a00b42c5\">14b15c7</a></td><td><code>Add more apostrophes</code></td></tr></table>\n",
    "created_at": "2021-07-23T06:00:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516955",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:23'>Comment 23:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/14b15c77a4a3eb82b70ff37ecde8ffb7a00b42c5">14b15c7</a></td><td><code>Add more apostrophes</code></td></tr></table>




---

archive/issue_comments_516956.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nDear Edgar, Nils, Travis,\n\nThank you all very much for your comments and code review. The latest commit has addressed all of the above comments now. Here are the main changes:\n\n1. The `EndomorphismRing` class is gone; its two main methods have been attached directly to the Jacobian via `is_generic` (which existed previously) and `geometric_endomorphism_algebra_is_field`. I didn't rename `is_generic` to what Nils suggested - `endomorphism_ring_is_ZZ` - since I understand that the word \"generic\" is commonly used to refer to there being geometrically no extra endomorphisms; but let me know if I should change either of these user-facing names.\n\n2. The file `jacobian_endomorphisms.py` has been renamed `jacobian_endomorphism_utils.py`, since it isn't offering any proper implementation of `EndomorphismRing`, and instead contains the main functions for the two methods in (1) above.\n\n3. Requisite doc changes throughout.",
    "created_at": "2021-07-23T06:11:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516956",
    "user": "https://github.com/BarinderBanwait"
}
```

<a id='comment:24'>Comment 24:</a>
Dear Edgar, Nils, Travis,

Thank you all very much for your comments and code review. The latest commit has addressed all of the above comments now. Here are the main changes:

1. The `EndomorphismRing` class is gone; its two main methods have been attached directly to the Jacobian via `is_generic` (which existed previously) and `geometric_endomorphism_algebra_is_field`. I didn't rename `is_generic` to what Nils suggested - `endomorphism_ring_is_ZZ` - since I understand that the word "generic" is commonly used to refer to there being geometrically no extra endomorphisms; but let me know if I should change either of these user-facing names.

2. The file `jacobian_endomorphisms.py` has been renamed `jacobian_endomorphism_utils.py`, since it isn't offering any proper implementation of `EndomorphismRing`, and instead contains the main functions for the two methods in (1) above.

3. Requisite doc changes throughout.



---

archive/issue_comments_516957.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nReplying to [@BarinderBanwait](#comment%3A24):\n> 1. The `EndomorphismRing` class is gone; its two main methods have been attached directly to the Jacobian via `is_generic` (which existed previously) and `geometric_endomorphism_algebra_is_field`. I didn't rename `is_generic` to what Nils suggested - `endomorphism_ring_is_ZZ` - since I understand that the word \"generic\" is commonly used to refer to there being geometrically no extra endomorphisms; but let me know if I should change either of these user-facing names.\n\nI have a problem with it, especially when it's attached to the Jacobian itself: it should mention it is measuring something about the endomorphism ring: people could think that it tests whether the torsion is generic?\n\nThere is also the slightly pedantic point that any particular jacobian is *not* generic, in the sense that its corresponding point in A_g is closed, and therefore not a generic point.",
    "created_at": "2021-07-23T06:34:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516957",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:25'>Comment 25:</a>
Replying to [@BarinderBanwait](#comment%3A24):
> 1. The `EndomorphismRing` class is gone; its two main methods have been attached directly to the Jacobian via `is_generic` (which existed previously) and `geometric_endomorphism_algebra_is_field`. I didn't rename `is_generic` to what Nils suggested - `endomorphism_ring_is_ZZ` - since I understand that the word "generic" is commonly used to refer to there being geometrically no extra endomorphisms; but let me know if I should change either of these user-facing names.

I have a problem with it, especially when it's attached to the Jacobian itself: it should mention it is measuring something about the endomorphism ring: people could think that it tests whether the torsion is generic?

There is also the slightly pedantic point that any particular jacobian is *not* generic, in the sense that its corresponding point in A_g is closed, and therefore not a generic point.



---

archive/issue_comments_516958.json:
```json
{
    "body": "Changed commit from **[14b15c7](https://github.com/sagemath/sagetrac-mirror/commit/14b15c77a4a3eb82b70ff37ecde8ffb7a00b42c5)** to **[817bdc5](https://github.com/sagemath/sagetrac-mirror/commit/817bdc57324939c531453bf7987c83082ef0579a)**",
    "created_at": "2021-07-23T06:49:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516958",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[14b15c7](https://github.com/sagemath/sagetrac-mirror/commit/14b15c77a4a3eb82b70ff37ecde8ffb7a00b42c5)** to **[817bdc5](https://github.com/sagemath/sagetrac-mirror/commit/817bdc57324939c531453bf7987c83082ef0579a)**



---

archive/issue_comments_516959.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/817bdc57324939c531453bf7987c83082ef0579a\">817bdc5</a></td><td><code>rename is_generic to geometric_endomorphism_ring_is_ZZ</code></td></tr></table>\n",
    "created_at": "2021-07-23T06:49:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516959",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:26'>Comment 26:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/817bdc57324939c531453bf7987c83082ef0579a">817bdc5</a></td><td><code>rename is_generic to geometric_endomorphism_ring_is_ZZ</code></td></tr></table>




---

archive/issue_comments_516960.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nThanks Nils, what you say makes sense -- I've renamed it to `geometric_endomorphism_ring_is_ZZ`",
    "created_at": "2021-07-23T06:50:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516960",
    "user": "https://github.com/BarinderBanwait"
}
```

<a id='comment:27'>Comment 27:</a>
Thanks Nils, what you say makes sense -- I've renamed it to `geometric_endomorphism_ring_is_ZZ`



---

archive/issue_comments_516961.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/462db22ebabae2134de4a3d4f156bb68b698e2d9\">462db22</a></td><td><code>hopefully fix tests</code></td></tr></table>\n",
    "created_at": "2021-07-26T11:52:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516961",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:28'>Comment 28:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/462db22ebabae2134de4a3d4f156bb68b698e2d9">462db22</a></td><td><code>hopefully fix tests</code></td></tr></table>




---

archive/issue_comments_516962.json:
```json
{
    "body": "Changed commit from **[817bdc5](https://github.com/sagemath/sagetrac-mirror/commit/817bdc57324939c531453bf7987c83082ef0579a)** to **[462db22](https://github.com/sagemath/sagetrac-mirror/commit/462db22ebabae2134de4a3d4f156bb68b698e2d9)**",
    "created_at": "2021-07-26T11:52:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516962",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[817bdc5](https://github.com/sagemath/sagetrac-mirror/commit/817bdc57324939c531453bf7987c83082ef0579a)** to **[462db22](https://github.com/sagemath/sagetrac-mirror/commit/462db22ebabae2134de4a3d4f156bb68b698e2d9)**



---

archive/issue_comments_516963.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nHi @edgarcosta, it looks like the tests have passed on this. (It reports \"PluginFailed\" on the patchbot site in `startup_modules`, but clicking through into that it reports that \"All tests passed!\" so I don't know what's going on there). Is this now ready for the next stage of \"positive review\", and if so, what are the next steps to get this into the next release?",
    "created_at": "2021-07-30T06:25:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516963",
    "user": "https://github.com/BarinderBanwait"
}
```

<a id='comment:29'>Comment 29:</a>
Hi @edgarcosta, it looks like the tests have passed on this. (It reports "PluginFailed" on the patchbot site in `startup_modules`, but clicking through into that it reports that "All tests passed!" so I don't know what's going on there). Is this now ready for the next stage of "positive review", and if so, what are the next steps to get this into the next release?



---

archive/issue_comments_516964.json:
```json
{
    "body": "Reviewer: **Edgar Costa, Nils**",
    "created_at": "2021-07-30T20:11:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516964",
    "user": "https://github.com/edgarcosta"
}
```

Reviewer: **Edgar Costa, Nils**



---

archive/issue_events_422183.json:
```json
{
    "actor": "https://github.com/edgarcosta",
    "created_at": "2021-07-30T20:11:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-422183"
}
```



---

archive/issue_events_422184.json:
```json
{
    "actor": "https://github.com/edgarcosta",
    "created_at": "2021-07-30T20:11:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-422184"
}
```



---

archive/issue_comments_516965.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nI have marked it with a positive review. I believe don't need to do anything else, but I CCed David as he knows more than me.\n\n@nbruin, I also added you the list of Reviewers, if you disagree with the review or that please edit accordingly.",
    "created_at": "2021-07-30T20:11:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516965",
    "user": "https://github.com/edgarcosta"
}
```

<a id='comment:30'>Comment 30:</a>
I have marked it with a positive review. I believe don't need to do anything else, but I CCed David as he knows more than me.

@nbruin, I also added you the list of Reviewers, if you disagree with the review or that please edit accordingly.



---

archive/issue_comments_516966.json:
```json
{
    "body": "Changed reviewer from **Edgar Costa, Nils** to **Edgar Costa, Nils Bruin**",
    "created_at": "2021-07-30T20:11:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516966",
    "user": "https://github.com/edgarcosta"
}
```

Changed reviewer from **Edgar Costa, Nils** to **Edgar Costa, Nils Bruin**



---

archive/issue_events_422185.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-422185"
}
```



---

archive/issue_events_422186.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-422186"
}
```



---

archive/issue_events_422187.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-08-29T09:36:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-422187"
}
```



---

archive/issue_events_422188.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "76308b3eeb96743efeba8b7e38293cb9f9bf9165",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-08-29T09:36:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-422188"
}
```



---

archive/issue_comments_516967.json:
```json
{
    "body": "Changed branch from **[u/gh-BarinderBanwait/absolutely_simple_endomorphism_rings](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-BarinderBanwait/absolutely_simple_endomorphism_rings)** to **[462db22](https://github.com/sagemath/sagetrac-mirror/commit/462db22ebabae2134de4a3d4f156bb68b698e2d9)**",
    "created_at": "2021-08-29T09:36:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-516967",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/gh-BarinderBanwait/absolutely_simple_endomorphism_rings](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-BarinderBanwait/absolutely_simple_endomorphism_rings)** to **[462db22](https://github.com/sagemath/sagetrac-mirror/commit/462db22ebabae2134de4a3d4f156bb68b698e2d9)**
