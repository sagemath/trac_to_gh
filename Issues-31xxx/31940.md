# Issue 31940: Absolutely simple endomorphism rings

archive/issues_031703.json:
```json
{
    "assignees": [],
    "body": "This commit adds the first functionality for endomorphism rings of jacobians of genus 2 curves over Q. There is a new class `EndomorphismRing`, and two methods of this class: `is_absolutely_field` which determines whether or not the endomorphism algebra is a field; and `is_absolutely_trivial`, which determines whether or not the ring is just the integer ring Z.\n\nOne corresponding attribute has been added to the Jacobian of the hyperelliptic curve: `is_generic`, which is a wrapper for `is_absolutely_trivial` above.\n\nThe algorithms are based on Lombardo's paper \"Computing the geometric endomorphism ring of a genus 2 Jacobian\".\n\nThis is needed for trac ticket #30837.\n\nCC:  @roed314 @nbruin @edgarcosta davide.lombardo@unipi.it\n\nKeywords: **hyperelliptic curves, jacobians, endomorphism rings**\n\nBranch/Commit: **[`462db22`](https://github.com/sagemath/sagetrac-mirror/commit/462db22ebabae2134de4a3d4f156bb68b698e2d9)**\n\nReviewer: **Edgar Costa, Nils Bruin**\n\nAuthor: **Barinder S. Banwait, Davide Lombardo**\n\nComponent: **number theory**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31940_\n\n",
    "closed_at": "2021-08-29T09:36:20Z",
    "created_at": "2021-06-09T04:05:26Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20number%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Absolutely simple endomorphism rings",
    "type": "issue",
    "updated_at": "2021-08-29T09:36:20Z",
    "url": "https://github.com/sagemath/sage/issues/31940",
    "user": "https://github.com/BarinderBanwait"
}
```
This commit adds the first functionality for endomorphism rings of jacobians of genus 2 curves over Q. There is a new class `EndomorphismRing`, and two methods of this class: `is_absolutely_field` which determines whether or not the endomorphism algebra is a field; and `is_absolutely_trivial`, which determines whether or not the ring is just the integer ring Z.

One corresponding attribute has been added to the Jacobian of the hyperelliptic curve: `is_generic`, which is a wrapper for `is_absolutely_trivial` above.

The algorithms are based on Lombardo's paper "Computing the geometric endomorphism ring of a genus 2 Jacobian".

This is needed for trac ticket #30837.

CC:  @roed314 @nbruin @edgarcosta davide.lombardo@unipi.it

Keywords: **hyperelliptic curves, jacobians, endomorphism rings**

Branch/Commit: **[`462db22`](https://github.com/sagemath/sagetrac-mirror/commit/462db22ebabae2134de4a3d4f156bb68b698e2d9)**

Reviewer: **Edgar Costa, Nils Bruin**

Author: **Barinder S. Banwait, Davide Lombardo**

Component: **number theory**

_Issue created by migration from https://trac.sagemath.org/ticket/31940_





---

archive/issue_events_437215.json:
```json
{
    "actor": "https://github.com/BarinderBanwait",
    "created_at": "2021-06-09T04:05:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-437215"
}
```



---

archive/issue_events_437216.json:
```json
{
    "actor": "https://github.com/BarinderBanwait",
    "created_at": "2021-06-09T04:05:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-437216"
}
```



---

archive/issue_comments_513841.json:
```json
{
    "body": "Branch: **[u/gh-BarinderBanwait/absolutely_simple_endomorphism_rings](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-BarinderBanwait/absolutely_simple_endomorphism_rings)**",
    "created_at": "2021-06-09T11:09:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513841",
    "user": "https://github.com/BarinderBanwait"
}
```

Branch: **[u/gh-BarinderBanwait/absolutely_simple_endomorphism_rings](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-BarinderBanwait/absolutely_simple_endomorphism_rings)**



---

archive/issue_comments_513842.json:
```json
{
    "body": "Changed keywords from none to **hyperelliptic curves, jacobians, endomorphism rings**",
    "created_at": "2021-06-09T11:21:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513842",
    "user": "https://github.com/BarinderBanwait"
}
```

Changed keywords from none to **hyperelliptic curves, jacobians, endomorphism rings**



---

archive/issue_events_437217.json:
```json
{
    "actor": "https://github.com/BarinderBanwait",
    "created_at": "2021-06-09T11:21:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-437217"
}
```



---

archive/issue_events_437218.json:
```json
{
    "actor": "https://github.com/BarinderBanwait",
    "created_at": "2021-06-09T11:21:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-437218"
}
```



---

archive/issue_events_437219.json:
```json
{
    "actor": "https://github.com/BarinderBanwait",
    "created_at": "2021-06-09T11:21:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-437219"
}
```



---

archive/issue_comments_513843.json:
```json
{
    "body": "Author: **Barinder S. Banwait and Davide Lombardo**",
    "created_at": "2021-06-09T11:21:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513843",
    "user": "https://github.com/BarinderBanwait"
}
```

Author: **Barinder S. Banwait and Davide Lombardo**



---

archive/issue_comments_513844.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n+This commit adds the first functionality for endomorphism rings of jacobians of genus 2 curves over Q. There is a new class `EndomorphismRing`, and two methods of this class: `is_absolutely_field` which determines whether or not the endomorphism algebra is a field; and `is_absolutely_trivial`, which determines whether or not the ring is just the integer ring Z.\n \n+Corresponding attributes have been added to the Jacobian of the hyperelliptic curve: `is_absolutely_simple` and `is_generic`.\n+\n+This is needed for trac ticket #30837, and in that sense is blocking this other work.\n``````\n",
    "created_at": "2021-06-09T11:21:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513844",
    "user": "https://github.com/BarinderBanwait"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,5 @@
+This commit adds the first functionality for endomorphism rings of jacobians of genus 2 curves over Q. There is a new class `EndomorphismRing`, and two methods of this class: `is_absolutely_field` which determines whether or not the endomorphism algebra is a field; and `is_absolutely_trivial`, which determines whether or not the ring is just the integer ring Z.
 
+Corresponding attributes have been added to the Jacobian of the hyperelliptic curve: `is_absolutely_simple` and `is_generic`.
+
+This is needed for trac ticket #30837, and in that sense is blocking this other work.
``````




---

archive/issue_comments_513845.json:
```json
{
    "body": "Commit: **[`a8a8a20`](https://github.com/sagemath/sagetrac-mirror/commit/a8a8a20832dcf8515186ef995f4e37b2a879a2a1)**",
    "created_at": "2021-06-09T11:21:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513845",
    "user": "https://github.com/BarinderBanwait"
}
```

Commit: **[`a8a8a20`](https://github.com/sagemath/sagetrac-mirror/commit/a8a8a20832dcf8515186ef995f4e37b2a879a2a1)**



---

archive/issue_events_437220.json:
```json
{
    "actor": "https://github.com/BarinderBanwait",
    "created_at": "2021-06-09T11:23:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20number%20theory",
    "label_color": "0000ff",
    "label_name": "c: number theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-437220"
}
```



---

archive/issue_comments_513846.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,6 @@\n \n Corresponding attributes have been added to the Jacobian of the hyperelliptic curve: `is_absolutely_simple` and `is_generic`.\n \n+The algorithms are based on Lombardo's paper \"Computing the geometric endomorphism ring of a genus 2 Jacobian\".\n+\n This is needed for trac ticket #30837, and in that sense is blocking this other work.\n``````\n",
    "created_at": "2021-06-09T11:38:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513846",
    "user": "https://github.com/BarinderBanwait"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,6 @@
 
 Corresponding attributes have been added to the Jacobian of the hyperelliptic curve: `is_absolutely_simple` and `is_generic`.
 
+The algorithms are based on Lombardo's paper "Computing the geometric endomorphism ring of a genus 2 Jacobian".
+
 This is needed for trac ticket #30837, and in that sense is blocking this other work.
``````




---

archive/issue_comments_513847.json:
```json
{
    "body": "Changed author from **Barinder S. Banwait and Davide Lombardo** to **Barinder S. Banwait, Davide Lombardo**",
    "created_at": "2021-06-09T11:48:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513847",
    "user": "https://github.com/BarinderBanwait"
}
```

Changed author from **Barinder S. Banwait and Davide Lombardo** to **Barinder S. Banwait, Davide Lombardo**



---

archive/issue_comments_513848.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nBlockers are for fixes without which it's unacceptable to ship a new release of sagemath. If a ticket is a dependency for another one, then you can just the other ticket to depend on it. That doesn't block releasing or working on the tickets; it just indicates that the dependency needs to be merged before the depending ticket. The dependent ticket should probably have its branch based on the dependency (which is one of the reasons to indicate the dependency on the ticket: knowing which order to merge branches in can save rebasing)",
    "created_at": "2021-06-09T16:37:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513848",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:6" align="right">comment:6</div>

Blockers are for fixes without which it's unacceptable to ship a new release of sagemath. If a ticket is a dependency for another one, then you can just the other ticket to depend on it. That doesn't block releasing or working on the tickets; it just indicates that the dependency needs to be merged before the depending ticket. The dependent ticket should probably have its branch based on the dependency (which is one of the reasons to indicate the dependency on the ticket: knowing which order to merge branches in can save rebasing)



---

archive/issue_events_437221.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2021-06-09T16:37:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-437221"
}
```



---

archive/issue_events_437222.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2021-06-09T16:37:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-437222"
}
```



---

archive/issue_comments_513849.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThanks for clarifying Nils -- I didn't realise 'blocker' meant 'release blocker', but in hindsight I should have guessed that. Apologies, and thanks for updating the dependency on the other ticket.",
    "created_at": "2021-06-09T16:46:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513849",
    "user": "https://github.com/BarinderBanwait"
}
```

<div id="comment:7" align="right">comment:7</div>

Thanks for clarifying Nils -- I didn't realise 'blocker' meant 'release blocker', but in hindsight I should have guessed that. Apologies, and thanks for updating the dependency on the other ticket.



---

archive/issue_comments_513850.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad600bb293ffc07c3fbdd25679bc581993787e01\"><code>ad600bb</code></a></td><td><code>Fixed doc strings</code></td></tr></table>\n",
    "created_at": "2021-06-30T06:29:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513850",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad600bb293ffc07c3fbdd25679bc581993787e01"><code>ad600bb</code></a></td><td><code>Fixed doc strings</code></td></tr></table>




---

archive/issue_comments_513851.json:
```json
{
    "body": "Changed commit from **[`a8a8a20`](https://github.com/sagemath/sagetrac-mirror/commit/a8a8a20832dcf8515186ef995f4e37b2a879a2a1)** to **[`ad600bb`](https://github.com/sagemath/sagetrac-mirror/commit/ad600bb293ffc07c3fbdd25679bc581993787e01)**",
    "created_at": "2021-06-30T06:29:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513851",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a8a8a20`](https://github.com/sagemath/sagetrac-mirror/commit/a8a8a20832dcf8515186ef995f4e37b2a879a2a1)** to **[`ad600bb`](https://github.com/sagemath/sagetrac-mirror/commit/ad600bb293ffc07c3fbdd25679bc581993787e01)**



---

archive/issue_comments_513852.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI've updated the docstrings on the two modules `jacobian_endomorphisms.py` and `jacobian_generic.py`, both of which pass when locally running those modules individually, so I'm marking this as ready for review. The linter *is* failing, but those failures don't seem related to these changes.",
    "created_at": "2021-06-30T06:36:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513852",
    "user": "https://github.com/BarinderBanwait"
}
```

<div id="comment:10" align="right">comment:10</div>

I've updated the docstrings on the two modules `jacobian_endomorphisms.py` and `jacobian_generic.py`, both of which pass when locally running those modules individually, so I'm marking this as ready for review. The linter *is* failing, but those failures don't seem related to these changes.



---

archive/issue_events_437223.json:
```json
{
    "actor": "https://github.com/BarinderBanwait",
    "created_at": "2021-06-30T06:36:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-437223"
}
```



---

archive/issue_comments_513853.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n This commit adds the first functionality for endomorphism rings of jacobians of genus 2 curves over Q. There is a new class `EndomorphismRing`, and two methods of this class: `is_absolutely_field` which determines whether or not the endomorphism algebra is a field; and `is_absolutely_trivial`, which determines whether or not the ring is just the integer ring Z.\n \n-Corresponding attributes have been added to the Jacobian of the hyperelliptic curve: `is_absolutely_simple` and `is_generic`.\n+One corresponding attribute has been added to the Jacobian of the hyperelliptic curve: `is_generic`, which is a wrapper for `is_absolutely_trivial` above.\n \n The algorithms are based on Lombardo's paper \"Computing the geometric endomorphism ring of a genus 2 Jacobian\".\n \n-This is needed for trac ticket #30837, and in that sense is blocking this other work.\n+This is needed for trac ticket #30837.\n``````\n",
    "created_at": "2021-06-30T10:15:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513853",
    "user": "https://github.com/BarinderBanwait"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,7 @@
 This commit adds the first functionality for endomorphism rings of jacobians of genus 2 curves over Q. There is a new class `EndomorphismRing`, and two methods of this class: `is_absolutely_field` which determines whether or not the endomorphism algebra is a field; and `is_absolutely_trivial`, which determines whether or not the ring is just the integer ring Z.
 
-Corresponding attributes have been added to the Jacobian of the hyperelliptic curve: `is_absolutely_simple` and `is_generic`.
+One corresponding attribute has been added to the Jacobian of the hyperelliptic curve: `is_generic`, which is a wrapper for `is_absolutely_trivial` above.
 
 The algorithms are based on Lombardo's paper "Computing the geometric endomorphism ring of a genus 2 Jacobian".
 
-This is needed for trac ticket #30837, and in that sense is blocking this other work.
+This is needed for trac ticket #30837.
``````




---

archive/issue_comments_513854.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI left some comments in: https://github.com/sagemath/sagetrac-mirror/pull/2/files\nand I'm happy to look at this again once the comments have been addressed.",
    "created_at": "2021-07-09T17:32:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513854",
    "user": "https://github.com/edgarcosta"
}
```

<div id="comment:12" align="right">comment:12</div>

I left some comments in: https://github.com/sagemath/sagetrac-mirror/pull/2/files
and I'm happy to look at this again once the comments have been addressed.



---

archive/issue_comments_513855.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nWhy doesn't `EndomorphismRing` inherit from `Homset`? It should also use `_repr_` rather than `__repr__`.\n\nI think you should not cache the result of `endomorphism_ring`. It should redirect to `Hom`, which does caching, and implement a `_Hom_` method as\n\n```python\ndef _Hom_(self, Y, category):\n    if self == Y:\n        from .jacobian_endomorphisms import EndomorphismRing\n        return EndomorphismRing(self)\n    return super()._Hom_(Y, category)\n```\nThat way someone doing `End(X)` or `Hom(X, X)` will get the endomorphism ring as well.\n\nA few things about the documentation:\n\n```diff\n     def is_generic(self, B=200):\n         r\"\"\"\n-        Returns whether the absolute endomorphism algebra of self is the\n+        Return whether the absolute endomorphism algebra of ``self`` is the\n         integer ring `\\ZZ`.\n \n         INPUT:\n \n-        - ``B`` -- the bound which appears in the statement of the algorithm\n-        from Lombardo's paper. Defaults to 200.\n+        - ``B`` -- (default: 200) the bound which appears in the statement of\n+          the algorithm from [Lom2019]_\n \n         OUTPUT:\n \n-            (bool): boolean indicating whether or not the absolute endomorphism\n-            ring is isomorphic to the integer ring.\n+        Boolean indicating whether or not the absolute endomorphism\n+        ring is isomorphic to the integer ring.\n \n-        EXAMPLES::\n+        EXAMPLES:\n \n-        This is LMFDB curve 603.a.603.2\n+        This is LMFDB curve 603.a.603.2::\n\n             sage: R.<x> = QQ[]\n             sage: f = 4*x^5 + x^4 - 4*x^3 + 2*x^2 + 4*x + 1\n             sage: C = HyperellipticCurve(f)\n```\nand similar changes. The biggest is when `EXAMPLES` is followed by text, it should be a single colon `:`, when something it to have Sage code after it, it should be a double colon `::`.\n\nThe `Codes up Lombardo's Algorithm 4.15` is not a really good explanation of what the function does. It is good to state `This is Algorithm 4.15 in [Lom2019]_.`, yet it is good to be more self-contained with a more descriptive version of what the function does.",
    "created_at": "2021-07-09T23:11:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513855",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:13" align="right">comment:13</div>

Why doesn't `EndomorphismRing` inherit from `Homset`? It should also use `_repr_` rather than `__repr__`.

I think you should not cache the result of `endomorphism_ring`. It should redirect to `Hom`, which does caching, and implement a `_Hom_` method as

```python
def _Hom_(self, Y, category):
    if self == Y:
        from .jacobian_endomorphisms import EndomorphismRing
        return EndomorphismRing(self)
    return super()._Hom_(Y, category)
```
That way someone doing `End(X)` or `Hom(X, X)` will get the endomorphism ring as well.

A few things about the documentation:

```diff
     def is_generic(self, B=200):
         r"""
-        Returns whether the absolute endomorphism algebra of self is the
+        Return whether the absolute endomorphism algebra of ``self`` is the
         integer ring `\ZZ`.
 
         INPUT:
 
-        - ``B`` -- the bound which appears in the statement of the algorithm
-        from Lombardo's paper. Defaults to 200.
+        - ``B`` -- (default: 200) the bound which appears in the statement of
+          the algorithm from [Lom2019]_
 
         OUTPUT:
 
-            (bool): boolean indicating whether or not the absolute endomorphism
-            ring is isomorphic to the integer ring.
+        Boolean indicating whether or not the absolute endomorphism
+        ring is isomorphic to the integer ring.
 
-        EXAMPLES::
+        EXAMPLES:
 
-        This is LMFDB curve 603.a.603.2
+        This is LMFDB curve 603.a.603.2::

             sage: R.<x> = QQ[]
             sage: f = 4*x^5 + x^4 - 4*x^3 + 2*x^2 + 4*x + 1
             sage: C = HyperellipticCurve(f)
```
and similar changes. The biggest is when `EXAMPLES` is followed by text, it should be a single colon `:`, when something it to have Sage code after it, it should be a double colon `::`.

The `Codes up Lombardo's Algorithm 4.15` is not a really good explanation of what the function does. It is good to state `This is Algorithm 4.15 in [Lom2019]_.`, yet it is good to be more self-contained with a more descriptive version of what the function does.



---

archive/issue_comments_513856.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nBarinder emailed me:\n> I've been struggling to implement the lazy attributes you suggested, particularly in 'jacobian_endomorphisms.py' regarding the flags '_have_established_geometrically_field' and '_have_established_geometrically_trivial'. The problem is that these are not attributes in the conventional sense, and is related to the warning at the top of the file.\n\nI agree with you.\nPerhaps, `__endomorphism_ring` is the only one that makes sense, see https://github.com/sagemath/sagetrac-mirror/pull/2/files#r669811139\n\nWith that in mind, I would add include a `proof` flag in the input of the methods `is_absolutely_field`, `is_absolutely_trivial`, and `is_generic`,\nand raise an error if `proof=True` and you would be returning `False`. \n\nNote, I don't think you need to do this `is_geom_trivial_when_field` and `get_is_geom_irred` as these are not available to the user. However, I would say in documention string that any `False` returned by those functions is not proved.",
    "created_at": "2021-07-14T21:46:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513856",
    "user": "https://github.com/edgarcosta"
}
```

<div id="comment:14" align="right">comment:14</div>

Barinder emailed me:
> I've been struggling to implement the lazy attributes you suggested, particularly in 'jacobian_endomorphisms.py' regarding the flags '_have_established_geometrically_field' and '_have_established_geometrically_trivial'. The problem is that these are not attributes in the conventional sense, and is related to the warning at the top of the file.

I agree with you.
Perhaps, `__endomorphism_ring` is the only one that makes sense, see https://github.com/sagemath/sagetrac-mirror/pull/2/files#r669811139

With that in mind, I would add include a `proof` flag in the input of the methods `is_absolutely_field`, `is_absolutely_trivial`, and `is_generic`,
and raise an error if `proof=True` and you would be returning `False`. 

Note, I don't think you need to do this `is_geom_trivial_when_field` and `get_is_geom_irred` as these are not available to the user. However, I would say in documention string that any `False` returned by those functions is not proved.



---

archive/issue_comments_513857.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@tscrim](#comment%3A13):\n> Why doesn't `EndomorphismRing` inherit from `Homset`? It should also use `_repr_` rather than `__repr__`.\n\nI don't think makes sense for this ticket. The ticket is not providing the ring in any shape or form, indeed, this ticket only provides a method to check if End = ZZ, and if not we cannot even prove it with the current method.",
    "created_at": "2021-07-16T18:05:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513857",
    "user": "https://github.com/edgarcosta"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@tscrim](#comment%3A13):
> Why doesn't `EndomorphismRing` inherit from `Homset`? It should also use `_repr_` rather than `__repr__`.

I don't think makes sense for this ticket. The ticket is not providing the ring in any shape or form, indeed, this ticket only provides a method to check if End = ZZ, and if not we cannot even prove it with the current method.



---

archive/issue_comments_513858.json:
```json
{
    "body": "Changed commit from **[`ad600bb`](https://github.com/sagemath/sagetrac-mirror/commit/ad600bb293ffc07c3fbdd25679bc581993787e01)** to **[`b7c94ea`](https://github.com/sagemath/sagetrac-mirror/commit/b7c94ea8c830e265861c69601ee19e2699eb4791)**",
    "created_at": "2021-07-16T18:24:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513858",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ad600bb`](https://github.com/sagemath/sagetrac-mirror/commit/ad600bb293ffc07c3fbdd25679bc581993787e01)** to **[`b7c94ea`](https://github.com/sagemath/sagetrac-mirror/commit/b7c94ea8c830e265861c69601ee19e2699eb4791)**



---

archive/issue_comments_513859.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b7c94ea8c830e265861c69601ee19e2699eb4791\"><code>b7c94ea</code></a></td><td><code>address review comments</code></td></tr></table>\n",
    "created_at": "2021-07-16T18:24:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513859",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b7c94ea8c830e265861c69601ee19e2699eb4791"><code>b7c94ea</code></a></td><td><code>address review comments</code></td></tr></table>




---

archive/issue_comments_513860.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\n@tscrim: Thank you very much for your comments, most of which I have implemented in the latest commit; however as Edgar suggested I haven't added the inheritance of `Homset` to `EndomorphismRing`, and have used the `lazy_attribute` for caching which Edgar suggested.",
    "created_at": "2021-07-16T19:06:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513860",
    "user": "https://github.com/BarinderBanwait"
}
```

<div id="comment:17" align="right">comment:17</div>

@tscrim: Thank you very much for your comments, most of which I have implemented in the latest commit; however as Edgar suggested I haven't added the inheritance of `Homset` to `EndomorphismRing`, and have used the `lazy_attribute` for caching which Edgar suggested.



---

archive/issue_comments_513861.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e5fb6e0cac6bef8801a84ef27f5de81f05971a8b\"><code>e5fb6e0</code></a></td><td><code>fix failing tests</code></td></tr></table>\n",
    "created_at": "2021-07-17T09:29:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513861",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e5fb6e0cac6bef8801a84ef27f5de81f05971a8b"><code>e5fb6e0</code></a></td><td><code>fix failing tests</code></td></tr></table>




---

archive/issue_comments_513862.json:
```json
{
    "body": "Changed commit from **[`b7c94ea`](https://github.com/sagemath/sagetrac-mirror/commit/b7c94ea8c830e265861c69601ee19e2699eb4791)** to **[`e5fb6e0`](https://github.com/sagemath/sagetrac-mirror/commit/e5fb6e0cac6bef8801a84ef27f5de81f05971a8b)**",
    "created_at": "2021-07-17T09:29:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513862",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b7c94ea`](https://github.com/sagemath/sagetrac-mirror/commit/b7c94ea8c830e265861c69601ee19e2699eb4791)** to **[`e5fb6e0`](https://github.com/sagemath/sagetrac-mirror/commit/e5fb6e0cac6bef8801a84ef27f5de81f05971a8b)**



---

archive/issue_comments_513863.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@edgarcosta](#comment%3A15):\n> Replying to [@tscrim](#comment%3A13):\n> > Why doesn't `EndomorphismRing` inherit from `Homset`? It should also use `_repr_` rather than `__repr__`.\n\n> \n> I don't think makes sense for this ticket. The ticket is not providing the ring in any shape or form, indeed, this ticket only provides a method to check if End = ZZ, and if not we cannot even prove it with the current method.\n\nIt is a `Homset`, and it will provide consistency with other such things within Sage. There isn't anything more you have to implement on top of it. Moreover, it will be much more naturally accessible via the `Hom` functor, which would handle the caching, and easy to extend to be an actual homset. No ring structure needs to be implemented for this. However, if you don't think it is for the best, then this will be fine. It is just outside of the framework of what we do elsewhere in Sage.\n\n@BarinderBanwait Please at least rename `__repr__` -> `_repr_` so it will work with the `rename()` method. This is standard for things inheriting from `SageObject`.\n\nOne other minor point <code>\\`False\\`</code> -> <code>\\`\\`False\\`\\`</code>.",
    "created_at": "2021-07-18T12:32:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513863",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@edgarcosta](#comment%3A15):
> Replying to [@tscrim](#comment%3A13):
> > Why doesn't `EndomorphismRing` inherit from `Homset`? It should also use `_repr_` rather than `__repr__`.

> 
> I don't think makes sense for this ticket. The ticket is not providing the ring in any shape or form, indeed, this ticket only provides a method to check if End = ZZ, and if not we cannot even prove it with the current method.

It is a `Homset`, and it will provide consistency with other such things within Sage. There isn't anything more you have to implement on top of it. Moreover, it will be much more naturally accessible via the `Hom` functor, which would handle the caching, and easy to extend to be an actual homset. No ring structure needs to be implemented for this. However, if you don't think it is for the best, then this will be fine. It is just outside of the framework of what we do elsewhere in Sage.

@BarinderBanwait Please at least rename `__repr__` -> `_repr_` so it will work with the `rename()` method. This is standard for things inheriting from `SageObject`.

One other minor point <code>\`False\`</code> -> <code>\`\`False\`\`</code>.



---

archive/issue_comments_513864.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@tscrim](#comment%3A19):\n> Replying to [@edgarcosta](#comment%3A15):\n> > Replying to [@tscrim](#comment%3A13):\n> > > Why doesn't `EndomorphismRing` inherit from `Homset`? It should also use `_repr_` rather than `__repr__`.\n\n> > \n> > I don't think makes sense for this ticket. The ticket is not providing the ring in any shape or form, indeed, this ticket only provides a method to check if End = ZZ, and if not we cannot even prove it with the current method.\n\nIt sounds to me that this ticket shouldn't even be implementing a method \"endomorphism_ring\" at all. That slot should be reserved for a routine that actually implements \"endomorphism ring\" and returns a ring. I'm not so sure that `Homset` is the appropriate place to hook in to, unless we actually can make it act on the Jacobian and/or divisor class group of the curve. We have infrastructure in place that can already give the endomorphism ring (unproven) in terms of matrices, and therefore with ring structure, in the form of C.riemann_surface(prec=...).endomorphism_basis() -- and I think Edgar has some pretty good ideas for speeding this up considerably for hyperelliptic curves (it would involve implementing some of the other integration schemes than Gauss-Legendre)\n\nIt sounds like, for now, it should perhaps provide a method `endomorphism_ring_is_ZZ` on genus 2 curves or their jacobians to provide access. If you're not actually implementing endomorphism rings, you shouldn't be forcing design decisions on them: you'll just make it difficult for the next person who might.\n\nLooking at the code, it look like it has some further functionality, but as far as I can see, these are True/False checks. I think it's false advertising to hang these things under an \"endomorphism_ring\" attribute. They are much better as true/false checks on the original object.\n\nThe implementation already follows the pattern where the non-trivial work happens in stand-alone functions. Just get those merged and make them available. The appropriate interface can be worked out afterwards. I have serious doubts that this is the right moment to introduce `EndomorphismRing`, just as a container for some true/false questions, when the functionality to do much more is already present -- for instance, computing endomorphism rings numerically isn't limited to genus 2 or to curves defined over QQ (but of course, for analytic methds, the field must be embedded in CC)",
    "created_at": "2021-07-18T17:52:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513864",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@tscrim](#comment%3A19):
> Replying to [@edgarcosta](#comment%3A15):
> > Replying to [@tscrim](#comment%3A13):
> > > Why doesn't `EndomorphismRing` inherit from `Homset`? It should also use `_repr_` rather than `__repr__`.

> > 
> > I don't think makes sense for this ticket. The ticket is not providing the ring in any shape or form, indeed, this ticket only provides a method to check if End = ZZ, and if not we cannot even prove it with the current method.

It sounds to me that this ticket shouldn't even be implementing a method "endomorphism_ring" at all. That slot should be reserved for a routine that actually implements "endomorphism ring" and returns a ring. I'm not so sure that `Homset` is the appropriate place to hook in to, unless we actually can make it act on the Jacobian and/or divisor class group of the curve. We have infrastructure in place that can already give the endomorphism ring (unproven) in terms of matrices, and therefore with ring structure, in the form of C.riemann_surface(prec=...).endomorphism_basis() -- and I think Edgar has some pretty good ideas for speeding this up considerably for hyperelliptic curves (it would involve implementing some of the other integration schemes than Gauss-Legendre)

It sounds like, for now, it should perhaps provide a method `endomorphism_ring_is_ZZ` on genus 2 curves or their jacobians to provide access. If you're not actually implementing endomorphism rings, you shouldn't be forcing design decisions on them: you'll just make it difficult for the next person who might.

Looking at the code, it look like it has some further functionality, but as far as I can see, these are True/False checks. I think it's false advertising to hang these things under an "endomorphism_ring" attribute. They are much better as true/false checks on the original object.

The implementation already follows the pattern where the non-trivial work happens in stand-alone functions. Just get those merged and make them available. The appropriate interface can be worked out afterwards. I have serious doubts that this is the right moment to introduce `EndomorphismRing`, just as a container for some true/false questions, when the functionality to do much more is already present -- for instance, computing endomorphism rings numerically isn't limited to genus 2 or to curves defined over QQ (but of course, for analytic methds, the field must be embedded in CC)



---

archive/issue_comments_513865.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@nbruin](#comment%3A20):\n> It sounds like, for now, it should perhaps provide a method `endomorphism_ring_is_ZZ` on genus 2 curves or their jacobians to provide access. If you're not actually implementing endomorphism rings, you shouldn't be forcing design decisions on them: you'll just make it difficult for the next person who might.\n> \n> Looking at the code, it look like it has some further functionality, but as far as I can see, these are True/False checks. I think it's false advertising to hang these things under an \"endomorphism_ring\" attribute. They are much better as true/false checks on the original object.\n\nThank you, Nils! I agree with your suggestion!\nI would suggest attaching the method to the Jacobian.",
    "created_at": "2021-07-18T19:29:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513865",
    "user": "https://github.com/edgarcosta"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@nbruin](#comment%3A20):
> It sounds like, for now, it should perhaps provide a method `endomorphism_ring_is_ZZ` on genus 2 curves or their jacobians to provide access. If you're not actually implementing endomorphism rings, you shouldn't be forcing design decisions on them: you'll just make it difficult for the next person who might.
> 
> Looking at the code, it look like it has some further functionality, but as far as I can see, these are True/False checks. I think it's false advertising to hang these things under an "endomorphism_ring" attribute. They are much better as true/false checks on the original object.

Thank you, Nils! I agree with your suggestion!
I would suggest attaching the method to the Jacobian.



---

archive/issue_comments_513866.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3528482302bf08e15cda1591c83d943386a43fb\"><code>d352848</code></a></td><td><code>address review comments, remove EndomorphismRing class</code></td></tr></table>\n",
    "created_at": "2021-07-23T05:58:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513866",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3528482302bf08e15cda1591c83d943386a43fb"><code>d352848</code></a></td><td><code>address review comments, remove EndomorphismRing class</code></td></tr></table>




---

archive/issue_comments_513867.json:
```json
{
    "body": "Changed commit from **[`e5fb6e0`](https://github.com/sagemath/sagetrac-mirror/commit/e5fb6e0cac6bef8801a84ef27f5de81f05971a8b)** to **[`d352848`](https://github.com/sagemath/sagetrac-mirror/commit/d3528482302bf08e15cda1591c83d943386a43fb)**",
    "created_at": "2021-07-23T05:58:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513867",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e5fb6e0`](https://github.com/sagemath/sagetrac-mirror/commit/e5fb6e0cac6bef8801a84ef27f5de81f05971a8b)** to **[`d352848`](https://github.com/sagemath/sagetrac-mirror/commit/d3528482302bf08e15cda1591c83d943386a43fb)**



---

archive/issue_comments_513868.json:
```json
{
    "body": "Changed commit from **[`d352848`](https://github.com/sagemath/sagetrac-mirror/commit/d3528482302bf08e15cda1591c83d943386a43fb)** to **[`14b15c7`](https://github.com/sagemath/sagetrac-mirror/commit/14b15c77a4a3eb82b70ff37ecde8ffb7a00b42c5)**",
    "created_at": "2021-07-23T06:00:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513868",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d352848`](https://github.com/sagemath/sagetrac-mirror/commit/d3528482302bf08e15cda1591c83d943386a43fb)** to **[`14b15c7`](https://github.com/sagemath/sagetrac-mirror/commit/14b15c77a4a3eb82b70ff37ecde8ffb7a00b42c5)**



---

archive/issue_comments_513869.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/14b15c77a4a3eb82b70ff37ecde8ffb7a00b42c5\"><code>14b15c7</code></a></td><td><code>Add more apostrophes</code></td></tr></table>\n",
    "created_at": "2021-07-23T06:00:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513869",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/14b15c77a4a3eb82b70ff37ecde8ffb7a00b42c5"><code>14b15c7</code></a></td><td><code>Add more apostrophes</code></td></tr></table>




---

archive/issue_comments_513870.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nDear Edgar, Nils, Travis,\n\nThank you all very much for your comments and code review. The latest commit has addressed all of the above comments now. Here are the main changes:\n\n1. The `EndomorphismRing` class is gone; its two main methods have been attached directly to the Jacobian via `is_generic` (which existed previously) and `geometric_endomorphism_algebra_is_field`. I didn't rename `is_generic` to what Nils suggested - `endomorphism_ring_is_ZZ` - since I understand that the word \"generic\" is commonly used to refer to there being geometrically no extra endomorphisms; but let me know if I should change either of these user-facing names.\n\n2. The file `jacobian_endomorphisms.py` has been renamed `jacobian_endomorphism_utils.py`, since it isn't offering any proper implementation of `EndomorphismRing`, and instead contains the main functions for the two methods in (1) above.\n\n3. Requisite doc changes throughout.",
    "created_at": "2021-07-23T06:11:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513870",
    "user": "https://github.com/BarinderBanwait"
}
```

<div id="comment:24" align="right">comment:24</div>

Dear Edgar, Nils, Travis,

Thank you all very much for your comments and code review. The latest commit has addressed all of the above comments now. Here are the main changes:

1. The `EndomorphismRing` class is gone; its two main methods have been attached directly to the Jacobian via `is_generic` (which existed previously) and `geometric_endomorphism_algebra_is_field`. I didn't rename `is_generic` to what Nils suggested - `endomorphism_ring_is_ZZ` - since I understand that the word "generic" is commonly used to refer to there being geometrically no extra endomorphisms; but let me know if I should change either of these user-facing names.

2. The file `jacobian_endomorphisms.py` has been renamed `jacobian_endomorphism_utils.py`, since it isn't offering any proper implementation of `EndomorphismRing`, and instead contains the main functions for the two methods in (1) above.

3. Requisite doc changes throughout.



---

archive/issue_comments_513871.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@BarinderBanwait](#comment%3A24):\n> 1. The `EndomorphismRing` class is gone; its two main methods have been attached directly to the Jacobian via `is_generic` (which existed previously) and `geometric_endomorphism_algebra_is_field`. I didn't rename `is_generic` to what Nils suggested - `endomorphism_ring_is_ZZ` - since I understand that the word \"generic\" is commonly used to refer to there being geometrically no extra endomorphisms; but let me know if I should change either of these user-facing names.\n\nI have a problem with it, especially when it's attached to the Jacobian itself: it should mention it is measuring something about the endomorphism ring: people could think that it tests whether the torsion is generic?\n\nThere is also the slightly pedantic point that any particular jacobian is *not* generic, in the sense that its corresponding point in A_g is closed, and therefore not a generic point.",
    "created_at": "2021-07-23T06:34:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513871",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@BarinderBanwait](#comment%3A24):
> 1. The `EndomorphismRing` class is gone; its two main methods have been attached directly to the Jacobian via `is_generic` (which existed previously) and `geometric_endomorphism_algebra_is_field`. I didn't rename `is_generic` to what Nils suggested - `endomorphism_ring_is_ZZ` - since I understand that the word "generic" is commonly used to refer to there being geometrically no extra endomorphisms; but let me know if I should change either of these user-facing names.

I have a problem with it, especially when it's attached to the Jacobian itself: it should mention it is measuring something about the endomorphism ring: people could think that it tests whether the torsion is generic?

There is also the slightly pedantic point that any particular jacobian is *not* generic, in the sense that its corresponding point in A_g is closed, and therefore not a generic point.



---

archive/issue_comments_513872.json:
```json
{
    "body": "Changed commit from **[`14b15c7`](https://github.com/sagemath/sagetrac-mirror/commit/14b15c77a4a3eb82b70ff37ecde8ffb7a00b42c5)** to **[`817bdc5`](https://github.com/sagemath/sagetrac-mirror/commit/817bdc57324939c531453bf7987c83082ef0579a)**",
    "created_at": "2021-07-23T06:49:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513872",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`14b15c7`](https://github.com/sagemath/sagetrac-mirror/commit/14b15c77a4a3eb82b70ff37ecde8ffb7a00b42c5)** to **[`817bdc5`](https://github.com/sagemath/sagetrac-mirror/commit/817bdc57324939c531453bf7987c83082ef0579a)**



---

archive/issue_comments_513873.json:
```json
{
    "body": "<div id=\"comment:26\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/817bdc57324939c531453bf7987c83082ef0579a\"><code>817bdc5</code></a></td><td><code>rename is_generic to geometric_endomorphism_ring_is_ZZ</code></td></tr></table>\n",
    "created_at": "2021-07-23T06:49:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513873",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:26"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/817bdc57324939c531453bf7987c83082ef0579a"><code>817bdc5</code></a></td><td><code>rename is_generic to geometric_endomorphism_ring_is_ZZ</code></td></tr></table>




---

archive/issue_comments_513874.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nThanks Nils, what you say makes sense -- I've renamed it to `geometric_endomorphism_ring_is_ZZ`",
    "created_at": "2021-07-23T06:50:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513874",
    "user": "https://github.com/BarinderBanwait"
}
```

<div id="comment:27" align="right">comment:27</div>

Thanks Nils, what you say makes sense -- I've renamed it to `geometric_endomorphism_ring_is_ZZ`



---

archive/issue_comments_513875.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/462db22ebabae2134de4a3d4f156bb68b698e2d9\"><code>462db22</code></a></td><td><code>hopefully fix tests</code></td></tr></table>\n",
    "created_at": "2021-07-26T11:52:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513875",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/462db22ebabae2134de4a3d4f156bb68b698e2d9"><code>462db22</code></a></td><td><code>hopefully fix tests</code></td></tr></table>




---

archive/issue_comments_513876.json:
```json
{
    "body": "Changed commit from **[`817bdc5`](https://github.com/sagemath/sagetrac-mirror/commit/817bdc57324939c531453bf7987c83082ef0579a)** to **[`462db22`](https://github.com/sagemath/sagetrac-mirror/commit/462db22ebabae2134de4a3d4f156bb68b698e2d9)**",
    "created_at": "2021-07-26T11:52:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513876",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`817bdc5`](https://github.com/sagemath/sagetrac-mirror/commit/817bdc57324939c531453bf7987c83082ef0579a)** to **[`462db22`](https://github.com/sagemath/sagetrac-mirror/commit/462db22ebabae2134de4a3d4f156bb68b698e2d9)**



---

archive/issue_comments_513877.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nHi @edgarcosta, it looks like the tests have passed on this. (It reports \"PluginFailed\" on the patchbot site in `startup_modules`, but clicking through into that it reports that \"All tests passed!\" so I don't know what's going on there). Is this now ready for the next stage of \"positive review\", and if so, what are the next steps to get this into the next release?",
    "created_at": "2021-07-30T06:25:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513877",
    "user": "https://github.com/BarinderBanwait"
}
```

<div id="comment:29" align="right">comment:29</div>

Hi @edgarcosta, it looks like the tests have passed on this. (It reports "PluginFailed" on the patchbot site in `startup_modules`, but clicking through into that it reports that "All tests passed!" so I don't know what's going on there). Is this now ready for the next stage of "positive review", and if so, what are the next steps to get this into the next release?



---

archive/issue_comments_513878.json:
```json
{
    "body": "Reviewer: **Edgar Costa, Nils**",
    "created_at": "2021-07-30T20:11:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513878",
    "user": "https://github.com/edgarcosta"
}
```

Reviewer: **Edgar Costa, Nils**



---

archive/issue_events_437224.json:
```json
{
    "actor": "https://github.com/edgarcosta",
    "created_at": "2021-07-30T20:11:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-437224"
}
```



---

archive/issue_events_437225.json:
```json
{
    "actor": "https://github.com/edgarcosta",
    "created_at": "2021-07-30T20:11:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-437225"
}
```



---

archive/issue_comments_513879.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nI have marked it with a positive review. I believe don't need to do anything else, but I CCed David as he knows more than me.\n\n@nbruin, I also added you the list of Reviewers, if you disagree with the review or that please edit accordingly.",
    "created_at": "2021-07-30T20:11:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513879",
    "user": "https://github.com/edgarcosta"
}
```

<div id="comment:30" align="right">comment:30</div>

I have marked it with a positive review. I believe don't need to do anything else, but I CCed David as he knows more than me.

@nbruin, I also added you the list of Reviewers, if you disagree with the review or that please edit accordingly.



---

archive/issue_comments_513880.json:
```json
{
    "body": "Changed reviewer from **Edgar Costa, Nils** to **Edgar Costa, Nils Bruin**",
    "created_at": "2021-07-30T20:11:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513880",
    "user": "https://github.com/edgarcosta"
}
```

Changed reviewer from **Edgar Costa, Nils** to **Edgar Costa, Nils Bruin**



---

archive/issue_events_437226.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-437226"
}
```



---

archive/issue_events_437227.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-437227"
}
```



---

archive/issue_events_437228.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-08-29T09:36:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-437228"
}
```



---

archive/issue_events_437229.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "76308b3eeb96743efeba8b7e38293cb9f9bf9165",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-08-29T09:36:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31940#event-437229"
}
```



---

archive/issue_comments_513881.json:
```json
{
    "body": "Changed branch from **[u/gh-BarinderBanwait/absolutely_simple_endomorphism_rings](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-BarinderBanwait/absolutely_simple_endomorphism_rings)** to **[`462db22`](https://github.com/sagemath/sagetrac-mirror/commit/462db22ebabae2134de4a3d4f156bb68b698e2d9)**",
    "created_at": "2021-08-29T09:36:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31940#issuecomment-513881",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/gh-BarinderBanwait/absolutely_simple_endomorphism_rings](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-BarinderBanwait/absolutely_simple_endomorphism_rings)** to **[`462db22`](https://github.com/sagemath/sagetrac-mirror/commit/462db22ebabae2134de4a3d4f156bb68b698e2d9)**
