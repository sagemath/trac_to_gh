# Issue 28389: Compute graph of polyhedron with CombinatorialPolyhedron

Issue created by migration from https://trac.sagemath.org/ticket/28626

Original creator: @kliem

Original creation time: 2019-10-18 08:42:36

CC:  jipilab @laisrast

We use `CombinatorialPolyhedron` to compute the graph of `Polyhedron_base`.


---

Comment by @kliem created at 2019-10-18 09:09:14

Changing keywords from "" to "polyhedron, combinatorial_polyhedron".


---

Comment by @kliem created at 2019-10-18 09:09:14

What do we do with polyhedra that contain lines?

As of now it is understood that in this case the vertex_graph is non-empty. So the vertex graph is basically the one of the projection.

However, the docstring of `vertex_graph` states that the edges correspond to edges of the polyhedron. I find it very confusing that the `vertex_graph` of an unpointed polyhedron should have edges.

If people think this is the way it should be than the docstring of `vertex_graph` should be more precise.

I stumbled upon this because I got a test failure at
`File "src/sage/geometry/polyhedron/base.py", line 7229`

```
7225         Permutations can only exchange vertices with vertices, rays
7226         with rays, and lines with lines::
7227 
7228             sage: P = Polyhedron(vertices=[(1,0,0), (1,1,0)], rays=[(1,0,0)], lines=[(0,0,1)])
7229             sage: P.combinatorial_automorphism_group(vertex_graph_only=True)
7230             Permutation Group with generators [(A vertex at (1,0,0),A vertex at (1,1,0))]
```


This is a weird test, as it tests a behavior which seems to be opposed to the intention of `vertex_graph`.  Also the announcement is strange, as the `vertex_graph` contains neither rays nor lines and thus will not interchange them (not even a ray with a ray).
----
New commits:


---

Comment by dimpase created at 2019-10-19 14:49:31

it is not clear from the ticket description why edge_graph is deprecated, can you explain?


---

Comment by @kliem created at 2019-10-19 16:23:36

Sorry about the confusion. This ticket is built on top of #28603 and #28621. Only the last commit is due to this ticket.

In `CombinatorialPolyhedron`, I chose to implement a method `edge_graph`. In order to make it more compatible with `Polyhedron` I replace it by `vertex_graph` in #28603.

This way `CombinatorialPolyhedron(P).vertex_graph()` gives the vertex graph of our polyhedron `P`.

There are two issues with edge graph:
- It has no vertices if there are no edges (a 0-dimensional polyhedron).
- It depends not just on the combinatorial type, for example those two 

```
sage: Q = Polyhedron(vertices=[[1,0],[0,1]],rays=[[1,11/10],[11/10,1]]); Q
A 2-dimensional polyhedron in QQ^2 defined as the convex hull of 2 vertices and 2 rays
sage: P = Polyhedron(vertices=[[1,0],[0,1]],rays=[[1,1]]); P
A 2-dimensional polyhedron in QQ^2 defined as the convex hull of 2 vertices and 1 ray
```

  polyhedra do not have isomorphic `edge_graph`s in `CombinatorialPolyhedron`.


---

Comment by dimpase created at 2019-10-19 21:38:21

So this does bring the sanity in, where vertices correspond to vertices in the geometric sense, right?


---

Comment by @kliem created at 2019-10-20 04:59:00

Yes.

However, as I'm changing the behavior, I didn't want to do it secretely and see if there are objections. Hence the post on sage_devel.


---

Comment by dimpase created at 2019-10-20 08:24:29

Are you still working on the ticket, or it needs review?


---

Comment by @kliem created at 2019-10-20 10:30:24

I mostly waited, if there where objections to changing the behavior.

If there are none, I need to change the failing test and probably comment on the vertices being different from the method `vertices`.


---

Comment by git created at 2019-10-21 08:54:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @kliem created at 2019-10-21 08:54:46

Changing status from new to needs_review.


---

Comment by embray created at 2020-01-06 14:10:03

Ticket retargeted after milestone closed


---

Comment by @kliem created at 2020-01-25 12:15:40

Is this ticket good to go?


---

Comment by dimpase created at 2020-01-25 12:58:28

How about the bot report:

```
========== pyflakes ==========
git checkout patchbot/ticket_merged
src/sage/geometry/polyhedron/base.py:5189: local variable 'ambient_dim' is assigned to but never used
src/sage/geometry/polyhedron/base.py:5190: local variable 'polytope_dim' is assigned to but never used
```



---

Comment by jipilab created at 2020-02-04 14:10:49

Replying to [comment:14 dimpase]:
> How about the bot report:
> {{{
> ========== pyflakes ==========
> git checkout patchbot/ticket_merged
> src/sage/geometry/polyhedron/base.py:5189: local variable 'ambient_dim' is assigned to but never used
> src/sage/geometry/polyhedron/base.py:5190: local variable 'polytope_dim' is assigned to but never used
> }}}

Fixed in #28880.


---

Comment by mkoeppe created at 2020-04-14 19:41:51

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.


---

Comment by jipilab created at 2020-04-20 09:49:24

Replying to [comment:6 gh-kliem]:
> Yes.
> 
> However, as I'm changing the behavior, I didn't want to do it secretely and see if there are objections. Hence the post on sage_devel.

Could you link to the post?

I would say that the ticket looks ready, but for the sake of completeness, I would like to check the change of behavior...


---

Comment by jipilab created at 2020-04-20 09:49:24

Changing status from needs_review to needs_info.


---

Comment by @kliem created at 2020-04-20 10:41:14

Changing status from needs_info to needs_review.


---

Comment by jipilab created at 2020-04-20 14:45:20

Changing status from needs_review to positive_review.


---

Comment by @kliem created at 2020-04-20 14:45:53

Thank you.


---

Comment by vbraun created at 2020-04-23 22:33:08

Resolution: fixed
