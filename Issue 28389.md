# Issue 28389: Compute graph of polyhedron with CombinatorialPolyhedron

archive/issues_028389.json:
```json
{
    "body": "CC:  @jplab @laisrast\n\nWe use `CombinatorialPolyhedron` to compute the graph of `Polyhedron_base`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/28626\n\n",
    "created_at": "2019-10-18T08:42:36Z",
    "labels": [
        "geometry",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "Compute graph of polyhedron with CombinatorialPolyhedron",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28389",
    "user": "@kliem"
}
```
CC:  @jplab @laisrast

We use `CombinatorialPolyhedron` to compute the graph of `Polyhedron_base`.

Issue created by migration from https://trac.sagemath.org/ticket/28626





---

archive/issue_comments_400947.json:
```json
{
    "body": "Changing keywords from \"\" to \"polyhedron, combinatorial_polyhedron\".",
    "created_at": "2019-10-18T09:09:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400947",
    "user": "@kliem"
}
```

Changing keywords from "" to "polyhedron, combinatorial_polyhedron".



---

archive/issue_comments_400948.json:
```json
{
    "body": "What do we do with polyhedra that contain lines?\n\nAs of now it is understood that in this case the vertex_graph is non-empty. So the vertex graph is basically the one of the projection.\n\nHowever, the docstring of `vertex_graph` states that the edges correspond to edges of the polyhedron. I find it very confusing that the `vertex_graph` of an unpointed polyhedron should have edges.\n\nIf people think this is the way it should be than the docstring of `vertex_graph` should be more precise.\n\nI stumbled upon this because I got a test failure at\n`File \"src/sage/geometry/polyhedron/base.py\", line 7229`\n\n```\n7225         Permutations can only exchange vertices with vertices, rays\n7226         with rays, and lines with lines::\n7227 \n7228             sage: P = Polyhedron(vertices=[(1,0,0), (1,1,0)], rays=[(1,0,0)], lines=[(0,0,1)])\n7229             sage: P.combinatorial_automorphism_group(vertex_graph_only=True)\n7230             Permutation Group with generators [(A vertex at (1,0,0),A vertex at (1,1,0))]\n```\n\n\nThis is a weird test, as it tests a behavior which seems to be opposed to the intention of `vertex_graph`.  Also the announcement is strange, as the `vertex_graph` contains neither rays nor lines and thus will not interchange them (not even a ray with a ray).\n----\nNew commits:",
    "created_at": "2019-10-18T09:09:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400948",
    "user": "@kliem"
}
```

What do we do with polyhedra that contain lines?

As of now it is understood that in this case the vertex_graph is non-empty. So the vertex graph is basically the one of the projection.

However, the docstring of `vertex_graph` states that the edges correspond to edges of the polyhedron. I find it very confusing that the `vertex_graph` of an unpointed polyhedron should have edges.

If people think this is the way it should be than the docstring of `vertex_graph` should be more precise.

I stumbled upon this because I got a test failure at
`File "src/sage/geometry/polyhedron/base.py", line 7229`

```
7225         Permutations can only exchange vertices with vertices, rays
7226         with rays, and lines with lines::
7227 
7228             sage: P = Polyhedron(vertices=[(1,0,0), (1,1,0)], rays=[(1,0,0)], lines=[(0,0,1)])
7229             sage: P.combinatorial_automorphism_group(vertex_graph_only=True)
7230             Permutation Group with generators [(A vertex at (1,0,0),A vertex at (1,1,0))]
```


This is a weird test, as it tests a behavior which seems to be opposed to the intention of `vertex_graph`.  Also the announcement is strange, as the `vertex_graph` contains neither rays nor lines and thus will not interchange them (not even a ray with a ray).
----
New commits:



---

archive/issue_comments_400949.json:
```json
{
    "body": "it is not clear from the ticket description why edge_graph is deprecated, can you explain?",
    "created_at": "2019-10-19T14:49:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400949",
    "user": "@dimpase"
}
```

it is not clear from the ticket description why edge_graph is deprecated, can you explain?



---

archive/issue_comments_400950.json:
```json
{
    "body": "Sorry about the confusion. This ticket is built on top of #28603 and #28621. Only the last commit is due to this ticket.\n\nIn `CombinatorialPolyhedron`, I chose to implement a method `edge_graph`. In order to make it more compatible with `Polyhedron` I replace it by `vertex_graph` in #28603.\n\nThis way `CombinatorialPolyhedron(P).vertex_graph()` gives the vertex graph of our polyhedron `P`.\n\nThere are two issues with edge graph:\n- It has no vertices if there are no edges (a 0-dimensional polyhedron).\n- It depends not just on the combinatorial type, for example those two \n\n```\nsage: Q = Polyhedron(vertices=[[1,0],[0,1]],rays=[[1,11/10],[11/10,1]]); Q\nA 2-dimensional polyhedron in QQ^2 defined as the convex hull of 2 vertices and 2 rays\nsage: P = Polyhedron(vertices=[[1,0],[0,1]],rays=[[1,1]]); P\nA 2-dimensional polyhedron in QQ^2 defined as the convex hull of 2 vertices and 1 ray\n```\n\n  polyhedra do not have isomorphic `edge_graph`s in `CombinatorialPolyhedron`.",
    "created_at": "2019-10-19T16:23:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400950",
    "user": "@kliem"
}
```

Sorry about the confusion. This ticket is built on top of #28603 and #28621. Only the last commit is due to this ticket.

In `CombinatorialPolyhedron`, I chose to implement a method `edge_graph`. In order to make it more compatible with `Polyhedron` I replace it by `vertex_graph` in #28603.

This way `CombinatorialPolyhedron(P).vertex_graph()` gives the vertex graph of our polyhedron `P`.

There are two issues with edge graph:
- It has no vertices if there are no edges (a 0-dimensional polyhedron).
- It depends not just on the combinatorial type, for example those two 

```
sage: Q = Polyhedron(vertices=[[1,0],[0,1]],rays=[[1,11/10],[11/10,1]]); Q
A 2-dimensional polyhedron in QQ^2 defined as the convex hull of 2 vertices and 2 rays
sage: P = Polyhedron(vertices=[[1,0],[0,1]],rays=[[1,1]]); P
A 2-dimensional polyhedron in QQ^2 defined as the convex hull of 2 vertices and 1 ray
```

  polyhedra do not have isomorphic `edge_graph`s in `CombinatorialPolyhedron`.



---

archive/issue_comments_400951.json:
```json
{
    "body": "So this does bring the sanity in, where vertices correspond to vertices in the geometric sense, right?",
    "created_at": "2019-10-19T21:38:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400951",
    "user": "@dimpase"
}
```

So this does bring the sanity in, where vertices correspond to vertices in the geometric sense, right?



---

archive/issue_comments_400952.json:
```json
{
    "body": "Yes.\n\nHowever, as I'm changing the behavior, I didn't want to do it secretely and see if there are objections. Hence the post on sage_devel.",
    "created_at": "2019-10-20T04:59:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400952",
    "user": "@kliem"
}
```

Yes.

However, as I'm changing the behavior, I didn't want to do it secretely and see if there are objections. Hence the post on sage_devel.



---

archive/issue_comments_400953.json:
```json
{
    "body": "Are you still working on the ticket, or it needs review?",
    "created_at": "2019-10-20T08:24:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400953",
    "user": "@dimpase"
}
```

Are you still working on the ticket, or it needs review?



---

archive/issue_comments_400954.json:
```json
{
    "body": "I mostly waited, if there where objections to changing the behavior.\n\nIf there are none, I need to change the failing test and probably comment on the vertices being different from the method `vertices`.",
    "created_at": "2019-10-20T10:30:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400954",
    "user": "@kliem"
}
```

I mostly waited, if there where objections to changing the behavior.

If there are none, I need to change the failing test and probably comment on the vertices being different from the method `vertices`.



---

archive/issue_comments_400955.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-21T08:54:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400955",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_400956.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-10-21T08:54:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400956",
    "user": "@kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_400957.json:
```json
{
    "body": "Ticket retargeted after milestone closed",
    "created_at": "2020-01-06T14:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400957",
    "user": "@embray"
}
```

Ticket retargeted after milestone closed



---

archive/issue_comments_400958.json:
```json
{
    "body": "Is this ticket good to go?",
    "created_at": "2020-01-25T12:15:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400958",
    "user": "@kliem"
}
```

Is this ticket good to go?



---

archive/issue_comments_400959.json:
```json
{
    "body": "How about the bot report:\n\n```\n========== pyflakes ==========\ngit checkout patchbot/ticket_merged\nsrc/sage/geometry/polyhedron/base.py:5189: local variable 'ambient_dim' is assigned to but never used\nsrc/sage/geometry/polyhedron/base.py:5190: local variable 'polytope_dim' is assigned to but never used\n```\n",
    "created_at": "2020-01-25T12:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400959",
    "user": "@dimpase"
}
```

How about the bot report:

```
========== pyflakes ==========
git checkout patchbot/ticket_merged
src/sage/geometry/polyhedron/base.py:5189: local variable 'ambient_dim' is assigned to but never used
src/sage/geometry/polyhedron/base.py:5190: local variable 'polytope_dim' is assigned to but never used
```




---

archive/issue_comments_400960.json:
```json
{
    "body": "Replying to [comment:14 dimpase]:\n> How about the bot report:\n> {{{\n> ========== pyflakes ==========\n> git checkout patchbot/ticket_merged\n> src/sage/geometry/polyhedron/base.py:5189: local variable 'ambient_dim' is assigned to but never used\n> src/sage/geometry/polyhedron/base.py:5190: local variable 'polytope_dim' is assigned to but never used\n> }}}\n\nFixed in #28880.",
    "created_at": "2020-02-04T14:10:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400960",
    "user": "@jplab"
}
```

Replying to [comment:14 dimpase]:
> How about the bot report:
> {{{
> ========== pyflakes ==========
> git checkout patchbot/ticket_merged
> src/sage/geometry/polyhedron/base.py:5189: local variable 'ambient_dim' is assigned to but never used
> src/sage/geometry/polyhedron/base.py:5190: local variable 'polytope_dim' is assigned to but never used
> }}}

Fixed in #28880.



---

archive/issue_comments_400961.json:
```json
{
    "body": "Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.",
    "created_at": "2020-04-14T19:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400961",
    "user": "@mkoeppe"
}
```

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.



---

archive/issue_comments_400962.json:
```json
{
    "body": "Replying to [comment:6 gh-kliem]:\n> Yes.\n> \n> However, as I'm changing the behavior, I didn't want to do it secretely and see if there are objections. Hence the post on sage_devel.\n\nCould you link to the post?\n\nI would say that the ticket looks ready, but for the sake of completeness, I would like to check the change of behavior...",
    "created_at": "2020-04-20T09:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400962",
    "user": "@jplab"
}
```

Replying to [comment:6 gh-kliem]:
> Yes.
> 
> However, as I'm changing the behavior, I didn't want to do it secretely and see if there are objections. Hence the post on sage_devel.

Could you link to the post?

I would say that the ticket looks ready, but for the sake of completeness, I would like to check the change of behavior...



---

archive/issue_comments_400963.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2020-04-20T09:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400963",
    "user": "@jplab"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_400964.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2020-04-20T10:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400964",
    "user": "@kliem"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_400965.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-04-20T14:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400965",
    "user": "@jplab"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_400966.json:
```json
{
    "body": "Thank you.",
    "created_at": "2020-04-20T14:45:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400966",
    "user": "@kliem"
}
```

Thank you.



---

archive/issue_comments_400967.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-04-23T22:33:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28389#issuecomment-400967",
    "user": "@vbraun"
}
```

Resolution: fixed
