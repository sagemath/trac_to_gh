# Issue 32670: Update singular to 4.2.1p2

archive/issues_032670.json:
```json
{
    "body": "CC:  dimpase mjo fbissey arojas slelievre\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/32907\n\n",
    "created_at": "2021-11-19T18:21:34Z",
    "labels": [
        "packages: standard",
        "major",
        "enhancement"
    ],
    "title": "Update singular to 4.2.1p2",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32670",
    "user": "mkoeppe"
}
```
CC:  dimpase mjo fbissey arojas slelievre



Issue created by migration from https://trac.sagemath.org/ticket/32907





---

archive/issue_comments_466138.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-11-19T18:40:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466138",
    "user": "mkoeppe"
}
```

New commits:



---

archive/issue_comments_466139.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-19T18:44:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466139",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_466140.json:
```json
{
    "body": "Build ends with `Error: source file/directory doc/singular.idx does not exist`",
    "created_at": "2021-11-19T18:54:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466140",
    "user": "mkoeppe"
}
```

Build ends with `Error: source file/directory doc/singular.idx does not exist`



---

archive/issue_comments_466141.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-19T19:57:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466141",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_466142.json:
```json
{
    "body": "Passing `-j1` to \"make\" should no longer be necessary.",
    "created_at": "2021-11-19T20:40:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466142",
    "user": "mjo"
}
```

Passing `-j1` to "make" should no longer be necessary.



---

archive/issue_comments_466143.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-19T20:45:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466143",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_466144.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-11-19T20:51:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466144",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_466145.json:
```json
{
    "body": "This gives errors in the sagelib build:\n\n```\n  [sagelib-9.5.beta7]   build/cythonized/sage/rings/polynomial/multi_polynomial_libsingular.cpp:33693:18: note: in expansion of macro \u2018p_SetCoeff0\u2019\n  [sagelib-9.5.beta7]              (void)(p_SetCoeff0(__pyx_v_temp, n_Copy(p_GetCoeff(__pyx_v_p, __pyx_v_r), __pyx_v_r), __pyx_v_r));\n  [sagelib-9.5.beta7]                     ^\n  [sagelib-9.5.beta7]   build/cythonized/sage/rings/polynomial/multi_polynomial_libsingular.cpp: In function \u2018PyObject* __pyx_pf_4sage_5rings_10polynomial_28multi_polynomial_libsingular_23MPolynomial_libsingular_104factor(__pyx_obj_4sage_5rings_10polynomial_28multi_polynomial_libsingular_MPolynomial_libsingular*, PyObject*)\u2019:\n  [sagelib-9.5.beta7]   build/cythonized/sage/rings/polynomial/multi_polynomial_libsingular.cpp:34874:40: error: cannot convert \u2018ip_sring*\u2019 to \u2018coeffs {aka n_Procs_s*}\u2019 for argument \u20181\u2019 to \u2018int n_GetChar(coeffs)\u2019\n  [sagelib-9.5.beta7]      __pyx_t_7 = ((n_GetChar(__pyx_v__ring) > 0x20000000) != 0);\n  [sagelib-9.5.beta7]                                           ^\n```\n",
    "created_at": "2021-11-20T00:09:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466145",
    "user": "mkoeppe"
}
```

This gives errors in the sagelib build:

```
  [sagelib-9.5.beta7]   build/cythonized/sage/rings/polynomial/multi_polynomial_libsingular.cpp:33693:18: note: in expansion of macro ‘p_SetCoeff0’
  [sagelib-9.5.beta7]              (void)(p_SetCoeff0(__pyx_v_temp, n_Copy(p_GetCoeff(__pyx_v_p, __pyx_v_r), __pyx_v_r), __pyx_v_r));
  [sagelib-9.5.beta7]                     ^
  [sagelib-9.5.beta7]   build/cythonized/sage/rings/polynomial/multi_polynomial_libsingular.cpp: In function ‘PyObject* __pyx_pf_4sage_5rings_10polynomial_28multi_polynomial_libsingular_23MPolynomial_libsingular_104factor(__pyx_obj_4sage_5rings_10polynomial_28multi_polynomial_libsingular_MPolynomial_libsingular*, PyObject*)’:
  [sagelib-9.5.beta7]   build/cythonized/sage/rings/polynomial/multi_polynomial_libsingular.cpp:34874:40: error: cannot convert ‘ip_sring*’ to ‘coeffs {aka n_Procs_s*}’ for argument ‘1’ to ‘int n_GetChar(coeffs)’
  [sagelib-9.5.beta7]      __pyx_t_7 = ((n_GetChar(__pyx_v__ring) > 0x20000000) != 0);
  [sagelib-9.5.beta7]                                           ^
```




---

archive/issue_comments_466146.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-11-20T00:09:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466146",
    "user": "mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_466147.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-20T11:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466147",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_466148.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-11-20T11:47:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466148",
    "user": "arojas"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_466149.json:
```json
{
    "body": "Builds now, also with older singular (at least as far back as 4.2.0p1). I've also tried to keep tests compatible with older singular, except for the example in `rings/polynomial/hilbert.pyx`, which failed before and works now. Should we care about it?",
    "created_at": "2021-11-20T11:47:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466149",
    "user": "arojas"
}
```

Builds now, also with older singular (at least as far back as 4.2.0p1). I've also tried to keep tests compatible with older singular, except for the example in `rings/polynomial/hilbert.pyx`, which failed before and works now. Should we care about it?



---

archive/issue_comments_466150.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-11-20T17:53:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466150",
    "user": "mkoeppe"
}
```

New commits:



---

archive/issue_comments_466151.json:
```json
{
    "body": "`ubuntu-trusty-minimal` (https://github.com/mkoeppe/sage/runs/4274462334?check_suite_focus=true) and `ubuntu-trusty-standard`:\n\n```\n  [sagemath_doc_html-none]       from sage.symbolic.all   import *\n  [sagemath_doc_html-none]     File \"/sage/local/var/lib/sage/venv-python3.9.7/lib/python3.9/site-packages/sage/symbolic/all.py\", line 8, in <module>\n  [sagemath_doc_html-none]       import sage.symbolic.expression  # initialize pynac before .ring\n  [sagemath_doc_html-none]   ImportError: /sage/local/var/lib/sage/venv-python3.9.7/lib/python3.9/site-packages/sage/symbolic/expression.cpython-39-x86_64-linux-gnu.so: undefined symbol: fmpq_poly_inv_series_newton\n  [sagemath_doc_html-none]   Error: './sage --docbuild --all-documents' failed\n```\n",
    "created_at": "2021-11-21T01:09:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466151",
    "user": "mkoeppe"
}
```

`ubuntu-trusty-minimal` (https://github.com/mkoeppe/sage/runs/4274462334?check_suite_focus=true) and `ubuntu-trusty-standard`:

```
  [sagemath_doc_html-none]       from sage.symbolic.all   import *
  [sagemath_doc_html-none]     File "/sage/local/var/lib/sage/venv-python3.9.7/lib/python3.9/site-packages/sage/symbolic/all.py", line 8, in <module>
  [sagemath_doc_html-none]       import sage.symbolic.expression  # initialize pynac before .ring
  [sagemath_doc_html-none]   ImportError: /sage/local/var/lib/sage/venv-python3.9.7/lib/python3.9/site-packages/sage/symbolic/expression.cpython-39-x86_64-linux-gnu.so: undefined symbol: fmpq_poly_inv_series_newton
  [sagemath_doc_html-none]   Error: './sage --docbuild --all-documents' failed
```




---

archive/issue_comments_466152.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-11-21T01:11:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466152",
    "user": "mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_466153.json:
```json
{
    "body": "Replying to [comment:21 mkoeppe]:\n> `ubuntu-trusty-minimal` (https://github.com/mkoeppe/sage/runs/4274462334?check_suite_focus=true) and `ubuntu-trusty-standard`:\n\nhow can one see the singular spkg logs?",
    "created_at": "2021-11-21T08:19:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466153",
    "user": "arojas"
}
```

Replying to [comment:21 mkoeppe]:
> `ubuntu-trusty-minimal` (https://github.com/mkoeppe/sage/runs/4274462334?check_suite_focus=true) and `ubuntu-trusty-standard`:

how can one see the singular spkg logs?



---

archive/issue_comments_466154.json:
```json
{
    "body": "The log artifacts are now available at https://github.com/mkoeppe/sage/actions/runs/1485019210 (I had to cancel the workflow for that)",
    "created_at": "2021-11-21T08:45:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466154",
    "user": "mkoeppe"
}
```

The log artifacts are now available at https://github.com/mkoeppe/sage/actions/runs/1485019210 (I had to cancel the workflow for that)



---

archive/issue_comments_466155.json:
```json
{
    "body": "Still can't figure out where spkg logs are. Anyways, I insalled the docker image locally and this is the actual issue:\n\n```\nconfigure:24015: gcc -std=gnu11 -o conftest -I/home/sage/local/include/ -I/home/sage/local/include -I/home/sage/local/include -g -O2  -pipe -fno-common -g0 -O3 -Wno-unused-function -Wno-trigraphs -Wno-unused-parameter -Wunknown-pragmas -Wno-unused-variable -fomit-frame-pointer -fwrapv -fvisibility=default -finline-functions -fno-exceptions -funroll-loops  -Wl,-rpath-link,/home/sage/local/lib -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib -Wl,-rpath-link,/home/sage/local/lib -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib  -pipe -fno-common -g0 -O3 -Wno-unused-function -Wno-trigraphs -Wno-unused-parameter -Wunknown-pragmas -Wno-unused-variable -fomit-frame-pointer -fwrapv -fvisibility=default -finline-functions -fno-exceptions -funroll-loops conftest.c -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib -lflint -lmpfr -lgmp -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib -lgmp -lpthread  -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib -lgmp -lm  >&5\nIn file included from /home/sage/local/include/flint/nmod_vec.h:29:0,\n                 from /home/sage/local/include/flint/fmpz.h:31,\n                 from conftest.c:34:\n/home/sage/local/include/flint/ulong_extras.h:119:1: error: unknown type name '_Thread_local'\n extern FLINT_TLS_PREFIX ulong * _flint_primes[FLINT_BITS];\n ^\n```\n\nPerhaps a too old gcc?",
    "created_at": "2021-11-21T11:37:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466155",
    "user": "arojas"
}
```

Still can't figure out where spkg logs are. Anyways, I insalled the docker image locally and this is the actual issue:

```
configure:24015: gcc -std=gnu11 -o conftest -I/home/sage/local/include/ -I/home/sage/local/include -I/home/sage/local/include -g -O2  -pipe -fno-common -g0 -O3 -Wno-unused-function -Wno-trigraphs -Wno-unused-parameter -Wunknown-pragmas -Wno-unused-variable -fomit-frame-pointer -fwrapv -fvisibility=default -finline-functions -fno-exceptions -funroll-loops  -Wl,-rpath-link,/home/sage/local/lib -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib -Wl,-rpath-link,/home/sage/local/lib -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib  -pipe -fno-common -g0 -O3 -Wno-unused-function -Wno-trigraphs -Wno-unused-parameter -Wunknown-pragmas -Wno-unused-variable -fomit-frame-pointer -fwrapv -fvisibility=default -finline-functions -fno-exceptions -funroll-loops conftest.c -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib -lflint -lmpfr -lgmp -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib -lgmp -lpthread  -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib -lgmp -lm  >&5
In file included from /home/sage/local/include/flint/nmod_vec.h:29:0,
                 from /home/sage/local/include/flint/fmpz.h:31,
                 from conftest.c:34:
/home/sage/local/include/flint/ulong_extras.h:119:1: error: unknown type name '_Thread_local'
 extern FLINT_TLS_PREFIX ulong * _flint_primes[FLINT_BITS];
 ^
```

Perhaps a too old gcc?



---

archive/issue_comments_466156.json:
```json
{
    "body": "Besides singular not using flint on trusty, this error shows that there's also an issue in sagelib: `symbolic.expression` uses flint functions (probably via GiNaC) and yet it only links to flint via `SINGULAR_LIBRARIES` (and therefore it underlinks if singular is built without flint). It should be linking to flint directly.",
    "created_at": "2021-11-21T11:53:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466156",
    "user": "arojas"
}
```

Besides singular not using flint on trusty, this error shows that there's also an issue in sagelib: `symbolic.expression` uses flint functions (probably via GiNaC) and yet it only links to flint via `SINGULAR_LIBRARIES` (and therefore it underlinks if singular is built without flint). It should be linking to flint directly.



---

archive/issue_comments_466157.json:
```json
{
    "body": "Replying to [comment:26 arojas]:\n> Besides singular not using flint on trusty, this error shows that there's also an issue in sagelib: `symbolic.expression` uses flint functions (probably via GiNaC) and yet it only links to flint via `SINGULAR_LIBRARIES` (and therefore it underlinks if singular is built without flint). It should be linking to flint directly.\n\nOpened #32919 for this",
    "created_at": "2021-11-21T12:16:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466157",
    "user": "arojas"
}
```

Replying to [comment:26 arojas]:
> Besides singular not using flint on trusty, this error shows that there's also an issue in sagelib: `symbolic.expression` uses flint functions (probably via GiNaC) and yet it only links to flint via `SINGULAR_LIBRARIES` (and therefore it underlinks if singular is built without flint). It should be linking to flint directly.

Opened #32919 for this



---

archive/issue_comments_466158.json:
```json
{
    "body": "Replying to [comment:25 arojas]:\n> {{{\n> configure:24015: gcc -std=gnu11 -o conftest -I/home/sage/local/include/ -I/home/sage/local/include -I/home/sage/local/include -g -O2  -pipe -fno-common -g0 -O3 -Wno-unused-function -Wno-trigraphs -Wno-unused-parameter -Wunknown-pragmas -Wno-unused-variable -fomit-frame-pointer -fwrapv -fvisibility=default -finline-functions -fno-exceptions -funroll-loops  -Wl,-rpath-link,/home/sage/local/lib -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib -Wl,-rpath-link,/home/sage/local/lib -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib  -pipe -fno-common -g0 -O3 -Wno-unused-function -Wno-trigraphs -Wno-unused-parameter -Wunknown-pragmas -Wno-unused-variable -fomit-frame-pointer -fwrapv -fvisibility=default -finline-functions -fno-exceptions -funroll-loops conftest.c -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib -lflint -lmpfr -lgmp -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib -lgmp -lpthread  -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib -lgmp -lm  >&5\n> In file included from /home/sage/local/include/flint/nmod_vec.h:29:0,\n>                  from /home/sage/local/include/flint/fmpz.h:31,\n>                  from conftest.c:34:\n> /home/sage/local/include/flint/ulong_extras.h:119:1: error: unknown type name '_Thread_local'\n>  extern FLINT_TLS_PREFIX ulong * _flint_primes[FLINT_BITS];\n>  ^\n> }}}\n> Perhaps a too old gcc?\n\nYes, it looks like we are running into an old problem, \nhttps://bugs.freebsd.org/bugzilla/show_bug.cgi?id=203066, \"don't use `-std=gnu11` with gcc < 4.9",
    "created_at": "2021-11-21T18:32:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466158",
    "user": "mkoeppe"
}
```

Replying to [comment:25 arojas]:
> {{{
> configure:24015: gcc -std=gnu11 -o conftest -I/home/sage/local/include/ -I/home/sage/local/include -I/home/sage/local/include -g -O2  -pipe -fno-common -g0 -O3 -Wno-unused-function -Wno-trigraphs -Wno-unused-parameter -Wunknown-pragmas -Wno-unused-variable -fomit-frame-pointer -fwrapv -fvisibility=default -finline-functions -fno-exceptions -funroll-loops  -Wl,-rpath-link,/home/sage/local/lib -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib -Wl,-rpath-link,/home/sage/local/lib -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib  -pipe -fno-common -g0 -O3 -Wno-unused-function -Wno-trigraphs -Wno-unused-parameter -Wunknown-pragmas -Wno-unused-variable -fomit-frame-pointer -fwrapv -fvisibility=default -finline-functions -fno-exceptions -funroll-loops conftest.c -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib -lflint -lmpfr -lgmp -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib -lgmp -lpthread  -L/home/sage/local/lib -Wl,-rpath,/home/sage/local/lib -lgmp -lm  >&5
> In file included from /home/sage/local/include/flint/nmod_vec.h:29:0,
>                  from /home/sage/local/include/flint/fmpz.h:31,
>                  from conftest.c:34:
> /home/sage/local/include/flint/ulong_extras.h:119:1: error: unknown type name '_Thread_local'
>  extern FLINT_TLS_PREFIX ulong * _flint_primes[FLINT_BITS];
>  ^
> }}}
> Perhaps a too old gcc?

Yes, it looks like we are running into an old problem, 
https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=203066, "don't use `-std=gnu11` with gcc < 4.9



---

archive/issue_comments_466159.json:
```json
{
    "body": "It looks like this is showing up now simply because the new singular tarball has been generated with a newer version of autoconf.\n\nBefore:\n\n```\nConfiguring singular-4.2.1.p0\nchecking for gcc... gcc\nchecking whether the C compiler works... yes\nchecking for C compiler default output file name... a.out\nchecking for suffix of executables... \nchecking whether we are cross compiling... no\nchecking for suffix of object files... o\nchecking whether we are using the GNU C compiler... yes\nchecking whether gcc accepts -g... yes\nchecking for gcc option to accept ISO C89... none needed\n```\n\n\n\nAfter:\n\n```\nConfiguring singular-4.2.1p2\nchecking for gcc... gcc\nchecking whether the C compiler works... yes\nchecking for C compiler default output file name... a.out\nchecking for suffix of executables... \nchecking whether we are cross compiling... no\nchecking for suffix of object files... o\nchecking whether the compiler supports GNU C... yes\nchecking whether gcc accepts -g... yes\nchecking for gcc option to enable C11 features... -std=gnu11\n```\n",
    "created_at": "2021-11-21T18:36:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466159",
    "user": "mkoeppe"
}
```

It looks like this is showing up now simply because the new singular tarball has been generated with a newer version of autoconf.

Before:

```
Configuring singular-4.2.1.p0
checking for gcc... gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables... 
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ISO C89... none needed
```



After:

```
Configuring singular-4.2.1p2
checking for gcc... gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables... 
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether the compiler supports GNU C... yes
checking whether gcc accepts -g... yes
checking for gcc option to enable C11 features... -std=gnu11
```




---

archive/issue_comments_466160.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-21T20:03:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466160",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_466161.json:
```json
{
    "body": "With this patch for flint, Singular finds it, as tested with `tox -e docker-ubuntu-trusty-standard -- singular`.",
    "created_at": "2021-11-21T20:28:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466161",
    "user": "mkoeppe"
}
```

With this patch for flint, Singular finds it, as tested with `tox -e docker-ubuntu-trusty-standard -- singular`.



---

archive/issue_comments_466162.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-11-21T20:28:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466162",
    "user": "mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_466163.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-22T17:56:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466163",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_466164.json:
```json
{
    "body": "If it helps I could try this ticket out\non a few machines (Cygwin, Linux, macOS).\n\nFor now I can only offer trivial comments\n(feel free to disregard them).\n\nI would wrap this long output line:\n\n```diff\n         sage: J.hilbert_numerator(algorithm='singular')\n-        120*t^33 - 3465*t^32 + 48180*t^31 - 429374*t^30 + 2753520*t^29 - 13522410*t^28 + 52832780*t^27 - 168384150*t^26 + 445188744*t^25 - 987193350*t^24 + 1847488500*t^23 + 1372406746*t^22 - 403422496*t^21 - 8403314*t^20 - 471656596*t^19 + 1806623746*t^18 + 752776200*t^17 + 752776200*t^16 - 1580830020*t^15 + 1673936550*t^14 - 1294246800*t^13 + 786893250*t^12 - 382391100*t^11 + 146679390*t^10 - 42299400*t^9 + 7837830*t^8 - 172260*t^7 - 468930*t^6 + 183744*t^5 - 39270*t^4 + 5060*t^3 - 330*t^2 + 1\n+        120*t^33 - 3465*t^32 + 48180*t^31 - 429374*t^30 + 2753520*t^29\n+        - 13522410*t^28 + 52832780*t^27 - 168384150*t^26 + 445188744*t^25\n+        - 987193350*t^24 + 1847488500*t^23 + 1372406746*t^22 - 403422496*t^21\n+        - 8403314*t^20 - 471656596*t^19 + 1806623746*t^18 + 752776200*t^17\n+        + 752776200*t^16 - 1580830020*t^15 + 1673936550*t^14 - 1294246800*t^13\n+        + 786893250*t^12 - 382391100*t^11 + 146679390*t^10 - 42299400*t^9\n+        + 7837830*t^8 - 172260*t^7 - 468930*t^6 + 183744*t^5 - 39270*t^4\n+        + 5060*t^3 - 330*t^2 + 1\n```\n\nor maybe even rewrite that doctest as:\n\n```diff\n-        sage: J.hilbert_numerator(algorithm='singular')\n+        sage: p = J.hilbert_numerator(algorithm='singular')\n+        sage: p.list()\n+        [1, 0, -330, 5060, -39270, 183744, -468930, -172260, 7837830,\n+         -42299400, 146679390, -382391100, 786893250, -1294246800,\n+         1673936550, -1580830020, 752776200, 752776200, 1806623746,\n+         -471656596, -8403314, -403422496, 1372406746, 1847488500,\n+         -987193350, 445188744, -168384150, 52832780, -13522410,\n+         2753520, -429374, 48180, -3465, 120]\n```\n\nwhose output I personally find easier to parse visually.\n\nAnother wrapping suggestion:\n\n```diff\n-        [x + y + 57119*z + 4, y^2 + 3*y + 17220, y*z + ..., 2*y + 158864, z^2 + 17223, 2*z + 41856, 164878]\n+        [x + y + 57119*z + 4, y^2 + 3*y + 17220, y*z + ...,\n+         2*y + 158864, z^2 + 17223, 2*z + 41856, 164878]\n```\n\n\nSome pep8 whitespace suggestions (the last two occur several times):\n\n```diff\n-            n_Delete(&n,r.cf)\n+            n_Delete(&n, r.cf)\n```\n\n\n\n```diff\n-                p_SetCoeff(newptemp,n_Copy(p_GetCoeff(p,r),r.cf),r)\n+                p_SetCoeff(newptemp, n_Copy(p_GetCoeff(p, r), r.cf), r)\n```\n\n\n\n```diff\n-            p_SetCoeff(p, n_Init(1,_ring.cf), _ring)\n+            p_SetCoeff(p, n_Init(1, _ring.cf), _ring)\n```\n",
    "created_at": "2021-11-26T22:58:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466164",
    "user": "slelievre"
}
```

If it helps I could try this ticket out
on a few machines (Cygwin, Linux, macOS).

For now I can only offer trivial comments
(feel free to disregard them).

I would wrap this long output line:

```diff
         sage: J.hilbert_numerator(algorithm='singular')
-        120*t^33 - 3465*t^32 + 48180*t^31 - 429374*t^30 + 2753520*t^29 - 13522410*t^28 + 52832780*t^27 - 168384150*t^26 + 445188744*t^25 - 987193350*t^24 + 1847488500*t^23 + 1372406746*t^22 - 403422496*t^21 - 8403314*t^20 - 471656596*t^19 + 1806623746*t^18 + 752776200*t^17 + 752776200*t^16 - 1580830020*t^15 + 1673936550*t^14 - 1294246800*t^13 + 786893250*t^12 - 382391100*t^11 + 146679390*t^10 - 42299400*t^9 + 7837830*t^8 - 172260*t^7 - 468930*t^6 + 183744*t^5 - 39270*t^4 + 5060*t^3 - 330*t^2 + 1
+        120*t^33 - 3465*t^32 + 48180*t^31 - 429374*t^30 + 2753520*t^29
+        - 13522410*t^28 + 52832780*t^27 - 168384150*t^26 + 445188744*t^25
+        - 987193350*t^24 + 1847488500*t^23 + 1372406746*t^22 - 403422496*t^21
+        - 8403314*t^20 - 471656596*t^19 + 1806623746*t^18 + 752776200*t^17
+        + 752776200*t^16 - 1580830020*t^15 + 1673936550*t^14 - 1294246800*t^13
+        + 786893250*t^12 - 382391100*t^11 + 146679390*t^10 - 42299400*t^9
+        + 7837830*t^8 - 172260*t^7 - 468930*t^6 + 183744*t^5 - 39270*t^4
+        + 5060*t^3 - 330*t^2 + 1
```

or maybe even rewrite that doctest as:

```diff
-        sage: J.hilbert_numerator(algorithm='singular')
+        sage: p = J.hilbert_numerator(algorithm='singular')
+        sage: p.list()
+        [1, 0, -330, 5060, -39270, 183744, -468930, -172260, 7837830,
+         -42299400, 146679390, -382391100, 786893250, -1294246800,
+         1673936550, -1580830020, 752776200, 752776200, 1806623746,
+         -471656596, -8403314, -403422496, 1372406746, 1847488500,
+         -987193350, 445188744, -168384150, 52832780, -13522410,
+         2753520, -429374, 48180, -3465, 120]
```

whose output I personally find easier to parse visually.

Another wrapping suggestion:

```diff
-        [x + y + 57119*z + 4, y^2 + 3*y + 17220, y*z + ..., 2*y + 158864, z^2 + 17223, 2*z + 41856, 164878]
+        [x + y + 57119*z + 4, y^2 + 3*y + 17220, y*z + ...,
+         2*y + 158864, z^2 + 17223, 2*z + 41856, 164878]
```


Some pep8 whitespace suggestions (the last two occur several times):

```diff
-            n_Delete(&n,r.cf)
+            n_Delete(&n, r.cf)
```



```diff
-                p_SetCoeff(newptemp,n_Copy(p_GetCoeff(p,r),r.cf),r)
+                p_SetCoeff(newptemp, n_Copy(p_GetCoeff(p, r), r.cf), r)
```



```diff
-            p_SetCoeff(p, n_Init(1,_ring.cf), _ring)
+            p_SetCoeff(p, n_Init(1, _ring.cf), _ring)
```




---

archive/issue_comments_466165.json:
```json
{
    "body": "Changing keywords from \"\" to \"upgrade, Singular\".",
    "created_at": "2021-11-26T22:58:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466165",
    "user": "slelievre"
}
```

Changing keywords from "" to "upgrade, Singular".



---

archive/issue_comments_466166.json:
```json
{
    "body": "Cygwin testing would be valuable",
    "created_at": "2021-11-26T23:04:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466166",
    "user": "mkoeppe"
}
```

Cygwin testing would be valuable



---

archive/issue_comments_466167.json:
```json
{
    "body": "Also please feel free to push these edits to the ticket",
    "created_at": "2021-11-27T19:49:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466167",
    "user": "mkoeppe"
}
```

Also please feel free to push these edits to the ticket



---

archive/issue_comments_466168.json:
```json
{
    "body": "Setting to blocker because system singular is already being picked up by our spkg-configure",
    "created_at": "2021-12-09T21:15:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466168",
    "user": "mkoeppe"
}
```

Setting to blocker because system singular is already being picked up by our spkg-configure



---

archive/issue_comments_466169.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2021-12-09T21:15:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466169",
    "user": "mkoeppe"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_466170.json:
```json
{
    "body": "Let's get this in please",
    "created_at": "2021-12-17T23:29:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466170",
    "user": "mkoeppe"
}
```

Let's get this in please



---

archive/issue_comments_466171.json:
```json
{
    "body": "4.2.1p3 is out including the commit needed for #32959",
    "created_at": "2021-12-17T23:39:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466171",
    "user": "arojas"
}
```

4.2.1p3 is out including the commit needed for #32959



---

archive/issue_comments_466172.json:
```json
{
    "body": "yes, seems like a nice update to get: https://github.com/Singular/Singular/releases/tag/Release-4-2-1p3",
    "created_at": "2021-12-18T00:08:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466172",
    "user": "dimpase"
}
```

yes, seems like a nice update to get: https://github.com/Singular/Singular/releases/tag/Release-4-2-1p3



---

archive/issue_comments_466173.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-12-18T04:20:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466173",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_466174.json:
```json
{
    "body": "Tests on GH Actions look fine.",
    "created_at": "2021-12-18T18:49:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466174",
    "user": "mkoeppe"
}
```

Tests on GH Actions look fine.



---

archive/issue_comments_466175.json:
```json
{
    "body": "lgtm",
    "created_at": "2021-12-22T23:59:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466175",
    "user": "dimpase"
}
```

lgtm



---

archive/issue_comments_466176.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-12-22T23:59:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466176",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_466177.json:
```json
{
    "body": "Thanks!",
    "created_at": "2021-12-23T00:17:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466177",
    "user": "mkoeppe"
}
```

Thanks!



---

archive/issue_comments_466178.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-12-28T21:15:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466178",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_466179.json:
```json
{
    "body": "update to 4.3.0 is dealt with on #33160",
    "created_at": "2022-01-13T13:34:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32670#issuecomment-466179",
    "user": "dimpase"
}
```

update to 4.3.0 is dealt with on #33160
