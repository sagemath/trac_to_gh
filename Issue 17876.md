# Issue 17876: Warning for unstable/experimental code

Issue created by migration from https://trac.sagemath.org/ticket/18113

Original creator: dkrenn

Original creation time: 2015-04-02 17:59:29

Keywords: sd66, warning

During SageDays66 and on [https://groups.google.com/forum/#!topic/sage-devel/LXWs6KOw0Lk](https://groups.google.com/forum/#!topic/sage-devel/LXWs6KOw0Lk) there were discussions about the possibility to add code to Sage which is marked as "experimental". For this code no deprecation would be needed (for some time, e.g. a year or when the developers decide) in case of changes in the code.

One motivation for this is, that many modules are developed not in Sage but outside (but with the goal of implementing it in to Sage when ready). This is done later, when it is clear, that the designs have turned out to be a good choice (and maybe changed a couple of times). Having it included in Sage from the beginning would have lead to several deprecations in many cases, which are a lot of effort and therefore a barrier in the development process.


---

Comment by dkrenn created at 2015-04-02 18:00:36

New commits:


---

Comment by git created at 2015-04-03 14:40:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2015-04-03 14:42:08

I've created a decorator for easier usage.

I've also written a draft in the developer guide. Please read and comment here or rewrite it.

Daniel


---

Comment by git created at 2015-04-07 09:07:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2015-04-07 09:08:27

Added some SEEALSO blocks.


---

Comment by dkrenn created at 2015-04-07 09:09:05

I've now set it to needs_review since the discussion on sage-devel seems to have come to an end.


---

Comment by dkrenn created at 2015-04-07 09:09:05

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2015-04-07 09:47:03

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2015-04-07 09:47:03

Please add the required `import` statements to the documentation such that the examples can really be copy-pasted.


---

Comment by jdemeyer created at 2015-04-07 09:48:50

Are you sure that the warning stacklevel should not be increased?

And is the ``@`` needed here in the last example in the documentation?


---

Comment by git created at 2015-04-07 09:53:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-04-07 11:25:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2015-04-07 11:27:04

Replying to [comment:8 jdemeyer]:
> Are you sure that the warning stacklevel should not be increased?

Good point; changed (but I am not that familiar with it, so please check very carefully...).
----
New commits:


---

Comment by git created at 2015-04-07 11:46:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2015-04-07 11:47:24

Now tried to adapt stacklevel in decorator as well.


---

Comment by dkrenn created at 2015-04-07 11:47:50

Changing status from needs_work to needs_review.


---

Comment by kcrisman created at 2015-04-07 13:17:39


```
+def experimental(trac_number, message, stacklevel=5):
+    r"""
+    Issue a warning that the functionality or class is experimental
+    and might change in future.
+
+    INPUT:
+
+    - ``trac_number`` -- an integer. The trac ticket number where the
+      deprecation is introduced.
+
```

Maybe the trac ticket number where the experimental functionality was introduced?


---

Comment by kcrisman created at 2015-04-07 13:17:39

Changing status from needs_review to needs_info.


---

Comment by git created at 2015-04-07 15:16:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2015-04-07 15:17:35

Changing status from needs_info to needs_review.


---

Comment by dkrenn created at 2015-04-07 15:17:35

Replying to [comment:15 kcrisman]:
> {{{
> +def experimental(trac_number, message, stacklevel=5):
> +    r"""
> +    Issue a warning that the functionality or class is experimental
> +    and might change in future.
> +
> +    INPUT:
> +
> +    - ``trac_number`` -- an integer. The trac ticket number where the
> +      deprecation is introduced.
> +
> }}}
> Maybe the trac ticket number where the experimental functionality was introduced?

Yes (copy and pasted...) ;) Is now corrected.


---

Comment by kcrisman created at 2015-04-07 15:19:52

I figured as much.  Sorry I don't have time to actually do a full review.


---

Comment by mmezzarobba created at 2015-04-08 13:48:26

FWIW I'd find it more natural if `experimental` was the decorator. But I don't know what to call the version that just produces the warning then. Perhaps something like `warn_experimental`?


---

Comment by git created at 2015-04-09 08:05:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2015-04-09 08:05:46

Replying to [comment:19 mmezzarobba]:
> FWIW I'd find it more natural if `experimental` was the decorator. But I don't know what to call the version that just produces the warning then. Perhaps something like `warn_experimental`?

Good idea. Changed.


---

Comment by mmezzarobba created at 2015-04-13 10:13:55

* The `stacklevel` argument of `experimental_warning` defaults to 5, but the docstring says “default: ``4``”. Which should it be?
* “issues” should be “issue” in the docstring of ``warning``.
* (Also, I would perhaps replace ”without a deprecation warning” by something like “without a deprecation period” or “with no formal deprecation”, but I'm not sure if it's clearer.)


---

Comment by git created at 2015-04-13 13:50:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2015-04-13 13:51:13

Replying to [comment:22 mmezzarobba]:
> * The `stacklevel` argument of `experimental_warning` defaults to 5, but the docstring says “default: ``4``”. Which should it be?
> * “issues” should be “issue” in the docstring of ``warning``.
> * (Also, I would perhaps replace ”without a deprecation warning” by something like “without a deprecation period” or “with no formal deprecation”, but I'm not sure if it's clearer.)

Changed. Thanks for your comments.


---

Comment by mmezzarobba created at 2015-04-13 15:54:38

After testing it seems to me that `stacklevel` should be 4 in both `experimental.__init__` and `experimental_warning` to get the right line number. But perhaps I misunderstood the intention?

Otherwise lgtm.


---

Comment by git created at 2015-04-13 22:06:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-04-13 22:18:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2015-04-13 22:21:45

Replying to [comment:25 mmezzarobba]:
> After testing it seems to me that `stacklevel` should be 4 in both `experimental.__init__` and `experimental_warning` to get the right line number. But perhaps I misunderstood the intention?

I think you are right; it should be 4. Changed.


---

Comment by mmezzarobba created at 2015-04-14 06:57:57

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-04-14 23:01:27

Resolution: fixed
