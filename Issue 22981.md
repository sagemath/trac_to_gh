# Issue 22981: Ramified extensions of general p-adic rings and fields

Issue created by migration from Trac.

Original creator: roed

Original creation time: 2017-06-11 18:44:52

CC:  saraedum swewers caruso

Keywords: sd87

We should have support for relative extensions of p-adic rings and fields.  This is particularly useful for totally ramified extensions of unramified extensions of Qp, which will represent a general absolute extension of Qp.


---

Comment by saraedum created at 2017-06-11 19:21:56

New commits:


---

Comment by git created at 2017-06-12 01:49:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-06-12 02:12:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-06-12 07:03:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-06-13 06:07:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-06-13 09:25:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-06-13 20:26:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-06-13 23:17:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-06-13 23:49:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-06-14 09:29:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-06-15 06:13:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-06-15 20:09:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-07-17 06:08:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-07-20 19:59:04

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by git created at 2017-07-20 21:32:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-07-21 07:02:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-07-21 08:26:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-07-21 18:59:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-07-22 22:38:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-08-03 02:19:10

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by roed created at 2017-08-03 05:27:46

Diff against #23471


---

Attachment

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by roed created at 2017-08-03 21:43:16

Update dependency chain: #23471 depends on #14825, which depends on #20310.


---

Comment by git created at 2017-08-21 04:22:42

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by git created at 2017-09-22 21:05:00

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by git created at 2017-11-04 00:13:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-11-05 08:21:21

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by git created at 2017-11-15 23:25:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by lubicz created at 2017-12-16 19:18:45

It seems that I have found a problem with this ticket. Here is my example:



```
sage: R=Zq(2^10)
sage: P.<alpha>=R[]
sage: R1.<t>=R.ext(alpha^2+2*alpha+2)
sage: M1=matrix(R1, 2, 2)
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
```



---

Comment by git created at 2018-03-01 15:38:24

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2018-03-01 15:46:04

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:


---

Comment by git created at 2018-03-01 15:52:01

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2018-03-01 16:04:30

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:


---

Comment by roed created at 2018-03-01 16:05:29

Sorry for the weird force pushes.  Things got confused with #23344.  It should be okay now, and a fast-forward of the branch from an hour ago.


---

Comment by caruso created at 2018-05-17 19:44:39

Here are a series of bugs/remarks (see also discussion on Zulip):

- the printing of the parent is not optimal
- there is an issue with precision with the computation of `x^p`
- the methods `zero` and `one` (of the parent) are not implemented
- the method `expansion` is broken
- coercion from `QQ` to a p-adic field does not always work (might be related to the previous item)
- the method `polynomial` is broken
----
New commits:


---

Comment by roed created at 2018-07-22 20:27:52

Changing keywords from "sd87" to "sd87, padicIMA".


---

Comment by varul created at 2018-07-23 16:24:42

_test_add, _test_elements, _test_log, _test_sub failed when running TestSuite on the following 5-adic Eisenstein field.


```
sage: K.<a> = Qq(125)
sage: R.<x> = K[]
sage: W.<w> = K.extension(x^3 + 25*x^2 - 5*a*x + 5*(1+a^2))
sage: TestSuite(W).run()
```


For _test_add, the line

```
tester.assertTrue(y.is_equal_to(z-x,zprec))
```

fails. Even though the expressions z-(x+y) and x+y-z were fine, the expression z-x-y is not. (In my particular failure, they all had relative precision 60, x and z had absolute precision 60, y had absolute precision 63.)


---

Comment by git created at 2018-07-23 16:51:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by varul created at 2018-07-23 19:55:22

random_element fails because multiplying by an element in the base field with negative valuation throws a "ValueError: negative valuation"

```
sage: K.<a> = Qq(125)
sage: R.<t> = K[]
sage: W.<w> = K.extension(t^3 + 5*(5*t^2 + (13*a-a^2)*t + a))
sage: K(1/5)*w
ValueError: negative valuation
```



---

Comment by git created at 2018-07-23 20:57:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-23 21:44:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by caruso created at 2018-07-23 22:22:19

Here is another bug:


```
sage: K.<a> = Qq(2^10, 10)
sage: S.<X> = K[]
sage: L.<pi> = K.extension(X^2 - 16*X + 2)
sage: L(2,absprec=3)
<repr(<sage.rings.padics.relative_ramified_CR.RelativeRamifiedCappedRelativeElement at 0x7febfb11d4d0>) failed: RuntimeError: repr_spec called on zero>
```

----
New commits:


---

Comment by git created at 2018-07-23 22:25:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-23 23:46:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-24 23:30:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-24 23:50:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by roed created at 2018-07-25 00:00:22

Changing status from new to needs_review.


---

Comment by roed created at 2018-07-25 00:00:22

All tests pass on our machines.  Sending it to the patchbots.


---

Comment by caruso created at 2018-07-25 12:32:38

There's still a bug with shifting:


```
sage: W.<a> = Zq(2^10,3)
sage: S.<x> = W[]
sage: OL.<pi> = W.extension(x^2 - 2*a*x + 2)
sage: OL(1) >> 1
a + pi + pi^3 + a*pi^4 + O(pi^5)
```


The last answer should be `0`, I guess.

In any case, results are not coherent:


```
sage: (OL(1) >> 1) >> 1
(a^2 + 1) + a*pi + pi^2 + O(pi^4)
sage: OL(1) >> 2
O(pi^4)
```



---

Comment by git created at 2018-07-25 13:39:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-25 13:47:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-25 19:10:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-26 05:56:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by caruso created at 2018-07-26 21:52:18

I've found--and fixed--some bugs.

I'm not satisfied with this ticket. Positive review for me when patchbot is happy.
----
Last 10 new commits:


---

Comment by git created at 2018-07-26 22:34:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-26 22:42:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-26 22:50:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-27 03:15:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-27 16:38:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-27 17:33:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by caruso created at 2018-07-28 00:20:45

All tests pass! (But several plugins failed.)

We're almost done!
----
New commits:


---

Comment by roed created at 2018-07-28 05:50:55

I think we're planning on ignoring the pyflakes plugin; that's a task for another ticket.

We did leave in the `_unit` debugging method for `relative_ramified_FP.pyx`.  That should either get removed or documented.

I can finish this off in the next few days if you don't get a chance before your flight.


---

Comment by git created at 2018-07-28 08:59:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by caruso created at 2018-07-28 09:01:46

I removed the method `_unit`.

The plugin `startup_module` says:

```
startup_modules Failed
startup_modules -- 3 seconds
```

but I don't understand what's the problem.
----
New commits:


---

Comment by caruso created at 2018-07-29 15:54:43

The latest patchbot report reports failures, but I think that they are not related to this ticket. Do you agree?


---

Comment by roed created at 2018-07-29 17:21:45

Changing status from needs_review to positive_review.


---

Comment by roed created at 2018-07-29 17:21:45

I agree.  And the startup_module is just checking that new modules aren't unintentionally added to Sage when they shouldn't be.  Since we're intending to, it's no problem.

I think we're all set!


---

Comment by vbraun created at 2018-08-09 21:28:03

Resolution: fixed
