# Issue 24554: py3: fix tests in sage.structure.unique_representation

archive/issues_024554.json:
```json
{
    "body": "Keywords: python3, richcmp\n\nOn one hand, we might still want to test `__cmp__` with this code on Python 2.  On the other hand, I think we'll be replacing most/all `__cmp__` methods anyways, so maybe it doesn't matter.  The comparison implementation itself is also not critical to how `UniqueRepresentation` works.\n\nI'm fine with either way.\n\nIssue created by migration from https://trac.sagemath.org/ticket/24791\n\n",
    "closed_at": "2018-03-22T19:22:53Z",
    "created_at": "2018-02-20T13:23:49Z",
    "labels": [
        "component: python3",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "py3: fix tests in sage.structure.unique_representation",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24554",
    "user": "https://github.com/embray"
}
```
Keywords: python3, richcmp

On one hand, we might still want to test `__cmp__` with this code on Python 2.  On the other hand, I think we'll be replacing most/all `__cmp__` methods anyways, so maybe it doesn't matter.  The comparison implementation itself is also not critical to how `UniqueRepresentation` works.

I'm fine with either way.

Issue created by migration from https://trac.sagemath.org/ticket/24791





---

archive/issue_comments_344137.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-20T13:24:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344137",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344138.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-20T13:25:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344138",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344139.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-02-20T13:25:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344139",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_344140.json:
```json
{
    "body": "This code looks strange:\n\n```\n        ....:         if op in (op_EQ, op_NE):\n        ....:             if type(self) != type(other):\n        ....:                 return op == op_NE\n```\nI wouldn't write that in an example. Would it work to do\n\n```\n        ....:         if type(self) is not type(other):\n        ....:             return NotImplemented\n```",
    "created_at": "2018-02-20T13:55:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344140",
    "user": "https://github.com/jdemeyer"
}
```

This code looks strange:

```
        ....:         if op in (op_EQ, op_NE):
        ....:             if type(self) != type(other):
        ....:                 return op == op_NE
```
I wouldn't write that in an example. Would it work to do

```
        ....:         if type(self) is not type(other):
        ....:             return NotImplemented
```



---

archive/issue_comments_344141.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-02-20T13:55:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344141",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_344142.json:
```json
{
    "body": "The docs are no longer consistent with the example. I actually think it's best to just remove the `__cmp__` completely (instead of replacing it with `__richcmp__`) and then also remove the talk about custom comparison methods from the docs.",
    "created_at": "2018-02-20T19:16:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344142",
    "user": "https://github.com/jdemeyer"
}
```

The docs are no longer consistent with the example. I actually think it's best to just remove the `__cmp__` completely (instead of replacing it with `__richcmp__`) and then also remove the talk about custom comparison methods from the docs.



---

archive/issue_comments_344143.json:
```json
{
    "body": "Just FYI: this conflicts with #19628",
    "created_at": "2018-02-20T19:18:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344143",
    "user": "https://github.com/jdemeyer"
}
```

Just FYI: this conflicts with #19628



---

archive/issue_comments_344144.json:
```json
{
    "body": "Replying to [comment:5 jdemeyer]:\n> The docs are no longer consistent with the example. I actually think it's best to just remove the `__cmp__` completely (instead of replacing it with `__richcmp__`) and then also remove the talk about custom comparison methods from the docs.\n\n\nThat did seem out of place to me as well.  Beyond `__eq__` the talk of other comparison operators doesn't seem relevant, but I wasn't sure.\n\nTo be clear, you're just talking about the second example, and ensuing discussion of comparison methods, right?  In the first example the `__eq__`, at least, is still necessary.\n\nI ask just because, while I understand what this class does on its own, I wasn't sure if there was some subtlety of how it's used in Sage that necessitated this documentation.",
    "created_at": "2018-02-21T11:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344144",
    "user": "https://github.com/embray"
}
```

Replying to [comment:5 jdemeyer]:
> The docs are no longer consistent with the example. I actually think it's best to just remove the `__cmp__` completely (instead of replacing it with `__richcmp__`) and then also remove the talk about custom comparison methods from the docs.


That did seem out of place to me as well.  Beyond `__eq__` the talk of other comparison operators doesn't seem relevant, but I wasn't sure.

To be clear, you're just talking about the second example, and ensuing discussion of comparison methods, right?  In the first example the `__eq__`, at least, is still necessary.

I ask just because, while I understand what this class does on its own, I wasn't sure if there was some subtlety of how it's used in Sage that necessitated this documentation.



---

archive/issue_comments_344145.json:
```json
{
    "body": "Yes, I was talking about the example with the `\"custom cmp\"`",
    "created_at": "2018-02-21T12:34:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344145",
    "user": "https://github.com/jdemeyer"
}
```

Yes, I was talking about the example with the `"custom cmp"`



---

archive/issue_comments_344146.json:
```json
{
    "body": "Replying to [comment:6 jdemeyer]:\n> Just FYI: this conflicts with #19628\n\n\nThat ticket looks like it's been sitting around for quite a while. Is it something I could be of help with?",
    "created_at": "2018-02-21T13:01:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344146",
    "user": "https://github.com/embray"
}
```

Replying to [comment:6 jdemeyer]:
> Just FYI: this conflicts with #19628


That ticket looks like it's been sitting around for quite a while. Is it something I could be of help with?



---

archive/issue_comments_344147.json:
```json
{
    "body": "Replying to [comment:9 embray]:\n> Is it something I could be of help with?\n\n\nIt just needs review...",
    "created_at": "2018-02-21T13:04:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344147",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:9 embray]:
> Is it something I could be of help with?


It just needs review...



---

archive/issue_comments_344148.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-21T13:33:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344148",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344149.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-21T13:35:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344149",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344150.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-02-21T13:37:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344150",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_344151.json:
```json
{
    "body": "Merged in #19628 and removed the custom comparison examples.  In the end the only change needed for Python 3 is to replace the one `__cmp__` in the example for `CachedRepresentation` with `__eq__`, which makes more sense anyways.",
    "created_at": "2018-02-21T13:37:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344151",
    "user": "https://github.com/embray"
}
```

Merged in #19628 and removed the custom comparison examples.  In the end the only change needed for Python 3 is to replace the one `__cmp__` in the example for `CachedRepresentation` with `__eq__`, which makes more sense anyways.



---

archive/issue_comments_344152.json:
```json
{
    "body": "We should keep the test for `!=`",
    "created_at": "2018-03-11T07:47:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344152",
    "user": "https://github.com/fchapoton"
}
```

We should keep the test for `!=`



---

archive/issue_comments_344153.json:
```json
{
    "body": "That's a good point.",
    "created_at": "2018-03-12T14:52:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344153",
    "user": "https://github.com/embray"
}
```

That's a good point.



---

archive/issue_comments_344154.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-03-12T14:52:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344154",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_344155.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-12T14:54:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344155",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344156.json:
```json
{
    "body": "Changing keywords from \"\" to \"python3, richcmp\".",
    "created_at": "2018-03-14T18:59:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344156",
    "user": "https://github.com/fchapoton"
}
```

Changing keywords from "" to "python3, richcmp".



---

archive/issue_comments_344157.json:
```json
{
    "body": "is this back to needs_review ?",
    "created_at": "2018-03-14T19:00:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344157",
    "user": "https://github.com/fchapoton"
}
```

is this back to needs_review ?



---

archive/issue_comments_344158.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-03-15T13:19:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344158",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_344159.json:
```json
{
    "body": "I will assume so.",
    "created_at": "2018-03-15T13:19:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344159",
    "user": "https://github.com/fchapoton"
}
```

I will assume so.



---

archive/issue_comments_344160.json:
```json
{
    "body": "This sentence still makes no sense to me (see [comment:5]):\n\n```\nFor other\ncomparisons, the relevant custom comparison is called if defined for either\nthe left-hand side or the right-hand side::\n```",
    "created_at": "2018-03-16T09:28:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344160",
    "user": "https://github.com/jdemeyer"
}
```

This sentence still makes no sense to me (see [comment:5]):

```
For other
comparisons, the relevant custom comparison is called if defined for either
the left-hand side or the right-hand side::
```



---

archive/issue_comments_344161.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-03-16T09:28:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344161",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_344162.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-03-16T12:53:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344162",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_344163.json:
```json
{
    "body": "Could you clarify?  I think the sentence itself makes sense; or is at least true. If anything doesn't make sense it might just be the placement. I.e. the examples that immediately follow that sentence isn't really relevant (the sentence is more a modification to the previous sentence, to which the examples due apply).  \n\nMaybe if it were moved later?  I wouldn't outright remove it--the point is just to say that other custom comparisons may still be implemented on classes that subclass from this.",
    "created_at": "2018-03-16T12:53:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344163",
    "user": "https://github.com/embray"
}
```

Could you clarify?  I think the sentence itself makes sense; or is at least true. If anything doesn't make sense it might just be the placement. I.e. the examples that immediately follow that sentence isn't really relevant (the sentence is more a modification to the previous sentence, to which the examples due apply).  

Maybe if it were moved later?  I wouldn't outright remove it--the point is just to say that other custom comparisons may still be implemented on classes that subclass from this.



---

archive/issue_comments_344164.json:
```json
{
    "body": "What are \"other comparisons\" in that sentence?",
    "created_at": "2018-03-16T13:10:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344164",
    "user": "https://github.com/jdemeyer"
}
```

What are "other comparisons" in that sentence?



---

archive/issue_comments_344165.json:
```json
{
    "body": "`<` `>` `<=` `>=`?",
    "created_at": "2018-03-16T13:23:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344165",
    "user": "https://github.com/embray"
}
```

`<` `>` `<=` `>=`?



---

archive/issue_comments_344166.json:
```json
{
    "body": "OK, but then what is \"the relevant custom comparison\"?",
    "created_at": "2018-03-16T13:26:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344166",
    "user": "https://github.com/jdemeyer"
}
```

OK, but then what is "the relevant custom comparison"?



---

archive/issue_comments_344167.json:
```json
{
    "body": "I would just remove that sentence completely.",
    "created_at": "2018-03-16T13:27:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344167",
    "user": "https://github.com/jdemeyer"
}
```

I would just remove that sentence completely.



---

archive/issue_comments_344168.json:
```json
{
    "body": "Okay... I don't really see a problem with it other than what I explained above, but I can certainly live without it as well.",
    "created_at": "2018-03-16T13:34:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344168",
    "user": "https://github.com/embray"
}
```

Okay... I don't really see a problem with it other than what I explained above, but I can certainly live without it as well.



---

archive/issue_comments_344169.json:
```json
{
    "body": "If that sentence is meant to say that you can subclass `CachedRepresentation` and add your own rich comparison methods, it's saying that very badly. It's also superfluous since that's how subclassing in Python works in general.",
    "created_at": "2018-03-16T13:36:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344169",
    "user": "https://github.com/jdemeyer"
}
```

If that sentence is meant to say that you can subclass `CachedRepresentation` and add your own rich comparison methods, it's saying that very badly. It's also superfluous since that's how subclassing in Python works in general.



---

archive/issue_comments_344170.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-16T13:43:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344170",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344171.json:
```json
{
    "body": "Replying to [comment:27 jdemeyer]:\n> It's also superfluous since that's how subclassing in Python works in general.\n\n\nI agree that it's superfluous, but so is a lot of the other text in there. I figured it was worth pointing out for those who aren't completely comfortable how subclassing works w.r.t. comparisons (heck, I'm not even completely comfortable with it, if recent experience dictates).\n\nSo it's saying \"these objects have this specific type of behavior when it comes to identity comparisons, but may still have any other behavior w.r.t. ordering behavior\".  But I don't think it's too important to say that either.",
    "created_at": "2018-03-16T13:46:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344171",
    "user": "https://github.com/embray"
}
```

Replying to [comment:27 jdemeyer]:
> It's also superfluous since that's how subclassing in Python works in general.


I agree that it's superfluous, but so is a lot of the other text in there. I figured it was worth pointing out for those who aren't completely comfortable how subclassing works w.r.t. comparisons (heck, I'm not even completely comfortable with it, if recent experience dictates).

So it's saying "these objects have this specific type of behavior when it comes to identity comparisons, but may still have any other behavior w.r.t. ordering behavior".  But I don't think it's too important to say that either.



---

archive/issue_comments_344172.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-03-16T14:01:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344172",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_062319.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-03-22T19:22:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24554#event-62319"
}
```



---

archive/issue_comments_344173.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-03-22T19:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24554#issuecomment-344173",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
