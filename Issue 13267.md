# Issue 13267: padic xgcd incorrect

Issue created by migration from Trac.

Original creator: saraedum

Original creation time: 2012-09-07 18:55:38

Assignee: roed

Keywords: gcd

`xgcd` is broken for padics:


```
sage: R.<x> = Qp(3,3)[]
sage: f = 3*x + 7
sage: g = 5*x + 9
sage: f.xgcd(f*g)[0].is_one()
True

sage: R.<x> = Qp(3)[]
sage: f = 490473657*x + 257392844/729
sage: g = 225227399/59049*x - 8669753175
sage: f.xgcd(f*g)[0].is_one()
True
```


The algorithm used is the standard Euclidean algorithm which is afaik not correct for inexact fields.


---

Comment by saraedum created at 2012-09-07 19:12:06

The only place where the doctests called that xgcd was in the padic L-series. I disabled the calls there until we have a working xgcd for padics.


---

Comment by saraedum created at 2012-09-26 14:15:45

Replying to [comment:1 saraedum]:
> The only place where the doctests called that xgcd was in the padic L-series. I disabled the calls there until we have a working xgcd for padics.

Just found out about stopgaps. A stopgap makes of course much more sense than just removing functionality.


---

Attachment


---

Comment by roed created at 2012-10-24 09:08:20

This is great.  I could never get up the motivation to fix this since I always wanted to fix so many other things about p-adic polynomials first.  I'll review it once the prerequisites are finished.


---

Comment by niles created at 2014-01-27 21:38:32

rebased and converted to git branch; no other changes
----
New commits:


---

Comment by git created at 2014-01-28 16:08:08

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by niles created at 2014-01-28 16:13:41

I am working on this in an attempt to resolve #9457.  Bug-hunting there triggers the stopgap for this ticket (see comment 12 there).  I have now created git branches for all of this ticket's dependencies and merged them here.  Unfortunately the tests in this ticket description now trigger an error:


```
sage: R.<x> = Qp(3,3)[]
sage: f = 3*x + 7
sage: g = 5*x + 9
sage: f.xgcd(f*g)[0].is_one()

Traceback (most recent call last)
...
TypeError: _xgcd_univariate_polynomial() takes exactly 2 arguments (3 given)
```


So there are some problems here, possibly caused by my rebasing . . .


---

Comment by git created at 2014-01-29 19:25:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by niles created at 2014-01-29 19:27:55

After a change in #13629, this seems to be working correctly and giving the output written in the examples/tests.  But the main examples on this ticket description are still broken.


---

Comment by wuthrich created at 2016-03-23 09:28:06

I work on #20254. The solution there will avoid the use of xgcd for p-adic L-functions.
----
New commits:


---

Comment by @EnderWannabe created at 2020-06-26 18:41:35

As of today, the main examples in this ticket all work. However, xgcd itself is still broken. Examples can be found by search:


```
sage: R = PolynomialRing(Qp(5), 'x')
sage: while True:
sage:    f,g = R.random_element(degree=3), R.random_element(degree=3)
sage:    d,a,b = xgcd(f,g)
sage:    if a*f + b*g != d:
sage:        print("d =", d)
sage:        print("a =", a)
sage:        print('f = ', f)
sage:        print('b = ', b)
sage:        print('g = ', g)
sage:        break

d = 1 + O(5^2)
a = (3*5^41 + O(5^43))*x^2 + (3*5^14 + O(5^16))*x + 2*5^11 + 3*5^12 + O(5^13)
f =  (4*5^-1 + 2 + 2*5 + 5^2 + 4*5^3 + 2*5^4 + 3*5^5 + 4*5^7 + 2*5^8 + 2*5^9 + 4*5^10 + 3*5^11 + 2*5^12 + 4*5^15 + 5^16 + 5^17 + 3*5^18 + O(5^19))*x^3 + (4*5^-12 + 2*5^-11 + 5^-9 + 2*5^-8 + 4*5^-5 + 3*5^-4 + 4*5^-3 + 2*5^-2 + 5^-1 + 1 + 5 + 3*5^2 + 3*5^3 + 2*5^4 + 2*5^5 + 3*5^6 + O(5^7))*x^2 + (5 + 5^2 + 2*5^3 + 5^4 + 2*5^5 + 5^6 + 4*5^7 + 2*5^8 + 4*5^9 + 5^10 + 2*5^11 + 5^12 + 3*5^13 + 5^14 + 3*5^15 + 2*5^17 + 2*5^18 + 5^19 + 4*5^20 + O(5^21))*x + 3*5^-5 + 5^-2 + 5^-1 + 4*5 + 4*5^2 + 4*5^4 + 2*5^5 + 5^6 + 5^8 + 2*5^9 + 2*5^10 + 3*5^11 + 2*5^12 + 5^13 + 3*5^14 + O(5^15)
b =  (4*5^14 + O(5^16))*x^2 + O(5^-11)*x + O(5^-38)
g =  (2*5^26 + 4*5^28 + 5^29 + 2*5^31 + 2*5^32 + 5^35 + 4*5^36 + 5^37 + 3*5^38 + 5^39 + 3*5^40 + 5^41 + 3*5^42 + 3*5^43 + 5^44 + O(5^45))*x^3 + (2*5^-1 + 5 + 5^4 + 4*5^6 + 2*5^7 + 4*5^8 + 2*5^9 + 5^10 + 5^11 + 5^13 + 4*5^14 + 5^17 + 2*5^18 + O(5^19))*x^2 + (5^3 + 2*5^4 + 2*5^5 + 3*5^6 + 4*5^7 + 4*5^8 + 4*5^9 + 3*5^10 + 2*5^11 + 2*5^15 + 2*5^16 + 4*5^17 + 3*5^18 + 4*5^19 + O(5^21))*x + 1 + 4*5 + 4*5^3 + 3*5^4 + 3*5^5 + 4*5^7 + 3*5^8 + 5^9 + 5^11 + 2*5^12 + 5^13 + 2*5^14 + 4*5^15 + 4*5^17 + 5^18 + 3*5^19 + O(5^20)
```

