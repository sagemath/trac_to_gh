# Issue 34393: Switch sagelib's build system from setuptools to meson-python / ninja

Issue created by migration from https://trac.sagemath.org/ticket/34630

Original creator: mkoeppe

Original creation time: 2022-10-02 22:04:54

CC:  dimpase klee

(from #32874#comment:27)

SciPy has switched to meson-python / ninja (see #34081).
See for example https://github.com/scipy/scipy/blob/main/scipy/linalg/meson.build; this replaces older infrastructure like https://github.com/scipy/scipy/blob/main/tools/cythonize.py

Cython recently added the `--depfile` switch 
- https://github.com/cython/cython/pull/4949 (`cython --depfile`)

This finally enables build systems to do their own dependency tracking (caching dependencies in depfiles) instead of passing all source files to Cython - where it takes a good chunk of the time for a trivial `./sage -b` (https://trac.sagemath.org/ticket/32874#comment:27).

What is needed is to make use of `cython --depfile` in meson:
- https://github.com/mesonbuild/meson/issues/9049 (Cython dep handling)

Then we can switch from setuptools to meson-python. We would continue to use our own package/module discovery code (`sage_setup.find`).


---

Comment by dimpase created at 2022-11-01 12:01:06

good idea.
