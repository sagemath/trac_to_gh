# Issue 24646: Endless symbolic computation

Issue created by migration from Trac.

Original creator: ipasquinelli

Original creation time: 2018-03-02 09:45:07

CC:  rws vdelecroix

Keywords: days93

I tried calculating 


```

a=e^(I*pi/4)+1
b=1-e^(I*pi/4)
a*b

```


and both expressions a*b and a/b don't stop computing.


---

Comment by vdelecroix created at 2018-03-02 09:47:42

Could you add your architecture/sage version in the ticket description? I can confirm the behavior on archlinux with compiled sage-8.2.beta6.


---

Comment by vdelecroix created at 2018-03-02 09:48:29

Alternative computation that terminates:

```
UCF = UniversalCyclotomicField()
a = UCF.zeta(8) + 1
b = 1 - UCF.zeta(8)
a * b
```



---

Comment by sdrewitz created at 2018-03-02 13:19:32

I can confirm it on archlinux with compiled sage-8.2.beta6, sage-8.2.beta5 and sage-8.1.
However, with the sagemath 8.1-11 from the archlinux community repository it does work.



```
sage: a = 1 + e^(I*pi/4)
sage: b = 1 - e^(I*pi/4)
sage: a*b
1/4*((I + 1)*sqrt(2) - 2)*(-(I + 1)*sqrt(2) - 2)
sage: a/b
-1/2*(-(I + 1)*sqrt(2) - 2)/(-(1/2*I + 1/2)*sqrt(2) + 1)

```



---

Comment by rws created at 2018-03-02 13:45:53

Confirmed in beta6. The loop is in Pynac. Thanks for the report.


---

Comment by rws created at 2018-03-02 14:19:13

Actually there were changes in pynac-0.7.17 that appear to have fixed it. With #24838:

```
sage:  sage: a = 1 + e^(I*pi/4)
....:  sage: b = 1 - e^(I*pi/4)
....:  sage: a*b
....: 
1/4*((I + 1)*sqrt(2) - 2)*(-(I + 1)*sqrt(2) - 2)
```

We might doctest this in this ticket, though.


---

Comment by vdelecroix created at 2018-03-02 14:20:47

Replying to [comment:6 rws]:
> Actually there were changes in pynac-0.7.17 that appear to have fixed it. With #24838:

Cool

> We might doctest this in this ticket, though.

+1


---

Comment by vdelecroix created at 2018-03-02 14:23:07

Ralf, Irene is working on this ticket (she is learning how to develop). We will have a branch in a minute. Thanks for pointing #24838.


---

Comment by ipasquinelli created at 2018-03-02 15:30:04

Changing status from new to needs_review.


---

Comment by ipasquinelli created at 2018-03-02 15:30:04

New commits:


---

Comment by rws created at 2018-03-03 08:42:26

I think this is fine, but we may have to wait for setting positive until #24838 gets positive.


---

Comment by rws created at 2018-07-01 06:56:05

Okay, the dependency #24838 is now in the develop branch. Your branch no longer merges because there were further changes in the dependency. Instead of merging them I created a fresh branch with only your commit (using `git cherry-pick`).
----
New commits:


---

Comment by tscrim created at 2018-07-01 07:20:04

Changing keywords from "days93" to "days93, days94".


---

Comment by tscrim created at 2018-07-01 07:20:04

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2018-07-01 07:20:04

LGTM.


---

Comment by vbraun created at 2018-07-05 22:19:13

see patchbot


---

Comment by vbraun created at 2018-07-05 22:19:13

Changing status from positive_review to needs_work.


---

Comment by tscrim created at 2018-07-05 23:09:58

Problem actually comes from an earlier doctest:

```
sage: e = x+1 <= x-2
```

(I tested this by copy/pasting the doctest).
So we probably need to use `exp`.


---

Comment by git created at 2018-07-06 05:35:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2018-07-06 05:36:01

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2018-08-03 19:20:18

update milestone 8.3 -> 8.4


---

Comment by tscrim created at 2018-08-04 07:43:51

Forgot about this. LGTM.


---

Comment by tscrim created at 2018-08-04 07:43:51

Changing status from needs_review to positive_review.


---

Comment by git created at 2018-08-04 11:01:10

Changing status from positive_review to needs_review.


---

Comment by git created at 2018-08-04 11:01:10

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by @bryangingechen created at 2018-08-04 11:02:42

Replying to [comment:21 git]:
> Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
> ||[4d0c51e](https://git.sagemath.org/sage.git/commit/?id=4d0c51eab2f477499b6f7c64b5e7d179f8063cf2)||`Merge with sage-8.3`||

I fixed a trivial merge conflict with 8.3.


---

Comment by @bryangingechen created at 2018-08-04 11:02:42

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-08-06 15:13:09

Resolution: fixed
