# Issue 18876: LatticePoset: Return type category of product()

Issue created by migration from Trac.

Original creator: jmantysalo

Original creation time: 2015-08-31 07:37:05

CC:  ncohen

Keywords: poset, latticeposet


```
L = LatticePoset({1:[]})
L2 = L.product(L)
L3 = L.ordinal_product(L)
type(L) == type(L2), type(L) == type(L3)
```


outputs `(False, True)`.

(Also the docstring needs some polishing, at least oneliner to "Return the cartesian product of the poset with `other`.")


---

Comment by jmantysalo created at 2015-08-31 07:37:51

Changing type from PLEASE CHANGE to defect.


---

Comment by jmantysalo created at 2015-08-31 07:53:00

Nicolas, you might be interested in this. `type(L2)` says `sage.combinat.posets.lattices.FiniteLatticePoset_with_category` but `L2.category()` gives Join of Category of finite _posets_ and Category of finite enumerated sets and Category of facade sets, whereas the category of `L3` is Join of Category of finite _lattice_ posets and Category of finite enumerated sets and Category of facade sets.

I don't know if there is anything to do to prevent this kind of errors. The error appears with `L2.join_irreducibles()`, but `L2.join_matrix()` works.


---

Comment by tscrim created at 2015-08-31 15:12:37

The difference is in the constructions, `product` goes through `FiniteLatticePoset` whereas `ordinal_product` goes through `LatticePoset` (which sets category). So it's a code path problem, not anything with the categories.

IMO, one should implement an `__init__` method for each of `*LatticePoset` classes which handles telling `Poset` which category to use. I'm not so much in favor of these construction functions because they cause problems exactly like this one.


---

Comment by jmantysalo created at 2015-09-01 06:04:24

Replying to [comment:3 tscrim]:
> The difference is in the constructions, `product` goes through `FiniteLatticePoset` whereas `ordinal_product` goes through `LatticePoset` (which sets category). So it's a code path problem, not anything with the categories.

OK. Corrected that.

> IMO, one should implement an `__init__` method for each of `*LatticePoset` classes which handles telling `Poset` which category to use. I'm not so much in favor of these construction functions because they cause problems exactly like this one.

Should this be part of #18776?

This is now ready for review. I corrected the bug, added the definition of the function and added a test.

Also there is non-relating change that rearranges the functions in the "Other & not yet classified" part of index and changes some phrasing.
----
New commits:


---

Comment by jmantysalo created at 2015-09-01 06:04:24

Changing status from new to needs_review.


---

Comment by jmantysalo created at 2015-09-14 12:22:21

Travis, do you happen to have time for this?


---

Comment by tscrim created at 2015-09-15 19:40:31

Some questions/comments.

- You've not added any tests which check that this is fixed.
- Cartesian should be capitalized.
- Why did you make all of the changes to the table of methods?

Also I'm not going to set a positive review on tickets that change ```self``` to `this poset` (that's not to say I'm not going to allow a positive review, but it's my somewhat mild form of protest).


---

Comment by jmantysalo created at 2015-09-16 06:08:58

Replying to [comment:7 tscrim]:

> - You've not added any tests which check that this is fixed.
> - Cartesian should be capitalized.

OK, I'll do these.

> - Why did you make all of the changes to the table of methods?

Because it is more logical to have for example `comparability_graph()` and `comparability_graph()` together and `promotion()` and `evacuation()` as a pair. All changes are for "uncategorized" functions at the index.

> Also I'm not going to set a positive review on tickets that change ```self``` to `this poset` (that's not to say I'm not going to allow a positive review, but it's my somewhat mild form of protest).

Duh. Can you make a patch to convert all `the poset` and `this poset` to ```self```? Maybe a year ago I was pointed to style guide that adviced against `self`. But almost everything is OK for me, as long as it is uniform accross the software.


---

Comment by git created at 2015-09-16 08:37:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2015-09-16 08:39:47

Corrected. Hopefully Travis can review this, even if the patch has the `self` -> "the" -change.


---

Comment by jmantysalo created at 2015-09-24 14:26:35

Nicolas? As Travis won't review this, can you do it?


---

Comment by git created at 2015-11-09 10:57:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2015-11-09 10:58:55

Changing status from needs_review to needs_work.


---

Comment by jmantysalo created at 2015-11-09 10:58:55

Merge. Compiling and running tests.

Also I moved `kazhdan_lusztig_polynomial` to right place in the index of functions.


---

Comment by jmantysalo created at 2015-11-09 14:01:04

Tests passed.


---

Comment by jmantysalo created at 2015-11-09 14:01:04

Changing status from needs_work to needs_review.


---

Comment by jmantysalo created at 2015-11-12 12:04:20

Nathann maybe? The bug is clear and patch is simple. Othewise this rearranges index of not classified functions so that for example `comparability_graph()` is near to `incomparability_graph()`. But nobody have had time to look at this.


---

Comment by ncohen created at 2015-11-12 12:53:58

> Nathann maybe?

I am not the 'reviewer by default'.

About your patch: is there a reason why you don't want to use the automatically generated index of functions?

Nathann


---

Comment by jmantysalo created at 2015-11-12 13:07:51

Replying to [comment:16 ncohen]:

> I am not the 'reviewer by default'.

I know, I have tried to ping other people. With no success, as you can see.

> About your patch: is there a reason why you don't want to use the automatically generated index of functions?

No. Just that I must learn to use it (at the process of reviewing the ticket where you extend it). And that I try to convert using it when there is not much other tickets waiting for this file.


---

Comment by ncohen created at 2015-11-12 13:20:58

Changing status from needs_review to positive_review.


---

Comment by jmantysalo created at 2015-11-12 13:37:35

Thanks. Next time I try harder to get someone else to review.


---

Comment by vbraun created at 2015-11-12 22:44:29

Resolution: fixed
