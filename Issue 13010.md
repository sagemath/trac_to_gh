# Issue 13010: Update sage-mode to 0.8

Issue created by migration from https://trac.sagemath.org/ticket/13182

Original creator: iandrus

Original creation time: 2012-06-29 14:10:19

Assignee: was

CC:  hivert bump jpflori

Keywords: sage-mode

After updating to 0.7 in #13176 we should move into the future with 0.8 which will be released soon.

There is an experimental 0.8 spkg at http://boxen.math.washington.edu/home/iandrus/sage_mode-0.8.spkg

Currently the major goal is to support python.el by fgallina which will be in Emacs 24.2.


---

Comment by iandrus created at 2012-09-12 11:26:33

I have released sage-mode 0.8, so I'm marking this as needs review.  Please reinstall the sage_mode spkg from the link in the description before reviewing.


---

Comment by iandrus created at 2012-09-12 11:26:33

Changing status from new to needs_review.


---

Comment by ddrake created at 2012-11-24 19:07:49

If nothing else, I'm happy that the name of the spkg now has an underscore (`sage_mode` instead of `sage-mode`). This may seem unimportant, but the usual "`sage -i`" command gets confused when the spkg name has a hyphen in it (some script splits on the hyphen to separate the name from the version number). So thanks for the name change!

I'll look over the spkg but my elisp knowledge is probably too minimal to properly review this, and I'm also stuck with Emacs 23 for now.


---

Comment by iandrus created at 2012-11-24 21:17:32

Since this is technically an upstream package (and still optional) I don't know that you need to check the elisp so much as just make sure that it installs, and works correctly.  Though of course feedback on the elisp is welcome too.  

There is a known issue with new versions of Sage [and pretty printing output](https://bitbucket.org/gvol/sage-mode/issue/12/support-new-version-of-html-pretty-print).


---

Comment by nthiery created at 2013-03-07 02:21:03

I can confirm that 0.9 installed and ran smoothly on my machine (Ubuntu 12.04, emacs 23.3). And given that it fixes a critical issue (tab completion) with the latest version of Sage, I am all in favor for getting this in! Thanks for name change as well.


---

Comment by iandrus created at 2013-03-10 23:32:57

Changing type from enhancement to defect.


---

Comment by iandrus created at 2013-03-10 23:32:57

I have updated slightly the 0.9 package and made an official release.  Since 0.7 is broken wrt newer versions of Sage I have changed this to a defect.


---

Comment by ddrake created at 2013-03-21 00:48:56

I've installed the 0.9 spkg into 5.9.beta0 on Ubuntu 12.10 (with emacs 23.4) and things seem to work fine. I'm going to try with emacs 24 and report how that works.


---

Comment by ddrake created at 2013-03-21 18:12:16

The AUCTeX integration is great! But I do notice one problem with emacs 24:

If you don't have org-mode installed and you load a TeX file -- with or without any Sage stuff in it -- I get "Can't find library org". If I then install org-mode, loading a TeX file gives `File mode specification error: (void-function loop)`.

This is with the current state of Ubuntu 13.04: emacs 24.2, AUCTeX 11.87 and org-mode 7.9.2. In Ubuntu 12.10 (versions 23.4, 11.86, 7.8.11, respectively) things work fine.


---

Comment by iandrus created at 2013-03-21 20:09:52

The `loop` problem is because I forgot to require `cl` at compile time.  I'm not sure why loading a tex file asks for org--it definitely shouldn't.  I tried it real fast, but I couldn't reproduce it.  If you uninstall org and set `debug-on-error` do you get a backtrace?


---

Comment by iandrus created at 2013-03-22 03:42:14

I have a fix for the `loop` issue up [on bitbucket](https://bitbucket.org/gvol/sage-mode/downloads/sage_mode-0.9.1.spkg) (not sure why I didn't think of hosting spkg's there before).


---

Comment by ddrake created at 2013-03-22 16:16:29

Backtrace for the problem when org isn't installed: http://boxen.math.washington.edu/home/drake/13182load-tex-file-backtrace.txt . Your 0.9.1 spkg fixes the `loop` problem when I have org-mode installed in emacs 24.


---

Comment by iandrus created at 2013-03-22 19:24:10

Replying to [comment:13 ddrake]:
> Backtrace for the problem when org isn't installed: http://boxen.math.washington.edu/home/drake/13182load-tex-file-backtrace.txt . Your 0.9.1 spkg fixes the `loop` problem when I have org-mode installed in emacs 24.

This seems to be a bug in org-mode (the version that's shipped with your emacs).  It's finding some org files (in particular org-latex), but can't actually `(require 'org)`.  Normally org wouldn't be loaded at run time, only at compile time, but since byte-compilation failed (due to this error), it also occurred at run time.  I have updated the spkg on bitbucket to work around this issue (I hope). 

Thanks for testing.


---

Comment by nthiery created at 2013-03-29 19:01:21

Hi!

Would it be possible to add

```
    (require 'help-mode)
```


See: http://www.mail-archive.com/sage-devel`@`googlegroups.com/msg41622.html

Thanks!


---

Comment by iandrus created at 2013-03-29 20:24:10

Replying to [comment:16 nthiery]:
> Hi!
> 
> Would it be possible to add
> {{{
>     (require 'help-mode)
> }}}
> 
> See: http://www.mail-archive.com/sage-devel`@`googlegroups.com/msg41622.html
> 
> Thanks!

It's on line 70 of sage-mode.el.  Are you still seeing problems?


---

Comment by nthiery created at 2013-03-29 20:50:44

Ah. I posted this after seeing an issue on Dan Bump's machine; however I did not double check he had the very latest version of the spkg. I am adding him in CC for confirmation.


---

Comment by nthiery created at 2013-04-01 13:10:12

Replying to [comment:18 nthiery]:
> Ah. I posted this after seeing an issue on Dan Bump's machine; however I did not double check he had the very latest version of the spkg. I am adding him in CC for confirmation.

I reinstalled the latest sage-mode on my machine, after removing the "require help-mode" line from my .emacs, and this indeed seems to work smootlhy. Dan, can you confirm?


---

Comment by ddrake created at 2013-04-01 16:57:29

Replying to [comment:19 nthiery]:
> I reinstalled the latest sage-mode on my machine, after removing the "require help-mode" line from my .emacs, and this indeed seems to work smootlhy. Dan, can you confirm?

I can confirm that the latest spkg works. It has a `(require 'help-mode)` line, my `.emacs` does not, and everything installs and works fine with emacs 23.


---

Comment by iandrus created at 2013-06-07 17:14:50

I hate to bug everyone, but it would be great if this could get reviewed.  I keep getting emails from people having problems and they are (understandably) still using sage-mode 0.7.  It's not uncommon that their issues are solved by simply upgrading.

Thanks, and let me know if I can review one of your tickets in exchange or something.


---

Comment by chapoton created at 2013-06-12 20:39:35

I have tried on sage 5.10.rc1, and it works fine.

In particular, tab completion works.

I had to install preview-latex-style, which is not by default on my ubuntu LTS.

I would give a positive review, but I would prefer if Nicolas or Florent confirm me !


---

Comment by iandrus created at 2013-06-12 21:24:13

Replying to [comment:23 chapoton]:
> I have tried on sage 5.10.rc1, and it works fine.
> 
> In particular, tab completion works.
> 
> I had to install preview-latex-style, which is not by default on my ubuntu LTS.
> 
> I would give a positive review, but I would prefer if Nicolas or Florent confirm me !

You mean you had to install preview.sty?  You should only need that to use sage-view to display typeset text.  But it would probably be a good idea to mention that as a requirement.  I'll add it to the next version.


---

Comment by chapoton created at 2013-06-14 07:51:32

Using the skpg with emacs 23, I have only been hurted by problems with latex compilation, which are part of other tickets, namely #14382 and #13624.

So let me give a positive review.


---

Comment by chapoton created at 2013-06-14 07:51:47

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-06-14 09:20:08

Changing component from user interface to packages: optional.


---

Comment by jdemeyer created at 2013-06-14 09:24:46

Resolution: fixed


---

Comment by schilly created at 2013-06-14 10:28:19

optional spkg is on the server


---

Comment by iandrus created at 2013-06-14 17:20:41

Replying to [comment:25 chapoton]:
> 
> Using the skpg with emacs 23, I have only been hurted by problems with latex compilation, which are part of other tickets, namely #14382 and #13624.
> 
> So let me give a positive review.

Cool, thanks!
