# Issue 10333: miscellaneous cleanup in perm_gps preparing for domains

archive/issues_010333.json:
```json
{
    "body": "Assignee: joyner\n\nCC:  sage-combinat jasonbhill\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/10334\n\n",
    "created_at": "2010-11-26T04:18:36Z",
    "labels": [
        "component: group theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7.1",
    "title": "miscellaneous cleanup in perm_gps preparing for domains",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10333",
    "user": "https://github.com/mwhansen"
}
```
Assignee: joyner

CC:  sage-combinat jasonbhill



Issue created by migration from https://trac.sagemath.org/ticket/10334





---

archive/issue_comments_105694.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-11-26T07:16:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105694",
    "user": "https://github.com/mwhansen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_105695.json:
```json
{
    "body": "Looks good! Passes all long tests.",
    "created_at": "2011-01-19T04:28:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105695",
    "user": "https://github.com/rlmill"
}
```

Looks good! Passes all long tests.



---

archive/issue_comments_105696.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-01-19T04:28:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105696",
    "user": "https://github.com/rlmill"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_026573.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-25T08:15:19Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10333#event-26573"
}
```



---

archive/issue_comments_105697.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-01-25T08:15:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105697",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_105698.json:
```json
{
    "body": "I got a test failure that seems related to this patch\n\n```\nsage -t  \"devel/sage-main/sage/groups/perm_gps/permgroup.py\"\n**********************************************************************\nFile \"/usr/share/sage/devel/sage-main/sage/groups/perm_gps/permgroup.py\", line 1876:\n    sage: G.isomorphism_to(H)\nExpected:\n    Permutation group morphism:\n      From: Permutation Group with generators [(2,3), (1,2,3)]\n      To:   Permutation Group with generators [(1,2,4), (1,4)]\n      Defn: [(2,3), (1,2,3)] -> [(2,4), (1,2,4)]\nGot:\n    Permutation group morphism:\n      From: Permutation Group with generators [(2,3), (1,2,3)]\n      To:   Permutation Group with generators [(1,2,4), (1,4)]\n      Defn: [(2,3), (1,2,3)] -> [(2,4), (1,4,2)]\n```\n",
    "created_at": "2011-01-27T08:36:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105698",
    "user": "https://github.com/kiwifb"
}
```

I got a test failure that seems related to this patch

```
sage -t  "devel/sage-main/sage/groups/perm_gps/permgroup.py"
**********************************************************************
File "/usr/share/sage/devel/sage-main/sage/groups/perm_gps/permgroup.py", line 1876:
    sage: G.isomorphism_to(H)
Expected:
    Permutation group morphism:
      From: Permutation Group with generators [(2,3), (1,2,3)]
      To:   Permutation Group with generators [(1,2,4), (1,4)]
      Defn: [(2,3), (1,2,3)] -> [(2,4), (1,2,4)]
Got:
    Permutation group morphism:
      From: Permutation Group with generators [(2,3), (1,2,3)]
      To:   Permutation Group with generators [(1,2,4), (1,4)]
      Defn: [(2,3), (1,2,3)] -> [(2,4), (1,4,2)]
```




---

archive/issue_comments_105699.json:
```json
{
    "body": "Changing status from closed to needs_work.",
    "created_at": "2011-02-03T19:40:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105699",
    "user": "https://github.com/vbraun"
}
```

Changing status from closed to needs_work.



---

archive/issue_events_026574.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2011-02-03T19:40:21Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10333#event-26574"
}
```



---

archive/issue_comments_105700.json:
```json
{
    "body": "I tripped over this patch as well (on sage-4.6.2.alpha3)\n\n```\nsage: S4 = SymmetricGroup(4)\nsage: [ g.orbits() for g in S4.conjugacy_classes_subgroups() ]\nERROR: An unexpected error occurred while tokenizing input\nThe following traceback may be corrupted or invalid\nThe error message is: ('EOF in multi-line statement', (396, 0))\n\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n\n/home/vbraun/Sage/24cell/<ipython console> in <module>()\n\n/home/vbraun/Sage/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)\n    553             return self.cache[k]\n    554         except KeyError:\n--> 555             w = self._cachedmethod._instance_call(self._instance, *args, **kwds)\n    556             self.cache[k] = w\n    557             return w\n\n/home/vbraun/Sage/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in _instance_call(self, inst, *args, **kwds)\n    776 \n    777         \"\"\"\n--> 778         return self._cachedfunc.f(inst, *args, **kwds)\n    779 \n    780     def _get_instance_cache(self, inst):\n\n/home/vbraun/Sage/sage/local/lib/python2.6/site-packages/sage/groups/perm_gps/permgroup.pyc in orbits(self)\n    952              sage: G.stabilizer(1) \n    953              Permutation Group with generators [(2,3)(4,10), (2,10,4)]\n--> 954              sage: G = PermutationGroup([[(2,3,4)],[(6,7)]])\n    955              sage: G.stabilizer(1)\n    956              Permutation Group with generators [(6,7), (2,3,4)]\n\n/home/vbraun/Sage/sage/local/lib/python2.6/site-packages/sage/groups/perm_gps/permgroup.pyc in _set_gap(self)\n    911          \"\"\"\n    912          return self._gap_().Orbit(integer).sage()\n--> 913     \n    914     def transversals(self, integer):\n    915          \"\"\"\n\n/home/vbraun/Sage/sage/local/lib/python2.6/site-packages/sage/groups/perm_gps/permgroup.pyc in set(self)\n    896         return self._gap_().Orbits(\"[1..%d]\" % self.largest_moved_point()).sage()\n    897 \n--> 898     @cached_method\n    899     def orbit(self, integer):\n    900          \"\"\"\n\n/home/vbraun/Sage/sage/local/lib/python2.6/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__getattr__ (sage/structure/parent.c:5600)()\n\n/home/vbraun/Sage/sage/local/lib/python2.6/site-packages/sage/structure/parent.so in sage.structure.parent.getattr_from_other_class (sage/structure/parent.c:2777)()\n\n/home/vbraun/Sage/sage/local/lib/python2.6/site-packages/sage/structure/parent.so in sage.structure.parent.raise_attribute_error (sage/structure/parent.c:2663)()\n\nAttributeError: 'PermutationGroup_generic_with_category' object has no attribute '_set'\n```\n\nFor reference, I'll attach a patch that reverses the changes. With the patch reversed, I get the expected output.",
    "created_at": "2011-02-03T19:40:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105700",
    "user": "https://github.com/vbraun"
}
```

I tripped over this patch as well (on sage-4.6.2.alpha3)

```
sage: S4 = SymmetricGroup(4)
sage: [ g.orbits() for g in S4.conjugacy_classes_subgroups() ]
ERROR: An unexpected error occurred while tokenizing input
The following traceback may be corrupted or invalid
The error message is: ('EOF in multi-line statement', (396, 0))

---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)

/home/vbraun/Sage/24cell/<ipython console> in <module>()

/home/vbraun/Sage/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)
    553             return self.cache[k]
    554         except KeyError:
--> 555             w = self._cachedmethod._instance_call(self._instance, *args, **kwds)
    556             self.cache[k] = w
    557             return w

/home/vbraun/Sage/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in _instance_call(self, inst, *args, **kwds)
    776 
    777         """
--> 778         return self._cachedfunc.f(inst, *args, **kwds)
    779 
    780     def _get_instance_cache(self, inst):

/home/vbraun/Sage/sage/local/lib/python2.6/site-packages/sage/groups/perm_gps/permgroup.pyc in orbits(self)
    952              sage: G.stabilizer(1) 
    953              Permutation Group with generators [(2,3)(4,10), (2,10,4)]
--> 954              sage: G = PermutationGroup([[(2,3,4)],[(6,7)]])
    955              sage: G.stabilizer(1)
    956              Permutation Group with generators [(6,7), (2,3,4)]

/home/vbraun/Sage/sage/local/lib/python2.6/site-packages/sage/groups/perm_gps/permgroup.pyc in _set_gap(self)
    911          """
    912          return self._gap_().Orbit(integer).sage()
--> 913     
    914     def transversals(self, integer):
    915          """

/home/vbraun/Sage/sage/local/lib/python2.6/site-packages/sage/groups/perm_gps/permgroup.pyc in set(self)
    896         return self._gap_().Orbits("[1..%d]" % self.largest_moved_point()).sage()
    897 
--> 898     @cached_method
    899     def orbit(self, integer):
    900          """

/home/vbraun/Sage/sage/local/lib/python2.6/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__getattr__ (sage/structure/parent.c:5600)()

/home/vbraun/Sage/sage/local/lib/python2.6/site-packages/sage/structure/parent.so in sage.structure.parent.getattr_from_other_class (sage/structure/parent.c:2777)()

/home/vbraun/Sage/sage/local/lib/python2.6/site-packages/sage/structure/parent.so in sage.structure.parent.raise_attribute_error (sage/structure/parent.c:2663)()

AttributeError: 'PermutationGroup_generic_with_category' object has no attribute '_set'
```

For reference, I'll attach a patch that reverses the changes. With the patch reversed, I get the expected output.



---

archive/issue_comments_105701.json:
```json
{
    "body": "I've added a patch \"trac_10334-permgroup_cleanup-fix-mh.patch\" which fixes the issue that Volker found.  The __init__ method is cleaned up in #10335.\n\nLet me know what the status of this ticket is.",
    "created_at": "2011-02-06T16:15:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105701",
    "user": "https://github.com/mwhansen"
}
```

I've added a patch "trac_10334-permgroup_cleanup-fix-mh.patch" which fixes the issue that Volker found.  The __init__ method is cleaned up in #10335.

Let me know what the status of this ticket is.



---

archive/issue_comments_105702.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2011-02-06T22:51:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105702",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_105703.json:
```json
{
    "body": "Works fine now! I can't reproduce Fran\u00e7ois' doctest failure. He doesn't indicate if it is on a supported platform. We should go ahead and merge this one as it apparently works on the buildbot machines.",
    "created_at": "2011-02-06T22:51:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105703",
    "user": "https://github.com/vbraun"
}
```

Works fine now! I can't reproduce Fran√ßois' doctest failure. He doesn't indicate if it is on a supported platform. We should go ahead and merge this one as it apparently works on the buildbot machines.



---

archive/issue_comments_105704.json:
```json
{
    "body": "Indeed I didn't. Turns out it is some crap I have in gap. I'll open another ticket \nif I find anything that should be fixed there. Nothing relevant to this ticket, it \njust pointed to the failure of another component.",
    "created_at": "2011-02-07T01:48:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105704",
    "user": "https://github.com/kiwifb"
}
```

Indeed I didn't. Turns out it is some crap I have in gap. I'll open another ticket 
if I find anything that should be fixed there. Nothing relevant to this ticket, it 
just pointed to the failure of another component.



---

archive/issue_comments_105705.json:
```json
{
    "body": "What's up with this ticket?  It was merged in sage-4.6.2.alpha2 and worked fine on the buildbot.\n\nI'm going to unmerge this in sage-4.6.2.alpha4 until this is sorted out.\n\nVolker: it is a very bad idea to reopen tickets which are already merged, this will cause major confusion.  At the very least, it should be discussed with the release manager (me in this case).",
    "created_at": "2011-02-07T08:58:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105705",
    "user": "https://github.com/jdemeyer"
}
```

What's up with this ticket?  It was merged in sage-4.6.2.alpha2 and worked fine on the buildbot.

I'm going to unmerge this in sage-4.6.2.alpha4 until this is sorted out.

Volker: it is a very bad idea to reopen tickets which are already merged, this will cause major confusion.  At the very least, it should be discussed with the release manager (me in this case).



---

archive/issue_comments_105706.json:
```json
{
    "body": "It just needs trac_10334-permgroup_cleanup-mh.patch and trac_10334-permgroup_cleanup-fix-mh.patch to be applied.  The first was already merged in alpha2.",
    "created_at": "2011-02-07T10:55:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105706",
    "user": "https://github.com/mwhansen"
}
```

It just needs trac_10334-permgroup_cleanup-mh.patch and trac_10334-permgroup_cleanup-fix-mh.patch to be applied.  The first was already merged in alpha2.



---

archive/issue_comments_105707.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-02-08T08:50:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105707",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_105708.json:
```json
{
    "body": "Please change the commit messages of the patches to something more descriptive (and keep in mind that the ticket number should be on the first line of the commit message).",
    "created_at": "2011-02-08T08:50:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105708",
    "user": "https://github.com/jdemeyer"
}
```

Please change the commit messages of the patches to something more descriptive (and keep in mind that the ticket number should be on the first line of the commit message).



---

archive/issue_comments_105709.json:
```json
{
    "body": "Attachment [trac_10334-permgroup_cleanup-mh.patch](tarball://root/attachments/some-uuid/ticket10334/trac_10334-permgroup_cleanup-mh.patch) by @mwhansen created at 2011-02-08 09:16:48",
    "created_at": "2011-02-08T09:16:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105709",
    "user": "https://github.com/mwhansen"
}
```

Attachment [trac_10334-permgroup_cleanup-mh.patch](tarball://root/attachments/some-uuid/ticket10334/trac_10334-permgroup_cleanup-mh.patch) by @mwhansen created at 2011-02-08 09:16:48



---

archive/issue_comments_105710.json:
```json
{
    "body": "I've fixed the commit message and combined the two patches into one.",
    "created_at": "2011-02-08T09:17:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105710",
    "user": "https://github.com/mwhansen"
}
```

I've fixed the commit message and combined the two patches into one.



---

archive/issue_comments_105711.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2011-02-08T09:17:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105711",
    "user": "https://github.com/mwhansen"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_026575.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-02-16T08:50:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10333#event-26575"
}
```



---

archive/issue_comments_105712.json:
```json
{
    "body": "Doctest error on 64-bit OS X 10.6:\n\n```\nsage -t -long  -force_lib devel/sage/sage/groups/perm_gps/permgroup.py\n**********************************************************************\nFile \"/Users/buildbot/build/sage/bsd-1/bsd_64_full/build/sage-4.6.2.rc0/devel/sage-main/sage/groups/perm_gps/permgroup.py\", line 1174:\n    sage: G.random_element()\nExpected:\n    (1,2)(4,5)\nGot:\n    (2,3)(4,5)\n**********************************************************************\n```\n",
    "created_at": "2011-02-18T08:18:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105712",
    "user": "https://github.com/jdemeyer"
}
```

Doctest error on 64-bit OS X 10.6:

```
sage -t -long  -force_lib devel/sage/sage/groups/perm_gps/permgroup.py
**********************************************************************
File "/Users/buildbot/build/sage/bsd-1/bsd_64_full/build/sage-4.6.2.rc0/devel/sage-main/sage/groups/perm_gps/permgroup.py", line 1174:
    sage: G.random_element()
Expected:
    (1,2)(4,5)
Got:
    (2,3)(4,5)
**********************************************************************
```




---

archive/issue_comments_105713.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2011-02-18T08:18:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105713",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from closed to new.



---

archive/issue_events_026576.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-02-18T08:18:13Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10333#event-26576"
}
```



---

archive/issue_comments_105714.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2011-02-18T08:18:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105714",
    "user": "https://github.com/jdemeyer"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_105715.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2011-02-18T08:18:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105715",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from major to minor.



---

archive/issue_events_026577.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-02-18T08:18:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "milestone": "sage-4.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10333#event-26577"
}
```



---

archive/issue_comments_105716.json:
```json
{
    "body": "Changing status from new to needs_work.",
    "created_at": "2011-02-18T08:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105716",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_work.



---

archive/issue_comments_105717.json:
```json
{
    "body": "FWIW, I applied this to 4.7.alpha1 with a single (easy-to-fix) hunk failure.  I could post a rebase if that is desirable.\n\nPassed all tests in sage/groups, and in particular I did not see the \"random element\" failure noted above (64-bit Ubuntu).",
    "created_at": "2011-03-16T05:21:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105717",
    "user": "https://github.com/rbeezer"
}
```

FWIW, I applied this to 4.7.alpha1 with a single (easy-to-fix) hunk failure.  I could post a rebase if that is desirable.

Passed all tests in sage/groups, and in particular I did not see the "random element" failure noted above (64-bit Ubuntu).



---

archive/issue_comments_105718.json:
```json
{
    "body": "On 4.7.rc0.\n\n1)  3 hunk failures when applying `trac_10334-permgroup_cleanup-rebase-mh.patch`, a rebase is attached.\n\n2) With rebase a quotient group fails in a doctest.  Here's the evidence:\n\nClean 4.7.rc0:\n\n\n```\nG = DihedralGroup(20)\nC = G.commutator()\nQ = G.quotient(C)\nQ.is_abelian()\n```\n\n\n4.7.rc0 with rebased patch:\n\n\n```\nsage: G = DihedralGroup(20)\nsage: C = G.commutator()\nsage: Q = G.quotient(C)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n\n/home/sage/sage-4.7.rc0/devel/sage-main/<ipython console> in <module>()\n\n/sage/sage-4.7.rc0/local/lib/python2.6/site-packages/sage/groups/perm_gps/permgroup.pyc in quotient(self, N)\n   1483         phi = Q.RegularActionHomomorphism()\n   1484         gens = phi.Image().GeneratorsOfGroup()\n-> 1485         return PermutationGroup([self(gen) for gen in gens])\n   1486\n   1487     def quotient_group(self, N):\n\n/sage/sage-4.7.rc0/local/lib/python2.6/site-packages/sage/groups/perm_gps/permgroup.pyc in __call__(self, x, check)\n    593             return self.identity()\n    594\n--> 595         return self._element_class()(x, self, check=check)\n    596\n    597     def _coerce_impl(self, x):\n\n/sage/sage-4.7.rc0/local/lib/python2.6/site-packages/sage/groups/perm_gps/permgroup_element.so in sage.groups.perm_gps.permgroup_element.PermutationGroupElement.__init__ (sage/groups/perm_gps/permgroup_element.c:3008)()\n\nTypeError: permutation (1, 2)(3, 4) not in Dihedral group of order 40 as a permutation group\n```\n\n\nI've tried to locate the error, with no luck.  My rebase could be at fault, but I've double-checked that as well.",
    "created_at": "2011-05-03T13:09:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105718",
    "user": "https://github.com/rbeezer"
}
```

On 4.7.rc0.

1)  3 hunk failures when applying `trac_10334-permgroup_cleanup-rebase-mh.patch`, a rebase is attached.

2) With rebase a quotient group fails in a doctest.  Here's the evidence:

Clean 4.7.rc0:


```
G = DihedralGroup(20)
C = G.commutator()
Q = G.quotient(C)
Q.is_abelian()
```


4.7.rc0 with rebased patch:


```
sage: G = DihedralGroup(20)
sage: C = G.commutator()
sage: Q = G.quotient(C)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/home/sage/sage-4.7.rc0/devel/sage-main/<ipython console> in <module>()

/sage/sage-4.7.rc0/local/lib/python2.6/site-packages/sage/groups/perm_gps/permgroup.pyc in quotient(self, N)
   1483         phi = Q.RegularActionHomomorphism()
   1484         gens = phi.Image().GeneratorsOfGroup()
-> 1485         return PermutationGroup([self(gen) for gen in gens])
   1486
   1487     def quotient_group(self, N):

/sage/sage-4.7.rc0/local/lib/python2.6/site-packages/sage/groups/perm_gps/permgroup.pyc in __call__(self, x, check)
    593             return self.identity()
    594
--> 595         return self._element_class()(x, self, check=check)
    596
    597     def _coerce_impl(self, x):

/sage/sage-4.7.rc0/local/lib/python2.6/site-packages/sage/groups/perm_gps/permgroup_element.so in sage.groups.perm_gps.permgroup_element.PermutationGroupElement.__init__ (sage/groups/perm_gps/permgroup_element.c:3008)()

TypeError: permutation (1, 2)(3, 4) not in Dihedral group of order 40 as a permutation group
```


I've tried to locate the error, with no luck.  My rebase could be at fault, but I've double-checked that as well.



---

archive/issue_comments_105719.json:
```json
{
    "body": "Forgot some details above.\n\nOn clean 4.7.rc0 the \"is_abelian\" returns {{{True}}.  This is a doctest that has been passing in alpha testing.\n\nOn patched version, the commutator is a subgroup, and it is normal:\n\n\n```\nsage: G = DihedralGroup(20)\nsage: C = G.commutator()\nsage: C.is_subgroup(G)\nTrue\nsage: C.is_normal(G)\nTrue\n```\n",
    "created_at": "2011-05-03T13:14:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105719",
    "user": "https://github.com/rbeezer"
}
```

Forgot some details above.

On clean 4.7.rc0 the "is_abelian" returns {{{True}}.  This is a doctest that has been passing in alpha testing.

On patched version, the commutator is a subgroup, and it is normal:


```
sage: G = DihedralGroup(20)
sage: C = G.commutator()
sage: C.is_subgroup(G)
True
sage: C.is_normal(G)
True
```




---

archive/issue_comments_105720.json:
```json
{
    "body": "Attachment [trac_10334-permgroup_cleanup-rebase-mh.patch](tarball://root/attachments/some-uuid/ticket10334/trac_10334-permgroup_cleanup-rebase-mh.patch) by @nthiery created at 2011-05-03 13:51:29\n\nFixed a remaining doctest with Rob.",
    "created_at": "2011-05-03T13:51:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105720",
    "user": "https://github.com/nthiery"
}
```

Attachment [trac_10334-permgroup_cleanup-rebase-mh.patch](tarball://root/attachments/some-uuid/ticket10334/trac_10334-permgroup_cleanup-rebase-mh.patch) by @nthiery created at 2011-05-03 13:51:29

Fixed a remaining doctest with Rob.



---

archive/issue_comments_105721.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-05-03T13:51:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105721",
    "user": "https://github.com/nthiery"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_105722.json:
```json
{
    "body": "For the record, it looks like quotients were failing because elements of the permutation group representation of the quotient were being coerced into the larger of the two groups used in the quotient construction.  Since the representation of the quotient has little connection with this larger group the changes to the `__init__` method would now notice and fail.",
    "created_at": "2011-05-03T18:09:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105722",
    "user": "https://github.com/rbeezer"
}
```

For the record, it looks like quotients were failing because elements of the permutation group representation of the quotient were being coerced into the larger of the two groups used in the quotient construction.  Since the representation of the quotient has little connection with this larger group the changes to the `__init__` method would now notice and fail.



---

archive/issue_comments_105723.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-05-03T18:12:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105723",
    "user": "https://github.com/rbeezer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_105724.json:
```json
{
    "body": "Passes all tests on 4.7.rc0 and looks good.\n\nLots of good improvements and fixes in here.  Thanks, Mike.",
    "created_at": "2011-05-03T18:12:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105724",
    "user": "https://github.com/rbeezer"
}
```

Passes all tests on 4.7.rc0 and looks good.

Lots of good improvements and fixes in here.  Thanks, Mike.



---

archive/issue_events_026578.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-05-03T18:12:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "milestone": "sage-4.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10333#event-26578"
}
```



---

archive/issue_events_026579.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-05-03T18:12:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "milestone": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10333#event-26579"
}
```



---

archive/issue_comments_105725.json:
```json
{
    "body": "Changing keywords from \"\" to \"days30\".",
    "created_at": "2011-05-10T14:30:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105725",
    "user": "https://github.com/nthiery"
}
```

Changing keywords from "" to "days30".



---

archive/issue_comments_105726.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-05-13T06:14:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105726",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_026580.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-05-13T06:14:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10333#event-26580"
}
```



---

archive/issue_comments_105727.json:
```json
{
    "body": "Test comment.",
    "created_at": "2011-08-05T18:58:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105727",
    "user": "https://github.com/mwhansen"
}
```

Test comment.



---

archive/issue_comments_105728.json:
```json
{
    "body": "And another test comment.",
    "created_at": "2011-08-05T22:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10333#issuecomment-105728",
    "user": "https://github.com/mwhansen"
}
```

And another test comment.
