# Issue 10034: Create hold context

archive/issues_010034.json:
```json
{
    "body": "Assignee: burcin\n\nCC:  burcin eviatarbach\n\nNow that Pynac will support 'hold' of symbolic expressions, like\n\n```\nsage: tan(pi/12,hold=True)\ntan(1/12*pi)\n```\n\nwe might want a 'context' for this.\n\nIssue created by migration from https://trac.sagemath.org/ticket/10035\n\n",
    "created_at": "2010-09-29T19:08:24Z",
    "labels": [
        "symbolics",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Create hold context",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10034",
    "user": "kcrisman"
}
```
Assignee: burcin

CC:  burcin eviatarbach

Now that Pynac will support 'hold' of symbolic expressions, like

```
sage: tan(pi/12,hold=True)
tan(1/12*pi)
```

we might want a 'context' for this.

Issue created by migration from https://trac.sagemath.org/ticket/10035





---

archive/issue_comments_100839.json:
```json
{
    "body": "Can you give a code sample of what you mean?",
    "created_at": "2010-09-30T02:06:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100839",
    "user": "jason"
}
```

Can you give a code sample of what you mean?



---

archive/issue_comments_100840.json:
```json
{
    "body": "Replying to [comment:1 jason]:\n> Can you give a code sample of what you mean?\nNo, because this is really a followup to another ticket.  I'll cc: Burcin in, though he probably already gets it given the component.  I imagine something like\n\n```\nsage: context('hold') # or whatever the usual syntax is for such things - Sage doesn't have any yet\nsage: a = tan(pi/12)\nsage: a\ntan(pi/12)\n```\n\nas opposed to evaluating it.",
    "created_at": "2010-09-30T02:35:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100840",
    "user": "kcrisman"
}
```

Replying to [comment:1 jason]:
> Can you give a code sample of what you mean?
No, because this is really a followup to another ticket.  I'll cc: Burcin in, though he probably already gets it given the component.  I imagine something like

```
sage: context('hold') # or whatever the usual syntax is for such things - Sage doesn't have any yet
sage: a = tan(pi/12)
sage: a
tan(pi/12)
```

as opposed to evaluating it.



---

archive/issue_comments_100841.json:
```json
{
    "body": "I was thinking of something like:\n\n```\nsage: with hold:\n....:     t = tan(pi/2)\n....:\nsage: t\ntan(pi/12)\nsage: tan(pi/12)\n-sqrt(3) + 2\n```\n",
    "created_at": "2010-10-01T14:54:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100841",
    "user": "burcin"
}
```

I was thinking of something like:

```
sage: with hold:
....:     t = tan(pi/2)
....:
sage: t
tan(pi/12)
sage: tan(pi/12)
-sqrt(3) + 2
```




---

archive/issue_comments_100842.json:
```json
{
    "body": "That would be awesome!",
    "created_at": "2010-10-01T15:01:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100842",
    "user": "jason"
}
```

That would be awesome!



---

archive/issue_comments_100843.json:
```json
{
    "body": "Replying to [comment:4 jason]:\n> That would be awesome!\nBut with such a construction it is not obvious how to simplify 't' without going through Maxima as suggested in [#10034](http://trac.sagemath.org/search/opensearch?q=ticket%3A10034)\n\n\n\n```\nsage: with hold: \n....:     t = tan(pi/2) \n....: \nsage: t tan(pi/12) \nsage: t.eval() #or t.unhold() or whatever \n-sqrt(3) + 2\n```\n",
    "created_at": "2010-10-05T09:40:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100843",
    "user": "jpflori"
}
```

Replying to [comment:4 jason]:
> That would be awesome!
But with such a construction it is not obvious how to simplify 't' without going through Maxima as suggested in [#10034](http://trac.sagemath.org/search/opensearch?q=ticket%3A10034)



```
sage: with hold: 
....:     t = tan(pi/2) 
....: 
sage: t tan(pi/12) 
sage: t.eval() #or t.unhold() or whatever 
-sqrt(3) + 2
```




---

archive/issue_comments_100844.json:
```json
{
    "body": "#11776 seems to be asking for something very similar.",
    "created_at": "2011-09-08T00:55:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100844",
    "user": "kcrisman"
}
```

#11776 seems to be asking for something very similar.



---

archive/issue_comments_100845.json:
```json
{
    "body": "An interesting use case for this showed up at [this tex.SX question](http://tex.stackexchange.com/questions/136514/).",
    "created_at": "2014-03-13T15:11:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100845",
    "user": "kcrisman"
}
```

An interesting use case for this showed up at [this tex.SX question](http://tex.stackexchange.com/questions/136514/).



---

archive/issue_comments_100846.json:
```json
{
    "body": "Replying to [comment:5 jpflori]:\n> Replying to [comment:4 jason]:\n> > That would be awesome!\n> But with such a construction it is not obvious how to simplify 't' without going through Maxima as suggested in [#10034](http://trac.sagemath.org/search/opensearch?q=ticket%3A10034)\n> \n> \n> {{{\n> sage: with hold: \n> ....:     t = tan(pi/2) \n> ....: \n> sage: t tan(pi/12) \n> sage: t.eval() #or t.unhold() or whatever \n> -sqrt(3) + 2\n> }}}\nYou are going through Maxima because the `simplify...` functions do this. So improve these by replacing Maxima. It has nothing to do with the question of a global hold context.",
    "created_at": "2014-12-25T09:31:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100846",
    "user": "rws"
}
```

Replying to [comment:5 jpflori]:
> Replying to [comment:4 jason]:
> > That would be awesome!
> But with such a construction it is not obvious how to simplify 't' without going through Maxima as suggested in [#10034](http://trac.sagemath.org/search/opensearch?q=ticket%3A10034)
> 
> 
> {{{
> sage: with hold: 
> ....:     t = tan(pi/2) 
> ....: 
> sage: t tan(pi/12) 
> sage: t.eval() #or t.unhold() or whatever 
> -sqrt(3) + 2
> }}}
You are going through Maxima because the `simplify...` functions do this. So improve these by replacing Maxima. It has nothing to do with the question of a global hold context.



---

archive/issue_comments_100847.json:
```json
{
    "body": "See https://github.com/pynac/pynac/issues/76",
    "created_at": "2015-06-24T08:01:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100847",
    "user": "rws"
}
```

See https://github.com/pynac/pynac/issues/76



---

archive/issue_comments_100848.json:
```json
{
    "body": "Changing priority from minor to major.",
    "created_at": "2015-06-24T12:32:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100848",
    "user": "rws"
}
```

Changing priority from minor to major.



---

archive/issue_comments_100849.json:
```json
{
    "body": "The construction would look like:\n\n```\nsage: class hold_class:\n....:     def __enter__(self): print('entered')\n....:     def __exit__(self, *args): print('exited')\n....:     \nsage: hold = hold_class()\nsage: with hold:\n....:     x^2\n....:     \nentered\nx^2\nexited\n```\n",
    "created_at": "2017-08-30T06:28:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100849",
    "user": "rws"
}
```

The construction would look like:

```
sage: class hold_class:
....:     def __enter__(self): print('entered')
....:     def __exit__(self, *args): print('exited')
....:     
sage: hold = hold_class()
sage: with hold:
....:     x^2
....:     
entered
x^2
exited
```




---

archive/issue_comments_100850.json:
```json
{
    "body": "So we can actually use a global state (e.g. a boolean hold state inside Pynac) and via the Python `with` ensure that it is always set locally.",
    "created_at": "2017-08-30T06:33:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100850",
    "user": "rws"
}
```

So we can actually use a global state (e.g. a boolean hold state inside Pynac) and via the Python `with` ensure that it is always set locally.



---

archive/issue_comments_100851.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-08-31T07:55:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100851",
    "user": "rws"
}
```

New commits:



---

archive/issue_comments_100852.json:
```json
{
    "body": "Ordinarily I'd just say **well done** and leave it at that.  But what to do with the \"old\" hold stuff?  Keep, deprecate, side-by-side - should we transform old examples into this one, not, leave that to another ticket that may or may not get attention ... I assume you have thoughts on this so this is just for the purposes of hearing them, I don't have a strong opinion other than that a decision would have to be made, this patch alone wouldn't suffice.  THANK YOU for this.",
    "created_at": "2017-08-31T16:47:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100852",
    "user": "kcrisman"
}
```

Ordinarily I'd just say **well done** and leave it at that.  But what to do with the "old" hold stuff?  Keep, deprecate, side-by-side - should we transform old examples into this one, not, leave that to another ticket that may or may not get attention ... I assume you have thoughts on this so this is just for the purposes of hearing them, I don't have a strong opinion other than that a decision would have to be made, this patch alone wouldn't suffice.  THANK YOU for this.



---

archive/issue_comments_100853.json:
```json
{
    "body": "I think the best strategy is to keep the old functionality but replace doctests in tutorials and introductory docstrings (another ticket). As there will be more such contexts a syntax for multiple settings like `with context(hold, eval_fp, simplify):` seems best.\n\nPlease review this whenever pynac-0.7.11 is merged.",
    "created_at": "2017-09-01T06:15:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100853",
    "user": "rws"
}
```

I think the best strategy is to keep the old functionality but replace doctests in tutorials and introductory docstrings (another ticket). As there will be more such contexts a syntax for multiple settings like `with context(hold, eval_fp, simplify):` seems best.

Please review this whenever pynac-0.7.11 is merged.



---

archive/issue_comments_100854.json:
```json
{
    "body": "Or even `with context(x > 0, simplify):`",
    "created_at": "2017-09-01T06:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100854",
    "user": "rws"
}
```

Or even `with context(x > 0, simplify):`



---

archive/issue_comments_100855.json:
```json
{
    "body": "Note however that the Python directive `with` interactively acts on its content all at once. That is,\n\n```\nsage: with hold:\n....:     sin(0)\n....:     cos(0)\n....:     \nsin(0)\ncos(0)\n```\n\nMaybe we should provide `start()/stop()` so people can do\n\n```\nsage: mycontext1 = context(...)\nsage: mycontext2 = context(...)\nsage: with mycontext1:\n........\nsage: mycontext2.start()\n...\nsage: mycontext2.stop()\n```\n",
    "created_at": "2017-09-01T06:32:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100855",
    "user": "rws"
}
```

Note however that the Python directive `with` interactively acts on its content all at once. That is,

```
sage: with hold:
....:     sin(0)
....:     cos(0)
....:     
sin(0)
cos(0)
```

Maybe we should provide `start()/stop()` so people can do

```
sage: mycontext1 = context(...)
sage: mycontext2 = context(...)
sage: with mycontext1:
........
sage: mycontext2.start()
...
sage: mycontext2.stop()
```




---

archive/issue_comments_100856.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-01T06:58:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100856",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_100857.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-09-23T05:53:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100857",
    "user": "rws"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_100858.json:
```json
{
    "body": "On top of 8.1beta9 + #24026 + #23990 + #23923 + #24088 + their dependencies running on Debian Testing on core i7 + 16 GB RAM, passes `ptestlong` with no error whatsoever.\n\n==>`positive_review`",
    "created_at": "2017-10-25T19:31:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100858",
    "user": "charpent"
}
```

On top of 8.1beta9 + #24026 + #23990 + #23923 + #24088 + their dependencies running on Debian Testing on core i7 + 16 GB RAM, passes `ptestlong` with no error whatsoever.

==>`positive_review`



---

archive/issue_comments_100859.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-25T19:31:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100859",
    "user": "charpent"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_100860.json:
```json
{
    "body": "Thanks.",
    "created_at": "2017-10-26T06:22:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100860",
    "user": "rws"
}
```

Thanks.



---

archive/issue_comments_100861.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-10-29T10:32:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10034",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10034#issuecomment-100861",
    "user": "vbraun"
}
```

Resolution: fixed
