# Issue 13426: implement padic (x)gcd for fixed mod polynomials

Issue created by migration from https://trac.sagemath.org/ticket/13630

Original creator: saraedum

Original creation time: 2012-10-19 23:45:12

Assignee: roed

Polynomials over the padics only implement an incorrect (x)gcd, see #13439. The attached patch provides a correct implementation for polynomials over fixed modulus rings.


---

Attachment


---

Comment by niles created at 2014-01-28 15:55:36

rebased to sage 6.0 and converted to git branch; no other changes

merges cleanly in local repository in spite of what trac says
----
Last 10 new commits:


---

Comment by aly.deines created at 2016-03-22 09:46:07

Some of the doctests aren't passing.  It looks like everything is correct, formatting just needs to be updated.


```
aly@aly-laptop:~/Sage/sage$ ./sage -t src/sage/rings/padics/generic_nodes.py 
too few successful tests, not using stored timings
Running doctests with ID 2016-03-22-09-42-58-fac8bd3c.
Git branch: ticket/13630
Using --optional=ccache,mpir,python2,sage
Doctesting 1 file.
sage -t src/sage/rings/padics/generic_nodes.py
**********************************************************************
File "src/sage/rings/padics/generic_nodes.py", line 284, in sage.rings.padics.generic_nodes.pAdicFixedModRingGeneric._gcd_univariate_polynomial
Failed example:
    (t^3).gcd( t^5 )
Expected:
    ((1 + O(3^20))*t^3, 20)
Got:
    ((1 + O(3^20))*t^3 + (O(3^20))*t^2 + (O(3^20))*t + (O(3^20)), 20)
**********************************************************************
File "src/sage/rings/padics/generic_nodes.py", line 368, in sage.rings.padics.generic_nodes.pAdicFixedModRingGeneric._xgcd_univariate_polynomial
Failed example:
    (t^3).xgcd( t^5 )
Expected:
    ((1 + O(3^20))*t^3, 20, (1 + O(3^20)), 0)
Got:
    ((1 + O(3^20))*t^3 + (O(3^20))*t^2 + (O(3^20))*t + (O(3^20)),
     20,
     (1 + O(3^20)),
     0)
**********************************************************************
2 items had failures:
   1 of  34 in sage.rings.padics.generic_nodes.pAdicFixedModRingGeneric._gcd_univariate_polynomial
   1 of  36 in sage.rings.padics.generic_nodes.pAdicFixedModRingGeneric._xgcd_univariate_polynomial
    [110 tests, 2 failures, 0.16 s]
----------------------------------------------------------------------
sage -t src/sage/rings/padics/generic_nodes.py  # 2 doctests failed
----------------------------------------------------------------------
Total time for all tests: 0.2 seconds
    cpu time: 0.2 seconds
    cumulative wall time: 0.2 seconds

```



```

aly@aly-laptop:~/Sage/sage$ ./sage -t src/sage/rings/padics/padic_generic.py 
too few successful tests, not using stored timings
Running doctests with ID 2016-03-22-09-44-46-93337901.
Git branch: ticket/13630
Using --optional=ccache,mpir,python2,sage
Doctesting 1 file.
sage -t src/sage/rings/padics/padic_generic.py
**********************************************************************
File "src/sage/rings/padics/padic_generic.py", line 368, in sage.rings.padics.padic_generic.pAdicGeneric.__xgcd_shift
Failed example:
    R._pAdicGeneric__xgcd_shift(R(3),19, 20)
Expected:
    O(3^20)
Got:
    3^20 + O(3^20)
**********************************************************************
File "src/sage/rings/padics/padic_generic.py", line 530, in sage.rings.padics.padic_generic.pAdicGeneric.__xgcd_univariate_polynomial_fixed
Failed example:
    S._pAdicGeneric__xgcd_univariate_polynomial_fixed(t,t)
Expected:
    ((1 + O(3))*t, 1, (1 + O(3))*t, 1, (1 + O(3)), 0)
Got:
    ((1 + O(3))*t + (O(3)), 1, (1 + O(3))*t + (O(3)), 1, (1 + O(3)), 0)
**********************************************************************
File "src/sage/rings/padics/padic_generic.py", line 552, in sage.rings.padics.padic_generic.pAdicGeneric.__xgcd_univariate_polynomial_fixed
Failed example:
    S._pAdicGeneric__xgcd_univariate_polynomial_fixed(g,g.derivative())
Expected:
    ((1 + O(3^2))*t^2 + (1 + O(3^2))*t + (1 + O(3^2)), 1, (3 + O(3^2))*t^2 + (3 + O(3^2))*t + (3 + O(3^2)), 2, (2*3 + O(3^2))*t + (2*3 + O(3^2)), (1 + O(3^2))*t^2)
Got:
    ((1 + O(3^2))*t^2 + (1 + O(3^2))*t + (1 + O(3^2)),
     1,
     (3 + O(3^2))*t^2 + (3 + O(3^2))*t + (3 + O(3^2)),
     2,
     (2*3 + O(3^2))*t + (2*3 + O(3^2)),
     (1 + O(3^2))*t^2 + (O(3^2))*t + (O(3^2)))
**********************************************************************
File "src/sage/rings/padics/padic_generic.py", line 566, in sage.rings.padics.padic_generic.pAdicGeneric.__xgcd_univariate_polynomial_fixed
Failed example:
    S._pAdicGeneric__xgcd_univariate_polynomial_fixed(g,g.derivative())
Expected:
    ((1 + O(3^15))*t + (2 + 2*3 + O(3^15)), 10, (3^5 + O(3^15))*t + (2*3^5 + 2*3^6 + O(3^15)), 15, (3 + 3^2 + 3^6 + 2*3^7 + 2*3^9 + 2*3^10 + 2*3^11 + 3^13 + O(3^15))*t + (3^5 + 2*3^7 + 2*3^8 + 2*3^9 + 3^11 + 3^12 + 3^13 + O(3^15)), (2 + 3 + 2*3^2 + 2*3^3 + 2*3^4 + 3^5 + 2*3^7 + 2*3^11 + 3^12 + 2*3^13 + 3^14 + O(3^15))*t^2 + (1 + 3 + 2*3^4 + 3^7 + 2*3^8 + 3^9 + 3^10 + 2*3^11 + 2*3^12 + 2*3^13 + O(3^15))*t)
Got:
    ((1 + O(3^15))*t + (2 + 2*3 + O(3^15)),
     10,
     (3^5 + O(3^15))*t + (2*3^5 + 2*3^6 + O(3^15)),
     15,
     (3 + 3^2 + 3^6 + 2*3^7 + 2*3^9 + 2*3^10 + 2*3^11 + 3^13 + O(3^15))*t + (3^5 + 2*3^7 + 2*3^8 + 2*3^9 + 3^11 + 3^12 + 3^13 + O(3^15)),
     (2 + 3 + 2*3^2 + 2*3^3 + 2*3^4 + 3^5 + 2*3^7 + 2*3^11 + 3^12 + 2*3^13 + 3^14 + O(3^15))*t^2 + (1 + 3 + 2*3^4 + 3^7 + 2*3^8 + 3^9 + 3^10 + 2*3^11 + 2*3^12 + 2*3^13 + O(3^15))*t + (O(3^15)))
**********************************************************************
File "src/sage/rings/padics/padic_generic.py", line 574, in sage.rings.padics.padic_generic.pAdicGeneric.__xgcd_univariate_polynomial_fixed
Failed example:
    S._pAdicGeneric__xgcd_univariate_polynomial_fixed(g,g.derivative())
Expected:
    ((1 + O(3^30))*t + (2 + 2*3 + O(3^30)), 25, (3^5 + O(3^30))*t + (2*3^5 + 2*3^6 + O(3^30)), 30, (3 + 3^2 + 3^6 + 2*3^7 + 2*3^9 + 2*3^10 + 2*3^13 + 3^15 + 3^16 + 3^17 + 3^18 + 2*3^19 + 2*3^20 + 3^21 + 3^22 + 3^23 + 2*3^24 + 2*3^28 + O(3^30))*t + (3^5 + 2*3^7 + 2*3^8 + 2*3^9 + 3^11 + 3^12 + 3^13 + 3^15 + 2*3^16 + 3^17 + 3^18 + 3^23 + 2*3^25 + 2*3^26 + 2*3^27 + 3^29 + O(3^30)), (2 + 3 + 2*3^2 + 2*3^3 + 2*3^4 + 3^5 + 2*3^7 + 2*3^10 + 2*3^11 + 2*3^13 + 3^14 + 3^15 + 3^16 + 3^17 + 3^20 + 3^21 + 3^22 + 2*3^24 + 2*3^25 + 2*3^26 + 2*3^28 + O(3^30))*t^2 + (1 + 3 + 2*3^4 + 3^7 + 2*3^8 + 3^9 + 2*3^10 + 3^11 + 2*3^15 + 2*3^16 + 2*3^17 + 3^18 + 2*3^19 + 3^20 + 3^21 + 2*3^23 + 3^24 + 3^27 + 2*3^28 + 2*3^29 + O(3^30))*t)
Got:
    ((1 + O(3^30))*t + (2 + 2*3 + O(3^30)),
     25,
     (3^5 + O(3^30))*t + (2*3^5 + 2*3^6 + O(3^30)),
     30,
     (3 + 3^2 + 3^6 + 2*3^7 + 2*3^9 + 2*3^10 + 2*3^13 + 3^15 + 3^16 + 3^17 + 3^18 + 2*3^19 + 2*3^20 + 3^21 + 3^22 + 3^23 + 2*3^24 + 2*3^28 + O(3^30))*t + (3^5 + 2*3^7 + 2*3^8 + 2*3^9 + 3^11 + 3^12 + 3^13 + 3^15 + 2*3^16 + 3^17 + 3^18 + 3^23 + 2*3^25 + 2*3^26 + 2*3^27 + 3^29 + O(3^30)),
     (2 + 3 + 2*3^2 + 2*3^3 + 2*3^4 + 3^5 + 2*3^7 + 2*3^10 + 2*3^11 + 2*3^13 + 3^14 + 3^15 + 3^16 + 3^17 + 3^20 + 3^21 + 3^22 + 2*3^24 + 2*3^25 + 2*3^26 + 2*3^28 + O(3^30))*t^2 + (1 + 3 + 2*3^4 + 3^7 + 2*3^8 + 3^9 + 2*3^10 + 3^11 + 2*3^15 + 2*3^16 + 2*3^17 + 3^18 + 2*3^19 + 3^20 + 3^21 + 2*3^23 + 3^24 + 3^27 + 2*3^28 + 2*3^29 + O(3^30))*t + (O(3^30)))
**********************************************************************
File "src/sage/rings/padics/padic_generic.py", line 592, in sage.rings.padics.padic_generic.pAdicGeneric.__xgcd_univariate_polynomial_fixed
Failed example:
    S._pAdicGeneric__xgcd_univariate_polynomial_fixed(f.change_ring(S), g.change_ring(S))
Expected:
    ((1 + O(3^6))*t + (3 + 2*3^3 + 3^5 + O(3^6)), 3, (1 + O(3^6))*t + (3 + 2*3^3 + 3^5 + O(3^6)), 3, (3^5 + O(3^6))*t^3 + (2*3^4 + 2*3^5 + O(3^6))*t^2 + (3^2 + 3^3 + 2*3^4 + 2*3^5 + O(3^6))*t + (2 + 3 + 2*3^2 + 3^3 + O(3^6)), (3^5 + O(3^6))*t)
Got:
    ((1 + O(3^6))*t + (3 + 2*3^3 + 3^5 + O(3^6)),
     3,
     (1 + O(3^6))*t + (3 + 2*3^3 + 3^5 + O(3^6)),
     3,
     (3^5 + O(3^6))*t^3 + (2*3^4 + 2*3^5 + O(3^6))*t^2 + (3^2 + 3^3 + 2*3^4 + 2*3^5 + O(3^6))*t + (2 + 3 + 2*3^2 + 3^3 + O(3^6)),
     (3^5 + O(3^6))*t + (O(3^6)))
**********************************************************************
2 items had failures:
   1 of   6 in sage.rings.padics.padic_generic.pAdicGeneric.__xgcd_shift
   5 of  70 in sage.rings.padics.padic_generic.pAdicGeneric.__xgcd_univariate_polynomial_fixed
    [206 tests, 6 failures, 0.37 s]
----------------------------------------------------------------------
sage -t src/sage/rings/padics/padic_generic.py  # 6 doctests failed
----------------------------------------------------------------------
Total time for all tests: 0.4 seconds
    cpu time: 0.4 seconds
    cumulative wall time: 0.4 seconds

```

----
New commits:


---

Comment by aly.deines created at 2016-03-23 15:07:57

Changing keywords from "" to "sd71".


---

Comment by aly.deines created at 2016-03-23 17:42:37

Changing keywords from "sd71" to "days71".


---

Comment by saraedum created at 2017-07-21 19:42:40

This should not be done in this way. Let's reopen a new ticket for that.


---

Comment by saraedum created at 2017-07-21 19:42:40

Changing keywords from "days71" to "days71, sd87".


---

Comment by saraedum created at 2017-07-21 19:42:40

Changing status from new to needs_review.


---

Comment by saraedum created at 2017-07-21 19:42:46

Changing status from needs_review to positive_review.


---

Comment by embray created at 2017-12-12 08:23:33

Resolution: wontfix
