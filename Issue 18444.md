# Issue 18444: Separate the rankwidth library into a standard package

Issue created by migration from Trac.

Original creator: mjo

Original creation time: 2015-06-11 17:58:55

CC:  jdemeyer ncohen

This is a follow-up to,

  https://groups.google.com/forum/#!topic/sage-devel/HF52TdkH0fw

The author of the rankwidth (rw) package was very helpful in getting the library/executable packaged with autotools. The new release is available here:

  http://pholia.tdi.informatik.uni-frankfurt.de/~philipp/software/rw-0.6.tar.gz

The first big change is that it uses autotools, obviously. So the standard `./configure && make` should work. But more importantly, we can now compile the shared library without the executable, and without the resulting dependency on igraph. If you use the default ./configure:


```
$ ./configure
...
configure: error: Package requirements (igraph >= 0.6) were not met:

No package 'igraph' found
```


But if you pass the `--enable-executable=no` flag,


```
$ ./configure --enable-executable=no
```


it will succeed without igraph and build the library.


---

Comment by ncohen created at 2015-06-11 21:50:15

Have you started turning it into a Sage package?


---

Comment by mjo created at 2015-06-11 22:30:12

Replying to [comment:2 ncohen]:
> Have you started turning it into a Sage package?

Nope, no work on that yet.


---

Comment by ncohen created at 2015-06-11 22:32:23

Okay, I'll do it tomorrow then.


---

Comment by ncohen created at 2015-06-12 10:28:11

Changing status from new to needs_review.


---

Comment by ncohen created at 2015-06-12 10:28:11

New commits:


---

Comment by git created at 2015-06-12 10:29:14

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2015-06-12 11:23:46

The license is GPL version 2 *or later*.


---

Comment by jdemeyer created at 2015-06-12 11:24:22

For upstream contact, I would mention the page [http://pholia.tdi.informatik.uni-frankfurt.de/~philipp/software/rw.shtml](http://pholia.tdi.informatik.uni-frankfurt.de/~philipp/software/rw.shtml)


---

Comment by jdemeyer created at 2015-06-12 11:35:02

These lines should be removed from the `.pxd` file, since they are not in the API of `rw`:

```
subset_t *slots

uint_fast8_t num_vertices
```


Move this inside the `cdef extern from "rankwidth_c/rw.h":` block (removing the stuff in quotes and `uint_fast8`):

```
    ctypedef int uint_fast8_t
    ctypedef int uint_fast32_t
    ctypedef int subset_t
```



---

Comment by jdemeyer created at 2015-06-12 11:35:11

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2015-06-12 11:46:13

And this is clearly a private function, this shouldn't be in the `pxd` either:

```
cdef void set_am(int i, int j, int val)
```



---

Comment by git created at 2015-06-12 12:03:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2015-06-12 12:04:25

I made all modifications except the one about the licence: where did you see that? I said 'GPL2' in `SPKG.txt` because that's what the `COPYING` file contains.

Nathann


---

Comment by ncohen created at 2015-06-12 12:04:25

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2015-06-12 12:08:54

Replying to [comment:13 ncohen]:
> I made all modifications except the one about the licence: where did you see that? I said 'GPL2' in `SPKG.txt` because that's what the `COPYING` file contains.

Look in the code (`rw.c` for example).

Note that Sage is released under GPL version 3 (the only license which is compatible with all standard packages), so if it really was GPL version 2 only, that would be a problem.


---

Comment by jdemeyer created at 2015-06-12 12:08:54

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2015-06-12 12:11:00

Do you really need this stuff in quotes:

```
"uint_fast8_t"
```

(same for the other two)


---

Comment by ncohen created at 2015-06-12 12:14:33

Yo !

> Look in the code (`rw.c` for example).

Well, that's two contradicting sources. Should we ask upstream to use the same in both places?

> Note that Sage is released under GPL version 3 (the only license which is compatible with all standard packages), so if it really was GPL version 2 only, that would be a problem.

Sigh... `T_T`

Nathann


---

Comment by git created at 2015-06-12 12:19:53

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by ncohen created at 2015-06-12 12:20:06

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2015-06-12 12:20:56

Replying to [comment:16 ncohen]:
> Well, that's two contradicting sources.

It's not contradicting. The code is what matters. Essentially it says "this code is released until GPL v2 or later, see the file `COPYING` for the GPL v2 text"


---

Comment by jdemeyer created at 2015-06-12 12:26:29

`rw` should be a dependency of the Sage library in `build/deps`.


---

Comment by jdemeyer created at 2015-06-12 12:26:29

Changing status from needs_review to needs_work.


---

Comment by ncohen created at 2015-06-12 12:30:02

Changing status from needs_work to needs_review.


---

Comment by ncohen created at 2015-06-12 12:30:02

> `rw` should be a dependency of the Sage library in `build/deps`.

Arg... True `:-/`

Can you think of a way to make this automatic?

Nathann


---

Comment by git created at 2015-06-12 12:30:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2015-06-12 13:07:58

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2015-06-12 13:10:55

Thanks!


---

Comment by vbraun created at 2015-06-12 22:58:48

Resolution: fixed
