# Issue 28161: _richcmp_ for quaternion algebra elements

Issue created by migration from https://trac.sagemath.org/ticket/28398

Original creator: chapoton

Original creation time: 2019-08-25 15:19:55

CC:  tscrim chapoton

instead of the old-style `_cmp_`


---

Comment by chapoton created at 2019-08-25 15:20:23

Changing status from new to needs_review.


---

Comment by chapoton created at 2019-08-25 15:20:23

New commits:


---

Comment by chapoton created at 2019-08-25 19:19:19

bot is morally green, please review


---

Comment by tscrim created at 2019-08-25 21:33:16

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2019-08-25 21:33:16

LGTM.


---

Comment by vbraun created at 2019-08-28 19:54:50

Resolution: fixed


---

Comment by mmasdeu created at 2020-01-28 10:41:43

This breaks quaternion algebra comparisons quite badly. In Sage 9.0:


```
sage: B.<i,j,k> = QuaternionAlgebra(6)
sage: B(1) == B(-1)
False
sage: B(1) != B(-1)
False
```



---

Comment by mmasdeu created at 2020-01-28 10:41:43

Set assignee to tscrim.


---

Comment by mmasdeu created at 2020-01-28 10:54:11

Changing assignee from tscrim to chapoton.


---

Comment by tscrim created at 2020-01-28 15:34:55

So this change did not cause that problem, but instead #28595. The problem comes from the fact that `mpz_cmp` yields arbitrary positive/negative numbers, but `rich_to_bool` assumes the input is in `[-1, 0, 1]`. Instead, we just need to use `rich_to_bool_sgn`. This is now #29094.
