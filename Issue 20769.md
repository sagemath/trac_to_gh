# Issue 20769: IPython 5.0

Issue created by migration from Trac.

Original creator: vbraun

Original creation time: 2016-07-11 21:28:07

CC:  fbissey




---

Comment by git created at 2016-07-11 21:36:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vbraun created at 2016-07-11 21:45:38

Changing component from PLEASE CHANGE to packages: standard.


---

Comment by vbraun created at 2016-07-11 21:45:38

Changing type from PLEASE CHANGE to enhancement.


---

Comment by git created at 2016-07-11 22:11:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vbraun created at 2016-07-11 22:17:59

Prompt configuration was also changed

```
$ ./sage
[...]
/home/vbraun/Sage/git-develop/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py:440: UserWarning: As of IPython 5.0 `PromptManager` config will have no effect and has been replaced by TerminalInteractiveShell.prompts_class
  warn('As of IPython 5.0 `PromptManager` config will have no effect'
In [1]: 
```



---

Comment by git created at 2016-07-11 22:34:15

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:


---

Comment by git created at 2016-07-13 19:20:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vbraun created at 2016-07-13 19:21:07

IPython's `run_cell()` seems to be broken on Python2: https://github.com/ipython/ipython/issues/9756


---

Comment by fbissey created at 2016-07-13 19:58:32

Will this be the last `ipython` supporting python 2? I remember a post a while ago stating that a branch would be maintained for python2 but not get any new features.


---

Comment by vbraun created at 2016-07-13 20:50:21

Yes, though IPython 5 is supposed to get long-term support because of that.


---

Comment by git created at 2016-07-23 20:20:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vbraun created at 2016-07-23 20:52:59

Changing status from new to needs_review.


---

Comment by vbraun created at 2016-07-23 20:52:59

All tests pass


---

Comment by fbissey created at 2016-07-23 21:16:02

OK, I am not really ready but let's go. It's even more urgent that this also move `pyzmq` and I wonder how we avoided https://bugs.gentoo.org/show_bug.cgi?id=583192 for all the time that `cython-0.24+` and `pyzmq-15.2.0` have been in sage simultaneously.


---

Comment by fbissey created at 2016-07-23 21:16:02

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-07-24 09:18:30

Since its a bigger UI change, lets postpone it to the next beta cycle.


---

Comment by git created at 2016-07-24 11:55:36

Changing status from positive_review to needs_review.


---

Comment by git created at 2016-07-24 11:55:36

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by slelievre created at 2016-07-28 10:51:55

Just adding "upgrade" to the ticket summary so that it appears in

https://trac.sagemath.org/query?summary=~upgrade&desc=1&order=status


---

Comment by vbraun created at 2016-08-06 17:06:33

Changing status from needs_review to positive_review.


---

Comment by git created at 2016-08-06 18:23:49

Changing status from positive_review to needs_review.


---

Comment by git created at 2016-08-06 18:23:49

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by vbraun created at 2016-08-07 20:00:04

Resolution: fixed


---

Comment by leif created at 2016-08-11 21:46:54

This presumably broke `sage_mode` (cf. [this post on sage-devel](http://permalink.gmane.org/gmane.comp.mathematics.sage.devel/88271)).

And this also seems related:

```
After the update, on exit from Sage I get

Exiting Sage (CPU time 0m0.17s, Wall time 0m44.15s).
:0: UserWarning: You do not have a working installation of the service_identity module: 'No module named service_identity'.  Please install it from <https://pypi.python.org/pypi/service_identity> and make sure all of its dependencies are satisfied.  Without the service_identity module and a recent enough pyOpenSSL to support it, Twisted can perform only rudimentary TLS client hostname verification.  Many valid certificate/hostname mappings may be rejected.

After doing "sage --pip install service_identity"
this warning goes away.

Any idea what happens here?

Dima
```

(from sage-release)


---

Comment by leif created at 2016-08-11 21:56:58

Replying to [comment:22 leif]:
> This presumably broke `sage_mode` (cf. [this post on sage-devel](http://permalink.gmane.org/gmane.comp.mathematics.sage.devel/88271)).

See #21227.


---

Comment by jhpalmieri created at 2016-08-11 22:36:46

I think this also broke `line_profiler`:

```
$ sage
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 7.4.beta0, Release Date: 2016-08-10               │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
[SageTerminalApp] WARNING | Error in loading extension: line_profiler
Check your config files in /Users/palmieri/.sage/ipython_genutils-0.1.0/profile_default
Traceback (most recent call last):
  File "/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/IPython/core/shellapp.py", line 246, in init_extensions
    self.shell.extension_manager.load_extension(ext)
  File "/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/IPython/core/extensions.py", line 85, in load_extension
    if self._call_load_ipython_extension(mod):
  File "/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/IPython/core/extensions.py", line 132, in _call_load_ipython_extension
    mod.load_ipython_extension(self.shell)
  File "/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/line_profiler.py", line 372, in load_ipython_extension
    ip.define_magic('lprun', magic_lprun)
AttributeError: 'SageTerminalInteractiveShell' object has no attribute 'define_magic'
sage: %lprun?
Object `%lprun` not found.
```



---

Comment by tmonteil created at 2016-09-09 00:12:46

Replying to [comment:24 jhpalmieri]:
> I think this also broke `line_profiler`:

See #21457.
