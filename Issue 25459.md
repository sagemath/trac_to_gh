# Issue 25459: Error in is_clique for graphs with multiple edges

Issue created by migration from Trac.

Original creator: dcoudert

Original creation time: 2018-06-28 17:56:10

CC:  pelegm jmantysalo chapoton


```
sage: G = Graph(multiedges=True)
sage: G.add_cycle([0, 1, 2, 3])
sage: G.add_edge(0,1)
sage: G.add_edge(0,1)
sage: G.is_clique()
True
```



---

Comment by dcoudert created at 2018-06-28 18:29:21

Changing status from new to needs_review.


---

Comment by dcoudert created at 2018-06-28 18:29:21

There might be smarter way to do that, but at least it fix the issue
----
New commits:


---

Comment by pelegm created at 2018-06-30 15:19:26

I'm not sure we have the right/common definition of cliques here.  Docs say:

  A clique is a set of vertices such that there is an edge between any two vertices.


I would say:

  A clique is a set of vertices such that there is a **single** edge between any two vertices.

For example, according to this paper [here](https://ac.els-cdn.com/S0012365X07004736/1-s2.0-S0012365X07004736-main.pdf?_tid=14011a02-1462-4f2e-bd26-ae008042d602&acdnat=1530371745_b4554aaf02a9a601a6ab55e63afe7571),

  A clique in a graph or multigraph G is a simple complete subgraph of G.


---

Comment by pelegm created at 2018-06-30 15:19:44

Changing keywords from "" to "days94".


---

Comment by dcoudert created at 2018-06-30 16:04:45

What we expect certainly depends on the context. One solution could be to add a parameter `strict`, such that when `strict==True` we want a simple complete subgraph, and when set to `False`, we may tolerate loops of multiple edges = contains a simple complete subgraph. This is certainly not perfect, I agree.


---

Comment by git created at 2018-07-07 13:23:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-07 13:29:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2018-07-07 13:32:07

I added parameter `induced` to check for an induced clique or if the graph contains a clique. I also added a parameter `loops` to deal with complete (di)graphs with loops. This way we have more flexibility, and we can get what we want.

The last commit exhibit a potential change of behavior when asking for an undirected clique inside a directed graph. I consider that we can have only 1 arc between a given pair of nodes to get an induced clique. Let me know if you agree.


---

Comment by jmantysalo created at 2018-07-11 09:53:08

The logic seems to be clear. However,


```
sage: g = Graph({1: [2]})
sage: g.is_clique([1,2,3])
True
```


Also the indentation in `INPUT` section for parameters `vertices` and `directed_clique` is wrong (but right for `induced` and `loops`).


---

Comment by jmantysalo created at 2018-07-11 09:56:23

Changing status from needs_review to needs_work.


---

Comment by jmantysalo created at 2018-07-11 09:56:23

Also


```
sage: g = Graph(3)
sage: g.is_clique([1,2,3])
False
sage: g = Graph(2)
sage: g.is_clique([1,2])
True
```



---

Comment by git created at 2018-07-11 11:14:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2018-07-11 11:20:19

Changing status from needs_work to needs_review.


---

Comment by dcoudert created at 2018-07-11 11:20:19

Good catch ! This is a side effect of `g.subgraph(vertices)` that don't check if `vertices` is a subset of the vertices of the graph. I added a simple test.

Do you think I should open a ticket to raise an error in `g.subgraph(vertices)` when some vertices (or edges) are not in the graph ?


---

Comment by jmantysalo created at 2018-07-11 12:29:11

Replying to [comment:13 dcoudert]:

> Do you think I should open a ticket to raise an error in `g.subgraph(vertices)` when some vertices (or edges) are not in the graph ? 

To me it sounds logical. I expect that


```
SymmetricGroup(2).subgroup((1,2), 'junk')
Poset({1: [2]}).subposet([1, 'junk'])
Graph({1:[2]}).subgraph([1, 'junk'])
```


gives similar output (they do not), and actually I have changed the output of


```
Poset({1: [2], 3: []}).is_antichain_of_poset([1,2,4])
```


to be an error message, not `False`.

However, if you do that, then this ticket should be postponed until that is ready.


---

Comment by dcoudert created at 2018-07-11 12:51:48

I prefer to have this ticket fixed now since it impacts other methods. For instance, `g.vertex_connectivity()` has special treatment for cliques. If `g.is_clique()` returns a wrong answer, then the answer of `g.vertex_connectivity()` is also wrong.

We can deal with the `subgraph` problem independently.


---

Comment by jmantysalo created at 2018-07-11 13:04:07

Replying to [comment:15 dcoudert]:
> I prefer to have this ticket fixed now since it impacts other methods. For instance, `g.vertex_connectivity()` has special treatment for cliques. If `g.is_clique()` returns a wrong answer, then the answer of `g.vertex_connectivity()` is also wrong.
> 
> We can deal with the `subgraph` problem independently.

OK. I'll try to review this in a day or two.


---

Comment by jmantysalo created at 2018-07-12 06:19:37

Changing status from needs_review to positive_review.


---

Comment by jmantysalo created at 2018-07-12 06:19:37

Seems to be OK. ("Trivially complicated code", but there is no other way as there are so many combinations of parameters.)


---

Comment by dcoudert created at 2018-07-12 07:10:41

Thank you.


---

Comment by jmantysalo created at 2018-07-12 14:57:08

rc for 8.3 is already out.


---

Comment by vbraun created at 2018-08-05 08:17:56

Resolution: fixed
