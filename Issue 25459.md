# Issue 25459: Error in is_clique for graphs with multiple edges

archive/issues_025459.json:
```json
{
    "body": "CC:  @pelegm @jm58660 @fchapoton\n\n\n```\nsage: G = Graph(multiedges=True)\nsage: G.add_cycle([0, 1, 2, 3])\nsage: G.add_edge(0,1)\nsage: G.add_edge(0,1)\nsage: G.is_clique()\nTrue\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/25696\n\n",
    "created_at": "2018-06-28T17:56:10Z",
    "labels": [
        "graph theory",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "Error in is_clique for graphs with multiple edges",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25459",
    "user": "@dcoudert"
}
```
CC:  @pelegm @jm58660 @fchapoton


```
sage: G = Graph(multiedges=True)
sage: G.add_cycle([0, 1, 2, 3])
sage: G.add_edge(0,1)
sage: G.add_edge(0,1)
sage: G.is_clique()
True
```


Issue created by migration from https://trac.sagemath.org/ticket/25696





---

archive/issue_comments_359188.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-06-28T18:29:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359188",
    "user": "@dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_359189.json:
```json
{
    "body": "There might be smarter way to do that, but at least it fix the issue\n----\nNew commits:",
    "created_at": "2018-06-28T18:29:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359189",
    "user": "@dcoudert"
}
```

There might be smarter way to do that, but at least it fix the issue
----
New commits:



---

archive/issue_comments_359190.json:
```json
{
    "body": "I'm not sure we have the right/common definition of cliques here.  Docs say:\n\n  A clique is a set of vertices such that there is an edge between any two vertices.\n\n\nI would say:\n\n  A clique is a set of vertices such that there is a **single** edge between any two vertices.\n\nFor example, according to this paper [here](https://ac.els-cdn.com/S0012365X07004736/1-s2.0-S0012365X07004736-main.pdf?_tid=14011a02-1462-4f2e-bd26-ae008042d602&acdnat=1530371745_b4554aaf02a9a601a6ab55e63afe7571),\n\n  A clique in a graph or multigraph G is a simple complete subgraph of G.",
    "created_at": "2018-06-30T15:19:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359190",
    "user": "@pelegm"
}
```

I'm not sure we have the right/common definition of cliques here.  Docs say:

  A clique is a set of vertices such that there is an edge between any two vertices.


I would say:

  A clique is a set of vertices such that there is a **single** edge between any two vertices.

For example, according to this paper [here](https://ac.els-cdn.com/S0012365X07004736/1-s2.0-S0012365X07004736-main.pdf?_tid=14011a02-1462-4f2e-bd26-ae008042d602&acdnat=1530371745_b4554aaf02a9a601a6ab55e63afe7571),

  A clique in a graph or multigraph G is a simple complete subgraph of G.



---

archive/issue_comments_359191.json:
```json
{
    "body": "Changing keywords from \"\" to \"days94\".",
    "created_at": "2018-06-30T15:19:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359191",
    "user": "@pelegm"
}
```

Changing keywords from "" to "days94".



---

archive/issue_comments_359192.json:
```json
{
    "body": "What we expect certainly depends on the context. One solution could be to add a parameter `strict`, such that when `strict==True` we want a simple complete subgraph, and when set to `False`, we may tolerate loops of multiple edges = contains a simple complete subgraph. This is certainly not perfect, I agree.",
    "created_at": "2018-06-30T16:04:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359192",
    "user": "@dcoudert"
}
```

What we expect certainly depends on the context. One solution could be to add a parameter `strict`, such that when `strict==True` we want a simple complete subgraph, and when set to `False`, we may tolerate loops of multiple edges = contains a simple complete subgraph. This is certainly not perfect, I agree.



---

archive/issue_comments_359193.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-07T13:23:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359193",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_359194.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-07T13:29:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359194",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_359195.json:
```json
{
    "body": "I added parameter `induced` to check for an induced clique or if the graph contains a clique. I also added a parameter `loops` to deal with complete (di)graphs with loops. This way we have more flexibility, and we can get what we want.\n\nThe last commit exhibit a potential change of behavior when asking for an undirected clique inside a directed graph. I consider that we can have only 1 arc between a given pair of nodes to get an induced clique. Let me know if you agree.",
    "created_at": "2018-07-07T13:32:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359195",
    "user": "@dcoudert"
}
```

I added parameter `induced` to check for an induced clique or if the graph contains a clique. I also added a parameter `loops` to deal with complete (di)graphs with loops. This way we have more flexibility, and we can get what we want.

The last commit exhibit a potential change of behavior when asking for an undirected clique inside a directed graph. I consider that we can have only 1 arc between a given pair of nodes to get an induced clique. Let me know if you agree.



---

archive/issue_comments_359196.json:
```json
{
    "body": "The logic seems to be clear. However,\n\n\n```\nsage: g = Graph({1: [2]})\nsage: g.is_clique([1,2,3])\nTrue\n```\n\n\nAlso the indentation in `INPUT` section for parameters `vertices` and `directed_clique` is wrong (but right for `induced` and `loops`).",
    "created_at": "2018-07-11T09:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359196",
    "user": "@jm58660"
}
```

The logic seems to be clear. However,


```
sage: g = Graph({1: [2]})
sage: g.is_clique([1,2,3])
True
```


Also the indentation in `INPUT` section for parameters `vertices` and `directed_clique` is wrong (but right for `induced` and `loops`).



---

archive/issue_comments_359197.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-07-11T09:56:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359197",
    "user": "@jm58660"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_359198.json:
```json
{
    "body": "Also\n\n\n```\nsage: g = Graph(3)\nsage: g.is_clique([1,2,3])\nFalse\nsage: g = Graph(2)\nsage: g.is_clique([1,2])\nTrue\n```\n",
    "created_at": "2018-07-11T09:56:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359198",
    "user": "@jm58660"
}
```

Also


```
sage: g = Graph(3)
sage: g.is_clique([1,2,3])
False
sage: g = Graph(2)
sage: g.is_clique([1,2])
True
```




---

archive/issue_comments_359199.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-11T11:14:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359199",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_359200.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-07-11T11:20:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359200",
    "user": "@dcoudert"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_359201.json:
```json
{
    "body": "Good catch ! This is a side effect of `g.subgraph(vertices)` that don't check if `vertices` is a subset of the vertices of the graph. I added a simple test.\n\nDo you think I should open a ticket to raise an error in `g.subgraph(vertices)` when some vertices (or edges) are not in the graph ?",
    "created_at": "2018-07-11T11:20:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359201",
    "user": "@dcoudert"
}
```

Good catch ! This is a side effect of `g.subgraph(vertices)` that don't check if `vertices` is a subset of the vertices of the graph. I added a simple test.

Do you think I should open a ticket to raise an error in `g.subgraph(vertices)` when some vertices (or edges) are not in the graph ?



---

archive/issue_comments_359202.json:
```json
{
    "body": "Replying to [comment:13 dcoudert]:\n\n> Do you think I should open a ticket to raise an error in `g.subgraph(vertices)` when some vertices (or edges) are not in the graph ? \n\nTo me it sounds logical. I expect that\n\n\n```\nSymmetricGroup(2).subgroup((1,2), 'junk')\nPoset({1: [2]}).subposet([1, 'junk'])\nGraph({1:[2]}).subgraph([1, 'junk'])\n```\n\n\ngives similar output (they do not), and actually I have changed the output of\n\n\n```\nPoset({1: [2], 3: []}).is_antichain_of_poset([1,2,4])\n```\n\n\nto be an error message, not `False`.\n\nHowever, if you do that, then this ticket should be postponed until that is ready.",
    "created_at": "2018-07-11T12:29:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359202",
    "user": "@jm58660"
}
```

Replying to [comment:13 dcoudert]:

> Do you think I should open a ticket to raise an error in `g.subgraph(vertices)` when some vertices (or edges) are not in the graph ? 

To me it sounds logical. I expect that


```
SymmetricGroup(2).subgroup((1,2), 'junk')
Poset({1: [2]}).subposet([1, 'junk'])
Graph({1:[2]}).subgraph([1, 'junk'])
```


gives similar output (they do not), and actually I have changed the output of


```
Poset({1: [2], 3: []}).is_antichain_of_poset([1,2,4])
```


to be an error message, not `False`.

However, if you do that, then this ticket should be postponed until that is ready.



---

archive/issue_comments_359203.json:
```json
{
    "body": "I prefer to have this ticket fixed now since it impacts other methods. For instance, `g.vertex_connectivity()` has special treatment for cliques. If `g.is_clique()` returns a wrong answer, then the answer of `g.vertex_connectivity()` is also wrong.\n\nWe can deal with the `subgraph` problem independently.",
    "created_at": "2018-07-11T12:51:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359203",
    "user": "@dcoudert"
}
```

I prefer to have this ticket fixed now since it impacts other methods. For instance, `g.vertex_connectivity()` has special treatment for cliques. If `g.is_clique()` returns a wrong answer, then the answer of `g.vertex_connectivity()` is also wrong.

We can deal with the `subgraph` problem independently.



---

archive/issue_comments_359204.json:
```json
{
    "body": "Replying to [comment:15 dcoudert]:\n> I prefer to have this ticket fixed now since it impacts other methods. For instance, `g.vertex_connectivity()` has special treatment for cliques. If `g.is_clique()` returns a wrong answer, then the answer of `g.vertex_connectivity()` is also wrong.\n> \n> We can deal with the `subgraph` problem independently.\n\nOK. I'll try to review this in a day or two.",
    "created_at": "2018-07-11T13:04:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359204",
    "user": "@jm58660"
}
```

Replying to [comment:15 dcoudert]:
> I prefer to have this ticket fixed now since it impacts other methods. For instance, `g.vertex_connectivity()` has special treatment for cliques. If `g.is_clique()` returns a wrong answer, then the answer of `g.vertex_connectivity()` is also wrong.
> 
> We can deal with the `subgraph` problem independently.

OK. I'll try to review this in a day or two.



---

archive/issue_comments_359205.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-07-12T06:19:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359205",
    "user": "@jm58660"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_359206.json:
```json
{
    "body": "Seems to be OK. (\"Trivially complicated code\", but there is no other way as there are so many combinations of parameters.)",
    "created_at": "2018-07-12T06:19:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359206",
    "user": "@jm58660"
}
```

Seems to be OK. ("Trivially complicated code", but there is no other way as there are so many combinations of parameters.)



---

archive/issue_comments_359207.json:
```json
{
    "body": "Thank you.",
    "created_at": "2018-07-12T07:10:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359207",
    "user": "@dcoudert"
}
```

Thank you.



---

archive/issue_comments_359208.json:
```json
{
    "body": "rc for 8.3 is already out.",
    "created_at": "2018-07-12T14:57:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359208",
    "user": "@jm58660"
}
```

rc for 8.3 is already out.



---

archive/issue_comments_359209.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-08-05T08:17:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25459#issuecomment-359209",
    "user": "@vbraun"
}
```

Resolution: fixed
