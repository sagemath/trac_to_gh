# Issue 29757: Add integral curves over QQ

Issue created by migration from https://trac.sagemath.org/ticket/29994

Original creator: klee

Original creation time: 2020-06-26 08:02:41

Refactor integral curves (over finite fields) code to allow integral curves over QQ.


---

Comment by git created at 2020-06-26 08:04:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by klee created at 2020-06-26 08:04:44

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2020-06-26 14:02:17

Thanks for working on this.

There's a duplicated doctest for `parametric_representation`.

```
+            sage: p.closed_point()
+            Point (x, y - 1)
+            sage: p.closed_point()
+            Point (x, y - 1)
```


In `Curve`, adding a comment on the special handling in the added case would be valuable.

```
             if k in Fields():
+                if k == QQ and A.coordinate_ring().ideal(F).is_prime():
+                    return IntegralAffineCurve(A, F)
                 return AffineCurve_field(A, F)
             return AffineCurve(A, F)
```

Also, this is repeated 4 times (for affine/projective, plane/general), so perhaps this can be refactored?

There are also some warnings from patchbot plugins.


---

Comment by git created at 2020-06-29 01:05:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by klee created at 2020-06-29 01:16:37

Replying to [comment:4 mkoeppe]:
 
> There's a duplicated doctest for `parametric_representation`.
> {{{
> +            sage: p.closed_point()
> +            Point (x, y - 1)
> +            sage: p.closed_point()
> +            Point (x, y - 1)
> }}}

Removed.

> In `Curve`, adding a comment on the special handling in the added case would be valuable.
> {{{
>              if k in Fields():
> +                if k == QQ and A.coordinate_ring().ideal(F).is_prime():
> +                    return IntegralAffineCurve(A, F)
>                  return AffineCurve_field(A, F)
>              return AffineCurve(A, F)
> }}}
> Also, this is repeated 4 times (for affine/projective, plane/general), so perhaps this can be refactored?

I did some refactoring in the constructor, but perhaps not for the case you commented on. 

For the special handling(?), I think the code explains itself. I don't see any helpful comment to add...
 
> There are also some warnings from patchbot plugins.

Fixed for patchbot warnings.


---

Comment by mkoeppe created at 2020-06-30 22:08:25

Changing status from needs_review to positive_review.


---

Comment by klee created at 2020-07-01 00:03:08

Replying to [comment:7 mkoeppe]:

Great! Thanks!


---

Comment by vbraun created at 2020-07-08 19:32:13

Resolution: fixed
