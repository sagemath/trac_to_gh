# Issue 12381: Add interface for PALP polytope databases

Issue created by migration from Trac.

Original creator: vbraun

Original creation time: 2012-02-21 07:16:03

Assignee: was

CC:  novoselt jdemeyer

Keywords: PALP reflexive polytopes

This ticket implements an interface to read databases of reflexive polytopes:
  * Add databases in PALP format to the `polytopes_db.spkg`. 
  * A class `PALPreader` that can read the palp output and yield it in various Sage representations.
  * Finally, this ticket contains a specialized PPL lattice polytope that is fast enough to construct to go through the 500 million 4-d reflexive polytopes and compute integral points.


---

Comment by vbraun created at 2012-02-21 07:20:56

Changing status from new to needs_review.


---

Comment by vbraun created at 2012-06-03 22:28:17

I've updated the patches with various minor improvements.


---

Comment by Snark created at 2012-06-11 15:46:39

I had a look and have some remarks to do:
* now spkg-install checks for SAGE_DATA before using SAGE_DATA (the one in sage 5.0 checks SAGE_ROOT before using SAGE_DATA...), which is good!
* the sources aren't in a directory src/ but in reflexive_polytopes/ -- isn't it against the conventions?
* both build.sh scripts lack a shebang ;
* is it normal that the installation is dumping everything in SAGE_DATA/reflexive_polytopes/ ? Shouldn't the spkg (1) depend on palp (2) in the build phase, use it to create the database (3) in the install phase, only install the resulting database?


---

Comment by vbraun created at 2012-06-11 16:20:52

I've added the shebang to the build.sh scripts, even though we are entering deep into bikeshedding territory here as these are not executed but only show how the database can be built.

I've also renamed the directory to `src/`, thats just something I inherited from the previous version.

All databases in Sage just copy their content. Usually they require non-trivial computer resources to build, so you specifically don't want to recompute them when you are installing Sage. In this case its actually computationally easy, but just wait until we add the 4-d case ;-)


---

Comment by Snark created at 2012-06-11 16:53:09

Copying the contents is ok -- what bothers me is that you copy the scripts too.

You says that "these are not executed but only show how the database can be built" -- does that mean you don't guarantee they effectively work?


---

Comment by vbraun created at 2012-06-11 17:01:18

Well you have my word that the scripts work :-P I think having the scripts is better than not having them. Who cares if they end up in the database directory or not.


---

Comment by Snark created at 2012-06-11 18:13:48

I see two reasons to care:
1. sage is big enough ;
2. if it's not data, it doesn't belong to SAGE_DATA.


---

Comment by vbraun created at 2012-06-11 18:27:12

Lets call it documentation, then, shall we?


---

Comment by Snark created at 2012-06-11 19:15:36

If it's documentation, it belongs into SAGE_DOC ; installing things in correct places isn't as frivolous as you seem to think...


---

Comment by vbraun created at 2012-06-12 17:56:23

`$SAGE_DOC` contains docs like the developer manual. You want me to typeset the script in sphinx and include it in the developer manual? That doesn't sound reasonable to me.


---

Comment by Snark created at 2012-06-12 18:16:56

Why not just cp the right files into $SAGE_DATA?


---

Comment by vbraun created at 2012-06-12 19:05:53

I've deleted the build.sh scripts. Updated spkg at the same location.


---

Comment by vbraun created at 2012-07-01 16:27:13

Updating the database patch for the new `PointCollection` output introduced in #12544, which is one of the possible output formats.


---

Comment by vbraun created at 2012-07-01 16:27:26

Updated patch


---

Attachment

Rediffed patch


---

Attachment

can this ticket be rebased so that it does not depend upon anything that is in `sage-pending`, such as #11310 ?


---

Comment by vbraun created at 2012-07-09 14:54:49

I **think** Jeroen just used sage-pending in #11310 since we didn't have a sage-5.3 milestone at that time and sage-5.2 is supposed to be just a new sagenb + trivial tickets. But maybe Jeroen had some other reason?


---

Comment by jdemeyer created at 2012-07-09 14:59:03

It's mainly because of #13109.  The current plan is to merge #13109 in sage-5.2 but all follow-ups (including #11310) in sage-5.3.  It's certainly not meant to be a long-term sage-pending.


---

Comment by novoselt created at 2012-07-25 18:58:58

Hi Volker, do you actually have the package for 4d polytopes which is mentioned in the patch documentation?

(By the way, maybe `polytopes_reflexive_4d_db` would be a better name for it?)


---

Comment by vbraun created at 2012-08-04 15:09:39

Sorry forgot to reply.. I haven't packaged the 4d database... 10 GB spkg? ;-) But the updated spkg contains the 2d and 3d analogues in PALP's binary database format.


---

Comment by dimpase created at 2013-04-17 16:11:09

somewhere down in the first patch you have

```
The database is very large and not installed by default. You can 
install it with the command ``install_package('polytopes_db_4d')``.
```

but this does not work. Was it meant to be added later?


---

Comment by vbraun created at 2013-04-17 17:27:05

Yes. Though there is also the question whether we want to host a 4+gb database (and I don't have a firm opinion either way)


---

Comment by vbraun created at 2013-04-17 18:26:02

For fun: http://boxen.math.washington.edu/home/vbraun/www/polytopes_db_4d-1.0.spkg

Still takes a day or so to upload...


---

Comment by dimpase created at 2013-04-18 08:54:44

Replying to [comment:22 vbraun]:
> Yes. Though there is also the question whether we want to host a 4+gb database (and I don't have a firm opinion either way)
IMHO, if it is hosted elsewhere, we might rather want to host an interface only.
Anyhow that comment in the source about `install_package('polytopes_db_4d')` is misleading, and should be rectified.


---

Comment by vbraun created at 2013-04-20 15:15:19

Updated `polytopes_db-20120220.spkg` to merge in the changes that others have done in the year+ that it has been lingering here.


---

Comment by vbraun created at 2013-04-20 15:29:06

I made a ticket for the 4-d database at #14467.


---

Comment by dimpase created at 2013-04-22 06:16:16

Replying to [comment:25 vbraun]:
> Updated `polytopes_db-20120220.spkg` to merge in the changes that others have done in the year+ that it has been lingering here.
This spkg can only be found on `http://www.stp.dias.ie/~vbraun/Sage/spkg/`.
Is this how this is meant to be?


---

Comment by vbraun created at 2013-04-22 08:44:00

I'm leaving Ireland and my DIAS account will be closed in the coming weeks. I uploaded the spkg to boxen, and this is where it should be. The link in the ticket description works for me.


---

Comment by dimpase created at 2013-04-25 06:04:22

Replying to [comment:28 vbraun]:
> I'm leaving Ireland and my DIAS account will be closed in the coming weeks. I uploaded the spkg to boxen, and this is where it should be. The link in the ticket description works for me.

Wohin, Volker?


---

Comment by dimpase created at 2013-04-25 06:04:22

Changing status from needs_review to positive_review.


---

Attachment

Updated patch


---

Comment by jdemeyer created at 2013-05-08 07:44:01

Resolution: fixed
