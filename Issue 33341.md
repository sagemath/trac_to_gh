# Issue 33341: Add VS code config for debbuing doctests

archive/issues_033341.json:
```json
{
    "body": "CC:  @mkoeppe\n\nAdd VS code launch config that allows running and debugging doctests in an active file. To test (should work on gitpod as well):\n- Open some python file\n- Go to \"Run & Debug\" tab by clicking the play symbol with the little bug on it on the very left (or Ctrl + Shift + D)\n- Next to the green play button at the top, select \"Sage: Test\" from the dropdown, then click the play button.\n\nIssue created by migration from https://trac.sagemath.org/ticket/33578\n\n",
    "created_at": "2022-03-27T13:46:58Z",
    "labels": [
        "component: doctest framework"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.6",
    "title": "Add VS code config for debbuing doctests",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33341",
    "user": "https://github.com/tobiasdiez"
}
```
CC:  @mkoeppe

Add VS code launch config that allows running and debugging doctests in an active file. To test (should work on gitpod as well):
- Open some python file
- Go to "Run & Debug" tab by clicking the play symbol with the little bug on it on the very left (or Ctrl + Shift + D)
- Next to the green play button at the top, select "Sage: Test" from the dropdown, then click the play button.

Issue created by migration from https://trac.sagemath.org/ticket/33578





---

archive/issue_comments_474104.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-03-27T13:47:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474104",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_474105.json:
```json
{
    "body": "This would probably be better with `sage -t --verbose`",
    "created_at": "2022-03-27T18:09:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474105",
    "user": "https://github.com/mkoeppe"
}
```

This would probably be better with `sage -t --verbose`



---

archive/issue_comments_474106.json:
```json
{
    "body": "It's not running within `sage-env`, so lots of doctest failures happen.",
    "created_at": "2022-03-27T18:39:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474106",
    "user": "https://github.com/mkoeppe"
}
```

It's not running within `sage-env`, so lots of doctest failures happen.



---

archive/issue_comments_474107.json:
```json
{
    "body": "Also a behavior like `./sage -t --debug` would be good, which drops into the debugger on failure.",
    "created_at": "2022-03-27T18:43:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474107",
    "user": "https://github.com/mkoeppe"
}
```

Also a behavior like `./sage -t --debug` would be good, which drops into the debugger on failure.



---

archive/issue_comments_474108.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-03-27T18:44:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474108",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_474109.json:
```json
{
    "body": "Replying to [comment:4 mkoeppe]:\n> It's not running within `sage-env`, so lots of doctest failures happen.\n> \n\nI think this is not easily possible as I have to specify a python script as the \"program\".",
    "created_at": "2022-03-27T19:02:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474109",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:4 mkoeppe]:
> It's not running within `sage-env`, so lots of doctest failures happen.
> 

I think this is not easily possible as I have to specify a python script as the "program".



---

archive/issue_comments_474110.json:
```json
{
    "body": "Replying to [comment:2 mkoeppe]:\n> This would probably be better with `sage -t --verbose`\n\nDo you think that's generally helpful? Some of the python files contain quite some tests, so the output may be quite overwhelming.",
    "created_at": "2022-03-27T19:03:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474110",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:2 mkoeppe]:
> This would probably be better with `sage -t --verbose`

Do you think that's generally helpful? Some of the python files contain quite some tests, so the output may be quite overwhelming.



---

archive/issue_comments_474111.json:
```json
{
    "body": "Replying to [comment:5 mkoeppe]:\n> Also a behavior like `./sage -t --debug` would be good, which drops into the debugger on failure.\n\nEverything is already run in the debugger and things like \"break on error\" can be configured there.",
    "created_at": "2022-03-27T19:05:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474111",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:5 mkoeppe]:
> Also a behavior like `./sage -t --debug` would be good, which drops into the debugger on failure.

Everything is already run in the debugger and things like "break on error" can be configured there.



---

archive/issue_comments_474112.json:
```json
{
    "body": "Replying to [comment:9 gh-tobiasdiez]:\n> Everything is already run in the debugger and things like \"break on error\" can be configured there.\n\nBut the doctest framework catches the exceptions",
    "created_at": "2022-03-27T19:09:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474112",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:9 gh-tobiasdiez]:
> Everything is already run in the debugger and things like "break on error" can be configured there.

But the doctest framework catches the exceptions



---

archive/issue_comments_474113.json:
```json
{
    "body": "Replying to [comment:8 gh-tobiasdiez]:\n> Replying to [comment:2 mkoeppe]:\n> > This would probably be better with `sage -t --verbose`\n> \n> Do you think that's generally helpful? Some of the python files contain quite some tests, so the output may be quite overwhelming.\n\nMostly in conjunction with dropping the user into the debugger",
    "created_at": "2022-03-27T19:09:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474113",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:8 gh-tobiasdiez]:
> Replying to [comment:2 mkoeppe]:
> > This would probably be better with `sage -t --verbose`
> 
> Do you think that's generally helpful? Some of the python files contain quite some tests, so the output may be quite overwhelming.

Mostly in conjunction with dropping the user into the debugger



---

archive/issue_comments_474114.json:
```json
{
    "body": "Replying to [comment:7 gh-tobiasdiez]:\n> Replying to [comment:4 mkoeppe]:\n> > It's not running within `sage-env`, so lots of doctest failures happen.\n> \n> I think this is not easily possible as I have to specify a python script as the \"program\". \n\nIt would probably already help to include `SAGE_LOCAL/bin` in PATH until #30818 is done",
    "created_at": "2022-03-27T19:17:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474114",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:7 gh-tobiasdiez]:
> Replying to [comment:4 mkoeppe]:
> > It's not running within `sage-env`, so lots of doctest failures happen.
> 
> I think this is not easily possible as I have to specify a python script as the "program". 

It would probably already help to include `SAGE_LOCAL/bin` in PATH until #30818 is done



---

archive/issue_comments_474115.json:
```json
{
    "body": "Replying to [comment:10 mkoeppe]:\n> Replying to [comment:9 gh-tobiasdiez]:\n> > Everything is already run in the debugger and things like \"break on error\" can be configured there.\n> \n> But the doctest framework catches the exceptions\n\nThe debug statement doesn't play nicely with vscode debugger (it breaks in the console but not in the vs code debugger).",
    "created_at": "2022-03-28T08:51:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474115",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:10 mkoeppe]:
> Replying to [comment:9 gh-tobiasdiez]:
> > Everything is already run in the debugger and things like "break on error" can be configured there.
> 
> But the doctest framework catches the exceptions

The debug statement doesn't play nicely with vscode debugger (it breaks in the console but not in the vs code debugger).



---

archive/issue_comments_474116.json:
```json
{
    "body": "Replying to [comment:11 mkoeppe]:\n> Replying to [comment:8 gh-tobiasdiez]:\n> > Replying to [comment:2 mkoeppe]:\n> > > This would probably be better with `sage -t --verbose`\n> > \n> > Do you think that's generally helpful? Some of the python files contain quite some tests, so the output may be quite overwhelming.\n> \n> Mostly in conjunction with dropping the user into the debugger\n\nAdded although I still find it not very helpful.",
    "created_at": "2022-03-28T08:52:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474116",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:11 mkoeppe]:
> Replying to [comment:8 gh-tobiasdiez]:
> > Replying to [comment:2 mkoeppe]:
> > > This would probably be better with `sage -t --verbose`
> > 
> > Do you think that's generally helpful? Some of the python files contain quite some tests, so the output may be quite overwhelming.
> 
> Mostly in conjunction with dropping the user into the debugger

Added although I still find it not very helpful.



---

archive/issue_comments_474117.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-03-28T08:52:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474117",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_474118.json:
```json
{
    "body": "Replying to [comment:12 mkoeppe]:\n> Replying to [comment:7 gh-tobiasdiez]:\n> > Replying to [comment:4 mkoeppe]:\n> > > It's not running within `sage-env`, so lots of doctest failures happen.\n> > \n> > I think this is not easily possible as I have to specify a python script as the \"program\". \n> \n> It would probably already help to include `SAGE_LOCAL/bin` in PATH until #30818 is done\n\nI can set env variables (using `env`) but don't know how to append things. As #30818 is also making good process I don't thing this is very important.",
    "created_at": "2022-03-28T08:53:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474118",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:12 mkoeppe]:
> Replying to [comment:7 gh-tobiasdiez]:
> > Replying to [comment:4 mkoeppe]:
> > > It's not running within `sage-env`, so lots of doctest failures happen.
> > 
> > I think this is not easily possible as I have to specify a python script as the "program". 
> 
> It would probably already help to include `SAGE_LOCAL/bin` in PATH until #30818 is done

I can set env variables (using `env`) but don't know how to append things. As #30818 is also making good process I don't thing this is very important.



---

archive/issue_comments_474119.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-28T08:54:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474119",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_474120.json:
```json
{
    "body": "Replying to [comment:13 gh-tobiasdiez]:\n> Replying to [comment:10 mkoeppe]:\n> > Replying to [comment:9 gh-tobiasdiez]:\n> > > Everything is already run in the debugger and things like \"break on error\" can be configured there.\n> > \n> > But the doctest framework catches the exceptions\n> \n> The debug statement doesn't play nicely with vscode debugger (it breaks in the console but not in the vs code debugger).\n\nYes, `--debug` explicitly invokes pdb. So we would need an option to just raise an exception on failure.",
    "created_at": "2022-03-28T16:09:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474120",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:13 gh-tobiasdiez]:
> Replying to [comment:10 mkoeppe]:
> > Replying to [comment:9 gh-tobiasdiez]:
> > > Everything is already run in the debugger and things like "break on error" can be configured there.
> > 
> > But the doctest framework catches the exceptions
> 
> The debug statement doesn't play nicely with vscode debugger (it breaks in the console but not in the vs code debugger).

Yes, `--debug` explicitly invokes pdb. So we would need an option to just raise an exception on failure.



---

archive/issue_comments_474121.json:
```json
{
    "body": "Yes, that would be a small improvement. VS code also provides the option to break whenever an exception is raised (in user code). This should be good enough (combined with the option to ignore certain exceptions). (Moreover, once we switch to pytest, this will be handled automatically as exceptions reaching pytest count as \"unhandled\".)",
    "created_at": "2022-03-28T17:53:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474121",
    "user": "https://github.com/tobiasdiez"
}
```

Yes, that would be a small improvement. VS code also provides the option to break whenever an exception is raised (in user code). This should be good enough (combined with the option to ignore certain exceptions). (Moreover, once we switch to pytest, this will be handled automatically as exceptions reaching pytest count as "unhandled".)



---

archive/issue_comments_474122.json:
```json
{
    "body": "Can we please get this in?",
    "created_at": "2022-04-16T21:39:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474122",
    "user": "https://github.com/tobiasdiez"
}
```

Can we please get this in?



---

archive/issue_comments_474123.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-04-16T22:22:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474123",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_474124.json:
```json
{
    "body": "Thanks!",
    "created_at": "2022-04-17T21:27:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474124",
    "user": "https://github.com/tobiasdiez"
}
```

Thanks!



---

archive/issue_comments_474125.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2022-05-07T18:35:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474125",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_474126.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-05-12T21:42:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33341#issuecomment-474126",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
