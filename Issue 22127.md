# Issue 22127: Upgrade to pynac-0.7.5

Issue created by migration from Trac.

Original creator: rws

Original creation time: 2017-02-12 16:20:25

Pynac-0.7.5 has
- crucial improvements to Gosper algorithm
- pynac.pc additions

https://github.com/pynac/pynac/releases/download/pynac-0.7.5/pynac-0.7.5.tar.bz2


---

Comment by rws created at 2017-02-12 16:25:36

Changing status from new to needs_review.


---

Comment by rws created at 2017-02-12 16:28:27

New commits:


---

Comment by vbraun created at 2017-02-14 20:09:53

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-02-17 20:07:12


```
sage -t --long --warn-long 79.1 src/sage/functions/orthogonal_polys.py
**********************************************************************
File "src/sage/functions/orthogonal_polys.py", line 1884, in sage.functions.orthogonal_polys.Func_jacobi_P._eval_
Failed example:
    jacobi_P(1,n,n,n)
Expected:
    (n + 1)*n
Got:
    (n + 1)*((n - 1)*gamma(2*n + 2)/gamma(n + 1) + gamma(2*n + 2)/gamma(n + 1))*gamma(n + 1)/gamma(2*n + 2)
**********************************************************************
File "src/sage/functions/orthogonal_polys.py", line 1888, in sage.functions.orthogonal_polys.Func_jacobi_P._eval_
Failed example:
    jacobi_P(1,n,n,x)
Expected:
    (n + 1)*x
Got:
    (n + 1)*((x - 1)*gamma(2*n + 2)/gamma(n + 1) + gamma(2*n + 2)/gamma(n + 1))*gamma(n + 1)/gamma(2*n + 2)
**********************************************************************
1 item had failures:
   2 of  13 in sage.functions.orthogonal_polys.Func_jacobi_P._eval_
    [378 tests, 2 failures, 7.87 s]
----------------------------------------------------------------------
sage -t --long --warn-long 79.1 src/sage/functions/orthogonal_polys.py  # 2 doctests failed
----------------------------------------------------------------------
Total time for all tests: 8.1 seconds
    cpu time: 5.3 seconds
    cumulative wall time: 7.9 seconds
```



---

Comment by vbraun created at 2017-02-17 20:07:12

Changing status from positive_review to needs_work.


---

Comment by git created at 2017-02-19 06:11:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2017-02-19 06:12:19

Changing status from needs_work to needs_review.


---

Comment by vbraun created at 2017-02-20 00:38:39

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-02-23 11:58:18

I'm getting this on 32-bit 

```
sage -t --long src/sage/functions/orthogonal_polys.py
**********************************************************************
File "src/sage/functions/orthogonal_polys.py", line 1886, in sage.functions.orthogonal_polys.Func_jacobi_P._eval_
Failed example:
    jacobi_P(2,n,n,n)
Expected:
    1/4*(2*n - 1)*(n + 2)*(n + 1)^2
Got:
    1/4*(2*n^2 + n - 1)*(n + 2)*(n + 1)
**********************************************************************
1 item had failures:
   1 of  13 in sage.functions.orthogonal_polys.Func_jacobi_P._eval_
    [378 tests, 1 failure, 8.03 s]
```



---

Comment by vbraun created at 2017-02-23 11:59:52

There are some more, possibly related to #22057

```
sage -t --long src/sage/symbolic/expression.pyx
**********************************************************************
File "src/sage/symbolic/expression.pyx", line 6729, in sage.symbolic.expression.Expression.resultant
Failed example:
    (x+y).resultant(x-y, x)
Expected:
    -2*y
Got:
    2*x
**********************************************************************
File "src/sage/symbolic/expression.pyx", line 6732, in sage.symbolic.expression.Expression.resultant
Failed example:
    r.coefficient(a^4)
Expected:
    b^4*y^2 - 4*b^3*y^3 + 6*b^2*y^4 - 4*b*y^5 + y^6
Got:
    0
**********************************************************************
1 item had failures:
   2 of   7 in sage.symbolic.expression.Expression.resultant
    [2670 tests, 2 failures, 35.16 s]
```



---

Comment by vbraun created at 2017-02-23 12:00:34

Changing status from positive_review to needs_work.


---

Comment by rws created at 2017-02-23 16:12:41

What's the easiest way to build a 32bit Sage for debugging this? Volker, can you give me an account?


---

Comment by rws created at 2017-02-23 16:22:25

Hold on, I confirm there is a problem with resultants when I merge #22057 into this.,


---

Comment by rws created at 2017-02-23 16:28:54

As there were 32bit problems with Giac I think it would be safer if we used Singular on 32bit instead. Fortunately I provided for such build-time switching. Now this should just be a matter of spkg-install...


---

Comment by rws created at 2017-02-25 07:31:59

On the other hand failure on 32 bit indicates underlying bugs so, sadly, I'll switch off Giac support again until #22101 and #22280 have been sorted out and then try again. If the 32 bit problems persist then at least we know it's not Giac in this case.


---

Comment by git created at 2017-02-25 07:51:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2017-02-25 07:51:43

Changing status from needs_work to needs_review.


---

Comment by vbraun created at 2017-02-25 12:28:00

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-03-01 18:51:15

Resolution: fixed


---

Comment by fbissey created at 2017-03-05 02:09:38

Something weird is happening to me here in sage-on-gentoo. Tests were OK after merging of this and #22057. Now that we have moved past 7.6.beta6 (I work off Volker's tree usually) I have the failures in `symbolic/expression.pyx` and `functions/orthogonal_polys.py` again. For the later it is even stranger, I get the failure only the first time I run the test, subsequent testing of `functions/orthogonal_polys.py` pass but not `symbolic/expression.pyx`.

Could it be caused by ginac, since I still have it enabled in pynac? But why would it re-appear after 7.6.beta6 has been released?


---

Comment by rws created at 2017-03-05 07:12:57

Replying to [comment:22 fbissey]:
> Could it be caused by ginac, since I still have it enabled in pynac? But why would it re-appear after 7.6.beta6 has been released?

Giac? Yes that's why I disabled it again (comment:17). On the other hand if the problems persist even when you disable it too, then please open a ticket because that would be unexpected.
