# Issue 15181: %timeit in notebook

archive/issues_015181.json:
```json
{
    "body": "CC:  chapoton\n\nKeywords: notebook, timeit\n\nIn the notebook\n\n```\n%timeit\n1+1\n```\n\ngives\n\n```\n2\nCPU time: 0.00 s,  Wall time: 0.00 s\n```\n\nwhereas\n\n```\ntimeit(\"1+1\")\n```\n\ngives\n\n```\n625 loops, best of 3: 806 ns per loop\n```\n\nas it should.\n\nIn contrast, at the sage command line we get\n\n```\nsage: timeit(\"1+1\")\n625 loops, best of 3: 886 ns per loop\nsage: %timeit 1+1\n1000000 loops, best of 3: 309 ns per loop\n```\n\n\nThis is inconsistent, the notebook `%timeit` should also return something like `625 loops, best of 3: 806 ns per loop`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/15418\n\n",
    "created_at": "2013-11-14T10:23:02Z",
    "labels": [
        "notebook",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "%timeit in notebook",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15181",
    "user": "dkrenn"
}
```
CC:  chapoton

Keywords: notebook, timeit

In the notebook

```
%timeit
1+1
```

gives

```
2
CPU time: 0.00 s,  Wall time: 0.00 s
```

whereas

```
timeit("1+1")
```

gives

```
625 loops, best of 3: 806 ns per loop
```

as it should.

In contrast, at the sage command line we get

```
sage: timeit("1+1")
625 loops, best of 3: 886 ns per loop
sage: %timeit 1+1
1000000 loops, best of 3: 309 ns per loop
```


This is inconsistent, the notebook `%timeit` should also return something like `625 loops, best of 3: 806 ns per loop`.

Issue created by migration from https://trac.sagemath.org/ticket/15418





---

archive/issue_comments_194952.json:
```json
{
    "body": "Interesting.  You may also want to report this [upstream](https://github.com/sagemath/sagenb) as well, if it hasn't been already.",
    "created_at": "2013-11-15T03:36:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15181",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15181#issuecomment-194952",
    "user": "kcrisman"
}
```

Interesting.  You may also want to report this [upstream](https://github.com/sagemath/sagenb) as well, if it hasn't been already.



---

archive/issue_comments_194953.json:
```json
{
    "body": "I can confirm this - because we don't actually use timeit to handle timeit, apparently it all goes the same place\n\n```\n        return ('time' in self.percent_directives() or\n                'timeit' in self.percent_directives() or\n                getattr(self, '_time', False))\n```\n\nin cell.py.",
    "created_at": "2014-12-19T04:28:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15181",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15181#issuecomment-194953",
    "user": "kcrisman"
}
```

I can confirm this - because we don't actually use timeit to handle timeit, apparently it all goes the same place

```
        return ('time' in self.percent_directives() or
                'timeit' in self.percent_directives() or
                getattr(self, '_time', False))
```

in cell.py.



---

archive/issue_comments_194954.json:
```json
{
    "body": "https://github.com/sagemath/sagenb/issues/316",
    "created_at": "2014-12-19T04:29:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15181",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15181#issuecomment-194954",
    "user": "kcrisman"
}
```

https://github.com/sagemath/sagenb/issues/316



---

archive/issue_comments_194955.json:
```json
{
    "body": "See also #17127.",
    "created_at": "2015-06-03T18:08:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15181",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15181#issuecomment-194955",
    "user": "kcrisman"
}
```

See also #17127.



---

archive/issue_comments_194956.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-08-18T00:36:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15181",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15181#issuecomment-194956",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_194957.json:
```json
{
    "body": "Proposing to close all sagenb tickets as outdated, so that all remaining open tickets in the notebook component are about the Jupyter notebook.",
    "created_at": "2020-08-18T00:36:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15181",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15181#issuecomment-194957",
    "user": "mkoeppe"
}
```

Proposing to close all sagenb tickets as outdated, so that all remaining open tickets in the notebook component are about the Jupyter notebook.



---

archive/issue_comments_194958.json:
```json
{
    "body": "ok",
    "created_at": "2020-10-20T19:14:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15181",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15181#issuecomment-194958",
    "user": "chapoton"
}
```

ok



---

archive/issue_comments_194959.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2020-10-20T19:14:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15181",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15181#issuecomment-194959",
    "user": "chapoton"
}
```

Resolution: invalid
