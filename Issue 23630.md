# Issue 23630: Fix SciPy lil_matrix() with Sage Integers

archive/issues_023630.json:
```json
{
    "body": "CC:  @zimmermann6\n\nSince the upgrade to SciPy 0.19.1, this is broken:\n\n```\nsage: from scipy.sparse import lil_matrix\nsage: lil_matrix((100,100))\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-2-63750b5b39bc> in <module>()\n----> 1 lil_matrix((Integer(100),Integer(100)))\n\n/usr/local/src/sage-config/local/lib/python2.7/site-packages/scipy/sparse/lil.py in __init__(self, arg1, shape, dtype, copy)\n    112                     self.data[i] = []\n    113             else:\n--> 114                 raise TypeError('unrecognized lil_matrix constructor usage')\n    115         else:\n    116             # assume A is dense\n\nTypeError: unrecognized lil_matrix constructor usage\n```\n\n\n**Upstream**:\n1. https://github.com/scipy/scipy/issues/7860\n2. https://github.com/numpy/numpy/pull/9691\n\nIssue created by migration from https://trac.sagemath.org/ticket/23867\n\n",
    "created_at": "2017-09-15T11:01:13Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Fix SciPy lil_matrix() with Sage Integers",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23630",
    "user": "https://github.com/jdemeyer"
}
```
CC:  @zimmermann6

Since the upgrade to SciPy 0.19.1, this is broken:

```
sage: from scipy.sparse import lil_matrix
sage: lil_matrix((100,100))
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-2-63750b5b39bc> in <module>()
----> 1 lil_matrix((Integer(100),Integer(100)))

/usr/local/src/sage-config/local/lib/python2.7/site-packages/scipy/sparse/lil.py in __init__(self, arg1, shape, dtype, copy)
    112                     self.data[i] = []
    113             else:
--> 114                 raise TypeError('unrecognized lil_matrix constructor usage')
    115         else:
    116             # assume A is dense

TypeError: unrecognized lil_matrix constructor usage
```


**Upstream**:
1. https://github.com/scipy/scipy/issues/7860
2. https://github.com/numpy/numpy/pull/9691

Issue created by migration from https://trac.sagemath.org/ticket/23867





---

archive/issue_comments_330593.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-09-15T11:33:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23630#issuecomment-330593",
    "user": "https://github.com/jdemeyer"
}
```

New commits:



---

archive/issue_comments_330594.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-09-15T11:33:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23630#issuecomment-330594",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_330595.json:
```json
{
    "body": "is that a temporary fix, waiting for the numpy/scipy issue to be fixed, and that will be removed afterwards?",
    "created_at": "2017-09-15T11:42:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23630#issuecomment-330595",
    "user": "https://github.com/zimmermann6"
}
```

is that a temporary fix, waiting for the numpy/scipy issue to be fixed, and that will be removed afterwards?



---

archive/issue_comments_330596.json:
```json
{
    "body": "Replying to [comment:5 zimmerma]:\n> is that a temporary fix, waiting for the numpy/scipy issue to be fixed, and that will be removed afterwards?\n\nYes, exactly.",
    "created_at": "2017-09-15T11:55:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23630#issuecomment-330596",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:5 zimmerma]:
> is that a temporary fix, waiting for the numpy/scipy issue to be fixed, and that will be removed afterwards?

Yes, exactly.



---

archive/issue_comments_330597.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-09-16T14:56:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23630#issuecomment-330597",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_330598.json:
```json
{
    "body": "Upstream has essentially accepted the PR, and everything else LGTM.",
    "created_at": "2017-09-16T14:56:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23630#issuecomment-330598",
    "user": "https://github.com/tscrim"
}
```

Upstream has essentially accepted the PR, and everything else LGTM.



---

archive/issue_events_022136.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-09-20T22:26:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23630",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23630#event-22136"
}
```



---

archive/issue_comments_330599.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-09-20T22:26:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23630#issuecomment-330599",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_330600.json:
```json
{
    "body": "just a question: since this is a temporary fix, is there a way to ensure we don't forget to revert it when the issue is fixed upstream?",
    "created_at": "2017-09-21T08:03:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23630#issuecomment-330600",
    "user": "https://github.com/zimmermann6"
}
```

just a question: since this is a temporary fix, is there a way to ensure we don't forget to revert it when the issue is fixed upstream?



---

archive/issue_comments_330601.json:
```json
{
    "body": "Replying to [comment:12 zimmerma]:\n> just a question: since this is a temporary fix, is there a way to ensure we don't forget to revert it when the issue is fixed upstream?\n\nIf `numpy` accepts the Sage patch, we will notice that the Sage patch to `numpy` no longer applies when we upgrade `numpy`.",
    "created_at": "2017-09-21T08:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23630#issuecomment-330601",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:12 zimmerma]:
> just a question: since this is a temporary fix, is there a way to ensure we don't forget to revert it when the issue is fixed upstream?

If `numpy` accepts the Sage patch, we will notice that the Sage patch to `numpy` no longer applies when we upgrade `numpy`.
