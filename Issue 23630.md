# Issue 23630: Fix SciPy lil_matrix() with Sage Integers

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2017-09-15 11:01:13

CC:  zimmerma

Since the upgrade to SciPy 0.19.1, this is broken:

```
sage: from scipy.sparse import lil_matrix
sage: lil_matrix((100,100))
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-2-63750b5b39bc> in <module>()
----> 1 lil_matrix((Integer(100),Integer(100)))

/usr/local/src/sage-config/local/lib/python2.7/site-packages/scipy/sparse/lil.py in __init__(self, arg1, shape, dtype, copy)
    112                     self.data[i] = []
    113             else:
--> 114                 raise TypeError('unrecognized lil_matrix constructor usage')
    115         else:
    116             # assume A is dense

TypeError: unrecognized lil_matrix constructor usage
```


*Upstream*:
1. https://github.com/scipy/scipy/issues/7860
2. https://github.com/numpy/numpy/pull/9691


---

Comment by jdemeyer created at 2017-09-15 11:33:13

New commits:


---

Comment by jdemeyer created at 2017-09-15 11:33:13

Changing status from new to needs_review.


---

Comment by zimmerma created at 2017-09-15 11:42:26

is that a temporary fix, waiting for the numpy/scipy issue to be fixed, and that will be removed afterwards?


---

Comment by jdemeyer created at 2017-09-15 11:55:36

Replying to [comment:5 zimmerma]:
> is that a temporary fix, waiting for the numpy/scipy issue to be fixed, and that will be removed afterwards?

Yes, exactly.


---

Comment by tscrim created at 2017-09-16 14:56:22

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2017-09-16 14:56:22

Upstream has essentially accepted the PR, and everything else LGTM.


---

Comment by vbraun created at 2017-09-20 22:26:23

Resolution: fixed


---

Comment by zimmerma created at 2017-09-21 08:03:41

just a question: since this is a temporary fix, is there a way to ensure we don't forget to revert it when the issue is fixed upstream?


---

Comment by jdemeyer created at 2017-09-21 08:30:03

Replying to [comment:12 zimmerma]:
> just a question: since this is a temporary fix, is there a way to ensure we don't forget to revert it when the issue is fixed upstream?

If `numpy` accepts the Sage patch, we will notice that the Sage patch to `numpy` no longer applies when we upgrade `numpy`.
