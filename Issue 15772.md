# Issue 15772: Compute rank of elliptic curve defined over relative number field

Issue created by migration from https://trac.sagemath.org/ticket/16009

Original creator: mmasdeu

Original creation time: 2014-03-25 13:43:42

CC:  cremona pbruin

Keywords: descent, rank, elliptic curve, relative number field

Currently the following fails:


```
sage: x = QQ['x'].gen()
sage: F.<a> = QuadraticField(5)
sage: K.<b> = F.extension(x^2-3)
sage: E = EllipticCurve(K,[0,0,0,b,1])
sage: E.rank()
```


This is because the sage function wrapping around Denis Simon's two-descent script does not consider relative number fields.

I propose an easy fix for it.



---

Comment by mmasdeu created at 2014-03-25 13:50:31

New commits:


---

Comment by mmasdeu created at 2014-03-25 13:50:31

Changing status from new to needs_review.


---

Comment by pbruin created at 2014-03-25 17:06:27

Looks good and passes all tests.  The new doctest does take a long time (4 minutes), but that is probably hard to avoid.  Two comments:
- use your real name for the "Authors" field
- the documentation line starting with "An example with" should be indented
After fixing those, feel free to set this to positive review.


---

Comment by pbruin created at 2014-03-25 17:06:27

Changing status from needs_review to needs_work.


---

Comment by cremona created at 2014-03-25 17:21:35

Please try to find a shorter doctest!  Even when tagged with "long time" 4 minutes is going to add quite a lot to the testing time.

But thanks for doing this, anyway.


---

Comment by git created at 2014-03-25 17:21:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-03-25 17:54:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmasdeu created at 2014-03-25 17:56:13

Changing status from needs_work to positive_review.


---

Comment by pbruin created at 2014-03-25 18:00:21

This long example, and the special `lim1` and `limtriv` in your last commit, make it sound like a good moment to look into #9322, which should generally speed up `simon_two_descent()` by changing the parameters.


---

Comment by pbruin created at 2014-03-25 18:34:11

The old example would be more than twice as fast with Simon's default parameters:

```
sage: %timeit -n 1 -r 1 E.rank(lim1=2,lim3=4,limtriv=2)
1 loops, best of 1: 1min 42s per loop
```

So indeed fixing #9322 would help.

Another thing: `E.torsion_subgroup()` fails as well, I've opened ticket #16011 for it.


---

Comment by pbruin created at 2014-03-26 21:03:08

The doctest in the last commit turns out to break (return an incorrect result) after #11005.  Marc and I could reproduce this using Simon's script inside `gp`.  We will mark the doctest with `# known bug` and report the bug to Denis Simon.


---

Comment by pbruin created at 2014-03-26 21:03:08

Changing status from positive_review to needs_work.


---

Comment by git created at 2014-03-27 11:24:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmasdeu created at 2014-03-27 11:50:54

Changing status from needs_work to needs_review.


---

Comment by mmasdeu created at 2014-03-27 11:50:54

I merged #16022 and now the it passes the doctests.


---

Comment by pbruin created at 2014-03-27 12:22:47

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-03-31 14:57:34

Resolution: fixed
