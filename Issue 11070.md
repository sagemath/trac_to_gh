# Issue 11070: python spkg build fails on Ubuntu 11.04

Issue created by migration from https://trac.sagemath.org/ticket/11242

Original creator: pipedream

Original creation time: 2011-04-23 15:31:36

Assignee: GeorgSWeber

Keywords: python crypt natty

I found this build failure with sage 4.6.2 on Ubuntu 11.04 64bit beta2. I believe it affects all sage versions, all arches, on Ubuntu 11.04 and higher.

http://groups.google.com/group/sage-devel/browse_thread/thread/593b9a4124f5075d

Report upstream: Ubuntu already patch their python as I propose to patch the sage python with one line to build the crypt module with -lcrypt. Upstream python does not build on Ubuntu without this patch, and this one line suffices. Upstream python says this is because Ubuntu 11.04 introduced some multiarch support. More details in the google thread and the python bug referred to in that thread.

Files changed in the attached spkg:
patches/Setup.dist
patches/Setup.dist.patch 
spkg-install
SPKG.txt
changelog

This needs testing on other releases, distros, and OSes. If it breaks building on other systems a specific check for Ubuntu can be added with [ "x`lsb_release -d`" == "xDescription: Ubuntu 11.04" (after 1 May 2011 when this release is out). Then the patch can only be applied for that specific version of Ubuntu. 

This spkg can be tested with sage -f python-2.6.4.p10.spkg.
Revert with cd SAGE_ROOT/spkg/standard; sage -f python-2.6.4.p9.spkg.

The error is obvious -- both in the python install log and when starting sage import crypt fails.


---

Comment by pipedream created at 2011-04-23 15:47:44

How do I delete this ticket? IT is a duplicate of 11243


---

Comment by leif created at 2011-09-10 22:50:46

Changing status from new to needs_review.


---

Comment by leif created at 2011-09-10 22:50:46

Changing component from build to packages.


---

Comment by leif created at 2011-09-10 22:50:46

This is a duplicate of #11447, #11243, fixed in the Python 2.6.4.p11 spkg.


---

Comment by leif created at 2011-09-10 22:50:54

Changing status from needs_review to positive_review.


---

Comment by leif created at 2011-09-12 20:25:35

Resolution: duplicate


---

Comment by jdemeyer created at 2011-09-29 13:45:50

leif, please explain the "merged in: sage-4.7.1.rc0"

If this ticket is duplicate, there is nothing to merge...
