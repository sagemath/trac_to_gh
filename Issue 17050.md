# Issue 17050: K.is_subring(K) not implemented for some fields K

Issue created by migration from https://trac.sagemath.org/ticket/17287

Original creator: mjo

Original creation time: 2014-11-04 13:38:32

This seems like it should be an easy special case `if self == foo` right before we raise the `NotImplementedError`.

A few examples:


```
sage: QQbar.is_subring(QQbar)
...
NotImplementedError
```



```
sage: RR.is_subring(RR)
...
NotImplementedError
```



```
sage: CC.is_subring(CC)
...
NotImplementedError
```



```
sage: K.<a> = NumberField(x^3-x+1/10)
sage: K.is_ring()
True
sage: K.is_subring(K)
...
NotImplementedError
```



```
sage: R.<x> = RR[]
sage: R
Univariate Polynomial Ring in x over Real Field with 53 bits of precision
sage: R.is_ring()
True
sage: R.is_subring(R)
...
NotImplementedError
```




---

Comment by mjo created at 2015-09-06 13:43:46

Changing keywords from "" to "beginner".


---

Comment by tmonteil created at 2015-09-09 06:28:32

Let me own this ticket for the next 10 days, i plan to use this for a formation about how to contribute to Sage.


---

Comment by tmonteil created at 2015-09-09 06:28:32

Set assignee to tmonteil.


---

Comment by ajagekar.akshay created at 2016-01-31 05:36:43

Changing status from new to needs_review.


---

Comment by ajagekar.akshay created at 2016-01-31 05:36:43

New commits:


---

Comment by mjo created at 2016-01-31 14:11:55

So far so good! Whenever we fix a bug in sage, we like to add some tests to make sure that the bug is really fixed and won't come back again. In the description of this ticket, I found a few examples that used to fail but which now work. Can you add tests for those?

You can see what a test looks like by looking at the commented code right above your fix:


```
EXAMPLES::

    sage: ZZ.is_subring(QQ)
    True
    sage: ZZ.is_subring(GF(19))
    False
```


I would suggest adding a new section called "TESTS" and placing the new tests there. The structure of our documentation strings is described in full at http://doc.sagemath.org/html/en/developer/coding_basics.html#documentation-strings. Here's what the first test would look like:


```
TESTS:

Every ring is a subring of itself, :trac:`17287`::

    sage: QQbar.is_subring(QQbar)
    True
```


The :trac: thing is a special sort of link to this ticket, described in http://doc.sagemath.org/html/en/developer/sage_manuals.html#chapter-sage-manuals-links. Then you can add the other examples from the description below that. When you're done adding them, don't forget to run `sage -b` to build the changes (even though you only changed a comment). Then you can run the tests for that file with `sage -t`. Like,


```
$ sage -t sage/rings/ring.pyx 
Running doctests with ID 2016-01-31-09-08-05-2b1b6a12.
Git branch: develop
Using --optional=mpir,python2,sage
Doctesting 1 file.
sage -t --warn-long 72.5 sage/rings/ring.pyx
    [387 tests, 4.63 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 4.9 seconds
    cpu time: 3.5 seconds
    cumulative wall time: 4.6 seconds
```


And it takes forever, but at least once, someone should run `make ptestlong` to test the entire sage library with the change in place.


---

Comment by tmonteil created at 2016-01-31 15:07:01

Great that some newcomer work on it! However, my impression is that this test should be for trivial cases. My fear in using equality is that this might take a while if the equality is hard to decide. Here i guess we want a fast shortcut for trivial cases, that is when `self is other` (which should solve the present use cases since most rings have unique representation).


---

Comment by tmonteil created at 2016-01-31 15:07:01

Changing status from needs_review to needs_work.


---

Comment by git created at 2016-01-31 18:51:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ajagekar.akshay created at 2016-01-31 18:55:53

According to suggestions I have made some changes and also added some tests for examples that previously failed.


---

Comment by ajagekar.akshay created at 2016-01-31 18:56:25

Changing status from needs_work to needs_review.


---

Comment by mjo created at 2016-01-31 19:07:46

Looks good, thanks! I have one more nitpick.

In the docstrings, the double-colons are used to indicate that "the thing after this is a test." So you will see,


```
EXAMPLES::

    sage: ZZ.is_subring(QQ)
    True
```


and


```

TESTS:

Blah blah blah::

    sage: x == x
    True
```


but in the second case, the "TESTS:" doesn't need two trailing colons.

Finally, these two lines can probably go:


```
sage: R
Univariate Polynomial Ring in x over Real Field with 53 bits of precision
```


They don't really test anything useful. I think I included them in the description just to demonstrate that `R` is a ring.


---

Comment by git created at 2016-01-31 19:29:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ajagekar.akshay created at 2016-01-31 19:33:32

I corrected the typo and removed unnecessary test.


---

Comment by mjo created at 2016-02-04 19:37:21

Everything looks good, thanks!


---

Comment by mjo created at 2016-02-04 19:37:21

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-02-05 19:33:06

Resolution: fixed
