# Issue 10279: error in precision of p-adic L-functions

Issue created by migration from https://trac.sagemath.org/ticket/10280

Original creator: wuthrich

Original creation time: 2010-11-16 17:46:05

Assignee: cremona

CC:  was

Keywords: padic L-functions

The following was reported by Mark Watkins.


```
sage: E=EllipticCurve('389a')
sage: Lp = E.padic_lseries(3)
sage: Lp.series(4)
O(3^6) + O(3^3)*T + (2 + 2*3 + 2*3^2 + O(3^3))*T^2 + (2 + O(3^2))*T^3 +
 (1 + 2*3 + O(3^3))*T^4 + O(T^5)
sage: Lp.series(5)
O(3^7) + O(3^4)*T + (2 + 2*3 + 2*3^2 + 3^3 + O(3^4))*T^2 + (2 + O(3^3))*T^3 +
 (1 + 2*3 + 2*3^2 + 2*3^3 + O(3^4))*T^4 + O(T^5)
```


Note that the term 2*3<sup>2</sup>  in T<sup>4</sup> has appeared in the second computation.


---

Comment by wuthrich created at 2010-11-16 17:47:40

As Mark suggests further, this is likely a problem with `_prec_bounds`

 "Should the `_prec_bounds` take
 some sort of maximum over valuation of coefficients (say all i up to j)
 rather than just the valuation of the jth one?"


---

Attachment

patch, exported against 4.6.1


---

Comment by wuthrich created at 2011-01-26 18:31:03

I rewrote `e_bounds ` in padic_lseries.py. The new code is exactly as in the [paper ](http://wstein.org/papers/shark/)


---

Comment by wuthrich created at 2011-01-26 18:46:53

Note that the changes in the docstring at line 1019 are a new bug, reported as #10698.


---

Comment by wuthrich created at 2011-01-27 09:07:50

both patches should be applied


---

Comment by wuthrich created at 2011-01-27 09:29:48

Changing status from new to needs_review.


---

Attachment


---

Comment by was created at 2011-03-31 19:28:47

Looks good, and matches with the paper.  Thanks again to Mark Watkins for finding this.


---

Comment by was created at 2011-03-31 19:28:54

Changing status from needs_review to positive_review.


---

Comment by was created at 2011-04-02 04:41:08

The following comment is about the purposely slightly incorrect output in the second/third patch:


```
Note that this is mainly a problem about the printing. The
coefficients print as zero when they should be in fact zero up to some
(negative) precision.

The docstring is still a good documentation for someone who wants to
use the function.
I can not fix #10698, nor #4656, and I fear they are not going to be fixed soon.
I could have removed the docstring or cut the precision in T to 3, but
I would like to have it like that once the #10698 is fixed. The person
fixing that would maybe not want to do it.

Chris Wuthrich.

```



---

Attachment


---

Comment by was created at 2011-04-02 04:42:41

Release manager: apply all three patches.


---

Comment by jdemeyer created at 2011-04-07 19:56:40

Resolution: fixed
