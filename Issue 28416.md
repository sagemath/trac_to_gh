# Issue 28416: Faster iterator for permutation groups

Issue created by migration from https://trac.sagemath.org/ticket/28653

Original creator: vdelecroix

Original creation time: 2019-10-25 04:16:29

CC:  slelievre

The default iterator for permutation group makes use of a strong generating system (when the group is not monogen). This is expensive and should be avoided for faster code when the group is small. However, as noticed in #28539, the `RecursiveEnumeratedSet` generate elements in different order in Python 2 and Python 3 and makes it impossible to use.


---

Comment by embray created at 2020-01-06 14:10:03

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-04-14 19:41:51

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.


---

Comment by slelievre created at 2020-08-31 20:20:35

Different order in Python 2 and Python 3 is no longer be a problem.


---

Comment by chapoton created at 2020-10-13 17:12:58

voila une premiere tentative naive. Pas bien plus rapide, en fait
----
New commits:


---

Comment by git created at 2020-10-13 18:55:34

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2020-10-13 20:00:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2020-10-13 20:01:17

is this reasonable now ?


---

Comment by chapoton created at 2020-10-13 20:01:17

Changing status from new to needs_info.


---

Comment by vdelecroix created at 2020-10-14 06:18:21

What I thought was to reuse `sage.combinat.permutation_cython.pyx`. But in this module, it was decided to use `unsigned int` whereas `PermutationGroupElement` uses `int`. This is quite unfortunate.

If you use the swap algorithm from Knuth, it is trivial to make it work for `A_n` since permutations are alternatively even and odd (two neighboring permutations in the iterator differs by a transposition).


---

Comment by chapoton created at 2020-12-06 17:21:04

Changing status from needs_info to needs_review.


---

Comment by chapoton created at 2020-12-06 17:21:04

Voila une nouvelle tentative.


---

Comment by git created at 2020-12-06 17:24:04

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2020-12-06 19:17:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-12-06 19:24:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-12-07 07:21:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2020-12-07 09:05:43

bon, alors evidemment, ca casse un certain nombre de doctests. Avant de se lancer dans l'etude au cas par cas de ces doctests, je voudrais savoir si le code proposé est une bonne idée ou pas.

En particulier, pour les permutations, vaut-il mieux passer par itertools comme je le fait ou bien faire la meme chose que pour les permutations alternées ?

peut-etre aussi peut-on utiliser une maniere plus efficace de créer une permutation ?


---

Comment by vdelecroix created at 2020-12-07 09:08:29

Les permutations sont des tableaux d'entiers en C. Voir [This is the Trac macro *comment:10* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:10-macro).


---

Comment by chapoton created at 2020-12-07 09:41:20

Certes. Mais tu veux dire quoi, exactement ? Qu'il faut ré-implementer l'algo de Knuth au lieu d'utiliser la version existante, qui ne se passe pas au niveau array ?


---

Comment by vdelecroix created at 2020-12-07 17:56:05

Qu'il faut réécrire les fonctions de `sage/combinat/permutation_cython.pyx` de manière à ce qu'elles soient aussi utilisables par `PermutationGroupElement`.


---

Comment by mkoeppe created at 2021-03-15 22:07:04

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.


---

Comment by roed created at 2021-04-28 07:51:08

There are multiple failing tests.


---

Comment by roed created at 2021-04-28 07:51:08

Changing status from needs_review to needs_work.


---

Comment by mkoeppe created at 2021-07-19 00:44:56

Setting a new milestone for this ticket based on a cursory review.
