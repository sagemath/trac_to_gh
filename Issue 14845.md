# Issue 14845: speedup of k-Schur functions at t=1

Issue created by migration from https://trac.sagemath.org/ticket/15082

Original creator: zabrocki

Original creation time: 2013-08-23 00:35:10

This patch will implement two improvements to the k-Schur functions at t=1.  The first is a change to `_to_schur_on_basis` and the second is a change to how the product is calculated.  Both will improve the algorithm for doing these calculations by factoring out k-rectangles which are known to multiply by the rule `s_R*s^{(k)}_\lambda = s^{(k)}_{\lambda\cup R}`.  Currently `_to_schur_on_basis` is computed by determining the tableau in the k-atom of a given shape.  Factoring out maximal rectangles seems to reduce the computation by orders of magnitude for large examples.

Before:

```
sage: Sym = SymmetricFunctions(QQ); ks3 = Sym.kschur(3,1); s = Sym.s()
sage: timeit("s(ks3([3,3,3,2,2,1,1,1]))", number = 1, repeat = 1)
1 loops, best of 1: 7.43 s per loop
```


After:

```
sage: Sym = SymmetricFunctions(QQ); ks3 = Sym.kschur(3,1); s = Sym.s()
sage: timeit("s(ks3([3,3,3,2,2,1,1,1]))", number = 1, repeat = 1)
1 loops, best of 1: 55.5 ms per loop
```



---

Attachment


---

Comment by zabrocki created at 2013-08-23 20:46:43

Changing status from new to needs_review.


---

Comment by aschilling created at 2013-08-25 21:59:40

Hi Mike,

I reviewed the changes and they look good to me! I posted a small review patch on the sage-combinat queue right after your patch. Please review and fold if appropriate and reupload here.

Best,

Anne


---

Attachment

Thanks Anne.  The review patch is folded in this one.


---

Comment by aschilling created at 2013-08-26 06:39:54

This patch is really great. The following took almost infinite on my machine before the patch:

```
sage: Sym = SymmetricFunctions(QQ); ks3 = Sym.kschur(3,1); s = Sym.s()
sage: ks3[3,3,3,2,2,1]*ks3[3,3,2,2,2]
```

With the patch we get

```
sage: Sym = SymmetricFunctions(QQ); ks3 = Sym.kschur(3,1); s = Sym.s()
sage: timeit("ks3[3,3,3,2,2,1]*ks3[3,3,2,2,2]", number=1, repeat=1)
1 loops, best of 1: 145 ms per loop
sage: ks3[3,3,3,2,2,1]*ks3[3,3,2,2,2]
ks3[3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 1] + ks3[3, 3, 3, 3, 3, 3, 2, 2, 2, 2]
```


All tests seem to pass!


---

Comment by aschilling created at 2013-08-26 06:40:09

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-08-28 06:55:16

Resolution: fixed
