# Issue 31241: metaticket: pynac's poly_mul_expand function is buggy

archive/issues_031241.json:
```json
{
    "body": "This ticket tracks corrections to pynac's `poly_mul_expand` function. \n\n(This function is called by pynac's `ex::expand` method when expanding certain products of sums. It is not necessary, but makes the expansion more efficient for large sums.)\n\n* Disable the use of `poly_mul_expand` in pynac's `ex::expand` method until it has been debugged.\n* #31077 Pynac's `ex::to_canonical` method asks singular to process certain \"polynomials\", but they are sometimes actually Laurent polynomials. Do not send a Laurent polynomial to singular if it has any negative exponents.\n* (enhancement) Modify `poly_mul_expand` to deal with negative exponents by handling Laurent polynomials correctly.\n* #31477 Pynac's `numeric::gcd` method erroneously says that `gcd(1, p)` is equal to `1` for every rational number `p`. (See #31411 for the relation to this metaticket.)\n* #31411 Subexpressions that have no exponent need to be treated by `ex::to_canonical` as if they have an exponent of `1`.\n* Given the number of problems that have been found (and the critical importance of returning correct results when expanding sums) all of the methods in pynac's `mpoly-singular.cpp` file should be thoroughly tested before we re-enable the use of `poly_mul_expand` in `ex::expand`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/31478\n\n",
    "created_at": "2021-03-10T06:33:07Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "metaticket: pynac's poly_mul_expand function is buggy",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31241",
    "user": "https://github.com/DaveWitteMorris"
}
```
This ticket tracks corrections to pynac's `poly_mul_expand` function. 

(This function is called by pynac's `ex::expand` method when expanding certain products of sums. It is not necessary, but makes the expansion more efficient for large sums.)

* Disable the use of `poly_mul_expand` in pynac's `ex::expand` method until it has been debugged.
* #31077 Pynac's `ex::to_canonical` method asks singular to process certain "polynomials", but they are sometimes actually Laurent polynomials. Do not send a Laurent polynomial to singular if it has any negative exponents.
* (enhancement) Modify `poly_mul_expand` to deal with negative exponents by handling Laurent polynomials correctly.
* #31477 Pynac's `numeric::gcd` method erroneously says that `gcd(1, p)` is equal to `1` for every rational number `p`. (See #31411 for the relation to this metaticket.)
* #31411 Subexpressions that have no exponent need to be treated by `ex::to_canonical` as if they have an exponent of `1`.
* Given the number of problems that have been found (and the critical importance of returning correct results when expanding sums) all of the methods in pynac's `mpoly-singular.cpp` file should be thoroughly tested before we re-enable the use of `poly_mul_expand` in `ex::expand`.

Issue created by migration from https://trac.sagemath.org/ticket/31478





---

archive/issue_events_082653.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31241",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31241#event-82653"
}
```



---

archive/issue_events_082654.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T20:12:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31241",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31241#event-82654"
}
```



---

archive/issue_events_082655.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T20:12:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31241",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31241#event-82655"
}
```



---

archive/issue_events_082656.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31241",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31241#event-82656"
}
```



---

archive/issue_events_082657.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31241",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31241#event-82657"
}
```



---

archive/issue_events_082658.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31241",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31241#event-82658"
}
```



---

archive/issue_events_082659.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31241",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31241#event-82659"
}
```
