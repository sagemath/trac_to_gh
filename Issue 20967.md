# Issue 20967: guessing k-regular sequences

archive/issues_020967.json:
```json
{
    "body": "CC:  @rwst\n\nCode for guessing the parameters of k-regular sequences from the first few entries of a list/sequence/etc.\n\nSee also Meta ticket #21202.\n\nIssue created by migration from https://trac.sagemath.org/ticket/21204\n\n",
    "created_at": "2016-08-10T13:12:40Z",
    "labels": [
        "combinatorics",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "guessing k-regular sequences",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20967",
    "user": "@dkrenn"
}
```
CC:  @rwst

Code for guessing the parameters of k-regular sequences from the first few entries of a list/sequence/etc.

See also Meta ticket #21202.

Issue created by migration from https://trac.sagemath.org/ticket/21204





---

archive/issue_comments_290077.json:
```json
{
    "body": "Is it correct that (the generating function ```f``` of) every k-regular sequence satisfies a Mahler-type functional equation?  That is, a polynomial ```p``` such that ```p(f(x), f(x<sup>2),...,f(x</sup>k)) = 0```?\n\nIf so, then you could reuse the guessing functionality in FriCAS.  Of course, FriCAS is not a standard package, although I think it should be, for many reasons.  In any case, the guessing package within is fast and well tested, and covers a lot of ground - essentially everything which is available for 1-dimensional guessing.  For example:\n\n\n```\nsage: l = [0, 1, 0, 2, 0, 1, 0, 3, 0, 1, 0, 2, 0, 1, 0, 4, 0, 1, 0, 2, 0, 1, 0, 3, 0, 1, 0, 2, 0, 1, 0, 5, 0, 1, 0, 2, 0, 1, 0, 3, 0, 1, 0, 2, 0, 1, 0, 4, 0, 1, 0, 2, 0, 1, 0, 3, 0, 1, 0, 2, 0, 1, 0, 6, 0, 1, 0, 2, 0, 1, 0, 3, 0, 1, 0, 2, 0, 1, 0, 4, 0, 1, 0, 2, 0, 1, 0, 3, 0, 1, 0, 2, 0, 1, 0, 5, 0, 1, 0, 2, 0, 1, 0, 3, 0, 1, 0, 2, 0, 1, 0]\nsage: fricas.guessFE(l)\n      n         3        2        2                             3      4\n  [[[x ]f(x): (x  - x)f(x ) + (- x  + 1)f(x) - x= 0,f(x)= x + 2x  + O(x )]]\n```\n",
    "created_at": "2016-08-10T14:36:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290077",
    "user": "@mantepse"
}
```

Is it correct that (the generating function ```f``` of) every k-regular sequence satisfies a Mahler-type functional equation?  That is, a polynomial ```p``` such that ```p(f(x), f(x<sup>2),...,f(x</sup>k)) = 0```?

If so, then you could reuse the guessing functionality in FriCAS.  Of course, FriCAS is not a standard package, although I think it should be, for many reasons.  In any case, the guessing package within is fast and well tested, and covers a lot of ground - essentially everything which is available for 1-dimensional guessing.  For example:


```
sage: l = [0, 1, 0, 2, 0, 1, 0, 3, 0, 1, 0, 2, 0, 1, 0, 4, 0, 1, 0, 2, 0, 1, 0, 3, 0, 1, 0, 2, 0, 1, 0, 5, 0, 1, 0, 2, 0, 1, 0, 3, 0, 1, 0, 2, 0, 1, 0, 4, 0, 1, 0, 2, 0, 1, 0, 3, 0, 1, 0, 2, 0, 1, 0, 6, 0, 1, 0, 2, 0, 1, 0, 3, 0, 1, 0, 2, 0, 1, 0, 4, 0, 1, 0, 2, 0, 1, 0, 3, 0, 1, 0, 2, 0, 1, 0, 5, 0, 1, 0, 2, 0, 1, 0, 3, 0, 1, 0, 2, 0, 1, 0]
sage: fricas.guessFE(l)
      n         3        2        2                             3      4
  [[[x ]f(x): (x  - x)f(x ) + (- x  + 1)f(x) - x= 0,f(x)= x + 2x  + O(x )]]
```




---

archive/issue_comments_290078.json:
```json
{
    "body": "Replying to [comment:2 mantepse]:\n> Is it correct that (the generating function ```f``` of) every k-regular sequence satisfies a Mahler-type functional equation?  That is, a polynomial ```p``` such that ```p(f(x), f(x<sup>2),...,f(x</sup>k)) = 0```?\n\nI've found in the book of Allouche and Shallit:\n\n   \"It is known that k-regular power series satisfy Mahler functional equations; see Rand \u0301e [1992], Dumas [1993a], and Becker [1994].\"\n\nso I believe the answer to your question is affirmative.\n\n> If so, then you could reuse the guessing functionality in FriCAS.  Of course, FriCAS is not a standard package, although I think it should be, for many reasons.  In any case, the guessing package within is fast and well tested, and covers a lot of ground - essentially everything which is available for 1-dimensional guessing. \n\nI didn't know about this feature of FriCAS, but looks good :)\n\nAre there any plans to make FriCAS standard (I tried with `sage -i fricas`, but installation fails :(",
    "created_at": "2016-08-10T15:25:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290078",
    "user": "@dkrenn"
}
```

Replying to [comment:2 mantepse]:
> Is it correct that (the generating function ```f``` of) every k-regular sequence satisfies a Mahler-type functional equation?  That is, a polynomial ```p``` such that ```p(f(x), f(x<sup>2),...,f(x</sup>k)) = 0```?

I've found in the book of Allouche and Shallit:

   "It is known that k-regular power series satisfy Mahler functional equations; see Rand Ìe [1992], Dumas [1993a], and Becker [1994]."

so I believe the answer to your question is affirmative.

> If so, then you could reuse the guessing functionality in FriCAS.  Of course, FriCAS is not a standard package, although I think it should be, for many reasons.  In any case, the guessing package within is fast and well tested, and covers a lot of ground - essentially everything which is available for 1-dimensional guessing. 

I didn't know about this feature of FriCAS, but looks good :)

Are there any plans to make FriCAS standard (I tried with `sage -i fricas`, but installation fails :(



---

archive/issue_comments_290079.json:
```json
{
    "body": "Replying to [comment:3 dkrenn]:\n\n> Are there any plans to make FriCAS standard (I tried with `sage -i fricas`, but installation fails :(\n\nHow does it fail?  That's very bad indeed!",
    "created_at": "2016-08-10T15:34:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290079",
    "user": "@mantepse"
}
```

Replying to [comment:3 dkrenn]:

> Are there any plans to make FriCAS standard (I tried with `sage -i fricas`, but installation fails :(

How does it fail?  That's very bad indeed!



---

archive/issue_comments_290080.json:
```json
{
    "body": "Replying to [comment:4 mantepse]:\n> > Are there any plans to make FriCAS standard (I tried with `sage -i fricas`, but installation fails :(\n> \n> How does it fail?  That's very bad indeed!\n\nPosted on https://groups.google.com/forum/#!topic/sage-devel/6_rBQvKdGPo",
    "created_at": "2016-08-10T15:44:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290080",
    "user": "@dkrenn"
}
```

Replying to [comment:4 mantepse]:
> > Are there any plans to make FriCAS standard (I tried with `sage -i fricas`, but installation fails :(
> 
> How does it fail?  That's very bad indeed!

Posted on https://groups.google.com/forum/#!topic/sage-devel/6_rBQvKdGPo



---

archive/issue_comments_290081.json:
```json
{
    "body": "this is to update FriCAS: #21209\n\nprobably the current version of FriCAS (1.2.7) should compile with current ECL just fine.",
    "created_at": "2016-08-10T16:54:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290081",
    "user": "@dimpase"
}
```

this is to update FriCAS: #21209

probably the current version of FriCAS (1.2.7) should compile with current ECL just fine.



---

archive/issue_comments_290082.json:
```json
{
    "body": "The new fricas interface is #21231.  It would be very easy to add a dedicated command for guessing k-regular sequences to FriCAS.  If this is interesting, I could probably further improve the interface to avoid `pexpect` and communicate with FriCAS more directly, Waldek Hebisch has already done the work on the FriCAS-side.\n\n(Currently, passing long lists to FriCAS is very very slow.  But I would like to have at least some confirmation of interest before I spend more time on the interface)",
    "created_at": "2016-08-21T15:37:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290082",
    "user": "@mantepse"
}
```

The new fricas interface is #21231.  It would be very easy to add a dedicated command for guessing k-regular sequences to FriCAS.  If this is interesting, I could probably further improve the interface to avoid `pexpect` and communicate with FriCAS more directly, Waldek Hebisch has already done the work on the FriCAS-side.

(Currently, passing long lists to FriCAS is very very slow.  But I would like to have at least some confirmation of interest before I spend more time on the interface)



---

archive/issue_comments_290083.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2016-08-21T16:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290083",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_290084.json:
```json
{
    "body": "Replying to [comment:8 mantepse]:\n> The new fricas interface is #21231.  It would be very easy to add a dedicated command for guessing k-regular sequences to FriCAS. \n\nYou mean guessing the Mahler functional equation, right? \n\n> If this is interesting, I could probably further improve the interface to avoid `pexpect` and communicate with FriCAS more directly, Waldek Hebisch has already done the work on the FriCAS-side.\n\nI think having this would be interesting and good. I am still not sure how exactly I would get the k-regular sequence out of it; I have to dig into this topic a bit further, I guess. (At the moment, I do not see directly, where the parameter k comes into play, as the FriCAS guessing works without this parameter.)\nThis is not my top priority at the moment (as the simple implementation of guessing of this ticket satisfies my needs and gives exactly the kind of representation I need.\n\nAs FriCAS is an optional package, I would guess, when having the interface you speak about, would be used as an alternative choice which guessing-algorithm was used. (Maybe even if FriCAS was a standard package...not sure at the moment...)\n\n> (Currently, passing long lists to FriCAS is very very slow.  But I would like to have at least some confirmation of interest before I spend more time on the interface)\n\nFrom what you can suggest by reading the above, I am not sure what the implications for this ticket are. However, having such a functionality of guessing the functional equation would definitely something nice to have in [SageMath](SageMath).",
    "created_at": "2016-08-21T17:12:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290084",
    "user": "@dkrenn"
}
```

Replying to [comment:8 mantepse]:
> The new fricas interface is #21231.  It would be very easy to add a dedicated command for guessing k-regular sequences to FriCAS. 

You mean guessing the Mahler functional equation, right? 

> If this is interesting, I could probably further improve the interface to avoid `pexpect` and communicate with FriCAS more directly, Waldek Hebisch has already done the work on the FriCAS-side.

I think having this would be interesting and good. I am still not sure how exactly I would get the k-regular sequence out of it; I have to dig into this topic a bit further, I guess. (At the moment, I do not see directly, where the parameter k comes into play, as the FriCAS guessing works without this parameter.)
This is not my top priority at the moment (as the simple implementation of guessing of this ticket satisfies my needs and gives exactly the kind of representation I need.

As FriCAS is an optional package, I would guess, when having the interface you speak about, would be used as an alternative choice which guessing-algorithm was used. (Maybe even if FriCAS was a standard package...not sure at the moment...)

> (Currently, passing long lists to FriCAS is very very slow.  But I would like to have at least some confirmation of interest before I spend more time on the interface)

From what you can suggest by reading the above, I am not sure what the implications for this ticket are. However, having such a functionality of guessing the functional equation would definitely something nice to have in [SageMath](SageMath).



---

archive/issue_comments_290085.json:
```json
{
    "body": "Replying to [comment:10 dkrenn]:\n> Replying to [comment:8 mantepse]:\n> > The new fricas interface is #21231.  It would be very easy to add a dedicated command for guessing k-regular sequences to FriCAS. \n> \n> You mean guessing the Mahler functional equation, right? \n\nHm.  I actually meant to add a command that guesses the equation for the k-regular sequence.  But I just found out that I was slightly mistaken about the nature of k-regular sequences: apparently there is no single equation determining it, but rather a bunch of them, right?  It should still be possible to reuse the machinery.",
    "created_at": "2016-08-21T18:22:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290085",
    "user": "@mantepse"
}
```

Replying to [comment:10 dkrenn]:
> Replying to [comment:8 mantepse]:
> > The new fricas interface is #21231.  It would be very easy to add a dedicated command for guessing k-regular sequences to FriCAS. 
> 
> You mean guessing the Mahler functional equation, right? 

Hm.  I actually meant to add a command that guesses the equation for the k-regular sequence.  But I just found out that I was slightly mistaken about the nature of k-regular sequences: apparently there is no single equation determining it, but rather a bunch of them, right?  It should still be possible to reuse the machinery.



---

archive/issue_comments_290086.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-22T13:17:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290086",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_290087.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-22T15:23:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290087",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_290088.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-22T15:26:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290088",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_290089.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2016-08-25T11:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290089",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_290090.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2016-08-25T11:53:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290090",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_290091.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2016-08-25T18:20:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290091",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_290092.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-08-25T18:24:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290092",
    "user": "@dkrenn"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_290093.json:
```json
{
    "body": "- Merged in #21325 to avoid a trivial merge conflict.\n- Merged in #21319 to have equality testing in the doctests, but not needed for the actual code.\n- Thus, this ticket essentially depends only on #21203.",
    "created_at": "2016-08-25T18:24:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290093",
    "user": "@dkrenn"
}
```

- Merged in #21325 to avoid a trivial merge conflict.
- Merged in #21319 to have equality testing in the doctests, but not needed for the actual code.
- Thus, this ticket essentially depends only on #21203.



---

archive/issue_comments_290094.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2016-08-26T12:00:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290094",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_290095.json:
```json
{
    "body": "patchbot doctest failure, python3 plugin failure",
    "created_at": "2017-01-05T12:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290095",
    "user": "@cheuberg"
}
```

patchbot doctest failure, python3 plugin failure



---

archive/issue_comments_290096.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-01-05T12:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290096",
    "user": "@cheuberg"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_290097.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2017-01-24T13:26:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290097",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_290098.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-01-24T13:27:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290098",
    "user": "@dkrenn"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_290099.json:
```json
{
    "body": "Replying to [comment:20 cheuberg]:\n> patchbot doctest failure, python3 plugin failure\n\nFixed.",
    "created_at": "2017-01-24T13:27:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290099",
    "user": "@dkrenn"
}
```

Replying to [comment:20 cheuberg]:
> patchbot doctest failure, python3 plugin failure

Fixed.



---

archive/issue_comments_290100.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-06T07:44:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290100",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_290101.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-29T08:51:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290101",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_290102.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2021-05-11T14:52:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290102",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_290103.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2021-06-25T13:04:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290103",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_290104.json:
```json
{
    "body": "Merged dependencies; ready for review.",
    "created_at": "2021-06-25T13:14:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290104",
    "user": "@dkrenn"
}
```

Merged dependencies; ready for review.



---

archive/issue_comments_290105.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2022-01-05T21:39:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290105",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_290106.json:
```json
{
    "body": "Merged dependencies, now based on 9.4",
    "created_at": "2022-01-05T21:41:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290106",
    "user": "@dkrenn"
}
```

Merged dependencies, now based on 9.4



---

archive/issue_comments_290107.json:
```json
{
    "body": "A a rule, ticket branches should be based on the latest beta, not on the latest stable version.",
    "created_at": "2022-01-06T11:37:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290107",
    "user": "@dimpase"
}
```

A a rule, ticket branches should be based on the latest beta, not on the latest stable version.



---

archive/issue_comments_290108.json:
```json
{
    "body": "Replying to [comment:31 dimpase]:\n> A a rule, ticket branches should be based on the latest beta, not on the latest stable version. \n\nThe current beta merges automatically and cleanly, so there is no difference on which branch to put it (as the patchbot runs it in the latest beta anyways). \n\nThe reason for putting it on the latest stable is that this code is loosely related to a mathematical paper, so might be used by someone now and putting it on a stable version makes this using easier (as no beta needs to be compiled separately).\n\n(And, the reason for merging in a newer version of [SageMath](SageMath) at all was a non-tivial merge conflict. If that would not have been, then it would still be 9.3.)",
    "created_at": "2022-01-06T12:17:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290108",
    "user": "@dkrenn"
}
```

Replying to [comment:31 dimpase]:
> A a rule, ticket branches should be based on the latest beta, not on the latest stable version. 

The current beta merges automatically and cleanly, so there is no difference on which branch to put it (as the patchbot runs it in the latest beta anyways). 

The reason for putting it on the latest stable is that this code is loosely related to a mathematical paper, so might be used by someone now and putting it on a stable version makes this using easier (as no beta needs to be compiled separately).

(And, the reason for merging in a newer version of [SageMath](SageMath) at all was a non-tivial merge conflict. If that would not have been, then it would still be 9.3.)



---

archive/issue_comments_290109.json:
```json
{
    "body": "red branch => needs work",
    "created_at": "2022-05-12T09:32:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290109",
    "user": "@fchapoton"
}
```

red branch => needs work



---

archive/issue_comments_290110.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-05-12T09:32:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290110",
    "user": "@fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_290111.json:
```json
{
    "body": "Unfortunately, rebasing this in a straightforward way over the latest beta (9.7.beta3) proves impossible (it leads to missing pieces for some reason).\n\nAnd merging the latest beta does not work any more, either. \n\nWhat's the latest develop branch where it still worked?",
    "created_at": "2022-06-24T16:21:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290111",
    "user": "@dimpase"
}
```

Unfortunately, rebasing this in a straightforward way over the latest beta (9.7.beta3) proves impossible (it leads to missing pieces for some reason).

And merging the latest beta does not work any more, either. 

What's the latest develop branch where it still worked?



---

archive/issue_comments_290112.json:
```json
{
    "body": "Clean merge of the latest beta (9.8.beta1)\n----\nNew commits:",
    "created_at": "2022-10-02T08:27:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290112",
    "user": "@cheuberg"
}
```

Clean merge of the latest beta (9.8.beta1)
----
New commits:



---

archive/issue_comments_290113.json:
```json
{
    "body": "Sorry, that was a wrong push. I'll fix it soon.",
    "created_at": "2022-10-02T08:30:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290113",
    "user": "@cheuberg"
}
```

Sorry, that was a wrong push. I'll fix it soon.



---

archive/issue_comments_290114.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2022-10-02T08:33:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290114",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_290115.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-02T18:48:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290115",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_290116.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-11T17:00:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290116",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_290117.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2022-10-11T17:09:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290117",
    "user": "@cheuberg"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_290118.json:
```json
{
    "body": "I started reading this and have a lot of questions. I might then have to reread the code because I am not yet confident that I understand everything, so I apologise in advance if some further questions pop up at a later iteration.\n\nWhile reading the code, I tried to make some notes on what the various routines are doing; I pushed those notes to branch `u/cheuberg/sequences/k-regular-guess-documentation`; after polishing those, it might be worthwhile to include these.\nDue to my question 16 below, these notes might still require substantial rewrite (I am not sure about left/right).\n\n1. `k_regular_sequence.value` in the docstring: the `\\operator` does not yield the desired output in the HTML documentation.\n2. `k_regular_sequence.split_interlace`: from the description, I do not understand what \"split a digit into `p` parts\" shall mean. Instead of the many examples (which might be moved to `TESTS`) I'd prefer to see fewer examples with an explanation what the output means. Perhaps \"split into `p` parts\" could be made explicit into saying that it will be expanded as a `k/p`-ary expansion? And also say that \"value of the expansion\" means expansion in base `k/p`?\n3. `kRegularSequenceSpace.guess`: One-sentence description: perhaps \"Guess a k-regular sequence whose first terms coincide with ...\"?\n4. `kRegularSequenceSpace.guess`: it is unclear to me what \"bootstrapping this guessing\" means.\n5. `kRegularSequenceSpace.guess`: please use the \"new\" method `linear_representation` for all examples\n6. `kRegularSequenceSpace.guess`: In the first example, it may be helpful to explain what \"variant 1\" and \"variant 2\" are (variant 1: without a bootstrapping sequence; variant 2: with the constant sequence as a bootstrapping sequence).\n7. `kRegularSequenceSpace.guess`: I suggest to compare the outputs of Variant 1 and Variant 2 (that they yield the same sequence).\n8. `kRegularSequenceSpace.guess`: it would be helpful to indicate the vector valued sequences used in the various examples (Sum of digits, variant 1: (s(n), s(2n+1)); variant 2: (1, s(n)), all natural numbers: (n, 2n+1), indicator function of even integers: ([n even], 1), indicator function of odd integers: )\n9. `kRegularSequenceSpace.guess`: I suggest to rename all functions containing `linear_dependence` in their name to `linear_combination` (we are actually interested in the coefficients, not the existence of coefficients)\n10. `kRegularSequenceSpace.guess`: I suggest to rename `guess_linear_dependence` to `linear_combination_candidate`: we are not guessing here, but we are deriving the only candidate and are checking it in the next step.\n21. `kRegularSequenceSpace.guess`: I am surprised that `verify_linear_dependence` has `(n_max - r_L) // k**t_L + 1` as an upper bound for the loop. I think that the code does not guarantee that it will never evaluate `f` for some higher values than `n_max`, that might happen in `some_inverse_U_matrix`. On the other hand, something might be considered to be linearly dependent on the available functions while in truth it is not; this should not cause real problems.\n32. `kRegularSequenceSpace.guess`: I do not understand the `if seq(0):` part: Why does it make a difference whether the zeroth element of the given sequence vanishes or not? I do not know whether it is related, but the following is not what I expect:\n    {{{\nsage: def s(k):\nsage:     return k\nsage: Seq2 = kRegularSequenceSpace(2, ZZ)\nsage: S1 = Seq2.guess(s)\nsage: S2 = Seq2.guess(s, sequence=S1)\nsage: S1\n2-regular sequence 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, ...\nsage: S2\n2-regular sequence 0, -2, -2, -6, -2, -6, -10, -14, -2, -6, ...\n}}}\n13. `kRegularSequenceSpace.guess`: I am surprised by `if t_R >= max_dimension:`: I thought that `max_dimension` will be the dimension of the matrices of the resulting regular sequence, but it seems to be the exponent? Shouldn't it be called like that in this case?\n24. `kRegularSequenceSpace.guess`: I do not understand why the parameter s is actually stored into `lines`, I do not think it is ever used.\n35. I do not understand why `k_regular_sequence.split_interlace` is defined in this ticket, it do not see a usage of it.\n46. I find it puzzling that the `values` function contains `seq` which in turn has the `left` vector of the given sequence times the matrix product, and this at the very end ends up in `right`.",
    "created_at": "2022-10-11T17:09:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20967",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20967#issuecomment-290118",
    "user": "@cheuberg"
}
```

I started reading this and have a lot of questions. I might then have to reread the code because I am not yet confident that I understand everything, so I apologise in advance if some further questions pop up at a later iteration.

While reading the code, I tried to make some notes on what the various routines are doing; I pushed those notes to branch `u/cheuberg/sequences/k-regular-guess-documentation`; after polishing those, it might be worthwhile to include these.
Due to my question 16 below, these notes might still require substantial rewrite (I am not sure about left/right).

1. `k_regular_sequence.value` in the docstring: the `\operator` does not yield the desired output in the HTML documentation.
2. `k_regular_sequence.split_interlace`: from the description, I do not understand what "split a digit into `p` parts" shall mean. Instead of the many examples (which might be moved to `TESTS`) I'd prefer to see fewer examples with an explanation what the output means. Perhaps "split into `p` parts" could be made explicit into saying that it will be expanded as a `k/p`-ary expansion? And also say that "value of the expansion" means expansion in base `k/p`?
3. `kRegularSequenceSpace.guess`: One-sentence description: perhaps "Guess a k-regular sequence whose first terms coincide with ..."?
4. `kRegularSequenceSpace.guess`: it is unclear to me what "bootstrapping this guessing" means.
5. `kRegularSequenceSpace.guess`: please use the "new" method `linear_representation` for all examples
6. `kRegularSequenceSpace.guess`: In the first example, it may be helpful to explain what "variant 1" and "variant 2" are (variant 1: without a bootstrapping sequence; variant 2: with the constant sequence as a bootstrapping sequence).
7. `kRegularSequenceSpace.guess`: I suggest to compare the outputs of Variant 1 and Variant 2 (that they yield the same sequence).
8. `kRegularSequenceSpace.guess`: it would be helpful to indicate the vector valued sequences used in the various examples (Sum of digits, variant 1: (s(n), s(2n+1)); variant 2: (1, s(n)), all natural numbers: (n, 2n+1), indicator function of even integers: ([n even], 1), indicator function of odd integers: )
9. `kRegularSequenceSpace.guess`: I suggest to rename all functions containing `linear_dependence` in their name to `linear_combination` (we are actually interested in the coefficients, not the existence of coefficients)
10. `kRegularSequenceSpace.guess`: I suggest to rename `guess_linear_dependence` to `linear_combination_candidate`: we are not guessing here, but we are deriving the only candidate and are checking it in the next step.
21. `kRegularSequenceSpace.guess`: I am surprised that `verify_linear_dependence` has `(n_max - r_L) // k**t_L + 1` as an upper bound for the loop. I think that the code does not guarantee that it will never evaluate `f` for some higher values than `n_max`, that might happen in `some_inverse_U_matrix`. On the other hand, something might be considered to be linearly dependent on the available functions while in truth it is not; this should not cause real problems.
32. `kRegularSequenceSpace.guess`: I do not understand the `if seq(0):` part: Why does it make a difference whether the zeroth element of the given sequence vanishes or not? I do not know whether it is related, but the following is not what I expect:
    {{{
sage: def s(k):
sage:     return k
sage: Seq2 = kRegularSequenceSpace(2, ZZ)
sage: S1 = Seq2.guess(s)
sage: S2 = Seq2.guess(s, sequence=S1)
sage: S1
2-regular sequence 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, ...
sage: S2
2-regular sequence 0, -2, -2, -6, -2, -6, -10, -14, -2, -6, ...
}}}
13. `kRegularSequenceSpace.guess`: I am surprised by `if t_R >= max_dimension:`: I thought that `max_dimension` will be the dimension of the matrices of the resulting regular sequence, but it seems to be the exponent? Shouldn't it be called like that in this case?
24. `kRegularSequenceSpace.guess`: I do not understand why the parameter s is actually stored into `lines`, I do not think it is ever used.
35. I do not understand why `k_regular_sequence.split_interlace` is defined in this ticket, it do not see a usage of it.
46. I find it puzzling that the `values` function contains `seq` which in turn has the `left` vector of the given sequence times the matrix product, and this at the very end ends up in `right`.
