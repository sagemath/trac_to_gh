# Issue 26763: Upgrade NumPy to 1.16

archive/issues_026763.json:
```json
{
    "body": "CC:  @antonio-rojas @kiwifb @slel @tobihan tmonteil\n\nIn Debian we have NumPy 1.16.0rc1 which leads to some deprecation warnings:\n\nDeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead\n\nIt would be nice if sagemath could update the package soon after the 1.16 release.\n\nIssue created by migration from https://trac.sagemath.org/ticket/27000\n\n",
    "created_at": "2019-01-02T14:47:56Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "Upgrade NumPy to 1.16",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26763",
    "user": "https://github.com/tobihan"
}
```
CC:  @antonio-rojas @kiwifb @slel @tobihan tmonteil

In Debian we have NumPy 1.16.0rc1 which leads to some deprecation warnings:

DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead

It would be nice if sagemath could update the package soon after the 1.16 release.

Issue created by migration from https://trac.sagemath.org/ticket/27000





---

archive/issue_comments_375997.json:
```json
{
    "body": "Changing keywords from \"\" to \"upgrade, numpy\".",
    "created_at": "2019-01-08T14:34:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-375997",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "upgrade, numpy".



---

archive/issue_comments_375998.json:
```json
{
    "body": "It seems most, if not all of these `DeprecationWarning`s are actually coming via matplotlib.  I don't even see any explict `np.asscalar()` calls in the Sage sources.",
    "created_at": "2019-01-09T14:53:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-375998",
    "user": "https://github.com/embray"
}
```

It seems most, if not all of these `DeprecationWarning`s are actually coming via matplotlib.  I don't even see any explict `np.asscalar()` calls in the Sage sources.



---

archive/issue_comments_375999.json:
```json
{
    "body": "Upstream fix to matplotlib: https://github.com/matplotlib/matplotlib/pull/12478",
    "created_at": "2019-01-09T15:00:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-375999",
    "user": "https://github.com/embray"
}
```

Upstream fix to matplotlib: https://github.com/matplotlib/matplotlib/pull/12478



---

archive/issue_comments_376000.json:
```json
{
    "body": "I'm getting this on Arch after updating to 1.16.0\n\n```\nsage -t /usr/lib/python2.7/site-packages/sage/misc/inline_fortran.py\n**********************************************************************\nFile \"/usr/lib/python2.7/site-packages/sage/misc/inline_fortran.py\", line 134, in sage.misc.inline_fortran._import_module_from_path._import_module_from_path_impl\nFailed example:\n    fortran(code, globals())\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1086, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.misc.inline_fortran._import_module_from_path._import_module_from_path_impl[1]>\", line 1, in <module>\n        fortran(code, globals())\n      File \"sage/misc/lazy_import.pyx\", line 354, in sage.misc.lazy_import.LazyImport.__call__ (build/cythonized/sage/misc/lazy_import.c:3684)\n        return self.get_object()(*args, **kwds)\n      File \"/usr/lib/python2.7/site-packages/sage/misc/inline_fortran.py\", line 96, in __call__\n        return self.eval(*args, **kwds)\n      File \"/usr/lib/python2.7/site-packages/sage/misc/inline_fortran.py\", line 191, in eval\n        with open(log) as fobj:\n    IOError: [Errno 2] No such file or directory: 'fortran_module.log'\n**********************************************************************\n```\n",
    "created_at": "2019-01-14T17:08:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376000",
    "user": "https://github.com/antonio-rojas"
}
```

I'm getting this on Arch after updating to 1.16.0

```
sage -t /usr/lib/python2.7/site-packages/sage/misc/inline_fortran.py
**********************************************************************
File "/usr/lib/python2.7/site-packages/sage/misc/inline_fortran.py", line 134, in sage.misc.inline_fortran._import_module_from_path._import_module_from_path_impl
Failed example:
    fortran(code, globals())
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python2.7/site-packages/sage/doctest/forker.py", line 1086, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.inline_fortran._import_module_from_path._import_module_from_path_impl[1]>", line 1, in <module>
        fortran(code, globals())
      File "sage/misc/lazy_import.pyx", line 354, in sage.misc.lazy_import.LazyImport.__call__ (build/cythonized/sage/misc/lazy_import.c:3684)
        return self.get_object()(*args, **kwds)
      File "/usr/lib/python2.7/site-packages/sage/misc/inline_fortran.py", line 96, in __call__
        return self.eval(*args, **kwds)
      File "/usr/lib/python2.7/site-packages/sage/misc/inline_fortran.py", line 191, in eval
        with open(log) as fobj:
    IOError: [Errno 2] No such file or directory: 'fortran_module.log'
**********************************************************************
```




---

archive/issue_comments_376001.json:
```json
{
    "body": "Changing type from defect to enhancement.",
    "created_at": "2019-01-15T01:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376001",
    "user": "https://github.com/slel"
}
```

Changing type from defect to enhancement.



---

archive/issue_comments_376002.json:
```json
{
    "body": "Editing ticket description now that NumPy 1.16.0 is released.\n\nThe release announcement for NumPy 1.16.0 warns:\n\n> Downstream developers building this release should use Cython >= 0.29.2\n> and, if linking OpenBLAS, OpenBLAS > v0.3.4.\n\nSo this depends on the upgrade to OpenBLAS 0.3.5 (from 0.3.3) in #27020,\nand on the upgrade to Cython 0.29.2 in #27058.",
    "created_at": "2019-01-15T01:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376002",
    "user": "https://github.com/slel"
}
```

Editing ticket description now that NumPy 1.16.0 is released.

The release announcement for NumPy 1.16.0 warns:

> Downstream developers building this release should use Cython >= 0.29.2
> and, if linking OpenBLAS, OpenBLAS > v0.3.4.

So this depends on the upgrade to OpenBLAS 0.3.5 (from 0.3.3) in #27020,
and on the upgrade to Cython 0.29.2 in #27058.



---

archive/issue_comments_376003.json:
```json
{
    "body": "I also get some problems with inline_fortran on Numpy 1.16 (this has been affecting the Debian port).  Haven't looked into it yet.",
    "created_at": "2019-01-15T14:12:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376003",
    "user": "https://github.com/embray"
}
```

I also get some problems with inline_fortran on Numpy 1.16 (this has been affecting the Debian port).  Haven't looked into it yet.



---

archive/issue_comments_376004.json:
```json
{
    "body": "The inline_fortran problem appears to be caused by a backwards-incompatibility introduced by https://github.com/numpy/numpy/pull/11937\n\nThis interface previously was [documented](https://docs.scipy.org/doc/numpy/f2py/usage.html#python-module-f2py2e) as calling f2py through a shell, which meant it was possible to pass constructs like shell redirections in the `extra_args` argument.  So that PR should have passed `shell=True` to `subprocess.check_output` in order to keep that functionality, but it did not (that, or formally deprecate it and also allow a way to capture standard I/O).",
    "created_at": "2019-01-15T14:42:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376004",
    "user": "https://github.com/embray"
}
```

The inline_fortran problem appears to be caused by a backwards-incompatibility introduced by https://github.com/numpy/numpy/pull/11937

This interface previously was [documented](https://docs.scipy.org/doc/numpy/f2py/usage.html#python-module-f2py2e) as calling f2py through a shell, which meant it was possible to pass constructs like shell redirections in the `extra_args` argument.  So that PR should have passed `shell=True` to `subprocess.check_output` in order to keep that functionality, but it did not (that, or formally deprecate it and also allow a way to capture standard I/O).



---

archive/issue_comments_376005.json:
```json
{
    "body": "#27061 offers a fix to the problem with `sage.misc.inline_fortran`.",
    "created_at": "2019-01-15T15:36:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376005",
    "user": "https://github.com/embray"
}
```

#27061 offers a fix to the problem with `sage.misc.inline_fortran`.



---

archive/issue_comments_376006.json:
```json
{
    "body": "Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.",
    "created_at": "2019-01-15T18:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376006",
    "user": "https://github.com/embray"
}
```

Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.



---

archive/issue_comments_376007.json:
```json
{
    "body": "Is there a branch to test this?",
    "created_at": "2019-01-28T12:47:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376007",
    "user": "https://github.com/dimpase"
}
```

Is there a branch to test this?



---

archive/issue_comments_376008.json:
```json
{
    "body": "Is it compatible with scipy 1.2? It was released earlier, and given that scipy logs are full of `Using deprecated Numpy API` warnings, it seems that the real blocker to this would be a new scipy version.\n----\nNew commits:",
    "created_at": "2019-01-28T12:56:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376008",
    "user": "https://github.com/dimpase"
}
```

Is it compatible with scipy 1.2? It was released earlier, and given that scipy logs are full of `Using deprecated Numpy API` warnings, it seems that the real blocker to this would be a new scipy version.
----
New commits:



---

archive/issue_comments_376009.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-01-28T16:03:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376009",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_376010.json:
```json
{
    "body": "Replying to [comment:16 dimpase]:\n> Is it compatible with scipy 1.2? It was released earlier, and given that scipy logs are full of `Using deprecated Numpy API` warnings, it seems that the real blocker to this would be a new scipy version.\n\nThere is a long discussion about that in https://github.com/cython/cython/issues/2498",
    "created_at": "2019-01-28T16:36:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376010",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:16 dimpase]:
> Is it compatible with scipy 1.2? It was released earlier, and given that scipy logs are full of `Using deprecated Numpy API` warnings, it seems that the real blocker to this would be a new scipy version.

There is a long discussion about that in https://github.com/cython/cython/issues/2498



---

archive/issue_comments_376011.json:
```json
{
    "body": "anything stops us from going forward with this upgrade? it all seems to work, after matplotlib fix.",
    "created_at": "2019-01-28T17:45:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376011",
    "user": "https://github.com/dimpase"
}
```

anything stops us from going forward with this upgrade? it all seems to work, after matplotlib fix.



---

archive/issue_comments_376012.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-01-28T17:48:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376012",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_376013.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-28T17:56:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376013",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_376014.json:
```json
{
    "body": "LGTM",
    "created_at": "2019-01-28T17:56:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376014",
    "user": "https://github.com/dimpase"
}
```

LGTM



---

archive/issue_comments_376015.json:
```json
{
    "body": "Seems to conflict with matplotlib on OSX:\n\n```\nIgnoring indexes: https://pypi.org/simple\nCreated temporary directory: /private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-ephem-wheel-cache-kl7Hms\nCreated temporary directory: /private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-tracker-Za__6B\nCreated requirements tracker '/private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-tracker-Za__6B'\nCreated temporary directory: /private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-install-DJEDBz\nProcessing /Users/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/matplotlib-2.2.3.p0/src\n  Created temporary directory: /private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-build-46rwMp\n  Added file:///Users/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/matplotlib-2.2.3.p0/src to build tracker '/private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-tracker-Za__6B'\n  Running setup.py (path:/private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-build-46rwMp/setup.py) egg_info for package from file:///Users/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/matplotlib-2.2.3.p0/src\n    Running command python setup.py egg_info\n    ============================================================================\n    Edit setup.cfg to change the build options\n    BUILDING MATPLOTLIB\n                matplotlib: yes [2.2.3]\n                    python: yes [2.7.15 (default, Jan 27 2019, 04:12:55)  [GCC\n                            4.2.1 Compatible Apple LLVM 10.0.0\n                            (clang-1000.11.45.5)]]\n                  platform: yes [darwin]\n    REQUIRED DEPENDENCIES AND EXTENSIONS\n    Traceback (most recent call last):\n      File \"<string>\", line 1, in <module>\n      File \"/private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-build-46rwMp/setup.py\", line 172, in <module>\n        result = package.check()\n      File \"setupext.py\", line 963, in check\n        import numpy\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/__init__.py\", line 142, in <module>\n        from . import core\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/__init__.py\", line 59, in <module>\n        from . import numeric\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/numeric.py\", line 3093, in <module>\n        from . import fromnumeric\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/fromnumeric.py\", line 17, in <module>\n        from . import _methods\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/_methods.py\", line 158, in <module>\n        _NDARRAY_ARRAY_FUNCTION = mu.ndarray.__array_function__\n    AttributeError: type object 'numpy.ndarray' has no attribute '__array_function__'\nCleaning up...\n  Removing source in /private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-build-46rwMp\nRemoved file:///Users/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/matplotlib-2.2.3.p0/src from build tracker '/private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-tracker-Za__6B'\nRemoved build tracker '/private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-tracker-Za__6B'\nCommand \"python setup.py egg_info\" failed with error code 1 in /private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-build-46rwMp/\nException information:\nTraceback (most recent call last):\n  File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/pip/_internal/cli/base_command.py\", line 143, in main\n    status = self.run(options, args)\n  File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/pip/_internal/commands/install.py\", line 318, in run\n    resolver.resolve(requirement_set)\n  File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/pip/_internal/resolve.py\", line 102, in resolve\n    self._resolve_one(requirement_set, req)\n  File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/pip/_internal/resolve.py\", line 256, in _resolve_one\n    abstract_dist = self._get_abstract_dist_for(req_to_install)\n  File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/pip/_internal/resolve.py\", line 209, in _get_abstract_dist_for\n    self.require_hashes\n  File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/pip/_internal/operations/prepare.py\", line 298, in prepare_linked_requirement\n    abstract_dist.prep_for_dist(finder, self.build_isolation)\n  File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/pip/_internal/operations/prepare.py\", line 126, in prep_for_dist\n    self.req.run_egg_info()\n  File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/pip/_internal/req/req_install.py\", line 473, in run_egg_info\n    command_desc='python setup.py egg_info')\n  File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/pip/_internal/utils/misc.py\", line 705, in call_subprocess\n    % (command_desc, proc.returncode, cwd))\nInstallationError: Command \"python setup.py egg_info\" failed with error code 1 in /private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-build-46rwMp/\nError: installing with pip2 failed\n********************************************************************************\nError installing matplotlib-2.2.3.p0\n********************************************************************************\nreal\t0m6.450s\nuser\t0m2.680s\nsys\t0m3.147s\n************************************************************************\nError installing package matplotlib-2.2.3.p0\n************************************************************************\n```\n",
    "created_at": "2019-02-02T14:59:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376015",
    "user": "https://github.com/vbraun"
}
```

Seems to conflict with matplotlib on OSX:

```
Ignoring indexes: https://pypi.org/simple
Created temporary directory: /private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-ephem-wheel-cache-kl7Hms
Created temporary directory: /private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-tracker-Za__6B
Created requirements tracker '/private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-tracker-Za__6B'
Created temporary directory: /private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-install-DJEDBz
Processing /Users/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/matplotlib-2.2.3.p0/src
  Created temporary directory: /private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-build-46rwMp
  Added file:///Users/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/matplotlib-2.2.3.p0/src to build tracker '/private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-tracker-Za__6B'
  Running setup.py (path:/private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-build-46rwMp/setup.py) egg_info for package from file:///Users/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/matplotlib-2.2.3.p0/src
    Running command python setup.py egg_info
    ============================================================================
    Edit setup.cfg to change the build options
    BUILDING MATPLOTLIB
                matplotlib: yes [2.2.3]
                    python: yes [2.7.15 (default, Jan 27 2019, 04:12:55)  [GCC
                            4.2.1 Compatible Apple LLVM 10.0.0
                            (clang-1000.11.45.5)]]
                  platform: yes [darwin]
    REQUIRED DEPENDENCIES AND EXTENSIONS
    Traceback (most recent call last):
      File "<string>", line 1, in <module>
      File "/private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-build-46rwMp/setup.py", line 172, in <module>
        result = package.check()
      File "setupext.py", line 963, in check
        import numpy
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/__init__.py", line 142, in <module>
        from . import core
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/__init__.py", line 59, in <module>
        from . import numeric
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/numeric.py", line 3093, in <module>
        from . import fromnumeric
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/fromnumeric.py", line 17, in <module>
        from . import _methods
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/_methods.py", line 158, in <module>
        _NDARRAY_ARRAY_FUNCTION = mu.ndarray.__array_function__
    AttributeError: type object 'numpy.ndarray' has no attribute '__array_function__'
Cleaning up...
  Removing source in /private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-build-46rwMp
Removed file:///Users/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/matplotlib-2.2.3.p0/src from build tracker '/private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-tracker-Za__6B'
Removed build tracker '/private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-tracker-Za__6B'
Command "python setup.py egg_info" failed with error code 1 in /private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-build-46rwMp/
Exception information:
Traceback (most recent call last):
  File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/pip/_internal/cli/base_command.py", line 143, in main
    status = self.run(options, args)
  File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/pip/_internal/commands/install.py", line 318, in run
    resolver.resolve(requirement_set)
  File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/pip/_internal/resolve.py", line 102, in resolve
    self._resolve_one(requirement_set, req)
  File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/pip/_internal/resolve.py", line 256, in _resolve_one
    abstract_dist = self._get_abstract_dist_for(req_to_install)
  File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/pip/_internal/resolve.py", line 209, in _get_abstract_dist_for
    self.require_hashes
  File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/pip/_internal/operations/prepare.py", line 298, in prepare_linked_requirement
    abstract_dist.prep_for_dist(finder, self.build_isolation)
  File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/pip/_internal/operations/prepare.py", line 126, in prep_for_dist
    self.req.run_egg_info()
  File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/pip/_internal/req/req_install.py", line 473, in run_egg_info
    command_desc='python setup.py egg_info')
  File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/pip/_internal/utils/misc.py", line 705, in call_subprocess
    % (command_desc, proc.returncode, cwd))
InstallationError: Command "python setup.py egg_info" failed with error code 1 in /private/var/folders/hd/9pzxdk253fjbnwfcnj5bfmwc0000gs/T/pip-req-build-46rwMp/
Error: installing with pip2 failed
********************************************************************************
Error installing matplotlib-2.2.3.p0
********************************************************************************
real	0m6.450s
user	0m2.680s
sys	0m3.147s
************************************************************************
Error installing package matplotlib-2.2.3.p0
************************************************************************
```




---

archive/issue_comments_376016.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-02-02T14:59:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376016",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_376017.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-02-04T08:42:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376017",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_376018.json:
```json
{
    "body": "1.16.1 is out, no test failures (on Arch)",
    "created_at": "2019-02-04T11:48:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376018",
    "user": "https://github.com/antonio-rojas"
}
```

1.16.1 is out, no test failures (on Arch)



---

archive/issue_comments_376019.json:
```json
{
    "body": "What OSX version do you get that error on?",
    "created_at": "2019-02-04T11:53:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376019",
    "user": "https://github.com/dimpase"
}
```

What OSX version do you get that error on?



---

archive/issue_comments_376020.json:
```json
{
    "body": "latest (mojave)",
    "created_at": "2019-02-04T19:10:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376020",
    "user": "https://github.com/vbraun"
}
```

latest (mojave)



---

archive/issue_comments_376021.json:
```json
{
    "body": "\n```\nAttributeError: type object 'numpy.ndarray' has no attribute '__array_function__'\nCleaning up...\n```\n\nseems to tell one that the error was during the build of numpy.\nBring on da log!",
    "created_at": "2019-02-04T19:33:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376021",
    "user": "https://github.com/dimpase"
}
```


```
AttributeError: type object 'numpy.ndarray' has no attribute '__array_function__'
Cleaning up...
```

seems to tell one that the error was during the build of numpy.
Bring on da log!



---

archive/issue_comments_376022.json:
```json
{
    "body": "The scipy build fails similarly:\n\n```\nInstalling scipy-1.2.0\nTraceback (most recent call last):\n  File \"setup.py\", line 492, in <module>\n    setup_package()\n  File \"setup.py\", line 424, in setup_package\n    import numpy\n  File \"/Users/jdemeyer/sage/local/lib/python2.7/site-packages/numpy/__init__.py\", line 142, in <module>\n    from . import core\n  File \"/Users/jdemeyer/sage/local/lib/python2.7/site-packages/numpy/core/__init__.py\", line 59, in <module>\n    from . import numeric\n  File \"/Users/jdemeyer/sage/local/lib/python2.7/site-packages/numpy/core/numeric.py\", line 3093, in <module>\n    from . import fromnumeric\n  File \"/Users/jdemeyer/sage/local/lib/python2.7/site-packages/numpy/core/fromnumeric.py\", line 17, in <module>\n    from . import _methods\n  File \"/Users/jdemeyer/sage/local/lib/python2.7/site-packages/numpy/core/_methods.py\", line 158, in <module>\n    _NDARRAY_ARRAY_FUNCTION = mu.ndarray.__array_function__\nAttributeError: type object 'numpy.ndarray' has no attribute '__array_function__'\nError: could not determine package name\n********************************************************************************\n```\n",
    "created_at": "2019-02-06T10:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376022",
    "user": "https://github.com/jdemeyer"
}
```

The scipy build fails similarly:

```
Installing scipy-1.2.0
Traceback (most recent call last):
  File "setup.py", line 492, in <module>
    setup_package()
  File "setup.py", line 424, in setup_package
    import numpy
  File "/Users/jdemeyer/sage/local/lib/python2.7/site-packages/numpy/__init__.py", line 142, in <module>
    from . import core
  File "/Users/jdemeyer/sage/local/lib/python2.7/site-packages/numpy/core/__init__.py", line 59, in <module>
    from . import numeric
  File "/Users/jdemeyer/sage/local/lib/python2.7/site-packages/numpy/core/numeric.py", line 3093, in <module>
    from . import fromnumeric
  File "/Users/jdemeyer/sage/local/lib/python2.7/site-packages/numpy/core/fromnumeric.py", line 17, in <module>
    from . import _methods
  File "/Users/jdemeyer/sage/local/lib/python2.7/site-packages/numpy/core/_methods.py", line 158, in <module>
    _NDARRAY_ARRAY_FUNCTION = mu.ndarray.__array_function__
AttributeError: type object 'numpy.ndarray' has no attribute '__array_function__'
Error: could not determine package name
********************************************************************************
```




---

archive/issue_comments_376023.json:
```json
{
    "body": "this seems to be an NumPy/pip (?) problem: https://github.com/numpy/numpy/issues/12736",
    "created_at": "2019-02-06T10:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376023",
    "user": "https://github.com/dimpase"
}
```

this seems to be an NumPy/pip (?) problem: https://github.com/numpy/numpy/issues/12736



---

archive/issue_comments_376024.json:
```json
{
    "body": "We should upgrade to 1.16.1, where this bug is apparently fixed\nby https://github.com/numpy/numpy/pull/12891\n\nhttps://github.com/numpy/numpy/releases/tag/v1.16.1",
    "created_at": "2019-02-06T11:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376024",
    "user": "https://github.com/dimpase"
}
```

We should upgrade to 1.16.1, where this bug is apparently fixed
by https://github.com/numpy/numpy/pull/12891

https://github.com/numpy/numpy/releases/tag/v1.16.1



---

archive/issue_comments_376025.json:
```json
{
    "body": "Replying to [comment:31 dimpase]:\n> We should upgrade to 1.16.1, where this bug is apparently fixed\n> by https://github.com/numpy/numpy/pull/12891\n\nThere is nothing \"fixed\". The only thing that changed is a better error message. Apparently we're not properly deleting old versions of numpy.",
    "created_at": "2019-02-08T08:49:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376025",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:31 dimpase]:
> We should upgrade to 1.16.1, where this bug is apparently fixed
> by https://github.com/numpy/numpy/pull/12891

There is nothing "fixed". The only thing that changed is a better error message. Apparently we're not properly deleting old versions of numpy.



---

archive/issue_comments_376026.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-02-08T08:56:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376026",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_376027.json:
```json
{
    "body": "Adding a `spkg-legacy-uninstall` script should fix things.",
    "created_at": "2019-02-08T08:57:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376027",
    "user": "https://github.com/jdemeyer"
}
```

Adding a `spkg-legacy-uninstall` script should fix things.



---

archive/issue_comments_376028.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-02-08T08:58:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376028",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_376029.json:
```json
{
    "body": "OK, looks good.",
    "created_at": "2019-02-11T00:56:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376029",
    "user": "https://github.com/dimpase"
}
```

OK, looks good.



---

archive/issue_comments_376030.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-02-11T00:56:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376030",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_024855.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2019-02-13T20:56:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26763#event-24855"
}
```



---

archive/issue_comments_376031.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-02-13T20:56:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26763",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26763#issuecomment-376031",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
