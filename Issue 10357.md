# Issue 10357: The sloane_find command is now completely broken

archive/issues_010357.json:
```json
{
    "body": "Assignee: sage-combinat\n\nCC:  sage-combinat @williamstein @kini jpflori chrisjamesberg vivianepons\n\nThe sloane_find command, which parses output of a webpage, is now completely broken due to the Sloane sequence webpage being rewritten. It silently always finds nothing.\n\n\n```\nsage: sloane_find([1,1,2,3,5,8,13,21], nresults=1)\n[]\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/10358\n\n",
    "created_at": "2010-12-01T03:02:31Z",
    "labels": [
        "combinatorics",
        "critical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.13",
    "title": "The sloane_find command is now completely broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10357",
    "user": "@williamstein"
}
```
Assignee: sage-combinat

CC:  sage-combinat @williamstein @kini jpflori chrisjamesberg vivianepons

The sloane_find command, which parses output of a webpage, is now completely broken due to the Sloane sequence webpage being rewritten. It silently always finds nothing.


```
sage: sloane_find([1,1,2,3,5,8,13,21], nresults=1)
[]
```


Issue created by migration from https://trac.sagemath.org/ticket/10358





---

archive/issue_comments_106441.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2010-12-01T03:02:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106441",
    "user": "@williamstein"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_106442.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2010-12-01T03:04:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106442",
    "user": "@williamstein"
}
```

Resolution: duplicate



---

archive/issue_comments_106443.json:
```json
{
    "body": "Crap, this is a dup of #10056",
    "created_at": "2010-12-01T03:04:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106443",
    "user": "@williamstein"
}
```

Crap, this is a dup of #10056



---

archive/issue_comments_106444.json:
```json
{
    "body": "Changing assignee from sage-combinat to tmonteil.",
    "created_at": "2011-01-25T13:43:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106444",
    "user": "tmonteil"
}
```

Changing assignee from sage-combinat to tmonteil.



---

archive/issue_comments_106445.json:
```json
{
    "body": "Hi,\n\nthe aim of #10056 was to migrate every url in sage that was dealing with Sloane's database at once (not only `sloane_find()`), hence this is not really a duplicate. The issue here is that oeis changed their html templates, so the sage parsers are not working anymore. I just coded a new parser, which you can see working on the combinat repository (`sloane_new_website_parsers-tm.patch`).\n\nI added the more atomic functions in `sage/databases/sloane.py` (the documentation still needs to be fixed):\n\n- `sloane_discover()` which discovers which sequences correspond to some list of integers.\n- `sloane_first_terms()` which returns the first terms of the sequence.\n- `sloane_description()` which returns the one line description of the sequence.\n\nI don't really know what to do with the broken functions:\n- `parse_sequence()` is completely dead and now useless. Should it now raise a deprecation warning ?\n- `sloane_sequence()` and `sloane_find()` are broken, but maybe some users still need them, should i make them working again as a combination of the first 3 functions ?\n\nAlso, maybe all those functions should be renamed by replacing sloane by oeis ? This may be too early since i guess most people know more about Sloane than about oeis. In such a case, what is the procedure/convention to ensure backward compatibility ?\n\nAt the end, we could have a daily crontab to check when the oeis changes its html template, and adapt the parsers accordingly. Better, we could ask them to provide an online standard query system, but if i understand a discussion in the nmbrthry mailing-list, this may not be their whish.\n\nCiao,\nThierry",
    "created_at": "2011-01-25T13:43:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106445",
    "user": "tmonteil"
}
```

Hi,

the aim of #10056 was to migrate every url in sage that was dealing with Sloane's database at once (not only `sloane_find()`), hence this is not really a duplicate. The issue here is that oeis changed their html templates, so the sage parsers are not working anymore. I just coded a new parser, which you can see working on the combinat repository (`sloane_new_website_parsers-tm.patch`).

I added the more atomic functions in `sage/databases/sloane.py` (the documentation still needs to be fixed):

- `sloane_discover()` which discovers which sequences correspond to some list of integers.
- `sloane_first_terms()` which returns the first terms of the sequence.
- `sloane_description()` which returns the one line description of the sequence.

I don't really know what to do with the broken functions:
- `parse_sequence()` is completely dead and now useless. Should it now raise a deprecation warning ?
- `sloane_sequence()` and `sloane_find()` are broken, but maybe some users still need them, should i make them working again as a combination of the first 3 functions ?

Also, maybe all those functions should be renamed by replacing sloane by oeis ? This may be too early since i guess most people know more about Sloane than about oeis. In such a case, what is the procedure/convention to ensure backward compatibility ?

At the end, we could have a daily crontab to check when the oeis changes its html template, and adapt the parsers accordingly. Better, we could ask them to provide an online standard query system, but if i understand a discussion in the nmbrthry mailing-list, this may not be their whish.

Ciao,
Thierry



---

archive/issue_comments_106446.json:
```json
{
    "body": "Changing status from closed to needs_work.",
    "created_at": "2011-01-25T13:44:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106446",
    "user": "tmonteil"
}
```

Changing status from closed to needs_work.



---

archive/issue_comments_106447.json:
```json
{
    "body": "Salut Thierry,\n\nRather than having a bunch of functions to return the various pieces of a Sloane result, there could be a single object from which one could query the pieces via methods. Something like:\n\n\n```\n    sage: s = sloane_find([1,1,2,5,8,14])[0]\n    sage: s.description()\n    ...\n    sage: s[6]\n    42\n```\n\n\n\nActually, Anders Claesson [1] had implemented a prototype of this feature during FPSAC'09, and his demo was quite cool. I guess he would agree to give his code away for someone else to finalize it and merge it into Sage.\n\nBut maybe that should be the topic of a separate ticket.\n\n[1] http://combinatorics.is/anders/",
    "created_at": "2011-01-26T10:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106447",
    "user": "@nthiery"
}
```

Salut Thierry,

Rather than having a bunch of functions to return the various pieces of a Sloane result, there could be a single object from which one could query the pieces via methods. Something like:


```
    sage: s = sloane_find([1,1,2,5,8,14])[0]
    sage: s.description()
    ...
    sage: s[6]
    42
```



Actually, Anders Claesson [1] had implemented a prototype of this feature during FPSAC'09, and his demo was quite cool. I guess he would agree to give his code away for someone else to finalize it and merge it into Sage.

But maybe that should be the topic of a separate ticket.

[1] http://combinatorics.is/anders/



---

archive/issue_comments_106448.json:
```json
{
    "body": "Resolution changed from duplicate to fixed",
    "created_at": "2011-10-23T01:23:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106448",
    "user": "@nexttime"
}
```

Resolution changed from duplicate to fixed



---

archive/issue_comments_106449.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2011-10-23T01:24:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106449",
    "user": "@nexttime"
}
```

Changing status from closed to new.



---

archive/issue_comments_106450.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2011-10-23T01:24:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106450",
    "user": "@nexttime"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_106451.json:
```json
{
    "body": "By the way, if you need to play with OEIS now, here is the current version of the patch in preparation, on sage-combinat: [http://combinat.sagemath.org/patches/file/0506836c7c66/sloane_new_website_parsers-tm.patch](http://combinat.sagemath.org/patches/file/0506836c7c66/sloane_new_website_parsers-tm.patch)\n\nThe methods still parse the new website correctly, but i didn't put everything in a single class yet as Nicolas suggested.",
    "created_at": "2011-10-23T15:49:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106451",
    "user": "tmonteil"
}
```

By the way, if you need to play with OEIS now, here is the current version of the patch in preparation, on sage-combinat: [http://combinat.sagemath.org/patches/file/0506836c7c66/sloane_new_website_parsers-tm.patch](http://combinat.sagemath.org/patches/file/0506836c7c66/sloane_new_website_parsers-tm.patch)

The methods still parse the new website correctly, but i didn't put everything in a single class yet as Nicolas suggested.



---

archive/issue_comments_106452.json:
```json
{
    "body": "Oh, no particular hurry. I just happened to notice OEIS was broken, and was surprised to find that this ticket was closed, so I asked leif to reopen it. Glad to hear there is a patch in the works. If possible could you post it here once in a while? As the ticket hadn't been changed for 9 months I thought nobody was working on it. Thanks!",
    "created_at": "2011-10-24T07:07:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106452",
    "user": "@kini"
}
```

Oh, no particular hurry. I just happened to notice OEIS was broken, and was surprised to find that this ticket was closed, so I asked leif to reopen it. Glad to hear there is a patch in the works. If possible could you post it here once in a while? As the ticket hadn't been changed for 9 months I thought nobody was working on it. Thanks!



---

archive/issue_comments_106453.json:
```json
{
    "body": "Changing keywords from \"\" to \"Cernay2012\".",
    "created_at": "2012-02-10T02:54:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106453",
    "user": "tmonteil"
}
```

Changing keywords from "" to "Cernay2012".



---

archive/issue_comments_106454.json:
```json
{
    "body": "Thierry, can you upload your patch here? Was it ready?\n\nS\u00e9bastien",
    "created_at": "2012-08-01T12:57:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106454",
    "user": "@seblabbe"
}
```

Thierry, can you upload your patch here? Was it ready?

Sébastien



---

archive/issue_comments_106455.json:
```json
{
    "body": "See also #13884, though it should be dealt with here.\n\nAnd FYI, we would want to make sure that this also works:\n\n```\nsage -t --only_optional=internet \"devel/sage/sage/combinat/words/paths.py\"\n    sage: sloane_find(_, nresults=1) #optional - internet\nExpected:\n    Searching Sloane's online database...\n    [[1653,\n      'Numbers n such that 2*n^2 - 1 is a square.',\n      [1,\n       5,\n       29,\n       169,\n       985,\n       5741,\n       33461,\n       195025,\n       1136689,\n       6625109,\n       38613965,\n       225058681,\n       1311738121,\n       7645370045,\n       44560482149,\n       259717522849,\n       1513744654945,\n       8822750406821,\n       51422757785981,\n       299713796309065,\n       1746860020068409]]]\nGot:\n    Searching Sloane's online database...\n    []\n**********************************************************************\n```\n\nWhich of course it should once this is done, but wanted to point it out since it's in a different file.",
    "created_at": "2013-01-03T18:05:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106455",
    "user": "@kcrisman"
}
```

See also #13884, though it should be dealt with here.

And FYI, we would want to make sure that this also works:

```
sage -t --only_optional=internet "devel/sage/sage/combinat/words/paths.py"
    sage: sloane_find(_, nresults=1) #optional - internet
Expected:
    Searching Sloane's online database...
    [[1653,
      'Numbers n such that 2*n^2 - 1 is a square.',
      [1,
       5,
       29,
       169,
       985,
       5741,
       33461,
       195025,
       1136689,
       6625109,
       38613965,
       225058681,
       1311738121,
       7645370045,
       44560482149,
       259717522849,
       1513744654945,
       8822750406821,
       51422757785981,
       299713796309065,
       1746860020068409]]]
Got:
    Searching Sloane's online database...
    []
**********************************************************************
```

Which of course it should once this is done, but wanted to point it out since it's in a different file.



---

archive/issue_comments_106456.json:
```json
{
    "body": "> Thierry, can you upload your patch here? Was it ready?\n\n6 months old question left unanswered.. Time for a ping `:-P`\n\nNathann",
    "created_at": "2013-01-20T10:07:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106456",
    "user": "@nathanncohen"
}
```

> Thierry, can you upload your patch here? Was it ready?

6 months old question left unanswered.. Time for a ping `:-P`

Nathann



---

archive/issue_comments_106457.json:
```json
{
    "body": "http://combinat.sagemath.org/patches/log/tip/sloane_new_website_parsers-tm.patch\n\nNothing happened for two years, and the patch is still sitting in the combinat queue without being posted on trac.",
    "created_at": "2013-01-20T10:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106457",
    "user": "@kini"
}
```

http://combinat.sagemath.org/patches/log/tip/sloane_new_website_parsers-tm.patch

Nothing happened for two years, and the patch is still sitting in the combinat queue without being posted on trac.



---

archive/issue_comments_106458.json:
```json
{
    "body": "\"The Sage-Combinat experience\" `:-P`\n\nSo, should we set this ticket to `need_work`, or `needs_info`, or `wait_for_the_combinat_queue_to_be_reviewed` ? `:-P`\n\nNathann",
    "created_at": "2013-01-20T10:15:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106458",
    "user": "@nathanncohen"
}
```

"The Sage-Combinat experience" `:-P`

So, should we set this ticket to `need_work`, or `needs_info`, or `wait_for_the_combinat_queue_to_be_reviewed` ? `:-P`

Nathann



---

archive/issue_comments_106459.json:
```json
{
    "body": "Hi,\n\nsorry for the delay, the version on the combinat queue is not the good one, during the Cernay combinat days in last february (less than one year!), i build a new class named oeis, that allows to get all kind of information from the oeis db (cross references, web links, ...).\n\nI upload a temporary version here so that you can try it, but the documentation is not finished, and non backward-compatible changes may still appear.\n\nThierry",
    "created_at": "2013-01-21T11:32:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106459",
    "user": "tmonteil"
}
```

Hi,

sorry for the delay, the version on the combinat queue is not the good one, during the Cernay combinat days in last february (less than one year!), i build a new class named oeis, that allows to get all kind of information from the oeis db (cross references, web links, ...).

I upload a temporary version here so that you can try it, but the documentation is not finished, and non backward-compatible changes may still appear.

Thierry



---

archive/issue_comments_106460.json:
```json
{
    "body": "The patch needs to be rebased after #13701, some doctests, and make urls clickable from the notebook. \n\nI will finish this during sage days 49.",
    "created_at": "2013-06-08T17:06:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106460",
    "user": "tmonteil"
}
```

The patch needs to be rebased after #13701, some doctests, and make urls clickable from the notebook. 

I will finish this during sage days 49.



---

archive/issue_comments_106461.json:
```json
{
    "body": "Attachment [trac_10358-oeis-tm.patch](tarball://root/attachments/some-uuid/ticket10358/trac_10358-oeis-tm.patch) by tmonteil created at 2013-06-21 17:24:09",
    "created_at": "2013-06-21T17:24:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106461",
    "user": "tmonteil"
}
```

Attachment [trac_10358-oeis-tm.patch](tarball://root/attachments/some-uuid/ticket10358/trac_10358-oeis-tm.patch) by tmonteil created at 2013-06-21 17:24:09



---

archive/issue_comments_106462.json:
```json
{
    "body": "There is a room for lots of improvements, but i submit it now under the social pressure ;)\n\nMost tests use an internet connection, so do not forget `--optional=sage,internet` when testing.\n\nThe name of the method `.natural_object()` might be improved (`.sage()` is not better since an OEIS sequence is already a Sage object).",
    "created_at": "2013-06-21T17:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106462",
    "user": "tmonteil"
}
```

There is a room for lots of improvements, but i submit it now under the social pressure ;)

Most tests use an internet connection, so do not forget `--optional=sage,internet` when testing.

The name of the method `.natural_object()` might be improved (`.sage()` is not better since an OEIS sequence is already a Sage object).



---

archive/issue_comments_106463.json:
```json
{
    "body": "Changing keywords from \"Cernay2012\" to \"Cernay2012 days49\".",
    "created_at": "2013-06-21T17:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106463",
    "user": "tmonteil"
}
```

Changing keywords from "Cernay2012" to "Cernay2012 days49".



---

archive/issue_comments_106464.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-06-21T17:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106464",
    "user": "tmonteil"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_106465.json:
```json
{
    "body": "Just a brief question - why the `oeis()` rather than `sloane_find()`?  Are you just completely replacing the sloane.py?  I just don't quite get why this isn't just all put in sloane.py, and perhaps the new code replacing the broken code... Not that I have a vested interest in this.\n\nI do recommend that all references to `is broken for more than a year` be changed to `is broken` or perhaps `has been broken for some time`.\n\nAlso, it would be nice to have references like \n\n```\nclass:`sage.databases.oeis.OEIS`_\n```\n\nor whatever the correct format is.",
    "created_at": "2013-06-21T17:40:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106465",
    "user": "@kcrisman"
}
```

Just a brief question - why the `oeis()` rather than `sloane_find()`?  Are you just completely replacing the sloane.py?  I just don't quite get why this isn't just all put in sloane.py, and perhaps the new code replacing the broken code... Not that I have a vested interest in this.

I do recommend that all references to `is broken for more than a year` be changed to `is broken` or perhaps `has been broken for some time`.

Also, it would be nice to have references like 

```
class:`sage.databases.oeis.OEIS`_
```

or whatever the correct format is.



---

archive/issue_comments_106466.json:
```json
{
    "body": "Here is how i understand the mess. There are three different things related to OEIS in Sage.\n\n- `sage/databases/sloane.py` (still) contains a class `SloaneEncyclopedia` that\n  corresponds to a local partial copy of the OEIS. It is really a database.\n  This file used to contain a function `sloane_find()` as well that, given a\n  sequence, looked on the web and answered the name, the title, and the first\n  terms of the OEIS sequences containing it.\n\n- `sage/databases/oeis.py` (which is created by this patch) contains two\n  classes,\n  - `OEIS`, that represents the on-line database, so that you can ask it questions\n    like\n    - give me the sequence whose ID is 'A000040'\n    - give me 5 sequences whose description deal with \"decimals\".\n    - give me 3 sequences that contain `[2,3,5,7]` as a subsequence.\n    - (todo) : give me the explanation of the keyword 'cofr'\n    - ...\n  - `OEISSequence` that represents a sequence, so that you can ask it questions like\n    - what is your name ?\n    - what are your first terms ?\n    - are you finite ?\n    - do you have some references, links,... ?\n    - what is your starting index ?\n    - which natural Sage object do you represent (continued fraction, decimal\n      number, sequence, power series,...) ?\n    - ...\n\n- `sage/combinat/sloane_functions.py` contains a generic class `SloaneSequence`,\n  and a class (that inherits from the generic one) for each implementation of a\n  given OEIS sequence. Such a class allows to dynamically give more terms than\n  the one stored in OEIS. This functionality could perhaps be redesigned in\n  something lighter (like a dictionary of functions), to ease adding new\n  entries).\n\nOf course `OEIS` and `sloane_find()` are related, which is why i posted the patch\non this ticket. But, the answers are not of the same type (direct informations\nversus an OEIS sequences that you can ask for informations), hence if i name\nthe class `OEIS` as `sloane_find`, old code using `sloane_find()` won't work either,\nhence the deprecation warning instead. Also it would have been harder to\nextend the `function sloane_find()`, where it will be easy for the classes\n`OEIS`/`OEISSequence`.\n\nActually, i do not know whether `oeis.py` should stay in the `sage/databases/`\ndirectory, since is it not an interface to a local database but a tool to\nfetch an online website, like `finance/stock.py` and `interfaces/magma_free.py`\n\nPerhaps should i move it to `sage/combinat/` directory (where\n`sloane_functions.py` is), or maybe we should move all three tools to a\n`sage/combinat/oeis/` directory (but then `sloane.py` will not be in `sage/databases/` anymore) ? The current choice is the laziest.\n\nOf course those 3 tools related to OEIS should be interfaced together (e.g. if\nthere are too many online queries, suggest the user to install the offline\ndatabase ; if there is a Sage implementation of some OEIS sequence, then use\nit when iterating over it once the first terms are exhausted ; and so on).\nThis is planned but, will take some more tests, and perhaps having 3 different tools for 3 different purposes is a good start. Having the web, the DB and the\nfunctions interfaced will also allow to be more lazy (e.g an OEIS sequence\ncould be created with only its ID, without fetching the web as long as there are local\nanswers, this could be easily done in the OEIS/OEISSequence framework).\n\nI will change the deprecation messages, and description of broken functions as you suggested.\n\nConcerning the reference class:`sage.databases.oeis.OEIS`_, i already put one in the general description of sloane.py (as a SEEALSO::). Should i also put one in the deprecation warnings as well ?",
    "created_at": "2013-06-22T09:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106466",
    "user": "tmonteil"
}
```

Here is how i understand the mess. There are three different things related to OEIS in Sage.

- `sage/databases/sloane.py` (still) contains a class `SloaneEncyclopedia` that
  corresponds to a local partial copy of the OEIS. It is really a database.
  This file used to contain a function `sloane_find()` as well that, given a
  sequence, looked on the web and answered the name, the title, and the first
  terms of the OEIS sequences containing it.

- `sage/databases/oeis.py` (which is created by this patch) contains two
  classes,
  - `OEIS`, that represents the on-line database, so that you can ask it questions
    like
    - give me the sequence whose ID is 'A000040'
    - give me 5 sequences whose description deal with "decimals".
    - give me 3 sequences that contain `[2,3,5,7]` as a subsequence.
    - (todo) : give me the explanation of the keyword 'cofr'
    - ...
  - `OEISSequence` that represents a sequence, so that you can ask it questions like
    - what is your name ?
    - what are your first terms ?
    - are you finite ?
    - do you have some references, links,... ?
    - what is your starting index ?
    - which natural Sage object do you represent (continued fraction, decimal
      number, sequence, power series,...) ?
    - ...

- `sage/combinat/sloane_functions.py` contains a generic class `SloaneSequence`,
  and a class (that inherits from the generic one) for each implementation of a
  given OEIS sequence. Such a class allows to dynamically give more terms than
  the one stored in OEIS. This functionality could perhaps be redesigned in
  something lighter (like a dictionary of functions), to ease adding new
  entries).

Of course `OEIS` and `sloane_find()` are related, which is why i posted the patch
on this ticket. But, the answers are not of the same type (direct informations
versus an OEIS sequences that you can ask for informations), hence if i name
the class `OEIS` as `sloane_find`, old code using `sloane_find()` won't work either,
hence the deprecation warning instead. Also it would have been harder to
extend the `function sloane_find()`, where it will be easy for the classes
`OEIS`/`OEISSequence`.

Actually, i do not know whether `oeis.py` should stay in the `sage/databases/`
directory, since is it not an interface to a local database but a tool to
fetch an online website, like `finance/stock.py` and `interfaces/magma_free.py`

Perhaps should i move it to `sage/combinat/` directory (where
`sloane_functions.py` is), or maybe we should move all three tools to a
`sage/combinat/oeis/` directory (but then `sloane.py` will not be in `sage/databases/` anymore) ? The current choice is the laziest.

Of course those 3 tools related to OEIS should be interfaced together (e.g. if
there are too many online queries, suggest the user to install the offline
database ; if there is a Sage implementation of some OEIS sequence, then use
it when iterating over it once the first terms are exhausted ; and so on).
This is planned but, will take some more tests, and perhaps having 3 different tools for 3 different purposes is a good start. Having the web, the DB and the
functions interfaced will also allow to be more lazy (e.g an OEIS sequence
could be created with only its ID, without fetching the web as long as there are local
answers, this could be easily done in the OEIS/OEISSequence framework).

I will change the deprecation messages, and description of broken functions as you suggested.

Concerning the reference class:`sage.databases.oeis.OEIS`_, i already put one in the general description of sloane.py (as a SEEALSO::). Should i also put one in the deprecation warnings as well ?



---

archive/issue_comments_106467.json:
```json
{
    "body": "Helloooooooo !!\n\nI noticed small things\n\n* `find_by_description` does not use `first_result`\n* ```absolute_value`` - (bool, default False) expliquer le bordel.`\n* Shouldn't `OEISSequence.fields` be renamed to `_fields` ? It's weird to have this constant among so many functions in the tab-completion.\n* In your deprecation warnings could you replace \"oeis\" by \"oeis()\" ? To emphasize that \"oeis\" is a function that should be used instead of \"sloane_find\" ?\n* I am not a big fan of the design of `first_terms` which builds the list of all terms, and that is subsequently called by `__call__` and `__getitem__` that ignore most values and return only one. But of course efficiency is not really a problem here `:-P`\n* The documentation of the OEIS module begins a tad harshly. A sentence saying \"The OEIS is an online database for integer sequences, you can query it through Sage in order to guess how an integer sequence contiues and what it may mean\" would be nice before all Sage examples are given `:-)`\n\nThis being said I like your new code, and I think that it fits well in `database/`...\n\nNathann",
    "created_at": "2013-06-27T18:21:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106467",
    "user": "@nathanncohen"
}
```

Helloooooooo !!

I noticed small things

* `find_by_description` does not use `first_result`
* ```absolute_value`` - (bool, default False) expliquer le bordel.`
* Shouldn't `OEISSequence.fields` be renamed to `_fields` ? It's weird to have this constant among so many functions in the tab-completion.
* In your deprecation warnings could you replace "oeis" by "oeis()" ? To emphasize that "oeis" is a function that should be used instead of "sloane_find" ?
* I am not a big fan of the design of `first_terms` which builds the list of all terms, and that is subsequently called by `__call__` and `__getitem__` that ignore most values and return only one. But of course efficiency is not really a problem here `:-P`
* The documentation of the OEIS module begins a tad harshly. A sentence saying "The OEIS is an online database for integer sequences, you can query it through Sage in order to guess how an integer sequence contiues and what it may mean" would be nice before all Sage examples are given `:-)`

This being said I like your new code, and I think that it fits well in `database/`...

Nathann



---

archive/issue_comments_106468.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2013-06-28T16:52:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106468",
    "user": "@nathanncohen"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_106469.json:
```json
{
    "body": "Here is the first review patch.\n\nSuggested by Karl-Dieter:\n\n- I do recommend that all references to is broken for more than a year be\n  changed to is broken or perhaps has been broken for some time.\n    - Done.\n- Also, it would be nice to have references like\n  class:`sage.databases.oeis.OEIS`_ or whatever the correct format is.\n    - Done\n    - I added :mod:`OEIS <sage.databases.oeis>`\n    - I also added similar cross references between the three Sloane-related modules.\n\nSuggested by Nathann:\n\n- find_by_description does not use first_result\n    - Done.\n    - I think it disapeared when migrating from my first patch and the new\n      framework.\n- ``absolute_value`` - (bool, default False) expliquer le bordel.\n    - Done.\n    - Why did my en_GB spell checker did not alert me about that ? ;)\n- Shouldn't OEISSequence.fields be renamed to _fields ? It's weird to have\n  this constant among so many functions in the tab-completion.\n    - Done.\n    - I like to see it exists, but i agree this may be confusing, and perhaps\n      someone that need this will find it even if it is called _fields.\n- In your deprecation warnings could you replace \"oeis\" by \"oeis()\" ? To\n  emphasize that \"oeis\" is a function that should be used instead of\n  \"sloane_find\" ?\n    - Done.\n- I am not a big fan of the design of first_terms which builds the list of all\n  terms, and that is subsequently called by __call__ and __getitem__ that\n  ignore most values and return only one. But of course efficiency is not\n  really a problem here :-P\n    - Done.\n    - Actually, the result we get from the website is a string from which we\n      have to extract the first terms, and if i want the 10th term, id no not\n      see how to find it without parsing the whole string (or at least a big\n      part of it since i do not know the length of the 9 previous integers of\n      the sequence). There used to be a `@`cached_method here (and i forgot to\n      remove the associated import_statement), so i put it back, hence many\n      calls to __call__ or __getitem__ will cost string parsing only the first\n      time.\n    - Also, i think it is good to have such a separate method to say that\n      those first terms come from the online database. This might be useful\n      when interfacing with `sloane_functions`, and then have a differnt\n      method like `further_terms` or so, to distinguish them (and allow cross\n      testing).\n- The documentation of the OEIS module begins a tad harshly. A sentence saying\n  \"The OEIS is an online database for integer sequences, you can query it\n  through Sage in order to guess how an integer sequence contiues and what it\n  may mean\" would be nice before all Sage examples are given :-)\n    - Done.\n\nMoreover, i took the opportunity to fix a few things:\n\n- I added empty default values to the variables of sloane_find() and\n  sloane_sequence() so that calling them without argument will lead to the\n  deprecation warning instead of an error.\n- Thanks to the patchbot, i noticed that Sage startuptime was slower with\n  oeis, this is due to the import of modules that are not imported elsewhere\n  in Sage: `HTMLParser` and `webbrowser`. Therefore, i now import them in the\n  right methods only, and make oeis lazy_imported as well.\n- Thanks to the patchbot, i put doctest coverage of oeis.py to 100% (i forgot\n  to doctest `.__init__()` and untestable functions like `.browse()`)\n- I removed an old unused option in `FancyTuple`, and fixed some typos.\n- I added a .browse() method to OEIS class.",
    "created_at": "2013-07-16T10:47:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106469",
    "user": "tmonteil"
}
```

Here is the first review patch.

Suggested by Karl-Dieter:

- I do recommend that all references to is broken for more than a year be
  changed to is broken or perhaps has been broken for some time.
    - Done.
- Also, it would be nice to have references like
  class:`sage.databases.oeis.OEIS`_ or whatever the correct format is.
    - Done
    - I added :mod:`OEIS <sage.databases.oeis>`
    - I also added similar cross references between the three Sloane-related modules.

Suggested by Nathann:

- find_by_description does not use first_result
    - Done.
    - I think it disapeared when migrating from my first patch and the new
      framework.
- ``absolute_value`` - (bool, default False) expliquer le bordel.
    - Done.
    - Why did my en_GB spell checker did not alert me about that ? ;)
- Shouldn't OEISSequence.fields be renamed to _fields ? It's weird to have
  this constant among so many functions in the tab-completion.
    - Done.
    - I like to see it exists, but i agree this may be confusing, and perhaps
      someone that need this will find it even if it is called _fields.
- In your deprecation warnings could you replace "oeis" by "oeis()" ? To
  emphasize that "oeis" is a function that should be used instead of
  "sloane_find" ?
    - Done.
- I am not a big fan of the design of first_terms which builds the list of all
  terms, and that is subsequently called by __call__ and __getitem__ that
  ignore most values and return only one. But of course efficiency is not
  really a problem here :-P
    - Done.
    - Actually, the result we get from the website is a string from which we
      have to extract the first terms, and if i want the 10th term, id no not
      see how to find it without parsing the whole string (or at least a big
      part of it since i do not know the length of the 9 previous integers of
      the sequence). There used to be a `@`cached_method here (and i forgot to
      remove the associated import_statement), so i put it back, hence many
      calls to __call__ or __getitem__ will cost string parsing only the first
      time.
    - Also, i think it is good to have such a separate method to say that
      those first terms come from the online database. This might be useful
      when interfacing with `sloane_functions`, and then have a differnt
      method like `further_terms` or so, to distinguish them (and allow cross
      testing).
- The documentation of the OEIS module begins a tad harshly. A sentence saying
  "The OEIS is an online database for integer sequences, you can query it
  through Sage in order to guess how an integer sequence contiues and what it
  may mean" would be nice before all Sage examples are given :-)
    - Done.

Moreover, i took the opportunity to fix a few things:

- I added empty default values to the variables of sloane_find() and
  sloane_sequence() so that calling them without argument will lead to the
  deprecation warning instead of an error.
- Thanks to the patchbot, i noticed that Sage startuptime was slower with
  oeis, this is due to the import of modules that are not imported elsewhere
  in Sage: `HTMLParser` and `webbrowser`. Therefore, i now import them in the
  right methods only, and make oeis lazy_imported as well.
- Thanks to the patchbot, i put doctest coverage of oeis.py to 100% (i forgot
  to doctest `.__init__()` and untestable functions like `.browse()`)
- I removed an old unused option in `FancyTuple`, and fixed some typos.
- I added a .browse() method to OEIS class.



---

archive/issue_comments_106470.json:
```json
{
    "body": "First review patch",
    "created_at": "2013-07-16T10:48:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106470",
    "user": "tmonteil"
}
```

First review patch



---

archive/issue_comments_106471.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2013-07-16T11:03:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106471",
    "user": "tmonteil"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_106472.json:
```json
{
    "body": "Attachment [trac_10358-oeis-review_1-tm.patch](tarball://root/attachments/some-uuid/ticket10358/trac_10358-oeis-review_1-tm.patch) by tmonteil created at 2013-07-16 11:03:06",
    "created_at": "2013-07-16T11:03:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106472",
    "user": "tmonteil"
}
```

Attachment [trac_10358-oeis-review_1-tm.patch](tarball://root/attachments/some-uuid/ticket10358/trac_10358-oeis-review_1-tm.patch) by tmonteil created at 2013-07-16 11:03:06



---

archive/issue_comments_106473.json:
```json
{
    "body": "I am playing with oeis again and thought of two others things..\n\n* How come that there is no \".sequence\" entry when you have a oeis sequence ? Sounds natural, doesn't it ? Wouldn't it be muuuuch more natural than \"first_n_terms\" ? `O_o`\n\n* How come that there is no way to print all the information that OEIS knows on the sequence ? Something like `seq.show_all()` or `seq.show` ? Right now everything is split in manymany fields, which is nice if you want to write some code but if you just want to know everything there is to know about this sequence, well.. It's quite uneasy to use, isn't it ?\n\nOh, and perhaps you should use viewer.browser instead of webbroser ?\n\nhttp://www.sagemath.org/doc/reference/misc/sage/misc/viewer.html\n\nNathann",
    "created_at": "2013-07-17T19:45:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106473",
    "user": "@nathanncohen"
}
```

I am playing with oeis again and thought of two others things..

* How come that there is no ".sequence" entry when you have a oeis sequence ? Sounds natural, doesn't it ? Wouldn't it be muuuuch more natural than "first_n_terms" ? `O_o`

* How come that there is no way to print all the information that OEIS knows on the sequence ? Something like `seq.show_all()` or `seq.show` ? Right now everything is split in manymany fields, which is nice if you want to write some code but if you just want to know everything there is to know about this sequence, well.. It's quite uneasy to use, isn't it ?

Oh, and perhaps you should use viewer.browser instead of webbroser ?

http://www.sagemath.org/doc/reference/misc/sage/misc/viewer.html

Nathann



---

archive/issue_comments_106474.json:
```json
{
    "body": "Hmmmmmm... Looks like your way of picking the browser makes more sense than mine. It's bit weird though that `viewer.browser` does not use webbrowser at all `O_o`\n\nNathann",
    "created_at": "2013-07-17T21:57:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106474",
    "user": "@nathanncohen"
}
```

Hmmmmmm... Looks like your way of picking the browser makes more sense than mine. It's bit weird though that `viewer.browser` does not use webbrowser at all `O_o`

Nathann



---

archive/issue_comments_106475.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-07-17T21:57:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106475",
    "user": "@nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_106476.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-07-17T21:58:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106476",
    "user": "@nathanncohen"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_106477.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-07-17T21:58:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106477",
    "user": "@nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_106478.json:
```json
{
    "body": "In this second review ticket, i added a basic `.show()` method as Nathann suggested.\n\nI took the opportunity to update a doctest (an OEIS entry was updated), to let `.cross_references()` return tuples instead of lists (like the other methods), and to have a better alignment in the representation of `FancyTuple`.\n\nConcerning the name `.sequence()` vs `.first_terms()` i prefer to stick to `.first_terms()` because we only got the first few terms, not the whole sequence. Perhaps `.sequence()` could be defined while interfacing `oeis` with `sloane_sequence`.",
    "created_at": "2013-07-20T01:09:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106478",
    "user": "tmonteil"
}
```

In this second review ticket, i added a basic `.show()` method as Nathann suggested.

I took the opportunity to update a doctest (an OEIS entry was updated), to let `.cross_references()` return tuples instead of lists (like the other methods), and to have a better alignment in the representation of `FancyTuple`.

Concerning the name `.sequence()` vs `.first_terms()` i prefer to stick to `.first_terms()` because we only got the first few terms, not the whole sequence. Perhaps `.sequence()` could be defined while interfacing `oeis` with `sloane_sequence`.



---

archive/issue_comments_106479.json:
```json
{
    "body": "Second review patch",
    "created_at": "2013-07-20T01:10:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106479",
    "user": "tmonteil"
}
```

Second review patch



---

archive/issue_comments_106480.json:
```json
{
    "body": "Attachment [trac_10358-oeis-review_2-tm.patch](tarball://root/attachments/some-uuid/ticket10358/trac_10358-oeis-review_2-tm.patch) by tmonteil created at 2013-07-20 01:12:04",
    "created_at": "2013-07-20T01:12:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106480",
    "user": "tmonteil"
}
```

Attachment [trac_10358-oeis-review_2-tm.patch](tarball://root/attachments/some-uuid/ticket10358/trac_10358-oeis-review_2-tm.patch) by tmonteil created at 2013-07-20 01:12:04



---

archive/issue_comments_106481.json:
```json
{
    "body": "Helloooooooooo Thiery !\n\nI read your code again, and made a couple of modifications. Could you please give it a look ? If you agree with them you can set this ticket to `positive_review` `:-)`\n\n* Added `__call__` to the Sphinx doc\n* Copied the doc of `__call__` to the doc of OEIS because it's currently impossible to know what `oeis()` takes as parameters (that's what you get from using fancy `__call__` instead of a normal `.find()` function...)\n* Added a section for classes and methods in the module's doc, to separate them from the module's doc in the html page\n\nNathann",
    "created_at": "2013-07-20T12:54:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106481",
    "user": "@nathanncohen"
}
```

Helloooooooooo Thiery !

I read your code again, and made a couple of modifications. Could you please give it a look ? If you agree with them you can set this ticket to `positive_review` `:-)`

* Added `__call__` to the Sphinx doc
* Copied the doc of `__call__` to the doc of OEIS because it's currently impossible to know what `oeis()` takes as parameters (that's what you get from using fancy `__call__` instead of a normal `.find()` function...)
* Added a section for classes and methods in the module's doc, to separate them from the module's doc in the html page

Nathann



---

archive/issue_comments_106482.json:
```json
{
    "body": "Attachment [trac_10358-rev.patch](tarball://root/attachments/some-uuid/ticket10358/trac_10358-rev.patch) by @nathanncohen created at 2013-07-20 12:55:12",
    "created_at": "2013-07-20T12:55:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106482",
    "user": "@nathanncohen"
}
```

Attachment [trac_10358-rev.patch](tarball://root/attachments/some-uuid/ticket10358/trac_10358-rev.patch) by @nathanncohen created at 2013-07-20 12:55:12



---

archive/issue_comments_106483.json:
```json
{
    "body": "Ping ?...",
    "created_at": "2013-10-10T12:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106483",
    "user": "@nathanncohen"
}
```

Ping ?...



---

archive/issue_comments_106484.json:
```json
{
    "body": "Hi,\n\ni built a new patch above yours. Instead of copying the doc of `__call__` to the doc of `OEIS`, i moved it to avoid code replication.\n\nAlso, the `html()` function prints things but returns nothing, so i updated the doc accordingly.\n\nI also had to update some doctests since some OEIS entries get updated upstream.\n\nI made the patch with sage 5.10, so let us see if the patchbot can apply and test them on 5.12 (i am going compile it, but it may take some time).",
    "created_at": "2013-10-14T14:50:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106484",
    "user": "tmonteil"
}
```

Hi,

i built a new patch above yours. Instead of copying the doc of `__call__` to the doc of `OEIS`, i moved it to avoid code replication.

Also, the `html()` function prints things but returns nothing, so i updated the doc accordingly.

I also had to update some doctests since some OEIS entries get updated upstream.

I made the patch with sage 5.10, so let us see if the patchbot can apply and test them on 5.12 (i am going compile it, but it may take some time).



---

archive/issue_comments_106485.json:
```json
{
    "body": "The last patch does not apply, see the patchbot report. But maybe it is not supposed to apply it on top of Nathann's patch trac_10358-rev.patch\u200b ?\n\nIf so, you must tell the patchbot (in a comment) what patches to apply.",
    "created_at": "2013-10-14T20:04:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106485",
    "user": "@fchapoton"
}
```

The last patch does not apply, see the patchbot report. But maybe it is not supposed to apply it on top of Nathann's patch trac_10358-rev.patch​ ?

If so, you must tell the patchbot (in a comment) what patches to apply.



---

archive/issue_comments_106486.json:
```json
{
    "body": "Indeed, the patch applies instead of Nathann's one, not on top of it. I specified it in the ticket description. Did i use a wrong syntax ?",
    "created_at": "2013-10-15T09:14:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106486",
    "user": "tmonteil"
}
```

Indeed, the patch applies instead of Nathann's one, not on top of it. I specified it in the ticket description. Did i use a wrong syntax ?



---

archive/issue_comments_106487.json:
```json
{
    "body": "Hello. The **patchbots** do not look at the description, but only look here (in the comments). Let me do it:\n\napply trac_10358-oeis-tm.patch\u200b trac_10358-oeis-review_1-tm.patch\u200b trac_10358-oeis-review_2-tm.patch trac_10358-oeis-review_3-nc-tm.patch\u200b \n\nI do not remember if commas are necessary. Let us see.",
    "created_at": "2013-10-15T09:58:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106487",
    "user": "@fchapoton"
}
```

Hello. The **patchbots** do not look at the description, but only look here (in the comments). Let me do it:

apply trac_10358-oeis-tm.patch​ trac_10358-oeis-review_1-tm.patch​ trac_10358-oeis-review_2-tm.patch trac_10358-oeis-review_3-nc-tm.patch​ 

I do not remember if commas are necessary. Let us see.



---

archive/issue_comments_106488.json:
```json
{
    "body": "apply trac_10358-oeis-tm.patch\u200b,trac_10358-oeis-review_1-tm.patch\u200b,trac_10358-oeis-review_2-tm.patch,trac_10358-oeis-review_3-nc-tm.patch\u200b",
    "created_at": "2013-10-15T10:00:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106488",
    "user": "@fchapoton"
}
```

apply trac_10358-oeis-tm.patch​,trac_10358-oeis-review_1-tm.patch​,trac_10358-oeis-review_2-tm.patch,trac_10358-oeis-review_3-nc-tm.patch​



---

archive/issue_comments_106489.json:
```json
{
    "body": "This does not seem to work..\n\nfor patchbot: apply trac_10358-oeis-tm.patch\u200b trac_10358-oeis-review_1-tm.patch\u200b trac_10358-oeis-review_2-tm.patch trac_10358-oeis-review_3-nc-tm.patch\u200b",
    "created_at": "2013-10-15T10:03:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106489",
    "user": "@fchapoton"
}
```

This does not seem to work..

for patchbot: apply trac_10358-oeis-tm.patch​ trac_10358-oeis-review_1-tm.patch​ trac_10358-oeis-review_2-tm.patch trac_10358-oeis-review_3-nc-tm.patch​



---

archive/issue_comments_106490.json:
```json
{
    "body": "\"identify a sequence from of its first elements.\" ? `:-)`\n\nNathann",
    "created_at": "2013-10-15T14:34:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106490",
    "user": "@nathanncohen"
}
```

"identify a sequence from of its first elements." ? `:-)`

Nathann



---

archive/issue_comments_106491.json:
```json
{
    "body": "Oh. Looks like the mistake was actually in my patch. Well, I guess you can fix it in yours as it replaces mine and set this patch to `positive_review` `:-)`\n\nNathann",
    "created_at": "2013-10-15T16:56:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106491",
    "user": "@nathanncohen"
}
```

Oh. Looks like the mistake was actually in my patch. Well, I guess you can fix it in yours as it replaces mine and set this patch to `positive_review` `:-)`

Nathann



---

archive/issue_comments_106492.json:
```json
{
    "body": "**Patchbots** are sometimes dumb. Let us try again to teach them !\n\napply trac_10358-oeis-tm.patch\u200b,trac_10358-oeis-review_1-tm.patch,trac_10358-oeis-review_2-tm.patch,trac_10358-oeis-review_3-nc-tm.patch",
    "created_at": "2013-10-15T18:07:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106492",
    "user": "@fchapoton"
}
```

**Patchbots** are sometimes dumb. Let us try again to teach them !

apply trac_10358-oeis-tm.patch​,trac_10358-oeis-review_1-tm.patch,trac_10358-oeis-review_2-tm.patch,trac_10358-oeis-review_3-nc-tm.patch



---

archive/issue_comments_106493.json:
```json
{
    "body": "Almost good ... Let me try again\n\napply trac_10358-oeis-tm.patch\u200b,trac_10358-oeis-review_1-tm.patch,trac_10358-oeis-review_2-tm.patch,trac_10358-oeis-review_3-nc-tm.patch",
    "created_at": "2013-10-15T18:13:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106493",
    "user": "@fchapoton"
}
```

Almost good ... Let me try again

apply trac_10358-oeis-tm.patch​,trac_10358-oeis-review_1-tm.patch,trac_10358-oeis-review_2-tm.patch,trac_10358-oeis-review_3-nc-tm.patch



---

archive/issue_comments_106494.json:
```json
{
    "body": "pfff.  Last try\n\napply only trac_10358-oeis-tm.patch\u200b,trac_10358-oeis-review_1-tm.patch,trac_10358-oeis-review_2-tm.patch,trac_10358-oeis-review_3-nc-tm.patch",
    "created_at": "2013-10-15T18:22:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106494",
    "user": "@fchapoton"
}
```

pfff.  Last try

apply only trac_10358-oeis-tm.patch​,trac_10358-oeis-review_1-tm.patch,trac_10358-oeis-review_2-tm.patch,trac_10358-oeis-review_3-nc-tm.patch



---

archive/issue_comments_106495.json:
```json
{
    "body": "ok, it was failing because the **patchbots** do not like invisible characters (and neither do I). This should work:\n\napply trac_10358-oeis-tm.patch trac_10358-oeis-review_1-tm.patch trac_10358-oeis-review_2-tm.patch trac_10358-oeis-review_3-nc-tm.patch",
    "created_at": "2013-10-15T18:55:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106495",
    "user": "@fchapoton"
}
```

ok, it was failing because the **patchbots** do not like invisible characters (and neither do I). This should work:

apply trac_10358-oeis-tm.patch trac_10358-oeis-review_1-tm.patch trac_10358-oeis-review_2-tm.patch trac_10358-oeis-review_3-nc-tm.patch



---

archive/issue_comments_106496.json:
```json
{
    "body": "Attachment [trac_10358-oeis-review_3-nc-tm.patch](tarball://root/attachments/some-uuid/ticket10358/trac_10358-oeis-review_3-nc-tm.patch) by tmonteil created at 2013-10-19 12:49:13\n\nTested on 5.12",
    "created_at": "2013-10-19T12:49:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106496",
    "user": "tmonteil"
}
```

Attachment [trac_10358-oeis-review_3-nc-tm.patch](tarball://root/attachments/some-uuid/ticket10358/trac_10358-oeis-review_3-nc-tm.patch) by tmonteil created at 2013-10-19 12:49:13

Tested on 5.12



---

archive/issue_comments_106497.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-10-19T12:50:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106497",
    "user": "tmonteil"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_106498.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-10-20T21:29:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106498",
    "user": "@jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_106499.json:
```json
{
    "body": "This needs to be rebased to #15245.",
    "created_at": "2013-10-20T21:29:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106499",
    "user": "@jdemeyer"
}
```

This needs to be rebased to #15245.



---

archive/issue_comments_106500.json:
```json
{
    "body": "rebased after #15245",
    "created_at": "2013-10-20T22:54:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106500",
    "user": "tmonteil"
}
```

rebased after #15245



---

archive/issue_comments_106501.json:
```json
{
    "body": "Attachment [trac_10358-oeis-tm_rebase.patch](tarball://root/attachments/some-uuid/ticket10358/trac_10358-oeis-tm_rebase.patch) by tmonteil created at 2013-10-20 23:07:34\n\nThe rebase is a shift in sage/matrix/matrix2.pyx\n\napply trac_10358-oeis-tm_rebase.patch trac_10358-oeis-review_1-tm.patch trac_10358-oeis-review_2-tm.patch trac_10358-oeis-review_3-nc-tm.patch",
    "created_at": "2013-10-20T23:07:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106501",
    "user": "tmonteil"
}
```

Attachment [trac_10358-oeis-tm_rebase.patch](tarball://root/attachments/some-uuid/ticket10358/trac_10358-oeis-tm_rebase.patch) by tmonteil created at 2013-10-20 23:07:34

The rebase is a shift in sage/matrix/matrix2.pyx

apply trac_10358-oeis-tm_rebase.patch trac_10358-oeis-review_1-tm.patch trac_10358-oeis-review_2-tm.patch trac_10358-oeis-review_3-nc-tm.patch



---

archive/issue_comments_106502.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-10-20T23:07:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106502",
    "user": "tmonteil"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_106503.json:
```json
{
    "body": "The patches apply now.",
    "created_at": "2013-10-21T11:58:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106503",
    "user": "@jdemeyer"
}
```

The patches apply now.



---

archive/issue_comments_106504.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-10-21T11:58:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106504",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_106505.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-10-31T19:15:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106505",
    "user": "@jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_106506.json:
```json
{
    "body": "Joy, joy, joy is all around us!\n\nHail to Thierry, Hail to Nathann!",
    "created_at": "2013-10-31T22:52:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106506",
    "user": "@nthiery"
}
```

Joy, joy, joy is all around us!

Hail to Thierry, Hail to Nathann!



---

archive/issue_comments_106507.json:
```json
{
    "body": "I use this closed ticket to touch the interested people. In March 2017 I got:\n\n```\n  sage: oeis([1,1,2,5,14])\n  0: A000108: Catalan numbers: C(n) = binomial(2n,n)/(n+1) = (2n)!/(n!(n+1)!). \\\nAlso called Segner numbers.\n  1: A120588: G.f. satisfies: 3*A(x) = 2 + x + A(x)^2, with a(0) = 1.\n  2: A080937: Number of Catalan paths (nonnegative, starting and ending at 0, s\\\ntep +/-1) of 2*n steps with all values <= 5.\n```\n\nand now I get with Sage 8.3:\n\n```\nsage: oeis([1,1,2,5,14])\n\n0: A000108: Catalan numbers: C(n) = binomial(2n,n)/(n+1) = (2n)!/(n!(n+1)!). Also called Segner numbers.\n1: A120588: G.f. satisfies: 3*A(x) = 2 + x + A(x)^2, with a(0) = 1.\n2: A000679: Number of groups of order 2^n.\n```\n\nI have two questions:\n\n1) why did the output change?\n\n2) why do we get only 3 answers (I checked with `len(oeis(...))` that there are only 3 answers, and it is not only 3 answers that are printed), whereas the OEIS official site gives 209 answers?",
    "created_at": "2018-09-19T14:35:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106507",
    "user": "@zimmermann6"
}
```

I use this closed ticket to touch the interested people. In March 2017 I got:

```
  sage: oeis([1,1,2,5,14])
  0: A000108: Catalan numbers: C(n) = binomial(2n,n)/(n+1) = (2n)!/(n!(n+1)!). \
Also called Segner numbers.
  1: A120588: G.f. satisfies: 3*A(x) = 2 + x + A(x)^2, with a(0) = 1.
  2: A080937: Number of Catalan paths (nonnegative, starting and ending at 0, s\
tep +/-1) of 2*n steps with all values <= 5.
```

and now I get with Sage 8.3:

```
sage: oeis([1,1,2,5,14])

0: A000108: Catalan numbers: C(n) = binomial(2n,n)/(n+1) = (2n)!/(n!(n+1)!). Also called Segner numbers.
1: A120588: G.f. satisfies: 3*A(x) = 2 + x + A(x)^2, with a(0) = 1.
2: A000679: Number of groups of order 2^n.
```

I have two questions:

1) why did the output change?

2) why do we get only 3 answers (I checked with `len(oeis(...))` that there are only 3 answers, and it is not only 3 answers that are printed), whereas the OEIS official site gives 209 answers?



---

archive/issue_comments_106508.json:
```json
{
    "body": "Replying to [comment:58 zimmerma]:\n> I use this closed ticket to touch the interested people. In March 2017 I got:\n> {{{\n>   sage: oeis([1,1,2,5,14])\n>   0: A000108: Catalan numbers: C(n) = binomial(2n,n)/(n+1) = (2n)!/(n!(n+1)!). \\\n> Also called Segner numbers.\n>   1: A120588: G.f. satisfies: 3*A(x) = 2 + x + A(x)^2, with a(0) = 1.\n>   2: A080937: Number of Catalan paths (nonnegative, starting and ending at 0, s\\\n> tep +/-1) of 2*n steps with all values <= 5.\n> }}}\n> and now I get with Sage 8.3:\n> {{{\n> sage: oeis([1,1,2,5,14])\n> \n> 0: A000108: Catalan numbers: C(n) = binomial(2n,n)/(n+1) = (2n)!/(n!(n+1)!). Also called Segner numbers.\n> 1: A120588: G.f. satisfies: 3*A(x) = 2 + x + A(x)^2, with a(0) = 1.\n> 2: A000679: Number of groups of order 2^n.\n> }}}\n> I have two questions:\n> \n> 1) why did the output change?\n\nThe `oeis` module connects to an on-line database, which is subject to changes. The output depends on the ordering provided by OEIS, which depends on various criteria (i do not know the details, but if the sequence has keywords `interesting` or `important` it will appear earlier).\n \n> 2) why do we get only 3 answers (I checked with `len(oeis(...))` that there are only 3 answers, and it is not only 3 answers that are printed), whereas the OEIS official site gives 209 answers?\n\nYou can get help about `oeis` as follows:\n\n\n```\nsage: oeis?\n```\n\n\nYou can see that there is a `max_results` option, which is set by default to 3 to avoid the outout being flooded. Maybe this could be extended to, say, 10.\n\nAlso, OEIS will only send the 100 first results even if you do:\n\n\n```\nsage: oeis([1,1,2,5,14], max_results=2000)\n```\n\n\nThis is why there is a `first_result` option, to be able to access the next ones.",
    "created_at": "2018-09-19T14:54:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106508",
    "user": "tmonteil"
}
```

Replying to [comment:58 zimmerma]:
> I use this closed ticket to touch the interested people. In March 2017 I got:
> {{{
>   sage: oeis([1,1,2,5,14])
>   0: A000108: Catalan numbers: C(n) = binomial(2n,n)/(n+1) = (2n)!/(n!(n+1)!). \
> Also called Segner numbers.
>   1: A120588: G.f. satisfies: 3*A(x) = 2 + x + A(x)^2, with a(0) = 1.
>   2: A080937: Number of Catalan paths (nonnegative, starting and ending at 0, s\
> tep +/-1) of 2*n steps with all values <= 5.
> }}}
> and now I get with Sage 8.3:
> {{{
> sage: oeis([1,1,2,5,14])
> 
> 0: A000108: Catalan numbers: C(n) = binomial(2n,n)/(n+1) = (2n)!/(n!(n+1)!). Also called Segner numbers.
> 1: A120588: G.f. satisfies: 3*A(x) = 2 + x + A(x)^2, with a(0) = 1.
> 2: A000679: Number of groups of order 2^n.
> }}}
> I have two questions:
> 
> 1) why did the output change?

The `oeis` module connects to an on-line database, which is subject to changes. The output depends on the ordering provided by OEIS, which depends on various criteria (i do not know the details, but if the sequence has keywords `interesting` or `important` it will appear earlier).
 
> 2) why do we get only 3 answers (I checked with `len(oeis(...))` that there are only 3 answers, and it is not only 3 answers that are printed), whereas the OEIS official site gives 209 answers?

You can get help about `oeis` as follows:


```
sage: oeis?
```


You can see that there is a `max_results` option, which is set by default to 3 to avoid the outout being flooded. Maybe this could be extended to, say, 10.

Also, OEIS will only send the 100 first results even if you do:


```
sage: oeis([1,1,2,5,14], max_results=2000)
```


This is why there is a `first_result` option, to be able to access the next ones.



---

archive/issue_comments_106509.json:
```json
{
    "body": "Thierry, thank you for your answer.\n\nOf course I had tried `oeis?`, and in Sage 8.3 I get:\n\n```\n   * \"max_results\" - (integer, default: 30) the maximum number of\n     results to return, they are sorted according to their relevance.\n     In any cases, the OEIS website will never provide more than 100\n     results.\n```\n\nthus the documentation seems to differ from the code. Should I open a new ticket for that?",
    "created_at": "2018-09-20T09:00:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10357",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10357#issuecomment-106509",
    "user": "@zimmermann6"
}
```

Thierry, thank you for your answer.

Of course I had tried `oeis?`, and in Sage 8.3 I get:

```
   * "max_results" - (integer, default: 30) the maximum number of
     results to return, they are sorted according to their relevance.
     In any cases, the OEIS website will never provide more than 100
     results.
```

thus the documentation seems to differ from the code. Should I open a new ticket for that?
