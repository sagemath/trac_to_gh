# Issue 19802: Subfield subcodes

archive/issues_019802.json:
```json
{
    "body": "This ticket proposes an implementation of subfield subcodes.\n\n  \n\nIssue created by migration from https://trac.sagemath.org/ticket/20039\n\n",
    "created_at": "2016-02-11T15:57:21Z",
    "labels": [
        "coding theory",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Subfield subcodes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19802",
    "user": "dlucas"
}
```
This ticket proposes an implementation of subfield subcodes.

  

Issue created by migration from https://trac.sagemath.org/ticket/20039





---

archive/issue_comments_272214.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-11T16:01:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272214",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_272215.json:
```json
{
    "body": "This is still a WIP I push here as there's some work done which might be of any interest.\n\nIn my branch, one will find:\n\n- a class dedicated to field embeddings which, considering `Fp` a finite field (`p` prime), `Fq` (`q=p^s`) and `Fq^m`, gives a representation of elements of `Fq^m` as vectors of `Fp` over a basis of `Fq`.\n\n- an implementation of subfield subcodes\n\n## Known issues\n\n- Some names are quite bad and need to be reconsidered\n- Subfield subcode's parity check matrix computation has not been thoroughly tested\n- A decoder for subfield subcodes is not yet implemented\n- Some interesting methods could be implemented (e.g. dual code of a subfield subcode)\n- `dimension_lower_bound` seems quite useless...",
    "created_at": "2016-02-11T16:07:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272215",
    "user": "dlucas"
}
```

This is still a WIP I push here as there's some work done which might be of any interest.

In my branch, one will find:

- a class dedicated to field embeddings which, considering `Fp` a finite field (`p` prime), `Fq` (`q=p^s`) and `Fq^m`, gives a representation of elements of `Fq^m` as vectors of `Fp` over a basis of `Fq`.

- an implementation of subfield subcodes

## Known issues

- Some names are quite bad and need to be reconsidered
- Subfield subcode's parity check matrix computation has not been thoroughly tested
- A decoder for subfield subcodes is not yet implemented
- Some interesting methods could be implemented (e.g. dual code of a subfield subcode)
- `dimension_lower_bound` seems quite useless...



---

archive/issue_comments_272216.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-15T10:36:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272216",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_272217.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2016-02-19T09:03:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272217",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_272218.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-02-19T09:06:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272218",
    "user": "dlucas"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_272219.json:
```json
{
    "body": "I implemented a decoder for subfield subcodes, rewrote some documentation and fixed the bugs I found.\nI decided to drop the implementation of a specific `dual_code` method as it seems to quite difficult, and thus will be done in another ticket.\nThis ticket now depends on #19653, as I need better decoders than `syndrome` and `nearest_neighbor` to perform (fast) tests over the decoder implemented here. \n\nThis is now open for review.\n\nDavid",
    "created_at": "2016-02-19T09:06:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272219",
    "user": "dlucas"
}
```

I implemented a decoder for subfield subcodes, rewrote some documentation and fixed the bugs I found.
I decided to drop the implementation of a specific `dual_code` method as it seems to quite difficult, and thus will be done in another ticket.
This ticket now depends on #19653, as I need better decoders than `syndrome` and `nearest_neighbor` to perform (fast) tests over the decoder implemented here. 

This is now open for review.

David



---

archive/issue_comments_272220.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2016-03-01T13:02:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272220",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_272221.json:
```json
{
    "body": "I made a few fixes:\n\n- `decoding_radius` now properly handles extra arguments. This is useful if the original decoder is `GRSErrorErasureDecoder`, for instance.\n- The decoder now succeeds (and returns a list) when it should with an original decoder which is a list decoder.\n\nThis is still open for review.\n\nDavid",
    "created_at": "2016-03-01T13:04:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272221",
    "user": "dlucas"
}
```

I made a few fixes:

- `decoding_radius` now properly handles extra arguments. This is useful if the original decoder is `GRSErrorErasureDecoder`, for instance.
- The decoder now succeeds (and returns a list) when it should with an original decoder which is a list decoder.

This is still open for review.

David



---

archive/issue_comments_272222.json:
```json
{
    "body": "after a very quick look I noticed that you swapped the order of parameters for `HammingCode`. This means you would need to deprecate the existing order, etc etc.\n\nAre you really willing to do so?",
    "created_at": "2016-03-23T15:12:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272222",
    "user": "@dimpase"
}
```

after a very quick look I noticed that you swapped the order of parameters for `HammingCode`. This means you would need to deprecate the existing order, etc etc.

Are you really willing to do so?



---

archive/issue_comments_272223.json:
```json
{
    "body": "Hello,\n\nI did that for consistency with the new code classes I'm designing, in which the base field of the code is the first argument.\nI'd prefer to do so, as I like when all the classes of a library have the same calling conventions (if possible, of course).\n\nAnd in that case, it was actually done in #19930... Which is now closed.\nI deprecated the old convention, of course.\n\nI hope it's not a problem...\n\nBest,\n\nDavid",
    "created_at": "2016-03-23T15:51:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272223",
    "user": "dlucas"
}
```

Hello,

I did that for consistency with the new code classes I'm designing, in which the base field of the code is the first argument.
I'd prefer to do so, as I like when all the classes of a library have the same calling conventions (if possible, of course).

And in that case, it was actually done in #19930... Which is now closed.
I deprecated the old convention, of course.

I hope it's not a problem...

Best,

David



---

archive/issue_comments_272224.json:
```json
{
    "body": "Hi David,\n\nPlease split the two items you mention into two different tickets if possible.\nThat is if you really have a nice and general class for finite fields embeddings, please give it its own ticket.\nIts use will definitely go much further than subfields codes!\nAnd hopefully I might have time to review it first.\n\nBest,\nJP",
    "created_at": "2016-03-24T14:25:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272224",
    "user": "jpflori"
}
```

Hi David,

Please split the two items you mention into two different tickets if possible.
That is if you really have a nice and general class for finite fields embeddings, please give it its own ticket.
Its use will definitely go much further than subfields codes!
And hopefully I might have time to review it first.

Best,
JP



---

archive/issue_comments_272225.json:
```json
{
    "body": "Hello,\n\nI opened a new ticket for my field embeddings class. See it in #20284.\n\nBest,\n\nDavid",
    "created_at": "2016-03-25T08:50:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272225",
    "user": "dlucas"
}
```

Hello,

I opened a new ticket for my field embeddings class. See it in #20284.

Best,

David



---

archive/issue_comments_272226.json:
```json
{
    "body": "Hi,\n\nI merged it with the latest beta, and made it work with the new `relative_finite_field_extension.py` file. I also removed some piece of code in the list decoder, which didn't return subfield codewords. Thus it remains to fix this and to do the review.\n\nStill needs review then.\n\nBest,\n\nJulien\n----\nNew commits:",
    "created_at": "2016-07-05T11:50:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272226",
    "user": "@jlavauzelle"
}
```

Hi,

I merged it with the latest beta, and made it work with the new `relative_finite_field_extension.py` file. I also removed some piece of code in the list decoder, which didn't return subfield codewords. Thus it remains to fix this and to do the review.

Still needs review then.

Best,

Julien
----
New commits:



---

archive/issue_comments_272227.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-17T13:36:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272227",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_272228.json:
```json
{
    "body": "Hi David,\n\nFirst, I merged with the latest beta.\n\nI also reviewed your code. Nice piece of code, again. A few remarks:\n- I added the classes into the catalogs.\n \n- That's a great feature that you let the user choose the field embedding. But it has consequences. Especially, if you consider two subfield subcodes `C1` and `C2` of the same code, with the same subfield but with different embeddings, then `C1 == C2` does not generally hold (they are only isomorphic). So your equality test `__eq__` should check the embedding also. See the code below:\n {{{\n q = 4 ; Q = q**3 ; k = 8\n Fq = GF(q) ; FQ = GF(Q)\n pts = FQ.list()[:Q//5]\n C = codes.GeneralizedReedSolomonCode(pts, k)\n H = Hom(Fq, FQ)\n SubC1 = codes.SubfieldSubcode(C, Fq, embedding=H[0])\n SubC2 = codes.SubfieldSubcode(C, Fq, embedding=H[1])\n for c in SubC1:\n     print c in SubC2\n }}}\n   I my commits, I proposed to check the embedding instead of the field order (well, in fact, the field will be checked via the embedding).\n\n- I made the decoder raise a `DecodingError` when trying to output a non-subfield word.\n\n- I also modified `cast_into_relative_field()` method from `relative_finite_field_embedding.py` and added an `__eq__()` method.\n\nIf you agree with my changes, put it on positive review.\n\nJulien",
    "created_at": "2016-07-17T13:37:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272228",
    "user": "@jlavauzelle"
}
```

Hi David,

First, I merged with the latest beta.

I also reviewed your code. Nice piece of code, again. A few remarks:
- I added the classes into the catalogs.
 
- That's a great feature that you let the user choose the field embedding. But it has consequences. Especially, if you consider two subfield subcodes `C1` and `C2` of the same code, with the same subfield but with different embeddings, then `C1 == C2` does not generally hold (they are only isomorphic). So your equality test `__eq__` should check the embedding also. See the code below:
 {{{
 q = 4 ; Q = q**3 ; k = 8
 Fq = GF(q) ; FQ = GF(Q)
 pts = FQ.list()[:Q//5]
 C = codes.GeneralizedReedSolomonCode(pts, k)
 H = Hom(Fq, FQ)
 SubC1 = codes.SubfieldSubcode(C, Fq, embedding=H[0])
 SubC2 = codes.SubfieldSubcode(C, Fq, embedding=H[1])
 for c in SubC1:
     print c in SubC2
 }}}
   I my commits, I proposed to check the embedding instead of the field order (well, in fact, the field will be checked via the embedding).

- I made the decoder raise a `DecodingError` when trying to output a non-subfield word.

- I also modified `cast_into_relative_field()` method from `relative_finite_field_embedding.py` and added an `__eq__()` method.

If you agree with my changes, put it on positive review.

Julien



---

archive/issue_comments_272229.json:
```json
{
    "body": "Hello,\n\nI agree with your changes, thanks for your work!\nI made a tiny tweak: since #20840, it's no longer necessary to register manually \ngeneric decoders in every single file, `AbstractLinearCode`'s constructor now does it.\nThus, I removed the lines related to registration of syndrome and nearest neighbour decoders \nin `SubfieldSubcode`'s list of known decoders.\n\nIf this is fine with you, you can set it to `positive_review`!\n\nBest,\n\nDavid\n----\nNew commits:",
    "created_at": "2016-07-18T11:09:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272229",
    "user": "dlucas"
}
```

Hello,

I agree with your changes, thanks for your work!
I made a tiny tweak: since #20840, it's no longer necessary to register manually 
generic decoders in every single file, `AbstractLinearCode`'s constructor now does it.
Thus, I removed the lines related to registration of syndrome and nearest neighbour decoders 
in `SubfieldSubcode`'s list of known decoders.

If this is fine with you, you can set it to `positive_review`!

Best,

David
----
New commits:



---

archive/issue_comments_272230.json:
```json
{
    "body": "Hi,\n\nAlright, I didn't know there was such a automatic registration. Great :)\n\nPositive review then.\n\nJulien",
    "created_at": "2016-07-18T13:21:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272230",
    "user": "@jlavauzelle"
}
```

Hi,

Alright, I didn't know there was such a automatic registration. Great :)

Positive review then.

Julien



---

archive/issue_comments_272231.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-07-18T13:21:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272231",
    "user": "@jlavauzelle"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_272232.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-07-19T23:13:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19802#issuecomment-272232",
    "user": "@vbraun"
}
```

Resolution: fixed
