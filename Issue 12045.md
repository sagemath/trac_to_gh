# Issue 12045: Finite field polynomials allow division by zero

Issue created by migration from https://trac.sagemath.org/ticket/12217

Original creator: johanbosman

Original creation time: 2011-12-21 21:08:00

Assignee: AlexGhitza

For prime finite fields, one gets a strange message:

```
sage: P.<x> = GF(5)[]
sage: x/5
Exception ZeroDivisionError: 'Inverse does not exist.' in 'sage.rings.fraction_field_FpT.normalize' ignored
1/0
```

And non-prime finite fields don't complain at all:

```
sage: P.<x> = GF(25,'a')[]
sage: x/5
x
```



---

Comment by pbruin created at 2013-11-22 01:05:57

It has gotten worse: the first example causes Sage (5.13.beta3) to crash, and when attaching GDB to do the autopsy, GDB crashes too!

The second example still behaves in the same way.


---

Comment by pbruin created at 2013-12-13 19:39:37

I fixed both bugs; a patch is coming soon.  The second one is actually a bug in the Givaro interface:

```
sage: F=GF(25,'a')
sage: type(F)
<class 'sage.rings.finite_rings.finite_field_givaro.FiniteField_givaro_with_category'>
sage: z=F(0)
sage: ~z
1
```



---

Comment by pbruin created at 2013-12-13 20:12:38

correctly handle division by zero


---

Comment by pbruin created at 2013-12-13 20:22:23

Changing status from new to needs_review.


---

Attachment


---

Comment by jdemeyer created at 2013-12-13 22:10:51

Patch seems to work as advertised.

I think you should add an error message though: I prefer

```
ZeroDivisionError: fraction field element division by zero
```

or

```
ZeroDivisionError: division by zero in finite field
```

or even

```
ZeroDivisionError: division by zero in Finite Field in a of size 5^2
```

to

```
ZeroDivisionError
```



---

Comment by jdemeyer created at 2013-12-13 22:10:51

Changing status from needs_review to needs_work.


---

Comment by pbruin created at 2013-12-13 22:56:20

Replying to [comment:9 jdemeyer]:
> I think you should add an error message
Hmm.  For the finite field inversion I really like

```
ZeroDivisionError: division by zero in Finite Field in a of size 5^2
```

so I'll add this.

As for the error message when trying to do _x_/0, what fails here is strictly speaking not a division inside the fraction field, but trying to construct a fraction (from two elements of the polynomial ring) whose denominator is 0.  This is basically an implementation detail, though.

In any case, the existing "fraction field element division by zero" sounds awkward to me.  At the moment I'm undecided between three possibilities:

```
ZeroDivisionError: fraction has denominator 0
ZeroDivisionError: division by zero in Univariate Polynomial Ring over Finite Field in a of size 5^2
ZeroDivisionError: division by zero in Fraction Field of Univariate Polynomial Ring over Finite Field in a of size 5^2
```



---

Comment by pbruin created at 2013-12-13 23:26:43

Something else that bothers me is the implementation of `PolynomialElement.__div__()`.  When computing `x/y`, it first tries to coerce `y` to the base ring and multiply the polynomial `x` by `~y`.  This can fail either because the coercion fails or because `y = 0`.  In both cases, the computation is retried, but this is useless if `y = 0`; after all, we will certainly get a `ZeroDivisionError` again.  New patch now testing.


---

Comment by pbruin created at 2013-12-14 00:08:31

correctly handle division by zero, now with better error messages


---

Attachment

For division by 0 in the polynomial ring, I decided for 'fraction has denominator 0', but because of a different change in `polynomial_element.pyx` (see comment:11), you will only see this message when trying to construct fraction field elements by coercing a pair of elements of the polynomial ring into the fraction field; see the new doctest in `fraction_field_FpT.pyx`.


---

Comment by pbruin created at 2013-12-14 00:13:40

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2013-12-14 13:20:12

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2013-12-18 15:03:13

Resolution: fixed
