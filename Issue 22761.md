# Issue 22761: Unable to parse hypergeometric result from mathematica_free

archive/issues_022761.json:
```json
{
    "body": "CC:  rws kcrisman\n\nKeywords: integrate, hypergeometric\n\n\n```\nsage: integrate(e^(-x^2)*log(x), x, algorithm='mathematica_free')\nTraceback (most recent call last):\n...\nValueError: Unable to parse: -(x*HypergeometricPFQ[{1/2,1/2},{3/2,3/2},-x^2])+(Sqrt[Pi]*Erf[x]*Log[x])/2\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/22998\n\n",
    "created_at": "2017-05-14T09:59:48Z",
    "labels": [
        "calculus",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Unable to parse hypergeometric result from mathematica_free",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22761",
    "user": "mforets"
}
```
CC:  rws kcrisman

Keywords: integrate, hypergeometric


```
sage: integrate(e^(-x^2)*log(x), x, algorithm='mathematica_free')
Traceback (most recent call last):
...
ValueError: Unable to parse: -(x*HypergeometricPFQ[{1/2,1/2},{3/2,3/2},-x^2])+(Sqrt[Pi]*Erf[x]*Log[x])/2
```


Issue created by migration from https://trac.sagemath.org/ticket/22998





---

archive/issue_comments_318012.json:
```json
{
    "body": "the result i was expecting is the sage object:\n \n\n```\nresult = -(x*hypergeometric((1/2,1/2),(3/2,3/2),-x^2))+(sqrt(pi)*erf(x)*log(x))/2\n```\n\n\n\nmaybe one can substitute the line in `mma_free_integrator`:\n\n\n```\nans = SR(mexpr.lower().replace('[', '(').replace(']', ')'))\n```\n\n\nwith the some of the code at the mathematica interface in `_sage_` ?\n\n(we don't need Mathematica to be installed!)\n\nas you can see, there are two issues with the line above in this example. it transforms: \n\n\n```\n-(x*HypergeometricPFQ[{1/2,1/2},{3/2,3/2},-x^2])+(Sqrt[Pi]*Erf[x]*Log[x])/2\n```\n\n\ninto \n\n\n```\n'-(x*hypergeometricpfq({1/2,1/2},{3/2,3/2},-x^2))+(sqrt(pi)*erf(x)*log(x))/2'\n```\n\n\nthese are (i) curly braces, (ii) the special function is not transformed properly (no use of the conversions dictionary)",
    "created_at": "2017-05-14T10:41:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22761#issuecomment-318012",
    "user": "mforets"
}
```

the result i was expecting is the sage object:
 

```
result = -(x*hypergeometric((1/2,1/2),(3/2,3/2),-x^2))+(sqrt(pi)*erf(x)*log(x))/2
```



maybe one can substitute the line in `mma_free_integrator`:


```
ans = SR(mexpr.lower().replace('[', '(').replace(']', ')'))
```


with the some of the code at the mathematica interface in `_sage_` ?

(we don't need Mathematica to be installed!)

as you can see, there are two issues with the line above in this example. it transforms: 


```
-(x*HypergeometricPFQ[{1/2,1/2},{3/2,3/2},-x^2])+(Sqrt[Pi]*Erf[x]*Log[x])/2
```


into 


```
'-(x*hypergeometricpfq({1/2,1/2},{3/2,3/2},-x^2))+(sqrt(pi)*erf(x)*log(x))/2'
```


these are (i) curly braces, (ii) the special function is not transformed properly (no use of the conversions dictionary)



---

archive/issue_comments_318013.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-05-14T15:10:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22761#issuecomment-318013",
    "user": "mforets"
}
```

New commits:



---

archive/issue_comments_318014.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-05-14T15:10:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22761#issuecomment-318014",
    "user": "mforets"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_318015.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-14T19:14:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22761#issuecomment-318015",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318016.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-14T19:21:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22761#issuecomment-318016",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318017.json:
```json
{
    "body": "notice that this change has an (arguably) adverse effect in test at lines 492-495 of `symbolic/integration/integral.py`. \n\nindeed, instead of \n\n\n```\nsage: _ = var('x, y, z')\nsage: f = sin(x^2) + y^z\nsage: f.integrate(x, algorithm=\"mathematica_free\")   # optional - internet\nx*y^z + sqrt(1/2)*sqrt(pi)*fresnels(sqrt(2)*x/sqrt(pi))\n```\n\n\none has:\n\n\n```\nsage: _ = var('x, y, z')\nsage: f = sin(x^2) + y^z\nsage: f.integrate(x, algorithm=\"mathematica_free\")   # optional - internet\nTraceback (most recent call last):\nNotImplementedError: Don't know a Sage equivalent for Mathematica function 'FresnelS'.\n```\n\n\nthe new issue is because Fresnel integrals are not implemented in Sage (right?) -- in other words, one cannot do much with the former result. \n\nThat said, Sage could return a more verbose message like:\n\n\n```\n\"Don't know a Sage equivalent for Mathematica function '%s'.\n\nUnable to parse: %s\" % m.group() % mexpr\n```\n",
    "created_at": "2017-05-14T19:30:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22761#issuecomment-318017",
    "user": "mforets"
}
```

notice that this change has an (arguably) adverse effect in test at lines 492-495 of `symbolic/integration/integral.py`. 

indeed, instead of 


```
sage: _ = var('x, y, z')
sage: f = sin(x^2) + y^z
sage: f.integrate(x, algorithm="mathematica_free")   # optional - internet
x*y^z + sqrt(1/2)*sqrt(pi)*fresnels(sqrt(2)*x/sqrt(pi))
```


one has:


```
sage: _ = var('x, y, z')
sage: f = sin(x^2) + y^z
sage: f.integrate(x, algorithm="mathematica_free")   # optional - internet
Traceback (most recent call last):
NotImplementedError: Don't know a Sage equivalent for Mathematica function 'FresnelS'.
```


the new issue is because Fresnel integrals are not implemented in Sage (right?) -- in other words, one cannot do much with the former result. 

That said, Sage could return a more verbose message like:


```
"Don't know a Sage equivalent for Mathematica function '%s'.

Unable to parse: %s" % m.group() % mexpr
```




---

archive/issue_comments_318018.json:
```json
{
    "body": "Replying to [comment:5 mforets]:\n> the new issue is because Fresnel integrals are not implemented in Sage (right?)\n\nRight. You can see all symbolic function tickets at https://trac.sagemath.org/wiki/symbolics/functions",
    "created_at": "2017-05-15T08:25:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22761#issuecomment-318018",
    "user": "rws"
}
```

Replying to [comment:5 mforets]:
> the new issue is because Fresnel integrals are not implemented in Sage (right?)

Right. You can see all symbolic function tickets at https://trac.sagemath.org/wiki/symbolics/functions



---

archive/issue_comments_318019.json:
```json
{
    "body": "thanks for pointing out that page. i've added an entry in [Tickets to make](https://trac.sagemath.org/wiki/symbolics/functions#Ticketstomake) for future reference.",
    "created_at": "2017-05-16T05:35:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22761#issuecomment-318019",
    "user": "mforets"
}
```

thanks for pointing out that page. i've added an entry in [Tickets to make](https://trac.sagemath.org/wiki/symbolics/functions#Ticketstomake) for future reference.



---

archive/issue_comments_318020.json:
```json
{
    "body": "Looks good, and tests in relevant directories pass. Please fill in the Authors field.",
    "created_at": "2017-05-16T14:46:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22761#issuecomment-318020",
    "user": "rws"
}
```

Looks good, and tests in relevant directories pass. Please fill in the Authors field.



---

archive/issue_comments_318021.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-05-16T14:46:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22761#issuecomment-318021",
    "user": "rws"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_318022.json:
```json
{
    "body": "Thanks :)",
    "created_at": "2017-05-16T14:47:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22761#issuecomment-318022",
    "user": "mforets"
}
```

Thanks :)



---

archive/issue_comments_318023.json:
```json
{
    "body": "do you want me to update (in a new ticket) the doctest from comment:5? the patchbots, do they test with `optional - internet`?",
    "created_at": "2017-05-16T16:48:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22761#issuecomment-318023",
    "user": "mforets"
}
```

do you want me to update (in a new ticket) the doctest from comment:5? the patchbots, do they test with `optional - internet`?



---

archive/issue_comments_318024.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-05-19T22:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22761#issuecomment-318024",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_318025.json:
```json
{
    "body": "merge conflict",
    "created_at": "2017-05-19T22:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22761#issuecomment-318025",
    "user": "vbraun"
}
```

merge conflict



---

archive/issue_comments_318026.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-05-20T05:13:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22761#issuecomment-318026",
    "user": "rws"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_318027.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-05-20T05:13:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22761#issuecomment-318027",
    "user": "rws"
}
```

New commits:



---

archive/issue_comments_318028.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-05-21T10:08:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22761#issuecomment-318028",
    "user": "vbraun"
}
```

Resolution: fixed
