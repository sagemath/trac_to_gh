# Issue 22598: molien series for finite matrix gap groups in char 0

Issue created by migration from https://trac.sagemath.org/ticket/22835

Original creator: bhutz

Original creation time: 2017-04-19 19:13:46

CC:  rlmiller

Compute the molien series for any finite matrix group that has a _gap_ function. This includes the computation of molien series relative to nontrivial characters


---

Comment by bhutz created at 2017-04-19 19:15:10

Changing status from new to needs_review.


---

Comment by bhutz created at 2017-04-19 19:15:10

New commits:


---

Comment by bhutz created at 2017-04-19 19:15:57

This requires #22783, which is already closed.


---

Comment by tscrim created at 2017-04-19 20:13:27

A few comments:

- Why restrict to characteristic `0`? From the Wikipedia page, it just requires the characteristic of the field not to divide the order of the group (which you need anyways).
- You should use:
  {{{
        INPUT:

        - ``xi`` -- (default: trivial character) a linear group character of this group

        - ``return_series`` -- boolean (default: ``True``) if ``True``, then returns
          the Molien series as a power series, ``False`` as a rational function

        - ``prec`` -- integer (default: 20); power series default precision

        - ``variable`` -- string (default: ``'t'``); Variable name for the Molien series
  }}}
- I would use
  {{{#!diff
-mol = 1/self.order() * mol
+mol /= self.order()
  }}}
- You have some inconsistent spacing around the operators, and there are a number of unnecessary parentheses that (IMO) makes it harder to read.


---

Comment by bhutz created at 2017-04-19 22:26:03

Changing status from needs_review to needs_work.


---

Comment by bhutz created at 2017-04-19 22:26:03

Thanks for the comments.

For the characteristic: there are a number of problems with the Molien series entry in wikipedia, one of which is the formula for char p. While there is a formula assuming non-divisibility, I think it is somewhat more complicated that than. Dekker-deJong is the reference. I was just going to leave it for the future, but I'll take another look at their paper and see how hard it would be.


---

Comment by tscrim created at 2017-04-19 22:45:02

Ah, okay. Don't worry too much if positive characteristic seems like a lot of work.


---

Comment by git created at 2017-04-20 15:45:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2017-04-20 15:47:31

It wasn't too bad to add char>0 support. I also added a substantial amount of documentation to go with as it is a non-trivial computation.


---

Comment by bhutz created at 2017-04-20 15:47:31

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2017-04-20 15:54:35

Great, thanks. Three small comments: ``N`-th root` (although this isn't such a big deal, but I think it looks a little better), typo `copmputed`, and put the reference in the master reference file (and a nitpick, missing commas after each math formula). You can set a positive review on my behalf.


---

Comment by bhutz created at 2017-04-20 15:59:25

err...where is the master reference file?


---

Comment by tscrim created at 2017-04-20 16:00:35

`src/doc/en/reference/references/index.rst`


---

Comment by bhutz created at 2017-04-20 16:04:28

ok. will do.


---

Comment by git created at 2017-04-20 22:12:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2017-04-20 22:14:22

You might want to look at it again since I forgot to add the characters for the relative series in the mod p case earlier.


---

Comment by tscrim created at 2017-04-21 03:26:32

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-04-25 17:40:05

Resolution: fixed
