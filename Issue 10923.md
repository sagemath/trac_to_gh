# Issue 10923: Implementation of the SubwordComplex as defined by Knutson and Miller

archive/issues_010923.json:
```json
{
    "body": "Assignee: tbd\n\nThis patch provides an implementation of the subword complex:\n\nFix a Coxeter system (W,S). Let Q = be a finite word in S and pi in W.\n\nThe subword complex Delta(Q,pi) is then defined to be the simplicial complex with vertices being {0,...,n-1}, (n = len(Q), one vertex for each letter in Q) and with facets given by all (indices of) subwords Q' of Q for which Q\\Q' is a reduced expression for pi.\n\n\n```\n    sage: W = CoxeterGroup(['A',2])\n    sage: w = W.from_reduced_word([1,2,1])\n    sage: C = SubwordComplex([2,1,2,1,2],w); C\n    Subword complex of type ['A', 2] for Q = [2, 1, 2, 1, 2] and pi = [1, 2, 1]\n    sage: C.facets()\n    {(1, 2), (3, 4), (0, 4), (2, 3), (0, 1)}\n```\n\n\ndepends on Ticket #8359.\n\nI will upload the patch as soon as the patch on Coxeter groups is ready.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11010\n\n",
    "created_at": "2011-03-24T14:18:31Z",
    "labels": [
        "PLEASE CHANGE",
        "major",
        "PLEASE CHANGE"
    ],
    "title": "Implementation of the SubwordComplex as defined by Knutson and Miller",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10923",
    "user": "stumpc5"
}
```
Assignee: tbd

This patch provides an implementation of the subword complex:

Fix a Coxeter system (W,S). Let Q = be a finite word in S and pi in W.

The subword complex Delta(Q,pi) is then defined to be the simplicial complex with vertices being {0,...,n-1}, (n = len(Q), one vertex for each letter in Q) and with facets given by all (indices of) subwords Q' of Q for which Q\Q' is a reduced expression for pi.


```
    sage: W = CoxeterGroup(['A',2])
    sage: w = W.from_reduced_word([1,2,1])
    sage: C = SubwordComplex([2,1,2,1,2],w); C
    Subword complex of type ['A', 2] for Q = [2, 1, 2, 1, 2] and pi = [1, 2, 1]
    sage: C.facets()
    {(1, 2), (3, 4), (0, 4), (2, 3), (0, 1)}
```


depends on Ticket #8359.

I will upload the patch as soon as the patch on Coxeter groups is ready.

Issue created by migration from https://trac.sagemath.org/ticket/11010





---

archive/issue_comments_117316.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2011-04-04T14:04:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117316",
    "user": "stumpc5"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_117317.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to combinatorics.",
    "created_at": "2011-04-04T14:04:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117317",
    "user": "stumpc5"
}
```

Changing component from PLEASE CHANGE to combinatorics.



---

archive/issue_comments_117318.json:
```json
{
    "body": "Changing status from new to needs_work.",
    "created_at": "2011-04-04T14:04:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117318",
    "user": "stumpc5"
}
```

Changing status from new to needs_work.



---

archive/issue_comments_117319.json:
```json
{
    "body": "Changing keywords from \"\" to \"subword complex, simplicial complex\".",
    "created_at": "2011-04-04T14:04:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117319",
    "user": "stumpc5"
}
```

Changing keywords from "" to "subword complex, simplicial complex".



---

archive/issue_comments_117320.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-11-20T08:37:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117320",
    "user": "chapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_117321.json:
```json
{
    "body": "Replying to [comment:6 chapoton]:\n\nOkay, I must confess that I tend to not finish implementations once the patch does what I want it to do...\n\nThe dependencies of this patch must (unfortunately) inherit as well the dependencies of #11122. This is to say that this patch actually relies on many things implemented in #11187.\n\nI would be very, very glad if anyone would finally start reviewing the universal cyclotomic field, #8327 on which #11187 depends (I would first need to rebase it, and make sure that the trac version is updated to the newest version on the combinat queue).\n\nCheers, Christian",
    "created_at": "2012-11-20T08:49:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117321",
    "user": "stumpc5"
}
```

Replying to [comment:6 chapoton]:

Okay, I must confess that I tend to not finish implementations once the patch does what I want it to do...

The dependencies of this patch must (unfortunately) inherit as well the dependencies of #11122. This is to say that this patch actually relies on many things implemented in #11187.

I would be very, very glad if anyone would finally start reviewing the universal cyclotomic field, #8327 on which #11187 depends (I would first need to rebase it, and make sure that the trac version is updated to the newest version on the combinat queue).

Cheers, Christian



---

archive/issue_comments_117322.json:
```json
{
    "body": "Attachment [trac_11010-subword_complex-cs.patch](tarball://root/attachments/some-uuid/ticket11010/trac_11010-subword_complex-cs.patch) by stumpc5 created at 2013-01-23 17:39:15",
    "created_at": "2013-01-23T17:39:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117322",
    "user": "stumpc5"
}
```

Attachment [trac_11010-subword_complex-cs.patch](tarball://root/attachments/some-uuid/ticket11010/trac_11010-subword_complex-cs.patch) by stumpc5 created at 2013-01-23 17:39:15



---

archive/issue_comments_117323.json:
```json
{
    "body": "I have made a git branch. It does not work: runs into an infinite recursion because of #15456.\n----\nNew commits:",
    "created_at": "2014-03-05T15:55:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117323",
    "user": "chapoton"
}
```

I have made a git branch. It does not work: runs into an infinite recursion because of #15456.
----
New commits:



---

archive/issue_comments_117324.json:
```json
{
    "body": "The code needs to be 100% doctested. Some empty methods should be removed.",
    "created_at": "2014-03-05T16:27:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117324",
    "user": "chapoton"
}
```

The code needs to be 100% doctested. Some empty methods should be removed.



---

archive/issue_comments_117325.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-03-05T16:27:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117325",
    "user": "chapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_117326.json:
```json
{
    "body": "Hello Christian, do you really think that this ticket depends on #11187 ?\n\nI am tempted to ressurect this one, without waiting for the famous category-and-axiom ticket.\n\nWith not so much work, I managed to get a branch with only 19 failures.",
    "created_at": "2014-03-07T20:51:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117326",
    "user": "chapoton"
}
```

Hello Christian, do you really think that this ticket depends on #11187 ?

I am tempted to ressurect this one, without waiting for the famous category-and-axiom ticket.

With not so much work, I managed to get a branch with only 19 failures.



---

archive/issue_comments_117327.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-03-14T17:04:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117327",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117328.json:
```json
{
    "body": "Here is a better branch.\n\nI am removing the dependencies to #11187, #15456 as I think they are not really needed.\n\nThere are still 16 failing doctests. Work in progress.",
    "created_at": "2014-03-14T17:10:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117328",
    "user": "chapoton"
}
```

Here is a better branch.

I am removing the dependencies to #11187, #15456 as I think they are not really needed.

There are still 16 failing doctests. Work in progress.



---

archive/issue_comments_117329.json:
```json
{
    "body": "Dear Frederic,\n\nThanks for your work on that -- I am super busy with other stuff, hopefully this will get better in about 4 weeks from now.\n\nI am not sure if I/we should keep the construction for positive genus:\n- Mathematically, this has not been considered before,\n\n- it is not quite the right generalization of subword complexes as defined by Knutson-Miller. In particular, such complexes do not need to be vertex-decomposable or shellable.\n\n- we have a proper generalization which will have similar combinatorics and will capture the needed behaviour for positive genus\n\n- our paper in which I introduce these things is still on hold and we will need at least another 3-6 months before getting this into a state to make it publicly available\n\nI should be able to quickly look at your branch during the weekend to clean things up a bit. Or do you prefer to work things out yourself?\n\nCheers, Christian",
    "created_at": "2014-03-14T17:38:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117329",
    "user": "stumpc5"
}
```

Dear Frederic,

Thanks for your work on that -- I am super busy with other stuff, hopefully this will get better in about 4 weeks from now.

I am not sure if I/we should keep the construction for positive genus:
- Mathematically, this has not been considered before,

- it is not quite the right generalization of subword complexes as defined by Knutson-Miller. In particular, such complexes do not need to be vertex-decomposable or shellable.

- we have a proper generalization which will have similar combinatorics and will capture the needed behaviour for positive genus

- our paper in which I introduce these things is still on hold and we will need at least another 3-6 months before getting this into a state to make it publicly available

I should be able to quickly look at your branch during the weekend to clean things up a bit. Or do you prefer to work things out yourself?

Cheers, Christian



---

archive/issue_comments_117330.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-03-14T20:55:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117330",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117331.json:
```json
{
    "body": "Hello Christian,\n\nI would be happy to see you come back here. The code is not very easy to understand by me alone.\n\nThe remaining issues (15 doctests) seem to be related to a strange use of roots, where Weyl group elements seem to be supposed to act on the indices of roots in the list of roots. And they do not, of course.\n\nI will not do anything more on the ticket until next week.",
    "created_at": "2014-03-14T21:00:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117331",
    "user": "chapoton"
}
```

Hello Christian,

I would be happy to see you come back here. The code is not very easy to understand by me alone.

The remaining issues (15 doctests) seem to be related to a strange use of roots, where Weyl group elements seem to be supposed to act on the indices of roots in the list of roots. And they do not, of course.

I will not do anything more on the ticket until next week.



---

archive/issue_comments_117332.json:
```json
{
    "body": "Replying to [comment:17 chapoton]:\n\nHi,\n\n> I would be happy to see you come back here. The code is not very easy to understand by me alone.\n\nI spend some time today trying to get Sage working properly again, but I failed so far. I guess I need someone helping me to work properly with git...\n\n* I upgraded Sage using http://wiki.sagemath.org/TentativeConventions#Get_the_latest_official_development_version_of_Sage, but I got an error ```error: command 'gcc' failed with exit status```, so this is my first problem\n\nI don't know how to resolve that now (and I also don't know if I tried to upgrade to the newest development version or the latest stable version).\n\n> The remaining issues (15 doctests) seem to be related to a strange use of roots, where Weyl group elements seem to be supposed to act on the indices of roots in the list of roots. And they do not, of course.\n\nI use the CHEVIE implementation of finite reflection groups which are implemented as permutation groups on indices of roots. This speed things drastically, but it is not reall mathematically clean. Moreover, I just looked at the code, and\n\n* I also pushed many non-features that are there only for my research (and for which I cannot prove what I want to prove)\n* Many features only make sense for finite Coxeter groups, so such checks are still to be implemented.",
    "created_at": "2014-03-15T18:23:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117332",
    "user": "stumpc5"
}
```

Replying to [comment:17 chapoton]:

Hi,

> I would be happy to see you come back here. The code is not very easy to understand by me alone.

I spend some time today trying to get Sage working properly again, but I failed so far. I guess I need someone helping me to work properly with git...

* I upgraded Sage using http://wiki.sagemath.org/TentativeConventions#Get_the_latest_official_development_version_of_Sage, but I got an error ```error: command 'gcc' failed with exit status```, so this is my first problem

I don't know how to resolve that now (and I also don't know if I tried to upgrade to the newest development version or the latest stable version).

> The remaining issues (15 doctests) seem to be related to a strange use of roots, where Weyl group elements seem to be supposed to act on the indices of roots in the list of roots. And they do not, of course.

I use the CHEVIE implementation of finite reflection groups which are implemented as permutation groups on indices of roots. This speed things drastically, but it is not reall mathematically clean. Moreover, I just looked at the code, and

* I also pushed many non-features that are there only for my research (and for which I cannot prove what I want to prove)
* Many features only make sense for finite Coxeter groups, so such checks are still to be implemented.



---

archive/issue_comments_117333.json:
```json
{
    "body": "Hello Frederic,\n\nI now spent some time playing with the patch.\n\nMy main concern is: I can re-implement things to work with any implementation of Coxeter groups (i.e., with the current implementations of Weyl groups and Coxeter groups). BUT: this will slow down things drastically!\n\nSo we either leave this ticket open and wait for my CHEVIE version of Coxeter groups, \n#11187 (I am not too positive that these will make it into Sage this year though), or we get rid of the speedy implementations and have a slow version to play in very low ranks that can be used soon.\n\nCheers, Christian",
    "created_at": "2014-03-17T09:12:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117333",
    "user": "stumpc5"
}
```

Hello Frederic,

I now spent some time playing with the patch.

My main concern is: I can re-implement things to work with any implementation of Coxeter groups (i.e., with the current implementations of Weyl groups and Coxeter groups). BUT: this will slow down things drastically!

So we either leave this ticket open and wait for my CHEVIE version of Coxeter groups, 
#11187 (I am not too positive that these will make it into Sage this year though), or we get rid of the speedy implementations and have a slow version to play in very low ranks that can be used soon.

Cheers, Christian



---

archive/issue_comments_117334.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2015-06-03T23:37:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117334",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_117335.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-05T23:30:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117335",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117336.json:
```json
{
    "body": "Vincent, please remove the `c` and the `html` file again from the branch since they are not supposed to be going into sage.",
    "created_at": "2015-06-06T01:20:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117336",
    "user": "stumpc5"
}
```

Vincent, please remove the `c` and the `html` file again from the branch since they are not supposed to be going into sage.



---

archive/issue_comments_117337.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-06T15:41:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117337",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117338.json:
```json
{
    "body": "does not apply, needs to be rebased",
    "created_at": "2015-06-23T07:42:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117338",
    "user": "chapoton"
}
```

does not apply, needs to be rebased



---

archive/issue_comments_117339.json:
```json
{
    "body": "I have made a new branch, by disentangling u/vpilaud/ticket/11010 from #11187 (but sadly still depending on #11187).\n\nIt seems that all my previous work on this ticket was lost. I do not appreciate.\n\n----\nNew commits:",
    "created_at": "2015-11-11T20:55:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117339",
    "user": "chapoton"
}
```

I have made a new branch, by disentangling u/vpilaud/ticket/11010 from #11187 (but sadly still depending on #11187).

It seems that all my previous work on this ticket was lost. I do not appreciate.

----
New commits:



---

archive/issue_comments_117340.json:
```json
{
    "body": "> It seems that all my previous work on this ticket was lost. I do not appreciate.\n\nI don't understand. How can work be lost on a ticket?",
    "created_at": "2015-11-11T22:17:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117340",
    "user": "stumpc5"
}
```

> It seems that all my previous work on this ticket was lost. I do not appreciate.

I don't understand. How can work be lost on a ticket?



---

archive/issue_comments_117341.json:
```json
{
    "body": "Sorry for having been a little rude. I was tired and angry yesterday evening.\n\nIt remains that I have done twice the same clean-up work. I think it was\nbecause the branch by Vincent was not based on my previous branch.\n\nI would really like if this ticket would no longer depend on #11187, which has\nno hope to enter sage as long as it depends on gap3.\n\nYou said once that it could be possible, but with a high speed penalty. Maybe this is nevertheless the way to go.",
    "created_at": "2015-11-12T08:04:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117341",
    "user": "chapoton"
}
```

Sorry for having been a little rude. I was tired and angry yesterday evening.

It remains that I have done twice the same clean-up work. I think it was
because the branch by Vincent was not based on my previous branch.

I would really like if this ticket would no longer depend on #11187, which has
no hope to enter sage as long as it depends on gap3.

You said once that it could be possible, but with a high speed penalty. Maybe this is nevertheless the way to go.



---

archive/issue_comments_117342.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-11-12T12:16:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117342",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117343.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-11-12T15:01:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117343",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117344.json:
```json
{
    "body": "As far as I can see, just one thing is needed:\n\n- `reflections()` (technically `nr_reflections()`, but we can just do `len(self.reflections())`)\n\nWe can construct this easily enough by conjugation of simple reflections:\n\n```\nsage: W = CoxeterGroup(['A',2])\nsage: S = W.simple_reflections()\nsage: I = W.index_set()\nsage: R = RecursivelyEnumeratedSet(S, lambda x: [S[i]*x*S[i] for i in I if not x.has_descent(i)], structure=\"graded\")\nsage: list(R)\n[\n[-1  1]  [ 1  0]  [ 0 -1]\n[ 0  1], [ 1 -1], [-1  0]\n]\nsage: all(x.absolute_length() for x in R)\nTrue\n```\n\n\nThe `apply_simple_reflection` is already a part of Sage for Coxeter groups.\n\nAside - This probably deserves to be in the category of finite Coxeter groups, but there is some slight conflict with this\n\n```\nsage: W = WeylGroup(['A',2], prefix='s')\nsage: W.reflections()\nFinite family {s1*s2*s1: (1, 0, -1), s1: (1, -1, 0), s2: (0, 1, -1)}\n```\n\n(Trying to do this on the Weyl group on the root system seems to run forever and `ctrl-C` out results in a nasty error message.)",
    "created_at": "2015-11-12T16:46:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117344",
    "user": "tscrim"
}
```

As far as I can see, just one thing is needed:

- `reflections()` (technically `nr_reflections()`, but we can just do `len(self.reflections())`)

We can construct this easily enough by conjugation of simple reflections:

```
sage: W = CoxeterGroup(['A',2])
sage: S = W.simple_reflections()
sage: I = W.index_set()
sage: R = RecursivelyEnumeratedSet(S, lambda x: [S[i]*x*S[i] for i in I if not x.has_descent(i)], structure="graded")
sage: list(R)
[
[-1  1]  [ 1  0]  [ 0 -1]
[ 0  1], [ 1 -1], [-1  0]
]
sage: all(x.absolute_length() for x in R)
True
```


The `apply_simple_reflection` is already a part of Sage for Coxeter groups.

Aside - This probably deserves to be in the category of finite Coxeter groups, but there is some slight conflict with this

```
sage: W = WeylGroup(['A',2], prefix='s')
sage: W.reflections()
Finite family {s1*s2*s1: (1, 0, -1), s1: (1, -1, 0), s2: (0, 1, -1)}
```

(Trying to do this on the Weyl group on the root system seems to run forever and `ctrl-C` out results in a nasty error message.)



---

archive/issue_comments_117345.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-11-12T21:39:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117345",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117346.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-12-10T20:13:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117346",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117347.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-12-11T20:35:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117347",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117348.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-12-12T21:30:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117348",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117349.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-12-12T21:35:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117349",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117350.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-12-12T21:50:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117350",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117351.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-12-13T11:54:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117351",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117352.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-12-13T21:09:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117352",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117353.json:
```json
{
    "body": "Ok, guys. We are **almost there**. Most of the things are working and hopefully not too slow. I have worked hard for two days, so please react !\n\nJust 2 small remaining problems (unless the bot reveals some others):\n\n* the \"plot\" code is broken, maybe we can remove that for the moment ? unless somebody wants to repair it ?\n* the \"root_polytope\" method is not documented, any objection to its removal ? unless you can provide a working example ?\n\ncheers,\n\nFrederic",
    "created_at": "2015-12-13T21:15:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117353",
    "user": "chapoton"
}
```

Ok, guys. We are **almost there**. Most of the things are working and hopefully not too slow. I have worked hard for two days, so please react !

Just 2 small remaining problems (unless the bot reveals some others):

* the "plot" code is broken, maybe we can remove that for the moment ? unless somebody wants to repair it ?
* the "root_polytope" method is not documented, any objection to its removal ? unless you can provide a working example ?

cheers,

Frederic



---

archive/issue_comments_117354.json:
```json
{
    "body": "Hi Frederic -- thanks a lot for all your work here! I am still too busy to contribute, but I can promise to have had a closer look by the end of the week, together with my opinion on how to proceed and a few speed tests... Cheers, Christian",
    "created_at": "2015-12-14T08:02:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117354",
    "user": "stumpc5"
}
```

Hi Frederic -- thanks a lot for all your work here! I am still too busy to contribute, but I can promise to have had a closer look by the end of the week, together with my opinion on how to proceed and a few speed tests... Cheers, Christian



---

archive/issue_comments_117355.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-12-14T18:10:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117355",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117356.json:
```json
{
    "body": "Okay, things seem to work, great!\n\n* Root polytope: all this patch was basically parked on trac for my own research. And this method is stuff for which nothing is proven so far, so it should not be part of the ticket anymore.\n\n* Plot: what do you have in mind outside of types A and B?\n\n* Here are a few timings:\n\n  This patch:\n\n```\nsage: W = WeylGroup(['A',6])\nsage: c = list(W.index_set()); Q = c + W.w0.coxeter_sorting_word(c)\nsage: %time S = SubwordComplex(Q,W.w0)\nCPU times: user 23.6 s, sys: 36 ms, total: 23.6 s\nWall time: 23.6 s\nsage: len(S)\n429\n```\n\n  The same patch based on the Coxeter group implementation:\n\n```\nsage: W = CoxeterGroup(['A',6])                                    \nsage: c = list(W.index_set()); Q = c + W.w0.coxeter_sorting_word(c)\nsage: %time S = SubwordComplex(Q,W.w0)                             \nCPU times: user 0.41 s, sys: 0.00 s, total: 0.41 s\nWall time: 0.41 s\nsage: len(S)                                                       \n429\n```\n",
    "created_at": "2015-12-19T12:05:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117356",
    "user": "stumpc5"
}
```

Okay, things seem to work, great!

* Root polytope: all this patch was basically parked on trac for my own research. And this method is stuff for which nothing is proven so far, so it should not be part of the ticket anymore.

* Plot: what do you have in mind outside of types A and B?

* Here are a few timings:

  This patch:

```
sage: W = WeylGroup(['A',6])
sage: c = list(W.index_set()); Q = c + W.w0.coxeter_sorting_word(c)
sage: %time S = SubwordComplex(Q,W.w0)
CPU times: user 23.6 s, sys: 36 ms, total: 23.6 s
Wall time: 23.6 s
sage: len(S)
429
```

  The same patch based on the Coxeter group implementation:

```
sage: W = CoxeterGroup(['A',6])                                    
sage: c = list(W.index_set()); Q = c + W.w0.coxeter_sorting_word(c)
sage: %time S = SubwordComplex(Q,W.w0)                             
CPU times: user 0.41 s, sys: 0.00 s, total: 0.41 s
Wall time: 0.41 s
sage: len(S)                                                       
429
```




---

archive/issue_comments_117357.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-12-19T12:31:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117357",
    "user": "stumpc5"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_117358.json:
```json
{
    "body": "I removed some experimental code that is not supposed to be merged (this includes the root polytope), and fixed the plot. This file's tests pass locally, so let's see what the patchbot says...\n----\nNew commits:",
    "created_at": "2015-12-19T12:31:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117358",
    "user": "stumpc5"
}
```

I removed some experimental code that is not supposed to be merged (this includes the root polytope), and fixed the plot. This file's tests pass locally, so let's see what the patchbot says...
----
New commits:



---

archive/issue_comments_117359.json:
```json
{
    "body": "I think one should put a large **Warning** about\n\n`To be used only with Coxeter groups in the implementation='reflection'`\n\nIn fact, it is not only slow but mostly broken with Weyl groups.\n\nSide remark : it seems that one cannot use the quadratic fields Q(sqrt2) for type B\nand Q(sqrt5) for type H. To be fixed in another ticket, maybe.",
    "created_at": "2015-12-20T16:31:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117359",
    "user": "chapoton"
}
```

I think one should put a large **Warning** about

`To be used only with Coxeter groups in the implementation='reflection'`

In fact, it is not only slow but mostly broken with Weyl groups.

Side remark : it seems that one cannot use the quadratic fields Q(sqrt2) for type B
and Q(sqrt5) for type H. To be fixed in another ticket, maybe.



---

archive/issue_comments_117360.json:
```json
{
    "body": "> In fact, it is not only slow but mostly broken with Weyl groups.\n\nOh yes, the doctests were written for `implementation='reflection'` so it does not show that it is broken for Weyl groups.\n\nI will have a quick look whether I can fix that!",
    "created_at": "2015-12-20T16:58:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117360",
    "user": "stumpc5"
}
```

> In fact, it is not only slow but mostly broken with Weyl groups.

Oh yes, the doctests were written for `implementation='reflection'` so it does not show that it is broken for Weyl groups.

I will have a quick look whether I can fix that!



---

archive/issue_comments_117361.json:
```json
{
    "body": "I'm not too surprised `WeylGroup` is slower; it goes through the GAP interface (in particular, for multiplication) whereas the reflection implementation (of Coxeter groups) does not. However because of this, it can't get things like conjugacy classes. There is probably quite a bit we can improve with (GAP) matrix groups, but that is an issue for another ticket.\n\nHowever, it surprises me a little bit that it is broken for Weyl groups because the reflection implementation was fairly minimal (up to what comes from the category).",
    "created_at": "2015-12-20T17:38:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117361",
    "user": "tscrim"
}
```

I'm not too surprised `WeylGroup` is slower; it goes through the GAP interface (in particular, for multiplication) whereas the reflection implementation (of Coxeter groups) does not. However because of this, it can't get things like conjugacy classes. There is probably quite a bit we can improve with (GAP) matrix groups, but that is an issue for another ticket.

However, it surprises me a little bit that it is broken for Weyl groups because the reflection implementation was fairly minimal (up to what comes from the category).



---

archive/issue_comments_117362.json:
```json
{
    "body": "First, the definition of subword complexes is for Coxeter groups (finite or infinite), but many of its properties (see my paper with Vincent referenced in the header) come from understanding roots and weights. (This means that the construction works, but many methods don't.)\n\nSecond, I think the current failure is only because the method `WeylGroup.roots` is missing, as is the method `WeylGroupElement.action_on_root_indices`.\n* Do you know how I can get the list of (simple, positive, almost positive, all) roots of a root system when I only have the Weyl group `W` at hand? It seems that I have to build a root system from the Cartan type, though it seems more natural to have a method `WeylGroup.root_system` or at least `WeylGroup.cartan_matrix`, wouldn't it?",
    "created_at": "2015-12-20T18:06:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117362",
    "user": "stumpc5"
}
```

First, the definition of subword complexes is for Coxeter groups (finite or infinite), but many of its properties (see my paper with Vincent referenced in the header) come from understanding roots and weights. (This means that the construction works, but many methods don't.)

Second, I think the current failure is only because the method `WeylGroup.roots` is missing, as is the method `WeylGroupElement.action_on_root_indices`.
* Do you know how I can get the list of (simple, positive, almost positive, all) roots of a root system when I only have the Weyl group `W` at hand? It seems that I have to build a root system from the Cartan type, though it seems more natural to have a method `WeylGroup.root_system` or at least `WeylGroup.cartan_matrix`, wouldn't it?



---

archive/issue_comments_117363.json:
```json
{
    "body": "New branch, where I have added a warning.\n\nDo you really want this to work for Weyl groups ?\n\nYou can build roots for Weyl groups just as I did for the Coxeter groups, using a reduced word for w0. But it will not be enough..\n----\nNew commits:",
    "created_at": "2015-12-20T18:10:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117363",
    "user": "chapoton"
}
```

New branch, where I have added a warning.

Do you really want this to work for Weyl groups ?

You can build roots for Weyl groups just as I did for the Coxeter groups, using a reduced word for w0. But it will not be enough..
----
New commits:



---

archive/issue_comments_117364.json:
```json
{
    "body": "Replying to [comment:57 chapoton]:\n> Do you really want this to work for Weyl groups ?\n\nI just want to quickly see if I can get the method `root_configuration` working since many others only depend on this one. And many people do use Weyl groups...",
    "created_at": "2015-12-20T18:13:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117364",
    "user": "stumpc5"
}
```

Replying to [comment:57 chapoton]:
> Do you really want this to work for Weyl groups ?

I just want to quickly see if I can get the method `root_configuration` working since many others only depend on this one. And many people do use Weyl groups...



---

archive/issue_comments_117365.json:
```json
{
    "body": "Replying to [comment:56 stumpc5]:\n> * Do you know how I can get the list of (simple, positive, almost positive, all) roots of a root system when I only have the Weyl group `W` at hand? It seems that I have to build a root system from the Cartan type, though it seems more natural to have a method `WeylGroup.root_system` or at least `WeylGroup.cartan_matrix`, wouldn't it?\n\nAh, `WeylGroup.domain` does it...",
    "created_at": "2015-12-20T18:42:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117365",
    "user": "stumpc5"
}
```

Replying to [comment:56 stumpc5]:
> * Do you know how I can get the list of (simple, positive, almost positive, all) roots of a root system when I only have the Weyl group `W` at hand? It seems that I have to build a root system from the Cartan type, though it seems more natural to have a method `WeylGroup.root_system` or at least `WeylGroup.cartan_matrix`, wouldn't it?

Ah, `WeylGroup.domain` does it...



---

archive/issue_comments_117366.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-12-21T10:24:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117366",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117367.json:
```json
{
    "body": "> Do you really want this to work for Weyl groups ?\n\nOkay, I give up on this -- I tried the past hours to get it done for Weyl groups, but I basically have to fix every single method, and even have to implement my own fundamental weights in order to make this work for Weyl groups. If this is crucial at some point, we can still get back to this...",
    "created_at": "2015-12-21T10:41:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117367",
    "user": "stumpc5"
}
```

> Do you really want this to work for Weyl groups ?

Okay, I give up on this -- I tried the past hours to get it done for Weyl groups, but I basically have to fix every single method, and even have to implement my own fundamental weights in order to make this work for Weyl groups. If this is crucial at some point, we can still get back to this...



---

archive/issue_comments_117368.json:
```json
{
    "body": "The patchbot is happy, so I think this is ready to go -- or do you see any remaining problems?",
    "created_at": "2016-01-03T13:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117368",
    "user": "stumpc5"
}
```

The patchbot is happy, so I think this is ready to go -- or do you see any remaining problems?



---

archive/issue_comments_117369.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-01-03T14:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117369",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117370.json:
```json
{
    "body": "I am not quite satisfied with the custom naive type A/B recognition in the plot method. Travis, is there a better way ? or even a way to have the correct type printed in the repr ?",
    "created_at": "2016-01-03T15:00:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117370",
    "user": "chapoton"
}
```

I am not quite satisfied with the custom naive type A/B recognition in the plot method. Travis, is there a better way ? or even a way to have the correct type printed in the repr ?



---

archive/issue_comments_117371.json:
```json
{
    "body": "Replying to [comment:64 chapoton]:\n> I am not quite satisfied with the custom naive type A/B recognition in the plot method. Travis, is there a better way ? or even a way to have the correct type printed in the repr ?\n\nYou can use the (relatively recent) Coxeter matrices and types:\n\n```\nsage: W = CoxeterGroup(['C',4])\nsage: T = W.coxeter_matrix().coxeter_type(); T\nCoxeter type of ['C', 4]\n```\n\nThe current implementation for Coxeter types essentially wraps the Cartan types, so there is a \"different\" type for B and C. (This was done because there was a lot of information that could be pulled from the Cartan type, as there is a lot of hard-coded data, and I didn't want to have to try and decide on a naming scheme. I fully take the blame for the hacks involved.)\n\nHowever, the information you're after is inside the wrapped type:\n\n```\nsage: T.cartan_type()\n['B', 4]\nsage: T.cartan_type().type()\n'B'\nsage: T.cartan_type().rank()\n4\n```\n",
    "created_at": "2016-01-03T15:37:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117371",
    "user": "tscrim"
}
```

Replying to [comment:64 chapoton]:
> I am not quite satisfied with the custom naive type A/B recognition in the plot method. Travis, is there a better way ? or even a way to have the correct type printed in the repr ?

You can use the (relatively recent) Coxeter matrices and types:

```
sage: W = CoxeterGroup(['C',4])
sage: T = W.coxeter_matrix().coxeter_type(); T
Coxeter type of ['C', 4]
```

The current implementation for Coxeter types essentially wraps the Cartan types, so there is a "different" type for B and C. (This was done because there was a lot of information that could be pulled from the Cartan type, as there is a lot of hard-coded data, and I didn't want to have to try and decide on a naming scheme. I fully take the blame for the hacks involved.)

However, the information you're after is inside the wrapped type:

```
sage: T.cartan_type()
['B', 4]
sage: T.cartan_type().type()
'B'
sage: T.cartan_type().rank()
4
```




---

archive/issue_comments_117372.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-01-03T16:59:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117372",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117373.json:
```json
{
    "body": "ok, thanks Travis. I have done the needed changes, I think.",
    "created_at": "2016-01-03T17:00:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117373",
    "user": "chapoton"
}
```

ok, thanks Travis. I have done the needed changes, I think.



---

archive/issue_comments_117374.json:
```json
{
    "body": "ok, I think that this can go. Christian, if you agree, set to positive.",
    "created_at": "2016-01-03T20:44:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117374",
    "user": "chapoton"
}
```

ok, I think that this can go. Christian, if you agree, set to positive.



---

archive/issue_comments_117375.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-01-03T21:04:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117375",
    "user": "stumpc5"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_117376.json:
```json
{
    "body": "Does the plotting also work for type C, being that it is the dual of type B (and we are dealing with Cartan types)?",
    "created_at": "2016-01-03T23:17:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117376",
    "user": "tscrim"
}
```

Does the plotting also work for type C, being that it is the dual of type B (and we are dealing with Cartan types)?



---

archive/issue_comments_117377.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-01-04T10:08:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117377",
    "user": "stumpc5"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_117378.json:
```json
{
    "body": "I am rather confused now:\n* First Sage start\n\n```\nsage: W = CoxeterGroup(['B',4])\nsage: W.coxeter_matrix().coxeter_type()\nCoxeter type of ['B', 4]\nsage: W = CoxeterGroup(['C',4])\nsage: W.coxeter_matrix().coxeter_type()\nCoxeter type of ['B', 4]\n```\n\n* Second Sage start\n\n```\nsage: W = CoxeterGroup(['C',4])\nsage: W.coxeter_matrix().coxeter_type()\nCoxeter type of ['C', 4]\nsage: W = CoxeterGroup(['B',4])\nsage: W.coxeter_matrix().coxeter_type()\nCoxeter type of ['C', 4]\n```\n\nIn particular, the root systems `W.roots()` are not correct in the two second calls of `CoxeterGroup`.\n\nAlso, the plotting now assumes that the first index is the type B/C special one. This is, it is expected that\n\n```\nsage: s0 = W.simple_reflection(W.index-set()[0])\nsage: s1 = W.simple_reflection(W.index-set()[1])\nsage: (s0*s1).order()\n4\n```\n\nI doubt that this is correct in the current implementation of `Coxeter groups` where the last index is expected to be special. If so, I will add some magic to figure out the proper labelling...",
    "created_at": "2016-01-04T10:08:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117378",
    "user": "stumpc5"
}
```

I am rather confused now:
* First Sage start

```
sage: W = CoxeterGroup(['B',4])
sage: W.coxeter_matrix().coxeter_type()
Coxeter type of ['B', 4]
sage: W = CoxeterGroup(['C',4])
sage: W.coxeter_matrix().coxeter_type()
Coxeter type of ['B', 4]
```

* Second Sage start

```
sage: W = CoxeterGroup(['C',4])
sage: W.coxeter_matrix().coxeter_type()
Coxeter type of ['C', 4]
sage: W = CoxeterGroup(['B',4])
sage: W.coxeter_matrix().coxeter_type()
Coxeter type of ['C', 4]
```

In particular, the root systems `W.roots()` are not correct in the two second calls of `CoxeterGroup`.

Also, the plotting now assumes that the first index is the type B/C special one. This is, it is expected that

```
sage: s0 = W.simple_reflection(W.index-set()[0])
sage: s1 = W.simple_reflection(W.index-set()[1])
sage: (s0*s1).order()
4
```

I doubt that this is correct in the current implementation of `Coxeter groups` where the last index is expected to be special. If so, I will add some magic to figure out the proper labelling...



---

archive/issue_comments_117379.json:
```json
{
    "body": "The first issue is the result of my quick hacking to get something working. The Coxeter matrices are equal for the Cartan types B and C, and the Coxeter matrix is the information passed to the `UniqueRepresentation` cache. There are a number of ways to go moving forward, but I think that deserves its own separate ticket.\n\nFor the second issue, yes, you are correct. The `n-1` and `n` nodes have the order 4 relation between them, as this agrees with the corresponding B/C Cartan types (and the Coxeter matrix). You are welcome to relabel the Coxeter type, which should work, or go to the Coxeter graph and find the edge label4ed by 4 and use those nodes. Personally, I would use the latter option since it is independent of the labeling.",
    "created_at": "2016-01-04T11:16:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117379",
    "user": "tscrim"
}
```

The first issue is the result of my quick hacking to get something working. The Coxeter matrices are equal for the Cartan types B and C, and the Coxeter matrix is the information passed to the `UniqueRepresentation` cache. There are a number of ways to go moving forward, but I think that deserves its own separate ticket.

For the second issue, yes, you are correct. The `n-1` and `n` nodes have the order 4 relation between them, as this agrees with the corresponding B/C Cartan types (and the Coxeter matrix). You are welcome to relabel the Coxeter type, which should work, or go to the Coxeter graph and find the edge label4ed by 4 and use those nodes. Personally, I would use the latter option since it is independent of the labeling.



---

archive/issue_comments_117380.json:
```json
{
    "body": "I also have the problem that the plot only allows irreducible types. When playing with reducible types, I got to the types B vs. G bug in #19830...",
    "created_at": "2016-01-04T13:16:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117380",
    "user": "stumpc5"
}
```

I also have the problem that the plot only allows irreducible types. When playing with reducible types, I got to the types B vs. G bug in #19830...



---

archive/issue_comments_117381.json:
```json
{
    "body": "Is this \"needs_review\" ?\n----\nNew commits:",
    "created_at": "2016-01-04T19:32:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117381",
    "user": "chapoton"
}
```

Is this "needs_review" ?
----
New commits:



---

archive/issue_comments_117382.json:
```json
{
    "body": "> Is this \"needs_review\" ?\n\nNot quite, I wanted to add a few more doctests for the type B plotting with various indexing sets. But then saw that the indexing in `CoxeterGroup` is corrupted, see #19830. This is another issue, but I still want to add more examples/testing.",
    "created_at": "2016-01-04T19:36:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117382",
    "user": "stumpc5"
}
```

> Is this "needs_review" ?

Not quite, I wanted to add a few more doctests for the type B plotting with various indexing sets. But then saw that the indexing in `CoxeterGroup` is corrupted, see #19830. This is another issue, but I still want to add more examples/testing.



---

archive/issue_comments_117383.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-01-05T15:22:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117383",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117384.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-01-05T15:27:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117384",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_117385.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-01-05T15:28:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117385",
    "user": "stumpc5"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_117386.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-01-06T11:24:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117386",
    "user": "chapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_117387.json:
```json
{
    "body": "ok, good enough for me.\n\nI have made two minor doc changes, and now set this again to positive review.\n\nAny further changes will have to be in another ticket.\n----\nNew commits:",
    "created_at": "2016-01-06T11:24:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117387",
    "user": "chapoton"
}
```

ok, good enough for me.

I have made two minor doc changes, and now set this again to positive review.

Any further changes will have to be in another ticket.
----
New commits:



---

archive/issue_comments_117388.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-01-06T22:56:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10923#issuecomment-117388",
    "user": "vbraun"
}
```

Resolution: fixed
