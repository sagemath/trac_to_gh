# Issue 31706: Bug in PARI/GP qfminim() via fincke_pohst()

Issue created by migration from https://trac.sagemath.org/ticket/31943

Original creator: @octonion

Original creation time: 2021-06-09 16:32:40

Keywords: PARI/GP qfminim

There's a very simple bug in Sagemath's PARI/GP 2.11.4, currently fixed in PARI/GP master, such that e.g. gp('qfminim(Mat([1.]),,,2)') will error with the message

***   at top-level: qfminim(Mat([1.]),,,2)
  ***                 ^----------------------
  *** qfminim: precision too low in qfminim.

Unfortunately, the same bug is also affecting some of the number theory code I've written, as it uses the Fincke-Post algorithm via qfminim() to fetch lattice points for a grid search.

This is PARI/GP bug #2262:

https://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2262

A missing mandatory flag when calling lllfp in fincke_pohst() was
causing internal confusion (same error on qfminit(Mat(1),,,2)).


---

Comment by @octonion created at 2021-06-09 16:36:54

Minor edit.


---

Comment by @octonion created at 2021-06-09 16:37:30

Minor edit.


---

Comment by @octonion created at 2021-06-09 16:38:08

Minor edit.


---

Comment by @octonion created at 2021-06-09 16:38:53

Changing type from PLEASE CHANGE to defect.


---

Comment by chapoton created at 2021-06-09 17:00:44

duplicate, see #30801


---

Comment by chapoton created at 2021-06-09 17:00:44

Changing status from new to needs_review.


---

Comment by tscrim created at 2021-06-11 03:38:27

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2021-06-11 05:43:04

Resolution: duplicate
