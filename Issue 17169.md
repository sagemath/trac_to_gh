# Issue 17169: sage.crypto.gen_lattice: quotient parameter should accept polynomials

Issue created by migration from https://trac.sagemath.org/ticket/17406

Original creator: jdemeyer

Original creation time: 2014-11-27 10:08:11

CC:  vbraun

This works:

```
sage: var('x')
x
sage: sage.crypto.gen_lattice(type='ideal', seed=42, quotient=x^4-1)
[11  0  0  0  0  0  0  0]
[ 0 11  0  0  0  0  0  0]
[ 0  0 11  0  0  0  0  0]
[ 0  0  0 11  0  0  0  0]
[ 4 -2 -3 -3  1  0  0  0]
[-3  4 -2 -3  0  1  0  0]
[-3 -3  4 -2  0  0  1  0]
[-2 -3 -3  4  0  0  0  1]
```


But this should also work:

```
sage: R.<x> = ZZ[]
sage: sage.crypto.gen_lattice(type='ideal', seed=42, quotient=x^4-1)
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-11-387441ec01a8> in <module>()
----> 1 sage.crypto.gen_lattice(type='ideal', seed=Integer(42), quotient=x**Integer(4)-Integer(1))

/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/crypto/lattice.pyc in gen_lattice(type, n, m, q, seed, quotient, dual, ntl, lattice)
    215         if quotient is None: raise \
    216             ValueError('ideal bases require a quotient polynomial')
--> 217         x = quotient.default_variable()
    218         if n != quotient.degree(x): raise \
    219             ValueError('ideal bases require n  = quotient.degree()')

/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/structure/element.so in sage.structure.element.Element.__getattr__ (build/cythonized/sage/structure/element.c:4074)()

/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/structure/misc.so in sage.structure.misc.getattr_from_other_class (build/cythonized/sage/structure/misc.c:1631)()

AttributeError: 'sage.rings.polynomial.polynomial_integer_dense_flint.Polynomial_integer_dense_flint' object has no attribute 'default_variable'
```



---

Comment by jdemeyer created at 2014-11-27 11:31:35

New commits:


---

Comment by jdemeyer created at 2014-11-27 11:31:35

Changing status from new to needs_review.


---

Comment by chapoton created at 2015-04-17 18:12:13

correct failing doctest
----
New commits:


---

Comment by malb created at 2015-05-19 10:45:17

In the patch you add


```python
assert P.base_ring() is ZZ_q
```


I was under the impression we are encouraged to avoid `assert` unless it's really a bug in the program we are checking for.


---

Comment by jdemeyer created at 2015-05-19 12:30:53

Replying to [comment:4 malb]:
> I was under the impression we are encouraged to avoid `assert` unless it's really a bug in the program we are checking for.

Absolutely! You must only use `assert` to check for bugs, not for bad user input.


---

Comment by vdelecroix created at 2015-11-28 13:30:44

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2015-11-28 13:30:44

Does not merge on 6.10.beta6


---

Comment by git created at 2015-11-29 10:01:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2015-11-29 10:02:27

Changing status from needs_work to positive_review.


---

Comment by jdemeyer created at 2015-11-29 10:02:38

Changing status from positive_review to needs_review.


---

Comment by jdemeyer created at 2015-11-29 10:03:22

Accidentally set to "positive review", let's hope Volker didn't merge it in this 11-second window :-)


---

Comment by vdelecroix created at 2015-12-01 19:14:14

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-12-03 23:23:22

Resolution: fixed
