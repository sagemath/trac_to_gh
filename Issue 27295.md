# Issue 27295: Enumeration of Spanning trees in increasing order of weights

archive/issues_027295.json:
```json
{
    "body": "CC:  @dcoudert\n\nCurrently we have spanning_trees function to list all the spanning trees of undirected graph. But does not take the weight of edges into account. This ticket aims at implementing such algorithms to output all spanning trees of an undirected weighted graph in increasing order of weights. This can be of potential use for applications requiring additional constraints other than least weights.\n\nIssue created by migration from https://trac.sagemath.org/ticket/27532\n\n",
    "created_at": "2019-03-22T11:34:09Z",
    "labels": [
        "component: graph theory"
    ],
    "title": "Enumeration of Spanning trees in increasing order of weights",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27295",
    "user": "https://github.com/rajat1433"
}
```
CC:  @dcoudert

Currently we have spanning_trees function to list all the spanning trees of undirected graph. But does not take the weight of edges into account. This ticket aims at implementing such algorithms to output all spanning trees of an undirected weighted graph in increasing order of weights. This can be of potential use for applications requiring additional constraints other than least weights.

Issue created by migration from https://trac.sagemath.org/ticket/27532





---

archive/issue_comments_384393.json:
```json
{
    "body": "Changing keywords from \"\" to \"enumeration,spanning trees\".",
    "created_at": "2019-03-22T11:37:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27295#issuecomment-384393",
    "user": "https://github.com/rajat1433"
}
```

Changing keywords from "" to "enumeration,spanning trees".



---

archive/issue_comments_384394.json:
```json
{
    "body": "Following paper cover algorithms for enumerating the spanning trees in undirected weighted graphs.\n\nhttp://www.scielo.br/scielo.php?script=sci_arttext&pid=S0101-74382005000200004\n\nhttp://www.hariharan-ramesh.com/papers/spantree1.pdf",
    "created_at": "2019-03-22T11:37:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27295#issuecomment-384394",
    "user": "https://github.com/rajat1433"
}
```

Following paper cover algorithms for enumerating the spanning trees in undirected weighted graphs.

http://www.scielo.br/scielo.php?script=sci_arttext&pid=S0101-74382005000200004

http://www.hariharan-ramesh.com/papers/spantree1.pdf



---

archive/issue_comments_384395.json:
```json
{
    "body": "Set assignee to @rajat1433.",
    "created_at": "2019-03-22T11:37:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27295#issuecomment-384395",
    "user": "https://github.com/rajat1433"
}
```

Set assignee to @rajat1433.



---

archive/issue_comments_384396.json:
```json
{
    "body": "Good idea.",
    "created_at": "2019-03-22T15:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27295#issuecomment-384396",
    "user": "https://github.com/dcoudert"
}
```

Good idea.



---

archive/issue_comments_384397.json:
```json
{
    "body": "Remove assignee @rajat1433.",
    "created_at": "2019-04-12T04:28:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27295#issuecomment-384397",
    "user": "https://github.com/rajat1433"
}
```

Remove assignee @rajat1433.



---

archive/issue_comments_384398.json:
```json
{
    "body": "As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).",
    "created_at": "2019-06-14T14:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27295#issuecomment-384398",
    "user": "https://github.com/embray"
}
```

As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).



---

archive/issue_comments_384399.json:
```json
{
    "body": "As of now the method spanning_trees is using Read-Tarjan backtracking algorithm and returns list of spanning trees, why can't we simply apply weight function to these trees and sort the result based on the weight to solve this?",
    "created_at": "2020-03-03T02:47:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27295#issuecomment-384399",
    "user": "https://github.com/Bhatt21"
}
```

As of now the method spanning_trees is using Read-Tarjan backtracking algorithm and returns list of spanning trees, why can't we simply apply weight function to these trees and sort the result based on the weight to solve this?



---

archive/issue_comments_384400.json:
```json
{
    "body": "Replying to [comment:5 gh-Bhatt21]:\n> As of now the method spanning_trees is using Read-Tarjan backtracking algorithm and returns list of spanning trees, why can't we simply apply weight function to these trees and sort the result based on the weight to solve this?\n\n\nWe wish to get an iterator over the spanning trees in increasing order of weights. Also the multiple edges must be taken into account and their different weights. This can't be done just by sorting the results based on weight.\nI have linked some papers citing optimized algorithms to achieve the same at the beginning comment of this tkt.",
    "created_at": "2020-03-03T05:38:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27295#issuecomment-384400",
    "user": "https://github.com/rajat1433"
}
```

Replying to [comment:5 gh-Bhatt21]:
> As of now the method spanning_trees is using Read-Tarjan backtracking algorithm and returns list of spanning trees, why can't we simply apply weight function to these trees and sort the result based on the weight to solve this?


We wish to get an iterator over the spanning trees in increasing order of weights. Also the multiple edges must be taken into account and their different weights. This can't be done just by sorting the results based on weight.
I have linked some papers citing optimized algorithms to achieve the same at the beginning comment of this tkt.



---

archive/issue_comments_384401.json:
```json
{
    "body": "Thanks for the reply!but I still have doubt about this. Can u give some trivial example where sorting the total weight of a spanning tree would give wrong result? with multiple edges",
    "created_at": "2020-03-03T17:02:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27295#issuecomment-384401",
    "user": "https://github.com/Bhatt21"
}
```

Thanks for the reply!but I still have doubt about this. Can u give some trivial example where sorting the total weight of a spanning tree would give wrong result? with multiple edges



---

archive/issue_comments_384402.json:
```json
{
    "body": "Sorting spanning trees by weight will not give wrong results. The problem is that the number of spanning trees can be too huge to be stored. See https://en.wikipedia.org/wiki/Spanning_tree. So an iterator is much better.",
    "created_at": "2020-03-03T17:46:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27295#issuecomment-384402",
    "user": "https://github.com/dcoudert"
}
```

Sorting spanning trees by weight will not give wrong results. The problem is that the number of spanning trees can be too huge to be stored. See https://en.wikipedia.org/wiki/Spanning_tree. So an iterator is much better.



---

archive/issue_comments_384403.json:
```json
{
    "body": "Got the problem thanks!",
    "created_at": "2020-03-03T18:13:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27295#issuecomment-384403",
    "user": "https://github.com/Bhatt21"
}
```

Got the problem thanks!



---

archive/issue_comments_384404.json:
```json
{
    "body": "Relevant algorithms are:\n1. Sanjiv Kapoor, H. Ramesh: Algorithms for Enumerating All Spanning Trees of Undirected and Weighted Graphs. SIAM J. Comput. 24(2): 247-265 (1995) https://epubs.siam.org/doi/10.1137/S009753979225030X\n2. Sanjiv Kapoor, H. Ramesh: An Algorithm for Enumerating All Spanning Trees of a Directed Graph. Algorithmica volume 27, pages 120\u2013130 (2000) https://doi.org/10.1007/s004530010008\n\nNot sure if [2] is also for weighted graphs.",
    "created_at": "2021-10-27T14:20:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27295#issuecomment-384404",
    "user": "https://github.com/dcoudert"
}
```

Relevant algorithms are:
1. Sanjiv Kapoor, H. Ramesh: Algorithms for Enumerating All Spanning Trees of Undirected and Weighted Graphs. SIAM J. Comput. 24(2): 247-265 (1995) https://epubs.siam.org/doi/10.1137/S009753979225030X
2. Sanjiv Kapoor, H. Ramesh: An Algorithm for Enumerating All Spanning Trees of a Directed Graph. Algorithmica volume 27, pages 120–130 (2000) https://doi.org/10.1007/s004530010008

Not sure if [2] is also for weighted graphs.



---

archive/issue_comments_384405.json:
```json
{
    "body": "> 1. Sanjiv Kapoor, H. Ramesh: Algorithms for Enumerating All Spanning Trees of Undirected and Weighted Graphs. SIAM J. Comput. 24(2): 247-265 (1995) \u200bhttps://epubs.siam.org/doi/10.1137/S009753979225030X\n\n\nI just finished reading paper [1]. I'll attempt to implement the relevant algorithm (provided in Section 3)",
    "created_at": "2022-04-13T10:05:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27295#issuecomment-384405",
    "user": "https://github.com/enjeck"
}
```

> 1. Sanjiv Kapoor, H. Ramesh: Algorithms for Enumerating All Spanning Trees of Undirected and Weighted Graphs. SIAM J. Comput. 24(2): 247-265 (1995) ​https://epubs.siam.org/doi/10.1137/S009753979225030X


I just finished reading paper [1]. I'll attempt to implement the relevant algorithm (provided in Section 3)



---

archive/issue_comments_384406.json:
```json
{
    "body": "Pertaining to my last commit:\n\nI just wanted to share my progress so far. \n\nThe implementation is not right yet, and doesn't produce correct results. I think I understand how the algorithm is supposed to work, but still trying to wrap my head around how to properly implement it, especially when it comes to using data structures like circular doubly linked list and indexed priority queues. \n\n---\nNew commits:",
    "created_at": "2022-04-18T04:06:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27295#issuecomment-384406",
    "user": "https://github.com/enjeck"
}
```

Pertaining to my last commit:

I just wanted to share my progress so far. 

The implementation is not right yet, and doesn't produce correct results. I think I understand how the algorithm is supposed to work, but still trying to wrap my head around how to properly implement it, especially when it comes to using data structures like circular doubly linked list and indexed priority queues. 

---
New commits:



---

archive/issue_comments_384407.json:
```json
{
    "body": "A few quick remarks:\n- The cycle basis should be computed outside the while loop, so only once\n- To simplify your tests, it might be interesting to create the graph of each cycle of the basis. Then you can search for the graph containing a given edge `f`\n- Similarly, it might be easier to let T be a graph instead of a list of edges. The goal is first to get a valid implementation. Then you can search for a faster method",
    "created_at": "2022-04-20T15:37:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27295#issuecomment-384407",
    "user": "https://github.com/dcoudert"
}
```

A few quick remarks:
- The cycle basis should be computed outside the while loop, so only once
- To simplify your tests, it might be interesting to create the graph of each cycle of the basis. Then you can search for the graph containing a given edge `f`
- Similarly, it might be easier to let T be a graph instead of a list of edges. The goal is first to get a valid implementation. Then you can search for a faster method



---

archive/issue_comments_384408.json:
```json
{
    "body": "Gotcha, dcoudert\n\n\n> Similarly, it might be easier to let T be a graph instead of a list of edges. The goal is first to get a valid implementation. Then you can search for a faster method \n\n\n\nIf we let T be a graph, it might cause issues with the priority queue. I recall trying to do this, but with `new_graph`, and there was a comparison-related error. I guess that the current heap implementation can't compare graphs to see which is \"less than\" or \"greater than\" so as to push or pop from the heap. \n\nI'll try and see how it goes!",
    "created_at": "2022-04-20T16:36:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27295#issuecomment-384408",
    "user": "https://github.com/enjeck"
}
```

Gotcha, dcoudert


> Similarly, it might be easier to let T be a graph instead of a list of edges. The goal is first to get a valid implementation. Then you can search for a faster method 



If we let T be a graph, it might cause issues with the priority queue. I recall trying to do this, but with `new_graph`, and there was a comparison-related error. I guess that the current heap implementation can't compare graphs to see which is "less than" or "greater than" so as to push or pop from the heap. 

I'll try and see how it goes!



---

archive/issue_comments_384409.json:
```json
{
    "body": "any progress ?",
    "created_at": "2022-10-16T13:16:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27295#issuecomment-384409",
    "user": "https://github.com/dcoudert"
}
```

any progress ?



---

archive/issue_comments_384410.json:
```json
{
    "body": "No significant progress yet. I intend to start afresh, so it'll take some time before I can submit new code.",
    "created_at": "2022-10-16T13:56:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27295",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27295#issuecomment-384410",
    "user": "https://github.com/enjeck"
}
```

No significant progress yet. I intend to start afresh, so it'll take some time before I can submit new code.
