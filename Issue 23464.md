# Issue 23464: new standard package libatomic_ops

Issue created by migration from https://trac.sagemath.org/ticket/23701

Original creator: dimpase

Original creation time: 2017-08-24 14:02:37

CC:  fbissey

This is needed for the gc update on #23700, 
see [GC website](http://www.hboehm.info/gc/) for details.

The package is C headers and two small static libraries.

The tarball is here: http://www.hboehm.info/gc/gc_source/libatomic_ops-7.4.4.tar.gz


---

Comment by dimpase created at 2017-08-24 15:03:36

Changing status from new to needs_review.


---

Comment by dimpase created at 2017-08-24 15:03:36

New commits:


---

Comment by fbissey created at 2017-08-24 23:01:49

Why 7.4.4 and not 7.6.0 matching boehm-gc? Ok, that's because the download web[age doesn't point to the new github repos:
https://github.com/ivmai/libatomic_ops/releases
https://github.com/ivmai/bdwgc/releases


---

Comment by dimpase created at 2017-08-25 08:13:23

Right, so should we stick to what they tag as "Latest release", i.e. 7.4.4 for `gc` and 
7.4.6 for `libatomic_ops`?


---

Comment by fbissey created at 2017-08-25 09:02:27

I am ok with that and at least that's what I have here, so I can say personally that it has some testing on linux. 7.6.0 should at least all build otherwise I would have had complaints on gentoo's bugzilla (a guy called Jurgen Rose is building everything in ~amd64 - unstable in debian parlance - I usually know quite quickly if something breaks sage building).


---

Comment by git created at 2017-08-25 11:11:52

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2017-08-25 13:25:13

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by embray created at 2017-10-09 12:08:11

These flags

```
+CONFIGURE_FLAGS="--enable-large-config"
+if [ "$UNAME" = "CYGWIN" ]; then
+    # See https://trac.sagemath.org/ticket/22694
+    CONFIGURE_FLAGS="$CONFIGURE_FLAGS --enable-threads=posix --enable-handle-fork"
+fi
```

are for libgc and are not applicable to libatomic_ops


---

Comment by embray created at 2017-10-09 12:08:11

Changing status from needs_review to needs_work.


---

Comment by git created at 2017-10-09 14:06:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2017-10-09 14:07:12

oops, sorry, fixed now.


---

Comment by dimpase created at 2017-10-09 14:07:12

Changing status from needs_work to needs_review.


---

Comment by embray created at 2017-10-09 14:17:03


```
-CONFIGURE_FLAGS="--enable-large-config"
-if [ "$UNAME" = "CYGWIN" ]; then
-    # See https://trac.sagemath.org/ticket/22694
-    CONFIGURE_FLAGS="$CONFIGURE_FLAGS --enable-threads=posix --enable-handle-fork"
-fi
-
 ./configure --prefix="$SAGE_LOCAL" --libdir="$SAGE_LOCAL/lib" $CONFIGURE_FLAGS
```


Now `$CONFIGURE_FLAGS` is undefined and not used so you could remove that too.

Also, I have another change I need to propose but I'm still investigating a bit...


---

Comment by dimpase created at 2018-01-06 00:19:11

We should go for 7.6.2, released last month
https://github.com/ivmai/libatomic_ops/releases/tag/v7.6.2
(to match the corresponding GC release)
I will update accordingly.


---

Comment by git created at 2018-01-06 01:22:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by embray created at 2018-02-02 15:50:16

I have some slight changes to this

1) To get it compatible with #23701 on Cygwin

2) To update it to use `sage-dist-helpers` Ã  la #24025

Do you mind if I replace this with my branch?  If it works then positive review from me (with apologies for the long delay)


---

Comment by dimpase created at 2018-02-02 16:30:20

sure, please go ahead.


---

Comment by embray created at 2018-02-02 17:21:09

I guess somebody should review my changes as well.
----
New commits:


---

Comment by dimpase created at 2018-02-02 18:12:18

Could we do reviewing of this ticket and #23700 in one go, as this is the dependency of #23700 and only #23700?


---

Comment by jdemeyer created at 2018-02-03 19:57:50

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2018-02-03 19:57:50

Could you remove the `SAGE64` stuff, see #23733.


---

Comment by dimpase created at 2018-02-03 23:30:46

Changing status from needs_work to needs_review.


---

Comment by dimpase created at 2018-02-03 23:30:46

Well, eventually, yes, we will get rid of SAGE64, but #23733 isn't in great shape at the moment. Thus I set this back to needs review.


---

Comment by embray created at 2018-02-05 09:57:25

It does seem a bit orthogonal.


---

Comment by jdemeyer created at 2018-02-06 15:43:53

Instead of `CONFIGURE_FLAGS`, most packages use a variable name of the form `{PACKAGENAME}_CONFIGURE`. So I suggest to use `LIBATOMIC_OPS_CONFIGURE` for this.

And please remove the `SAGE64` stuff. That hasn't been used in years.


---

Comment by jdemeyer created at 2018-02-06 15:43:53

Changing status from needs_review to needs_work.


---

Comment by dimpase created at 2018-02-20 16:09:31

Changing status from needs_work to positive_review.


---

Comment by dimpase created at 2018-02-20 16:09:31

While SAGE64 removal waits, let us get this in.


---

Comment by vbraun created at 2018-02-21 18:55:34

Resolution: fixed
