# Issue 27996: fix doctest in gap_packages when ~/.gap is not empty

Issue created by migration from https://trac.sagemath.org/ticket/28233

Original creator: fbissey

Original creation time: 2019-07-23 02:10:36

CC:  strogdon

One of the doctest in the file `sage/tests/gap_packages.py` has a result that can depend on the content of the testing user's home directory. Namely if `~/.gap` exist and it is not empty

```
sage -t --long /usr/lib64/python2.7/site-packages/sage/tests/gap_packages.py
**********************************************************************
File "/usr/lib64/python2.7/site-packages/sage/tests/gap_packages.py", line 137, in sage.tests.gap_packages.all_installed_packages
Failed example:
    all_installed_packages() == all_installed_packages(gap=gap)
Expected:
    True
Got:
    False
```

This can be fixed by telling the test to ignore the content of `~/.gap`.



---

Comment by fbissey created at 2019-07-23 02:19:18

Changing status from new to needs_review.


---

Comment by fbissey created at 2019-07-23 02:19:18

Reminder: this happens because by default `libgap` always look at the content of `~/.gap` but the pexpect interface to `gap` doesn't. This ticket explicitly discards the content of `~/.gap` in all cases.
----
New commits:


---

Comment by strogdon created at 2019-07-23 02:54:22

Changing status from needs_review to positive_review.


---

Comment by strogdon created at 2019-07-23 02:54:22

I think given the status of `gap -r` that this is the best thing to do. It, of course, does work. Should the description doctest be relative to vanilla Sage? If so, I can change this if you do not have access to vanilla.


---

Comment by fbissey created at 2019-07-23 04:43:06

No it doesn't matter. Leave it be.


---

Comment by vbraun created at 2019-07-29 21:54:45

Resolution: fixed
