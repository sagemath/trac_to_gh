# Issue 24383: singular fails to build on SunOS

archive/issues_024383.json:
```json
{
    "body": "CC:  @dimpase\n\n\n```\nlibtool: compile:  g++ -DHAVE_CONFIG_H -I. -I.. -I.. -I.. -I/var/export/home/jeroen/sage/local/var/tmp/sage/build/singular-4.1.0p3.p1/src -I/var/export/home/jeroen/sage/local/var/tmp/sage/build/singular-4.1.0p3.p1/src/factory/include -I/var/export/home/jeroen/sage/local/var/tmp/sage/build/singular-4.1.0p3.p1/src -I/var/export/home/jeroen/sage/local/var/tmp/sage/build/singular-4.1.0p3.p1/src -I/var/export/home/jeroen/sage/local/include -I/var/export/home/jeroen/sage/local/include -O2 -g -m64 -O2 -g -D_XPG6 -pipe -fno-common -O3 -Wno-unused-function -Wno-trigraphs -Wno-unused-parameter -Wunknown-pragmas -Wno-unused-variable -fomit-frame-pointer -fwrapv -fvisibility=default -finline-functions -fno-exceptions -fno-rtti -fno-threadsafe-statics -fno-enforce-eh-specs -fconserve-space -funroll-loops -fno-delete-null-pointer-checks -MT ffields.lo -MD -MP -MF .deps/ffields.Tpo -c ffields.cc  -fPIC -DPIC -o .libs/ffields.o\nffields.cc: In function 'BOOLEAN nfCoeffIsEqual(coeffs, n_coeffType, void*)':\nffields.cc:809:40: error: call of overloaded 'pow(int&, int&)' is ambiguous\n     int c = pow (p->GFChar, p->GFDegree);\n                                        ^\nIn file included from /usr/include/math.h:17:0,\n                 from ffields.cc:21:\n/usr/include/iso/math_iso.h:199:21: note: candidate: long double std::pow(long double, int)\n  inline long double pow(long double __X, int __Y) { return\n                     ^\n/usr/include/iso/math_iso.h:197:21: note: candidate: long double std::pow(long double, long double)\n  inline long double pow(long double __X, long double __Y) { return\n                     ^\n/usr/include/iso/math_iso.h:166:15: note: candidate: float std::pow(float, int)\n  inline float pow(float __X, int __Y) { return\n               ^\n/usr/include/iso/math_iso.h:161:15: note: candidate: float std::pow(float, float)\n  inline float pow(float __X, float __Y) { return __powf(__X, __Y); }\n               ^\n/usr/include/iso/math_iso.h:141:16: note: candidate: double std::pow(double, int)\n  inline double pow(double __X, int __Y) { return\n                ^  \n/usr/include/iso/math_iso.h:64:15: note: candidate: double std::pow(double, double)\n extern double pow __P((double, double));\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/24620\n\n",
    "created_at": "2018-01-31T06:30:50Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "singular fails to build on SunOS",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24383",
    "user": "https://github.com/jdemeyer"
}
```
CC:  @dimpase


```
libtool: compile:  g++ -DHAVE_CONFIG_H -I. -I.. -I.. -I.. -I/var/export/home/jeroen/sage/local/var/tmp/sage/build/singular-4.1.0p3.p1/src -I/var/export/home/jeroen/sage/local/var/tmp/sage/build/singular-4.1.0p3.p1/src/factory/include -I/var/export/home/jeroen/sage/local/var/tmp/sage/build/singular-4.1.0p3.p1/src -I/var/export/home/jeroen/sage/local/var/tmp/sage/build/singular-4.1.0p3.p1/src -I/var/export/home/jeroen/sage/local/include -I/var/export/home/jeroen/sage/local/include -O2 -g -m64 -O2 -g -D_XPG6 -pipe -fno-common -O3 -Wno-unused-function -Wno-trigraphs -Wno-unused-parameter -Wunknown-pragmas -Wno-unused-variable -fomit-frame-pointer -fwrapv -fvisibility=default -finline-functions -fno-exceptions -fno-rtti -fno-threadsafe-statics -fno-enforce-eh-specs -fconserve-space -funroll-loops -fno-delete-null-pointer-checks -MT ffields.lo -MD -MP -MF .deps/ffields.Tpo -c ffields.cc  -fPIC -DPIC -o .libs/ffields.o
ffields.cc: In function 'BOOLEAN nfCoeffIsEqual(coeffs, n_coeffType, void*)':
ffields.cc:809:40: error: call of overloaded 'pow(int&, int&)' is ambiguous
     int c = pow (p->GFChar, p->GFDegree);
                                        ^
In file included from /usr/include/math.h:17:0,
                 from ffields.cc:21:
/usr/include/iso/math_iso.h:199:21: note: candidate: long double std::pow(long double, int)
  inline long double pow(long double __X, int __Y) { return
                     ^
/usr/include/iso/math_iso.h:197:21: note: candidate: long double std::pow(long double, long double)
  inline long double pow(long double __X, long double __Y) { return
                     ^
/usr/include/iso/math_iso.h:166:15: note: candidate: float std::pow(float, int)
  inline float pow(float __X, int __Y) { return
               ^
/usr/include/iso/math_iso.h:161:15: note: candidate: float std::pow(float, float)
  inline float pow(float __X, float __Y) { return __powf(__X, __Y); }
               ^
/usr/include/iso/math_iso.h:141:16: note: candidate: double std::pow(double, int)
  inline double pow(double __X, int __Y) { return
                ^  
/usr/include/iso/math_iso.h:64:15: note: candidate: double std::pow(double, double)
 extern double pow __P((double, double));
```


Issue created by migration from https://trac.sagemath.org/ticket/24620





---

archive/issue_comments_341176.json:
```json
{
    "body": "This is interesting; it would be good to understand why I am not seeing this `pow` errors any more...",
    "created_at": "2018-01-31T07:51:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24383",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24383#issuecomment-341176",
    "user": "https://github.com/dimpase"
}
```

This is interesting; it would be good to understand why I am not seeing this `pow` errors any more...



---

archive/issue_comments_341177.json:
```json
{
    "body": "I guess you must be using `gas`, misnamed as `as`. Make sure that the real Sun`as` is first in your path.",
    "created_at": "2018-01-31T08:09:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24383",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24383#issuecomment-341177",
    "user": "https://github.com/dimpase"
}
```

I guess you must be using `gas`, misnamed as `as`. Make sure that the real Sun`as` is first in your path.



---

archive/issue_comments_341178.json:
```json
{
    "body": "Replying to [comment:3 dimpase]:\n> I guess you must be using `gas`, misnamed as `as`. Make sure that the real Sun`as` is first in your path.\n\nWhy would the assembler interfere with the compilation of `pow()`? That makes no sense to me.",
    "created_at": "2018-01-31T09:08:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24383",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24383#issuecomment-341178",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:3 dimpase]:
> I guess you must be using `gas`, misnamed as `as`. Make sure that the real Sun`as` is first in your path.

Why would the assembler interfere with the compilation of `pow()`? That makes no sense to me.



---

archive/issue_comments_341179.json:
```json
{
    "body": "sorry, I meant `ld`...\nAnyhow, could you show what you have in $PATH, and in $LD_LIBRARY_PATH.",
    "created_at": "2018-01-31T09:10:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24383",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24383#issuecomment-341179",
    "user": "https://github.com/dimpase"
}
```

sorry, I meant `ld`...
Anyhow, could you show what you have in $PATH, and in $LD_LIBRARY_PATH.



---

archive/issue_comments_341180.json:
```json
{
    "body": "Replying to [comment:5 dimpase]:\n> sorry, I meant `ld`...\n\nSame comment... Why would the linker interfere with the compilation of `pow()`? That makes no sense to me.",
    "created_at": "2018-01-31T09:17:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24383",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24383#issuecomment-341180",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:5 dimpase]:
> sorry, I meant `ld`...

Same comment... Why would the linker interfere with the compilation of `pow()`? That makes no sense to me.



---

archive/issue_comments_341181.json:
```json
{
    "body": "There is some kind of caching involved. I just logged in, and (with Solaris `ld`, whether it's relevant or not), it worked:\n\n```\n// t.cc\n#include <cmath>\nint main()\n{\n// using namespace std;\nint i,j,k;\ni = 2;\nj = 10;\nk = pow(i,j);\nreturn k;\n}\n```\n\nand `g++ t.cc` worked.\n\nBut then\n\n```\n$ PATH=/opt/csw/gnu:$PATH ld --version\nGNU ld (GNU Binutils) 2.24\n...\n$ PATH=/opt/csw/gnu:$PATH g++ t.cc\nt.cc: In function \u2018int main()\u2019:\nt.cc:8:12: error: call of overloaded \u2018pow(int&, int&)\u2019 is ambiguous\n...\n```\n\n\nAnd now going back to the correct linker does not help either.\n\nAnyhow, I have managed to build Singular without any changes to the C++ source few times in row (it needed the linking fixes, but that's another story).",
    "created_at": "2018-01-31T09:27:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24383",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24383#issuecomment-341181",
    "user": "https://github.com/dimpase"
}
```

There is some kind of caching involved. I just logged in, and (with Solaris `ld`, whether it's relevant or not), it worked:

```
// t.cc
#include <cmath>
int main()
{
// using namespace std;
int i,j,k;
i = 2;
j = 10;
k = pow(i,j);
return k;
}
```

and `g++ t.cc` worked.

But then

```
$ PATH=/opt/csw/gnu:$PATH ld --version
GNU ld (GNU Binutils) 2.24
...
$ PATH=/opt/csw/gnu:$PATH g++ t.cc
t.cc: In function ‘int main()’:
t.cc:8:12: error: call of overloaded ‘pow(int&, int&)’ is ambiguous
...
```


And now going back to the correct linker does not help either.

Anyhow, I have managed to build Singular without any changes to the C++ source few times in row (it needed the linking fixes, but that's another story).



---

archive/issue_comments_341182.json:
```json
{
    "body": "Replying to [comment:7 dimpase]:\n> There is some kind of caching involved.\n\nThat would be really surprising.\n\n> I just logged in, and (with Solaris `ld`, whether it's relevant or not), it worked:\n> {{{\n> // t.cc\n> #include <cmath>\n> int main()\n> {\n> // using namespace std;\n> int i,j,k;\n> i = 2;\n> j = 10;\n> k = pow(i,j);\n> return k;\n> }\n> }}}\n> and `g++ t.cc` worked.\n\nThis never worked for me. I get\n\n```\nt.cc: In function \u2018int main()\u2019:\nt.cc:8:12: error: call of overloaded \u2018pow(int&, int&)\u2019 is ambiguous\n k = pow(i,j);\n            ^\nIn file included from /usr/include/math.h:17:0,\n                 from /usr/gcc/5/include/c++/5.4.0/cmath:44,\n                 from t.cc:1:\n/usr/include/iso/math_iso.h:199:21: note: candidate: long double std::pow(long double, int)\n  inline long double pow(long double __X, int __Y) { return\n                     ^\n/usr/include/iso/math_iso.h:197:21: note: candidate: long double std::pow(long double, long double)\n  inline long double pow(long double __X, long double __Y) { return\n                     ^\n/usr/include/iso/math_iso.h:166:15: note: candidate: float std::pow(float, int)\n  inline float pow(float __X, int __Y) { return\n               ^\n/usr/include/iso/math_iso.h:161:15: note: candidate: float std::pow(float, float)\n  inline float pow(float __X, float __Y) { return __powf(__X, __Y); }\n               ^\n/usr/include/iso/math_iso.h:141:16: note: candidate: double std::pow(double, int)\n  inline double pow(double __X, int __Y) { return\n                ^\n/usr/include/iso/math_iso.h:64:15: note: candidate: double std::pow(double, double)\n extern double pow __P((double, double));\n```\n",
    "created_at": "2018-01-31T10:02:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24383",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24383#issuecomment-341182",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:7 dimpase]:
> There is some kind of caching involved.

That would be really surprising.

> I just logged in, and (with Solaris `ld`, whether it's relevant or not), it worked:
> {{{
> // t.cc
> #include <cmath>
> int main()
> {
> // using namespace std;
> int i,j,k;
> i = 2;
> j = 10;
> k = pow(i,j);
> return k;
> }
> }}}
> and `g++ t.cc` worked.

This never worked for me. I get

```
t.cc: In function ‘int main()’:
t.cc:8:12: error: call of overloaded ‘pow(int&, int&)’ is ambiguous
 k = pow(i,j);
            ^
In file included from /usr/include/math.h:17:0,
                 from /usr/gcc/5/include/c++/5.4.0/cmath:44,
                 from t.cc:1:
/usr/include/iso/math_iso.h:199:21: note: candidate: long double std::pow(long double, int)
  inline long double pow(long double __X, int __Y) { return
                     ^
/usr/include/iso/math_iso.h:197:21: note: candidate: long double std::pow(long double, long double)
  inline long double pow(long double __X, long double __Y) { return
                     ^
/usr/include/iso/math_iso.h:166:15: note: candidate: float std::pow(float, int)
  inline float pow(float __X, int __Y) { return
               ^
/usr/include/iso/math_iso.h:161:15: note: candidate: float std::pow(float, float)
  inline float pow(float __X, float __Y) { return __powf(__X, __Y); }
               ^
/usr/include/iso/math_iso.h:141:16: note: candidate: double std::pow(double, int)
  inline double pow(double __X, int __Y) { return
                ^
/usr/include/iso/math_iso.h:64:15: note: candidate: double std::pow(double, double)
 extern double pow __P((double, double));
```




---

archive/issue_comments_341183.json:
```json
{
    "body": "Replacing `pow` by `std::pow` does work though.",
    "created_at": "2018-01-31T10:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24383",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24383#issuecomment-341183",
    "user": "https://github.com/jdemeyer"
}
```

Replacing `pow` by `std::pow` does work though.



---

archive/issue_comments_341184.json:
```json
{
    "body": "One possible explanation is LTO optimisation, coupled (perhaps) with ccache.\nYou try to compile the example above, and you manage, say, by adding `std::` to `pow`.\nThis get stored in ccache, and used by the compiler next time to compile the code without that `std::`...",
    "created_at": "2018-01-31T10:07:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24383",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24383#issuecomment-341184",
    "user": "https://github.com/dimpase"
}
```

One possible explanation is LTO optimisation, coupled (perhaps) with ccache.
You try to compile the example above, and you manage, say, by adding `std::` to `pow`.
This get stored in ccache, and used by the compiler next time to compile the code without that `std::`...



---

archive/issue_comments_341185.json:
```json
{
    "body": "Yes, sure, it does work (or `using namespace std;` works too). The real question is whether Singular is adhering to c++11 (or so) standard, or it relies on an old behaviour of C++ which is platform-dependent.",
    "created_at": "2018-01-31T10:10:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24383",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24383#issuecomment-341185",
    "user": "https://github.com/dimpase"
}
```

Yes, sure, it does work (or `using namespace std;` works too). The real question is whether Singular is adhering to c++11 (or so) standard, or it relies on an old behaviour of C++ which is platform-dependent.



---

archive/issue_comments_341186.json:
```json
{
    "body": "Note that http://en.cppreference.com/w/cpp/numeric/math/pow specifically talks about `std::pow`. Without `std::` of `using namespace std;` all bets are off, at least it looks like this to me.",
    "created_at": "2018-01-31T10:24:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24383",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24383#issuecomment-341186",
    "user": "https://github.com/dimpase"
}
```

Note that http://en.cppreference.com/w/cpp/numeric/math/pow specifically talks about `std::pow`. Without `std::` of `using namespace std;` all bets are off, at least it looks like this to me.



---

archive/issue_comments_341187.json:
```json
{
    "body": "Replying to [comment:10 dimpase]:\n> One possible explanation is LTO optimisation\n\nThis error happens before linking. I really don't see how linking could have anything to do with it.\n\n> coupled (perhaps) with ccache.\n\nAre you explicitly using `ccache`? I don't think that it's enabled by default on that machine.\n\n> This get stored in ccache, and used by the compiler next time to compile the code without that `std::`...\n\nccache wouldn't just ignore \"`std::`\". The sources with and without `std::` are obviously different.",
    "created_at": "2018-01-31T10:32:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24383",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24383#issuecomment-341187",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:10 dimpase]:
> One possible explanation is LTO optimisation

This error happens before linking. I really don't see how linking could have anything to do with it.

> coupled (perhaps) with ccache.

Are you explicitly using `ccache`? I don't think that it's enabled by default on that machine.

> This get stored in ccache, and used by the compiler next time to compile the code without that `std::`...

ccache wouldn't just ignore "`std::`". The sources with and without `std::` are obviously different.



---

archive/issue_comments_341188.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2018-01-31T10:38:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24383",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24383#issuecomment-341188",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: duplicate



---

archive/issue_comments_341189.json:
```json
{
    "body": "I'm folding this in #24611.",
    "created_at": "2018-01-31T10:38:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24383",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24383#issuecomment-341189",
    "user": "https://github.com/jdemeyer"
}
```

I'm folding this in #24611.



---

archive/issue_events_022766.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-01-31T10:38:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24383",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24383#event-22766"
}
```



---

archive/issue_comments_341190.json:
```json
{
    "body": "I'm not using `ccache` globally, I'm using it as a Sage package. \n\nNote that the error messages  `...note: candidate: long double std::pow(...)`, so perhaps it'd willing to consider `int std::pow(...)` if it was in `ccache`.\nAnd it could be that some tests I did where at Sage prompt, thus using `ccache`. (This is just a conjecture of course).",
    "created_at": "2018-01-31T10:44:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24383",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24383#issuecomment-341190",
    "user": "https://github.com/dimpase"
}
```

I'm not using `ccache` globally, I'm using it as a Sage package. 

Note that the error messages  `...note: candidate: long double std::pow(...)`, so perhaps it'd willing to consider `int std::pow(...)` if it was in `ccache`.
And it could be that some tests I did where at Sage prompt, thus using `ccache`. (This is just a conjecture of course).
