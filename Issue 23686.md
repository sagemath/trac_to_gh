# Issue 23686: Interface cases function with SymPy's piecewise

Issue created by migration from Trac.

Original creator: rws

Original creation time: 2017-09-23 06:17:24

CC:  mforets charpent

In #20191 the `cases` function is introduced. This ticket should interface it with SymPy's piecewise (both directions) and test with:

```
        sage: _ = var('y, z')
        sage: (x^y - z).integrate(y)
        -y*z + x^y/log(x)
        sage: (x^y - z).integrate(y, algorithm="sympy")  # see Trac #14694
        -y*z + cases(((log(x) == 0, y), (1, x^y/log(x))))
```




---

Comment by charpent created at 2017-10-09 20:36:32

New commits:


---

Comment by git created at 2017-10-17 06:05:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2017-10-17 06:07:10

Changing status from new to needs_review.


---

Comment by charpent created at 2017-10-17 15:34:03

Changing status from needs_review to needs_work.


---

Comment by charpent created at 2017-10-17 15:34:03

On top of 8.1beta7+#24026 + #24006(dependency) + #23990(dependency) + #23923(present patch), one permanent failure :


```
sage -t --long src/sage/symbolic/integration/integral.py
**********************************************************************
File "src/sage/symbolic/integration/integral.py", line 508, in sage.symbolic.int
egration.integral.integrate
Failed example:
    (x^y - z).integrate(y, algorithm="sympy")  # see Trac #14694
Expected:
    Traceback (most recent call last):
    ...
    AttributeError: 'ExprCondPair' object has no attribute '_sage_'
Got:
    -y*z + cases(((log(x) == 0, y), (1, x^y/log(x))))
**********************************************************************
1 item had failures:
   1 of 126 in sage.symbolic.integration.integral.integrate
    [169 tests, 1 failure, 53.41 s]
```

==>`needs_work`. Probably a booboo, though...


---

Comment by git created at 2017-10-17 16:09:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2017-10-17 16:09:48

Changing status from needs_work to needs_review.


---

Comment by charpent created at 2017-10-17 21:16:42

Changing status from needs_review to positive_review.


---

Comment by charpent created at 2017-10-17 21:16:42

On top of 8.1beta8+#24026 + #24006(dependency) + #23990(dependency) + #23923(present patch), passes ptestlong with no error whatsoever.

==>`positive_review`

Notes : 
* I rebased the test on the hust-issued 8.1.beta8
* I have kept #24026 (which `needs_review`, BTW...) because removing it entails recompiling R (which is slow) and reinstall 442 R packages, (which is slower...).


---

Comment by rws created at 2017-10-18 06:08:01

Thanks. I've added your name, hope it's not impolite.


---

Comment by vbraun created at 2017-10-30 07:41:21

Resolution: fixed
