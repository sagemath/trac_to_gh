# Issue 10144: the charpoly method in matrix_integer_dense.pyx contains a note about it being disabled on 64-bit computers, which is just not true

Issue created by migration from Trac.

Original creator: was

Original creation time: 2010-10-20 01:52:13

Assignee: jason, was

CC:  mderickx vdelecroix

This old note is in the charpoly docstring in matrix_integer_dense.pyx:

```

        .. note::

           Linbox charpoly disabled on 64-bit machines, since it hangs
           in many cases.
```

But, if you look at the code, there is nothing to disable charpoly on 64-bit machines.   I think I wrote that note, and at one point, yes, it was disabled.  But the issue got fixed.  Unfortunately, the note wasn't removed. 


---

Attachment

ARGH.  I just had the misfortune of actually *trying* to use Sage to compute a bunch of charpolys on a 64-bit machine.  Indeed, the comment that the charpoly is disabled is wrong -- it's enabled.  Unfortunately, it *does* hang in many cases.  More precisely, ever few hundred or so charpoly's I tried to compute hung up completely (they should take seconds and after 8 hours hadn't returned).  Trying the same charpoly again did work.  This sucks. 

What also sucks is that the Sage native charpoly is massively slower than the linbox one (totally different algorithms):

```
sage: a = random_matrix(ZZ,100)
sage: time f = a.charpoly(algorithm='generic')
CPU times: user 6.49 s, sys: 0.01 s, total: 6.50 s
Wall time: 6.51 s
sage: a = random_matrix(ZZ,100)
sage: time f = a.charpoly(algorithm='linbox')
verbose 1 (<module>) computing charpoly of 100 x 100 matrix using linbox
verbose 1 (<module>) using linbox poly comp
verbose 1 (<module>) computed poly -- now converting back to Sage
verbose 1 (<module>) finished computing charpoly (time = 0.136902)
CPU times: user 0.14 s, sys: 0.00 s, total: 0.14 s
Wall time: 0.14 s
```


I'm really not sure what to do beside complain to Clement or rewrite charpoly to maybe run two threads at once (?), or timeout and try again after a certain amount of time (depending on the size of the input???).


---

Comment by was created at 2010-11-10 17:10:53

By the way, the input matrices I've been using are Hecke operators on spaces of Hilbert modular forms over Q(sqrt(5)).  They are very sparse.


---

Comment by was created at 2010-11-10 17:17:02

I think the right way to close *this* ticket for now (which is a documentation error), is to change the message from

```

        .. note::

           Linbox charpoly disabled on 64-bit machines, since it hangs
           in many cases.
```


to


```
{{{

        .. note::

           The the Linbox charpoly implementation is used by default, watch out since it is unfortunately known to completely hang in some cases.   See trac #10145.

}}}


---

Comment by mderickx created at 2011-01-09 12:35:41

I also ran into this documentation inconsistency. I agree the documentation should be fixed for now. And make the hanging another bug. 
Do you have any reasonably sized/fast to compute matrices at hand which fail. The reason I ran into this was cause of a matrix which took about 3 hours to compute. I'd like to report it upstream.


---

Comment by chapoton created at 2020-06-20 20:07:13

Changing status from new to needs_review.


---

Comment by chapoton created at 2020-06-20 20:07:13

This seems to be obsolete. Maybe we can close as invalid ?


---

Comment by mkoeppe created at 2020-06-20 23:42:48

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2020-06-21 06:02:04

Resolution: invalid
