# Issue 13340: Omit .DS_Store when building 'all' documentation

archive/issues_013340.json:
```json
{
    "body": "Assignee: mvngu\n\nCC:  yomcat\n\nIn OS X, viewing a directory like devel/sage/doc/en/ in the Finder can create a file `.DS_Store`, and then the docbuilder thinks that it is a piece of documentation to be built. We should ignore it.\n\nThe attached patch adds \".DS_Store\" to the list of documents to ignore. We could instead (or in addition) only add documents if they are directories.\n\nIssue created by migration from https://trac.sagemath.org/ticket/13544\n\n",
    "created_at": "2012-09-28T03:07:49Z",
    "labels": [
        "documentation",
        "minor",
        "bug"
    ],
    "title": "Omit .DS_Store when building 'all' documentation",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13340",
    "user": "jhpalmieri"
}
```
Assignee: mvngu

CC:  yomcat

In OS X, viewing a directory like devel/sage/doc/en/ in the Finder can create a file `.DS_Store`, and then the docbuilder thinks that it is a piece of documentation to be built. We should ignore it.

The attached patch adds ".DS_Store" to the list of documents to ignore. We could instead (or in addition) only add documents if they are directories.

Issue created by migration from https://trac.sagemath.org/ticket/13544





---

archive/issue_comments_163905.json:
```json
{
    "body": "Attachment [trac_13544_ds_store.patch](tarball://root/attachments/some-uuid/ticket13544/trac_13544_ds_store.patch) by jhpalmieri created at 2012-09-28 03:08:17",
    "created_at": "2012-09-28T03:08:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13340#issuecomment-163905",
    "user": "jhpalmieri"
}
```

Attachment [trac_13544_ds_store.patch](tarball://root/attachments/some-uuid/ticket13544/trac_13544_ds_store.patch) by jhpalmieri created at 2012-09-28 03:08:17



---

archive/issue_comments_163906.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-09-28T03:08:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13340#issuecomment-163906",
    "user": "jhpalmieri"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_163907.json:
```json
{
    "body": "Another option would be the following; this could be used in addition to the patch here, or independently of it. Both should fix the problem.\n\n```diff\ndiff --git a/doc/common/builder.py b/doc/common/builder.py\n--- a/doc/common/builder.py\n+++ b/doc/common/builder.py\n@@ -257,11 +257,10 @@ class AllBuilder(object):\n             sage: documents[0] == 'en/reference'\n             True\n         \"\"\"\n-        documents = []\n-        for lang in LANGUAGES:\n-            for document in os.listdir(os.path.join(SAGE_DOC, lang)):\n-                if document not in OMIT:\n-                    documents.append(os.path.join(lang, document))\n+        documents = [os.path.join(lang, document) for lang in LANGUAGES\n+                     for document in os.listdir(os.path.join(SAGE_DOC, lang))\n+                     if document not in OMIT and\n+                     os.path.isdir(os.path.join(SAGE_DOC, lang, document))]\n \n         # Ensure that the reference guide is compiled first so that links from\n         # the other document to it are correctly resolved.\n```\n",
    "created_at": "2012-09-28T03:26:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13340#issuecomment-163907",
    "user": "jhpalmieri"
}
```

Another option would be the following; this could be used in addition to the patch here, or independently of it. Both should fix the problem.

```diff
diff --git a/doc/common/builder.py b/doc/common/builder.py
--- a/doc/common/builder.py
+++ b/doc/common/builder.py
@@ -257,11 +257,10 @@ class AllBuilder(object):
             sage: documents[0] == 'en/reference'
             True
         """
-        documents = []
-        for lang in LANGUAGES:
-            for document in os.listdir(os.path.join(SAGE_DOC, lang)):
-                if document not in OMIT:
-                    documents.append(os.path.join(lang, document))
+        documents = [os.path.join(lang, document) for lang in LANGUAGES
+                     for document in os.listdir(os.path.join(SAGE_DOC, lang))
+                     if document not in OMIT and
+                     os.path.isdir(os.path.join(SAGE_DOC, lang, document))]
 
         # Ensure that the reference guide is compiled first so that links from
         # the other document to it are correctly resolved.
```




---

archive/issue_comments_163908.json:
```json
{
    "body": "Replying to [comment:2 jhpalmieri]:\n> Another option would be the following; this could be used in addition to the patch here, or independently of it. Both should fix the problem.\n\nThis solution is nicer and would fix more than just .DS_Store issues (assuming that such things arise).",
    "created_at": "2012-09-28T03:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13340#issuecomment-163908",
    "user": "yomcat"
}
```

Replying to [comment:2 jhpalmieri]:
> Another option would be the following; this could be used in addition to the patch here, or independently of it. Both should fix the problem.

This solution is nicer and would fix more than just .DS_Store issues (assuming that such things arise).



---

archive/issue_comments_163909.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-09-28T04:55:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13340#issuecomment-163909",
    "user": "yomcat"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_163910.json:
```json
{
    "body": "Works as advertised. Both fixes.",
    "created_at": "2012-09-28T04:55:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13340#issuecomment-163910",
    "user": "yomcat"
}
```

Works as advertised. Both fixes.



---

archive/issue_comments_163911.json:
```json
{
    "body": "John, in this case, I find the for/for/if better readable than the long list comprehension.  It's a detail, but a 4-line list comprehension is a lot to parse.  I agree on the change itself.",
    "created_at": "2012-09-28T06:37:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13340#issuecomment-163911",
    "user": "jdemeyer"
}
```

John, in this case, I find the for/for/if better readable than the long list comprehension.  It's a detail, but a 4-line list comprehension is a lot to parse.  I agree on the change itself.



---

archive/issue_comments_163912.json:
```json
{
    "body": "Okay, here's a new \"dirs\" patch. I suggest we only use that patch, not both.",
    "created_at": "2012-09-28T14:34:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13340#issuecomment-163912",
    "user": "jhpalmieri"
}
```

Okay, here's a new "dirs" patch. I suggest we only use that patch, not both.



---

archive/issue_comments_163913.json:
```json
{
    "body": "If you fix the commit message, it's all good to go.",
    "created_at": "2012-09-28T14:47:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13340#issuecomment-163913",
    "user": "jdemeyer"
}
```

If you fix the commit message, it's all good to go.



---

archive/issue_comments_163914.json:
```json
{
    "body": "Well, I personally thought that \"[mq]: foo\" was pretty descriptive.",
    "created_at": "2012-09-28T15:29:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13340#issuecomment-163914",
    "user": "jhpalmieri"
}
```

Well, I personally thought that "[mq]: foo" was pretty descriptive.



---

archive/issue_comments_163915.json:
```json
{
    "body": "Attachment [trac_13544_dirs.patch](tarball://root/attachments/some-uuid/ticket13544/trac_13544_dirs.patch) by jhpalmieri created at 2012-09-28 15:30:06",
    "created_at": "2012-09-28T15:30:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13340#issuecomment-163915",
    "user": "jhpalmieri"
}
```

Attachment [trac_13544_dirs.patch](tarball://root/attachments/some-uuid/ticket13544/trac_13544_dirs.patch) by jhpalmieri created at 2012-09-28 15:30:06



---

archive/issue_comments_163916.json:
```json
{
    "body": "(Oops: trac_13544_dirs.patch and trac_13544_dirs.2.patch are identical. You can delete one if you want. I wish that attachment owners could delete their own attachments.)",
    "created_at": "2012-09-28T15:31:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13340#issuecomment-163916",
    "user": "jhpalmieri"
}
```

(Oops: trac_13544_dirs.patch and trac_13544_dirs.2.patch are identical. You can delete one if you want. I wish that attachment owners could delete their own attachments.)



---

archive/issue_comments_163917.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-10-05T10:07:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13340",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13340#issuecomment-163917",
    "user": "jdemeyer"
}
```

Resolution: fixed
