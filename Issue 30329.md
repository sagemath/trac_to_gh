# Issue 30329: random_spanning_tree ignores weights

Issue created by migration from https://trac.sagemath.org/ticket/30566

Original creator: pelegm

Original creation time: 2020-09-13 04:51:42

Keywords: random_spanning_tree, aldous/broder, weighted_graphs

!Aldous/Broder on a weighted graph should perform a random walk on that graph which considers the weights, and this is not the case at the moment.

Options:
1. make the walk consider the weights
2. add a warning for weighted graphs



---

Comment by pelegm created at 2020-09-13 04:58:50

I don't have a development environment on my computer at the moment, but the difference should be in the following line:



```python
new_s = neighbours[randint(0, len(neighbours) - 1)]
```


Instead, `new_s` should be chosen with weights considered (if and only if the graph is weighted). The sage function `choice` does not support weights, but `numpy`'s `choice` does:

https://stackoverflow.com/a/26196078/1565828


---

Comment by dcoudert created at 2021-03-28 13:03:09

Changing status from new to needs_review.


---

Comment by dcoudert created at 2021-03-28 13:03:09

With this branch, the walk considers the weights.
----
New commits:


---

Comment by mkoeppe created at 2021-05-10 17:42:09

Moving to 9.4, as 9.3 has been released.


---

Comment by mkoeppe created at 2021-07-19 00:44:56

Setting a new milestone for this ticket based on a cursory review.


---

Comment by git created at 2021-11-08 15:29:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2021-11-08 15:29:39

Clean the use of weights as part of #13112


---

Comment by chapoton created at 2021-11-09 18:48:27

ca me parait bien. Peut-etre ajouter un doctest que le resultat est bien un arbre lorsqu'on utilise les poids ?


---

Comment by git created at 2021-11-09 23:40:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2021-11-09 23:40:38

Tu as raison.


---

Comment by chapoton created at 2021-11-11 09:33:38

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2021-11-11 09:33:38

ok, positif


---

Comment by vbraun created at 2021-11-14 17:06:32

Resolution: fixed
