# Issue 33128: missing interface for nauty-genbg (generating bipartite graphs with given bipartition)

archive/issues_033128.json:
```json
{
    "body": "CC:  tscrim\n\nSage provides interface to `nauty-geng` tool via `graph.nauty_geng()`, but interface for `nauty-genbg` tool is missing.\n\nIssue created by migration from https://trac.sagemath.org/ticket/33365\n\n",
    "created_at": "2022-02-17T16:02:38Z",
    "labels": [
        "graph theory",
        "major",
        "enhancement"
    ],
    "title": "missing interface for nauty-genbg (generating bipartite graphs with given bipartition)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33128",
    "user": "@maxale"
}
```
CC:  tscrim

Sage provides interface to `nauty-geng` tool via `graph.nauty_geng()`, but interface for `nauty-genbg` tool is missing.

Issue created by migration from https://trac.sagemath.org/ticket/33365





---

archive/issue_comments_472075.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-04-10T13:46:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33128#issuecomment-472075",
    "user": "dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_472076.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-04-10T13:46:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33128#issuecomment-472076",
    "user": "dcoudert"
}
```

New commits:



---

archive/issue_comments_472077.json:
```json
{
    "body": "I see that the resulting graphs are created via \n\n\n```\n         G = BipartiteGraph(s[:-1], format='graph6')\n\n```\n\n\nPlease notice that `graph6` format does not bear bipartition information, and the bipartition produced by `BipartiteGraph()` may be different from the requested one (via parameters `n1` and `n2`), especially for non-connected ones, where multiple bipartitions may exist. I believe `genbg` produces the graph under assumption that left and right partite sets are formed by vertices `(0..n1-1)` and `(n1..n1+n2-1)`, respectively. This needs to be enforced for the resulting graphs like:\n\n\n```\n         G = BipartiteGraph(s[:-1], format='graph6', partition=(set(0..n1-1),set(n1..n1+n2-1)))\n\n```\n\n\nI did not test this, but I hope the idea is clear.",
    "created_at": "2022-04-10T15:32:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33128#issuecomment-472077",
    "user": "@maxale"
}
```

I see that the resulting graphs are created via 


```
         G = BipartiteGraph(s[:-1], format='graph6')

```


Please notice that `graph6` format does not bear bipartition information, and the bipartition produced by `BipartiteGraph()` may be different from the requested one (via parameters `n1` and `n2`), especially for non-connected ones, where multiple bipartitions may exist. I believe `genbg` produces the graph under assumption that left and right partite sets are formed by vertices `(0..n1-1)` and `(n1..n1+n2-1)`, respectively. This needs to be enforced for the resulting graphs like:


```
         G = BipartiteGraph(s[:-1], format='graph6', partition=(set(0..n1-1),set(n1..n1+n2-1)))

```


I did not test this, but I hope the idea is clear.



---

archive/issue_comments_472078.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-04-10T17:22:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33128#issuecomment-472078",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_472079.json:
```json
{
    "body": "You are right. Not easy when `n1` and `n2` are somewhere in the `options` string...\n\nI'm not particularly proud of my solution of parsing the auxiliary output, but it's working for as long as the user don't pass option -q (which suppress the auxiliary output).",
    "created_at": "2022-04-10T17:26:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33128#issuecomment-472079",
    "user": "dcoudert"
}
```

You are right. Not easy when `n1` and `n2` are somewhere in the `options` string...

I'm not particularly proud of my solution of parsing the auxiliary output, but it's working for as long as the user don't pass option -q (which suppress the auxiliary output).



---

archive/issue_comments_472080.json:
```json
{
    "body": "green bot, please review.",
    "created_at": "2022-04-30T12:29:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33128#issuecomment-472080",
    "user": "dcoudert"
}
```

green bot, please review.



---

archive/issue_comments_472081.json:
```json
{
    "body": "More of a nitpick: I think `(-s, -a)` and, e.g., `\">M\"` should be code-formatted.\n\nI agree that it is not that elegant, but it seems to work. If issues arise down the road, we can fix them then.\n\nWhether or not you include my above nitpick, you can set a positive review on my behalf.",
    "created_at": "2022-06-16T23:40:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33128#issuecomment-472081",
    "user": "tscrim"
}
```

More of a nitpick: I think `(-s, -a)` and, e.g., `">M"` should be code-formatted.

I agree that it is not that elegant, but it seems to work. If issues arise down the road, we can fix them then.

Whether or not you include my above nitpick, you can set a positive review on my behalf.



---

archive/issue_comments_472082.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-17T14:33:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33128#issuecomment-472082",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_472083.json:
```json
{
    "body": "I'm not sure to understand what you asked for... I changed to `(``-s``, ``-a``)`.\n\nI prefer to avoid mentioning `\">M\"`. It can effectively be used to count graphs, but it's not documented and does not even appear in the source code of `genbg`.",
    "created_at": "2022-06-17T14:36:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33128#issuecomment-472083",
    "user": "dcoudert"
}
```

I'm not sure to understand what you asked for... I changed to `(``-s``, ``-a``)`.

I prefer to avoid mentioning `">M"`. It can effectively be used to count graphs, but it's not documented and does not even appear in the source code of `genbg`.



---

archive/issue_comments_472084.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-06-17T14:36:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33128#issuecomment-472084",
    "user": "dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_472085.json:
```json
{
    "body": "As proposed, I set this ticket to positive review.\n\nThanks.",
    "created_at": "2022-06-17T14:36:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33128#issuecomment-472085",
    "user": "dcoudert"
}
```

As proposed, I set this ticket to positive review.

Thanks.



---

archive/issue_comments_472086.json:
```json
{
    "body": "Replying to [comment:10 dcoudert]:\n> I'm not sure to understand what you asked for... I changed to `(``-s``, ``-a``)`.\n\nYes, that\u2019s right: code formatting is ````.\n\n> I prefer to avoid mentioning `\">M\"`. It can effectively be used to count graphs, but it's not documented and does not even appear in the source code of `genbg`.\n\nThose kind of things were included in the doc though. Anyways, not so important.\n\nThank you.",
    "created_at": "2022-06-18T04:56:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33128#issuecomment-472086",
    "user": "tscrim"
}
```

Replying to [comment:10 dcoudert]:
> I'm not sure to understand what you asked for... I changed to `(``-s``, ``-a``)`.

Yes, thatâ€™s right: code formatting is ````.

> I prefer to avoid mentioning `">M"`. It can effectively be used to count graphs, but it's not documented and does not even appear in the source code of `genbg`.

Those kind of things were included in the doc though. Anyways, not so important.

Thank you.



---

archive/issue_comments_472087.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-06-19T15:24:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33128#issuecomment-472087",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_472088.json:
```json
{
    "body": "Please notice that `nauty-genbg` has the following restrictions on `n1` and `n2`:\n\n\n```\n$ nauty-genbg 5 28\n>E genbg: must have n1=1..24, n1+n2=1..32\n```\n\n\nShould these restrictions be checked by the interface and an appropriate error be raised?",
    "created_at": "2022-07-13T15:37:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33128#issuecomment-472088",
    "user": "@maxale"
}
```

Please notice that `nauty-genbg` has the following restrictions on `n1` and `n2`:


```
$ nauty-genbg 5 28
>E genbg: must have n1=1..24, n1+n2=1..32
```


Should these restrictions be checked by the interface and an appropriate error be raised?



---

archive/issue_comments_472089.json:
```json
{
    "body": "Yes, and these restrictions should be properly documented. Can you open a ticket ?",
    "created_at": "2022-07-13T15:50:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33128#issuecomment-472089",
    "user": "dcoudert"
}
```

Yes, and these restrictions should be properly documented. Can you open a ticket ?



---

archive/issue_comments_472090.json:
```json
{
    "body": "Added as ticket #34179.",
    "created_at": "2022-07-13T17:33:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33128#issuecomment-472090",
    "user": "@maxale"
}
```

Added as ticket #34179.
