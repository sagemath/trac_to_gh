# Issue 33128: missing interface for nauty-genbg (generating bipartite graphs with given bipartition)

Issue created by migration from https://trac.sagemath.org/ticket/33365

Original creator: @maxale

Original creation time: 2022-02-17 16:02:38

CC:  tscrim

Sage provides interface to `nauty-geng` tool via `graph.nauty_geng()`, but interface for `nauty-genbg` tool is missing.


---

Comment by dcoudert created at 2022-04-10 13:46:02

Changing status from new to needs_review.


---

Comment by dcoudert created at 2022-04-10 13:46:02

New commits:


---

Comment by @maxale created at 2022-04-10 15:32:07

I see that the resulting graphs are created via 


```
         G = BipartiteGraph(s[:-1], format='graph6')

```


Please notice that `graph6` format does not bear bipartition information, and the bipartition produced by `BipartiteGraph()` may be different from the requested one (via parameters `n1` and `n2`), especially for non-connected ones, where multiple bipartitions may exist. I believe `genbg` produces the graph under assumption that left and right partite sets are formed by vertices `(0..n1-1)` and `(n1..n1+n2-1)`, respectively. This needs to be enforced for the resulting graphs like:


```
         G = BipartiteGraph(s[:-1], format='graph6', partition=(set(0..n1-1),set(n1..n1+n2-1)))

```


I did not test this, but I hope the idea is clear.


---

Comment by git created at 2022-04-10 17:22:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2022-04-10 17:26:08

You are right. Not easy when `n1` and `n2` are somewhere in the `options` string...

I'm not particularly proud of my solution of parsing the auxiliary output, but it's working for as long as the user don't pass option -q (which suppress the auxiliary output).


---

Comment by dcoudert created at 2022-04-30 12:29:54

green bot, please review.


---

Comment by tscrim created at 2022-06-16 23:40:16

More of a nitpick: I think `(-s, -a)` and, e.g., `">M"` should be code-formatted.

I agree that it is not that elegant, but it seems to work. If issues arise down the road, we can fix them then.

Whether or not you include my above nitpick, you can set a positive review on my behalf.


---

Comment by git created at 2022-06-17 14:33:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2022-06-17 14:36:05

I'm not sure to understand what you asked for... I changed to `(``-s``, ``-a``)`.

I prefer to avoid mentioning `">M"`. It can effectively be used to count graphs, but it's not documented and does not even appear in the source code of `genbg`.


---

Comment by dcoudert created at 2022-06-17 14:36:37

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2022-06-17 14:36:37

As proposed, I set this ticket to positive review.

Thanks.


---

Comment by tscrim created at 2022-06-18 04:56:49

Replying to [comment:10 dcoudert]:
> I'm not sure to understand what you asked for... I changed to `(``-s``, ``-a``)`.

Yes, thatâ€™s right: code formatting is ````.

> I prefer to avoid mentioning `">M"`. It can effectively be used to count graphs, but it's not documented and does not even appear in the source code of `genbg`.

Those kind of things were included in the doc though. Anyways, not so important.

Thank you.


---

Comment by vbraun created at 2022-06-19 15:24:38

Resolution: fixed


---

Comment by @maxale created at 2022-07-13 15:37:35

Please notice that `nauty-genbg` has the following restrictions on `n1` and `n2`:


```
$ nauty-genbg 5 28
>E genbg: must have n1=1..24, n1+n2=1..32
```


Should these restrictions be checked by the interface and an appropriate error be raised?


---

Comment by dcoudert created at 2022-07-13 15:50:04

Yes, and these restrictions should be properly documented. Can you open a ticket ?


---

Comment by @maxale created at 2022-07-13 17:33:30

Added as ticket #34179.
