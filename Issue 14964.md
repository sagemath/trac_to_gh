# Issue 14964: Problem with Hecke eigenvalues with the same index as the level

Issue created by migration from Trac.

Original creator: fstromberg

Original creation time: 2013-09-16 00:00:39

It seems to be a problem to compute Hecke eigenvalues for Modular Symbol subspaces at integers dividing the level N unless the eigenvalue for the Hecke operator at N is computed first.
I have verified this problem for sage versions between 5.8 and 5.12.beta.

Example::


    sage: M=ModularSymbols(5,6,sign=1)

    sage: S=M.decomposition()

    sage: f=S[0]

    sage: f.eigenvalue(10)

    IndexError                                Traceback (most recent call last)

    ...

    IndexError: n must be a positive integer

    sage: f.eigenvalue(5)

    25

    sage: f.eigenvalue(10)

    50


---

Comment by AlexGhitza created at 2014-04-24 14:02:50

The code used the recursive formula for the Hecke eigenvalues of p-power index without implementing the base case.  This is fixed in the attached branch.


---

Comment by AlexGhitza created at 2014-04-24 14:04:29

Changing status from new to needs_review.


---

Comment by AlexGhitza created at 2014-04-24 14:04:29

New commits:


---

Comment by pbruin created at 2014-04-24 16:32:31

Changing status from needs_review to positive_review.


---

Comment by pbruin created at 2014-04-24 16:32:31

Changing component from number theory to modular forms.


---

Comment by vbraun created at 2014-04-29 12:03:12

Resolution: fixed
