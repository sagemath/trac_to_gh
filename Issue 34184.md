# Issue 34184: jupyter_jsmol installation times out

archive/issues_034184.json:
```json
{
    "body": "CC:  @mkoeppe @videlec @kiwifb @slel @strogdon\n\nafter #33866 update, I get an error on Gentoo.\n\nAs it turns out, jupyter_jsmol installation process fetches more js stuff than there is in the tarball:\n\n```\njjupyter_jsmol-2022.1.0] Building wheels for collected packages: jupyter-jsmol\n[jupyter_jsmol-2022.1.0]   WARNING: Ignoring --build-option when building jupyter-jsmol using PEP 517\n[jupyter_jsmol-2022.1.0]   Building wheel for jupyter-jsmol (pyproject.toml): started\n[jupyter_jsmol-2022.1.0]   Running command Building wheel for jupyter-jsmol (pyproject.toml)\n[jupyter_jsmol-2022.1.0]   setup.py entered\n[jupyter_jsmol-2022.1.0]   $PATH=/mnt/opt/Sage/sage-dev/build/bin:/mnt/opt/Sage/sage-dev/local/var/lib/sage/venv-python3.10/bin:/mnt/opt/Sage/sage-dev/local/bin:/mnt/opt/Sage/sage-dev/build/bin:/mnt/opt/Sage/sage-dev/local/bin:/mnt/opt/Sage/sage-dev/local/var/lib/sage/venv-python3.10/bin:/mnt/opt/Sage/sage-dev/build/bin:/mnt/opt/Sage/sage-dev/src/bin:/mnt/opt/Sage/sage-dev/local/bin:/home/dima/.elan/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/bin:/usr/lib/llvm/14/bin:/home/dima/.local/bin:/home/dima/.local/bin\n[jupyter_jsmol-2022.1.0]   <string>:47: DeprecatedWarning: create_cmdclass is deprecated as of 0.8 and will be removed in 1.0. \"\n[jupyter_jsmol-2022.1.0]   Use `wrap_installers` to handle prebuild steps in cmdclass.\n[jupyter_jsmol-2022.1.0]   Use `get_data_files` to handle data files.\n[jupyter_jsmol-2022.1.0]   Use `include_package_data=True` and `MANIFEST.in` for package data.\n[jupyter_jsmol-2022.1.0] \n[jupyter_jsmol-2022.1.0]   <string>:49: DeprecatedWarning: install_npm is deprecated as of 0.8 and will be removed in 1.0. Use `npm_builder` and `wrap_installers`\n[jupyter_jsmol-2022.1.0]   running bdist_wheel\n[jupyter_jsmol-2022.1.0]   running jsdeps\n[jupyter_jsmol-2022.1.0]   Installing build dependencies with npm.  This may take a while...\n[jupyter_jsmol-2022.1.0]   > yarn install\n[jupyter_jsmol-2022.1.0]   yarn install v1.22.19\n[jupyter_jsmol-2022.1.0]   warning package.json: No license field\n[jupyter_jsmol-2022.1.0]   warning package-lock.json found. Your project contains lock files generated by tools other than Yarn. It is advised not to mix package managers in order to avoid resolution inconsistencies caused by unsynchronized lock files. To clear this warning, remove package-lock.json.\n[jupyter_jsmol-2022.1.0]   warning jupyter-jsmol@2022.1.0: No license field\n[jupyter_jsmol-2022.1.0]   [1/4] Resolving packages...\n[jupyter_jsmol-2022.1.0]   [2/4] Fetching packages...\n[jupyter_jsmol-2022.1.0]   info There appears to be trouble with your network connection. Retrying...\n...\n```\n\n\naand it hangs - even tough the network is OK. Also reported on sage-devel with archlinux.\n\nIssue created by migration from https://trac.sagemath.org/ticket/34421\n\n",
    "created_at": "2022-08-24T10:59:58Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "jupyter_jsmol installation times out",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34184",
    "user": "https://github.com/dimpase"
}
```
CC:  @mkoeppe @videlec @kiwifb @slel @strogdon

after #33866 update, I get an error on Gentoo.

As it turns out, jupyter_jsmol installation process fetches more js stuff than there is in the tarball:

```
jjupyter_jsmol-2022.1.0] Building wheels for collected packages: jupyter-jsmol
[jupyter_jsmol-2022.1.0]   WARNING: Ignoring --build-option when building jupyter-jsmol using PEP 517
[jupyter_jsmol-2022.1.0]   Building wheel for jupyter-jsmol (pyproject.toml): started
[jupyter_jsmol-2022.1.0]   Running command Building wheel for jupyter-jsmol (pyproject.toml)
[jupyter_jsmol-2022.1.0]   setup.py entered
[jupyter_jsmol-2022.1.0]   $PATH=/mnt/opt/Sage/sage-dev/build/bin:/mnt/opt/Sage/sage-dev/local/var/lib/sage/venv-python3.10/bin:/mnt/opt/Sage/sage-dev/local/bin:/mnt/opt/Sage/sage-dev/build/bin:/mnt/opt/Sage/sage-dev/local/bin:/mnt/opt/Sage/sage-dev/local/var/lib/sage/venv-python3.10/bin:/mnt/opt/Sage/sage-dev/build/bin:/mnt/opt/Sage/sage-dev/src/bin:/mnt/opt/Sage/sage-dev/local/bin:/home/dima/.elan/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/bin:/usr/lib/llvm/14/bin:/home/dima/.local/bin:/home/dima/.local/bin
[jupyter_jsmol-2022.1.0]   <string>:47: DeprecatedWarning: create_cmdclass is deprecated as of 0.8 and will be removed in 1.0. "
[jupyter_jsmol-2022.1.0]   Use `wrap_installers` to handle prebuild steps in cmdclass.
[jupyter_jsmol-2022.1.0]   Use `get_data_files` to handle data files.
[jupyter_jsmol-2022.1.0]   Use `include_package_data=True` and `MANIFEST.in` for package data.
[jupyter_jsmol-2022.1.0] 
[jupyter_jsmol-2022.1.0]   <string>:49: DeprecatedWarning: install_npm is deprecated as of 0.8 and will be removed in 1.0. Use `npm_builder` and `wrap_installers`
[jupyter_jsmol-2022.1.0]   running bdist_wheel
[jupyter_jsmol-2022.1.0]   running jsdeps
[jupyter_jsmol-2022.1.0]   Installing build dependencies with npm.  This may take a while...
[jupyter_jsmol-2022.1.0]   > yarn install
[jupyter_jsmol-2022.1.0]   yarn install v1.22.19
[jupyter_jsmol-2022.1.0]   warning package.json: No license field
[jupyter_jsmol-2022.1.0]   warning package-lock.json found. Your project contains lock files generated by tools other than Yarn. It is advised not to mix package managers in order to avoid resolution inconsistencies caused by unsynchronized lock files. To clear this warning, remove package-lock.json.
[jupyter_jsmol-2022.1.0]   warning jupyter-jsmol@2022.1.0: No license field
[jupyter_jsmol-2022.1.0]   [1/4] Resolving packages...
[jupyter_jsmol-2022.1.0]   [2/4] Fetching packages...
[jupyter_jsmol-2022.1.0]   info There appears to be trouble with your network connection. Retrying...
...
```


aand it hangs - even tough the network is OK. Also reported on sage-devel with archlinux.

Issue created by migration from https://trac.sagemath.org/ticket/34421





---

archive/issue_comments_484425.json:
```json
{
    "body": "Changing keywords from \"\" to \"jupyter_jsmol\".",
    "created_at": "2022-08-24T16:27:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484425",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "jupyter_jsmol".



---

archive/issue_comments_484426.json:
```json
{
    "body": "While fixing this, is it worth also addressing this message in the log file?\n\n```\n  Looking in links: /Users/palmieri/Desktop/Sage/sage_builds/TESTING/clean/sage-9.7.beta8/local/var/lib/sage/venv-python3.9/var/lib/sage/wheels\n  ERROR: Could not find a version that satisfies the requirement jupyter_packaging~=0.7.9 (from versions: none)\n  ERROR: No matching distribution found for jupyter_packaging~=0.7.9\n```\n\nI don't know where this version number for `jupyter_packaging` is coming from.",
    "created_at": "2022-08-24T18:14:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484426",
    "user": "https://github.com/jhpalmieri"
}
```

While fixing this, is it worth also addressing this message in the log file?

```
  Looking in links: /Users/palmieri/Desktop/Sage/sage_builds/TESTING/clean/sage-9.7.beta8/local/var/lib/sage/venv-python3.9/var/lib/sage/wheels
  ERROR: Could not find a version that satisfies the requirement jupyter_packaging~=0.7.9 (from versions: none)
  ERROR: No matching distribution found for jupyter_packaging~=0.7.9
```

I don't know where this version number for `jupyter_packaging` is coming from.



---

archive/issue_comments_484427.json:
```json
{
    "body": "I don't see the problem in the ticket description on my OS X machine. Is it because of this from the log file?\n\n```\n  yarn not found, ignoring yarn.lock file\n  `yarn` unavailable.  If you're running this command using sudo, make sure `yarn` is available to sudo\n```\n",
    "created_at": "2022-08-24T18:15:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484427",
    "user": "https://github.com/jhpalmieri"
}
```

I don't see the problem in the ticket description on my OS X machine. Is it because of this from the log file?

```
  yarn not found, ignoring yarn.lock file
  `yarn` unavailable.  If you're running this command using sudo, make sure `yarn` is available to sudo
```




---

archive/issue_comments_484428.json:
```json
{
    "body": "Replying to [comment:5 jhpalmieri]:\n> I don't see the problem in the ticket description on my OS X machine. Is it because of this from the log file?\n> {{{\n>   yarn not found, ignoring yarn.lock file\n>   `yarn` unavailable.  If you're running this command using sudo, make sure `yarn` is available to sudo\n> }}}\n\non another Linux box, without yarn installed, I can't reproduce this either.",
    "created_at": "2022-08-24T18:28:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484428",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:5 jhpalmieri]:
> I don't see the problem in the ticket description on my OS X machine. Is it because of this from the log file?
> {{{
>   yarn not found, ignoring yarn.lock file
>   `yarn` unavailable.  If you're running this command using sudo, make sure `yarn` is available to sudo
> }}}

on another Linux box, without yarn installed, I can't reproduce this either.



---

archive/issue_comments_484429.json:
```json
{
    "body": "My guess would be that on the affected system, there's an installation of some Javascript tools such as `yarn`, and that this interacts poorly with the fact we poison the https proxy when installing normal packages.",
    "created_at": "2022-08-24T18:41:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484429",
    "user": "https://github.com/mkoeppe"
}
```

My guess would be that on the affected system, there's an installation of some Javascript tools such as `yarn`, and that this interacts poorly with the fact we poison the https proxy when installing normal packages.



---

archive/issue_comments_484430.json:
```json
{
    "body": "It would be worth trying if `export JUPYTER_PACKAGING_SKIP_NPM=1` resolves this problem.\n\nSee https://github.com/jupyter/jupyter-packaging/blob/main/jupyter_packaging/setupbase.py#L74",
    "created_at": "2022-08-25T04:10:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484430",
    "user": "https://github.com/mkoeppe"
}
```

It would be worth trying if `export JUPYTER_PACKAGING_SKIP_NPM=1` resolves this problem.

See https://github.com/jupyter/jupyter-packaging/blob/main/jupyter_packaging/setupbase.py#L74



---

archive/issue_comments_484431.json:
```json
{
    "body": "That'd be nice if it works. The previous version (0.2.4) had a switch to avoid the npm stuff (`--skip-npm`) but it has been removed.",
    "created_at": "2022-08-25T04:13:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484431",
    "user": "https://github.com/kiwifb"
}
```

That'd be nice if it works. The previous version (0.2.4) had a switch to avoid the npm stuff (`--skip-npm`) but it has been removed.



---

archive/issue_comments_484432.json:
```json
{
    "body": "it's weird that absence of yarn does not  lead to  build failure, and still produces something that works (?).",
    "created_at": "2022-08-25T06:07:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484432",
    "user": "https://github.com/dimpase"
}
```

it's weird that absence of yarn does not  lead to  build failure, and still produces something that works (?).



---

archive/issue_comments_484433.json:
```json
{
    "body": "The sdist of this package contains the prebuilt Javascript assets.",
    "created_at": "2022-08-25T06:42:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484433",
    "user": "https://github.com/mkoeppe"
}
```

The sdist of this package contains the prebuilt Javascript assets.



---

archive/issue_comments_484434.json:
```json
{
    "body": "why can't we just install the binary wheel? How is it different?",
    "created_at": "2022-08-25T06:53:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484434",
    "user": "https://github.com/dimpase"
}
```

why can't we just install the binary wheel? How is it different?



---

archive/issue_comments_484435.json:
```json
{
    "body": "Replying to [comment:9 mkoeppe]:\n> It would be worth trying if `export JUPYTER_PACKAGING_SKIP_NPM=1` resolves this problem.\n> \n> See https://github.com/jupyter/jupyter-packaging/blob/main/jupyter_packaging/setupbase.py#L74\n\nIt fails for two reasons. First the handling of this environment variable is buggy\n\n```\n  Skipping npm install as requested.\n  Traceback (most recent call last):\n    File \"/opt/sage/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py\", line 363, in <module>\n      main()\n    File \"/opt/sage/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py\", line 345, in main\n      json_out['return_val'] = hook(**hook_input['kwargs'])\n    File \"/opt/sage/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py\", line 164, in prepare_metadata_for_build_wheel\n      return hook(metadata_directory, config_settings)\n    File \"/opt/sage/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/setuptools/build_meta.py\", line 188, in prepare_metadata_for_build_wheel\n      self.run_setup()\n    File \"/opt/sage/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/setuptools/build_meta.py\", line 174, in run_setup\n      exec(code, locals())\n    File \"<string>\", line 8, in <module>\n    File \"/opt/sage/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/jupyter_packaging/__init__.py\", line 6, in <module>\n      from .setupbase import *  # noqa\n    File \"/opt/sage/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/jupyter_packaging/setupbase.py\", line 77, in <module>\n      sys.argv.remove(\"--skip-npm\")\n  ValueError: list.remove(x): x not in list\n  error: subprocess-exited-with-error\n```\n\nSecondly, there seems to be a missing build dependency\n\n```\n  ERROR: Could not find a version that satisfies the requirement jupyter_packaging~=0.7.9 (from versions: none)\n  ERROR: No matching distribution found for jupyter_packaging~=0.7.9\n  error: subprocess-exited-with-error\n  \n  \u00d7 pip subprocess to install build dependencies did not run successfully.\n  \u2502 exit code: 1\n  \u2570\u2500> See above for output.\n  \n  note: This error originates from a subprocess, and is likely not a problem with pip.\n  full command: /opt/sage/local/var/lib/sage/venv-python3.10/bin/python3 /tmp/pip-standalone-pip-a17tx8xr/__env_pip__.zip/pip install --ignore-installed --no-user --prefix /tmp/pip-build-env-\nmyzlxjyq/overlay --no-warn-script-location --no-binary :all: --only-binary :none: --no-index --find-links /opt/sage/local/var/lib/sage/venv-python3.10/var/lib/sage/wheels -- 'jupyter_packagin\ng~=0.7.9' 'jupyterlab>=3.0.0,==3.*' 'setuptools>=40.8.0' wheel\n```\n",
    "created_at": "2022-08-25T07:51:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484435",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:9 mkoeppe]:
> It would be worth trying if `export JUPYTER_PACKAGING_SKIP_NPM=1` resolves this problem.
> 
> See https://github.com/jupyter/jupyter-packaging/blob/main/jupyter_packaging/setupbase.py#L74

It fails for two reasons. First the handling of this environment variable is buggy

```
  Skipping npm install as requested.
  Traceback (most recent call last):
    File "/opt/sage/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py", line 363, in <module>
      main()
    File "/opt/sage/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py", line 345, in main
      json_out['return_val'] = hook(**hook_input['kwargs'])
    File "/opt/sage/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py", line 164, in prepare_metadata_for_build_wheel
      return hook(metadata_directory, config_settings)
    File "/opt/sage/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/setuptools/build_meta.py", line 188, in prepare_metadata_for_build_wheel
      self.run_setup()
    File "/opt/sage/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/setuptools/build_meta.py", line 174, in run_setup
      exec(code, locals())
    File "<string>", line 8, in <module>
    File "/opt/sage/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/jupyter_packaging/__init__.py", line 6, in <module>
      from .setupbase import *  # noqa
    File "/opt/sage/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/jupyter_packaging/setupbase.py", line 77, in <module>
      sys.argv.remove("--skip-npm")
  ValueError: list.remove(x): x not in list
  error: subprocess-exited-with-error
```

Secondly, there seems to be a missing build dependency

```
  ERROR: Could not find a version that satisfies the requirement jupyter_packaging~=0.7.9 (from versions: none)
  ERROR: No matching distribution found for jupyter_packaging~=0.7.9
  error: subprocess-exited-with-error
  
  × pip subprocess to install build dependencies did not run successfully.
  │ exit code: 1
  ╰─> See above for output.
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
  full command: /opt/sage/local/var/lib/sage/venv-python3.10/bin/python3 /tmp/pip-standalone-pip-a17tx8xr/__env_pip__.zip/pip install --ignore-installed --no-user --prefix /tmp/pip-build-env-
myzlxjyq/overlay --no-warn-script-location --no-binary :all: --only-binary :none: --no-index --find-links /opt/sage/local/var/lib/sage/venv-python3.10/var/lib/sage/wheels -- 'jupyter_packagin
g~=0.7.9' 'jupyterlab>=3.0.0,==3.*' 'setuptools>=40.8.0' wheel
```




---

archive/issue_comments_484436.json:
```json
{
    "body": "Replying to [comment:14 vdelecroix]:\n> Replying to [comment:9 mkoeppe]:\n> > It would be worth trying if `export JUPYTER_PACKAGING_SKIP_NPM=1` resolves this problem.\n> > \n> > See https://github.com/jupyter/jupyter-packaging/blob/main/jupyter_packaging/setupbase.py#L74\n> \n> It fails for two reasons. First the handling of this environment variable is buggy\n\nCan you report this upstream please?",
    "created_at": "2022-08-25T10:05:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484436",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:14 vdelecroix]:
> Replying to [comment:9 mkoeppe]:
> > It would be worth trying if `export JUPYTER_PACKAGING_SKIP_NPM=1` resolves this problem.
> > 
> > See https://github.com/jupyter/jupyter-packaging/blob/main/jupyter_packaging/setupbase.py#L74
> 
> It fails for two reasons. First the handling of this environment variable is buggy

Can you report this upstream please?



---

archive/issue_comments_484437.json:
```json
{
    "body": "Try with this please\n----\nNew commits:",
    "created_at": "2022-08-25T10:21:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484437",
    "user": "https://github.com/mkoeppe"
}
```

Try with this please
----
New commits:



---

archive/issue_comments_484438.json:
```json
{
    "body": "this does not seem to change anything (same `x not in list` error with `JUPYTER_PACKAGING_SKIP_NPM=1`, hang with `yarn` without the latter).\n\nI tried overriding the system `yarn` with `src/bin/yarn` pointing to `/bin/true`. Then build finishes, and \ntests with `jsmol` pass. \n\nI'm however suspicious of it being non-working, still.\nIs there a visual test I can do?",
    "created_at": "2022-08-25T10:36:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484438",
    "user": "https://github.com/dimpase"
}
```

this does not seem to change anything (same `x not in list` error with `JUPYTER_PACKAGING_SKIP_NPM=1`, hang with `yarn` without the latter).

I tried overriding the system `yarn` with `src/bin/yarn` pointing to `/bin/true`. Then build finishes, and 
tests with `jsmol` pass. 

I'm however suspicious of it being non-working, still.
Is there a visual test I can do?



---

archive/issue_comments_484439.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-25T11:03:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484439",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_484440.json:
```json
{
    "body": "Try with this please",
    "created_at": "2022-08-25T11:03:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484440",
    "user": "https://github.com/mkoeppe"
}
```

Try with this please



---

archive/issue_comments_484441.json:
```json
{
    "body": "https://doc.sagemath.org/html/en/installation/launching.html#setting-up-sagemath-as-a-jupyter-kernel-in-an-existing-jupyter-notebook-or-jupyterlab-installation shows a test that you can do with jsmol",
    "created_at": "2022-08-25T11:04:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484441",
    "user": "https://github.com/mkoeppe"
}
```

https://doc.sagemath.org/html/en/installation/launching.html#setting-up-sagemath-as-a-jupyter-kernel-in-an-existing-jupyter-notebook-or-jupyterlab-installation shows a test that you can do with jsmol



---

archive/issue_comments_484442.json:
```json
{
    "body": "OK, it's actually in the docs, how to test jsmol - in notebook one has to run\n\n```\nplot3d(lambda u,v:(u^2+v^2)/4-2,(-2,2),(-2,2)).show(viewer=\"jmol\")\n```\n\nand see it producing stuff.\nIt works for my crude yarn->true workaround. \n----\nNew commits:",
    "created_at": "2022-08-25T11:14:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484442",
    "user": "https://github.com/dimpase"
}
```

OK, it's actually in the docs, how to test jsmol - in notebook one has to run

```
plot3d(lambda u,v:(u^2+v^2)/4-2,(-2,2),(-2,2)).show(viewer="jmol")
```

and see it producing stuff.
It works for my crude yarn->true workaround. 
----
New commits:



---

archive/issue_comments_484443.json:
```json
{
    "body": "OK, this works!",
    "created_at": "2022-08-25T11:19:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484443",
    "user": "https://github.com/dimpase"
}
```

OK, this works!



---

archive/issue_comments_484444.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-08-25T11:19:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484444",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_484445.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-08-25T11:19:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484445",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_484446.json:
```json
{
    "body": "Follow up in #34430 for a similar change that should be applied to other packages.",
    "created_at": "2022-08-25T11:22:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484446",
    "user": "https://github.com/mkoeppe"
}
```

Follow up in #34430 for a similar change that should be applied to other packages.



---

archive/issue_comments_484447.json:
```json
{
    "body": "Replying to [comment:15 mkoeppe]:\n> Replying to [comment:14 vdelecroix]:\n> > Replying to [comment:9 mkoeppe]:\n> > > It would be worth trying if `export JUPYTER_PACKAGING_SKIP_NPM=1` resolves this problem.\n> > > \n> > > See https://github.com/jupyter/jupyter-packaging/blob/main/jupyter_packaging/setupbase.py#L74\n> > \n> > It fails for two reasons. First the handling of this environment variable is buggy\n> \n> Can you report this upstream please?\n\nDone at https://github.com/jupyter/jupyter-packaging/issues/160",
    "created_at": "2022-08-25T11:37:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484447",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:15 mkoeppe]:
> Replying to [comment:14 vdelecroix]:
> > Replying to [comment:9 mkoeppe]:
> > > It would be worth trying if `export JUPYTER_PACKAGING_SKIP_NPM=1` resolves this problem.
> > > 
> > > See https://github.com/jupyter/jupyter-packaging/blob/main/jupyter_packaging/setupbase.py#L74
> > 
> > It fails for two reasons. First the handling of this environment variable is buggy
> 
> Can you report this upstream please?

Done at https://github.com/jupyter/jupyter-packaging/issues/160



---

archive/issue_comments_484448.json:
```json
{
    "body": "Thanks for reporting upstream at\n\n- \u200bhttps://github.com/jupyter/jupyter-packaging/issues/160\n\nand providing a fix at\n\n- \u200bhttps://github.com/jupyter/jupyter-packaging/pulls/161\n\nA new release is out that thas the fix:\n\n- \u200bhttps://github.com/jupyter/jupyter-packaging/releases/tag/v0.12.3 \n\nUpgrade ticket for Sage: #34432.",
    "created_at": "2022-08-25T16:33:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484448",
    "user": "https://github.com/slel"
}
```

Thanks for reporting upstream at

- ​https://github.com/jupyter/jupyter-packaging/issues/160

and providing a fix at

- ​https://github.com/jupyter/jupyter-packaging/pulls/161

A new release is out that thas the fix:

- ​https://github.com/jupyter/jupyter-packaging/releases/tag/v0.12.3 

Upgrade ticket for Sage: #34432.



---

archive/issue_comments_484449.json:
```json
{
    "body": "What happened here is that the comment regarding `jupyter_jsmol` in #33138 (ticket description) was no longer true after the `jupyter_jsmol` upgrade in #33530.",
    "created_at": "2022-08-25T17:57:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484449",
    "user": "https://github.com/mkoeppe"
}
```

What happened here is that the comment regarding `jupyter_jsmol` in #33138 (ticket description) was no longer true after the `jupyter_jsmol` upgrade in #33530.



---

archive/issue_events_089498.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-08-29T11:24:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34184#event-89498"
}
```



---

archive/issue_comments_484450.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-08-29T11:24:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34184#issuecomment-484450",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
