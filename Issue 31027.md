# Issue 31027: Allow setting zmin, zmax in plot3d and other 3d plots

archive/issues_031027.json:
```json
{
    "body": "CC:  slelievre\n\nKeywords: plot3d, zmin, zmax\n\nVarious types of 3d plots lack a way of\nsetting zmin and/or zmax, or a zrange:\n\n- `plot3d`\n- `plot` method of hyperplane arrangement\n- `plot` method of polyhedron\n\nwhile some others provide one, such as:\n\n- `implicit_plot3d`\n- `plot_vector_field3d`\n\nThis is frequently requested by users,\nsee for instance:\n\n- [Ask Sage question 55355: Ranging the z-axis](https://ask.sagemath.org/question/55355)\n- [Ask Sage question 54100: Calimero effect in plot3d](https://ask.sagemath.org/question/54100)\n- [Ask Sage question 36557: Vertical view plot3d](https://ask.sagemath.org/question/36557)\n- [Ask Sage question 30561: Visualizing Polyhedron with specified range](https://ask.sagemath.org/question/30561)\n- [sage-support request, 2008-11-13, Limiting z axis in 3d plot](https://groups.google.com/g/sage-support/c/SfR6lb-dwYc/m/n7hLC8SwYJQJ)\n\nIssue created by migration from https://trac.sagemath.org/ticket/31264\n\n",
    "created_at": "2021-01-19T17:00:02Z",
    "labels": [
        "graphics",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Allow setting zmin, zmax in plot3d and other 3d plots",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31027",
    "user": "slelievre"
}
```
CC:  slelievre

Keywords: plot3d, zmin, zmax

Various types of 3d plots lack a way of
setting zmin and/or zmax, or a zrange:

- `plot3d`
- `plot` method of hyperplane arrangement
- `plot` method of polyhedron

while some others provide one, such as:

- `implicit_plot3d`
- `plot_vector_field3d`

This is frequently requested by users,
see for instance:

- [Ask Sage question 55355: Ranging the z-axis](https://ask.sagemath.org/question/55355)
- [Ask Sage question 54100: Calimero effect in plot3d](https://ask.sagemath.org/question/54100)
- [Ask Sage question 36557: Vertical view plot3d](https://ask.sagemath.org/question/36557)
- [Ask Sage question 30561: Visualizing Polyhedron with specified range](https://ask.sagemath.org/question/30561)
- [sage-support request, 2008-11-13, Limiting z axis in 3d plot](https://groups.google.com/g/sage-support/c/SfR6lb-dwYc/m/n7hLC8SwYJQJ)

Issue created by migration from https://trac.sagemath.org/ticket/31264





---

archive/issue_comments_443197.json:
```json
{
    "body": "Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-24T02:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31027#issuecomment-443197",
    "user": "mkoeppe"
}
```

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_443198.json:
```json
{
    "body": "Where would be the appropriate place to read `zmin` and `zmax` keywords? Currently, they are stored in the `_extra_kwds` of the graphics object that is created but never read. A hacky way would be to use the `add_constraint` workaround (see above) and just do something like this:\n\n\n```diff\n--- a/src/sage/plot/plot3d/parametric_plot3d.py\n+++ b/src/sage/plot/plot3d/parametric_plot3d.py\n@@ -1001,6 +1001,15 @@ def parametric_plot3d(f, urange, vrange=None, plot_points=\"automatic\",\n         if plot_points == \"automatic\":\n             plot_points = [40, 40]\n         G = _parametric_plot3d_surface(f, urange, vrange, plot_points=plot_points, boundary_style=boundary_style, **kwds)\n+\n+    if 'zmin' in kwds:\n+        G.add_constraint(lambda x, y, z: z >= kwds[\"zmin\"])\n+        kwds.pop('zmin')\n+\n+    if 'zmax' in kwds:\n+        G.add_constraint(lambda x, y, z: z <= kwds[\"zmax\"])\n+        kwds.pop('zmax')\n```\n",
    "created_at": "2022-08-22T09:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31027#issuecomment-443198",
    "user": "saraedum"
}
```

Where would be the appropriate place to read `zmin` and `zmax` keywords? Currently, they are stored in the `_extra_kwds` of the graphics object that is created but never read. A hacky way would be to use the `add_constraint` workaround (see above) and just do something like this:


```diff
--- a/src/sage/plot/plot3d/parametric_plot3d.py
+++ b/src/sage/plot/plot3d/parametric_plot3d.py
@@ -1001,6 +1001,15 @@ def parametric_plot3d(f, urange, vrange=None, plot_points="automatic",
         if plot_points == "automatic":
             plot_points = [40, 40]
         G = _parametric_plot3d_surface(f, urange, vrange, plot_points=plot_points, boundary_style=boundary_style, **kwds)
+
+    if 'zmin' in kwds:
+        G.add_constraint(lambda x, y, z: z >= kwds["zmin"])
+        kwds.pop('zmin')
+
+    if 'zmax' in kwds:
+        G.add_constraint(lambda x, y, z: z <= kwds["zmax"])
+        kwds.pop('zmax')
```

