# Issue 21276: Package rst_to_ipynb

archive/issues_021276.json:
```json
{
    "body": "CC:  slabbe nthiery boussica vdelecroix\n\n`rst_to_ipynb` converts rst source to ipynb worksheet. Code will be added once #21512 is reviewed.\n\nIssue created by migration from https://trac.sagemath.org/ticket/21513\n\n",
    "created_at": "2016-09-16T23:18:46Z",
    "labels": [
        "packages: optional",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "Package rst_to_ipynb",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21276",
    "user": "tmonteil"
}
```
CC:  slabbe nthiery boussica vdelecroix

`rst_to_ipynb` converts rst source to ipynb worksheet. Code will be added once #21512 is reviewed.

Issue created by migration from https://trac.sagemath.org/ticket/21513





---

archive/issue_comments_295227.json:
```json
{
    "body": "Is this related to\nhttps://github.com/esc/rst2ipynb\nor to\nhttps://github.com/ariddell/rst2ipynb\n?",
    "created_at": "2016-09-26T15:20:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295227",
    "user": "slabbe"
}
```

Is this related to
https://github.com/esc/rst2ipynb
or to
https://github.com/ariddell/rst2ipynb
?



---

archive/issue_comments_295228.json:
```json
{
    "body": "Or do you have https://github.com/nthiery/rst-to-ipynb in mind?\n\nSee also https://github.com/aaren/notedown/issues/33",
    "created_at": "2016-09-27T16:09:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295228",
    "user": "slelievre"
}
```

Or do you have https://github.com/nthiery/rst-to-ipynb in mind?

See also https://github.com/aaren/notedown/issues/33



---

archive/issue_comments_295229.json:
```json
{
    "body": "Replying to [comment:4 slelievre]:\n> Or do you have https://github.com/nthiery/rst-to-ipynb in mind?\n\nIndeed. But i proposed some changes to allow tables to be correctly displayed and the possiblity to tune the jupyter kernel (we need the sagemath one), now i have to wait that the repository get stablized again to push my changes on this ticket with the most recent version/hash, in particular, the work is not licensed yet, and should become BSD-3clause in case jupyter wants to include it.",
    "created_at": "2016-09-28T12:00:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295229",
    "user": "tmonteil"
}
```

Replying to [comment:4 slelievre]:
> Or do you have https://github.com/nthiery/rst-to-ipynb in mind?

Indeed. But i proposed some changes to allow tables to be correctly displayed and the possiblity to tune the jupyter kernel (we need the sagemath one), now i have to wait that the repository get stablized again to push my changes on this ticket with the most recent version/hash, in particular, the work is not licensed yet, and should become BSD-3clause in case jupyter wants to include it.



---

archive/issue_comments_295230.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-09-29T22:47:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295230",
    "user": "tmonteil"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_295231.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-09-29T22:47:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295231",
    "user": "tmonteil"
}
```

New commits:



---

archive/issue_comments_295232.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-30T16:03:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295232",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_295233.json:
```json
{
    "body": "As suggested by Samuel by email, the name of the upstream package is `rst-to-ipynb`, with scores.",
    "created_at": "2016-09-30T16:04:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295233",
    "user": "tmonteil"
}
```

As suggested by Samuel by email, the name of the upstream package is `rst-to-ipynb`, with scores.



---

archive/issue_comments_295234.json:
```json
{
    "body": "ping ?",
    "created_at": "2016-11-08T07:29:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295234",
    "user": "tmonteil"
}
```

ping ?



---

archive/issue_comments_295235.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-11-08T09:51:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295235",
    "user": "slabbe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_295236.json:
```json
{
    "body": "After downloading the zip file into upstream directory, both make `rst-to-ipynb` and `sage -f rst-to-ipynb` fail:\n\n\n```\n$ sage -f rst-to-ipynb\nmake build/make/Makefile\nmake[1]\u00a0: on entre dans le r\u00e9pertoire \u00ab\u00a0/home/labbe/Applications/sage-git\u00a0\u00bb\nmake[1]: \u00ab\u00a0build/make/Makefile\u00a0\u00bb est \u00e0 jour.\nmake[1]\u00a0: on quitte le r\u00e9pertoire \u00ab\u00a0/home/labbe/Applications/sage-git\u00a0\u00bb\nbuild/bin/sage-logger \\\n\t\"cd build/make && ./install 'all-toolchain'\" logs/install.log\nNothing to (re)build / all up-to-date.\n\nError: package 'rst-to-ipynb' not found\nAssuming it is an old-style package... (this is deprecated: use -p instead of -i to install old-style packages)\n\nAttempting to download package rst-to-ipynb\n>>> Checking online list of optional packages.\n>>> Checking online list of experimental packages.\n>>> Checking online list of huge packages.\nError: could not find a package matching rst-to-ipynb\n       Try 'sage --package list' to see the available packages\n       Did you mean: rst_to_ipynb?\n```\n",
    "created_at": "2016-11-08T09:51:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295236",
    "user": "slabbe"
}
```

After downloading the zip file into upstream directory, both make `rst-to-ipynb` and `sage -f rst-to-ipynb` fail:


```
$ sage -f rst-to-ipynb
make build/make/Makefile
make[1] : on entre dans le répertoire « /home/labbe/Applications/sage-git »
make[1]: « build/make/Makefile » est à jour.
make[1] : on quitte le répertoire « /home/labbe/Applications/sage-git »
build/bin/sage-logger \
	"cd build/make && ./install 'all-toolchain'" logs/install.log
Nothing to (re)build / all up-to-date.

Error: package 'rst-to-ipynb' not found
Assuming it is an old-style package... (this is deprecated: use -p instead of -i to install old-style packages)

Attempting to download package rst-to-ipynb
>>> Checking online list of optional packages.
>>> Checking online list of experimental packages.
>>> Checking online list of huge packages.
Error: could not find a package matching rst-to-ipynb
       Try 'sage --package list' to see the available packages
       Did you mean: rst_to_ipynb?
```




---

archive/issue_comments_295237.json:
```json
{
    "body": "Also `make rst_to_ipynb` fail:\n\n\n```\n[rst_to_ipynb-fd58cd03] Found local metadata for rst_to_ipynb-fd58cd03\n[rst_to_ipynb-fd58cd03] Attempting to download package rst_to_ipynb-fd58cd03.zip from mirrors\n[rst_to_ipynb-fd58cd03] http://www.mirrorservice.org/sites/www.sagemath.org/spkg/upstream/rst_to_ipynb/rst_to_ipynb-fd58cd03.zip\n[rst_to_ipynb-fd58cd03] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]\n[rst_to_ipynb-fd58cd03] ERROR [transfer|run:135]: [Errno 404] Not Found: '//www.mirrorservice.org/sites/www.sagemath.org/spkg/upstream/rst_to_ipynb/rst_to_ipynb-fd58cd03.zip'\n[rst_to_ipynb-fd58cd03] http://www-ftp.lip6.fr/pub/math/sagemath/spkg/upstream/rst_to_ipynb/rst_to_ipynb-fd58cd03.zip\n[rst_to_ipynb-fd58cd03] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]\n[rst_to_ipynb-fd58cd03] ERROR [transfer|run:135]: [Errno 404] Not Found: '//www-ftp.lip6.fr/pub/math/sagemath/spkg/upstream/rst_to_ipynb/rst_to_ipynb-fd58cd03.zip'\n\n...\n```\n",
    "created_at": "2016-11-08T10:03:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295237",
    "user": "slabbe"
}
```

Also `make rst_to_ipynb` fail:


```
[rst_to_ipynb-fd58cd03] Found local metadata for rst_to_ipynb-fd58cd03
[rst_to_ipynb-fd58cd03] Attempting to download package rst_to_ipynb-fd58cd03.zip from mirrors
[rst_to_ipynb-fd58cd03] http://www.mirrorservice.org/sites/www.sagemath.org/spkg/upstream/rst_to_ipynb/rst_to_ipynb-fd58cd03.zip
[rst_to_ipynb-fd58cd03] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[rst_to_ipynb-fd58cd03] ERROR [transfer|run:135]: [Errno 404] Not Found: '//www.mirrorservice.org/sites/www.sagemath.org/spkg/upstream/rst_to_ipynb/rst_to_ipynb-fd58cd03.zip'
[rst_to_ipynb-fd58cd03] http://www-ftp.lip6.fr/pub/math/sagemath/spkg/upstream/rst_to_ipynb/rst_to_ipynb-fd58cd03.zip
[rst_to_ipynb-fd58cd03] [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
[rst_to_ipynb-fd58cd03] ERROR [transfer|run:135]: [Errno 404] Not Found: '//www-ftp.lip6.fr/pub/math/sagemath/spkg/upstream/rst_to_ipynb/rst_to_ipynb-fd58cd03.zip'

...
```




---

archive/issue_comments_295238.json:
```json
{
    "body": "The description of the ticket should be updated: scores vs underscores.\n\nCan you add information in the ticket how I should use that package? Inside sage? Inside `sage -sh`? Using `sage -rst2ipynb` ? What command should I type?",
    "created_at": "2016-11-08T10:09:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295238",
    "user": "slabbe"
}
```

The description of the ticket should be updated: scores vs underscores.

Can you add information in the ticket how I should use that package? Inside sage? Inside `sage -sh`? Using `sage -rst2ipynb` ? What command should I type?



---

archive/issue_comments_295239.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-11-08T10:31:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295239",
    "user": "tmonteil"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_295240.json:
```json
{
    "body": "The ticket description said that the zipball should be renamed as `rst_to_ipynb-fd58cd03.zip` or directly downloaded from my homepage, anyway i updated the description to be more explicit and added hints for testing the package.",
    "created_at": "2016-11-08T10:31:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295240",
    "user": "tmonteil"
}
```

The ticket description said that the zipball should be renamed as `rst_to_ipynb-fd58cd03.zip` or directly downloaded from my homepage, anyway i updated the description to be more explicit and added hints for testing the package.



---

archive/issue_comments_295241.json:
```json
{
    "body": "Thanks for the info. I forgot about #21514.\n\nI managed to run `make rst_to_ipynb` succesfully from scratch on another machine.\n\nI did some testing... Sage blocks like the following works great:\n\n\n```\nsage: 4+4\n8\nsage: for i in range(5):\n....:     print i\n0\n1\n2\n3\n4\n```\n\n\nThey are translated into one input block + one output block. Great.\n\nI get a problem with\n\n\n```\n>>> 4+4\n8\n>>> for i in range(5):\n...     print i\n0\n1\n2\n3\n4\n```\n\n\nwhich get written into one input block. Is it possible to patch Nicolas Thi\u00e9ry package?",
    "created_at": "2016-11-08T10:57:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295241",
    "user": "slabbe"
}
```

Thanks for the info. I forgot about #21514.

I managed to run `make rst_to_ipynb` succesfully from scratch on another machine.

I did some testing... Sage blocks like the following works great:


```
sage: 4+4
8
sage: for i in range(5):
....:     print i
0
1
2
3
4
```


They are translated into one input block + one output block. Great.

I get a problem with


```
>>> 4+4
8
>>> for i in range(5):
...     print i
0
1
2
3
4
```


which get written into one input block. Is it possible to patch Nicolas Thiéry package?



---

archive/issue_comments_295242.json:
```json
{
    "body": "Replying to [comment:15 slabbe]:\n[...]\n> I get a problem with\n> \n> {{{\n> >>> 4+4\n> 8\n> >>> for i in range(5):\n> ...     print i\n> 0\n> 1\n> 2\n> 3\n> 4\n> }}}\n> \n> which get written into one input block. Is it possible to patch Nicolas Thi\u00e9ry package?\n\nI hope so ! Just make patch a send him a pull-request. I did that already to be able to define the kernel (so that the `sage -rst2ipynb` command builds sagemath worksheets), and to fix malformatted tables.",
    "created_at": "2016-11-10T14:36:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295242",
    "user": "tmonteil"
}
```

Replying to [comment:15 slabbe]:
[...]
> I get a problem with
> 
> {{{
> >>> 4+4
> 8
> >>> for i in range(5):
> ...     print i
> 0
> 1
> 2
> 3
> 4
> }}}
> 
> which get written into one input block. Is it possible to patch Nicolas Thiéry package?

I hope so ! Just make patch a send him a pull-request. I did that already to be able to define the kernel (so that the `sage -rst2ipynb` command builds sagemath worksheets), and to fix malformatted tables.



---

archive/issue_comments_295243.json:
```json
{
    "body": "Ok! I will do this probably next week during the sage days.\n\nQuestion maybe for Nicolas. Should I patch the `sageblockfilter.py` file or should I create a new file `pythonblockfilter.py` ?",
    "created_at": "2016-11-17T15:50:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295243",
    "user": "slabbe"
}
```

Ok! I will do this probably next week during the sage days.

Question maybe for Nicolas. Should I patch the `sageblockfilter.py` file or should I create a new file `pythonblockfilter.py` ?



---

archive/issue_comments_295244.json:
```json
{
    "body": "Please note that contributing to `rst-to-ipynb` is independent of the current ticket, which is about packaging it. It would be nice to have `sage -rst2ipynb` available soon for everyone (it is ready for almost 3 months now).\n\nNote also that such a sage command should make your own development of `rst-to-ipynb` easier ;) (i used it massively for scripting the build of tutorials last month, it is very handy).",
    "created_at": "2016-11-20T12:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295244",
    "user": "tmonteil"
}
```

Please note that contributing to `rst-to-ipynb` is independent of the current ticket, which is about packaging it. It would be nice to have `sage -rst2ipynb` available soon for everyone (it is ready for almost 3 months now).

Note also that such a sage command should make your own development of `rst-to-ipynb` easier ;) (i used it massively for scripting the build of tutorials last month, it is very handy).



---

archive/issue_comments_295245.json:
```json
{
    "body": "Hi S\u00e9bastien,\n\nShall we have a small sprint on this this week?\n\nCheers,\n                                Nicolas",
    "created_at": "2016-11-20T19:23:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295245",
    "user": "nthiery"
}
```

Hi Sébastien,

Shall we have a small sprint on this this week?

Cheers,
                                Nicolas



---

archive/issue_comments_295246.json:
```json
{
    "body": "Hi Thierry,\n\nAdrien tried to use rst-to-ipynb by cloning the repo; that was painful\nto use for him (getting the dependencies, ...). So I ended up making\nit into a proper Python/pip package, which installs the conversion\nscript. While I am at it, I might as well upload the package on pipy\n(planning to do this tomorrow).\n\nAt this stage, the script is called rst2ipynb for consistency with\n`sage -rst2ipynb` and many existing `rst2xxx` converters.\n\nQuestions:\n- Should the pip package be called rst2ipynb or rst-to-ipynb?\n- In the former case, should the github repo be renamed rst2ipynb?\n- Once we have a proper pip package on pipy, do we need a Sage package?\n  (if no, sorry for the lack of sync; we could have saved the writing\n  of this package).\n\nCheers,\n      Nicolas",
    "created_at": "2016-11-22T21:31:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295246",
    "user": "nthiery"
}
```

Hi Thierry,

Adrien tried to use rst-to-ipynb by cloning the repo; that was painful
to use for him (getting the dependencies, ...). So I ended up making
it into a proper Python/pip package, which installs the conversion
script. While I am at it, I might as well upload the package on pipy
(planning to do this tomorrow).

At this stage, the script is called rst2ipynb for consistency with
`sage -rst2ipynb` and many existing `rst2xxx` converters.

Questions:
- Should the pip package be called rst2ipynb or rst-to-ipynb?
- In the former case, should the github repo be renamed rst2ipynb?
- Once we have a proper pip package on pipy, do we need a Sage package?
  (if no, sorry for the lack of sync; we could have saved the writing
  of this package).

Cheers,
      Nicolas



---

archive/issue_comments_295247.json:
```json
{
    "body": "Let me just remind that Sage is a collective effort, which aims to share the development of common features in order to focus on the code specific to our own research.\n\nAll the `sage -rst2ipynb` stuff (packaging, scripting,...) is ready for 3 months now (i wrote those in August during https://wiki.sagemath.org/days75).\n\nIf, instead of trying alternate/duplicate ways to install it painlessly, those tickets had been reviewed, `sage -rst2ipynb` command would have been in Sage 7.4 already and Adrien would not even have had to clone anything nor to suffer some dependencies issues, because some Sage developers (myself and the reviewers) would have taken care of this once for all.\n\nNow, could please someone review the last 2 tickets (this one and #21514 that i will push over this branch after it is reviewed) so that `sage -rst2ipynb` command will be available to every Sage user in the next release, which might end up in real-life interesting feature requests and useful improvements.\n\nI presume Sebastien noticed the `>>>` issue because he used the package on a concrete use case that led to errors. The rst-to-ipynb package development will benefit from its easy availability to every Sage users, each with their specific workflow.\n\n----\n\nThat said, regarding pip installation, there are two very different things: having rst-to-ipynb being pip-installable, and having it hosted/mirrored on PyPI.\n\nIf you write a convenient setup.py script, we could modify the spkg-install script to use the pip command for the install. But please do not condition the review of this ticket to that, plan it for 7.6 instead, or earlier if the last 2 ticket get merged soon.\n\nNow, regarding fetching from PyPI for Sage, it is another story, since rst-yo-ipynb depends on notedown and pandoc_attributes, whose versions on PyPI are bitroting a lot behind the github source from which the Sage packages are built. Changes since the last PyPI update (more than 1+1/2 year) include Python3 support and various fixes.\n\nIf you have enough free time for not only creating, but also being commited to maintaining a PyPI rst-to-ipynb package indefinitely, it is definitely interesting.\n\nIt could even replace the current spkgs on the longer run, but it requires first to pressure notedown/pandoc_attributes dev to also update his PyPI repositories, and probably he does not have much time for this.\n\nMoreover, regarding the development of rst-to-ipynb, i guess it is better to develop and test it against the latest versions of its dependencies, and not the PyPI ones, since in case of an upstream problem, it is much more doable to obtain a pull than to obtain a new PyPI release.\n\nThat said, having a somehow degraded (because of older dependencies) version on PyPI could be interesting for non-Sage users, but it would currently be a loss for Sage, and since the packaging work with up-to-date dependencies is done anyway, i do not see any benefit in relying on older Python3 incompatible versions.\n\nThis is only a very personal suggestion, but if i had such free time, i would better work on having a rst2ipynb feature being part of Jupyter (which is why i promoted the licensing of rst-to-ipynb to be the same as the jupyter one), so that it will be much more maintained, widely tested, used in different contexts, hence improved. It would perhaps imply finding a non-pandoc way to do the conversion, i am not sure.\n\nRegarding the naming scheme, it is not very important, and certainly not imposed by the `sage -rst2ipynb` command name, since this later needs a dedicated script anyway (being interfaced with the `sage` command and specifying the Sage kernel).\n\nPlease, let us focus on having a public working `sage -rst2ipynb` command first. It is a key step for a lossless sagenb to jupyter migration.",
    "created_at": "2016-11-23T00:33:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295247",
    "user": "tmonteil"
}
```

Let me just remind that Sage is a collective effort, which aims to share the development of common features in order to focus on the code specific to our own research.

All the `sage -rst2ipynb` stuff (packaging, scripting,...) is ready for 3 months now (i wrote those in August during https://wiki.sagemath.org/days75).

If, instead of trying alternate/duplicate ways to install it painlessly, those tickets had been reviewed, `sage -rst2ipynb` command would have been in Sage 7.4 already and Adrien would not even have had to clone anything nor to suffer some dependencies issues, because some Sage developers (myself and the reviewers) would have taken care of this once for all.

Now, could please someone review the last 2 tickets (this one and #21514 that i will push over this branch after it is reviewed) so that `sage -rst2ipynb` command will be available to every Sage user in the next release, which might end up in real-life interesting feature requests and useful improvements.

I presume Sebastien noticed the `>>>` issue because he used the package on a concrete use case that led to errors. The rst-to-ipynb package development will benefit from its easy availability to every Sage users, each with their specific workflow.

----

That said, regarding pip installation, there are two very different things: having rst-to-ipynb being pip-installable, and having it hosted/mirrored on PyPI.

If you write a convenient setup.py script, we could modify the spkg-install script to use the pip command for the install. But please do not condition the review of this ticket to that, plan it for 7.6 instead, or earlier if the last 2 ticket get merged soon.

Now, regarding fetching from PyPI for Sage, it is another story, since rst-yo-ipynb depends on notedown and pandoc_attributes, whose versions on PyPI are bitroting a lot behind the github source from which the Sage packages are built. Changes since the last PyPI update (more than 1+1/2 year) include Python3 support and various fixes.

If you have enough free time for not only creating, but also being commited to maintaining a PyPI rst-to-ipynb package indefinitely, it is definitely interesting.

It could even replace the current spkgs on the longer run, but it requires first to pressure notedown/pandoc_attributes dev to also update his PyPI repositories, and probably he does not have much time for this.

Moreover, regarding the development of rst-to-ipynb, i guess it is better to develop and test it against the latest versions of its dependencies, and not the PyPI ones, since in case of an upstream problem, it is much more doable to obtain a pull than to obtain a new PyPI release.

That said, having a somehow degraded (because of older dependencies) version on PyPI could be interesting for non-Sage users, but it would currently be a loss for Sage, and since the packaging work with up-to-date dependencies is done anyway, i do not see any benefit in relying on older Python3 incompatible versions.

This is only a very personal suggestion, but if i had such free time, i would better work on having a rst2ipynb feature being part of Jupyter (which is why i promoted the licensing of rst-to-ipynb to be the same as the jupyter one), so that it will be much more maintained, widely tested, used in different contexts, hence improved. It would perhaps imply finding a non-pandoc way to do the conversion, i am not sure.

Regarding the naming scheme, it is not very important, and certainly not imposed by the `sage -rst2ipynb` command name, since this later needs a dedicated script anyway (being interfaced with the `sage` command and specifying the Sage kernel).

Please, let us focus on having a public working `sage -rst2ipynb` command first. It is a key step for a lossless sagenb to jupyter migration.



---

archive/issue_comments_295248.json:
```json
{
    "body": "Salut Thierry,\n\nWith S\u00e9bastien, we are precisely in the process of reviewing this\nticket and its `sage -rst2ipynb` counterpart, with goal to get it done\nhopefully today. That's what led me to try first a manual install of\nrst2ipynb, and realize it was even more messy than I thought. Making\nit pip installable / a pipy package is part of that collective effort\nto work with upstream and write stuff useful to the larger community :-)\n\nI agree, it would have been more productive to discuss earlier on the\nbest approach for packaging.\n\nThanks for pointing out the caveat about the outdated versions of\nnotedown on pipy. Plus the necessity to pass down extra arguments for\nthe kernel. This is indeed a good reason to have a sage package, at\nleast for now.\n\nMy plan:\n- Do tiny further edits to rst2ipynb, and make an \"official release\".\n  (it's already pip installable)\n- Release it on pipy (that's cheap anyway)\n- Update the Sage package to use pip to install it from a source clone.\n\nFor the long run: having a reST to ipynb converter under the Jupyter\numbrella would indeed be best. The current pandoc+notedown approach is\nreaching its limits (e.g. for handling cross references, in particular\nfor multi-file documents). I believe more in a Sphinx-based\napproach. In a discussion with the Jupyter dev, they pointed out that\npandoc was a heavy dependency, and that Sphinx also looked better to\nthat respect.\n\nCheers,\n                                   Nicolas",
    "created_at": "2016-11-23T07:07:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295248",
    "user": "nthiery"
}
```

Salut Thierry,

With Sébastien, we are precisely in the process of reviewing this
ticket and its `sage -rst2ipynb` counterpart, with goal to get it done
hopefully today. That's what led me to try first a manual install of
rst2ipynb, and realize it was even more messy than I thought. Making
it pip installable / a pipy package is part of that collective effort
to work with upstream and write stuff useful to the larger community :-)

I agree, it would have been more productive to discuss earlier on the
best approach for packaging.

Thanks for pointing out the caveat about the outdated versions of
notedown on pipy. Plus the necessity to pass down extra arguments for
the kernel. This is indeed a good reason to have a sage package, at
least for now.

My plan:
- Do tiny further edits to rst2ipynb, and make an "official release".
  (it's already pip installable)
- Release it on pipy (that's cheap anyway)
- Update the Sage package to use pip to install it from a source clone.

For the long run: having a reST to ipynb converter under the Jupyter
umbrella would indeed be best. The current pandoc+notedown approach is
reaching its limits (e.g. for handling cross references, in particular
for multi-file documents). I believe more in a Sphinx-based
approach. In a discussion with the Jupyter dev, they pointed out that
pandoc was a heavy dependency, and that Sphinx also looked better to
that respect.

Cheers,
                                   Nicolas



---

archive/issue_comments_295249.json:
```json
{
    "body": "rst2ipynb 0.2.1 \"released\" and uploaded on pipy: https://pypi.python.org/pypi/rst2ipynb/0.2.1",
    "created_at": "2016-11-23T07:52:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295249",
    "user": "nthiery"
}
```

rst2ipynb 0.2.1 "released" and uploaded on pipy: https://pypi.python.org/pypi/rst2ipynb/0.2.1



---

archive/issue_comments_295250.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-11-23T09:40:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295250",
    "user": "nthiery"
}
```

New commits:



---

archive/issue_comments_295251.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-11-23T09:40:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295251",
    "user": "nthiery"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_295252.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-23T09:57:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295252",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_295253.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-11-23T09:58:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295253",
    "user": "nthiery"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_295254.json:
```json
{
    "body": "Done! Thierry, S\u00e9bastien, do you mind reviewing my changes?\n\nI am now moving on to #21514.",
    "created_at": "2016-11-23T09:58:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295254",
    "user": "nthiery"
}
```

Done! Thierry, Sébastien, do you mind reviewing my changes?

I am now moving on to #21514.



---

archive/issue_comments_295255.json:
```json
{
    "body": "Not sure whether I should be author or reviewer here :-)",
    "created_at": "2016-11-23T10:01:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295255",
    "user": "nthiery"
}
```

Not sure whether I should be author or reviewer here :-)



---

archive/issue_comments_295256.json:
```json
{
    "body": "The way you did the refactor lost all the history so it is hard to see what changed, you should use `git mv` command, then modify the files, then `git add` command.\n\nI have to recompile parts of Sage, so the rest might take time.",
    "created_at": "2016-11-23T10:32:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295256",
    "user": "tmonteil"
}
```

The way you did the refactor lost all the history so it is hard to see what changed, you should use `git mv` command, then modify the files, then `git add` command.

I have to recompile parts of Sage, so the rest might take time.



---

archive/issue_comments_295257.json:
```json
{
    "body": "I am sorry that I was late at working on this ticket this Fall.\n\nI agree to postpone the fix of `>>>` blocks to a later release of rst2ipynb.\n\nI intend to review this ticket so that it gets a positive review *during* Sage Days 79.\n\nReplying to [comment:30 tmonteil]:\n> The way you did the refactor lost all the history so it is hard to see what changed, you should use `git mv` command, then modify the files, then `git add` command.\n\n+1\n\nNicolas, can you redo your last commit and use `git mv` instead (you will need to `git push -f` your new branch: whatever).",
    "created_at": "2016-11-23T13:28:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295257",
    "user": "slabbe"
}
```

I am sorry that I was late at working on this ticket this Fall.

I agree to postpone the fix of `>>>` blocks to a later release of rst2ipynb.

I intend to review this ticket so that it gets a positive review *during* Sage Days 79.

Replying to [comment:30 tmonteil]:
> The way you did the refactor lost all the history so it is hard to see what changed, you should use `git mv` command, then modify the files, then `git add` command.

+1

Nicolas, can you redo your last commit and use `git mv` instead (you will need to `git push -f` your new branch: whatever).



---

archive/issue_comments_295258.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-11-23T15:04:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295258",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_295259.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-11-23T21:33:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295259",
    "user": "slabbe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_295260.json:
```json
{
    "body": "Changing keywords from \"\" to \"days79\".",
    "created_at": "2016-11-23T21:33:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295260",
    "user": "slabbe"
}
```

Changing keywords from "" to "days79".



---

archive/issue_comments_295261.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-11-27T16:46:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21276#issuecomment-295261",
    "user": "vbraun"
}
```

Resolution: fixed
