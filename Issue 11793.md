# Issue 11793: OS X 10.7 Lion: Error building sage.misc.darwin_utilities extension

archive/issues_011793.json:
```json
{
    "body": "Assignee: drkirkby\n\nBuilding the sage.misc.darwin_utilities fails on OS X 10.7.2 with gcc-4.2.1 (build 5658) using XCode 4.\n\n\n```\ndeep:sage wstein$ export MAKE=\"make -j1\"\ndeep:sage wstein$ sage -br\n\n----------------------------------------------------------\nsage: Building and installing modified Sage library files.\n\n\nInstalling c_lib\nscons: `install' is up to date.\nUpdating Cython code....\nTime to execute 0 commands: 0.0105319023132 seconds\nFinished compiling Cython code (time = 0.939815998077 seconds)\nrunning install\nrunning build\nrunning build_py\nrunning build_ext\nbuilding 'sage.misc.darwin_utilities' extension\ngcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -I/Users/wstein/sage/install/sage-4.7.3.alpha1/local/include -I/Users/wstein/sage/install/sage-4.7.3.alpha1/local/include/csage -I/Users/wstein/sage/install/sage-4.7.3.alpha1/devel/sage/sage/ext -I/Users/wstein/sage/install/sage-4.7.3.alpha1/local/include/python2.6 -c sage/misc/darwin_memory_usage.c -o build/temp.macosx-10.7-x86_64-2.6/sage/misc/darwin_memory_usage.o -w\nIn file included from sage/misc/darwin_memory_usage.c:4:\n/usr/include/mach/task_info.h:252: error: expected specifier-qualifier-list before \u2018vm_extmod_statistics_data_t\u2019\nerror: command 'gcc' failed with exit status 1\nsage: There was an error installing modified sage library code.\n\n\n\ndeep:sage wstein$ gcc -v\nUsing built-in specs.\nTarget: i686-apple-darwin11\n...\ngcc version 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2335.15.00)\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/11965\n\n",
    "created_at": "2011-10-31T06:30:34Z",
    "labels": [
        "component: porting",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.8",
    "title": "OS X 10.7 Lion: Error building sage.misc.darwin_utilities extension",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11793",
    "user": "https://github.com/williamstein"
}
```
Assignee: drkirkby

Building the sage.misc.darwin_utilities fails on OS X 10.7.2 with gcc-4.2.1 (build 5658) using XCode 4.


```
deep:sage wstein$ export MAKE="make -j1"
deep:sage wstein$ sage -br

----------------------------------------------------------
sage: Building and installing modified Sage library files.


Installing c_lib
scons: `install' is up to date.
Updating Cython code....
Time to execute 0 commands: 0.0105319023132 seconds
Finished compiling Cython code (time = 0.939815998077 seconds)
running install
running build
running build_py
running build_ext
building 'sage.misc.darwin_utilities' extension
gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -I/Users/wstein/sage/install/sage-4.7.3.alpha1/local/include -I/Users/wstein/sage/install/sage-4.7.3.alpha1/local/include/csage -I/Users/wstein/sage/install/sage-4.7.3.alpha1/devel/sage/sage/ext -I/Users/wstein/sage/install/sage-4.7.3.alpha1/local/include/python2.6 -c sage/misc/darwin_memory_usage.c -o build/temp.macosx-10.7-x86_64-2.6/sage/misc/darwin_memory_usage.o -w
In file included from sage/misc/darwin_memory_usage.c:4:
/usr/include/mach/task_info.h:252: error: expected specifier-qualifier-list before ‘vm_extmod_statistics_data_t’
error: command 'gcc' failed with exit status 1
sage: There was an error installing modified sage library code.



deep:sage wstein$ gcc -v
Using built-in specs.
Target: i686-apple-darwin11
...
gcc version 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2335.15.00)
```


Issue created by migration from https://trac.sagemath.org/ticket/11965





---

archive/issue_comments_134489.json:
```json
{
    "body": "I got this module to build by simply commenting out the line that was importing something that is now not allowed.   With this one fix the Sage-4.7.3.alpha1 library builds!",
    "created_at": "2011-10-31T06:37:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11793#issuecomment-134489",
    "user": "https://github.com/williamstein"
}
```

I got this module to build by simply commenting out the line that was importing something that is now not allowed.   With this one fix the Sage-4.7.3.alpha1 library builds!



---

archive/issue_comments_134490.json:
```json
{
    "body": "Incidentally, getting rid of that #include does not break building on OS X 10.6, so it is likely safe.",
    "created_at": "2011-10-31T06:43:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11793#issuecomment-134490",
    "user": "https://github.com/williamstein"
}
```

Incidentally, getting rid of that #include does not break building on OS X 10.6, so it is likely safe.



---

archive/issue_comments_134491.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-10-31T06:44:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11793#issuecomment-134491",
    "user": "https://github.com/williamstein"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_134492.json:
```json
{
    "body": "Attachment [trac_11965.patch](tarball://root/attachments/some-uuid/ticket11965/trac_11965.patch) by @williamstein created at 2011-10-31 06:44:52",
    "created_at": "2011-10-31T06:44:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11793#issuecomment-134492",
    "user": "https://github.com/williamstein"
}
```

Attachment [trac_11965.patch](tarball://root/attachments/some-uuid/ticket11965/trac_11965.patch) by @williamstein created at 2011-10-31 06:44:52



---

archive/issue_comments_134493.json:
```json
{
    "body": "Milestone sage-4.7.3 deleted",
    "created_at": "2011-11-03T16:14:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11793#issuecomment-134493",
    "user": "https://github.com/jdemeyer"
}
```

Milestone sage-4.7.3 deleted



---

archive/issue_events_031670.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-10T13:31:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11793",
    "milestone": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11793#event-31670"
}
```



---

archive/issue_comments_134494.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2011-11-10T13:31:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11793#issuecomment-134494",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from major to blocker.



---

archive/issue_events_031671.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-14T21:50:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11793",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11793#event-31671"
}
```



---

archive/issue_comments_134495.json:
```json
{
    "body": "Works for me on OS X 10.4 PPC.  With William's claim that it also works on 10.6 and 10.7, I give it a positive_review.",
    "created_at": "2011-11-14T21:50:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11793#issuecomment-134495",
    "user": "https://github.com/jdemeyer"
}
```

Works for me on OS X 10.4 PPC.  With William's claim that it also works on 10.6 and 10.7, I give it a positive_review.



---

archive/issue_comments_134496.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-11-14T21:50:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11793",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11793#issuecomment-134496",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
