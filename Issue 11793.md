# Issue 11793: OS X 10.7 Lion: Error building sage.misc.darwin_utilities extension

Issue created by migration from Trac.

Original creator: was

Original creation time: 2011-10-31 06:30:34

Assignee: drkirkby

Building the sage.misc.darwin_utilities fails on OS X 10.7.2 with gcc-4.2.1 (build 5658) using XCode 4.


```
deep:sage wstein$ export MAKE="make -j1"
deep:sage wstein$ sage -br

----------------------------------------------------------
sage: Building and installing modified Sage library files.


Installing c_lib
scons: `install' is up to date.
Updating Cython code....
Time to execute 0 commands: 0.0105319023132 seconds
Finished compiling Cython code (time = 0.939815998077 seconds)
running install
running build
running build_py
running build_ext
building 'sage.misc.darwin_utilities' extension
gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -I/Users/wstein/sage/install/sage-4.7.3.alpha1/local/include -I/Users/wstein/sage/install/sage-4.7.3.alpha1/local/include/csage -I/Users/wstein/sage/install/sage-4.7.3.alpha1/devel/sage/sage/ext -I/Users/wstein/sage/install/sage-4.7.3.alpha1/local/include/python2.6 -c sage/misc/darwin_memory_usage.c -o build/temp.macosx-10.7-x86_64-2.6/sage/misc/darwin_memory_usage.o -w
In file included from sage/misc/darwin_memory_usage.c:4:
/usr/include/mach/task_info.h:252: error: expected specifier-qualifier-list before ‘vm_extmod_statistics_data_t’
error: command 'gcc' failed with exit status 1
sage: There was an error installing modified sage library code.



deep:sage wstein$ gcc -v
Using built-in specs.
Target: i686-apple-darwin11
...
gcc version 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2335.15.00)
```



---

Comment by was created at 2011-10-31 06:37:14

I got this module to build by simply commenting out the line that was importing something that is now not allowed.   With this one fix the Sage-4.7.3.alpha1 library builds!


---

Comment by was created at 2011-10-31 06:43:03

Incidentally, getting rid of that #include does not break building on OS X 10.6, so it is likely safe.


---

Comment by was created at 2011-10-31 06:44:52

Changing status from new to needs_review.


---

Attachment


---

Comment by jdemeyer created at 2011-11-03 16:14:43

Milestone sage-4.7.3 deleted


---

Comment by jdemeyer created at 2011-11-10 13:31:16

Changing priority from major to blocker.


---

Comment by jdemeyer created at 2011-11-14 21:50:45

Works for me on OS X 10.4 PPC.  With William's claim that it also works on 10.6 and 10.7, I give it a positive_review.


---

Comment by jdemeyer created at 2011-11-14 21:50:45

Resolution: fixed
