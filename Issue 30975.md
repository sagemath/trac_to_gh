# Issue 30975: fix submonoid method when the generating set include the identity

Issue created by migration from https://trac.sagemath.org/ticket/31212

Original creator: saliola

Original creation time: 2021-01-08 19:56:03

CC:  zabrocki aschilling

Keywords: submonoid, monoid, semigroups

Fix the `submonoid` method so that we don't get two copies of the identity element when the generating set already includes the identity element.

```
sage: R = IntegerModRing(15)
sage: R.submonoid([R.one()]).list()         # this should be [1]
[1, 1]

sage: S = SymmetricGroup(4)
sage: S.submonoid([S.one()]).list()         # this should be [()]
[(), ()]

sage: S = SymmetricGroup(4)
sage: S.submonoid(list(S)).cardinality()    # this should be 24
25
```



---

Comment by chapoton created at 2021-01-09 19:42:41

Changing status from new to needs_review.


---

Comment by chapoton created at 2021-01-09 19:42:41

New commits:


---

Comment by saliola created at 2021-01-09 20:11:09

Changing status from needs_review to positive_review.


---

Comment by saliola created at 2021-01-09 20:11:09

Salut Frédéric! Thanks so much for this quick fix and the other improvements to the surrounding code.


---

Comment by slelievre created at 2021-01-09 22:46:43

Does this also fix duplicate generators?

```
sage: S = SymmetricGroup(4)
sage: M = S.submonoid([S[3], S[3]])
sage: M
A subgroup of (Symmetric group of order 4! as a permutation group)
with 2 generators
sage: M.list()
[(), (1,2)(3,4), (1,2)(3,4)]
```


Using `OrderedDict`, or just `dict` once we drop Python 3.6 support,
could help. See:

- [Stack Overflow question 12897374: Get unique values from a list in Python](https://stackoverflow.com/questions/12897374)


---

Comment by vbraun created at 2021-01-24 10:37:27

Resolution: fixed
