# Issue 4606: elliptic curves -- implement gross-Zagier L-functions

archive/issues_004606.json:
```json
{
    "body": "Make it so one can do:\n\n```\nsage: e = EllipticCurve('37a')\nsage: K.<a> = QuadraticField(-40)\nsage: A = K.class_group().gen(0); A\nFractional ideal class (2, -1/2*a)\nsage: L = e.lseries_gross_zagier(A)  \nsage: L(1)\n0.000000000000000\nsage: L.taylor_series(1,5)\n0.000000000000000 - 5.51899839494458*z + 13.6297841350649*z^2 - 16.2292417817675*z^3 + 7.94788823722712*z^4 + O(z^5)\n```\nnobody had seen this!\n\n**CC:**  @williamstein @craigcitro @categorie\n\n**Branch/Commit:** [1c7df5572312affd88f2fbd074dad5f07b583efa](https://github.com/sagemath/sagetrac-mirror/commit/1c7df5572312affd88f2fbd074dad5f07b583efa)\n\n**Reviewer:** Chris Wuthrich\n\n**Author:** William Stein, Robert Bradshaw, Craig Citro\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/4606\n\n",
    "closed_at": "2015-06-29T22:31:25Z",
    "created_at": "2008-11-24T22:59:03Z",
    "labels": [
        "component: elliptic curves"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.8",
    "title": "elliptic curves -- implement gross-Zagier L-functions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/4606",
    "user": "https://github.com/robertwb"
}
```
Make it so one can do:

```
sage: e = EllipticCurve('37a')
sage: K.<a> = QuadraticField(-40)
sage: A = K.class_group().gen(0); A
Fractional ideal class (2, -1/2*a)
sage: L = e.lseries_gross_zagier(A)  
sage: L(1)
0.000000000000000
sage: L.taylor_series(1,5)
0.000000000000000 - 5.51899839494458*z + 13.6297841350649*z^2 - 16.2292417817675*z^3 + 7.94788823722712*z^4 + O(z^5)
```
nobody had seen this!

**CC:**  @williamstein @craigcitro @categorie

**Branch/Commit:** [1c7df5572312affd88f2fbd074dad5f07b583efa](https://github.com/sagemath/sagetrac-mirror/commit/1c7df5572312affd88f2fbd074dad5f07b583efa)

**Reviewer:** Chris Wuthrich

**Author:** William Stein, Robert Bradshaw, Craig Citro

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/4606





---

archive/issue_comments_040650.json:
```json
{
    "body": "Attachment [4606-gz-lseries.patch](tarball://root/attachments/some-uuid/ticket4606/4606-gz-lseries.patch) by @robertwb created at 2008-11-25 06:44:02",
    "created_at": "2008-11-25T06:44:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40650",
    "user": "https://github.com/robertwb"
}
```

Attachment [4606-gz-lseries.patch](tarball://root/attachments/some-uuid/ticket4606/4606-gz-lseries.patch) by @robertwb created at 2008-11-25 06:44:02



---

archive/issue_comments_040651.json:
```json
{
    "body": "<a id='comment:1'></a>\nStill going to add some doctests right now, but here's the code. Note, however, the check \\sum_A L_A(E,s) = L(E/K,s) fails. :(",
    "created_at": "2008-11-25T06:46:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40651",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:1'></a>
Still going to add some doctests right now, but here's the code. Note, however, the check \sum_A L_A(E,s) = L(E/K,s) fails. :(



---

archive/issue_comments_040652.json:
```json
{
    "body": "Attachment [4606-gz-doctests.patch](tarball://root/attachments/some-uuid/ticket4606/4606-gz-doctests.patch) by @robertwb created at 2008-11-25 08:17:14",
    "created_at": "2008-11-25T08:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40652",
    "user": "https://github.com/robertwb"
}
```

Attachment [4606-gz-doctests.patch](tarball://root/attachments/some-uuid/ticket4606/4606-gz-doctests.patch) by @robertwb created at 2008-11-25 08:17:14



---

archive/issue_comments_040653.json:
```json
{
    "body": "Attachment [trac-4606-pt3.patch](tarball://root/attachments/some-uuid/ticket4606/trac-4606-pt3.patch) by @craigcitro created at 2008-11-28 11:10:18",
    "created_at": "2008-11-28T11:10:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40653",
    "user": "https://github.com/craigcitro"
}
```

Attachment [trac-4606-pt3.patch](tarball://root/attachments/some-uuid/ticket4606/trac-4606-pt3.patch) by @craigcitro created at 2008-11-28 11:10:18



---

archive/issue_comments_040654.json:
```json
{
    "body": "<a id='comment:2'></a>\nSo I've attached a patch, which at least fixes a few issues. This patch fixes two definite bugs:\n\n* In `E.lseries_gross_zagier(A)`, you were caching the value -- no matter what value of `A` was getting passed in! That was an easy fix. :) Unfortunately, after fixing that, there were still issues. \n\n* There was a subtle issue in `I.quadratic_form()`, for `I` an ideal in a quadratic number field. For instance, with just the first two patches above, taking `K = QuadraticField(-40)` and `I` the trivial element in the class group, the code returned `x^2 + 40*y^2` for `I.quadratic_form()`. The underlying issue was one of choice of generators: you were using `K.gen()` where you really needed `K.ring_of_integers().gen()`, because you needed to know that something generated all of `I` over `ZZ`, not just `QQ`. I'm **fairly** certain that the current code is correct, but it's after 2AM, so someone should double check me. \n\nSo, now that those are fixed, we go back to the example Robert points out in the code: \n\n```\nsage: E = EllipticCurve('37a')\nsage: K.<a> = QuadraticField(-40)\nsage: A = K.class_group().gen(0)\nsage: L = E.lseries_gross_zagier(A)\nsage: LL = E.lseries_gross_zagier(A**2)\nsage: L(2) + LL(2)\n0.506799279512368\n\nsage: E.lseries()(2) * E.quadratic_twist(-40).lseries()(2)\n0.502803417587467\n```\n\nSo we're now quite close. In particular, I wonder if there isn't rounding going on:\n\n```\nsage: E.lseries().taylor_series(2,5) * E.quadratic_twist(-40).lseries().taylor_series(2,5)\n0.50 + 0.38*z - 0.16*z^2 + 0.0078*z^3 + 0.070*z^4 - 0.039*z^5 + O(z^6)\n```\n\nThat definitely seems to suggest small precision to me. In any event, we're getting close:\n\n```\nsage: L.taylor_series(2,5) + LL.taylor_series(2,5)\n0.506799279512368 + 0.360199571567893*z - 0.122141848388581*z^2 - 0.00635398874570253*z^3 + 0.0383995215484257*z^4 + O(z^5)\n\nsage: L.taylor_series(2,5) + LL.taylor_series(2,5) - (E.lseries().taylor_series(2,5) * E.quadratic_twist(-40).lseries().taylor_series(2,5))\n-0.016*z + 0.035*z^2 - 0.014*z^3 - 0.031*z^4 + O(z^5)\n```\n\nI'll cook up a few more examples and post what I find.",
    "created_at": "2008-11-28T11:38:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40654",
    "user": "https://github.com/craigcitro"
}
```

<a id='comment:2'></a>
So I've attached a patch, which at least fixes a few issues. This patch fixes two definite bugs:

* In `E.lseries_gross_zagier(A)`, you were caching the value -- no matter what value of `A` was getting passed in! That was an easy fix. :) Unfortunately, after fixing that, there were still issues. 

* There was a subtle issue in `I.quadratic_form()`, for `I` an ideal in a quadratic number field. For instance, with just the first two patches above, taking `K = QuadraticField(-40)` and `I` the trivial element in the class group, the code returned `x^2 + 40*y^2` for `I.quadratic_form()`. The underlying issue was one of choice of generators: you were using `K.gen()` where you really needed `K.ring_of_integers().gen()`, because you needed to know that something generated all of `I` over `ZZ`, not just `QQ`. I'm **fairly** certain that the current code is correct, but it's after 2AM, so someone should double check me. 

So, now that those are fixed, we go back to the example Robert points out in the code: 

```
sage: E = EllipticCurve('37a')
sage: K.<a> = QuadraticField(-40)
sage: A = K.class_group().gen(0)
sage: L = E.lseries_gross_zagier(A)
sage: LL = E.lseries_gross_zagier(A**2)
sage: L(2) + LL(2)
0.506799279512368

sage: E.lseries()(2) * E.quadratic_twist(-40).lseries()(2)
0.502803417587467
```

So we're now quite close. In particular, I wonder if there isn't rounding going on:

```
sage: E.lseries().taylor_series(2,5) * E.quadratic_twist(-40).lseries().taylor_series(2,5)
0.50 + 0.38*z - 0.16*z^2 + 0.0078*z^3 + 0.070*z^4 - 0.039*z^5 + O(z^6)
```

That definitely seems to suggest small precision to me. In any event, we're getting close:

```
sage: L.taylor_series(2,5) + LL.taylor_series(2,5)
0.506799279512368 + 0.360199571567893*z - 0.122141848388581*z^2 - 0.00635398874570253*z^3 + 0.0383995215484257*z^4 + O(z^5)

sage: L.taylor_series(2,5) + LL.taylor_series(2,5) - (E.lseries().taylor_series(2,5) * E.quadratic_twist(-40).lseries().taylor_series(2,5))
-0.016*z + 0.035*z^2 - 0.014*z^3 - 0.031*z^4 + O(z^5)
```

I'll cook up a few more examples and post what I find.



---

archive/issue_comments_040655.json:
```json
{
    "body": "<a id='comment:3'></a>\nExcellent. That's looking very good. I was very tired the day I was finishing that up, so I'm glad you caught these errors.",
    "created_at": "2008-11-28T18:12:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40655",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:3'></a>
Excellent. That's looking very good. I was very tired the day I was finishing that up, so I'm glad you caught these errors.



---

archive/issue_comments_040656.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [robertwb](#comment%3A3):\n> Excellent. That's looking very good. I was very tired the day I was finishing that up, so I'm glad you caught these errors. \n\n\nShould this ticker be \"[with patch, needs review]\" ? \n\nCheers,\n\nMichael",
    "created_at": "2008-11-28T18:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40656",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:4'></a>
Replying to [robertwb](#comment%3A3):
> Excellent. That's looking very good. I was very tired the day I was finishing that up, so I'm glad you caught these errors. 


Should this ticker be "[with patch, needs review]" ? 

Cheers,

Michael



---

archive/issue_comments_040657.json:
```json
{
    "body": "<a id='comment:5'></a>\nNo, I don't think so yet (but if Craig is happy with it, then sure).",
    "created_at": "2008-11-28T18:28:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40657",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:5'></a>
No, I don't think so yet (but if Craig is happy with it, then sure).



---

archive/issue_comments_040658.json:
```json
{
    "body": "**Changing assignee** from @williamstein to @loefflerd.",
    "created_at": "2009-07-20T19:50:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40658",
    "user": "https://github.com/loefflerd"
}
```

**Changing assignee** from @williamstein to @loefflerd.



---

archive/issue_comments_040659.json:
```json
{
    "body": "**Remove assignee** @loefflerd.",
    "created_at": "2009-10-09T09:12:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40659",
    "user": "https://github.com/loefflerd"
}
```

**Remove assignee** @loefflerd.



---

archive/issue_events_013626.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4606#event-13626"
}
```



---

archive/issue_comments_040660.json:
```json
{
    "body": "**Upstream:** N/A",
    "created_at": "2013-09-19T19:54:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40660",
    "user": "https://github.com/fchapoton"
}
```

**Upstream:** N/A



---

archive/issue_comments_040661.json:
```json
{
    "body": "<a id='comment:9'></a>\nfor the **patchbots**:\n\napply only trac_4606_gross_zagier_lseries_rebased.patch",
    "created_at": "2013-09-19T19:54:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40661",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>
for the **patchbots**:

apply only trac_4606_gross_zagier_lseries_rebased.patch



---

archive/issue_comments_040662.json:
```json
{
    "body": "Attachment [trac_4606_gross_zagier_lseries_rebased.patch](tarball://root/attachments/some-uuid/ticket4606/trac_4606_gross_zagier_lseries_rebased.patch) by @fchapoton created at 2013-09-20 16:09:19\n\nfolded all three patches and rebased on 5.12.beta5",
    "created_at": "2013-09-20T16:09:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40662",
    "user": "https://github.com/fchapoton"
}
```

Attachment [trac_4606_gross_zagier_lseries_rebased.patch](tarball://root/attachments/some-uuid/ticket4606/trac_4606_gross_zagier_lseries_rebased.patch) by @fchapoton created at 2013-09-20 16:09:19

folded all three patches and rebased on 5.12.beta5



---

archive/issue_comments_040663.json:
```json
{
    "body": "<a id='comment:10'></a>\napply trac_4606_gross_zagier_lseries_rebased.patch",
    "created_at": "2013-10-15T19:25:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40663",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>
apply trac_4606_gross_zagier_lseries_rebased.patch



---

archive/issue_comments_040664.json:
```json
{
    "body": "**Branch:** [u/chapoton/4606](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/4606)",
    "created_at": "2014-01-09T19:34:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40664",
    "user": "https://github.com/fchapoton"
}
```

**Branch:** [u/chapoton/4606](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/4606)



---

archive/issue_comments_040665.json:
```json
{
    "body": "**Commit:** [a356ce0dac36dbea966b497784fc9c4d1a32b2ce](https://github.com/sagemath/sagetrac-mirror/commit/a356ce0dac36dbea966b497784fc9c4d1a32b2ce)",
    "created_at": "2014-01-09T19:34:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40665",
    "user": "https://github.com/fchapoton"
}
```

**Commit:** [a356ce0dac36dbea966b497784fc9c4d1a32b2ce](https://github.com/sagemath/sagetrac-mirror/commit/a356ce0dac36dbea966b497784fc9c4d1a32b2ce)



---

archive/issue_comments_040666.json:
```json
{
    "body": "**Changing status** from new to needs_info.",
    "created_at": "2014-01-09T19:34:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40666",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from new to needs_info.



---

archive/issue_comments_040667.json:
```json
{
    "body": "<a id='comment:11'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a356ce0dac36dbea966b497784fc9c4d1a32b2ce\">a356ce0</a></td><td><code>Gross-Zagier L-function attached to an elliptic curve</code></td></tr></table>\n",
    "created_at": "2014-01-09T19:34:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40667",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a356ce0dac36dbea966b497784fc9c4d1a32b2ce">a356ce0</a></td><td><code>Gross-Zagier L-function attached to an elliptic curve</code></td></tr></table>




---

archive/issue_comments_040668.json:
```json
{
    "body": "**Changing status** from needs_info to needs_work.",
    "created_at": "2014-01-09T19:35:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40668",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from needs_info to needs_work.



---

archive/issue_events_013627.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4606#event-13627"
}
```



---

archive/issue_events_013628.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4606#event-13628"
}
```



---

archive/issue_events_013629.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4606#event-13629"
}
```



---

archive/issue_events_013630.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4606#event-13630"
}
```



---

archive/issue_events_013631.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4606#event-13631"
}
```



---

archive/issue_events_013632.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4606#event-13632"
}
```



---

archive/issue_comments_040669.json:
```json
{
    "body": "<a id='comment:16'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6b00349f1dfc845c7ad86399a527b3bf1228d22d\">6b00349</a></td><td><code>Merge branch 'u/chapoton/4606' into 6.7.b2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a591e284419df08fba48ddb4d61b300839a7386b\">a591e28</a></td><td><code>trac #4606 fixing usage of sig_on/off</code></td></tr></table>\n",
    "created_at": "2015-04-25T16:21:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40669",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6b00349f1dfc845c7ad86399a527b3bf1228d22d">6b00349</a></td><td><code>Merge branch 'u/chapoton/4606' into 6.7.b2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a591e284419df08fba48ddb4d61b300839a7386b">a591e28</a></td><td><code>trac #4606 fixing usage of sig_on/off</code></td></tr></table>




---

archive/issue_comments_040670.json:
```json
{
    "body": "**Changing commit** from \"[a356ce0dac36dbea966b497784fc9c4d1a32b2ce](https://github.com/sagemath/sagetrac-mirror/commit/a356ce0dac36dbea966b497784fc9c4d1a32b2ce)\" to \"[a591e284419df08fba48ddb4d61b300839a7386b](https://github.com/sagemath/sagetrac-mirror/commit/a591e284419df08fba48ddb4d61b300839a7386b)\".",
    "created_at": "2015-04-25T16:21:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40670",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a356ce0dac36dbea966b497784fc9c4d1a32b2ce](https://github.com/sagemath/sagetrac-mirror/commit/a356ce0dac36dbea966b497784fc9c4d1a32b2ce)" to "[a591e284419df08fba48ddb4d61b300839a7386b](https://github.com/sagemath/sagetrac-mirror/commit/a591e284419df08fba48ddb4d61b300839a7386b)".



---

archive/issue_events_013633.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-04-26T07:18:38Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4606#event-13633"
}
```



---

archive/issue_events_013634.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-04-26T07:18:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "milestone": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4606#event-13634"
}
```



---

archive/issue_comments_040671.json:
```json
{
    "body": "**Changing commit** from \"[a591e284419df08fba48ddb4d61b300839a7386b](https://github.com/sagemath/sagetrac-mirror/commit/a591e284419df08fba48ddb4d61b300839a7386b)\" to \"[8fe5dc70187365b0b76ebf1709a48883ca9bb690](https://github.com/sagemath/sagetrac-mirror/commit/8fe5dc70187365b0b76ebf1709a48883ca9bb690)\".",
    "created_at": "2015-04-26T07:54:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40671",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a591e284419df08fba48ddb4d61b300839a7386b](https://github.com/sagemath/sagetrac-mirror/commit/a591e284419df08fba48ddb4d61b300839a7386b)" to "[8fe5dc70187365b0b76ebf1709a48883ca9bb690](https://github.com/sagemath/sagetrac-mirror/commit/8fe5dc70187365b0b76ebf1709a48883ca9bb690)".



---

archive/issue_comments_040672.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8fe5dc70187365b0b76ebf1709a48883ca9bb690\">8fe5dc7</a></td><td><code>trac #4606 full coverage</code></td></tr></table>\n",
    "created_at": "2015-04-26T07:54:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40672",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8fe5dc70187365b0b76ebf1709a48883ca9bb690">8fe5dc7</a></td><td><code>trac #4606 full coverage</code></td></tr></table>




---

archive/issue_comments_040673.json:
```json
{
    "body": "<a id='comment:19'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f48d40298dbc6847e77e0e7f95bc461df8a5c186\">f48d402</a></td><td><code>Merge branch 'u/chapoton/4606' into 6.7.b3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fbc3a575ae443d7811b0dfdbd36f1f5d5309f5b2\">fbc3a57</a></td><td><code>trac #4606 more doc</code></td></tr></table>\n",
    "created_at": "2015-05-01T19:54:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40673",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f48d40298dbc6847e77e0e7f95bc461df8a5c186">f48d402</a></td><td><code>Merge branch 'u/chapoton/4606' into 6.7.b3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fbc3a575ae443d7811b0dfdbd36f1f5d5309f5b2">fbc3a57</a></td><td><code>trac #4606 more doc</code></td></tr></table>




---

archive/issue_comments_040674.json:
```json
{
    "body": "**Changing commit** from \"[8fe5dc70187365b0b76ebf1709a48883ca9bb690](https://github.com/sagemath/sagetrac-mirror/commit/8fe5dc70187365b0b76ebf1709a48883ca9bb690)\" to \"[fbc3a575ae443d7811b0dfdbd36f1f5d5309f5b2](https://github.com/sagemath/sagetrac-mirror/commit/fbc3a575ae443d7811b0dfdbd36f1f5d5309f5b2)\".",
    "created_at": "2015-05-01T19:54:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40674",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[8fe5dc70187365b0b76ebf1709a48883ca9bb690](https://github.com/sagemath/sagetrac-mirror/commit/8fe5dc70187365b0b76ebf1709a48883ca9bb690)" to "[fbc3a575ae443d7811b0dfdbd36f1f5d5309f5b2](https://github.com/sagemath/sagetrac-mirror/commit/fbc3a575ae443d7811b0dfdbd36f1f5d5309f5b2)".



---

archive/issue_comments_040675.json:
```json
{
    "body": "<a id='comment:20'></a>\nIt seems that the Dirichlet coefficients of\n\n- the product of Dirichlet series for E and its twists\n- the sum of Dirichlet series for (E,A) over all classes A\n\ndo not quite exactly match. I have not been able to locate the error so far. It could be either in the quadratic form code implemented here or elsewhere. Quadratic forms theta series should be checked against the generic implementation of theta series.",
    "created_at": "2015-05-02T07:32:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40675",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:20'></a>
It seems that the Dirichlet coefficients of

- the product of Dirichlet series for E and its twists
- the sum of Dirichlet series for (E,A) over all classes A

do not quite exactly match. I have not been able to locate the error so far. It could be either in the quadratic form code implemented here or elsewhere. Quadratic forms theta series should be checked against the generic implementation of theta series.



---

archive/issue_comments_040676.json:
```json
{
    "body": "<a id='comment:21'></a>\nApparently, the theta series is good (but slower than the generic implementation).\n\nSo the problem must be in the Dirichlet convolution code",
    "created_at": "2015-05-02T07:40:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40676",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:21'></a>
Apparently, the theta series is good (but slower than the generic implementation).

So the problem must be in the Dirichlet convolution code



---

archive/issue_comments_040677.json:
```json
{
    "body": "**Changing commit** from \"[fbc3a575ae443d7811b0dfdbd36f1f5d5309f5b2](https://github.com/sagemath/sagetrac-mirror/commit/fbc3a575ae443d7811b0dfdbd36f1f5d5309f5b2)\" to \"[c4daca81bcc855197d8196eb5caf20ddf7dea05a](https://github.com/sagemath/sagetrac-mirror/commit/c4daca81bcc855197d8196eb5caf20ddf7dea05a)\".",
    "created_at": "2015-05-02T14:00:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40677",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[fbc3a575ae443d7811b0dfdbd36f1f5d5309f5b2](https://github.com/sagemath/sagetrac-mirror/commit/fbc3a575ae443d7811b0dfdbd36f1f5d5309f5b2)" to "[c4daca81bcc855197d8196eb5caf20ddf7dea05a](https://github.com/sagemath/sagetrac-mirror/commit/c4daca81bcc855197d8196eb5caf20ddf7dea05a)".



---

archive/issue_comments_040678.json:
```json
{
    "body": "<a id='comment:22'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c4daca81bcc855197d8196eb5caf20ddf7dea05a\">c4daca8</a></td><td><code>trac #4606 better, but still not numerical equality</code></td></tr></table>\n",
    "created_at": "2015-05-02T14:00:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40678",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c4daca81bcc855197d8196eb5caf20ddf7dea05a">c4daca8</a></td><td><code>trac #4606 better, but still not numerical equality</code></td></tr></table>




---

archive/issue_comments_040679.json:
```json
{
    "body": "<a id='comment:23'></a>\nHum, here is the current state of affairs:\n\n```\nsage: E = EllipticCurve('37a')\nsage: K.<a> = QuadraticField(-40)\nsage: A = K.class_group().gen(0)\nsage: L = E.lseries_gross_zagier(A)\nsage: LL = E.lseries_gross_zagier(A**2)\nsage: L(2) + LL(2)\n0.506799279512368\nsage: E.lseries()(2) * E.quadratic_twist(-40).lseries()(2)\n0.502803417587467\n```\nNot so good, in fact. Now let us compare Taylor expansions:\n\n```\nsage: L.taylor_series(2, 5)+LL.taylor_series(2, 5)\n0.506799279512368 + 0.360199571567893*z - 0.122141848388581*z^2 - 0.00635398874570253*z^3 + 0.0383995215484257*z^4 + O(z^5)\nsage: E.lseries().taylor_series(2,series_prec=5) * E.quadratic_twist(-40).lseries().taylor_series(2,series_prec=5)\n0.502803417587467 + 0.374948906665456*z - 0.144641137632262*z^2 + 0.00702138852027905*z^3 + 0.0487513598755609*z^4 + O(z^5)\n```\nNot far, but definitely not good. Note that the syntax of taylor expansion differs.",
    "created_at": "2015-05-02T14:22:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40679",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:23'></a>
Hum, here is the current state of affairs:

```
sage: E = EllipticCurve('37a')
sage: K.<a> = QuadraticField(-40)
sage: A = K.class_group().gen(0)
sage: L = E.lseries_gross_zagier(A)
sage: LL = E.lseries_gross_zagier(A**2)
sage: L(2) + LL(2)
0.506799279512368
sage: E.lseries()(2) * E.quadratic_twist(-40).lseries()(2)
0.502803417587467
```
Not so good, in fact. Now let us compare Taylor expansions:

```
sage: L.taylor_series(2, 5)+LL.taylor_series(2, 5)
0.506799279512368 + 0.360199571567893*z - 0.122141848388581*z^2 - 0.00635398874570253*z^3 + 0.0383995215484257*z^4 + O(z^5)
sage: E.lseries().taylor_series(2,series_prec=5) * E.quadratic_twist(-40).lseries().taylor_series(2,series_prec=5)
0.502803417587467 + 0.374948906665456*z - 0.144641137632262*z^2 + 0.00702138852027905*z^3 + 0.0487513598755609*z^4 + O(z^5)
```
Not far, but definitely not good. Note that the syntax of taylor expansion differs.



---

archive/issue_comments_040680.json:
```json
{
    "body": "<a id='comment:24'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0c383d9020a3e5dc3e440c862a205439b74f504a\">0c383d9</a></td><td><code>trac #4606 now sure that Dirichlet coeffs do indeed match</code></td></tr></table>\n",
    "created_at": "2015-05-02T16:01:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40680",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0c383d9020a3e5dc3e440c862a205439b74f504a">0c383d9</a></td><td><code>trac #4606 now sure that Dirichlet coeffs do indeed match</code></td></tr></table>




---

archive/issue_comments_040681.json:
```json
{
    "body": "**Changing commit** from \"[c4daca81bcc855197d8196eb5caf20ddf7dea05a](https://github.com/sagemath/sagetrac-mirror/commit/c4daca81bcc855197d8196eb5caf20ddf7dea05a)\" to \"[0c383d9020a3e5dc3e440c862a205439b74f504a](https://github.com/sagemath/sagetrac-mirror/commit/0c383d9020a3e5dc3e440c862a205439b74f504a)\".",
    "created_at": "2015-05-02T16:01:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40681",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c4daca81bcc855197d8196eb5caf20ddf7dea05a](https://github.com/sagemath/sagetrac-mirror/commit/c4daca81bcc855197d8196eb5caf20ddf7dea05a)" to "[0c383d9020a3e5dc3e440c862a205439b74f504a](https://github.com/sagemath/sagetrac-mirror/commit/0c383d9020a3e5dc3e440c862a205439b74f504a)".



---

archive/issue_comments_040682.json:
```json
{
    "body": "<a id='comment:25'></a>\nI think that I have checked fully the computation of the Dirichet coefficients.\n\nSo well... maybe something is wrong in the parameters given to Dokchitser program ?\n\n```\nsage: e = EllipticCurve('37a')\nsage: K.<a> = QuadraticField(-40)\nsage: A = K.class_group().gen(0)\nsage: from sage.modular.modform.l_series import GrossZagierLseries\nsage: G = GrossZagierLseries(e, A)\nsage: G._dokchister.check_functional_equation()\n-80.1679727952639\nsage: G = GrossZagierLseries(e, A**2)\nsage: G._dokchister.check_functional_equation()\n47.5616711441054\n```",
    "created_at": "2015-05-02T16:23:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40682",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:25'></a>
I think that I have checked fully the computation of the Dirichet coefficients.

So well... maybe something is wrong in the parameters given to Dokchitser program ?

```
sage: e = EllipticCurve('37a')
sage: K.<a> = QuadraticField(-40)
sage: A = K.class_group().gen(0)
sage: from sage.modular.modform.l_series import GrossZagierLseries
sage: G = GrossZagierLseries(e, A)
sage: G._dokchister.check_functional_equation()
-80.1679727952639
sage: G = GrossZagierLseries(e, A**2)
sage: G._dokchister.check_functional_equation()
47.5616711441054
```



---

archive/issue_comments_040683.json:
```json
{
    "body": "<a id='comment:26'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/49204245903e70177e371485e4e61a322a90fde6\">4920424</a></td><td><code>trac #4606 Yipee ! working at last</code></td></tr></table>\n",
    "created_at": "2015-05-02T18:23:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40683",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/49204245903e70177e371485e4e61a322a90fde6">4920424</a></td><td><code>trac #4606 Yipee ! working at last</code></td></tr></table>




---

archive/issue_comments_040684.json:
```json
{
    "body": "**Changing commit** from \"[0c383d9020a3e5dc3e440c862a205439b74f504a](https://github.com/sagemath/sagetrac-mirror/commit/0c383d9020a3e5dc3e440c862a205439b74f504a)\" to \"[49204245903e70177e371485e4e61a322a90fde6](https://github.com/sagemath/sagetrac-mirror/commit/49204245903e70177e371485e4e61a322a90fde6)\".",
    "created_at": "2015-05-02T18:23:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40684",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0c383d9020a3e5dc3e440c862a205439b74f504a](https://github.com/sagemath/sagetrac-mirror/commit/0c383d9020a3e5dc3e440c862a205439b74f504a)" to "[49204245903e70177e371485e4e61a322a90fde6](https://github.com/sagemath/sagetrac-mirror/commit/49204245903e70177e371485e4e61a322a90fde6)".



---

archive/issue_comments_040685.json:
```json
{
    "body": "**Changing commit** from \"[49204245903e70177e371485e4e61a322a90fde6](https://github.com/sagemath/sagetrac-mirror/commit/49204245903e70177e371485e4e61a322a90fde6)\" to \"[0bb47fa2466dbc64485237c788b964e5b0280ccb](https://github.com/sagemath/sagetrac-mirror/commit/0bb47fa2466dbc64485237c788b964e5b0280ccb)\".",
    "created_at": "2015-05-02T18:29:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40685",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[49204245903e70177e371485e4e61a322a90fde6](https://github.com/sagemath/sagetrac-mirror/commit/49204245903e70177e371485e4e61a322a90fde6)" to "[0bb47fa2466dbc64485237c788b964e5b0280ccb](https://github.com/sagemath/sagetrac-mirror/commit/0bb47fa2466dbc64485237c788b964e5b0280ccb)".



---

archive/issue_comments_040686.json:
```json
{
    "body": "<a id='comment:27'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0bb47fa2466dbc64485237c788b964e5b0280ccb\">0bb47fa</a></td><td><code>trac #4606 fixing some doc details</code></td></tr></table>\n",
    "created_at": "2015-05-02T18:29:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40686",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0bb47fa2466dbc64485237c788b964e5b0280ccb">0bb47fa</a></td><td><code>trac #4606 fixing some doc details</code></td></tr></table>




---

archive/issue_comments_040687.json:
```json
{
    "body": "<a id='comment:28'></a>\nThis is now working\n\n```\nsage: sage: e = EllipticCurve('37a')\nsage: sage: K.<a> = QuadraticField(-40)\nsage: sage: A = K.class_group().gen(0)\nsage: sage: from sage.modular.modform.l_series import GrossZagierLseries\nsage: sage: G = GrossZagierLseries(e, A)\nsage: sage: G._dokchister.check_functional_equation()\n2.77555756156289e-17\nsage: sage: G = GrossZagierLseries(e, A**2)\nsage: sage: G._dokchister.check_functional_equation()\n-3.64291929955129e-17\n```\nAfter six years !",
    "created_at": "2015-05-02T18:53:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40687",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:28'></a>
This is now working

```
sage: sage: e = EllipticCurve('37a')
sage: sage: K.<a> = QuadraticField(-40)
sage: sage: A = K.class_group().gen(0)
sage: sage: from sage.modular.modform.l_series import GrossZagierLseries
sage: sage: G = GrossZagierLseries(e, A)
sage: sage: G._dokchister.check_functional_equation()
2.77555756156289e-17
sage: sage: G = GrossZagierLseries(e, A**2)
sage: sage: G._dokchister.check_functional_equation()
-3.64291929955129e-17
```
After six years !



---

archive/issue_comments_040688.json:
```json
{
    "body": "<a id='comment:29'></a>\nCongratulations! I will look at it, but at the moment I am rebuilding with #18340 (new Pari version), and this should surely be tested on top of that?",
    "created_at": "2015-05-02T19:03:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40688",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:29'></a>
Congratulations! I will look at it, but at the moment I am rebuilding with #18340 (new Pari version), and this should surely be tested on top of that?



---

archive/issue_comments_040689.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -6,8 +6,9 @@\n sage: A = K.class_group().gen(0); A\n Fractional ideal class (2, -1/2*a)\n sage: L = e.lseries_gross_zagier(A)  \n-sage: L(2)\n-0\n-sage: L.taylor_series(2,5)\n-nobody has seen this!\n+sage: L(1)\n+0.000000000000000\n+sage: L.taylor_series(1,5)\n+0.000000000000000 - 5.51899839494458*z + 13.6297841350649*z^2 - 16.2292417817675*z^3 + 7.94788823722712*z^4 + O(z^5)\n ```\n+nobody had seen this!\n``````\n",
    "created_at": "2015-05-02T19:10:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40689",
    "user": "https://github.com/fchapoton"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -6,8 +6,9 @@
 sage: A = K.class_group().gen(0); A
 Fractional ideal class (2, -1/2*a)
 sage: L = e.lseries_gross_zagier(A)  
-sage: L(2)
-0
-sage: L.taylor_series(2,5)
-nobody has seen this!
+sage: L(1)
+0.000000000000000
+sage: L.taylor_series(1,5)
+0.000000000000000 - 5.51899839494458*z + 13.6297841350649*z^2 - 16.2292417817675*z^3 + 7.94788823722712*z^4 + O(z^5)
 ```
+nobody had seen this!
``````




---

archive/issue_comments_040690.json:
```json
{
    "body": "**Author:** William Stein, Robert Bradshaw, Craig Citro",
    "created_at": "2015-05-02T19:10:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40690",
    "user": "https://github.com/fchapoton"
}
```

**Author:** William Stein, Robert Bradshaw, Craig Citro



---

archive/issue_comments_040691.json:
```json
{
    "body": "<a id='comment:31'></a>\nI just wrote a report which trac swallowed and deleted as I was not logged in.  I am not going to rewrite it!  More after I have done some more testing.",
    "created_at": "2015-05-04T12:04:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40691",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:31'></a>
I just wrote a report which trac swallowed and deleted as I was not logged in.  I am not going to rewrite it!  More after I have done some more testing.



---

archive/issue_comments_040692.json:
```json
{
    "body": "<a id='comment:32'></a>\nWhy is this not \"needs review\"?",
    "created_at": "2015-05-04T12:05:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40692",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:32'></a>
Why is this not "needs review"?



---

archive/issue_comments_040693.json:
```json
{
    "body": "<a id='comment:33'></a>\nI see some remaining things that should be done:\n\n- maybe use the generic theta function code if it is faster than the one provided here for binary quadratic forms (as it seems to be)\n\n- make sure that the syntax is similar to the other L-functions we have\n\n- test with many curves and many quadratic number fields\n\n- have an expert say something about the conductor. I changed it using my very small understanding of Dokchister parameters and it worked. But I am not very sure if it is the right answer for all curves and all fields.",
    "created_at": "2015-05-04T12:14:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40693",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:33'></a>
I see some remaining things that should be done:

- maybe use the generic theta function code if it is faster than the one provided here for binary quadratic forms (as it seems to be)

- make sure that the syntax is similar to the other L-functions we have

- test with many curves and many quadratic number fields

- have an expert say something about the conductor. I changed it using my very small understanding of Dokchister parameters and it worked. But I am not very sure if it is the right answer for all curves and all fields.



---

archive/issue_comments_040694.json:
```json
{
    "body": "<a id='comment:34'></a>\nReplying to [chapoton](#comment%3A33):\n> I see some remaining things that should be done:\n> \n> - maybe use the generic theta function code if it is faster than the one provided here for binary quadratic forms (as it seems to be)\n\n\nSurely such a possible improvement can be noted for later work, and not delay this?\n\n> \n> - make sure that the syntax is similar to the other L-functions we have\n\n\nGood point.  \n\n> \n> - test with many curves and many quadratic number fields\n \n>\n\nI tested with one curve and many fields.  This led to the one suggestion I have:\n\n- somewhere, perhaps in the constructor for GrossZagierLseries, test that the ideal class is associated to an imaginary quadratic field.  If you construct it from an ideal in a real quadratic field there is a resulting error in the quadratic forms code, and this should be more graceful.\n\nJohn\n \n> - have an expert say something about the conductor. I changed it using my very small understanding of Dokchister parameters and it worked. But I am not very sure if it is the right answer for all curves and all fields.\n",
    "created_at": "2015-05-04T13:33:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40694",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:34'></a>
Replying to [chapoton](#comment%3A33):
> I see some remaining things that should be done:
> 
> - maybe use the generic theta function code if it is faster than the one provided here for binary quadratic forms (as it seems to be)


Surely such a possible improvement can be noted for later work, and not delay this?

> 
> - make sure that the syntax is similar to the other L-functions we have


Good point.  

> 
> - test with many curves and many quadratic number fields
 
>

I tested with one curve and many fields.  This led to the one suggestion I have:

- somewhere, perhaps in the constructor for GrossZagierLseries, test that the ideal class is associated to an imaginary quadratic field.  If you construct it from an ideal in a real quadratic field there is a resulting error in the quadratic forms code, and this should be more graceful.

John
 
> - have an expert say something about the conductor. I changed it using my very small understanding of Dokchister parameters and it worked. But I am not very sure if it is the right answer for all curves and all fields.




---

archive/issue_comments_040695.json:
```json
{
    "body": "**Changing commit** from \"[0bb47fa2466dbc64485237c788b964e5b0280ccb](https://github.com/sagemath/sagetrac-mirror/commit/0bb47fa2466dbc64485237c788b964e5b0280ccb)\" to \"[b9d3acc5fdf1f3e1c43937624472320b81e5db63](https://github.com/sagemath/sagetrac-mirror/commit/b9d3acc5fdf1f3e1c43937624472320b81e5db63)\".",
    "created_at": "2015-05-04T15:10:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40695",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0bb47fa2466dbc64485237c788b964e5b0280ccb](https://github.com/sagemath/sagetrac-mirror/commit/0bb47fa2466dbc64485237c788b964e5b0280ccb)" to "[b9d3acc5fdf1f3e1c43937624472320b81e5db63](https://github.com/sagemath/sagetrac-mirror/commit/b9d3acc5fdf1f3e1c43937624472320b81e5db63)".



---

archive/issue_comments_040696.json:
```json
{
    "body": "<a id='comment:35'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b9d3acc5fdf1f3e1c43937624472320b81e5db63\">b9d3acc</a></td><td><code>trac #4606 check for imaginary quadratic field</code></td></tr></table>\n",
    "created_at": "2015-05-04T15:10:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40696",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b9d3acc5fdf1f3e1c43937624472320b81e5db63">b9d3acc</a></td><td><code>trac #4606 check for imaginary quadratic field</code></td></tr></table>




---

archive/issue_comments_040697.json:
```json
{
    "body": "<a id='comment:36'></a>\nThanks for the IQF patch.\nWe should have someone look at the conductor though.  I won't have time (and would have to look things up for sure). Who?",
    "created_at": "2015-05-04T16:46:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40697",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:36'></a>
Thanks for the IQF patch.
We should have someone look at the conductor though.  I won't have time (and would have to look things up for sure). Who?



---

archive/issue_comments_040698.json:
```json
{
    "body": "**Changing commit** from \"[b9d3acc5fdf1f3e1c43937624472320b81e5db63](https://github.com/sagemath/sagetrac-mirror/commit/b9d3acc5fdf1f3e1c43937624472320b81e5db63)\" to \"[5aa3c478a11a47da871b9f4fe1e2925669902309](https://github.com/sagemath/sagetrac-mirror/commit/5aa3c478a11a47da871b9f4fe1e2925669902309)\".",
    "created_at": "2015-05-04T19:52:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40698",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b9d3acc5fdf1f3e1c43937624472320b81e5db63](https://github.com/sagemath/sagetrac-mirror/commit/b9d3acc5fdf1f3e1c43937624472320b81e5db63)" to "[5aa3c478a11a47da871b9f4fe1e2925669902309](https://github.com/sagemath/sagetrac-mirror/commit/5aa3c478a11a47da871b9f4fe1e2925669902309)".



---

archive/issue_comments_040699.json:
```json
{
    "body": "<a id='comment:37'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5aa3c478a11a47da871b9f4fe1e2925669902309\">5aa3c47</a></td><td><code>trac #4606 more similar parameters for taylor_expansion</code></td></tr></table>\n",
    "created_at": "2015-05-04T19:52:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40699",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5aa3c478a11a47da871b9f4fe1e2925669902309">5aa3c47</a></td><td><code>trac #4606 more similar parameters for taylor_expansion</code></td></tr></table>




---

archive/issue_comments_040700.json:
```json
{
    "body": "<a id='comment:39'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/89ee981ffff3e97833c11685d129c88631790711\">89ee981</a></td><td><code>Merge branch 'u/chapoton/4606' into 6.7.b4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/742be7795325b79528bbbe5c52cb3bcbab3ea3d9\">742be77</a></td><td><code>trac #4606 changes in eps and conductor</code></td></tr></table>\n",
    "created_at": "2015-05-13T09:59:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40700",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:39'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/89ee981ffff3e97833c11685d129c88631790711">89ee981</a></td><td><code>Merge branch 'u/chapoton/4606' into 6.7.b4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/742be7795325b79528bbbe5c52cb3bcbab3ea3d9">742be77</a></td><td><code>trac #4606 changes in eps and conductor</code></td></tr></table>




---

archive/issue_comments_040701.json:
```json
{
    "body": "**Changing commit** from \"[5aa3c478a11a47da871b9f4fe1e2925669902309](https://github.com/sagemath/sagetrac-mirror/commit/5aa3c478a11a47da871b9f4fe1e2925669902309)\" to \"[742be7795325b79528bbbe5c52cb3bcbab3ea3d9](https://github.com/sagemath/sagetrac-mirror/commit/742be7795325b79528bbbe5c52cb3bcbab3ea3d9)\".",
    "created_at": "2015-05-13T09:59:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40701",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[5aa3c478a11a47da871b9f4fe1e2925669902309](https://github.com/sagemath/sagetrac-mirror/commit/5aa3c478a11a47da871b9f4fe1e2925669902309)" to "[742be7795325b79528bbbe5c52cb3bcbab3ea3d9](https://github.com/sagemath/sagetrac-mirror/commit/742be7795325b79528bbbe5c52cb3bcbab3ea3d9)".



---

archive/issue_comments_040702.json:
```json
{
    "body": "<a id='comment:40'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d8d92d243217643f47883f6fc9c4818efb859252\">d8d92d2</a></td><td><code>trac #4606 using Kronecker characters</code></td></tr></table>\n",
    "created_at": "2015-05-13T12:16:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40702",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d8d92d243217643f47883f6fc9c4818efb859252">d8d92d2</a></td><td><code>trac #4606 using Kronecker characters</code></td></tr></table>




---

archive/issue_comments_040703.json:
```json
{
    "body": "**Changing commit** from \"[742be7795325b79528bbbe5c52cb3bcbab3ea3d9](https://github.com/sagemath/sagetrac-mirror/commit/742be7795325b79528bbbe5c52cb3bcbab3ea3d9)\" to \"[d8d92d243217643f47883f6fc9c4818efb859252](https://github.com/sagemath/sagetrac-mirror/commit/d8d92d243217643f47883f6fc9c4818efb859252)\".",
    "created_at": "2015-05-13T12:16:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40703",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[742be7795325b79528bbbe5c52cb3bcbab3ea3d9](https://github.com/sagemath/sagetrac-mirror/commit/742be7795325b79528bbbe5c52cb3bcbab3ea3d9)" to "[d8d92d243217643f47883f6fc9c4818efb859252](https://github.com/sagemath/sagetrac-mirror/commit/d8d92d243217643f47883f6fc9c4818efb859252)".



---

archive/issue_comments_040704.json:
```json
{
    "body": "<a id='comment:41'></a>\nNow working better, but not perfectly (some problems with trivial ideal classes)\n\n```\nsage: K=QuadraticField(-79)\nsage: K.class_group()\nClass group of order 5 with structure C5 of Number Field in a with defining polynomial x^2 + 79\nsage: A=K.class_group().gen()\nsage: E=EllipticCurve('433a1')\nsage: sum(E.lseries_gross_zagier(A**i)(2) for i in range(5))\n0.173957331997956\nsage: E.lseries()(2)*E.quadratic_twist(-79).lseries()(2)\n0.327922081982688\nsage: lgz=E.lseries_gross_zagier(A)\nsage: lgz._dokchister.check_functional_equation()\n8.32667268468867e-17\nsage: lgz=E.lseries_gross_zagier(A**2)\nsage: lgz._dokchister.check_functional_equation()\n-2.20309881449055e-16\nsage: lgz=E.lseries_gross_zagier(A**3)\nsage: lgz._dokchister.check_functional_equation()\n-2.20309881449055e-16\nsage: lgz=E.lseries_gross_zagier(A**4)\nsage: lgz._dokchister.check_functional_equation()\n8.32667268468867e-17\nsage: lgz=E.lseries_gross_zagier(A**5)\nsage: lgz._dokchister.check_functional_equation()\n-1383.90668128107\n```",
    "created_at": "2015-05-13T12:18:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40704",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:41'></a>
Now working better, but not perfectly (some problems with trivial ideal classes)

```
sage: K=QuadraticField(-79)
sage: K.class_group()
Class group of order 5 with structure C5 of Number Field in a with defining polynomial x^2 + 79
sage: A=K.class_group().gen()
sage: E=EllipticCurve('433a1')
sage: sum(E.lseries_gross_zagier(A**i)(2) for i in range(5))
0.173957331997956
sage: E.lseries()(2)*E.quadratic_twist(-79).lseries()(2)
0.327922081982688
sage: lgz=E.lseries_gross_zagier(A)
sage: lgz._dokchister.check_functional_equation()
8.32667268468867e-17
sage: lgz=E.lseries_gross_zagier(A**2)
sage: lgz._dokchister.check_functional_equation()
-2.20309881449055e-16
sage: lgz=E.lseries_gross_zagier(A**3)
sage: lgz._dokchister.check_functional_equation()
-2.20309881449055e-16
sage: lgz=E.lseries_gross_zagier(A**4)
sage: lgz._dokchister.check_functional_equation()
8.32667268468867e-17
sage: lgz=E.lseries_gross_zagier(A**5)
sage: lgz._dokchister.check_functional_equation()
-1383.90668128107
```



---

archive/issue_comments_040705.json:
```json
{
    "body": "<a id='comment:42'></a>\nIs the following thing normal ?\n\n```\nsage: K=QuadraticField(-79)\nsage: A=K.class_group().gen()\nsage: [(A**i).ideal().quadratic_form().discriminant() for i in range(5)]\n[-316, -79, -79, -79, -79]\n```",
    "created_at": "2015-05-13T12:30:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40705",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:42'></a>
Is the following thing normal ?

```
sage: K=QuadraticField(-79)
sage: A=K.class_group().gen()
sage: [(A**i).ideal().quadratic_form().discriminant() for i in range(5)]
[-316, -79, -79, -79, -79]
```



---

archive/issue_comments_040706.json:
```json
{
    "body": "**Changing commit** from \"[d8d92d243217643f47883f6fc9c4818efb859252](https://github.com/sagemath/sagetrac-mirror/commit/d8d92d243217643f47883f6fc9c4818efb859252)\" to \"[42ae8925a24a542a5aa138a552c32215374f4629](https://github.com/sagemath/sagetrac-mirror/commit/42ae8925a24a542a5aa138a552c32215374f4629)\".",
    "created_at": "2015-05-13T13:39:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40706",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d8d92d243217643f47883f6fc9c4818efb859252](https://github.com/sagemath/sagetrac-mirror/commit/d8d92d243217643f47883f6fc9c4818efb859252)" to "[42ae8925a24a542a5aa138a552c32215374f4629](https://github.com/sagemath/sagetrac-mirror/commit/42ae8925a24a542a5aa138a552c32215374f4629)".



---

archive/issue_comments_040707.json:
```json
{
    "body": "<a id='comment:43'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/42ae8925a24a542a5aa138a552c32215374f4629\">42ae892</a></td><td><code>trac #4606 fixing the quadratic form code</code></td></tr></table>\n",
    "created_at": "2015-05-13T13:39:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40707",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/42ae8925a24a542a5aa138a552c32215374f4629">42ae892</a></td><td><code>trac #4606 fixing the quadratic form code</code></td></tr></table>




---

archive/issue_comments_040708.json:
```json
{
    "body": "<a id='comment:44'></a>\nOk. Now everything seems to work fine. As far as I can tell.\n\nThere remains to add a little more doc.",
    "created_at": "2015-05-13T13:48:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40708",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:44'></a>
Ok. Now everything seems to work fine. As far as I can tell.

There remains to add a little more doc.



---

archive/issue_comments_040709.json:
```json
{
    "body": "<a id='comment:45'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3360e5a5db70bd7862a1ed14dcf5bcc5150169c4\">3360e5a</a></td><td><code>Merge branch 'u/chapoton/4606' into 6.7.rc0</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/abe5e2cc73d90cbcf4f322433498389a1a760245\">abe5e2c</a></td><td><code>trac #4606 renaming files, and adding more doc</code></td></tr></table>\n",
    "created_at": "2015-05-17T19:45:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40709",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:45'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3360e5a5db70bd7862a1ed14dcf5bcc5150169c4">3360e5a</a></td><td><code>Merge branch 'u/chapoton/4606' into 6.7.rc0</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/abe5e2cc73d90cbcf4f322433498389a1a760245">abe5e2c</a></td><td><code>trac #4606 renaming files, and adding more doc</code></td></tr></table>




---

archive/issue_comments_040710.json:
```json
{
    "body": "**Changing commit** from \"[42ae8925a24a542a5aa138a552c32215374f4629](https://github.com/sagemath/sagetrac-mirror/commit/42ae8925a24a542a5aa138a552c32215374f4629)\" to \"[abe5e2cc73d90cbcf4f322433498389a1a760245](https://github.com/sagemath/sagetrac-mirror/commit/abe5e2cc73d90cbcf4f322433498389a1a760245)\".",
    "created_at": "2015-05-17T19:45:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40710",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[42ae8925a24a542a5aa138a552c32215374f4629](https://github.com/sagemath/sagetrac-mirror/commit/42ae8925a24a542a5aa138a552c32215374f4629)" to "[abe5e2cc73d90cbcf4f322433498389a1a760245](https://github.com/sagemath/sagetrac-mirror/commit/abe5e2cc73d90cbcf4f322433498389a1a760245)".



---

archive/issue_comments_040711.json:
```json
{
    "body": "**Changing commit** from \"[abe5e2cc73d90cbcf4f322433498389a1a760245](https://github.com/sagemath/sagetrac-mirror/commit/abe5e2cc73d90cbcf4f322433498389a1a760245)\" to \"[0886afaff80793135ee03cccb9b90d8e891ffa98](https://github.com/sagemath/sagetrac-mirror/commit/0886afaff80793135ee03cccb9b90d8e891ffa98)\".",
    "created_at": "2015-05-17T19:47:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40711",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[abe5e2cc73d90cbcf4f322433498389a1a760245](https://github.com/sagemath/sagetrac-mirror/commit/abe5e2cc73d90cbcf4f322433498389a1a760245)" to "[0886afaff80793135ee03cccb9b90d8e891ffa98](https://github.com/sagemath/sagetrac-mirror/commit/0886afaff80793135ee03cccb9b90d8e891ffa98)".



---

archive/issue_comments_040712.json:
```json
{
    "body": "<a id='comment:46'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0886afaff80793135ee03cccb9b90d8e891ffa98\">0886afa</a></td><td><code>trac #4606 more doc</code></td></tr></table>\n",
    "created_at": "2015-05-17T19:47:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40712",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:46'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0886afaff80793135ee03cccb9b90d8e891ffa98">0886afa</a></td><td><code>trac #4606 more doc</code></td></tr></table>




---

archive/issue_comments_040713.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2015-05-17T19:58:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40713",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_040714.json:
```json
{
    "body": "<a id='comment:47'></a>\nAnybody interested, please give me feed back. It seems to work.",
    "created_at": "2015-05-17T19:58:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40714",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:47'></a>
Anybody interested, please give me feed back. It seems to work.



---

archive/issue_events_013635.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-06-26T11:31:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "milestone": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4606#event-13635"
}
```



---

archive/issue_events_013636.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-06-26T11:31:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "milestone": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4606#event-13636"
}
```



---

archive/issue_comments_040715.json:
```json
{
    "body": "<a id='comment:48'></a>\nping ?",
    "created_at": "2015-06-26T11:31:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40715",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:48'></a>
ping ?



---

archive/issue_comments_040716.json:
```json
{
    "body": "**Changing branch** from \"[u/chapoton/4606](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/4606)\" to \"[u/wuthrich/ticket/4606](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/ticket/4606)\".",
    "created_at": "2015-06-28T20:15:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40716",
    "user": "https://github.com/categorie"
}
```

**Changing branch** from "[u/chapoton/4606](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/4606)" to "[u/wuthrich/ticket/4606](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/ticket/4606)".



---

archive/issue_comments_040717.json:
```json
{
    "body": "**Reviewer:** Chris Wuthrich",
    "created_at": "2015-06-28T20:15:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40717",
    "user": "https://github.com/categorie"
}
```

**Reviewer:** Chris Wuthrich



---

archive/issue_comments_040718.json:
```json
{
    "body": "<a id='comment:49'></a>\n... pong!\n\nI added a little bit more to the documentation. Just pointing to the article is not enough.\n\nI tested this (merged into 6.8.beta6) and all passed. \n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ff129c9071ea182927d048705ed006174b8688f3\">ff129c9</a></td><td><code>#4606: additional doc</code></td></tr></table>\n",
    "created_at": "2015-06-28T20:15:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40718",
    "user": "https://github.com/categorie"
}
```

<a id='comment:49'></a>
... pong!

I added a little bit more to the documentation. Just pointing to the article is not enough.

I tested this (merged into 6.8.beta6) and all passed. 

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ff129c9071ea182927d048705ed006174b8688f3">ff129c9</a></td><td><code>#4606: additional doc</code></td></tr></table>




---

archive/issue_comments_040719.json:
```json
{
    "body": "**Changing commit** from \"[0886afaff80793135ee03cccb9b90d8e891ffa98](https://github.com/sagemath/sagetrac-mirror/commit/0886afaff80793135ee03cccb9b90d8e891ffa98)\" to \"[ff129c9071ea182927d048705ed006174b8688f3](https://github.com/sagemath/sagetrac-mirror/commit/ff129c9071ea182927d048705ed006174b8688f3)\".",
    "created_at": "2015-06-28T20:15:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40719",
    "user": "https://github.com/categorie"
}
```

**Changing commit** from "[0886afaff80793135ee03cccb9b90d8e891ffa98](https://github.com/sagemath/sagetrac-mirror/commit/0886afaff80793135ee03cccb9b90d8e891ffa98)" to "[ff129c9071ea182927d048705ed006174b8688f3](https://github.com/sagemath/sagetrac-mirror/commit/ff129c9071ea182927d048705ed006174b8688f3)".



---

archive/issue_comments_040720.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2015-06-28T20:15:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40720",
    "user": "https://github.com/categorie"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_040721.json:
```json
{
    "body": "**Changing commit** from \"[ff129c9071ea182927d048705ed006174b8688f3](https://github.com/sagemath/sagetrac-mirror/commit/ff129c9071ea182927d048705ed006174b8688f3)\" to \"[0886afaff80793135ee03cccb9b90d8e891ffa98](https://github.com/sagemath/sagetrac-mirror/commit/0886afaff80793135ee03cccb9b90d8e891ffa98)\".",
    "created_at": "2015-06-28T20:17:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40721",
    "user": "https://github.com/categorie"
}
```

**Changing commit** from "[ff129c9071ea182927d048705ed006174b8688f3](https://github.com/sagemath/sagetrac-mirror/commit/ff129c9071ea182927d048705ed006174b8688f3)" to "[0886afaff80793135ee03cccb9b90d8e891ffa98](https://github.com/sagemath/sagetrac-mirror/commit/0886afaff80793135ee03cccb9b90d8e891ffa98)".



---

archive/issue_comments_040722.json:
```json
{
    "body": "<a id='comment:50'></a>\noops, sorry, something went wrong. I should be able fix that..",
    "created_at": "2015-06-28T20:17:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40722",
    "user": "https://github.com/categorie"
}
```

<a id='comment:50'></a>
oops, sorry, something went wrong. I should be able fix that..



---

archive/issue_comments_040723.json:
```json
{
    "body": "**Changing branch** from \"[u/wuthrich/ticket/4606](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/ticket/4606)\" to \"[u/chapoton/4606](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/4606)\".",
    "created_at": "2015-06-28T20:17:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40723",
    "user": "https://github.com/categorie"
}
```

**Changing branch** from "[u/wuthrich/ticket/4606](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/ticket/4606)" to "[u/chapoton/4606](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/4606)".



---

archive/issue_comments_040724.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2015-06-28T20:17:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40724",
    "user": "https://github.com/categorie"
}
```

**Changing status** from positive_review to needs_work.



---

archive/issue_comments_040725.json:
```json
{
    "body": "**Changing branch** from \"[u/chapoton/4606](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/4606)\" to \"[u/wuthrich/ticket/4606_new](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/ticket/4606_new)\".",
    "created_at": "2015-06-29T07:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40725",
    "user": "https://github.com/categorie"
}
```

**Changing branch** from "[u/chapoton/4606](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/4606)" to "[u/wuthrich/ticket/4606_new](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/ticket/4606_new)".



---

archive/issue_comments_040726.json:
```json
{
    "body": "<a id='comment:51'></a>\ndone and retested.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1c7df5572312affd88f2fbd074dad5f07b583efa\">1c7df55</a></td><td><code>#4606: more doc</code></td></tr></table>\n",
    "created_at": "2015-06-29T07:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40726",
    "user": "https://github.com/categorie"
}
```

<a id='comment:51'></a>
done and retested.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1c7df5572312affd88f2fbd074dad5f07b583efa">1c7df55</a></td><td><code>#4606: more doc</code></td></tr></table>




---

archive/issue_comments_040727.json:
```json
{
    "body": "**Changing status** from needs_work to positive_review.",
    "created_at": "2015-06-29T07:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40727",
    "user": "https://github.com/categorie"
}
```

**Changing status** from needs_work to positive_review.



---

archive/issue_comments_040728.json:
```json
{
    "body": "**Changing commit** from \"[0886afaff80793135ee03cccb9b90d8e891ffa98](https://github.com/sagemath/sagetrac-mirror/commit/0886afaff80793135ee03cccb9b90d8e891ffa98)\" to \"[1c7df5572312affd88f2fbd074dad5f07b583efa](https://github.com/sagemath/sagetrac-mirror/commit/1c7df5572312affd88f2fbd074dad5f07b583efa)\".",
    "created_at": "2015-06-29T07:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40728",
    "user": "https://github.com/categorie"
}
```

**Changing commit** from "[0886afaff80793135ee03cccb9b90d8e891ffa98](https://github.com/sagemath/sagetrac-mirror/commit/0886afaff80793135ee03cccb9b90d8e891ffa98)" to "[1c7df5572312affd88f2fbd074dad5f07b583efa](https://github.com/sagemath/sagetrac-mirror/commit/1c7df5572312affd88f2fbd074dad5f07b583efa)".



---

archive/issue_comments_040729.json:
```json
{
    "body": "<a id='comment:52'></a>\nThere is one thing, I should add here, although I am in favour of putting this into sage: It is unlikely that this code will be used much. I might be wrong.",
    "created_at": "2015-06-29T08:34:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40729",
    "user": "https://github.com/categorie"
}
```

<a id='comment:52'></a>
There is one thing, I should add here, although I am in favour of putting this into sage: It is unlikely that this code will be used much. I might be wrong.



---

archive/issue_comments_040730.json:
```json
{
    "body": "<a id='comment:53'></a>\nYou may well be right, and the fact that nothing much happened to this code for 7 years tends to support that.  But surely that does not matter -- far better that the code be here, properly documented and tested for the future, than that it should wither and die!",
    "created_at": "2015-06-29T08:49:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40730",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:53'></a>
You may well be right, and the fact that nothing much happened to this code for 7 years tends to support that.  But surely that does not matter -- far better that the code be here, properly documented and tested for the future, than that it should wither and die!



---

archive/issue_comments_040731.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2015-06-29T22:31:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40731",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed



---

archive/issue_comments_040732.json:
```json
{
    "body": "**Changing branch** from \"[u/wuthrich/ticket/4606_new](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/ticket/4606_new)\" to \"[1c7df5572312affd88f2fbd074dad5f07b583efa](https://github.com/sagemath/sagetrac-mirror/commit/1c7df5572312affd88f2fbd074dad5f07b583efa)\".",
    "created_at": "2015-06-29T22:31:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4606#issuecomment-40732",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/wuthrich/ticket/4606_new](https://github.com/sagemath/sagetrac-mirror/tree/u/wuthrich/ticket/4606_new)" to "[1c7df5572312affd88f2fbd074dad5f07b583efa](https://github.com/sagemath/sagetrac-mirror/commit/1c7df5572312affd88f2fbd074dad5f07b583efa)".



---

archive/issue_events_013637.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-29T22:31:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/4606",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4606#event-13637"
}
```
