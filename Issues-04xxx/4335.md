# Issue 4335: [with patch, positive review] Labelling of newforms

archive/issues_004335.json:
```json
{
    "body": "Given a space of CuspForms, there is a newforms method which gives a list of newforms associated to that space, with a name specified by the user. However, this does not seem to work correctly at the moment:\n\n```\nsage: S=CuspForms(23)\nsage: S.newforms('b')\n[q + a0*q^2 + (-2*a0 - 1)*q^3 + (-a0 - 1)*q^4 + 2*a0*q^5 + O(q^6)]\n```\n\nI think that the newforms code should be changed to something like:\n\n```\ndef newforms(self, names=None):\n        \"\"\"\n        Return all cusp forms in the cuspidal subspace of self.\n        \n        EXAMPLES:\n        \n        sage: CuspForms(23).newforms('b')\n        [q + b0*q^2 + (-2*b0 - 1)*q^3 + (-b0 - 1)*q^4 + 2*b0*q^5 + O(q^6)]\n        \"\"\"\n        M = self.modular_symbols(sign=1)\n        factors = M.cuspidal_subspace().new_subspace().decomposition()\n        large_dims = [ X.dimension() for X in factors if X.dimension() != 1 ]\n        if len(large_dims) > 0 and names is None:            \n            names = 'a'\n        return [ element.Newform(self, factors[i], names=(names+str(i)) )\n                 for i in range(len(factors)) ]\n```\n(removing the ValueError statement) as this should correctly use the user-specified name if one is given or default to 'a' if one is not.\n\nAssignee: @craigcitro\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/4335\n\n",
    "closed_at": "2008-10-26T12:05:24Z",
    "created_at": "2008-10-21T19:15:07Z",
    "labels": [
        "component: modular forms",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-3.2",
    "title": "[with patch, positive review] Labelling of newforms",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/4335",
    "user": "https://trac.sagemath.org/admin/accounts/users/ljpk"
}
```
Given a space of CuspForms, there is a newforms method which gives a list of newforms associated to that space, with a name specified by the user. However, this does not seem to work correctly at the moment:

```
sage: S=CuspForms(23)
sage: S.newforms('b')
[q + a0*q^2 + (-2*a0 - 1)*q^3 + (-a0 - 1)*q^4 + 2*a0*q^5 + O(q^6)]
```

I think that the newforms code should be changed to something like:

```
def newforms(self, names=None):
        """
        Return all cusp forms in the cuspidal subspace of self.
        
        EXAMPLES:
        
        sage: CuspForms(23).newforms('b')
        [q + b0*q^2 + (-2*b0 - 1)*q^3 + (-b0 - 1)*q^4 + 2*b0*q^5 + O(q^6)]
        """
        M = self.modular_symbols(sign=1)
        factors = M.cuspidal_subspace().new_subspace().decomposition()
        large_dims = [ X.dimension() for X in factors if X.dimension() != 1 ]
        if len(large_dims) > 0 and names is None:            
            names = 'a'
        return [ element.Newform(self, factors[i], names=(names+str(i)) )
                 for i in range(len(factors)) ]
```
(removing the ValueError statement) as this should correctly use the user-specified name if one is given or default to 'a' if one is not.

Assignee: @craigcitro

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/4335





---

archive/issue_comments_031724.json:
```json
{
    "body": "<a id='comment:1'></a>Lloyd,\n\nThanks for pointing this out!  I guess we only ever tested with 'a'.  This will be good fodder for bug day on Thursday...",
    "created_at": "2008-10-22T00:40:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4335#issuecomment-31724",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:1'></a>Lloyd,

Thanks for pointing this out!  I guess we only ever tested with 'a'.  This will be good fodder for bug day on Thursday...



---

archive/issue_comments_031725.json:
```json
{
    "body": "<a id='comment:2'></a>Attachment [trac-4335.patch](tarball://root/attachments/some-uuid/ticket4335/trac-4335.patch) by @craigcitro created at 2008-10-22 04:13:57\n\nSorry, I couldn't wait until Thursday. :) I think William's comment is right -- I probably just never tested this with anything except `a`, since that's the letter I usually use. \n\nHowever, raising an error if no variable name is provided is, in fact, the intended behavior -- basically obeying the rule of \"explicit is better than implicit.\"",
    "created_at": "2008-10-22T04:13:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4335#issuecomment-31725",
    "user": "https://github.com/craigcitro"
}
```

<a id='comment:2'></a>Attachment [trac-4335.patch](tarball://root/attachments/some-uuid/ticket4335/trac-4335.patch) by @craigcitro created at 2008-10-22 04:13:57

Sorry, I couldn't wait until Thursday. :) I think William's comment is right -- I probably just never tested this with anything except `a`, since that's the letter I usually use. 

However, raising an error if no variable name is provided is, in fact, the intended behavior -- basically obeying the rule of "explicit is better than implicit."



---

archive/issue_comments_031726.json:
```json
{
    "body": "Changing status from new to assigned.",
    "created_at": "2008-10-22T04:13:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4335#issuecomment-31726",
    "user": "https://github.com/craigcitro"
}
```

Changing status from new to assigned.



---

archive/issue_comments_031727.json:
```json
{
    "body": "<a id='comment:3'></a>Looks good to me.",
    "created_at": "2008-10-22T06:02:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4335#issuecomment-31727",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:3'></a>Looks good to me.



---

archive/issue_comments_031728.json:
```json
{
    "body": "<a id='comment:4'></a>I personally find the fact that one has to manually assign a variable name really annoying, but if that's the design decision you've taken then fair enough (I can see your reasons; I just disagree).",
    "created_at": "2008-10-22T13:47:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4335#issuecomment-31728",
    "user": "https://trac.sagemath.org/admin/accounts/users/ljpk"
}
```

<a id='comment:4'></a>I personally find the fact that one has to manually assign a variable name really annoying, but if that's the design decision you've taken then fair enough (I can see your reasons; I just disagree).



---

archive/issue_comments_031729.json:
```json
{
    "body": "<a id='comment:5'></a>> I personally find the fact that one has to manually assign a variable \n> name really annoying, but if that's the design decision you've taken\n> then fair enough (I can see your reasons; I just disagree).\n\n\nWe've systematically made that decision throughout all Sage, so we should stick with that here.\n\nThat said, we have also talked about making it so one can specify a uniform default throughout sage, e.g., a function f(n) that takes as input an integer n and outputs a variable name.  You could define it to be anything you want and everywhere in Sage that requires variables would call it -- if specified instead of giving an error, when you forget to give a variable name.",
    "created_at": "2008-10-22T20:55:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4335#issuecomment-31729",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:5'></a>> I personally find the fact that one has to manually assign a variable 
> name really annoying, but if that's the design decision you've taken
> then fair enough (I can see your reasons; I just disagree).


We've systematically made that decision throughout all Sage, so we should stick with that here.

That said, we have also talked about making it so one can specify a uniform default throughout sage, e.g., a function f(n) that takes as input an integer n and outputs a variable name.  You could define it to be anything you want and everywhere in Sage that requires variables would call it -- if specified instead of giving an error, when you forget to give a variable name.



---

archive/issue_comments_031730.json:
```json
{
    "body": "<a id='comment:6'></a>Good point. The request for a system-wide variable default is now trac #4345.",
    "created_at": "2008-10-23T07:07:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4335#issuecomment-31730",
    "user": "https://github.com/craigcitro"
}
```

<a id='comment:6'></a>Good point. The request for a system-wide variable default is now trac #4345.



---

archive/issue_comments_031731.json:
```json
{
    "body": "<a id='comment:7'></a>Unfortunately other patches mandate a rebase of this patch:\n\n```\nmabshoff@sage:/scratch/mabshoff/release-cycle/sage-3.2.alpha1/devel/sage$ patch -p1 --dry-run < trac_4335.patch \npatching file sage/modular/modform/space.py\nHunk #1 FAILED at 1571.\n1 out of 1 hunk FAILED -- saving rejects to file sage/modular/modform/space.py.rej\n```\nPlease try either my current merge tree on sage.math or alternatively wait for 3.2.alpha1 out in the next 12 hours\n\nCheers,\n\nMichael",
    "created_at": "2008-10-26T02:49:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4335#issuecomment-31731",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:7'></a>Unfortunately other patches mandate a rebase of this patch:

```
mabshoff@sage:/scratch/mabshoff/release-cycle/sage-3.2.alpha1/devel/sage$ patch -p1 --dry-run < trac_4335.patch 
patching file sage/modular/modform/space.py
Hunk #1 FAILED at 1571.
1 out of 1 hunk FAILED -- saving rejects to file sage/modular/modform/space.py.rej
```
Please try either my current merge tree on sage.math or alternatively wait for 3.2.alpha1 out in the next 12 hours

Cheers,

Michael



---

archive/issue_comments_031732.json:
```json
{
    "body": "<a id='comment:8'></a>Attachment [trac-4335-rebase.patch](tarball://root/attachments/some-uuid/ticket4335/trac-4335-rebase.patch) by @craigcitro created at 2008-10-26 04:53:40\n\nI rebased the patch, and it *should* work -- I don't have a current alpha, but I was pretty sure it was my patch from another ticket that caused the merge troubles. Let me know if this one doesn't work.",
    "created_at": "2008-10-26T04:53:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4335#issuecomment-31732",
    "user": "https://github.com/craigcitro"
}
```

<a id='comment:8'></a>Attachment [trac-4335-rebase.patch](tarball://root/attachments/some-uuid/ticket4335/trac-4335-rebase.patch) by @craigcitro created at 2008-10-26 04:53:40

I rebased the patch, and it *should* work -- I don't have a current alpha, but I was pretty sure it was my patch from another ticket that caused the merge troubles. Let me know if this one doesn't work.



---

archive/issue_comments_031733.json:
```json
{
    "body": "<a id='comment:9'></a>The rebased patch applies fine - now doctesting.\n\nCheers,\n\nMichael",
    "created_at": "2008-10-26T09:50:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4335#issuecomment-31733",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:9'></a>The rebased patch applies fine - now doctesting.

Cheers,

Michael



---

archive/issue_comments_031734.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2008-10-26T12:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4335#issuecomment-31734",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

Resolution: fixed



---

archive/issue_comments_031735.json:
```json
{
    "body": "<a id='comment:10'></a>Merged in Sage 3.2.alpha1",
    "created_at": "2008-10-26T12:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4335",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4335#issuecomment-31735",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:10'></a>Merged in Sage 3.2.alpha1



---

archive/issue_events_009810.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-10-26T12:05:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/4335",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4335#event-9810"
}
```
