# Issue 4549: New class IntegerListLex for generating integer lists => much improved partition iterators

archive/issues_004549.json:
```json
{
    "body": "IntegerListsLex refactoring, and application to Partitions\n\n- Reworked the integer lists lexicographic generator into a full\n  featured combinatorial class IntegerListsLex\n- support for n in a set (or any iterable `I` implementing `n in I`)\n\nApplications to Partitions:\n- Systematic use of IntegerListsLex to get constant amortized time\n  iterators (huge efficiency improvement).\n- This includes PartitionsGreatestEQ and PartitionsGreatestLE which\n  were previously implemented in GAP. This was inefficient due to\n  the communication overhead, and not using an iterator.\n  (backward compatible unpickling)\n- Implements horizontal_border_strip.\n\n\n**Assignee:** @nthiery\n\n**CC:**  sage-combinat\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/4549\n\n",
    "closed_at": "2009-04-04T23:56:30Z",
    "created_at": "2008-11-19T16:24:29Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-3.4.1",
    "title": "New class IntegerListLex for generating integer lists => much improved partition iterators",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/4549",
    "user": "https://github.com/nthiery"
}
```
IntegerListsLex refactoring, and application to Partitions

- Reworked the integer lists lexicographic generator into a full
  featured combinatorial class IntegerListsLex
- support for n in a set (or any iterable `I` implementing `n in I`)

Applications to Partitions:
- Systematic use of IntegerListsLex to get constant amortized time
  iterators (huge efficiency improvement).
- This includes PartitionsGreatestEQ and PartitionsGreatestLE which
  were previously implemented in GAP. This was inefficient due to
  the communication overhead, and not using an iterator.
  (backward compatible unpickling)
- Implements horizontal_border_strip.


**Assignee:** @nthiery

**CC:**  sage-combinat

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/4549





---

archive/attachments_005009.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "integer_lists_lex-4549-nt.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket4549/integer_lists_lex-4549-nt.patch",
    "created_at": "2009-02-13T16:34:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/nthiery"
}
```



---

archive/issue_comments_040060.json:
```json
{
    "body": "<a id='comment:1'></a>\nReworked the integer lists lexicographic generator into a full featured combinatorial class IntegerListsLex\nUse it systematically in Partitions to get constant amortized time iterators.\nAlso implements horizontal_border_strip.\n\nNote: the attached patch does not contain the commit messages!",
    "created_at": "2009-02-13T16:34:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40060",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:1'></a>
Reworked the integer lists lexicographic generator into a full featured combinatorial class IntegerListsLex
Use it systematically in Partitions to get constant amortized time iterators.
Also implements horizontal_border_strip.

Note: the attached patch does not contain the commit messages!



---

archive/issue_events_013498.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "rename": {
        "from": "New method horizontal_border_strip using new IntegerListsLex combinatorial class",
        "to": "New class IntegerListLex for generating integer lists => much improved partition iterators"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4549#event-13498"
}
```



---

archive/issue_comments_040061.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2009-02-13T16:34:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40061",
    "user": "https://github.com/nthiery"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_040062.json:
```json
{
    "body": "Replying to [ticket:4549 nthiery]:\n> See the title. Patch integer_lists_lex-nt in development in sage-combinat.\n\n\nNote: this patch depends on #4371 and #5255.",
    "created_at": "2009-02-13T16:45:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40062",
    "user": "https://github.com/saliola"
}
```

Replying to [ticket:4549 nthiery]:
> See the title. Patch integer_lists_lex-nt in development in sage-combinat.


Note: this patch depends on #4371 and #5255.



---

archive/issue_events_013499.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2009-02-13T23:34:11Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "milestone": "sage-3.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4549#event-13499"
}
```



---

archive/issue_comments_040063.json:
```json
{
    "body": "**Changing assignee** from @mwhansen to @nthiery.",
    "created_at": "2009-02-14T18:27:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40063",
    "user": "https://github.com/nthiery"
}
```

**Changing assignee** from @mwhansen to @nthiery.



---

archive/attachments_005010.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_4549-review.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket4549/trac_4549-review.patch",
    "created_at": "2009-02-14T23:26:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/mwhansen"
}
```



---

archive/issue_comments_040064.json:
```json
{
    "body": "",
    "created_at": "2009-02-14T23:26:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40064",
    "user": "https://github.com/mwhansen"
}
```





---

archive/issue_comments_040065.json:
```json
{
    "body": "<a id='comment:5'></a>\nI've added a patch which adds some doctests, adds a warning when min_part=0 is passed to partitions, and changed the default implementation of count to use Integers so that we don't have to reimplemented in IntegerListsLex\n\nAssuming someone okay's my changes, I think both patches are good to go in.",
    "created_at": "2009-02-14T23:28:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40065",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:5'></a>
I've added a patch which adds some doctests, adds a warning when min_part=0 is passed to partitions, and changed the default implementation of count to use Integers so that we don't have to reimplemented in IntegerListsLex

Assuming someone okay's my changes, I think both patches are good to go in.



---

archive/issue_comments_040066.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [mhansen](#comment%3A5):\nIt's ok for me ! The warning is a good idea. Go ahead.",
    "created_at": "2009-02-15T01:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40066",
    "user": "https://github.com/hivert"
}
```

<a id='comment:6'></a>
Replying to [mhansen](#comment%3A5):
It's ok for me ! The warning is a good idea. Go ahead.



---

archive/issue_comments_040067.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2009-02-15T01:25:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40067",
    "user": "https://github.com/mwhansen"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_013500.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "rename": {
        "from": "New class IntegerListLex for generating integer lists => much improved partition iterators",
        "to": "[pickle problem] New class IntegerListLex for generating integer lists => much improved partition iterators"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4549#event-13500"
}
```



---

archive/issue_comments_040068.json:
```json
{
    "body": "**Changing status** from positive_review to positive_review.",
    "created_at": "2009-02-15T08:37:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40068",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing status** from positive_review to positive_review.



---

archive/issue_comments_040069.json:
```json
{
    "body": "<a id='comment:8'></a>\nThis patch breaks the pickle jar which according to Mike is no surprise:\n\n```\nsage -t -long \"devel/sage/sage/structure/sage_object.pyx\"   \n**********************************************************************\nFile \"/scratch/mabshoff/sage-3.3.rc1/devel/sage/sage/structure/sage_object.pyx\", line 682:\n    sage: sage.structure.sage_object.unpickle_all(std)\nExpected:\n    doctest:...: DeprecationWarning: Your data is stored in an old format. Please use the save() function to store your data in a more recent format.\n    doctest:...: DeprecationWarning: RQDF is deprecated; use RealField(212) instead.\n    Successfully unpickled ... objects.\n    Failed to unpickle 0 objects.\nGot:\n    doctest:1172: DeprecationWarning: Your data is stored in an old format. Please use the save() function to store your data in a more recent format.\n    doctest:1172: DeprecationWarning: RQDF is deprecated; use RealField(212) instead.\n    ** failed:  _class__sage_combinat_partition_PartitionsGreatestEQ_nk__.sobj\n    ** failed:  _class__sage_combinat_partition_Partitions_constraints__.sobj\n    ** failed:  _class__sage_combinat_partition_PartitionsGreatestLE_nk__.sobj\n    Failed:\n    _class__sage_combinat_partition_PartitionsGreatestEQ_nk__.sobj\n    _class__sage_combinat_partition_Partitions_constraints__.sobj\n    _class__sage_combinat_partition_PartitionsGreatestLE_nk__.sobj\n    Successfully unpickled 445 objects.\n    Failed to unpickle 3 objects.\n**********************************************************************\n```\n\nWe need to make a call if we are going to break this pickles or not. Other than that there were no doctesting issues.\n\nCheers,\n\nMichael",
    "created_at": "2009-02-15T08:37:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40069",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:8'></a>
This patch breaks the pickle jar which according to Mike is no surprise:

```
sage -t -long "devel/sage/sage/structure/sage_object.pyx"   
**********************************************************************
File "/scratch/mabshoff/sage-3.3.rc1/devel/sage/sage/structure/sage_object.pyx", line 682:
    sage: sage.structure.sage_object.unpickle_all(std)
Expected:
    doctest:...: DeprecationWarning: Your data is stored in an old format. Please use the save() function to store your data in a more recent format.
    doctest:...: DeprecationWarning: RQDF is deprecated; use RealField(212) instead.
    Successfully unpickled ... objects.
    Failed to unpickle 0 objects.
Got:
    doctest:1172: DeprecationWarning: Your data is stored in an old format. Please use the save() function to store your data in a more recent format.
    doctest:1172: DeprecationWarning: RQDF is deprecated; use RealField(212) instead.
    ** failed:  _class__sage_combinat_partition_PartitionsGreatestEQ_nk__.sobj
    ** failed:  _class__sage_combinat_partition_Partitions_constraints__.sobj
    ** failed:  _class__sage_combinat_partition_PartitionsGreatestLE_nk__.sobj
    Failed:
    _class__sage_combinat_partition_PartitionsGreatestEQ_nk__.sobj
    _class__sage_combinat_partition_Partitions_constraints__.sobj
    _class__sage_combinat_partition_PartitionsGreatestLE_nk__.sobj
    Successfully unpickled 445 objects.
    Failed to unpickle 3 objects.
**********************************************************************
```

We need to make a call if we are going to break this pickles or not. Other than that there were no doctesting issues.

Cheers,

Michael



---

archive/issue_comments_040070.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [mhansen](#comment%3A5):\n> I've added a patch which adds some doctests, adds a warning when min_part=0 is passed to partitions, \n\nThanks!\n\n> and changed the default implementation of count to use Integers \n\n\nGood.\n\n> so that we don't have to reimplemented in IntegerListsLex\n\n\nWe still do! Sorry, I did not comment on this in the code, but the implementation of count differs from\nthe default one from CombinatorialClass, as it bypasses the call to _element_constructor_!",
    "created_at": "2009-02-15T22:32:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40070",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:9'></a>
Replying to [mhansen](#comment%3A5):
> I've added a patch which adds some doctests, adds a warning when min_part=0 is passed to partitions, 

Thanks!

> and changed the default implementation of count to use Integers 


Good.

> so that we don't have to reimplemented in IntegerListsLex


We still do! Sorry, I did not comment on this in the code, but the implementation of count differs from
the default one from CombinatorialClass, as it bypasses the call to _element_constructor_!



---

archive/issue_comments_040071.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [mabshoff](#comment%3A8):\n> This patch breaks the pickle jar which according to Mike is no surprise:\n\n\nIndeed no surprise. \n\n> We need to make a call if we are going to break this pickles or not. Other than that there were no doctesting issues.\n\n\nI would tend to break the pickles indeed, unless someone cries very loud for this.\n\nCheers,\n\t\t\t\tNicolas",
    "created_at": "2009-02-15T22:35:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40071",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:10'></a>
Replying to [mabshoff](#comment%3A8):
> This patch breaks the pickle jar which according to Mike is no surprise:


Indeed no surprise. 

> We need to make a call if we are going to break this pickles or not. Other than that there were no doctesting issues.


I would tend to break the pickles indeed, unless someone cries very loud for this.

Cheers,
				Nicolas



---

archive/issue_events_013501.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-02-16T04:59:59Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "milestone": "sage-3.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4549#event-13501"
}
```



---

archive/issue_events_013502.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-02-16T04:59:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "milestone": "sage-3.4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4549#event-13502"
}
```



---

archive/issue_comments_040072.json:
```json
{
    "body": "<a id='comment:11'></a>\nI am cleaning up the 3.3 milestone. If a patch with positive review is put up to this ticket on time it might make it into 3.3.\n\nCheers,\n\nMichael",
    "created_at": "2009-02-16T04:59:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40072",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:11'></a>
I am cleaning up the 3.3 milestone. If a patch with positive review is put up to this ticket on time it might make it into 3.3.

Cheers,

Michael



---

archive/issue_events_013503.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "rename": {
        "from": "[pickle problem] New class IntegerListLex for generating integer lists => much improved partition iterators",
        "to": "New class IntegerListLex for generating integer lists => much improved partition iterators"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4549#event-13503"
}
```



---

archive/issue_comments_040073.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2009-03-25T06:09:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40073",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing status** from positive_review to needs_work.



---

archive/attachments_005011.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "integer_lists_lex-4549-submitted.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket4549/integer_lists_lex-4549-submitted.patch",
    "created_at": "2009-04-02T05:27:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/nthiery"
}
```



---

archive/issue_comments_040074.json:
```json
{
    "body": "",
    "created_at": "2009-04-02T05:27:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40074",
    "user": "https://github.com/nthiery"
}
```





---

archive/issue_comments_040075.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,15 @@\n-See the title. Patch integer_lists_lex-nt in development in sage-combinat.\n+IntegerListsLex refactoring, and application to Partitions\n+\n+- Reworked the integer lists lexicographic generator into a full\n+  featured combinatorial class IntegerListsLex\n+- support for n in a set (or any iterable `I` implementing `n in I`)\n+\n+Applications to Partitions:\n+- Systematic use of IntegerListsLex to get constant amortized time\n+  iterators (huge efficiency improvement).\n+- This includes PartitionsGreatestEQ and PartitionsGreatestLE which\n+  were previously implemented in GAP. This was inefficient due to\n+  the communication overhead, and not using an iterator.\n+  (backward compatible unpickling)\n+- Implements horizontal_border_strip.\n+\n``````\n",
    "created_at": "2009-04-02T05:28:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40075",
    "user": "https://github.com/nthiery"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,15 @@
-See the title. Patch integer_lists_lex-nt in development in sage-combinat.
+IntegerListsLex refactoring, and application to Partitions
+
+- Reworked the integer lists lexicographic generator into a full
+  featured combinatorial class IntegerListsLex
+- support for n in a set (or any iterable `I` implementing `n in I`)
+
+Applications to Partitions:
+- Systematic use of IntegerListsLex to get constant amortized time
+  iterators (huge efficiency improvement).
+- This includes PartitionsGreatestEQ and PartitionsGreatestLE which
+  were previously implemented in GAP. This was inefficient due to
+  the communication overhead, and not using an iterator.
+  (backward compatible unpickling)
+- Implements horizontal_border_strip.
+
``````




---

archive/issue_comments_040076.json:
```json
{
    "body": "<a id='comment:13'></a>\nUpdated patch:\n- Now handles pickles of PartitionsGreatestEQ and PartitionsGreatestLE from sage <= 3.4.1.\n- Rebased against 3.4 (and sphinx)",
    "created_at": "2009-04-02T05:28:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40076",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:13'></a>
Updated patch:
- Now handles pickles of PartitionsGreatestEQ and PartitionsGreatestLE from sage <= 3.4.1.
- Rebased against 3.4 (and sphinx)



---

archive/issue_comments_040077.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2009-04-02T05:28:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40077",
    "user": "https://github.com/nthiery"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_040078.json:
```json
{
    "body": "<a id='comment:14'></a>\nI should mention: only the last patch is needed; it integrates the previous ones",
    "created_at": "2009-04-02T05:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40078",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:14'></a>
I should mention: only the last patch is needed; it integrates the previous ones



---

archive/issue_comments_040079.json:
```json
{
    "body": "<a id='comment:15'></a>\nDear Nicolas,\n\n> I should mention: only the last patch is needed; it integrates the previous ones\n\n\nThe patch looks good to me. However, though I'm not 100% sure I launched the correct check, it seems that one of the old pickle is still broken:\n\n```\nsage: std = os.environ['SAGE_DATA'] + '/extcode/pickle_jar/pickle_jar.tar.bz2'\nsage: sage.structure.sage_object.unpickle_all(std)\n** failed:  _class__sage_combinat_partition_Partitions_constraints__.sobj\n/usr/local/sage/sage/local/lib/python2.5/site-packages/IPython/iplib.py:2073: DeprecationWarning: RQDF is deprecated; use RealField(212) instead.\n  exec code_obj in self.user_global_ns, self.user_ns\nFailed:\n_class__sage_combinat_partition_Partitions_constraints__.sobj\nSuccessfully unpickled 486 objects.\nFailed to unpickle 1 objects.\n```\nAm I doing something wrong ?\n\nCheers,\n\nFlorent",
    "created_at": "2009-04-02T09:49:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40079",
    "user": "https://github.com/hivert"
}
```

<a id='comment:15'></a>
Dear Nicolas,

> I should mention: only the last patch is needed; it integrates the previous ones


The patch looks good to me. However, though I'm not 100% sure I launched the correct check, it seems that one of the old pickle is still broken:

```
sage: std = os.environ['SAGE_DATA'] + '/extcode/pickle_jar/pickle_jar.tar.bz2'
sage: sage.structure.sage_object.unpickle_all(std)
** failed:  _class__sage_combinat_partition_Partitions_constraints__.sobj
/usr/local/sage/sage/local/lib/python2.5/site-packages/IPython/iplib.py:2073: DeprecationWarning: RQDF is deprecated; use RealField(212) instead.
  exec code_obj in self.user_global_ns, self.user_ns
Failed:
_class__sage_combinat_partition_Partitions_constraints__.sobj
Successfully unpickled 486 objects.
Failed to unpickle 1 objects.
```
Am I doing something wrong ?

Cheers,

Florent



---

archive/issue_comments_040080.json:
```json
{
    "body": "Fix for the remaining broken pickle + tests for the other one.",
    "created_at": "2009-04-03T16:29:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40080",
    "user": "https://github.com/hivert"
}
```

Fix for the remaining broken pickle + tests for the other one.



---

archive/attachments_005012.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "integer_lists_lex-4549-review.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket4549/integer_lists_lex-4549-review.patch",
    "created_at": "2009-04-03T16:36:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/hivert"
}
```



---

archive/issue_comments_040081.json:
```json
{
    "body": "<a id='comment:16'></a>\nDear All,\n\n> The patch looks good to me. However, though I'm not 100% sure I launched the correct check, it seems that one of the old pickle is still broken:\n\n\nI added a review patch which should fix this remaining pickle problem. If someone reread it I'm ready to give a positive review. \n\nFlorent",
    "created_at": "2009-04-03T16:36:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40081",
    "user": "https://github.com/hivert"
}
```

<a id='comment:16'></a>
Dear All,

> The patch looks good to me. However, though I'm not 100% sure I launched the correct check, it seems that one of the old pickle is still broken:


I added a review patch which should fix this remaining pickle problem. If someone reread it I'm ready to give a positive review. 

Florent



---

archive/issue_comments_040082.json:
```json
{
    "body": "<a id='comment:17'></a>\nThanks Florent for the fix. I had overlooked this pickle. \nOh, and thanks for pointing out how one can test backward compatibility unpickles :-)\n\nI tried the patch on my machine and it looks and works fine.\n\nSo, I allow myself to set the positive review  flag on behalf of Florent!\n\nI also lifted the priority to major, since this gives a large (memory) efficiency gain.",
    "created_at": "2009-04-04T00:49:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40082",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:17'></a>
Thanks Florent for the fix. I had overlooked this pickle. 
Oh, and thanks for pointing out how one can test backward compatibility unpickles :-)

I tried the patch on my machine and it looks and works fine.

So, I allow myself to set the positive review  flag on behalf of Florent!

I also lifted the priority to major, since this gives a large (memory) efficiency gain.



---

archive/issue_comments_040083.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2009-04-04T00:49:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40083",
    "user": "https://github.com/nthiery"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_040084.json:
```json
{
    "body": "<a id='comment:18'></a>\nIf its still possible, I'd rather see this integrated in 3.4.1, this allows for #5308 being integrated as soon as possible.\n\nFlorent",
    "created_at": "2009-04-04T08:29:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40084",
    "user": "https://github.com/hivert"
}
```

<a id='comment:18'></a>
If its still possible, I'd rather see this integrated in 3.4.1, this allows for #5308 being integrated as soon as possible.

Florent



---

archive/issue_events_013504.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2009-04-04T08:29:26Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "milestone": "sage-3.4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4549#event-13504"
}
```



---

archive/issue_events_013505.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2009-04-04T08:29:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "milestone": "sage-3.4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4549#event-13505"
}
```



---

archive/issue_comments_040085.json:
```json
{
    "body": "<a id='comment:19'></a>\nMerged\n\n* integer_lists_lex-4549-submitted.patch\n* integer_lists_lex-4549-review.patch\n\nin Sage 3.4.1.rc0.\n\nCheers,\n\nMichael",
    "created_at": "2009-04-04T23:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40085",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:19'></a>
Merged

* integer_lists_lex-4549-submitted.patch
* integer_lists_lex-4549-review.patch

in Sage 3.4.1.rc0.

Cheers,

Michael



---

archive/issue_comments_040086.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2009-04-04T23:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4549#issuecomment-40086",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Resolution:** fixed



---

archive/issue_events_013506.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-04-04T23:56:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/4549",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4549#event-13506"
}
```
