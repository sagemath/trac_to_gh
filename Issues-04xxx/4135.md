# Issue 4135: notebook -- user management features

archive/issues_004135.json:
```json
{
    "body": "New features:\n- Reset a user's password\n- Add a new user\n- Suspend/unsuspend a user\n- Temporary password shown for each user if one is set (Created by password reset and add user)\n\n**Assignee:** TimothyClemans\n\n**Author:** Timothy Clemans\n\n**Reviewer:** Tim Dumol, Dan Drake\n\n**Merged:** Sage 4.1.2.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/4135\n\n",
    "closed_at": "2009-09-03T10:40:01Z",
    "created_at": "2008-09-16T16:38:32Z",
    "labels": [
        "component: notebook",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.1.2",
    "title": "notebook -- user management features",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/4135",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```
New features:
- Reset a user's password
- Add a new user
- Suspend/unsuspend a user
- Temporary password shown for each user if one is set (Created by password reset and add user)

**Assignee:** TimothyClemans

**Author:** Timothy Clemans

**Reviewer:** Tim Dumol, Dan Drake

**Merged:** Sage 4.1.2.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/4135





---

archive/issue_comments_031051.json:
```json
{
    "body": "<a id='comment:1'></a>\nDepends on #4134 and #2407",
    "created_at": "2008-09-16T16:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31051",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

<a id='comment:1'></a>
Depends on #4134 and #2407



---

archive/issue_events_011968.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-09-16T22:01:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "milestone": "sage-3.1.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4135#event-11968"
}
```



---

archive/issue_comments_031052.json:
```json
{
    "body": "<a id='comment:3'></a>\nI'm trying to review this, but I can't get the patches to apply. I'm starting from a clean 3.1.2 tree. Which patches should I apply, and in what order? Should I use a different version to apply patches against?",
    "created_at": "2008-09-26T05:32:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31052",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:3'></a>
I'm trying to review this, but I can't get the patches to apply. I'm starting from a clean 3.1.2 tree. Which patches should I apply, and in what order? Should I use a different version to apply patches against?



---

archive/issue_comments_031053.json:
```json
{
    "body": "<a id='comment:4'></a>\nThis ticket has been rebased.",
    "created_at": "2008-09-29T18:57:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31053",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

<a id='comment:4'></a>
This ticket has been rebased.



---

archive/issue_comments_031054.json:
```json
{
    "body": "<a id='comment:5'></a>\nIt seems that the /user page isn't found with an existing notebook.  I created a new notebook and the /users page came up.",
    "created_at": "2008-09-29T21:11:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31054",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:5'></a>
It seems that the /user page isn't found with an existing notebook.  I created a new notebook and the /users page came up.



---

archive/issue_comments_031055.json:
```json
{
    "body": "<a id='comment:6'></a>\nI've had trouble in the pass with getting administrative users recognized by the Notebook.",
    "created_at": "2008-09-29T21:15:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31055",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

<a id='comment:6'></a>
I've had trouble in the pass with getting administrative users recognized by the Notebook.



---

archive/issue_comments_031056.json:
```json
{
    "body": "<a id='comment:7'></a>\nI've applied all the necessary patches to a 3.1.3alpha1 tree, but when I try to start Sage, I get:\n\n```\n/var/tmp/sage-3.1.3.alpha1/local/lib/python2.5/site-packages/sage/server/notebook/twist.py in <module>()\n   1935     return False\n   1936 \n-> 1937 from sage.server.notebook.template import registration_page_template\n   1938 from sage.server.notebook.template import login_page_template\n   1939 \n\n/var/tmp/sage-3.1.3.alpha1/local/lib/python2.5/site-packages/sage/server/notebook/template.py in <module>()\n     38 templates = ['login', 'yes_no', 'failed_login', 'register', 'admin_add_user']\n     39 for name in templates:\n---> 40     G[name + '_template'] =  PageTemplate(pjoin(path, '%s.template'%name))\n     41 \n     42 def login_page_template(accounts, default_user, is_username_error=False, is_password_error=False, welcome=None, recover=False):\n\n/var/tmp/sage-3.1.3.alpha1/local/lib/python2.5/site-packages/sage/server/notebook/template.py in __init__(self, filename)\n     27 class PageTemplate:\n     28     def __init__(self, filename):\n---> 29         file = open(filename, 'r')\n     30         self.__template = Template(file.read())\n     31         file.close()\n\nIOError: [Errno 2] No such file or directory: '/var/tmp/sage-3.1.3.alpha1/data/extcode/notebook/templates/admin_add_user.template'\n```\nThat's just the last part of the traceback; the rest doesn't seem so interesting...but let me know if you want to see it.\n\nI've looked through the patches from 4134, 2407, and this ticket, and I don't see where the file `admin_add_user.template` is created. I have all those patches applied (except 4134, which has already been merged); how do I get that file?",
    "created_at": "2008-09-30T01:40:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31056",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:7'></a>
I've applied all the necessary patches to a 3.1.3alpha1 tree, but when I try to start Sage, I get:

```
/var/tmp/sage-3.1.3.alpha1/local/lib/python2.5/site-packages/sage/server/notebook/twist.py in <module>()
   1935     return False
   1936 
-> 1937 from sage.server.notebook.template import registration_page_template
   1938 from sage.server.notebook.template import login_page_template
   1939 

/var/tmp/sage-3.1.3.alpha1/local/lib/python2.5/site-packages/sage/server/notebook/template.py in <module>()
     38 templates = ['login', 'yes_no', 'failed_login', 'register', 'admin_add_user']
     39 for name in templates:
---> 40     G[name + '_template'] =  PageTemplate(pjoin(path, '%s.template'%name))
     41 
     42 def login_page_template(accounts, default_user, is_username_error=False, is_password_error=False, welcome=None, recover=False):

/var/tmp/sage-3.1.3.alpha1/local/lib/python2.5/site-packages/sage/server/notebook/template.py in __init__(self, filename)
     27 class PageTemplate:
     28     def __init__(self, filename):
---> 29         file = open(filename, 'r')
     30         self.__template = Template(file.read())
     31         file.close()

IOError: [Errno 2] No such file or directory: '/var/tmp/sage-3.1.3.alpha1/data/extcode/notebook/templates/admin_add_user.template'
```
That's just the last part of the traceback; the rest doesn't seem so interesting...but let me know if you want to see it.

I've looked through the patches from 4134, 2407, and this ticket, and I don't see where the file `admin_add_user.template` is created. I have all those patches applied (except 4134, which has already been merged); how do I get that file?



---

archive/issue_comments_031057.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [ddrake](#comment%3A7):\n> I've looked through the patches from 4134, 2407, and this ticket, and I don't see where the file `admin_add_user.template` is created. I have all those patches applied (except 4134, which has already been merged); how do I get that file?\n\n\nDid you do ` hg_extcode.apply('http://trac.sagemath.org/sage_trac/attachment/ticket/4135/extcode-4135_1.patch') `",
    "created_at": "2008-09-30T02:03:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31057",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

<a id='comment:8'></a>
Replying to [ddrake](#comment%3A7):
> I've looked through the patches from 4134, 2407, and this ticket, and I don't see where the file `admin_add_user.template` is created. I have all those patches applied (except 4134, which has already been merged); how do I get that file?


Did you do ` hg_extcode.apply('http://trac.sagemath.org/sage_trac/attachment/ticket/4135/extcode-4135_1.patch') `



---

archive/issue_comments_031058.json:
```json
{
    "body": "<a id='comment:9'></a>\nOr if you're using queues and don't want to mess up your tree, go to $SAGE_ROOT/data/extcode and do:\n\n```\nhg qinit\nhg qimport /path/to/extcode-patch\nhg qpush\n```",
    "created_at": "2008-09-30T02:57:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31058",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:9'></a>
Or if you're using queues and don't want to mess up your tree, go to $SAGE_ROOT/data/extcode and do:

```
hg qinit
hg qimport /path/to/extcode-patch
hg qpush
```



---

archive/issue_comments_031059.json:
```json
{
    "body": "<a id='comment:10'></a>\nTimothy, what is the relationship between this patch and #3923, #3937, and #3949.",
    "created_at": "2008-10-24T00:02:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31059",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:10'></a>
Timothy, what is the relationship between this patch and #3923, #3937, and #3949.



---

archive/issue_comments_031060.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2008-11-09T01:33:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31060",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_031061.json:
```json
{
    "body": "<a id='comment:12'></a>\nApply just extcode-4135_1.patch and sage-4145_3.patch",
    "created_at": "2008-11-11T01:23:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31061",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

<a id='comment:12'></a>
Apply just extcode-4135_1.patch and sage-4145_3.patch



---

archive/issue_comments_031062.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2008-11-11T01:23:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31062",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_031063.json:
```json
{
    "body": "**Changing assignee** from boothby to TimothyClemans.",
    "created_at": "2008-11-11T01:24:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31063",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

**Changing assignee** from boothby to TimothyClemans.



---

archive/issue_comments_031064.json:
```json
{
    "body": "**Changing status** from new to assigned.",
    "created_at": "2008-11-11T01:24:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31064",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

**Changing status** from new to assigned.



---

archive/issue_comments_031065.json:
```json
{
    "body": "<a id='comment:14'></a>\nDepends on #3950",
    "created_at": "2008-11-11T05:20:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31065",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

<a id='comment:14'></a>
Depends on #3950



---

archive/issue_comments_031066.json:
```json
{
    "body": "<a id='comment:15'></a>\nDon't apply extcode-4135_1.patch afterall",
    "created_at": "2008-11-11T05:33:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31066",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

<a id='comment:15'></a>
Don't apply extcode-4135_1.patch afterall



---

archive/issue_comments_031067.json:
```json
{
    "body": "<a id='comment:16'></a>\nApply sage-4135_3.patch and sage-4135_4.patch",
    "created_at": "2008-12-20T20:07:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31067",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

<a id='comment:16'></a>
Apply sage-4135_3.patch and sage-4135_4.patch



---

archive/attachments_004387.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_4135.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket4135/trac_4135.patch",
    "created_at": "2009-01-19T07:19:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/mwhansen"
}
```



---

archive/issue_comments_031068.json:
```json
{
    "body": "",
    "created_at": "2009-01-19T07:19:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31068",
    "user": "https://github.com/mwhansen"
}
```





---

archive/issue_comments_031069.json:
```json
{
    "body": "<a id='comment:17'></a>\nCan we get a review for this since this patch is holding up several other patches?\n\nCheers,\n\nMichael",
    "created_at": "2009-02-02T05:13:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31069",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:17'></a>
Can we get a review for this since this patch is holding up several other patches?

Cheers,

Michael



---

archive/issue_comments_031070.json:
```json
{
    "body": "<a id='comment:18'></a>\nI applied mhansen's patch to a clean 3.3.alpha3 tree, deleted my .sage/sage_notebook directory to start fresh, but I still get problems: I log in, click \"Manage Users\", click \"Add user\", then put in a name and hit \"Create account\". The resulting page is blank and has the title \"Error | Sage Notebook\".\n\nIf I hit the back button to get back to the \"add a user\" page, then click cancel, I get to the user management page, which lists the user I tried to add.\n\nIf I click on the user's name, I go to the usual \"home page\", and it lists the user's name as if I am logged in as that user...but I thought I was logged in as admin? If I then click on Settings, I can go to the user management page and...well, manage users.\n\nRight now, this patch seems to need work. Am I doing something wrong?",
    "created_at": "2009-02-03T00:24:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31070",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:18'></a>
I applied mhansen's patch to a clean 3.3.alpha3 tree, deleted my .sage/sage_notebook directory to start fresh, but I still get problems: I log in, click "Manage Users", click "Add user", then put in a name and hit "Create account". The resulting page is blank and has the title "Error | Sage Notebook".

If I hit the back button to get back to the "add a user" page, then click cancel, I get to the user management page, which lists the user I tried to add.

If I click on the user's name, I go to the usual "home page", and it lists the user's name as if I am logged in as that user...but I thought I was logged in as admin? If I then click on Settings, I can go to the user management page and...well, manage users.

Right now, this patch seems to need work. Am I doing something wrong?



---

archive/issue_comments_031071.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2009-02-08T01:31:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31071",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

**Changing status** from needs_review to needs_work.



---

archive/attachments_004388.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_4135.2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket4135/trac_4135.2.patch",
    "created_at": "2009-03-16T19:41:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```



---

archive/issue_comments_031072.json:
```json
{
    "body": "",
    "created_at": "2009-03-16T19:41:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31072",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```





---

archive/issue_comments_031073.json:
```json
{
    "body": "<a id='comment:20'></a>\nThere was a bug in the error_message.html template.",
    "created_at": "2009-03-16T19:42:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31073",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

<a id='comment:20'></a>
There was a bug in the error_message.html template.



---

archive/issue_comments_031074.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2009-03-16T19:42:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31074",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_031075.json:
```json
{
    "body": "<a id='comment:21'></a>\nI've applied the patch to a 3.4 tree and all the bits seem to work.",
    "created_at": "2009-03-16T23:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31075",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:21'></a>
I've applied the patch to a 3.4 tree and all the bits seem to work.



---

archive/attachments_004389.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_4135.3.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket4135/trac_4135.3.patch",
    "created_at": "2009-04-14T01:03:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/dandrake"
}
```



---

archive/issue_comments_031076.json:
```json
{
    "body": "trac_4135.2.patch rebased for 3.4.1.rc2",
    "created_at": "2009-04-14T01:03:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31076",
    "user": "https://github.com/dandrake"
}
```

trac_4135.2.patch rebased for 3.4.1.rc2



---

archive/issue_comments_031077.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2009-04-14T01:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31077",
    "user": "https://github.com/dandrake"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_031078.json:
```json
{
    "body": "<a id='comment:22'></a>\nI've rebased this patch for 3.4.1.rc2 and give it a slightly weak positive review -- I still don't know Twisted or the notebook code terribly well, and would appreciate it if someone who knows it better would also take a look at this patch.",
    "created_at": "2009-04-14T01:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31078",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:22'></a>
I've rebased this patch for 3.4.1.rc2 and give it a slightly weak positive review -- I still don't know Twisted or the notebook code terribly well, and would appreciate it if someone who knows it better would also take a look at this patch.



---

archive/issue_comments_031079.json:
```json
{
    "body": "**Changing status** from positive_review to needs_review.",
    "created_at": "2009-04-24T02:39:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31079",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing status** from positive_review to needs_review.



---

archive/issue_comments_031080.json:
```json
{
    "body": "<a id='comment:23'></a>\nHmm, given this is rather crucial and hard to test code I would be happy if someone else did take another look, so \"needs review\" to attract someone else.\n\nCheers,\n\nMichael",
    "created_at": "2009-04-24T02:39:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31080",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:23'></a>
Hmm, given this is rather crucial and hard to test code I would be happy if someone else did take another look, so "needs review" to attract someone else.

Cheers,

Michael



---

archive/issue_comments_031081.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2009-07-27T13:37:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31081",
    "user": "https://github.com/TimDumol"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_031082.json:
```json
{
    "body": "<a id='comment:24'></a>\nApplied patch to r12658.\n\nEverything works perfectly except for the cancel link in the Account Settings page. It links to /home, leading to a 404 Error. I believe /home/<username>/ is the proper way to link it.",
    "created_at": "2009-07-27T13:37:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31082",
    "user": "https://github.com/TimDumol"
}
```

<a id='comment:24'></a>
Applied patch to r12658.

Everything works perfectly except for the cancel link in the Account Settings page. It links to /home, leading to a 404 Error. I believe /home/<username>/ is the proper way to link it.



---

archive/issue_comments_031083.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [timdumol](#comment%3A24):\n> Applied patch to r12658.\n> \n> Everything works perfectly except for the cancel link in the Account Settings page. It links to /home, leading to a 404 Error. I believe /home/<username>/ is the proper way to link it.\n\n\nI see the same error. I put in a `<pre>{{ debug()|e }}</pre>` bit (see http://jinja.pocoo.org/1/documentation/designerdoc) into `account_settings.html` and it looks like the template engine is not getting a username.",
    "created_at": "2009-07-27T22:38:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31083",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:25'></a>
Replying to [timdumol](#comment%3A24):
> Applied patch to r12658.
> 
> Everything works perfectly except for the cancel link in the Account Settings page. It links to /home, leading to a 404 Error. I believe /home/<username>/ is the proper way to link it.


I see the same error. I put in a `<pre>{{ debug()|e }}</pre>` bit (see http://jinja.pocoo.org/1/documentation/designerdoc) into `account_settings.html` and it looks like the template engine is not getting a username.



---

archive/issue_comments_031084.json:
```json
{
    "body": "<a id='comment:26'></a>\nFor the cancel button not working, see the patch at #6856. (I created that ticket before seeing the issue was already mentioned here.)",
    "created_at": "2009-09-01T17:32:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31084",
    "user": "https://github.com/wjp"
}
```

<a id='comment:26'></a>
For the cancel button not working, see the patch at #6856. (I created that ticket before seeing the issue was already mentioned here.)



---

archive/issue_comments_031085.json:
```json
{
    "body": "<a id='comment:27'></a>\nI don't understand how (or if?) this patch implements the mentioned temporary password functionality. There is a new '__temporary_password' variable, but that doesn't seem to be used.",
    "created_at": "2009-09-01T18:30:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31085",
    "user": "https://github.com/wjp"
}
```

<a id='comment:27'></a>
I don't understand how (or if?) this patch implements the mentioned temporary password functionality. There is a new '__temporary_password' variable, but that doesn't seem to be used.



---

archive/issue_comments_031086.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [wjp](#comment%3A27):\n> I don't understand how (or if?) this patch implements the mentioned temporary password functionality. There is a new '__temporary_password' variable, but that doesn't seem to be used.\n\n\nWhen one adds a new user, you get a page saying \"The temporary password for the new user foo is 52oN5g2a\". Unfortunately, that password does not seem to be temporary; the new user can log in and out, and back in again with that password. When I read \"temporary password\", I think that the user will be able to log in once, and then be forced to change the password right away.\n\nAnother problem with the temporary password page is that the title of the page is \"Error\", even though there's no error.\n\nThat said: this patch, along with #6856 (which I just positively reviewed) does give us the basic functionality for adding users and resetting passwords from inside the notebook, which is something I'd really like. The last patch applies cleanly to 4.1.1. What do people think of merging this and opening a new ticket to fix the temporary password bits? (Or changing this patch so that it doesn't claim that the new password is temporary?)",
    "created_at": "2009-09-01T23:49:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31086",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:28'></a>
Replying to [wjp](#comment%3A27):
> I don't understand how (or if?) this patch implements the mentioned temporary password functionality. There is a new '__temporary_password' variable, but that doesn't seem to be used.


When one adds a new user, you get a page saying "The temporary password for the new user foo is 52oN5g2a". Unfortunately, that password does not seem to be temporary; the new user can log in and out, and back in again with that password. When I read "temporary password", I think that the user will be able to log in once, and then be forced to change the password right away.

Another problem with the temporary password page is that the title of the page is "Error", even though there's no error.

That said: this patch, along with #6856 (which I just positively reviewed) does give us the basic functionality for adding users and resetting passwords from inside the notebook, which is something I'd really like. The last patch applies cleanly to 4.1.1. What do people think of merging this and opening a new ticket to fix the temporary password bits? (Or changing this patch so that it doesn't claim that the new password is temporary?)



---

archive/issue_comments_031087.json:
```json
{
    "body": "<a id='comment:29'></a>\nI'd agree with not holding up this patch because of this, because it is already a very useful feature to have.\n\nThis patch does probably have to be rebased against #6568, though.",
    "created_at": "2009-09-02T09:00:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31087",
    "user": "https://github.com/wjp"
}
```

<a id='comment:29'></a>
I'd agree with not holding up this patch because of this, because it is already a very useful feature to have.

This patch does probably have to be rebased against #6568, though.



---

archive/issue_comments_031088.json:
```json
{
    "body": "rebased against 4.1.1 + #6568",
    "created_at": "2009-09-03T03:07:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31088",
    "user": "https://github.com/dandrake"
}
```

rebased against 4.1.1 + #6568



---

archive/issue_comments_031089.json:
```json
{
    "body": "**Author:** Timothy Clemans",
    "created_at": "2009-09-03T03:15:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31089",
    "user": "https://github.com/dandrake"
}
```

**Author:** Timothy Clemans



---

archive/attachments_004390.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_4135.4.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket4135/trac_4135.4.patch",
    "created_at": "2009-09-03T03:15:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/dandrake"
}
```



---

archive/issue_comments_031090.json:
```json
{
    "body": "<a id='comment:30'></a>\nRebased patch up. This should apply cleanly to the release manager's 4.1.2.alpha tree. I am going to change this to a positive review and open a new ticket for the temporary password business.\n\nRelease manager: apply only attachment:trac_4135.4.patch.",
    "created_at": "2009-09-03T03:15:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31090",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:30'></a>
Rebased patch up. This should apply cleanly to the release manager's 4.1.2.alpha tree. I am going to change this to a positive review and open a new ticket for the temporary password business.

Release manager: apply only attachment:trac_4135.4.patch.



---

archive/issue_comments_031091.json:
```json
{
    "body": "**Reviewer:** Tim Dumol, Dan Drake",
    "created_at": "2009-09-03T03:15:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31091",
    "user": "https://github.com/dandrake"
}
```

**Reviewer:** Tim Dumol, Dan Drake



---

archive/issue_comments_031092.json:
```json
{
    "body": "**Changing status** from needs_work to positive_review.",
    "created_at": "2009-09-03T03:15:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31092",
    "user": "https://github.com/dandrake"
}
```

**Changing status** from needs_work to positive_review.



---

archive/issue_comments_031093.json:
```json
{
    "body": "<a id='comment:31'></a>\nThe temporary password ticket is #6871.",
    "created_at": "2009-09-03T03:19:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31093",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:31'></a>
The temporary password ticket is #6871.



---

archive/issue_comments_031094.json:
```json
{
    "body": "<a id='comment:32'></a>\nI got two hunk failures when merging `trac_4135.4.patch`:\n\n```\n[mvngu@mod sage-main]$ hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/4135/trac_4135.4.patch && hg qpush\nadding trac_4135.4.patch to series file\napplying trac_4135.4.patch\npatching file sage/server/notebook/twist.py\nHunk #6 FAILED at 217\nHunk #69 FAILED at 1747\n2 out of 102 hunks FAILED -- saving rejects to file sage/server/notebook/twist.py.rej\npatch failed, unable to continue (try -v)\npatch failed, rejects left in working dir\nErrors during apply, please fix and refresh trac_4135.4.patch\n```\nThis might depend on #6742, #6840, and #6568.",
    "created_at": "2009-09-03T06:34:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31094",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:32'></a>
I got two hunk failures when merging `trac_4135.4.patch`:

```
[mvngu@mod sage-main]$ hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/4135/trac_4135.4.patch && hg qpush
adding trac_4135.4.patch to series file
applying trac_4135.4.patch
patching file sage/server/notebook/twist.py
Hunk #6 FAILED at 217
Hunk #69 FAILED at 1747
2 out of 102 hunks FAILED -- saving rejects to file sage/server/notebook/twist.py.rej
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
Errors during apply, please fix and refresh trac_4135.4.patch
```
This might depend on #6742, #6840, and #6568.



---

archive/issue_comments_031095.json:
```json
{
    "body": "<a id='comment:33'></a>\nReplying to [mvngu](#comment%3A32):\n> I got two hunk failures when merging `trac_4135.4.patch`:\n\n\n(snip)\n\n> This might depend on #6742, #6840, and #6568.\n\n\nI tried applying the patch here on top of a 4.1.1 tree that already had the patches from those three tickets applied, and I get a different hunk that won't apply. Perhaps I'll wait for the alpha0 tarball to be released and rebase the patch here based on that...or, you could `hg serve` your merge tree and let me pull from that.",
    "created_at": "2009-09-03T08:11:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31095",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:33'></a>
Replying to [mvngu](#comment%3A32):
> I got two hunk failures when merging `trac_4135.4.patch`:


(snip)

> This might depend on #6742, #6840, and #6568.


I tried applying the patch here on top of a 4.1.1 tree that already had the patches from those three tickets applied, and I get a different hunk that won't apply. Perhaps I'll wait for the alpha0 tarball to be released and rebase the patch here based on that...or, you could `hg serve` your merge tree and let me pull from that.



---

archive/attachments_004391.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_4135.5.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket4135/trac_4135.5.patch",
    "created_at": "2009-09-03T08:42:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/dandrake"
}
```



---

archive/issue_comments_031096.json:
```json
{
    "body": "rebased against mvngu's 4.1.2.alpha0 merge tree",
    "created_at": "2009-09-03T08:42:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31096",
    "user": "https://github.com/dandrake"
}
```

rebased against mvngu's 4.1.2.alpha0 merge tree



---

archive/issue_events_011969.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2009-09-03T10:40:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4135#event-11969"
}
```



---

archive/issue_comments_031097.json:
```json
{
    "body": "<a id='comment:34'></a>\nMerged `trac_4135.5.patch`. See #6874 for a follow-up to this ticket.",
    "created_at": "2009-09-03T10:40:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31097",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:34'></a>
Merged `trac_4135.5.patch`. See #6874 for a follow-up to this ticket.



---

archive/issue_comments_031098.json:
```json
{
    "body": "**Merged:** Sage 4.1.2.alpha0",
    "created_at": "2009-09-03T10:40:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4135",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4135#issuecomment-31098",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Merged:** Sage 4.1.2.alpha0
