# Issue 4433: Replace factorial with a symbolic version

archive/issues_004433.json:
```json
{
    "body": "This patch depends on #4432. It replaces the factorial in sage.rings.arith with the symbolic\nversion of #4432 in sage.calculus.calculus.\n\nFor now sage.rings.arith.factorial is just renamed to factorial_numeric, otherwise I got\ncircular imports at Sage startup.\n\nThe patch is against sage-3.2alpha1.\n\nAfter applying this patch plus the patches at #4432 all doctests passed.\n\nA sample session:\n\n```\nsage: gamma(x/2)(x=5)\n3*sqrt(pi)/4\n\nsage: f = factorial(x + factorial(y))\nsage: maxima(f).sage()\nfactorial(factorial(y) + x)\n\nsage: f(y=x)(x=3)\n362880\n```\n\n\n\n**Assignee:** whuss\n\nIssue created by migration from https://trac.sagemath.org/ticket/4433\n\n",
    "closed_at": "2008-11-28T07:28:57Z",
    "created_at": "2008-11-03T20:07:01Z",
    "labels": [
        "component: calculus",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-3.2.1",
    "title": "Replace factorial with a symbolic version",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/4433",
    "user": "https://trac.sagemath.org/admin/accounts/users/whuss"
}
```
This patch depends on #4432. It replaces the factorial in sage.rings.arith with the symbolic
version of #4432 in sage.calculus.calculus.

For now sage.rings.arith.factorial is just renamed to factorial_numeric, otherwise I got
circular imports at Sage startup.

The patch is against sage-3.2alpha1.

After applying this patch plus the patches at #4432 all doctests passed.

A sample session:

```
sage: gamma(x/2)(x=5)
3*sqrt(pi)/4

sage: f = factorial(x + factorial(y))
sage: maxima(f).sage()
factorial(factorial(y) + x)

sage: f(y=x)(x=3)
362880
```



**Assignee:** whuss

Issue created by migration from https://trac.sagemath.org/ticket/4433





---

archive/attachments_004770.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "factorial.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket4433/factorial.patch",
    "created_at": "2008-11-03T20:07:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/whuss"
}
```



---

archive/issue_comments_034056.json:
```json
{
    "body": "",
    "created_at": "2008-11-03T20:07:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4433#issuecomment-34056",
    "user": "https://trac.sagemath.org/admin/accounts/users/whuss"
}
```





---

archive/issue_comments_034057.json:
```json
{
    "body": "**Changing assignee** from @burcin to whuss.",
    "created_at": "2008-11-03T20:13:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4433#issuecomment-34057",
    "user": "https://trac.sagemath.org/admin/accounts/users/whuss"
}
```

**Changing assignee** from @burcin to whuss.



---

archive/issue_comments_034058.json:
```json
{
    "body": "<a id='comment:3'></a>\nI don't understand the purpose of converting everything to use the new factorial function defined in calculus.all since none of the existing code needed any of the functionality it provides.",
    "created_at": "2008-11-04T21:03:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4433#issuecomment-34058",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:3'></a>
I don't understand the purpose of converting everything to use the new factorial function defined in calculus.all since none of the existing code needed any of the functionality it provides.



---

archive/attachments_004771.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "factorial2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket4433/factorial2.patch",
    "created_at": "2008-11-05T16:31:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/whuss"
}
```



---

archive/issue_comments_034059.json:
```json
{
    "body": "",
    "created_at": "2008-11-05T16:31:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4433#issuecomment-34059",
    "user": "https://trac.sagemath.org/admin/accounts/users/whuss"
}
```





---

archive/issue_comments_034060.json:
```json
{
    "body": "<a id='comment:4'></a>\nI wanted to remove the factorial in rings.arith completely, because I think it is confusing\nto have to different factorial functions at the toplevel. Also Sage doesn't do this for the\nother symbolic functions like sin().\n\nIn the previous version rings.arith.factorial_numeric() was just there because I had not yet\nsolved the problem of circular imports at Sage startup.\n\nNow second patch that I just uploaded fixes this problem. Now there is only the factorial\nin calculus.all.\n\nWith both patches applied to sage-3.2alpha1 all doctests pass for me.",
    "created_at": "2008-11-05T16:39:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4433#issuecomment-34060",
    "user": "https://trac.sagemath.org/admin/accounts/users/whuss"
}
```

<a id='comment:4'></a>
I wanted to remove the factorial in rings.arith completely, because I think it is confusing
to have to different factorial functions at the toplevel. Also Sage doesn't do this for the
other symbolic functions like sin().

In the previous version rings.arith.factorial_numeric() was just there because I had not yet
solved the problem of circular imports at Sage startup.

Now second patch that I just uploaded fixes this problem. Now there is only the factorial
in calculus.all.

With both patches applied to sage-3.2alpha1 all doctests pass for me.



---

archive/issue_comments_034061.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2008-11-05T17:11:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4433#issuecomment-34061",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_034062.json:
```json
{
    "body": "<a id='comment:5'></a>\nA couple remarks:\n\n* the first patch removes \"!\" from the list of tokens which we used to ignore up to now. Now it changes meaning to be factorial, but I am not so sure it is a good idea since we use to explicitly forbid it. I don't know the reason why we did that, so see my comment below.\n* the second patch removes fact() [nee factorial_numeric()] from arith.py, but policy is to deprecate removed functions, especially something as simple and long existing like fact() in that file cannot be just removed. See \"def dynkin_diagram(t)\" in combinat/root_system/dynkin_diagram.py for an good example on how to use deprecation in Sage. \n\nEspecially the \"!\" change should be discussed on [sage-devel] since that is a rather fundamental change. I also cannot find a single occurrence of \"!\" in the docstring or tests, but maybe I  overlooked something. *If* the patch is merged with the \"!\" change it needs to be doctests.\n\nCheers,\n\nMichael",
    "created_at": "2008-11-05T17:11:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4433#issuecomment-34062",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:5'></a>
A couple remarks:

* the first patch removes "!" from the list of tokens which we used to ignore up to now. Now it changes meaning to be factorial, but I am not so sure it is a good idea since we use to explicitly forbid it. I don't know the reason why we did that, so see my comment below.
* the second patch removes fact() [nee factorial_numeric()] from arith.py, but policy is to deprecate removed functions, especially something as simple and long existing like fact() in that file cannot be just removed. See "def dynkin_diagram(t)" in combinat/root_system/dynkin_diagram.py for an good example on how to use deprecation in Sage. 

Especially the "!" change should be discussed on [sage-devel] since that is a rather fundamental change. I also cannot find a single occurrence of "!" in the docstring or tests, but maybe I  overlooked something. *If* the patch is merged with the "!" change it needs to be doctests.

Cheers,

Michael



---

archive/issue_comments_034063.json:
```json
{
    "body": "<a id='comment:6'></a>\nAnd a final comment about calculus.py: That file is rather large and messy, so there are various people who think that the file should be split up in the future. \"New symbolics\" might be just what is required there in the long term.\n\nCheers,\n\nMichael",
    "created_at": "2008-11-05T17:13:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4433#issuecomment-34063",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:6'></a>
And a final comment about calculus.py: That file is rather large and messy, so there are various people who think that the file should be split up in the future. "New symbolics" might be just what is required there in the long term.

Cheers,

Michael



---

archive/issue_comments_034064.json:
```json
{
    "body": "<a id='comment:7'></a>\nWe also shouldn't get rid of the documentation and algorithm keyword in sage.rings.arith.factorial just because.  Overall, I'd recommend just leaving it as is and not importing it to the top level.",
    "created_at": "2008-11-05T17:15:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4433#issuecomment-34064",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:7'></a>
We also shouldn't get rid of the documentation and algorithm keyword in sage.rings.arith.factorial just because.  Overall, I'd recommend just leaving it as is and not importing it to the top level.



---

archive/issue_comments_034065.json:
```json
{
    "body": "<a id='comment:8'></a>\nMike Hansen just pointed out to me in IRC that the \"!\" is used on the Maxima side, so I was wrong and you can disregard my comment about that.\n\nCheers,\n\nMichael",
    "created_at": "2008-11-05T21:45:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4433#issuecomment-34065",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:8'></a>
Mike Hansen just pointed out to me in IRC that the "!" is used on the Maxima side, so I was wrong and you can disregard my comment about that.

Cheers,

Michael



---

archive/attachments_004772.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "factorial3.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket4433/factorial3.patch",
    "created_at": "2008-11-06T12:47:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/whuss"
}
```



---

archive/issue_comments_034066.json:
```json
{
    "body": "supersedes the previous two patches",
    "created_at": "2008-11-06T12:47:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4433#issuecomment-34066",
    "user": "https://trac.sagemath.org/admin/accounts/users/whuss"
}
```

supersedes the previous two patches



---

archive/issue_comments_034067.json:
```json
{
    "body": "<a id='comment:9'></a>\nIn the new patch sage.rings.arith.factorial is kept but deprecated.",
    "created_at": "2008-11-06T12:49:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4433#issuecomment-34067",
    "user": "https://trac.sagemath.org/admin/accounts/users/whuss"
}
```

<a id='comment:9'></a>
In the new patch sage.rings.arith.factorial is kept but deprecated.



---

archive/issue_comments_034068.json:
```json
{
    "body": "<a id='comment:10'></a>\nThe other issues should by fixed by the latest patch for #4432.",
    "created_at": "2008-11-06T13:35:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4433#issuecomment-34068",
    "user": "https://trac.sagemath.org/admin/accounts/users/whuss"
}
```

<a id='comment:10'></a>
The other issues should by fixed by the latest patch for #4432.



---

archive/issue_comments_034069.json:
```json
{
    "body": "<a id='comment:11'></a>\nSince there is a new patch up here this one needs review again.\n\nCheers,\n\nMichael",
    "created_at": "2008-11-21T09:29:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4433#issuecomment-34069",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:11'></a>
Since there is a new patch up here this one needs review again.

Cheers,

Michael



---

archive/issue_comments_034070.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2008-11-21T09:29:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4433#issuecomment-34070",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_events_012735.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-11-28T07:28:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4433#event-12735"
}
```



---

archive/issue_comments_034071.json:
```json
{
    "body": "<a id='comment:12'></a>\nFixed by #4432 in Sage 3.2.1.rc0",
    "created_at": "2008-11-28T07:28:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4433#issuecomment-34071",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:12'></a>
Fixed by #4432 in Sage 3.2.1.rc0



---

archive/issue_comments_034072.json:
```json
{
    "body": "<a id='comment:13'></a>\nThe positive review stems from the review of the cumulative patch at #4432.\n\nCheers,\n\nMichael",
    "created_at": "2008-11-28T07:30:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4433#issuecomment-34072",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:13'></a>
The positive review stems from the review of the cumulative patch at #4432.

Cheers,

Michael



---

archive/issue_comments_034073.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2008-11-28T07:30:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4433",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4433#issuecomment-34073",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing status** from needs_review to positive_review.
