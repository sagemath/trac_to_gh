# Issue 4786: [with patch, positive review] fix some bugs / typos in the solve function

archive/issues_004786.json:
```json
{
    "body": "```\nIs this the right place for suggestions for the function \"solve\" ?\n\n1) The docstring has a typo : \"... solve an equation of system ...\"\nShould be an \"or\" here.\n\n2) The section\n\" solution_dict = True -- return a list of dictionaries containing the\nsolutions. \"\nmade me think that solution_dict defaults to True which is not the case.\nMaybe this could be made more clear.\n\n3) 'solution_dict = True' fails when only a single univariate equation\nis given. The solution is then not a list of lists and the conversion to\ndictionary fails:\n\nsage: var('a')\na\nsage: solve ([a^2-1],a,solution_dict=True)\n-\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n\n/home/tom/<ipython console> in <module>()\n\n/usr/local/sage/local/lib/python2.5/site-packages/sage/calculus/equations.pyc\nin solve(f, *args, **kwds)\n  1436         sol_list = string_to_list_of_solutions(a)\n  1437         if 'solution_dict' in kwds and kwds['solution_dict']==True:\n- -> 1438             sol_dict=[dict([[eq.left(),eq.right()] for eq in\nsolution]) for solution in sol_list]\n  1439             return sol_dict\n  1440         else:\n\nAttributeError: 'SymbolicVariable' object has no attribute 'left'\n\n\nThanks for your great work.\nThomas\n```\n\nAssignee: @burcin\n\nResolution: fixed\n\nAuthor: Karl-Dieter Crisman, Burcin Erocal\n\nReviewer: Burcin Erocal, Karl-Dieter Crisman\n\nMerged: Sage 4.1.2.alpha2\n\nIssue created by migration from https://trac.sagemath.org/ticket/4786\n\n",
    "closed_at": "2009-09-15T19:34:55Z",
    "created_at": "2008-12-13T21:43:31Z",
    "labels": [
        "component: calculus",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.1.2",
    "title": "[with patch, positive review] fix some bugs / typos in the solve function",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/4786",
    "user": "https://github.com/williamstein"
}
```
```
Is this the right place for suggestions for the function "solve" ?

1) The docstring has a typo : "... solve an equation of system ..."
Should be an "or" here.

2) The section
" solution_dict = True -- return a list of dictionaries containing the
solutions. "
made me think that solution_dict defaults to True which is not the case.
Maybe this could be made more clear.

3) 'solution_dict = True' fails when only a single univariate equation
is given. The solution is then not a list of lists and the conversion to
dictionary fails:

sage: var('a')
a
sage: solve ([a^2-1],a,solution_dict=True)
-
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)

/home/tom/<ipython console> in <module>()

/usr/local/sage/local/lib/python2.5/site-packages/sage/calculus/equations.pyc
in solve(f, *args, **kwds)
  1436         sol_list = string_to_list_of_solutions(a)
  1437         if 'solution_dict' in kwds and kwds['solution_dict']==True:
- -> 1438             sol_dict=[dict([[eq.left(),eq.right()] for eq in
solution]) for solution in sol_list]
  1439             return sol_dict
  1440         else:

AttributeError: 'SymbolicVariable' object has no attribute 'left'


Thanks for your great work.
Thomas
```

Assignee: @burcin

Resolution: fixed

Author: Karl-Dieter Crisman, Burcin Erocal

Reviewer: Burcin Erocal, Karl-Dieter Crisman

Merged: Sage 4.1.2.alpha2

Issue created by migration from https://trac.sagemath.org/ticket/4786





---

archive/issue_comments_039399.json:
```json
{
    "body": "Attachment [trac-4786.patch](tarball://root/attachments/some-uuid/ticket4786/trac-4786.patch) by @jasongrout created at 2009-01-22 18:27:12",
    "created_at": "2009-01-22T18:27:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39399",
    "user": "https://github.com/jasongrout"
}
```

Attachment [trac-4786.patch](tarball://root/attachments/some-uuid/ticket4786/trac-4786.patch) by @jasongrout created at 2009-01-22 18:27:12



---

archive/issue_comments_039400.json:
```json
{
    "body": "<a id='comment:1'></a>I believe this patch takes care of all the issues pointed out above.",
    "created_at": "2009-01-22T18:27:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39400",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:1'></a>I believe this patch takes care of all the issues pointed out above.



---

archive/issue_comments_039401.json:
```json
{
    "body": "<a id='comment:2'></a>I get the following failures:\n\n```\n**********************************************************************\nFile \"/opt/sage/devel/sage-main/sage/calculus/equations.py\", line 1392:\n    sage: solve([3==3, 1.00000000000000*x^3 == 0], x)\nExpected:\n    [x == 0]\nGot:\n    [[x == 0]]\n**********************************************************************\nFile \"/opt/sage/devel/sage-main/sage/calculus/equations.py\", line 1394:\n    sage: solve([1.00000000000000*x^3 == 0], x)\nExpected:\n    [x == 0]\nGot:\n    [[x == 0]]\n```",
    "created_at": "2009-01-24T15:01:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39401",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:2'></a>I get the following failures:

```
**********************************************************************
File "/opt/sage/devel/sage-main/sage/calculus/equations.py", line 1392:
    sage: solve([3==3, 1.00000000000000*x^3 == 0], x)
Expected:
    [x == 0]
Got:
    [[x == 0]]
**********************************************************************
File "/opt/sage/devel/sage-main/sage/calculus/equations.py", line 1394:
    sage: solve([1.00000000000000*x^3 == 0], x)
Expected:
    [x == 0]
Got:
    [[x == 0]]
```



---

archive/issue_comments_039402.json:
```json
{
    "body": "Attachment [trac_4786-solution_dict.patch](tarball://root/attachments/some-uuid/ticket4786/trac_4786-solution_dict.patch) by @kcrisman created at 2009-08-26 15:25:42\n\nBased on 4.1.1",
    "created_at": "2009-08-26T15:25:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39402",
    "user": "https://github.com/kcrisman"
}
```

Attachment [trac_4786-solution_dict.patch](tarball://root/attachments/some-uuid/ticket4786/trac_4786-solution_dict.patch) by @kcrisman created at 2009-08-26 15:25:42

Based on 4.1.1



---

archive/issue_comments_039403.json:
```json
{
    "body": "<a id='comment:3'></a>Apply only second patch.  This should fix the same things post-Pynac switch, and passes all tests in sage/calculus and sage/symbolic.",
    "created_at": "2009-08-26T15:27:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39403",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:3'></a>Apply only second patch.  This should fix the same things post-Pynac switch, and passes all tests in sage/calculus and sage/symbolic.



---

archive/issue_comments_039404.json:
```json
{
    "body": "new version of kcrisman's patch",
    "created_at": "2009-09-10T12:38:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39404",
    "user": "https://github.com/burcin"
}
```

new version of kcrisman's patch



---

archive/issue_comments_039405.json:
```json
{
    "body": "Changing author from \"\" to \"Karl-Dieter Crisman\"",
    "created_at": "2009-09-10T12:48:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39405",
    "user": "https://github.com/burcin"
}
```

Changing author from "" to "Karl-Dieter Crisman"



---

archive/issue_comments_039406.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Burcin Erocal\"",
    "created_at": "2009-09-10T12:48:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39406",
    "user": "https://github.com/burcin"
}
```

Changing reviewer from "" to "Burcin Erocal"



---

archive/issue_comments_039407.json:
```json
{
    "body": "<a id='comment:4'></a>Attachment [trac_4786-solution_dict.take2.patch](tarball://root/attachments/some-uuid/ticket4786/trac_4786-solution_dict.take2.patch) by @burcin created at 2009-09-10 12:48:12\n\nHi Karl-Dieter,\n\nI uploaded a new version of your patch at attachment:trac_4786-solution_dict.take2.patch. The changes are:\n* used `sorted( d.items() )` to print a dictionary in a doctest\n* changed the block:\n {{{\n            try:\n                sol_dict=[dict([[eq.left(),eq.right()] for eq in solution]) for solution in sol_list]\n            except TypeError:\n                if not isinstance(sol_list[0],list):\n                    sol_list = [[i] for i in sol_list]\n                    sol_dict=[dict([[eq.left(),eq.right()] for eq in solution]) for solution in sol_list]\n }}}\n to\n {{{\n            if isinstance(sol_list[0], list):\n                sol_dict=[dict([[eq.left(),eq.right()] for eq in solution])\n                        for solution in sol_list]\n            else:\n                sol_dict=[{eq.left():eq.right()} for eq in sol_list]\n }}}\n\nPlease give this ticket a positive review if you're ok with my changes.\n\n---\n\nMinh, only apply: attachment:trac_4786-solution_dict.take2.patch",
    "created_at": "2009-09-10T12:48:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39407",
    "user": "https://github.com/burcin"
}
```

<a id='comment:4'></a>Attachment [trac_4786-solution_dict.take2.patch](tarball://root/attachments/some-uuid/ticket4786/trac_4786-solution_dict.take2.patch) by @burcin created at 2009-09-10 12:48:12

Hi Karl-Dieter,

I uploaded a new version of your patch at attachment:trac_4786-solution_dict.take2.patch. The changes are:
* used `sorted( d.items() )` to print a dictionary in a doctest
* changed the block:
 {{{
            try:
                sol_dict=[dict([[eq.left(),eq.right()] for eq in solution]) for solution in sol_list]
            except TypeError:
                if not isinstance(sol_list[0],list):
                    sol_list = [[i] for i in sol_list]
                    sol_dict=[dict([[eq.left(),eq.right()] for eq in solution]) for solution in sol_list]
 }}}
 to
 {{{
            if isinstance(sol_list[0], list):
                sol_dict=[dict([[eq.left(),eq.right()] for eq in solution])
                        for solution in sol_list]
            else:
                sol_dict=[{eq.left():eq.right()} for eq in sol_list]
 }}}

Please give this ticket a positive review if you're ok with my changes.

---

Minh, only apply: attachment:trac_4786-solution_dict.take2.patch



---

archive/issue_comments_039408.json:
```json
{
    "body": "<a id='comment:5'></a>That change sounds fine - I am used to catching Errors, but in this case isinstance makes much more sense.\n\nIronically, though:\n\n```\n**********************************************************************\nFile \"/Users/.../sage-4.1.1/devel/sage-morepatchtests/sage/symbolic/relation.py\", line 455:\n    sage: map(lambda x: sorted(x.items()), res)\nExpected:\n    [[(y, 4), (x, 2)], [(y, 4), (x, -2)]]\nGot:\n    [[(x, 2), (y, 4)], [(x, -2), (y, 4)]]\n**********************************************************************\n```\nSo I fixed that in the latest version, and hopefully now you can give it positive review!",
    "created_at": "2009-09-10T14:13:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39408",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:5'></a>That change sounds fine - I am used to catching Errors, but in this case isinstance makes much more sense.

Ironically, though:

```
**********************************************************************
File "/Users/.../sage-4.1.1/devel/sage-morepatchtests/sage/symbolic/relation.py", line 455:
    sage: map(lambda x: sorted(x.items()), res)
Expected:
    [[(y, 4), (x, 2)], [(y, 4), (x, -2)]]
Got:
    [[(x, 2), (y, 4)], [(x, -2), (y, 4)]]
**********************************************************************
```
So I fixed that in the latest version, and hopefully now you can give it positive review!



---

archive/issue_comments_039409.json:
```json
{
    "body": "<a id='comment:6'></a>Attachment [trac_4786-solution_dict.take3.patch](tarball://root/attachments/some-uuid/ticket4786/trac_4786-solution_dict.take3.patch) by @kcrisman created at 2009-09-10 14:14:34\n\nApply only take3.",
    "created_at": "2009-09-10T14:14:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39409",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'></a>Attachment [trac_4786-solution_dict.take3.patch](tarball://root/attachments/some-uuid/ticket4786/trac_4786-solution_dict.take3.patch) by @kcrisman created at 2009-09-10 14:14:34

Apply only take3.



---

archive/issue_comments_039410.json:
```json
{
    "body": "Attachment [trac_4786-solution_dict.take4.patch](tarball://root/attachments/some-uuid/ticket4786/trac_4786-solution_dict.take4.patch) by @burcin created at 2009-09-12 13:13:20",
    "created_at": "2009-09-12T13:13:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39410",
    "user": "https://github.com/burcin"
}
```

Attachment [trac_4786-solution_dict.take4.patch](tarball://root/attachments/some-uuid/ticket4786/trac_4786-solution_dict.take4.patch) by @burcin created at 2009-09-12 13:13:20



---

archive/issue_comments_039411.json:
```json
{
    "body": "<a id='comment:7'></a>Somehow, `y` is shown first on my laptop, better to just print the values for each variable as Mike has done just a few lines above. \n\nI attached a new patch only with this doctest changed. Hopefully this is the last one. :)",
    "created_at": "2009-09-12T13:15:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39411",
    "user": "https://github.com/burcin"
}
```

<a id='comment:7'></a>Somehow, `y` is shown first on my laptop, better to just print the values for each variable as Mike has done just a few lines above. 

I attached a new patch only with this doctest changed. Hopefully this is the last one. :)



---

archive/issue_comments_039412.json:
```json
{
    "body": "<a id='comment:8'></a>Looks good!  I guess I don't feel comfortable putting positive review on a patch I largely wrote, but I'll add my name to the reviewer list and you can add your name to the author list if you feel that's appropriate.",
    "created_at": "2009-09-13T00:22:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39412",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:8'></a>Looks good!  I guess I don't feel comfortable putting positive review on a patch I largely wrote, but I'll add my name to the reviewer list and you can add your name to the author list if you feel that's appropriate.



---

archive/issue_comments_039413.json:
```json
{
    "body": "Changing reviewer from \"Burcin Erocal\" to \"Burcin Erocal, Karl-Dieter Crisman\"",
    "created_at": "2009-09-13T00:22:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39413",
    "user": "https://github.com/kcrisman"
}
```

Changing reviewer from "Burcin Erocal" to "Burcin Erocal, Karl-Dieter Crisman"



---

archive/issue_comments_039414.json:
```json
{
    "body": "Changing author from \"Karl-Dieter Crisman\" to \"Karl-Dieter Crisman, Burcin Erocal\"",
    "created_at": "2009-09-13T10:35:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39414",
    "user": "https://github.com/burcin"
}
```

Changing author from "Karl-Dieter Crisman" to "Karl-Dieter Crisman, Burcin Erocal"



---

archive/issue_comments_039415.json:
```json
{
    "body": "<a id='comment:9'></a>Positive review.",
    "created_at": "2009-09-13T10:35:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39415",
    "user": "https://github.com/burcin"
}
```

<a id='comment:9'></a>Positive review.



---

archive/issue_comments_039416.json:
```json
{
    "body": "Changing merged from \"\" to \"Sage 4.1.2.alpha2\"",
    "created_at": "2009-09-15T19:34:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39416",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Changing merged from "" to "Sage 4.1.2.alpha2"



---

archive/issue_comments_039417.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2009-09-15T19:34:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39417",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Resolution: fixed



---

archive/issue_events_010938.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2009-09-15T19:34:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4786#event-10938"
}
```



---

archive/issue_comments_039418.json:
```json
{
    "body": "<a id='comment:10'></a>Merged `trac_4786-solution_dict.take4.patch`.",
    "created_at": "2009-09-15T19:34:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4786#issuecomment-39418",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:10'></a>Merged `trac_4786-solution_dict.take4.patch`.
