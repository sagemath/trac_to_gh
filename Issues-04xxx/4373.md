# Issue 4373: doctest failure in sage/algebras/group_algebra.py on 32 bit platforms

archive/issues_004373.json:
```json
{
    "assignees": [
        "https://github.com/loefflerd"
    ],
    "body": "\n```\nsage -t  devel/sage/sage/algebras/group_algebra.py          \n********************************************************************** \nFile \"/home/jaap/downloads/sage-3.2.alpha0/tmp/group_algebra.py\", line 230: \n     sage: OG(FormalSum([ (1, G(2)), (2, RR(0.77)) ]), check=False) \nExpected: \n     [2 0] \n     [0 2] + 2*0.770000000000000 \nGot: \n     2*0.770000000000000 + [2 0] \n     [0 2] \n**********************************************************************\n```\n\nCC:  @mwhansen\n\nComponent: **doctest coverage**\n\nAuthor: **David Loeffler**\n\nReviewer: **Michael Abshoff**\n\nMerged: **3.2.alpha2**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/4373_\n\n",
    "closed_at": "2008-10-28T16:24:17Z",
    "created_at": "2008-10-27T05:35:02Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/doctest%20coverage",
        "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-3.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "doctest failure in sage/algebras/group_algebra.py on 32 bit platforms",
    "type": "issue",
    "updated_at": "2009-06-07T09:47:33Z",
    "url": "https://github.com/sagemath/sage/issues/4373",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

```
sage -t  devel/sage/sage/algebras/group_algebra.py          
********************************************************************** 
File "/home/jaap/downloads/sage-3.2.alpha0/tmp/group_algebra.py", line 230: 
     sage: OG(FormalSum([ (1, G(2)), (2, RR(0.77)) ]), check=False) 
Expected: 
     [2 0] 
     [0 2] + 2*0.770000000000000 
Got: 
     2*0.770000000000000 + [2 0] 
     [0 2] 
**********************************************************************
```

CC:  @mwhansen

Component: **doctest coverage**

Author: **David Loeffler**

Reviewer: **Michael Abshoff**

Merged: **3.2.alpha2**

_Issue created by migration from https://trac.sagemath.org/ticket/4373_





---

archive/issue_events_049549.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-10-27T05:35:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "milestone_number": null,
    "milestone_title": "sage-3.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4373#event-49549"
}
```



---

archive/issue_events_049550.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-10-27T05:35:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "label": "https://github.com/sagemath/sage/labels/doctest%20coverage",
    "label_color": "696969",
    "label_name": "doctest coverage",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4373#event-49550"
}
```



---

archive/issue_events_049551.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-10-27T05:35:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4373#event-49551"
}
```



---

archive/issue_events_049552.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-10-27T05:35:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4373#event-49552"
}
```



---

archive/issue_events_049553.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-10-27T05:35:02Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "subject": "https://github.com/sagetrac-mabshoff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4373#event-49553"
}
```



---

archive/issue_comments_025304.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nDavid,\n\nsince this is your patch any clue what is going on here?\n\nCheers,\n\nMichael",
    "created_at": "2008-10-28T12:54:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4373#issuecomment-25304",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:1" align="right">comment:1</div>

David,

since this is your patch any clue what is going on here?

Cheers,

Michael



---

archive/issue_events_049554.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-10-28T12:55:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4373#event-49554"
}
```



---

archive/issue_events_049555.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-10-28T12:55:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4373#event-49555"
}
```



---

archive/issue_comments_025305.json:
```json
{
    "body": "Attachment: **[4373.patch.gz](https://github.com/sagemath/sage/files/ticket4373/4373.patch.gz)**",
    "created_at": "2008-10-28T13:22:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4373#issuecomment-25305",
    "user": "https://github.com/loefflerd"
}
```

Attachment: **[4373.patch.gz](https://github.com/sagemath/sage/files/ticket4373/4373.patch.gz)**



---

archive/issue_comments_025306.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThe failed doctest was just verifying that the \"check\" flag could be disabled, by using this to create a bogus group algebra element that is a formal sum of things that aren't in the right group. The string representation of such an element depends on the sort order of the elements, which is completely arbitrary and subject to changing between platforms, hence the failure here.\n\nAll that's really needed is to check that the method runs; it's inconceivable that it could run but not give the expected answer. So I've uploaded a 1-line patch that marks the doctest with \"# random\".\n\n(I didn't use the \"#64-bit\" and \"#32-bit\" flags as then it would just break again next time someone changed the sort order of real numbers versus integer matrices, which is bound to happen before long.)",
    "created_at": "2008-10-28T13:31:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4373#issuecomment-25306",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:3" align="right">comment:3</div>

The failed doctest was just verifying that the "check" flag could be disabled, by using this to create a bogus group algebra element that is a formal sum of things that aren't in the right group. The string representation of such an element depends on the sort order of the elements, which is completely arbitrary and subject to changing between platforms, hence the failure here.

All that's really needed is to check that the method runs; it's inconceivable that it could run but not give the expected answer. So I've uploaded a 1-line patch that marks the doctest with "# random".

(I didn't use the "#64-bit" and "#32-bit" flags as then it would just break again next time someone changed the sort order of real numbers versus integer matrices, which is bound to happen before long.)



---

archive/issue_events_049556.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-10-28T13:31:52Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "subject": "https://github.com/loefflerd",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4373#event-49556"
}
```



---

archive/issue_events_049557.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2008-10-28T13:31:52Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "subject": "https://github.com/loefflerd",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4373#event-49557"
}
```



---

archive/issue_events_049558.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-10-28T13:41:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4373#event-49558"
}
```



---

archive/issue_comments_025307.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nOk, I think in that situation then #random is warranted. But could you please replace the patch by a version that adds the explanation you just gave on the ticket why this fails so that in the future people looking at that doctest understand why. It would also be nice to mention this ticket number in the string, i.e. \"the issue was also discussed at #4373\".\n\nMike: FYI since you also had some comments about this code.\n\nCheers,\n\nMichael",
    "created_at": "2008-10-28T13:41:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4373#issuecomment-25307",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:4" align="right">comment:4</div>

Ok, I think in that situation then #random is warranted. But could you please replace the patch by a version that adds the explanation you just gave on the ticket why this fails so that in the future people looking at that doctest understand why. It would also be nice to mention this ticket number in the string, i.e. "the issue was also discussed at #4373".

Mike: FYI since you also had some comments about this code.

Cheers,

Michael



---

archive/issue_comments_025308.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nAttachment: **[4373-new.patch.gz](https://github.com/sagemath/sage/files/ticket4373/4373-new.patch.gz)**\n\nok, here it is again, with a more informative comment on the doctest.",
    "created_at": "2008-10-28T14:21:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4373#issuecomment-25308",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:5" align="right">comment:5</div>

Attachment: **[4373-new.patch.gz](https://github.com/sagemath/sage/files/ticket4373/4373-new.patch.gz)**

ok, here it is again, with a more informative comment on the doctest.



---

archive/issue_comments_025309.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nTwo small issues: The explanation should be before the doctest and indented and the '#' in the docstring needs to be escaped. I will take care of both small issues. \n\nCheers,\n\nMichael",
    "created_at": "2008-10-28T15:49:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4373#issuecomment-25309",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:6" align="right">comment:6</div>

Two small issues: The explanation should be before the doctest and indented and the '#' in the docstring needs to be escaped. I will take care of both small issues. 

Cheers,

Michael



---

archive/issue_events_049559.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-10-28T15:49:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4373#event-49559"
}
```



---

archive/issue_events_049560.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-10-28T15:49:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4373#event-49560"
}
```



---

archive/issue_events_049561.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-10-28T16:24:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4373#event-49561"
}
```



---

archive/issue_events_049562.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-10-28T16:24:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4373#event-49562"
}
```



---

archive/issue_comments_025310.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nMerged in Sage 3.2.alpha2",
    "created_at": "2008-10-28T16:24:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4373#issuecomment-25310",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:7" align="right">comment:7</div>

Merged in Sage 3.2.alpha2



---

archive/issue_comments_025311.json:
```json
{
    "body": "Reviewer: **Michael Abshoff**",
    "created_at": "2009-06-07T09:47:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4373#issuecomment-25311",
    "user": "https://github.com/loefflerd"
}
```

Reviewer: **Michael Abshoff**



---

archive/issue_comments_025312.json:
```json
{
    "body": "Merged: **3.2.alpha2**",
    "created_at": "2009-06-07T09:47:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4373#issuecomment-25312",
    "user": "https://github.com/loefflerd"
}
```

Merged: **3.2.alpha2**



---

archive/issue_comments_025313.json:
```json
{
    "body": "Author: **David Loeffler**",
    "created_at": "2009-06-07T09:47:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4373",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4373#issuecomment-25313",
    "user": "https://github.com/loefflerd"
}
```

Author: **David Loeffler**
