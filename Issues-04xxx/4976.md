# Issue 4976: fill option for plot, polar_plot and parametric_plot

archive/issues_004976.json:
```json
{
    "body": "This patch adds the new options \"fill\", \"fillcolor\", and \"fillalpha\" to the plot functions,\nwhich allow to fill the area between two functions in a plot, or to fill the area between \nthe function and the x-axis.\n\nThe syntax for fill is similar to what Mathematica uses.\n\nI also attach a file with some examples for easier testing.\n\nGreetings,\n\nWilfried\n\n**Assignee:** whuss\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/4976\n\n",
    "closed_at": "2009-02-05T13:02:10Z",
    "created_at": "2009-01-14T17:17:39Z",
    "labels": [
        "component: graphics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-3.3",
    "title": "fill option for plot, polar_plot and parametric_plot",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/4976",
    "user": "https://trac.sagemath.org/admin/accounts/users/whuss"
}
```
This patch adds the new options "fill", "fillcolor", and "fillalpha" to the plot functions,
which allow to fill the area between two functions in a plot, or to fill the area between 
the function and the x-axis.

The syntax for fill is similar to what Mathematica uses.

I also attach a file with some examples for easier testing.

Greetings,

Wilfried

**Assignee:** whuss

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/4976





---

archive/issue_comments_044934.json:
```json
{
    "body": "some examples",
    "created_at": "2009-01-14T17:19:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4976#issuecomment-44934",
    "user": "https://trac.sagemath.org/admin/accounts/users/whuss"
}
```

some examples



---

archive/attachments_005596.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "fill_examples.sage",
    "asset_url": "tarball://root/attachments/some-uuid/ticket4976/fill_examples.sage",
    "created_at": "2009-01-14T17:20:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.sage",
    "user": "https://trac.sagemath.org/admin/accounts/users/whuss"
}
```



---

archive/issue_comments_044935.json:
```json
{
    "body": "",
    "created_at": "2009-01-14T17:20:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4976#issuecomment-44935",
    "user": "https://trac.sagemath.org/admin/accounts/users/whuss"
}
```





---

archive/attachments_005597.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "fill1.png",
    "asset_url": "tarball://root/attachments/some-uuid/ticket4976/fill1.png",
    "created_at": "2009-01-29T04:05:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.png",
    "user": "https://github.com/kcrisman"
}
```



---

archive/issue_comments_044936.json:
```json
{
    "body": "<a id='comment:1'></a>\nI think that someone who does heavier-duty plotting (and who has a machine new enough that plot.py doesn't time out while testing) should give a final review, but it very nicely solves a lot of problems, and didn't break any of the examples I thought it might when I tried it.  After some thought, probably putting generate_plot_points separately (and with very nice documentation) is a wise idea as well, and hopefully someone who originated that code will agree.\n\nMy only functional caveat is that you may want to put in a catch for fill=min and fill=max (as opposed to fill='min' and fill='max') because it parses these as functions, which they are, but it should probably raise an error (in both cases seems to have net effect of fill='axis'), since max and min are not really functions of one variable.\n\nThere should probably also be more explicit documentation of how the fillcolor option works, as opposed to seeing fillcolor='#ccc' in the tests - all legal input categories should be listed, perhaps there are others.\n\nBut that's all quibbles and my own ignorance; this is a beautiful addition, and someone else should review it very soon to avoid bitrot.",
    "created_at": "2009-01-29T04:05:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4976#issuecomment-44936",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:1'></a>
I think that someone who does heavier-duty plotting (and who has a machine new enough that plot.py doesn't time out while testing) should give a final review, but it very nicely solves a lot of problems, and didn't break any of the examples I thought it might when I tried it.  After some thought, probably putting generate_plot_points separately (and with very nice documentation) is a wise idea as well, and hopefully someone who originated that code will agree.

My only functional caveat is that you may want to put in a catch for fill=min and fill=max (as opposed to fill='min' and fill='max') because it parses these as functions, which they are, but it should probably raise an error (in both cases seems to have net effect of fill='axis'), since max and min are not really functions of one variable.

There should probably also be more explicit documentation of how the fillcolor option works, as opposed to seeing fillcolor='#ccc' in the tests - all legal input categories should be listed, perhaps there are others.

But that's all quibbles and my own ignorance; this is a beautiful addition, and someone else should review it very soon to avoid bitrot.



---

archive/issue_comments_044937.json:
```json
{
    "body": "<a id='comment:2'></a>\nThis patch seems to also be a big refactoring of the plot code, and also seems to change the code to plot a list of functions in multiple colors.  I'm not disagreeing with it, but just commenting that this patch addresses more than the ticket says it does.",
    "created_at": "2009-01-29T05:18:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4976#issuecomment-44937",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:2'></a>
This patch seems to also be a big refactoring of the plot code, and also seems to change the code to plot a list of functions in multiple colors.  I'm not disagreeing with it, but just commenting that this patch addresses more than the ticket says it does.



---

archive/issue_comments_044938.json:
```json
{
    "body": "<a id='comment:3'></a>\nFirst, I really appreciate this patch and the beautiful functionality it adds.  We've needed it for a long time.  It also appears to do a much-needed refactoring of the plot code.  I haven't tested the patch, though, or looked at it extremely closely.  \n\nJust a short comment about a piece of code.  The patch uses map and max/min to calculate filling to the max or min of the function.  It would be slightly faster and probably a lot clearer to just use list comprehensions:\n\n```\n\nsage: data=[(x,x*x) for x in [0..10,step=0.01]]\nsage: timeit('min(map(lambda t: t[1], data))')\n625 loops, best of 3: 1.29 ms per loop\nsage: timeit('min(i[1] for i in data)')\n625 loops, best of 3: 1.15 ms per loop\n```\n\nIt would be orders of magnitude faster to use numpy to store the list of data.  This would be a more major change in the plotting code, but here is the equivalent numpy code:\n\n```\nsage: import numpy\nsage: ndata=numpy.array(data,dtype=float)\nsage: timeit('numpy.max(ndata[:,1])')\n625 loops, best of 3: 30.7 \u00b5s per loop\n```",
    "created_at": "2009-01-29T05:39:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4976#issuecomment-44938",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:3'></a>
First, I really appreciate this patch and the beautiful functionality it adds.  We've needed it for a long time.  It also appears to do a much-needed refactoring of the plot code.  I haven't tested the patch, though, or looked at it extremely closely.  

Just a short comment about a piece of code.  The patch uses map and max/min to calculate filling to the max or min of the function.  It would be slightly faster and probably a lot clearer to just use list comprehensions:

```

sage: data=[(x,x*x) for x in [0..10,step=0.01]]
sage: timeit('min(map(lambda t: t[1], data))')
625 loops, best of 3: 1.29 ms per loop
sage: timeit('min(i[1] for i in data)')
625 loops, best of 3: 1.15 ms per loop
```

It would be orders of magnitude faster to use numpy to store the list of data.  This would be a more major change in the plotting code, but here is the equivalent numpy code:

```
sage: import numpy
sage: ndata=numpy.array(data,dtype=float)
sage: timeit('numpy.max(ndata[:,1])')
625 loops, best of 3: 30.7 Âµs per loop
```



---

archive/attachments_005598.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "fill_plot.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket4976/fill_plot.patch",
    "created_at": "2009-02-02T14:51:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/whuss"
}
```



---

archive/issue_comments_044939.json:
```json
{
    "body": "rebased for sage-3.3.alpha2",
    "created_at": "2009-02-02T14:51:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4976#issuecomment-44939",
    "user": "https://trac.sagemath.org/admin/accounts/users/whuss"
}
```

rebased for sage-3.3.alpha2



---

archive/issue_comments_044940.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [kcrisman](#comment%3A1):\n> My only functional caveat is that you may want to put in a catch for fill=min and fill=max (as opposed to fill='min' and fill='max') because it parses these as functions, which they are, but it should probably raise an error (in both cases seems to have net effect of fill='axis'), since max and min are not really functions of one variable.\n\n\nIn the new patch a warning gets printed if min or max is used as the parameter for fill.\n\nReplying to [jason](#comment%3A3):\n> The patch uses map and max/min to calculate filling to the max or min of the function. It would be slightly faster and probably a lot clearer to just use list comprehensions\n\n\nI changed it to use generator comprehensions.",
    "created_at": "2009-02-02T14:56:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4976#issuecomment-44940",
    "user": "https://trac.sagemath.org/admin/accounts/users/whuss"
}
```

<a id='comment:4'></a>
Replying to [kcrisman](#comment%3A1):
> My only functional caveat is that you may want to put in a catch for fill=min and fill=max (as opposed to fill='min' and fill='max') because it parses these as functions, which they are, but it should probably raise an error (in both cases seems to have net effect of fill='axis'), since max and min are not really functions of one variable.


In the new patch a warning gets printed if min or max is used as the parameter for fill.

Replying to [jason](#comment%3A3):
> The patch uses map and max/min to calculate filling to the max or min of the function. It would be slightly faster and probably a lot clearer to just use list comprehensions


I changed it to use generator comprehensions.



---

archive/attachments_005599.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "4976-reviewer.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket4976/4976-reviewer.patch",
    "created_at": "2009-02-04T03:51:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/kcrisman"
}
```



---

archive/issue_comments_044941.json:
```json
{
    "body": "",
    "created_at": "2009-02-04T03:51:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4976#issuecomment-44941",
    "user": "https://github.com/kcrisman"
}
```





---

archive/issue_comments_044942.json:
```json
{
    "body": "<a id='comment:5'></a>\nPositive review off 3.3.alpha4; as we've all noted, this will be a great addition.  I did try quite a bit to crack it, but couldn't; I can't check plot.py doctests, unfortunately, so there is still the potential, but I doubt it.\n\nTwo comments: \n\n1. I added the reviewer patch because it was not clear that in parametric_plot, all fill options behave the same.  This is ok behavior, I think, for the parametric case, but should be documented.  \n\n2. With the fix for max/min versus 'max'/'min', the behavior of max and min (without quotes) has changed, in a very interesting way; in fact, it behaves somewhat similarly to the parametric filling.  I think it's a feature, not a bug, which should be documented and made easily available, but that should be on another ticket.",
    "created_at": "2009-02-04T03:57:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4976#issuecomment-44942",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:5'></a>
Positive review off 3.3.alpha4; as we've all noted, this will be a great addition.  I did try quite a bit to crack it, but couldn't; I can't check plot.py doctests, unfortunately, so there is still the potential, but I doubt it.

Two comments: 

1. I added the reviewer patch because it was not clear that in parametric_plot, all fill options behave the same.  This is ok behavior, I think, for the parametric case, but should be documented.  

2. With the fix for max/min versus 'max'/'min', the behavior of max and min (without quotes) has changed, in a very interesting way; in fact, it behaves somewhat similarly to the parametric filling.  I think it's a feature, not a bug, which should be documented and made easily available, but that should be on another ticket.



---

archive/issue_comments_044943.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2009-02-04T03:57:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4976#issuecomment-44943",
    "user": "https://github.com/kcrisman"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_014962.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2009-02-04T03:57:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "milestone": "sage-3.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4976#event-14962"
}
```



---

archive/issue_comments_044944.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2009-02-05T13:02:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4976#issuecomment-44944",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Resolution:** fixed



---

archive/issue_events_014963.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-02-05T13:02:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4976#event-14963"
}
```



---

archive/attachments_005600.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_4976_numerical_noise.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket4976/trac_4976_numerical_noise.patch",
    "created_at": "2009-02-05T13:02:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```



---

archive/issue_comments_044945.json:
```json
{
    "body": "<a id='comment:6'></a>\nMerged all three patches in Sage 3.3.alpha6.\n\nCheers,\n\nMichael",
    "created_at": "2009-02-05T13:02:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4976#issuecomment-44945",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:6'></a>
Merged all three patches in Sage 3.3.alpha6.

Cheers,

Michael
