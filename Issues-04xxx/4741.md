# Issue 4741: Implement S-integral point finding for elliptic curves over Q

archive/issues_004741.json:
```json
{
    "assignees": [
        "https://github.com/williamstein"
    ],
    "body": "This follows on from #3674, where integral points for elliptic curves over Q were implemented.\n\nThe work here was done (again) by Tobias Nagel and Michael Mardaus, with some necessary backup functionality for elliptic curve local data by me (John Cremona) which has already been merged.\n\nTwo functions are defined:  (1) `padic_elliptic_logarithm()` for points on curves over number fields, in ell_point.py; (2) `S_integral_points()` for curves over Q only (so far!), in ell_rational field.py.\n\nThe patch s_int_pts.patch applies to 3.2.1 + the patches at #4715.  Should be ready for review soon...\n\nCC:  @sagetrac-mardaus @sagetrac-tnagel\n\nComponent: **number theory**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/4741_\n\n",
    "closed_at": "2008-12-15T17:12:40Z",
    "created_at": "2008-12-08T12:37:24Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20number%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-3.2.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Implement S-integral point finding for elliptic curves over Q",
    "type": "issue",
    "updated_at": "2008-12-15T17:12:40Z",
    "url": "https://github.com/sagemath/sage/issues/4741",
    "user": "https://github.com/JohnCremona"
}
```
This follows on from #3674, where integral points for elliptic curves over Q were implemented.

The work here was done (again) by Tobias Nagel and Michael Mardaus, with some necessary backup functionality for elliptic curve local data by me (John Cremona) which has already been merged.

Two functions are defined:  (1) `padic_elliptic_logarithm()` for points on curves over number fields, in ell_point.py; (2) `S_integral_points()` for curves over Q only (so far!), in ell_rational field.py.

The patch s_int_pts.patch applies to 3.2.1 + the patches at #4715.  Should be ready for review soon...

CC:  @sagetrac-mardaus @sagetrac-tnagel

Component: **number theory**

_Issue created by migration from https://trac.sagemath.org/ticket/4741_





---

archive/issue_events_054029.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2008-12-08T12:37:24Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "milestone_number": null,
    "milestone_title": "sage-3.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54029"
}
```



---

archive/issue_events_054030.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2008-12-08T12:37:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20number%20theory",
    "label_color": "0000ff",
    "label_name": "c: number theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54030"
}
```



---

archive/issue_events_054031.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2008-12-08T12:37:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54031"
}
```



---

archive/issue_events_054032.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2008-12-08T12:37:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54032"
}
```



---

archive/issue_events_054033.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-12-08T12:37:24Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "subject": "https://github.com/JohnCremona",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54033"
}
```



---

archive/issue_comments_028498.json:
```json
{
    "body": "Attachment: **[s_int_pts.patch.gz](https://github.com/sagemath/sage/files/ticket4741/s_int_pts.patch.gz)**\n\nAttachment: **[trac-4741-padic_log.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-padic_log.patch.gz)**",
    "created_at": "2008-12-08T15:21:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28498",
    "user": "https://github.com/JohnCremona"
}
```

Attachment: **[s_int_pts.patch.gz](https://github.com/sagemath/sage/files/ticket4741/s_int_pts.patch.gz)**

Attachment: **[trac-4741-padic_log.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-padic_log.patch.gz)**



---

archive/issue_comments_028499.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThe second patch fixes various issues with the padic_log function:\n\n1. Bug: points of finite order have log 0 and this case should be dealt with at the beginning.  The code breaks on E(0), for example.\n2. I deleted the \"print_mode\" parameter since it was actually changing the output type from p-adic to rational;  callers can lift if they want.\n3. The test \"if xde == p**(xde.valuation(p))\" seems to be wrong.  I changed it to \"if x.valuation(p)>=0\", which is the condition that P is not in the formal group.\n4. It did not multiply P by the Tamagawa exponent.\n5. It did not divide the answer by the factor you multiplied the point by! \n6. The precision was artificially capped at 20, since the prec parameter to log() was not used and defaults to 20.  That is the precision of the power series in t, where we will substitute t=-x/y, so I added \"prec=1+precision//v\"  where v is the valuation of -x/y.  (N.B. in `E^1` one has val(x)=-2*v and val(y)=-3*v for some v>0, so v=val(-x/y).\n7. I added some doctests to show that log(k*P)/log(P)==k in various examples.  That is how I discovered the precision problem.  Now it looks pretty good.",
    "created_at": "2008-12-08T15:28:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28499",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:1" align="right">comment:1</div>

The second patch fixes various issues with the padic_log function:

1. Bug: points of finite order have log 0 and this case should be dealt with at the beginning.  The code breaks on E(0), for example.
2. I deleted the "print_mode" parameter since it was actually changing the output type from p-adic to rational;  callers can lift if they want.
3. The test "if xde == p**(xde.valuation(p))" seems to be wrong.  I changed it to "if x.valuation(p)>=0", which is the condition that P is not in the formal group.
4. It did not multiply P by the Tamagawa exponent.
5. It did not divide the answer by the factor you multiplied the point by! 
6. The precision was artificially capped at 20, since the prec parameter to log() was not used and defaults to 20.  That is the precision of the power series in t, where we will substitute t=-x/y, so I added "prec=1+precision//v"  where v is the valuation of -x/y.  (N.B. in `E^1` one has val(x)=-2*v and val(y)=-3*v for some v>0, so v=val(-x/y).
7. I added some doctests to show that log(k*P)/log(P)==k in various examples.  That is how I discovered the precision problem.  Now it looks pretty good.



---

archive/issue_comments_028500.json:
```json
{
    "body": "Attachment: **[trac-4741-fix2.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-fix2.patch.gz)**",
    "created_at": "2008-12-11T14:18:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28500",
    "user": "https://github.com/JohnCremona"
}
```

Attachment: **[trac-4741-fix2.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-fix2.patch.gz)**



---

archive/issue_comments_028501.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThe third patch fixes a bug (missed a 2-integral points on 37a1) and makes  `S_integral_x_coords_with_abs_bounded_by()` slightly more efficient, but we are way slower than Magma and I think that the main culprits are that function and  `S_integral_points_with_bounded_mw_coeffs()`.   In the integral points case we made the latter much faster by using real points (since you can tell if a real number is approximately integral) but th analogous thing for S-integral points is more complicated.  Rather than wait, as we are getting the right points (after substantial testing against Magma, for example), I would like this to go in now and we can look into making things faster later.\n\nDetails of what is in the 3rd patch:\n1. p-adic elliptic log: default precision now 20 not 100, which works fine.  Also converts points to p-adic earlier which avoids dealing with large rationals when the multiplier factor is needed.\n2. Calls to p-adic log from S_integral_points() now multiply by the necessary factor after taking logs instead of before: it is a homomorphism, and again this avoinds dealing with larger rationals.\n3. Correct use of proof flag (though it is rather crude that when proof==False we just omit the time-consuming call to  S_integral_x_coords_with_abs_bounded_by(abs_bound)).\n4. Some speed improvements to S_integral_x_coords_with_abs_bounded_by(), and improved comments including some TODOs.\n\n[Note to Tobias and Michael M: this patch includes the changes in the patch you sent me.]\n\nI have a timing comparison table and will include it here once I have worked out how to do wiki tables.",
    "created_at": "2008-12-11T14:18:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28501",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:2" align="right">comment:2</div>

The third patch fixes a bug (missed a 2-integral points on 37a1) and makes  `S_integral_x_coords_with_abs_bounded_by()` slightly more efficient, but we are way slower than Magma and I think that the main culprits are that function and  `S_integral_points_with_bounded_mw_coeffs()`.   In the integral points case we made the latter much faster by using real points (since you can tell if a real number is approximately integral) but th analogous thing for S-integral points is more complicated.  Rather than wait, as we are getting the right points (after substantial testing against Magma, for example), I would like this to go in now and we can look into making things faster later.

Details of what is in the 3rd patch:
1. p-adic elliptic log: default precision now 20 not 100, which works fine.  Also converts points to p-adic earlier which avoids dealing with large rationals when the multiplier factor is needed.
2. Calls to p-adic log from S_integral_points() now multiply by the necessary factor after taking logs instead of before: it is a homomorphism, and again this avoinds dealing with larger rationals.
3. Correct use of proof flag (though it is rather crude that when proof==False we just omit the time-consuming call to  S_integral_x_coords_with_abs_bounded_by(abs_bound)).
4. Some speed improvements to S_integral_x_coords_with_abs_bounded_by(), and improved comments including some TODOs.

[Note to Tobias and Michael M: this patch includes the changes in the patch you sent me.]

I have a timing comparison table and will include it here once I have worked out how to do wiki tables.



---

archive/issue_events_054034.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2008-12-11T14:18:59Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "title_is": "Implement S-integral point finding for elliptic curves over Q",
    "title_was": "[not yet ready for review] Implement S-integral point finding for elliptic curves over Q",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54034"
}
```



---

archive/issue_events_054035.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2008-12-11T14:18:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54035"
}
```



---

archive/issue_comments_028502.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI keep on thinking of more things which should be done to speed this up.  I'm putting them here so they do not get lost.\n\np-adic elliptic log:  we call this on several points for each prime, but a lot of the code does not depend on the point (construction of p-adic field, and the formal group, and the series), so this code should be reorganised: this probably means having a new class to store all that stuff.",
    "created_at": "2008-12-11T14:53:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28502",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:3" align="right">comment:3</div>

I keep on thinking of more things which should be done to speed this up.  I'm putting them here so they do not get lost.

p-adic elliptic log:  we call this on several points for each prime, but a lot of the code does not depend on the point (construction of p-adic field, and the formal group, and the series), so this code should be reorganised: this probably means having a new class to store all that stuff.



---

archive/issue_comments_028503.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nHey John,\n\nI'm having a hard time with the latest patch. It does not apply on a fresh clone from 3.2.1 with the patches from ticket 4715 and the 2 others from this ticket.\n\nIt gives me:\n\n```\npatching file sage/schemes/elliptic_curves/ell_rational_field.py\nHunk #1 FAILED at 4532\nHunk #4 succeeded at 4611 with fuzz 2 (offset 0 lines).\nHunk #5 FAILED at 4633\nHunk #6 FAILED at 4655\nHunk #11 FAILED at 4822\nHunk #12 FAILED at 4845\n5 out of 16 hunks FAILED -- saving rejects to file sage/schemes/elliptic_curves/ell_rational_field.py.rej\nabort: patch failed to apply\n```\nwhen I try. Perhaps you changed something else in your file before exporting this one.\nOr am I doing something wrong?",
    "created_at": "2008-12-12T06:48:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28503",
    "user": "https://github.com/sagetrac-mardaus"
}
```

<div id="comment:4" align="right">comment:4</div>

Hey John,

I'm having a hard time with the latest patch. It does not apply on a fresh clone from 3.2.1 with the patches from ticket 4715 and the 2 others from this ticket.

It gives me:

```
patching file sage/schemes/elliptic_curves/ell_rational_field.py
Hunk #1 FAILED at 4532
Hunk #4 succeeded at 4611 with fuzz 2 (offset 0 lines).
Hunk #5 FAILED at 4633
Hunk #6 FAILED at 4655
Hunk #11 FAILED at 4822
Hunk #12 FAILED at 4845
5 out of 16 hunks FAILED -- saving rejects to file sage/schemes/elliptic_curves/ell_rational_field.py.rej
abort: patch failed to apply
```
when I try. Perhaps you changed something else in your file before exporting this one.
Or am I doing something wrong?



---

archive/issue_comments_028504.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nYep, same thing for me in my current 3.2.2.alpha2 merge tree:\n\n```\nmabshoff@sage:/scratch/mabshoff/release-cycle/sage-3.2.2.alpha2/devel/sage$ patch -p1 < trac-4741-fix2.patch\\?format\\=raw patching file sage/schemes/elliptic_curves/ell_point.py\npatching file sage/schemes/elliptic_curves/ell_rational_field.py\nHunk #1 FAILED at 4533.\nHunk #2 succeeded at 4547 (offset 1 line).\nHunk #4 succeeded at 4609 with fuzz 2.\nHunk #5 FAILED at 4634.\nHunk #6 FAILED at 4662.\nHunk #7 succeeded at 4669 (offset -10 lines).\nHunk #8 succeeded at 4695 (offset -10 lines).\nHunk #9 succeeded at 4728 (offset -10 lines).\nHunk #10 succeeded at 4744 (offset -10 lines).\nHunk #11 FAILED at 4819.\nHunk #12 FAILED at 4854.\nHunk #13 succeeded at 4936 (offset -19 lines).\nHunk #14 succeeded at 4972 (offset -19 lines).\nHunk #15 succeeded at 5014 (offset -19 lines).\nHunk #16 succeeded at 5094 (offset -19 lines).\n5 out of 16 hunks FAILED -- saving rejects to file sage/schemes/elliptic_curves/ell_rational_field.py.rej\n```\nThe only changes post 3.2.1 to that file were:\n\n```\nhangeset:   11145:614177b99fa2\nuser:        John Cremona <john.cremona@gmail.com>\ndate:        Fri Dec 05 13:34:53 2008 +0000\nsummary:     #4715 second patch\n\nchangeset:   11144:84cee787fc0f\nuser:        John Cremona <john.cremona@gmail.com>\ndate:        Fri Dec 05 11:58:48 2008 +0000\nsummary:     #4715: tiny bug fix in KodairaSymbol + doctest\n```\nBut even reverting those two patches does not make fix2 apply, so are we missing a patch?\n\nCheers,\n\nMichael",
    "created_at": "2008-12-12T06:58:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28504",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:5" align="right">comment:5</div>

Yep, same thing for me in my current 3.2.2.alpha2 merge tree:

```
mabshoff@sage:/scratch/mabshoff/release-cycle/sage-3.2.2.alpha2/devel/sage$ patch -p1 < trac-4741-fix2.patch\?format\=raw patching file sage/schemes/elliptic_curves/ell_point.py
patching file sage/schemes/elliptic_curves/ell_rational_field.py
Hunk #1 FAILED at 4533.
Hunk #2 succeeded at 4547 (offset 1 line).
Hunk #4 succeeded at 4609 with fuzz 2.
Hunk #5 FAILED at 4634.
Hunk #6 FAILED at 4662.
Hunk #7 succeeded at 4669 (offset -10 lines).
Hunk #8 succeeded at 4695 (offset -10 lines).
Hunk #9 succeeded at 4728 (offset -10 lines).
Hunk #10 succeeded at 4744 (offset -10 lines).
Hunk #11 FAILED at 4819.
Hunk #12 FAILED at 4854.
Hunk #13 succeeded at 4936 (offset -19 lines).
Hunk #14 succeeded at 4972 (offset -19 lines).
Hunk #15 succeeded at 5014 (offset -19 lines).
Hunk #16 succeeded at 5094 (offset -19 lines).
5 out of 16 hunks FAILED -- saving rejects to file sage/schemes/elliptic_curves/ell_rational_field.py.rej
```
The only changes post 3.2.1 to that file were:

```
hangeset:   11145:614177b99fa2
user:        John Cremona <john.cremona@gmail.com>
date:        Fri Dec 05 13:34:53 2008 +0000
summary:     #4715 second patch

changeset:   11144:84cee787fc0f
user:        John Cremona <john.cremona@gmail.com>
date:        Fri Dec 05 11:58:48 2008 +0000
summary:     #4715: tiny bug fix in KodairaSymbol + doctest
```
But even reverting those two patches does not make fix2 apply, so are we missing a patch?

Cheers,

Michael



---

archive/issue_comments_028505.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nSorry everyone.  I'll make a new patch which works properly, and with 3.2.2.alpha1.  Since our patches essentially just add two separate functions, one each in two files, it should not be too difficult but I'll wait until I get into the office.",
    "created_at": "2008-12-12T08:49:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28505",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:6" align="right">comment:6</div>

Sorry everyone.  I'll make a new patch which works properly, and with 3.2.2.alpha1.  Since our patches essentially just add two separate functions, one each in two files, it should not be too difficult but I'll wait until I get into the office.



---

archive/issue_comments_028506.json:
```json
{
    "body": "Attachment: **[trac-4741-rebase.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-rebase.patch.gz)**\n\nReplaces all the above; based on 3.2.2.alpha1",
    "created_at": "2008-12-12T09:47:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28506",
    "user": "https://github.com/JohnCremona"
}
```

Attachment: **[trac-4741-rebase.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-rebase.patch.gz)**

Replaces all the above; based on 3.2.2.alpha1



---

archive/issue_comments_028507.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nOK, I have posted a new patch which replaces all the earlier ones and is based on 3.2.2.alpha1.  I tested it on a fresh clone of that version and all seems well.",
    "created_at": "2008-12-12T09:49:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28507",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:7" align="right">comment:7</div>

OK, I have posted a new patch which replaces all the earlier ones and is based on 3.2.2.alpha1.  I tested it on a fresh clone of that version and all seems well.



---

archive/issue_events_054036.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-12-12T17:04:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "milestone_number": null,
    "milestone_title": "sage-3.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54036"
}
```



---

archive/issue_events_054037.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-12-12T17:04:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "milestone_number": null,
    "milestone_title": "sage-3.2.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54037"
}
```



---

archive/issue_comments_028508.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\ntrac-4741-rebase.patch applies cleanly to my Sage 3.2.2.alpha2 merge tree. But I am seeing one doctest failure with -long on sage.math:\n\n```\nmabshoff@sage:/scratch/mabshoff/release-cycle/sage-3.2.2.alpha2$ ./sage -t -long devel/sage/sage/schemes/elliptic_curves/ell_rational_field.py\nsage -t -long \"devel/sage/sage/schemes/elliptic_curves/ell_rational_field.py\"\n**********************************************************************\nFile \"/scratch/mabshoff/release-cycle/sage-3.2.2.alpha2/devel/sage/sage/schemes/elliptic_curves/ell_rational_field.py\", line 3338, in __main__.example_110\nFailed example:\n    time E.rank(), len(E.S_integral_points([Integer(3),Integer(5),Integer(7)]))  # long time (~15s)###line 4619:_sage_    >>> time E.rank(), len(E.S_integral_points([3,5,7]))  # long time (~15s)\nException raised:\n    Traceback (most recent call last):\n      File \"/scratch/mabshoff/release-cycle/sage-3.2.2.alpha2/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/scratch/mabshoff/release-cycle/sage-3.2.2.alpha2/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/scratch/mabshoff/release-cycle/sage-3.2.2.alpha2/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_110[10]>\", line 1\n         time E.rank(), len(E.S_integral_points([Integer(3),Integer(5),Integer(7)]))  # long time (~15s)###line 4619:_sage_    >>> time E.rank(), len(E.S_integral_points([3,5,7]))  # long time (~15s)\n              ^\n     SyntaxError: invalid syntax\n**********************************************************************\n1 items had failures:\n   1 of  11 in __main__.example_110\n***Test Failed*** 1 failures.\n\n         [221.0 s]\nexit code: 1024\n```\n\nCheers,\n\nMichael",
    "created_at": "2008-12-12T17:04:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28508",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:8" align="right">comment:8</div>

trac-4741-rebase.patch applies cleanly to my Sage 3.2.2.alpha2 merge tree. But I am seeing one doctest failure with -long on sage.math:

```
mabshoff@sage:/scratch/mabshoff/release-cycle/sage-3.2.2.alpha2$ ./sage -t -long devel/sage/sage/schemes/elliptic_curves/ell_rational_field.py
sage -t -long "devel/sage/sage/schemes/elliptic_curves/ell_rational_field.py"
**********************************************************************
File "/scratch/mabshoff/release-cycle/sage-3.2.2.alpha2/devel/sage/sage/schemes/elliptic_curves/ell_rational_field.py", line 3338, in __main__.example_110
Failed example:
    time E.rank(), len(E.S_integral_points([Integer(3),Integer(5),Integer(7)]))  # long time (~15s)###line 4619:_sage_    >>> time E.rank(), len(E.S_integral_points([3,5,7]))  # long time (~15s)
Exception raised:
    Traceback (most recent call last):
      File "/scratch/mabshoff/release-cycle/sage-3.2.2.alpha2/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/scratch/mabshoff/release-cycle/sage-3.2.2.alpha2/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/scratch/mabshoff/release-cycle/sage-3.2.2.alpha2/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_110[10]>", line 1
         time E.rank(), len(E.S_integral_points([Integer(3),Integer(5),Integer(7)]))  # long time (~15s)###line 4619:_sage_    >>> time E.rank(), len(E.S_integral_points([3,5,7]))  # long time (~15s)
              ^
     SyntaxError: invalid syntax
**********************************************************************
1 items had failures:
   1 of  11 in __main__.example_110
***Test Failed*** 1 failures.

         [221.0 s]
exit code: 1024
```

Cheers,

Michael



---

archive/issue_comments_028509.json:
```json
{
    "body": "Attachment: **[trac-4741-doctest.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-doctest.patch.gz)**",
    "created_at": "2008-12-12T17:17:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28509",
    "user": "https://github.com/JohnCremona"
}
```

Attachment: **[trac-4741-doctest.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-doctest.patch.gz)**



---

archive/issue_comments_028510.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nSorry about that, clearly I did not do a -long test.  I just left the \"time\"  command in the doctest by mistake.  Testing this again I find that instead of 15s this example only takes 7.5s (my work yesterday was good, wasn't it!) but I have left in the # long time sdince this files so much in it already.\n\nNew minipatch should so the trick.",
    "created_at": "2008-12-12T17:18:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28510",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:9" align="right">comment:9</div>

Sorry about that, clearly I did not do a -long test.  I just left the "time"  command in the doctest by mistake.  Testing this again I find that instead of 15s this example only takes 7.5s (my work yesterday was good, wasn't it!) but I have left in the # long time sdince this files so much in it already.

New minipatch should so the trick.



---

archive/issue_comments_028511.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nHere we go, now it applies on my 3.2.1 build and all tests, but the long passed.\nHow long should the long test for ell_rational_field take? I ran it 3h and nothing.\nThanks",
    "created_at": "2008-12-13T03:51:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28511",
    "user": "https://github.com/sagetrac-mardaus"
}
```

<div id="comment:10" align="right">comment:10</div>

Here we go, now it applies on my 3.2.1 build and all tests, but the long passed.
How long should the long test for ell_rational_field take? I ran it 3h and nothing.
Thanks



---

archive/issue_comments_028512.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nOk no idea, what was wrong on my 3.2.1 but with a fresh built 3.2.2 alpha1 and the 2 patches here, doctest worked fine. (normal and long). So I guess we are good to go for 3.2.2.\n\nCheers Michael",
    "created_at": "2008-12-13T08:15:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28512",
    "user": "https://github.com/sagetrac-mardaus"
}
```

<div id="comment:11" align="right">comment:11</div>

Ok no idea, what was wrong on my 3.2.1 but with a fresh built 3.2.2 alpha1 and the 2 patches here, doctest worked fine. (normal and long). So I guess we are good to go for 3.2.2.

Cheers Michael



---

archive/issue_comments_028513.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThanks Michael (M).  Michael (A), can we put a positive review on this?  I would have preferred someone other than the three of us reviewing eachothers' code!",
    "created_at": "2008-12-13T10:13:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28513",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:12" align="right">comment:12</div>

Thanks Michael (M).  Michael (A), can we put a positive review on this?  I would have preferred someone other than the three of us reviewing eachothers' code!



---

archive/issue_comments_028514.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nREFEREE REPORT:\n\nTwo trivial typo fixes:\n\n* \"It is not necessary to specify mw_base, then the Mordell-Weil basis must be computed (may take much longer)\" --> \"It is not necessary to specify mw_base; if it is not specified, then the Mordell-Weil basis must be computed, which may take much longer.\"\n\n* \"Computes the p-adic elliptic logarithm of self\" --> \"Computes the p-adic elliptic logarithm of self.\"\n\nA BUG:\n\n```\nsage: E = EllipticCurve('794a1')\nsage: E.S_integral_points([2,3,5])\nTraceback (most recent call last):\n...\nsage.rings.padics.precision_error.PrecisionError: cannot divide by something indistinguishable from zero\n```",
    "created_at": "2008-12-13T21:39:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28514",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:13" align="right">comment:13</div>

REFEREE REPORT:

Two trivial typo fixes:

* "It is not necessary to specify mw_base, then the Mordell-Weil basis must be computed (may take much longer)" --> "It is not necessary to specify mw_base; if it is not specified, then the Mordell-Weil basis must be computed, which may take much longer."

* "Computes the p-adic elliptic logarithm of self" --> "Computes the p-adic elliptic logarithm of self."

A BUG:

```
sage: E = EllipticCurve('794a1')
sage: E.S_integral_points([2,3,5])
Traceback (most recent call last):
...
sage.rings.padics.precision_error.PrecisionError: cannot divide by something indistinguishable from zero
```



---

archive/issue_events_054038.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-12-13T21:39:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54038"
}
```



---

archive/issue_events_054039.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-12-13T21:39:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54039"
}
```



---

archive/issue_comments_028515.json:
```json
{
    "body": "Attachment: **[trac-4741-prec.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-prec.patch.gz)**",
    "created_at": "2008-12-13T22:16:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28515",
    "user": "https://github.com/JohnCremona"
}
```

Attachment: **[trac-4741-prec.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-prec.patch.gz)**



---

archive/issue_events_054040.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2008-12-13T22:17:10Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "title_is": "[needs review again] Implement S-integral point finding for elliptic curves over Q",
    "title_was": "Implement S-integral point finding for elliptic curves over Q",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54040"
}
```



---

archive/issue_comments_028516.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThe *-prec.patch fixes that for your example but a more itelligent solution would be preferable...",
    "created_at": "2008-12-13T22:17:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28516",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:14" align="right">comment:14</div>

The *-prec.patch fixes that for your example but a more itelligent solution would be preferable...



---

archive/issue_comments_028517.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nAttachment: **[trac-4741-typos.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-typos.patch.gz)**\n\nSorry, forgot to fix the typos: see *-typos.patch.  Sorry for the extra hassle.",
    "created_at": "2008-12-13T22:21:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28517",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:15" align="right">comment:15</div>

Attachment: **[trac-4741-typos.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-typos.patch.gz)**

Sorry, forgot to fix the typos: see *-typos.patch.  Sorry for the extra hassle.



---

archive/issue_comments_028518.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nAttachment: **[trac-4741-fix3.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-fix3.patch.gz)**\n\nOK, so I found 2 more trivial bugs in kodaira which only mattered in the tamagawa_exponent() function used (only) in S_integral_points and padic_elliptic_log functions.  Fixed, and tested that tamagawa_exponent() works on all curves in the database to 6000, with all bad primes for each.  (Sorry, I have not checked that this covers all Kodaira types, but I think so.  The code even failed on 1 curve of conductor 15.)\n\nThat revealed a but in pari_curve(), for example 903b3, where the default pari precision was not enough.  I now test for this (with try: ... except PariError) and double the precision on failure, continuing until success.  The crazy thing is that I remember fixing that bug before, but it must have been while working on something which never got submitted (or is bitrotting on trac perhaps;)).\n\nNext I tested again the database curves of rank at least 2 with S=[2,3,5].  No problems until 2175c3, and that just takes a long time.  So I think it is safe to proceed (famous last words, but it's my bedtime).  The *-fix3.patch contains the above-mentioned fixes and also adapts the doctests to agree with the output from the enhanced p-adic precision which I forgot earlier.",
    "created_at": "2008-12-13T23:16:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28518",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:16" align="right">comment:16</div>

Attachment: **[trac-4741-fix3.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-fix3.patch.gz)**

OK, so I found 2 more trivial bugs in kodaira which only mattered in the tamagawa_exponent() function used (only) in S_integral_points and padic_elliptic_log functions.  Fixed, and tested that tamagawa_exponent() works on all curves in the database to 6000, with all bad primes for each.  (Sorry, I have not checked that this covers all Kodaira types, but I think so.  The code even failed on 1 curve of conductor 15.)

That revealed a but in pari_curve(), for example 903b3, where the default pari precision was not enough.  I now test for this (with try: ... except PariError) and double the precision on failure, continuing until success.  The crazy thing is that I remember fixing that bug before, but it must have been while working on something which never got submitted (or is bitrotting on trac perhaps;)).

Next I tested again the database curves of rank at least 2 with S=[2,3,5].  No problems until 2175c3, and that just takes a long time.  So I think it is safe to proceed (famous last words, but it's my bedtime).  The *-fix3.patch contains the above-mentioned fixes and also adapts the doctests to agree with the output from the enhanced p-adic precision which I forgot earlier.



---

archive/issue_comments_028519.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\n\n```\n[12:23am] wstein: I can't apply trac-4741-fix3.patch  from cremona's ticket cleanly...\n[12:24am] wstein: If the patch passes all doctests and you can apply it, then positive review.\n[12:24am] mabshoff: mk\n[12:24am] wstein: He addressed my issues, and did a good test of running the code.\n[12:24am] mabshoff: ok\n```",
    "created_at": "2008-12-14T08:27:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28519",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:17" align="right">comment:17</div>


```
[12:23am] wstein: I can't apply trac-4741-fix3.patch  from cremona's ticket cleanly...
[12:24am] wstein: If the patch passes all doctests and you can apply it, then positive review.
[12:24am] mabshoff: mk
[12:24am] wstein: He addressed my issues, and did a good test of running the code.
[12:24am] mabshoff: ok
```



---

archive/issue_events_054041.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-12-14T08:27:59Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "title_is": "Implement S-integral point finding for elliptic curves over Q",
    "title_was": "[needs review again] Implement S-integral point finding for elliptic curves over Q",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54041"
}
```



---

archive/issue_events_054042.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-12-14T08:27:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54042"
}
```



---

archive/issue_events_054043.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-12-14T08:27:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54043"
}
```



---

archive/issue_comments_028520.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nSo sort of positive review.  I have read all the latest changes and they *look* good, but I have *not* actually tried the new code or run doctests, since I can't apply the last patch.",
    "created_at": "2008-12-14T08:28:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28520",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:18" align="right">comment:18</div>

So sort of positive review.  I have read all the latest changes and they *look* good, but I have *not* actually tried the new code or run doctests, since I can't apply the last patch.



---

archive/issue_comments_028521.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nYep, I am seeing the same issue as William:\n\n```\nmabshoff@sage:/scratch/mabshoff/release-cycle/sage-3.2.2.rc0/devel/sage$ patch -p1 < trac_4741_part_1_rebase.patch \npatching file sage/schemes/elliptic_curves/ell_point.py\npatching file sage/schemes/elliptic_curves/ell_rational_field.py\nHunk #1 succeeded at 4585 (offset 53 lines).\nmabshoff@sage:/scratch/mabshoff/release-cycle/sage-3.2.2.rc0/devel/sage$ patch -p1 < trac_4741_part_2_doctest.patch \npatching file sage/schemes/elliptic_curves/ell_rational_field.py\nHunk #1 succeeded at 4669 (offset 53 lines).\nmabshoff@sage:/scratch/mabshoff/release-cycle/sage-3.2.2.rc0/devel/sage$ patch -p1 < trac_4741_part_3_prec.patch \npatching file sage/schemes/elliptic_curves/ell_point.py\nmabshoff@sage:/scratch/mabshoff/release-cycle/sage-3.2.2.rc0/devel/sage$ patch -p1 < trac_4741_part_4_typos.patch \npatching file sage/schemes/elliptic_curves/ell_point.py\npatching file sage/schemes/elliptic_curves/ell_rational_field.py\nHunk #1 succeeded at 4651 (offset 66 lines).\nmabshoff@sage:/scratch/mabshoff/release-cycle/sage-3.2.2.rc0/devel/sage$ patch -p1 --dry-run < trac_4741_part_5_fix3.patch \npatching file sage/schemes/elliptic_curves/ell_point.py\npatching file sage/schemes/elliptic_curves/ell_rational_field.py\nHunk #1 FAILED at 485.\nHunk #2 FAILED at 509.\nHunk #3 succeeded at 4644 (offset 66 lines).\n2 out of 3 hunks FAILED -- saving rejects to file sage/schemes/elliptic_curves/ell_rational_field.py.rej\npatching file sage/schemes/elliptic_curves/kodaira_symbol.py\nHunk #1 FAILED at 78.\n1 out of 1 hunk FAILED -- saving rejects to file sage/schemes/elliptic_curves/kodaira_symbol.py.rej\n```\nSo either I am doing something wrong, i.e. merging the wrong patches or fix3 needs a rebase.\n\nCheers,\n\nMichael",
    "created_at": "2008-12-14T08:35:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28521",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:19" align="right">comment:19</div>

Yep, I am seeing the same issue as William:

```
mabshoff@sage:/scratch/mabshoff/release-cycle/sage-3.2.2.rc0/devel/sage$ patch -p1 < trac_4741_part_1_rebase.patch 
patching file sage/schemes/elliptic_curves/ell_point.py
patching file sage/schemes/elliptic_curves/ell_rational_field.py
Hunk #1 succeeded at 4585 (offset 53 lines).
mabshoff@sage:/scratch/mabshoff/release-cycle/sage-3.2.2.rc0/devel/sage$ patch -p1 < trac_4741_part_2_doctest.patch 
patching file sage/schemes/elliptic_curves/ell_rational_field.py
Hunk #1 succeeded at 4669 (offset 53 lines).
mabshoff@sage:/scratch/mabshoff/release-cycle/sage-3.2.2.rc0/devel/sage$ patch -p1 < trac_4741_part_3_prec.patch 
patching file sage/schemes/elliptic_curves/ell_point.py
mabshoff@sage:/scratch/mabshoff/release-cycle/sage-3.2.2.rc0/devel/sage$ patch -p1 < trac_4741_part_4_typos.patch 
patching file sage/schemes/elliptic_curves/ell_point.py
patching file sage/schemes/elliptic_curves/ell_rational_field.py
Hunk #1 succeeded at 4651 (offset 66 lines).
mabshoff@sage:/scratch/mabshoff/release-cycle/sage-3.2.2.rc0/devel/sage$ patch -p1 --dry-run < trac_4741_part_5_fix3.patch 
patching file sage/schemes/elliptic_curves/ell_point.py
patching file sage/schemes/elliptic_curves/ell_rational_field.py
Hunk #1 FAILED at 485.
Hunk #2 FAILED at 509.
Hunk #3 succeeded at 4644 (offset 66 lines).
2 out of 3 hunks FAILED -- saving rejects to file sage/schemes/elliptic_curves/ell_rational_field.py.rej
patching file sage/schemes/elliptic_curves/kodaira_symbol.py
Hunk #1 FAILED at 78.
1 out of 1 hunk FAILED -- saving rejects to file sage/schemes/elliptic_curves/kodaira_symbol.py.rej
```
So either I am doing something wrong, i.e. merging the wrong patches or fix3 needs a rebase.

Cheers,

Michael



---

archive/issue_events_054044.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-12-14T08:35:29Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "title_is": "[needs rebase] Implement S-integral point finding for elliptic curves over Q",
    "title_was": "Implement S-integral point finding for elliptic curves over Q",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54044"
}
```



---

archive/issue_comments_028522.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nI think my problem is that I had just done a -upgrade to 3.2.2.alpha1 which -- as usual with upgrades -- toally and utterly confused me.  Upgrades leave with with a Sage version which does not match the name of the directory that it is in.\n\nSo now I'll try to make it work properly with 3.2.2.alpha2 (not alpha1) and while I am at it, combine those 3 little patches into one.",
    "created_at": "2008-12-14T11:04:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28522",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:20" align="right">comment:20</div>

I think my problem is that I had just done a -upgrade to 3.2.2.alpha1 which -- as usual with upgrades -- toally and utterly confused me.  Upgrades leave with with a Sage version which does not match the name of the directory that it is in.

So now I'll try to make it work properly with 3.2.2.alpha2 (not alpha1) and while I am at it, combine those 3 little patches into one.



---

archive/issue_events_054045.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2008-12-14T11:59:25Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "title_is": "[with rebased patch, needs review (finally)] Implement S-integral point finding for elliptic curves over Q",
    "title_was": "[needs rebase] Implement S-integral point finding for elliptic curves over Q",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54045"
}
```



---

archive/issue_comments_028523.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nAttachment: **[trac-4741-rebased-fixes.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-rebased-fixes.patch.gz)**\n\nI was right: last night's 3 patches were all based on the previous release.  This explains two things:  the kodaira bugs I re-fixed last night had already been fixed, as had the pari_curve precision problem.\n\nSo now we have trac-4741-rebased-fixes.patch which (1) replaces the previous 3; (2) is properly based on 3.2.2.alpha2; (3) improves on the earlier fixes by handling the p-adic precision more intelligently (it uses try/except, first trying p-adci precision 20 and doubling if that fails).\n\nI tried the patch on a new clone of 3.2.2.alpha2.  To recap, apply these three patches in this order and ignore the others:\n1. trac-4741-rebase.patch\n2. trac-4741-doctest.patch\n3. trac-4741-rebased-fixes.patch\nand you should find that all doctests in sage/schemes/elliptic_curves pass, and that for all database curves to conductor 2000 of rank>1 E.S_integral_points([2,3,5]) works fine.",
    "created_at": "2008-12-14T11:59:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28523",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:21" align="right">comment:21</div>

Attachment: **[trac-4741-rebased-fixes.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-rebased-fixes.patch.gz)**

I was right: last night's 3 patches were all based on the previous release.  This explains two things:  the kodaira bugs I re-fixed last night had already been fixed, as had the pari_curve precision problem.

So now we have trac-4741-rebased-fixes.patch which (1) replaces the previous 3; (2) is properly based on 3.2.2.alpha2; (3) improves on the earlier fixes by handling the p-adic precision more intelligently (it uses try/except, first trying p-adci precision 20 and doubling if that fails).

I tried the patch on a new clone of 3.2.2.alpha2.  To recap, apply these three patches in this order and ignore the others:
1. trac-4741-rebase.patch
2. trac-4741-doctest.patch
3. trac-4741-rebased-fixes.patch
and you should find that all doctests in sage/schemes/elliptic_curves pass, and that for all database curves to conductor 2000 of rank>1 E.S_integral_points([2,3,5]) works fine.



---

archive/issue_comments_028524.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@williamstein](#comment%3A18):\n> \n> \n> So sort of positive review.  I have read all the latest changes and they *look* good, but I have *not* actually tried the new code or run doctests, since I can't apply the last patch. \n\nApplying \n\n1. trac-4741-rebase.patch\n2. trac-4741-doctest.patch\n3. trac-4741-rebased-fixes.patch\n\nleads to a working Sage as well as passing doctests.\n\nWilliam: I assume you want to give this the final positive review once you poke around a little more.\n\nCheers,\n\nMichael",
    "created_at": "2008-12-14T16:55:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28524",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@williamstein](#comment%3A18):
> 
> 
> So sort of positive review.  I have read all the latest changes and they *look* good, but I have *not* actually tried the new code or run doctests, since I can't apply the last patch. 

Applying 

1. trac-4741-rebase.patch
2. trac-4741-doctest.patch
3. trac-4741-rebased-fixes.patch

leads to a working Sage as well as passing doctests.

William: I assume you want to give this the final positive review once you poke around a little more.

Cheers,

Michael



---

archive/issue_comments_028525.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nREFEREE REPORT:\n\nI broke it again with a simple for loop.\n\n```\nsage: EllipticCurve('2534g1').S_integral_points([13,2])\n...\n--> 576             return self[0]/self[2], self[1]/self[2]\n    577 \n    578     def is_divisible_by(self, m):\n\n/home/was/build/sage-3.2.2.alpha2/local/lib/python2.5/site-packages/sage/structure/element.so in sage.structure.element.RingElement.__div__ (sage/structure/element.c:9074)()\n\n/home/was/build/sage-3.2.2.alpha2/local/lib/python2.5/site-packages/sage/rings/padics/padic_capped_relative_element.so in sage.rings.padics.padic_capped_relative_element.pAdicCappedRelativeElement._div_ (sage/rings/padics/padic_capped_relative_element.c:11055)()\n\nZeroDivisionError: cannot divide by zero\n```\n\nThis is the loop that got it:\n\n```\nsage: for E in cremona_optimal_curves([1000..10000]):\n    if E.rank() == 2:\n        print E.cremona_label(), E.S_integral_points([13]+[E.conductor().factor()[0][0]])\n```",
    "created_at": "2008-12-14T19:27:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28525",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:23" align="right">comment:23</div>

REFEREE REPORT:

I broke it again with a simple for loop.

```
sage: EllipticCurve('2534g1').S_integral_points([13,2])
...
--> 576             return self[0]/self[2], self[1]/self[2]
    577 
    578     def is_divisible_by(self, m):

/home/was/build/sage-3.2.2.alpha2/local/lib/python2.5/site-packages/sage/structure/element.so in sage.structure.element.RingElement.__div__ (sage/structure/element.c:9074)()

/home/was/build/sage-3.2.2.alpha2/local/lib/python2.5/site-packages/sage/rings/padics/padic_capped_relative_element.so in sage.rings.padics.padic_capped_relative_element.pAdicCappedRelativeElement._div_ (sage/rings/padics/padic_capped_relative_element.c:11055)()

ZeroDivisionError: cannot divide by zero
```

This is the loop that got it:

```
sage: for E in cremona_optimal_curves([1000..10000]):
    if E.rank() == 2:
        print E.cremona_label(), E.S_integral_points([13]+[E.conductor().factor()[0][0]])
```



---

archive/issue_events_054046.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-12-14T19:27:15Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "title_is": "[with rebased patch] Implement S-integral point finding for elliptic curves over Q",
    "title_was": "[with rebased patch, needs review (finally)] Implement S-integral point finding for elliptic curves over Q",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54046"
}
```



---

archive/issue_events_054047.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-12-14T19:27:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54047"
}
```



---

archive/issue_events_054048.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-12-14T19:27:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54048"
}
```



---

archive/issue_events_054049.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-12-14T20:09:31Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "title_is": "Implement S-integral point finding for elliptic curves over Q",
    "title_was": "[with rebased patch] Implement S-integral point finding for elliptic curves over Q",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54049"
}
```



---

archive/issue_comments_028526.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nFix the summary so that this ticket isn't picked up by report 19.\n\nCheers,\n\nMichael",
    "created_at": "2008-12-14T20:09:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28526",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:24" align="right">comment:24</div>

Fix the summary so that this ticket isn't picked up by report 19.

Cheers,

Michael



---

archive/issue_comments_028527.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nDon't you just love thorough reviewing (seriously).  I was not trapping enough errors in my padic log fix.  Now as well as PariError I trap ZeroDivisionError and TypeError, which can all happen when the precision is too low.  That run fine on was's loop until 2666e1.  This may not get finished tonight...",
    "created_at": "2008-12-14T20:57:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28527",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:25" align="right">comment:25</div>

Don't you just love thorough reviewing (seriously).  I was not trapping enough errors in my padic log fix.  Now as well as PariError I trap ZeroDivisionError and TypeError, which can all happen when the precision is too low.  That run fine on was's loop until 2666e1.  This may not get finished tonight...



---

archive/issue_events_054050.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2008-12-14T22:11:36Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "title_is": "[with new patch, needs review (and work too)] Implement S-integral point finding for elliptic curves over Q",
    "title_was": "Implement S-integral point finding for elliptic curves over Q",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54050"
}
```



---

archive/issue_comments_028528.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nAttachment: **[trac-4741-padic.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-padic.patch.gz)**\n\nVarious p-adic precision bandaids applied, so that William's loop now runs up to this one:\n\nsage: EllipticCurve(\"7690e1\").S_integral_points([13,2])\n\nat which point there's an error raised deep in the p-adic code.  I can't deal with that now, so someone will have to make a judgement about whether this is now \"good enough\".\n\nWorking with p-adics is an acquired skill which I'm not sure I have enough of -- perhaps we need reinforcements?  For example, you cannot just do E.change_ring(Qp(p,precision)) for E an elliptic curve over Q, since an error will be raised if the precision is too low (only of p is a prime of bad reduction I think, so one should be able to work out the necessary precision).\n\nTobias and Michael, the try/except I put in around line 5077 of ell_rational_field.py was not fully thought through, perhaps that is something you should look into?\n\n\ntrac-4741-padic.patch",
    "created_at": "2008-12-14T22:11:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28528",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:26" align="right">comment:26</div>

Attachment: **[trac-4741-padic.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-padic.patch.gz)**

Various p-adic precision bandaids applied, so that William's loop now runs up to this one:

sage: EllipticCurve("7690e1").S_integral_points([13,2])

at which point there's an error raised deep in the p-adic code.  I can't deal with that now, so someone will have to make a judgement about whether this is now "good enough".

Working with p-adics is an acquired skill which I'm not sure I have enough of -- perhaps we need reinforcements?  For example, you cannot just do E.change_ring(Qp(p,precision)) for E an elliptic curve over Q, since an error will be raised if the precision is too low (only of p is a prime of bad reduction I think, so one should be able to work out the necessary precision).

Tobias and Michael, the try/except I put in around line 5077 of ell_rational_field.py was not fully thought through, perhaps that is something you should look into?


trac-4741-padic.patch



---

archive/issue_comments_028529.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nI will have a look at the try/except statement.Unfortunately I have to attend some courses at university this morning, so I will do that this afternoon. Was there a special curve you needed this try/except?\n\nI hope the rest of the code will get a \"good enough\" judgment.",
    "created_at": "2008-12-15T09:00:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28529",
    "user": "https://github.com/sagetrac-tnagel"
}
```

<div id="comment:27" align="right">comment:27</div>

I will have a look at the try/except statement.Unfortunately I have to attend some courses at university this morning, so I will do that this afternoon. Was there a special curve you needed this try/except?

I hope the rest of the code will get a "good enough" judgment.



---

archive/issue_comments_028530.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nI am inclined to merge this code and then open a new ticket for the remaining issues. This code has gotten beaten up quite a bit and it seems certainly to be a lot less buggy than any currently released Magma code :)\n\nCheers,\n\nMichael",
    "created_at": "2008-12-15T09:02:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28530",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:28" align="right">comment:28</div>

I am inclined to merge this code and then open a new ticket for the remaining issues. This code has gotten beaten up quite a bit and it seems certainly to be a lot less buggy than any currently released Magma code :)

Cheers,

Michael



---

archive/issue_comments_028531.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nThanks for the encouragement, Michael!\n\nHere's the strategy I propose.  We separate out as an issue the computation of the p-adic elliptic log (of a point on an elliptic curve over Q, and later over number fields).  A lot of this work does not depend on the point, only on the curve and the prime (specifically, construction of the base-change curve over Qp, and the integer f such that `f*E(Qp)\\subseteq E^1(Qp)`, which is the product of the tamagawa exponent (already cached) and the exponent of the group mod p).  This could be stored in the local_data class which we already have.  The p-adic part of this would need some work to compute the suitable precision needed (which may be more than the user asks for).\n\nThe second issue is then the S_integral points code itself, where I had one difficulty.  I'll recover the curve which caused that and send it to tnagel.",
    "created_at": "2008-12-15T09:41:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28531",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:29" align="right">comment:29</div>

Thanks for the encouragement, Michael!

Here's the strategy I propose.  We separate out as an issue the computation of the p-adic elliptic log (of a point on an elliptic curve over Q, and later over number fields).  A lot of this work does not depend on the point, only on the curve and the prime (specifically, construction of the base-change curve over Qp, and the integer f such that `f*E(Qp)\subseteq E^1(Qp)`, which is the product of the tamagawa exponent (already cached) and the exponent of the group mod p).  This could be stored in the local_data class which we already have.  The p-adic part of this would need some work to compute the suitable precision needed (which may be more than the user asks for).

The second issue is then the S_integral points code itself, where I had one difficulty.  I'll recover the curve which caused that and send it to tnagel.



---

archive/issue_comments_028532.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nI am OK with merging the code as is now, as long as a \"NOTE:\" is added to the docstring for S_integral_points (etc.) that it is known to fail on some input, with a pointer to the appropriate trac ticket.  I much prefer that to the Ma* approach of \"there are no bugs here\" approach, where one lets the user discover bugs.\n\nSo \"positive review\" modulo adding such a note.",
    "created_at": "2008-12-15T15:33:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28532",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:30" align="right">comment:30</div>

I am OK with merging the code as is now, as long as a "NOTE:" is added to the docstring for S_integral_points (etc.) that it is known to fail on some input, with a pointer to the appropriate trac ticket.  I much prefer that to the Ma* approach of "there are no bugs here" approach, where one lets the user discover bugs.

So "positive review" modulo adding such a note.



---

archive/issue_comments_028533.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@williamstein](#comment%3A30):\n> I am OK with merging the code as is now, as long as a \"NOTE:\" is added to the docstring for S_integral_points (etc.) that it is known to fail on some input, with a pointer to the appropriate trac ticket.  I much prefer that to the Ma* approach of \"there are no bugs here\" approach, where one lets the user discover bugs.\n> \n> So \"positive review\" modulo adding such a note.\n\nSounds good to me.  I'll try to add such a NOTE today.  JEC",
    "created_at": "2008-12-15T15:55:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28533",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@williamstein](#comment%3A30):
> I am OK with merging the code as is now, as long as a "NOTE:" is added to the docstring for S_integral_points (etc.) that it is known to fail on some input, with a pointer to the appropriate trac ticket.  I much prefer that to the Ma* approach of "there are no bugs here" approach, where one lets the user discover bugs.
> 
> So "positive review" modulo adding such a note.

Sounds good to me.  I'll try to add such a NOTE today.  JEC



---

archive/issue_comments_028534.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nAttachment: **[trac-4741-note.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-note.patch.gz)**\n\nReplying to [@JohnCremona](#comment%3A31):\n> Replying to [@williamstein](#comment%3A30):\n> > I am OK with merging the code as is now, as long as a \"NOTE:\" is added to the docstring for S_integral_points (etc.) that it is known to fail on some input, with a pointer to the appropriate trac ticket.  I much prefer that to the Ma* approach of \"there are no bugs here\" approach, where one lets the user discover bugs.\n> > \n> > So \"positive review\" modulo adding such a note.\n\n> \n> Sounds good to me.  I'll try to add such a NOTE today.  JEC  -- done",
    "created_at": "2008-12-15T16:32:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28534",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:32" align="right">comment:32</div>

Attachment: **[trac-4741-note.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-note.patch.gz)**

Replying to [@JohnCremona](#comment%3A31):
> Replying to [@williamstein](#comment%3A30):
> > I am OK with merging the code as is now, as long as a "NOTE:" is added to the docstring for S_integral_points (etc.) that it is known to fail on some input, with a pointer to the appropriate trac ticket.  I much prefer that to the Ma* approach of "there are no bugs here" approach, where one lets the user discover bugs.
> > 
> > So "positive review" modulo adding such a note.

> 
> Sounds good to me.  I'll try to add such a NOTE today.  JEC  -- done



---

archive/issue_comments_028535.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nPositive review pending deletion of the question mark \"?\" in this line of the last patch:\n\n```\nEllipticCurve?(\"7690e1\").S_integral_points([13,2])\n```\n\nWilliam",
    "created_at": "2008-12-15T16:41:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28535",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:33" align="right">comment:33</div>

Positive review pending deletion of the question mark "?" in this line of the last patch:

```
EllipticCurve?("7690e1").S_integral_points([13,2])
```

William



---

archive/issue_comments_028536.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nJohn,\n\nplease also open a new ticket for that known failure and mention that ticket in the NOTE since this ticket will then be closed and finding the info about that curve is much easier at a clean and new ticket.\n\nCheers,\n\nMichael",
    "created_at": "2008-12-15T16:43:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28536",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:34" align="right">comment:34</div>

John,

please also open a new ticket for that known failure and mention that ticket in the NOTE since this ticket will then be closed and finding the info about that curve is much easier at a clean and new ticket.

Cheers,

Michael



---

archive/issue_comments_028537.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nAttachment: **[trac-4741-note2.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-note2.patch.gz)**\n\nReplying to [@sagetrac-mabshoff](#comment%3A34):\n> John,\n> \n> please also open a new ticket for that known failure and mention that ticket in the NOTE since this ticket will then be closed and finding the info about that curve is much easier at a clean and new ticket.\n> \n> Cheers,\n> \n> Michael\n\nTypo fixed and reference to new ticket #4805 added in *-note2.patch.",
    "created_at": "2008-12-15T17:02:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28537",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:35" align="right">comment:35</div>

Attachment: **[trac-4741-note2.patch.gz](https://github.com/sagemath/sage/files/ticket4741/trac-4741-note2.patch.gz)**

Replying to [@sagetrac-mabshoff](#comment%3A34):
> John,
> 
> please also open a new ticket for that known failure and mention that ticket in the NOTE since this ticket will then be closed and finding the info about that curve is much easier at a clean and new ticket.
> 
> Cheers,
> 
> Michael

Typo fixed and reference to new ticket #4805 added in *-note2.patch.



---

archive/issue_comments_028538.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@williamstein](#comment%3A33):\n> Positive review pending deletion of the question mark \"?\" in this line of the last patch:\n> \n> ```\n> EllipticCurve?(\"7690e1\").S_integral_points([13,2])\n> ```\n> \n> William\n\nPerfectionist!  Of course I notived that after uploading the patch (after which there is no way of deleting it for us ordinary mortals ;)).",
    "created_at": "2008-12-15T17:03:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28538",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@williamstein](#comment%3A33):
> Positive review pending deletion of the question mark "?" in this line of the last patch:
> 
> ```
> EllipticCurve?("7690e1").S_integral_points([13,2])
> ```
> 
> William

Perfectionist!  Of course I notived that after uploading the patch (after which there is no way of deleting it for us ordinary mortals ;)).



---

archive/issue_events_054051.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-12-15T17:09:35Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "title_is": "Implement S-integral point finding for elliptic curves over Q",
    "title_was": "[with new patch, needs review (and work too)] Implement S-integral point finding for elliptic curves over Q",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54051"
}
```



---

archive/issue_events_054052.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-12-15T17:09:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54052"
}
```



---

archive/issue_events_054053.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-12-15T17:09:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54053"
}
```



---

archive/issue_comments_028539.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nPositive review. Finally ;)\n\nCheers,\n\nMichael",
    "created_at": "2008-12-15T17:09:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28539",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:37" align="right">comment:37</div>

Positive review. Finally ;)

Cheers,

Michael



---

archive/issue_events_054054.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-12-15T17:12:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54054"
}
```



---

archive/issue_events_054055.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-12-15T17:12:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4741#event-54055"
}
```



---

archive/issue_comments_028540.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nMerged \n* trac_4741_part_1_rebase.patch\n* trac_4741_part_2_doctest.patch\n* trac_4741_part_3_rebased-fixes.patch\n* trac_4741_part_4_note.patch\n* trac_4741_part_5_note2.patch\n\nin Sage 3.2.2.rc0",
    "created_at": "2008-12-15T17:12:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4741#issuecomment-28540",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:38" align="right">comment:38</div>

Merged 
* trac_4741_part_1_rebase.patch
* trac_4741_part_2_doctest.patch
* trac_4741_part_3_rebased-fixes.patch
* trac_4741_part_4_note.patch
* trac_4741_part_5_note2.patch

in Sage 3.2.2.rc0
