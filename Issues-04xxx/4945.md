# Issue 4945: [with patch, positive review] LaTeX for gp elements shouldn't use verbatim environment

archive/issues_004945.json:
```json
{
    "body": "Gary wrote: \n \nWhen using the SAGE notebook with typeset on, the command \n\n``` \n  gp(2+2) \n``` \ngives the error `'Unknown environment \"verbatim\"'`. \n \nTyping \n\n``` \n  gp(2+2) \n``` \nin the SAGE command line works fine. I think it is a latex output \nerror. \n \nI can confirm this bug. It is caused by the generic latex method for Expect elements: \n \n``` \nsage: latex(gp(2+2)) \n\\begin{verbatim}4\\end{verbatim} \n``` \n \nwhich apparently doesn't play well with jsMath. \n \n`search_src(\"begin{verbatim}\")` returns 43 hits.\n\nAssignee: cwitty\n\nKeywords: jsmath\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/4945\n\n",
    "closed_at": "2009-01-12T02:17:47Z",
    "created_at": "2009-01-06T16:56:57Z",
    "labels": [
        "component: misc",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-3.3",
    "title": "[with patch, positive review] LaTeX for gp elements shouldn't use verbatim environment",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/4945",
    "user": "https://github.com/malb"
}
```
Gary wrote: 
 
When using the SAGE notebook with typeset on, the command 

``` 
  gp(2+2) 
``` 
gives the error `'Unknown environment "verbatim"'`. 
 
Typing 

``` 
  gp(2+2) 
``` 
in the SAGE command line works fine. I think it is a latex output 
error. 
 
I can confirm this bug. It is caused by the generic latex method for Expect elements: 
 
``` 
sage: latex(gp(2+2)) 
\begin{verbatim}4\end{verbatim} 
``` 
 
which apparently doesn't play well with jsMath. 
 
`search_src("begin{verbatim}")` returns 43 hits.

Assignee: cwitty

Keywords: jsmath

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/4945





---

archive/issue_comments_040788.json:
```json
{
    "body": "<a id='comment:1'></a>\n| search_src(\"begin{verbatim}\") returns 43 hits\n\nMost of those are in docstrings, so we don't need to worry about them.  I think the only relevant instances are interfaces/expect.py, misc/latex.py, misc/log.py.  I don't understand how verbatim is used in the last two.  The attached patch seems to fix the problem in the first one: `latex(gp(2+2))` works in the notebook now.\n\n(The solution here is to change verbatim to verb -- search misc/all.py for 'verbatim' to see very similar code) and then to use the jsMath 'verb' extension.)",
    "created_at": "2009-01-06T18:53:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4945#issuecomment-40788",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:1'></a>
| search_src("begin{verbatim}") returns 43 hits

Most of those are in docstrings, so we don't need to worry about them.  I think the only relevant instances are interfaces/expect.py, misc/latex.py, misc/log.py.  I don't understand how verbatim is used in the last two.  The attached patch seems to fix the problem in the first one: `latex(gp(2+2))` works in the notebook now.

(The solution here is to change verbatim to verb -- search misc/all.py for 'verbatim' to see very similar code) and then to use the jsMath 'verb' extension.)



---

archive/issue_comments_040789.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe extra \\require{verb} worries me, since it is included each time an element is LaTeXified. Shouldn't it be in some header?\n\nCheers,\nMartin",
    "created_at": "2009-01-06T20:00:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4945#issuecomment-40789",
    "user": "https://github.com/malb"
}
```

<a id='comment:2'></a>
The extra \require{verb} worries me, since it is included each time an element is LaTeXified. Shouldn't it be in some header?

Cheers,
Martin



---

archive/issue_comments_040790.json:
```json
{
    "body": "<a id='comment:3'></a>\nReplying to [malb](#comment%3A2):\n> The extra \\require{verb} worries me, since it is included each time an element is LaTeXified. Shouldn't it be in some header?\n\n\nYes, maybe it should.  I couldn't figure out where, though.\n\n(For more on the jsMath verb extension, including different ways of loading it, see [this web page](http://www.math.union.edu/~dpvc/jsMath/authors/verb.html).)",
    "created_at": "2009-01-06T20:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4945#issuecomment-40790",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:3'></a>
Replying to [malb](#comment%3A2):
> The extra \require{verb} worries me, since it is included each time an element is LaTeXified. Shouldn't it be in some header?


Yes, maybe it should.  I couldn't figure out where, though.

(For more on the jsMath verb extension, including different ways of loading it, see [this web page](http://www.math.union.edu/~dpvc/jsMath/authors/verb.html).)



---

archive/issue_comments_040791.json:
```json
{
    "body": "<a id='comment:4'></a>\nI just posted a slightly different version of the patch.  It doesn't address malb's issue, but it is a little cleaner: it only includes '\\require{verb}' if in notebook mode.",
    "created_at": "2009-01-06T20:54:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4945#issuecomment-40791",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>
I just posted a slightly different version of the patch.  It doesn't address malb's issue, but it is a little cleaner: it only includes '\require{verb}' if in notebook mode.



---

archive/issue_comments_040792.json:
```json
{
    "body": "<a id='comment:5'></a>\nOkay, here's a patch which (I think) addresses malb's issue.",
    "created_at": "2009-01-07T00:10:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4945#issuecomment-40792",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>
Okay, here's a patch which (I think) addresses malb's issue.



---

archive/issue_comments_040793.json:
```json
{
    "body": "<a id='comment:6'></a>\nAttachment [4945.patch](tarball://root/attachments/some-uuid/ticket4945/4945.patch) by @malb created at 2009-01-07 12:13:37\n\nPatch looks good.",
    "created_at": "2009-01-07T12:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4945#issuecomment-40793",
    "user": "https://github.com/malb"
}
```

<a id='comment:6'></a>
Attachment [4945.patch](tarball://root/attachments/some-uuid/ticket4945/4945.patch) by @malb created at 2009-01-07 12:13:37

Patch looks good.



---

archive/issue_events_011420.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-01-12T02:17:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/4945",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4945#event-11420"
}
```



---

archive/issue_comments_040794.json:
```json
{
    "body": "<a id='comment:7'></a>\nMerged in Sage 3.3.alpha0",
    "created_at": "2009-01-12T02:17:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4945#issuecomment-40794",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:7'></a>
Merged in Sage 3.3.alpha0



---

archive/issue_comments_040795.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2009-01-12T02:17:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4945#issuecomment-40795",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

Resolution: fixed



---

archive/issue_events_011421.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-01-12T02:17:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4945",
    "milestone": "sage-3.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4945#event-11421"
}
```
