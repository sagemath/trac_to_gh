# Issue 4945: LaTeX for gp elements shouldn't use verbatim environment

archive/issues_004945.json:
```json
{
    "assignees": [],
    "body": "Gary wrote: \n \nWhen using the SAGE notebook with typeset on, the command \n\n``` \n  gp(2+2) \n``` \ngives the error `'Unknown environment \"verbatim\"'`. \n \nTyping \n\n``` \n  gp(2+2) \n``` \nin the SAGE command line works fine. I think it is a latex output \nerror. \n \nI can confirm this bug. It is caused by the generic latex method for Expect elements: \n \n\n``` \nsage: latex(gp(2+2)) \n\\begin{verbatim}4\\end{verbatim} \n``` \n \nwhich apparently doesn't play well with jsMath. \n \n`search_src(\"begin{verbatim}\")` returns 43 hits.\n\nAssignee: **@sagetrac-cwitty**\n\nKeywords: **jsmath**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/4945_\n\n",
    "closed_at": "2009-01-12T02:17:47Z",
    "created_at": "2009-01-06T16:56:57Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-3.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "LaTeX for gp elements shouldn't use verbatim environment",
    "type": "issue",
    "updated_at": "2009-01-12T02:17:47Z",
    "url": "https://github.com/sagemath/sage/issues/4945",
    "user": "https://github.com/malb"
}
```
Gary wrote: 
 
When using the SAGE notebook with typeset on, the command 

``` 
  gp(2+2) 
``` 
gives the error `'Unknown environment "verbatim"'`. 
 
Typing 

``` 
  gp(2+2) 
``` 
in the SAGE command line works fine. I think it is a latex output 
error. 
 
I can confirm this bug. It is caused by the generic latex method for Expect elements: 
 

``` 
sage: latex(gp(2+2)) 
\begin{verbatim}4\end{verbatim} 
``` 
 
which apparently doesn't play well with jsMath. 
 
`search_src("begin{verbatim}")` returns 43 hits.

Assignee: **@sagetrac-cwitty**

Keywords: **jsmath**

_Issue created by migration from https://trac.sagemath.org/ticket/4945_





---

archive/issue_events_051285.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-01-06T16:56:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/4945",
    "milestone_number": null,
    "milestone_title": "sage-3.4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4945#event-51285"
}
```



---

archive/issue_events_051286.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-01-06T16:56:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/4945",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4945#event-51286"
}
```



---

archive/issue_events_051287.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-01-06T16:56:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/4945",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4945#event-51287"
}
```



---

archive/issue_comments_031075.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\n| search_src(\"begin{verbatim}\") returns 43 hits\n\nMost of those are in docstrings, so we don't need to worry about them.  I think the only relevant instances are interfaces/expect.py, misc/latex.py, misc/log.py.  I don't understand how verbatim is used in the last two.  The attached patch seems to fix the problem in the first one: `latex(gp(2+2))` works in the notebook now.\n\n(The solution here is to change verbatim to verb -- search misc/all.py for 'verbatim' to see very similar code) and then to use the jsMath 'verb' extension.)",
    "created_at": "2009-01-06T18:53:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4945#issuecomment-31075",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:1" align="right">Comment 1</div>

| search_src("begin{verbatim}") returns 43 hits

Most of those are in docstrings, so we don't need to worry about them.  I think the only relevant instances are interfaces/expect.py, misc/latex.py, misc/log.py.  I don't understand how verbatim is used in the last two.  The attached patch seems to fix the problem in the first one: `latex(gp(2+2))` works in the notebook now.

(The solution here is to change verbatim to verb -- search misc/all.py for 'verbatim' to see very similar code) and then to use the jsMath 'verb' extension.)



---

archive/issue_events_051288.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-01-06T18:53:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/4945",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4945#event-51288"
}
```



---

archive/issue_comments_031076.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nThe extra \\require{verb} worries me, since it is included each time an element is LaTeXified. Shouldn't it be in some header?\n\nCheers,\nMartin",
    "created_at": "2009-01-06T20:00:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4945#issuecomment-31076",
    "user": "https://github.com/malb"
}
```

<div id="comment:2" align="right">Comment 2</div>

The extra \require{verb} worries me, since it is included each time an element is LaTeXified. Shouldn't it be in some header?

Cheers,
Martin



---

archive/issue_comments_031077.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nReplying to [@malb](#comment%3A2):\n> The extra \\require{verb} worries me, since it is included each time an element is LaTeXified. Shouldn't it be in some header?\n\nYes, maybe it should.  I couldn't figure out where, though.\n\n(For more on the jsMath verb extension, including different ways of loading it, see [this web page](http://www.math.union.edu/~dpvc/jsMath/authors/verb.html).)",
    "created_at": "2009-01-06T20:11:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4945#issuecomment-31077",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:3" align="right">Comment 3</div>

Replying to [@malb](#comment%3A2):
> The extra \require{verb} worries me, since it is included each time an element is LaTeXified. Shouldn't it be in some header?

Yes, maybe it should.  I couldn't figure out where, though.

(For more on the jsMath verb extension, including different ways of loading it, see [this web page](http://www.math.union.edu/~dpvc/jsMath/authors/verb.html).)



---

archive/issue_comments_031078.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nI just posted a slightly different version of the patch.  It doesn't address malb's issue, but it is a little cleaner: it only includes '\\require{verb}' if in notebook mode.",
    "created_at": "2009-01-06T20:54:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4945#issuecomment-31078",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:4" align="right">Comment 4</div>

I just posted a slightly different version of the patch.  It doesn't address malb's issue, but it is a little cleaner: it only includes '\require{verb}' if in notebook mode.



---

archive/issue_comments_031079.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nOkay, here's a patch which (I think) addresses malb's issue.",
    "created_at": "2009-01-07T00:10:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4945#issuecomment-31079",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:5" align="right">Comment 5</div>

Okay, here's a patch which (I think) addresses malb's issue.



---

archive/issue_comments_031080.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nAttachment: **[4945.patch.gz](https://github.com/sagemath/sage/files/ticket4945/4945.patch.gz)**\n\nPatch looks good.",
    "created_at": "2009-01-07T12:13:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4945#issuecomment-31080",
    "user": "https://github.com/malb"
}
```

<div id="comment:6" align="right">Comment 6</div>

Attachment: **[4945.patch.gz](https://github.com/sagemath/sage/files/ticket4945/4945.patch.gz)**

Patch looks good.



---

archive/issue_events_051289.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-01-07T12:13:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/4945",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4945#event-51289"
}
```



---

archive/issue_events_051290.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-01-07T12:13:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/4945",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4945#event-51290"
}
```



---

archive/issue_events_051291.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-01-12T02:17:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/4945",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4945#event-51291"
}
```



---

archive/issue_events_051292.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-01-12T02:17:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/4945",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4945#event-51292"
}
```



---

archive/issue_comments_031081.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nMerged in Sage 3.3.alpha0",
    "created_at": "2009-01-12T02:17:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/4945",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/4945#issuecomment-31081",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:7" align="right">Comment 7</div>

Merged in Sage 3.3.alpha0



---

archive/issue_events_051293.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-01-12T02:17:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/4945",
    "milestone_number": null,
    "milestone_title": "sage-3.4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4945#event-51293"
}
```



---

archive/issue_events_051294.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-01-12T02:17:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/4945",
    "milestone_number": null,
    "milestone_title": "sage-3.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/4945#event-51294"
}
```
