# Issue 18939: Make LiE a new-style spkg

Issue created by migration from Trac.

Original creator: tscrim

Original creation time: 2015-09-09 22:23:04

Assignee: tscrim

CC:  vbraun jdemeyer jhpalmieri

To help with the conversion of the build system.


---

Attachment

Renamed tarball of upstream


---

Comment by tscrim created at 2015-09-09 23:00:28

Changing status from new to needs_review.


---

Comment by tscrim created at 2015-09-09 23:00:28

New commits:


---

Comment by git created at 2015-09-09 23:01:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2015-09-10 12:23:49

This clearly should be removed:

```
## SPKG Maintainer

 * William Stein (?)
 * Michael Abshoff (?)
```


Similar to #19177, it's recommended to add a `dependencies` file.


---

Comment by git created at 2015-09-10 15:49:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-09-10 15:50:33

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by tscrim created at 2015-09-10 15:51:05

Whoops, don't know how `cc194fa` got in there.

Fixed.


---

Comment by jdemeyer created at 2015-09-10 21:09:22

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2015-09-10 21:09:22

Is the package called `lie` or `conlie`? You should be consistent...


---

Comment by jdemeyer created at 2015-09-10 21:10:43

Sorry, too fast.


---

Comment by jdemeyer created at 2015-09-10 21:10:43

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2015-09-10 21:16:36

The package is called `LiE`. The upstream tarball is the only thing that is called conlie AFAIK.


---

Comment by jdemeyer created at 2015-09-10 21:19:33

The package installs fine.


---

Comment by jdemeyer created at 2015-09-10 21:20:01

Replying to [comment:10 tscrim]:
> The package is called `LiE`. The upstream tarball is the only thing that is called conlie AFAIK.

Got it, it was just confusing with the links in the description.


---

Comment by jdemeyer created at 2015-09-11 06:13:06


```
sage -t --long src/sage/interfaces/lie.py
**********************************************************************
File "src/sage/interfaces/lie.py", line 573, in sage.interfaces.lie.LiE.version
Failed example:
    lie.version() # optional - lie
Exception raised:
    Traceback (most recent call last):
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.lie.LiE.version[0]>", line 1, in <module>
        lie.version() # optional - lie
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/interfaces/lie.py", line 576, in version
        return lie_version()
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/interfaces/lie.py", line 932, in lie_version
        f = open(SAGE_LOCAL + 'lib/LiE/INFO.0')
    IOError: [Errno 2] No such file or directory: '/usr/local/src/sage-config/locallib/LiE/INFO.0'
**********************************************************************
File "src/sage/interfaces/lie.py", line 929, in sage.interfaces.lie.lie_version
Failed example:
    lie_version() # optional - lie
Exception raised:
    Traceback (most recent call last):
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.lie.lie_version[1]>", line 1, in <module>
        lie_version() # optional - lie
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/interfaces/lie.py", line 932, in lie_version
        f = open(SAGE_LOCAL + 'lib/LiE/INFO.0')
    IOError: [Errno 2] No such file or directory: '/usr/local/src/sage-config/locallib/LiE/INFO.0'
**********************************************************************
```



---

Comment by jdemeyer created at 2015-09-11 06:13:06

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2015-09-11 06:15:25

A non-reproducible failure:

```
sage -t --long src/sage/interfaces/lie.py
**********************************************************************
File "src/sage/interfaces/lie.py", line 515, in sage.interfaces.lie.LiE.trait_names
Failed example:
    lie.trait_names() # optional - lie
Expected:
    ['Cartan_type',
     'cent_roots',
     ...
     'n_comp']
Got:
    ['history',
     'version',
[...snip...]
```

Sorting the list should solve this.


---

Comment by git created at 2015-09-11 17:45:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-09-11 17:47:32

Apparently `SAGE_LOCAL` previously had a trailing `/`, or this file was never really tested. Anyways, I added the `/` to the rest of the filepath. I also fixed the output of the one random failure.


---

Comment by tscrim created at 2015-09-11 17:47:32

Changing status from needs_work to needs_review.


---

Comment by jhpalmieri created at 2015-09-11 18:09:29

It would probably be better to use `os.path.join`.


---

Comment by git created at 2015-09-11 18:14:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2015-09-11 18:18:52

Also, I suggest to make `lie.trait_names()` itself sorted, instead of sorting in the doctest.


---

Comment by jdemeyer created at 2015-09-11 18:18:52

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2015-09-11 18:19:31

If you use `os.path.join`, it should be better be used as

```
os.path.join(SAGE_LOCAL, 'lib', 'LiE', 'INFO.0')
```



---

Comment by git created at 2015-09-11 18:33:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-09-11 18:33:54

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2015-09-11 20:02:18

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2015-09-11 20:02:18

Despite the claim that the package has no dependencies, it seems to depend at least on `readline` and `ncurses`:

```
gcc -o Lie.exe lexer.o parser.o non-ANSI.o bigint.o binmat.o creatop.o gettype.o getvalue.o init.o learn.o main.o mem.o node.o onoff.o output.o poly.o sym.o print.o get
l.o date.o static/*.o box/*.o -lreadline -lncurses
```



---

Comment by tscrim created at 2015-09-11 21:15:16

It also depends on `bison`, but that can be a system-wide installation (instead of the experimental spkg).

So what should I do at this point, just put `readline` and `ncurses` (and `bison`) in the dependency part of the `SPKG.txt` or do I need to add things to the `dependencies` file?


---

Comment by jdemeyer created at 2015-09-11 21:30:34

Replying to [comment:24 tscrim]:
> So what should I do at this point, just put `readline` and `ncurses` (and `bison`) in the dependency part of the `SPKG.txt` or do I need to add things to the `dependencies` file?

Both please.

The package installs and doctests pass, so for the rest it's good for me.


---

Comment by git created at 2015-09-11 23:19:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-09-11 23:19:53

Done. Thanks for walking me though things.


---

Comment by tscrim created at 2015-09-11 23:19:53

Changing status from needs_work to needs_review.


---

Comment by git created at 2015-09-11 23:21:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2015-09-13 08:38:39

Dependencies look good. I will do one final check with `make distclean`.


---

Comment by jdemeyer created at 2015-09-13 10:55:39

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2015-09-13 12:53:18

Thanks again.


---

Comment by vbraun created at 2015-09-14 19:01:10

Resolution: fixed


---

Comment by jdemeyer created at 2015-09-18 08:50:47

Breakage: #19239
