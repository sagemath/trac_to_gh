# Issue 29998: Add construction methods to FiniteRankFreeModule and CombinatorialFreeModule

archive/issues_029998.json:
```json
{
    "body": "CC:  @tscrim @egourgoulhon @fchapoton @nthiery\n\n(follow-up from #30194)\n\nIssue created by migration from https://trac.sagemath.org/ticket/30235\n\n",
    "created_at": "2020-07-28T04:04:26Z",
    "labels": [
        "component: linear algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "Add construction methods to FiniteRankFreeModule and CombinatorialFreeModule",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29998",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @tscrim @egourgoulhon @fchapoton @nthiery

(follow-up from #30194)

Issue created by migration from https://trac.sagemath.org/ticket/30235





---

archive/issue_comments_425774.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-07-28T04:05:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425774",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_events_078141.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-13T17:11:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29998#event-78141"
}
```



---

archive/issue_events_078142.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29998#event-78142"
}
```



---

archive/issue_events_078143.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29998#event-78143"
}
```



---

archive/issue_comments_425775.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425775",
    "user": "https://github.com/mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_078144.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29998#event-78144"
}
```



---

archive/issue_events_078145.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29998#event-78145"
}
```



---

archive/issue_events_078146.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29998#event-78146"
}
```



---

archive/issue_events_078147.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29998#event-78147"
}
```



---

archive/issue_events_078148.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-01T21:16:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29998#event-78148"
}
```



---

archive/issue_events_078149.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-01T21:16:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29998#event-78149"
}
```



---

archive/issue_comments_425776.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-08-21T23:41:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425776",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_comments_425777.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-21T23:52:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425777",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425778.json:
```json
{
    "body": "We will need to be really careful with this because lots of classes are subclasses of `CFM`, where the result of `construction()` will become wrong if we do the generic one.\n\nHowever, I am generally +1 on doing this. There is a ticket out there on implementing extension of scalars, and this would be a step towards doing that generically by being able to implement pushouts.",
    "created_at": "2022-08-22T00:08:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425778",
    "user": "https://github.com/tscrim"
}
```

We will need to be really careful with this because lots of classes are subclasses of `CFM`, where the result of `construction()` will become wrong if we do the generic one.

However, I am generally +1 on doing this. There is a ticket out there on implementing extension of scalars, and this would be a step towards doing that generically by being able to implement pushouts.



---

archive/issue_comments_425779.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-22T02:11:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425779",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425780.json:
```json
{
    "body": "Replying to [comment:13 tscrim]:\n> We will need to be really careful with this because lots of classes are subclasses of `CFM`, where the result of `construction()` will become wrong if we do the generic one.\n\nYes, I see a few dozen testsuite failures (`_test_construction`) in `sage.combinat` now.\n\n> However, I am generally +1 on doing this. There is a ticket out there on implementing extension of scalars, and this would be a step towards doing that generically by being able to implement pushouts.\n\nYes",
    "created_at": "2022-08-22T02:12:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425780",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:13 tscrim]:
> We will need to be really careful with this because lots of classes are subclasses of `CFM`, where the result of `construction()` will become wrong if we do the generic one.

Yes, I see a few dozen testsuite failures (`_test_construction`) in `sage.combinat` now.

> However, I am generally +1 on doing this. There is a ticket out there on implementing extension of scalars, and this would be a step towards doing that generically by being able to implement pushouts.

Yes



---

archive/issue_comments_425781.json:
```json
{
    "body": "Help on these subclasses in `sage.combinat` is very welcome.\n\nOtherwise I'd just add a lot of `def construction(self): return None`",
    "created_at": "2022-08-22T02:26:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425781",
    "user": "https://github.com/mkoeppe"
}
```

Help on these subclasses in `sage.combinat` is very welcome.

Otherwise I'd just add a lot of `def construction(self): return None`



---

archive/issue_comments_425782.json:
```json
{
    "body": "There are also a number of them in `sage.algebra` as well. In most cases, the \"correct\" thing to do would be to have their own `ConstructionFunctor`. Although we probably would remove a lot of redundant code if we have some generic subclass, say `VectorSpaceWithBaseRing` from commutative rings that takes a class and arbitrary inputs/keywords except the base ring. It would have a generic merging that would require all of the inputs/keywords to be equal. It might also be possible to pull the key to `UniqueRepresentation` as these additional structures as a generic implementation in `CFM`.",
    "created_at": "2022-08-22T02:40:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425782",
    "user": "https://github.com/tscrim"
}
```

There are also a number of them in `sage.algebra` as well. In most cases, the "correct" thing to do would be to have their own `ConstructionFunctor`. Although we probably would remove a lot of redundant code if we have some generic subclass, say `VectorSpaceWithBaseRing` from commutative rings that takes a class and arbitrary inputs/keywords except the base ring. It would have a generic merging that would require all of the inputs/keywords to be equal. It might also be possible to pull the key to `UniqueRepresentation` as these additional structures as a generic implementation in `CFM`.



---

archive/issue_comments_425783.json:
```json
{
    "body": "For a start, I guess we can just give the `None` construction to all filtered modules",
    "created_at": "2022-08-22T02:50:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425783",
    "user": "https://github.com/mkoeppe"
}
```

For a start, I guess we can just give the `None` construction to all filtered modules



---

archive/issue_comments_425784.json:
```json
{
    "body": "True, it makes the situation no worse than before.",
    "created_at": "2022-08-22T02:56:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425784",
    "user": "https://github.com/tscrim"
}
```

True, it makes the situation no worse than before.



---

archive/issue_comments_425785.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-22T02:57:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425785",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425786.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-22T03:46:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425786",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425787.json:
```json
{
    "body": "Probably safer to just disable the `construction` for all subclasses",
    "created_at": "2022-08-22T04:08:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425787",
    "user": "https://github.com/mkoeppe"
}
```

Probably safer to just disable the `construction` for all subclasses



---

archive/issue_comments_425788.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-22T04:44:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425788",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425789.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-08-22T04:47:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425789",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_425790.json:
```json
{
    "body": "Replying to [comment:17 tscrim]:\n> It might also be possible to pull the key to `UniqueRepresentation` as these additional structures as a generic implementation in `CFM`.\n\nYes, I think a solution based on `UniqueRepresentation` could be a good idea.",
    "created_at": "2022-08-22T04:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425790",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:17 tscrim]:
> It might also be possible to pull the key to `UniqueRepresentation` as these additional structures as a generic implementation in `CFM`.

Yes, I think a solution based on `UniqueRepresentation` could be a good idea.



---

archive/issue_comments_425791.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-22T04:51:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425791",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425792.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-22T04:54:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425792",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425793.json:
```json
{
    "body": "\n```\nsage -t --random-seed=211950378039065916298685714207807222444 doc/en/thematic_tutorials/tutorial-implementing-algebraic-structures.rst  # 1 doctest failed\nsage -t --random-seed=211950378039065916298685714207807222444 doc/en/thematic_tutorials/tutorial-objects-and-classes.rst  # 1 doctest failed\nsage -t --random-seed=211950378039065916298685714207807222444 sage/combinat/free_module.py  # 1 doctest failed\nsage -t --random-seed=211950378039065916298685714207807222444 sage/modules/with_basis/indexed_element.pyx  # 1 doctest failed\n```\n",
    "created_at": "2022-08-22T16:25:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425793",
    "user": "https://github.com/mkoeppe"
}
```


```
sage -t --random-seed=211950378039065916298685714207807222444 doc/en/thematic_tutorials/tutorial-implementing-algebraic-structures.rst  # 1 doctest failed
sage -t --random-seed=211950378039065916298685714207807222444 doc/en/thematic_tutorials/tutorial-objects-and-classes.rst  # 1 doctest failed
sage -t --random-seed=211950378039065916298685714207807222444 sage/combinat/free_module.py  # 1 doctest failed
sage -t --random-seed=211950378039065916298685714207807222444 sage/modules/with_basis/indexed_element.pyx  # 1 doctest failed
```




---

archive/issue_comments_425794.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-22T17:18:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425794",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425795.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-22T17:35:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425795",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425796.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-22T17:56:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425796",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425797.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-22T18:05:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425797",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425798.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-22T19:02:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425798",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425799.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-22T19:08:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425799",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425800.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-22T19:12:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425800",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425801.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-08-22T19:13:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425801",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_425802.json:
```json
{
    "body": "\n```\nsage -t --random-seed=116536317366563428683146425021076892502 src/sage/manifolds/vector_bundle_fiber.py  # 1 doctest failed\nsage -t --random-seed=116536317366563428683146425021076892502 src/sage/manifolds/differentiable/tangent_space.py  # 1 doctest failed\n```\n",
    "created_at": "2022-08-22T20:26:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425802",
    "user": "https://github.com/mkoeppe"
}
```


```
sage -t --random-seed=116536317366563428683146425021076892502 src/sage/manifolds/vector_bundle_fiber.py  # 1 doctest failed
sage -t --random-seed=116536317366563428683146425021076892502 src/sage/manifolds/differentiable/tangent_space.py  # 1 doctest failed
```




---

archive/issue_comments_425803.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-22T20:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425803",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425804.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-22T22:25:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425804",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425805.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-23T05:17:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425805",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425806.json:
```json
{
    "body": "Tests pass, the pyright crash is unrelated; needs review",
    "created_at": "2022-08-23T15:37:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425806",
    "user": "https://github.com/mkoeppe"
}
```

Tests pass, the pyright crash is unrelated; needs review



---

archive/issue_comments_425807.json:
```json
{
    "body": "While the subclass for the construction version is the proper way to do it, I am not sure how much of a hassle it will create long-term once we have a more general way to do constructions for things that subclass CFM. The hack way would be\n\n```python\ndef construction(self):\n    if self.__class__.__mro__[1] == CombinatorialFreeModule:\n         return VectorFunctor(...)\n    return super().construction()\n```\n\n(We cannot to `type(self) == CFM` because of the dynamic class created from the category. There is a function or method to get this more robustly, but I don't remember offhand.) I am fairly convinced that your proposal is how we should go, but I just have this little nagging doubt.\n\nOne thing that does need to be changed is that we will have two `CFM` classes with (almost) identical (public) documentations. This is easy to fix by adding a class-level doc to the new class explaining the difference.",
    "created_at": "2022-08-24T03:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425807",
    "user": "https://github.com/tscrim"
}
```

While the subclass for the construction version is the proper way to do it, I am not sure how much of a hassle it will create long-term once we have a more general way to do constructions for things that subclass CFM. The hack way would be

```python
def construction(self):
    if self.__class__.__mro__[1] == CombinatorialFreeModule:
         return VectorFunctor(...)
    return super().construction()
```

(We cannot to `type(self) == CFM` because of the dynamic class created from the category. There is a function or method to get this more robustly, but I don't remember offhand.) I am fairly convinced that your proposal is how we should go, but I just have this little nagging doubt.

One thing that does need to be changed is that we will have two `CFM` classes with (almost) identical (public) documentations. This is easy to fix by adding a class-level doc to the new class explaining the difference.



---

archive/issue_comments_425808.json:
```json
{
    "body": "Another hackish way would be to assign `self.construction` in a `__classcall_private__` method.",
    "created_at": "2022-08-24T03:13:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425808",
    "user": "https://github.com/mkoeppe"
}
```

Another hackish way would be to assign `self.construction` in a `__classcall_private__` method.



---

archive/issue_comments_425809.json:
```json
{
    "body": "Replying to [comment:47 mkoeppe]:\n> Another hackish way would be to assign `self.construction` in a `__classcall_private__` method.\n\nIndeed, although I think that is even more of a hack since it is doing stuff non-locally (to the method).",
    "created_at": "2022-08-24T03:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425809",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:47 mkoeppe]:
> Another hackish way would be to assign `self.construction` in a `__classcall_private__` method.

Indeed, although I think that is even more of a hack since it is doing stuff non-locally (to the method).



---

archive/issue_comments_425810.json:
```json
{
    "body": "I don't have an objection to using `self.__class__.__base__` or something like this like you suggested. It's probably less confusing than the renaming reimport",
    "created_at": "2022-08-24T03:38:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425810",
    "user": "https://github.com/mkoeppe"
}
```

I don't have an objection to using `self.__class__.__base__` or something like this like you suggested. It's probably less confusing than the renaming reimport



---

archive/issue_comments_425811.json:
```json
{
    "body": "I'm making this change now.",
    "created_at": "2022-08-24T04:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425811",
    "user": "https://github.com/mkoeppe"
}
```

I'm making this change now.



---

archive/issue_comments_425812.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-24T04:27:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425812",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425813.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-24T05:05:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425813",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425814.json:
```json
{
    "body": "I think this is acceptable. \u00c9ric, do you have any comments?",
    "created_at": "2022-08-25T02:43:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425814",
    "user": "https://github.com/tscrim"
}
```

I think this is acceptable. Éric, do you have any comments?



---

archive/issue_comments_425815.json:
```json
{
    "body": "Replying to [comment:53 tscrim]:\n> I think this is acceptable. \u00c9ric, do you have any comments?\n\nNo, I don't. This is mostly beyond my knowledge, but thanks for asking ;-)",
    "created_at": "2022-08-26T21:57:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425815",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:53 tscrim]:
> I think this is acceptable. Éric, do you have any comments?

No, I don't. This is mostly beyond my knowledge, but thanks for asking ;-)



---

archive/issue_comments_425816.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-08-27T01:22:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425816",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_425817.json:
```json
{
    "body": "Then let it be so.",
    "created_at": "2022-08-27T01:22:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425817",
    "user": "https://github.com/tscrim"
}
```

Then let it be so.



---

archive/issue_comments_425818.json:
```json
{
    "body": "Thanks!",
    "created_at": "2022-08-27T01:25:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425818",
    "user": "https://github.com/mkoeppe"
}
```

Thanks!



---

archive/issue_events_078150.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-08-29T11:24:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29998#event-78150"
}
```



---

archive/issue_comments_425819.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-08-29T11:24:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29998",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29998#issuecomment-425819",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
