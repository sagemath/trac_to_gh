# Issue 15097: Evaluation of Jacobi elliptic functions for non-real arguments depends on previously computed values

Issue created by migration from https://trac.sagemath.org/ticket/15334

Original creator: davidamadore

Original creation time: 2013-10-27 18:05:50

CC:  jakobkroeker vklein

Keywords: special function elliptic integral jacobi

The following example shows that numerically evaluating sn(I,1/2) first fails ("cannot evaluate symbolic expression numerically") and then succeeds once the value sc(1,1/2) has been computed:


```
sage: N(jacobi("sn", I, 1/2))
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-1-e0000742d9d6> in <module>()
----> 1 N(jacobi("sn", I, Integer(1)/Integer(2)))

/usr/src/local/sage-5.12/local/lib/python2.7/site-packages/sage/misc/functional.pyc in numerical_approx(x, prec, digits)
   1395             prec = int((digits+1) * LOG_TEN_TWO_PLUS_EPSILON) + 1
   1396     try:
-> 1397         return x._numerical_approx(prec)
   1398     except AttributeError:
   1399         from sage.rings.complex_double import is_ComplexDoubleElement

/usr/src/local/sage-5.12/local/lib/python2.7/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression._numerical_approx (sage/symbolic/expression.cpp:22615)()

TypeError: cannot evaluate symbolic expression numerically
sage: N(jacobi("sc", 1, 1/2))
1.34737147138542
sage: N(jacobi("sn", I, 1/2))
1.34737147138542*I
```


(in fact, evaluating sc with any arguments whatsoever seems to make the sn function work afterward).


---

Comment by jakobkroeker created at 2017-02-26 00:58:54

seems fixed meanwhile, needs a test?


---

Comment by chapoton created at 2019-06-22 18:28:57

Changing status from new to needs_review.


---

Comment by chapoton created at 2019-06-22 18:28:57

here is a doctest
----
New commits:


---

Comment by chapoton created at 2019-06-25 11:20:34

green bot, please review, easy one


---

Comment by vklein created at 2019-06-25 13:44:28

Looks good to me.


---

Comment by vklein created at 2019-06-25 13:44:28

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2019-06-26 12:32:51

merci Vincent


---

Comment by vbraun created at 2019-06-27 20:13:53

Resolution: fixed
