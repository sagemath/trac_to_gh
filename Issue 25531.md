# Issue 25531: py3: fix auxiliary graph in link.py

Issue created by migration from https://trac.sagemath.org/ticket/25768

Original creator: chapoton

Original creation time: 2018-07-04 11:43:50

CC:  tscrim embray jdemeyer

So that it can work in python3.

This currently means that all vertices should be comparable, so we turn integer vertices to tuples of length 1.


---

Comment by chapoton created at 2018-07-04 11:44:14

New commits:


---

Comment by chapoton created at 2018-07-04 11:44:14

Changing status from new to needs_review.


---

Comment by tscrim created at 2018-07-09 14:09:15

That is a clever workaround, but I am not sure we should/need to do this. We do want to remove the forced sorting on graphs, which is generic problem. So I am a little hesitant to make the code more complicated for this reason.


---

Comment by chapoton created at 2018-07-09 16:17:34

indeed. The issue here will probably be fixed (in a smarter way) in #25769


---

Comment by embray created at 2018-07-10 10:48:42

I don't get it.  Why `len(x) == 3`?


---

Comment by embray created at 2018-07-10 10:52:33

The Python 3 version of the `pprint` module sorts objects safely e.g. like how it sorts dicts: https://github.com/python/cpython/blob/3.7/Lib/pprint.py#L180 by using a [_safe_key](https://github.com/python/cpython/blob/3.7/Lib/pprint.py#L72) class which basically wraps objects in such a way that restores Python 2-style comparison.

What we really need is a version of this in Sage.  It's too bad the one in Python is just an internal implementation detail in a relatively obscure module.  But it's easy enough to replicate.  We can also provide a `safe_sorted` which ensures each sort key is automatically wrapped.


---

Comment by jdemeyer created at 2018-07-10 11:55:36

Replying to [ticket:25768 chapoton]:
> This currently means that all vertices should be comparable, so we turn integer vertices to tuples of length 1.

??? That's not a real solution.


---

Comment by jdemeyer created at 2018-07-10 11:55:36

Changing status from needs_review to needs_info.


---

Comment by chapoton created at 2018-07-10 11:59:57

The real solution is already done in #25769


---

Comment by embray created at 2018-07-10 12:22:49

I don't think that's a "real solution" either (although I do believe it's a useful feature).


---

Comment by vdelecroix created at 2018-08-03 19:18:42

milestone update 8.3 -> 8.4


---

Comment by chapoton created at 2018-08-11 08:23:59

Changing status from needs_info to needs_review.


---

Comment by chapoton created at 2018-08-11 08:23:59

Here is a new proposal.
----
New commits:


---

Comment by tscrim created at 2018-08-11 08:57:37

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2018-08-11 08:57:37

LGTM. Thanks.


---

Comment by vbraun created at 2018-08-17 21:14:15

Resolution: fixed
