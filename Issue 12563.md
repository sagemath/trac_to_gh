# Issue 12563: optional magma doctest fails on sage-5.0.beta9

Issue created by migration from Trac.

Original creator: mariah

Original creation time: 2012-03-23 13:21:40

Assignee: was

CC:  robertwb mhansen was

The following optional magma doctest fails on sage-5.0.bata9 using
magma-2.18-4.


```
eno% ./sage -t -only-optional=magma "devel/sage/sage/symbolic/integration/integral.py"
sage -t -only-optional=magma "devel/sage/sage/symbolic/integration/integral.py"
Traceback (most recent call last):
  File "/home/mariah/sage/sage-5.0.beta9-x86_64-Linux-core2-fc/local/bin/sage-doctest", line 924, in <module>
    test_file(argv[1], library_code = library_code)
  File "/home/mariah/sage/sage-5.0.beta9-x86_64-Linux-core2-fc/local/bin/sage-doctest", line 721, in test_file
    s = extract_doc(file, library_code=library_code)
  File "/home/mariah/sage/sage-5.0.beta9-x86_64-Linux-core2-fc/local/bin/sage-doctest", line 551, in extract_doc
    doc = doc_preparse(F[i:j+3])
  File "/home/mariah/sage/sage-5.0.beta9-x86_64-Linux-core2-fc/local/bin/sage-doctest", line 370, in doc_preparse
    v = [i for i in range(len(t)) if only_optional_include(comment_modifiers[i])]
IndexError: list index out of range
         [0.2 s]
 
----------------------------------------------------------------------
The following tests failed:


        sage -t -only-optional=magma "devel/sage/sage/symbolic/integration/integral.py" # File not found
```



---

Comment by mhansen created at 2012-05-25 06:31:04

Is this reproducible?  It seems like more of a problem with `sage-doctest` than anything specific to Magma.


---

Comment by mhansen created at 2012-05-25 06:31:15

Changing keywords from "" to "sd40.5".


---

Comment by was created at 2012-05-25 17:15:25

Changing assignee from was to mvngu.


---

Comment by was created at 2012-05-25 17:15:25

Changing component from interfaces to doctest.


---

Comment by was created at 2012-05-25 17:15:25

mhansen -- you are right -- this has nothing to do with Magma, a priori.   I'll change the title of the ticket.    It's a bug in the doctest framework, but I don't yet know how to trigger it.  I just looked through the relevant code in sage-doctest, and it's a mix of code I wrote and then later Robert Bradshaw extended with a "tolerance" ability.  My code assumes that the lists t and comment_modifiers have the same length, but I think Robert's doesn't and in some cases adds things to t but not comment_modifiers.


---

Comment by was created at 2012-05-25 18:32:38

This has been fixed in sage-5.0 already as #12493.   I'm closing this as a dup.


---

Comment by was created at 2012-05-25 18:32:38

Resolution: duplicate


---

Comment by was created at 2012-05-26 02:23:01

Resolution changed from duplicate to 


---

Comment by was created at 2012-05-26 02:23:01

Changing status from closed to new.


---

Comment by was created at 2012-05-26 02:23:13

Changing status from new to needs_review.


---

Comment by was created at 2012-05-26 02:23:20

Changing status from needs_review to positive_review.


---

Comment by was created at 2012-05-26 02:23:42

This should be closed as a dup.


---

Comment by jdemeyer created at 2012-06-02 13:23:42

Resolution: duplicate
