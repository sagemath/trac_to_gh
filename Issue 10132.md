# Issue 10132: Make sure log(1) returns an Integer, not an int

Issue created by migration from Trac.

Original creator: kcrisman

Original creation time: 2010-10-15 19:19:44

Assignee: burcin

CC:  eviatarbach

From [this thread](http://groups.google.com/group/sage-devel/browse_thread/thread/cceabb7271022b1c/944c94af910269a0):

```
> > sage: type(log(1))
> > <type 'int'>
> > sage: log(1).n()
> > ---------------------------------------------------------------------------
> > AttributeError: 'int' object has no attribute 'n'
> > sage: Integer(log(1)).n()
> > 0.000000000000000
> > sage: a = Integer(1)
> > sage: a.log()
> > 0
> > sage: type(a.log())
> > <type 'int'>
> > sage: from sage.functions.log import function_log
> > sage: function_log(Integer(1))
> > 0
> > sage: type(function_log(Integer(1)))
> > <type 'int'>
> 
> > Is there any way to get around this in the code, or are we pretty much
> > stuck with this because of how GinacFunctions work? Â I'm not 100% sure
> > this is a bug in log; maybe instead we should extend int so that
> 
> This is a bug in the log() function, and any other function which
> returns exact values like 0 or 1. We already work around most cases,
> see lines 720-722 and 736-761 of sage/symbolic/function.pyx.
> 
> The correct fix is to change the corresponding pynac functions to
> coerce the exact value to the parent of the argument before returning
> it. For example, all the lines "return _ex1;" or "return _ex0;" in
> 
> http://pynac.sagemath.org/hg/file/b233d9dadcfa/ginac/inifcns_trans.cpp
> 
> has to be changed this way.
> 

Yup, I see what you are talking about - e.g. 

		if (x.is_equal(_ex1))  // log(1) -> 0
			return _ex0;

Although it might be nice to stay relatively close to Ginac and fix such things on the Sage level if that's not really bad.
```

This ticket's goal is to implement one of these solutions (that is, catch this in function.pyx or in Pynac).


---

Comment by kcrisman created at 2011-06-01 03:26:12

#10972 was closed as a duplicate. Ironic that I reported both, though in my defense, that ticket does list a few specific functions beyond log for which that happens, and it was 8 months ago :)


---

Comment by dsm created at 2012-02-13 07:38:41

ping.  I just noticed this in a different context.


---

Comment by kcrisman created at 2012-10-21 01:42:15

See also [this sage-devel thread](https://groups.google.com/forum/#!msg/sage-devel/lVCZTy0DljY/aGmQ1csQr4kJ).


---

Comment by kcrisman created at 2012-10-31 12:14:48

See also [this sage-devel thread](https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/apTU2ZdBZVw), where it seems that the consensus is that such things should give Sage `Integer`s, though at #10972 Burcin seems to suggest that symbolic expressions are appropriate.


---

Comment by kcrisman created at 2012-10-31 12:14:48

Changing keywords from "" to "type coercion symbolic".


---

Comment by jdemeyer created at 2014-11-26 17:16:20

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2014-11-26 17:16:20

New commits:


---

Comment by rws created at 2014-12-05 16:50:00

Looks good and passes `make ptestlong`.


---

Comment by rws created at 2014-12-05 16:50:00

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-12-12 12:29:54

Resolution: fixed


---

Comment by rws created at 2015-08-29 14:33:45

Actually this should have been fixed in Pynac. Now, accidentally the recent patches dealing with https://github.com/pynac/pynac/issues/7 automatically produce this behaviour. Which will be Pynac-0.4.4. The wrapper from this ticket should then be removed.
