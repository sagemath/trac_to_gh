# Issue 24939: Singular hnexpansion() output in different ring than input

Issue created by migration from Trac.

Original creator: @BrentBaccala

Original creation time: 2018-04-16 03:20:46

CC:  slelievre

Keywords: Singular NumberField

Singular's hnexpansion() function computes Hamburger-Noether expansions of a polynomial, but if the polynomial is over a NumberField, and the variable used in the NumberField's minimal polynomial doesn't match its generator, then they don't return results in the same ring.


```
sage: R.<b> = QQ[]
sage: S = NumberField(b^7 - 18, 'a')

sage: R.<x,y> = S[]
sage: f = x + y

sage: singular.lib('hnoether.lib')
sage: hne = f._singular_().hnexpansion().sage()

sage: hne[0][0].base_ring()
Multivariate Polynomial Ring in x, y over Number Field in a with defining polynomial a^7 - 18

sage: f.parent()
Multivariate Polynomial Ring in x, y over Number Field in a with defining polynomial b^7 - 18

sage: hne[0][0].base_ring() is f.parent()
False

```


Changing the 'b' to an 'a' during the creation of the NumberField will cause the results to come back in the same ring.

The results should always come back in the same ring used to define the polynomial, right?


---

Comment by slelievre created at 2018-04-17 08:50:23

Changing keywords from "Singular NumberField" to "Singular, NumberField".
