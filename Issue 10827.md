# Issue 10827: is_chordal can raise TypeError

archive/issues_010827.json:
```json
{
    "body": "Assignee: jason, ncohen, rlm\n\nCC:  @gvol brunellus @jasongrout\n\nis_chordal often -- but not always -- raises a TypeError on disconnected graphs (and the one-vertex graph) in 4.6.2: \n\n\n```\nsage: G = Graph()\nsage: G.is_chordal()\nTrue\nsage: G = Graph(1)\nsage: G.is_chordal()\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n\n/Users/mcneil/Desktop/<ipython console> in <module>()\n\n/Applications/sage/local/lib/python2.6/site-packages/sage/graphs/generic_graph.pyc in is_chordal(self, certificate)\n   9480         for v in peo:\n   9481 \n-> 9482             if t_peo.out_degree(v)>0 and g.neighbors(v) not in neighbors_subsets[t_peo.neighbor_out_iterator(v).next()]:\n   9483 \n   9484                 if certificate:\n\n/Applications/sage/local/lib/python2.6/site-packages/sage/graphs/digraph.pyc in out_degree(self, vertices, labels)\n   1147             return di\n   1148         else:\n-> 1149             return list(self.out_degree_iterator(vertices, labels=labels))\n   1150 \n   1151     def out_degree_iterator(self, vertices=None, labels=False):\n\n/Applications/sage/local/lib/python2.6/site-packages/sage/graphs/digraph.pyc in out_degree_iterator(self, vertices, labels)\n   1192                 yield (v, d)\n   1193         else:\n-> 1194             for v in vertices:\n   1195                 d = 0\n   1196                 for e in self.outgoing_edge_iterator(v):\n\nTypeError: 'int' object is not iterable\n```\n\n\n\n```\ndef crash(g):\n    try:\n        g.is_chordal(); return False\n    except TypeError:\n        return True\n\nfrom collections import defaultdict\nfor n in [0..7]:\n    gcount = 0\n    res = defaultdict(int)\n    for g in graphs(n):\n        gcount += 1 \n        cr = crash(g)\n        res[(cr, g.is_connected())] += 1\n    print n, 'total graphs:', gcount, \n    for k in sorted(res):\n        print '(crashed: %s, connected: %s) = %d' % (k[0], k[1], res[k]),\n    print\n\n0 total graphs: 1 (crashed: False, connected: True) = 1\n1 total graphs: 1 (crashed: True, connected: True) = 1\n2 total graphs: 2 (crashed: False, connected: True) = 1 (crashed: True, connected: False) = 1\n3 total graphs: 4 (crashed: False, connected: True) = 2 (crashed: True, connected: False) = 2\n4 total graphs: 11 (crashed: False, connected: False) = 1 (crashed: False, connected: True) = 6 (crashed: True, connected: False) = 4\n5 total graphs: 34 (crashed: False, connected: False) = 3 (crashed: False, connected: True) = 21 (crashed: True, connected: False) = 10\n6 total graphs: 156 (crashed: False, connected: False) = 17 (crashed: False, connected: True) = 112 (crashed: True, connected: False) = 27\n7 total graphs: 1044 (crashed: False, connected: False) = 97 (crashed: False, connected: True) = 853 (crashed: True, connected: False) = 94\n\n```\n\n\nSee trac #8284.  The above also causes problems for is_interval, which at one point tries \"if not self.is_chordal()\".\n\nIssue created by migration from https://trac.sagemath.org/ticket/10899\n\n",
    "created_at": "2011-03-10T03:34:57Z",
    "labels": [
        "component: graph theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "is_chordal can raise TypeError",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10827",
    "user": "https://trac.sagemath.org/admin/accounts/users/dsm"
}
```
Assignee: jason, ncohen, rlm

CC:  @gvol brunellus @jasongrout

is_chordal often -- but not always -- raises a TypeError on disconnected graphs (and the one-vertex graph) in 4.6.2: 


```
sage: G = Graph()
sage: G.is_chordal()
True
sage: G = Graph(1)
sage: G.is_chordal()
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/Users/mcneil/Desktop/<ipython console> in <module>()

/Applications/sage/local/lib/python2.6/site-packages/sage/graphs/generic_graph.pyc in is_chordal(self, certificate)
   9480         for v in peo:
   9481 
-> 9482             if t_peo.out_degree(v)>0 and g.neighbors(v) not in neighbors_subsets[t_peo.neighbor_out_iterator(v).next()]:
   9483 
   9484                 if certificate:

/Applications/sage/local/lib/python2.6/site-packages/sage/graphs/digraph.pyc in out_degree(self, vertices, labels)
   1147             return di
   1148         else:
-> 1149             return list(self.out_degree_iterator(vertices, labels=labels))
   1150 
   1151     def out_degree_iterator(self, vertices=None, labels=False):

/Applications/sage/local/lib/python2.6/site-packages/sage/graphs/digraph.pyc in out_degree_iterator(self, vertices, labels)
   1192                 yield (v, d)
   1193         else:
-> 1194             for v in vertices:
   1195                 d = 0
   1196                 for e in self.outgoing_edge_iterator(v):

TypeError: 'int' object is not iterable
```



```
def crash(g):
    try:
        g.is_chordal(); return False
    except TypeError:
        return True

from collections import defaultdict
for n in [0..7]:
    gcount = 0
    res = defaultdict(int)
    for g in graphs(n):
        gcount += 1 
        cr = crash(g)
        res[(cr, g.is_connected())] += 1
    print n, 'total graphs:', gcount, 
    for k in sorted(res):
        print '(crashed: %s, connected: %s) = %d' % (k[0], k[1], res[k]),
    print

0 total graphs: 1 (crashed: False, connected: True) = 1
1 total graphs: 1 (crashed: True, connected: True) = 1
2 total graphs: 2 (crashed: False, connected: True) = 1 (crashed: True, connected: False) = 1
3 total graphs: 4 (crashed: False, connected: True) = 2 (crashed: True, connected: False) = 2
4 total graphs: 11 (crashed: False, connected: False) = 1 (crashed: False, connected: True) = 6 (crashed: True, connected: False) = 4
5 total graphs: 34 (crashed: False, connected: False) = 3 (crashed: False, connected: True) = 21 (crashed: True, connected: False) = 10
6 total graphs: 156 (crashed: False, connected: False) = 17 (crashed: False, connected: True) = 112 (crashed: True, connected: False) = 27
7 total graphs: 1044 (crashed: False, connected: False) = 97 (crashed: False, connected: True) = 853 (crashed: True, connected: False) = 94

```


See trac #8284.  The above also causes problems for is_interval, which at one point tries "if not self.is_chordal()".

Issue created by migration from https://trac.sagemath.org/ticket/10899





---

archive/issue_comments_114468.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-12-07T23:37:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10827#issuecomment-114468",
    "user": "https://trac.sagemath.org/admin/accounts/users/brunellus"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_114469.json:
```json
{
    "body": "OK, this was quite easy -- the problem was that lex_BFS fails to generate correct tree. If we consider Graph(1), lex_BFS correctly computes order [1], but as a tree it return empty DiGraph, where it sould return DiGraph(1). Then is_chordal fails, because it asks for order of the vertex 1, that is not in the DiGraph. It is somehow unfortunate that out_degree function couldn't detect this problem and respond with a more apropriate error message.\n\nSo, why does lex_BFS fail to construct the proper tree? It takes the proper edges and adds them to the empty DiGraph. But that is not sufficient when the tree shouldn't contain any edges, as it is in the case of Graph(1). So the whole patch I wrote consist of single line, that adds vertices to the newly created tree too.\n\nI tried to run the crash test code from the ticket description and it didn't find any failing case.\n\n\n```\n0 total graphs: 1 (crashed: False, connected: True) = 1\n1 total graphs: 1 (crashed: False, connected: True) = 1\n2 total graphs: 2 (crashed: False, connected: False) = 1 (crashed: False, connected: True) = 1\n3 total graphs: 4 (crashed: False, connected: False) = 2 (crashed: False, connected: True) = 2\n4 total graphs: 11 (crashed: False, connected: False) = 5 (crashed: False, connected: True) = 6\n5 total graphs: 34 (crashed: False, connected: False) = 13 (crashed: False, connected: True) = 21\n6 total graphs: 156 (crashed: False, connected: False) = 44 (crashed: False, connected: True) = 112\n7 total graphs: 1044 (crashed: False, connected: False) = 191 (crashed: False, connected: True) = 853\n```\n",
    "created_at": "2011-12-07T23:37:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10827#issuecomment-114469",
    "user": "https://trac.sagemath.org/admin/accounts/users/brunellus"
}
```

OK, this was quite easy -- the problem was that lex_BFS fails to generate correct tree. If we consider Graph(1), lex_BFS correctly computes order [1], but as a tree it return empty DiGraph, where it sould return DiGraph(1). Then is_chordal fails, because it asks for order of the vertex 1, that is not in the DiGraph. It is somehow unfortunate that out_degree function couldn't detect this problem and respond with a more apropriate error message.

So, why does lex_BFS fail to construct the proper tree? It takes the proper edges and adds them to the empty DiGraph. But that is not sufficient when the tree shouldn't contain any edges, as it is in the case of Graph(1). So the whole patch I wrote consist of single line, that adds vertices to the newly created tree too.

I tried to run the crash test code from the ticket description and it didn't find any failing case.


```
0 total graphs: 1 (crashed: False, connected: True) = 1
1 total graphs: 1 (crashed: False, connected: True) = 1
2 total graphs: 2 (crashed: False, connected: False) = 1 (crashed: False, connected: True) = 1
3 total graphs: 4 (crashed: False, connected: False) = 2 (crashed: False, connected: True) = 2
4 total graphs: 11 (crashed: False, connected: False) = 5 (crashed: False, connected: True) = 6
5 total graphs: 34 (crashed: False, connected: False) = 13 (crashed: False, connected: True) = 21
6 total graphs: 156 (crashed: False, connected: False) = 44 (crashed: False, connected: True) = 112
7 total graphs: 1044 (crashed: False, connected: False) = 191 (crashed: False, connected: True) = 853
```




---

archive/issue_comments_114470.json:
```json
{
    "body": "Attachment [trac_10899_lex_BFS_repair.patch](tarball://root/attachments/some-uuid/ticket10899/trac_10899_lex_BFS_repair.patch) by brunellus created at 2011-12-07 23:37:41",
    "created_at": "2011-12-07T23:37:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10827#issuecomment-114470",
    "user": "https://trac.sagemath.org/admin/accounts/users/brunellus"
}
```

Attachment [trac_10899_lex_BFS_repair.patch](tarball://root/attachments/some-uuid/ticket10899/trac_10899_lex_BFS_repair.patch) by brunellus created at 2011-12-07 23:37:41



---

archive/issue_comments_114471.json:
```json
{
    "body": "all doctests pass on top of 4.8.alpha6 on a 64-bit machine.\n\nPaul",
    "created_at": "2012-01-10T14:54:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10827#issuecomment-114471",
    "user": "https://github.com/zimmermann6"
}
```

all doctests pass on top of 4.8.alpha6 on a 64-bit machine.

Paul



---

archive/issue_comments_114472.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd35.5\".",
    "created_at": "2012-01-10T14:54:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10827#issuecomment-114472",
    "user": "https://github.com/zimmermann6"
}
```

Changing keywords from "" to "sd35.5".



---

archive/issue_comments_114473.json:
```json
{
    "body": "Attachment [trac_10899_lex_BFS_repair.2.patch](tarball://root/attachments/some-uuid/ticket10899/trac_10899_lex_BFS_repair.2.patch) by brunellus created at 2012-01-10 20:37:10",
    "created_at": "2012-01-10T20:37:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10827#issuecomment-114473",
    "user": "https://trac.sagemath.org/admin/accounts/users/brunellus"
}
```

Attachment [trac_10899_lex_BFS_repair.2.patch](tarball://root/attachments/some-uuid/ticket10899/trac_10899_lex_BFS_repair.2.patch) by brunellus created at 2012-01-10 20:37:10



---

archive/issue_comments_114474.json:
```json
{
    "body": "Great! The new version differs only in technical details of the documentation.",
    "created_at": "2012-01-10T20:39:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10827#issuecomment-114474",
    "user": "https://trac.sagemath.org/admin/accounts/users/brunellus"
}
```

Great! The new version differs only in technical details of the documentation.



---

archive/issue_comments_114475.json:
```json
{
    "body": "please could you add also as doctest the example from the description?\n\n```\nsage: Graph(1).is_chordal()\nTrue\n```\n\n\nNote: one could wonder whether `0 vertices` should be `0 vertex` below:\n\n```\nsage: Graph().lex_BFS(tree=True) \n([], Digraph on 0 vertices)\n```\n\n\nNote 2: while reviewing that ticket I discovered that the syntax `Graph(n)` was not\ndocumented. I will open a new ticket for that.\n\nPaul",
    "created_at": "2012-01-11T09:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10827#issuecomment-114475",
    "user": "https://github.com/zimmermann6"
}
```

please could you add also as doctest the example from the description?

```
sage: Graph(1).is_chordal()
True
```


Note: one could wonder whether `0 vertices` should be `0 vertex` below:

```
sage: Graph().lex_BFS(tree=True) 
([], Digraph on 0 vertices)
```


Note 2: while reviewing that ticket I discovered that the syntax `Graph(n)` was not
documented. I will open a new ticket for that.

Paul



---

archive/issue_comments_114476.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-01-11T09:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10827#issuecomment-114476",
    "user": "https://github.com/zimmermann6"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_114477.json:
```json
{
    "body": "the issue about undocumented `Graph(n)` is now at #12293.\n\nPaul",
    "created_at": "2012-01-11T09:49:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10827#issuecomment-114477",
    "user": "https://github.com/zimmermann6"
}
```

the issue about undocumented `Graph(n)` is now at #12293.

Paul



---

archive/issue_comments_114478.json:
```json
{
    "body": "Attachment [trac_10899_lex_BFS_repair.3.patch](tarball://root/attachments/some-uuid/ticket10899/trac_10899_lex_BFS_repair.3.patch) by brunellus created at 2012-01-11 16:54:18\n\nI added the requested doctest and a small part of the presented testing program.",
    "created_at": "2012-01-11T16:54:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10827#issuecomment-114478",
    "user": "https://trac.sagemath.org/admin/accounts/users/brunellus"
}
```

Attachment [trac_10899_lex_BFS_repair.3.patch](tarball://root/attachments/some-uuid/ticket10899/trac_10899_lex_BFS_repair.3.patch) by brunellus created at 2012-01-11 16:54:18

I added the requested doctest and a small part of the presented testing program.



---

archive/issue_comments_114479.json:
```json
{
    "body": "English is not my first language, so I'm not sure whether \"graph on 0 vertices\" sounds weird. Wikipedia says:\n\n\"Languages having only a singular and plural form may still differ in their treatment of zero. For example, in English, German, Dutch, Italian, Spanish and Portuguese, the plural form is used for zero or more than one, and the singular for one thing only. By contrast, in French, the singular form is used for zero.\"\n\nI guess that some very polite piece of software could write something like \"Digraph on no vertices\". :-)",
    "created_at": "2012-01-11T17:03:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10827#issuecomment-114479",
    "user": "https://trac.sagemath.org/admin/accounts/users/brunellus"
}
```

English is not my first language, so I'm not sure whether "graph on 0 vertices" sounds weird. Wikipedia says:

"Languages having only a singular and plural form may still differ in their treatment of zero. For example, in English, German, Dutch, Italian, Spanish and Portuguese, the plural form is used for zero or more than one, and the singular for one thing only. By contrast, in French, the singular form is used for zero."

I guess that some very polite piece of software could write something like "Digraph on no vertices". :-)



---

archive/issue_comments_114480.json:
```json
{
    "body": "> I added the requested doctest and a small part of the presented testing program. \n\nthank you, great work!\n\nPaul",
    "created_at": "2012-01-11T17:10:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10827#issuecomment-114480",
    "user": "https://github.com/zimmermann6"
}
```

> I added the requested doctest and a small part of the presented testing program. 

thank you, great work!

Paul



---

archive/issue_comments_114481.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-01-11T17:10:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10827#issuecomment-114481",
    "user": "https://github.com/zimmermann6"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_114482.json:
```json
{
    "body": "Replying to [comment:10 brunellus]:\n> English is not my first language, so I'm not sure whether \"graph on 0 vertices\" sounds weird. Wikipedia says:\n> \n\n\n\"0 vertices\" is the correct English.",
    "created_at": "2012-01-12T15:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10827#issuecomment-114482",
    "user": "https://github.com/jasongrout"
}
```

Replying to [comment:10 brunellus]:
> English is not my first language, so I'm not sure whether "graph on 0 vertices" sounds weird. Wikipedia says:
> 


"0 vertices" is the correct English.



---

archive/issue_events_028237.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-15T10:44:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10827",
    "milestone": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10827#event-28237"
}
```



---

archive/issue_events_028238.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-23T13:57:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10827",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10827#event-28238"
}
```



---

archive/issue_comments_114483.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-01-23T13:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10827#issuecomment-114483",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
