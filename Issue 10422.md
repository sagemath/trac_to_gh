# Issue 10422: Calling a polynomial over finite non-prime field with named arguments

archive/issues_010422.json:
```json
{
    "body": "Assignee: AlexGhitza\n\nKeywords: Conversion, polynomial\n\nAt [sage-support](http://groups.google.com/group/sage-support/browse_thread/thread/9e729cb5d909bd53), Thomas pointed to a bug that boils down as follows:\n\n```\nsage: F.<x> = GF(4)\nsage: P.<y> = F[]\nsage: p = P.random_element(5,5)\nsage: SR(p)\nTraceback (most recent call last):\n...\nTypeError: __call__() takes exactly 1 positional argument (0 given)\n```\n\n\nReading the `_symbolic_` method, one is pointed to the subs method, which is\n\n```\n    def subs(self, *x, **kwds):\n        if len(x) == 1 and isinstance(x[0], dict):\n            g = self.parent().gen()\n            if x[0].has_key(g):\n                return self(x[0][g])\n            elif len(x[0]) > 0:\n                raise TypeError, \"keys do not match self's parent\"\n            return self\n        return self.__call__(*x, **kwds)\n```\n\nand there is the error again:\n\n```\nsage: p(y=y)\nTraceback (most recent call last):\n...\nTypeError: __call__() takes exactly 1 positional argument (0 given)\n```\n\n\nIndeed, the call method of p is\n\n```\n    def __call__(self, a):\n        cdef ntl_ZZ_pE _a\n        cdef ZZ_pE_c c_b\n\n        K = self._parent.base_ring()\n\n        try:\n            if a.parent() is not K:\n                a = K.coerce(a)\n        except (TypeError, AttributeError, NotImplementedError):\n            return Polynomial.__call__(self, a)\n\n        _a = self._parent._modulus.ZZ_pE(list(a.polynomial()))\n        ZZ_pEX_eval(c_b, self.x, _a.x)\n\n        R = K.polynomial_ring()\n        return K(str(R(ZZ_pE_c_to_list(c_b))))\n```\n\n\nSo, my patch will change the call method so that the arguments can either a single positional argument or one named argument (using the variable name).\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/10475\n\n",
    "created_at": "2010-12-14T11:16:42Z",
    "labels": [
        "basic arithmetic",
        "major",
        "bug"
    ],
    "title": "Calling a polynomial over finite non-prime field with named arguments",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10422",
    "user": "SimonKing"
}
```
Assignee: AlexGhitza

Keywords: Conversion, polynomial

At [sage-support](http://groups.google.com/group/sage-support/browse_thread/thread/9e729cb5d909bd53), Thomas pointed to a bug that boils down as follows:

```
sage: F.<x> = GF(4)
sage: P.<y> = F[]
sage: p = P.random_element(5,5)
sage: SR(p)
Traceback (most recent call last):
...
TypeError: __call__() takes exactly 1 positional argument (0 given)
```


Reading the `_symbolic_` method, one is pointed to the subs method, which is

```
    def subs(self, *x, **kwds):
        if len(x) == 1 and isinstance(x[0], dict):
            g = self.parent().gen()
            if x[0].has_key(g):
                return self(x[0][g])
            elif len(x[0]) > 0:
                raise TypeError, "keys do not match self's parent"
            return self
        return self.__call__(*x, **kwds)
```

and there is the error again:

```
sage: p(y=y)
Traceback (most recent call last):
...
TypeError: __call__() takes exactly 1 positional argument (0 given)
```


Indeed, the call method of p is

```
    def __call__(self, a):
        cdef ntl_ZZ_pE _a
        cdef ZZ_pE_c c_b

        K = self._parent.base_ring()

        try:
            if a.parent() is not K:
                a = K.coerce(a)
        except (TypeError, AttributeError, NotImplementedError):
            return Polynomial.__call__(self, a)

        _a = self._parent._modulus.ZZ_pE(list(a.polynomial()))
        ZZ_pEX_eval(c_b, self.x, _a.x)

        R = K.polynomial_ring()
        return K(str(R(ZZ_pE_c_to_list(c_b))))
```


So, my patch will change the call method so that the arguments can either a single positional argument or one named argument (using the variable name).


Issue created by migration from https://trac.sagemath.org/ticket/10475





---

archive/issue_comments_107291.json:
```json
{
    "body": "With the patch, one obtains\n\n```\nsage: F.<x> = GF(4)\nsage: P.<y> = F[]\nsage: p = y^4 + x*y^3 + y^2 + (x + 1)*y + x + 1\nsage: SR(p)      #indirect doctest\n(((y + x)*y + 1)*y + x + 1)*y + x + 1\n```\n\n\nThat example is added as a test.",
    "created_at": "2010-12-14T11:23:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10422",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10422#issuecomment-107291",
    "user": "SimonKing"
}
```

With the patch, one obtains

```
sage: F.<x> = GF(4)
sage: P.<y> = F[]
sage: p = y^4 + x*y^3 + y^2 + (x + 1)*y + x + 1
sage: SR(p)      #indirect doctest
(((y + x)*y + 1)*y + x + 1)*y + x + 1
```


That example is added as a test.



---

archive/issue_comments_107292.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-12-14T11:23:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10422",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10422#issuecomment-107292",
    "user": "SimonKing"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_107293.json:
```json
{
    "body": "There's one typo:\n\n```\nraise TypeError, \"%s__call__() accepts no named argument except 'x'\"%(type(self),self.variable_name())\n```\n\nneeds to have a second formatting character.\n\nOther than that, looks good.",
    "created_at": "2010-12-22T09:46:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10422",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10422#issuecomment-107293",
    "user": "roed"
}
```

There's one typo:

```
raise TypeError, "%s__call__() accepts no named argument except 'x'"%(type(self),self.variable_name())
```

needs to have a second formatting character.

Other than that, looks good.



---

archive/issue_comments_107294.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2010-12-22T09:46:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10422",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10422#issuecomment-107294",
    "user": "roed"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_107295.json:
```json
{
    "body": "Attachment [10475univariate_polynomial_call.patch](tarball://root/attachments/some-uuid/ticket10475/10475univariate_polynomial_call.patch) by SimonKing created at 2010-12-22 10:02:27",
    "created_at": "2010-12-22T10:02:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10422",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10422#issuecomment-107295",
    "user": "SimonKing"
}
```

Attachment [10475univariate_polynomial_call.patch](tarball://root/attachments/some-uuid/ticket10475/10475univariate_polynomial_call.patch) by SimonKing created at 2010-12-22 10:02:27



---

archive/issue_comments_107296.json:
```json
{
    "body": "Hi,\n\nThanks for finding it!\n\nActually there was another bug in it: When no positional argument together with a named argument different from the variable name was provided, then the \"wrong\" error was raised.\n\nThis is fixed in the updated patch, and I also added tests that demonstrate both errors:\n\n```\n            sage: p(2)\n            x + 1\n            sage: p(y=2)\n            x + 1\n            sage: p(3,y=2)\n            Traceback (most recent call last):\n            ...\n            TypeError: <type 'sage.rings.polynomial.polynomial_zz_pex.Polynomial_ZZ_pEX'>__call__() takes exactly 1 argument\n            sage: p(x=2)\n            Traceback (most recent call last):\n            ...\n            TypeError: <type 'sage.rings.polynomial.polynomial_zz_pex.Polynomial_ZZ_pEX'>__call__() accepts no named argument except 'y'\n```\n",
    "created_at": "2010-12-22T10:06:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10422",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10422#issuecomment-107296",
    "user": "SimonKing"
}
```

Hi,

Thanks for finding it!

Actually there was another bug in it: When no positional argument together with a named argument different from the variable name was provided, then the "wrong" error was raised.

This is fixed in the updated patch, and I also added tests that demonstrate both errors:

```
            sage: p(2)
            x + 1
            sage: p(y=2)
            x + 1
            sage: p(3,y=2)
            Traceback (most recent call last):
            ...
            TypeError: <type 'sage.rings.polynomial.polynomial_zz_pex.Polynomial_ZZ_pEX'>__call__() takes exactly 1 argument
            sage: p(x=2)
            Traceback (most recent call last):
            ...
            TypeError: <type 'sage.rings.polynomial.polynomial_zz_pex.Polynomial_ZZ_pEX'>__call__() accepts no named argument except 'y'
```




---

archive/issue_comments_107297.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2010-12-22T10:06:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10422",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10422#issuecomment-107297",
    "user": "SimonKing"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_107298.json:
```json
{
    "body": "Looks fine to me.  Once the doctests finish, it has a positive review from me.\n\nI'm going to be traveling and not checking in on this for a while; if someone else wants to finalize it once the doctests pass, go for it.",
    "created_at": "2010-12-22T10:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10422",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10422#issuecomment-107298",
    "user": "roed"
}
```

Looks fine to me.  Once the doctests finish, it has a positive review from me.

I'm going to be traveling and not checking in on this for a while; if someone else wants to finalize it once the doctests pass, go for it.



---

archive/issue_comments_107299.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-01-09T01:12:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10422",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10422#issuecomment-107299",
    "user": "aly.deines"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_107300.json:
```json
{
    "body": "Replying to [comment:4 roed]:\n> Looks fine to me.  Once the doctests finish, it has a positive review from me.\n> \n> I'm going to be traveling and not checking in on this for a while; if someone else wants to finalize it once the doctests pass, go for it.\n\nThe doctests pass for me.",
    "created_at": "2011-01-09T01:12:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10422",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10422#issuecomment-107300",
    "user": "aly.deines"
}
```

Replying to [comment:4 roed]:
> Looks fine to me.  Once the doctests finish, it has a positive review from me.
> 
> I'm going to be traveling and not checking in on this for a while; if someone else wants to finalize it once the doctests pass, go for it.

The doctests pass for me.



---

archive/issue_comments_107301.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-01-19T22:24:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10422",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10422#issuecomment-107301",
    "user": "jdemeyer"
}
```

Resolution: fixed
