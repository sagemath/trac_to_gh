# Issue 22330: The integral of floor(x) from 0 to inf is negative

Issue created by migration from Trac.

Original creator: pelegm

Original creation time: 2017-03-10 11:52:09

CC:  kcrisman rws

Keywords: floor,integrate,sympy

Running

```python
integrate(floor(x), x, 0, infinity, algorithm='sympy')
```

and trying

```python
integrate(floor(x), x, 0, infinity, algorithm='sympy').n()
```

returns (!!!) `-679.7441466712775`. This is awfully wrong.


---

Comment by pelegm created at 2017-03-11 12:08:36

Note that it doesn't happen without `algorithm='sympy'`.


---

Comment by rws created at 2017-03-12 06:16:30

I don't think this is correct:

```
sage: integrate((1+x+x^2)^(1/3), x, 0, infinity)
integrate((x^2 + x + 1)^(1/3), x, 0, +Infinity)
sage: _.n()
8.835093500042741e+20
```



---

Comment by kcrisman created at 2017-03-13 12:50:06

I want to point out that all these integrals involve infinity.  I can't remember any more exactly where to find it (did poke about a bit) but there should be code, and not original code, for how to deal with this situation - I think it just sends it to the GSL algorithm `numerical_integral` which would likely give nonsense for infinity.  And indeed that is the case - [compare this Sage cell](http://sagecell.sagemath.org/?z=eJwrKMrMK1HIK81NLcpMTsyJB_JS04sSczTScvLzizQqNHUUDHQUtD3z0jLzMksqNXm5CnDp0KiIM1LQVqgAYkPNOA1DfWN0zQA7mSO9&lang=sage):

```
sage: print numerical_integral(floor(x), 0, +Infinity)
sage: print numerical_integral((x^2 + x + 1)^(1/3), 0, +Infinity)
(-679.7441466712775, 632.307547415802)
(8.835093500042741e+20, 1.6991730463958232e+21)
```



---

Comment by kcrisman created at 2017-03-13 12:50:06

Changing keywords from "floor,integrate,sympy" to "integrate".
