# Issue 22330: The integral of floor(x) from 0 to inf is negative

archive/issues_022330.json:
```json
{
    "body": "CC:  @kcrisman @rwst\n\nKeywords: floor,integrate,sympy\n\nRunning\n\n```python\nintegrate(floor(x), x, 0, infinity, algorithm='sympy')\n```\n\nand trying\n\n```python\nintegrate(floor(x), x, 0, infinity, algorithm='sympy').n()\n```\n\nreturns (!!!) `-679.7441466712775`. This is awfully wrong.\n\nIssue created by migration from https://trac.sagemath.org/ticket/22567\n\n",
    "created_at": "2017-03-10T11:52:09Z",
    "labels": [
        "calculus",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.6",
    "title": "The integral of floor(x) from 0 to inf is negative",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22330",
    "user": "@pelegm"
}
```
CC:  @kcrisman @rwst

Keywords: floor,integrate,sympy

Running

```python
integrate(floor(x), x, 0, infinity, algorithm='sympy')
```

and trying

```python
integrate(floor(x), x, 0, infinity, algorithm='sympy').n()
```

returns (!!!) `-679.7441466712775`. This is awfully wrong.

Issue created by migration from https://trac.sagemath.org/ticket/22567





---

archive/issue_comments_310423.json:
```json
{
    "body": "Note that it doesn't happen without `algorithm='sympy'`.",
    "created_at": "2017-03-11T12:08:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22330",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22330#issuecomment-310423",
    "user": "@pelegm"
}
```

Note that it doesn't happen without `algorithm='sympy'`.



---

archive/issue_comments_310424.json:
```json
{
    "body": "I don't think this is correct:\n\n```\nsage: integrate((1+x+x^2)^(1/3), x, 0, infinity)\nintegrate((x^2 + x + 1)^(1/3), x, 0, +Infinity)\nsage: _.n()\n8.835093500042741e+20\n```\n",
    "created_at": "2017-03-12T06:16:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22330",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22330#issuecomment-310424",
    "user": "@rwst"
}
```

I don't think this is correct:

```
sage: integrate((1+x+x^2)^(1/3), x, 0, infinity)
integrate((x^2 + x + 1)^(1/3), x, 0, +Infinity)
sage: _.n()
8.835093500042741e+20
```




---

archive/issue_comments_310425.json:
```json
{
    "body": "I want to point out that all these integrals involve infinity.  I can't remember any more exactly where to find it (did poke about a bit) but there should be code, and not original code, for how to deal with this situation - I think it just sends it to the GSL algorithm `numerical_integral` which would likely give nonsense for infinity.  And indeed that is the case - [compare this Sage cell](http://sagecell.sagemath.org/?z=eJwrKMrMK1HIK81NLcpMTsyJB_JS04sSczTScvLzizQqNHUUDHQUtD3z0jLzMksqNXm5CnDp0KiIM1LQVqgAYkPNOA1DfWN0zQA7mSO9&lang=sage):\n\n```\nsage: print numerical_integral(floor(x), 0, +Infinity)\nsage: print numerical_integral((x^2 + x + 1)^(1/3), 0, +Infinity)\n(-679.7441466712775, 632.307547415802)\n(8.835093500042741e+20, 1.6991730463958232e+21)\n```\n",
    "created_at": "2017-03-13T12:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22330",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22330#issuecomment-310425",
    "user": "@kcrisman"
}
```

I want to point out that all these integrals involve infinity.  I can't remember any more exactly where to find it (did poke about a bit) but there should be code, and not original code, for how to deal with this situation - I think it just sends it to the GSL algorithm `numerical_integral` which would likely give nonsense for infinity.  And indeed that is the case - [compare this Sage cell](http://sagecell.sagemath.org/?z=eJwrKMrMK1HIK81NLcpMTsyJB_JS04sSczTScvLzizQqNHUUDHQUtD3z0jLzMksqNXm5CnDp0KiIM1LQVqgAYkPNOA1DfWN0zQA7mSO9&lang=sage):

```
sage: print numerical_integral(floor(x), 0, +Infinity)
sage: print numerical_integral((x^2 + x + 1)^(1/3), 0, +Infinity)
(-679.7441466712775, 632.307547415802)
(8.835093500042741e+20, 1.6991730463958232e+21)
```




---

archive/issue_comments_310426.json:
```json
{
    "body": "Changing keywords from \"floor,integrate,sympy\" to \"integrate\".",
    "created_at": "2017-03-13T12:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22330",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22330#issuecomment-310426",
    "user": "@kcrisman"
}
```

Changing keywords from "floor,integrate,sympy" to "integrate".
