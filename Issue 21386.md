# Issue 21386: Upgrade to pynac-0.6.91

Issue created by migration from https://trac.sagemath.org/ticket/21623

Original creator: rws

Original creation time: 2016-10-02 13:50:06

CC:  paulmasson fbissey

* compiles with clang
 * fix `cot(float)` bug; (#21365)
 * NaN constant; return NaN with atan2(0,0) (#21614)
 * numeric log fixes
 * prevent some overflow exceptions in `cot/csc`
 * two-argument log (log to base)
 * Support `gegenbauer(n,a,x)` with non-numeric `a`
 * update AUTHORS

https://github.com/pynac/pynac/releases/download/pynac-0.6.91/pynac-0.6.91.tar.bz2


---

Comment by rws created at 2016-10-02 14:40:18

Changing status from new to needs_review.


---

Comment by rws created at 2016-10-02 14:40:18

New commits:


---

Comment by paulmasson created at 2016-10-02 22:31:44

Documentation builds, but failing doctest in `fast_callable.pyx`.

Would like more information on "overflow exceptions in `cot/csc`", which is presumably this [commit](https://github.com/pynac/pynac/commit/08a27812e3280bfa60ee341748ab82173ee13635). What does this fix exactly?

The versioning is nonstandard. If this is a minor update it should be 0.6.9.1, otherwise 0.6.10.


---

Comment by paulmasson created at 2016-10-02 22:31:44

Changing status from needs_review to needs_work.


---

Comment by git created at 2016-10-03 05:57:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2016-10-03 06:16:17

Replying to [comment:5 paulmasson]:
> Documentation builds, but failing doctest in `fast_callable.pyx`.

Curious. The doctest change seemeed necessary, but not anymore.

> Would like more information on "overflow exceptions in `cot/csc`", which is presumably this [commit](https://github.com/pynac/pynac/commit/08a27812e3280bfa60ee341748ab82173ee13635). What does this fix exactly?

I think I explained this already. The only exact numeric value that can go into `inverse()` is zero. All others are inexact. Otherwise the doctest that fails is:

```
File "src/sage/functions/trig.py", line 268, in sage.functions.trig.Function_cot.__init__
Failed example:
    cot(float(0))
Exception raised:
    Traceback (most recent call last):
      File "/home/ralf/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/ralf/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.functions.trig.Function_cot.__init__[16]>", line 1, in <module>
        cot(float(Integer(0)))
      File "sage/symbolic/function.pyx", line 996, in sage.symbolic.function.BuiltinFunction.__call__ (build/cythonized/sage/symbolic/function.cpp:11008)
        res = super(BuiltinFunction, self).__call__(
      File "sage/symbolic/function.pyx", line 488, in sage.symbolic.function.Function.__call__ (build/cythonized/sage/symbolic/function.cpp:6241)
        res = g_function_eval1(self._serial,
    OverflowError: numeric::inverse(): division by zero
```


> The versioning is nonstandard. If this is a minor update it should be 0.6.9.1, otherwise 0.6.10.

Where do you get the idea of a standard for versioning? I could use ISO 8601 of the release date as well for the version string. There is a tradition to use major/minor/micro for Pynac, and I changed micro from 9 to 91 (ninety one) to stay lexicographically consecutive.
----
New commits:


---

Comment by rws created at 2016-10-03 07:59:21

Changing status from needs_work to needs_review.


---

Comment by paulmasson created at 2016-10-03 19:44:46

Replying to [comment:7 rws]:
> > The versioning is nonstandard. If this is a minor update it should be 0.6.9.1, otherwise 0.6.10.
> 
> Where do you get the idea of a standard for versioning? I could use ISO 8601 of the release date as well for the version string. There is a tradition to use major/minor/micro for Pynac, and I changed micro from 9 to 91 (ninety one) to stay lexicographically consecutive.
The traditional split indicates the use of semantic versioning. In semantic versioning numbers are incremented numerically, not lexicographically. See item (2) in this standard: http://semver.org


---

Comment by rws created at 2016-10-03 20:16:41

Nothing there forbids incrementing by 82.


---

Comment by tscrim created at 2016-10-06 13:58:37

Because of this change:

```diff
diff --git a/src/sage/functions/trig.py b/src/sage/functions/trig.py
index 40c0586..fba1100 100644
--- a/src/sage/functions/trig.py
+++ b/src/sage/functions/trig.py
@@ -265,6 +265,15 @@ class Function_cot(GinacFunction):
 
         TESTS:
 
+            sage: cot(float(0))
+            Infinity
+            sage: cot(SR(0))
+            Infinity
+            sage: cot(float(0.1))
+            9.966644423259238
+            sage: type(_)
+            <type 'float'>
+
         Test complex input::
 
             sage: cot(complex(1,1))     # rel tol 1e-15
```

The doc is incorrect. You need to change `TESTS:` -> `TESTS::`.

Other than that, I would be willing to set this to a positive review unless Paul has any objections.


---

Comment by git created at 2016-10-06 14:18:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by paulmasson created at 2016-10-06 20:23:56

I have a problem with the version number. In semantic versioning, incrementing by 82 implies that many private releases in between versions, which clearly wasn't the case. This version number is inconsistent with the entire versioning history of Pynac.

This version number appears to be an arbitrary choice. As a belatedly recognized direct contributor to this version, I think it is well within my purview to request a modification. As more of the symbolics of Sage is moved into Pynac, I would like to see that project become more of a true collaboration. Changing the version on GitHub is a straightforward process and would give evidence of acceptance of feedback.

I don't think this ticket should be approved with the current version number.


---

Comment by tscrim created at 2016-10-06 22:06:00

I think this is in the realm of bikeshedding.


---

Comment by fbissey created at 2016-10-06 22:09:07

While I disapprove of the numbering, I don't care enough to make it an issue for inclusion/review.


---

Comment by paulmasson created at 2016-10-07 00:44:14

Travis, since there is no review process for Pynac this is the only place to question arbitrary decisions made by one person. If you consider that trivial, so be it.


---

Comment by rws created at 2016-10-07 05:40:49

The Pynac review process happens here, nothing new. Maintainer decisions are often seen as arbitrary. I won't devote time to revert a numbering issue. Rather, I started yesterday on fast series expansion using Flint, which will make a new minor number change necessary because of the hard dependency. So if 0.6.91 doesn't get positive review it'll be replaced by 0.7.0 later, anyway. The numbering criticism is noted and will be followed when 0.7.10 is on the plate. Or if.


---

Comment by tscrim created at 2016-10-07 13:45:23

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2016-10-07 13:45:23

IMO, let's try to sneak this into the next Sage release. So I'm setting this to a positive review.


---

Comment by rws created at 2016-10-15 14:43:10

Replying to [comment:17 rws]:
> ...fast series expansion using Flint, which will make a new minor number change necessary because of the hard dependency.

It's done. See #14878.


---

Comment by vbraun created at 2016-10-21 07:03:54

Resolution: fixed
