# Issue 18836: categorial constructions, pushout and coercions (extended) for asymptotic ring and growth groups

Issue created by migration from https://trac.sagemath.org/ticket/19073

Original creator: dkrenn

Original creation time: 2015-08-22 19:18:51

CC:  behackl

Keywords: asymptotics

Extend coersions and deal with pushout constructions.


---

Comment by git created at 2015-08-24 17:43:06

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by git created at 2015-08-24 17:49:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-08-25 07:43:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2015-09-02 14:06:21

Changing status from new to needs_review.


---

Comment by git created at 2015-09-14 18:34:52

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by dkrenn created at 2015-09-14 18:35:19

merged 6.9.beta5


---

Comment by dkrenn created at 2015-09-15 17:28:59

Changing component from symbolics to asymptotic expansions.


---

Comment by git created at 2015-09-16 16:08:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2015-09-16 16:14:35

merged 6.9.beta6 (with #18182)


---

Comment by git created at 2015-09-16 17:40:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-09-29 17:57:15

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by dkrenn created at 2015-09-29 17:57:39

Merged in changes in dependencies.


---

Comment by git created at 2015-09-30 09:25:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-10-04 14:51:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2015-10-04 14:58:19

Changing status from needs_review to needs_work.


---

Comment by cheuberg created at 2015-10-04 14:58:19

I reviewed this ticket without reviewing its dependency #18182. I have added a few reviewer commits.

Here are some further comments.

1. `growth_group.combine_exceptions`: missing INPUT and OUTPUT blocks
2. Why is the default category now a monoid instead of a group?
3. `GenericGrowthGroup._pushout_`:
  - explain why there is no common canonical parent for objects with parents: `Growth Group QQ^x` and `Growth Group x^QQ` (commutativity of pushouts vs. non-commutativity of cartesian products of growth groups with the same generator?)
  - What is the role of the lines

```
        if isinstance(other, GenericGrowthGroup):
            pass
```

4. `growth_group_cartesian.merge_overlapping`: 
  - add more information to docstring: missing INPUT: and OUTPUT: blocks
  - `find_mergedoverlapping_index`: `key` is evaluated frequently
5. `_convert_factors_`: remove `list` in penultimate line of code.
6. `TermWithCoefficientMonoid._element_constructor_`: what is the point of catching and immediately re-raising an exception in 

```
try:
	return self.element_class(self, data, coefficient)
except:
	raise
```

7. `AsymptoticRing.__init__`: why is an `Asymptoticring` now a poset?


---

Comment by dkrenn created at 2015-10-08 14:12:48

Changing status from needs_work to needs_review.


---

Comment by dkrenn created at 2015-10-08 14:12:48

Replying to [comment:20 cheuberg]:
> I reviewed this ticket without reviewing its dependency #18182. I have added a few reviewer commits.

Cross-review...ok.

> 1. `growth_group.combine_exceptions`: missing INPUT and OUTPUT blocks

Added.

> 2. Why is the default category now a monoid instead of a group?

A monoid is all what is needed to make the asymptotic ring a ring. Of course usually this will be a group to allow inversions in the ring, but as a minimal requirement, we have Monoids()

> 3. `GenericGrowthGroup._pushout_`:
>   - explain why there is no common canonical parent for objects with parents: `Growth Group QQ^x` and `Growth Group x^QQ` (commutativity of pushouts vs. non-commutativity of cartesian products of growth groups with the same generator?)

Documented.

>   - What is the role of the lines
> {{{
>         if isinstance(other, GenericGrowthGroup):
>             pass
> }}}

`elif` forgotten in the line following this. Rewritten completely.

> 4. `growth_group_cartesian.merge_overlapping`: 
>   - add more information to docstring: missing INPUT: and OUTPUT: blocks

Added and extended.

>   - `find_mergedoverlapping_index`: `key` is evaluated frequently

Now cached.

> 5. `_convert_factors_`: remove `list` in penultimate line of code.

Done.

> 6. `TermWithCoefficientMonoid._element_constructor_`: what is the point of catching and immediately re-raising an exception in 
> {{{
> try:
> 	return self.element_class(self, data, coefficient)
> except:
> 	raise
> }}}

No point; changed. (I think this changed at some point and was forgotten)

> 7. `AsymptoticRing.__init__`: why is an `Asymptoticring` now a poset?

Removed (this was planned to be done on #19083).
----
New commits:


---

Comment by git created at 2015-10-08 14:54:13

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by dkrenn created at 2015-10-08 14:56:02

Merge in all dependencies.


---

Comment by git created at 2015-10-08 17:09:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2015-10-08 17:19:16

Replying to [comment:22 dkrenn]:
> Replying to [comment:20 cheuberg]:
> > 2. Why is the default category now a monoid instead of a group?
> 
> A monoid is all what is needed to make the asymptotic ring a ring. Of course usually this will be a group to allow inversions in the ring, but as a minimal requirement, we have Monoids()

Ok, this explains why a `GenericGrowthGroup` is only a monoid.

The derived classes `MonomialGrowthGroup` and `ExponentialGrowthGroup`, however, will be groups in many cases.
Perhaps this can be resolved in or after #19083.

> > 3. `GenericGrowthGroup._pushout_`:
> >   - explain why there is no common canonical parent for objects with parents: `Growth Group QQ^x` and `Growth Group x^QQ` (commutativity of pushouts vs. non-commutativity of cartesian products of growth groups with the same generator?)
> 
> Documented.

I reworded that and added further doctests.

> >   - `find_mergedoverlapping_index`: `key` is evaluated frequently
> 
> Now cached.

However, the helper functions only need the keys, I added a commit to do so.

Please cross-review my changes and add item 2. to the TODO list of #19083 or, alternatively, open a ticket for that.
After that, consider this to be a conditional `positive_review` from my side, conditional on #18182.


---

Comment by dkrenn created at 2015-10-12 14:59:38

Changing status from needs_review to positive_review.


---

Comment by dkrenn created at 2015-10-12 14:59:38

Replying to [comment:28 cheuberg]:
> Replying to [comment:22 dkrenn]:
> > Replying to [comment:20 cheuberg]:
> > > 2. Why is the default category now a monoid instead of a group?
> > 
> > A monoid is all what is needed to make the asymptotic ring a ring. Of course usually this will be a group to allow inversions in the ring, but as a minimal requirement, we have Monoids()
> 
> Ok, this explains why a `GenericGrowthGroup` is only a monoid.
> 
> The derived classes `MonomialGrowthGroup` and `ExponentialGrowthGroup`, however, will be groups in many cases.
> Perhaps this can be resolved in or after #19083.

Ok. Added it as a work issue on #19083.

> > > 3. `GenericGrowthGroup._pushout_`:
> > >   - explain why there is no common canonical parent for objects with parents: `Growth Group QQ^x` and `Growth Group x^QQ` (commutativity of pushouts vs. non-commutativity of cartesian products of growth groups with the same generator?)
> > 
> > Documented.
> 
> I reworded that and added further doctests.

Corrected PEP8.

> > >   - `find_mergedoverlapping_index`: `key` is evaluated frequently
> > 
> > Now cached.
> 
> However, the helper functions only need the keys, I added a commit to do so.

Thanks.

> Please cross-review my changes and add item 2. to the TODO list of #19083 or, alternatively, open a ticket for that.
> After that, consider this to be a conditional `positive_review` from my side, conditional on #18182.

Everything done.
----
New commits:


---

Comment by cheuberg created at 2015-10-23 05:50:12

Removed dependency on "duplicate" ticket #18586.


---

Comment by vbraun created at 2015-10-23 23:10:02

This is probably due to one of the tickets in beta2, probably best to wait for the next release and then fix:

```
sage -t --long src/sage/combinat/rigged_configurations/kr_tableaux.py
**********************************************************************
File "src/sage/combinat/rigged_configurations/kr_tableaux.py", line 1671, in sage.combinat.rigged_configurations.kr_tableaux.KRTableauxTypeDTri2Element.e
Failed example:
    KRT.module_generators[0].e(0)
Exception raised:
    Traceback (most recent call last):
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.combinat.rigged_configurations.kr_tableaux.KRTableauxTypeDTri2Element.e[1]>", line 1, in <module>
        KRT.module_generators[Integer(0)].e(Integer(0))
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1680, in e
        ret = ret.to_virtual_configuration().e(0)
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/rigged_configuration_element.py", line 1327, in e
        ret = self.to_tensor_product_of_kirillov_reshetikhin_tableaux().e(a)
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/tensor_product.py", line 1258, in e
        position = self.positions_of_unmatched_plus(i)
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/tensor_product.py", line 1400, in positions_of_unmatched_plus
        l = self.positions_of_unmatched_minus(i, dual=True, reverse=True)
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/tensor_product.py", line 1380, in positions_of_unmatched_minus
        plus = self[j].epsilon(i)
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1532, in epsilon
        return KirillovReshetikhinTableauxElement.epsilon(self, i)
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1373, in epsilon
        return self.to_kirillov_reshetikhin_crystal().epsilon0()
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/rigged_configurations/kr_tableaux.py", line 1160, in to_kirillov_reshetikhin_crystal
        return self.parent().kirillov_reshetikhin_crystal()(self)
      File "sage/structure/parent.pyx", line 1098, in sage.structure.parent.Parent.__call__ (/mnt/disk/home/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/structure/parent.c:9821)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 109, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/mnt/disk/home/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/structure/coerce_maps.c:4543)
        raise
      File "sage/structure/coerce_maps.pyx", line 104, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/mnt/disk/home/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/structure/coerce_maps.c:4436)
        return C._element_constructor(x)
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/kirillov_reshetikhin.py", line 3024, in _element_constructor_
        return self.module_generator().f_string(f_str)
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/crystals/kirillov_reshetikhin.py", line 543, in module_generator
        return [ b for b in self.module_generators if b.weight() == weight][0]
    IndexError: list index out of range
**********************************************************************
```



---

Comment by vbraun created at 2015-10-23 23:10:02

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2015-10-24 07:57:00

Nevermind was casued by something else


---

Comment by vbraun created at 2015-10-24 07:57:00

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2015-10-24 10:22:18

Resolution: fixed
