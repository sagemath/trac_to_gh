# Issue 26830: py3: Simplicial complexes: fix is_isomorphic

Issue created by migration from https://trac.sagemath.org/ticket/27067

Original creator: jhpalmieri

Original creation time: 2019-01-15 22:30:35

The method `is_isomorphic` for simplicial complexes doesn't work with Python 3 for several reasons. The method constructs graphs associated to `self` and `other` and then tests whether they are isomorphic, preserving edge labels.

- Some of the edges have labels and some don't, and this is not handled gracefully, so we give all edges labels.
- The vertices and/or facets in the complexes can't be sorted in Python 3, so we translate them all to Python `int`s, sort those, and then translate back if we need to.


---

Comment by jhpalmieri created at 2019-01-15 22:59:20

New commits:


---

Comment by jhpalmieri created at 2019-01-15 22:59:20

Changing status from new to needs_review.


---

Comment by git created at 2019-01-15 23:00:33

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by chapoton created at 2019-01-16 09:04:32

two failing doctests, see patchbot

Maybe try to make them more robust ?


---

Comment by chapoton created at 2019-01-16 09:04:32

Changing status from needs_review to needs_work.


---

Comment by jhpalmieri created at 2019-01-16 17:04:50

Changing status from needs_work to needs_review.


---

Comment by jhpalmieri created at 2019-01-16 17:04:50

That test is fixed by #27027, one of the dependencies. Let's wait until it's merged and then try this again.


---

Comment by jhpalmieri created at 2019-01-16 17:05:31

(The branch from #26966 is included here because there would be merge conflicts otherwise. I didn't include the one from #27027. I never know the right way to handle dependencies like this.)


---

Comment by jhpalmieri created at 2019-02-03 22:59:09

Okay, please try this again now (you probably have to rebase onto 8.7.beta2).


---

Comment by @darijgr created at 2019-02-04 03:16:53

The code LGTM, but please add a doctest showing that the two possible simplicial complexes on a 1-element set (one consisting of just the empty set, and another that is the whole powerset) are not isomorphic -- this is a bit of an edge case for the implementation.


---

Comment by jhpalmieri created at 2019-02-04 03:32:33

I'm not sure I understand. Every vertex in a simplicial set must be in a facet, or to put it another way, the vertices in a simplicial set are formed by taking the union of the facets. (I'm talking about how things are implemented in Sage.) So if you have a vertex, you can't have the empty simplicial set. I can add this:

```
sage: S = SimplicialComplex()
sage: T = SimplicialComplex([0])
sage: S.is_isomorphic(T)
False
```

and/or this:

```
sage: T.remove_face([0])
sage: S.is_isomorphic(T)
True
```



---

Comment by @darijgr created at 2019-02-04 03:35:12

Does Sage really forbid ghost vertices? If so, then it's a non-issue, though it's a bad decision if you ask me.


---

Comment by @darijgr created at 2019-02-04 03:36:36

And then the doc here:

```
This module implements the basic structure of finite simplicial
complexes. Given a set `V` of "vertices", a simplicial complex on `V`
is a collection `K` of subsets of `V` satisfying the condition that if
`S` is one of the subsets in `K`, then so is every subset of `S`.  The
subsets `S` are called the 'simplices' of `K`.
```

is wrong, as it says nothing about ghost vertices being forbidden.


---

Comment by jhpalmieri created at 2019-02-04 03:45:42

You're right that the documentation is out-dated. I'm curious about "ghost vertices". For example, why should the empty simplicial complex on vertices {1,2} be considered different from the empty simplicial complex on vertices {4,5,6,7}?


---

Comment by @darijgr created at 2019-02-04 04:03:35

If you don't keep the ghost vertices around, then the link of a vertex of a simplicial complex may lose vertices. Somehow I doubt this is a good thing. Then again I haven't done much with simplicial complexes, so I don't know what is actually good in practice.


---

Comment by jhpalmieri created at 2019-02-04 04:29:09

I don't know of any computational reason, in particular any reason within Sage, why it should matter if link(sigma) and the ambient simplicial complex should have the same or different vertex sets.


---

Comment by @darijgr created at 2019-02-04 04:29:46

OK, then this should be reflected in the doc.


---

Comment by jhpalmieri created at 2019-02-04 04:32:51

See #27211 for the documentation change.


---

Comment by @darijgr created at 2019-02-04 18:50:59

Changing keywords from "" to "python3, simplicial complexes".


---

Comment by @darijgr created at 2019-02-04 18:50:59

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-02-05 16:57:36

Resolution: fixed
