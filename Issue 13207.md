# Issue 13207: Add a splitting field function for polynomials over a finite field

Issue created by migration from Trac.

Original creator: abrochard

Original creation time: 2012-08-18 17:43:29

Assignee: davidloeffler

CC:  mmasdeu jdemeyer

The purpose of this patch is to add the splitting_field() function to polynomial elements with coefficients in a finite field. For coherence purpose, I copied the syntax of the patch proposed for ticket #2217 (hope it's ok), which is about splitting field for polynomial over number fields. Some of the argument are not used in the function, but again, it is for the overall coherence in case of integration of both patches.


---

Attachment


---

Comment by roed created at 2012-09-17 05:30:12

Is this waiting on something, or should it be marked as needs review?


---

Comment by abrochard created at 2012-09-17 11:29:00

Changing status from new to needs_review.


---

Comment by roed created at 2012-10-15 08:05:21

I haven't taken a look, but I'll just note that there are some whitespace issues: you added a TAB character in polynomial_element.pyx and there's trailing whitespace as well.  See the report from the patchbot.


---

Comment by robharron created at 2013-03-14 07:27:01

For p a prime and q = p<sup>n</sup>, the field F<sub>q</sub> is Galois over F<sub>p</sub>, i.e. it is the splitting field of any irreducible polynomial of degree n over F<sub>p</sub>. Moreover, the field with p<sup>n</sup> elements contains the one with p<sup>m</sup> elements if and only if m divides n. Thus, starting from a polynomial over F<sub>p</sub>, the splitting field is simply given by taking the lcm of the degrees of the factors. This would be quicker than what you are doing. If you start with a polynomial over F<sub>q</sub>, a simple modification of what I've said would work too.


---

Comment by mmasdeu created at 2013-03-14 22:24:42

I think that the whole point is to return an embedding of F<sub>q</sub> into its splitting field. For that, one has to be careful when constructing the extensions: either choosing the given polynomial (or a factor of it) to define the extension, or using some root finding algorithm.

Also, the patch fails in the last couple of Sage releases...

Replying to [comment:5 robharron]:
> For p a prime and q = p<sup>n</sup>, the field F<sub>q</sub> is Galois over F<sub>p</sub>, i.e. it is the splitting field of any irreducible polynomial of degree n over F<sub>p</sub>. Moreover, the field with p<sup>n</sup> elements contains the one with p<sup>m</sup> elements if and only if m divides n. Thus, starting from a polynomial over F<sub>p</sub>, the splitting field is simply given by taking the lcm of the degrees of the factors. This would be quicker than what you are doing. If you start with a polynomial over F<sub>q</sub>, a simple modification of what I've said would work too.


---

Comment by robharron created at 2013-03-15 04:45:53

But have you looked at the code? It doesn't do anything special with regards to the embedding. (Do you see something I don't?) In the end it simply says F.Hom(K)[0] (for instance, I think the code only runs when the polynomial is defined over a prime field, in which case the embedding returned is simply the canonical one sending 1 to 1). I just quickly wrote a function that does what I suggested and it works just fine and is quite quick.

Replying to [comment:6 mmasdeu]:
> I think that the whole point is to return an embedding of F<sub>q</sub> into its splitting field. For that, one has to be careful when constructing the extensions: either choosing the given polynomial (or a factor of it) to define the extension, or using some root finding algorithm.
> 
> Also, the patch fails in the last couple of Sage releases...
> 
> Replying to [comment:5 robharron]:
> > For p a prime and q = p<sup>n</sup>, the field F<sub>q</sub> is Galois over F<sub>p</sub>, i.e. it is the splitting field of any irreducible polynomial of degree n over F<sub>p</sub>. Moreover, the field with p<sup>n</sup> elements contains the one with p<sup>m</sup> elements if and only if m divides n. Thus, starting from a polynomial over F<sub>p</sub>, the splitting field is simply given by taking the lcm of the degrees of the factors. This would be quicker than what you are doing. If you start with a polynomial over F<sub>q</sub>, a simple modification of what I've said would work too.


---

Comment by mmasdeu created at 2013-03-17 21:44:48

Yes, I agree that for polynomials defined over F<sub>p</sub> the function should be simplified. As for F<sub>q</sub> one definitely needs to fix the code, since that calling of Hom won't work...

Replying to [comment:7 robharron]:
> But have you looked at the code? It doesn't do anything special with regards to the embedding. (Do you see something I don't?) In the end it simply says F.Hom(K)[0] (for instance, I think the code only runs when the polynomial is defined over a prime field, in which case the embedding returned is simply the canonical one sending 1 to 1). I just quickly wrote a function that does what I suggested and it works just fine and is quite quick.
> 
> Replying to [comment:6 mmasdeu]:
> > I think that the whole point is to return an embedding of F<sub>q</sub> into its splitting field. For that, one has to be careful when constructing the extensions: either choosing the given polynomial (or a factor of it) to define the extension, or using some root finding algorithm.
> > 
> > Also, the patch fails in the last couple of Sage releases...
> > 
> > Replying to [comment:5 robharron]:
> > > For p a prime and q = p<sup>n</sup>, the field F<sub>q</sub> is Galois over F<sub>p</sub>, i.e. it is the splitting field of any irreducible polynomial of degree n over F<sub>p</sub>. Moreover, the field with p<sup>n</sup> elements contains the one with p<sup>m</sup> elements if and only if m divides n. Thus, starting from a polynomial over F<sub>p</sub>, the splitting field is simply given by taking the lcm of the degrees of the factors. This would be quicker than what you are doing. If you start with a polynomial over F<sub>q</sub>, a simple modification of what I've said would work too.


---

Comment by robharron created at 2013-03-17 22:46:45

No, for F<sub>q</sub> the calling of Hom works:


```
sage: F = GF(3^4, 'z')
sage: K = GF(3^12, 'zz')
sage: F.Hom(K)
Set of field embeddings from Finite Field in z of size 3^4 to Finite Field in zz of size 3^12
sage: F.Hom(K)[0]
Ring morphism:
  From: Finite Field in z of size 3^4
  To:   Finite Field in zz of size 3^12
  Defn: z |--> 2*zz^10 + zz^8 + 2*zz^7 + zz^6 + 2*zz^5 + zz^4 + 2*zz^3 + 2*zz^2 + zz + 2
```


The problem over F<sub>q</sub> is elsewhere: some coercion problem when calling poly.change_ring().

Replying to [comment:8 mmasdeu]:
> Yes, I agree that for polynomials defined over F<sub>p</sub> the function should be simplified. As for F<sub>q</sub> one definitely needs to fix the code, since that calling of Hom won't work...
> 
> Replying to [comment:7 robharron]:
> > But have you looked at the code? It doesn't do anything special with regards to the embedding. (Do you see something I don't?) In the end it simply says F.Hom(K)[0] (for instance, I think the code only runs when the polynomial is defined over a prime field, in which case the embedding returned is simply the canonical one sending 1 to 1). I just quickly wrote a function that does what I suggested and it works just fine and is quite quick.


---

Attachment

rewritten, based on 5.11.rc0 + #8335


---

Comment by pbruin created at 2013-08-06 15:06:38

I was going to review this, but ended up wanting to change almost everything, so here is a new version.  The doctests are the same as in the original, up to cosmetic changes.

The new implementation of this function is very short, as suggested by the above comments.  It just computes the degree of the splitting field over the base field, and then calls the `FiniteField_base.extension()` method implemented by #8335.

The `map` flag from the original patch is currently not understood, but for more flexibility, any additional arguments are now passed to `FiniteField_base.extension()`, which would be the right place to implement the `map` parameter.

The currently unused parameters have been removed; this ticket will probably be merged before #2217, and that one might change dramatically for all we know.


---

Comment by pbruin created at 2013-08-06 15:06:38

Changing component from number fields to algebra.


---

Comment by jdemeyer created at 2014-01-06 10:16:36

Conflicts with #2217.


---

Comment by jdemeyer created at 2014-01-06 10:16:36

Changing status from needs_review to needs_work.


---

Comment by pbruin created at 2014-01-06 23:23:38

Changing status from needs_work to needs_review.


---

Comment by pbruin created at 2014-01-06 23:23:38

The `map` option now also works for finite fields, based on a new method `FiniteFieldHomset._an_element_()`.
----
New commits:


---

Comment by jdemeyer created at 2014-01-07 10:16:49

You should add doctests for the `map` parameter in `extension`.


---

Comment by jdemeyer created at 2014-01-07 10:16:56

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-01-07 22:50:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pbruin created at 2014-01-07 22:50:31

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2014-01-08 09:28:50

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-01-16 05:10:52

Resolution: fixed
