# Issue 13207: Add a splitting field function for polynomials over a finite field

archive/issues_013207.json:
```json
{
    "body": "Assignee: @loefflerd\n\nCC:  @mmasdeu @jdemeyer\n\nThe purpose of this patch is to add the splitting_field() function to polynomial elements with coefficients in a finite field. For coherence purpose, I copied the syntax of the patch proposed for ticket #2217 (hope it's ok), which is about splitting field for polynomial over number fields. Some of the argument are not used in the function, but again, it is for the overall coherence in case of integration of both patches.\n\nIssue created by migration from https://trac.sagemath.org/ticket/13379\n\n",
    "created_at": "2012-08-18T17:43:29Z",
    "labels": [
        "number fields",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.1",
    "title": "Add a splitting field function for polynomials over a finite field",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13207",
    "user": "@abrochard"
}
```
Assignee: @loefflerd

CC:  @mmasdeu @jdemeyer

The purpose of this patch is to add the splitting_field() function to polynomial elements with coefficients in a finite field. For coherence purpose, I copied the syntax of the patch proposed for ticket #2217 (hope it's ok), which is about splitting field for polynomial over number fields. Some of the argument are not used in the function, but again, it is for the overall coherence in case of integration of both patches.

Issue created by migration from https://trac.sagemath.org/ticket/13379





---

archive/issue_comments_161469.json:
```json
{
    "body": "Attachment [trac_13379_splitting_field.patch](tarball://root/attachments/some-uuid/ticket13379/trac_13379_splitting_field.patch) by @abrochard created at 2012-08-18 17:48:09",
    "created_at": "2012-08-18T17:48:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161469",
    "user": "@abrochard"
}
```

Attachment [trac_13379_splitting_field.patch](tarball://root/attachments/some-uuid/ticket13379/trac_13379_splitting_field.patch) by @abrochard created at 2012-08-18 17:48:09



---

archive/issue_comments_161470.json:
```json
{
    "body": "Is this waiting on something, or should it be marked as needs review?",
    "created_at": "2012-09-17T05:30:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161470",
    "user": "@roed314"
}
```

Is this waiting on something, or should it be marked as needs review?



---

archive/issue_comments_161471.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-09-17T11:29:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161471",
    "user": "@abrochard"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_161472.json:
```json
{
    "body": "I haven't taken a look, but I'll just note that there are some whitespace issues: you added a TAB character in polynomial_element.pyx and there's trailing whitespace as well.  See the report from the patchbot.",
    "created_at": "2012-10-15T08:05:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161472",
    "user": "@roed314"
}
```

I haven't taken a look, but I'll just note that there are some whitespace issues: you added a TAB character in polynomial_element.pyx and there's trailing whitespace as well.  See the report from the patchbot.



---

archive/issue_comments_161473.json:
```json
{
    "body": "For p a prime and q = p<sup>n</sup>, the field F<sub>q</sub> is Galois over F<sub>p</sub>, i.e. it is the splitting field of any irreducible polynomial of degree n over F<sub>p</sub>. Moreover, the field with p<sup>n</sup> elements contains the one with p<sup>m</sup> elements if and only if m divides n. Thus, starting from a polynomial over F<sub>p</sub>, the splitting field is simply given by taking the lcm of the degrees of the factors. This would be quicker than what you are doing. If you start with a polynomial over F<sub>q</sub>, a simple modification of what I've said would work too.",
    "created_at": "2013-03-14T07:27:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161473",
    "user": "@rharron"
}
```

For p a prime and q = p<sup>n</sup>, the field F<sub>q</sub> is Galois over F<sub>p</sub>, i.e. it is the splitting field of any irreducible polynomial of degree n over F<sub>p</sub>. Moreover, the field with p<sup>n</sup> elements contains the one with p<sup>m</sup> elements if and only if m divides n. Thus, starting from a polynomial over F<sub>p</sub>, the splitting field is simply given by taking the lcm of the degrees of the factors. This would be quicker than what you are doing. If you start with a polynomial over F<sub>q</sub>, a simple modification of what I've said would work too.



---

archive/issue_comments_161474.json:
```json
{
    "body": "I think that the whole point is to return an embedding of F<sub>q</sub> into its splitting field. For that, one has to be careful when constructing the extensions: either choosing the given polynomial (or a factor of it) to define the extension, or using some root finding algorithm.\n\nAlso, the patch fails in the last couple of Sage releases...\n\nReplying to [comment:5 robharron]:\n> For p a prime and q = p<sup>n</sup>, the field F<sub>q</sub> is Galois over F<sub>p</sub>, i.e. it is the splitting field of any irreducible polynomial of degree n over F<sub>p</sub>. Moreover, the field with p<sup>n</sup> elements contains the one with p<sup>m</sup> elements if and only if m divides n. Thus, starting from a polynomial over F<sub>p</sub>, the splitting field is simply given by taking the lcm of the degrees of the factors. This would be quicker than what you are doing. If you start with a polynomial over F<sub>q</sub>, a simple modification of what I've said would work too.",
    "created_at": "2013-03-14T22:24:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161474",
    "user": "@mmasdeu"
}
```

I think that the whole point is to return an embedding of F<sub>q</sub> into its splitting field. For that, one has to be careful when constructing the extensions: either choosing the given polynomial (or a factor of it) to define the extension, or using some root finding algorithm.

Also, the patch fails in the last couple of Sage releases...

Replying to [comment:5 robharron]:
> For p a prime and q = p<sup>n</sup>, the field F<sub>q</sub> is Galois over F<sub>p</sub>, i.e. it is the splitting field of any irreducible polynomial of degree n over F<sub>p</sub>. Moreover, the field with p<sup>n</sup> elements contains the one with p<sup>m</sup> elements if and only if m divides n. Thus, starting from a polynomial over F<sub>p</sub>, the splitting field is simply given by taking the lcm of the degrees of the factors. This would be quicker than what you are doing. If you start with a polynomial over F<sub>q</sub>, a simple modification of what I've said would work too.



---

archive/issue_comments_161475.json:
```json
{
    "body": "But have you looked at the code? It doesn't do anything special with regards to the embedding. (Do you see something I don't?) In the end it simply says F.Hom(K)[0] (for instance, I think the code only runs when the polynomial is defined over a prime field, in which case the embedding returned is simply the canonical one sending 1 to 1). I just quickly wrote a function that does what I suggested and it works just fine and is quite quick.\n\nReplying to [comment:6 mmasdeu]:\n> I think that the whole point is to return an embedding of F<sub>q</sub> into its splitting field. For that, one has to be careful when constructing the extensions: either choosing the given polynomial (or a factor of it) to define the extension, or using some root finding algorithm.\n> \n> Also, the patch fails in the last couple of Sage releases...\n> \n> Replying to [comment:5 robharron]:\n> > For p a prime and q = p<sup>n</sup>, the field F<sub>q</sub> is Galois over F<sub>p</sub>, i.e. it is the splitting field of any irreducible polynomial of degree n over F<sub>p</sub>. Moreover, the field with p<sup>n</sup> elements contains the one with p<sup>m</sup> elements if and only if m divides n. Thus, starting from a polynomial over F<sub>p</sub>, the splitting field is simply given by taking the lcm of the degrees of the factors. This would be quicker than what you are doing. If you start with a polynomial over F<sub>q</sub>, a simple modification of what I've said would work too.",
    "created_at": "2013-03-15T04:45:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161475",
    "user": "@rharron"
}
```

But have you looked at the code? It doesn't do anything special with regards to the embedding. (Do you see something I don't?) In the end it simply says F.Hom(K)[0] (for instance, I think the code only runs when the polynomial is defined over a prime field, in which case the embedding returned is simply the canonical one sending 1 to 1). I just quickly wrote a function that does what I suggested and it works just fine and is quite quick.

Replying to [comment:6 mmasdeu]:
> I think that the whole point is to return an embedding of F<sub>q</sub> into its splitting field. For that, one has to be careful when constructing the extensions: either choosing the given polynomial (or a factor of it) to define the extension, or using some root finding algorithm.
> 
> Also, the patch fails in the last couple of Sage releases...
> 
> Replying to [comment:5 robharron]:
> > For p a prime and q = p<sup>n</sup>, the field F<sub>q</sub> is Galois over F<sub>p</sub>, i.e. it is the splitting field of any irreducible polynomial of degree n over F<sub>p</sub>. Moreover, the field with p<sup>n</sup> elements contains the one with p<sup>m</sup> elements if and only if m divides n. Thus, starting from a polynomial over F<sub>p</sub>, the splitting field is simply given by taking the lcm of the degrees of the factors. This would be quicker than what you are doing. If you start with a polynomial over F<sub>q</sub>, a simple modification of what I've said would work too.



---

archive/issue_comments_161476.json:
```json
{
    "body": "Yes, I agree that for polynomials defined over F<sub>p</sub> the function should be simplified. As for F<sub>q</sub> one definitely needs to fix the code, since that calling of Hom won't work...\n\nReplying to [comment:7 robharron]:\n> But have you looked at the code? It doesn't do anything special with regards to the embedding. (Do you see something I don't?) In the end it simply says F.Hom(K)[0] (for instance, I think the code only runs when the polynomial is defined over a prime field, in which case the embedding returned is simply the canonical one sending 1 to 1). I just quickly wrote a function that does what I suggested and it works just fine and is quite quick.\n> \n> Replying to [comment:6 mmasdeu]:\n> > I think that the whole point is to return an embedding of F<sub>q</sub> into its splitting field. For that, one has to be careful when constructing the extensions: either choosing the given polynomial (or a factor of it) to define the extension, or using some root finding algorithm.\n> > \n> > Also, the patch fails in the last couple of Sage releases...\n> > \n> > Replying to [comment:5 robharron]:\n> > > For p a prime and q = p<sup>n</sup>, the field F<sub>q</sub> is Galois over F<sub>p</sub>, i.e. it is the splitting field of any irreducible polynomial of degree n over F<sub>p</sub>. Moreover, the field with p<sup>n</sup> elements contains the one with p<sup>m</sup> elements if and only if m divides n. Thus, starting from a polynomial over F<sub>p</sub>, the splitting field is simply given by taking the lcm of the degrees of the factors. This would be quicker than what you are doing. If you start with a polynomial over F<sub>q</sub>, a simple modification of what I've said would work too.",
    "created_at": "2013-03-17T21:44:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161476",
    "user": "@mmasdeu"
}
```

Yes, I agree that for polynomials defined over F<sub>p</sub> the function should be simplified. As for F<sub>q</sub> one definitely needs to fix the code, since that calling of Hom won't work...

Replying to [comment:7 robharron]:
> But have you looked at the code? It doesn't do anything special with regards to the embedding. (Do you see something I don't?) In the end it simply says F.Hom(K)[0] (for instance, I think the code only runs when the polynomial is defined over a prime field, in which case the embedding returned is simply the canonical one sending 1 to 1). I just quickly wrote a function that does what I suggested and it works just fine and is quite quick.
> 
> Replying to [comment:6 mmasdeu]:
> > I think that the whole point is to return an embedding of F<sub>q</sub> into its splitting field. For that, one has to be careful when constructing the extensions: either choosing the given polynomial (or a factor of it) to define the extension, or using some root finding algorithm.
> > 
> > Also, the patch fails in the last couple of Sage releases...
> > 
> > Replying to [comment:5 robharron]:
> > > For p a prime and q = p<sup>n</sup>, the field F<sub>q</sub> is Galois over F<sub>p</sub>, i.e. it is the splitting field of any irreducible polynomial of degree n over F<sub>p</sub>. Moreover, the field with p<sup>n</sup> elements contains the one with p<sup>m</sup> elements if and only if m divides n. Thus, starting from a polynomial over F<sub>p</sub>, the splitting field is simply given by taking the lcm of the degrees of the factors. This would be quicker than what you are doing. If you start with a polynomial over F<sub>q</sub>, a simple modification of what I've said would work too.



---

archive/issue_comments_161477.json:
```json
{
    "body": "No, for F<sub>q</sub> the calling of Hom works:\n\n\n```\nsage: F = GF(3^4, 'z')\nsage: K = GF(3^12, 'zz')\nsage: F.Hom(K)\nSet of field embeddings from Finite Field in z of size 3^4 to Finite Field in zz of size 3^12\nsage: F.Hom(K)[0]\nRing morphism:\n  From: Finite Field in z of size 3^4\n  To:   Finite Field in zz of size 3^12\n  Defn: z |--> 2*zz^10 + zz^8 + 2*zz^7 + zz^6 + 2*zz^5 + zz^4 + 2*zz^3 + 2*zz^2 + zz + 2\n```\n\n\nThe problem over F<sub>q</sub> is elsewhere: some coercion problem when calling poly.change_ring().\n\nReplying to [comment:8 mmasdeu]:\n> Yes, I agree that for polynomials defined over F<sub>p</sub> the function should be simplified. As for F<sub>q</sub> one definitely needs to fix the code, since that calling of Hom won't work...\n> \n> Replying to [comment:7 robharron]:\n> > But have you looked at the code? It doesn't do anything special with regards to the embedding. (Do you see something I don't?) In the end it simply says F.Hom(K)[0] (for instance, I think the code only runs when the polynomial is defined over a prime field, in which case the embedding returned is simply the canonical one sending 1 to 1). I just quickly wrote a function that does what I suggested and it works just fine and is quite quick.",
    "created_at": "2013-03-17T22:46:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161477",
    "user": "@rharron"
}
```

No, for F<sub>q</sub> the calling of Hom works:


```
sage: F = GF(3^4, 'z')
sage: K = GF(3^12, 'zz')
sage: F.Hom(K)
Set of field embeddings from Finite Field in z of size 3^4 to Finite Field in zz of size 3^12
sage: F.Hom(K)[0]
Ring morphism:
  From: Finite Field in z of size 3^4
  To:   Finite Field in zz of size 3^12
  Defn: z |--> 2*zz^10 + zz^8 + 2*zz^7 + zz^6 + 2*zz^5 + zz^4 + 2*zz^3 + 2*zz^2 + zz + 2
```


The problem over F<sub>q</sub> is elsewhere: some coercion problem when calling poly.change_ring().

Replying to [comment:8 mmasdeu]:
> Yes, I agree that for polynomials defined over F<sub>p</sub> the function should be simplified. As for F<sub>q</sub> one definitely needs to fix the code, since that calling of Hom won't work...
> 
> Replying to [comment:7 robharron]:
> > But have you looked at the code? It doesn't do anything special with regards to the embedding. (Do you see something I don't?) In the end it simply says F.Hom(K)[0] (for instance, I think the code only runs when the polynomial is defined over a prime field, in which case the embedding returned is simply the canonical one sending 1 to 1). I just quickly wrote a function that does what I suggested and it works just fine and is quite quick.



---

archive/issue_comments_161478.json:
```json
{
    "body": "Attachment [trac_13379-splitting_field_new.patch](tarball://root/attachments/some-uuid/ticket13379/trac_13379-splitting_field_new.patch) by @pjbruin created at 2013-08-06 14:51:07\n\nrewritten, based on 5.11.rc0 + #8335",
    "created_at": "2013-08-06T14:51:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161478",
    "user": "@pjbruin"
}
```

Attachment [trac_13379-splitting_field_new.patch](tarball://root/attachments/some-uuid/ticket13379/trac_13379-splitting_field_new.patch) by @pjbruin created at 2013-08-06 14:51:07

rewritten, based on 5.11.rc0 + #8335



---

archive/issue_comments_161479.json:
```json
{
    "body": "I was going to review this, but ended up wanting to change almost everything, so here is a new version.  The doctests are the same as in the original, up to cosmetic changes.\n\nThe new implementation of this function is very short, as suggested by the above comments.  It just computes the degree of the splitting field over the base field, and then calls the `FiniteField_base.extension()` method implemented by #8335.\n\nThe `map` flag from the original patch is currently not understood, but for more flexibility, any additional arguments are now passed to `FiniteField_base.extension()`, which would be the right place to implement the `map` parameter.\n\nThe currently unused parameters have been removed; this ticket will probably be merged before #2217, and that one might change dramatically for all we know.",
    "created_at": "2013-08-06T15:06:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161479",
    "user": "@pjbruin"
}
```

I was going to review this, but ended up wanting to change almost everything, so here is a new version.  The doctests are the same as in the original, up to cosmetic changes.

The new implementation of this function is very short, as suggested by the above comments.  It just computes the degree of the splitting field over the base field, and then calls the `FiniteField_base.extension()` method implemented by #8335.

The `map` flag from the original patch is currently not understood, but for more flexibility, any additional arguments are now passed to `FiniteField_base.extension()`, which would be the right place to implement the `map` parameter.

The currently unused parameters have been removed; this ticket will probably be merged before #2217, and that one might change dramatically for all we know.



---

archive/issue_comments_161480.json:
```json
{
    "body": "Changing component from number fields to algebra.",
    "created_at": "2013-08-06T15:06:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161480",
    "user": "@pjbruin"
}
```

Changing component from number fields to algebra.



---

archive/issue_comments_161481.json:
```json
{
    "body": "Conflicts with #2217.",
    "created_at": "2014-01-06T10:16:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161481",
    "user": "@jdemeyer"
}
```

Conflicts with #2217.



---

archive/issue_comments_161482.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-01-06T10:16:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161482",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_161483.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-01-06T23:23:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161483",
    "user": "@pjbruin"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_161484.json:
```json
{
    "body": "The `map` option now also works for finite fields, based on a new method `FiniteFieldHomset._an_element_()`.\n----\nNew commits:",
    "created_at": "2014-01-06T23:23:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161484",
    "user": "@pjbruin"
}
```

The `map` option now also works for finite fields, based on a new method `FiniteFieldHomset._an_element_()`.
----
New commits:



---

archive/issue_comments_161485.json:
```json
{
    "body": "You should add doctests for the `map` parameter in `extension`.",
    "created_at": "2014-01-07T10:16:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161485",
    "user": "@jdemeyer"
}
```

You should add doctests for the `map` parameter in `extension`.



---

archive/issue_comments_161486.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-01-07T10:16:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161486",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_161487.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-01-07T22:50:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161487",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_161488.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-01-07T22:50:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161488",
    "user": "@pjbruin"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_161489.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-01-08T09:28:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161489",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_161490.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-01-16T05:10:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13207#issuecomment-161490",
    "user": "@vbraun"
}
```

Resolution: fixed
