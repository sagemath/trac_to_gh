# Issue 13190: Fix bug in build_flow_graph

Issue created by migration from Trac.

Original creator: dcoudert

Original creation time: 2012-08-13 12:14:30

Assignee: jason, ncohen, rlm

CC:  ncohen

The function `build_flow_graph` (called by the `flow` function) contains a

```
g.set_edge_label(l)
```

instead of

```
g.set_edge_label(sp[i],sp[i+1],l) 
```

where ``l`` is a number.



---

Comment by dcoudert created at 2012-08-13 12:17:47

Changing status from new to needs_review.


---

Comment by dcoudert created at 2012-08-13 12:18:25

Changing type from PLEASE CHANGE to defect.


---

Comment by dcoudert created at 2012-08-13 14:34:29

The patch is working for both sage-5.3.beta0 and sage-5.3.beta1.


---

Comment by kini created at 2012-08-14 05:21:36

It looks like the call you replaced is just completely broken and would throw `TypeError` when executed. I assume that this wasn't caught by a doctest. Could you write a doctest which goes through this code path?


---

Comment by dcoudert created at 2012-08-14 08:43:35

It wasn't in the doctests. In fact the existence of 0-cost cycles in flows depends on the LP solver and the instance. Some LP solver simplifies the solution returning the minimum possible number of non zero variables.

I added some very artificial doctests, but it does the job.


---

Attachment

with doctests


---

Comment by dcoudert created at 2012-08-14 09:58:13

every lines of the `_build_flow_graph` method have trailing white spaces. This is super boring!!! I have only removed those from edited lines, but I'm eager to remove all of them...


---

Comment by ncohen created at 2012-09-20 13:23:07

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2012-09-20 13:23:07

Well, then if doctests pass and the bug is fixed... `:-)`

Nathann


---

Comment by jdemeyer created at 2012-09-23 16:22:20

Resolution: fixed
