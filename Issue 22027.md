# Issue 22027: Improve Sandpiles thematic tutorial

Issue created by migration from https://trac.sagemath.org/ticket/22264

Original creator: tscrim

Original creation time: 2017-01-26 18:40:55

CC:  dperkinson

Keywords: beginner

There are a number of things that could use some polish. This is just to fix the issues I see.


---

Comment by tscrim created at 2017-01-26 18:41:38

New commits:


---

Comment by tscrim created at 2017-01-26 18:41:38

Changing status from new to needs_review.


---

Comment by git created at 2017-03-27 22:26:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2017-03-27 22:27:40

Some changes made, more to come...


---

Comment by git created at 2017-03-27 22:28:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2017-03-27 22:29:52


```
The *minimal burning configuration* is the one with the minimal script (its
components are no larger than the components of any other script for a burning
configuration).
```


Does the "no larger" mean "less or equal", or does it really mean "not larger"? (Due to the tacit all-quantor here, this makes a difference.)


```
The following are equivalent for a configuration `c` with burning
configuration `b` having script `\sigma`:

- `c` is recurrent;
- `c + b` stabilizes to `c`;
- the firing vector for the stabilization of `c + b` is `\sigma`.
```

Am I seeing it right that the b has nothing to do with c? Because the "with" suggests that it does, but I'm not sure what...


---

Comment by tscrim created at 2017-03-27 23:23:52

Two things I see from a quick look:

- Instead of `\mathbb{Z`} use `\ZZ`.
- I think `every vertex is accessible from some vertex in its support.` is ambiguous, in contrast saying there is a path.

For comment:5. I don't see the difference since I am interpreting it as something compared component-by-component. My guess is that `b` is related to `c` by the underlying graph. So they are not quite completely separate.


---

Comment by darij created at 2017-03-28 04:29:48

Thanks! The "accessible" is defined further above in that .rst file, so I thought it makes sense. But I'll add both wordings.

Yes, b and c have nothing to do with each other, as I've just found out from http://www.dam.brown.edu/people/cklivans/Dynkin.pdf . And the "no larger" is indeed componentwise (Theorem 2.28 in https://arxiv.org/pdf/1112.6163.pdf ). I will clarify these tomorrow when I am back on a Linux machine.


---

Comment by git created at 2017-03-28 17:09:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2017-03-28 17:24:33

I don't understand what `is_alive` does (the example isn't definitive here). The doc is also not quite clear (what is "the resulting cycle"?).

Also, how can this be true?

```
The *zero set* for the sandpile ideal `I` is

.. MATH::

    Z(I) = \{p\in\CC^n: f(p)=0\mbox{ for all $f\in I$}\},

the set of simultaneous zeros of the polynomials in `I`.  Letting `S^1` denote
the unit circle in the complex plane, `Z(I)` is a finite
subgroup of `S^1 \times \cdots \times S^1 \subset \CC^n`
```

The circle `S^1` is not a subvariety of `\CC` in the sense of algebraic geometry over `\CC`...


---

Comment by git created at 2017-03-28 17:25:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2017-03-28 17:34:38

I'm done with my review of everything up until the "methods" section. What remains are the two questions in comment:10; also, what exactly is the Tutte polynomial?


---

Comment by git created at 2017-03-28 17:34:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-05-21 02:08:06

ping


---

Comment by tscrim created at 2017-05-21 02:09:52

Wait, that's a ping to myself...

The short answer is I have no idea. I was just trying to clean it a little bit.


---

Comment by tscrim created at 2017-10-26 00:20:20

Could we just consider this an improvement and deal with further stuff (which was previously there) on later tickets?


---

Comment by git created at 2017-11-21 21:46:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2017-11-21 21:47:27

Thanks to Gregg Musiker for suggesting me to consult Dave's "primer" for missing definitions. One more step towards a review (comment:10 and comment:12 are dealt with).

EDIT: I've now looked through all parts you've changed, so it should be a positive_review if you are fine with my changes. But I'll take one final look at this tonight.


---

Comment by git created at 2017-11-22 00:33:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-11-22 01:28:16

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2017-11-22 01:28:16

LGTM. Thanks.


---

Comment by vbraun created at 2017-12-04 00:46:03

Docs don't build


---

Comment by vbraun created at 2017-12-04 00:46:03

Changing status from positive_review to needs_work.


---

Comment by git created at 2017-12-04 23:41:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2017-12-04 23:42:01

Changing status from needs_work to positive_review.


---

Comment by darij created at 2017-12-04 23:42:01

Does this mean the docbuilder doesn't look for references in `src/doc/en/reference/references/index.rst`? Every time I think Sphinx cannot get any more stupid I get proven wrong.

Anyway, I've added the reference to the local bibliography. It should work now.


---

Comment by jhpalmieri created at 2017-12-05 01:30:40

Replying to [comment:24 darij]:
> Does this mean the docbuilder doesn't look for references in `src/doc/en/reference/references/index.rst`? 

When building the reference manual, yes, but when building other pieces of the documentation, no.


---

Comment by vbraun created at 2017-12-08 08:06:30

See patchbot


---

Comment by vbraun created at 2017-12-08 08:06:30

Changing status from positive_review to needs_work.


---

Comment by git created at 2017-12-08 16:21:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2017-12-08 16:22:09

Changing status from needs_work to positive_review.


---

Comment by darij created at 2017-12-08 16:22:09

And I thought we were becoming unicode-compatible with py3 :)


---

Comment by vbraun created at 2017-12-09 14:58:04


```
sage -t --long --warn-long 64.0 src/sage/sandpiles/sandpile.py
**********************************************************************
File "src/sage/sandpiles/sandpile.py", line 387, in sage.sandpiles.sandpile.Sandpile.help
Failed example:
    Sandpile.help() # long time
Expected:
    For detailed help with any method FOO listed below,
    enter "Sandpile.FOO?" or enter "S.FOO?" for any Sandpile S.
    <BLANKLINE>
    all_k_config             -- The constant configuration with all values set to k.
    all_k_div                -- The divisor with all values set to k.
    avalanche_polynomial     -- The avalanche polynomial.
    betti                    -- The Betti table for the homogeneous toppling ideal.
    betti_complexes          -- The support-complexes with non-trivial homology.
    burning_config           -- The minimal burning configuration.
    burning_script           -- A script for the minimal burning configuration.
    canonical_divisor        -- The canonical divisor.
    dict                     -- A dictionary of dictionaries representing a directed graph.
    genus                    -- The genus: (# non-loop edges) - (# vertices) + 1.
    groebner                 -- A Groebner basis for the homogeneous toppling ideal.
    group_gens               -- A minimal list of generators for the sandpile group.
    group_order              -- The size of the sandpile group.
    h_vector                 -- The number of superstable configurations in each degree.
    help                     -- List of Sandpile-specific methods (not inherited from Graph).
    hilbert_function         -- The Hilbert function of the homogeneous toppling ideal.
    ideal                    -- The saturated homogeneous toppling ideal.
    identity                 -- The identity configuration.
    in_degree                -- The in-degree of a vertex or a list of all in-degrees.
    invariant_factors        -- The invariant factors of the sandpile group.
    is_undirected            -- Is the underlying graph undirected?
    jacobian_representatives -- Representatives for the elements of the Jacobian group.
    laplacian                -- The Laplacian matrix of the graph.
    markov_chain             -- The sandpile Markov chain for configurations or divisors.
    max_stable               -- The maximal stable configuration.
    max_stable_div           -- The maximal stable divisor.
    max_superstables         -- The maximal superstable configurations.
    min_recurrents           -- The minimal recurrent elements.
    nonsink_vertices         -- The nonsink vertices.
    nonspecial_divisors      -- The nonspecial divisors.
    out_degree               -- The out-degree of a vertex or a list of all out-degrees.
    picard_representatives   -- Representatives of the divisor classes of degree d in the Picard group.
    points                   -- Generators for the multiplicative group of zeros of the sandpile ideal.
    postulation              -- The postulation number of the toppling ideal.
    recurrents               -- The recurrent configurations.
    reduced_laplacian        -- The reduced Laplacian matrix of the graph.
    reorder_vertices         -- A copy of the sandpile with vertex names permuted.
    resolution               -- A minimal free resolution of the homogeneous toppling ideal.
    ring                     -- The ring containing the homogeneous toppling ideal.
    show                     -- Draw the underlying graph.
    show3d                   -- Draw the underlying graph.
    sink                     -- The sink vertex.
    smith_form               -- The Smith normal form for the Laplacian.
    solve                    -- Approximations of the complex affine zeros of the sandpile ideal.
    stable_configs           -- Generator for all stable configurations.
    stationary_density       -- The stationary density of the sandpile.
    superstables             -- The superstable configurations.
    symmetric_recurrents     -- The symmetric recurrent configurations.
    tutte_polynomial         -- The Tutte polynomial.
    unsaturated_ideal        -- The unsaturated, homogeneous toppling ideal.
    version                  -- The version number of Sage Sandpiles.
    zero_config              -- The all-zero configuration.
    zero_div                 -- The all-zero divisor.
Got:
    For detailed help with any method FOO listed below,
    enter "Sandpile.FOO?" or enter "S.FOO?" for any Sandpile S.
    <BLANKLINE>
    all_k_config             -- The constant configuration with all values set to k.
    all_k_div                -- The divisor with all values set to k.
    avalanche_polynomial     -- The avalanche polynomial.
    betti                    -- The Betti table for the homogeneous toppling ideal.
    betti_complexes          -- The support-complexes with non-trivial homology.
    burning_config           -- The minimal burning configuration.
    burning_script           -- A script for the minimal burning configuration.
    canonical_divisor        -- The canonical divisor.
    dict                     -- A dictionary of dictionaries representing a directed graph.
    genus                    -- The genus: (# non-loop edges) - (# vertices) + 1.
    groebner                 -- A Groebner basis for the homogeneous toppling ideal.
    group_gens               -- A minimal list of generators for the sandpile group.
    group_order              -- The size of the sandpile group.
    h_vector                 -- The number of superstable configurations in each degree.
    help                     -- List of Sandpile-specific methods (not inherited from Graph).
    hilbert_function         -- The Hilbert function of the homogeneous toppling ideal.
    ideal                    -- The saturated homogeneous toppling ideal.
    identity                 -- The identity configuration.
    in_degree                -- The in-degree of a vertex or a list of all in-degrees.
    invariant_factors        -- The invariant factors of the sandpile group.
    is_undirected            -- Is the underlying graph undirected?
    jacobian_representatives -- Representatives for the elements of the Jacobian group.
    laplacian                -- The Laplacian matrix of the graph.
    markov_chain             -- The sandpile Markov chain for configurations or divisors.
    max_stable               -- The maximal stable configuration.
    max_stable_div           -- The maximal stable divisor.
    max_superstables         -- The maximal superstable configurations.
    min_recurrents           -- The minimal recurrent elements.
    nonsink_vertices         -- The nonsink vertices.
    nonspecial_divisors      -- The nonspecial divisors.
    out_degree               -- The out-degree of a vertex or a list of all out-degrees.
    picard_representatives   -- Representatives of the divisor classes of degree d in the Picard group.
    points                   -- Generators for the multiplicative group of zeros of the sandpile ideal.
    postulation              -- The postulation number of the toppling ideal.
    recurrents               -- The recurrent configurations.
    reduced_laplacian        -- The reduced Laplacian matrix of the graph.
    reorder_vertices         -- A copy of the sandpile with vertex names permuted.
    resolution               -- A minimal free resolution of the homogeneous toppling ideal.
    ring                     -- The ring containing the homogeneous toppling ideal.
    show                     -- Draw the underlying graph.
    show3d                   -- Draw the underlying graph.
    sink                     -- The sink vertex.
    smith_form               -- The Smith normal form for the Laplacian.
    solve                    -- Approximations of the complex affine zeros of the sandpile ideal.
    stable_configs           -- Generator for all stable configurations.
    stationary_density       -- The stationary density of the sandpile.
    superstables             -- The superstable configurations.
    symmetric_recurrents     -- The symmetric recurrent configurations.
    tutte_polynomial         -- The Tutte polynomial of the underlying graph.
    unsaturated_ideal        -- The unsaturated, homogeneous toppling ideal.
    version                  -- The version number of Sage Sandpiles.
    zero_config              -- The all-zero configuration.
    zero_div                 -- The all-zero divisor.
**********************************************************************
```



---

Comment by vbraun created at 2017-12-09 14:58:04

Changing status from positive_review to needs_work.


---

Comment by git created at 2017-12-09 23:14:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2017-12-09 23:32:25

Alright, let's see now.


---

Comment by darij created at 2017-12-09 23:32:25

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2017-12-11 08:05:53

Still fails


---

Comment by vbraun created at 2017-12-11 08:05:53

Changing status from positive_review to needs_work.


---

Comment by git created at 2017-12-11 08:41:43

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-12-11 08:42:47

This should fix the doctests output because I explicitly copied the expected output. I also enabled utf8 encoding on the thematic tutorial and put back the unicode characters.


---

Comment by tscrim created at 2017-12-11 08:42:47

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2017-12-11 09:49:50

"Should fix" or "I tested that it fixes"?


---

Comment by vbraun created at 2017-12-11 09:49:50

Changing status from positive_review to needs_info.


---

Comment by tscrim created at 2017-12-11 12:41:34

"I tested that it fixes" on my machine. :)


---

Comment by tscrim created at 2017-12-11 12:41:34

Changing status from needs_info to positive_review.


---

Comment by vbraun created at 2017-12-16 09:49:16

Resolution: fixed
