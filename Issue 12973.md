# Issue 12973: Sage's noncommutive rings don't always increment a refcount

Issue created by migration from Trac.

Original creator: roed

Original creation time: 2012-06-21 05:12:48

Assignee: malb

CC:  simonking malb

Running doctests with the new doctest framework revealed that KeyErrors were being ignored in `sage.lib.singular.ring.singular_ring_delete`.  The included patch fixes the problem, but I need to add doctests.


---

Attachment


---

Comment by roed created at 2012-06-21 18:35:19

Changing status from new to needs_review.


---

Comment by roed created at 2012-06-25 18:33:51

My fixes apparently aren't enough: I'm picking up more failures now.


---

Comment by roed created at 2012-06-25 18:33:51

Changing status from needs_review to needs_work.


---

Comment by roed created at 2012-07-07 07:06:06

Changing status from needs_work to needs_review.


---

Comment by roed created at 2012-07-07 07:06:06

Somehow the problems went away with further changes in the doctest framework.  I'm not convinced that no problems remain in this area, but I'm going to return this to "Needs review" for now.


---

Comment by jhpalmieri created at 2012-08-23 21:55:21

Simon: any opinions?


---

Comment by roed created at 2012-09-01 03:36:22

I'm going to make another push to finish #12415.  If this could get reviewed sometime in the next week that would be great.  I'm not sure if the changes here address all of the issues in deallocating singular objects, but I think it's an improvement and can go in.


---

Comment by malb created at 2012-09-01 10:43:21

Changing status from needs_review to positive_review.


---

Comment by malb created at 2012-09-01 10:43:21

Patch looks good to me.


---

Comment by jdemeyer created at 2012-09-02 21:46:03

Changing priority from minor to critical.


---

Comment by jdemeyer created at 2012-09-02 21:46:03

Thanks!


---

Comment by jdemeyer created at 2012-09-04 17:15:42

Resolution: fixed


---

Comment by SimonKing created at 2012-09-15 18:02:04

Question: Wouldn't it be better to follow the approach in #13447? Hence, drop the ring_refcount_dict altogether?


---

Comment by SimonKing created at 2012-09-17 17:10:19

For the record: Since this ticket is already merged, I made it an indirect dependency of #13447, which is now ready for review. #13447 removes the ring_refcount_dict.
