# Issue 24712: Bug in p-adic expansion over ramified extensions

Issue created by migration from https://trac.sagemath.org/ticket/24949

Original creator: caruso

Original creation time: 2018-03-11 17:12:40

CC:  roed saraedum

Keywords: expansion normalize


```
sage: R.<a> = Zp(2).extension(x^10 + 2)
sage: x = R(a^4 + a^5)
sage: y = R(a^2 + a^3)
sage: z = x - y^2
sage: z.expansion(4)
Traceback (most recent call last):
...
PrecisionError:

sage: z
a^5 + a^6 + a^15 + a^16 + O(a^204)
sage: z.expansion(4)
0
```



---

Comment by roed created at 2018-07-22 20:51:16

Changing keywords from "expansion normalize" to "expansion normalize, padicIMA".


---

Comment by caruso created at 2022-06-02 20:32:09

Changing status from new to needs_review.


---

Comment by caruso created at 2022-06-02 20:32:09

Adding a call to `_normalize()' seems to fix the bug.
----
New commits:


---

Comment by git created at 2022-06-02 20:33:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by roed created at 2022-06-02 21:06:08

Positive review once tests pass.


---

Comment by roed created at 2022-06-03 00:39:24

It looks like there's an infinite recursion test failure....


---

Comment by git created at 2022-06-03 14:16:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by caruso created at 2022-06-03 14:17:57

The problem comes from conversion between padic when p changes:


```
sage: Zp(2)(Zp(5)(1))
Traceback (most recent call last):
...
RecursionError
```


It is fixed by the latest commit.
----
New commits:


---

Comment by roed created at 2022-06-03 18:18:01

Changing status from needs_review to positive_review.


---

Comment by roed created at 2022-06-03 18:18:01

The docbuild error is `/home/sagemath/sage/src/doc/en/reference/spkg/libspatialindex.rst: WARNING: document isn't included in any toctree`, which has nothing to do with this ticket.


---

Comment by vbraun created at 2022-06-12 12:17:19

Resolution: fixed
