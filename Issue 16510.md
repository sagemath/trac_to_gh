# Issue 16510: Add optional Arb package (arbitrary-precision floating-point ball arithmetic)

Issue created by migration from https://trac.sagemath.org/ticket/16747

Original creator: ktkohl

Original creation time: 2014-07-31 15:42:30

CC:  alina fredrik.johansson mmezzarobba

Add Arb [http://fredrikj.net/arb/](http://fredrikj.net/arb/) as an optional/experimental package.
Source code here:  [https://github.com/fredrik-johansson/arb/archive/master.zip](https://github.com/fredrik-johansson/arb/archive/master.zip)


---

Comment by ktkohl created at 2014-07-31 23:11:21

How do I get the arb-2.2.tar.bz2 to be part of the commit?
----
New commits:


---

Comment by cheuberg created at 2014-08-08 13:03:22

I modified the patch:

- use the .tar.gz file from github with version number instead of unversioned .zip file
- use Sage's versions of flint, mpfr, gmp in building the package (if there is no version of one of those in the system paths, then the optional package won't compile).
- Set package version to 2.2.0 to match the name of the top level directory of the .tar.gz file so that no renaming to src is necessary.

In that version, it compiles for me.

Are you planning to provide and include python bindings for the library?
----
New commits:


---

Comment by cheuberg created at 2014-09-01 16:10:54

Replying to [comment:4 ktkohl]:
> How do I get the arb-2.2.tar.bz2 to be part of the commit?

In the [developer guide](http://www.sagemath.org/doc/developer/packaging.html#manual-package-build-and-installation), it says "If all went fine, open a ticket, put a link to the original tarball in the ticket and upload a branch with the code under `SAGE_ROOT/build/pkgs`." So IMHO, there is nothing else to do.


---

Comment by fredrik.johansson created at 2014-09-01 17:06:39

I recently updated the makefile in Arb (requires a git checkout). This might solve some potential build issues with the 2.2 release.


---

Comment by cheuberg created at 2014-09-23 06:24:23

Replying to [comment:9 fredrik.johansson]:
> I recently updated the makefile in Arb (requires a git checkout). This might solve some potential build issues with the 2.2 release.

For the sage spkg, it would probably be easier to have a release on github with that change.

`@`original authors: is there a reason why the status of this patch is not "needs_review"? I'd also like to renew my question on whether you plan to provide python bindings.


---

Comment by fredrik.johansson created at 2014-09-25 12:44:37

I will make a new release soon.

I've also just added methods arb_get_interval_mpfr/arb_set_interval_mpfr which should simplify conversion to/from Sage's RIF and CIF.


---

Comment by fredrik.johansson created at 2014-09-25 17:20:18

https://github.com/fredrik-johansson/arb/archive/2.3.0.tar.gz is available


---

Comment by git created at 2014-10-17 07:31:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2014-10-17 07:36:14

Updated to version 2.3.0; replaced usernames of original ticket authors by their full names as given by `SPKG.txt`.


---

Comment by cheuberg created at 2014-10-17 07:36:14

Changing status from new to needs_review.


---

Comment by cheuberg created at 2014-10-17 07:36:14

Changing keywords from "" to "arb, optional package. interval field".


---

Comment by jdemeyer created at 2014-10-17 08:28:07

The tarball name is too strange: it should contain the package name (`arb-2.3.0.tar.gz`)


---

Comment by jdemeyer created at 2014-10-17 08:28:07

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2014-10-17 08:29:11

Is the `-j1` needed for `$MAKE install`?


---

Comment by jdemeyer created at 2014-10-17 08:31:26

Try to avoid long lines like

```
Arb is a C library for arbitrary-precision floating-point ball arithmetic, developed by Fredrik Johansson (fredrik.johansson@gmail.com). It supports efficient high-precision computation with polynomials, power series, matrices and special functions over the real and complex numbers, with automatic, rigorous error control.
```



---

Comment by vbraun created at 2014-10-17 09:06:52

We most likely really need the `--libdir="$SAGE_LOCAL/lib"`. Some systems have hacked lt to install libraries in strange locations by default.


---

Comment by git created at 2014-10-19 04:38:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2014-10-19 04:48:10

Replying to [comment:15 jdemeyer]:
> The tarball name is too strange: it should contain the package name (`arb-2.3.0.tar.gz`)
I cannot change the original name on github, therefore I downloaded a copy, renamed the tarball and placed it in my own webspace, see the modified description of the ticket.


---

Comment by cheuberg created at 2014-10-19 04:52:53

Replying to [comment:16 jdemeyer]:
> Is the `-j1` needed for `$MAKE install`?
IMHO it is not needed and removing it should not have any effects (the only dependency of make install is the library which should have been compiled in parallel before; then make install creates two directories and copies a few files into these directories, but these steps would not be run in parallel, anyway). So `-j1` is removed in commit [f3ffd68](http://git.sagemath.org/sage.git/commit/?id=f3ffd68f4cab80fa7177b451557a7a5947725324).


---

Comment by cheuberg created at 2014-10-19 04:54:37

Replying to [comment:17 jdemeyer]:
> Try to avoid long lines

done in commit [f3f169d](http://git.sagemath.org/sage.git/commit/?id=f3f169d1af46a1a1f3ad30fb16cf048b348f938c).


---

Comment by cheuberg created at 2014-10-19 05:02:24

Replying to [comment:18 vbraun]:
> We most likely really need the `--libdir="$SAGE_LOCAL/lib"`. Some systems have hacked lt to install libraries in strange locations by default. 
The `.configure` script of arb does not support the option `--libdir`. Its `Makefile.in` uses `$(DESTDIR)$(PREFIX)/lib` (and `$(DESTDIR)$(PREFIX)/include`) as targets when installing the library.
Therefore, commit [7487164](http://git.sagemath.org/sage.git/commit/?id=74871647fade608ce1b4b2be7d4ca08a7e6da63c) removes `--libdir` (previously commented out).


---

Comment by cheuberg created at 2014-10-19 05:02:24

Changing status from needs_work to needs_review.


---

Comment by vbraun created at 2014-10-19 11:05:50

Argh, no autotools/libtool :-(


---

Comment by cheuberg created at 2014-10-22 06:48:36

Rather minimal python bindings are now in #17194


---

Comment by cheuberg created at 2014-10-29 09:02:33

See discussion on [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/-MZAvj8qxVk) concerning the section `SPKG Maintainers`.


---

Comment by git created at 2014-10-31 18:55:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2014-11-06 12:50:51

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-11-15 16:22:39

Resolution: fixed
