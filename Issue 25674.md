# Issue 25674: Increasing tableau class

Issue created by migration from https://trac.sagemath.org/ticket/25911

Original creator: @opechenik

Original creation time: 2018-07-23 23:24:55

CC:  kdilks jessicapalencia opechenik deinst tscrim

Keywords: sagedays@ICERM

The goal of this project is to implement a new subclass of Tableaux for "increasing tableaux," which are strictly increasing along rows and down columns. 

This will give us a natural home for (currently unimplemented) methods on these objects, such as the K-promotion and K-evacuation of Hugh Thomas--Alex Yong.

Ticket #23678 aims to implement a more general notion for arbitrary posets.



---

Comment by opechenik created at 2018-07-24 14:30:29

Changing keywords from "sagedays@ICERM" to "sagedays@icerm".


---

Comment by kdilks created at 2018-07-25 02:38:38

The problem is around line 8259 . When you're checking to see if the content is an integer vector, you follow up 'try:' with 'else:' instead of "except". There's a few other instances where this is done elsewhere in tableau.py . Should be.


```
        if wt is not None:
            if (not wt in IntegerVectors()):
                try:
                    wt = IntegerVector(wt)
                except ValueError:
                    raise ValueError( "wt must be an integer vector" )
            if not all([k in [0,1] for k in wt]):
                raise ValueError( "wt must be a binary vector" )
```


----
New commits:


---

Comment by kdilks created at 2018-07-25 04:11:33

Modified that line at least locally so that I could build and start to test the code.

You'll want to add IncreasingTableau/IncreasingTableaux to the list of things to be imported to the global namespace in `combinat/all.py` . Otherwise, you need to type in 'from sage.combinat.tableau import IncreasingTableaux' every session you want to use it.

Working through the iterator currently.

It didn't like


```
for node in Tableau(active_tab).cells():
                if active_tab[node] == 0:
```


because active tab is a list (of lists), and was being passed a tuple. It was happy when I did


```
for node in Tableau(active_tab).cells():
                if active_tab[node[0]][node[1]] == 0:
```

, though there should be a cleaner way to pass a tuple to nested lists.

Need to add `from sage.misc.misc import powerset` to the imports at the top of `tableau.py` .

For the line `top_value = max(active_tab.values())` , is there some kind of missing `values()` method which is supposed to give the content? Kind of stuck here until that gets resolved.

Additionally, you can get rid of the `cardinality()` method, you only need to explicitly define that if you have a different method of counting the size of the object without using the iterator to generate all of them.


---

Comment by opechenik created at 2018-07-25 13:08:22

Replying to [comment:5 kdilks]:

> For the line `top_value = max(active_tab.values())` , is there some kind of missing `values()` method which is supposed to give the content? Kind of stuck here until that gets resolved.

`active_tab.values()` should be instead `active_tab.entries()`. (In the poset version, active_tab had been a dictionary and I didn't translate correctly.)


---

Comment by git created at 2018-07-25 13:22:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-25 14:01:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by kdilks created at 2018-07-25 14:16:02

Iterator doesn't break now....but it also doesn't create anything.

I think before working on the code itself, it might be a good idea to change over the doctests, so that things like this can be more quickly picked up by running `./sage -t ./sage/combinat/tableau.py` after building with new changes.


---

Comment by git created at 2018-07-25 14:43:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-25 14:50:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by kdilks created at 2018-07-25 15:08:43

I can do things now! But still needs the automatic import statement so I don't have to copy the import statement each time I start a new session.

Another minor thing to clean up, you can just remove the `random_element()` method for now. It will inherit the naive random element method from I think FiniteEnumeratedSet (generate whole set, pick a random element). You only explicitly include the method if your class has a faster way to generate a random element. There should be a nice way to do this for Increasing Tableaux, but I don't want to think about that too much now.


---

Comment by kdilks created at 2018-07-25 15:13:33

You might want to consider making a `bender_knuth_involutions()` method that allows one to enter a list or iterable that specifies a sequence of toggles, analagous to `order_ideal_toggle()` and `order_ideal_toggles()` in Posets. I imagine the latter just calls the former in a way that would be easy to copy over.


---

Comment by git created at 2018-07-25 15:23:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-25 17:52:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-25 18:33:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-25 18:50:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-25 20:18:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-25 20:26:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-26 13:04:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-26 19:32:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by kdilks created at 2018-07-26 20:34:13

Man, there's a lot of documentation left to change.

For `descent_set()`, I would give a quick definition, and make a disclaimer indicating that it is more closely related to `standard_descents()` than `descents()` (annoyingly, the parent `Tableau` class has a `descents()` method that is completely different from the descents that we actually look at).


---

Comment by git created at 2018-07-27 15:26:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-08-02 14:33:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-08-02 15:14:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-08-02 15:55:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by kdilks created at 2018-08-02 16:42:12

You don't need to explicitly include a cardinality method unless it's using some non-trivial theorem (hook length formula, macmahon box formula, etc.) to give the enumeration. As long as there's an iterator, the default method for cardinality inherited from...FiniteSets (?) automatically iterates and counts.


---

Comment by git created at 2018-08-02 18:16:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-08-05 19:28:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-08-05 19:41:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-08-06 01:07:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by opechenik created at 2018-08-06 01:09:17

Set assignee to opechenik.


---

Comment by opechenik created at 2018-08-06 01:09:30

Changing status from new to needs_review.


---

Comment by kdilks created at 2018-08-06 01:25:36

I think when you include a reference in a docstring that you want linked to the appropriate bib item, you need to do [Tag]_ with the underscore after. I also think the convention is to add all references to the global references file, rather than just having local bibliographies.

Do the infinite factory classes really need to ave an explicit list() function raising a not implemented error?

I'll give everything a more thorough look later this week.


---

Comment by git created at 2018-08-06 01:39:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by opechenik created at 2018-08-06 01:42:11

Thanks Kevin! I fixed the references. But where is the global references file? I can't find it.

I agree that the "not implemented" list() methods seem useless, but SemistandardTableaux had them, so I figured someone must have known something.

Replying to [comment:36 kdilks]:
> I think when you include a reference in a docstring that you want linked to the appropriate bib item, you need to do [Tag]_ with the underscore after. I also think the convention is to add all references to the global references file, rather than just having local bibliographies.
> 
> Do the infinite factory classes really need to ave an explicit list() function raising a not implemented error?
> 
> I'll give everything a more thorough look later this week.


---

Comment by kdilks created at 2018-08-06 01:45:38

I thought that might be the case, but can't easily check to see what the SST code is for comparison now.

http://doc.sagemath.org/html/en/developer/coding_basics.html#sage-s-master-bibliography-file


---

Comment by tscrim created at 2018-08-06 01:47:56

Replying to [comment:38 opechenik]:
> Thanks Kevin! I fixed the references. But where is the global references file? I can't find it.

`$SAGE_ROOT/src/doc/en/reference/references/index.rst`

> I agree that the "not implemented" list() methods seem useless, but SemistandardTableaux had them, so I figured someone must have known something.

You should let the (choice of) category handle that. IMO, the tableau code needs to be overhauled and is not necessarily the best reference.


---

Comment by git created at 2018-08-06 14:43:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by opechenik created at 2018-08-06 14:45:53

Replying to [comment:40 tscrim]:

> You should let the (choice of) category handle that. IMO, the tableau code needs to be overhauled and is not necessarily the best reference.
Yes, the tableau code is a mess. Maybe that can be my project for my next SageDays...


---

Comment by tscrim created at 2018-09-24 01:03:42

I fixed a number of bugs dealing with iteration. In particular, if you fixed a (shape of) size of 0 and a positive `max_entry`, then it would yield multiple `[]`. I added a bunch of tests for corner cases (you're welcome Darij :P) and allowed a `max_entry=0`, which makes sense for empty shapes/sizes. I made the `eval` input more standardized and put a warning that it is not the usual `eval` of a tableau (which caused me some confusion).

I did some streamlining of the element methods (they are faster now):

```
sage: %time for t in IncreasingTableaux(6): tp = t.K_BenderKnuth(2)
CPU times: user 384 ms, sys: 4 ms, total: 388 ms
Wall time: 364 ms
sage: %time for t in IncreasingTableaux(7): tp = t.K_BenderKnuth(2)
CPU times: user 1.81 s, sys: 0 ns, total: 1.81 s
Wall time: 1.8 s
```

vs your branch

```
sage: %time for t in IncreasingTableaux(6): tp = t.K_BenderKnuth(2)
CPU times: user 440 ms, sys: 32 ms, total: 472 ms
Wall time: 415 ms
sage: %time for t in IncreasingTableaux(7): tp = t.K_BenderKnuth(2)
CPU times: user 2.16 s, sys: 12 ms, total: 2.17 s
Wall time: 2.16 s
```


There were a number of other misc documentation fixes/tweaks I did. Finally, I renamed `K_BenderKnuth` to `K_bender_knuth` to follow Sage/Python naming conventions (I feel the K is justified as being capitalized as a special exception because of K-theory).

If my changes are good, then positive review.
----
New commits:


---

Comment by kdilks created at 2018-09-26 04:16:51

Still need to look everything over, but there are two minor things noted in Pyflakes from Patchbot. 

One is that line 5124 is unnecessary. In the code for descent_set() , it defines cells = self.cells() and then never uses it, my guess is left over from when code was originally made in the notebook, or when the iteration over all cells was done differently. 

Second is that 'mu' on line 8407 is undefined. Is line 8367 supposed to be `mu = kwargs.get("eval", None)` instead of `wt = kwargs.get("eval", None)` ? And more importantly...is there even an IncreasingSkewTableaux class defined anywhere yet? I feel like this is something that doesn't belong in the code yet.


---

Comment by git created at 2018-09-26 09:37:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2018-09-26 09:38:42

Replying to [comment:44 kdilks]:
> Still need to look everything over, but there are two minor things noted in Pyflakes from Patchbot. 
> 
> One is that line 5124 is unnecessary. In the code for descent_set() , it defines cells = self.cells() and then never uses it, my guess is left over from when code was originally made in the notebook, or when the iteration over all cells was done differently. 

Yes, that was leftover from the old implementation. Removed.

> Second is that 'mu' on line 8407 is undefined. Is line 8367 supposed to be `mu = kwargs.get("eval", None)` instead of `wt = kwargs.get("eval", None)` ? And more importantly...is there even an IncreasingSkewTableaux class defined anywhere yet? I feel like this is something that doesn't belong in the code yet.

I concur. I left this hook in there and made it raise a `NotImplementedError`.


---

Comment by tscrim created at 2018-09-29 00:17:55

Green patchbot (morally).


---

Comment by opechenik created at 2018-09-29 19:29:31

Everything looks good from my vantage point. Thanks for cleaning up my code!


---

Comment by tscrim created at 2018-09-29 23:09:44

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2018-09-29 23:09:44

I am going to treat that (along with the green patchbot) as a positive review.


---

Comment by vbraun created at 2018-10-01 22:35:44

Resolution: fixed
