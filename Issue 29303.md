# Issue 29303: some cleanup in sf/monomial

Issue created by migration from https://trac.sagemath.org/ticket/29540

Original creator: chapoton

Original creation time: 2020-04-21 13:33:44

CC:  vdelecroix tscrim

* slightly better code for conversion from polynomial

* pep cleanup

* remove any use of six


---

Comment by chapoton created at 2020-04-21 13:34:25

New commits:


---

Comment by chapoton created at 2020-04-21 13:34:25

Changing status from new to needs_review.


---

Comment by chapoton created at 2020-04-21 16:35:52

green bot, please review


---

Comment by tscrim created at 2020-04-22 00:47:20

I don't think this change is correct:

```diff
-                if left_m == [] and right_m == []:
-                    z_elt[ left_m ] = left_c*right_c
+                # Hack due to symmetrica crashing when both of the
+                # partitions are the empty partition
+                if not left_m and not right:   # I think this should be right_m  <---
+                    z_elt[left_m] = left_c * right_c
```


Also, a micro-optimization while-we-are-at-it:

```diff
-        out = self.sum_of_terms(((Partition(e), c)
-                                 for e, c in f.dict().items()
-                                 if is_partition(e)),
-                                distinct=True)
+        out = self._from_dict({_Partitions.element_class(_Partitions, e): c
+                               for e, c in f.dict().items()
+                               if is_partition(e)}
+                              remove_zeros=False)
```



---

Comment by git created at 2020-04-22 06:41:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2020-04-22 06:44:35

You can do

```
from sage.combinat.partition import _Partitions
```



---

Comment by git created at 2020-04-22 06:51:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2020-04-22 06:54:26

Thanks, done !


---

Comment by tscrim created at 2020-04-22 07:04:59

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2020-04-22 07:04:59

Thanks. LGTM.


---

Comment by vbraun created at 2020-04-23 22:32:36

Resolution: fixed
