# Issue 30883: move downward default division from magmas to monoids

Issue created by migration from https://trac.sagemath.org/ticket/31120

Original creator: chapoton

Original creation time: 2020-12-27 20:38:39

CC:  nthiery tscrim slelievre

We move the default implementation of `_div_` which is using the product by the inverse from the categories of `Magmas` to the categories of `Monoids`.

The main reason is that the inverse of an element is not well-defined for a magma, where left-inverse and right-inverse must be distinguished.

This is a very small ticket in preparation for #17965


---

Comment by chapoton created at 2020-12-27 20:39:09

Changing status from new to needs_review.


---

Comment by chapoton created at 2020-12-27 20:39:09

New commits:


---

Comment by git created at 2020-12-27 20:41:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2020-12-29 08:07:28

green bot, please review


---

Comment by tscrim created at 2020-12-31 00:14:28

We also have another technical issue as there might only be a one sided inverse and `_div_` is assuming the right inverse. So if an element `x` only has a left inverse `y` (i.e., `y` is not also a right inverse), then `x * ~x == x * y != 1`. I think this is the same issue, and while this does improve the situation slightly, I feel like a more comprehensive solution is necessary with the method remaining in `Magmas`. One possible idea is to implement methods `left/right_inverse()`, which then redirect to `__invert__` in the category of `Groups`.


---

Comment by chapoton created at 2020-12-31 19:41:56

Ok, I guess this should / could be discussed on sage-devel.

Certainly having both left inverses and right inverses would be good. I am frightened to open such a can of worms.

In my opinion, everything about **units** and **inverses** should belong to the category of _monoid_ and not to the category of _magma_. One could argue that one can define these for magmas, but my point is that these notions are really seriously useful only for monoids.


---

Comment by tscrim created at 2021-01-01 06:32:40

Replying to [comment:5 chapoton]:
> Ok, I guess this should / could be discussed on sage-devel.
> 
> Certainly having both left inverses and right inverses would be good. I am frightened to open such a can of worms.

I certainly can understand being hesitant about it. Although I doubt it would be that bad as I don't think it is that common to have something with only 1-sided inverses or other esoteric behavior around this.

> In my opinion, everything about **units** and **inverses** should belong to the category of _monoid_ and not to the category of _magma_. One could argue that one can define these for magmas, but my point is that these notions are really seriously useful only for monoids.

I agree that it is most likely useless for anything that is not a unital magma (and likely monoid). However, that does not mean it holds no meaning at this level, which would be the justification for moving it as I see it. I guess I don't quite see the harm in having this here (which is independent of the bug in the implementation).


---

Comment by chapoton created at 2021-01-31 08:31:03

Changing status from needs_review to needs_work.


---

Comment by mkoeppe created at 2021-03-15 22:07:04

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.


---

Comment by git created at 2021-07-12 07:52:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2021-07-12 08:04:27

I still think that the small change made here goes in the positive direction.

If somebody at some point in the future really needs left and right division in magmas, then it will be possible to introduce say `_leftdiv_` and `_rightdiv_` default methods in the Element class of magmas. I am ready to bet that this will ***never*** happen.

Moreover, we do not even have a symbol for the division on the left, do we ?

`@`nthiery, any constructive comment ?


---

Comment by tscrim created at 2021-07-12 22:56:13

The only other thing I am a bit worried about is that this operation can still make sense in a magma when `x` has an (two-sided) inverse. I agree that we are not very likely to have an unital magma with some inverses (perhaps even a division magma) that is not a monoid.

We could use `_backslash_` as left division:

```
sage: 2 \ 5
AttributeError: 'sage.rings.integer.Integer' object has no attribute '_backslash_'
```

However, we currently have no protocol for this.


---

Comment by slelievre created at 2021-07-13 10:39:15

Maybe `SageObject` could provide `_backslash_(self, other)`
which would try something like `other._left_div_(self)`.


---

Comment by chapoton created at 2021-12-31 09:43:10

As said in the description, this very tiny ticket is meant to prepare for #17965, which aims at unifying the interface for inversion, a much needed task I would say.

Can we please move on ? I do not see the point of insisting on introducing left and right inverses in magmas, as there is currently no need for that anywhere, and there will probably never be.


---

Comment by chapoton created at 2021-12-31 09:43:21

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2021-12-31 22:58:50

I am still not convinced that it should not be at least “generically” supported for magmas in some form. I do agree that it should be at least promoted(demoted?) to something else, but I would say the category of unital magmas since that is the first category this could make sense. I am not strongly opposed to putting it monoids since that means an inverse is automatically two-sided, but if you think it is better here, then I am willing to positively review this (albeit somewhat begrudgingly).


---

Comment by chapoton created at 2022-04-11 18:27:11

I regret that this ticket stands still. My opinion is unchanged that the proper locus for the notion of inverse is the theory of monoids, and that we will probably never need "inverses" for magmas.

Do you see any way out ? Should we ask somebody else, so that the discussion does not remain stuck between the two of us ? But who ?


---

Comment by tscrim created at 2022-04-11 22:52:52

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2022-04-11 22:52:52

Nicholas would be the person I would want to weigh in. However, since you feel strongly about this and I do not and it should not have any impact, I will set this to a positive review. If someone else is unsure, they can revert the positive review.


---

Comment by vbraun created at 2022-05-18 22:19:00

Resolution: fixed


---

Comment by slelievre created at 2022-05-19 09:39:05

The discussion was about moving `_div_` from magmas to monoids.

Staring at commit 7d85a76... does it completely remove magmas?


---

Comment by chapoton created at 2022-05-19 11:26:41

no. The diff may not be working for closed tickets..
