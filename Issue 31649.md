# Issue 31649: Refresh graph_plot.py

Issue created by migration from https://trac.sagemath.org/ticket/31886

Original creator: slelievre

Original creation time: 2021-05-31 14:27:48

CC:  chapoton tscrim

Improve readability of `graphs/graph_plot.py`.


---

Comment by slelievre created at 2021-05-31 14:28:39

Please review.
----
New commits:


---

Comment by slelievre created at 2021-05-31 14:28:39

Changing status from new to needs_review.


---

Comment by tscrim created at 2021-05-31 23:53:56

Thank you for going through and doing some cleaning of this file. It definitely needs it. Overall, LGTM, but I do have a few questions and comments.

Why did you change this test?

```diff
-            sage: g.plot(color_by_label=True, edge_style='solid', layout='circular')
+            sage: g.plot(color_by_label=True, layout='circular')
```


You no longer need the `update` internal function:

```
        def update(key, label, color, head):
            edges_to_draw[key].append((label, color, head))
```


I personally find `a = (x, y)` easier to understand than `a = x, y`. However, this is more stylistic.

Also stylistic, but I would rather have the longer variable name `curr_loop_size` rather than `r` to have more self-documenting code.

Why did you create this variable?

```
p12 = (float(p2[0] - p1[0]), float(p2[1] - p1[1]))
```

It seems like it is only used to compute the perp slope. I feel like it doesn't add to the clarity.


---

Comment by slelievre created at 2021-06-01 09:58:32

Changing status from needs_review to needs_work.


---

Comment by slelievre created at 2021-06-01 09:58:32

Replying to [comment:2 tscrim]:
> Thank you for going through and doing some cleaning of
> this file. It definitely needs it. Overall, LGTM,
> but I do have a few questions and comments.

Thanks for agreeing with that and for taking a thorough look.

> Why did you change this test?
> {{{#!diff
> -            sage: g.plot(color_by_label=True, edge_style='solid', layout='circular')
> +            sage: g.plot(color_by_label=True, layout='circular')
> }}}

To simplify this test copied from Ask Sage in #31542, as:

- `edge_style` defaults to `'solid'`
- the test is for the number of edges, not their style

> You no longer need the `update` internal function:
> {{{
>         def update(key, label, color, head):
>             edges_to_draw[key].append((label, color, head))
> }}}

I hesitated to remove it, but I agree the benefits
no longer clearly outweigh the drawbacks:

- pros: six lines 16 characters shorter, less brackets and parentheses.
- cons: overhead of an internal function

> I personally find `a = (x, y)` easier to understand
> than `a = x, y`. However, this is more stylistic.

I agree and I'll change that.

> Also stylistic, but I would rather have the longer variable name
> `curr_loop_size` rather than `r` to have more self-documenting code.

I agree and I'll change that.

> Why did you create this variable?
> {{{
> p12 = (float(p2[0] - p1[0]), float(p2[1] - p1[1]))
> }}}
> It seems like it is only used to compute the perp slope.
> I feel like it doesn't add to the clarity.

I agree and I'll revert to the previous version.


---

Comment by git created at 2021-06-01 10:12:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slelievre created at 2021-06-01 10:12:54

Changing status from needs_work to needs_review.


---

Comment by slelievre created at 2021-06-01 10:12:54

Ready for review again.


---

Comment by tscrim created at 2021-06-02 01:17:07

Thank you.


---

Comment by tscrim created at 2021-06-02 01:17:07

Changing status from needs_review to positive_review.


---

Comment by slelievre created at 2021-06-02 05:50:14

Changing priority from minor to major.


---

Comment by slelievre created at 2021-06-02 05:50:14

Thanks for the review!

Setting priority back to major in view
of upcoming more substantial changes.


---

Comment by vbraun created at 2021-06-29 17:40:42

Resolution: fixed
