# Issue 19162: let category of growth group be determined by input

Issue created by migration from Trac.

Original creator: dkrenn

Original creation time: 2015-10-13 09:26:42

CC:  behackl cheuberg

At the moment, the category of a growth group is always the join of monoids and posets (except if explicitly specified). In many/typical cases this is a group (depends on the input). This aim of this ticket is to change this behavior.


---

Comment by dkrenn created at 2015-10-13 09:31:17

Code is written, but there is a problem with the coercion framework... (I will fix this later...)
----
Last 10 new commits:


---

Comment by git created at 2015-10-15 16:02:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-10-15 16:13:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2015-10-15 16:13:44

Changing status from new to needs_review.


---

Comment by cheuberg created at 2015-10-17 06:23:21

I added a rather stupid doctest: `x^W` where `W = Words([0, 1])`. The resulting growth group turns out to be a monoid; however, `W` itself is not a monoid. (As a side note, even finite words are not declared to be a monoid). I am not sure whether we should check that.

Apart from that: Shouldn't we check for commutativity of the base and return `Monoids().Commutative()` instead?

The rest seems to be fine; I do not understand why there was a failure on a patchbot.
----
New commits:


---

Comment by cheuberg created at 2015-10-17 06:23:21

Changing status from needs_review to needs_info.


---

Comment by cheuberg created at 2015-10-17 06:30:27

Replying to [comment:8 cheuberg]:
> I do not understand why there was a failure on a patchbot.

Sorry, I can now reproduce the failure:


```
sage -t --long src/sage/rings/asymptotic/growth_group.py
**********************************************************************
File "src/sage/rings/asymptotic/growth_group.py", line 3649, in sage.rings.asymptotic.growth_group.GrowthGroupFactory
Failed example:
    TestSuite(GrowthGroup('x^ZZ')).run(verbose=True)  # long time
Expected:
    running ._test_an_element() . . . pass
    running ._test_associativity() . . . pass
    running ._test_cardinality() . . . pass
    running ._test_category() . . . pass
    running ._test_elements() . . .
      Running the test suite of self.an_element()
      running ._test_category() . . . pass
      running ._test_eq() . . . pass
      running ._test_not_implemented_methods() . . . pass
      running ._test_pickling() . . . pass
      pass
    running ._test_elements_eq_reflexive() . . . pass
    running ._test_elements_eq_symmetric() . . . pass
    running ._test_elements_eq_transitive() . . . pass
    running ._test_elements_neq() . . . pass
    running ._test_eq() . . . pass
    running ._test_not_implemented_methods() . . . pass
    running ._test_one() . . . pass
    running ._test_pickling() . . . pass
    running ._test_prod() . . . pass
    running ._test_some_elements() . . . pass
Got:
    running ._test_an_element() . . . pass
    running ._test_associativity() . . . pass
    running ._test_cardinality() . . . pass
    running ._test_category() . . . pass
    running ._test_elements() . . .
      Running the test suite of self.an_element()
      running ._test_category() . . . pass
      running ._test_eq() . . . pass
      running ._test_not_implemented_methods() . . . pass
      running ._test_pickling() . . . pass
      pass
    running ._test_elements_eq_reflexive() . . . pass
    running ._test_elements_eq_symmetric() . . . pass
    running ._test_elements_eq_transitive() . . . pass
    running ._test_elements_neq() . . . pass
    running ._test_eq() . . . pass
    running ._test_inverse() . . . pass
    running ._test_not_implemented_methods() . . . pass
    running ._test_one() . . . pass
    running ._test_pickling() . . . pass
    running ._test_prod() . . . pass
    running ._test_some_elements() . . . pass
**********************************************************************
File "src/sage/rings/asymptotic/growth_group.py", line 3674, in sage.rings.asymptotic.growth_group.GrowthGroupFactory
Failed example:
    TestSuite(GrowthGroup('QQ^y')).run(verbose=True)  # long time
Expected:
    running ._test_an_element() . . . pass
    running ._test_associativity() . . . pass
    running ._test_cardinality() . . . pass
    running ._test_category() . . . pass
    running ._test_elements() . . .
      Running the test suite of self.an_element()
      running ._test_category() . . . pass
      running ._test_eq() . . . pass
      running ._test_not_implemented_methods() . . . pass
      running ._test_pickling() . . . pass
      pass
    running ._test_elements_eq_reflexive() . . . pass
    running ._test_elements_eq_symmetric() . . . pass
    running ._test_elements_eq_transitive() . . . pass
    running ._test_elements_neq() . . . pass
    running ._test_eq() . . . pass
    running ._test_not_implemented_methods() . . . pass
    running ._test_one() . . . pass
    running ._test_pickling() . . . pass
    running ._test_prod() . . . pass
    running ._test_some_elements() . . . pass
Got:
    running ._test_an_element() . . . pass
    running ._test_associativity() . . . pass
    running ._test_cardinality() . . . pass
    running ._test_category() . . . pass
    running ._test_elements() . . .
      Running the test suite of self.an_element()
      running ._test_category() . . . pass
      running ._test_eq() . . . pass
      running ._test_not_implemented_methods() . . . pass
      running ._test_pickling() . . . pass
      pass
    running ._test_elements_eq_reflexive() . . . pass
    running ._test_elements_eq_symmetric() . . . pass
    running ._test_elements_eq_transitive() . . . pass
    running ._test_elements_neq() . . . pass
    running ._test_eq() . . . pass
    running ._test_inverse() . . . fail
    Traceback (most recent call last):
      File "/local/sage/sage-6.9.rc0/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "/local/sage/sage-6.9.rc0/local/lib/python2.7/site-packages/sage/categories/groups.py", line 150, in _test_inverse
        tester.assertEquals(x * ~x, self.one())
      File "/local/sage/sage-6.9.rc0/local/lib/python2.7/site-packages/sage/rings/asymptotic/growth_group.py", line 3151, in __invert__
        return self.parent()._create_element_via_parent_(1 / self.base)
      File "sage/structure/element.pyx", line 1988, in sage.structure.element.RingElement.__div__ (/local/sage/sage-6.9.rc0/src/build/cythonized/sage/structure/element.c:18129)
        return coercion_model.bin_op(self, right, div)
      File "sage/structure/coerce.pyx", line 1018, in sage.structure.coerce.CoercionModel_cache_maps.bin_op (/local/sage/sage-6.9.rc0/src/build/cythonized/sage/structure/coerce.c:8689)
        return PyObject_CallObject(op, xy)
      File "sage/structure/element.pyx", line 1987, in sage.structure.element.RingElement.__div__ (/local/sage/sage-6.9.rc0/src/build/cythonized/sage/structure/element.c:18104)
        return (<RingElement>self)._div_(<RingElement>right)
      File "sage/rings/rational.pyx", line 2147, in sage.rings.rational.Rational._div_ (/local/sage/sage-6.9.rc0/src/build/cythonized/sage/rings/rational.c:19787)
        raise ZeroDivisionError('rational division by zero')
    ZeroDivisionError: rational division by zero
    ------------------------------------------------------------
    running ._test_not_implemented_methods() . . . pass
    running ._test_one() . . . pass
    running ._test_pickling() . . . pass
    running ._test_prod() . . . pass
    running ._test_some_elements() . . . pass
    The following tests failed: _test_inverse
**********************************************************************
File "src/sage/rings/asymptotic/growth_group.py", line 3699, in sage.rings.asymptotic.growth_group.GrowthGroupFactory
Failed example:
    TestSuite(GrowthGroup('x^QQ * log(x)^ZZ')).run(verbose=True)  # long time
Expected:
    running ._test_an_element() . . . pass
    running ._test_associativity() . . . pass
    running ._test_cardinality() . . . pass
    running ._test_category() . . . pass
    running ._test_elements() . . .
      Running the test suite of self.an_element()
      running ._test_category() . . . pass
      running ._test_eq() . . . pass
      running ._test_not_implemented_methods() . . . pass
      running ._test_pickling() . . . pass
      pass
    running ._test_elements_eq_reflexive() . . . pass
    running ._test_elements_eq_symmetric() . . . pass
    running ._test_elements_eq_transitive() . . . pass
    running ._test_elements_neq() . . . pass
    running ._test_eq() . . . pass
    running ._test_not_implemented_methods() . . . pass
    running ._test_one() . . . pass
    running ._test_pickling() . . . pass
    running ._test_prod() . . . pass
    running ._test_some_elements() . . . pass
Got:
    running ._test_an_element() . . . pass
    running ._test_associativity() . . . pass
    running ._test_cardinality() . . . pass
    running ._test_category() . . . pass
    running ._test_elements() . . .
      Running the test suite of self.an_element()
      running ._test_category() . . . pass
      running ._test_eq() . . . pass
      running ._test_not_implemented_methods() . . . pass
      running ._test_pickling() . . . pass
      pass
    running ._test_elements_eq_reflexive() . . . pass
    running ._test_elements_eq_symmetric() . . . pass
    running ._test_elements_eq_transitive() . . . pass
    running ._test_elements_neq() . . . pass
    running ._test_eq() . . . pass
    running ._test_inverse() . . . pass
    running ._test_not_implemented_methods() . . . pass
    running ._test_one() . . . pass
    running ._test_pickling() . . . pass
    running ._test_prod() . . . pass
    running ._test_some_elements() . . . pass
**********************************************************************
1 item had failures:
   3 of  19 in sage.rings.asymptotic.growth_group.GrowthGroupFactory
    1 test skipped
    [615 tests, 3 failures, 9.96 s]
```



---

Comment by cheuberg created at 2015-10-17 06:30:27

Changing status from needs_info to needs_work.


---

Comment by git created at 2015-10-19 18:23:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2015-10-19 18:25:21

I've completly rewritten the determining of the categories. Needs review.

Replying to [comment:8 cheuberg]:
> I added a rather stupid doctest: `x^W` where `W = Words([0, 1])`. The resulting growth group turns out to be a monoid; however, `W` itself is not a monoid. (As a side note, even finite words are not declared to be a monoid). I am not sure whether we should check that.

Is now checked.

> Apart from that: Shouldn't we check for commutativity of the base and return `Monoids().Commutative()` instead?

Is now checked as well.


---

Comment by dkrenn created at 2015-10-19 18:25:49

Replying to [comment:9 cheuberg]:
> Replying to [comment:8 cheuberg]:
> > I do not understand why there was a failure on a patchbot.
> 
> Sorry, I can now reproduce the failure: [...]

Fixed.


---

Comment by dkrenn created at 2015-10-19 18:25:49

Changing status from needs_work to needs_review.


---

Comment by cheuberg created at 2015-10-20 11:04:34

Changing status from needs_review to needs_work.


---

Comment by cheuberg created at 2015-10-20 11:04:34

I added one reviewer commits and have two more remarks.

1. `sage.rings.asymptotic.misc.transform_category`: document parameter `initial_category`
2. `GenericGrowthElement.__classcall__`: does it make sense to promote polynomials to Posets? How is the partial order defined on polynomials?
----
New commits:


---

Comment by dkrenn created at 2015-10-21 08:43:09

Replying to [comment:15 cheuberg]:
> I added one reviewer commits and have two more remarks.

Cross-reviewed.

> 1. `sage.rings.asymptotic.misc.transform_category`: document parameter `initial_category`

Documented.

> 2. `GenericGrowthElement.__classcall__`: does it make sense to promote polynomials to Posets? How is the partial order defined on polynomials?

The default order is `degrevlex`, see
http://doc.sagemath.org/html/en/reference/polynomial_rings/sage/rings/polynomial/polynomial_ring_constructor.html#sage.rings.polynomial.polynomial_ring_constructor.PolynomialRing

Thus, polynomial rings should be posets as well.
----
New commits:


---

Comment by dkrenn created at 2015-10-21 08:43:30

Changing status from needs_work to needs_review.


---

Comment by cheuberg created at 2015-10-23 06:58:01

Changing status from needs_review to positive_review.


---

Comment by cheuberg created at 2015-10-23 06:58:01

Merges cleanly with 6.10.beta1 (despite failure of trac's automerging); doctests pass; documentation builds.


---

Comment by vbraun created at 2015-10-24 10:22:12

Resolution: fixed


---

Comment by cheuberg created at 2015-10-31 07:52:21

Replying to [comment:15 cheuberg]:
> I added one reviewer commits and have two more remarks.
> ||[997380b](http://git.sagemath.org/sage.git/commit/?id=997380baa67cc3d7fda5e9791c29d58f3ff15515)||`Trac #19399: Insert ReSt links`||

This commit was lost and is not contained in the version of this ticket which finally got merged. As #19400 deals with documentation of asymptotic expansions anyway, the lost commit could be merged in that ticket instead of opening a new trivial ticket.
