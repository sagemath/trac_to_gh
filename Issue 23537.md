# Issue 23537: sage_setup: Proper error checking for makedirs

Issue created by migration from https://trac.sagemath.org/ticket/23774

Original creator: mkoeppe

Original creation time: 2017-09-01 22:08:51

CC:  jhpalmieri jdemeyer embray

If the Python function `makedirs` is used to achieve the effect of `mkdir -p`, one needs to distinguish two situations: Directory already exists; directory does not exist and cannot be created.

See https://stackoverflow.com/questions/600268/mkdir-p-functionality-in-python


---

Comment by mkoeppe created at 2017-09-01 22:16:23

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2017-09-01 22:16:23

New commits:


---

Comment by jdemeyer created at 2017-09-02 00:50:49

I prefer a simpler

```
if not os.path.isdir(path):
    raise
```

in the `except` block. Why do you need to check in addition the `errno`?


---

Comment by mkoeppe created at 2017-09-02 01:29:44

I'd say not checking the errno is the moral equivalent of catching all exceptions.


---

Comment by chapoton created at 2017-09-02 06:22:18

does not build ("path" is not defined..)


---

Comment by jdemeyer created at 2017-09-02 09:22:19

Replying to [comment:4 mkoeppe]:
> I'd say not checking the errno is the moral equivalent of catching all exceptions. 

It's fine to catch all exceptions because I suggest to check the _desired result_ not the reason why it failed.


---

Comment by git created at 2017-09-02 21:40:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2017-09-03 07:25:22

Obvious simplification: change

```
if condition:
    pass
else:
    raise
```

to

```
if not condition:
    raise
```



---

Comment by git created at 2017-09-03 15:58:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2017-09-04 08:31:18

I don't like your last commit message, so I squashed these commits to one.
----
New commits:


---

Comment by jdemeyer created at 2017-09-04 08:31:18

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-09-10 11:56:51

Resolution: fixed
