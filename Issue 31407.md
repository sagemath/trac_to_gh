# Issue 31407: Topological closure of embedded submanifolds

Issue created by migration from https://trac.sagemath.org/ticket/31644

Original creator: mkoeppe

Original creation time: 2021-04-10 23:45:40

CC:  egourgoulhon tscrim yzh @mjungmath

We define a class for objects in the category of topological spaces that represents the topological closure of an embedded submanifold. 
Embedded submanifolds will provide a method `closure` to construct it. As far as this ticket is concerned, this object is abstract: it only knows what object it is the closure of and the ambient space.

The purpose of this is to build a connection of manifolds to cell complexes and convex polyhedra: In a separate ticket, we will define embedded submanifolds of euclidean spaces that arise as interiors of polyhedra or relative interiors of their faces.


---

Comment by @mjungmath created at 2021-04-10 23:56:08

That sounds extremely interesting!

Btw: Do you really mean cell complexes or rather simplicial complexes?


---

Comment by mkoeppe created at 2021-04-11 01:09:53

Simplicial is too narrow - that would not be enough (without triangulating) to represent general convex polyhedra and their boundary structure. So need something slightly more general.


---

Comment by mkoeppe created at 2021-04-11 03:04:27

New commits:


---

Comment by mkoeppe created at 2021-04-11 03:23:34

Here's a beginning. 

Currently, is there already a way to get the image of the embedding of the submanifold in the ambient manifold as a "subset"?


---

Comment by @mjungmath created at 2021-04-11 09:17:26

Replying to [comment:4 mkoeppe]:
> New commits:
> ||[331aa59](https://git.sagemath.org/sage.git/commit?id=331aa59f61c065ac9b6237e5d37ae59ba652ece6)||`sage.manifolds.closure_topological_submanifold, TopologicalSubmanifold.closure: New`||

Looks already nice!

Replying to [comment:2 mkoeppe]:
> Simplicial is too narrow - that would not be enough (without triangulating) to represent general convex polyhedra and their boundary structure. So need something slightly more general.

Right, the cube is already a counter-example.

Replying to [comment:5 mkoeppe]:
> Here's a beginning. 
> 
> Currently, is there already a way to get the image of the embedding of the submanifold in the ambient manifold as a "subset"? 

No, I don't think so.


---

Comment by egourgoulhon created at 2021-04-11 10:20:11

Replying to [comment:6 gh-mjungmath]:
> 
> Replying to [comment:5 mkoeppe]:
> > Here's a beginning. 
> > 
> > Currently, is there already a way to get the image of the embedding of the submanifold in the ambient manifold as a "subset"? 
> 
> No, I don't think so.
I confirm; more generally, there is no such functionality for continuous maps.


---

Comment by @mjungmath created at 2021-04-11 13:12:11

Speaking of boundary; I think we should slowly but surely consider to introduce manifolds with boundary...


---

Comment by egourgoulhon created at 2021-04-11 13:33:14

Replying to [comment:8 gh-mjungmath]:
> Speaking of boundary; I think we should slowly but surely consider to introduce manifolds with boundary...
Indeed. There is even some demand for it: https://ask.sagemath.org/question/56532/.


---

Comment by mkoeppe created at 2021-04-11 15:50:22

Replying to [comment:7 egourgoulhon]:
> Replying to [comment:6 gh-mjungmath]:
> > 
> > Replying to [comment:5 mkoeppe]:
> > > Currently, is there already a way to get the image of the embedding of the submanifold in the ambient manifold as a "subset"? 
> > 
> > No, I don't think so.
> I confirm; more generally, there is no such functionality for continuous maps. 

OK, I have opened #31653 for this


---

Comment by git created at 2021-04-11 16:29:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-04-29 21:11:28

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:


---

Comment by git created at 2021-04-30 04:45:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-05-08 22:22:19

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by mkoeppe created at 2021-05-08 22:24:39

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2021-05-08 22:49:29

I have put the new class in a new subpackage `sage.manifolds.subsets` (see  #30139#comment:33)


---

Comment by egourgoulhon created at 2021-05-09 12:51:59

Changing status from needs_review to needs_work.


---

Comment by egourgoulhon created at 2021-05-09 12:51:59

Looks nice, but there are several issues reported by the patchbot, including doctest failures.


---

Comment by @mjungmath created at 2021-05-09 13:12:50

Looks like the failures are originated in #31798.


---

Comment by git created at 2021-05-09 15:46:28

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by mkoeppe created at 2021-05-09 15:47:14

Redid the branch on top of only #31763, #31798


---

Comment by mkoeppe created at 2021-05-09 15:47:23

Changing status from needs_work to needs_review.


---

Comment by git created at 2021-05-11 22:47:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-05-12 01:32:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-05-19 15:38:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mjungmath created at 2021-05-30 09:40:02

One doctest has failed. Is that related to this ticket?


---

Comment by mkoeppe created at 2021-05-30 16:54:22

No, it's unrelated, see #31848


---

Comment by egourgoulhon created at 2021-06-02 15:03:36

Looks nice!

There is a spurious line feed in the html documentation of `ManifoldSubsetClosure`, which can be fixed with

```diff
     - ``name`` -- (default: computed from the name of the subset)
-       string; name (symbol) given to the closure
+      string; name (symbol) given to the closure
```

Besides, there should be some `EXAMPLES` section in the main docstring of `ManifoldSubsetClosure`, and the latter should start with `r"""`, instead of `"""`, I think.


---

Comment by git created at 2021-06-02 16:58:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by egourgoulhon created at 2021-06-03 06:41:31

I would not perform the import of `ManifoldSubsetClosure` in the `EXAMPLES` section, but rather construct the closure via the dedicated method `closure()`, since this is what the end user is supposed to do. In other words, I would rewrite the first part of the example as something like

```
sage: M = Manifold(2, 'R^2', structure='topological')
sage: c_cart.<x,y> = M.chart() # Cartesian coordinates on R^2
sage: D = M.open_subset('D', coord_def={c_cart: x^2+y^2<1}); D
Open subset D of the 2-dimensional topological manifold R^2
sage: cl_D = D.closure()
sage: cl_D
Topological closure cl_D of the Open subset D of the 2-dimensional
 topological manifold R^2
sage: latex(cl_D)
\mathop{\mathrm{cl}}(D)
sage: type(cl_D)
<class 'sage.manifolds.subsets.closure.ManifoldSubsetClosure_with_category'>
sage: cl_D.category()
Category of subobjects of sets
```



---

Comment by egourgoulhon created at 2021-06-03 08:47:48

Also, in the docstring of `ManifoldSubset.closure()`, it would be nice to add an `OUTPUT` field as follows:

```
OUTPUT:

- an instance of :class:`~sage.manifolds.subsets.closure.ManifoldSubsetClosure`
```

This allows one to easily access to the documentation of class `ManifoldSubsetClosure` from that of `closure()`. For completeness, one may also add an `INPUT` field describing the arguments `name` and `latex_name` and their default values.


---

Comment by git created at 2021-06-03 18:04:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-06-03 18:04:41

Thanks for the suggestions, done.


---

Comment by egourgoulhon created at 2021-06-03 22:20:36

Changing status from needs_review to positive_review.


---

Comment by egourgoulhon created at 2021-06-03 22:20:36

Thanks!


---

Comment by mkoeppe created at 2021-06-03 23:16:50

Thank you!


---

Comment by git created at 2021-06-19 18:20:02

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by git created at 2021-06-19 18:20:02

Changing status from positive_review to needs_review.


---

Comment by mkoeppe created at 2021-06-19 18:20:57

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2021-06-19 18:20:57

Trivial merge of updated dependency #31763


---

Comment by vbraun created at 2021-06-29 17:40:54

Resolution: fixed
