# Issue 21186: CubeConnectedGraph generator

Issue created by migration from Trac.

Original creator: mcognetta

Original creation time: 2016-09-05 15:31:45




---

Comment by mcognetta created at 2016-09-05 15:32:34

Changing component from PLEASE CHANGE to graph theory.


---

Comment by mcognetta created at 2016-09-05 15:32:34

Changing type from PLEASE CHANGE to enhancement.


---

Comment by mcognetta created at 2016-09-05 15:32:34

Changing keywords from "" to "graph generators".


---

Comment by mcognetta created at 2016-09-05 15:32:34

Changing priority from major to minor.


---

Comment by mcognetta created at 2016-09-05 15:57:29

I have a patch for this done but I am getting the following error when I try to push it:


```
    STDERR: Host key verification failed.
    STDERR: fatal: Could not read from remote repository.
    STDERR: 
    STDERR: Please make sure you have the correct access rights
    STDERR: and the repository exists.
```


Any advice? I was getting some man-in-the-middle warning before but that is gone now...


----


edit: fixed it. I had deleted trac.sagemath.org from my known hosts but never readded it.


---

Comment by dcoudert created at 2016-09-05 17:30:49

Hello,

Thank you for adding this.

Here `n` is not the order of the CCC but the dimension. The order of CCC(n) is `d*2^d` (You could mention it in the documentation).
I suggest to replace `n` with `d` to avoid confusion with the order.


Use `<` instead of `\lt`. As you can see in the documentation displayed in a terminal, `\lt` is replaced with `lt`, which is not nice. Also, you can avoid using `\lfloor...\rfloor` and give directly the value for `n` even and `n` odd. I don't know what to do with the `oplus`. Actually I don't knwo what you mean by `x oplus 2^y`.

```
sage: G = graphs.CubeConnectedCycle?
Signature:      graphs.CubeConnectedCycle(n)
Docstring:     
   Returns the cube-connected cycle of order n.

   The cube-connected cycle of order n is the n-dimensional hypercube
   with each of its vertices replaced by a cycle of length n. The
   construction is as follows: Construct vertex (x,y) for 0 <= x lt
   2^n, 0 <= y lt n. For each vertex, (x,y), add an edge between it
   and (x, (y-1) mod n)), (x,(y+1) mod n), and (x oplus 2^y, y)

   INPUT:

      * "n" -- The dimension of the desired hypercube as well as the
        length of the cycle to be placed at each vertex of the
        n-dimensional hypercube. n must be a positive integer.

   EXAMPLES:

   The diameter of cube-connected cycles for n gt 3 is 2n+ lfloor
   frac{n}{2} rfloor -2

      sage: g = graphs.CubeConnectedCycle(9)
      sage: g.diameter()
      20

   All vertices have degree 3 when n gt 1

      sage: g = graphs.CubeConnectedCycle(12)
      sage: all(g.degree(v) == 3 for v in g)
      True
```


For the last example, observe that CCC(2) is a cycle of order 8, and so all vertices have degree 2.

The error message could be changed to `greater than 0`.

Best,
David.

PS: switch the ticket to need review when ready. It is still as new...
----
New commits:


---

Comment by mcognetta created at 2016-09-06 05:32:20

Replying to [comment:5 dcoudert]:
> Hello,
> 
> Thank you for adding this.
> 
> Here `n` is not the order of the CCC but the dimension. The order of CCC(n) is `d*2^d` (You could mention it in the documentation).
> I suggest to replace `n` with `d` to avoid confusion with the order.
> 
> 
> Use `<` instead of `\lt`. As you can see in the documentation displayed in a terminal, `\lt` is replaced with `lt`, which is not nice. Also, you can avoid using `\lfloor...\rfloor` and give directly the value for `n` even and `n` odd. I don't know what to do with the `oplus`. Actually I don't knwo what you mean by `x oplus 2^y`.
> {{{
> sage: G = graphs.CubeConnectedCycle?
> Signature:      graphs.CubeConnectedCycle(n)
> Docstring:     
>    Returns the cube-connected cycle of order n.
> 
>    The cube-connected cycle of order n is the n-dimensional hypercube
>    with each of its vertices replaced by a cycle of length n. The
>    construction is as follows: Construct vertex (x,y) for 0 <= x lt
>    2^n, 0 <= y lt n. For each vertex, (x,y), add an edge between it
>    and (x, (y-1) mod n)), (x,(y+1) mod n), and (x oplus 2^y, y)
> 
>    INPUT:
> 
>       * "n" -- The dimension of the desired hypercube as well as the
>         length of the cycle to be placed at each vertex of the
>         n-dimensional hypercube. n must be a positive integer.
> 
>    EXAMPLES:
> 
>    The diameter of cube-connected cycles for n gt 3 is 2n+ lfloor
>    frac{n}{2} rfloor -2
> 
>       sage: g = graphs.CubeConnectedCycle(9)
>       sage: g.diameter()
>       20
> 
>    All vertices have degree 3 when n gt 1
> 
>       sage: g = graphs.CubeConnectedCycle(12)
>       sage: all(g.degree(v) == 3 for v in g)
>       True
> }}}
> 
> For the last example, observe that CCC(2) is a cycle of order 8, and so all vertices have degree 2.
> 
> The error message could be changed to `greater than 0`.
> 
> Best,
> David.
> 
> PS: switch the ticket to need review when ready. It is still as new...
> ----
> New commits:
> ||[8a012f6](https://git.sagemath.org/sage.git/commit?id=8a012f6ccc58e17a641ac8364c1f47f2907358cb)||`Added a generator for CubeConnectedCycles to families.py`||

Hi, thanks for the comments.

I will add the suggested items. \oplus is for the bitwise xor operation. I am not sure the best way to have that in the docs? Maybe just `^`?


---

Comment by git created at 2016-09-06 15:37:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mcognetta created at 2016-09-06 15:39:37

Changing status from new to needs_review.


---

Comment by mcognetta created at 2016-09-06 15:39:37

I changed the documentation to reflect most of the recommendations but kept the floor and \oplus latex symbols because I don't know what to do with \oplus and floor is present in many other doc strings. I clarified the meaning of \oplus to avoid confusion.


---

Comment by dcoudert created at 2016-09-06 16:32:36

Some other comments:
* `order `d2^d`.` -> ` order `d\times 2^d`.` or `.` or `\cdot`. It will be nicer
* in the examples, you could change `sage: len(g)` with `sage: len(g)==d*2**d` and the expected result to `True`.
* `All vertices have degree `3` when `d > 1` ::` -> `All vertices have degree `3` when `d > 2` ::`


You are lucky that the `^` operator is working well here. I have different behavior when using the command line...

```
sage: G = graphs.CubeConnectedCycle(3)
sage: print G.vertices()
[(0, 0), (0, 1), (0, 2), (1, 0), (1, 1), (1, 2), (2, 0), (2, 1), (2, 2), (3, 0), (3, 1), (3, 2), (4, 0), (4, 1), (4, 2), (5, 0), (5, 1), (5, 2), (6, 0), (6, 1), (6, 2), (7, 0), (7, 1), (7, 2)]
sage: def toto(d):
....:     G = Graph(name="Cube-Connected Cycle of dimension {}".format(d))
....:     G.add_vertices((x, y) for x in range(pow(2, d)) for y in range(d))
....:     for x, y in G.vertices():
....:         G.add_edge((x, y), (x, (y+1)%d))
....:         G.add_edge((x, y), (x, (y-1)%d))
....:         G.add_edge((x, y), (x^pow(2, y), y))
....:     return G
....: 
sage: print toto(3).vertices()
[(0, 0), (0, 1), (0, 2), (1, 0), (1, 1), (1, 2), (2, 0), (2, 1), (2, 2), (3, 0), (3, 1), (3, 2), (4, 0), (4, 1), (4, 2), (5, 0), (5, 1), (5, 2), (6, 0), (6, 1), (6, 2), (7, 0), (7, 1), (7, 2), (9, 1), (16, 1), (16, 2), (25, 1), (36, 1), (49, 1), (81, 2), (256, 2), (625, 2), (1296, 2), (2401, 2)]
sage: G.is_isomorphic(toto(3))
False
```

I don't know how to prevent such problem.


---

Comment by mcognetta created at 2016-09-06 16:39:18

I actually had the same problem for a little but it sort of just went away. I tried to use

```
x.__xor__(y)
```

but it wouldn't work on either the command line or in loaded modules (can't remember which).

What is the preferred way to do operations such as xor, power, and mod?


---

Comment by dcoudert created at 2016-09-06 17:13:41

I tried in both command line and module and `G.add_edge((x, y), (x.__xor__(pow(2, y)), y))` is working well. 
Apparently, `^` is the standard python3 xor https://docs.python.org/3/reference/expressions.html, so you can let it as is. 
Exponentiation is done with `**` in python3, so it will become the standard, and mod is `%`.


---

Comment by mcognetta created at 2016-09-07 03:24:25

I will leave `^` as is and and change pow to be `**`. Is there a case where using the sage pow and mod functions is preferred over using the python operators `**` and `%`?


---

Comment by git created at 2016-09-07 03:41:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2016-09-07 06:26:32

I don't know when is `pow` prefered to `**`.

You forgot to consider the following comments:
* `order `d2^d`.` -> ` order `d\times 2^d`.` or `.` or `\cdot`. It will be nicer
* in the examples, you could change `sage: len(g)` with `sage: len(g)==d*2**d` and the expected result to `True`.
* `All vertices have degree `3` when `d > 1` ::` -> `All vertices have degree `3` when `d > 2` ::`


---

Comment by git created at 2016-09-09 03:46:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2016-09-09 12:11:41

you forgot the last item
* `All vertices have degree `3` when `d > 1` ::` -> `All vertices have degree `3` when `d > 2` ::`


---

Comment by mcognetta created at 2016-09-09 17:25:23

It seems to be correct as is. See http://mathworld.wolfram.com/Cube-ConnectedCycle.html


---

Comment by dcoudert created at 2016-09-10 07:01:09

Your construction does not follow the wolfram definition where `CCC(1)` has loops and `CCC(2)` has multiple (parallel) edges.

```
sage: graphs.CubeConnectedCycle(1).has_loops()
False
sage: graphs.CubeConnectedCycle(2).allows_multiple_edges()
False
```

So either you add necessary cases to strictly follow the wolfram definition, or you follow the usual assumption in graph theory that `CCC(1)` is an edge and so vertices have degree 1, and `CCC(2)` is a cycle of order 8 and so its vertices have degree 2.

If you check the original paper by Preparata and Vuillemin in 1981 http://dl.acm.org/citation.cfm?id=358660, you will see that the definition is slightly different and more general (extra vertices can be added).
If you remind me, I can check on Monday in reference books such as `J. de Rumeur, Communication dans les réseaux de processeurs, Masson, 1994` and others.


I realize that there is an error in your code with `d=1` due to `%1` since `1%1==2%1==0`. Furthermore, the test is not good since all vertices have by definition degree less than 3.

```
sage: g = graphs.CubeConnectedCycle(1)
sage: any(g.degree(v) < 3 for v in g)
True
sage: g.edges()
[]
sage: g.vertices()
[(0, 0), (1, 0)]
```



---

Comment by dcoudert created at 2016-09-20 12:38:15

In your code, some edges are added twice. A simple method to avoid that is as follows:

```
    if d<1:
        raise ValueError('d must be greater than 0.')

    G = Graph(name="Cube-Connected Cycle of dimension {}".format(d))

    for  x in range(1<<d):
        G.add_cycle( [(x, y) for y in range(d)] )

    for x, y in G.vertices():
        G.add_edge((x, y), (x^(1<<y), y))

    return G
```

The `1<<y` are just minor improvements.


---

Comment by dcoudert created at 2016-09-20 12:38:15

Changing status from needs_review to needs_work.


---

Comment by mcognetta created at 2016-09-20 12:43:22

Thanks, I haven't really been able to do anything in Sage for a while (https://groups.google.com/forum/#!topic/sage-devel/jLUq1rqdOC4). I will try to finish it up soon, I feel dumb for having so many small mistakes but it has been prohibitively time consuming to do iterative improvements on anything I was messing with in Sage.


---

Comment by dcoudert created at 2016-09-20 12:52:56

I also had issues with 7.4-beta4 (#21482), and it took me a lot of compilations to test te patch...

Concerning this ticket, we all make small mistakes. That's why the reviewing process is so important (ok, some times it's really boring).

We are almost done with this ticket. We mostly have to ensure that the definition fits the code and vice-et-versa ;)


---

Comment by dcoudert created at 2016-11-05 21:06:47

any update?


---

Comment by dcoudert created at 2017-10-21 09:47:10

just a ping to know if you are willing to finalize this ticket.


---

Comment by mcognetta created at 2017-10-21 12:41:52

Wow I thought this had been closed already. Give me a day or so to get sage set up on my new work station and I'll finish it


---

Comment by git created at 2017-11-14 16:41:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mcognetta created at 2017-11-14 16:42:57

I've been having a ridiculous amount of trouble getting sage to work/compile/connect to trac correctly. Anyway, I updated the docs and included cases for d=1 and 2 specifically to match the original definition. Hope this is sufficient. Thanks for the help in the past.


---

Comment by mcognetta created at 2017-11-14 16:42:57

Changing status from needs_work to needs_review.


---

Comment by dcoudert created at 2017-11-14 17:52:34

I'm sorry you had difficulties installing/updating sage.

I have several comments. Let's start with the easiest one:
- `Returns the cube-connected cycle of dimension `d`.` -> `Return the cube-connected cycle of dimension `d`.`
- Instead of `<=`, you can use `\leq`. It will be much nicer.

In the examples:
- `sage: d = 10` this is large. In general we try to have quick tests since there are many many tests in Sagemath. `d = 3` could be enough, non?
- `sage: d = 9`. again, 4 is large enough.
- `sage: g = graphs.CubeConnectedCycle(12)` is clearly too large. 3 is enough here.

In the code:
- `if d<1:` -> `if d < 1:`
- `ValueError('d must be greater than 0.')` -> `ValueError('the dimension d must be greater than 0')` without `.` at the end. Change the test accordingly.


Now, there is something wrong with the way you handle the case `d == 1` and `d == 2`. If I use your code, I get:

```
sage: G = graphs.CubeConnectedCycle(1)
sage: G.edges()
[((0, 0), (0, 0), None), ((0, 0), (1, 0), None), ((1, 0), (1, 0), None)]
sage: G.has_loops()
False
sage: G.loops()
[]
sage: G = graphs.CubeConnectedCycle(2)
sage: G.edges(labels=0)

[((0, 0), (0, 1)),
 ((0, 0), (0, 1)),
 ((0, 0), (1, 0)),
 ((0, 1), (2, 1)),
 ((1, 0), (1, 1)),
 ((1, 0), (1, 1)),
 ((1, 1), (3, 1)),
 ((2, 0), (2, 1)),
 ((2, 0), (2, 1)),
 ((2, 0), (3, 0)),
 ((3, 0), (3, 1)),
 ((3, 0), (3, 1))]
sage: G.has_multiple_edges()
False
```

Could you tell me what you expect `CCC(1)` and `CCC(2)` to be ?


Also, I'm not able to build the documentation. I got:

```
OSError: [graphs   ] /Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/graphs/graph_generators.py:docstring of sage.graphs.graph_generators.GraphGenerators.CubeConnectedCycle:33: WARNING: Unexpected indentation.
```

I suspect it is due to the line `The construction is as follows:`. Can you check ?

All these are only minor issues that can easily be fixed. Almost done !


---

Comment by dcoudert created at 2017-11-14 17:52:34

Changing status from needs_review to needs_work.


---

Comment by @vipul79321 created at 2020-03-02 13:51:40

According to Wikipedia [https://en.wikipedia.org/wiki/Cube-connected_cycles#Definition](https://en.wikipedia.org/wiki/Cube-connected_cycles#Definition).
In CCC(d), each node (x,y) should have `(x,(y+1)mod d) , (x,(y-1)mod d) and (x XOR 2^y, y)` has its neighbor( or adjacent vertices)

CCC(1) can be one of the following:

1).Graph with edges: `[((0, 0), (0, 0)), ((0, 0), (0, 1)), ((0, 1), (0, 1))]` if we dont consider a vertex to be its own neighbor unless there is a self loop.

2). A simple Graph with an edge: `[((0, 0), (1, 0))]`, If we consider a vertex to be its own neighbor as mentioned in following link [http://mathworld.wolfram.com/GraphNeighborhood.html](http://mathworld.wolfram.com/GraphNeighborhood.html)

CCC(2) should be\\
Simple Graph with edges: `[((0, 0), (0, 1)), ((0, 0), (1, 0)), ((0, 1), (2, 1)), ((1, 0), (1, 1)), ((1, 1), (3, 1)), ((2, 0), (2, 1)), ((2, 0), (3, 0)), ((3, 0), (3, 1))]`

Code works fine for CCC(d>3).

`@`docoudert: Can you guide me here?


---

Comment by dcoudert created at 2020-03-02 14:11:03

I think it's better to follow the wolfram definition of CCC here http://mathworld.wolfram.com/Cube-ConnectedCycleGraph.html.


---

Comment by git created at 2020-03-03 04:48:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @vipul79321 created at 2020-03-03 04:55:22

Replying to [comment:29 dcoudert]:
> I think it's better to follow the wolfram definition of CCC here http://mathworld.wolfram.com/Cube-ConnectedCycleGraph.html. 
> 
There is still one ambiguity for CCC(2). It can have following edge set according to diagram or definition of CCC(2) in Wolfram :\\
1) `[((0, 0), (0, 1)), ((0, 0), (1, 0)), ((0, 0), (1, 0)), ((0, 1), (2, 1)), ((0, 1), (2, 1)), ((1, 0), (1, 1)), ((1, 1), (3, 1)), ((1, 1), (3, 1)), ((2, 0), (2, 1)), ((2, 0), (3, 0)), ((2, 0), (3, 0)), ((3, 0), (3, 1))]`

or

2) `[((0, 0), (0, 1)), ((0, 0), (0, 1)), ((0, 0), (1, 0)), ((0, 1), (2, 1)), ((1, 0), (1, 1)), ((1, 0), (1, 1)), ((1, 1), (3, 1)), ((2, 0), (2, 1)), ((2, 0), (2, 1)), ((2, 0), (3, 0)), ((3, 0), (3, 1)), ((3, 0), (3, 1))]`


---

Comment by @vipul79321 created at 2020-03-03 04:55:22

Changing status from needs_work to needs_review.


---

Comment by dcoudert created at 2020-03-03 08:25:51

which one follows best the definition given here https://en.wikipedia.org/wiki/Cube-connected_cycles ?


---

Comment by @vipul79321 created at 2020-03-03 13:24:28

Replying to [comment:33 dcoudert]:
> which one follows best the definition given here https://en.wikipedia.org/wiki/Cube-connected_cycles ?
Both cases satisfy the condition given.

But sticking to this definition given in[http://mathworld.wolfram.com/Cube-ConnectedCycleGraph.html](http://mathworld.wolfram.com/Cube-ConnectedCycleGraph.html) The cube-connected cycle graph of order n is the graph obtained by replacing each vertex in a n-dimensional hypercube by a cycle of length n.

Option (2) of comment 32 fits well because each node in hypergraph is replaced by cycle whose x is fixed and that pattern is also followed in all CCC(d>=3).


---

Comment by git created at 2020-03-03 13:44:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2020-03-03 16:03:02

- Please follow the PEP8 coding style  https://www.python.org/dev/peps/pep-0008/ 
- Use `for x, y in G:` instead of `for x, y in G.vertices():`
- I don't understand how you make the graph for `d == 2` with allowing / disallowing multi edges.
You could directly list the edges of the graph, you know them.


---

Comment by git created at 2020-03-03 16:23:43

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @vipul79321 created at 2020-03-03 16:25:38

Replying to [comment:36 dcoudert]:
> - Please follow the PEP8 coding style  https://www.python.org/dev/peps/pep-0008/
Hopefully I updated it to PEP8 style. If not, please point out where I am missing it.


---

Comment by dcoudert created at 2020-03-04 17:13:10

almost good.
- alignment issue in the ÌNPUT` block

```diff
-        - ``d`` -- The dimension of the desired hypercube as well as the length
-          of the cycle to be placed at each vertex of the `d`-dimensional
-          hypercube. `d` must be a positive integer.
+    - ``d`` -- integer; the dimension of the desired hypercube as well as the
+      length of the cycle to be placed at each vertex of the `d`-dimensional
+      hypercube. `d` must be a positive integer.
```

- empty line missing

```diff
-    `2d + \lfloor \frac{d}{2} \rfloor - 2` ::
-        sage: d = 4
+    `2d + \lfloor \frac{d}{2} \rfloor - 2` ::
+
+        sage: d = 4
```

- nicer presentation

```diff
-        G.add_edges([((0, 0), (0, 1)), ((0, 0), (0, 1)), ((0, 0), (1, 0)), ((0, 1), (2, 1)), ((1, 0), (1, 1)), ((1, 0), (1, 1)), ((1, 1), (3, 1)), ((2, 0), (2, 1)), ((2, 0), (2, 1)), ((2, 0), (3, 0)), ((3, 0), (3, 1)), ((3, 0), (3, 1))])
+        G.add_edges([((0, 0), (0, 1)), ((0, 0), (0, 1)), ((0, 0), (1, 0)),
+                     ((0, 1), (2, 1)), ((1, 0), (1, 1)), ((1, 0), (1, 1)),
+                     ((1, 1), (3, 1)), ((2, 0), (2, 1)), ((2, 0), (2, 1)),
+                     ((2, 0), (3, 0)), ((3, 0), (3, 1)), ((3, 0), (3, 1))])
```



---

Comment by dcoudert created at 2020-03-04 17:19:17

and don't forget to add your name in the authors field.


---

Comment by git created at 2020-03-05 03:40:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2020-03-05 07:14:41

Can you check the error reported by the patchbot ?

Have you check if the documentation builds and displays well ?


---

Comment by git created at 2020-03-05 07:46:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @vipul79321 created at 2020-03-05 07:47:51

Replying to [comment:43 dcoudert]:
> Can you check the error reported by the patchbot ?
Those issues occured in some other part of the code. I have fixed them
> 
> Have you check if the documentation builds and displays well ?
Yes


---

Comment by dcoudert created at 2020-03-05 08:52:41

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2020-03-05 08:52:41

LGTM.


---

Comment by vbraun created at 2020-03-08 11:27:06

Resolution: fixed
