# Issue 23107: p-adic square root

archive/issues_023107.json:
```json
{
    "body": "CC:  roed caruso\n\nThis ticket will implement the square root over unramified entensions of Z_p\n\nIssue created by migration from https://trac.sagemath.org/ticket/23344\n\n",
    "created_at": "2017-06-30T12:48:57Z",
    "labels": [
        "padics",
        "major",
        "enhancement"
    ],
    "title": "p-adic square root",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23107",
    "user": "lubicz"
}
```
CC:  roed caruso

This ticket will implement the square root over unramified entensions of Z_p

Issue created by migration from https://trac.sagemath.org/ticket/23344





---

archive/issue_comments_323199.json:
```json
{
    "body": "Doesn't this already work? This field `L` is an example from the docstring for `Qp.extension`.\n\n```\nsage: F = list(Qp(19)['x'](cyclotomic_polynomial(5)).factor())[0][0]\nsage: L = Qp(19).extension(F, names='a')\nsage: L\nUnramified Extension of 19-adic Field with capped relative precision 20 in a defined by (1 + O(19^20))*x^2 + (5 + 2*19 + 10*19^2 + 14*19^3 + 7*19^4 + 13*19^5 + 5*19^6 + 12*19^7 + 8*19^8 + 4*19^9 + 14*19^10 + 6*19^11 + 5*19^12 + 13*19^13 + 16*19^14 + 4*19^15 + 17*19^16 + 8*19^18 + 4*19^19 + O(19^20))*x + (1 + O(19^20))\nsage: u = L(4+19).sqrt(); u\n2 + 5*19 + 3*19^2 + 11*19^3 + 12*19^4 + 13*19^5 + 11*19^6 + 15*19^7 + 12*19^8 + 18*19^9 + 15*19^10 + 2*19^11 + 9*19^12 + 4*19^13 + 19^15 + 19^16 + 13*19^18 + 3*19^19 + O(19^20)\nsage: u^2\n4 + 19 + O(19^20)\n```\n\nThe syntax `sqrt(L(4+19))` also works.",
    "created_at": "2017-08-24T21:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323199",
    "user": "kedlaya"
}
```

Doesn't this already work? This field `L` is an example from the docstring for `Qp.extension`.

```
sage: F = list(Qp(19)['x'](cyclotomic_polynomial(5)).factor())[0][0]
sage: L = Qp(19).extension(F, names='a')
sage: L
Unramified Extension of 19-adic Field with capped relative precision 20 in a defined by (1 + O(19^20))*x^2 + (5 + 2*19 + 10*19^2 + 14*19^3 + 7*19^4 + 13*19^5 + 5*19^6 + 12*19^7 + 8*19^8 + 4*19^9 + 14*19^10 + 6*19^11 + 5*19^12 + 13*19^13 + 16*19^14 + 4*19^15 + 17*19^16 + 8*19^18 + 4*19^19 + O(19^20))*x + (1 + O(19^20))
sage: u = L(4+19).sqrt(); u
2 + 5*19 + 3*19^2 + 11*19^3 + 12*19^4 + 13*19^5 + 11*19^6 + 15*19^7 + 12*19^8 + 18*19^9 + 15*19^10 + 2*19^11 + 9*19^12 + 4*19^13 + 19^15 + 19^16 + 13*19^18 + 3*19^19 + O(19^20)
sage: u^2
4 + 19 + O(19^20)
```

The syntax `sqrt(L(4+19))` also works.



---

archive/issue_comments_323200.json:
```json
{
    "body": "If I am not mistaken, with the version of sage I am working with (8.0.rc0), the square root is working fine for elements of Qp (even if Qp is embeded in an extension) but not for elements of an extension of Qp (not in Q_p). Continuing your example :\n\n```\nsage: a=L.gen()\nsage: sqrt(4+19*a)\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n<ipython-input-5-842761a28969> in <module>()\n----> 1 sqrt(Integer(4)+Integer(19)*a)\n\n/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/functions/other.pyc in sqrt(x, *args, **kwds)\n   2002         except (AttributeError, TypeError):\n   2003             pass\n-> 2004         return _do_sqrt(x, *args, **kwds)\n   2005 \n   2006 # register sqrt in pynac symbol_table for conversion back from other systems\n\n/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/functions/other.pyc in _do_sqrt(x, prec, extend, all)\n   1903             z = I\n   1904         else:\n-> 1905             z = SR(x) ** one_half\n   1906 \n   1907         if all:\n\n/home/lubicz/sagemath/sage/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.__pow__ (/home/lubicz/sagemath/sage/src/build/cythonized/sage/symbolic/expression.cpp:25800)()\n   3882                            relational_operator(base._gobj))\n   3883         else:\n-> 3884             x = g_pow(base._gobj, nexp._gobj)\n   3885         return new_Expression_from_GEx(base._parent, x)\n   3886 \n\n/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/padics/CR_template.pxi in sage.rings.padics.qadic_flint_CR.CRElement.__pow__ (/home/lubicz/sagemath/sage/src/build/cythonized/sage/rings/padics/qadic_flint_CR.c:20012)()\n    672         elif exact_exp:\n    673             # exact_pow_helper is defined in padic_template_element.pxi\n--> 674             right = exact_pow_helper(&ans.relprec, self.relprec, _right, self.prime_pow)\n    675             if ans.relprec > self.prime_pow.ram_prec_cap:\n    676                 ans.relprec = self.prime_pow.ram_prec_cap\n\n/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/padics/padic_template_element.pxi in sage.rings.padics.qadic_flint_CR.exact_pow_helper (/home/lubicz/sagemath/sage/src/build/cythonized/sage/rings/padics/qadic_flint_CR.c:15216)()\n    545         exp_val = mpz_get_si((<Integer>right.valuation(p)).value)\n    546     elif isinstance(_right, Rational):\n--> 547         raise NotImplementedError\n    548     ansrelprec[0] = relprec + exp_val\n    549     if exp_val > 0 and mpz_cmp_ui(p.value, 2) == 0 and relprec == 1:\n\nNotImplementedError: \n```\n\n\nAnother example which motivates my tickets since I am implementing in sagemath an improved version of the AGM algorithm :\n\n\n```\nsage: R.<x>=Zq(2^10, 20)\nsage: sqrt(1+8*x)\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n<ipython-input-10-25d75e2ffffe> in <module>()\n----> 1 sqrt(Integer(1)+Integer(8)*x)\n\n/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/functions/other.pyc in sqrt(x, *args, **kwds)\n   2002         except (AttributeError, TypeError):\n   2003             pass\n-> 2004         return _do_sqrt(x, *args, **kwds)\n   2005 \n   2006 # register sqrt in pynac symbol_table for conversion back from other systems\n\n/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/functions/other.pyc in _do_sqrt(x, prec, extend, all)\n   1903             z = I\n   1904         else:\n-> 1905             z = SR(x) ** one_half\n   1906 \n   1907         if all:\n\n/home/lubicz/sagemath/sage/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.__pow__ (/home/lubicz/sagemath/sage/src/build/cythonized/sage/symbolic/expression.cpp:25800)()\n   3882                            relational_operator(base._gobj))\n   3883         else:\n-> 3884             x = g_pow(base._gobj, nexp._gobj)\n   3885         return new_Expression_from_GEx(base._parent, x)\n   3886 \n\n/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/padics/CR_template.pxi in sage.rings.padics.qadic_flint_CR.CRElement.__pow__ (/home/lubicz/sagemath/sage/src/build/cythonized/sage/rings/padics/qadic_flint_CR.c:20012)()\n    672         elif exact_exp:\n    673             # exact_pow_helper is defined in padic_template_element.pxi\n--> 674             right = exact_pow_helper(&ans.relprec, self.relprec, _right, self.prime_pow)\n    675             if ans.relprec > self.prime_pow.ram_prec_cap:\n    676                 ans.relprec = self.prime_pow.ram_prec_cap\n\n/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/padics/padic_template_element.pxi in sage.rings.padics.qadic_flint_CR.exact_pow_helper (/home/lubicz/sagemath/sage/src/build/cythonized/sage/rings/padics/qadic_flint_CR.c:15216)()\n    545         exp_val = mpz_get_si((<Integer>right.valuation(p)).value)\n    546     elif isinstance(_right, Rational):\n--> 547         raise NotImplementedError\n    548     ansrelprec[0] = relprec + exp_val\n    549     if exp_val > 0 and mpz_cmp_ui(p.value, 2) == 0 and relprec == 1:\n\nNotImplementedError: \n```\n",
    "created_at": "2017-08-28T07:06:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323200",
    "user": "lubicz"
}
```

If I am not mistaken, with the version of sage I am working with (8.0.rc0), the square root is working fine for elements of Qp (even if Qp is embeded in an extension) but not for elements of an extension of Qp (not in Q_p). Continuing your example :

```
sage: a=L.gen()
sage: sqrt(4+19*a)
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-5-842761a28969> in <module>()
----> 1 sqrt(Integer(4)+Integer(19)*a)

/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/functions/other.pyc in sqrt(x, *args, **kwds)
   2002         except (AttributeError, TypeError):
   2003             pass
-> 2004         return _do_sqrt(x, *args, **kwds)
   2005 
   2006 # register sqrt in pynac symbol_table for conversion back from other systems

/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/functions/other.pyc in _do_sqrt(x, prec, extend, all)
   1903             z = I
   1904         else:
-> 1905             z = SR(x) ** one_half
   1906 
   1907         if all:

/home/lubicz/sagemath/sage/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.__pow__ (/home/lubicz/sagemath/sage/src/build/cythonized/sage/symbolic/expression.cpp:25800)()
   3882                            relational_operator(base._gobj))
   3883         else:
-> 3884             x = g_pow(base._gobj, nexp._gobj)
   3885         return new_Expression_from_GEx(base._parent, x)
   3886 

/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/padics/CR_template.pxi in sage.rings.padics.qadic_flint_CR.CRElement.__pow__ (/home/lubicz/sagemath/sage/src/build/cythonized/sage/rings/padics/qadic_flint_CR.c:20012)()
    672         elif exact_exp:
    673             # exact_pow_helper is defined in padic_template_element.pxi
--> 674             right = exact_pow_helper(&ans.relprec, self.relprec, _right, self.prime_pow)
    675             if ans.relprec > self.prime_pow.ram_prec_cap:
    676                 ans.relprec = self.prime_pow.ram_prec_cap

/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/padics/padic_template_element.pxi in sage.rings.padics.qadic_flint_CR.exact_pow_helper (/home/lubicz/sagemath/sage/src/build/cythonized/sage/rings/padics/qadic_flint_CR.c:15216)()
    545         exp_val = mpz_get_si((<Integer>right.valuation(p)).value)
    546     elif isinstance(_right, Rational):
--> 547         raise NotImplementedError
    548     ansrelprec[0] = relprec + exp_val
    549     if exp_val > 0 and mpz_cmp_ui(p.value, 2) == 0 and relprec == 1:

NotImplementedError: 
```


Another example which motivates my tickets since I am implementing in sagemath an improved version of the AGM algorithm :


```
sage: R.<x>=Zq(2^10, 20)
sage: sqrt(1+8*x)
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-10-25d75e2ffffe> in <module>()
----> 1 sqrt(Integer(1)+Integer(8)*x)

/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/functions/other.pyc in sqrt(x, *args, **kwds)
   2002         except (AttributeError, TypeError):
   2003             pass
-> 2004         return _do_sqrt(x, *args, **kwds)
   2005 
   2006 # register sqrt in pynac symbol_table for conversion back from other systems

/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/functions/other.pyc in _do_sqrt(x, prec, extend, all)
   1903             z = I
   1904         else:
-> 1905             z = SR(x) ** one_half
   1906 
   1907         if all:

/home/lubicz/sagemath/sage/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.__pow__ (/home/lubicz/sagemath/sage/src/build/cythonized/sage/symbolic/expression.cpp:25800)()
   3882                            relational_operator(base._gobj))
   3883         else:
-> 3884             x = g_pow(base._gobj, nexp._gobj)
   3885         return new_Expression_from_GEx(base._parent, x)
   3886 

/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/padics/CR_template.pxi in sage.rings.padics.qadic_flint_CR.CRElement.__pow__ (/home/lubicz/sagemath/sage/src/build/cythonized/sage/rings/padics/qadic_flint_CR.c:20012)()
    672         elif exact_exp:
    673             # exact_pow_helper is defined in padic_template_element.pxi
--> 674             right = exact_pow_helper(&ans.relprec, self.relprec, _right, self.prime_pow)
    675             if ans.relprec > self.prime_pow.ram_prec_cap:
    676                 ans.relprec = self.prime_pow.ram_prec_cap

/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/padics/padic_template_element.pxi in sage.rings.padics.qadic_flint_CR.exact_pow_helper (/home/lubicz/sagemath/sage/src/build/cythonized/sage/rings/padics/qadic_flint_CR.c:15216)()
    545         exp_val = mpz_get_si((<Integer>right.valuation(p)).value)
    546     elif isinstance(_right, Rational):
--> 547         raise NotImplementedError
    548     ansrelprec[0] = relprec + exp_val
    549     if exp_val > 0 and mpz_cmp_ui(p.value, 2) == 0 and relprec == 1:

NotImplementedError: 
```




---

archive/issue_comments_323201.json:
```json
{
    "body": "Replying to [comment:2 lubicz]:\n> If I am not mistaken, with the version of sage I am working with (8.0.rc0), the square root is working fine for elements of Qp (even if Qp is embeded in an extension) but not for elements of an extension of Qp (not in Q_p). \n\nI agree.  The current implementation just calls off to Pari (see line 2774 in `padic_generic_element.pyx`).  It would be good if we could have a native implementation that worked for general extensions (not just unramified ones).",
    "created_at": "2017-08-28T08:01:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323201",
    "user": "roed"
}
```

Replying to [comment:2 lubicz]:
> If I am not mistaken, with the version of sage I am working with (8.0.rc0), the square root is working fine for elements of Qp (even if Qp is embeded in an extension) but not for elements of an extension of Qp (not in Q_p). 

I agree.  The current implementation just calls off to Pari (see line 2774 in `padic_generic_element.pyx`).  It would be good if we could have a native implementation that worked for general extensions (not just unramified ones).



---

archive/issue_comments_323202.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-03-01T15:34:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323202",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_323203.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2018-03-01T15:46:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323203",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_323204.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-03-01T15:52:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323204",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_323205.json:
```json
{
    "body": "Several comments:\n\n- you don't need your function `_artin_schreier` since Sage has already methods (e.g. `roots`) for solving algebraic equations in finite fields\n\n- in the `square_root` method, `prec` shouldn't be the precision cap of the parent but the actual precision of the element, no?\n\n- in the `square_root` method, use the `sqrt` method for computing the square root modulo p (by the way, I don't understand why this part is needed)\n\n- `ceil((prec+1)/2.0)` is also `1 + prec // 2`, isn't it?\n\n- I would say that our recursive implementation is slower that an iterative one, but I'm not sure\n\n- maybe, you could at the same time complete the documentation of the method `sqrt`",
    "created_at": "2018-03-02T13:23:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323205",
    "user": "caruso"
}
```

Several comments:

- you don't need your function `_artin_schreier` since Sage has already methods (e.g. `roots`) for solving algebraic equations in finite fields

- in the `square_root` method, `prec` shouldn't be the precision cap of the parent but the actual precision of the element, no?

- in the `square_root` method, use the `sqrt` method for computing the square root modulo p (by the way, I don't understand why this part is needed)

- `ceil((prec+1)/2.0)` is also `1 + prec // 2`, isn't it?

- I would say that our recursive implementation is slower that an iterative one, but I'm not sure

- maybe, you could at the same time complete the documentation of the method `sqrt`



---

archive/issue_comments_323206.json:
```json
{
    "body": "By the way, this ticket only implements `sqrt` for unramified extensions of `Q2`, is that right? (It's not what is written in the description of the ticket.)\n\n\n```\n    sage: R.<a> = Zq(5^2)\n    sage: sqrt(1+5*a)\n    Traceback (most recent call last):\n    ...\n    NotImplementedError\n```\n",
    "created_at": "2018-03-08T20:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323206",
    "user": "caruso"
}
```

By the way, this ticket only implements `sqrt` for unramified extensions of `Q2`, is that right? (It's not what is written in the description of the ticket.)


```
    sage: R.<a> = Zq(5^2)
    sage: sqrt(1+5*a)
    Traceback (most recent call last):
    ...
    NotImplementedError
```




---

archive/issue_comments_323207.json:
```json
{
    "body": "Replying to [comment:13 caruso]:\n> By the way, this ticket only implements `sqrt` for unramified extensions of `Q2`, is that right? (It's not what is written in the description of the ticket.)\n\nYeah, I think that's correct.  It would be nice to have it also include an implementation for other primes, but that's not currently in the code.",
    "created_at": "2018-03-08T20:22:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323207",
    "user": "roed"
}
```

Replying to [comment:13 caruso]:
> By the way, this ticket only implements `sqrt` for unramified extensions of `Q2`, is that right? (It's not what is written in the description of the ticket.)

Yeah, I think that's correct.  It would be nice to have it also include an implementation for other primes, but that's not currently in the code.



---

archive/issue_comments_323208.json:
```json
{
    "body": "My answer to the first comments of Xavier: \\\\\n1) artin schreier is very efficient to solve equations of the form \nx2=ax+b by using a square and multiply type algorithm it shoud perform in ln(n)2 (where n is the degree of Q_q / Q_p) operations in Q_2. I don't know what is the algorithm implemented in roots but it should be less efficient, no ?\\\\\n\n2) yes I will make the change \\\\\n3) I have search through the square_root method and I could find only to lines with the keyword sqrt : \n* ans = self.parent()(self.__pari__().sqrt())\n*  z = self._inv_sqrt(prec)\nthe first one is for calling the pari implementation and the second one is a call to the inverse square root method.\\\\\n4) yes I will make the change\\\\\n5) ok\\\\\n6) Ok \\\\\n7) I will extend the implementation for odd primes p.\nThanks for your comments and you help !",
    "created_at": "2018-03-08T20:50:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323208",
    "user": "lubicz"
}
```

My answer to the first comments of Xavier: \\
1) artin schreier is very efficient to solve equations of the form 
x2=ax+b by using a square and multiply type algorithm it shoud perform in ln(n)2 (where n is the degree of Q_q / Q_p) operations in Q_2. I don't know what is the algorithm implemented in roots but it should be less efficient, no ?\\

2) yes I will make the change \\
3) I have search through the square_root method and I could find only to lines with the keyword sqrt : 
* ans = self.parent()(self.__pari__().sqrt())
*  z = self._inv_sqrt(prec)
the first one is for calling the pari implementation and the second one is a call to the inverse square root method.\\
4) yes I will make the change\\
5) ok\\
6) Ok \\
7) I will extend the implementation for odd primes p.
Thanks for your comments and you help !



---

archive/issue_comments_323209.json:
```json
{
    "body": "I've pushed a new implementation which works over any extension of `Qp` for p > 2 and any unramified extension of `Q2` (the case of ramified extensions of `Q2` is much more subtle).\n\nPS: I've deleted your code; feel free to revert my changes if you think that it's appropriate.\n----\nNew commits:",
    "created_at": "2018-03-08T23:01:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323209",
    "user": "caruso"
}
```

I've pushed a new implementation which works over any extension of `Qp` for p > 2 and any unramified extension of `Q2` (the case of ramified extensions of `Q2` is much more subtle).

PS: I've deleted your code; feel free to revert my changes if you think that it's appropriate.
----
New commits:



---

archive/issue_comments_323210.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-11T19:18:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323210",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323211.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-03-11T19:20:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323211",
    "user": "caruso"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_323212.json:
```json
{
    "body": "I've extended my implementation to all p-adic fields (including ramified extensions of Q_2).\n\nNeeds review.",
    "created_at": "2018-03-11T19:20:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323212",
    "user": "caruso"
}
```

I've extended my implementation to all p-adic fields (including ramified extensions of Q_2).

Needs review.



---

archive/issue_comments_323213.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-30T08:13:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323213",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323214.json:
```json
{
    "body": "In  \ndef _square_root(self):\n\n- replaced  parent = self.parent() by ring = self.parent()\n- corrected a bug in the computation of Artin-Schreier equation (carac 2).\nPushed the changes on trac.",
    "created_at": "2018-03-30T08:28:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323214",
    "user": "lubicz"
}
```

In  
def _square_root(self):

- replaced  parent = self.parent() by ring = self.parent()
- corrected a bug in the computation of Artin-Schreier equation (carac 2).
Pushed the changes on trac.



---

archive/issue_comments_323215.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-03-30T12:51:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323215",
    "user": "lubicz"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_323216.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-03-31T06:27:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323216",
    "user": "chapoton"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_323217.json:
```json
{
    "body": "patchbot reports failing doctests..",
    "created_at": "2018-03-31T06:27:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323217",
    "user": "chapoton"
}
```

patchbot reports failing doctests..



---

archive/issue_comments_323218.json:
```json
{
    "body": "It looks like many of the failures result from different choices of square root, but I agree that they need to be fixed.",
    "created_at": "2018-03-31T07:06:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323218",
    "user": "roed"
}
```

It looks like many of the failures result from different choices of square root, but I agree that they need to be fixed.



---

archive/issue_comments_323219.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-31T10:41:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323219",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323220.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-03-31T10:42:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323220",
    "user": "caruso"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_323221.json:
```json
{
    "body": "As David pointed out, the issue was due to the choice/ordering of square roots (which was not consistent when precision varies). I fixed it. Let's see what the patchbot says now.",
    "created_at": "2018-03-31T10:42:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323221",
    "user": "caruso"
}
```

As David pointed out, the issue was due to the choice/ordering of square roots (which was not consistent when precision varies). I fixed it. Let's see what the patchbot says now.



---

archive/issue_comments_323222.json:
```json
{
    "body": "bot is green",
    "created_at": "2018-03-31T16:52:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323222",
    "user": "chapoton"
}
```

bot is green



---

archive/issue_comments_323223.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-04-02T10:31:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323223",
    "user": "caruso"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_323224.json:
```json
{
    "body": "OK. So, I give a positive review to this ticket again.\nPlease change this if you disagree.",
    "created_at": "2018-04-02T10:31:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323224",
    "user": "caruso"
}
```

OK. So, I give a positive review to this ticket again.
Please change this if you disagree.



---

archive/issue_comments_323225.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-08T17:27:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23107#issuecomment-323225",
    "user": "vbraun"
}
```

Resolution: fixed
