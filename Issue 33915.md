# Issue 33915: Fix broken bootstrap (AC_LIB_RPATH etc.)

archive/issues_033915.json:
```json
{
    "body": "CC:  @culler @dimpase @kiwifb @isuruf @nbruin\n\nBroken in #29549, because I forgot to add some files.\n\nIssue created by migration from https://trac.sagemath.org/ticket/34152\n\n",
    "created_at": "2022-07-11T16:11:57Z",
    "labels": [
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "Fix broken bootstrap (AC_LIB_RPATH etc.)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33915",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @culler @dimpase @kiwifb @isuruf @nbruin

Broken in #29549, because I forgot to add some files.

Issue created by migration from https://trac.sagemath.org/ticket/34152





---

archive/issue_comments_480885.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-07-11T16:15:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480885",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_comments_480886.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to build: configure.",
    "created_at": "2022-07-11T16:15:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480886",
    "user": "https://github.com/mkoeppe"
}
```

Changing component from PLEASE CHANGE to build: configure.



---

archive/issue_comments_480887.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-07-11T16:17:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480887",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_480888.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-11T16:34:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480888",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480889.json:
```json
{
    "body": "vendoring more and more of gnulib...\n\nshould we instead install,on demand, gnulib itself?",
    "created_at": "2022-07-11T18:18:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480889",
    "user": "https://github.com/dimpase"
}
```

vendoring more and more of gnulib...

should we instead install,on demand, gnulib itself?



---

archive/issue_comments_480890.json:
```json
{
    "body": "This is how Gnulib is designed to be used. \n\"Its components are intended to be shared at the source level, rather than being a library that gets built, installed, and linked against. Thus, there is no distribution tarball; the idea is to copy files from Gnulib into your own source tree.\"\nhttps://www.gnu.org/software/gnulib/",
    "created_at": "2022-07-11T19:18:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480890",
    "user": "https://github.com/mkoeppe"
}
```

This is how Gnulib is designed to be used. 
"Its components are intended to be shared at the source level, rather than being a library that gets built, installed, and linked against. Thus, there is no distribution tarball; the idea is to copy files from Gnulib into your own source tree."
https://www.gnu.org/software/gnulib/



---

archive/issue_comments_480891.json:
```json
{
    "body": "it seems that \"copying\" is meant to be done from an installed `gnulib` version.\nThat's how I read https://www.mail-archive.com/bug-gnulib`@`gnu.org/msg36476.html\nwhere a way to do this is discussed.\n`gnulib` has a script to facilitate such an installation: https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh",
    "created_at": "2022-07-11T22:35:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480891",
    "user": "https://github.com/dimpase"
}
```

it seems that "copying" is meant to be done from an installed `gnulib` version.
That's how I read https://www.mail-archive.com/bug-gnulib`@`gnu.org/msg36476.html
where a way to do this is discussed.
`gnulib` has a script to facilitate such an installation: https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh



---

archive/issue_comments_480892.json:
```json
{
    "body": "There's no such thing as an \"installed\" gnulib.",
    "created_at": "2022-07-11T22:38:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480892",
    "user": "https://github.com/mkoeppe"
}
```

There's no such thing as an "installed" gnulib.



---

archive/issue_comments_480893.json:
```json
{
    "body": "The workflow with gnulib is documented in https://www.gnu.org/software/gnulib/manual/html_node/Invoking-gnulib_002dtool.html",
    "created_at": "2022-07-11T22:46:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480893",
    "user": "https://github.com/mkoeppe"
}
```

The workflow with gnulib is documented in https://www.gnu.org/software/gnulib/manual/html_node/Invoking-gnulib_002dtool.html



---

archive/issue_comments_480894.json:
```json
{
    "body": "Replying to [comment:8 dimpase]:\n> `gnulib` has a script to facilitate such an installation: https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh\n\n\nfrom https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh#L36:\n\"The package maintainer may choose to use or not use git submodules.\" - I chose to not use git submodules.",
    "created_at": "2022-07-11T22:53:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480894",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:8 dimpase]:
> `gnulib` has a script to facilitate such an installation: https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh


from https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh#L36:
"The package maintainer may choose to use or not use git submodules." - I chose to not use git submodules.



---

archive/issue_comments_480895.json:
```json
{
    "body": "Replying to [comment:9 mkoeppe]:\n> There's no such thing as an \"installed\" gnulib.\n\n\nthere certainly is an executable/script called `gnulib-tool` - which is certainly a part of installed gnulib",
    "created_at": "2022-07-11T22:54:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480895",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:9 mkoeppe]:
> There's no such thing as an "installed" gnulib.


there certainly is an executable/script called `gnulib-tool` - which is certainly a part of installed gnulib



---

archive/issue_comments_480896.json:
```json
{
    "body": "\"gnulib-tool is not installed in a standard directory that is contained in the PATH variable. It needs to be run directly in the directory that contains the Gnulib source code.\" https://www.gnu.org/software/gnulib/manual/html_node/Invoking-gnulib_002dtool.html",
    "created_at": "2022-07-11T23:04:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480896",
    "user": "https://github.com/mkoeppe"
}
```

"gnulib-tool is not installed in a standard directory that is contained in the PATH variable. It needs to be run directly in the directory that contains the Gnulib source code." https://www.gnu.org/software/gnulib/manual/html_node/Invoking-gnulib_002dtool.html



---

archive/issue_comments_480897.json:
```json
{
    "body": "> gnulib-tool is not installed in a standard directory that is contained in the PATH variable\n\nOK, fine, but its directory has to appear somehow",
    "created_at": "2022-07-11T23:05:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480897",
    "user": "https://github.com/dimpase"
}
```

> gnulib-tool is not installed in a standard directory that is contained in the PATH variable

OK, fine, but its directory has to appear somehow



---

archive/issue_comments_480898.json:
```json
{
    "body": "Yes, a developer who wants to update the portions of Gnulib that have been copied into the source tree will use a git clone of gnulib and invoke gnulib-tool from there.",
    "created_at": "2022-07-11T23:08:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480898",
    "user": "https://github.com/mkoeppe"
}
```

Yes, a developer who wants to update the portions of Gnulib that have been copied into the source tree will use a git clone of gnulib and invoke gnulib-tool from there.



---

archive/issue_comments_480899.json:
```json
{
    "body": "Replying to [comment:11 mkoeppe]:\n> Replying to [comment:8 dimpase]:\n> > `gnulib` has a script to facilitate such an installation: https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh\n\n> \n> from https://www.gnu.org/software/gnulib/manual/html_node/Invoking-gnulib_002dtool.html:\n> \"The package maintainer may choose to use or not use git submodules.\" - I chose to not use git submodules.\n> \n\n\nThe quote you attribute to `Invoking-gnulib_002dtool.html` is actually from `gitsub.sh`.\n\n`gitsub.sh` can do `subcheckouts` rather than `submodules`.\n\nThe docs don't even discuss manual vendoring of files, I think.",
    "created_at": "2022-07-11T23:10:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480899",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:11 mkoeppe]:
> Replying to [comment:8 dimpase]:
> > `gnulib` has a script to facilitate such an installation: https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh

> 
> from https://www.gnu.org/software/gnulib/manual/html_node/Invoking-gnulib_002dtool.html:
> "The package maintainer may choose to use or not use git submodules." - I chose to not use git submodules.
> 


The quote you attribute to `Invoking-gnulib_002dtool.html` is actually from `gitsub.sh`.

`gitsub.sh` can do `subcheckouts` rather than `submodules`.

The docs don't even discuss manual vendoring of files, I think.



---

archive/issue_comments_480900.json:
```json
{
    "body": "Replying to [comment:16 dimpase]:\n> Replying to [comment:11 mkoeppe]:\n> > Replying to [comment:8 dimpase]:\n> > > `gnulib` has a script to facilitate such an installation: https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh\n\n> > \n> > from https://www.gnu.org/software/gnulib/manual/html_node/Invoking-gnulib_002dtool.html:\n> > \"The package maintainer may choose to use or not use git submodules.\" - I chose to not use git submodules.\n> > \n\n> \n> The quote you attribute to `Invoking-gnulib_002dtool.html` is actually from `gitsub.sh`.\n\n\nYes, sorry, wrong link.\nFixed now: I meant to paste https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh#L36",
    "created_at": "2022-07-11T23:11:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480900",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:16 dimpase]:
> Replying to [comment:11 mkoeppe]:
> > Replying to [comment:8 dimpase]:
> > > `gnulib` has a script to facilitate such an installation: https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh

> > 
> > from https://www.gnu.org/software/gnulib/manual/html_node/Invoking-gnulib_002dtool.html:
> > "The package maintainer may choose to use or not use git submodules." - I chose to not use git submodules.
> > 

> 
> The quote you attribute to `Invoking-gnulib_002dtool.html` is actually from `gitsub.sh`.


Yes, sorry, wrong link.
Fixed now: I meant to paste https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh#L36



---

archive/issue_comments_480901.json:
```json
{
    "body": "Replying to [comment:16 dimpase]:\n> The docs don't even discuss manual vendoring of files, I think.\n\n\nPlease, Dima, the whole manual talks about nothing else.",
    "created_at": "2022-07-11T23:13:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480901",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:16 dimpase]:
> The docs don't even discuss manual vendoring of files, I think.


Please, Dima, the whole manual talks about nothing else.



---

archive/issue_comments_480902.json:
```json
{
    "body": "Replying to [comment:15 mkoeppe]:\n> Yes, a developer who wants to update the portions of Gnulib that have been copied into the source tree will use a git clone of gnulib and invoke gnulib-tool from there.\n\n\nbut not manually - rather, as a part of pre-configuring a project. Checking in our repo huge chunks of gnulib is suboptimal.",
    "created_at": "2022-07-11T23:13:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480902",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:15 mkoeppe]:
> Yes, a developer who wants to update the portions of Gnulib that have been copied into the source tree will use a git clone of gnulib and invoke gnulib-tool from there.


but not manually - rather, as a part of pre-configuring a project. Checking in our repo huge chunks of gnulib is suboptimal.



---

archive/issue_comments_480903.json:
```json
{
    "body": "Replying to [comment:19 dimpase]:\n> Replying to [comment:15 mkoeppe]:\n> > Yes, a developer who wants to update the portions of Gnulib that have been copied into the source tree will use a git clone of gnulib and invoke gnulib-tool from there.\n\n> \n> but not manually\n\n\nIt's called the \"initial import\". https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html\nThis is what I did in #29549 (except that I forgot to `git add` some files).",
    "created_at": "2022-07-11T23:15:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480903",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:19 dimpase]:
> Replying to [comment:15 mkoeppe]:
> > Yes, a developer who wants to update the portions of Gnulib that have been copied into the source tree will use a git clone of gnulib and invoke gnulib-tool from there.

> 
> but not manually


It's called the "initial import". https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html
This is what I did in #29549 (except that I forgot to `git add` some files).



---

archive/issue_comments_480904.json:
```json
{
    "body": "Replying to [comment:18 mkoeppe]:\n> Replying to [comment:16 dimpase]:\n> > The docs don't even discuss manual vendoring of files, I think.\n\n> \n> Please, Dima, the whole manual talks about nothing else.\n\n\nThis manual is older than `git`, you know, no wonder it won't mention it.\n\n`gitsub.sh` is for the modern way of doing things, and that's what `gnulib` maintainer uses.",
    "created_at": "2022-07-11T23:19:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480904",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:18 mkoeppe]:
> Replying to [comment:16 dimpase]:
> > The docs don't even discuss manual vendoring of files, I think.

> 
> Please, Dima, the whole manual talks about nothing else.


This manual is older than `git`, you know, no wonder it won't mention it.

`gitsub.sh` is for the modern way of doing things, and that's what `gnulib` maintainer uses.



---

archive/issue_comments_480905.json:
```json
{
    "body": "Replying to [comment:21 dimpase]:\n> `gitsub.sh` is for the modern way of doing things, and that's what `gnulib` maintainer uses.\n\n\nIt's a new option of how to work with gnulib, but it offers no benefits for us.",
    "created_at": "2022-07-11T23:23:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480905",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:21 dimpase]:
> `gitsub.sh` is for the modern way of doing things, and that's what `gnulib` maintainer uses.


It's a new option of how to work with gnulib, but it offers no benefits for us.



---

archive/issue_comments_480906.json:
```json
{
    "body": "Replying to [comment:21 dimpase]:\n> This manual is older than `git`, you know, no wonder it won't mention it.\n\n\nUse with git is documented in https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html; it describes several approaches.",
    "created_at": "2022-07-11T23:27:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480906",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:21 dimpase]:
> This manual is older than `git`, you know, no wonder it won't mention it.


Use with git is documented in https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html; it describes several approaches.



---

archive/issue_comments_480907.json:
```json
{
    "body": "Replying to [comment:19 dimpase]:\n> Checking in our repo huge chunks of gnulib is suboptimal.\n\n\n#29549 added 2 files, the current ticket is adding 4 more.",
    "created_at": "2022-07-11T23:31:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480907",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:19 dimpase]:
> Checking in our repo huge chunks of gnulib is suboptimal.


#29549 added 2 files, the current ticket is adding 4 more.



---

archive/issue_comments_480908.json:
```json
{
    "body": "yes, about 5000 loc, likely to cause trouble if not updated on time.\n\ndownstreams wouldn't be happy, maintenance is problematic.\n\nwhy vendor if it can be avoided?",
    "created_at": "2022-07-12T07:03:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480908",
    "user": "https://github.com/dimpase"
}
```

yes, about 5000 loc, likely to cause trouble if not updated on time.

downstreams wouldn't be happy, maintenance is problematic.

why vendor if it can be avoided?



---

archive/issue_comments_480909.json:
```json
{
    "body": "Once again, this is the standard way to use gnulib.",
    "created_at": "2022-07-12T07:14:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480909",
    "user": "https://github.com/mkoeppe"
}
```

Once again, this is the standard way to use gnulib.



---

archive/issue_comments_480910.json:
```json
{
    "body": "Replying to [comment:25 dimpase]:\n> why vendor if it can be avoided?\n\n\nBecause the alternative (the `gitsub.sh` -- which is to be copied into the source tree by the way) introduces a ridiculous amount of complexity.",
    "created_at": "2022-07-12T07:16:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480910",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:25 dimpase]:
> why vendor if it can be avoided?


Because the alternative (the `gitsub.sh` -- which is to be copied into the source tree by the way) introduces a ridiculous amount of complexity.



---

archive/issue_comments_480911.json:
```json
{
    "body": "How about just requiring `gnulib-tool` ? macOS purists may have to jump an extra hoop, but it's very minor.",
    "created_at": "2022-07-12T08:32:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480911",
    "user": "https://github.com/dimpase"
}
```

How about just requiring `gnulib-tool` ? macOS purists may have to jump an extra hoop, but it's very minor.



---

archive/issue_comments_480912.json:
```json
{
    "body": "here is a way to use gnulib-tool instead.\n\nBased on the original branch of this ticket.\nBy the way, I also noticed that gettext is still mentioned in a lot of `tox`-related and CI-related files.\n\n---\nNew commits:",
    "created_at": "2022-07-12T11:42:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480912",
    "user": "https://github.com/dimpase"
}
```

here is a way to use gnulib-tool instead.

Based on the original branch of this ticket.
By the way, I also noticed that gettext is still mentioned in a lot of `tox`-related and CI-related files.

---
New commits:



---

archive/issue_comments_480913.json:
```json
{
    "body": "No, we cannot assume that `gnulib-tool` (= all of gnulib) is available in the system.",
    "created_at": "2022-07-12T12:57:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480913",
    "user": "https://github.com/mkoeppe"
}
```

No, we cannot assume that `gnulib-tool` (= all of gnulib) is available in the system.



---

archive/issue_comments_480914.json:
```json
{
    "body": "... because comment:9",
    "created_at": "2022-07-12T13:54:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480914",
    "user": "https://github.com/mkoeppe"
}
```

... because comment:9



---

archive/issue_comments_480915.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-12T14:31:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480915",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_480916.json:
```json
{
    "body": "Replying to [comment:32 mkoeppe]:\n> ... because comment:9\n\n\nall the systems I checked either have `gnulib` package (with a reasonably recent, complete, version of `gnuilib`), or none at all, and then\nit can be installed (ok, ok, cloned from its repo, and PATH adjusted accordingly)",
    "created_at": "2022-07-12T14:34:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480916",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:32 mkoeppe]:
> ... because comment:9


all the systems I checked either have `gnulib` package (with a reasonably recent, complete, version of `gnuilib`), or none at all, and then
it can be installed (ok, ok, cloned from its repo, and PATH adjusted accordingly)



---

archive/issue_comments_480917.json:
```json
{
    "body": "Replying to [comment:34 dimpase]:\n> or none at all\n\n\nexactly, that's the problem\n\n> and then\n> it can be installed (ok, ok, cloned from its repo, and PATH adjusted accordingly)\n\n\nBut we certainly do not want to force every developer who wants to run `./bootstrap` to do that.",
    "created_at": "2022-07-12T15:03:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480917",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:34 dimpase]:
> or none at all


exactly, that's the problem

> and then
> it can be installed (ok, ok, cloned from its repo, and PATH adjusted accordingly)


But we certainly do not want to force every developer who wants to run `./bootstrap` to do that.



---

archive/issue_comments_480918.json:
```json
{
    "body": "Replying to [comment:36 mkoeppe]:\n> Replying to [comment:34 dimpase]:\n> > or none at all\n\n> \n> exactly, that's the problem\n> \n> > and then\n> > it can be installed (ok, ok, cloned from its repo, and PATH adjusted accordingly)\n\n> \n> But we certainly do not want to force every developer who wants to run `./bootstrap` to do that.\n\n\nonly these who use macOS and only these who do not use anything but Xcode might have to do this. And among the latter only these who need to  build ./configure\n\nIt's certainly not \"every developer\".",
    "created_at": "2022-07-12T16:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480918",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:36 mkoeppe]:
> Replying to [comment:34 dimpase]:
> > or none at all

> 
> exactly, that's the problem
> 
> > and then
> > it can be installed (ok, ok, cloned from its repo, and PATH adjusted accordingly)

> 
> But we certainly do not want to force every developer who wants to run `./bootstrap` to do that.


only these who use macOS and only these who do not use anything but Xcode might have to do this. And among the latter only these who need to  build ./configure

It's certainly not "every developer".



---

archive/issue_comments_480919.json:
```json
{
    "body": "Assuming that gnulib is installed in the system directly contradicts the intentions of upstream.\n\nAnd neither homebrew nor conda have a gnulib package.",
    "created_at": "2022-07-12T16:19:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480919",
    "user": "https://github.com/mkoeppe"
}
```

Assuming that gnulib is installed in the system directly contradicts the intentions of upstream.

And neither homebrew nor conda have a gnulib package.



---

archive/issue_comments_480920.json:
```json
{
    "body": "Replying to [comment:38 mkoeppe]:\n> Assuming that gnulib is installed in the system directly contradicts the intentions of upstream.\n\n\none would expect the system maintainers to update reasonably often.\n(indeed, e.g. on Debian stable and Fedora 34 gnulib is dated 2021; it appears that https://repology.org/project/gnulib/versions is not complete/up to date, e.g. is doesn't show Fedora packages).\n\nNo need for us to do this maintainance job.\n\n> \n> And neither homebrew nor conda have a gnulib package.\n\nfor Homebrew we can actually make one; not sure how hard it's for conda",
    "created_at": "2022-07-12T16:35:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480920",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:38 mkoeppe]:
> Assuming that gnulib is installed in the system directly contradicts the intentions of upstream.


one would expect the system maintainers to update reasonably often.
(indeed, e.g. on Debian stable and Fedora 34 gnulib is dated 2021; it appears that https://repology.org/project/gnulib/versions is not complete/up to date, e.g. is doesn't show Fedora packages).

No need for us to do this maintainance job.

> 
> And neither homebrew nor conda have a gnulib package.

for Homebrew we can actually make one; not sure how hard it's for conda



---

archive/issue_comments_480921.json:
```json
{
    "body": "Let me try to explain it again:\n\nUpstream states clearly that gnulib is not to be installed.\nAnd indeed, it does not have a `make install` target.\n\nWhen Debian/Fedora/... are shipping gnulib, it is likely for the purpose of implementing their policy when building packages -- i.e., updating the vendored portions of gnulib of a package before starting the build.",
    "created_at": "2022-07-12T16:55:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480921",
    "user": "https://github.com/mkoeppe"
}
```

Let me try to explain it again:

Upstream states clearly that gnulib is not to be installed.
And indeed, it does not have a `make install` target.

When Debian/Fedora/... are shipping gnulib, it is likely for the purpose of implementing their policy when building packages -- i.e., updating the vendored portions of gnulib of a package before starting the build.



---

archive/issue_comments_480922.json:
```json
{
    "body": "Replying to [comment:40 mkoeppe]:\n> Let me try to explain it again:\n> \n> Upstream states clearly that gnulib is not to be installed.\n> And indeed, it does not have a `make install` target.\n> \n> When !Debian/Fedora/... are shipping gnulib, it is likely for the purpose of implementing their policy when building packages -- i.e., updating the vendored portions of gnulib of a package before starting the build.\n\n\nMy reading is that gnulib's upstream doesn't want gnulib to be vendored, either, as it leads to using outdated gnulib.\nThe upstream wants a fresh version to be used (well, this is understandable). That's why they promote `gitsub.sh`.",
    "created_at": "2022-07-12T17:13:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480922",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:40 mkoeppe]:
> Let me try to explain it again:
> 
> Upstream states clearly that gnulib is not to be installed.
> And indeed, it does not have a `make install` target.
> 
> When !Debian/Fedora/... are shipping gnulib, it is likely for the purpose of implementing their policy when building packages -- i.e., updating the vendored portions of gnulib of a package before starting the build.


My reading is that gnulib's upstream doesn't want gnulib to be vendored, either, as it leads to using outdated gnulib.
The upstream wants a fresh version to be used (well, this is understandable). That's why they promote `gitsub.sh`.



---

archive/issue_comments_480923.json:
```json
{
    "body": "Replying to [comment:41 dimpase]:\n> My reading is that gnulib's upstream doesn't want gnulib to be vendored\n\n\nMy branch does not \"vendor\" gnulib. It has imported the needed gnulib modules into our source tree. This is the standard documented usage.",
    "created_at": "2022-07-12T17:16:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480923",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:41 dimpase]:
> My reading is that gnulib's upstream doesn't want gnulib to be vendored


My branch does not "vendor" gnulib. It has imported the needed gnulib modules into our source tree. This is the standard documented usage.



---

archive/issue_comments_480924.json:
```json
{
    "body": "Replying to [comment:41 dimpase]:\n> That's why they promote `gitsub.sh`.\n\n\nThey don't \"promote\" it. The entire manual only *mentions* the existence of this file. see https://www.gnu.org/software/gnulib/manual/gnulib.html",
    "created_at": "2022-07-12T17:25:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480924",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:41 dimpase]:
> That's why they promote `gitsub.sh`.


They don't "promote" it. The entire manual only *mentions* the existence of this file. see https://www.gnu.org/software/gnulib/manual/gnulib.html



---

archive/issue_comments_480925.json:
```json
{
    "body": "Replying to [comment:41 dimpase]:\n> The upstream wants a fresh version to be used\n\n\nBut not \"fresh\" as in \"whatever is in upstream gnulib HEAD\" whenever someone runs `./bootstrap`.\n\nUpdating the imported gnulib modules is something that the maintainer of a package does explicitly. For example, gettext does use `gitsub.sh` (in \"submodule\" mode): updating is done by a maintainer - that's a commit.",
    "created_at": "2022-07-12T17:40:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480925",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:41 dimpase]:
> The upstream wants a fresh version to be used


But not "fresh" as in "whatever is in upstream gnulib HEAD" whenever someone runs `./bootstrap`.

Updating the imported gnulib modules is something that the maintainer of a package does explicitly. For example, gettext does use `gitsub.sh` (in "submodule" mode): updating is done by a maintainer - that's a commit.



---

archive/issue_comments_480926.json:
```json
{
    "body": "the relationship between gettext and gnulib is akin to the relationship between individual strands of pasta in a spaghetti bowl :-)",
    "created_at": "2022-07-12T18:27:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480926",
    "user": "https://github.com/dimpase"
}
```

the relationship between gettext and gnulib is akin to the relationship between individual strands of pasta in a spaghetti bowl :-)



---

archive/issue_comments_480927.json:
```json
{
    "body": "Replying to [comment:44 mkoeppe]:\n> Replying to [comment:41 dimpase]:\n> > The upstream wants a fresh version to be used\n\n> \n> But not \"fresh\" as in \"whatever is in upstream gnulib HEAD\" whenever someone runs `./bootstrap`.\n> \n\n\nbut, how fresh? Do they advice to age a version in a wine cask? \n\n\n> Updating the imported gnulib modules is something that the maintainer of a package does explicitly. For example, gettext does use `gitsub.sh` (in \"submodule\" mode): updating is done by a maintainer - that's a commit.\n\n\nAren't they maintained by the same people?",
    "created_at": "2022-07-12T18:31:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480927",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:44 mkoeppe]:
> Replying to [comment:41 dimpase]:
> > The upstream wants a fresh version to be used

> 
> But not "fresh" as in "whatever is in upstream gnulib HEAD" whenever someone runs `./bootstrap`.
> 


but, how fresh? Do they advice to age a version in a wine cask? 


> Updating the imported gnulib modules is something that the maintainer of a package does explicitly. For example, gettext does use `gitsub.sh` (in "submodule" mode): updating is done by a maintainer - that's a commit.


Aren't they maintained by the same people?



---

archive/issue_comments_480928.json:
```json
{
    "body": "Replying to [comment:46 dimpase]:\n> Replying to [comment:44 mkoeppe]:\n> > Replying to [comment:41 dimpase]:\n> > > The upstream wants a fresh version to be used\n\n> > \n> > But not \"fresh\" as in \"whatever is in upstream gnulib HEAD\" whenever someone runs `./bootstrap`.\n> > \n\n> \n> but, how fresh?\n\n\nUpdate, test, commit, as usual",
    "created_at": "2022-07-12T18:34:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480928",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:46 dimpase]:
> Replying to [comment:44 mkoeppe]:
> > Replying to [comment:41 dimpase]:
> > > The upstream wants a fresh version to be used

> > 
> > But not "fresh" as in "whatever is in upstream gnulib HEAD" whenever someone runs `./bootstrap`.
> > 

> 
> but, how fresh?


Update, test, commit, as usual



---

archive/issue_comments_480929.json:
```json
{
    "body": "the gettext worked for us without committing any files/modules from it, at all. I don't see how using gnulib instead is going to break anything.",
    "created_at": "2022-07-12T18:46:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480929",
    "user": "https://github.com/dimpase"
}
```

the gettext worked for us without committing any files/modules from it, at all. I don't see how using gnulib instead is going to break anything.



---

archive/issue_comments_480930.json:
```json
{
    "body": "Before #29549, we were getting our files at `./bootstrap` time from a system installation of `gettextize`. `gettextize` has the files that we need because gettext has imported these gnulib modules - see for example https://github.com/autotools-mirror/gettext/blob/master/autogen.sh#L168 for iconv.",
    "created_at": "2022-07-12T18:57:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480930",
    "user": "https://github.com/mkoeppe"
}
```

Before #29549, we were getting our files at `./bootstrap` time from a system installation of `gettextize`. `gettextize` has the files that we need because gettext has imported these gnulib modules - see for example https://github.com/autotools-mirror/gettext/blob/master/autogen.sh#L168 for iconv.



---

archive/issue_comments_480931.json:
```json
{
    "body": "#29549 followed the advice from Bruno Haible that you relayed in #27823#comment:52 (https://trac.sagemath.org/ticket/29549#comment:3). \nExcept for the mistake of forgetting `git add` for some of the files, which is entirely my own.",
    "created_at": "2022-07-12T19:04:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480931",
    "user": "https://github.com/mkoeppe"
}
```

#29549 followed the advice from Bruno Haible that you relayed in #27823#comment:52 (https://trac.sagemath.org/ticket/29549#comment:3). 
Except for the mistake of forgetting `git add` for some of the files, which is entirely my own.



---

archive/issue_comments_480932.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-07-12T20:35:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480932",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_comments_480933.json:
```json
{
    "body": "I don't see how advice from Haible says that importing means copying+committing, rather than calling gnulib-tool every time autoconf has to be run.",
    "created_at": "2022-07-12T20:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480933",
    "user": "https://github.com/dimpase"
}
```

I don't see how advice from Haible says that importing means copying+committing, rather than calling gnulib-tool every time autoconf has to be run.



---

archive/issue_comments_480934.json:
```json
{
    "body": "Replying to [comment:52 dimpase]:\n> I don't see how advice from Haible says that importing means copying+committing\n\n\nThat message only says, don't try to get it from gettext, get it from gnulib instead.",
    "created_at": "2022-07-12T21:01:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480934",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:52 dimpase]:
> I don't see how advice from Haible says that importing means copying+committing


That message only says, don't try to get it from gettext, get it from gnulib instead.



---

archive/issue_comments_480935.json:
```json
{
    "body": "I responded to your question in comment:48.",
    "created_at": "2022-07-12T21:02:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480935",
    "user": "https://github.com/mkoeppe"
}
```

I responded to your question in comment:48.



---

archive/issue_comments_480936.json:
```json
{
    "body": "I don't think you responded to my question in comment:48",
    "created_at": "2022-07-12T21:44:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480936",
    "user": "https://github.com/dimpase"
}
```

I don't think you responded to my question in comment:48



---

archive/issue_comments_480937.json:
```json
{
    "body": "sorry, I see committing a bunch of files from another project as a regression (unneeded vendoring).",
    "created_at": "2022-07-12T21:47:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480937",
    "user": "https://github.com/dimpase"
}
```

sorry, I see committing a bunch of files from another project as a regression (unneeded vendoring).



---

archive/issue_comments_480938.json:
```json
{
    "body": "Replying to [comment:55 dimpase]:\n> I don't think you responded to my question in comment:48\n\n\nTry rephrasing your question then please",
    "created_at": "2022-07-12T21:56:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480938",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:55 dimpase]:
> I don't think you responded to my question in comment:48


Try rephrasing your question then please



---

archive/issue_comments_480939.json:
```json
{
    "body": "Replying to [comment:56 dimpase]:\n> sorry, I see committing a bunch of files from another project as a regression (unneeded vendoring).\n\n\ncomment:42.",
    "created_at": "2022-07-12T22:04:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480939",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:56 dimpase]:
> sorry, I see committing a bunch of files from another project as a regression (unneeded vendoring).


comment:42.



---

archive/issue_comments_480940.json:
```json
{
    "body": "I think Matthias is using gnulib as intended. Making it maintainable is possibly the tricky bit. Had to deal with gnulib before on AIX :( the advantage of using gettext in this case is to rely on a third party to do the maintenance. And then you have to make sure you are up to date yourself.\n\nAs to adding bunch of files from another project, yes it is trading them against the gettext dependency as far as I understand. So potentially a tarball with stuff you don't care about.\n\nDima, do you have a good stated technical opposition to gnulib rather than a philosophical one?",
    "created_at": "2022-07-13T09:22:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480940",
    "user": "https://github.com/kiwifb"
}
```

I think Matthias is using gnulib as intended. Making it maintainable is possibly the tricky bit. Had to deal with gnulib before on AIX :( the advantage of using gettext in this case is to rely on a third party to do the maintenance. And then you have to make sure you are up to date yourself.

As to adding bunch of files from another project, yes it is trading them against the gettext dependency as far as I understand. So potentially a tarball with stuff you don't care about.

Dima, do you have a good stated technical opposition to gnulib rather than a philosophical one?



---

archive/issue_comments_480941.json:
```json
{
    "body": "I don't have opposition to `gnulib`, I rather want have it installed and used by `./bootstrap` via `gnulib-tool`.",
    "created_at": "2022-07-13T09:27:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480941",
    "user": "https://github.com/dimpase"
}
```

I don't have opposition to `gnulib`, I rather want have it installed and used by `./bootstrap` via `gnulib-tool`.



---

archive/issue_comments_480942.json:
```json
{
    "body": "Replying to [comment:60 dimpase]:\n> I don't have opposition to `gnulib`, I rather want have it installed and used by `./bootstrap` via `gnulib-tool`.\n\n\nI see, then we'll go round and round. Do I want to have to install gnulib to bootstrap?\n\n```\nfbissey@tarazed ~ $ eix gnulib\n* dev-libs/gnulib\n     Available versions:  ~*2019.03.17.09.24.57 ~*2022.02.12.16.27.05 ~*2022.05.26.07.24.56 **9999-r1*l {doc}\n     Homepage:            https://www.gnu.org/software/gnulib\n     Description:         Gnulib is a library of common routines intended to be shared at the source level\n```\nhum stuff that has all the markers for \"install at your own risks, you have been warned\" and which force to do things that are equivalent to signing a contract saying you understand the risks before you can install. Looking at the package itself it is \"grab a tarball and manually copy the files in a potentially arbitrary location\". No, I am with Matthias on that one, this is in a different class than autotools and libtools or cmake. You redistribute the bits you need. Having the tools to maintain it in the same package is a must though.",
    "created_at": "2022-07-13T09:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480942",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:60 dimpase]:
> I don't have opposition to `gnulib`, I rather want have it installed and used by `./bootstrap` via `gnulib-tool`.


I see, then we'll go round and round. Do I want to have to install gnulib to bootstrap?

```
fbissey@tarazed ~ $ eix gnulib
* dev-libs/gnulib
     Available versions:  ~*2019.03.17.09.24.57 ~*2022.02.12.16.27.05 ~*2022.05.26.07.24.56 **9999-r1*l {doc}
     Homepage:            https://www.gnu.org/software/gnulib
     Description:         Gnulib is a library of common routines intended to be shared at the source level
```
hum stuff that has all the markers for "install at your own risks, you have been warned" and which force to do things that are equivalent to signing a contract saying you understand the risks before you can install. Looking at the package itself it is "grab a tarball and manually copy the files in a potentially arbitrary location". No, I am with Matthias on that one, this is in a different class than autotools and libtools or cmake. You redistribute the bits you need. Having the tools to maintain it in the same package is a must though.



---

archive/issue_comments_480943.json:
```json
{
    "body": "\"bits\" are thousands of lines, in about 10 files. To me it screams that it should be installed and copied as needed,  not copied once and committed in our tree. \n\nI think gnulib is in such a weird state due to GNU folks having badly failed QA on the gnulib/gettext stuff.",
    "created_at": "2022-07-13T09:52:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480943",
    "user": "https://github.com/dimpase"
}
```

"bits" are thousands of lines, in about 10 files. To me it screams that it should be installed and copied as needed,  not copied once and committed in our tree. 

I think gnulib is in such a weird state due to GNU folks having badly failed QA on the gnulib/gettext stuff.



---

archive/issue_comments_480944.json:
```json
{
    "body": "Replying to [comment:62 dimpase]:\n> I think gnulib is in such a weird state due to GNU folks having badly failed QA on the gnulib/gettext stuff. \n\n\nPossibly :) that has never stopped anyone - and I am talking in a professional capacity as someone who helped people install real stinky software on \"supercomputers\" and computers not really super. Sometimes, I turn to my fellow researcher or a PhD student and go \"we are not going to do that one sorry, it stinks because it is real dead. Please reconsider\". Not so long ago sagemath was in the stinky pile, it still stinks a bit but not that bad :), using gnulib as Matthias wants will not make it smell much more. At the very least, gnulib and sagemath are very much alive and that counts for a lot.",
    "created_at": "2022-07-13T10:14:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480944",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:62 dimpase]:
> I think gnulib is in such a weird state due to GNU folks having badly failed QA on the gnulib/gettext stuff. 


Possibly :) that has never stopped anyone - and I am talking in a professional capacity as someone who helped people install real stinky software on "supercomputers" and computers not really super. Sometimes, I turn to my fellow researcher or a PhD student and go "we are not going to do that one sorry, it stinks because it is real dead. Please reconsider". Not so long ago sagemath was in the stinky pile, it still stinks a bit but not that bad :), using gnulib as Matthias wants will not make it smell much more. At the very least, gnulib and sagemath are very much alive and that counts for a lot.



---

archive/issue_comments_480945.json:
```json
{
    "body": "IMHO my branch for the issue, i.e. `u/dimpase/config/gnulib`, is less stinky.\n\nMatthias already caused a bit of havoc in 9.7.beta5 by only keeping in `m4/` some of the files installed by `gnulib-tool --import iconv` and not all (a bug only visible on a box without gettext installed :-(). And still `u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__` doesn't add them all.\n\n---\nNew commits:",
    "created_at": "2022-07-13T11:00:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480945",
    "user": "https://github.com/dimpase"
}
```

IMHO my branch for the issue, i.e. `u/dimpase/config/gnulib`, is less stinky.

Matthias already caused a bit of havoc in 9.7.beta5 by only keeping in `m4/` some of the files installed by `gnulib-tool --import iconv` and not all (a bug only visible on a box without gettext installed :-(). And still `u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__` doesn't add them all.

---
New commits:



---

archive/issue_comments_480946.json:
```json
{
    "body": "advice to install `gnutls` is missing in this branch, but that's minor, easy to fix.",
    "created_at": "2022-07-13T11:06:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480946",
    "user": "https://github.com/dimpase"
}
```

advice to install `gnutls` is missing in this branch, but that's minor, easy to fix.



---

archive/issue_comments_480947.json:
```json
{
    "body": "Replying to [comment:61 fbissey]:\n> Replying to [comment:60 dimpase]:\n> > I don't have opposition to `gnulib`, I rather want have it installed and used by `./bootstrap` via `gnulib-tool`.\n\n> \n> I see, then we'll go round and round. Do I want to have to install gnulib to bootstrap?\n> \n> ```\n> fbissey@tarazed ~ $ eix gnulib\n> * dev-libs/gnulib\n>      Available versions:  ~*2019.03.17.09.24.57 ~*2022.02.12.16.27.05 ~*2022.05.26.07.24.56 **9999-r1*l {doc}\n>      Homepage:            https://www.gnu.org/software/gnulib\n>      Description:         Gnulib is a library of common routines intended to be shared at the source level\n> ```\n\n\non gentoo I had to do the \"missing keyword\" fix for gnulib, in order to install it.\nNot sure it's a bug or feature.",
    "created_at": "2022-07-13T11:21:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480947",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:61 fbissey]:
> Replying to [comment:60 dimpase]:
> > I don't have opposition to `gnulib`, I rather want have it installed and used by `./bootstrap` via `gnulib-tool`.

> 
> I see, then we'll go round and round. Do I want to have to install gnulib to bootstrap?
> 
> ```
> fbissey@tarazed ~ $ eix gnulib
> * dev-libs/gnulib
>      Available versions:  ~*2019.03.17.09.24.57 ~*2022.02.12.16.27.05 ~*2022.05.26.07.24.56 **9999-r1*l {doc}
>      Homepage:            https://www.gnu.org/software/gnulib
>      Description:         Gnulib is a library of common routines intended to be shared at the source level
> ```


on gentoo I had to do the "missing keyword" fix for gnulib, in order to install it.
Not sure it's a bug or feature.



---

archive/issue_comments_480948.json:
```json
{
    "body": "It is a feature. This is a way to get you to sign off that you know what you are doing. You have to be really explicit that you want to install it.",
    "created_at": "2022-07-13T11:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480948",
    "user": "https://github.com/kiwifb"
}
```

It is a feature. This is a way to get you to sign off that you know what you are doing. You have to be really explicit that you want to install it.



---

archive/issue_comments_480949.json:
```json
{
    "body": "Replying to [comment:23 mkoeppe]:\n> Replying to [comment:21 dimpase]:\n> > This manual is older than `git`, you know, no wonder it won't mention it.\n\n> \n> Use with git is documented in https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html; it describes several approaches.\n\n\nDima, let me highlight this link again. It documents 3 approaches how to use gnulib with version control systems. Do you see which of the 3 corresponds to my branch?",
    "created_at": "2022-07-13T14:53:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480949",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:23 mkoeppe]:
> Replying to [comment:21 dimpase]:
> > This manual is older than `git`, you know, no wonder it won't mention it.

> 
> Use with git is documented in https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html; it describes several approaches.


Dima, let me highlight this link again. It documents 3 approaches how to use gnulib with version control systems. Do you see which of the 3 corresponds to my branch?



---

archive/issue_comments_480950.json:
```json
{
    "body": "After all these years trying to unvendor as much as possible, all of a sudden you reverse the course. I don't get it.",
    "created_at": "2022-07-13T16:13:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480950",
    "user": "https://github.com/dimpase"
}
```

After all these years trying to unvendor as much as possible, all of a sudden you reverse the course. I don't get it.



---

archive/issue_comments_480951.json:
```json
{
    "body": "You keep using this word \"vendoring\" here. This is not what's happening. My branch is using gnulib as documented.\n\nYou may find https://lists.gnu.org/archive/html/bug-gnulib/2008-11/msg00083.html helpful.",
    "created_at": "2022-07-13T16:22:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480951",
    "user": "https://github.com/mkoeppe"
}
```

You keep using this word "vendoring" here. This is not what's happening. My branch is using gnulib as documented.

You may find https://lists.gnu.org/archive/html/bug-gnulib/2008-11/msg00083.html helpful.



---

archive/issue_comments_480952.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-07-13T16:25:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480952",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_comments_480953.json:
```json
{
    "body": "I consider the gnulib manual outdated. OK, it's not vendoring, it's an SCO (Special Copying Operation) :P",
    "created_at": "2022-07-13T17:18:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480953",
    "user": "https://github.com/dimpase"
}
```

I consider the gnulib manual outdated. OK, it's not vendoring, it's an SCO (Special Copying Operation) :P



---

archive/issue_comments_480954.json:
```json
{
    "body": "Replying to [comment:72 dimpase]:\n> I consider the gnulib manual outdated.\n\n\nTry taking that to bug-gnulib.",
    "created_at": "2022-07-13T17:20:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480954",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:72 dimpase]:
> I consider the gnulib manual outdated.


Try taking that to bug-gnulib.



---

archive/issue_comments_480955.json:
```json
{
    "body": "Pro tip: Use the subject \"Gnulib considered harmful\"",
    "created_at": "2022-07-13T17:22:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480955",
    "user": "https://github.com/mkoeppe"
}
```

Pro tip: Use the subject "Gnulib considered harmful"



---

archive/issue_comments_480956.json:
```json
{
    "body": "Changing priority from blocker to critical.",
    "created_at": "2022-07-14T14:08:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480956",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from blocker to critical.



---

archive/issue_comments_480957.json:
```json
{
    "body": "Adding those four files to the m4 directory fixed all of my problems with the bootstrap script, including the missing .dylib extension on LIBSINGULAR_PATH.  I am now getting a working macOS build with no issues.\n\nIt seems completely clear to me that this is the correct approach.  A project distributes an m4 directory containing the exact gnulib .m4 files that are needed to make its build work. By that I mean the exact versions of those files. The gnulib repository changes almost daily and they do not do releases.  So this seems like the only way to ensure a working build.  And it is also what gnulib says to do.",
    "created_at": "2022-07-15T15:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480957",
    "user": "https://github.com/culler"
}
```

Adding those four files to the m4 directory fixed all of my problems with the bootstrap script, including the missing .dylib extension on LIBSINGULAR_PATH.  I am now getting a working macOS build with no issues.

It seems completely clear to me that this is the correct approach.  A project distributes an m4 directory containing the exact gnulib .m4 files that are needed to make its build work. By that I mean the exact versions of those files. The gnulib repository changes almost daily and they do not do releases.  So this seems like the only way to ensure a working build.  And it is also what gnulib says to do.



---

archive/issue_comments_480958.json:
```json
{
    "body": "Replying to [comment:76 culler]:\n> Adding those four files to the m4 directory fixed all of my problems with the bootstrap script, including the missing .dylib extension on LIBSINGULAR_PATH.  I am now getting a working macOS build with no issues.\n> \n> It seems completely clear to me that this is the correct approach.  A project distributes an m4 directory containing the exact gnulib .m4 files that are needed to make its build work. By that I mean the exact versions of those files. The gnulib repository changes almost daily and they do not do releases.  So this seems like the only way to ensure a working build.  And it is also what gnulib says to do.\n\n\nThe only way? \nIf one wants to follow the gnulib updates then one can use `git submodule` or a similar solution; and this is mentioned in gnulib docs.\nTotally no need to follow the 30+ years old way of copying files by hand.",
    "created_at": "2022-07-16T19:59:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480958",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:76 culler]:
> Adding those four files to the m4 directory fixed all of my problems with the bootstrap script, including the missing .dylib extension on LIBSINGULAR_PATH.  I am now getting a working macOS build with no issues.
> 
> It seems completely clear to me that this is the correct approach.  A project distributes an m4 directory containing the exact gnulib .m4 files that are needed to make its build work. By that I mean the exact versions of those files. The gnulib repository changes almost daily and they do not do releases.  So this seems like the only way to ensure a working build.  And it is also what gnulib says to do.


The only way? 
If one wants to follow the gnulib updates then one can use `git submodule` or a similar solution; and this is mentioned in gnulib docs.
Totally no need to follow the 30+ years old way of copying files by hand.



---

archive/issue_comments_480959.json:
```json
{
    "body": "Gnulib provides `gnulib-tool` for the copying, so copying is not done \"by hand\".",
    "created_at": "2022-07-16T20:06:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480959",
    "user": "https://github.com/mkoeppe"
}
```

Gnulib provides `gnulib-tool` for the copying, so copying is not done "by hand".



---

archive/issue_comments_480960.json:
```json
{
    "body": "sure - but updating is done by hand; one needs to update gnulib on the box, and launch gnulib-tool",
    "created_at": "2022-07-16T21:03:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480960",
    "user": "https://github.com/dimpase"
}
```

sure - but updating is done by hand; one needs to update gnulib on the box, and launch gnulib-tool



---

archive/issue_comments_480961.json:
```json
{
    "body": "Yes, the author of an upgrade ticket for these files will have to run `gnulibtool`.",
    "created_at": "2022-07-16T21:08:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480961",
    "user": "https://github.com/mkoeppe"
}
```

Yes, the author of an upgrade ticket for these files will have to run `gnulibtool`.



---

archive/issue_comments_480962.json:
```json
{
    "body": "That's approach 3 of the three approaches explained in the manual (https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).",
    "created_at": "2022-07-16T21:34:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480962",
    "user": "https://github.com/mkoeppe"
}
```

That's approach 3 of the three approaches explained in the manual (https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).



---

archive/issue_comments_480963.json:
```json
{
    "body": "so you chose the most labour-intensive approach, resulting in extra maintenance to be done.",
    "created_at": "2022-07-17T10:04:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480963",
    "user": "https://github.com/dimpase"
}
```

so you chose the most labour-intensive approach, resulting in extra maintenance to be done.



---

archive/issue_comments_480964.json:
```json
{
    "body": "No. \n\nIn approach 2 of the three approaches, in the variant with `git submodule`, the author of an upgrade ticket will have to run `git submodule update --remote` and then commit the change. \n\nFor the author of an upgrade ticket for gnulib, it's the same amount of labor as approach 3: One command and one commit.\n\nThe drawbacks of this approach: \n- it exposes all developers (not just an author of a gnulib upgrade ticket) to the complexity of git submodules. \n- a source tarball of Sage will have to contain the full copy of gnulib (a copy of the submodule). More \"vendoring\" ;)",
    "created_at": "2022-07-17T18:19:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480964",
    "user": "https://github.com/mkoeppe"
}
```

No. 

In approach 2 of the three approaches, in the variant with `git submodule`, the author of an upgrade ticket will have to run `git submodule update --remote` and then commit the change. 

For the author of an upgrade ticket for gnulib, it's the same amount of labor as approach 3: One command and one commit.

The drawbacks of this approach: 
- it exposes all developers (not just an author of a gnulib upgrade ticket) to the complexity of git submodules. 
- a source tarball of Sage will have to contain the full copy of gnulib (a copy of the submodule). More "vendoring" ;)



---

archive/issue_comments_480965.json:
```json
{
    "body": "why do you insist on committing exact copies of files in gnulib into Sage tree? My approach does not do this.",
    "created_at": "2022-07-18T11:41:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480965",
    "user": "https://github.com/dimpase"
}
```

why do you insist on committing exact copies of files in gnulib into Sage tree? My approach does not do this.



---

archive/issue_comments_480966.json:
```json
{
    "body": "Replying to [comment:84 dimpase]:\n> why do you insist on committing exact copies of files in gnulib into Sage tree?\n\n\nIt is the documented way to use gnulib, specifically, approach 3.\n\nThe Gnulib manual, https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html, introduces the three approaches with this paragraph:\n\n  Here are the three different approaches in common use. Each has its place, and you should use whichever best suits your particular project and development methods.\n\nThe approach of your branch is neither of the three documented approaches. Upstream explicitly rejects this approach. It's reflected in: Gnulib not making releases and not having an \"install\" target (comment:9, comment:40); homebrew and conda not packaging it (comment:38); gentoo marking it as \"source only\" (comment:67); and the thread linked in comment:70.",
    "created_at": "2022-07-18T16:31:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480966",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:84 dimpase]:
> why do you insist on committing exact copies of files in gnulib into Sage tree?


It is the documented way to use gnulib, specifically, approach 3.

The Gnulib manual, https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html, introduces the three approaches with this paragraph:

  Here are the three different approaches in common use. Each has its place, and you should use whichever best suits your particular project and development methods.

The approach of your branch is neither of the three documented approaches. Upstream explicitly rejects this approach. It's reflected in: Gnulib not making releases and not having an "install" target (comment:9, comment:40); homebrew and conda not packaging it (comment:38); gentoo marking it as "source only" (comment:67); and the thread linked in comment:70.



---

archive/issue_comments_480967.json:
```json
{
    "body": "I think upstream has it wrong. Why do they insist on partial, or even complete, vendoring of their code? This only make sense if one wants to change it, but for 99% of projects it is not the case.",
    "created_at": "2022-07-18T19:16:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480967",
    "user": "https://github.com/dimpase"
}
```

I think upstream has it wrong. Why do they insist on partial, or even complete, vendoring of their code? This only make sense if one wants to change it, but for 99% of projects it is not the case.



---

archive/issue_comments_480968.json:
```json
{
    "body": "comment:73, comment:74",
    "created_at": "2022-07-18T19:23:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480968",
    "user": "https://github.com/mkoeppe"
}
```

comment:73, comment:74



---

archive/issue_comments_480969.json:
```json
{
    "body": "Replying to [comment:87 mkoeppe]:\n> comment:73, comment:74\n\n\nno, I am not going to try to expain the obvious to upstream. They are either too stubbon, or have an agenda (?), or just don't care. This \"gnulib must not be installed\" is nonsense - the same can be said about any source-only package.\n`gnulib` can be distributed by distributions, as it's done with gettext, and gnulib consumers can just call `gnulib-tool`.\n\nJust revert #29549 if you prefer, it's ugly but at least we don't increase codebase unnecessarily.",
    "created_at": "2022-07-19T07:42:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480969",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:87 mkoeppe]:
> comment:73, comment:74


no, I am not going to try to expain the obvious to upstream. They are either too stubbon, or have an agenda (?), or just don't care. This "gnulib must not be installed" is nonsense - the same can be said about any source-only package.
`gnulib` can be distributed by distributions, as it's done with gettext, and gnulib consumers can just call `gnulib-tool`.

Just revert #29549 if you prefer, it's ugly but at least we don't increase codebase unnecessarily.



---

archive/issue_comments_480970.json:
```json
{
    "body": "Replying to [comment:88 dimpase]:\n> Just revert #29549\n\n\nNo. #29549 solved an actual problem, as explained in the 1st paragraph of the ticket description.",
    "created_at": "2022-07-19T15:21:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480970",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:88 dimpase]:
> Just revert #29549


No. #29549 solved an actual problem, as explained in the 1st paragraph of the ticket description.



---

archive/issue_comments_480971.json:
```json
{
    "body": "Replying to [comment:88 dimpase]:\n> `gnulib` can be distributed by distributions\n\n\nBut it isn't, and it's beyond the scope of our project to change that.",
    "created_at": "2022-07-19T15:24:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480971",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:88 dimpase]:
> `gnulib` can be distributed by distributions


But it isn't, and it's beyond the scope of our project to change that.



---

archive/issue_comments_480972.json:
```json
{
    "body": "Replying to [comment:90 mkoeppe]:\n> Replying to [comment:88 dimpase]:\n> > `gnulib` can be distributed by distributions\n\n> \n> But it isn't, and it's beyond the scope of our project to change that.\n\n\nwell, yes, it is distributed by Fedora, !Debian/Ubuntu, Gentoo...",
    "created_at": "2022-07-19T16:53:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480972",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:90 mkoeppe]:
> Replying to [comment:88 dimpase]:
> > `gnulib` can be distributed by distributions

> 
> But it isn't, and it's beyond the scope of our project to change that.


well, yes, it is distributed by Fedora, !Debian/Ubuntu, Gentoo...



---

archive/issue_comments_480973.json:
```json
{
    "body": "comment:38, comment:67.",
    "created_at": "2022-07-19T17:30:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480973",
    "user": "https://github.com/mkoeppe"
}
```

comment:38, comment:67.



---

archive/issue_comments_480974.json:
```json
{
    "body": "Replying to [comment:88 dimpase]:\n> This \"gnulib must not be installed\" is nonsense - the same can be said about any source-only package.\n\n\nWhat other packages that need to run at bootstrap time do you have in mind?",
    "created_at": "2022-07-19T17:35:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480974",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:88 dimpase]:
> This "gnulib must not be installed" is nonsense - the same can be said about any source-only package.


What other packages that need to run at bootstrap time do you have in mind?



---

archive/issue_comments_480975.json:
```json
{
    "body": "I think we may have to have a vote on what to do on sage-devel. People here have strong opinions on what is the right thing to do and the final decision may have to be done by a third party.",
    "created_at": "2022-07-19T21:27:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480975",
    "user": "https://github.com/kiwifb"
}
```

I think we may have to have a vote on what to do on sage-devel. People here have strong opinions on what is the right thing to do and the final decision may have to be done by a third party.



---

archive/issue_comments_480976.json:
```json
{
    "body": "Replying to [comment:93 mkoeppe]:\n> Replying to [comment:88 dimpase]:\n> > This \"gnulib must not be installed\" is nonsense - the same can be said about any source-only package.\n\n> \n> What other packages that need to run at bootstrap time do you have in mind?\n\n\nthat's not what I had in mind - what I have in mind is an (imaginary, because it'd be insane design) header-only C++ library which comes with a tool to copy some of the headers it provides into the source tree, and the manual saying that you also should commit these copied headers into your tree. All that instead of having it installed and using `#include <...>`...",
    "created_at": "2022-07-20T09:31:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480976",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:93 mkoeppe]:
> Replying to [comment:88 dimpase]:
> > This "gnulib must not be installed" is nonsense - the same can be said about any source-only package.

> 
> What other packages that need to run at bootstrap time do you have in mind?


that's not what I had in mind - what I have in mind is an (imaginary, because it'd be insane design) header-only C++ library which comes with a tool to copy some of the headers it provides into the source tree, and the manual saying that you also should commit these copied headers into your tree. All that instead of having it installed and using `#include <...>`...



---

archive/issue_comments_480977.json:
```json
{
    "body": "Replying to [comment:95 dimpase]:\n> what I have in mind is an (imaginary, because it'd be insane design) header-only C++ library which comes with a tool to copy some of the headers it provides into the source tree, and the manual saying that you also should commit these copied headers into your tree.\n\n\n`nauty` is a real example of this design by upstream. And of course distributions that engage in unvendoring, such as Debian, unvendor nauty from packages that have followed upstream's advice. See for example https://salsa.debian.org/python-team/packages/pynauty/-/tree/debian/latest/debian/patches",
    "created_at": "2022-07-20T16:28:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480977",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:95 dimpase]:
> what I have in mind is an (imaginary, because it'd be insane design) header-only C++ library which comes with a tool to copy some of the headers it provides into the source tree, and the manual saying that you also should commit these copied headers into your tree.


`nauty` is a real example of this design by upstream. And of course distributions that engage in unvendoring, such as Debian, unvendor nauty from packages that have followed upstream's advice. See for example https://salsa.debian.org/python-team/packages/pynauty/-/tree/debian/latest/debian/patches



---

archive/issue_comments_480978.json:
```json
{
    "body": "nauty is designed by Brendan MacKay, who is really very far from software engineering practice - not sure if you know the saga, involving a threat to fork nauty, that resulted in it getting a normal license...",
    "created_at": "2022-07-20T16:35:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480978",
    "user": "https://github.com/dimpase"
}
```

nauty is designed by Brendan MacKay, who is really very far from software engineering practice - not sure if you know the saga, involving a threat to fork nauty, that resulted in it getting a normal license...



---

archive/issue_comments_480979.json:
```json
{
    "body": "Yes, everyone agrees that upstream's policy is poorly motivated, and so it makes sense to override it and unvendor nauty from packages that have followed nauty's advice.",
    "created_at": "2022-07-20T16:37:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480979",
    "user": "https://github.com/mkoeppe"
}
```

Yes, everyone agrees that upstream's policy is poorly motivated, and so it makes sense to override it and unvendor nauty from packages that have followed nauty's advice.



---

archive/issue_comments_480980.json:
```json
{
    "body": "But the situation with Gnulib is different because it has to run at bootstrap time.",
    "created_at": "2022-07-20T16:38:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480980",
    "user": "https://github.com/mkoeppe"
}
```

But the situation with Gnulib is different because it has to run at bootstrap time.



---

archive/issue_comments_480981.json:
```json
{
    "body": "Sorry to explain the obvious, but bootstrap time comes before configure time. It is at configure time that one runs system package discovery.",
    "created_at": "2022-07-20T16:39:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480981",
    "user": "https://github.com/mkoeppe"
}
```

Sorry to explain the obvious, but bootstrap time comes before configure time. It is at configure time that one runs system package discovery.



---

archive/issue_comments_480982.json:
```json
{
    "body": "Not even Debian overrides the Gnulib maintainers' insight into their package. Well, they tried in 2008(?) -- let me again link https://lists.gnu.org/archive/html/bug-gnulib/2008-11/msg00083.html -- but as of today, Gnulib is not a build dependency of any Debian package. It is packaged as a tool for Debian package maintainers.",
    "created_at": "2022-07-20T16:40:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480982",
    "user": "https://github.com/mkoeppe"
}
```

Not even Debian overrides the Gnulib maintainers' insight into their package. Well, they tried in 2008(?) -- let me again link https://lists.gnu.org/archive/html/bug-gnulib/2008-11/msg00083.html -- but as of today, Gnulib is not a build dependency of any Debian package. It is packaged as a tool for Debian package maintainers.



---

archive/issue_comments_480983.json:
```json
{
    "body": "Relevant for the discussion are packages that runs at bootstrap time, not imaginary or real packages that can be discovered at configure time.",
    "created_at": "2022-07-20T16:43:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480983",
    "user": "https://github.com/mkoeppe"
}
```

Relevant for the discussion are packages that runs at bootstrap time, not imaginary or real packages that can be discovered at configure time.



---

archive/issue_comments_480984.json:
```json
{
    "body": "So here's a relevant example: autoconf-archive.",
    "created_at": "2022-07-20T16:43:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480984",
    "user": "https://github.com/mkoeppe"
}
```

So here's a relevant example: autoconf-archive.



---

archive/issue_comments_480985.json:
```json
{
    "body": "And we have followed autoconf-archive's documented way to use it: Namely to (manually \ud83d\ude31) copy the m4 files into our m4 directory and commit them to our tree.",
    "created_at": "2022-07-20T16:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480985",
    "user": "https://github.com/mkoeppe"
}
```

And we have followed autoconf-archive's documented way to use it: Namely to (manually ) copy the m4 files into our m4 directory and commit them to our tree.



---

archive/issue_comments_480986.json:
```json
{
    "body": "Gnulib uses the same model, and in contrast to autoconf-archive it even provides a tool that assists with updating the files.",
    "created_at": "2022-07-20T16:46:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480986",
    "user": "https://github.com/mkoeppe"
}
```

Gnulib uses the same model, and in contrast to autoconf-archive it even provides a tool that assists with updating the files.



---

archive/issue_comments_480987.json:
```json
{
    "body": "Replying to [comment:102 mkoeppe]:\n> Relevant for the discussion are packages that runs at bootstrap time, not imaginary or real packages that can be discovered at configure time.\n\n\nCertainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.",
    "created_at": "2022-07-20T16:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480987",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:102 mkoeppe]:
> Relevant for the discussion are packages that runs at bootstrap time, not imaginary or real packages that can be discovered at configure time.


Certainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.



---

archive/issue_comments_480988.json:
```json
{
    "body": "autoconf-archive is really a collection of independent m4 files, and we actually modify a few of them.",
    "created_at": "2022-07-20T16:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480988",
    "user": "https://github.com/dimpase"
}
```

autoconf-archive is really a collection of independent m4 files, and we actually modify a few of them.



---

archive/issue_comments_480989.json:
```json
{
    "body": "gnulib is really much more than a collection of independent m4 files, and we modify none of gnulib-supplied files.",
    "created_at": "2022-07-20T16:50:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480989",
    "user": "https://github.com/dimpase"
}
```

gnulib is really much more than a collection of independent m4 files, and we modify none of gnulib-supplied files.



---

archive/issue_comments_480990.json:
```json
{
    "body": "Replying to [comment:106 dimpase]:\n> Certainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.\n\n\nWhat do you imagine would it do if it is not available?",
    "created_at": "2022-07-20T16:52:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480990",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:106 dimpase]:
> Certainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.


What do you imagine would it do if it is not available?



---

archive/issue_comments_480991.json:
```json
{
    "body": "Replying to [comment:107 dimpase]:\n> autoconf-archive is really a collection of independent m4 files, and we actually modify a few of them.\n\n\nThat we modify them without sending the changes upstream is actually a poor practice of our project. See also #29590",
    "created_at": "2022-07-20T16:54:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480991",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:107 dimpase]:
> autoconf-archive is really a collection of independent m4 files, and we actually modify a few of them.


That we modify them without sending the changes upstream is actually a poor practice of our project. See also #29590



---

archive/issue_comments_480992.json:
```json
{
    "body": "Replying to [comment:108 dimpase]:\n> gnulib is really much more than a collection of independent m4 files\n\n\nMacros in autoconf-archive also have interdependencies. For example, `ax_cxx_compile_stdcxx_11.m4` depends on `ax_cxx_compile_stdcxx.m4`.\n\n> and we modify none of gnulib-supplied files.\n\n\nI was puzzled before by your comment:86 in the same direction. If there are concerns about maintainability, they should apply to files that are copied in from an upstream and then modified locally! Copying in files and leaving them unmodified is obviously less problematic.",
    "created_at": "2022-07-20T17:07:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480992",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:108 dimpase]:
> gnulib is really much more than a collection of independent m4 files


Macros in autoconf-archive also have interdependencies. For example, `ax_cxx_compile_stdcxx_11.m4` depends on `ax_cxx_compile_stdcxx.m4`.

> and we modify none of gnulib-supplied files.


I was puzzled before by your comment:86 in the same direction. If there are concerns about maintainability, they should apply to files that are copied in from an upstream and then modified locally! Copying in files and leaving them unmodified is obviously less problematic.



---

archive/issue_comments_480993.json:
```json
{
    "body": "Replying to [comment:109 mkoeppe]:\n> Replying to [comment:106 dimpase]:\n> > Certainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.\n\n> \n> What do you imagine would it do if it is not available?\n\n\nthe usual for bootstrap thing - resort to downloading configure.spkg",
    "created_at": "2022-07-20T17:18:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480993",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:109 mkoeppe]:
> Replying to [comment:106 dimpase]:
> > Certainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.

> 
> What do you imagine would it do if it is not available?


the usual for bootstrap thing - resort to downloading configure.spkg



---

archive/issue_comments_480994.json:
```json
{
    "body": "Replying to [comment:110 mkoeppe]:\n> Replying to [comment:107 dimpase]:\n> > autoconf-archive is really a collection of independent m4 files, and we actually modify a few of them.\n\n> \n> That we modify them without sending the changes upstream is actually a poor practice of our project. See also #29590\n\n\n\ncommunication with GNU/FSF greybeards is really above my pay grade. I tried with readline, autoconf, I really don't click with them...",
    "created_at": "2022-07-20T17:21:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480994",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:110 mkoeppe]:
> Replying to [comment:107 dimpase]:
> > autoconf-archive is really a collection of independent m4 files, and we actually modify a few of them.

> 
> That we modify them without sending the changes upstream is actually a poor practice of our project. See also #29590



communication with GNU/FSF greybeards is really above my pay grade. I tried with readline, autoconf, I really don't click with them...



---

archive/issue_comments_480995.json:
```json
{
    "body": "Replying to [comment:112 dimpase]:\n> Replying to [comment:109 mkoeppe]:\n> > Replying to [comment:106 dimpase]:\n> > > Certainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.\n\n> > \n> > What do you imagine would it do if it is not available?\n\n> \n> the usual for bootstrap thing - resort to downloading configure.spkg\n\n\nThis would make it harder for developers on macOS (with homebrew or without) or conda to work on tickets that upgrade packages. So they will have to learn about Gnulib even though their package upgrade has nothing to do with it.\n\nAnd it would make it harder for running our portability CIs: We would no longer be able to bootstrap a source tree from git on all supported platforms without an extra step that downloads/checks out the whole Gnulib.",
    "created_at": "2022-07-20T17:28:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480995",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:112 dimpase]:
> Replying to [comment:109 mkoeppe]:
> > Replying to [comment:106 dimpase]:
> > > Certainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.

> > 
> > What do you imagine would it do if it is not available?

> 
> the usual for bootstrap thing - resort to downloading configure.spkg


This would make it harder for developers on macOS (with homebrew or without) or conda to work on tickets that upgrade packages. So they will have to learn about Gnulib even though their package upgrade has nothing to do with it.

And it would make it harder for running our portability CIs: We would no longer be able to bootstrap a source tree from git on all supported platforms without an extra step that downloads/checks out the whole Gnulib.



---

archive/issue_comments_480996.json:
```json
{
    "body": "Replying to [comment:94 fbissey]:\n> I think we may have to have a vote on what to do on sage-devel. People here have strong opinions on what is the right thing to do and the final decision may have to be done by a third party.\n\n\n+100",
    "created_at": "2022-07-20T18:10:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480996",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:94 fbissey]:
> I think we may have to have a vote on what to do on sage-devel. People here have strong opinions on what is the right thing to do and the final decision may have to be done by a third party.


+100



---

archive/issue_comments_480997.json:
```json
{
    "body": "Replying to [comment:114 mkoeppe]:\n> Replying to [comment:112 dimpase]:\n> > Replying to [comment:109 mkoeppe]:\n> > > Replying to [comment:106 dimpase]:\n> > > > Certainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.\n\n> > > \n> > > What do you imagine would it do if it is not available?\n\n> > \n> > the usual for bootstrap thing - resort to downloading configure.spkg\n\n> \n> This would make it harder for developers on macOS (with homebrew or without) or conda to work on tickets that upgrade packages. So they will have to learn about Gnulib even though their package upgrade has nothing to do with it.\n\n\nAs far as Homebrew is concerned, it's easy to provide a formula to install gnulib.\nSuch a formula can be hosted on sagemath GH.\nI don't know how easy it is to do the same with Conda.\n\n> \n> And it would make it harder for running our portability CIs: We would no longer be able to bootstrap a source tree from git on all supported platforms without an extra step that downloads/checks out the whole Gnulib.\n\n\nCome on, that's like 2 lines of shell, to `git clone --depth=1` the `gnulib`, and adjust the path so that  `gnulib-tool` is there. \nWe can just add this step to `./bootstrap`, to be run if it can't find `gnulib-tool`.",
    "created_at": "2022-07-21T08:31:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480997",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:114 mkoeppe]:
> Replying to [comment:112 dimpase]:
> > Replying to [comment:109 mkoeppe]:
> > > Replying to [comment:106 dimpase]:
> > > > Certainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.

> > > 
> > > What do you imagine would it do if it is not available?

> > 
> > the usual for bootstrap thing - resort to downloading configure.spkg

> 
> This would make it harder for developers on macOS (with homebrew or without) or conda to work on tickets that upgrade packages. So they will have to learn about Gnulib even though their package upgrade has nothing to do with it.


As far as Homebrew is concerned, it's easy to provide a formula to install gnulib.
Such a formula can be hosted on sagemath GH.
I don't know how easy it is to do the same with Conda.

> 
> And it would make it harder for running our portability CIs: We would no longer be able to bootstrap a source tree from git on all supported platforms without an extra step that downloads/checks out the whole Gnulib.


Come on, that's like 2 lines of shell, to `git clone --depth=1` the `gnulib`, and adjust the path so that  `gnulib-tool` is there. 
We can just add this step to `./bootstrap`, to be run if it can't find `gnulib-tool`.



---

archive/issue_comments_480998.json:
```json
{
    "body": "This is not getting any better",
    "created_at": "2022-07-21T16:42:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480998",
    "user": "https://github.com/mkoeppe"
}
```

This is not getting any better



---

archive/issue_comments_480999.json:
```json
{
    "body": "Replying to [comment:117 mkoeppe]:\n> This is not getting any better\n\nWhy? Because you must blindly follow the upstream's advice?",
    "created_at": "2022-07-25T07:19:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-480999",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:117 mkoeppe]:
> This is not getting any better

Why? Because you must blindly follow the upstream's advice?



---

archive/issue_comments_481000.json:
```json
{
    "body": "comment:27",
    "created_at": "2022-07-25T16:17:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481000",
    "user": "https://github.com/mkoeppe"
}
```

comment:27



---

archive/issue_comments_481001.json:
```json
{
    "body": "I would have pointed instead to comment:94. I don't see a high likelihood of either Dima or Matthias convincing the other one. Taking the discussion to sage-devel seems like a good solution.",
    "created_at": "2022-07-25T17:42:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481001",
    "user": "https://github.com/jhpalmieri"
}
```

I would have pointed instead to comment:94. I don't see a high likelihood of either Dima or Matthias convincing the other one. Taking the discussion to sage-devel seems like a good solution.



---

archive/issue_comments_481002.json:
```json
{
    "body": "Replying to [comment:37 dimpase]:\n> only these who use macOS and only these who do not use anything but Xcode might have to do this. And among the latter only these who need to build ./configure\n\n\nI am such a developer. I don't know gnulib. I wish that I could upgrade a package without  learning (or struggling to install) gnulib. So I am +1 to Matthias' approach.",
    "created_at": "2022-07-29T02:40:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481002",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:37 dimpase]:
> only these who use macOS and only these who do not use anything but Xcode might have to do this. And among the latter only these who need to build ./configure


I am such a developer. I don't know gnulib. I wish that I could upgrade a package without  learning (or struggling to install) gnulib. So I am +1 to Matthias' approach.



---

archive/issue_comments_481003.json:
```json
{
    "body": "I never said one must \"know\" gnulib.\nIt can all be handled by ./bootstrap script.\n\nBut Matthias is against it, as it would violate gnulib overlords commandments...",
    "created_at": "2022-07-29T06:27:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481003",
    "user": "https://github.com/dimpase"
}
```

I never said one must "know" gnulib.
It can all be handled by ./bootstrap script.

But Matthias is against it, as it would violate gnulib overlords commandments...



---

archive/issue_comments_481004.json:
```json
{
    "body": "Dima, repeating this kind of rhetoric is not helpful for anything.",
    "created_at": "2022-07-29T06:46:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481004",
    "user": "https://github.com/mkoeppe"
}
```

Dima, repeating this kind of rhetoric is not helpful for anything.



---

archive/issue_comments_481005.json:
```json
{
    "body": "Replying to [comment:116 dimpase]:\n> As far as Homebrew is concerned, it's easy to provide a formula to install gnulib.\n> Such a formula can be hosted on sagemath GH.\n\n\nThe gnulib overlord is explicitly against this: https://lists.gnu.org/archive/html/bug-gnulib/2018-02/msg00041.html\n\nMaintaining the homebrew formula ourselves would be as burdensome as keeping a part of gnulib in our source tree.",
    "created_at": "2022-07-29T07:11:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481005",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:116 dimpase]:
> As far as Homebrew is concerned, it's easy to provide a formula to install gnulib.
> Such a formula can be hosted on sagemath GH.


The gnulib overlord is explicitly against this: https://lists.gnu.org/archive/html/bug-gnulib/2018-02/msg00041.html

Maintaining the homebrew formula ourselves would be as burdensome as keeping a part of gnulib in our source tree.



---

archive/issue_comments_481006.json:
```json
{
    "body": "Replying to [comment:124 klee]:\n> Replying to [comment:116 dimpase]:\n> > As far as Homebrew is concerned, it's easy to provide a formula to install gnulib.\n> > Such a formula can be hosted on sagemath GH.\n\n> \n> The gnulib overlord is explicitly against this: https://lists.gnu.org/archive/html/bug-gnulib/2018-02/msg00041.html\n\n\nthat message contains an explict advice against using an outdated gnulib. \n\n```\nPackaging gnulib through a packaging system would have the effect that its\nusers see an older version of gnulib...\n```\n\nYet your branch does exactly this - as the part of gnulib you copy becomes outdated very soon indeed.\n\n\n> \n> Maintaining the homebrew formula ourselves would be as burdensome as keeping a part of gnulib in our source tree.\n\n\nNo, no! A brew formula can pull from a git repo. How is it a burden?\nhttps://docs.brew.sh/How-to-Create-and-Maintain-a-Tap",
    "created_at": "2022-07-29T07:52:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481006",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:124 klee]:
> Replying to [comment:116 dimpase]:
> > As far as Homebrew is concerned, it's easy to provide a formula to install gnulib.
> > Such a formula can be hosted on sagemath GH.

> 
> The gnulib overlord is explicitly against this: https://lists.gnu.org/archive/html/bug-gnulib/2018-02/msg00041.html


that message contains an explict advice against using an outdated gnulib. 

```
Packaging gnulib through a packaging system would have the effect that its
users see an older version of gnulib...
```

Yet your branch does exactly this - as the part of gnulib you copy becomes outdated very soon indeed.


> 
> Maintaining the homebrew formula ourselves would be as burdensome as keeping a part of gnulib in our source tree.


No, no! A brew formula can pull from a git repo. How is it a burden?
https://docs.brew.sh/How-to-Create-and-Maintain-a-Tap



---

archive/issue_comments_481007.json:
```json
{
    "body": "Replying to [comment:125 dimpase]:\n> > Maintaining the homebrew formula ourselves would be as burdensome as keeping a part of gnulib in our source tree.\n\n> \n> No, no! A brew formula can pull from a git repo.\n\n\nI see. Pulling the latest gnulib from the repo sounds nice.\n\nSo if gnulib is not available on the system (I guess this is almost always the case), \"./configure\" would error out saying that I should brew install gnulib before continue. Right? I imagine this would be an extra hurdle for a new user.\n\n> How is it a burden?\n> https://docs.brew.sh/How-to-Create-and-Maintain-a-Tap\n\n\nI guess that practically gnulib in sage would need to be updated very rarely. If so, keeping hombrew formula (and conda formula too?) is a burden unnecessary in Matthias' approach.",
    "created_at": "2022-07-29T09:05:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481007",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:125 dimpase]:
> > Maintaining the homebrew formula ourselves would be as burdensome as keeping a part of gnulib in our source tree.

> 
> No, no! A brew formula can pull from a git repo.


I see. Pulling the latest gnulib from the repo sounds nice.

So if gnulib is not available on the system (I guess this is almost always the case), "./configure" would error out saying that I should brew install gnulib before continue. Right? I imagine this would be an extra hurdle for a new user.

> How is it a burden?
> https://docs.brew.sh/How-to-Create-and-Maintain-a-Tap


I guess that practically gnulib in sage would need to be updated very rarely. If so, keeping hombrew formula (and conda formula too?) is a burden unnecessary in Matthias' approach.



---

archive/issue_comments_481008.json:
```json
{
    "body": "Replying to [comment:126 klee]:\n> Replying to [comment:125 dimpase]:\n> > > Maintaining the homebrew formula ourselves would be as burdensome as keeping a part of gnulib in our source tree.\n\n> > \n> > No, no! A brew formula can pull from a git repo.\n\n> \n> I see. Pulling the latest gnulib from the repo sounds nice.\n> \n> So if gnulib is not available on the system (I guess this is almost always the case),\n\nno, it's available on !Debian/Ubuntu, Fedora, etc\n\n\n> \"./configure\" would error out saying that I should brew install gnulib before continue.\n> Right? \n\n\nno. It would be done by `./bootstrap`.\n\nconfigure (and confgure spkg) would already provide what's needed from gnulib.\nSo anyone who doesn't modify `./configure` won't even notice.\n\n> I imagine this would be an extra hurdle for a new user.\n> \n> > How is it a burden?\n> > https://docs.brew.sh/How-to-Create-and-Maintain-a-Tap\n\n> \n> I guess that practically gnulib in sage would need to be updated very rarely. If so, keeping hombrew formula (and conda formula too?) is a burden unnecessary in Matthias' approach. \n\n\nMatthias' solution dumps a lot of unamended code in Sage git tree, as if there is no internet or a system package to get it from...",
    "created_at": "2022-07-29T09:17:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481008",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:126 klee]:
> Replying to [comment:125 dimpase]:
> > > Maintaining the homebrew formula ourselves would be as burdensome as keeping a part of gnulib in our source tree.

> > 
> > No, no! A brew formula can pull from a git repo.

> 
> I see. Pulling the latest gnulib from the repo sounds nice.
> 
> So if gnulib is not available on the system (I guess this is almost always the case),

no, it's available on !Debian/Ubuntu, Fedora, etc


> "./configure" would error out saying that I should brew install gnulib before continue.
> Right? 


no. It would be done by `./bootstrap`.

configure (and confgure spkg) would already provide what's needed from gnulib.
So anyone who doesn't modify `./configure` won't even notice.

> I imagine this would be an extra hurdle for a new user.
> 
> > How is it a burden?
> > https://docs.brew.sh/How-to-Create-and-Maintain-a-Tap

> 
> I guess that practically gnulib in sage would need to be updated very rarely. If so, keeping hombrew formula (and conda formula too?) is a burden unnecessary in Matthias' approach. 


Matthias' solution dumps a lot of unamended code in Sage git tree, as if there is no internet or a system package to get it from...



---

archive/issue_comments_481009.json:
```json
{
    "body": "Replying to [comment:127 dimpase]:\n> Replying to [comment:126 klee]:\n> > So if gnulib is not available on the system (I guess this is almost always the case),\n\n> no, it's available on !Debian/Ubuntu, Fedora, etc\n\nI meant mac users...\n\n> > \"./configure\" would error out saying that I should brew install gnulib before continue.\n> > Right? \n\n> \n> no. It would be done by `./bootstrap`.\n\n\nSo in your solution, `brew install gnulib` will be a prerequisite before `./bootstrap` for a new mac user?\n\nPresently, Xcode is a unique prerequisite to build sage from source. In your solution, `gnulib` will be another one.  \n\n> Matthias' solution dumps a lot of unamended code in Sage git tree, as if there is no internet or a system package to get it from...\n\n\nI agree that it is not beautiful. But in terms of maintainability, I think unamended code is less problematic than amended. (I am thinking of amended Sphinx extension code in sage)\n\nI guess linux users would prefer your solution, but as a mac user I prefer Matthias' one...",
    "created_at": "2022-07-29T11:31:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481009",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:127 dimpase]:
> Replying to [comment:126 klee]:
> > So if gnulib is not available on the system (I guess this is almost always the case),

> no, it's available on !Debian/Ubuntu, Fedora, etc

I meant mac users...

> > "./configure" would error out saying that I should brew install gnulib before continue.
> > Right? 

> 
> no. It would be done by `./bootstrap`.


So in your solution, `brew install gnulib` will be a prerequisite before `./bootstrap` for a new mac user?

Presently, Xcode is a unique prerequisite to build sage from source. In your solution, `gnulib` will be another one.  

> Matthias' solution dumps a lot of unamended code in Sage git tree, as if there is no internet or a system package to get it from...


I agree that it is not beautiful. But in terms of maintainability, I think unamended code is less problematic than amended. (I am thinking of amended Sphinx extension code in sage)

I guess linux users would prefer your solution, but as a mac user I prefer Matthias' one...



---

archive/issue_comments_481010.json:
```json
{
    "body": "I am talking about Homebrew users, not the other macOS users.\n\nBesides, isn't it true that our gfortran doesn't build on the increasingly popular M1 macs, and so just Xcode is not enough any more, anyway.\n\nFor mac non-homebrew (and other gnulib-less platforms)  developers we can have few extra lines in bootsrtap to install gnulib into upstream/, if needed.",
    "created_at": "2022-07-29T11:56:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481010",
    "user": "https://github.com/dimpase"
}
```

I am talking about Homebrew users, not the other macOS users.

Besides, isn't it true that our gfortran doesn't build on the increasingly popular M1 macs, and so just Xcode is not enough any more, anyway.

For mac non-homebrew (and other gnulib-less platforms)  developers we can have few extra lines in bootsrtap to install gnulib into upstream/, if needed.



---

archive/issue_comments_481011.json:
```json
{
    "body": "Dima, let me try to summarize the approach that you are advocating. Correct me if I get anything wrong.\n\nDima 1. Start maintaining a homebrew recipe that tracks the `main` branch of Gnulib.\n\nDima 2. Start maintaining a conda-forge feedstock that tracks the `main` branch of Gnulib.\n\nDima 3. Extend `bootstrap` so that it uses and runs a `gnulib-tool` found in the system, no matter what version.\n\nDima 4. Extend `bootstrap` so that if no `gnulib-tool` is found in the system, it uses `git` to checkout the HEAD of the `main` branch of Gnulib, and then runs `gnulib-tool` from there. (This introduces a dependency on `git` for the bootstrapping and a dependency on internet connectivity for bootstrapping.)",
    "created_at": "2022-07-29T18:04:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481011",
    "user": "https://github.com/mkoeppe"
}
```

Dima, let me try to summarize the approach that you are advocating. Correct me if I get anything wrong.

Dima 1. Start maintaining a homebrew recipe that tracks the `main` branch of Gnulib.

Dima 2. Start maintaining a conda-forge feedstock that tracks the `main` branch of Gnulib.

Dima 3. Extend `bootstrap` so that it uses and runs a `gnulib-tool` found in the system, no matter what version.

Dima 4. Extend `bootstrap` so that if no `gnulib-tool` is found in the system, it uses `git` to checkout the HEAD of the `main` branch of Gnulib, and then runs `gnulib-tool` from there. (This introduces a dependency on `git` for the bootstrapping and a dependency on internet connectivity for bootstrapping.)



---

archive/issue_comments_481012.json:
```json
{
    "body": "1 and 2 are optional. 3 and 4 alone would do the job.",
    "created_at": "2022-07-29T22:20:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481012",
    "user": "https://github.com/dimpase"
}
```

1 and 2 are optional. 3 and 4 alone would do the job.



---

archive/issue_comments_481013.json:
```json
{
    "body": "Then would you agree that we leave 1 and 2 out of this discussion altogether? \n\nThese two just seem wildly out of place for our project -- we are not currently maintaining any downstream recipes and for the Sage project to start to do so would require a really good reason, I'd say.\n\n(By the way, homebrew packaging does not work like you suggest. Every package is versioned. There is no package that just goes like \"fetch from upstream HEAD\". All homebrew recipes that pull from a repository pull from a specific ref. To install a HEAD version instead of the pinned version, there is a special command `brew install --HEAD` that overrides the pin.)",
    "created_at": "2022-07-29T22:27:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481013",
    "user": "https://github.com/mkoeppe"
}
```

Then would you agree that we leave 1 and 2 out of this discussion altogether? 

These two just seem wildly out of place for our project -- we are not currently maintaining any downstream recipes and for the Sage project to start to do so would require a really good reason, I'd say.

(By the way, homebrew packaging does not work like you suggest. Every package is versioned. There is no package that just goes like "fetch from upstream HEAD". All homebrew recipes that pull from a repository pull from a specific ref. To install a HEAD version instead of the pinned version, there is a special command `brew install --HEAD` that overrides the pin.)



---

archive/issue_comments_481014.json:
```json
{
    "body": "Sure we can concentrate on 3 and 4 here.",
    "created_at": "2022-07-31T09:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481014",
    "user": "https://github.com/dimpase"
}
```

Sure we can concentrate on 3 and 4 here.



---

archive/issue_comments_481015.json:
```json
{
    "body": "Replying to [comment:130 mkoeppe]:\n> (This introduces a dependency on `git` for the bootstrapping and a dependency on internet connectivity for bootstrapping.)\n\n\nThis is reasonable.",
    "created_at": "2022-07-31T13:41:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481015",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:130 mkoeppe]:
> (This introduces a dependency on `git` for the bootstrapping and a dependency on internet connectivity for bootstrapping.)


This is reasonable.



---

archive/issue_comments_481016.json:
```json
{
    "body": "Replying to [comment:134 klee]:\n> Replying to [comment:130 mkoeppe]:\n> > (This introduces a dependency on `git` for the bootstrapping and a dependency on internet connectivity for bootstrapping.)\n\n> \n> This is reasonable.\n\n\nIn fact, `./bootstrap` is already dependent on internet connectivity - if it fails it tries do download `configure.spkg`. For building from git repo, internet connectivity is mandatory too (at least for the 1st build, which fetches tarballs to unstream/).\n\nAs well, if someone wants to do a remotely meaningful work on Sage, and that's a reason to run bootstrap, then `git` would already be there.\n\n---\n\nWe should pay more attention to our source tarballs - ideally they should already be configured, and so running bootstrap is never needed.",
    "created_at": "2022-07-31T13:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481016",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:134 klee]:
> Replying to [comment:130 mkoeppe]:
> > (This introduces a dependency on `git` for the bootstrapping and a dependency on internet connectivity for bootstrapping.)

> 
> This is reasonable.


In fact, `./bootstrap` is already dependent on internet connectivity - if it fails it tries do download `configure.spkg`. For building from git repo, internet connectivity is mandatory too (at least for the 1st build, which fetches tarballs to unstream/).

As well, if someone wants to do a remotely meaningful work on Sage, and that's a reason to run bootstrap, then `git` would already be there.

---

We should pay more attention to our source tarballs - ideally they should already be configured, and so running bootstrap is never needed.



---

archive/issue_comments_481017.json:
```json
{
    "body": "Replying to [comment:135 dimpase]:\n> We should pay more attention to our source tarballs - ideally they should already be configured, and so running bootstrap is never needed.\n\n\nYou probably mean \"they should already be bootstrapped\". And yes, they are.",
    "created_at": "2022-07-31T15:40:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481017",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:135 dimpase]:
> We should pay more attention to our source tarballs - ideally they should already be configured, and so running bootstrap is never needed.


You probably mean "they should already be bootstrapped". And yes, they are.



---

archive/issue_comments_481018.json:
```json
{
    "body": "Given that 4 is necessary to be included in this plan, is there a really a need for 3 or can we eliminate it too and focus on 4?\n\nPeople don't have gnulib installations in their system installations because even though debian and some other distro do have this package, it is not dependency of any package.",
    "created_at": "2022-07-31T15:46:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481018",
    "user": "https://github.com/mkoeppe"
}
```

Given that 4 is necessary to be included in this plan, is there a really a need for 3 or can we eliminate it too and focus on 4?

People don't have gnulib installations in their system installations because even though debian and some other distro do have this package, it is not dependency of any package.



---

archive/issue_comments_481019.json:
```json
{
    "body": "Replying to [comment:137 mkoeppe]:\n> Given that 4 is necessary to be included in this plan, is there a really a need for 3 or can we eliminate it too and focus on 4?\n> \n> People don't have gnulib installations in their system installations because even though debian and some other distro do have this package, it is not dependency of any package.\n\n\nThe plan is to add upstream/gnulib to PATH and check for gnulib-tool in ./bootstrap. \nIf found, just call it.\n\nIf not, `git clone` gnulib in upstream/ - then gnulib-tool is already there, so it can be called.\n\nThis is options 3+4 with almost the same amount of code as for option 4 alone.",
    "created_at": "2022-07-31T16:29:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481019",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:137 mkoeppe]:
> Given that 4 is necessary to be included in this plan, is there a really a need for 3 or can we eliminate it too and focus on 4?
> 
> People don't have gnulib installations in their system installations because even though debian and some other distro do have this package, it is not dependency of any package.


The plan is to add upstream/gnulib to PATH and check for gnulib-tool in ./bootstrap. 
If found, just call it.

If not, `git clone` gnulib in upstream/ - then gnulib-tool is already there, so it can be called.

This is options 3+4 with almost the same amount of code as for option 4 alone.



---

archive/issue_comments_481020.json:
```json
{
    "body": "Next question regarding Dima 4: Are you sure you want us to `git clone` from upstream main HEAD? Not checkout a fixed commit?",
    "created_at": "2022-07-31T16:41:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481020",
    "user": "https://github.com/mkoeppe"
}
```

Next question regarding Dima 4: Are you sure you want us to `git clone` from upstream main HEAD? Not checkout a fixed commit?



---

archive/issue_comments_481021.json:
```json
{
    "body": "Replying to [comment:139 mkoeppe]:\n> Next question regarding Dima 4: Are you sure you want us to `git clone` from upstream main HEAD? Not checkout a fixed commit?\n\n\nas far as I understand, upstream wants fresh checkouts, in absence of official releases.\nSo HEAD should it be.",
    "created_at": "2022-08-01T06:56:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481021",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:139 mkoeppe]:
> Next question regarding Dima 4: Are you sure you want us to `git clone` from upstream main HEAD? Not checkout a fixed commit?


as far as I understand, upstream wants fresh checkouts, in absence of official releases.
So HEAD should it be.



---

archive/issue_comments_481022.json:
```json
{
    "body": "We are not doing this for any other package. Why do you think it would be OK for `gnulib`?",
    "created_at": "2022-08-01T06:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481022",
    "user": "https://github.com/mkoeppe"
}
```

We are not doing this for any other package. Why do you think it would be OK for `gnulib`?



---

archive/issue_comments_481023.json:
```json
{
    "body": "Replying to [comment:141 mkoeppe]:\n> We are not doing this for any other package. Why do you think it would be OK for `gnulib`?\n\nCause that's the advice of upstream, no?",
    "created_at": "2022-08-01T08:46:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481023",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:141 mkoeppe]:
> We are not doing this for any other package. Why do you think it would be OK for `gnulib`?

Cause that's the advice of upstream, no?



---

archive/issue_comments_481024.json:
```json
{
    "body": "Replying to [comment:142 dimpase]:\n> Replying to [comment:141 mkoeppe]:\n> > We are not doing this for any other package. Why do you think it would be OK for `gnulib`?\n\n> Cause that's the advice of upstream, no?\n\nIt is secure to pull an old one tested for some time.",
    "created_at": "2022-08-01T09:10:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481024",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:142 dimpase]:
> Replying to [comment:141 mkoeppe]:
> > We are not doing this for any other package. Why do you think it would be OK for `gnulib`?

> Cause that's the advice of upstream, no?

It is secure to pull an old one tested for some time.



---

archive/issue_comments_481025.json:
```json
{
    "body": "like this? lightly tested, but seems to work\n\n---\nNew commits:",
    "created_at": "2022-08-01T14:24:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481025",
    "user": "https://github.com/dimpase"
}
```

like this? lightly tested, but seems to work

---
New commits:



---

archive/issue_comments_481026.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-01T18:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481026",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_481027.json:
```json
{
    "body": "Replying to [comment:142 dimpase]:\n> Replying to [comment:141 mkoeppe]:\n> > We are not doing this [git clone from upstream main HEAD] for any other package. Why do you think it would be OK for `gnulib`?\n\n> Cause that's the advice of upstream, no?\n\nNo, it's not. In the message that you refer to in comment:125, they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.\n\nThe Gnulib-provided bootstrap script - https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L84 - does not take an arbitrary version of gnulib-tools from the system. Rather, developers can set the environment variable `GNULIB_SRCDIR` if they want to bring their own copy. \n\n\nDima 4 is equivalent to the \"git subcheckout\" method of https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh, which we discussed back in comment:16. In https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L98 you can see that it can either check out HEAD or a fixed ref (`GNULIB_REVISION`)\n\nBut I see in the current branch you are using a fixed ref, that's great. Could you please add a comment that adds the date of the commit in a comment for reference?",
    "created_at": "2022-08-01T19:20:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481027",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:142 dimpase]:
> Replying to [comment:141 mkoeppe]:
> > We are not doing this [git clone from upstream main HEAD] for any other package. Why do you think it would be OK for `gnulib`?

> Cause that's the advice of upstream, no?

No, it's not. In the message that you refer to in comment:125, they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.

The Gnulib-provided bootstrap script - https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L84 - does not take an arbitrary version of gnulib-tools from the system. Rather, developers can set the environment variable `GNULIB_SRCDIR` if they want to bring their own copy. 


Dima 4 is equivalent to the "git subcheckout" method of https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh, which we discussed back in comment:16. In https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L98 you can see that it can either check out HEAD or a fixed ref (`GNULIB_REVISION`)

But I see in the current branch you are using a fixed ref, that's great. Could you please add a comment that adds the date of the commit in a comment for reference?



---

archive/issue_comments_481028.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-01T20:32:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481028",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_481029.json:
```json
{
    "body": "Replying to [comment:146 mkoeppe]:\n> Replying to [comment:142 dimpase]:\n> > Replying to [comment:141 mkoeppe]:\n> > > We are not doing this [git clone from upstream main HEAD] for any other package. Why do you think it would be OK for `gnulib`?\n\n> > Cause that's the advice of upstream, no?\n> \n> No, it's not. In the message that you refer to in comment:125, they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.\n\n\nHow does one know which version is good, and which is not? I presume a version used by Debian or Gentoo is likely to be OK, because it's actually used by many projects. Less sure about an arbitrary commit from the repo, but I expect, as they can't be bothered to tag a release for 9 years, all of them to be OKish.\n\n> \n> The Gnulib-provided bootstrap script - https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L84 - does not take an arbitrary version of gnulib-tools from the system. Rather, developers can set the environment variable `GNULIB_SRCDIR` if they want to bring their own copy. \n> \n> \n> Dima 4 is equivalent to the \"git subcheckout\" method of https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh, which we discussed back in comment:16. In https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L98 you can see that it can either check out HEAD or a fixed ref (`GNULIB_REVISION`)\n\n\nmaybe. A full checkout of gnulib, submodule or not, is too slow anyway to be useful for us, and it's an overkill.\n\n> \n> But I see in the current branch you are using a fixed ref, that's great. Could you please add a comment that adds the date of the commit in a comment for reference?\n\n\ndone.",
    "created_at": "2022-08-01T20:38:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481029",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:146 mkoeppe]:
> Replying to [comment:142 dimpase]:
> > Replying to [comment:141 mkoeppe]:
> > > We are not doing this [git clone from upstream main HEAD] for any other package. Why do you think it would be OK for `gnulib`?

> > Cause that's the advice of upstream, no?
> 
> No, it's not. In the message that you refer to in comment:125, they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.


How does one know which version is good, and which is not? I presume a version used by Debian or Gentoo is likely to be OK, because it's actually used by many projects. Less sure about an arbitrary commit from the repo, but I expect, as they can't be bothered to tag a release for 9 years, all of them to be OKish.

> 
> The Gnulib-provided bootstrap script - https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L84 - does not take an arbitrary version of gnulib-tools from the system. Rather, developers can set the environment variable `GNULIB_SRCDIR` if they want to bring their own copy. 
> 
> 
> Dima 4 is equivalent to the "git subcheckout" method of https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh, which we discussed back in comment:16. In https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L98 you can see that it can either check out HEAD or a fixed ref (`GNULIB_REVISION`)


maybe. A full checkout of gnulib, submodule or not, is too slow anyway to be useful for us, and it's an overkill.

> 
> But I see in the current branch you are using a fixed ref, that's great. Could you please add a comment that adds the date of the commit in a comment for reference?


done.



---

archive/issue_comments_481030.json:
```json
{
    "body": "Replying to [comment:148 dimpase]:\n> > In the message that you refer to in comment:125, they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.\n\n> \n> How does one know which version is good, and which is not? I presume a version used by Debian or Gentoo is likely to be OK, because it's actually used by many projects.\n\n\nI don't know about Gentoo (but see Francois comment:59, comment:61)\n\nAnd no, on Debian this package is *not* used for anything. It is not a build dependency of any package. comment:101",
    "created_at": "2022-08-01T20:47:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481030",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:148 dimpase]:
> > In the message that you refer to in comment:125, they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.

> 
> How does one know which version is good, and which is not? I presume a version used by Debian or Gentoo is likely to be OK, because it's actually used by many projects.


I don't know about Gentoo (but see Francois comment:59, comment:61)

And no, on Debian this package is *not* used for anything. It is not a build dependency of any package. comment:101



---

archive/issue_comments_481031.json:
```json
{
    "body": "Replying to [comment:148 dimpase]:\n> How does one know which version is good, and which is not?\n\n\nYou asked that before in comment:46, and I answered it in comment:47.",
    "created_at": "2022-08-01T20:49:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481031",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:148 dimpase]:
> How does one know which version is good, and which is not?


You asked that before in comment:46, and I answered it in comment:47.



---

archive/issue_comments_481032.json:
```json
{
    "body": "Replying to [comment:149 mkoeppe]:\n> Replying to [comment:148 dimpase]:\n> > > In the message that you refer to in comment:125, they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.\n\n> > \n> > How does one know which version is good, and which is not? I presume a version used by Debian or Gentoo is likely to be OK, because it's actually used by many projects.\n\n> \n> I don't know about Gentoo (but see Francois comment:59, comment:61)\n> \n> And no, on Debian this package is *not* used for anything. It is not a build dependency of any package. comment:101\n\n\n\"It is packaged as a tool for Debian package maintainers.\" - you wrote it yourself. So it is used, I presume, just not in the way controlled by official dependencies. \n\n---\n\nMy theory is that gnulib maintainers just can't be bothered to do a sane redesign - no wonder autotools receive so much public hate...",
    "created_at": "2022-08-01T20:53:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481032",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:149 mkoeppe]:
> Replying to [comment:148 dimpase]:
> > > In the message that you refer to in comment:125, they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.

> > 
> > How does one know which version is good, and which is not? I presume a version used by Debian or Gentoo is likely to be OK, because it's actually used by many projects.

> 
> I don't know about Gentoo (but see Francois comment:59, comment:61)
> 
> And no, on Debian this package is *not* used for anything. It is not a build dependency of any package. comment:101


"It is packaged as a tool for Debian package maintainers." - you wrote it yourself. So it is used, I presume, just not in the way controlled by official dependencies. 

---

My theory is that gnulib maintainers just can't be bothered to do a sane redesign - no wonder autotools receive so much public hate...



---

archive/issue_comments_481033.json:
```json
{
    "body": "Replying to [comment:151 dimpase]:\n> > And no, on Debian this package is *not* used for anything. It is not a build dependency of any package. comment:101\n\n> \n> \"It is packaged as a tool for Debian package maintainers.\" - you wrote it yourself. So it is used, I presume, just not in the way controlled by official dependencies. \n\n\nYes, for Debian package maintainers (persons) for their convenience in case they need to work on a package that has imported gnulib modules.",
    "created_at": "2022-08-01T20:55:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481033",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:151 dimpase]:
> > And no, on Debian this package is *not* used for anything. It is not a build dependency of any package. comment:101

> 
> "It is packaged as a tool for Debian package maintainers." - you wrote it yourself. So it is used, I presume, just not in the way controlled by official dependencies. 


Yes, for Debian package maintainers (persons) for their convenience in case they need to work on a package that has imported gnulib modules.



---

archive/issue_comments_481034.json:
```json
{
    "body": "Replying to [comment:150 mkoeppe]:\n> Replying to [comment:148 dimpase]:\n> > How does one know which version is good, and which is not?\n\n> \n> You asked that before in comment:46, and I answered it in comment:47.\n\n\nNamely - we treat it like any other package upgrade.",
    "created_at": "2022-08-01T20:57:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481034",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:150 mkoeppe]:
> Replying to [comment:148 dimpase]:
> > How does one know which version is good, and which is not?

> 
> You asked that before in comment:46, and I answered it in comment:47.


Namely - we treat it like any other package upgrade.



---

archive/issue_comments_481035.json:
```json
{
    "body": "Replying to [comment:150 mkoeppe]:\n> Replying to [comment:148 dimpase]:\n> > How does one know which version is good, and which is not?\n\n> \n> You asked that before in comment:46, and I answered it in comment:47.\n\n\nif true, this is an insanely wasteful approach - meaning that every, EVERY project using their beloved code must be doing its own testing?! Basically, they go to great heights to prevent organised QA of their code - \"please everyone roll your own, and no, you must not organise to do share this burden\" ?!",
    "created_at": "2022-08-01T20:59:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481035",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:150 mkoeppe]:
> Replying to [comment:148 dimpase]:
> > How does one know which version is good, and which is not?

> 
> You asked that before in comment:46, and I answered it in comment:47.


if true, this is an insanely wasteful approach - meaning that every, EVERY project using their beloved code must be doing its own testing?! Basically, they go to great heights to prevent organised QA of their code - "please everyone roll your own, and no, you must not organise to do share this burden" ?!



---

archive/issue_comments_481036.json:
```json
{
    "body": "I am getting tired of seeing the two of you arguing back and forth without anyone wanting to concede. It is sterile.\n\nWe need some form of this ticket in 9.7 for cygwin as far as I understand. If we don't solve your argument soon. Exit cygwin support.\n\nI want you to agree to each write a small brief about your side of the argument and then we will post them on sage-devel for a vote. Someone will not get what they think is right. And if we choose wrong it will be apparent soon enough. But this deadlock has to end.",
    "created_at": "2022-08-01T21:04:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481036",
    "user": "https://github.com/kiwifb"
}
```

I am getting tired of seeing the two of you arguing back and forth without anyone wanting to concede. It is sterile.

We need some form of this ticket in 9.7 for cygwin as far as I understand. If we don't solve your argument soon. Exit cygwin support.

I want you to agree to each write a small brief about your side of the argument and then we will post them on sage-devel for a vote. Someone will not get what they think is right. And if we choose wrong it will be apparent soon enough. But this deadlock has to end.



---

archive/issue_comments_481037.json:
```json
{
    "body": "Francois, in fact, today I have here a complete branch, ready for review. IMHO I convinced Matthias to at least look at it :-)",
    "created_at": "2022-08-01T21:07:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481037",
    "user": "https://github.com/dimpase"
}
```

Francois, in fact, today I have here a complete branch, ready for review. IMHO I convinced Matthias to at least look at it :-)



---

archive/issue_comments_481038.json:
```json
{
    "body": "Dima, I also looked at your previous branch, which was easily seen to be not suitable",
    "created_at": "2022-08-01T21:08:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481038",
    "user": "https://github.com/mkoeppe"
}
```

Dima, I also looked at your previous branch, which was easily seen to be not suitable



---

archive/issue_comments_481039.json:
```json
{
    "body": "Replying to [comment:155 fbissey]:\n> We need some form of this ticket in 9.7 for cygwin as far as I understand. If we don't solve your argument soon. Exit cygwin support.\n\n\nNo, it has nothing to do with Cygwin.\n\nIn fact, there isn't even a bug to be fixed. I thought there was when Marc reported this failure but there is actually no problem that needs to be solved. When gettext-devel is installed (as is documented as a bootstrap dependency), everything works OK.\n\nPresent ticket is an improvement that removes the remaining bits of dependency on gettext in our bootstrap process.",
    "created_at": "2022-08-01T21:11:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481039",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:155 fbissey]:
> We need some form of this ticket in 9.7 for cygwin as far as I understand. If we don't solve your argument soon. Exit cygwin support.


No, it has nothing to do with Cygwin.

In fact, there isn't even a bug to be fixed. I thought there was when Marc reported this failure but there is actually no problem that needs to be solved. When gettext-devel is installed (as is documented as a bootstrap dependency), everything works OK.

Present ticket is an improvement that removes the remaining bits of dependency on gettext in our bootstrap process.



---

archive/issue_comments_481040.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2022-08-01T21:13:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481040",
    "user": "https://github.com/kiwifb"
}
```

Changing priority from major to critical.



---

archive/issue_comments_481041.json:
```json
{
    "body": "Whatever it is for, it seems even less worth the arguing.\n\nYou have been at it for at least 3 weeks. I don't see a breakthrough without a third party being involved. I think a vote is the most equitable thing to do. I am giving you 24 hours from this post to reach an agreement. After that I throw the whole thing on sage-devel for a vote.",
    "created_at": "2022-08-01T21:13:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481041",
    "user": "https://github.com/kiwifb"
}
```

Whatever it is for, it seems even less worth the arguing.

You have been at it for at least 3 weeks. I don't see a breakthrough without a third party being involved. I think a vote is the most equitable thing to do. I am giving you 24 hours from this post to reach an agreement. After that I throw the whole thing on sage-devel for a vote.



---

archive/issue_comments_481042.json:
```json
{
    "body": "Replying to [comment:154 dimpase]:\n> if true, this is an insanely wasteful approach [... by upstream Gnulib]\n\n\nIt's not helpful for this ticket. As I said before, if you want to criticize their design decisions, this is the wrong forum. comment:73",
    "created_at": "2022-08-01T21:13:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481042",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:154 dimpase]:
> if true, this is an insanely wasteful approach [... by upstream Gnulib]


It's not helpful for this ticket. As I said before, if you want to criticize their design decisions, this is the wrong forum. comment:73



---

archive/issue_comments_481043.json:
```json
{
    "body": "Replying to [comment:159 fbissey]:\n> You have been at it for at least 3 weeks. I don't see a breakthrough without a third party being involved. I think a vote is the most equitable thing to do.\n\n\n+1, we actually made progress to determining something concrete that can be voted on in comment:130 to comment:133.",
    "created_at": "2022-08-01T21:15:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481043",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:159 fbissey]:
> You have been at it for at least 3 weeks. I don't see a breakthrough without a third party being involved. I think a vote is the most equitable thing to do.


+1, we actually made progress to determining something concrete that can be voted on in comment:130 to comment:133.



---

archive/issue_comments_481044.json:
```json
{
    "body": "Replying to [comment:146 mkoeppe]:\n> In the message that you refer to in comment:125, they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.\n> \n> The Gnulib-provided bootstrap script - https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L84 - does not take an arbitrary version of gnulib-tools from the system. Rather, developers can set the environment variable `GNULIB_SRCDIR` if they want to bring their own copy. \n\n\nRemains to be resolved whether Dima 3 is essential to Dima's plan or whether Gnulib's solution for this -- `GNULIB_SRCDIR` -- is acceptable.",
    "created_at": "2022-08-01T21:22:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481044",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:146 mkoeppe]:
> In the message that you refer to in comment:125, they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.
> 
> The Gnulib-provided bootstrap script - https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L84 - does not take an arbitrary version of gnulib-tools from the system. Rather, developers can set the environment variable `GNULIB_SRCDIR` if they want to bring their own copy. 


Remains to be resolved whether Dima 3 is essential to Dima's plan or whether Gnulib's solution for this -- `GNULIB_SRCDIR` -- is acceptable.



---

archive/issue_comments_481045.json:
```json
{
    "body": "I'm perfectly fine with only using `./upstream/gnulib/gnulib-tool`, if you don't like  `gnulib-tool` in the PATH.",
    "created_at": "2022-08-01T21:29:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481045",
    "user": "https://github.com/dimpase"
}
```

I'm perfectly fine with only using `./upstream/gnulib/gnulib-tool`, if you don't like  `gnulib-tool` in the PATH.



---

archive/issue_comments_481046.json:
```json
{
    "body": "OK, could you update your branch please?",
    "created_at": "2022-08-02T01:18:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481046",
    "user": "https://github.com/mkoeppe"
}
```

OK, could you update your branch please?



---

archive/issue_comments_481047.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-02T07:42:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481047",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_481048.json:
```json
{
    "body": "Replying to [comment:164 mkoeppe]:\n> OK, could you update your branch please?\n\ndone",
    "created_at": "2022-08-02T07:44:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481048",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:164 mkoeppe]:
> OK, could you update your branch please?

done



---

archive/issue_comments_481049.json:
```json
{
    "body": "Thanks.\n\nLooking at the `install_iconv` function in `bootstrap`: If we ever have to upgrade Gnulib (change the hardcoded commit), there is no mechanism that will bring this change to developer's `upstream` directories when `$SAGE_ROOT/upstream/gnulib/gnulib-tool` already exists. So this is not a complete solution yet",
    "created_at": "2022-08-02T18:48:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481049",
    "user": "https://github.com/mkoeppe"
}
```

Thanks.

Looking at the `install_iconv` function in `bootstrap`: If we ever have to upgrade Gnulib (change the hardcoded commit), there is no mechanism that will bring this change to developer's `upstream` directories when `$SAGE_ROOT/upstream/gnulib/gnulib-tool` already exists. So this is not a complete solution yet



---

archive/issue_comments_481050.json:
```json
{
    "body": "(Neither `make distclean` nor `make bootstrap-clean` clean anything in `upstream/`.)",
    "created_at": "2022-08-02T18:50:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481050",
    "user": "https://github.com/mkoeppe"
}
```

(Neither `make distclean` nor `make bootstrap-clean` clean anything in `upstream/`.)



---

archive/issue_comments_481051.json:
```json
{
    "body": "Of course, Gnulib has a complete solution for all of this: Its implementation stretches over the following files:\n- https://github.com/coreutils/gnulib/blob/master/top/bootstrap\n- https://github.com/coreutils/gnulib/blob/master/top/autopull.sh\n- https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh\n- https://github.com/coreutils/gnulib/blob/master/top/gen-bootstrap.sed",
    "created_at": "2022-08-02T18:53:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481051",
    "user": "https://github.com/mkoeppe"
}
```

Of course, Gnulib has a complete solution for all of this: Its implementation stretches over the following files:
- https://github.com/coreutils/gnulib/blob/master/top/bootstrap
- https://github.com/coreutils/gnulib/blob/master/top/autopull.sh
- https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh
- https://github.com/coreutils/gnulib/blob/master/top/gen-bootstrap.sed



---

archive/issue_comments_481052.json:
```json
{
    "body": "I can add removal of upstream/gnulib to bootstrap-clean target",
    "created_at": "2022-08-02T20:19:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481052",
    "user": "https://github.com/dimpase"
}
```

I can add removal of upstream/gnulib to bootstrap-clean target



---

archive/issue_comments_481053.json:
```json
{
    "body": "Can I take the motions happening in the last 24 hours as a sign you are moving towards a resolution without needing arbitration?",
    "created_at": "2022-08-02T21:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481053",
    "user": "https://github.com/kiwifb"
}
```

Can I take the motions happening in the last 24 hours as a sign you are moving towards a resolution without needing arbitration?



---

archive/issue_comments_481054.json:
```json
{
    "body": "Replying to [comment:171 fbissey]:\n> Can I take the motions happening in the last 24 hours as a sign you are moving towards a resolution without needing arbitration?\n\n\nYes, they are :)",
    "created_at": "2022-08-02T21:56:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481054",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:171 fbissey]:
> Can I take the motions happening in the last 24 hours as a sign you are moving towards a resolution without needing arbitration?


Yes, they are :)



---

archive/issue_comments_481055.json:
```json
{
    "body": "Replying to [comment:170 dimpase]:\n> I can add removal of upstream/gnulib to bootstrap-clean target\n\nthis is actually not a good idea, as it will force git clone on every run on bootstrap.\n\nOn the other hand, `mainainer-clean` target removes `upstream/` all together.\nFor the purposes of avoiding a possible confusion when `upstream/` is a symbolic link,\nI'll add an explicit removal of `upstream/gnulib` to `mainainer-clean`",
    "created_at": "2022-08-03T09:38:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481055",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:170 dimpase]:
> I can add removal of upstream/gnulib to bootstrap-clean target

this is actually not a good idea, as it will force git clone on every run on bootstrap.

On the other hand, `mainainer-clean` target removes `upstream/` all together.
For the purposes of avoiding a possible confusion when `upstream/` is a symbolic link,
I'll add an explicit removal of `upstream/gnulib` to `mainainer-clean`



---

archive/issue_comments_481056.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-03T09:40:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481056",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_481057.json:
```json
{
    "body": "I don't think the last change is useful. `rm -rf` does not follow symlinks either way",
    "created_at": "2022-08-03T18:01:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481057",
    "user": "https://github.com/mkoeppe"
}
```

I don't think the last change is useful. `rm -rf` does not follow symlinks either way



---

archive/issue_comments_481058.json:
```json
{
    "body": "it can be skipped, no problem. After all as soon as upstream/ is a symlink, all bets are off.",
    "created_at": "2022-08-03T20:06:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481058",
    "user": "https://github.com/dimpase"
}
```

it can be skipped, no problem. After all as soon as upstream/ is a symlink, all bets are off.



---

archive/issue_comments_481059.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-04T08:09:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481059",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_481060.json:
```json
{
    "body": "Replying to [comment:175 mkoeppe]:\n> I don't think the last change is useful. `rm -rf` does not follow symlinks either way\n\nOK, I've dropped it. Anything else?\n\nPS. Compared with the gnulib's `gitsub.sh`, the branch doesn't do a full checkout of their repo (which is 250Mb), it only checks out 83Mb (it probably can be trimmed even more, I didn't look into this). So that's a clear advantage, im my view (checking out a 250Mb repo takes a lot of time).",
    "created_at": "2022-08-04T09:11:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481060",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:175 mkoeppe]:
> I don't think the last change is useful. `rm -rf` does not follow symlinks either way

OK, I've dropped it. Anything else?

PS. Compared with the gnulib's `gitsub.sh`, the branch doesn't do a full checkout of their repo (which is 250Mb), it only checks out 83Mb (it probably can be trimmed even more, I didn't look into this). So that's a clear advantage, im my view (checking out a 250Mb repo takes a lot of time).



---

archive/issue_comments_481061.json:
```json
{
    "body": "I think it is problematic to require developers to know that they need to do `make maintainer-clean` when they pick up a branch with a gnulib version change.\n\nPreviously in this thread, you seemed very concerned about the maintenance burden that gnulib updates bring (comment:25, comment:82). The lack of an incremental update mechanism in your current branch places such a burden on developers who aren't even touching gnulib - everyone who runs gnulib.\n\nWhat do others think about this?",
    "created_at": "2022-08-04T17:04:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481061",
    "user": "https://github.com/mkoeppe"
}
```

I think it is problematic to require developers to know that they need to do `make maintainer-clean` when they pick up a branch with a gnulib version change.

Previously in this thread, you seemed very concerned about the maintenance burden that gnulib updates bring (comment:25, comment:82). The lack of an incremental update mechanism in your current branch places such a burden on developers who aren't even touching gnulib - everyone who runs gnulib.

What do others think about this?



---

archive/issue_comments_481062.json:
```json
{
    "body": "Replying to [comment:179 mkoeppe]:\n> I think it is problematic to require developers to know that they need to do `make maintainer-clean` when they pick up a branch with a gnulib version change.\n> \n> Previously in this thread, you seemed very concerned about the maintenance burden that gnulib updates bring (comment:25, comment:82). The lack of an incremental update mechanism in your current branch places such a burden on developers who aren't even touching gnulib - everyone who runs gnulib.\n\n\nMy main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. \n\nAs to incremental updates - you argued that we don't want to follow the upstream closely, i.e. no incremental updates, but just want to pin a gnulib commit, and then, at a good moment, pin a newer one. That's what my branch does.\n\nI can add a comment in ./bootstrap regarding the way to do this kind of update -  that certainly should be enough IMHO.",
    "created_at": "2022-08-04T20:19:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481062",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:179 mkoeppe]:
> I think it is problematic to require developers to know that they need to do `make maintainer-clean` when they pick up a branch with a gnulib version change.
> 
> Previously in this thread, you seemed very concerned about the maintenance burden that gnulib updates bring (comment:25, comment:82). The lack of an incremental update mechanism in your current branch places such a burden on developers who aren't even touching gnulib - everyone who runs gnulib.


My main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. 

As to incremental updates - you argued that we don't want to follow the upstream closely, i.e. no incremental updates, but just want to pin a gnulib commit, and then, at a good moment, pin a newer one. That's what my branch does.

I can add a comment in ./bootstrap regarding the way to do this kind of update -  that certainly should be enough IMHO.



---

archive/issue_comments_481063.json:
```json
{
    "body": "Replying to [comment:180 dimpase]:\n> As to incremental updates - you argued that we don't want to follow the upstream closely, i.e. no incremental updates, but just want to pin a gnulib commit, and then, at a good moment, pin a newer one. That's what my branch does.\n\n\nYes, but developers (everyone who has ever run `./bootstrap` in the tree) will not get the new pin unless they manually run `make maintainer-clean`.",
    "created_at": "2022-08-04T20:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481063",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:180 dimpase]:
> As to incremental updates - you argued that we don't want to follow the upstream closely, i.e. no incremental updates, but just want to pin a gnulib commit, and then, at a good moment, pin a newer one. That's what my branch does.


Yes, but developers (everyone who has ever run `./bootstrap` in the tree) will not get the new pin unless they manually run `make maintainer-clean`.



---

archive/issue_comments_481064.json:
```json
{
    "body": "Replying to [comment:180 dimpase]:\n> My main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. \n\n\nYou still haven't quite explained what exactly the nature of this concern is and why it weighs so heavy that it would warrant the complexity of a script that checks out 83 MB from the Gnulib git repo?\n\nTo compare with the copied files:\n\n```\n$ du -sh config/config.rpath m4/lib-*.m4 m4/iconv.m4 m4/host-cpu-c-abi.m4\n 20K\tconfig/config.rpath\n8.0K\tm4/lib-ld.m4\n 36K\tm4/lib-link.m4\n 12K\tm4/lib-prefix.m4\n 12K\tm4/iconv.m4\n 24K\tm4/host-cpu-c-abi.m4\n```",
    "created_at": "2022-08-04T20:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481064",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:180 dimpase]:
> My main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. 


You still haven't quite explained what exactly the nature of this concern is and why it weighs so heavy that it would warrant the complexity of a script that checks out 83 MB from the Gnulib git repo?

To compare with the copied files:

```
$ du -sh config/config.rpath m4/lib-*.m4 m4/iconv.m4 m4/host-cpu-c-abi.m4
 20K	config/config.rpath
8.0K	m4/lib-ld.m4
 36K	m4/lib-link.m4
 12K	m4/lib-prefix.m4
 12K	m4/iconv.m4
 24K	m4/host-cpu-c-abi.m4
```



---

archive/issue_comments_481065.json:
```json
{
    "body": "Replying to [comment:182 mkoeppe]:\n> Replying to [comment:180 dimpase]:\n> > My main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. \n\n> \n> You still haven't quite explained what exactly the nature of this concern is and why it weighs so heavy that it would warrant the complexity of a script that checks out 83 MB \n> from the Gnulib git repo?\n\n\nThe complexity of the 20-line script? Where is the compelexity there? \nThere isn't even a loop. 1/3rd of it is about supporting `-q` option of ./bootstrap.\n\n> \n> To compare with the copied files:\n> \n> ```\n> $ du -sh config/config.rpath m4/lib-*.m4 m4/iconv.m4 m4/host-cpu-c-abi.m4\n>  20K\tconfig/config.rpath\n> 8.0K\tm4/lib-ld.m4\n>  36K\tm4/lib-link.m4\n>  12K\tm4/lib-prefix.m4\n>  12K\tm4/iconv.m4\n>  24K\tm4/host-cpu-c-abi.m4\n> ```\n\n\nThis is not Sage's code, it has no place in Sage git tree - and there are means to get it in if needed. And your branch provides absolutely zero support for updating said code, while you keep arguing here that my code provides less than ideal support for it...\n\nTo update files in your branch, one would need to manually install gnulib, and run `gnulib-tool` with appropriate options, remove the unneeded files, and check the result in. You already made a mistake setting it up in the previous ticket. \n\nUpdating in my branch is trivial compared to this.",
    "created_at": "2022-08-04T21:59:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481065",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:182 mkoeppe]:
> Replying to [comment:180 dimpase]:
> > My main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. 

> 
> You still haven't quite explained what exactly the nature of this concern is and why it weighs so heavy that it would warrant the complexity of a script that checks out 83 MB 
> from the Gnulib git repo?


The complexity of the 20-line script? Where is the compelexity there? 
There isn't even a loop. 1/3rd of it is about supporting `-q` option of ./bootstrap.

> 
> To compare with the copied files:
> 
> ```
> $ du -sh config/config.rpath m4/lib-*.m4 m4/iconv.m4 m4/host-cpu-c-abi.m4
>  20K	config/config.rpath
> 8.0K	m4/lib-ld.m4
>  36K	m4/lib-link.m4
>  12K	m4/lib-prefix.m4
>  12K	m4/iconv.m4
>  24K	m4/host-cpu-c-abi.m4
> ```


This is not Sage's code, it has no place in Sage git tree - and there are means to get it in if needed. And your branch provides absolutely zero support for updating said code, while you keep arguing here that my code provides less than ideal support for it...

To update files in your branch, one would need to manually install gnulib, and run `gnulib-tool` with appropriate options, remove the unneeded files, and check the result in. You already made a mistake setting it up in the previous ticket. 

Updating in my branch is trivial compared to this.



---

archive/issue_comments_481066.json:
```json
{
    "body": "Replying to [comment:183 dimpase]:\n> Replying to [comment:182 mkoeppe]:\n> > Replying to [comment:180 dimpase]:\n> > > My main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. \n\n> > \n> > You still haven't quite explained what exactly the nature of this concern is and why it weighs so heavy that it would warrant the complexity of a script that checks out 83 MB \n> > from the Gnulib git repo?\n\n> \n> The complexity of the 20-line script? Where is the compelexity there? \n\n\nYour script is not complete yet, see comment:179",
    "created_at": "2022-08-04T22:02:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481066",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:183 dimpase]:
> Replying to [comment:182 mkoeppe]:
> > Replying to [comment:180 dimpase]:
> > > My main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. 

> > 
> > You still haven't quite explained what exactly the nature of this concern is and why it weighs so heavy that it would warrant the complexity of a script that checks out 83 MB 
> > from the Gnulib git repo?

> 
> The complexity of the 20-line script? Where is the compelexity there? 


Your script is not complete yet, see comment:179



---

archive/issue_comments_481067.json:
```json
{
    "body": "Replying to [comment:183 dimpase]:\n> Updating in my branch is trivial compared to this.\n\n\nFor the ticket author who works on the gnulib update, yes. For everyone else, as I said, it introduces a burden.",
    "created_at": "2022-08-04T22:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481067",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:183 dimpase]:
> Updating in my branch is trivial compared to this.


For the ticket author who works on the gnulib update, yes. For everyone else, as I said, it introduces a burden.



---

archive/issue_comments_481068.json:
```json
{
    "body": "But maybe you can just find a simple solution for this problem? Just a few more lines of shell script",
    "created_at": "2022-08-04T22:13:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481068",
    "user": "https://github.com/mkoeppe"
}
```

But maybe you can just find a simple solution for this problem? Just a few more lines of shell script



---

archive/issue_comments_481069.json:
```json
{
    "body": "Replying to [comment:184 mkoeppe]:\n> Replying to [comment:183 dimpase]:\n> > Replying to [comment:182 mkoeppe]:\n> > > Replying to [comment:180 dimpase]:\n> > > > My main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. \n\n> > > \n> > > You still haven't quite explained what exactly the nature of this concern is and why it weighs so heavy that it would warrant the complexity of a script that checks out 83 MB \n> > > from the Gnulib git repo?\n\n> > \n> > The complexity of the 20-line script? Where is the compelexity there? \n\n> \n> Your script is not complete yet, see comment:179\n\nAs I wrote, I think it suffices to put something like\n\n```\n# to update macros coming from gnulib:\n# 1) change the commit hash below to the one desired\n# 2) remove upstream/gnulib/, e.g. by running \n#    make maintainer-clean\n# 3) re-run ./bootstrap\n```\nin ./bootstrap's `install_iconv()`",
    "created_at": "2022-08-04T22:24:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481069",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:184 mkoeppe]:
> Replying to [comment:183 dimpase]:
> > Replying to [comment:182 mkoeppe]:
> > > Replying to [comment:180 dimpase]:
> > > > My main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. 

> > > 
> > > You still haven't quite explained what exactly the nature of this concern is and why it weighs so heavy that it would warrant the complexity of a script that checks out 83 MB 
> > > from the Gnulib git repo?

> > 
> > The complexity of the 20-line script? Where is the compelexity there? 

> 
> Your script is not complete yet, see comment:179

As I wrote, I think it suffices to put something like

```
# to update macros coming from gnulib:
# 1) change the commit hash below to the one desired
# 2) remove upstream/gnulib/, e.g. by running 
#    make maintainer-clean
# 3) re-run ./bootstrap
```
in ./bootstrap's `install_iconv()`



---

archive/issue_comments_481070.json:
```json
{
    "body": "These would be instructions for who?",
    "created_at": "2022-08-04T22:25:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481070",
    "user": "https://github.com/mkoeppe"
}
```

These would be instructions for who?



---

archive/issue_comments_481071.json:
```json
{
    "body": "I am sorry to admit that there is still a chasm between you, and it seems that sage-devel voting is the only way to escape from this seemingly eternal debate...\n\nThe voting would be about: \n\nDima's approach: install Gnulib by pulling 83 MB from Gnulib git repo (Dima, please rewrite in line of length < 80)\n\nvs\n\nMatthias' approach: install Gnulib by copying 112 KB into sagelib source tree (Matthias, please rewrite in line of length < 80)\n\nDima writes cons of Matthias' approach in 3 lines of each length < 80\n\nMatthias writes cons of Dima's approach in 3 lines of each length < 80\n\nThen please Fran\u00e7ois post the voting to sage-devel. Okay?",
    "created_at": "2022-08-04T22:41:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481071",
    "user": "https://github.com/kwankyu"
}
```

I am sorry to admit that there is still a chasm between you, and it seems that sage-devel voting is the only way to escape from this seemingly eternal debate...

The voting would be about: 

Dima's approach: install Gnulib by pulling 83 MB from Gnulib git repo (Dima, please rewrite in line of length < 80)

vs

Matthias' approach: install Gnulib by copying 112 KB into sagelib source tree (Matthias, please rewrite in line of length < 80)

Dima writes cons of Matthias' approach in 3 lines of each length < 80

Matthias writes cons of Dima's approach in 3 lines of each length < 80

Then please Franois post the voting to sage-devel. Okay?



---

archive/issue_comments_481072.json:
```json
{
    "body": "I am afraid it looks that way too. I will once we have the Matthias and Dima's position arguments.",
    "created_at": "2022-08-04T22:45:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481072",
    "user": "https://github.com/kiwifb"
}
```

I am afraid it looks that way too. I will once we have the Matthias and Dima's position arguments.



---

archive/issue_comments_481073.json:
```json
{
    "body": "Replying to [comment:188 mkoeppe]:\n> These would be instructions for who?\n\n\nfor whoever will be updating the version of gnulib we use, isn't it obvious?",
    "created_at": "2022-08-04T22:57:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481073",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:188 mkoeppe]:
> These would be instructions for who?


for whoever will be updating the version of gnulib we use, isn't it obvious?



---

archive/issue_comments_481074.json:
```json
{
    "body": "Replying to [comment:191 dimpase]:\n> Replying to [comment:188 mkoeppe]:\n> > These would be instructions for who?\n\n> \n> for whoever will be updating the version of gnulib we use, isn't it obvious?\n\n\nYou've apparently missed my point in comment:179\n\nYes, step 1 of your instructions needs to be run by \"whoever will be updating the version of gnulib we use\", that is, the ticket author.\n\nBut step 2 has to be run by everyone who runs `./bootstrap` and switches to a branch that contains such an update ticket.",
    "created_at": "2022-08-04T23:00:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481074",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:191 dimpase]:
> Replying to [comment:188 mkoeppe]:
> > These would be instructions for who?

> 
> for whoever will be updating the version of gnulib we use, isn't it obvious?


You've apparently missed my point in comment:179

Yes, step 1 of your instructions needs to be run by "whoever will be updating the version of gnulib we use", that is, the ticket author.

But step 2 has to be run by everyone who runs `./bootstrap` and switches to a branch that contains such an update ticket.



---

archive/issue_comments_481075.json:
```json
{
    "body": "Replying to [comment:192 mkoeppe]:\n> Replying to [comment:191 dimpase]:\n> > Replying to [comment:188 mkoeppe]:\n> > > These would be instructions for who?\n\n> > \n> > for whoever will be updating the version of gnulib we use, isn't it obvious?\n\n> \n> You've apparently missed my point in comment:179\n> \n> Yes, step 1 of your instructions needs to be run by \"whoever will be updating the version of gnulib we use\", that is, the ticket author.\n> \n> But step 2 has to be run by everyone who runs `./bootstrap` and switches to a branch that contains such an update ticket.\n\n\nAh, right, sorry. So we need to check that the output of `git rev-parse HEAD` in upstream/gnulib repo equals the commit hash hardwired in ./bootstrap, and if not, fetch the latter commit from the repo.",
    "created_at": "2022-08-04T23:31:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481075",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:192 mkoeppe]:
> Replying to [comment:191 dimpase]:
> > Replying to [comment:188 mkoeppe]:
> > > These would be instructions for who?

> > 
> > for whoever will be updating the version of gnulib we use, isn't it obvious?

> 
> You've apparently missed my point in comment:179
> 
> Yes, step 1 of your instructions needs to be run by "whoever will be updating the version of gnulib we use", that is, the ticket author.
> 
> But step 2 has to be run by everyone who runs `./bootstrap` and switches to a branch that contains such an update ticket.


Ah, right, sorry. So we need to check that the output of `git rev-parse HEAD` in upstream/gnulib repo equals the commit hash hardwired in ./bootstrap, and if not, fetch the latter commit from the repo.



---

archive/issue_comments_481076.json:
```json
{
    "body": "Replying to [comment:189 klee]:\n> Matthias' approach: install Gnulib by copying 112 KB into sagelib source tree (Matthias, please rewrite in line of length < 80)\n\n\nI've put a short description in the ticket box",
    "created_at": "2022-08-04T23:39:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481076",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:189 klee]:
> Matthias' approach: install Gnulib by copying 112 KB into sagelib source tree (Matthias, please rewrite in line of length < 80)


I've put a short description in the ticket box



---

archive/issue_comments_481077.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-04T23:53:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481077",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_481078.json:
```json
{
    "body": "Replying to [comment:204 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                           |                                           |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|\n> |[fd82fb9](https://git.sagemath.org/sage.git/commit/?id=fd82fb9ea530fab6f9b9b4d2e77a8d0e1c4f565e)|`check that installed gnulib is up to date`|\n\n\nthis is the change as explained in comment:194 - needs testing (I tend to get srting comparison in scripts wrong :-))",
    "created_at": "2022-08-04T23:59:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481078",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:204 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                           |                                           |
> |-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|
> |[fd82fb9](https://git.sagemath.org/sage.git/commit/?id=fd82fb9ea530fab6f9b9b4d2e77a8d0e1c4f565e)|`check that installed gnulib is up to date`|


this is the change as explained in comment:194 - needs testing (I tend to get srting comparison in scripts wrong :-))



---

archive/issue_comments_481079.json:
```json
{
    "body": "Ok is the material in the description what you want for going to a vote? Last call before I prepare the post.",
    "created_at": "2022-08-05T00:36:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481079",
    "user": "https://github.com/kiwifb"
}
```

Ok is the material in the description what you want for going to a vote? Last call before I prepare the post.



---

archive/issue_comments_481080.json:
```json
{
    "body": "I think Dima should have a chance to edit the description and finish his branch",
    "created_at": "2022-08-05T00:37:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481080",
    "user": "https://github.com/mkoeppe"
}
```

I think Dima should have a chance to edit the description and finish his branch



---

archive/issue_comments_481081.json:
```json
{
    "body": "Replying to [comment:209 mkoeppe]:\n> I think Dima should have a chance to edit the description and finish his branch\n\n\nFair enough, a few hours will not make much difference at this point.",
    "created_at": "2022-08-05T00:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481081",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:209 mkoeppe]:
> I think Dima should have a chance to edit the description and finish his branch


Fair enough, a few hours will not make much difference at this point.



---

archive/issue_comments_481082.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-08-05T09:49:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481082",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_481083.json:
```json
{
    "body": "OK, fixed the branch, and expanded ticket description.",
    "created_at": "2022-08-05T09:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481083",
    "user": "https://github.com/dimpase"
}
```

OK, fixed the branch, and expanded ticket description.



---

archive/issue_comments_481084.json:
```json
{
    "body": "Matthias's branch link doesn't work.",
    "created_at": "2022-08-05T10:08:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481084",
    "user": "https://github.com/kwankyu"
}
```

Matthias's branch link doesn't work.



---

archive/issue_comments_481085.json:
```json
{
    "body": "It seems that `__` at the end of the branch name disappears.",
    "created_at": "2022-08-05T10:14:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481085",
    "user": "https://github.com/kwankyu"
}
```

It seems that `__` at the end of the branch name disappears.



---

archive/issue_comments_481086.json:
```json
{
    "body": "In Dima's branch: the sentence below seems broken. Omit `and`?\n\n```bash\necho >&2 \"gnulib-tool needs to be installed and in your PATH. We install a copy in upstream/ \"\n```",
    "created_at": "2022-08-05T10:38:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481086",
    "user": "https://github.com/kwankyu"
}
```

In Dima's branch: the sentence below seems broken. Omit `and`?

```bash
echo >&2 "gnulib-tool needs to be installed and in your PATH. We install a copy in upstream/ "
```



---

archive/issue_comments_481087.json:
```json
{
    "body": "In Dima' branch:\n\nI think it is better to place gnulib at its own directory `gnulib` instead of `upstream/gnulib`, since gnulib is not an ordinary package. It looks odd to me to find the gnulib directory in `upstream` among all those tar files.",
    "created_at": "2022-08-05T11:21:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481087",
    "user": "https://github.com/kwankyu"
}
```

In Dima' branch:

I think it is better to place gnulib at its own directory `gnulib` instead of `upstream/gnulib`, since gnulib is not an ordinary package. It looks odd to me to find the gnulib directory in `upstream` among all those tar files.



---

archive/issue_comments_481088.json:
```json
{
    "body": "I'm going to add a paragraph to the \"Background\" that explains in what situations `./bootstrap` must be run.",
    "created_at": "2022-08-05T17:22:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481088",
    "user": "https://github.com/mkoeppe"
}
```

I'm going to add a paragraph to the "Background" that explains in what situations `./bootstrap` must be run.



---

archive/issue_comments_481089.json:
```json
{
    "body": "Replying to [comment:220 klee]:\n> In Dima' branch:\n> \n> I think it is better to place gnulib at its own directory `gnulib` instead of `upstream/gnulib`, since gnulib is not an ordinary package. It looks odd to me to find the gnulib directory in `upstream` among all those tar files.\n\n\ngnulib is an upstream package which does not provide tarballs. So instead of a tarball one has a directory under git control.",
    "created_at": "2022-08-05T19:47:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481089",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:220 klee]:
> In Dima' branch:
> 
> I think it is better to place gnulib at its own directory `gnulib` instead of `upstream/gnulib`, since gnulib is not an ordinary package. It looks odd to me to find the gnulib directory in `upstream` among all those tar files.


gnulib is an upstream package which does not provide tarballs. So instead of a tarball one has a directory under git control.



---

archive/issue_comments_481090.json:
```json
{
    "body": "Let's see if we can reach consensus on the question how often the files / the commit hash will have to be updated. Previously in this thread: \n- dimpase in comment:25 \"likely to cause trouble if not updated on time... maintenance is problematic\"\n- klee in comment:126 \"I guess that practically gnulib in sage would need to be updated very rarely.\"\nHistorical information on the relevant files of gnulib can be obtained by using `git log build-aux/config.rpath m4/lib-* m4/iconv.m4 m4/host-cpu-c-abi.m4` in a clone of Gnulib. I think the last change relevant for any of our supported platforms is from 2017.",
    "created_at": "2022-08-05T20:58:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481090",
    "user": "https://github.com/mkoeppe"
}
```

Let's see if we can reach consensus on the question how often the files / the commit hash will have to be updated. Previously in this thread: 
- dimpase in comment:25 "likely to cause trouble if not updated on time... maintenance is problematic"
- klee in comment:126 "I guess that practically gnulib in sage would need to be updated very rarely."
Historical information on the relevant files of gnulib can be obtained by using `git log build-aux/config.rpath m4/lib-* m4/iconv.m4 m4/host-cpu-c-abi.m4` in a clone of Gnulib. I think the last change relevant for any of our supported platforms is from 2017.



---

archive/issue_comments_481091.json:
```json
{
    "body": "By \"problematic\" I meant it's easy to make an error in your fully manual approach. And it's hard to test, as one needs to uninstall gettext, something that might be hard on some OSs, or create an artificial isolated environment/VM.\n\n\nMy proposal is essentially to add a semi-standard package to Sage (and use it in bootstrap). We have many rarely updated packages, and many packages with tarballs of size tens of Mb (matplotlib, Pillow, SciPy, GAP, giac, etc). I don't get why there is such a pushback against it.",
    "created_at": "2022-08-05T21:27:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481091",
    "user": "https://github.com/dimpase"
}
```

By "problematic" I meant it's easy to make an error in your fully manual approach. And it's hard to test, as one needs to uninstall gettext, something that might be hard on some OSs, or create an artificial isolated environment/VM.


My proposal is essentially to add a semi-standard package to Sage (and use it in bootstrap). We have many rarely updated packages, and many packages with tarballs of size tens of Mb (matplotlib, Pillow, SciPy, GAP, giac, etc). I don't get why there is such a pushback against it.



---

archive/issue_comments_481092.json:
```json
{
    "body": "Replying to [comment:231 dimpase]:\n > My proposal is essentially to add a semi-standard package to Sage (and use it in bootstrap). \n\nI meant that by \"not ordinary package\".\n\n> By \"problematic\" I meant it's easy to make an error in your fully manual approach. And it's hard to test, as one needs to uninstall gettext, something that might be hard on some OSs, or create an artificial isolated environment/VM.\n\n\nIf Matthias' approach is adopted after voting, your script could be used as an automatic way to update gnulib in sage.",
    "created_at": "2022-08-05T21:49:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481092",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:231 dimpase]:
 > My proposal is essentially to add a semi-standard package to Sage (and use it in bootstrap). 

I meant that by "not ordinary package".

> By "problematic" I meant it's easy to make an error in your fully manual approach. And it's hard to test, as one needs to uninstall gettext, something that might be hard on some OSs, or create an artificial isolated environment/VM.


If Matthias' approach is adopted after voting, your script could be used as an automatic way to update gnulib in sage.



---

archive/issue_comments_481093.json:
```json
{
    "body": "Replying to [comment:231 dimpase]:\n> it's hard to test, as one needs to uninstall gettext, something that might be hard on some OSs, or create an artificial isolated environment/VM.\n\n\nNo, we already test it automatically on GH Actions in all `-minimal` builds.",
    "created_at": "2022-08-05T21:52:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481093",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:231 dimpase]:
> it's hard to test, as one needs to uninstall gettext, something that might be hard on some OSs, or create an artificial isolated environment/VM.


No, we already test it automatically on GH Actions in all `-minimal` builds.



---

archive/issue_comments_481094.json:
```json
{
    "body": "Replying to [comment:233 mkoeppe]:\n> Replying to [comment:231 dimpase]:\n> > it's hard to test, as one needs to uninstall gettext, something that might be hard on some OSs, or create an artificial isolated environment/VM.\n\n> \n> No, we already test it automatically on GH Actions in all `-minimal` builds.\n\n\nyes, this is an artificial isolated environment, and a very fragile one (-minimal builds time out often). We don't have easy means to \ndo this locally.",
    "created_at": "2022-08-05T22:08:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481094",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:233 mkoeppe]:
> Replying to [comment:231 dimpase]:
> > it's hard to test, as one needs to uninstall gettext, something that might be hard on some OSs, or create an artificial isolated environment/VM.

> 
> No, we already test it automatically on GH Actions in all `-minimal` builds.


yes, this is an artificial isolated environment, and a very fragile one (-minimal builds time out often). We don't have easy means to 
do this locally.



---

archive/issue_comments_481095.json:
```json
{
    "body": "This can be run locally, and I know that you know this. It's `tox -e docker-ubuntu-jammy-minimal -- config.status` or `tox -e local-homebrew-macos-minimal -- config.status`.",
    "created_at": "2022-08-05T22:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481095",
    "user": "https://github.com/mkoeppe"
}
```

This can be run locally, and I know that you know this. It's `tox -e docker-ubuntu-jammy-minimal -- config.status` or `tox -e local-homebrew-macos-minimal -- config.status`.



---

archive/issue_comments_481096.json:
```json
{
    "body": "Replying to [comment:231 dimpase]:\n> My proposal is essentially to add a semi-standard package to Sage (and use it in bootstrap). We have many rarely updated packages, and many packages with tarballs of size tens of Mb (matplotlib, Pillow, SciPy, GAP, giac, etc).\n\n\nThat's not a very useful comparison. Our SciPy SPKG builds a 20 MB wheel from a 38 MB source tarball.\n\n```\n$ ls -l upstream/scipy-1.8.1.tar.gz\n-rw-r--r--  1 mkoeppe  staff  38196215 May 20 09:47 upstream/scipy-1.8.1.tar.gz\n$ ls -l venv/var/lib/sage/wheels/SciPy-1.8.1-cp310-cp310-macosx_12_0_x86_64.whl\n-rw-r--r--  1 mkoeppe  staff  20700328 Aug  3 00:44 venv/var/lib/sage/wheels/SciPy-1.8.1-cp310-cp310-macosx_12_0_x86_64.whl\n```",
    "created_at": "2022-08-05T22:30:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481096",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:231 dimpase]:
> My proposal is essentially to add a semi-standard package to Sage (and use it in bootstrap). We have many rarely updated packages, and many packages with tarballs of size tens of Mb (matplotlib, Pillow, SciPy, GAP, giac, etc).


That's not a very useful comparison. Our SciPy SPKG builds a 20 MB wheel from a 38 MB source tarball.

```
$ ls -l upstream/scipy-1.8.1.tar.gz
-rw-r--r--  1 mkoeppe  staff  38196215 May 20 09:47 upstream/scipy-1.8.1.tar.gz
$ ls -l venv/var/lib/sage/wheels/SciPy-1.8.1-cp310-cp310-macosx_12_0_x86_64.whl
-rw-r--r--  1 mkoeppe  staff  20700328 Aug  3 00:44 venv/var/lib/sage/wheels/SciPy-1.8.1-cp310-cp310-macosx_12_0_x86_64.whl
```



---

archive/issue_comments_481097.json:
```json
{
    "body": "I've added \"Updates are expected to be necessary only very rarely.\" to the ticket description. At least this does not seem to be disputed.",
    "created_at": "2022-08-05T22:46:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481097",
    "user": "https://github.com/mkoeppe"
}
```

I've added "Updates are expected to be necessary only very rarely." to the ticket description. At least this does not seem to be disputed.



---

archive/issue_comments_481098.json:
```json
{
    "body": "Replying to [comment:232 klee]:\n> If Matthias' approach is adopted after voting, [dimpase's] script could be used as an automatic way to update gnulib in sage.\n\n\nIndeed, as an `spkg-src` script of sorts.",
    "created_at": "2022-08-05T23:16:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481098",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:232 klee]:
> If Matthias' approach is adopted after voting, [dimpase's] script could be used as an automatic way to update gnulib in sage.


Indeed, as an `spkg-src` script of sorts.



---

archive/issue_comments_481099.json:
```json
{
    "body": "Replying to [comment:234 dimpase]:\n> > No, we already test it automatically on GH Actions in all `-minimal` builds.\n\n> \n> yes, this is an artificial isolated environment, and a very fragile one (-minimal builds time out often). We don't have easy means to \n> do this locally.\n\n\nThose who are interested in helping improve our testing infrastructure may want to take a look at #34228, #33062, #31505, #34270, #34255, which are waiting for review.",
    "created_at": "2022-08-05T23:24:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481099",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:234 dimpase]:
> > No, we already test it automatically on GH Actions in all `-minimal` builds.

> 
> yes, this is an artificial isolated environment, and a very fragile one (-minimal builds time out often). We don't have easy means to 
> do this locally.


Those who are interested in helping improve our testing infrastructure may want to take a look at #34228, #33062, #31505, #34270, #34255, which are waiting for review.



---

archive/issue_comments_481100.json:
```json
{
    "body": "Replying to [comment:235 mkoeppe]:\n> This can be run locally, and I know that you know this. It's `tox -e docker-ubuntu-jammy-minimal -- config.status` or `tox -e local-homebrew-macos-minimal -- config.status`.\n\n\n\nI don't have Docker at work - our sysadmins don't allow it.",
    "created_at": "2022-08-06T08:10:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481100",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:235 mkoeppe]:
> This can be run locally, and I know that you know this. It's `tox -e docker-ubuntu-jammy-minimal -- config.status` or `tox -e local-homebrew-macos-minimal -- config.status`.



I don't have Docker at work - our sysadmins don't allow it.



---

archive/issue_comments_481101.json:
```json
{
    "body": "Replying to [comment:236 mkoeppe]:\n> Replying to [comment:231 dimpase]:\n> > My proposal is essentially to add a semi-standard package to Sage (and use it in bootstrap). We have many rarely updated packages, and many packages with tarballs of size tens of Mb (matplotlib, Pillow, SciPy, GAP, giac, etc).\n\n> \n> That's not a very useful comparison. Our SciPy SPKG builds a 20 MB wheel from a 38 MB source tarball.\n\n\nOK, compare with GAP - almost 0.5G tarball, basic install is is few Mb",
    "created_at": "2022-08-06T08:16:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481101",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:236 mkoeppe]:
> Replying to [comment:231 dimpase]:
> > My proposal is essentially to add a semi-standard package to Sage (and use it in bootstrap). We have many rarely updated packages, and many packages with tarballs of size tens of Mb (matplotlib, Pillow, SciPy, GAP, giac, etc).

> 
> That's not a very useful comparison. Our SciPy SPKG builds a 20 MB wheel from a 38 MB source tarball.


OK, compare with GAP - almost 0.5G tarball, basic install is is few Mb



---

archive/issue_comments_481102.json:
```json
{
    "body": "Replying to [comment:173 dimpase]:\n> Replying to [comment:170 dimpase]:\n> > I can add removal of upstream/gnulib to bootstrap-clean target\n\n> this is actually not a good idea, as it will force git clone on every run on bootstrap.\n> \n> On the other hand, `maintainer-clean` target removes `upstream/` all together.\n\n\nBy the way, in your branch, `make bootstrap-clean` would need to remove the files that `gnulib-tool import` adds.",
    "created_at": "2022-08-06T13:37:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481102",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:173 dimpase]:
> Replying to [comment:170 dimpase]:
> > I can add removal of upstream/gnulib to bootstrap-clean target

> this is actually not a good idea, as it will force git clone on every run on bootstrap.
> 
> On the other hand, `maintainer-clean` target removes `upstream/` all together.


By the way, in your branch, `make bootstrap-clean` would need to remove the files that `gnulib-tool import` adds.



---

archive/issue_comments_481103.json:
```json
{
    "body": "Replying to [comment:241 dimpase]:\n> OK, compare with GAP - almost 0.5G tarball, basic install is is few Mb\n\n{{{\n$ du -sh local/share/gap\ndu: local/share/gap: No such file or directory\n$ make gap\n[...]\n$ du -sh local/share/gap\n720M\tlocal/share/gap\n}}}",
    "created_at": "2022-08-06T13:50:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481103",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:241 dimpase]:
> OK, compare with GAP - almost 0.5G tarball, basic install is is few Mb

{{{
$ du -sh local/share/gap
du: local/share/gap: No such file or directory
$ make gap
[...]
$ du -sh local/share/gap
720M	local/share/gap
}}}



---

archive/issue_comments_481104.json:
```json
{
    "body": "Replying to [comment:219 klee]:\n> In Dima's branch: the sentence below seems broken. Omit `and`?\n> \n> ```bash\n> echo >&2 \"gnulib-tool needs to be installed and in your PATH. We install a copy in upstream/ \"\n> ```\n\n\nI read the sentence wrong. But still this part \"`and in your PATH`\" seems to cause a confusion on the user(developer) if she is not expected to use the `gnulib-tool` directly.",
    "created_at": "2022-08-06T14:48:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481104",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:219 klee]:
> In Dima's branch: the sentence below seems broken. Omit `and`?
> 
> ```bash
> echo >&2 "gnulib-tool needs to be installed and in your PATH. We install a copy in upstream/ "
> ```


I read the sentence wrong. But still this part "`and in your PATH`" seems to cause a confusion on the user(developer) if she is not expected to use the `gnulib-tool` directly.



---

archive/issue_comments_481105.json:
```json
{
    "body": "Developing a comment of mine before, I suggest another candidate for the voting,\n\nhybrid: mkoeppe's and dimpase's branches may be combined. Dima's script is modified to a tool for updating the gnulib files, and kept in, perhaps,  `build/pkgs/gnulib/spkg-src`\n\nMatthias seems to have agreed to this (comment:238). If Dima agrees too, then we don't need to go for the voting.\n\nI am aware that Dima' main concern is to merge external source files into our source tree, but there already exists `m4/` directory filed with such files.\n\nI leave it to Fran\u00e7ois to decide whether to take the hybrid candidate or not for the voting. I do not insist.",
    "created_at": "2022-08-07T01:56:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481105",
    "user": "https://github.com/kwankyu"
}
```

Developing a comment of mine before, I suggest another candidate for the voting,

hybrid: mkoeppe's and dimpase's branches may be combined. Dima's script is modified to a tool for updating the gnulib files, and kept in, perhaps,  `build/pkgs/gnulib/spkg-src`

Matthias seems to have agreed to this (comment:238). If Dima agrees too, then we don't need to go for the voting.

I am aware that Dima' main concern is to merge external source files into our source tree, but there already exists `m4/` directory filed with such files.

I leave it to Franois to decide whether to take the hybrid candidate or not for the voting. I do not insist.



---

archive/issue_comments_481106.json:
```json
{
    "body": "If an hybrid both side could live with exists then I do not think we need a vote. The vote would only be to decide between two things that are incompatible.",
    "created_at": "2022-08-07T02:00:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481106",
    "user": "https://github.com/kiwifb"
}
```

If an hybrid both side could live with exists then I do not think we need a vote. The vote would only be to decide between two things that are incompatible.



---

archive/issue_comments_481107.json:
```json
{
    "body": "yet another option is to require external gnulib.\n\nI don't recall how easy is to check the version by calling gnulib-tool (afk now).\n\nAssuming the version rarely changes, why not?",
    "created_at": "2022-08-07T13:18:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481107",
    "user": "https://github.com/dimpase"
}
```

yet another option is to require external gnulib.

I don't recall how easy is to check the version by calling gnulib-tool (afk now).

Assuming the version rarely changes, why not?



---

archive/issue_comments_481108.json:
```json
{
    "body": "Replying to [comment:248 dimpase]:\n> yet another option is to require external gnulib.\n\n\nIn the nomenclature of comment:130, that's Dima 3 as a standalone. We have discussed it at length already.",
    "created_at": "2022-08-09T19:10:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481108",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:248 dimpase]:
> yet another option is to require external gnulib.


In the nomenclature of comment:130, that's Dima 3 as a standalone. We have discussed it at length already.



---

archive/issue_comments_481109.json:
```json
{
    "body": "Replying to [comment:247 fbissey]:\n> If an hybrid both side could live with exists then I do not think we need a vote. The vote would only be to decide between two things that are incompatible.\n\n\nIt sounds like it's time for a vote",
    "created_at": "2022-08-12T22:20:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481109",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:247 fbissey]:
> If an hybrid both side could live with exists then I do not think we need a vote. The vote would only be to decide between two things that are incompatible.


It sounds like it's time for a vote



---

archive/issue_comments_481110.json:
```json
{
    "body": "I'm without a fast internet and mostly in vacation mode in the coming week.",
    "created_at": "2022-08-14T20:24:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481110",
    "user": "https://github.com/dimpase"
}
```

I'm without a fast internet and mostly in vacation mode in the coming week.



---

archive/issue_comments_481111.json:
```json
{
    "body": "Replying to [comment:251 dimpase]:\n> I'm without a fast internet\n\n\nSorry, hard to resist: This means you can't test your branch, right?",
    "created_at": "2022-08-14T20:44:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481111",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:251 dimpase]:
> I'm without a fast internet


Sorry, hard to resist: This means you can't test your branch, right?



---

archive/issue_comments_481112.json:
```json
{
    "body": "surely, installing Sage using a mobile phone connection is a multilevel challenge...",
    "created_at": "2022-08-14T20:57:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481112",
    "user": "https://github.com/dimpase"
}
```

surely, installing Sage using a mobile phone connection is a multilevel challenge...



---

archive/issue_comments_481113.json:
```json
{
    "body": "Replying to [comment:246 klee]:\n> Developing a comment of mine before, I suggest another candidate for the voting,\n> \n> hybrid: mkoeppe's and dimpase's branches may be combined. Dima's script is modified to a tool for updating the gnulib files, and kept in, perhaps,  `build/pkgs/gnulib/spkg-src`\n> \n> Matthias seems to have agreed to this (comment:238). If Dima agrees too, then we don't need to go for the voting.\n\n\nI've prepared the hybrid version as outlined above.\n\n---\nNew commits:",
    "created_at": "2022-08-22T21:47:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481113",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:246 klee]:
> Developing a comment of mine before, I suggest another candidate for the voting,
> 
> hybrid: mkoeppe's and dimpase's branches may be combined. Dima's script is modified to a tool for updating the gnulib files, and kept in, perhaps,  `build/pkgs/gnulib/spkg-src`
> 
> Matthias seems to have agreed to this (comment:238). If Dima agrees too, then we don't need to go for the voting.


I've prepared the hybrid version as outlined above.

---
New commits:



---

archive/issue_comments_481114.json:
```json
{
    "body": "Replying to [comment:159 fbissey]:\n\n> You have been at it for at least 3 weeks. I don't see a breakthrough without a third party being involved. I think a vote is the most equitable thing to do. I am giving you 24 hours from this post to reach an agreement. After that I throw the whole thing on sage-devel for a vote.\n\n\nPlease Fran\u00e7ois, could you put up the vote?",
    "created_at": "2022-08-23T00:05:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481114",
    "user": "https://github.com/GMS103"
}
```

Replying to [comment:159 fbissey]:

> You have been at it for at least 3 weeks. I don't see a breakthrough without a third party being involved. I think a vote is the most equitable thing to do. I am giving you 24 hours from this post to reach an agreement. After that I throw the whole thing on sage-devel for a vote.


Please Franois, could you put up the vote?



---

archive/issue_comments_481115.json:
```json
{
    "body": "I think people have been waiting for Dima to react to this:\n\nReplying to [comment:246 klee]:\n> Matthias seems to have agreed to this (comment:238). If Dima agrees too, then we don't need to go for the voting.",
    "created_at": "2022-08-23T00:10:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481115",
    "user": "https://github.com/mkoeppe"
}
```

I think people have been waiting for Dima to react to this:

Replying to [comment:246 klee]:
> Matthias seems to have agreed to this (comment:238). If Dima agrees too, then we don't need to go for the voting.



---

archive/issue_comments_481116.json:
```json
{
    "body": "I have been quite busy since it is not a holidays period in the southern hemisphere. There is the point Matthias just made and my current lack of motivation because of stuff happening all over the place right now (I mean locally not globally, although that's also demoralizing).",
    "created_at": "2022-08-23T01:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481116",
    "user": "https://github.com/kiwifb"
}
```

I have been quite busy since it is not a holidays period in the southern hemisphere. There is the point Matthias just made and my current lack of motivation because of stuff happening all over the place right now (I mean locally not globally, although that's also demoralizing).



---

archive/issue_comments_481117.json:
```json
{
    "body": "Replying to [comment:260 fbissey]:\n> I have been quite busy since it is not a holidays period in the southern hemisphere. There is the point Matthias just made and my current lack of motivation ...\n\n\nI am giving you 24 hours from this post to put up the vote. After that, I will take the role and put up the vote.\n\nDima seems to just want the voting.",
    "created_at": "2022-08-23T07:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481117",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:260 fbissey]:
> I have been quite busy since it is not a holidays period in the southern hemisphere. There is the point Matthias just made and my current lack of motivation ...


I am giving you 24 hours from this post to put up the vote. After that, I will take the role and put up the vote.

Dima seems to just want the voting.



---

archive/issue_comments_481118.json:
```json
{
    "body": "Replying to [comment:261 klee]:\n> Replying to [comment:260 fbissey]:\n> > I have been quite busy since it is not a holidays period in the southern hemisphere. There is the point Matthias just made and my current lack of motivation ...\n\n> \n> I am giving you 24 hours from this post to put up the vote. After that, I will take the role and put up the vote.\n> \n> Dima seems to just want the voting.\n> \n\n\nThen don't wait :) I am quite happy for you to take the role of convenor. I just fixed my daughter bed frame and I had enough for the day.",
    "created_at": "2022-08-23T08:18:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481118",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:261 klee]:
> Replying to [comment:260 fbissey]:
> > I have been quite busy since it is not a holidays period in the southern hemisphere. There is the point Matthias just made and my current lack of motivation ...

> 
> I am giving you 24 hours from this post to put up the vote. After that, I will take the role and put up the vote.
> 
> Dima seems to just want the voting.
> 


Then don't wait :) I am quite happy for you to take the role of convenor. I just fixed my daughter bed frame and I had enough for the day.



---

archive/issue_comments_481119.json:
```json
{
    "body": "the current branch still puts over 100K of gnulib's code into Sage git tree.\nAnd this is the main point I don't approve of.",
    "created_at": "2022-08-23T09:20:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481119",
    "user": "https://github.com/dimpase"
}
```

the current branch still puts over 100K of gnulib's code into Sage git tree.
And this is the main point I don't approve of.



---

archive/issue_comments_481120.json:
```json
{
    "body": "Replying to [comment:262 fbissey]:\n> Then don't wait :) I am quite happy for you to take the role of convener. \n\n\nI need that time for me :) to prepare myself for the thing that people would vote about. You are still the better person for this job.",
    "created_at": "2022-08-23T10:48:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481120",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:262 fbissey]:
> Then don't wait :) I am quite happy for you to take the role of convener. 


I need that time for me :) to prepare myself for the thing that people would vote about. You are still the better person for this job.



---

archive/issue_comments_481121.json:
```json
{
    "body": "The branches linked in `hybrid` and `mkoeppe` are the same.",
    "created_at": "2022-08-23T13:02:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481121",
    "user": "https://github.com/kwankyu"
}
```

The branches linked in `hybrid` and `mkoeppe` are the same.



---

archive/issue_comments_481122.json:
```json
{
    "body": "Sorry, I've fixed the link in the description now",
    "created_at": "2022-08-23T13:18:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481122",
    "user": "https://github.com/mkoeppe"
}
```

Sorry, I've fixed the link in the description now



---

archive/issue_comments_481123.json:
```json
{
    "body": "OK, so if I understand the problem correctly:\n- we need 5 files in \"m4\" from \"gnulib\":\n\n``` \nm4/host-cpu-c-abi.m4\t\nm4/iconv.m4\nm4/lib-ld.m4\nm4/lib-link.m4\nm4/lib-prefix.m4\n```\n- the only officially supported way to get these is by a git pull\n- there are objections to having git as a prereq for bootstrapping a sagemath build\n\nThe \"hybrid\" solution:\n- checks the relevant files into the sagemath repo\n- includes a tool to pull from git and update those checked-in files\n\nThat means the \"hybrid\" solution is very robust once the files are successfully checked in: no dependency on anything outside of sagemath!\n\nUgly bit: we now have files in the sagemath repo that should definitely not be edited! There's another process to update them. It seems to me the ideal solution would be if there is a tarball somewhere that we CAN use to get those files from. We could do that, right? we could host a tiny repo inside sagemath that manages the tool to make the tarball by pulling from the gnulib repo and then host that tarball in our \"mirror\" infrastructure. Would the \"spkg\" download-and-resolve infrastructure already be available pre-bootstrap? or is in reasonable to special-case the download?\n\nIt looks to me like the pain of maintaining a tarball that can be referenced should be weighed against the impurity of having files under our git control that don't really belong there. But that could be processed as an improvement over \"hybrid\" which eminently looks like a maintainable solution.",
    "created_at": "2022-08-24T03:09:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481123",
    "user": "https://github.com/nbruin"
}
```

OK, so if I understand the problem correctly:
- we need 5 files in "m4" from "gnulib":

``` 
m4/host-cpu-c-abi.m4	
m4/iconv.m4
m4/lib-ld.m4
m4/lib-link.m4
m4/lib-prefix.m4
```
- the only officially supported way to get these is by a git pull
- there are objections to having git as a prereq for bootstrapping a sagemath build

The "hybrid" solution:
- checks the relevant files into the sagemath repo
- includes a tool to pull from git and update those checked-in files

That means the "hybrid" solution is very robust once the files are successfully checked in: no dependency on anything outside of sagemath!

Ugly bit: we now have files in the sagemath repo that should definitely not be edited! There's another process to update them. It seems to me the ideal solution would be if there is a tarball somewhere that we CAN use to get those files from. We could do that, right? we could host a tiny repo inside sagemath that manages the tool to make the tarball by pulling from the gnulib repo and then host that tarball in our "mirror" infrastructure. Would the "spkg" download-and-resolve infrastructure already be available pre-bootstrap? or is in reasonable to special-case the download?

It looks to me like the pain of maintaining a tarball that can be referenced should be weighed against the impurity of having files under our git control that don't really belong there. But that could be processed as an improvement over "hybrid" which eminently looks like a maintainable solution.



---

archive/issue_comments_481124.json:
```json
{
    "body": "Replying to [comment:269 nbruin]:\n> OK, so if I understand the problem correctly:\n> - we need 5 files in \"m4\" from \"gnulib\":\n> \n> ``` \n> m4/host-cpu-c-abi.m4\t\n> m4/iconv.m4\n> m4/lib-ld.m4\n> m4/lib-link.m4\n> m4/lib-prefix.m4\n> ```\n> - the only officially supported way to get these is by a git pull\n> - there are objections to having git as a prereq for bootstrapping a sagemath build\n\n\n(... and triggering an 80MB pull to get 100kB of files...)\n\n> The \"hybrid\" solution:\n> - checks the relevant files into the sagemath repo\n> - includes a tool to pull from git and update those checked-in files\n> \n> That means the \"hybrid\" solution is very robust once the files are successfully checked in: no dependency on anything outside of sagemath!\n\n\nThat's right.\n\n> Ugly bit: we now have files in the sagemath repo that should definitely not be edited! \n\n\nYes. It shares this property with other files in our `m4/` directory, from autoconf-archive - see discussion in comment:103 and following. It's just a \"fact of life\" - bootstrapping has to start somewhere.",
    "created_at": "2022-08-24T03:49:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481124",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:269 nbruin]:
> OK, so if I understand the problem correctly:
> - we need 5 files in "m4" from "gnulib":
> 
> ``` 
> m4/host-cpu-c-abi.m4	
> m4/iconv.m4
> m4/lib-ld.m4
> m4/lib-link.m4
> m4/lib-prefix.m4
> ```
> - the only officially supported way to get these is by a git pull
> - there are objections to having git as a prereq for bootstrapping a sagemath build


(... and triggering an 80MB pull to get 100kB of files...)

> The "hybrid" solution:
> - checks the relevant files into the sagemath repo
> - includes a tool to pull from git and update those checked-in files
> 
> That means the "hybrid" solution is very robust once the files are successfully checked in: no dependency on anything outside of sagemath!


That's right.

> Ugly bit: we now have files in the sagemath repo that should definitely not be edited! 


Yes. It shares this property with other files in our `m4/` directory, from autoconf-archive - see discussion in comment:103 and following. It's just a "fact of life" - bootstrapping has to start somewhere.



---

archive/issue_comments_481125.json:
```json
{
    "body": "Since Nils proposed to create a tarball for `gnulib` and host it somewhere, as an alternative to using git to\nclone `gnulib`, I've done it here:\nhttps://github.com/dimpase/gnulib/releases/tag/1.1beta\n\nAs you see, an `xz -9`-comperessed tarball is under 4.5Mb, instead of 80Mb via `git clone` - note that git normally uses compression (zlib) on the fly, meaning that in fact the amount of data transferred by `git clone` is perhaps only 1/10th of 80 Mb.\n\nThis places gnulib tarball size among rather average Sage spkgs.",
    "created_at": "2022-08-24T08:50:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481125",
    "user": "https://github.com/dimpase"
}
```

Since Nils proposed to create a tarball for `gnulib` and host it somewhere, as an alternative to using git to
clone `gnulib`, I've done it here:
https://github.com/dimpase/gnulib/releases/tag/1.1beta

As you see, an `xz -9`-comperessed tarball is under 4.5Mb, instead of 80Mb via `git clone` - note that git normally uses compression (zlib) on the fly, meaning that in fact the amount of data transferred by `git clone` is perhaps only 1/10th of 80 Mb.

This places gnulib tarball size among rather average Sage spkgs.



---

archive/issue_comments_481126.json:
```json
{
    "body": "According to the merged branch of #29549, we seem to only need `config/config.rpath` `m4/iconv.m4` from `gnulib`. Am i understanding correctly ?",
    "created_at": "2022-08-24T09:05:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481126",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

According to the merged branch of #29549, we seem to only need `config/config.rpath` `m4/iconv.m4` from `gnulib`. Am i understanding correctly ?



---

archive/issue_comments_481127.json:
```json
{
    "body": "Or, are `m4/host-cpu-c-abi.m4`, `m4/lib-ld.m4`, `m4/lib-link.m4` and `m4/lib-prefix.m4` required as well ?",
    "created_at": "2022-08-24T09:18:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481127",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Or, are `m4/host-cpu-c-abi.m4`, `m4/lib-ld.m4`, `m4/lib-link.m4` and `m4/lib-prefix.m4` required as well ?



---

archive/issue_comments_481128.json:
```json
{
    "body": "Replying to [comment:273 tmonteil]:\n> Or, are `m4/host-cpu-c-abi.m4`, `m4/lib-ld.m4`, `m4/lib-link.m4` and `m4/lib-prefix.m4` required as well ?\n\nyes, they are needed, too. Note that this ticket actually fixes a bug created in #29549 - the thing is that these files (perhaps, different versions) are also available as a part of gettext development on the system, so if you had the latter installed, you won't need this, more or less.\n\nAll together we need something like 112Kb from gnulib.",
    "created_at": "2022-08-24T09:25:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481128",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:273 tmonteil]:
> Or, are `m4/host-cpu-c-abi.m4`, `m4/lib-ld.m4`, `m4/lib-link.m4` and `m4/lib-prefix.m4` required as well ?

yes, they are needed, too. Note that this ticket actually fixes a bug created in #29549 - the thing is that these files (perhaps, different versions) are also available as a part of gettext development on the system, so if you had the latter installed, you won't need this, more or less.

All together we need something like 112Kb from gnulib.



---

archive/issue_comments_481129.json:
```json
{
    "body": "Replying to [comment:274 dimpase]:\n> Replying to [comment:273 tmonteil]:\n> > Or, are `m4/host-cpu-c-abi.m4`, `m4/lib-ld.m4`, `m4/lib-link.m4` and `m4/lib-prefix.m4` required as well ?\n\n> yes, they are needed, too. Note that this ticket actually fixes a big - the thing is that these files (perhaps, different versions) are also available as a part of gettext development on the system, so if you had the latter installed, you won't need this, more or less.\n> \n> All together we need something like 112Kb from gnulib.\n\n\nOK, thanks. What is wrong with shipping only those files within a `gnulib_cropped` (or `gnulib_iconv`) spkg as we do with boost or did with mathjax 2 ?",
    "created_at": "2022-08-24T09:46:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481129",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Replying to [comment:274 dimpase]:
> Replying to [comment:273 tmonteil]:
> > Or, are `m4/host-cpu-c-abi.m4`, `m4/lib-ld.m4`, `m4/lib-link.m4` and `m4/lib-prefix.m4` required as well ?

> yes, they are needed, too. Note that this ticket actually fixes a big - the thing is that these files (perhaps, different versions) are also available as a part of gettext development on the system, so if you had the latter installed, you won't need this, more or less.
> 
> All together we need something like 112Kb from gnulib.


OK, thanks. What is wrong with shipping only those files within a `gnulib_cropped` (or `gnulib_iconv`) spkg as we do with boost or did with mathjax 2 ?



---

archive/issue_comments_481130.json:
```json
{
    "body": "nothing much - except it cannot be an ordinary spkg, due to chicken vs egg issue.",
    "created_at": "2022-08-24T09:53:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481130",
    "user": "https://github.com/dimpase"
}
```

nothing much - except it cannot be an ordinary spkg, due to chicken vs egg issue.



---

archive/issue_comments_481131.json:
```json
{
    "body": "Replying to [comment:271 dimpase]:\n> Since Nils proposed to create a tarball for `gnulib` and host it somewhere, as an alternative to using git to\n> clone `gnulib`, I've done it here:\n> https://github.com/dimpase/gnulib/releases/tag/1.1beta\n> \n> As you see, an `xz -9`-compressed tarball is under 4.5Mb, instead of 80Mb via `git clone` - note that git normally uses compression (zlib) on the fly, meaning that in fact the amount of data transferred by `git clone` is perhaps only 1/10th of 80 Mb.\n> \n> This places gnulib tarball size among rather average Sage spkgs.\n\n\nSince we're doing numbers again (after comment:231, comment:236, comment:241, comment:243), let me just point out that the ratio 80 MB : 112KB after said compression changes to 4.5Mb : 22kB\n\n```\n$ tar cfz gl.tgz  config/config.rpath m4/lib-*.m4 m4/iconv.m4 m4/host-cpu-c-abi.m4\n$ ls -l gl.tgz\n-rw-r--r--  1 mkoeppe  staff  22688 Aug 24 09:21 gl.tgz\n```\n... and is thus still in the \"ludicrous\" range.",
    "created_at": "2022-08-24T16:31:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481131",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:271 dimpase]:
> Since Nils proposed to create a tarball for `gnulib` and host it somewhere, as an alternative to using git to
> clone `gnulib`, I've done it here:
> https://github.com/dimpase/gnulib/releases/tag/1.1beta
> 
> As you see, an `xz -9`-compressed tarball is under 4.5Mb, instead of 80Mb via `git clone` - note that git normally uses compression (zlib) on the fly, meaning that in fact the amount of data transferred by `git clone` is perhaps only 1/10th of 80 Mb.
> 
> This places gnulib tarball size among rather average Sage spkgs.


Since we're doing numbers again (after comment:231, comment:236, comment:241, comment:243), let me just point out that the ratio 80 MB : 112KB after said compression changes to 4.5Mb : 22kB

```
$ tar cfz gl.tgz  config/config.rpath m4/lib-*.m4 m4/iconv.m4 m4/host-cpu-c-abi.m4
$ ls -l gl.tgz
-rw-r--r--  1 mkoeppe  staff  22688 Aug 24 09:21 gl.tgz
```
... and is thus still in the "ludicrous" range.



---

archive/issue_comments_481132.json:
```json
{
    "body": "It sounds like a `gnulib_cropped` package would strike a nice balance if hosting the files under sagemath git control is too impure. But it sounds like it's a bit of a one-off (because the normal spkg tools are not available yet when it's needed) and perhaps not worth the effort for what we get from it.\n\nI'll have a go at a \"conceptual\" design, having the benefit of not having the technical knowledge to delve into details (a good design can be understood on a conceptual level, but I won't claim there exists a reasonable converse):\n\nPerhaps there are other files/artifacts that we need but don't really want to \"git\" control ourselves, and are needed before our normal spkg infrastructure (which is normally responsible for this) is available?\nI saw `autoconf-archive` mentioned before? So would this be more worthwhile if we'd have a `bootstrap-aux.spkg` that has all this crap in it?\n\nThe tools for *building* that `spkg` could just be the normal tools: in the building process, it would clone `gnulib` and extract the required files and similarly fetch `autoconf-archive` and extract (and patch?) what it needs, and then wrap that up in something that would look like a normal `spkg`.\n\nHowever, this package would normally not be *installed* through the normal means -- instead, when bootstrap needs it, it would locate an appropriate `spkg` file (or download it) and then extract what's necessary from it by virtue of it being a tarball.\n\nOr perhaps fulfilling the bootstrap-aux resources needs to happen in a pre-bootstrap step, that augments our git repo with some auxiliary external files?\n\nThis makes me think Matthias comment \"bootstrapping has to start somewhere\" might apply and make this not worthwhile, but perhaps someone else can see a way of making something like this work without too much trouble.",
    "created_at": "2022-08-24T18:40:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481132",
    "user": "https://github.com/nbruin"
}
```

It sounds like a `gnulib_cropped` package would strike a nice balance if hosting the files under sagemath git control is too impure. But it sounds like it's a bit of a one-off (because the normal spkg tools are not available yet when it's needed) and perhaps not worth the effort for what we get from it.

I'll have a go at a "conceptual" design, having the benefit of not having the technical knowledge to delve into details (a good design can be understood on a conceptual level, but I won't claim there exists a reasonable converse):

Perhaps there are other files/artifacts that we need but don't really want to "git" control ourselves, and are needed before our normal spkg infrastructure (which is normally responsible for this) is available?
I saw `autoconf-archive` mentioned before? So would this be more worthwhile if we'd have a `bootstrap-aux.spkg` that has all this crap in it?

The tools for *building* that `spkg` could just be the normal tools: in the building process, it would clone `gnulib` and extract the required files and similarly fetch `autoconf-archive` and extract (and patch?) what it needs, and then wrap that up in something that would look like a normal `spkg`.

However, this package would normally not be *installed* through the normal means -- instead, when bootstrap needs it, it would locate an appropriate `spkg` file (or download it) and then extract what's necessary from it by virtue of it being a tarball.

Or perhaps fulfilling the bootstrap-aux resources needs to happen in a pre-bootstrap step, that augments our git repo with some auxiliary external files?

This makes me think Matthias comment "bootstrapping has to start somewhere" might apply and make this not worthwhile, but perhaps someone else can see a way of making something like this work without too much trouble.



---

archive/issue_comments_481133.json:
```json
{
    "body": "I think it is useful to think about why it is that the idea of having these files in `m4` elicits such strong emotions regarding \"uncleanliness\" in some of us, that some of us want to go to extremes (such as the bizarre solution in #27823, which introduced the gettext dependency; or accepting a bloat factor of 1000, comment:278) -- just to avoid the unclean feeling.\n\nI have to admit that when I first used gnulib (in a more substantial way than here, namely to implement relocatability for LattE, around 2007) that I was also kind of offended by the idea of adding its imported files to my pristine CVS repository.\n\nSo here's some food for thought: The strong emotional response may be the result of decades of abuse that we endured by the early version control systems (RCS, CVS, SVN): If you committed something \"unclean\" to the central system, the system would come back and hurt you.\n\nThis is all outdated with git.",
    "created_at": "2022-08-24T19:08:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481133",
    "user": "https://github.com/mkoeppe"
}
```

I think it is useful to think about why it is that the idea of having these files in `m4` elicits such strong emotions regarding "uncleanliness" in some of us, that some of us want to go to extremes (such as the bizarre solution in #27823, which introduced the gettext dependency; or accepting a bloat factor of 1000, comment:278) -- just to avoid the unclean feeling.

I have to admit that when I first used gnulib (in a more substantial way than here, namely to implement relocatability for LattE, around 2007) that I was also kind of offended by the idea of adding its imported files to my pristine CVS repository.

So here's some food for thought: The strong emotional response may be the result of decades of abuse that we endured by the early version control systems (RCS, CVS, SVN): If you committed something "unclean" to the central system, the system would come back and hurt you.

This is all outdated with git.



---

archive/issue_comments_481134.json:
```json
{
    "body": "Regardless of the numbers, for me (and others perhaps), the thing is \"another dependency on external resource that needs to be fetched through internet at build time\" vs \"the resource is already in\".",
    "created_at": "2022-08-24T19:33:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481134",
    "user": "https://github.com/kwankyu"
}
```

Regardless of the numbers, for me (and others perhaps), the thing is "another dependency on external resource that needs to be fetched through internet at build time" vs "the resource is already in".



---

archive/issue_comments_481135.json:
```json
{
    "body": "Absolutely, I for sure don't want to have to do some manual workaround if I do a `git worktree create` while out in the wilderness without broadband access.",
    "created_at": "2022-08-24T19:38:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481135",
    "user": "https://github.com/mkoeppe"
}
```

Absolutely, I for sure don't want to have to do some manual workaround if I do a `git worktree create` while out in the wilderness without broadband access.



---

archive/issue_comments_481136.json:
```json
{
    "body": "solution in #27823 has advantages: 1) `gettext` is a properly versioned package, not that pile of goo called `gnulib`; 2) it does not check in anything alien into Sage git tree.",
    "created_at": "2022-08-24T19:58:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481136",
    "user": "https://github.com/dimpase"
}
```

solution in #27823 has advantages: 1) `gettext` is a properly versioned package, not that pile of goo called `gnulib`; 2) it does not check in anything alien into Sage git tree.



---

archive/issue_comments_481137.json:
```json
{
    "body": "Replying to [comment:281 klee]:\n> ... the thing is \"another dependency on external resource that needs to be fetched through internet at build time\" vs \"the resource is already in\".\n\n\nBut when I build sage from a fresh `git clone` the system already goes and measure speeds to mirrors, and (I think) fetch some spkgs. I presume the tarballs (or at least some fat versions of them) still come with those spkgs included, so that no internet connection is necessary to build those?\n\nI also recently learned that on all my previous builds, apparently `bootstrap -D` has executed, downloading a configuration from somewhere.\n\nSo it seems to me that if the bootstrap auxiliaries can be packaged in an spkg, we could provide the resources through an already-required pathway, so that shouldn't really make things more fragile.\n\nThat is provided that the `bootstrap-aux.spkg` locating/downloading can actually be done through normal means. If we have to special-case its discovery too much then *that* would probably make it more fragile and hence not worth it.\n\nI think it is important that for sagemath we do remain in a state where, after installing a well-defined set of prereqs (which should be commonly provided bits on our supported platforms) and obtaining a well-defined tarball, one should be able to build sage without internet access.\n\nI think that rule was previously already violated by `gettext-devel` being a soft prereq for which a silent workaround required internet access (in the form of `bootstrap -D`, which apparently does need internet access), so getting that solved is already progress. That can also be solved by declaring `gettext-devel` a hard prereq (provided it's a commonly provided component).",
    "created_at": "2022-08-24T20:05:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481137",
    "user": "https://github.com/nbruin"
}
```

Replying to [comment:281 klee]:
> ... the thing is "another dependency on external resource that needs to be fetched through internet at build time" vs "the resource is already in".


But when I build sage from a fresh `git clone` the system already goes and measure speeds to mirrors, and (I think) fetch some spkgs. I presume the tarballs (or at least some fat versions of them) still come with those spkgs included, so that no internet connection is necessary to build those?

I also recently learned that on all my previous builds, apparently `bootstrap -D` has executed, downloading a configuration from somewhere.

So it seems to me that if the bootstrap auxiliaries can be packaged in an spkg, we could provide the resources through an already-required pathway, so that shouldn't really make things more fragile.

That is provided that the `bootstrap-aux.spkg` locating/downloading can actually be done through normal means. If we have to special-case its discovery too much then *that* would probably make it more fragile and hence not worth it.

I think it is important that for sagemath we do remain in a state where, after installing a well-defined set of prereqs (which should be commonly provided bits on our supported platforms) and obtaining a well-defined tarball, one should be able to build sage without internet access.

I think that rule was previously already violated by `gettext-devel` being a soft prereq for which a silent workaround required internet access (in the form of `bootstrap -D`, which apparently does need internet access), so getting that solved is already progress. That can also be solved by declaring `gettext-devel` a hard prereq (provided it's a commonly provided component).



---

archive/issue_comments_481138.json:
```json
{
    "body": "Replying to [comment:284 nbruin]:\n> Replying to [comment:281 klee]:\n> > ... the thing is \"another dependency on external resource that needs to be fetched through internet at build time\" vs \"the resource is already in\".\n  \n> \n> But when I build sage from a fresh `git clone` the system already goes and measure speeds to mirrors, and (I think) fetch some spkgs.\n\n\nYes, it does after the \"configure\" phase has been completed and it starts to build packages.\n\n> I presume the tarballs [...] still come with those spkgs included, so that no internet connection is necessary to build those?\n\n\nYes, the tarballs include all standard packages and come pre-bootstrapped. No internet connection is needed.\n\n> I also recently learned that on all my previous builds, apparently `bootstrap -D` has executed, downloading a configuration from somewhere.\n\n\nYes, this happens when you switch branches that touch any of the files listed here: https://github.com/sagemath/sage/blob/develop/Makefile#L43: It knows it should re-bootstrap. When the bootstrapping prerequisites are missing, it falls back to `bootstrap -D`, which retrieves the SPKG containing the bootstrapping results as of the release that the branch is based on. This is OK if that branch made no actual changes to these files compared to that release -- but it will silently give you something that's not suitable otherwise.",
    "created_at": "2022-08-24T21:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481138",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:284 nbruin]:
> Replying to [comment:281 klee]:
> > ... the thing is "another dependency on external resource that needs to be fetched through internet at build time" vs "the resource is already in".
  
> 
> But when I build sage from a fresh `git clone` the system already goes and measure speeds to mirrors, and (I think) fetch some spkgs.


Yes, it does after the "configure" phase has been completed and it starts to build packages.

> I presume the tarballs [...] still come with those spkgs included, so that no internet connection is necessary to build those?


Yes, the tarballs include all standard packages and come pre-bootstrapped. No internet connection is needed.

> I also recently learned that on all my previous builds, apparently `bootstrap -D` has executed, downloading a configuration from somewhere.


Yes, this happens when you switch branches that touch any of the files listed here: https://github.com/sagemath/sage/blob/develop/Makefile#L43: It knows it should re-bootstrap. When the bootstrapping prerequisites are missing, it falls back to `bootstrap -D`, which retrieves the SPKG containing the bootstrapping results as of the release that the branch is based on. This is OK if that branch made no actual changes to these files compared to that release -- but it will silently give you something that's not suitable otherwise.



---

archive/issue_comments_481139.json:
```json
{
    "body": "Replying to [comment:285 mkoeppe]:\n> `bootstrap -D`, which retrieves the SPKG containing the bootstrapping results as of the release that the branch is based on.\n\n\nOK, so if `bootstrap -D` can retrieve an SPKG then it could also locate/retrieve an SPKG with m4 artifacts compiled from gnulib and autoconf-archive derived files. It would seem that this approach would lead to a scenario that is no less fragile than what we have already? Declaring this to be a \"standard\" SPKG would mean it's part of tarballs and hence that those would acquire the capability of bootstrapping without an internet connection.\n\nIt would just require that someone invests the time to build the requisite spkg.\n\nTo me that doesn't sound worse than the \"hybrid\" solution and for some it would have a conceptual advantage of not checking in other project's files.",
    "created_at": "2022-08-25T07:42:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481139",
    "user": "https://github.com/nbruin"
}
```

Replying to [comment:285 mkoeppe]:
> `bootstrap -D`, which retrieves the SPKG containing the bootstrapping results as of the release that the branch is based on.


OK, so if `bootstrap -D` can retrieve an SPKG then it could also locate/retrieve an SPKG with m4 artifacts compiled from gnulib and autoconf-archive derived files. It would seem that this approach would lead to a scenario that is no less fragile than what we have already? Declaring this to be a "standard" SPKG would mean it's part of tarballs and hence that those would acquire the capability of bootstrapping without an internet connection.

It would just require that someone invests the time to build the requisite spkg.

To me that doesn't sound worse than the "hybrid" solution and for some it would have a conceptual advantage of not checking in other project's files.



---

archive/issue_comments_481140.json:
```json
{
    "body": "Nils seems to be proposing yet another solution for the present ticket, instead of arguing merits or demerits of the candidate solutions of the ongoing vote.\n\nThe vote is to finish endless debates about solutions for this ticket. Proposing another solution at this moment, regardless of its own merits, would just disrupt the vote.\n\nBy the result of the vote, this ticket will be closed with adopting one solution from the candidates.\n\nNils may open another ticket for his idea, but that should build upon the present ticket.",
    "created_at": "2022-08-26T13:13:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481140",
    "user": "https://github.com/kwankyu"
}
```

Nils seems to be proposing yet another solution for the present ticket, instead of arguing merits or demerits of the candidate solutions of the ongoing vote.

The vote is to finish endless debates about solutions for this ticket. Proposing another solution at this moment, regardless of its own merits, would just disrupt the vote.

By the result of the vote, this ticket will be closed with adopting one solution from the candidates.

Nils may open another ticket for his idea, but that should build upon the present ticket.



---

archive/issue_comments_481141.json:
```json
{
    "body": "Replying to [comment:287 klee]:\n> Nils seems to be proposing yet another solution for the present ticket, instead of arguing merits or demerits of the candidate solutions of the ongoing vote.\n\n\nYes, indeed. I explored whether an SPKG solution could be robust and organized in such a way that the tarball isn't overly large. The answer seems to be yes: everything needed for locating spkgs is already available at bootstrap time, since this is implemented in python script in build, which run on the prerequisite python.\n\nOnce the vote has completed, we should implement whatever solution resolves this mess ASAP because the current state results in breakage of sagemath building. If after that someone has appetite for a cleaner solution, it looks like it's possible to provide one. I do not have the expertise for it, so I won't be pursuing it.",
    "created_at": "2022-08-26T16:35:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481141",
    "user": "https://github.com/nbruin"
}
```

Replying to [comment:287 klee]:
> Nils seems to be proposing yet another solution for the present ticket, instead of arguing merits or demerits of the candidate solutions of the ongoing vote.


Yes, indeed. I explored whether an SPKG solution could be robust and organized in such a way that the tarball isn't overly large. The answer seems to be yes: everything needed for locating spkgs is already available at bootstrap time, since this is implemented in python script in build, which run on the prerequisite python.

Once the vote has completed, we should implement whatever solution resolves this mess ASAP because the current state results in breakage of sagemath building. If after that someone has appetite for a cleaner solution, it looks like it's possible to provide one. I do not have the expertise for it, so I won't be pursuing it.



---

archive/issue_comments_481142.json:
```json
{
    "body": "Here what Bruno Haible (on of primary authors of gnulib/gettext) has to say about our problem:\nhttps://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00103.html\nNote that he does not suggest to check bits of gnulib in our git tree.\n(and elsewhere he says he seldom sees this done: https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00102.html)\n\n```\nDima Pasechnik wrote:\n> We are in fact having a fight now over whether to check in the\n> iconv pieces produced by gnulib-tool into the source tree, or call \n> gnulib-tool at bootstrap.\n> https://trac.sagemath.org/ticket/34152\n\nOK, now let's talk about the actual problem at hand.\n\nI won't jump into the discussion there, because\n  - it's already a very long thread,\n  - I don't know what an \"SPKG\" is,\n  - I don't know about the preferred habits in the sagemath dev community.\n\nBut there I read:\n> $ du -sh config/config.rpath m4/lib-*.m4 m4/iconv.m4 m4/host-cpu-c-abi.m4\n>  20K  config/config.rpath\n> 8.0K  m4/lib-ld.m4\n>  36K  m4/lib-link.m4\n>  12K  m4/lib-prefix.m4\n>  12K  m4/iconv.m4\n>  24K  m4/host-cpu-c-abi.m4\n\nYes, these is currently the list of files needed for AM_ICONV.\n\n> It's some kind of a weird tradition of jumping through hoops to get\n> config.rpath\n\nIf you need only a few files from Gnulib, the common approach is\nto invoke either gnulib-tool (if present, indicated through an\nenvironment variable GNULIB_SRCDIR that the user can set) or\nfetch the files from the git repository one by one.\n\nTo fetch only config.rpath:\n\nGNULIB_REPO_URL=\"https://git.savannah.gnu.org/gitweb/?p=gnulib.git;a=blob_plain;hb=HEAD;f=\";\nfor file in build-aux/config.rpath; do\n  if test -n \"$GNULIB_SRCDIR\" && test -d \"$GNULIB_SRCDIR\"; then\n    \"GNULIB_SRCDIR/gnulib-tool\" --copy-file $file $file\n  else\n    wget -q --timeout=5 -O $file.tmp \"${GNULIB_REPO_URL}$file\" \\\n      && mv $file.tmp $file\n  fi\ndone\n\nTo fetch all 6 files:\n\nGNULIB_REPO_URL=\"https://git.savannah.gnu.org/gitweb/?p=gnulib.git;a=blob_plain;hb=HEAD;f=\";\nfor file in build-aux/config.rpath m4/lib-ld.m4 m4/lib-link.m4 m4/lib-prefix.m4 \nm4/iconv.m4 m4/host-cpu-c-abi.m4; do\n  if test -n \"$GNULIB_SRCDIR\" && test -d \"$GNULIB_SRCDIR\"; then\n    \"GNULIB_SRCDIR/gnulib-tool\" --copy-file $file $file\n  else\n    wget -q --timeout=5 -O $file.tmp \"${GNULIB_REPO_URL}$file\" \\\n      && mv $file.tmp $file\n  fi\ndone\n\nThis is the quick solution, which minimizes network traffic. But it is not\nfuture-proof: At any moment, some more files may become needed, due to\nchanges in the *.m4 files. The future-proof solution is to download\nthe gnulib git repository (shallow, if you want) and run\n  $GNULIB_SRCDIR/gnulib-tool [OPTIONS] --import iconv\n\n> I don't quite understand the relationship between automake, gettext, and\n> gnutools here. Is AM_ICONV even meant to work without gnulib?\n> Or is it a libtool bug?\n\nAM_ICONV is documented in two places:\n- https://www.gnu.org/software/gettext/manual/html_node/AM_005fICONV.html\n- https://www.gnu.org/software/gnulib/MODULES.html#module=iconv\n\nThe consumption as a gnulib module is meant to be easier than through\ngettext. A lot of work has been put into gnulib to make such a consumption\neasy; gettext (autopoint) lags behind in this aspect.\n\n> https://lists.gnu.org/archive/html/bug-gettext/2011-10/msg00012.html\n\nAlready in 2011, if you need only AM_ICONV, the gnulib module 'iconv'\nwas the better choice.\n\n> config.rpath (in gnulib) appears to be an orphan.\n\nNo. It is maintained in gnulib, as you can see from the commit history.\n\n> (Does gettext misappropriate prefixes AM_ and\n> AC_ for its macros, making an impression that they are from autotools?)\n\nYes, the prefix AM_ here is a mistake. It should better be gl_. But\nchanging it now would cause more annoyance than benefit.\n```",
    "created_at": "2022-08-26T19:17:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481142",
    "user": "https://github.com/dimpase"
}
```

Here what Bruno Haible (on of primary authors of gnulib/gettext) has to say about our problem:
https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00103.html
Note that he does not suggest to check bits of gnulib in our git tree.
(and elsewhere he says he seldom sees this done: https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00102.html)

```
Dima Pasechnik wrote:
> We are in fact having a fight now over whether to check in the
> iconv pieces produced by gnulib-tool into the source tree, or call 
> gnulib-tool at bootstrap.
> https://trac.sagemath.org/ticket/34152

OK, now let's talk about the actual problem at hand.

I won't jump into the discussion there, because
  - it's already a very long thread,
  - I don't know what an "SPKG" is,
  - I don't know about the preferred habits in the sagemath dev community.

But there I read:
> $ du -sh config/config.rpath m4/lib-*.m4 m4/iconv.m4 m4/host-cpu-c-abi.m4
>  20K  config/config.rpath
> 8.0K  m4/lib-ld.m4
>  36K  m4/lib-link.m4
>  12K  m4/lib-prefix.m4
>  12K  m4/iconv.m4
>  24K  m4/host-cpu-c-abi.m4

Yes, these is currently the list of files needed for AM_ICONV.

> It's some kind of a weird tradition of jumping through hoops to get
> config.rpath

If you need only a few files from Gnulib, the common approach is
to invoke either gnulib-tool (if present, indicated through an
environment variable GNULIB_SRCDIR that the user can set) or
fetch the files from the git repository one by one.

To fetch only config.rpath:

GNULIB_REPO_URL="https://git.savannah.gnu.org/gitweb/?p=gnulib.git;a=blob_plain;hb=HEAD;f=";
for file in build-aux/config.rpath; do
  if test -n "$GNULIB_SRCDIR" && test -d "$GNULIB_SRCDIR"; then
    "GNULIB_SRCDIR/gnulib-tool" --copy-file $file $file
  else
    wget -q --timeout=5 -O $file.tmp "${GNULIB_REPO_URL}$file" \
      && mv $file.tmp $file
  fi
done

To fetch all 6 files:

GNULIB_REPO_URL="https://git.savannah.gnu.org/gitweb/?p=gnulib.git;a=blob_plain;hb=HEAD;f=";
for file in build-aux/config.rpath m4/lib-ld.m4 m4/lib-link.m4 m4/lib-prefix.m4 
m4/iconv.m4 m4/host-cpu-c-abi.m4; do
  if test -n "$GNULIB_SRCDIR" && test -d "$GNULIB_SRCDIR"; then
    "GNULIB_SRCDIR/gnulib-tool" --copy-file $file $file
  else
    wget -q --timeout=5 -O $file.tmp "${GNULIB_REPO_URL}$file" \
      && mv $file.tmp $file
  fi
done

This is the quick solution, which minimizes network traffic. But it is not
future-proof: At any moment, some more files may become needed, due to
changes in the *.m4 files. The future-proof solution is to download
the gnulib git repository (shallow, if you want) and run
  $GNULIB_SRCDIR/gnulib-tool [OPTIONS] --import iconv

> I don't quite understand the relationship between automake, gettext, and
> gnutools here. Is AM_ICONV even meant to work without gnulib?
> Or is it a libtool bug?

AM_ICONV is documented in two places:
- https://www.gnu.org/software/gettext/manual/html_node/AM_005fICONV.html
- https://www.gnu.org/software/gnulib/MODULES.html#module=iconv

The consumption as a gnulib module is meant to be easier than through
gettext. A lot of work has been put into gnulib to make such a consumption
easy; gettext (autopoint) lags behind in this aspect.

> https://lists.gnu.org/archive/html/bug-gettext/2011-10/msg00012.html

Already in 2011, if you need only AM_ICONV, the gnulib module 'iconv'
was the better choice.

> config.rpath (in gnulib) appears to be an orphan.

No. It is maintained in gnulib, as you can see from the commit history.

> (Does gettext misappropriate prefixes AM_ and
> AC_ for its macros, making an impression that they are from autotools?)

Yes, the prefix AM_ here is a mistake. It should better be gl_. But
changing it now would cause more annoyance than benefit.
```



---

archive/issue_comments_481143.json:
```json
{
    "body": "Dima, I suggested that you take your complaints about upstream gnulib to their mailing list in comment:73 and again in comment:87, 6 weeks ago, but you declined to do so in comment:88.\n\nI see that now you did, after all, yesterday or so, in https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00089.html, and you are writing:\n\n```\nIf a project does not use git's submodules, noone wants an extra\ncomplexity of submodules to be added to the build system just due to\nthe need for gnulib.\nIn some projects I am or was involved, it's basically the case that the code \ninjected by\nthe gnulib-tool got committed into the tree, and blissfully forgotten\nabout. \n```\nYes, having the gnulib-imported modules \"blissfully forgotten\" is exactly what my approach (and the hybrid approach) is achieving. You now seem to acknowledge that it's common practice, which sounds like a way to a peaceful resolution of what we discussed here in this ticket.",
    "created_at": "2022-08-26T19:42:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481143",
    "user": "https://github.com/mkoeppe"
}
```

Dima, I suggested that you take your complaints about upstream gnulib to their mailing list in comment:73 and again in comment:87, 6 weeks ago, but you declined to do so in comment:88.

I see that now you did, after all, yesterday or so, in https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00089.html, and you are writing:

```
If a project does not use git's submodules, noone wants an extra
complexity of submodules to be added to the build system just due to
the need for gnulib.
In some projects I am or was involved, it's basically the case that the code 
injected by
the gnulib-tool got committed into the tree, and blissfully forgotten
about. 
```
Yes, having the gnulib-imported modules "blissfully forgotten" is exactly what my approach (and the hybrid approach) is achieving. You now seem to acknowledge that it's common practice, which sounds like a way to a peaceful resolution of what we discussed here in this ticket.



---

archive/issue_comments_481144.json:
```json
{
    "body": "> You now seem to acknowledge that it's common practice, which sounds like a way to a peaceful resolution of what we discussed here in this ticket. \n\n\nNo, you are twisting my words, please stop. I never conducted a study of this (and I trust Bruno did, one way or another, arriving to the conclusion opposite).\n\nI also wrote there, and got a confirmation from a Gentoo developer, that \"code \ninjected by\nthe gnulib-tool got committed into the tree, and blissfully forgotten\" is a bad approach.",
    "created_at": "2022-08-26T19:55:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481144",
    "user": "https://github.com/dimpase"
}
```

> You now seem to acknowledge that it's common practice, which sounds like a way to a peaceful resolution of what we discussed here in this ticket. 


No, you are twisting my words, please stop. I never conducted a study of this (and I trust Bruno did, one way or another, arriving to the conclusion opposite).

I also wrote there, and got a confirmation from a Gentoo developer, that "code 
injected by
the gnulib-tool got committed into the tree, and blissfully forgotten" is a bad approach.



---

archive/issue_comments_481145.json:
```json
{
    "body": "Replying to [comment:289 dimpase]:\n> Here what Bruno Haible (on of primary authors of gnulib/gettext) has to say about our problem:\n> https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00103.html\n> Note that he does not suggest to check bits of gnulib in our git tree. [...]\n\n\nIn the previous message, https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00102.html, Bruno writes this:\n\n```\nIn [1] we document three approaches, dependending on the package's usual\nhandling of imported/generated files.\n\nDima Pasechnik wrote:\n> [...]\n> Why you at gnulib headquarters want large chunks of gnulib\n> scattered accross many, many thousands of downstream git trees, I don't know.\n\nThis is not what we \"want\". The documentation [1] gives three options. You\nchoose the one that fits best for your package.\n\n[1] https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html\n```\nHe is confirming what the manual is saying, disputing your comment:72",
    "created_at": "2022-08-26T19:58:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481145",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:289 dimpase]:
> Here what Bruno Haible (on of primary authors of gnulib/gettext) has to say about our problem:
> https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00103.html
> Note that he does not suggest to check bits of gnulib in our git tree. [...]


In the previous message, https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00102.html, Bruno writes this:

```
In [1] we document three approaches, dependending on the package's usual
handling of imported/generated files.

Dima Pasechnik wrote:
> [...]
> Why you at gnulib headquarters want large chunks of gnulib
> scattered accross many, many thousands of downstream git trees, I don't know.

This is not what we "want". The documentation [1] gives three options. You
choose the one that fits best for your package.

[1] https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html
```
He is confirming what the manual is saying, disputing your comment:72



---

archive/issue_comments_481146.json:
```json
{
    "body": "This is fun.\n\nI suggest that we stop the discussion and just agree to abide by the vote on sage-devel, which is still ongoing.",
    "created_at": "2022-08-26T20:05:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481146",
    "user": "https://github.com/jhpalmieri"
}
```

This is fun.

I suggest that we stop the discussion and just agree to abide by the vote on sage-devel, which is still ongoing.



---

archive/issue_comments_481147.json:
```json
{
    "body": "+1, with the recommendation for everyone interested to read the whole thread in https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00089.html",
    "created_at": "2022-08-26T20:07:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481147",
    "user": "https://github.com/mkoeppe"
}
```

+1, with the recommendation for everyone interested to read the whole thread in https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00089.html



---

archive/issue_comments_481148.json:
```json
{
    "body": "Replying to [comment:287 klee]:\n> Nils seems to be proposing yet another solution for the present ticket, instead of arguing merits or demerits of the candidate solutions of the ongoing vote.\n> \n> The vote is to finish endless debates about solutions for this ticket. Proposing another solution at this moment, regardless of its own merits, would just disrupt the vote.\n> \n> By the result of the vote, this ticket will be closed with adopting one solution from the candidates.\n> \n> Nils may open another ticket for his idea, but that should build upon the present ticket.\n\n\nThis only shows that asking people to vote on a proposal that was constructed by few other people without letting them to debate and improve the proposal first is a bad habit. We already experienced similar \"vote don't discuss\" procedure by the past, including the \"code of conduct\" episode. If a better proposal emerges, i do not see in the name of what it could not be chosen over the previous ones.",
    "created_at": "2022-08-27T23:14:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481148",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Replying to [comment:287 klee]:
> Nils seems to be proposing yet another solution for the present ticket, instead of arguing merits or demerits of the candidate solutions of the ongoing vote.
> 
> The vote is to finish endless debates about solutions for this ticket. Proposing another solution at this moment, regardless of its own merits, would just disrupt the vote.
> 
> By the result of the vote, this ticket will be closed with adopting one solution from the candidates.
> 
> Nils may open another ticket for his idea, but that should build upon the present ticket.


This only shows that asking people to vote on a proposal that was constructed by few other people without letting them to debate and improve the proposal first is a bad habit. We already experienced similar "vote don't discuss" procedure by the past, including the "code of conduct" episode. If a better proposal emerges, i do not see in the name of what it could not be chosen over the previous ones.



---

archive/issue_comments_481149.json:
```json
{
    "body": "Replying to [comment:295 tmonteil]:\n> This only shows that asking people to vote on a proposal that was constructed by few other people without letting them to debate and improve the proposal first is a bad habit. \n\n\nWe would be choked if we start a discussion on the procedure of voting that is likely to lead to a voting :) If you want the discussion anyway, please open it on sage-devel.",
    "created_at": "2022-08-28T00:24:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481149",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:295 tmonteil]:
> This only shows that asking people to vote on a proposal that was constructed by few other people without letting them to debate and improve the proposal first is a bad habit. 


We would be choked if we start a discussion on the procedure of voting that is likely to lead to a voting :) If you want the discussion anyway, please open it on sage-devel.



---

archive/issue_comments_481150.json:
```json
{
    "body": "Replying to [comment:295 tmonteil]:\n> This only shows that asking people to vote on a proposal that was constructed by few other people without letting them to debate and improve the proposal first is a bad habit. We already experienced similar \"vote don't discuss\" procedure by the past, including the \"code of conduct\" episode. If a better proposal emerges, i do not see in the name of what it could not be chosen over the previous ones.\n\n\nThis problem must urgently be resolved: presently, you can have a valid setup according to the documentation and yet be unable to build/configure the last couple of sagemath beta releases.\n\nAs far as I could see, a valid solution could have been \"gettext-devel is a prereq for sagemath\" (a really ugly one, though) but the solutions on the ticket at the moment would work too. I think the priority is to get *something* merged that resolves the acute problem.\n\nOnce we have a somewhat workable solution in place that at least allows people to build sage, we can look if the solution, like any piece of sage, can be improved. Who knows, perhaps a better solution even gets merged before a release is actually made! But we cannot really wait for that now.",
    "created_at": "2022-08-28T01:30:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481150",
    "user": "https://github.com/nbruin"
}
```

Replying to [comment:295 tmonteil]:
> This only shows that asking people to vote on a proposal that was constructed by few other people without letting them to debate and improve the proposal first is a bad habit. We already experienced similar "vote don't discuss" procedure by the past, including the "code of conduct" episode. If a better proposal emerges, i do not see in the name of what it could not be chosen over the previous ones.


This problem must urgently be resolved: presently, you can have a valid setup according to the documentation and yet be unable to build/configure the last couple of sagemath beta releases.

As far as I could see, a valid solution could have been "gettext-devel is a prereq for sagemath" (a really ugly one, though) but the solutions on the ticket at the moment would work too. I think the priority is to get *something* merged that resolves the acute problem.

Once we have a somewhat workable solution in place that at least allows people to build sage, we can look if the solution, like any piece of sage, can be improved. Who knows, perhaps a better solution even gets merged before a release is actually made! But we cannot really wait for that now.



---

archive/issue_comments_481151.json:
```json
{
    "body": "Replying to [comment:295 tmonteil]:\n> Replying to [comment:287 klee]:\n> > Nils seems to be proposing yet another solution for the present ticket, instead of arguing merits or demerits of the candidate solutions of the ongoing vote.\n> > \n> > The vote is to finish endless debates about solutions for this ticket. Proposing another solution at this moment, regardless of its own merits, would just disrupt the vote.\n> > \n> > By the result of the vote, this ticket will be closed with adopting one solution from the candidates.\n> > \n> > Nils may open another ticket for his idea, but that should build upon the present ticket.\n\n> \n> This only shows that asking people to vote on a proposal that was constructed by few other people without letting them to debate and improve the proposal first is a bad habit. We already experienced similar \"vote don't discuss\" procedure by the past, including the \"code of conduct\" episode. If a better proposal emerges, i do not see in the name of what it could not be chosen over the previous ones.\n> \n\n\nYour suggestion has some merits but there is no one size fits all for all cases. Problem: you have people arguing over two possible solution. You invite more sage developers in and now you have people arguing over 8 different solutions (Ok, I am exaggerating but I really see that kind of things as a real possibility). I'll take responsibility for calling the vote on this particular occasion. I was invited on the ticket but it became clear that I wouldn't sway one side over the other and I had nothing much more to offer to the ticket. May be calling someone else would have been better in this case.",
    "created_at": "2022-08-28T01:43:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481151",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:295 tmonteil]:
> Replying to [comment:287 klee]:
> > Nils seems to be proposing yet another solution for the present ticket, instead of arguing merits or demerits of the candidate solutions of the ongoing vote.
> > 
> > The vote is to finish endless debates about solutions for this ticket. Proposing another solution at this moment, regardless of its own merits, would just disrupt the vote.
> > 
> > By the result of the vote, this ticket will be closed with adopting one solution from the candidates.
> > 
> > Nils may open another ticket for his idea, but that should build upon the present ticket.

> 
> This only shows that asking people to vote on a proposal that was constructed by few other people without letting them to debate and improve the proposal first is a bad habit. We already experienced similar "vote don't discuss" procedure by the past, including the "code of conduct" episode. If a better proposal emerges, i do not see in the name of what it could not be chosen over the previous ones.
> 


Your suggestion has some merits but there is no one size fits all for all cases. Problem: you have people arguing over two possible solution. You invite more sage developers in and now you have people arguing over 8 different solutions (Ok, I am exaggerating but I really see that kind of things as a real possibility). I'll take responsibility for calling the vote on this particular occasion. I was invited on the ticket but it became clear that I wouldn't sway one side over the other and I had nothing much more to offer to the ticket. May be calling someone else would have been better in this case.



---

archive/issue_comments_481152.json:
```json
{
    "body": "Not a large participation but of those who voted, the hybrid approach was clearly prefered.\n\n* hybrid: 8\n* pseudo-package: 2\n* copy: 0",
    "created_at": "2022-08-29T00:08:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481152",
    "user": "https://github.com/kiwifb"
}
```

Not a large participation but of those who voted, the hybrid approach was clearly prefered.

* hybrid: 8
* pseudo-package: 2
* copy: 0



---

archive/issue_comments_481153.json:
```json
{
    "body": "I reviewed Dima's script while transforming it to the `spkg-src` script on the current branch.",
    "created_at": "2022-08-29T01:12:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481153",
    "user": "https://github.com/mkoeppe"
}
```

I reviewed Dima's script while transforming it to the `spkg-src` script on the current branch.



---

archive/issue_comments_481154.json:
```json
{
    "body": "It looks good to me, except those m4 files of external origin. But we decided to accept them.",
    "created_at": "2022-08-29T02:32:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481154",
    "user": "https://github.com/kwankyu"
}
```

It looks good to me, except those m4 files of external origin. But we decided to accept them.



---

archive/issue_comments_481155.json:
```json
{
    "body": "Replying to [comment:302 klee]:\n> It looks good to me, except those m4 files of external origin. But we decided to accept them.\n\nIf you put it like that, it's almost an argument *for* checking them in: by keeping them out of the tree, they'd be invisible for review and yet the files are used to build sagemath. When we put them into the repo at least it's clear for all to see those particular pieces of code that we depend on. We have of course plenty of dependencies that we don't put through our usual review process ...\n\nAnyway, thanks for getting the review process for this on track! I'm happy to see this problem is being resolved now. If people care enough to implement a nicer solution they can do so.",
    "created_at": "2022-08-29T03:11:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481155",
    "user": "https://github.com/nbruin"
}
```

Replying to [comment:302 klee]:
> It looks good to me, except those m4 files of external origin. But we decided to accept them.

If you put it like that, it's almost an argument *for* checking them in: by keeping them out of the tree, they'd be invisible for review and yet the files are used to build sagemath. When we put them into the repo at least it's clear for all to see those particular pieces of code that we depend on. We have of course plenty of dependencies that we don't put through our usual review process ...

Anyway, thanks for getting the review process for this on track! I'm happy to see this problem is being resolved now. If people care enough to implement a nicer solution they can do so.



---

archive/issue_comments_481156.json:
```json
{
    "body": "Replying to [comment:303 nbruin]:\n> by keeping them out of the tree, they'd be invisible for review and yet the files are used to build sagemath. When we put them into the repo at least it's clear for all to see those particular pieces of code that we depend on. We have of course plenty of dependencies that we don't put through our usual review process ...\n\n\nYes, this is an important point, and it matches an earlier discussion that we had on sage-devel regarding monorepo vs. multirepo strategies (in the context of the Sage library, not the Sage distribution): https://groups.google.com/g/sage-devel/c/AaKxoNQAWMg/m/uY1rW5n0BQAJ\n\nRelated: https://groups.google.com/g/sage-devel/c/JBFbtUNhqNU/m/KuySNvTuBAAJ",
    "created_at": "2022-08-29T03:18:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481156",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:303 nbruin]:
> by keeping them out of the tree, they'd be invisible for review and yet the files are used to build sagemath. When we put them into the repo at least it's clear for all to see those particular pieces of code that we depend on. We have of course plenty of dependencies that we don't put through our usual review process ...


Yes, this is an important point, and it matches an earlier discussion that we had on sage-devel regarding monorepo vs. multirepo strategies (in the context of the Sage library, not the Sage distribution): https://groups.google.com/g/sage-devel/c/AaKxoNQAWMg/m/uY1rW5n0BQAJ

Related: https://groups.google.com/g/sage-devel/c/JBFbtUNhqNU/m/KuySNvTuBAAJ



---

archive/issue_comments_481157.json:
```json
{
    "body": "Let's finally get this ticket in please.",
    "created_at": "2022-08-30T19:09:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481157",
    "user": "https://github.com/mkoeppe"
}
```

Let's finally get this ticket in please.



---

archive/issue_comments_481158.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-08-30T23:38:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481158",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_481159.json:
```json
{
    "body": "Thanks!",
    "created_at": "2022-08-31T01:40:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481159",
    "user": "https://github.com/mkoeppe"
}
```

Thanks!



---

archive/issue_comments_481160.json:
```json
{
    "body": "Changing priority from critical to blocker.",
    "created_at": "2022-08-31T01:50:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481160",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from critical to blocker.



---

archive/issue_comments_481161.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-09-07T23:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33915#issuecomment-481161",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_089177.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-09-07T23:10:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33915",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33915#event-89177"
}
```
