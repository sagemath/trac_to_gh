# Issue 33569: symbolic/random_tests.py test failure

archive/issues_033569.json:
```json
{
    "body": "Happened on Sage 9.6rc3 on x86_64 when doctesting with `--long --all` and 48 threads. See also #33794 for a similarly mysterious AttributeError; #33794#comment:5 hypothesized a caching bug as a possible cause.\n\n\n```\n**********************************************************************\nFile \"/nix/store/nkqf50khp5687qv1am8wp1r28z928jcq-sage-src-9.6.rc3/src/sage/symbolic/random_tests.py\", line 429, in sage.symbolic.random_tests.test_symbolic_expression_order\nFailed example:\n    test_symbolic_expression_order(10000)  # long time\nException raised:\n    Traceback (most recent call last):\n      File \"/nix/store/a9csyhp9lkqhm3in804mca3a3k2vyblh-python3-3.9.12-env/lib/python3.9/site-packages/sage/doctest/forker.py\", line 695, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/nix/store/a9csyhp9lkqhm3in804mca3a3k2vyblh-python3-3.9.12-env/lib/python3.9/site-packages/sage/doctest/forker.py\", line 1101, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.symbolic.random_tests.test_symbolic_expression_order[2]>\", line 1, in <module>\n        test_symbolic_expression_order(Integer(10000))  # long time\n      File \"/nix/store/a9csyhp9lkqhm3in804mca3a3k2vyblh-python3-3.9.12-env/lib/python3.9/site-packages/sage/symbolic/random_tests.py\", line 455, in test_symbolic_expression_order\n        assert_strict_weak_order(a, b, c, lambda x,y: x._cmp_add(y))\n      File \"/nix/store/a9csyhp9lkqhm3in804mca3a3k2vyblh-python3-3.9.12-env/lib/python3.9/site-packages/sage/symbolic/random_tests.py\", line 386, in assert_strict_weak_order\n        cmp_M[i, j] = (cmp_func(x[i], x[j]) == 1)   # or -1, doesn't matter\n      File \"/nix/store/a9csyhp9lkqhm3in804mca3a3k2vyblh-python3-3.9.12-env/lib/python3.9/site-packages/sage/symbolic/random_tests.py\", line 455, in <lambda>\n        assert_strict_weak_order(a, b, c, lambda x,y: x._cmp_add(y))\n    AttributeError: 'float' object has no attribute '_cmp_add'\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/33806\n\n",
    "created_at": "2022-05-05T12:11:10Z",
    "labels": [
        "symbolics",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "symbolic/random_tests.py test failure",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33569",
    "user": "@collares"
}
```
Happened on Sage 9.6rc3 on x86_64 when doctesting with `--long --all` and 48 threads. See also #33794 for a similarly mysterious AttributeError; #33794#comment:5 hypothesized a caching bug as a possible cause.


```
**********************************************************************
File "/nix/store/nkqf50khp5687qv1am8wp1r28z928jcq-sage-src-9.6.rc3/src/sage/symbolic/random_tests.py", line 429, in sage.symbolic.random_tests.test_symbolic_expression_order
Failed example:
    test_symbolic_expression_order(10000)  # long time
Exception raised:
    Traceback (most recent call last):
      File "/nix/store/a9csyhp9lkqhm3in804mca3a3k2vyblh-python3-3.9.12-env/lib/python3.9/site-packages/sage/doctest/forker.py", line 695, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/nix/store/a9csyhp9lkqhm3in804mca3a3k2vyblh-python3-3.9.12-env/lib/python3.9/site-packages/sage/doctest/forker.py", line 1101, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.symbolic.random_tests.test_symbolic_expression_order[2]>", line 1, in <module>
        test_symbolic_expression_order(Integer(10000))  # long time
      File "/nix/store/a9csyhp9lkqhm3in804mca3a3k2vyblh-python3-3.9.12-env/lib/python3.9/site-packages/sage/symbolic/random_tests.py", line 455, in test_symbolic_expression_order
        assert_strict_weak_order(a, b, c, lambda x,y: x._cmp_add(y))
      File "/nix/store/a9csyhp9lkqhm3in804mca3a3k2vyblh-python3-3.9.12-env/lib/python3.9/site-packages/sage/symbolic/random_tests.py", line 386, in assert_strict_weak_order
        cmp_M[i, j] = (cmp_func(x[i], x[j]) == 1)   # or -1, doesn't matter
      File "/nix/store/a9csyhp9lkqhm3in804mca3a3k2vyblh-python3-3.9.12-env/lib/python3.9/site-packages/sage/symbolic/random_tests.py", line 455, in <lambda>
        assert_strict_weak_order(a, b, c, lambda x,y: x._cmp_add(y))
    AttributeError: 'float' object has no attribute '_cmp_add'
```


Issue created by migration from https://trac.sagemath.org/ticket/33806





---

archive/issue_comments_477775.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2022-05-07T20:57:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33569#issuecomment-477775",
    "user": "@collares"
}
```

Changing priority from major to minor.



---

archive/issue_comments_477776.json:
```json
{
    "body": "Related ticket: #29961 (random symbolic expression is completely unstable)",
    "created_at": "2022-05-14T02:20:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33569#issuecomment-477776",
    "user": "@DaveWitteMorris"
}
```

Related ticket: #29961 (random symbolic expression is completely unstable)
