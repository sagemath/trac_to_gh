# Issue 29130: tox.ini: Add tests for python2

Issue created by migration from https://trac.sagemath.org/ticket/29367

Original creator: mkoeppe

Original creation time: 2020-03-19 16:05:09

CC:  jhpalmieri dimpase @mwageringel




---

Comment by mkoeppe created at 2020-03-21 22:44:54

Last 10 new commits:


---

Comment by mkoeppe created at 2020-03-21 22:44:54

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2020-03-21 22:45:10

Branch is on top of #29104.


---

Comment by mkoeppe created at 2020-03-22 03:21:57

Tests run at https://github.com/mkoeppe/sage/actions/runs/60588138


---

Comment by mkoeppe created at 2020-03-22 19:34:35

On `debian-jessie-standard-python2` (https://github.com/mkoeppe/sage/runs/525632981): 

```
  [pynac-0.7.26]   checking for a version of Python >= '2.1.0'... sys:1: RuntimeWarning: not adding directory '' to sys.path since it's not owned by a trusted user.
  [pynac-0.7.26]   Untrusted users could put files in this directory which might then be imported by your Python code. As a general precaution from similar exploits, you should not execute Python code from this directory
  [pynac-0.7.26]   yes
  [pynac-0.7.26]   checking for the distutils Python package... no
  [pynac-0.7.26]   configure: error: cannot import Python module "distutils".
```



---

Comment by mkoeppe created at 2020-03-22 19:36:11

Same on `debian-buster-standard-python2`


---

Comment by mkoeppe created at 2020-03-22 19:37:58

And on `debian-bullseye-standard-python2` both `pynac` and `pip` fail


---

Comment by mkoeppe created at 2020-03-22 20:36:35

The pynac error is caused by the warning `sys:1: RuntimeWarning: not adding directory '' to sys.path since it's not owned by a trusted user.`,
which is considered an error by pynac's `configure`.


---

Comment by mkoeppe created at 2020-03-22 20:37:10

This might be output because we run as root?


---

Comment by mkoeppe created at 2020-03-22 20:38:36

caused by `build/pkgs/python2/patches/sys_path_security-issue_16202.patch`, of course.


---

Comment by mkoeppe created at 2020-03-22 20:39:30

Not a good idea that we output that warning even in noninteractive invocations of PYTHON (`python -c`)


---

Comment by jhpalmieri created at 2020-03-22 20:48:08

Maybe it's finally time to get rid of that patch.


---

Comment by mkoeppe created at 2020-03-22 21:07:07

I agree - I have created #29394 for this.


---

Comment by dimpase created at 2020-03-24 16:54:43

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2020-03-24 16:54:43

ok


---

Comment by mkoeppe created at 2020-03-24 17:30:29

Thanks!


---

Comment by vbraun created at 2020-04-05 08:30:37

Resolution: fixed
