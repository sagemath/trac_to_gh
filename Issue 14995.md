# Issue 14995: fix _test_category for polynomial rings

Issue created by migration from Trac.

Original creator: saraedum

Original creation time: 2013-09-26 23:48:41

Polynomial rings whose elements are not extension classes currently don't pass the TestSuite:

```
sage: K.<x> = FunctionField(QQ)
sage: R.<y> = K[]
sage: TestSuite(R).run()
  Failure in _test_category:
  Traceback (most recent call last):
    File "/dev/shm/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 282, in run
      test_method(tester = tester)
    File "element.pyx", line 511, in sage.structure.element.Element._test_category (sage/structure/element.c:5084)
    File "/dev/shm/sage/local/lib/python/unittest/case.py", line 424, in assertTrue
      raise self.failureException(msg)
  AssertionError: False is not true
  ------------------------------------------------------------
  The following tests failed: _test_category
Failure in _test_elements
The following tests failed: _test_elements
```


The problem is that polynomials do not use `element_class` to construct their elements but a `_polyonmial_class` which does not use the `ElementMethods` of the category.


---

Comment by saraedum created at 2013-09-27 00:11:26

Changing status from new to needs_review.


---

Comment by roed created at 2014-01-03 09:57:27

I've rebased this against sage-6.0 + #12555.
----
Last 10 new commits:


---

Comment by git created at 2014-01-04 03:37:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-01-04 03:39:11

Branch pushed to git repo; I updated commit sha1. This was a forced push. Recent commits:


---

Comment by git created at 2014-01-08 03:37:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2014-03-07 16:14:16

There are some failing doctests, see patchbot report.


---

Comment by chapoton created at 2014-03-07 16:14:16

Changing status from needs_review to needs_work.


---

Comment by saraedum created at 2014-06-26 07:05:05

Changing status from needs_work to needs_review.


---

Comment by saraedum created at 2014-06-26 07:05:05

Changing keywords from "" to "sd59".


---

Comment by saraedum created at 2014-06-26 07:05:05

I am not sure anymore what I tried to do at this ticket. The new branch seems to fix this issue with only very few changes.
----
New commits:


---

Comment by malb created at 2014-06-28 00:25:01

Changing status from needs_review to needs_work.


---

Comment by malb created at 2014-06-28 00:25:01

Patchbot reports doctest failures.


---

Comment by git created at 2014-07-10 10:02:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2014-07-10 10:02:46

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2014-08-24 19:10:05

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2014-08-24 19:10:05

See patchbot report for doctest failures and TAB characters


---

Comment by chapoton created at 2014-11-08 20:26:11

I removed the TABs
----
New commits:


---

Comment by git created at 2015-10-04 21:53:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2015-10-04 21:53:57

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2015-10-05 01:17:25

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2015-10-05 01:17:25

Still some doctest failures.


---

Comment by saraedum created at 2015-10-05 02:03:58

Changing status from needs_work to needs_review.


---

Comment by git created at 2015-10-05 02:04:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2015-11-05 01:24:45

Changing status from needs_review to needs_work.


---

Comment by roed created at 2015-11-05 01:30:45

Looks good to me.


---

Comment by roed created at 2015-11-05 01:30:45

Changing status from needs_work to positive_review.


---

Comment by git created at 2015-11-05 01:42:32

Changing status from positive_review to needs_review.


---

Comment by git created at 2015-11-05 01:42:32

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by roed created at 2015-11-05 01:47:27

Changing status from needs_review to positive_review.


---

Comment by roed created at 2015-11-05 01:47:27

Thanks.


---

Comment by vbraun created at 2015-11-05 21:12:21

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2015-11-05 21:12:21


```
sage -t --long src/doc/ja/tutorial/tour_coercion.rst
**********************************************************************
File "src/doc/ja/tutorial/tour_coercion.rst", line 44, in doc.ja.tutorial.tour_coercion
Failed example:
    type(a); type(b); type(c)
Expected:
    <type 'sage.rings.polynomial.polynomial_integer_dense_flint.Polynomial_integer_dense_flint'>
    <class 'sage.rings.polynomial.polynomial_element_generic.Polynomial_generic_sparse'>
    <type 'sage.rings.polynomial.polynomial_integer_dense_ntl.Polynomial_integer_dense_ntl'>
Got:
    <type 'sage.rings.polynomial.polynomial_integer_dense_flint.Polynomial_integer_dense_flint'>
    <class 'sage.rings.polynomial.polynomial_element_generic.PolynomialRing_integral_domain_with_category.element_class'>
    <type 'sage.rings.polynomial.polynomial_integer_dense_ntl.Polynomial_integer_dense_ntl'>
**********************************************************************
1 item had failures:
   1 of  72 in doc.ja.tutorial.tour_coercion
    [59 tests, 1 failure, 0.34 s]
```



---

Comment by git created at 2015-11-19 19:19:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2015-11-19 19:20:07

New commits:
----
New commits:


---

Comment by saraedum created at 2015-11-19 19:20:07

Changing status from needs_work to needs_review.


---

Comment by git created at 2015-12-23 19:02:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by roed created at 2016-02-16 21:09:36

Looks good.


---

Comment by roed created at 2016-02-16 21:09:36

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-02-18 08:24:48

Resolution: fixed
