# Issue 20329: add qags option for numerical_integral

Issue created by migration from https://trac.sagemath.org/ticket/20566

Original creator: vdelecroix

Original creation time: 2016-05-06 21:24:23

Some singular integral fails with the default gsl adaptive algorithm

```
sage: F=sqrt((-x + 1.81759643554688)/((x - 1.0)*x))
sage: numerical_integral(F,1,1.81759)
(inf, nan)
```

Hopefully gsl have an adaptive method in presence of singularities

    https://www.gnu.org/software/gsl/manual/html_node/QAGS-adaptive-integration-with-singularities.html

Which just add the option to `numerical_integral`. With the branch applied

```
sage: numerical_integral(F,1,1.81759, algorithm='qags')
(1.1817104227640198, 3.516975723982796e-07)
```



---

Comment by vdelecroix created at 2016-05-06 21:33:00

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2016-05-06 21:33:00

New commits:


---

Comment by vdelecroix created at 2016-05-08 03:16:18

Changing keywords from "" to "days73".


---

Comment by chapoton created at 2016-07-13 19:34:54

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2016-07-13 19:34:54

lgtm


---

Comment by vbraun created at 2016-07-14 20:40:38

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2016-07-14 20:40:38

Fails on 32-bit with numerical noise:

```
sage -t --long src/sage/gsl/integration.pyx
**********************************************************************
File "src/sage/gsl/integration.pyx", line 206, in sage.gsl.integration.?
Failed example:
    numerical_integral(F, 1, b, algorithm='qags')
Expected:
    (1.1817104238446596, 3.387268288079781e-07)
Got:
    (1.181710423844647, 3.387267830667895e-07)
**********************************************************************
1 item had failures:
   1 of  29 in sage.gsl.integration.?
    [28 tests, 1 failure, 1.20 s]
```



---

Comment by vdelecroix created at 2016-07-22 18:39:01

rebased and doctest updated...


---

Comment by vdelecroix created at 2016-07-22 18:39:01

Changing status from needs_work to needs_review.


---

Comment by git created at 2016-07-22 18:39:45

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by chapoton created at 2016-07-26 16:48:45

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2016-07-26 16:48:45

should be enough, ok


---

Comment by vbraun created at 2016-07-27 20:24:35

Resolution: fixed
