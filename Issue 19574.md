# Issue 19574: Upgrade arb to version 2.8.0

Issue created by migration from https://trac.sagemath.org/ticket/19811

Original creator: jdemeyer

Original creation time: 2015-12-30 21:56:30

CC:  fredrik.johansson cheuberg mmezzarobba

*Tarball*: http://sage.ugent.be/www/jdemeyer/sage/arb-2.8.0.tar.bz2


---

Comment by jdemeyer created at 2015-12-30 22:01:59

New commits:


---

Comment by git created at 2016-01-13 09:34:44

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2016-01-13 11:02:43

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2016-01-13 14:37:40

Changing status from new to needs_review.


---

Comment by fredrik.johansson created at 2016-02-09 20:59:32

Changing status from needs_review to positive_review.


---

Comment by fredrik.johansson created at 2016-02-10 03:45:35

Well, there are four precision-related doctest failures when rebased on the latest develop branch.

Two tests got better.

One test - rising factorial - got slightly worse. This is expected as I changed the algorithm to use a gamma function quotient when n is large, which gives a speedup but slightly worse error bounds.

One test - a hypergeometric function - got a lot worse (all digits are lost). You need some 110 bits of precision now to get a similar result. The reason is that Arb uses some heuristics when choosing where to truncate asymptotic series, and these heuristics don't fully take the parameters into account. With large parameters (in this case a = 100) some precision is lost when z is not larger by orders of magnitude (in this case z = 1000+1000i). The old code in Arb had a bug that made it choose far too many terms in some cases, fixed in 2.8. This happened to result in a very precise answer for this test case, purely by accident. The current code in Arb is more correct, but errs on the side of stopping early, which is worse for this particular test case. I think I see a reasonable way to fix this in Arb, but that will be in the next version.


---

Comment by fredrik.johansson created at 2016-02-10 03:45:35

Changing status from positive_review to needs_work.


---

Comment by git created at 2016-02-10 12:55:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by fredrik.johansson created at 2016-02-10 12:57:51

Changing status from needs_work to needs_review.


---

Comment by fredrik.johansson created at 2016-02-10 12:57:51

Should be fixed now.

I also added a small patch for a bug in `_pow_` that I saw while fixing the doctests for that function.


---

Comment by jdemeyer created at 2016-02-15 08:40:34

I agree with the changes made by `@`fredrik.johansson


---

Comment by vbraun created at 2016-02-23 22:37:13

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-02-24 00:02:43

On OSX:

```
sage -t --long src/sage/rings/real_arb.pyx
**********************************************************************
File "src/sage/rings/real_arb.pyx", line 462, in sage.rings.real_arb.RealBallField._element_constructor_
Failed example:
    RBF(4*zeta(3))
Expected:
    [4.808227612638377 +/- 9.50e-16]
Got:
    [4.808227612638377 +/- 9.42e-16]
**********************************************************************
1 item had failures:
   1 of   7 in sage.rings.real_arb.RealBallField._element_constructor_
    [459 tests, 1 failure, 0.38 s]

sage -t --long src/sage/rings/real_mpfi.pyx
**********************************************************************
File "src/sage/rings/real_mpfi.pyx", line 5110, in sage.rings.real_mpfi.RealIntervalFieldElement.zeta
Failed example:
    zeta(RIF(3))
Expected:
    1.202056903159595?
Got:
    1.202056903159594?
**********************************************************************
1 item had failures:
   1 of   4 in sage.rings.real_mpfi.RealIntervalFieldElement.zeta
    [904 tests, 1 failure, 10.16 s]
```



---

Comment by vbraun created at 2016-02-24 00:02:43

Changing status from positive_review to needs_work.


---

Comment by git created at 2016-02-24 00:51:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by fredrik.johansson created at 2016-02-24 00:52:16

Fixed.


---

Comment by fredrik.johansson created at 2016-02-24 00:52:16

Changing status from needs_work to needs_review.


---

Comment by vbraun created at 2016-02-24 11:20:46

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-02-24 19:35:22

Resolution: fixed
