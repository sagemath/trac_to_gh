# Issue 10079: Fix documentation look in symbolic/expression.pyx

archive/issues_010079.json:
```json
{
    "body": "Assignee: mvngu\n\nCC:  mvngu jpflori\n\nIn this file, there are a lot of places where, in the html documentation, one sees `TEST` areas that aren't highlighted, methods like `simplify_log` referred to but not hyperlined via `:meth:` (in one case, somehow it is only `meth:` by mistake), and so forth.  I won't be more specific because it's throughout the file - you just have to look.  For instance, in a number of places there is something like \n\n```\nTESTS::\n     sage: asf;dlkj\n```\n\nbut since there isn't an intervening empty line this is typeset wrong.\n\nIssue created by migration from https://trac.sagemath.org/ticket/10080\n\n",
    "created_at": "2010-10-06T01:45:27Z",
    "labels": [
        "documentation",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Fix documentation look in symbolic/expression.pyx",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10079",
    "user": "kcrisman"
}
```
Assignee: mvngu

CC:  mvngu jpflori

In this file, there are a lot of places where, in the html documentation, one sees `TEST` areas that aren't highlighted, methods like `simplify_log` referred to but not hyperlined via `:meth:` (in one case, somehow it is only `meth:` by mistake), and so forth.  I won't be more specific because it's throughout the file - you just have to look.  For instance, in a number of places there is something like 

```
TESTS::
     sage: asf;dlkj
```

but since there isn't an intervening empty line this is typeset wrong.

Issue created by migration from https://trac.sagemath.org/ticket/10080





---

archive/issue_comments_101686.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-01-12T19:12:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101686",
    "user": "ksmith"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_101687.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd35.5\".",
    "created_at": "2012-01-12T19:12:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101687",
    "user": "ksmith"
}
```

Changing keywords from "" to "sd35.5".



---

archive/issue_comments_101688.json:
```json
{
    "body": "I made a patch that fixed all but two of the errors. I'm still getting:\n\ndocstring of sage.symbolic.expression:10: (ERROR/3) Unexpected indentation.\n\nand\n\ndocstring of sage.symbolic.expression:12: (WARNING/2) Block quote ends without a blank line; unexpected unindent.",
    "created_at": "2012-01-12T19:12:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101688",
    "user": "ksmith"
}
```

I made a patch that fixed all but two of the errors. I'm still getting:

docstring of sage.symbolic.expression:10: (ERROR/3) Unexpected indentation.

and

docstring of sage.symbolic.expression:12: (WARNING/2) Block quote ends without a blank line; unexpected unindent.



---

archive/issue_comments_101689.json:
```json
{
    "body": "Attachment [trac_10080_symbolic_expression.patch](tarball://root/attachments/some-uuid/ticket10080/trac_10080_symbolic_expression.patch) by ksmith created at 2012-01-12 19:14:05",
    "created_at": "2012-01-12T19:14:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101689",
    "user": "ksmith"
}
```

Attachment [trac_10080_symbolic_expression.patch](tarball://root/attachments/some-uuid/ticket10080/trac_10080_symbolic_expression.patch) by ksmith created at 2012-01-12 19:14:05



---

archive/issue_comments_101690.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-01-12T19:14:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101690",
    "user": "ksmith"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_101691.json:
```json
{
    "body": "The docstrings have been edited to confirm to our standards. (Personally, it helped me learn quite a bit about formatting the documentation and using an editor properly.)",
    "created_at": "2013-01-22T12:42:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101691",
    "user": "knsam"
}
```

The docstrings have been edited to confirm to our standards. (Personally, it helped me learn quite a bit about formatting the documentation and using an editor properly.)



---

archive/issue_comments_101692.json:
```json
{
    "body": "Attachment [trac_10080_docstrings_edit.patch](tarball://root/attachments/some-uuid/ticket10080/trac_10080_docstrings_edit.patch) by knsam created at 2013-01-22 12:43:04\n\nThe Patch!",
    "created_at": "2013-01-22T12:43:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101692",
    "user": "knsam"
}
```

Attachment [trac_10080_docstrings_edit.patch](tarball://root/attachments/some-uuid/ticket10080/trac_10080_docstrings_edit.patch) by knsam created at 2013-01-22 12:43:04

The Patch!



---

archive/issue_comments_101693.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-01-22T12:44:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101693",
    "user": "knsam"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_101694.json:
```json
{
    "body": "Hey,\n\nMany of the things that were there before were correct (see [the conventions page](http://www.sagemath.org/doc/developer/conventions.html:)). However the biggest thing to strive for (in a file) is consistency. For example, every occurrence of `True` should be typeset as ```True``` and every trac reference should be of the form `:trac:`10080``. (Of course there are some exceptions to this \"rule\", but the reasoning should be clear and self-evident.) However this does clean up a fair amount and is a good first attempt.\n\nAlso, is your patch suppose to be the only patch applied or on top of Kenneth's patch?\n\nThanks,\n\nTravis",
    "created_at": "2013-02-01T16:41:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101694",
    "user": "tscrim"
}
```

Hey,

Many of the things that were there before were correct (see [the conventions page](http://www.sagemath.org/doc/developer/conventions.html:)). However the biggest thing to strive for (in a file) is consistency. For example, every occurrence of `True` should be typeset as ```True``` and every trac reference should be of the form `:trac:`10080``. (Of course there are some exceptions to this "rule", but the reasoning should be clear and self-evident.) However this does clean up a fair amount and is a good first attempt.

Also, is your patch suppose to be the only patch applied or on top of Kenneth's patch?

Thanks,

Travis



---

archive/issue_comments_101695.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-02-01T16:41:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101695",
    "user": "tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_101696.json:
```json
{
    "body": "Replying to [comment:6 tscrim]:\nHi!\n\n> Hey,\n> \n> Many of the things that were there before were correct (see [the conventions page](http://www.sagemath.org/doc/developer/conventions.html:)). However the biggest thing to strive for (in a file) is consistency. For example, every occurrence of `True` should be typeset as ```True``` \n\nI might be mistaken, but I went through them once. I would be glad to have some pointers for a start about the old style being the right one and \"True\". \n\n>and every trac reference should be of the form `:trac:`10080``. (Of course there are some exceptions to this \"rule\", but the reasoning should be clear and self-evident.) \n\nOK Will do! \n\n>However this does clean up a fair amount and is a good first attempt.\n> \n> Also, is your patch suppose to be the only patch applied or on top of Kenneth's patch?\n> \nMine is the supposed to be the only patch you apply. \n> Thanks,\n\n> Travis",
    "created_at": "2013-02-01T16:50:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101696",
    "user": "knsam"
}
```

Replying to [comment:6 tscrim]:
Hi!

> Hey,
> 
> Many of the things that were there before were correct (see [the conventions page](http://www.sagemath.org/doc/developer/conventions.html:)). However the biggest thing to strive for (in a file) is consistency. For example, every occurrence of `True` should be typeset as ```True``` 

I might be mistaken, but I went through them once. I would be glad to have some pointers for a start about the old style being the right one and "True". 

>and every trac reference should be of the form `:trac:`10080``. (Of course there are some exceptions to this "rule", but the reasoning should be clear and self-evident.) 

OK Will do! 

>However this does clean up a fair amount and is a good first attempt.
> 
> Also, is your patch suppose to be the only patch applied or on top of Kenneth's patch?
> 
Mine is the supposed to be the only patch you apply. 
> Thanks,

> Travis



---

archive/issue_comments_101697.json:
```json
{
    "body": "Replying to [comment:8 knsam]:\n> Replying to [comment:6 tscrim]:\n> > Many of the things that were there before were correct (see [the conventions page](http://www.sagemath.org/doc/developer/conventions.html:)). However the biggest thing to strive for (in a file) is consistency. For example, every occurrence of `True` should be typeset as ```True``` \n> \n> I might be mistaken, but I went through them once. I would be glad to have some pointers for a start about the old style being the right one and \"True\". \n\nFor example, the `INPUT:` and `OUTPUT:` blocks should be:\n\n```\nINPUT:\n\n- ``arg_name`` -- Description of argument\n\n- ``second_arg`` -- Another description\n\nOUTPUT:\n\nDescribing the output\n```\n\nAlso, for multi-line doctests, it is just `...`, not `....:` (don't ask me why), I prefer `EXAMPLES:` (with the s no matter if it is 1 or many), and capitalized `.. SEEALSO::` and such blocks. A good check is to run `sage -docbuild reference html` (after rebuilding sage via `sage -b`) and look at the output in `.../sage-branch/doc/output/html/...` in your favorite web-browser (Firefox had some issues last I knew, this might have been fixed...).\n\n> Mine is the supposed to be the only patch you apply. \n\nFor patchbot:\n\nApply only: trac_10080_docstrings_edit.patch",
    "created_at": "2013-02-01T17:04:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101697",
    "user": "tscrim"
}
```

Replying to [comment:8 knsam]:
> Replying to [comment:6 tscrim]:
> > Many of the things that were there before were correct (see [the conventions page](http://www.sagemath.org/doc/developer/conventions.html:)). However the biggest thing to strive for (in a file) is consistency. For example, every occurrence of `True` should be typeset as ```True``` 
> 
> I might be mistaken, but I went through them once. I would be glad to have some pointers for a start about the old style being the right one and "True". 

For example, the `INPUT:` and `OUTPUT:` blocks should be:

```
INPUT:

- ``arg_name`` -- Description of argument

- ``second_arg`` -- Another description

OUTPUT:

Describing the output
```

Also, for multi-line doctests, it is just `...`, not `....:` (don't ask me why), I prefer `EXAMPLES:` (with the s no matter if it is 1 or many), and capitalized `.. SEEALSO::` and such blocks. A good check is to run `sage -docbuild reference html` (after rebuilding sage via `sage -b`) and look at the output in `.../sage-branch/doc/output/html/...` in your favorite web-browser (Firefox had some issues last I knew, this might have been fixed...).

> Mine is the supposed to be the only patch you apply. 

For patchbot:

Apply only: trac_10080_docstrings_edit.patch



---

archive/issue_comments_101698.json:
```json
{
    "body": "Replying to [comment:9 tscrim]:\nThank you for the specific pointers. \n\n>For example, the `INPUT:` and `OUTPUT:` blocks should be:\n> {{{\n> INPUT:\n> \n> - ``arg_name`` -- Description of argument\n> \n> - ``second_arg`` -- Another description\n> \n> OUTPUT:\n> \n> Describing the output\n> }}}\n> Also, for multi-line doctests, it is just `...`, not `....:` (don't ask me why), I prefer `EXAMPLES:` (with the s no matter if it is 1 or many), and capitalized `.. SEEALSO::` and such blocks. \n\n1. OK, I think I understand what you mean about INPUT. Irrespective of the number of inputs, you have a bulleted list. Is this what we want? (Otherwise, I am not sure what is wrong with them.)\n\n2. Secondly, on the devel mailing list, I have seen that Keshav Kini was saying that it is better to have `....:` instead of `...` (there is a also a ticket on trac: #10458). So, I am now lost. \n\n3. About, EXAMPLES, I'd go ahead and change.  Capitalisation shall also be done. \n\n>A good check is to run `sage -docbuild reference html` (after rebuilding sage via `sage -b`) and look at the output in `.../sage-branch/doc/output/html/...` in your favorite web-browser (Firefox had some issues last I knew, this might have been fixed...).\n\nSure thing. Being a newbie that I am, my eyes are not trained enough to catch oddities. ;-) \n\nThank you for all the comments. I'll submit a patch to be applied on top of this. Thank you.",
    "created_at": "2013-02-02T09:55:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101698",
    "user": "knsam"
}
```

Replying to [comment:9 tscrim]:
Thank you for the specific pointers. 

>For example, the `INPUT:` and `OUTPUT:` blocks should be:
> {{{
> INPUT:
> 
> - ``arg_name`` -- Description of argument
> 
> - ``second_arg`` -- Another description
> 
> OUTPUT:
> 
> Describing the output
> }}}
> Also, for multi-line doctests, it is just `...`, not `....:` (don't ask me why), I prefer `EXAMPLES:` (with the s no matter if it is 1 or many), and capitalized `.. SEEALSO::` and such blocks. 

1. OK, I think I understand what you mean about INPUT. Irrespective of the number of inputs, you have a bulleted list. Is this what we want? (Otherwise, I am not sure what is wrong with them.)

2. Secondly, on the devel mailing list, I have seen that Keshav Kini was saying that it is better to have `....:` instead of `...` (there is a also a ticket on trac: #10458). So, I am now lost. 

3. About, EXAMPLES, I'd go ahead and change.  Capitalisation shall also be done. 

>A good check is to run `sage -docbuild reference html` (after rebuilding sage via `sage -b`) and look at the output in `.../sage-branch/doc/output/html/...` in your favorite web-browser (Firefox had some issues last I knew, this might have been fixed...).

Sure thing. Being a newbie that I am, my eyes are not trained enough to catch oddities. ;-) 

Thank you for all the comments. I'll submit a patch to be applied on top of this. Thank you.



---

archive/issue_comments_101699.json:
```json
{
    "body": "Replying to [comment:10 knsam]:\n> 1. OK, I think I understand what you mean about INPUT. Irrespective of the number of inputs, you have a bulleted list. Is this what we want? (Otherwise, I am not sure what is wrong with them.)\n\nThat is correct.\n\n> 2. Secondly, on the devel mailing list, I have seen that Keshav Kini was saying that it is better to have `....:` instead of `...` (there is a also a ticket on trac: #10458). So, I am now lost. \n\nYou'll notice that the ticket is not yet into sage (its status would be \"closed\" if it was), so those doctests will currently fail (you can run `sage -t filename1 filename2 ...` from the terminal).\n\n> Thank you for all the comments. I'll submit a patch to be applied on top of this. Thank you. \n\nNot a problem. You can just use the same patch (just make sure to check the \"replace file if exists\" during the attachments upload).\n\nBest,\n\nTravis",
    "created_at": "2013-02-02T13:25:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101699",
    "user": "tscrim"
}
```

Replying to [comment:10 knsam]:
> 1. OK, I think I understand what you mean about INPUT. Irrespective of the number of inputs, you have a bulleted list. Is this what we want? (Otherwise, I am not sure what is wrong with them.)

That is correct.

> 2. Secondly, on the devel mailing list, I have seen that Keshav Kini was saying that it is better to have `....:` instead of `...` (there is a also a ticket on trac: #10458). So, I am now lost. 

You'll notice that the ticket is not yet into sage (its status would be "closed" if it was), so those doctests will currently fail (you can run `sage -t filename1 filename2 ...` from the terminal).

> Thank you for all the comments. I'll submit a patch to be applied on top of this. Thank you. 

Not a problem. You can just use the same patch (just make sure to check the "replace file if exists" during the attachments upload).

Best,

Travis



---

archive/issue_comments_101700.json:
```json
{
    "body": "First Part.",
    "created_at": "2013-03-23T10:40:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101700",
    "user": "knsam"
}
```

First Part.



---

archive/issue_comments_101701.json:
```json
{
    "body": "Attachment [trac_10080_docstringsfix2.patch](tarball://root/attachments/some-uuid/ticket10080/trac_10080_docstringsfix2.patch) by knsam created at 2013-03-23 10:40:59\n\nSecond and the last part",
    "created_at": "2013-03-23T10:40:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101701",
    "user": "knsam"
}
```

Attachment [trac_10080_docstringsfix2.patch](tarball://root/attachments/some-uuid/ticket10080/trac_10080_docstringsfix2.patch) by knsam created at 2013-03-23 10:40:59

Second and the last part



---

archive/issue_comments_101702.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-03-23T10:42:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101702",
    "user": "knsam"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_101703.json:
```json
{
    "body": "Not quite! Perhaps, the last!",
    "created_at": "2013-03-23T11:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101703",
    "user": "knsam"
}
```

Not quite! Perhaps, the last!



---

archive/issue_comments_101704.json:
```json
{
    "body": "Attachment [trac_10080_docstringsfix3.patch](tarball://root/attachments/some-uuid/ticket10080/trac_10080_docstringsfix3.patch) by knsam created at 2013-03-23 11:14:45\n\nHah! I have found one last glitch just now, which I do not how to fix: \n\n\n```\nx.__init__(...) initializes x; see help(type(x)) for signature\n```\n\n\nand\n\n\n```\nx.next() -> the next value, or raise StopIteration\n```\n\n\nwhich appear in the `ExpressionIterator` class, towards the end of the built html. \n\nI don't know how to fix this.",
    "created_at": "2013-03-23T11:14:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101704",
    "user": "knsam"
}
```

Attachment [trac_10080_docstringsfix3.patch](tarball://root/attachments/some-uuid/ticket10080/trac_10080_docstringsfix3.patch) by knsam created at 2013-03-23 11:14:45

Hah! I have found one last glitch just now, which I do not how to fix: 


```
x.__init__(...) initializes x; see help(type(x)) for signature
```


and


```
x.next() -> the next value, or raise StopIteration
```


which appear in the `ExpressionIterator` class, towards the end of the built html. 

I don't know how to fix this.



---

archive/issue_comments_101705.json:
```json
{
    "body": "What are you trying to fix?  By the way, the first patch is quite a bomb - I like the intent, but it could cause a lot of rebasing to be needed.  \n* Also, `:meth:bool` isn't right, because `bool` isn't a method, it's a function.\n* And in `taylor` you dedented stuff that should have remained indented; there are two notations supported, and they should be under that listing.\nThat said, these are mostly going to be useful changes!  Did you look at the built documentation to check whether they \"look right\"?  Travis has the right idea there.",
    "created_at": "2013-03-26T03:07:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101705",
    "user": "kcrisman"
}
```

What are you trying to fix?  By the way, the first patch is quite a bomb - I like the intent, but it could cause a lot of rebasing to be needed.  
* Also, `:meth:bool` isn't right, because `bool` isn't a method, it's a function.
* And in `taylor` you dedented stuff that should have remained indented; there are two notations supported, and they should be under that listing.
That said, these are mostly going to be useful changes!  Did you look at the built documentation to check whether they "look right"?  Travis has the right idea there.



---

archive/issue_comments_101706.json:
```json
{
    "body": "I believe both are coming from the fact that `ExpressionIterator` does not have any class-level docstring. Trying giving it something like\n\n```\n\"\"\"\nIterator class for expressions.\n\"\"\"\n```\n\nand see if that fixes the problems. Also once you integrate Karl-Dieter's changes, I'll give it another review (also, more of a side-note, I would prefer to have one patch since the other two patches are very small). Thanks.",
    "created_at": "2013-03-27T13:58:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101706",
    "user": "tscrim"
}
```

I believe both are coming from the fact that `ExpressionIterator` does not have any class-level docstring. Trying giving it something like

```
"""
Iterator class for expressions.
"""
```

and see if that fixes the problems. Also once you integrate Karl-Dieter's changes, I'll give it another review (also, more of a side-note, I would prefer to have one patch since the other two patches are very small). Thanks.



---

archive/issue_comments_101707.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-06-20T00:17:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10079#issuecomment-101707",
    "user": "kcrisman"
}
```

Changing status from needs_review to needs_work.
