# Issue 29896: Giac mixes variables and constants of the same name such as I, e, π

archive/issues_029896.json:
```json
{
    "body": "CC:  frederichan slelievre egourgoulhon charpent\n\nKeywords: giac\n\nThe Giac interface needs to be more careful when handling symbolic variables that are also mathematical constants:\n\n\n```\nsage: var('I')._giac_()._sage_()^2  # should be I^2\n-1\nsage: var('e')._giac_()._sage_().n()  # should not evaluate\n2.71828182845905\nsage: var('\u03c0')._giac_()._sage_().n()  # should not evaluate\n3.14159265358979\n```\n\n\n\n```\nsage: e, x = var('e,x')\nsage: integrate(e^x, x, algorithm='maxima')  # correct\ne^x/log(e)\nsage: integrate(e^x, x, algorithm='giac')  # wrong\ne^x\n```\n\n\n\n```\nsage: y = var('\u03c0')\nsage: integrate(cos(y), y, algorithm='maxima')  # correct (after ticket 30112)\nsin(\u03c0)\nsage: integrate(cos(y), y, algorithm='giac')  # wrong\n-pi\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/30133\n\n",
    "created_at": "2020-07-13T17:58:17Z",
    "labels": [
        "symbolics",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Giac mixes variables and constants of the same name such as I, e, \u03c0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29896",
    "user": "@mwageringel"
}
```
CC:  frederichan slelievre egourgoulhon charpent

Keywords: giac

The Giac interface needs to be more careful when handling symbolic variables that are also mathematical constants:


```
sage: var('I')._giac_()._sage_()^2  # should be I^2
-1
sage: var('e')._giac_()._sage_().n()  # should not evaluate
2.71828182845905
sage: var('π')._giac_()._sage_().n()  # should not evaluate
3.14159265358979
```



```
sage: e, x = var('e,x')
sage: integrate(e^x, x, algorithm='maxima')  # correct
e^x/log(e)
sage: integrate(e^x, x, algorithm='giac')  # wrong
e^x
```



```
sage: y = var('π')
sage: integrate(cos(y), y, algorithm='maxima')  # correct (after ticket 30112)
sin(π)
sage: integrate(cos(y), y, algorithm='giac')  # wrong
-pi
```


Issue created by migration from https://trac.sagemath.org/ticket/30133





---

archive/issue_comments_424676.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29896#issuecomment-424676",
    "user": "mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_424677.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-06-09T18:47:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29896#issuecomment-424677",
    "user": "@mwageringel"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_424678.json:
```json
{
    "body": "Here is a basic fix which follows the implementation of the Maxima interface by changing the names of variables in the interface.\n----\nNew commits:",
    "created_at": "2021-06-09T18:47:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29896#issuecomment-424678",
    "user": "@mwageringel"
}
```

Here is a basic fix which follows the implementation of the Maxima interface by changing the names of variables in the interface.
----
New commits:



---

archive/issue_comments_424679.json:
```json
{
    "body": "LGTM overall. One little thing is adding `# -*- coding: utf-8 -*-` to the first line of `src/sage/symbolic/integration/external.py`. A while-we-are-at-it thing that you can ignore is fixing the pyflakes warnings in `src/sage/symbolic/expression_conversions.py`. Once done, you can set a positive review on my behalf.",
    "created_at": "2021-06-11T03:43:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29896#issuecomment-424679",
    "user": "tscrim"
}
```

LGTM overall. One little thing is adding `# -*- coding: utf-8 -*-` to the first line of `src/sage/symbolic/integration/external.py`. A while-we-are-at-it thing that you can ignore is fixing the pyflakes warnings in `src/sage/symbolic/expression_conversions.py`. Once done, you can set a positive review on my behalf.



---

archive/issue_comments_424680.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-06-11T17:29:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29896#issuecomment-424680",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_424681.json:
```json
{
    "body": "Thanks for the review. \n\nReplying to [comment:6 tscrim]:\n> LGTM overall. One little thing is adding `# -*- coding: utf-8 -*-` to the first line of `src/sage/symbolic/integration/external.py`.\n\nIn Python 3, utf-8 encoding is [the default](https://stackoverflow.com/questions/14083111/should-i-use-encoding-declaration-in-python-3), so this line is not needed.\n\nI have fixed the pyflakes warning, though.",
    "created_at": "2021-06-11T17:40:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29896#issuecomment-424681",
    "user": "@mwageringel"
}
```

Thanks for the review. 

Replying to [comment:6 tscrim]:
> LGTM overall. One little thing is adding `# -*- coding: utf-8 -*-` to the first line of `src/sage/symbolic/integration/external.py`.

In Python 3, utf-8 encoding is [the default](https://stackoverflow.com/questions/14083111/should-i-use-encoding-declaration-in-python-3), so this line is not needed.

I have fixed the pyflakes warning, though.



---

archive/issue_comments_424682.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-06-12T08:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29896#issuecomment-424682",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_424683.json:
```json
{
    "body": "I am not fully convinced and would rather be safe, but it's not a hill I am willing to die on as I don't know of something that definitely breaks right now that we support.",
    "created_at": "2021-06-12T08:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29896#issuecomment-424683",
    "user": "tscrim"
}
```

I am not fully convinced and would rather be safe, but it's not a hill I am willing to die on as I don't know of something that definitely breaks right now that we support.



---

archive/issue_comments_424684.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-06-20T08:14:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29896#issuecomment-424684",
    "user": "vbraun"
}
```

Resolution: fixed
