# Issue 29896: Giac mixes variables and constants of the same name such as I, e, π

Issue created by migration from https://trac.sagemath.org/ticket/30133

Original creator: @mwageringel

Original creation time: 2020-07-13 17:58:17

CC:  frederichan slelievre egourgoulhon charpent

Keywords: giac

The Giac interface needs to be more careful when handling symbolic variables that are also mathematical constants:


```
sage: var('I')._giac_()._sage_()^2  # should be I^2
-1
sage: var('e')._giac_()._sage_().n()  # should not evaluate
2.71828182845905
sage: var('π')._giac_()._sage_().n()  # should not evaluate
3.14159265358979
```



```
sage: e, x = var('e,x')
sage: integrate(e^x, x, algorithm='maxima')  # correct
e^x/log(e)
sage: integrate(e^x, x, algorithm='giac')  # wrong
e^x
```



```
sage: y = var('π')
sage: integrate(cos(y), y, algorithm='maxima')  # correct (after ticket 30112)
sin(π)
sage: integrate(cos(y), y, algorithm='giac')  # wrong
-pi
```



---

Comment by mkoeppe created at 2021-02-13 20:51:01

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.


---

Comment by @mwageringel created at 2021-06-09 18:47:50

Changing status from new to needs_review.


---

Comment by @mwageringel created at 2021-06-09 18:47:50

Here is a basic fix which follows the implementation of the Maxima interface by changing the names of variables in the interface.
----
New commits:


---

Comment by tscrim created at 2021-06-11 03:43:57

LGTM overall. One little thing is adding `# -*- coding: utf-8 -*-` to the first line of `src/sage/symbolic/integration/external.py`. A while-we-are-at-it thing that you can ignore is fixing the pyflakes warnings in `src/sage/symbolic/expression_conversions.py`. Once done, you can set a positive review on my behalf.


---

Comment by git created at 2021-06-11 17:29:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mwageringel created at 2021-06-11 17:40:20

Thanks for the review. 

Replying to [comment:6 tscrim]:
> LGTM overall. One little thing is adding `# -*- coding: utf-8 -*-` to the first line of `src/sage/symbolic/integration/external.py`.

In Python 3, utf-8 encoding is [the default](https://stackoverflow.com/questions/14083111/should-i-use-encoding-declaration-in-python-3), so this line is not needed.

I have fixed the pyflakes warning, though.


---

Comment by tscrim created at 2021-06-12 08:45:46

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2021-06-12 08:45:46

I am not fully convinced and would rather be safe, but it's not a hill I am willing to die on as I don't know of something that definitely breaks right now that we support.


---

Comment by vbraun created at 2021-06-20 08:14:34

Resolution: fixed
