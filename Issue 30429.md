# Issue 30429: Add "sage_setup: distribution" directives to all Cython modules needing external libraries

archive/issues_030429.json:
```json
{
    "body": "CC:  @tobiasdiez @dimpase\n\nThis is preparation for Meta-ticket #29705 (Modularization) and #30371.\n\nIssue created by migration from https://trac.sagemath.org/ticket/30666\n\n",
    "created_at": "2020-09-26T14:30:43Z",
    "labels": [
        "component: refactoring"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Add \"sage_setup: distribution\" directives to all Cython modules needing external libraries",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30429",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @tobiasdiez @dimpase

This is preparation for Meta-ticket #29705 (Modularization) and #30371.

Issue created by migration from https://trac.sagemath.org/ticket/30666





---

archive/issue_comments_433600.json:
```json
{
    "body": "Good idea to separate this into a new ticket.\n\nWhile working on #30371, I noticed that most cython files using singular cannot be compiled without pynac. So maybe these should be combined.\n\nAlso, I think, there should be distributions for GAP, CCObject, linbox, ratpoints, zn_poly and mari.\n\nWhat do you think about renaming sage_setup: distribution to sage_setup: dependency? I think this better reflects the purpose. The distribution is then generated based on which dependencies are available. Another idea would be to use `distutils: libraries` which already contains some of the dependencies anyway (e.g. arb, gmp, flint).",
    "created_at": "2020-09-26T18:34:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433600",
    "user": "https://github.com/tobiasdiez"
}
```

Good idea to separate this into a new ticket.

While working on #30371, I noticed that most cython files using singular cannot be compiled without pynac. So maybe these should be combined.

Also, I think, there should be distributions for GAP, CCObject, linbox, ratpoints, zn_poly and mari.

What do you think about renaming sage_setup: distribution to sage_setup: dependency? I think this better reflects the purpose. The distribution is then generated based on which dependencies are available. Another idea would be to use `distutils: libraries` which already contains some of the dependencies anyway (e.g. arb, gmp, flint).



---

archive/issue_comments_433601.json:
```json
{
    "body": "Replying to [comment:5 gh-tobiasdiez]:\n> While working on #30371, I noticed that most cython files using singular cannot be compiled without pynac. So maybe these should be combined.\n\n\nI think they should be separate because I really want to be able to make singular optional. pynac, on the other hand, is essential for our symbolics implementation.\n\n> Also, I think, there should be distributions for GAP, CCObject, linbox, ratpoints, zn_poly and mari.\n\n\nYes, please add to the list in the ticket description with explanation (what is CCObject?)\n\n> What do you think about renaming sage_setup: distribution to sage_setup: dependency?\n\n\nNo, I wouldn't like that. As soon as you start with declaring \"dependencies\", there will be combinatorial explosion from the combinations of such dependencies. I really want a well-designed partition of the source files into (relatively few) disjoint distributions. This is crucial for the modularization -- each distribution will eventually be separately compilable and installable package on PyPI.",
    "created_at": "2020-09-26T20:04:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433601",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:5 gh-tobiasdiez]:
> While working on #30371, I noticed that most cython files using singular cannot be compiled without pynac. So maybe these should be combined.


I think they should be separate because I really want to be able to make singular optional. pynac, on the other hand, is essential for our symbolics implementation.

> Also, I think, there should be distributions for GAP, CCObject, linbox, ratpoints, zn_poly and mari.


Yes, please add to the list in the ticket description with explanation (what is CCObject?)

> What do you think about renaming sage_setup: distribution to sage_setup: dependency?


No, I wouldn't like that. As soon as you start with declaring "dependencies", there will be combinatorial explosion from the combinations of such dependencies. I really want a well-designed partition of the source files into (relatively few) disjoint distributions. This is crucial for the modularization -- each distribution will eventually be separately compilable and installable package on PyPI.



---

archive/issue_comments_433602.json:
```json
{
    "body": "Ok, makes sense.\nWhich distribution should be assigned to files that have two dependencies (e.g use pynac and singular)?\n\nMy idea was that the cython file declares which dependencies it has, and in the setup.py file you have a list of distributions and their dependencies. If all dependencies are met, that particular distribution is built. E.g. distribution \"sage-singular\" relies on \"pynac\" and \"singular\". (That's only a feeling, but it feels strange to have distributions determined by dependencies and not by a theme or subject, e.g. \"sage-singular\" vs \"sage-symbolic calculation\". But you have a better overview, so I trust you there.)\n\nI've added the above distributions to the list.\n(Forget about CCObject, it was a missing import in #30371 that confused me.)",
    "created_at": "2020-09-27T07:48:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433602",
    "user": "https://github.com/tobiasdiez"
}
```

Ok, makes sense.
Which distribution should be assigned to files that have two dependencies (e.g use pynac and singular)?

My idea was that the cython file declares which dependencies it has, and in the setup.py file you have a list of distributions and their dependencies. If all dependencies are met, that particular distribution is built. E.g. distribution "sage-singular" relies on "pynac" and "singular". (That's only a feeling, but it feels strange to have distributions determined by dependencies and not by a theme or subject, e.g. "sage-singular" vs "sage-symbolic calculation". But you have a better overview, so I trust you there.)

I've added the above distributions to the list.
(Forget about CCObject, it was a missing import in #30371 that confused me.)



---

archive/issue_comments_433603.json:
```json
{
    "body": "Replying to [comment:8 gh-tobiasdiez]:\n> Which distribution should be assigned to files that have two dependencies (e.g use pynac and singular)?\n\n\nDistributions can certainly depend on other distributions. `sage-singular` could depend on `sage-pynac`. Let's include this in the ticket description. (In the modularized build, `sage-singular`'s `setup.py` or `setup.cfg` would have `install_requires = sage-pynac`.)\n\nAlso, often it is relatively easy to remove some of these dependencies by small changes to a few source files, moving a few methods around. See for example #29911. We can take work on this in follow-up tickets.\n\n> it feels strange to have distributions determined by dependencies and not by a theme or subject, e.g. \"sage-singular\" vs \"sage-symbolic calculation\". \n\n\nPerhaps, but there is actually an important \"political\" (open source community) reason for this design too. By naming these components after major libraries that provide the features, we make these libraries and their important role for Sage more visible to end users. Attribution tends to be an important motivating factor to developers of these libraries.",
    "created_at": "2020-09-27T17:52:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433603",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:8 gh-tobiasdiez]:
> Which distribution should be assigned to files that have two dependencies (e.g use pynac and singular)?


Distributions can certainly depend on other distributions. `sage-singular` could depend on `sage-pynac`. Let's include this in the ticket description. (In the modularized build, `sage-singular`'s `setup.py` or `setup.cfg` would have `install_requires = sage-pynac`.)

Also, often it is relatively easy to remove some of these dependencies by small changes to a few source files, moving a few methods around. See for example #29911. We can take work on this in follow-up tickets.

> it feels strange to have distributions determined by dependencies and not by a theme or subject, e.g. "sage-singular" vs "sage-symbolic calculation". 


Perhaps, but there is actually an important "political" (open source community) reason for this design too. By naming these components after major libraries that provide the features, we make these libraries and their important role for Sage more visible to end users. Attribution tends to be an important motivating factor to developers of these libraries.



---

archive/issue_comments_433604.json:
```json
{
    "body": "To expand on this a little bit: I wouldn't rule out distributions named after topics. The present ticket only provides a \"skeleton\" of distributions that are (1) technically needed to take care of compile-time dependencies, (2) provides attribution. Later on (in follow-up tickets), for example, there could be a distribution `sage-feature-padics` or something like this that has `sage-ntl` as a dependency and packages `sage.rings.padics`.",
    "created_at": "2020-09-27T18:36:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433604",
    "user": "https://github.com/mkoeppe"
}
```

To expand on this a little bit: I wouldn't rule out distributions named after topics. The present ticket only provides a "skeleton" of distributions that are (1) technically needed to take care of compile-time dependencies, (2) provides attribution. Later on (in follow-up tickets), for example, there could be a distribution `sage-feature-padics` or something like this that has `sage-ntl` as a dependency and packages `sage.rings.padics`.



---

archive/issue_comments_433605.json:
```json
{
    "body": "Replying to [comment:6 mkoeppe]:\n> Replying to [comment:5 gh-tobiasdiez]:\n> > While working on #30371, I noticed that most cython files using singular cannot be compiled without pynac. So maybe these should be combined.\n\n> \n> I think they should be separate because I really want to be able to make singular optional. pynac, on the other hand, is essential for our symbolics implementation.\n\n\nWhen I wrote this, I didn't recall that singular's `libfactory` is actually a dependency of pynac. So I think you are right, it's best to have pynac and singular in one distribution (for now, at least).",
    "created_at": "2020-10-04T17:05:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433605",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:6 mkoeppe]:
> Replying to [comment:5 gh-tobiasdiez]:
> > While working on #30371, I noticed that most cython files using singular cannot be compiled without pynac. So maybe these should be combined.

> 
> I think they should be separate because I really want to be able to make singular optional. pynac, on the other hand, is essential for our symbolics implementation.


When I wrote this, I didn't recall that singular's `libfactory` is actually a dependency of pynac. So I think you are right, it's best to have pynac and singular in one distribution (for now, at least).



---

archive/issue_comments_433606.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd111\".",
    "created_at": "2020-12-06T17:43:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433606",
    "user": "https://github.com/mkoeppe"
}
```

Changing keywords from "" to "sd111".



---

archive/issue_comments_433607.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433607",
    "user": "https://github.com/mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_079776.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30429#event-79776"
}
```



---

archive/issue_events_079777.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T02:58:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30429#event-79777"
}
```



---

archive/issue_events_079778.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T02:58:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30429#event-79778"
}
```



---

archive/issue_events_079779.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30429#event-79779"
}
```



---

archive/issue_events_079780.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30429#event-79780"
}
```



---

archive/issue_events_079781.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-01T21:16:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30429#event-79781"
}
```



---

archive/issue_events_079782.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-01T21:16:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30429#event-79782"
}
```



---

archive/issue_events_079783.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30429#event-79783"
}
```



---

archive/issue_events_079784.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30429#event-79784"
}
```



---

archive/issue_comments_433608.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-11-17T06:48:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433608",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_comments_433609.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-11-17T06:58:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433609",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433610.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-11-17T08:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433610",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433611.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-11-17T08:41:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433611",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_433612.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-11-18T22:40:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433612",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433613.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-12-03T00:50:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433613",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_433614.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-03T21:14:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433614",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433615.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-03T21:27:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433615",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433616.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-03T21:29:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433616",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433617.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-04T04:40:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433617",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433618.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-04T05:50:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433618",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433619.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-04T07:03:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433619",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433620.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-04T07:05:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433620",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433621.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-04T07:27:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433621",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433622.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-12-04T07:29:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433622",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_433623.json:
```json
{
    "body": "How are all these tags like `# sage_setup: distribution = sagemath-gap` processed?",
    "created_at": "2022-12-04T17:42:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433623",
    "user": "https://github.com/dimpase"
}
```

How are all these tags like `# sage_setup: distribution = sagemath-gap` processed?



---

archive/issue_comments_433624.json:
```json
{
    "body": "They are processed by the functions in `sage_setup.find`, via `sage.misc.package_dir`.",
    "created_at": "2022-12-04T18:55:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433624",
    "user": "https://github.com/mkoeppe"
}
```

They are processed by the functions in `sage_setup.find`, via `sage.misc.package_dir`.



---

archive/issue_comments_433625.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-04T19:08:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433625",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433626.json:
```json
{
    "body": "```\nsage -t --random-seed=146157697718740975867546676674797881386 sage/groups/perm_gps/partn_ref/data_structures.pyx\n**********************************************************************\nFile \"sage/groups/perm_gps/partn_ref/data_structures.pyx\", line 1221, in sage.groups.perm_gps.partn_ref.data_structures.SC_test_list_perms\nFailed example:\n    for i in range(2,9):\n        test_Sn_on_m_points(i,i,1,0)\nExpected nothing\nGot:\n    ImportError: cannot import name n_is_prime\n    Exception ignored in: 'sage.groups.perm_gps.partn_ref.data_structures.SC_is_giant'\n    Traceback (most recent call last):\n      File \"<doctest sage.groups.perm_gps.partn_ref.data_structures.SC_test_list_perms[2]>\", line 4, in test_Sn_on_m_points\n```",
    "created_at": "2022-12-04T19:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433626",
    "user": "https://github.com/mkoeppe"
}
```

```
sage -t --random-seed=146157697718740975867546676674797881386 sage/groups/perm_gps/partn_ref/data_structures.pyx
**********************************************************************
File "sage/groups/perm_gps/partn_ref/data_structures.pyx", line 1221, in sage.groups.perm_gps.partn_ref.data_structures.SC_test_list_perms
Failed example:
    for i in range(2,9):
        test_Sn_on_m_points(i,i,1,0)
Expected nothing
Got:
    ImportError: cannot import name n_is_prime
    Exception ignored in: 'sage.groups.perm_gps.partn_ref.data_structures.SC_is_giant'
    Traceback (most recent call last):
      File "<doctest sage.groups.perm_gps.partn_ref.data_structures.SC_test_list_perms[2]>", line 4, in test_Sn_on_m_points
```



---

archive/issue_comments_433627.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-12-04T19:16:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433627",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_433628.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-04T20:33:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433628",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433629.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-04T20:39:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433629",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433630.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-04T20:42:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433630",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433631.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-06T21:27:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433631",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433632.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-12-06T21:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433632",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_433633.json:
```json
{
    "body": "there are a number of files with `m4` suffix, which does not seem to be `m4` files.\nShould they rather get `in` suffux?",
    "created_at": "2022-12-07T17:33:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433633",
    "user": "https://github.com/dimpase"
}
```

there are a number of files with `m4` suffix, which does not seem to be `m4` files.
Should they rather get `in` suffux?



---

archive/issue_comments_433634.json:
```json
{
    "body": "They are processed by m4, see `build/pkgs/sagelib/bootstrap`",
    "created_at": "2022-12-07T17:57:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433634",
    "user": "https://github.com/mkoeppe"
}
```

They are processed by m4, see `build/pkgs/sagelib/bootstrap`



---

archive/issue_comments_433635.json:
```json
{
    "body": "Imho they should have .in suffix. Otherwise, looks OK.",
    "created_at": "2022-12-07T20:09:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433635",
    "user": "https://github.com/dimpase"
}
```

Imho they should have .in suffix. Otherwise, looks OK.



---

archive/issue_comments_433636.json:
```json
{
    "body": "The .in files in use with autotools are not processed by m4.\n\nThese .m4 files are processed by m4. For example, in setup.cfg.m4 you'll see the m4 macro call `esyscmd`.",
    "created_at": "2022-12-07T20:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433636",
    "user": "https://github.com/mkoeppe"
}
```

The .in files in use with autotools are not processed by m4.

These .m4 files are processed by m4. For example, in setup.cfg.m4 you'll see the m4 macro call `esyscmd`.



---

archive/issue_comments_433637.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-12-07T20:22:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433637",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_433638.json:
```json
{
    "body": "ah, OK. I misunderstood what \"processed\" means in this context.",
    "created_at": "2022-12-07T20:22:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433638",
    "user": "https://github.com/dimpase"
}
```

ah, OK. I misunderstood what "processed" means in this context.



---

archive/issue_comments_433639.json:
```json
{
    "body": "Thanks!",
    "created_at": "2022-12-07T20:24:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433639",
    "user": "https://github.com/mkoeppe"
}
```

Thanks!



---

archive/issue_comments_433640.json:
```json
{
    "body": "When I build the full sagelib with this ticket included (but I do not build those sub distribution yet) in sage-on-gentoo, building the documentation fails. After inspection, I have the sources installed for `sage/libs/flint`, `sage/libs/arb` etc, but none of compiled module are installed. Is there something I am missing or doing wrong?",
    "created_at": "2022-12-13T20:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433640",
    "user": "https://github.com/kiwifb"
}
```

When I build the full sagelib with this ticket included (but I do not build those sub distribution yet) in sage-on-gentoo, building the documentation fails. After inspection, I have the sources installed for `sage/libs/flint`, `sage/libs/arb` etc, but none of compiled module are installed. Is there something I am missing or doing wrong?



---

archive/issue_comments_433641.json:
```json
{
    "body": "Are you building from `src/` or from `pkgs/sagemath-standard/`?",
    "created_at": "2022-12-13T21:03:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433641",
    "user": "https://github.com/mkoeppe"
}
```

Are you building from `src/` or from `pkgs/sagemath-standard/`?



---

archive/issue_comments_433642.json:
```json
{
    "body": "`src` with the `setup.py` from `sagemath-standard`. This is when I build against develop or the Volker merging branch. The main reason I am starting from `src` in those cases, is that patch does not like links.",
    "created_at": "2022-12-13T21:07:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433642",
    "user": "https://github.com/kiwifb"
}
```

`src` with the `setup.py` from `sagemath-standard`. This is when I build against develop or the Volker merging branch. The main reason I am starting from `src` in those cases, is that patch does not like links.



---

archive/issue_comments_433643.json:
```json
{
    "body": "I also delete `src/sage_setup` so it is not used instead of the installed one.",
    "created_at": "2022-12-13T21:11:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433643",
    "user": "https://github.com/kiwifb"
}
```

I also delete `src/sage_setup` so it is not used instead of the installed one.



---

archive/issue_comments_433644.json:
```json
{
    "body": "OK, that's something that I'll have to fix in `pkgs/sagemath-standard/setup.py`.\nThanks for catching this",
    "created_at": "2022-12-13T21:24:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433644",
    "user": "https://github.com/mkoeppe"
}
```

OK, that's something that I'll have to fix in `pkgs/sagemath-standard/setup.py`.
Thanks for catching this



---

archive/issue_comments_433645.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-12-13T21:24:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433645",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_433646.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-14T06:56:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433646",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433647.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2022-12-19T05:01:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30429",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30429#issuecomment-433647",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
