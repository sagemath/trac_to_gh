# Issue 11479: Decide what to do with e^(y=x)

archive/issues_011479.json:
```json
{
    "body": "Assignee: @burcin\n\nCC:  @robertwb\n\nKeywords: maxima parsing\n\n[This sage-support thread](http://groups.google.com/group/sage-support/browse_thread/thread/641c16b1d5c9f026) describes the following problem:\n\n```\nsage: var('y') \ny \nsage: (y==x).log() \nlog(y == x) \nsage: (y==x).log().simplify() # just sends to Maxima and back to Sage \nlog(y) == log(x) \nsage: (y==x).exp() \ne^(y == x) \nsage: (y==x).exp().simplify() # just sends to Maxima and back to Sage \nTypeError: unable to make sense of Maxima expression 'e^(y=x)' in Sage \n```\n\n\nBasically, one can consider the problem in two ways - a Sage bug or a Maxima bug/feature.  Depends on how you look at it. \n* Option 1: We don't expect an = sign inside of expressions in our parser in sage/misc/parser.py.  Once you leave Parser.p_eqn, there is a lot of jumping around that happens, but it never gets back there, and that is the only place that replaces = with ==.  So we should fix that.\n* Option 2: Maxima erroneously doesn't change `e^(y=x)` to `e<sup>y=e</sup>x`.  With log, it does: \n\n```\nsage: var('y'); a = (y==x).log() \nsage: a._maxima_() \nlog(y)=log(x) \n```\n\n   But with exp, it doesn't: \n\n```\nsage: var('y'); a = (y==x).exp() \ny \nsage: a._maxima_() \n%e^(y=x) \n```\n\n\nFor now putting the upstream as 'none of the above' since it's not clear the bug is upstream.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11651\n\n",
    "created_at": "2011-08-05T16:24:03Z",
    "labels": [
        "symbolics",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Decide what to do with e^(y=x)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11479",
    "user": "@kcrisman"
}
```
Assignee: @burcin

CC:  @robertwb

Keywords: maxima parsing

[This sage-support thread](http://groups.google.com/group/sage-support/browse_thread/thread/641c16b1d5c9f026) describes the following problem:

```
sage: var('y') 
y 
sage: (y==x).log() 
log(y == x) 
sage: (y==x).log().simplify() # just sends to Maxima and back to Sage 
log(y) == log(x) 
sage: (y==x).exp() 
e^(y == x) 
sage: (y==x).exp().simplify() # just sends to Maxima and back to Sage 
TypeError: unable to make sense of Maxima expression 'e^(y=x)' in Sage 
```


Basically, one can consider the problem in two ways - a Sage bug or a Maxima bug/feature.  Depends on how you look at it. 
* Option 1: We don't expect an = sign inside of expressions in our parser in sage/misc/parser.py.  Once you leave Parser.p_eqn, there is a lot of jumping around that happens, but it never gets back there, and that is the only place that replaces = with ==.  So we should fix that.
* Option 2: Maxima erroneously doesn't change `e^(y=x)` to `e<sup>y=e</sup>x`.  With log, it does: 

```
sage: var('y'); a = (y==x).log() 
sage: a._maxima_() 
log(y)=log(x) 
```

   But with exp, it doesn't: 

```
sage: var('y'); a = (y==x).exp() 
y 
sage: a._maxima_() 
%e^(y=x) 
```


For now putting the upstream as 'none of the above' since it's not clear the bug is upstream.

Issue created by migration from https://trac.sagemath.org/ticket/11651





---

archive/issue_comments_128244.json:
```json
{
    "body": "See [this Maxima list message](http://www.math.utexas.edu/pipermail/maxima/2011/025756.html), and the ensuing comments, for more information.  \n\nFor now I'm putting this as \"upstream denies bug\" because the sense on the list was not unanimous that it should always happen; certainly one doesn't always want to expand the `==`, though for `exp` one might want to.\n\nRobert Dodier had a partial fix:\n\n```\n\nWell, log is declared to distrubute over lists, matrices, and equations,\nwhile exp is not so declared.\nYou can get the desired effect like this in a Maxima session,\nor just put the Lisp code in maxima-init.lisp.\n\n:lisp (setf (get '%exp 'distribute_over) '(mlist mequal))\n\n(Note that this also declares that exp distributes over lists;\nI hope that's not controversial. Exp shouldn't distribute over\nmatrices since exp(matrix) has another interpretation.)\n```\n\nHowever, this would not work with `%e^(y=x)`, only `exp(y=x)`, apparently.",
    "created_at": "2011-08-08T12:56:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11479#issuecomment-128244",
    "user": "@kcrisman"
}
```

See [this Maxima list message](http://www.math.utexas.edu/pipermail/maxima/2011/025756.html), and the ensuing comments, for more information.  

For now I'm putting this as "upstream denies bug" because the sense on the list was not unanimous that it should always happen; certainly one doesn't always want to expand the `==`, though for `exp` one might want to.

Robert Dodier had a partial fix:

```

Well, log is declared to distrubute over lists, matrices, and equations,
while exp is not so declared.
You can get the desired effect like this in a Maxima session,
or just put the Lisp code in maxima-init.lisp.

:lisp (setf (get '%exp 'distribute_over) '(mlist mequal))

(Note that this also declares that exp distributes over lists;
I hope that's not controversial. Exp shouldn't distribute over
matrices since exp(matrix) has another interpretation.)
```

However, this would not work with `%e^(y=x)`, only `exp(y=x)`, apparently.
