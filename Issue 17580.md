# Issue 17580: Error when taking resultant of polynomials over complicated base ring

Issue created by migration from Trac.

Original creator: pbruin

Original creation time: 2015-02-20 17:10:03

CC:  mmarco

Keywords: polynomial resultant

The following apparently tries to convert `p` and `q` into a wrong common ring (even though they already both have parent `S`):

```
A.<a,b,c> = Frac(PolynomialRing(QQ,'a,b,c'))
B.<d,e,f> = PolynomialRing(A,'d,e,f')
R.<x>= PolynomialRing(B,'x')
S.<y> = PolynomialRing(R,'y')
p = ((1/b^2*d^2+1/a)*x*y^2+a*b/c*y+e+x^2)
q = -4*c^2*y^3+1
print(p.resultant(q))
Traceback (most recent call last):
...
TypeError: not a constant polynomial
```

Another (related?) bug:

```
(a*d*x^2+a+e+1).resultant(-4*c^2*x+1)
Traceback (most recent call last):
...
RuntimeError: maximum recursion depth exceeded in cmp
```



---

Comment by pbruin created at 2015-03-17 09:42:52

Changing status from new to needs_review.


---

Comment by mmezzarobba created at 2015-04-12 19:28:55

So some resultants that used to be computed using Singular will now go through `sylvester_matrix`—is that correct? Do you know if it makes a significant difference in terms of speed?


---

Comment by mmarco created at 2015-04-12 20:26:30

We would need to run benchmarks to make sure, but it is certainly possible that the sylvester matrix method would be faster than singular, at least in some cases.


---

Comment by pbruin created at 2015-04-13 07:29:19

Replying to [comment:2 mmezzarobba]:
> So some resultants that used to be computed using Singular will now go through `sylvester_matrix`—is that correct?
Possibly, but this is only relevant when the polynomials are univariate polynomials over a multivariate polynomial ring.  The Sylvester matrix is only used if the coefficients cannot be converted to PARI; what probably happens in most cases is that the resultant is computed through PARI rather than Singular.  For genuine multivariate polynomials, Singular is still used via `MPolynomial_libsingular.resultant()`.
> Do you know if it makes a significant difference in terms of speed?
I don't know.  How about adding an `algorithm` keyword (which could be `pari`, `singular` or `sylvester` for now) so that the user can easily choose an implementation and we can compare the speed of the implementations?


---

Comment by mmezzarobba created at 2015-04-13 19:58:50

Changing status from needs_review to positive_review.


---

Comment by mmezzarobba created at 2015-04-13 19:58:50

Replying to [comment:4 pbruin]:
> I don't know.  How about adding an `algorithm` keyword (which could be `pari`, `singular` or `sylvester` for now) so that the user can easily choose an implementation and we can compare the speed of the implementations?

Ok, but then let's not block this ticket in the meantime if there is no significant regression to be expected.


---

Comment by vbraun created at 2015-04-14 23:01:38

Resolution: fixed
