# Issue 11415: update Cremona's tables for Sage

archive/issues_011415.json:
```json
{
    "body": "Assignee: cremona\n\nCC:  davidloeffler\n\nJohn Cremona tells me that: \"All data for elliptic curves of conductors from 130k to 140k is at\nhttp://www.warwick.ac.uk/staff/J.E.Cremona/ftp/data/ and also as a tar\nfile at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-04-08.tgz\n-- not to mention at http://code.google.com/p/ecdata/ !\"\n\nThe goal of this ticket is to:\n\n(1) Create a new drop-in-replacement sqlite database that has the data up to level 10000, which will be included standard with Sage.\n\n(2) Create a new sqlite database that has the data up to level 140000, which will be an optional spkg.\n\nThis is complicated because the current packages in Sage use ZODB.  Also, Cremona's database format has changed somewhat.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11587\n\n",
    "created_at": "2011-07-11T18:12:14Z",
    "labels": [
        "elliptic curves",
        "major",
        "enhancement"
    ],
    "title": "update Cremona's tables for Sage",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11415",
    "user": "was"
}
```
Assignee: cremona

CC:  davidloeffler

John Cremona tells me that: "All data for elliptic curves of conductors from 130k to 140k is at
http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/data/ and also as a tar
file at http://www.warwick.ac.uk/staff/J.E.Cremona/ftp/ecdata-2011-04-08.tgz
-- not to mention at http://code.google.com/p/ecdata/ !"

The goal of this ticket is to:

(1) Create a new drop-in-replacement sqlite database that has the data up to level 10000, which will be included standard with Sage.

(2) Create a new sqlite database that has the data up to level 140000, which will be an optional spkg.

This is complicated because the current packages in Sage use ZODB.  Also, Cremona's database format has changed somewhat.

Issue created by migration from https://trac.sagemath.org/ticket/11587





---

archive/issue_comments_127065.json:
```json
{
    "body": "Updated description to reflect the current status of the tables.",
    "created_at": "2011-07-11T22:44:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127065",
    "user": "ohanar"
}
```

Updated description to reflect the current status of the tables.



---

archive/issue_comments_127066.json:
```json
{
    "body": "Note: only the allgens file format has changed.",
    "created_at": "2011-07-13T09:17:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127066",
    "user": "cremona"
}
```

Note: only the allgens file format has changed.



---

archive/issue_comments_127067.json:
```json
{
    "body": "There are new spkgs at\nhttp://wstein.org/home/ohanar/cremona-database",
    "created_at": "2011-08-02T00:24:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127067",
    "user": "ohanar"
}
```

There are new spkgs at
http://wstein.org/home/ohanar/cremona-database



---

archive/issue_comments_127068.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-08-02T00:30:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127068",
    "user": "ohanar"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_127069.json:
```json
{
    "body": "I have a few questions.  Also since I do not know SQLITE and do not have the time to learn it just for this, the code will need to be reviewed by someone else.\n\nThere are two spkgs at the link, and one patch on this ticket.  Please can you explain how they are related?  Is one of the spkgs intended to be part of the standard Sage distribution so that every copy of Sage has the mini-database, as is the case now?  And is the other one a replacement for the optional large database?\n\nSecondly, you warn that the database takes some time to create.  Is this once-only time which you had to spend in creating the database which is part of the spkg, or is it time which must be spent by anyone installing the large optional spkg?\n\nTo test this, I assume that the following steps are necessary; please correct me if I am wrong.\n\n1. apply patches at #11642\n2. apply the patch here (trac_11587.patch)\n3. sage -b\n4. sage -i http://wstein.org/home/ohanar/cremona-database/elliptic_curves-0.2.spkg\n5. sage -b, test everything works\n6. sage -i http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110801.spkg\n7. sage -b, test everything still works\n\nLastly:  I expect that at regular intervals over the next few months I will be releasing updates to the database (for example, the range 170k=180k is about 70% done already).  Please leave rather clear instructions for what to do for future updates;  in particular, will it be neceaary to rebuild everything, or just to read in the new files (e.g. *.170000-179999 next time)?",
    "created_at": "2011-08-02T09:45:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127069",
    "user": "cremona"
}
```

I have a few questions.  Also since I do not know SQLITE and do not have the time to learn it just for this, the code will need to be reviewed by someone else.

There are two spkgs at the link, and one patch on this ticket.  Please can you explain how they are related?  Is one of the spkgs intended to be part of the standard Sage distribution so that every copy of Sage has the mini-database, as is the case now?  And is the other one a replacement for the optional large database?

Secondly, you warn that the database takes some time to create.  Is this once-only time which you had to spend in creating the database which is part of the spkg, or is it time which must be spent by anyone installing the large optional spkg?

To test this, I assume that the following steps are necessary; please correct me if I am wrong.

1. apply patches at #11642
2. apply the patch here (trac_11587.patch)
3. sage -b
4. sage -i http://wstein.org/home/ohanar/cremona-database/elliptic_curves-0.2.spkg
5. sage -b, test everything works
6. sage -i http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110801.spkg
7. sage -b, test everything still works

Lastly:  I expect that at regular intervals over the next few months I will be releasing updates to the database (for example, the range 170k=180k is about 70% done already).  Please leave rather clear instructions for what to do for future updates;  in particular, will it be neceaary to rebuild everything, or just to read in the new files (e.g. *.170000-179999 next time)?



---

archive/issue_comments_127070.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2011-08-02T09:45:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127070",
    "user": "cremona"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_127071.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2011-08-02T18:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127071",
    "user": "ohanar"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_127072.json:
```json
{
    "body": "Replying to [comment:5 cremona]:\n\n> There are two spkgs at the link, and one patch on this ticket.  Please can you explain how they are related?\n\nThe patch updates sage.databases.cremona to wrap the new SQLite databases. It provides about the same functionality as the old ZODB (there are some slight modifications to actually reflect the documentation, which wasn't respected before -- specifically the mini-database only has data from allcurves).\n\n> Is one of the spkgs intended to be part of the standard Sage distribution so that every copy of Sage has the mini-database, as is the case now?  And is the other one a replacement for the optional large database?\n\nCorrect. The elliptic_curve spkg is included every copy of sage, and includes both the mini-database, as well as a very small database of curves William finds interesting. The database_cremona_ellcurve spkg includes (most of) the data from allcurves, allgens, allbsd, and degphi for every curve that you have listed.\n \n> Secondly, you warn that the database takes some time to create.  Is this once-only time which you had to spend in creating the database which is part of the spkg, or is it time which must be spent by anyone installing the large optional spkg?\n\nCurrently the spkgs simply install pre-built SQL databases, so currently this is a once-only thing. That said, on my home system it only takes ~4mins to create the database from scratch.\n\n> To test this, I assume that the following steps are necessary; please correct me if I am wrong.\n1. apply patches at #11642\n2. apply the patch here (trac_11587.patch)\n3. sage -b\n4. sage -i http://wstein.org/home/ohanar/cremona-database/elliptic_curves-0.2.spkg\n5. sage -b, test everything works\n6. sage -i http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110801.spkg\n7. sage -b, test everything still works\n\nYes, that looks correct. The only thing to be aware of is that #11642 depends on #11640 (which is just a small patch), and that there are optional doctests you should run in step 7.\n\n> Lastly:  I expect that at regular intervals over the next few months I will be releasing updates to the database (for example, the range 170k=180k is about 70% done already).  Please leave rather clear instructions for what to do for future updates;  in particular, will it be neceaary to rebuild everything, or just to read in the new files (e.g. *.170000-179999 next time)?\n\nCurrently there is simple script to rebuild everything, but (in theory) it is also possible to simply add the new files. The former:\n\n```\nrm SAGE_ROOT/data/cremona/cremona.db\nSAGE_ROOT/sage\nsage: sage.databases.cremona.build('cremona','/path/to/ecdata.tgz')\n```\n\nthe later should be (although I haven't tested it):\n\n```\nmake a directory that only contains the new files\nSAGE_ROOT/sage\nsage: cData = sage.databases.cremona.LargeCremonaDatabase('cremona',False)\nsage: cData._init_from_ftpdata('/path/to/said/directory')\n```\n\nThat said, I've marked myself as the maintainer of the database_cremona_ellcurve spkg, so I'll try to keep it up to date (of course it would help if you let me know when you update your tables of course (: ).",
    "created_at": "2011-08-02T18:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127072",
    "user": "ohanar"
}
```

Replying to [comment:5 cremona]:

> There are two spkgs at the link, and one patch on this ticket.  Please can you explain how they are related?

The patch updates sage.databases.cremona to wrap the new SQLite databases. It provides about the same functionality as the old ZODB (there are some slight modifications to actually reflect the documentation, which wasn't respected before -- specifically the mini-database only has data from allcurves).

> Is one of the spkgs intended to be part of the standard Sage distribution so that every copy of Sage has the mini-database, as is the case now?  And is the other one a replacement for the optional large database?

Correct. The elliptic_curve spkg is included every copy of sage, and includes both the mini-database, as well as a very small database of curves William finds interesting. The database_cremona_ellcurve spkg includes (most of) the data from allcurves, allgens, allbsd, and degphi for every curve that you have listed.
 
> Secondly, you warn that the database takes some time to create.  Is this once-only time which you had to spend in creating the database which is part of the spkg, or is it time which must be spent by anyone installing the large optional spkg?

Currently the spkgs simply install pre-built SQL databases, so currently this is a once-only thing. That said, on my home system it only takes ~4mins to create the database from scratch.

> To test this, I assume that the following steps are necessary; please correct me if I am wrong.
1. apply patches at #11642
2. apply the patch here (trac_11587.patch)
3. sage -b
4. sage -i http://wstein.org/home/ohanar/cremona-database/elliptic_curves-0.2.spkg
5. sage -b, test everything works
6. sage -i http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110801.spkg
7. sage -b, test everything still works

Yes, that looks correct. The only thing to be aware of is that #11642 depends on #11640 (which is just a small patch), and that there are optional doctests you should run in step 7.

> Lastly:  I expect that at regular intervals over the next few months I will be releasing updates to the database (for example, the range 170k=180k is about 70% done already).  Please leave rather clear instructions for what to do for future updates;  in particular, will it be neceaary to rebuild everything, or just to read in the new files (e.g. *.170000-179999 next time)?

Currently there is simple script to rebuild everything, but (in theory) it is also possible to simply add the new files. The former:

```
rm SAGE_ROOT/data/cremona/cremona.db
SAGE_ROOT/sage
sage: sage.databases.cremona.build('cremona','/path/to/ecdata.tgz')
```

the later should be (although I haven't tested it):

```
make a directory that only contains the new files
SAGE_ROOT/sage
sage: cData = sage.databases.cremona.LargeCremonaDatabase('cremona',False)
sage: cData._init_from_ftpdata('/path/to/said/directory')
```

That said, I've marked myself as the maintainer of the database_cremona_ellcurve spkg, so I'll try to keep it up to date (of course it would help if you let me know when you update your tables of course (: ).



---

archive/issue_comments_127073.json:
```json
{
    "body": "I've updated the database_cremona_ellcurve spkg to include the latest tables, which can still be found at http://wstein.org/home/ohanar/cremona-database (the old one is still there there as well).\n\nI'm also attaching an updated patch that mainly updates the documentation to reflect the current state of the tables (upper bound of 180,000 vs 130,000), as well as the spkg version. It also limits the outputs of a few queries where only the first entry is needed.",
    "created_at": "2011-08-10T03:02:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127073",
    "user": "ohanar"
}
```

I've updated the database_cremona_ellcurve spkg to include the latest tables, which can still be found at http://wstein.org/home/ohanar/cremona-database (the old one is still there there as well).

I'm also attaching an updated patch that mainly updates the documentation to reflect the current state of the tables (upper bound of 180,000 vs 130,000), as well as the spkg version. It also limits the outputs of a few queries where only the first entry is needed.



---

archive/issue_comments_127074.json:
```json
{
    "body": "fixes the broken doctest for cremona_mini",
    "created_at": "2011-08-24T23:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127074",
    "user": "ohanar"
}
```

fixes the broken doctest for cremona_mini



---

archive/issue_comments_127075.json:
```json
{
    "body": "Attachment\n\nlooks good, works good",
    "created_at": "2011-08-25T08:51:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127075",
    "user": "boothby"
}
```

Attachment

looks good, works good



---

archive/issue_comments_127076.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-08-25T08:51:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127076",
    "user": "boothby"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_127077.json:
```json
{
    "body": "That's +1.4 MB, or +78% for the standard spkg.",
    "created_at": "2011-09-08T14:31:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127077",
    "user": "leif"
}
```

That's +1.4 MB, or +78% for the standard spkg.



---

archive/issue_comments_127078.json:
```json
{
    "body": "Changing keywords from \"\" to \"elliptic curves ellcurve database\".",
    "created_at": "2011-09-08T14:31:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127078",
    "user": "leif"
}
```

Changing keywords from "" to "elliptic curves ellcurve database".



---

archive/issue_comments_127079.json:
```json
{
    "body": "Replying to [comment:9 leif]:\n> That's +1.4 MB, or +78% for the standard spkg.\n\nI can rewrite the install script to simply create the database from Cremona's text files. On my system it takes ~6sec to build it from scratch, and would probably decrease the size of the spkg to a bit over 1MB.",
    "created_at": "2011-09-09T07:47:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127079",
    "user": "ohanar"
}
```

Replying to [comment:9 leif]:
> That's +1.4 MB, or +78% for the standard spkg.

I can rewrite the install script to simply create the database from Cremona's text files. On my system it takes ~6sec to build it from scratch, and would probably decrease the size of the spkg to a bit over 1MB.



---

archive/issue_comments_127080.json:
```json
{
    "body": "Attachment\n\nAdds the new dependencies of the elliptic_curves spkg",
    "created_at": "2011-09-10T07:22:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127080",
    "user": "ohanar"
}
```

Attachment

Adds the new dependencies of the elliptic_curves spkg



---

archive/issue_comments_127081.json:
```json
{
    "body": "I've created a new spkg that builds the cremona_mini database from Cremona's original text file. This requires a patch to the Sage root repository to reflect the new dependencies. I'm going to keep the optional spkg the same since it takes >5mins to build the database.",
    "created_at": "2011-09-10T07:32:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127081",
    "user": "ohanar"
}
```

I've created a new spkg that builds the cremona_mini database from Cremona's original text file. This requires a patch to the Sage root repository to reflect the new dependencies. I'm going to keep the optional spkg the same since it takes >5mins to build the database.



---

archive/issue_comments_127082.json:
```json
{
    "body": "Replying to [comment:11 ohanar]:\n> I've created a new spkg that builds the cremona_mini database from Cremona's original text file. This requires a patch to the Sage root repository to reflect the new dependencies.\n\nCool, thanks.\n\n> I'm going to keep the optional spkg the same since it takes >5mins to build the database.\n\nOptional is optional; I'm not aware of any size demands or restrictions there...",
    "created_at": "2011-09-10T07:55:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127082",
    "user": "leif"
}
```

Replying to [comment:11 ohanar]:
> I've created a new spkg that builds the cremona_mini database from Cremona's original text file. This requires a patch to the Sage root repository to reflect the new dependencies.

Cool, thanks.

> I'm going to keep the optional spkg the same since it takes >5mins to build the database.

Optional is optional; I'm not aware of any size demands or restrictions there...



---

archive/issue_comments_127083.json:
```json
{
    "body": "Replying to [comment:12 leif]:\n> Replying to [comment:11 ohanar]:\n> > I'm going to keep the optional spkg the same since it takes >5mins to build the database.\n> \n> Optional is optional; I'm not aware of any size demands or restrictions there...\n\nTrue, but I realized when updating the spkg that creating the database from text files more closely follows the spkg design of building libraries from source.",
    "created_at": "2011-09-10T08:01:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127083",
    "user": "ohanar"
}
```

Replying to [comment:12 leif]:
> Replying to [comment:11 ohanar]:
> > I'm going to keep the optional spkg the same since it takes >5mins to build the database.
> 
> Optional is optional; I'm not aware of any size demands or restrictions there...

True, but I realized when updating the spkg that creating the database from text files more closely follows the spkg design of building libraries from source.



---

archive/issue_comments_127084.json:
```json
{
    "body": "Many thanks for your work on this, Andrew.  It would be good if it were very easy to extend further (say just by having more data files in the right place on installation), since I have not stopped and in fact am very close to adding the range 180k=190k.  Adding that data (and more) should now be just a matter of adding some data files to the spkg, right?  Is the information such as the maximum conductor hard-wired into the code or just read from the database after construction from raw data files?",
    "created_at": "2011-09-10T13:09:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127084",
    "user": "cremona"
}
```

Many thanks for your work on this, Andrew.  It would be good if it were very easy to extend further (say just by having more data files in the right place on installation), since I have not stopped and in fact am very close to adding the range 180k=190k.  Adding that data (and more) should now be just a matter of adding some data files to the spkg, right?  Is the information such as the maximum conductor hard-wired into the code or just read from the database after construction from raw data files?



---

archive/issue_comments_127085.json:
```json
{
    "body": "Replying to [comment:14 cremona]:\n> It would be good if it were very easy to extend further (say just by having more data files in the right place on installation), since I have not stopped and in fact am very close to adding the range 180k=190k.  Adding that data (and more) should now be just a matter of adding some data files to the spkg, right? \n\nCurrently the spkg includes basically a single file -- a prebuilt database. This is primarily because it is much faster to have the package copy the file, rather than build the database from scratch (I was going to use time it takes to create it on sage.math as an example, but I got too impatient to let it finish). The script to create this database is `sage.databases.cremona.build`, this will build and install the database from your tgz file.\n\nIf we decide to, we can move the build script to be inside the spkg, with the knowledge that we should not use it on slow filesystems. If we do so, we should only include allcurves, allgens, allbsd, and degphi since those are the only files sage currently uses.\n\n> Is the information such as the maximum conductor hard-wired into the code or just read from the database after construction from raw data files?\n\nThere is still a bit of hard-wired code: a bit in the documentation, the build script, and an error message. It is possible to remove all of these references, the only reason I didn't when working on this patch was because I wanted to get sage up to speed. It is a simple fix, although if we decide remove the build scripts from the sage library to the spkg instead, we might as well do this at the same time.",
    "created_at": "2011-09-11T05:17:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127085",
    "user": "ohanar"
}
```

Replying to [comment:14 cremona]:
> It would be good if it were very easy to extend further (say just by having more data files in the right place on installation), since I have not stopped and in fact am very close to adding the range 180k=190k.  Adding that data (and more) should now be just a matter of adding some data files to the spkg, right? 

Currently the spkg includes basically a single file -- a prebuilt database. This is primarily because it is much faster to have the package copy the file, rather than build the database from scratch (I was going to use time it takes to create it on sage.math as an example, but I got too impatient to let it finish). The script to create this database is `sage.databases.cremona.build`, this will build and install the database from your tgz file.

If we decide to, we can move the build script to be inside the spkg, with the knowledge that we should not use it on slow filesystems. If we do so, we should only include allcurves, allgens, allbsd, and degphi since those are the only files sage currently uses.

> Is the information such as the maximum conductor hard-wired into the code or just read from the database after construction from raw data files?

There is still a bit of hard-wired code: a bit in the documentation, the build script, and an error message. It is possible to remove all of these references, the only reason I didn't when working on this patch was because I wanted to get sage up to speed. It is a simple fix, although if we decide remove the build scripts from the sage library to the spkg instead, we might as well do this at the same time.



---

archive/issue_comments_127086.json:
```json
{
    "body": "Replying to [comment:15 ohanar]:\n> Replying to [comment:14 cremona]:\n> > It would be good if it were very easy to extend further (say just by having more data files in the right place on installation), since I have not stopped and in fact am very close to adding the range 180k=190k.  Adding that data (and more) should now be just a matter of adding some data files to the spkg, right? \n> \n> Currently the spkg includes basically a single file -- a prebuilt database. This is primarily because it is much faster to have the package copy the file, rather than build the database from scratch (I was going to use time it takes to create it on sage.math as an example, but I got too impatient to let it finish). The script to create this database is `sage.databases.cremona.build`, this will build and install the database from your tgz file.\n> \n> If we decide to, we can move the build script to be inside the spkg, with the knowledge that we should not use it on slow filesystems. If we do so, we should only include allcurves, allgens, allbsd, and degphi since those are the only files sage currently uses.\n> \n> > Is the information such as the maximum conductor hard-wired into the code or just read from the database after construction from raw data files?\n> \n> There is still a bit of hard-wired code: a bit in the documentation, the build script, and an error message. It is possible to remove all of these references, the only reason I didn't when working on this patch was because I wanted to get sage up to speed. It is a simple fix, although if we decide remove the build scripts from the sage library to the spkg instead, we might as well do this at the same time.\n\nThanks for the explanation.  I agree that it is good to have the database file itself in the package and not the raw data, as long as it (the spkg) also has instructions on how to (re)create this from my raw data.  And a note of the precise things to be changed when the range is extended would also be a good idea, even if that's only a couple of places.  I'm thinking that it may not be you doing this next time!",
    "created_at": "2011-09-11T09:06:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127086",
    "user": "cremona"
}
```

Replying to [comment:15 ohanar]:
> Replying to [comment:14 cremona]:
> > It would be good if it were very easy to extend further (say just by having more data files in the right place on installation), since I have not stopped and in fact am very close to adding the range 180k=190k.  Adding that data (and more) should now be just a matter of adding some data files to the spkg, right? 
> 
> Currently the spkg includes basically a single file -- a prebuilt database. This is primarily because it is much faster to have the package copy the file, rather than build the database from scratch (I was going to use time it takes to create it on sage.math as an example, but I got too impatient to let it finish). The script to create this database is `sage.databases.cremona.build`, this will build and install the database from your tgz file.
> 
> If we decide to, we can move the build script to be inside the spkg, with the knowledge that we should not use it on slow filesystems. If we do so, we should only include allcurves, allgens, allbsd, and degphi since those are the only files sage currently uses.
> 
> > Is the information such as the maximum conductor hard-wired into the code or just read from the database after construction from raw data files?
> 
> There is still a bit of hard-wired code: a bit in the documentation, the build script, and an error message. It is possible to remove all of these references, the only reason I didn't when working on this patch was because I wanted to get sage up to speed. It is a simple fix, although if we decide remove the build scripts from the sage library to the spkg instead, we might as well do this at the same time.

Thanks for the explanation.  I agree that it is good to have the database file itself in the package and not the raw data, as long as it (the spkg) also has instructions on how to (re)create this from my raw data.  And a note of the precise things to be changed when the range is extended would also be a good idea, even if that's only a couple of places.  I'm thinking that it may not be you doing this next time!



---

archive/issue_comments_127087.json:
```json
{
    "body": "If 190k is almost done, I can add the upgrading instructions then.",
    "created_at": "2011-09-11T20:33:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127087",
    "user": "ohanar"
}
```

If 190k is almost done, I can add the upgrading instructions then.



---

archive/issue_comments_127088.json:
```json
{
    "body": "I get warnings from Sphinx:\n\n```\n.../local/lib/python2.6/site-packages/sage/databases/cremona.py:docstring of sage.databases.cremona:26: (WARNING/2) Definition list ends without a blank line; unexpected unindent.\n.../local/lib/python2.6/site-packages/sage/databases/cremona.py:docstring of sage.databases.cremona:36: (WARNING/2) Definition list ends without a blank line; unexpected unindent.\n```\n",
    "created_at": "2011-09-12T07:33:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127088",
    "user": "leif"
}
```

I get warnings from Sphinx:

```
.../local/lib/python2.6/site-packages/sage/databases/cremona.py:docstring of sage.databases.cremona:26: (WARNING/2) Definition list ends without a blank line; unexpected unindent.
.../local/lib/python2.6/site-packages/sage/databases/cremona.py:docstring of sage.databases.cremona:36: (WARNING/2) Definition list ends without a blank line; unexpected unindent.
```




---

archive/issue_comments_127089.json:
```json
{
    "body": "I'm not sure to which ticket this belongs, but I get an apparently trivial doctest error in the following example of `doc/en/bordeaux_2008/elliptic_curves.rst`:\n\n```python\n\nTo use the database, just create a curve by giving\n\n::\n\n    sage: EllipticCurve('5077a1')\n    Elliptic Curve defined by y^2 + y = x^3 - 7*x + 6 over Rational Field\n    sage: C = CremonaDatabase() \n    sage: C.number_of_curves() #optional - cremona\n    847550\n    sage: C[37]\n    {'a': {'a1': [[0, 0, 1, -1, 0], 1, 1],\n           'b1': [[0, 1, 1, -23, -50], 0, 3], ...\n    sage: C.isogeny_class('37b')\n    [Elliptic Curve defined by y^2 + y = x^3 + x^2 - 23*x - 50 \n    over Rational Field, ...]\n\n```\n\n\n\n```\nFile \".../doc/en/bordeaux_2008/elliptic_curves.rst\", line 22:\n    sage: C[37]\nExpected:\n    {'a': {'a1': [[0, 0, 1, -1, 0], 1, 1],\n           'b1': [[0, 1, 1, -23, -50], 0, 3], ...\nGot:\n    {'allcurves': {'a1': [[0, 0, 1, -1, 0], 1, 1], 'b1': [[0, 1, 1, -23, -50], 0, 3], 'b2': [[0, 1, 1, -1873, -31833], 0, 1], 'b3': [[0, 1, 1, -3, 1], 0, 3]}}\n```\n\n\n(Just the first key differs; `a` vs. `allcurves`.)",
    "created_at": "2011-09-12T08:23:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127089",
    "user": "leif"
}
```

I'm not sure to which ticket this belongs, but I get an apparently trivial doctest error in the following example of `doc/en/bordeaux_2008/elliptic_curves.rst`:

```python

To use the database, just create a curve by giving

::

    sage: EllipticCurve('5077a1')
    Elliptic Curve defined by y^2 + y = x^3 - 7*x + 6 over Rational Field
    sage: C = CremonaDatabase() 
    sage: C.number_of_curves() #optional - cremona
    847550
    sage: C[37]
    {'a': {'a1': [[0, 0, 1, -1, 0], 1, 1],
           'b1': [[0, 1, 1, -23, -50], 0, 3], ...
    sage: C.isogeny_class('37b')
    [Elliptic Curve defined by y^2 + y = x^3 + x^2 - 23*x - 50 
    over Rational Field, ...]

```



```
File ".../doc/en/bordeaux_2008/elliptic_curves.rst", line 22:
    sage: C[37]
Expected:
    {'a': {'a1': [[0, 0, 1, -1, 0], 1, 1],
           'b1': [[0, 1, 1, -23, -50], 0, 3], ...
Got:
    {'allcurves': {'a1': [[0, 0, 1, -1, 0], 1, 1], 'b1': [[0, 1, 1, -23, -50], 0, 3], 'b2': [[0, 1, 1, -1873, -31833], 0, 1], 'b3': [[0, 1, 1, -3, 1], 0, 3]}}
```


(Just the first key differs; `a` vs. `allcurves`.)



---

archive/issue_comments_127090.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-09-12T08:27:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127090",
    "user": "cremona"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_127091.json:
```json
{
    "body": "Replying to [comment:19 leif]:\n> I'm not sure to which ticket this belongs, but I get an apparently trivial doctest error in the following example of `doc/en/bordeaux_2008/elliptic_curves.rst`:\n\n> (Just the first key differs; `a` vs. `allcurves`.)\n\nI'm sure this is the correct ticket since the database has changed.  It's easy to forget to test this part of the documentation.  Changing the expected output to the actual output would be fine.\nHence back to \"Needs (trivial) work\".",
    "created_at": "2011-09-12T08:27:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127091",
    "user": "cremona"
}
```

Replying to [comment:19 leif]:
> I'm not sure to which ticket this belongs, but I get an apparently trivial doctest error in the following example of `doc/en/bordeaux_2008/elliptic_curves.rst`:

> (Just the first key differs; `a` vs. `allcurves`.)

I'm sure this is the correct ticket since the database has changed.  It's easy to forget to test this part of the documentation.  Changing the expected output to the actual output would be fine.
Hence back to "Needs (trivial) work".



---

archive/issue_comments_127092.json:
```json
{
    "body": "Replying to [comment:20 cremona]:\n> Replying to [comment:19 leif]:\n> > I'm not sure to which ticket this belongs, but I get an apparently trivial doctest error in the following example of `doc/en/bordeaux_2008/elliptic_curves.rst`:\n> \n> > (Just the first key differs; `a` vs. `allcurves`.)\n> \n> I'm sure this is the correct ticket since the database has changed.  It's easy to forget to test this part of the documentation.  Changing the expected output to the actual output would be fine.\n\nYup, didn't test this, so a good catch (and yes, it does belong here, I made the change in key names). Also, if you run the optional test, that will fail as well (we may want to scrap it for something else, since it adds to the maintenance of the optional spkg).",
    "created_at": "2011-09-12T08:32:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127092",
    "user": "ohanar"
}
```

Replying to [comment:20 cremona]:
> Replying to [comment:19 leif]:
> > I'm not sure to which ticket this belongs, but I get an apparently trivial doctest error in the following example of `doc/en/bordeaux_2008/elliptic_curves.rst`:
> 
> > (Just the first key differs; `a` vs. `allcurves`.)
> 
> I'm sure this is the correct ticket since the database has changed.  It's easy to forget to test this part of the documentation.  Changing the expected output to the actual output would be fine.

Yup, didn't test this, so a good catch (and yes, it does belong here, I made the change in key names). Also, if you run the optional test, that will fail as well (we may want to scrap it for something else, since it adds to the maintenance of the optional spkg).



---

archive/issue_comments_127093.json:
```json
{
    "body": "Replying to [comment:17 ohanar]:\n> If 190k is almost done, I can add the upgrading instructions then.\n\nIt's almost done in the sense that I have everything except that 3 curves in the range are \"missing\" on account of some difficulties with modular symbols which I will now try to fix (requires revising code and testing).  Either I'll have this by the end of Thursday, or I'll be away for a week and it will take longer.",
    "created_at": "2011-09-12T08:46:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127093",
    "user": "cremona"
}
```

Replying to [comment:17 ohanar]:
> If 190k is almost done, I can add the upgrading instructions then.

It's almost done in the sense that I have everything except that 3 curves in the range are "missing" on account of some difficulties with modular symbols which I will now try to fix (requires revising code and testing).  Either I'll have this by the end of Thursday, or I'll be away for a week and it will take longer.



---

archive/issue_comments_127094.json:
```json
{
    "body": "Attachment\n\nApply on top to sage library. Fixes issues with documentation.",
    "created_at": "2011-09-12T23:37:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127094",
    "user": "ohanar"
}
```

Attachment

Apply on top to sage library. Fixes issues with documentation.



---

archive/issue_comments_127095.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-09-12T23:42:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127095",
    "user": "ohanar"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_127096.json:
```json
{
    "body": "Applying trac_11587.patch onto 4.7.2.alpha1 failed.  And before that, installing the new spkg using sage -i ended with \n\n```\n...\nThread model: posix\ngcc version 4.4.3 (Ubuntu 4.4.3-4ubuntu5) \n****************************************************\n/home/jec/sage-4.7.2.alpha1.ecdb/local/bin/sage-sage: line 807: 12145 Killed                  tee -a ../install.log \"$SAGE_LOGS/$PKG_NAME\".log\n```\n\nwhich looks like an error message, I am not sure.  Am I doing something wrong?",
    "created_at": "2011-09-15T13:24:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127096",
    "user": "cremona"
}
```

Applying trac_11587.patch onto 4.7.2.alpha1 failed.  And before that, installing the new spkg using sage -i ended with 

```
...
Thread model: posix
gcc version 4.4.3 (Ubuntu 4.4.3-4ubuntu5) 
****************************************************
/home/jec/sage-4.7.2.alpha1.ecdb/local/bin/sage-sage: line 807: 12145 Killed                  tee -a ../install.log "$SAGE_LOGS/$PKG_NAME".log
```

which looks like an error message, I am not sure.  Am I doing something wrong?



---

archive/issue_comments_127097.json:
```json
{
    "body": "Replying to [comment:25 cremona]:\n> Applying trac_11587.patch onto 4.7.2.alpha1 failed.\n\nDid you first apply #11640 and #11642?\n\n\n> And before that, installing the new spkg using sage -i ended with \n\n```\n...\nThread model: posix\ngcc version 4.4.3 (Ubuntu 4.4.3-4ubuntu5) \n****************************************************\n/home/jec/sage-4.7.2.alpha1.ecdb/local/bin/sage-sage: line 807: 12145 Killed                  tee -a ../install.log \"$SAGE_LOGS/$PKG_NAME\".log\n```\n\n> which looks like an error message, I am not sure.\n\nYes. No idea what might have caused that.",
    "created_at": "2011-09-15T14:13:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127097",
    "user": "leif"
}
```

Replying to [comment:25 cremona]:
> Applying trac_11587.patch onto 4.7.2.alpha1 failed.

Did you first apply #11640 and #11642?


> And before that, installing the new spkg using sage -i ended with 

```
...
Thread model: posix
gcc version 4.4.3 (Ubuntu 4.4.3-4ubuntu5) 
****************************************************
/home/jec/sage-4.7.2.alpha1.ecdb/local/bin/sage-sage: line 807: 12145 Killed                  tee -a ../install.log "$SAGE_LOGS/$PKG_NAME".log
```

> which looks like an error message, I am not sure.

Yes. No idea what might have caused that.



---

archive/issue_comments_127098.json:
```json
{
    "body": "Replying to [comment:26 leif]:\n> Replying to [comment:25 cremona]:\n> > Applying trac_11587.patch onto 4.7.2.alpha1 failed.\n> \n> Did you first apply #11640 and #11642?\n\nNo since I saw that they were merged already -- but now I see that they were merged in alpha3 only.",
    "created_at": "2011-09-15T14:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127098",
    "user": "cremona"
}
```

Replying to [comment:26 leif]:
> Replying to [comment:25 cremona]:
> > Applying trac_11587.patch onto 4.7.2.alpha1 failed.
> 
> Did you first apply #11640 and #11642?

No since I saw that they were merged already -- but now I see that they were merged in alpha3 only.



---

archive/issue_comments_127099.json:
```json
{
    "body": "OK, with #11640 and #11642 applied first the patches to the Sage library apply fine.  Dor the deps one I just manually edited the file since I could find no trace of mercurial in $SAGE_ROOT/spkgs/standard (or at least hg gave an error message).  Then I rebuilt everything with sage -ba, and I am now doing a make ptestlong, and will report back.\n\nSmall comment, since I know that Andrew will be updating the conductor ranges anyway:  at the moment smallest_conductor() returns 1 which will surprise some people as the actual smallest is 11!",
    "created_at": "2011-09-15T14:52:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127099",
    "user": "cremona"
}
```

OK, with #11640 and #11642 applied first the patches to the Sage library apply fine.  Dor the deps one I just manually edited the file since I could find no trace of mercurial in $SAGE_ROOT/spkgs/standard (or at least hg gave an error message).  Then I rebuilt everything with sage -ba, and I am now doing a make ptestlong, and will report back.

Small comment, since I know that Andrew will be updating the conductor ranges anyway:  at the moment smallest_conductor() returns 1 which will surprise some people as the actual smallest is 11!



---

archive/issue_comments_127100.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-09-15T15:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127100",
    "user": "cremona"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_127101.json:
```json
{
    "body": "All test pass, so I am giving this a positive review.  This is for the default database (max conductor 10000);  but this ticket cannot be merged until the large database is also ready to go and has been tested.",
    "created_at": "2011-09-15T15:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127101",
    "user": "cremona"
}
```

All test pass, so I am giving this a positive review.  This is for the default database (max conductor 10000);  but this ticket cannot be merged until the large database is also ready to go and has been tested.



---

archive/issue_comments_127102.json:
```json
{
    "body": "Replying to [comment:29 cremona]:\n> All test pass, so I am giving this a positive review.\n\nI didn't expect something else. ;-)\n\n> This is for the default database (max conductor 10000);  but this ticket cannot be merged until the large database is also ready to go and has been tested.\n\nWhich will be when?\n\nCan't we just merge this ticket and open a follow-up in case something goes wrong with the larger (anyway optional) database?",
    "created_at": "2011-09-15T16:03:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127102",
    "user": "leif"
}
```

Replying to [comment:29 cremona]:
> All test pass, so I am giving this a positive review.

I didn't expect something else. ;-)

> This is for the default database (max conductor 10000);  but this ticket cannot be merged until the large database is also ready to go and has been tested.

Which will be when?

Can't we just merge this ticket and open a follow-up in case something goes wrong with the larger (anyway optional) database?



---

archive/issue_comments_127103.json:
```json
{
    "body": "P.S.: `deps` is part of the \"root\" repository, which is located in `$SAGE_ROOT`, so you have to apply the patch there.",
    "created_at": "2011-09-15T16:06:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127103",
    "user": "leif"
}
```

P.S.: `deps` is part of the "root" repository, which is located in `$SAGE_ROOT`, so you have to apply the patch there.



---

archive/issue_comments_127104.json:
```json
{
    "body": "Replying to [comment:30 leif]:\n> Replying to [comment:29 cremona]:\n> > All test pass, so I am giving this a positive review.\n> \n> I didn't expect something else. ;-)\n> \n> > This is for the default database (max conductor 10000);  but this ticket cannot be merged until the large database is also ready to go and has been tested.\n> \n> Which will be when?\n\nI finished creating the data this morning, and Andrew Ohana is updating his optional spkg (?) now.\n\n> \n> Can't we just merge this ticket and open a follow-up in case something goes wrong with the larger (anyway optional) database?\n\nNo, I don't think so, since the database has completely changed and so the *old* version of the optional larger database spkg will not be able to be applied to the *new* standard spkg.  (Andrew, please correct me if I am wrong on this).\n\nAnyway, the impression I got was that adding the additional curves published today would only take a few minutes.  If longer, then go with what is on this ticket.  But I don't know the right mechanism for changing the optional spkg.",
    "created_at": "2011-09-15T16:14:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127104",
    "user": "cremona"
}
```

Replying to [comment:30 leif]:
> Replying to [comment:29 cremona]:
> > All test pass, so I am giving this a positive review.
> 
> I didn't expect something else. ;-)
> 
> > This is for the default database (max conductor 10000);  but this ticket cannot be merged until the large database is also ready to go and has been tested.
> 
> Which will be when?

I finished creating the data this morning, and Andrew Ohana is updating his optional spkg (?) now.

> 
> Can't we just merge this ticket and open a follow-up in case something goes wrong with the larger (anyway optional) database?

No, I don't think so, since the database has completely changed and so the *old* version of the optional larger database spkg will not be able to be applied to the *new* standard spkg.  (Andrew, please correct me if I am wrong on this).

Anyway, the impression I got was that adding the additional curves published today would only take a few minutes.  If longer, then go with what is on this ticket.  But I don't know the right mechanism for changing the optional spkg.



---

archive/issue_comments_127105.json:
```json
{
    "body": "Replying to [comment:32 cremona]:\n> Replying to [comment:30 leif]:\n> > Replying to [comment:29 cremona]:\n> > > This is for the default database (max conductor 10000);  but this ticket cannot be merged until the large database is also ready to go and has been tested.\n> > \n> > Which will be when?\n> \n> I finished creating the data this morning, and Andrew Ohana is updating his optional spkg (?) now.\n\nWorking on it right now.\n> \n> > \n> > Can't we just merge this ticket and open a follow-up in case something goes wrong with the larger (anyway optional) database?\n> \n> No, I don't think so, since the database has completely changed and so the *old* version of the optional larger database spkg will not be able to be applied to the *new* standard spkg.  (Andrew, please correct me if I am wrong on this).\n\nThe optional spkgs mentioned the description work with the new database format, but there are a few places where the version of the package is hardcoded into the sage library (so holding off may be a good idea). I am going to remove these, so that maintaining the spkg is an easier chore.",
    "created_at": "2011-09-15T21:15:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127105",
    "user": "ohanar"
}
```

Replying to [comment:32 cremona]:
> Replying to [comment:30 leif]:
> > Replying to [comment:29 cremona]:
> > > This is for the default database (max conductor 10000);  but this ticket cannot be merged until the large database is also ready to go and has been tested.
> > 
> > Which will be when?
> 
> I finished creating the data this morning, and Andrew Ohana is updating his optional spkg (?) now.

Working on it right now.
> 
> > 
> > Can't we just merge this ticket and open a follow-up in case something goes wrong with the larger (anyway optional) database?
> 
> No, I don't think so, since the database has completely changed and so the *old* version of the optional larger database spkg will not be able to be applied to the *new* standard spkg.  (Andrew, please correct me if I am wrong on this).

The optional spkgs mentioned the description work with the new database format, but there are a few places where the version of the package is hardcoded into the sage library (so holding off may be a good idea). I am going to remove these, so that maintaining the spkg is an easier chore.



---

archive/issue_comments_127106.json:
```json
{
    "body": "Attachment\n\nremoves the hardcoded version number from sage library",
    "created_at": "2011-09-15T22:31:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127106",
    "user": "ohanar"
}
```

Attachment

removes the hardcoded version number from sage library



---

archive/issue_comments_127107.json:
```json
{
    "body": "Ok, I've updated the spkg, it now includes updating instructions in the spkg.txt as well. I've also added a patch that removes the hardcoded version numbers from the sage library, the instructions in the spkg are based off of this.",
    "created_at": "2011-09-15T22:37:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127107",
    "user": "ohanar"
}
```

Ok, I've updated the spkg, it now includes updating instructions in the spkg.txt as well. I've also added a patch that removes the hardcoded version numbers from the sage library, the instructions in the spkg are based off of this.



---

archive/issue_comments_127108.json:
```json
{
    "body": "Andrew, is the optional spkg http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110915.spkg with the larger database ready for \"release\"?",
    "created_at": "2011-09-16T13:53:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127108",
    "user": "leif"
}
```

Andrew, is the optional spkg http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110915.spkg with the larger database ready for "release"?



---

archive/issue_comments_127109.json:
```json
{
    "body": "Replying to [comment:35 leif]:\n> Andrew, is the optional spkg http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110915.spkg with the larger database ready for \"release\"?\n\nIt should be (the install script simply copies a single file)",
    "created_at": "2011-09-16T16:58:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127109",
    "user": "ohanar"
}
```

Replying to [comment:35 leif]:
> Andrew, is the optional spkg http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20110915.spkg with the larger database ready for "release"?

It should be (the install script simply copies a single file)



---

archive/issue_comments_127110.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-09-17T04:58:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127110",
    "user": "leif"
}
```

Resolution: fixed



---

archive/issue_comments_127111.json:
```json
{
    "body": "Had to add a changelog entry for the previous version in Sage (0.1), since otherwise Jeroen's merger3 (meanwhile) rejects it (assuming it wasn't based on the previous one in Sage).\n\nCorrected spkg at new location.",
    "created_at": "2011-09-23T04:20:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127111",
    "user": "leif"
}
```

Had to add a changelog entry for the previous version in Sage (0.1), since otherwise Jeroen's merger3 (meanwhile) rejects it (assuming it wasn't based on the previous one in Sage).

Corrected spkg at new location.



---

archive/issue_comments_127112.json:
```json
{
    "body": "\"Proper\" Mercurial changeset replacement patch. (Adds just the \"User\" field.)",
    "created_at": "2011-09-28T17:46:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127112",
    "user": "leif"
}
```

"Proper" Mercurial changeset replacement patch. (Adds just the "User" field.)



---

archive/issue_comments_127113.json:
```json
{
    "body": "Attachment\n\nI've attached one replacement patch which just adds the \"`# User ...`\" line the original patch is lacking.",
    "created_at": "2011-09-28T17:51:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127113",
    "user": "leif"
}
```

Attachment

I've attached one replacement patch which just adds the "`# User ...`" line the original patch is lacking.



---

archive/issue_comments_127114.json:
```json
{
    "body": "After installing the optionl daatbase on top of 4.7.2.alpha3 I had a doctest failure in \ndevel/sage/doc/en/bordeaux_2008/elliptic_curves.rst .  Nothing serious, just different gens for a curve (i.e. the ones in the database are not the same as those found, for a rank 2 curve).",
    "created_at": "2011-09-29T19:15:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127114",
    "user": "cremona"
}
```

After installing the optionl daatbase on top of 4.7.2.alpha3 I had a doctest failure in 
devel/sage/doc/en/bordeaux_2008/elliptic_curves.rst .  Nothing serious, just different gens for a curve (i.e. the ones in the database are not the same as those found, for a rank 2 curve).



---

archive/issue_comments_127115.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2011-10-06T19:25:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127115",
    "user": "jdemeyer"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_127116.json:
```json
{
    "body": "This is the cause of a serious speed regression.  Message by Dave Loeffler:\n\nI've found the culprit: this is a side-effect of #11587. If you\nlook at [attachment:trac_11587.patch], then it removes a couple of lines of code\nat lines 710-712 of sage/databases/cremona.py which sets the\ngenerators to [] if the gens aren't explicitly in the database but the\nrank is known to be 0. The new version doesn't perform this little\ncheck and so we waste loads of time doing pointless 2-descents.",
    "created_at": "2011-10-06T19:25:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127116",
    "user": "jdemeyer"
}
```

This is the cause of a serious speed regression.  Message by Dave Loeffler:

I've found the culprit: this is a side-effect of #11587. If you
look at [attachment:trac_11587.patch], then it removes a couple of lines of code
at lines 710-712 of sage/databases/cremona.py which sets the
generators to [] if the gens aren't explicitly in the database but the
rank is known to be 0. The new version doesn't perform this little
check and so we waste loads of time doing pointless 2-descents.



---

archive/issue_comments_127117.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2011-10-06T19:25:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127117",
    "user": "jdemeyer"
}
```

Changing status from closed to new.



---

archive/issue_comments_127118.json:
```json
{
    "body": "Replying to [comment:41 jdemeyer]:\n> This is the cause of a serious speed regression.  Message by Dave Loeffler:\n> \n> I've found the culprit: this is a side-effect of #11587. If you\n> look at [attachment:trac_11587.patch], then it removes a couple of lines of code\n> at lines 710-712 of sage/databases/cremona.py which sets the\n> generators to [] if the gens aren't explicitly in the database but the\n> rank is known to be 0. The new version doesn't perform this little\n> check and so we waste loads of time doing pointless 2-descents.\n\nI was fearing something like that.\n\nWhy not open a follow-up (blocker) ticket for fixing that?\n\nalpha3 is already out...",
    "created_at": "2011-10-06T19:58:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127118",
    "user": "leif"
}
```

Replying to [comment:41 jdemeyer]:
> This is the cause of a serious speed regression.  Message by Dave Loeffler:
> 
> I've found the culprit: this is a side-effect of #11587. If you
> look at [attachment:trac_11587.patch], then it removes a couple of lines of code
> at lines 710-712 of sage/databases/cremona.py which sets the
> generators to [] if the gens aren't explicitly in the database but the
> rank is known to be 0. The new version doesn't perform this little
> check and so we waste loads of time doing pointless 2-descents.

I was fearing something like that.

Why not open a follow-up (blocker) ticket for fixing that?

alpha3 is already out...



---

archive/issue_comments_127119.json:
```json
{
    "body": "Replying to [comment:42 leif]:\n> Why not open a follow-up (blocker) ticket for fixing that?\nI thought it might be easier to change an existing ticket, especially if the change is small.\n\n> alpha3 is already out...\nDoesn't really matter, I can re-merge the ticket in alpha4...",
    "created_at": "2011-10-06T20:04:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127119",
    "user": "jdemeyer"
}
```

Replying to [comment:42 leif]:
> Why not open a follow-up (blocker) ticket for fixing that?
I thought it might be easier to change an existing ticket, especially if the change is small.

> alpha3 is already out...
Doesn't really matter, I can re-merge the ticket in alpha4...



---

archive/issue_comments_127120.json:
```json
{
    "body": "Replying to [comment:41 jdemeyer]:\n> This is the cause of a serious speed regression.  Message by Dave Loeffler:\n> \n> I've found the culprit: this is a side-effect of #11587. If you\n> look at [attachment:trac_11587.patch], then it removes a couple of lines of code\n> at lines 710-712 of sage/databases/cremona.py which sets the\n> generators to [] if the gens aren't explicitly in the database but the\n> rank is known to be 0. The new version doesn't perform this little\n> check and so we waste loads of time doing pointless 2-descents.\n\nIt has always been rather a nuisance that the small default database differs from the large one not only in having fewer curves but in having less information about them (specifically, omits the known rank and generators).  I don't want to delay this ticket longer than necessary (and apologise for the positive review which missed this glitch) but propose a follow-up which includes all known data for the small database too.",
    "created_at": "2011-10-06T21:08:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127120",
    "user": "cremona"
}
```

Replying to [comment:41 jdemeyer]:
> This is the cause of a serious speed regression.  Message by Dave Loeffler:
> 
> I've found the culprit: this is a side-effect of #11587. If you
> look at [attachment:trac_11587.patch], then it removes a couple of lines of code
> at lines 710-712 of sage/databases/cremona.py which sets the
> generators to [] if the gens aren't explicitly in the database but the
> rank is known to be 0. The new version doesn't perform this little
> check and so we waste loads of time doing pointless 2-descents.

It has always been rather a nuisance that the small default database differs from the large one not only in having fewer curves but in having less information about them (specifically, omits the known rank and generators).  I don't want to delay this ticket longer than necessary (and apologise for the positive review which missed this glitch) but propose a follow-up which includes all known data for the small database too.



---

archive/issue_comments_127121.json:
```json
{
    "body": "Follow-up or on this ticket will not make a difference because I plan to unmerge this ticket anyway if it causes such massive slowdown.  So, do as you wish.",
    "created_at": "2011-10-06T21:19:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127121",
    "user": "jdemeyer"
}
```

Follow-up or on this ticket will not make a difference because I plan to unmerge this ticket anyway if it causes such massive slowdown.  So, do as you wish.



---

archive/issue_comments_127122.json:
```json
{
    "body": "This will be unmerged for the sage-4.7.2 release series.  We really *should* get this working so that it can be merged again in sage-4.7.3.alpha0.",
    "created_at": "2011-10-08T10:23:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127122",
    "user": "jdemeyer"
}
```

This will be unmerged for the sage-4.7.2 release series.  We really *should* get this working so that it can be merged again in sage-4.7.3.alpha0.



---

archive/issue_comments_127123.json:
```json
{
    "body": "Replying to [comment:46 jdemeyer]:\n> This will be unmerged for the sage-4.7.2 release series.  We really *should* get this working so that it can be merged again in sage-4.7.3.alpha0.\n\nThen we should also remove [http://sagemath.org/packages/optional/database_cremona_ellcurve-20110915.spkg](http://sagemath.org/packages/optional/database_cremona_ellcurve-20110915.spkg) again, since it is in the new format (which only the alpha3 supports); either when alpha4 is officially released, or right before the final 4.7.2 gets out.\n\nIt shouldn't be hard to change its `spkg-install` to just install the previous version (hard-coded URL, e.g. by recursively calling `sage -i ...` or `sage-spkg`) if the Sage version present doesn't support the new format, which is reasonable for the future anyway (i.e., when this ticket gets remerged). Cf. [sage-release](http://groups.google.com/group/sage-release/browse_thread/thread/3f8a60845a477324/cc82a5faf40fe57e#cc82a5faf40fe57e).",
    "created_at": "2011-10-08T14:10:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127123",
    "user": "leif"
}
```

Replying to [comment:46 jdemeyer]:
> This will be unmerged for the sage-4.7.2 release series.  We really *should* get this working so that it can be merged again in sage-4.7.3.alpha0.

Then we should also remove [http://sagemath.org/packages/optional/database_cremona_ellcurve-20110915.spkg](http://sagemath.org/packages/optional/database_cremona_ellcurve-20110915.spkg) again, since it is in the new format (which only the alpha3 supports); either when alpha4 is officially released, or right before the final 4.7.2 gets out.

It shouldn't be hard to change its `spkg-install` to just install the previous version (hard-coded URL, e.g. by recursively calling `sage -i ...` or `sage-spkg`) if the Sage version present doesn't support the new format, which is reasonable for the future anyway (i.e., when this ticket gets remerged). Cf. [sage-release](http://groups.google.com/group/sage-release/browse_thread/thread/3f8a60845a477324/cc82a5faf40fe57e#cc82a5faf40fe57e).



---

archive/issue_comments_127124.json:
```json
{
    "body": "... or simply print a message instructing the user to instead do\n\n```sh\n$ ./sage -i http://sagemath.org/packages/archive/database_cremona_ellcurve-20071019.p0.spkg\n```\n\n\n(It should IMHO also still be in `/packages/optional/`, along with its description, but I get a 404 if I replace `archive` by `optional` above.)\n\n\n\n\nCeterum censeo we should really split the spkg metadata (or Sage part) from its \"real\" contents (data or upstream tarballs), or at least *additionally* provide it in *small* files to be processed without the need to download the full spkgs in advance...",
    "created_at": "2011-10-08T14:36:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127124",
    "user": "leif"
}
```

... or simply print a message instructing the user to instead do

```sh
$ ./sage -i http://sagemath.org/packages/archive/database_cremona_ellcurve-20071019.p0.spkg
```


(It should IMHO also still be in `/packages/optional/`, along with its description, but I get a 404 if I replace `archive` by `optional` above.)




Ceterum censeo we should really split the spkg metadata (or Sage part) from its "real" contents (data or upstream tarballs), or at least *additionally* provide it in *small* files to be processed without the need to download the full spkgs in advance...



---

archive/issue_comments_127125.json:
```json
{
    "body": "Any effort in removing this upgrade which takes more than the few minutes it would take to fix the very minor problem in it would be a complete waste of time.",
    "created_at": "2011-10-09T10:37:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127125",
    "user": "cremona"
}
```

Any effort in removing this upgrade which takes more than the few minutes it would take to fix the very minor problem in it would be a complete waste of time.



---

archive/issue_comments_127126.json:
```json
{
    "body": "Replying to [comment:49 cremona]:\n> Any effort in removing this upgrade which takes more than the few minutes it would take to fix the very minor problem in it would be a complete waste of time.\n\nI fully agree, but unfortunately it's relatively easy to \"unmerge\" this ticket, and it's in general not up to the *release manager* to fix such things (that go beyond simple rebasing, fixing noise, permissions or commit messages etc., which IMHO at least partially already is a *voluntary* service).",
    "created_at": "2011-10-09T15:17:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127126",
    "user": "leif"
}
```

Replying to [comment:49 cremona]:
> Any effort in removing this upgrade which takes more than the few minutes it would take to fix the very minor problem in it would be a complete waste of time.

I fully agree, but unfortunately it's relatively easy to "unmerge" this ticket, and it's in general not up to the *release manager* to fix such things (that go beyond simple rebasing, fixing noise, permissions or commit messages etc., which IMHO at least partially already is a *voluntary* service).



---

archive/issue_comments_127127.json:
```json
{
    "body": "Replying to [comment:50 leif]:\n> Replying to [comment:49 cremona]:\n> > Any effort in removing this upgrade which takes more than the few minutes it would take to fix the very minor problem in it would be a complete waste of time.\n> \n> I fully agree, but unfortunately it's relatively easy to \"unmerge\" this ticket, and it's in general not up to the *release manager* to fix such things (that go beyond simple rebasing, fixing noise, permissions or commit messages etc., which IMHO at least partially already is a *voluntary* service).\n\nOf course -- I just meant that you should do the absolute minimum and not spend effort making the old system more clever. And I just have not had time to fix the patch.",
    "created_at": "2011-10-09T16:25:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127127",
    "user": "cremona"
}
```

Replying to [comment:50 leif]:
> Replying to [comment:49 cremona]:
> > Any effort in removing this upgrade which takes more than the few minutes it would take to fix the very minor problem in it would be a complete waste of time.
> 
> I fully agree, but unfortunately it's relatively easy to "unmerge" this ticket, and it's in general not up to the *release manager* to fix such things (that go beyond simple rebasing, fixing noise, permissions or commit messages etc., which IMHO at least partially already is a *voluntary* service).

Of course -- I just meant that you should do the absolute minimum and not spend effort making the old system more clever. And I just have not had time to fix the patch.



---

archive/issue_comments_127128.json:
```json
{
    "body": "apply over previous patches",
    "created_at": "2011-10-16T18:41:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127128",
    "user": "davidloeffler"
}
```

apply over previous patches



---

archive/issue_comments_127129.json:
```json
{
    "body": "Attachment",
    "created_at": "2011-10-16T18:41:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127129",
    "user": "davidloeffler"
}
```

Attachment



---

archive/issue_comments_127130.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-10-16T18:41:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127130",
    "user": "davidloeffler"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_127131.json:
```json
{
    "body": "Replying to [comment:52 davidloeffler]:\n\nNot tested but David's patch looks perfect and I believe his comment.  Better if someone else test this as David and I use the same machine.\n\nIf this is not merged soon it will become out of date since I have currently reached 198800 and expect to release an extension up to 200k within a week!",
    "created_at": "2011-10-16T19:23:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127131",
    "user": "cremona"
}
```

Replying to [comment:52 davidloeffler]:

Not tested but David's patch looks perfect and I believe his comment.  Better if someone else test this as David and I use the same machine.

If this is not merged soon it will become out of date since I have currently reached 198800 and expect to release an extension up to 200k within a week!



---

archive/issue_comments_127132.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-10-30T00:51:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127132",
    "user": "ohanar"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_127133.json:
```json
{
    "body": "Everything works as expected.\n\n`@`davidloeffler \nI don't think that those lines of code were actually ever used in the old version, since the small database actually included the generators despite the documentation saying otherwise (the new version follows what the documentation specified).\n\n`@`cremona\nI've posted a new spkg with your expanded tables, same location as before.",
    "created_at": "2011-10-30T00:51:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127133",
    "user": "ohanar"
}
```

Everything works as expected.

`@`davidloeffler 
I don't think that those lines of code were actually ever used in the old version, since the small database actually included the generators despite the documentation saying otherwise (the new version follows what the documentation specified).

`@`cremona
I've posted a new spkg with your expanded tables, same location as before.



---

archive/issue_comments_127134.json:
```json
{
    "body": "Replying to [comment:54 ohanar]:\n> Everything works as expected.\n> \n> `@`davidloeffler \n> I don't think that those lines of code were actually ever used in the old version, since the small database actually included the generators despite the documentation saying otherwise (the new version follows what the documentation specified).\n> \n> `@`cremona\n> I've posted a new spkg with your expanded tables, same location as before.\n\nMany thanks to all.  As predicted, the database was updated to go up to 200k a few days ago.",
    "created_at": "2011-10-30T11:21:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127134",
    "user": "cremona"
}
```

Replying to [comment:54 ohanar]:
> Everything works as expected.
> 
> `@`davidloeffler 
> I don't think that those lines of code were actually ever used in the old version, since the small database actually included the generators despite the documentation saying otherwise (the new version follows what the documentation specified).
> 
> `@`cremona
> I've posted a new spkg with your expanded tables, same location as before.

Many thanks to all.  As predicted, the database was updated to go up to 200k a few days ago.



---

archive/issue_comments_127135.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-10-31T11:27:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127135",
    "user": "jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_127136.json:
```json
{
    "body": "I just updated the description to reflect the fact that the optional db now goes up to 200k.",
    "created_at": "2011-11-03T13:55:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127136",
    "user": "cremona"
}
```

I just updated the description to reflect the fact that the optional db now goes up to 200k.



---

archive/issue_comments_127137.json:
```json
{
    "body": "Replying to [comment:54 ohanar]:\n> I've posted a new spkg with your expanded tables, same location as before.\nNot really same location as before, I updated the ticket description.",
    "created_at": "2011-11-03T14:10:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127137",
    "user": "jdemeyer"
}
```

Replying to [comment:54 ohanar]:
> I've posted a new spkg with your expanded tables, same location as before.
Not really same location as before, I updated the ticket description.



---

archive/issue_comments_127138.json:
```json
{
    "body": "Milestone sage-4.7.3 deleted",
    "created_at": "2011-11-03T16:14:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127138",
    "user": "jdemeyer"
}
```

Milestone sage-4.7.3 deleted



---

archive/issue_comments_127139.json:
```json
{
    "body": "I've posted an updated spkg based on Cremona's update to 210000 ([http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111121.spkg](http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111121.spkg)).\n\nI noticed that I never put in a way to install the old spkg for old copies of sage, so I added a recursive `sage -i` for now, until we have a standard that frees the user from downloading two different versions of an spkg. It should work for any version of sage released within the last year, although I haven't tested it super thoroughly (it works with stable 4.7.x, 4.8.alpha3, and 4.3.3.alpha0).",
    "created_at": "2011-11-27T11:36:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127139",
    "user": "ohanar"
}
```

I've posted an updated spkg based on Cremona's update to 210000 ([http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111121.spkg](http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111121.spkg)).

I noticed that I never put in a way to install the old spkg for old copies of sage, so I added a recursive `sage -i` for now, until we have a standard that frees the user from downloading two different versions of an spkg. It should work for any version of sage released within the last year, although I haven't tested it super thoroughly (it works with stable 4.7.x, 4.8.alpha3, and 4.3.3.alpha0).



---

archive/issue_comments_127140.json:
```json
{
    "body": "Replying to [comment:62 ohanar]:\n> I've posted an updated spkg based on Cremona's update to 210000 ([http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111121.spkg](http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111121.spkg)).\nPlease make a new ticket for making this an optional spkg (this ticket is closed).",
    "created_at": "2011-11-27T20:44:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127140",
    "user": "jdemeyer"
}
```

Replying to [comment:62 ohanar]:
> I've posted an updated spkg based on Cremona's update to 210000 ([http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111121.spkg](http://wstein.org/home/ohanar/cremona-database/database_cremona_ellcurve-20111121.spkg)).
Please make a new ticket for making this an optional spkg (this ticket is closed).



---

archive/issue_comments_127141.json:
```json
{
    "body": "Replying to [comment:63 jdemeyer]:\n> Please make a new ticket for making this an optional spkg (this ticket is closed).\nSure, my only reason for posting it in this ticket was due to the unaddressed issue of dealing with old copies of Sage.",
    "created_at": "2011-11-28T02:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127141",
    "user": "ohanar"
}
```

Replying to [comment:63 jdemeyer]:
> Please make a new ticket for making this an optional spkg (this ticket is closed).
Sure, my only reason for posting it in this ticket was due to the unaddressed issue of dealing with old copies of Sage.



---

archive/issue_comments_127142.json:
```json
{
    "body": "Doing a full test after installing the new optional database (onto 4.8.alpha4) I find one doctest failure in devel/sage/doc/en/bordeaux_2008/elliptic_curves.rst:\n\n```\n    sage: E = EllipticCurve([1,2,5,7,17])\n    sage: E.conductor()       # not in the Tables\n    154907\n    sage: E.gens()            # a few seconds\n    [(1 : 3 : 1), (67/4 : 507/8 : 1)]\n```\n\nsince that curve is now in the database and the listed generators are different.  I suggest instead \n\n```\nsage: E = EllipticCurve([0,0,1,-19,60])\nsage: E.conductor()        # not in the Tables\n1129211\nsage: E.gens()             # a few seconds\n[(-5 : 5 : 1), (-4 : 8 : 1), (-15/4 : 67/8 : 1), (-3 : 9 : 1)]\n```\n\n\nShould the ticket be reopened -- this is not an issue in testing without the optional db installed?",
    "created_at": "2011-12-14T14:54:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127142",
    "user": "cremona"
}
```

Doing a full test after installing the new optional database (onto 4.8.alpha4) I find one doctest failure in devel/sage/doc/en/bordeaux_2008/elliptic_curves.rst:

```
    sage: E = EllipticCurve([1,2,5,7,17])
    sage: E.conductor()       # not in the Tables
    154907
    sage: E.gens()            # a few seconds
    [(1 : 3 : 1), (67/4 : 507/8 : 1)]
```

since that curve is now in the database and the listed generators are different.  I suggest instead 

```
sage: E = EllipticCurve([0,0,1,-19,60])
sage: E.conductor()        # not in the Tables
1129211
sage: E.gens()             # a few seconds
[(-5 : 5 : 1), (-4 : 8 : 1), (-15/4 : 67/8 : 1), (-3 : 9 : 1)]
```


Should the ticket be reopened -- this is not an issue in testing without the optional db installed?



---

archive/issue_comments_127143.json:
```json
{
    "body": "Replying to [comment:65 cremona]:\n\n> \n> Should the ticket be reopened -- this is not an issue in testing without the optional db installed?\n\nSee #12184",
    "created_at": "2011-12-18T17:28:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11415",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11415#issuecomment-127143",
    "user": "cremona"
}
```

Replying to [comment:65 cremona]:

> 
> Should the ticket be reopened -- this is not an issue in testing without the optional db installed?

See #12184
