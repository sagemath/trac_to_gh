# Issue 14915: Sage interpreter blocks Tkinter GUI

Issue created by migration from Trac.

Original creator: dunfield

Original creation time: 2013-09-03 23:54:53

CC:  mgoerner culler jdemeyer jhpalmieri leif mstreng nbruin slabbe tscrim vbraun

IPython allows running Tkinter (and many other GUI toolkits) so that the GUI doesn't block the IPython interpreter.  In Sage 5.10 and earlier this worked in Sage's interpreter as well as vanilla IPython.  However, in Sage 5.11 it only works in vanilla IPython.  A minimal example (for both Linux and OS X) is:


```
sage: import Tkinter
sage: root = Tkinter.Tk()
```


Pre version 5.11, this brings up a small window titled "tk"; in Sage 5.11 it does nothing.  In 5.11 you can manually start the Tk gui via:


```
sage: root.mainloop()
```


but you don't get a new interpreter prompt until you quit the Tk GUI.  

I strongly suspect the issue is the new IPython inputhook (in "sage/misc/inputhook.pyx") that was added in Sage 5.11 as part of #14523.



---

Comment by dunfield created at 2013-09-04 00:00:32

I should have mentioned the following work-around in my initial report: 

```
sage: %gui none
```

or what is essentially equivalently 

```
sage: import IPython.lib.inputhook as ih
sage: ih.clear_inputhook()
```

This is why I think the new inputhook is the source of the change in behavior.


---

Comment by slelievre created at 2016-05-30 10:56:45

Cc-ing people from #14523.


---

Comment by vbraun created at 2016-05-30 15:56:38

Changing keywords from "" to "days74".


---

Comment by vbraun created at 2016-05-30 15:56:38

Changing status from new to needs_review.


---

Comment by vbraun created at 2016-05-30 15:56:38

The branch installs the input hook only while files are attached. Hence tkinter can grab it iff you don't have files attached.


---

Comment by git created at 2016-05-30 16:02:43

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2016-05-31 20:15:24

Nice! I guess there should be an explicit warning in the documentation of "attach".


---

Comment by dunfield created at 2016-06-14 19:49:15

I tried out this patch on OS X and everything worked as intended.  Should I set the status to "positive review" or does some documentation need to be added first as Vincent suggests?


---

Comment by vdelecroix created at 2016-06-24 07:49:40

Changing status from needs_review to positive_review.


---

Comment by vdelecroix created at 2016-06-24 07:49:40

Would be better with doc but more importantly this should be in Sage asap.


---

Comment by dunfield created at 2016-06-25 02:07:43

Replying to [comment:11 vdelecroix]:
> Would be better with doc but more importantly this should be in Sage asap.

Agreed.


---

Comment by fbissey created at 2016-06-25 07:35:23

I get 

```
Error building the documentation.
Traceback (most recent call last):
  File "sage_setup/docbuild/__main__.py", line 2, in <module>
    main()
  File "/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/sage_setup/docbuild/__init__.py", line 1629, in main
    builder()
  File "/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/sage_setup/docbuild/__init__.py", line 284, in _wrapper
    getattr(get_builder(document), 'inventory')(*args, **kwds)
  File "/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/sage_setup/docbuild/__init__.py", line 495, in _wrapper
    x.get(99999)
  File "/usr/lib64/python2.7/multiprocessing/pool.py", line 567, in get
    raise self._value
OSError: [repl     ] docstring of sage.repl.inputhook.is_installed:15: WARNING: Block quote ends without a blank line; unexpected unindent.
```



---

Comment by git created at 2016-06-25 08:36:17

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by git created at 2016-06-25 08:36:17

Changing status from positive_review to needs_review.


---

Comment by fbissey created at 2016-06-25 09:12:39

Yes, that fixed it. It looks like commenting on a ticket doesn't add you to cc automatically anymore...


---

Comment by fbissey created at 2016-06-25 09:12:39

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-06-26 07:30:21

Resolution: fixed
