# Issue 31023: update curl to 7.74.0

Issue created by migration from https://trac.sagemath.org/ticket/31260

Original creator: mkoeppe

Original creation time: 2021-01-18 18:21:12

CC:  dimpase mjo slelievre

https://curl.se/download.html


---

Comment by mkoeppe created at 2021-01-18 18:25:05

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2021-01-18 18:25:05

New commits:


---

Comment by dimpase created at 2021-02-09 22:41:03

7.75 has been released few days ago.


---

Comment by mkoeppe created at 2021-03-24 02:04:25

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.


---

Comment by slelievre created at 2021-07-24 14:52:15

Upgrade to curl 7.78.0 on top of Sage 9.4.beta5.
----
New commits:


---

Comment by mkoeppe created at 2021-12-18 19:53:12

Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.


---

Comment by mjo created at 2021-12-21 14:16:57

aand we're up to 7.80 now: https://curl.se/changes.html#7_80_0


---

Comment by mkoeppe created at 2021-12-21 16:33:00

Changing status from needs_review to needs_work.


---

Comment by slelievre created at 2021-12-22 16:11:27

New commits:


---

Comment by slelievre created at 2021-12-22 16:11:27

Changing status from needs_work to needs_review.


---

Comment by slelievre created at 2021-12-22 16:11:27

Changing keywords from "" to "upgrade, curl".


---

Comment by dimpase created at 2021-12-23 15:33:12

Something needs to be changed at the configuration stage. This is what I get on Debian 11.


```
...
[curl-7.80.0] checking dependency style of gcc... gcc3
[curl-7.80.0] checking curl version... 7.80.0
[curl-7.80.0] configure: error: select TLS backend(s) or disable TLS with --without-ssl.
[curl-7.80.0] 
[curl-7.80.0] Select from these:
[curl-7.80.0] 
[curl-7.80.0]   --with-amissl
[curl-7.80.0]   --with-bearssl
[curl-7.80.0]   --with-gnutls
[curl-7.80.0]   --with-mbedtls
[curl-7.80.0]   --with-mesalink
[curl-7.80.0]   --with-nss
[curl-7.80.0]   --with-openssl (also works for BoringSSL and libressl)
[curl-7.80.0]   --with-rustls
[curl-7.80.0]   --with-schannel
[curl-7.80.0]   --with-secure-transport
[curl-7.80.0]   --with-wolfssl
[curl-7.80.0] 
[curl-7.80.0] ****************************************************************************************
[curl-7.80.0] Error configuring curl-7.80.0
...
```



---

Comment by dimpase created at 2021-12-23 15:33:12

Changing status from needs_review to needs_work.


---

Comment by slelievre created at 2021-12-23 15:38:06

I guess it would be `--with-openssl` but
not sure how to make that change.


---

Comment by dimpase created at 2021-12-23 15:48:53


```diff
--- a/build/pkgs/curl/spkg-install.in
+++ b/build/pkgs/curl/spkg-install.in
@@ -15,6 +15,6 @@ if [ "$UNAME" = "Darwin" ]; then
     fi
 fi
 
-sdh_configure $CURL_CONFIGURE
+sdh_configure $CURL_CONFIGURE --with-openssl
 sdh_make
 sdh_make_install
```

makes it work on Debian 11. Whether this works on macOS, not sure, as well as I am not sure whether on macOS it works  without this change.


---

Comment by slelievre created at 2022-03-01 16:37:39

Changing status from needs_work to needs_review.


---

Comment by slelievre created at 2022-03-01 16:37:39

New commits:


---

Comment by mkoeppe created at 2022-03-04 00:00:18

On `debian-buster-minimal` (https://github.com/mkoeppe/sage/runs/5413423156?check_suite_focus=true)

```
configure: error: select TLS backend(s) or disable TLS with --without-ssl.

Select from these:

  --with-amissl
  --with-bearssl
  --with-gnutls
  --with-mbedtls
  --with-mesalink
  --with-nss
  --with-openssl (also works for BoringSSL and libressl)
  --with-rustls
  --with-schannel
  --with-secure-transport
  --with-wolfssl

checking whether to enable maintainer-specific portions of Makefiles... no
```



---

Comment by mkoeppe created at 2022-03-04 00:00:18

Changing status from needs_review to needs_work.


---

Comment by dimpase created at 2022-03-04 12:34:26

New commits:


---

Comment by dimpase created at 2022-03-04 12:34:26

Changing status from needs_work to needs_review.


---

Comment by dimpase created at 2022-03-04 12:35:09

with this patch, `tox -e docker-debian-buster-minimal -- curl` passes.


---

Comment by mkoeppe created at 2022-07-13 17:24:40

update to newer version in #34176


---

Comment by dimpase created at 2022-07-13 20:52:41

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2022-08-02 06:31:03

Resolution: invalid
