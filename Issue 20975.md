# Issue 20975: sage.rings.power_series_poly.PowerSeries_poly.pade, reads out of range

archive/issues_020975.json:
```json
{
    "body": "Keywords: Power Series, pade\n\n\n\n```\nsage: QQx.<x> = QQ[[]]\nsage: (1+x+O(x^100)).pade(2,2)\n---------------------------------------------------------------------------\nIndexError                                Traceback (most recent call last)\n<ipython-input-2-9cb1c03a10fc> in <module>()\n----> 1 (Integer(1)+x+O(x**Integer(100))).pade(Integer(2),Integer(2))\n\n/Applications/sage-7.3/src/sage/rings/power_series_poly.pyx in sage.rings.power_series_poly.PowerSeries_poly.pade (/Applications/sage-7.3/src/build/cythonized/sage/rings/power_series_poly.c:12104)()\n   1120         for i in range(1, n + 1):\n   1121             for j in range(n + 1):\n-> 1122                 mat[i, j] = c[m + i - j]\n   1123         for j in range(n + 1):\n   1124             mat[0, j] = z ** j\n\nIndexError: list index out of range\n```\n\n\nHere is a quick fix:\n\n\n```\nfor i in range(1, n + 1):\n            for j in range(n + 1):\n                if m + i - j < len(c): # new line\n                # or\n                # if m + i - j < self.degree(): \n                    mat[i, j] = c[m + i - j]\n```\n\n\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/21212\n\n",
    "created_at": "2016-08-10T19:26:56Z",
    "labels": [
        "commutative algebra",
        "major",
        "bug"
    ],
    "title": "sage.rings.power_series_poly.PowerSeries_poly.pade, reads out of range",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20975",
    "user": "edgarcosta"
}
```
Keywords: Power Series, pade



```
sage: QQx.<x> = QQ[[]]
sage: (1+x+O(x^100)).pade(2,2)
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-2-9cb1c03a10fc> in <module>()
----> 1 (Integer(1)+x+O(x**Integer(100))).pade(Integer(2),Integer(2))

/Applications/sage-7.3/src/sage/rings/power_series_poly.pyx in sage.rings.power_series_poly.PowerSeries_poly.pade (/Applications/sage-7.3/src/build/cythonized/sage/rings/power_series_poly.c:12104)()
   1120         for i in range(1, n + 1):
   1121             for j in range(n + 1):
-> 1122                 mat[i, j] = c[m + i - j]
   1123         for j in range(n + 1):
   1124             mat[0, j] = z ** j

IndexError: list index out of range
```


Here is a quick fix:


```
for i in range(1, n + 1):
            for j in range(n + 1):
                if m + i - j < len(c): # new line
                # or
                # if m + i - j < self.degree(): 
                    mat[i, j] = c[m + i - j]
```





Issue created by migration from https://trac.sagemath.org/ticket/21212





---

archive/issue_comments_290316.json:
```json
{
    "body": "here is a branch, just missing the result of the added doctest.\n----\nNew commits:",
    "created_at": "2016-08-11T08:05:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290316",
    "user": "chapoton"
}
```

here is a branch, just missing the result of the added doctest.
----
New commits:



---

archive/issue_comments_290317.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2016-08-11T08:05:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290317",
    "user": "chapoton"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_290318.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-11T08:07:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290318",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_290319.json:
```json
{
    "body": "Changing keywords from \"Power Series, pade\" to \"Power Series, pade, sd87\".",
    "created_at": "2017-07-22T03:17:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290319",
    "user": "edgarcosta"
}
```

Changing keywords from "Power Series, pade" to "Power Series, pade, sd87".



---

archive/issue_comments_290320.json:
```json
{
    "body": "Changing status from needs_info to positive_review.",
    "created_at": "2017-07-22T03:17:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290320",
    "user": "edgarcosta"
}
```

Changing status from needs_info to positive_review.



---

archive/issue_comments_290321.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-07-22T10:17:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290321",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_290322.json:
```json
{
    "body": "See patchbot",
    "created_at": "2017-07-22T10:17:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290322",
    "user": "vbraun"
}
```

See patchbot



---

archive/issue_comments_290323.json:
```json
{
    "body": "This was not in \"needs_review\" state, because the raised problem was not actually fixed.",
    "created_at": "2017-07-22T10:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290323",
    "user": "chapoton"
}
```

This was not in "needs_review" state, because the raised problem was not actually fixed.



---

archive/issue_comments_290324.json:
```json
{
    "body": "Ups, that was too late last night. I will fix it.",
    "created_at": "2017-07-22T13:32:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290324",
    "user": "edgarcosta"
}
```

Ups, that was too late last night. I will fix it.



---

archive/issue_comments_290325.json:
```json
{
    "body": "I tried to fix this with some hacks, and I didn't manage, I also believe that there is no point to try to fix this slow algorithm.\n\nI will write a rational reconstruct function using extended gcd for polynomial rings over fields, and pade will call that instead. \n(one can also make everything work over a domain, by temporarily working over the polynomial ring over the fraction field)",
    "created_at": "2017-07-23T19:23:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290325",
    "user": "edgarcosta"
}
```

I tried to fix this with some hacks, and I didn't manage, I also believe that there is no point to try to fix this slow algorithm.

I will write a rational reconstruct function using extended gcd for polynomial rings over fields, and pade will call that instead. 
(one can also make everything work over a domain, by temporarily working over the polynomial ring over the fraction field)



---

archive/issue_comments_290326.json:
```json
{
    "body": "I wrote the rational reconstruct function, see #23534.",
    "created_at": "2017-07-24T16:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290326",
    "user": "edgarcosta"
}
```

I wrote the rational reconstruct function, see #23534.



---

archive/issue_comments_290327.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-07-24T16:21:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290327",
    "user": "edgarcosta"
}
```

New commits:



---

archive/issue_comments_290328.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-07-24T16:21:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290328",
    "user": "edgarcosta"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_290329.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-25T01:38:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290329",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_290330.json:
```json
{
    "body": "Merged to newest with positively reviewed dependency.\n\nLooks good!\n----\nLast 10 new commits:",
    "created_at": "2017-08-25T00:03:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290330",
    "user": "aly.deines"
}
```

Merged to newest with positively reviewed dependency.

Looks good!
----
Last 10 new commits:



---

archive/issue_comments_290331.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-25T00:03:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290331",
    "user": "aly.deines"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_290332.json:
```json
{
    "body": "Changing keywords from \"Power Series, pade, sd87\" to \"Power Series, pade, sd87, days88\".",
    "created_at": "2017-08-25T17:37:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290332",
    "user": "edgarcosta"
}
```

Changing keywords from "Power Series, pade, sd87" to "Power Series, pade, sd87, days88".



---

archive/issue_comments_290333.json:
```json
{
    "body": "Some small doc details; you need these changes to get the correct formatting:\n\n```diff\n-       Check that `trac`:21212 is fixed::\n+       Check that :trac:`21212` is fixed::\n+\n            sage: QQx.<x> = QQ[[]]\n            sage: (1+x+O(x^100)).pade(2,2)\n            x + 1\n```\n",
    "created_at": "2017-08-25T18:32:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290333",
    "user": "tscrim"
}
```

Some small doc details; you need these changes to get the correct formatting:

```diff
-       Check that `trac`:21212 is fixed::
+       Check that :trac:`21212` is fixed::
+
            sage: QQx.<x> = QQ[[]]
            sage: (1+x+O(x^100)).pade(2,2)
            x + 1
```




---

archive/issue_comments_290334.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-08-25T18:32:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290334",
    "user": "tscrim"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_290335.json:
```json
{
    "body": "Fixed\n----\nNew commits:",
    "created_at": "2017-08-25T19:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290335",
    "user": "edgarcosta"
}
```

Fixed
----
New commits:



---

archive/issue_comments_290336.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-08-25T19:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290336",
    "user": "edgarcosta"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_290337.json:
```json
{
    "body": "Changing keywords from \"Power Series, pade, sd87, days88\" to \"Power Series, pade, sd87, days88, IMA coding sprints\".",
    "created_at": "2017-08-25T19:10:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290337",
    "user": "tscrim"
}
```

Changing keywords from "Power Series, pade, sd87, days88" to "Power Series, pade, sd87, days88, IMA coding sprints".



---

archive/issue_comments_290338.json:
```json
{
    "body": "You're missing the colon before `:trac:`. Once fixed, you can set this back to a positive review.",
    "created_at": "2017-08-25T19:10:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290338",
    "user": "tscrim"
}
```

You're missing the colon before `:trac:`. Once fixed, you can set this back to a positive review.



---

archive/issue_comments_290339.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-25T19:13:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290339",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_290340.json:
```json
{
    "body": "Thanks.",
    "created_at": "2017-08-25T19:22:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290340",
    "user": "tscrim"
}
```

Thanks.



---

archive/issue_comments_290341.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-25T19:22:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290341",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_290342.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-09-04T06:11:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20975",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20975#issuecomment-290342",
    "user": "vbraun"
}
```

Resolution: fixed
