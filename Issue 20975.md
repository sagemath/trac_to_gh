# Issue 20975: sage.rings.power_series_poly.PowerSeries_poly.pade, reads out of range

Issue created by migration from Trac.

Original creator: edgarcosta

Original creation time: 2016-08-10 19:26:56

Keywords: Power Series, pade



```
sage: QQx.<x> = QQ[[]]
sage: (1+x+O(x^100)).pade(2,2)
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-2-9cb1c03a10fc> in <module>()
----> 1 (Integer(1)+x+O(x**Integer(100))).pade(Integer(2),Integer(2))

/Applications/sage-7.3/src/sage/rings/power_series_poly.pyx in sage.rings.power_series_poly.PowerSeries_poly.pade (/Applications/sage-7.3/src/build/cythonized/sage/rings/power_series_poly.c:12104)()
   1120         for i in range(1, n + 1):
   1121             for j in range(n + 1):
-> 1122                 mat[i, j] = c[m + i - j]
   1123         for j in range(n + 1):
   1124             mat[0, j] = z ** j

IndexError: list index out of range
```


Here is a quick fix:


```
for i in range(1, n + 1):
            for j in range(n + 1):
                if m + i - j < len(c): # new line
                # or
                # if m + i - j < self.degree(): 
                    mat[i, j] = c[m + i - j]
```






---

Comment by chapoton created at 2016-08-11 08:05:45

here is a branch, just missing the result of the added doctest.
----
New commits:


---

Comment by chapoton created at 2016-08-11 08:05:45

Changing status from new to needs_info.


---

Comment by git created at 2016-08-11 08:07:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by edgarcosta created at 2017-07-22 03:17:05

Changing keywords from "Power Series, pade" to "Power Series, pade, sd87".


---

Comment by edgarcosta created at 2017-07-22 03:17:05

Changing status from needs_info to positive_review.


---

Comment by vbraun created at 2017-07-22 10:17:36

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2017-07-22 10:17:36

See patchbot


---

Comment by chapoton created at 2017-07-22 10:59:03

This was not in "needs_review" state, because the raised problem was not actually fixed.


---

Comment by edgarcosta created at 2017-07-22 13:32:43

Ups, that was too late last night. I will fix it.


---

Comment by edgarcosta created at 2017-07-23 19:23:47

I tried to fix this with some hacks, and I didn't manage, I also believe that there is no point to try to fix this slow algorithm.

I will write a rational reconstruct function using extended gcd for polynomial rings over fields, and pade will call that instead. 
(one can also make everything work over a domain, by temporarily working over the polynomial ring over the fraction field)


---

Comment by edgarcosta created at 2017-07-24 16:04:54

I wrote the rational reconstruct function, see #23534.


---

Comment by edgarcosta created at 2017-07-24 16:21:35

New commits:


---

Comment by edgarcosta created at 2017-07-24 16:21:53

Changing status from needs_work to needs_review.


---

Comment by git created at 2017-07-25 01:38:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by aly.deines created at 2017-08-25 00:03:58

Merged to newest with positively reviewed dependency.

Looks good!
----
Last 10 new commits:


---

Comment by aly.deines created at 2017-08-25 00:03:58

Changing status from needs_review to positive_review.


---

Comment by edgarcosta created at 2017-08-25 17:37:11

Changing keywords from "Power Series, pade, sd87" to "Power Series, pade, sd87, days88".


---

Comment by tscrim created at 2017-08-25 18:32:57

Some small doc details; you need these changes to get the correct formatting:

```diff
-       Check that `trac`:21212 is fixed::
+       Check that :trac:`21212` is fixed::
+
            sage: QQx.<x> = QQ[[]]
            sage: (1+x+O(x^100)).pade(2,2)
            x + 1
```



---

Comment by tscrim created at 2017-08-25 18:32:57

Changing status from positive_review to needs_work.


---

Comment by edgarcosta created at 2017-08-25 19:05:59

Fixed
----
New commits:


---

Comment by edgarcosta created at 2017-08-25 19:05:59

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2017-08-25 19:10:30

Changing keywords from "Power Series, pade, sd87, days88" to "Power Series, pade, sd87, days88, IMA coding sprints".


---

Comment by tscrim created at 2017-08-25 19:10:30

You're missing the colon before `:trac:`. Once fixed, you can set this back to a positive review.


---

Comment by git created at 2017-08-25 19:13:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-08-25 19:22:30

Thanks.


---

Comment by tscrim created at 2017-08-25 19:22:30

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-09-04 06:11:01

Resolution: fixed
