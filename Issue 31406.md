# Issue 31406: tab-completion sometimes access attributes

archive/issues_031406.json:
```json
{
    "body": "CC:  @kliem\n\nIn the following example, the IPython tab completion is trying to access the `__module__` attribute of the object while only trying to complete its name.\n\n```\nsage: cython(\"\"\"\n....: cdef class A(object):\n....:     def __getattr__(self, key):\n....:         print('getattr(key={})'.format(key))\n....:         raise AttributeError\n....: \"\"\")\nsage: a = A()\nsage: my_custom_name = A()\nsage: from IPython import get_ipython\nsage: ip = get_ipython()\nsage: ip.Completer.all_completions(\"my_custo\")\ngetattr(key=__module__)\ngetattr(key=__module__)\n['my_custom_name']\n```\n\nThis is not the case with standard Python classes.\n\nThis has dramatic consequence with lazily imported objects that gets imported when accessing any attribute, including `__module__`. It could even lead to a Sage crash on 9.2.rc3 because of badly designed lazy import\n\n```\nsage: ip.Completer.all_completions(\"s\")                                                                                                                                                        \nTraceback (most recent call last):\n...\nAttributeError: module 'sage.coding.linear_code' has no attribute 'self_orthogonal_binary_codes'\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/31643\n\n",
    "created_at": "2021-04-10T20:09:29Z",
    "labels": [
        "component: misc",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "tab-completion sometimes access attributes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31406",
    "user": "https://github.com/videlec"
}
```
CC:  @kliem

In the following example, the IPython tab completion is trying to access the `__module__` attribute of the object while only trying to complete its name.

```
sage: cython("""
....: cdef class A(object):
....:     def __getattr__(self, key):
....:         print('getattr(key={})'.format(key))
....:         raise AttributeError
....: """)
sage: a = A()
sage: my_custom_name = A()
sage: from IPython import get_ipython
sage: ip = get_ipython()
sage: ip.Completer.all_completions("my_custo")
getattr(key=__module__)
getattr(key=__module__)
['my_custom_name']
```

This is not the case with standard Python classes.

This has dramatic consequence with lazily imported objects that gets imported when accessing any attribute, including `__module__`. It could even lead to a Sage crash on 9.2.rc3 because of badly designed lazy import

```
sage: ip.Completer.all_completions("s")                                                                                                                                                        
Traceback (most recent call last):
...
AttributeError: module 'sage.coding.linear_code' has no attribute 'self_orthogonal_binary_codes'
```


Issue created by migration from https://trac.sagemath.org/ticket/31643





---

archive/issue_events_083347.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-18T16:17:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31406",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31406#event-83347"
}
```



---

archive/issue_events_083348.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-10T17:30:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31406",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31406#event-83348"
}
```



---

archive/issue_events_083349.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-10T17:30:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31406",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31406#event-83349"
}
```



---

archive/issue_events_083350.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31406",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31406#event-83350"
}
```



---

archive/issue_events_083351.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31406",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31406#event-83351"
}
```



---

archive/issue_events_083352.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31406",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31406#event-83352"
}
```



---

archive/issue_events_083353.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31406",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31406#event-83353"
}
```



---

archive/issue_events_083354.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31406",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31406#event-83354"
}
```



---

archive/issue_events_083355.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/31406",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31406#event-83355"
}
```
