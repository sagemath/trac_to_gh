# Issue 14663: Pari's qfminim (flag = 1 or 2) does not allow you to output all vectors. (also documentation improvement)

Issue created by migration from Trac.

Original creator: cturner

Original creation time: 2013-07-08 16:04:40

Assignee: justin

CC:  cremona

Pari's qfminim function (see http://pari.math.u-bordeaux.fr/dochtml/html.stable/Vectors,_matrices,_linear_algebra_and_sets.html for details ) takes an optional flag as a 3rd argument. (This is needed for non-integral quadratic forms). However, currently you can't call qfminim with a 3rd argument without specifying the 2nd argument, which is a limit on the number of vectors returned.

I have written a patch which allows us to set max = -1 which causes all vectors to returned.
I have also improved the documentation for this function somewhat.


---

Comment by cremona created at 2013-07-08 19:10:17

Can you edit the docstring's INPUT section so that all the input parameters are listed (together with what they mean), and have an OUTPUT section after that?  Currently they are a bit mixed up.  (Surely the meaning of input param. B is that all vectors of norm <= B are returned, not =B?)

Also the indentation looks wrong in the changed line of code.

I'll come back and review this again when these are fixed!


---

Comment by cremona created at 2013-07-09 15:12:35

Changing component from quadratic forms to interfaces.


---

Comment by cremona created at 2013-07-09 15:12:35

Changing status from new to needs_review.


---

Comment by cremona created at 2013-07-09 15:12:35

Changing keywords from "" to "quadratic forms".


---

Comment by cremona created at 2013-07-09 15:12:35

As second author, I corrected the formatting of the docstring (so running sage -docbuild reference html gives no warnings) and also added some examples.


---

Comment by rlm created at 2013-07-10 18:39:23

All tests pass when applied against sage-5.10.

My one nitpick is that the documentation uses both "length" and "square norm" to describe the role of B.


---

Comment by cremona created at 2013-07-10 19:47:55

Replying to [comment:5 rlm]:
> All tests pass when applied against sage-5.10.
> 
> My one nitpick is that the documentation uses both "length" and "square norm" to describe the role of B. 
Good point.  I changed both to just "norm" which seems clear and unambiguous.  Corrected patch in a second.


---

Comment by cremona created at 2013-07-10 19:48:39

Replaces previous


---

Comment by rlm created at 2013-07-10 22:47:39

Changing status from needs_review to positive_review.


---

Attachment

Looks good!


---

Comment by davidloeffler created at 2013-07-24 22:35:33

Apply trac_14867_qfminim1.patch​

(for patchbot)


---

Comment by jdemeyer created at 2013-08-16 20:51:15

On 32-bit systems:

```
sage -t --long devel/sage/sage/libs/pari/gen.pyx
**********************************************************************
File "devel/sage/sage/libs/pari/gen.pyx", line 8362, in sage.libs.pari.gen.gen.qfminim
Failed example:
    pari(A.change_ring(RR)).qfminim(5,max=5,flag=2).python()
Expected:
    [
                                                 [ -5 -10  -2  -7   3]
                                                 [  1   2   1   2   0]
    10, 5.0000000002328306436538696289062500000, [  1   2   0   1  -1]
    ]
Got:
    [
                             [ -5 -10  -2  -7   3]
                             [  1   2   1   2   0]
    10, 5.00000000023283064, [  1   2   0   1  -1]
    ]
**********************************************************************
```



---

Comment by jdemeyer created at 2013-08-16 20:51:15

Changing status from positive_review to needs_work.


---

Comment by cremona created at 2013-08-17 11:12:09

This will be easy to fix by having separate 32/64-bit outputs as with numerous other pari library tests.


---

Comment by jdemeyer created at 2014-01-29 16:11:38

New commits:


---

Comment by jdemeyer created at 2014-01-29 16:11:38

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2014-01-29 16:13:15

I mostly just applied the documentation changes from [attachment:trac_14867_qfminim1.patch​] (the code was already changed in #15760) and made a few more changes (you could consider these as reviewer changes).


---

Comment by jdemeyer created at 2014-02-03 09:28:25

Any reviewers please?


---

Comment by cremona created at 2014-02-03 09:34:42

I'm looking at it.  The chenges look good but I cannot checkout the branch for some reason:

```
$ ./sage -dev checkout --ticket=u/jdemeyer/ticket/14867
Ticket name "u/jdemeyer/ticket/14867" is not valid or ticket does not exist on trac.
```

This is the usual way I check out tickets to reivew and worked before.  I have not yet tried a manual git checkout.


---

Comment by cremona created at 2014-02-03 12:25:17

Manual checkout worked fine, testing now.  Perhaps I should report that failure of sage -dev.


---

Comment by cremona created at 2014-02-03 19:35:28

Replying to [comment:18 cremona]:
> I'm looking at it.  The chenges look good but I cannot checkout the branch for some reason:
> {{{
> $ ./sage -dev checkout --ticket=u/jdemeyer/ticket/14867
> Ticket name "u/jdemeyer/ticket/14867" is not valid or ticket does not exist on trac.
> }}}

For the record: that should have been 

```
 ./sage -dev checkout --ticket=14867
```


> This is the usual way I check out tickets to reivew and worked before.  I have not yet tried a manual git checkout.


---

Comment by cremona created at 2014-02-03 19:36:16

Looks good to me.


---

Comment by cremona created at 2014-02-03 19:36:16

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-02-07 00:49:55

Resolution: fixed
