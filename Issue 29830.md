# Issue 29830: gfortran spkg-configure: Reject versions >= 10

Issue created by migration from https://trac.sagemath.org/ticket/30067

Original creator: mkoeppe

Original creation time: 2020-07-04 22:37:21

CC:  dimpase bump mjo jhpalmieri fbissey

We already reject gcc 10, but if gfortran is installed separately, we also have to check that version.


---

Comment by dimpase created at 2020-07-05 08:50:33

just make sure it is possible to override with 

```
./configure --with-gfortran=
```

hmm, should it be with

```
./configure FC=
```


I am confused here


---

Comment by mkoeppe created at 2020-07-12 18:12:18

It can be overridden by `./configure --without-system-gfortran`.


---

Comment by slelievre created at 2020-07-12 21:53:04

If Homebrew is detected, should we check for `gfortran-9`
and recommend installing it via `brew install gcc`@`9`?


---

Comment by mkoeppe created at 2020-07-15 01:54:43

I hope that we can get #29456 working...


---

Comment by mkoeppe created at 2020-07-15 02:32:54

Changing priority from critical to blocker.


---

Comment by mkoeppe created at 2020-07-15 02:32:54

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2020-07-15 02:32:54

New commits:


---

Comment by dimpase created at 2020-07-15 11:05:20

where is the list

```
AC_PROG_FC([gfortran-9 gfortran g95 xlf95 f95 fort ifort ifc efc pgfortran pgf95 lf95 ftn nagfor xlf90 f90 pgf90 pghpf epcf90 g77 xlf f77 frt pgf77 cf77 fort77 fl32 af77])
```

coming from? I know that Sage sort of works with `flang`, which is not on the list  -not sure if `g95` and other old stuff listed  still works...


---

Comment by mkoeppe created at 2020-07-15 14:26:17

I put "gfortran-9" in front of the autoconf 2.69 default


---

Comment by dimpase created at 2020-07-15 15:51:59

by the way, a new Autotools beta version has been released, they promise 2.70 in 3 months. Time to submit bugs we know?


---

Comment by mjo created at 2020-07-15 17:17:11

Replying to [comment:11 dimpase]:
> by the way, a new Autotools beta version has been released, they promise 2.70 in 3 months. Time to submit bugs we know?

Once the beta is available in Gentoo (https://bugs.gentoo.org/732648) I'll start building sage with it to make sure there are no new problems.


---

Comment by git created at 2020-07-16 02:15:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2020-07-16 07:25:05

Replying to [comment:10 mkoeppe]:
> I put "gfortran-9" in front of the autoconf 2.69 default 

could you add `flang` and `lfortran` there too, just in case?


---

Comment by mkoeppe created at 2020-07-16 07:27:56

That's not within the scope of this ticket.


---

Comment by dimpase created at 2020-07-16 16:49:27

can we see tests on GH Actions?


---

Comment by mkoeppe created at 2020-07-16 18:19:59

Tests run in https://github.com/mkoeppe/sage/actions/runs/171722885


---

Comment by mkoeppe created at 2020-07-17 05:54:21

this can be seen in action for `local-homebrew-macos-standard`
at https://github.com/mkoeppe/sage/runs/878896230

```
-----------------------------------------------------------------------------
Checking whether SageMath should install SPKG gfortran...
checking the version of gfortran-9... 9.3.0
configure: will use system package and not install SPKG gfortran
-----------------------------------------------------------------------------
```



---

Comment by mkoeppe created at 2020-07-17 05:57:26

... and for `fedora-32-standard` at https://github.com/mkoeppe/sage/runs/878897518

```
Checking whether SageMath should install SPKG gfortran...
checking the version of gfortran... 10
configure: Installing gfortran because gfortran is version 10, which is too recent for this version of Sage
configure: no suitable system package found for SPKG gfortran
```

(though it does not really make a difference because it had already discovered that gcc is too new)


---

Comment by dimpase created at 2020-07-17 07:40:50

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2020-07-17 07:40:50

lgtm


---

Comment by mkoeppe created at 2020-07-17 16:52:08

Thanks!


---

Comment by vbraun created at 2020-07-25 22:51:33

Resolution: fixed


---

Comment by slelievre created at 2020-08-02 23:51:17

Replying to [comment:15 mkoeppe]:
> Replying to [comment:14 dimpase]:
> > could you add `flang` and `lfortran` there too, just in case?
> That's not within the scope of this ticket.

Is there a ticket for that?


---

Comment by mkoeppe created at 2020-08-03 20:08:06

#23926?
