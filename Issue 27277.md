# Issue 27277: Cygwin docbuild fails

archive/issues_027277.json:
```json
{
    "body": "CC:  @embray @jdemeyer\n\nThis is on the cygwin buildbot:\n\n```\n**********************************************************************\nFile \"src/sage_setup/docbuild/__init__.py\", line 105, in sage_setup.docbuild.builder_helper\nFailed example:\n    build_many(build_ref_doc, [(\"docname\", \"en\", \"html\", {})])\nExpected:\n    Traceback (most recent call last):\n    ...\n    Exception: ('Non-exception during docbuild: abort pool operation', BaseException('abort pool operation',))\nGot:\n    Process Process-3733:1:\n    Traceback (most recent call last):\n      File \"/home/Admin/sage-buildbot-worker/sage_git/build/local/lib/python2.7/multiprocessing/process.py\", line 267, in _bootstrap\n        self.run()\n      File \"/home/Admin/sage-buildbot-worker/sage_git/build/local/lib/python2.7/multiprocessing/process.py\", line 114, in run\n        self._target(*self._args, **self._kwargs)\n      File \"/home/Admin/sage-buildbot-worker/sage_git/build/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 80, in build_ref_doc\n        getattr(ReferenceSubBuilder(doc, lang), format)(*args, **kwds)\n      File \"/home/Admin/sage-buildbot-worker/sage_git/build/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 763, in _wrapper\n        getattr(DocBuilder, build_type)(self, *args, **kwds)\n      File \"/home/Admin/sage-buildbot-worker/sage_git/build/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 145, in f\n        raise Exception(\"Non-exception during docbuild: %s\"%(e,), e)\n    Exception: ('Non-exception during docbuild: abort pool operation', BaseException('abort pool operation',))\n    Traceback (most recent call last):\n      File \"/home/Admin/sage-buildbot-worker/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/Admin/sage-buildbot-worker/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage_setup.docbuild.builder_helper[7]>\", line 1, in <module>\n        build_many(build_ref_doc, [(\"docname\", \"en\", \"html\", {})])\n      File \"/home/Admin/sage-buildbot-worker/sage_git/build/local/lib/python2.7/site-packages/sage_setup/docbuild/utils.py\", line 214, in _build_many\n        raise worker_exc\n    WorkerDiedException: worker for ('docname', 'en', 'html', {}) died with non-zero exit code 1\n**********************************************************************\n1 item had failures:\n   1 of  10 in sage_setup.docbuild.builder_helper\n    [36 tests, 1 failure, 2.33 s]\n----------------------------------------------------------------------\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/27514\n\n",
    "created_at": "2019-03-19T21:28:18Z",
    "labels": [
        "component: build",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Cygwin docbuild fails",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27277",
    "user": "https://github.com/vbraun"
}
```
CC:  @embray @jdemeyer

This is on the cygwin buildbot:

```
**********************************************************************
File "src/sage_setup/docbuild/__init__.py", line 105, in sage_setup.docbuild.builder_helper
Failed example:
    build_many(build_ref_doc, [("docname", "en", "html", {})])
Expected:
    Traceback (most recent call last):
    ...
    Exception: ('Non-exception during docbuild: abort pool operation', BaseException('abort pool operation',))
Got:
    Process Process-3733:1:
    Traceback (most recent call last):
      File "/home/Admin/sage-buildbot-worker/sage_git/build/local/lib/python2.7/multiprocessing/process.py", line 267, in _bootstrap
        self.run()
      File "/home/Admin/sage-buildbot-worker/sage_git/build/local/lib/python2.7/multiprocessing/process.py", line 114, in run
        self._target(*self._args, **self._kwargs)
      File "/home/Admin/sage-buildbot-worker/sage_git/build/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 80, in build_ref_doc
        getattr(ReferenceSubBuilder(doc, lang), format)(*args, **kwds)
      File "/home/Admin/sage-buildbot-worker/sage_git/build/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 763, in _wrapper
        getattr(DocBuilder, build_type)(self, *args, **kwds)
      File "/home/Admin/sage-buildbot-worker/sage_git/build/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 145, in f
        raise Exception("Non-exception during docbuild: %s"%(e,), e)
    Exception: ('Non-exception during docbuild: abort pool operation', BaseException('abort pool operation',))
    Traceback (most recent call last):
      File "/home/Admin/sage-buildbot-worker/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/Admin/sage-buildbot-worker/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage_setup.docbuild.builder_helper[7]>", line 1, in <module>
        build_many(build_ref_doc, [("docname", "en", "html", {})])
      File "/home/Admin/sage-buildbot-worker/sage_git/build/local/lib/python2.7/site-packages/sage_setup/docbuild/utils.py", line 214, in _build_many
        raise worker_exc
    WorkerDiedException: worker for ('docname', 'en', 'html', {}) died with non-zero exit code 1
**********************************************************************
1 item had failures:
   1 of  10 in sage_setup.docbuild.builder_helper
    [36 tests, 1 failure, 2.33 s]
----------------------------------------------------------------------
```


Issue created by migration from https://trac.sagemath.org/ticket/27514





---

archive/issue_comments_384082.json:
```json
{
    "body": "I'm not sure what to even do about this test since it's not applicable to the new `build_many` code.  This test is a regression test for behavior specific to `multiprocessing.Pool.map`.",
    "created_at": "2019-03-20T08:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27277#issuecomment-384082",
    "user": "https://github.com/embray"
}
```

I'm not sure what to even do about this test since it's not applicable to the new `build_many` code.  This test is a regression test for behavior specific to `multiprocessing.Pool.map`.



---

archive/issue_comments_384083.json:
```json
{
    "body": "Fixes the issue with a small bit of refactoring to ensure that the test in question is always actually testing the `build_many` implementation to which it applies.\n----\nNew commits:",
    "created_at": "2019-04-17T10:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27277#issuecomment-384083",
    "user": "https://github.com/embray"
}
```

Fixes the issue with a small bit of refactoring to ensure that the test in question is always actually testing the `build_many` implementation to which it applies.
----
New commits:



---

archive/issue_comments_384084.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-04-17T10:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27277#issuecomment-384084",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_384085.json:
```json
{
    "body": "Ping?",
    "created_at": "2019-06-12T09:40:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27277#issuecomment-384085",
    "user": "https://github.com/embray"
}
```

Ping?



---

archive/issue_comments_384086.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-06-12T17:17:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27277#issuecomment-384086",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_384087.json:
```json
{
    "body": "Thank you!",
    "created_at": "2019-06-13T08:43:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27277#issuecomment-384087",
    "user": "https://github.com/embray"
}
```

Thank you!



---

archive/issue_comments_384088.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-06-27T20:13:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27277#issuecomment-384088",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_384089.json:
```json
{
    "body": "Not in Sage 8.8.  Let's please to try keep tickets' milestones related to the release in which we actually intend to include them, and in particular the release in which they were *actually* included, especially when closing tickets.",
    "created_at": "2019-07-03T11:34:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27277#issuecomment-384089",
    "user": "https://github.com/embray"
}
```

Not in Sage 8.8.  Let's please to try keep tickets' milestones related to the release in which we actually intend to include them, and in particular the release in which they were *actually* included, especially when closing tickets.
