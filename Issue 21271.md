# Issue 21271: Clean up src/setup.py

Issue created by migration from Trac.

Original creator: mkoeppe

Original creation time: 2016-09-16 17:55:02

CC:  jdemeyer vbraun embray leif fbissey was mmezzarobba dimpase jhpalmieri

... so that everything is done within the call to `setup`, not before it.

In particular, `src/setup.py --help` should return immediately.


---

Comment by jdemeyer created at 2016-09-16 17:59:10

Changing type from defect to task.


---

Comment by embray created at 2016-09-26 10:53:29

> and everything that is now done by make clean should be done by it

By which you mean the makefile in `src/` right?


---

Comment by mkoeppe created at 2016-09-26 14:54:29

Yes -- I've clarified it in the description.


---

Comment by embray created at 2016-09-29 15:23:34

Definitely keep in touch with me as a point of contact on any work you do on this--I know distutils + setuptools from top to bottom.


---

Comment by mkoeppe created at 2016-09-29 17:59:54

Let me just say that I consider #21613 not an important step towards this task ("... standard distutils behavior"). The present task ticket (#21508) is concerned with getting the _behavior_ of `setup.py` standard (how does it respond to standard commands and options), not necessarily its _implementation_. The fact that `setup.py` with #21480 invokes `make` is an implementation detail, which is not very relevant for the goal of #21507.


---

Comment by embray created at 2016-09-30 09:55:51

Except it is pretty non-standard for it to have non-trivial side-effects (e.g. running a subprocess that generates files) unconditionally.  Behavior-wise that should only happen when it's actually important for that to happen, such as during the build command.


---

Comment by mkoeppe created at 2016-09-30 19:16:51

Replying to [comment:16 embray]:
> Except it is pretty non-standard for it to have non-trivial side-effects (e.g. running a subprocess that generates files) unconditionally.  Behavior-wise that should only happen when it's actually important for that to happen, such as during the build command.

I agree that it should happen during the build command.


---

Comment by embray created at 2016-10-04 12:23:55

I will work on #21613, and you'll see it's not that big a deal.


---

Comment by jdemeyer created at 2016-10-04 12:56:51

Replying to [comment:18 embray]:
> I will work on #21613, and you'll see it's not that big a deal.

Beware of conflicts with other tickets, in particular #21600 and its dependencies.


---

Comment by embray created at 2016-10-04 13:08:01

Yep.  I don't think there will be significant conflicts, but I can make those tickets dependencies of #21613 and ensure any work I do there integrates well with the others before suggesting it to be merged.


---

Comment by mkoeppe created at 2021-03-24 02:04:25

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.
