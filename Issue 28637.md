# Issue 28637: Meaningful errors for immutable graphs

Issue created by migration from https://trac.sagemath.org/ticket/28874

Original creator: @kliem

Original creation time: 2019-12-12 13:03:55

CC:  dimpase

Keywords: graphs, immutable, error messages

Currently, immutable graphs have meaningless error messages, e.g.


```
sage: G = Graph(immutable=True)
sage: G.add_edge(1,2)
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-6-86491c12b8ed> in <module>()
----> 1 G.add_edge(Integer(1),Integer(2))

/srv/public/shared/sage-8.9/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in add_edge(self, u, v, label)
  10834                     pass
  10835 
> 10836         self._backend.add_edge(u, v, label, self._directed)
  10837 
  10838     def add_edges(self, edges, loops=True):

/srv/public/shared/sage-8.9/local/lib/python2.7/site-packages/sage/graphs/base/graph_backends.pyx in sage.graphs.base.graph_backends.GenericGraphBackend.add_edge (build/cythonized/sage/graphs/base/graph_backends.c:1693)()
    101             NotImplementedError
    102          """
--> 103         raise NotImplementedError()
    104 
    105     def add_edges(self, edges, directed):

NotImplementedError: 
```


This might make it hard to figure out the underlying problem, e.g. when a cached method returns an immutable graph and the user isn't aware of it.

We add methods to the static sparse backend, that give an error just like is done for matrices or vectors


```
ValueError: graph is immutable; please change a copy instead (use function copy())
```


We also replace the old messages

```
ValueError: thou shalt not add a vertex to an immutable graph
```

for the one that points out a resolution for the user.


---

Comment by @kliem created at 2019-12-12 13:04:54

Changing status from new to needs_review.


---

Comment by @kliem created at 2019-12-12 13:04:54

New commits:


---

Comment by tscrim created at 2019-12-13 03:58:16

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2019-12-13 03:58:16

LGTM.


---

Comment by vbraun created at 2019-12-17 22:46:34

Resolution: fixed
