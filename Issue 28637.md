# Issue 28637: Meaningful errors for immutable graphs

archive/issues_028637.json:
```json
{
    "body": "CC:  @dimpase\n\nKeywords: graphs, immutable, error messages\n\nCurrently, immutable graphs have meaningless error messages, e.g.\n\n\n```\nsage: G = Graph(immutable=True)\nsage: G.add_edge(1,2)\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n<ipython-input-6-86491c12b8ed> in <module>()\n----> 1 G.add_edge(Integer(1),Integer(2))\n\n/srv/public/shared/sage-8.9/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in add_edge(self, u, v, label)\n  10834                     pass\n  10835 \n> 10836         self._backend.add_edge(u, v, label, self._directed)\n  10837 \n  10838     def add_edges(self, edges, loops=True):\n\n/srv/public/shared/sage-8.9/local/lib/python2.7/site-packages/sage/graphs/base/graph_backends.pyx in sage.graphs.base.graph_backends.GenericGraphBackend.add_edge (build/cythonized/sage/graphs/base/graph_backends.c:1693)()\n    101             NotImplementedError\n    102          \"\"\"\n--> 103         raise NotImplementedError()\n    104 \n    105     def add_edges(self, edges, directed):\n\nNotImplementedError: \n```\n\n\nThis might make it hard to figure out the underlying problem, e.g. when a cached method returns an immutable graph and the user isn't aware of it.\n\nWe add methods to the static sparse backend, that give an error just like is done for matrices or vectors\n\n\n```\nValueError: graph is immutable; please change a copy instead (use function copy())\n```\n\n\nWe also replace the old messages\n\n```\nValueError: thou shalt not add a vertex to an immutable graph\n```\n\nfor the one that points out a resolution for the user.\n\nIssue created by migration from https://trac.sagemath.org/ticket/28874\n\n",
    "created_at": "2019-12-12T13:03:55Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "Meaningful errors for immutable graphs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28637",
    "user": "https://github.com/kliem"
}
```
CC:  @dimpase

Keywords: graphs, immutable, error messages

Currently, immutable graphs have meaningless error messages, e.g.


```
sage: G = Graph(immutable=True)
sage: G.add_edge(1,2)
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-6-86491c12b8ed> in <module>()
----> 1 G.add_edge(Integer(1),Integer(2))

/srv/public/shared/sage-8.9/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in add_edge(self, u, v, label)
  10834                     pass
  10835 
> 10836         self._backend.add_edge(u, v, label, self._directed)
  10837 
  10838     def add_edges(self, edges, loops=True):

/srv/public/shared/sage-8.9/local/lib/python2.7/site-packages/sage/graphs/base/graph_backends.pyx in sage.graphs.base.graph_backends.GenericGraphBackend.add_edge (build/cythonized/sage/graphs/base/graph_backends.c:1693)()
    101             NotImplementedError
    102          """
--> 103         raise NotImplementedError()
    104 
    105     def add_edges(self, edges, directed):

NotImplementedError: 
```


This might make it hard to figure out the underlying problem, e.g. when a cached method returns an immutable graph and the user isn't aware of it.

We add methods to the static sparse backend, that give an error just like is done for matrices or vectors


```
ValueError: graph is immutable; please change a copy instead (use function copy())
```


We also replace the old messages

```
ValueError: thou shalt not add a vertex to an immutable graph
```

for the one that points out a resolution for the user.

Issue created by migration from https://trac.sagemath.org/ticket/28874





---

archive/issue_comments_403909.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-12-12T13:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28637#issuecomment-403909",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_403910.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-12-12T13:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28637#issuecomment-403910",
    "user": "https://github.com/kliem"
}
```

New commits:



---

archive/issue_comments_403911.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-12-13T03:58:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28637#issuecomment-403911",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_403912.json:
```json
{
    "body": "LGTM.",
    "created_at": "2019-12-13T03:58:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28637#issuecomment-403912",
    "user": "https://github.com/tscrim"
}
```

LGTM.



---

archive/issue_comments_403913.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-12-17T22:46:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28637#issuecomment-403913",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_026487.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2019-12-17T22:46:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28637",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28637#event-26487"
}
```
