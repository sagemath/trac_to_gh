# Issue 34544: activate E275 in pycodestyle-minimal

Issue created by migration from https://trac.sagemath.org/ticket/34781

Original creator: chapoton

Original creation time: 2022-11-23 18:15:39




---

Comment by chapoton created at 2022-11-23 18:17:35

Changing status from new to needs_review.


---

Comment by chapoton created at 2022-11-23 18:17:35

New commits:


---

Comment by mkoeppe created at 2022-11-23 20:05:00


```
310     E275 missing whitespace after keyword
1       E306 expected 1 blank line before a nested definition, found 0
6       W391 blank line at end of file
```



---

Comment by mkoeppe created at 2022-11-23 20:05:00

Changing status from needs_review to needs_work.


---

Comment by git created at 2022-11-24 07:56:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2022-11-24 07:57:32

strange, but then let us keep that for later and just fix the linter again here


---

Comment by chapoton created at 2022-11-24 07:57:32

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2022-11-24 08:24:25

Why are we removing the one blank line at the end of files? The description of W261 does not match its example. Its "best practice" has zero blank lines and removing these from the files in this change means they have none. If they are doing some other kind of counting, then it makes no sense to have zero "blank lines". I am quite confused by this.


---

Comment by git created at 2022-11-24 08:26:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2022-11-24 10:53:53

Replying to [comment:6 Travis Scrimshaw]:
> Why are we removing the one blank line at the end of files? The description of W261 does not match its example. Its "best practice" has zero blank lines and removing these from the files in this change means they have none. If they are doing some other kind of counting, then it makes no sense to have zero "blank lines". I am quite confused by this.

W391

https://www.flake8rules.com/rules/W391.html


---

Comment by chapoton created at 2022-11-24 10:54:53

but indeed the description is faulty

the good thing is to end by one line break, but no empty lines


---

Comment by tscrim created at 2022-11-24 11:10:25

It's not just faulty, it doesn't even satisfy it's own logic. If it ends with a line break, then by definition, there is a blank line. Otherwise there is no line break at the end. If the end of the last line counts (again, what line break?), then how could there possibly be zero?

The general standard, as I understand it, is to have a blank line. This is what they are claiming too. They have a bug in their implementation with a false example IMO.


---

Comment by chapoton created at 2022-11-24 11:13:20

maybe there is a confusion with "empty" meaning "no characters at all" or "just a bunch of spaces" ? There should be a line break, followed (and preceded) by no spaces.


---

Comment by tscrim created at 2022-11-24 11:17:50

But again, a line break would mean we have a blank line. If what they meant was any type of whitespace, then it would be zero.

Having exactly one line break means

```
Something\n
<blankline><EOF>
```

Otherwise there would be zero for

```
Something<EOF>
```



---

Comment by mkoeppe created at 2022-11-24 20:09:20

Replying to [comment:6 Travis Scrimshaw]:
> I am quite confused by this.

Yes.

- `Text\n`, then EOF -- good.
- `Text`, then EOF -- ungood - non-terminated line at EOF.
- `Text\n\n`, then EOF -- ungood - empty line before EOF.
- `Text\n \n`, then EOF -- ungood - line with trailing space.
- `Text\n `, then EOF -- plus ungood - line with trailing space, non-terminated.


---

Comment by mkoeppe created at 2022-11-24 20:14:49

I would suggest not to make style changes like this:

```
-      if a == id_anyon:
-          if x == b and y == d:
-              return 1
-          else:
-              return 0
+    if a == id_anyon:
+        return 1 if x == b and y == d else 0
```

I don't think it's universally agreed that this would be an improvement. Personally, I never use `if-else` expressions and I find them harder to read.


---

Comment by chapoton created at 2022-11-25 08:59:31

maybe this debatable cosmetic change should not prevent to fix the linter as soon as possible ?


---

Comment by lorenz created at 2022-11-26 02:53:46

Replying to [comment:15 Matthias Köppe]:
> {{{
> -      if a == id_anyon:
> -          if x == b and y == d:
> -              return 1
> -          else:
> -              return 0
> +    if a == id_anyon:
> +        return 1 if x == b and y == d else 0
> }}}

How about `int(x == b and y == d)`?


---

Comment by git created at 2022-11-26 07:18:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2022-11-26 07:21:53

voilà, done


---

Comment by mkoeppe created at 2022-11-27 00:16:07

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2022-12-11 14:51:12

Changing priority from minor to major.


---

Comment by vbraun created at 2022-12-14 22:11:59

Resolution: fixed
