# Issue 28140: polymake interface broken with "non-standard" quadratic fields

archive/issues_028140.json:
```json
{
    "body": "CC:  mkoeppe slabbe simonking jipilab\n\nThe polymake interface is confused with Sage number fields that are not of the form `QQ[sqrt(D)]`. Here is a simple example\n\n```\nsage: x = polygen(QQ, 'x')\nsage: K = NumberField(x^2 - x -1, 'a', embedding=(1-AA(5).sqrt())/2)\nsage: a = K.gen()\nsage: L = NumberField(x^2 - 5, 'b', embedding=AA(5).sqrt())\nsage: b = L.gen()\nsage: f = Hom(K, L)([(1-b)/2])\nsage: Kverts = [(0,0,a),(1,a,2-a),(2*a,3,1),(2-a,5+2*a,3*a-7),(-3,2*a-1,-1),(1,a,a)]\nsage: Lverts = [list(map(f, v)) for v in Kverts]\nsage: Polyhedron(Kverts, base_ring=K, backend='polymake').f_vector()\n(1, 6, 12, 8, 1)\nsage: Polyhedron(Lverts, base_ring=L, backend='polymake').f_vector()\n(1, 5, 9, 6, 1)\n```\n\nOne can check that it is the second one which is correct\n\n```\nsage: Polyhedron(Kverts, base_ring=K, backend='field').f_vector()\n(1, 5, 9, 6, 1)\nsage: Polyhedron(Lverts, base_ring=L, backend='field').f_vector()\n(1, 5, 9, 6, 1)\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/28377\n\n",
    "created_at": "2019-08-21T17:13:00Z",
    "labels": [
        "geometry",
        "major",
        "bug"
    ],
    "title": "polymake interface broken with \"non-standard\" quadratic fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28140",
    "user": "vdelecroix"
}
```
CC:  mkoeppe slabbe simonking jipilab

The polymake interface is confused with Sage number fields that are not of the form `QQ[sqrt(D)]`. Here is a simple example

```
sage: x = polygen(QQ, 'x')
sage: K = NumberField(x^2 - x -1, 'a', embedding=(1-AA(5).sqrt())/2)
sage: a = K.gen()
sage: L = NumberField(x^2 - 5, 'b', embedding=AA(5).sqrt())
sage: b = L.gen()
sage: f = Hom(K, L)([(1-b)/2])
sage: Kverts = [(0,0,a),(1,a,2-a),(2*a,3,1),(2-a,5+2*a,3*a-7),(-3,2*a-1,-1),(1,a,a)]
sage: Lverts = [list(map(f, v)) for v in Kverts]
sage: Polyhedron(Kverts, base_ring=K, backend='polymake').f_vector()
(1, 6, 12, 8, 1)
sage: Polyhedron(Lverts, base_ring=L, backend='polymake').f_vector()
(1, 5, 9, 6, 1)
```

One can check that it is the second one which is correct

```
sage: Polyhedron(Kverts, base_ring=K, backend='field').f_vector()
(1, 5, 9, 6, 1)
sage: Polyhedron(Lverts, base_ring=L, backend='field').f_vector()
(1, 5, 9, 6, 1)
```


Issue created by migration from https://trac.sagemath.org/ticket/28377





---

archive/issue_comments_397427.json:
```json
{
    "body": "Je n'ai pas ajout\u00e9 le bon Labb\u00e9! D\u00e9sol\u00e9 S\u00e9bastien pour le spam.",
    "created_at": "2019-08-21T17:45:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28140#issuecomment-397427",
    "user": "vdelecroix"
}
```

Je n'ai pas ajouté le bon Labbé! Désolé Sébastien pour le spam.



---

archive/issue_comments_397428.json:
```json
{
    "body": "no comment on the previous implementation!!\n----\nNew commits:",
    "created_at": "2019-08-21T19:18:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28140#issuecomment-397428",
    "user": "vdelecroix"
}
```

no comment on the previous implementation!!
----
New commits:



---

archive/issue_comments_397429.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-08-21T19:18:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28140#issuecomment-397429",
    "user": "vdelecroix"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_397430.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-08-21T19:19:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28140#issuecomment-397430",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_397431.json:
```json
{
    "body": "Looks good to me. \n\nI am hesitating to put a test on one of the observed wrong f-vector, but if you confirm that this fixes the observed symptom on the f-vector, then I would say it is fine.",
    "created_at": "2019-08-22T10:29:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28140#issuecomment-397431",
    "user": "jipilab"
}
```

Looks good to me. 

I am hesitating to put a test on one of the observed wrong f-vector, but if you confirm that this fixes the observed symptom on the f-vector, then I would say it is fine.



---

archive/issue_comments_397432.json:
```json
{
    "body": "Replying to [comment:8 jipilab]:\n> Looks good to me. \n> \n> I am hesitating to put a test on one of the observed wrong f-vector, but if you confirm that this fixes the observed symptom on the f-vector, then I would say it is fine.\n\nThis ticket has nothing to do with polytopes :-) If you feel safer having examples involving polytope I let you add one.",
    "created_at": "2019-08-22T12:53:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28140#issuecomment-397432",
    "user": "vdelecroix"
}
```

Replying to [comment:8 jipilab]:
> Looks good to me. 
> 
> I am hesitating to put a test on one of the observed wrong f-vector, but if you confirm that this fixes the observed symptom on the f-vector, then I would say it is fine.

This ticket has nothing to do with polytopes :-) If you feel safer having examples involving polytope I let you add one.



---

archive/issue_comments_397433.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-08-26T09:49:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28140#issuecomment-397433",
    "user": "jipilab"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_397434.json:
```json
{
    "body": "Replying to [comment:9 vdelecroix]:\n> Replying to [comment:8 jipilab]:\n> > Looks good to me. \n> > \n> > I am hesitating to put a test on one of the observed wrong f-vector, but if you confirm that this fixes the observed symptom on the f-vector, then I would say it is fine.\n> \n> This ticket has nothing to do with polytopes :-) If you feel safer having examples involving polytope I let you add one.\n\nAfter looking carefully at the branch, I saw what you meant. I got confused by the description of the ticket...\n\nIt's all good.",
    "created_at": "2019-08-26T09:49:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28140#issuecomment-397434",
    "user": "jipilab"
}
```

Replying to [comment:9 vdelecroix]:
> Replying to [comment:8 jipilab]:
> > Looks good to me. 
> > 
> > I am hesitating to put a test on one of the observed wrong f-vector, but if you confirm that this fixes the observed symptom on the f-vector, then I would say it is fine.
> 
> This ticket has nothing to do with polytopes :-) If you feel safer having examples involving polytope I let you add one.

After looking carefully at the branch, I saw what you meant. I got confused by the description of the ticket...

It's all good.



---

archive/issue_comments_397435.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-08-28T19:55:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28140#issuecomment-397435",
    "user": "vbraun"
}
```

Resolution: fixed
