# Issue 10952: Update prereq so that SAGE_PORT does not need setting on Solaris x86

Issue created by migration from https://trac.sagemath.org/ticket/11070

Original creator: drkirkby

Original creation time: 2011-03-28 17:39:22

Assignee: drkirkby

CC:  jhpalmieri

The environment variable `SAGE_PORT` 

http://www.sagemath.org/doc/installation/source.html

has to be set on systems where such as AIX and HP-UX where Sage is not supported. Currently this is also so on Solaris x86, despite the fact Sage build fine and is fully supported on both OpenSolaris x86 and Solaris 10 x86:

http://wiki.sagemath.org/SupportedPlatforms

As such, the file

`$SAGE_ROOT/spkg/base/prereq-0.7-install`

needs to be changed to remove this specific test for Solaris on x86. There is also a minor typo with an "x" missing on a line where a test for Solaris 2.6 is performed. 

The new script will be installed as:

`$SAGE_ROOT/spkg/base/prereq-0.8-install` 

and the old one removed.



## Notes for reviewer
You only need to check the changes betweem the two scripts - ignore the tar file that the script open. That is the subject of another ticket #9978. 

## Notes for the release manager
This ticket depends on #9978. This and #9978 must be updated together. 

Making changes to `$SAGE_ROOT/spkg/base` is performed in a different way to other changes. 

Attached is `prereq-0.8-install` and the diff from the old version. {{{prereq-0.7-install}}

The tar file in the directory `$SAGE_ROOT/spkg/base` also needs the version incremented from 0.7 to 0.8. However, since some larger changes are made to this tar file as a result of a revised configure.ac used in #9978, the tar file will be attached there. 

To make the changes for this ticket and #9978, whilst updating the version of prereq script from 0.7 to 0.8, two things must be done. 
 * The tar file `prereq-0.8.tar` attached to #9978 should be installed as `$SAGE_ROOT/spkg/base/prereq-0.8.tar`
 * The tar file `$SAGE_ROOT/spkg/base/prereq-0.7.tar` should be removed. 
 * The script attached to this ticket (`prereq-0.8-install`) needs to be installed as `$SAGE_ROOT/spkg/base/prereq-0.8-install`
 * The script  `$SAGE_ROOT/spkg/base/prereq-0.7-install` must be removed.


---

Comment by drkirkby created at 2011-03-28 18:09:12

Changing status from new to needs_review.


---

Attachment

To be installed as $SAGE_ROOT/spkg/base/prereq-0.8-install


---

Comment by drkirkby created at 2011-03-28 21:53:32

Differences between the old script prereq-0.7-install and the new one prereq-0.8-install


---

Attachment


---

Comment by jhpalmieri created at 2011-03-29 21:26:33

Hi Dave,

In principle this looks good.  One very minor change to the patch: add a period at the end of

```
echo "Sage is not supported on any version of Solaris earlier than 10" 
```

(You're deleting the following line, which has the period for that sentence.)

More importantly, though, I think that the file prereq-0.8-install should be added to the spkg/base repo, it should be executable, and prereq-0.7-install should be removed from the repo.  (I guess actually you should use hg to rename the 0.7 version to the 0.8 version, and then patch it.)  The .hgignore file should be modified, too, to include the new tar file, and I suppose it doesn't need to mention the old tar file. 

I'm attaching a mercurial patch which does these things, and I've committed it in your name.  Let me know if you have any objections.  Please take a look at the patch, and if you're happy with it, give the ticket a positive review.  (I'm happy with your changes, I just want to make sure you're happy with my implementation of them.)


---

Attachment

apply to spkg/base repo


---

Comment by drkirkby created at 2011-03-29 23:14:20

Thank you John. 

Yes, your changes look fine to me. I was not aware exactly how to use Mercurial to rename the files. But I applied the Mercurial patch you created and it did the right things. 

I still need to get a positive review on the other half if this update of "prereq", which is on ticket #9978. If you have time, perhaps you could take a look at that.


---

Comment by drkirkby created at 2011-03-29 23:14:20

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2011-04-05 11:59:26

Resolution: fixed
