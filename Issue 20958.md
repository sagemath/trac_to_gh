# Issue 20958: cardinality_exhaustive incorrect for general curves of genus 1

Issue created by migration from https://trac.sagemath.org/ticket/21195

Original creator: pbruin

Original creation time: 2016-08-08 19:58:39

CC:  jpflori

Keywords: hyperelliptic curve finite field

After #19122, counting points at infinity still needs to be fixed for hyperelliptic curves of genus 1 given by an equation `y^2 + h(x)*y = f(x)` when `h != 0`.  Consider the following example (cf. comment:17:ticket:19122):

```
def test(p):
    S.<z> = GF(p)[]
    D = HyperellipticCurve(-z^2 + z, z^2)
    return D.count_points_exhaustive()
```

Running this for `p = 2` and `p = 3` gives

```
sage: test(2)
[4]
sage: test(3)
[4]  # or [3], after #19122
```

Both answers should be 5.


---

Comment by pbruin created at 2016-08-09 09:19:46

Changing status from new to needs_review.


---

Comment by pbruin created at 2016-08-09 09:19:46

The attached branch fixes the bug basically by removing the special case _g_ = 1 in `cardinality_exhaustive()`.  It also streamlines the code, making the parallels between the computations in the various cases (affine and infinite points, even and odd characteristic) more apparent.


---

Comment by jpflori created at 2016-08-09 09:30:44

Looks good to me!
Thanks Peter.


---

Comment by jpflori created at 2016-08-09 09:30:44

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-08-13 22:50:54

Resolution: fixed
