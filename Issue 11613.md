# Issue 11613: exp(I*pi*n).simplify_exp() doesn't simplify

archive/issues_011613.json:
```json
{
    "body": "Assignee: @burcin\n\nCC:  @kcrisman @orlitzky\n\nKeywords: maxima symbolics exponentials sd40.5\n\nAt https://groups.google.com/d/topic/sage-support/Pkn1o1kAcyE/discussion I noted that currently (4.7.1 and 4.7.2.alpha2), we have this:\n\n```\nsage: n = var('n')\nsage: assume(n, 'integer')\nsage: exp(I*n*pi).simplify_exp()\ne^(I*pi*n)\n```\nI was really hoping for `cos(pi*n)`, or `(-1)^n`. \n\nIf you are serious about asking Maxima, it will simplify it, though:\n\n```\nsage: A = exp(I*pi*n)\nsage: A.maxima_methods().rectform()\n(-1)^n\n```\n\nWe should somehow wrap rectform or make it easier to access. At a minimum, we should add something to the documentation to mention this possibility.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11785\n\n",
    "closed_at": "2014-02-20T23:17:01Z",
    "created_at": "2011-09-09T00:10:17Z",
    "labels": [
        "component: symbolics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "exp(I*pi*n).simplify_exp() doesn't simplify",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11613",
    "user": "https://github.com/dandrake"
}
```
Assignee: @burcin

CC:  @kcrisman @orlitzky

Keywords: maxima symbolics exponentials sd40.5

At https://groups.google.com/d/topic/sage-support/Pkn1o1kAcyE/discussion I noted that currently (4.7.1 and 4.7.2.alpha2), we have this:

```
sage: n = var('n')
sage: assume(n, 'integer')
sage: exp(I*n*pi).simplify_exp()
e^(I*pi*n)
```
I was really hoping for `cos(pi*n)`, or `(-1)^n`. 

If you are serious about asking Maxima, it will simplify it, though:

```
sage: A = exp(I*pi*n)
sage: A.maxima_methods().rectform()
(-1)^n
```

We should somehow wrap rectform or make it easier to access. At a minimum, we should add something to the documentation to mention this possibility.

Issue created by migration from https://trac.sagemath.org/ticket/11785





---

archive/issue_comments_130931.json:
```json
{
    "body": "This is sort of a work-in-progress, but I'd appreciate comments on the approach.",
    "created_at": "2012-03-27T18:48:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130931",
    "user": "https://github.com/orlitzky"
}
```

This is sort of a work-in-progress, but I'd appreciate comments on the approach.



---

archive/issue_comments_130932.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-03-27T18:48:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130932",
    "user": "https://github.com/orlitzky"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_130933.json:
```json
{
    "body": "Hmm.  Maybe for a first try we should just provide `simplify_rectform` or something more felicitously named regardless for now, and then discuss elsewhere whether it's useful to add this parameter.  I'm not sure that string length is a good measure of complexity, though I'm not sure I have a better idea (other than total number of vertices of the expression tree, I suppose).  In Maxima I don't think they do this, they just assume the user is smart enough to tell if it's simpler.  As long as this isn't in the default simplification (not to reopen the `simplify_full` issue!), we might not want to open up a whole new file of complexity of a symbolic expression without input from experts in such things.\n\nWhat do you think?  I do like having this available, Dan isn't the first to ask.  There are also some custom methods on some other ticket for pretty comprehensive dealing with the trig-complex issue, I can't remember where it is and don't have time to find it, though.  You might want to do some snooping on sage-devel archives or on Trac for these.",
    "created_at": "2012-03-27T20:12:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130933",
    "user": "https://github.com/kcrisman"
}
```

Hmm.  Maybe for a first try we should just provide `simplify_rectform` or something more felicitously named regardless for now, and then discuss elsewhere whether it's useful to add this parameter.  I'm not sure that string length is a good measure of complexity, though I'm not sure I have a better idea (other than total number of vertices of the expression tree, I suppose).  In Maxima I don't think they do this, they just assume the user is smart enough to tell if it's simpler.  As long as this isn't in the default simplification (not to reopen the `simplify_full` issue!), we might not want to open up a whole new file of complexity of a symbolic expression without input from experts in such things.

What do you think?  I do like having this available, Dan isn't the first to ask.  There are also some custom methods on some other ticket for pretty comprehensive dealing with the trig-complex issue, I can't remember where it is and don't have time to find it, though.  You might want to do some snooping on sage-devel archives or on Trac for these.



---

archive/issue_comments_130934.json:
```json
{
    "body": "I tried it without the complexity measure first, but this function has a tendency to make expressions *more* complicated. If we're ever going to use it in e.g. `full_simplify()`, we need to be a little more selective about which results we accept.\n\nIt turns out, string length is actually a pretty good measure.\n\nI implemented something close to the number of vertices in the expression tree:\n\n```\nfrom types import ListType\n\ndef flatten_list(l):\n   result = []\n\n   for item in l:\n      if isinstance(item, ListType):\n         result += flatten_list(item)\n      else:\n         result += [item]\n\n   return result\n\ndef flatten_operands(operands):\n   return operands + [flatten_operands(g.operands()) for g in operands]\n\ndef all_operands(expr):\n    return flatten_list(flatten_operands(expr.operands()))\n```\n\nand then tried the `len(all_operands(expr))` complexity measure. It also works, but is much much much slower and doesn't seem \"better\" than string length really. We could add that to the `complexity_measures` module as an option, but the dumb solution seems to work too.\n\n(The way that I'm testing, by the way, is to replace `simplify()` with `simplify_rect()` and watch the failing doctests. Many of them are promising.)\n\nAdmittedly adding a new module just for this feels like overkill, but the alternatives weren't too appealing:\n\n* Default to `lambda x: len(str(x))`\n* Default to `None`, and use the string length in that case. Requires the user to pass `lambda x: 1` to force the simplification (we'd also have to use less-than-or-equal-to in the function body).\n* Remove the measure altogether; this usually wasn't a simplification.\n\nDown the line, `simplify_full()` could potentially try `simplify_foo()` with *every* complexity measure, and return the expression that's simplest according to the measure you gave `simplify_full()`.",
    "created_at": "2012-03-27T20:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130934",
    "user": "https://github.com/orlitzky"
}
```

I tried it without the complexity measure first, but this function has a tendency to make expressions *more* complicated. If we're ever going to use it in e.g. `full_simplify()`, we need to be a little more selective about which results we accept.

It turns out, string length is actually a pretty good measure.

I implemented something close to the number of vertices in the expression tree:

```
from types import ListType

def flatten_list(l):
   result = []

   for item in l:
      if isinstance(item, ListType):
         result += flatten_list(item)
      else:
         result += [item]

   return result

def flatten_operands(operands):
   return operands + [flatten_operands(g.operands()) for g in operands]

def all_operands(expr):
    return flatten_list(flatten_operands(expr.operands()))
```

and then tried the `len(all_operands(expr))` complexity measure. It also works, but is much much much slower and doesn't seem "better" than string length really. We could add that to the `complexity_measures` module as an option, but the dumb solution seems to work too.

(The way that I'm testing, by the way, is to replace `simplify()` with `simplify_rect()` and watch the failing doctests. Many of them are promising.)

Admittedly adding a new module just for this feels like overkill, but the alternatives weren't too appealing:

* Default to `lambda x: len(str(x))`
* Default to `None`, and use the string length in that case. Requires the user to pass `lambda x: 1` to force the simplification (we'd also have to use less-than-or-equal-to in the function body).
* Remove the measure altogether; this usually wasn't a simplification.

Down the line, `simplify_full()` could potentially try `simplify_foo()` with *every* complexity measure, and return the expression that's simplest according to the measure you gave `simplify_full()`.



---

archive/issue_comments_130935.json:
```json
{
    "body": "Interesting, and good longer-range ideas.\n\nApropos slowness, that might be worth testing anyway for this.  `full_simplify` is probably really slow, but testing two different strings like this could make it really slow (not that that is done here).  The \"down the line\" would probably be super-slow for that reason.\n\nAlso, along the lines of plotting and William's recent email complaining about how 2D plotting got away from not caring about the backend, it might be worth thinking about how to allow a number of backends for simplification as well...  just a thought.",
    "created_at": "2012-03-28T02:28:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130935",
    "user": "https://github.com/kcrisman"
}
```

Interesting, and good longer-range ideas.

Apropos slowness, that might be worth testing anyway for this.  `full_simplify` is probably really slow, but testing two different strings like this could make it really slow (not that that is done here).  The "down the line" would probably be super-slow for that reason.

Also, along the lines of plotting and William's recent email complaining about how 2D plotting got away from not caring about the backend, it might be worth thinking about how to allow a number of backends for simplification as well...  just a thought.



---

archive/issue_comments_130936.json:
```json
{
    "body": "Failing doctest (looks like a typo, should be complexity_measure**s**):\n\n```\nFile \"/home/patchbot/sage-5.0.beta3/devel/sage-11785/sage/symbolic/complexity_measures.py\", line 30:\n    sage: from sage.symbolic.complexity_measure import string_length\nException raised:\n    Traceback (most recent call last):\n      File \"/home/patchbot/sage-5.0.beta3/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/patchbot/sage-5.0.beta3/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/patchbot/sage-5.0.beta3/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_1[2]>\", line 1, in <module>\n        from sage.symbolic.complexity_measure import string_length###line 30:\n    sage: from sage.symbolic.complexity_measure import string_length\n    ImportError: No module named complexity_measure\n**********************************************************************",
    "created_at": "2012-04-06T10:33:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130936",
    "user": "https://github.com/loefflerd"
}
```

Failing doctest (looks like a typo, should be complexity_measure**s**):

```
File "/home/patchbot/sage-5.0.beta3/devel/sage-11785/sage/symbolic/complexity_measures.py", line 30:
    sage: from sage.symbolic.complexity_measure import string_length
Exception raised:
    Traceback (most recent call last):
      File "/home/patchbot/sage-5.0.beta3/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/patchbot/sage-5.0.beta3/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/patchbot/sage-5.0.beta3/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_1[2]>", line 1, in <module>
        from sage.symbolic.complexity_measure import string_length###line 30:
    sage: from sage.symbolic.complexity_measure import string_length
    ImportError: No module named complexity_measure
**********************************************************************



---

archive/issue_comments_130937.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-04-06T10:33:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130937",
    "user": "https://github.com/loefflerd"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_130938.json:
```json
{
    "body": "Whoops, that was a last-minute change to match the naming of groups,rings, etc. I fixed the 's' and renamed the method to `simplify_rectform()` per comment 3.",
    "created_at": "2012-04-06T15:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130938",
    "user": "https://github.com/orlitzky"
}
```

Whoops, that was a last-minute change to match the naming of groups,rings, etc. I fixed the 's' and renamed the method to `simplify_rectform()` per comment 3.



---

archive/issue_comments_130939.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-04-06T15:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130939",
    "user": "https://github.com/orlitzky"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_130940.json:
```json
{
    "body": "I will ask some other people about the complexity measure stuff, but I think your default is reversed: for anyone who knows a little Maxima, they will expect something like `simplify_rectform()` to actually return what Maxima's `rectform` returns -- but the default *isn't* to do that. \n\nHere's my proposal: by default, call Maxima's `rectform` and return that. Don't import anything from `complexity_measures.py` by default, but include documentation showing the user how to import that and use it in the keyword argument. \n\n(Also, how hard is it to count the number of operands in an expression? It's just `len`, right? If it isn't too hard, perhaps the documentation could show how to use that as a complexity measure.)",
    "created_at": "2012-05-28T22:08:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130940",
    "user": "https://github.com/dandrake"
}
```

I will ask some other people about the complexity measure stuff, but I think your default is reversed: for anyone who knows a little Maxima, they will expect something like `simplify_rectform()` to actually return what Maxima's `rectform` returns -- but the default *isn't* to do that. 

Here's my proposal: by default, call Maxima's `rectform` and return that. Don't import anything from `complexity_measures.py` by default, but include documentation showing the user how to import that and use it in the keyword argument. 

(Also, how hard is it to count the number of operands in an expression? It's just `len`, right? If it isn't too hard, perhaps the documentation could show how to use that as a complexity measure.)



---

archive/issue_comments_130941.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-05-28T22:08:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130941",
    "user": "https://github.com/dandrake"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_130942.json:
```json
{
    "body": "Changing keywords from \"maxima symbolics exponentials\" to \"maxima symbolics exponentials sd40.5\".",
    "created_at": "2012-05-28T22:08:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130942",
    "user": "https://github.com/dandrake"
}
```

Changing keywords from "maxima symbolics exponentials" to "maxima symbolics exponentials sd40.5".



---

archive/issue_comments_130943.json:
```json
{
    "body": "Replying to [comment:9 ddrake]:\n> I will ask some other people about the complexity measure stuff, but I think your default is reversed: for anyone who knows a little Maxima, they will expect something like `simplify_rectform()` to actually return what Maxima's `rectform` returns -- but the default *isn't* to do that. \n> \n> Here's my proposal: by default, call Maxima's `rectform` and return that. Don't import anything from `complexity_measures.py` by default, but include documentation showing the user how to import that and use it in the keyword argument. \n\n\n\nBut why introduce a default that's not useful? Unless you're setting up a toy example to show what `rectform` does, most expressions will be made uglier. Maxima's `rectform()` isn't labeled a simplification; if we're going to call it one, I think it should simplify.\n\nIf we call it a simplification and have it only do `rectform()` by default, we're essentially requiring the user to both read the docs and pass `make_it_work=True` on every invocation.\n\n\nHow many of our users are there that,\n\na. Know maxima **and** are familiar with its `rectform()` **and** don't know about expr.maxima_methods().rectform() **and** would expect `simplify_rectform()` to *just* call `rectform()`?\nb. Use `simplify_foo()` and just want their expressions to get simpler.\n\nI suspect (b) dwarfs (a).\n\nI wouldn't mind if we just called it `Expression.rectform()` and documented what it does, but I also don't think that it would be as useful.\n\n\n\n\n> (Also, how hard is it to count the number of operands in an expression? It's just `len`, right? If it isn't too hard, perhaps the documentation could show how to use that as a complexity measure.)\n\n\n\n\n\nIt depends on how thorough you want to be. A simple `len(expr)` will return the number of top-level operands. If you want to count all operands at any level, you either have to recurse (as I did), or know some shortcut.\n\nThe former doesn't work well because you can have,\n\n```\nsage: f = huge_expression1 + huge_expression2\nsage: len(f)\n2\n```\n\nThe latter works comparably to the string length, but was slow as dirt (my implementation is lame). It could probably be improved, though. I would definitely include this if some pynac magic can speed it up.",
    "created_at": "2012-05-28T23:04:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130943",
    "user": "https://github.com/orlitzky"
}
```

Replying to [comment:9 ddrake]:
> I will ask some other people about the complexity measure stuff, but I think your default is reversed: for anyone who knows a little Maxima, they will expect something like `simplify_rectform()` to actually return what Maxima's `rectform` returns -- but the default *isn't* to do that. 
> 
> Here's my proposal: by default, call Maxima's `rectform` and return that. Don't import anything from `complexity_measures.py` by default, but include documentation showing the user how to import that and use it in the keyword argument. 



But why introduce a default that's not useful? Unless you're setting up a toy example to show what `rectform` does, most expressions will be made uglier. Maxima's `rectform()` isn't labeled a simplification; if we're going to call it one, I think it should simplify.

If we call it a simplification and have it only do `rectform()` by default, we're essentially requiring the user to both read the docs and pass `make_it_work=True` on every invocation.


How many of our users are there that,

a. Know maxima **and** are familiar with its `rectform()` **and** don't know about expr.maxima_methods().rectform() **and** would expect `simplify_rectform()` to *just* call `rectform()`?
b. Use `simplify_foo()` and just want their expressions to get simpler.

I suspect (b) dwarfs (a).

I wouldn't mind if we just called it `Expression.rectform()` and documented what it does, but I also don't think that it would be as useful.




> (Also, how hard is it to count the number of operands in an expression? It's just `len`, right? If it isn't too hard, perhaps the documentation could show how to use that as a complexity measure.)





It depends on how thorough you want to be. A simple `len(expr)` will return the number of top-level operands. If you want to count all operands at any level, you either have to recurse (as I did), or know some shortcut.

The former doesn't work well because you can have,

```
sage: f = huge_expression1 + huge_expression2
sage: len(f)
2
```

The latter works comparably to the string length, but was slow as dirt (my implementation is lame). It could probably be improved, though. I would definitely include this if some pynac magic can speed it up.



---

archive/issue_comments_130944.json:
```json
{
    "body": "Perhaps it would help to abstract out something.  From discussing with Dan, it sounds like you actually agree more than you think.\n* Those who want a command that simplifies definitely want the current version, or at least something like it.\n* Those who use something with the word `rectform` in it will expect something with right angles.\n\nCould we have two functions, then?  \n1. Something with `simplify_foo` where `foo` is something that implies `e^(pi*i*n)` will look very simple with `n` an integer but `e^(i*x)` doesn't change?\n2. Something that allows people to access `rectform` without using `maxima_methods`?  (I think that the group of folks who would like this is not insignificant, since a lot of people don't know Maxima when coming to Sage but definitely want this sort of symbolic stuff.)\n\nThoughts are welcome.",
    "created_at": "2012-05-29T02:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130944",
    "user": "https://github.com/kcrisman"
}
```

Perhaps it would help to abstract out something.  From discussing with Dan, it sounds like you actually agree more than you think.
* Those who want a command that simplifies definitely want the current version, or at least something like it.
* Those who use something with the word `rectform` in it will expect something with right angles.

Could we have two functions, then?  
1. Something with `simplify_foo` where `foo` is something that implies `e^(pi*i*n)` will look very simple with `n` an integer but `e^(i*x)` doesn't change?
2. Something that allows people to access `rectform` without using `maxima_methods`?  (I think that the group of folks who would like this is not insignificant, since a lot of people don't know Maxima when coming to Sage but definitely want this sort of symbolic stuff.)

Thoughts are welcome.



---

archive/issue_comments_130945.json:
```json
{
    "body": "Replying to [comment:11 kcrisman]:\n> Perhaps it would help to abstract out something.  From discussing with Dan, it sounds like you actually agree more than you think.\n> * Those who want a command that simplifies definitely want the current version, or at least something like it.\n> * Those who use something with the word `rectform` in it will expect something with right angles.\n> \n> Could we have two functions, then?  \n> 1. Something with `simplify_foo` where `foo` is something that implies `e^(pi*i*n)` will look very simple with `n` an integer but `e^(i*x)` doesn't change?\n> 2. Something that allows people to access `rectform` without using `maxima_methods`?  (I think that the group of folks who would like this is not insignificant, since a lot of people don't know Maxima when coming to Sage but definitely want this sort of symbolic stuff.)\n> \n> Thoughts are welcome.\n\n\nSure, I'll create another ticket for adding `Expression.rectform` (that one should be an easy review) and implement `simplify_rectform()` in terms of that. I'll try to do it later today.",
    "created_at": "2012-05-29T13:24:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130945",
    "user": "https://github.com/orlitzky"
}
```

Replying to [comment:11 kcrisman]:
> Perhaps it would help to abstract out something.  From discussing with Dan, it sounds like you actually agree more than you think.
> * Those who want a command that simplifies definitely want the current version, or at least something like it.
> * Those who use something with the word `rectform` in it will expect something with right angles.
> 
> Could we have two functions, then?  
> 1. Something with `simplify_foo` where `foo` is something that implies `e^(pi*i*n)` will look very simple with `n` an integer but `e^(i*x)` doesn't change?
> 2. Something that allows people to access `rectform` without using `maxima_methods`?  (I think that the group of folks who would like this is not insignificant, since a lot of people don't know Maxima when coming to Sage but definitely want this sort of symbolic stuff.)
> 
> Thoughts are welcome.


Sure, I'll create another ticket for adding `Expression.rectform` (that one should be an easy review) and implement `simplify_rectform()` in terms of that. I'll try to do it later today.



---

archive/issue_comments_130946.json:
```json
{
    "body": "There's a patch up at #13061 adding plain `rectform()`, so I'll rebase this one off that.",
    "created_at": "2012-05-29T17:57:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130946",
    "user": "https://github.com/orlitzky"
}
```

There's a patch up at #13061 adding plain `rectform()`, so I'll rebase this one off that.



---

archive/issue_comments_130947.json:
```json
{
    "body": "Attachment [sage-trac_11785.patch](tarball://root/attachments/some-uuid/ticket11785/sage-trac_11785.patch) by @orlitzky created at 2012-05-29 19:02:33\n\nUpdated patch based on Expression.rectform()",
    "created_at": "2012-05-29T19:02:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130947",
    "user": "https://github.com/orlitzky"
}
```

Attachment [sage-trac_11785.patch](tarball://root/attachments/some-uuid/ticket11785/sage-trac_11785.patch) by @orlitzky created at 2012-05-29 19:02:33

Updated patch based on Expression.rectform()



---

archive/issue_comments_130948.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-05-29T19:03:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130948",
    "user": "https://github.com/orlitzky"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_130949.json:
```json
{
    "body": "Ok, patch is updated.",
    "created_at": "2012-05-29T19:03:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130949",
    "user": "https://github.com/orlitzky"
}
```

Ok, patch is updated.



---

archive/issue_comments_130950.json:
```json
{
    "body": "Please fill in your real name as Author.",
    "created_at": "2012-07-27T20:41:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130950",
    "user": "https://github.com/jdemeyer"
}
```

Please fill in your real name as Author.



---

archive/issue_events_031001.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11613#event-31001"
}
```



---

archive/issue_events_031002.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11613#event-31002"
}
```



---

archive/issue_events_031003.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11613#event-31003"
}
```



---

archive/issue_comments_130951.json:
```json
{
    "body": "Rebased and changed doctest output order so it tests OK.\n\n---\nNew commits:",
    "created_at": "2014-02-15T16:16:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130951",
    "user": "https://github.com/rwst"
}
```

Rebased and changed doctest output order so it tests OK.

---
New commits:



---

archive/issue_comments_130952.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-02-15T16:16:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130952",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_130953.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2014-02-20T17:25:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130953",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_130954.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2014-02-20T17:25:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130954",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_130955.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-02-20T17:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130955",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_130956.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-02-20T23:17:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11613#issuecomment-130956",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_031004.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-02-20T23:17:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11613",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11613#event-31004"
}
```
