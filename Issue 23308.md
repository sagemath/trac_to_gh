# Issue 23308: segmentation fault with coefficients() on symbolic expressions

archive/issues_023308.json:
```json
{
    "body": "CC:  rws\n\nKeywords: bug, symbolics\n\nOn sage 8.0\n\n```\nsage: q,a,b = SR.var('q,a,b')\nsage: F = (a^2 + 6*a + 2*b)*q/(a^5 + 3*a^4*b + 3*a^3*b^2 + a^2*b^3) + (3*a + b)/(a^5 + 3*a^4*b + 3*a^3*b^2 + a^2*b^3)\nsage: F.coefficients()\nErreur de segmentation (core dumped)\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/23545\n\n",
    "created_at": "2017-07-26T09:44:39Z",
    "labels": [
        "symbolics",
        "critical",
        "bug"
    ],
    "title": "segmentation fault with coefficients() on symbolic expressions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23308",
    "user": "vdelecroix"
}
```
CC:  rws

Keywords: bug, symbolics

On sage 8.0

```
sage: q,a,b = SR.var('q,a,b')
sage: F = (a^2 + 6*a + 2*b)*q/(a^5 + 3*a^4*b + 3*a^3*b^2 + a^2*b^3) + (3*a + b)/(a^5 + 3*a^4*b + 3*a^3*b^2 + a^2*b^3)
sage: F.coefficients()
Erreur de segmentation (core dumped)
```


Issue created by migration from https://trac.sagemath.org/ticket/23545





---

archive/issue_comments_326165.json:
```json
{
    "body": "Confirmed. I added a minimal case.",
    "created_at": "2017-07-26T13:39:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23308#issuecomment-326165",
    "user": "rws"
}
```

Confirmed. I added a minimal case.



---

archive/issue_comments_326166.json:
```json
{
    "body": "The Pynac code does not check if the expression is a polynomial fraction in `x`. That case cannot be handled via `coefficient()` (the user should expand as a series). I will add a check to prevent this problem.",
    "created_at": "2017-07-29T14:41:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23308#issuecomment-326166",
    "user": "rws"
}
```

The Pynac code does not check if the expression is a polynomial fraction in `x`. That case cannot be handled via `coefficient()` (the user should expand as a series). I will add a check to prevent this problem.



---

archive/issue_comments_326167.json:
```json
{
    "body": "Pynac master has the fix. This branch adds doctests.\n----\nNew commits:",
    "created_at": "2017-08-03T06:33:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23308#issuecomment-326167",
    "user": "rws"
}
```

Pynac master has the fix. This branch adds doctests.
----
New commits:



---

archive/issue_comments_326168.json:
```json
{
    "body": "While the core dump is fixed in develop, one of the doctests fails.",
    "created_at": "2017-09-06T04:47:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23308#issuecomment-326168",
    "user": "rws"
}
```

While the core dump is fixed in develop, one of the doctests fails.



---

archive/issue_comments_326169.json:
```json
{
    "body": "Changing priority from critical to major.",
    "created_at": "2017-09-06T04:47:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23308#issuecomment-326169",
    "user": "rws"
}
```

Changing priority from critical to major.



---

archive/issue_comments_326170.json:
```json
{
    "body": "Fixed by #24262. I will give positive review if necessary, but as suggest to matk it duplicate and close it (after positive review of #24262, pf course...)..",
    "created_at": "2017-11-22T22:19:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23308#issuecomment-326170",
    "user": "charpent"
}
```

Fixed by #24262. I will give positive review if necessary, but as suggest to matk it duplicate and close it (after positive review of #24262, pf course...)..



---

archive/issue_comments_326171.json:
```json
{
    "body": "This ticket has doctests for #24147 too so let's make #24147 the duplicate.",
    "created_at": "2017-11-23T06:44:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23308#issuecomment-326171",
    "user": "rws"
}
```

This ticket has doctests for #24147 too so let's make #24147 the duplicate.



---

archive/issue_comments_326172.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-12-26T09:35:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23308#issuecomment-326172",
    "user": "rws"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_326173.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-12-27T08:29:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23308#issuecomment-326173",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_326174.json:
```json
{
    "body": "LGTM.",
    "created_at": "2017-12-27T08:29:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23308#issuecomment-326174",
    "user": "tscrim"
}
```

LGTM.



---

archive/issue_comments_326175.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-12-29T08:57:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23308#issuecomment-326175",
    "user": "vbraun"
}
```

Resolution: fixed
