# Issue 26833: Upgrade to Cysignals 1.9.0

archive/issues_026833.json:
```json
{
    "body": "CC:  arojas embray fbissey @timokau infinity0 jdemeyer slelievre thansen\n\nKeywords: upgrade, cysignals\n\nThis ticket is to upgrade to Cysignals 1.9.0.\n\n- Tarball: https://files.pythonhosted.org/packages/6c/29/ddd51b4f514ce7c554758eab63995024136f257f3d33ae14527d7d75705d/cysignals-1.9.0.tar.gz\n\nIssue created by migration from https://trac.sagemath.org/ticket/27070\n\n",
    "created_at": "2019-01-17T06:04:01Z",
    "labels": [
        "packages: standard",
        "major"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "Upgrade to Cysignals 1.9.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26833",
    "user": "slelievre"
}
```
CC:  arojas embray fbissey @timokau infinity0 jdemeyer slelievre thansen

Keywords: upgrade, cysignals

This ticket is to upgrade to Cysignals 1.9.0.

- Tarball: https://files.pythonhosted.org/packages/6c/29/ddd51b4f514ce7c554758eab63995024136f257f3d33ae14527d7d75705d/cysignals-1.9.0.tar.gz

Issue created by migration from https://trac.sagemath.org/ticket/27070





---

archive/issue_comments_377501.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2019-01-18T10:40:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377501",
    "user": "embray"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_377502.json:
```json
{
    "body": "Fine for me if somebody wants to do this, but there is no real reason for this upgrade. I mainly made the new release to answer to a Python bug.",
    "created_at": "2019-01-18T13:12:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377502",
    "user": "jdemeyer"
}
```

Fine for me if somebody wants to do this, but there is no real reason for this upgrade. I mainly made the new release to answer to a Python bug.



---

archive/issue_comments_377503.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-03-10T21:37:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377503",
    "user": "jdemeyer"
}
```

New commits:



---

archive/issue_comments_377504.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-03-10T21:37:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377504",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_377505.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2019-03-11T11:22:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377505",
    "user": "jdemeyer"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_377506.json:
```json
{
    "body": "Why is this a blocker?",
    "created_at": "2019-03-11T18:24:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377506",
    "user": "@timokau"
}
```

Why is this a blocker?



---

archive/issue_comments_377507.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-03-11T22:31:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377507",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_377508.json:
```json
{
    "body": "I am not entirely sure. However, I am sending this off to the buildbots, so it is somewhat moot (but it would still be good to have an answer Jeroen `;)`).",
    "created_at": "2019-03-11T22:31:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377508",
    "user": "tscrim"
}
```

I am not entirely sure. However, I am sending this off to the buildbots, so it is somewhat moot (but it would still be good to have an answer Jeroen `;)`).



---

archive/issue_comments_377509.json:
```json
{
    "body": "It's a blocker because it fixes #27384",
    "created_at": "2019-03-11T23:02:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377509",
    "user": "jdemeyer"
}
```

It's a blocker because it fixes #27384



---

archive/issue_comments_377510.json:
```json
{
    "body": "This is failing to build on OS X on conda-forge: https://github.com/conda-forge/cysignals-feedstock/pull/19 (despite cysignals on OS X being tested on Travis CI).",
    "created_at": "2019-03-12T09:54:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377510",
    "user": "jdemeyer"
}
```

This is failing to build on OS X on conda-forge: https://github.com/conda-forge/cysignals-feedstock/pull/19 (despite cysignals on OS X being tested on Travis CI).



---

archive/issue_comments_377511.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-03-12T09:54:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377511",
    "user": "jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_377512.json:
```json
{
    "body": "Replying to [comment:10 jdemeyer]:\n> It's a blocker because it fixes #27384\n\nWhich itself is not really a blocker (though it is a bad issue) except to the extent that it's a prerequisite to fixing #27214 which could also be argued is not a blocker, but it is a pretty severe problem the more and more I look at it.",
    "created_at": "2019-03-12T11:27:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377512",
    "user": "embray"
}
```

Replying to [comment:10 jdemeyer]:
> It's a blocker because it fixes #27384

Which itself is not really a blocker (though it is a bad issue) except to the extent that it's a prerequisite to fixing #27214 which could also be argued is not a blocker, but it is a pretty severe problem the more and more I look at it.



---

archive/issue_comments_377513.json:
```json
{
    "body": "Since the build problem is just a question of building the tests on clang do we really care about that here, or do you need to make a 1.10.1?",
    "created_at": "2019-03-12T11:32:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377513",
    "user": "embray"
}
```

Since the build problem is just a question of building the tests on clang do we really care about that here, or do you need to make a 1.10.1?



---

archive/issue_comments_377514.json:
```json
{
    "body": "Replying to [comment:14 embray]:\n> Since the build problem is just a question of building the tests on clang do we really care about that here, or do you need to make a 1.10.1?\n\nWe do care if the problem with conda-forge also exists on the computers of Sage users. At this point, I don't know if the build failure is specific to Conda (and I guess it's not).",
    "created_at": "2019-03-12T12:33:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377514",
    "user": "jdemeyer"
}
```

Replying to [comment:14 embray]:
> Since the build problem is just a question of building the tests on clang do we really care about that here, or do you need to make a 1.10.1?

We do care if the problem with conda-forge also exists on the computers of Sage users. At this point, I don't know if the build failure is specific to Conda (and I guess it's not).



---

archive/issue_comments_377515.json:
```json
{
    "body": "Okay, I just wasn't sure if the tests were built by default.  But if so then that's a reasonable caution I suppose.",
    "created_at": "2019-03-12T12:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377515",
    "user": "embray"
}
```

Okay, I just wasn't sure if the tests were built by default.  But if so then that's a reasonable caution I suppose.



---

archive/issue_comments_377516.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-03-12T20:09:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377516",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_377517.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-03-12T20:13:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377517",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_377518.json:
```json
{
    "body": "I'm getting this with 1.10.0 on OSX, please check before setting back to positive review:\n\n```\n[fpylll-0.4.1dev]     In file included from build/src/fpylll/fplll/integer_matrix.cpp:697:\n[fpylll-0.4.1dev]     In file included from /Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals/struct_signals.h:45:\n[fpylll-0.4.1dev]     /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/10.0.0/include/stdatomic.h:75:26: error: reference to 'memory_order' is ambiguous\n[fpylll-0.4.1dev]     void atomic_thread_fence(memory_order);\n[fpylll-0.4.1dev]                              ^\n[fpylll-0.4.1dev]     /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/10.0.0/include/stdatomic.h:68:3: note: candidate found by name lookup is 'memory_order'\n[fpylll-0.4.1dev]     } memory_order;\n[fpylll-0.4.1dev]       ^\n[fpylll-0.4.1dev]     /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/atomic:588:3: note: candidate found by name lookup is 'std::__1::memory_order'\n[fpylll-0.4.1dev]     } memory_order;\n[fpylll-0.4.1dev]       ^\n```\n",
    "created_at": "2019-03-13T09:06:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377518",
    "user": "vbraun"
}
```

I'm getting this with 1.10.0 on OSX, please check before setting back to positive review:

```
[fpylll-0.4.1dev]     In file included from build/src/fpylll/fplll/integer_matrix.cpp:697:
[fpylll-0.4.1dev]     In file included from /Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals/struct_signals.h:45:
[fpylll-0.4.1dev]     /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/10.0.0/include/stdatomic.h:75:26: error: reference to 'memory_order' is ambiguous
[fpylll-0.4.1dev]     void atomic_thread_fence(memory_order);
[fpylll-0.4.1dev]                              ^
[fpylll-0.4.1dev]     /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/10.0.0/include/stdatomic.h:68:3: note: candidate found by name lookup is 'memory_order'
[fpylll-0.4.1dev]     } memory_order;
[fpylll-0.4.1dev]       ^
[fpylll-0.4.1dev]     /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1/atomic:588:3: note: candidate found by name lookup is 'std::__1::memory_order'
[fpylll-0.4.1dev]     } memory_order;
[fpylll-0.4.1dev]       ^
```




---

archive/issue_comments_377519.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-03-13T09:06:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377519",
    "user": "vbraun"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_377520.json:
```json
{
    "body": "Which OS X machine is that? I cannot reproduce it on your `osx.fritz.box` (I tried cysignals-1.10.**1** but probably that doesn't make a difference for this error).",
    "created_at": "2019-03-13T14:58:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377520",
    "user": "jdemeyer"
}
```

Which OS X machine is that? I cannot reproduce it on your `osx.fritz.box` (I tried cysignals-1.10.**1** but probably that doesn't make a difference for this error).



---

archive/issue_comments_377521.json:
```json
{
    "body": "Yes, that one. Whats the compiler invocation? I have\n\n```\n    gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals -I/Users/buildslave-sage/slave/sage_git/build/local/include -I/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/include -I/Users/buildslave-sage/slave/sage_git/build/local/include/python2.7 -c build/src/fpylll/fplll/integer_matrix.cpp -o build/temp.macosx-10.9-x86_64-2.7/build/src/fpylll/fplll/integer_matrix.o -std=c++11\n```\n",
    "created_at": "2019-03-13T18:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377521",
    "user": "vbraun"
}
```

Yes, that one. Whats the compiler invocation? I have

```
    gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals -I/Users/buildslave-sage/slave/sage_git/build/local/include -I/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/include -I/Users/buildslave-sage/slave/sage_git/build/local/include/python2.7 -c build/src/fpylll/fplll/integer_matrix.cpp -o build/temp.macosx-10.9-x86_64-2.7/build/src/fpylll/fplll/integer_matrix.o -std=c++11
```




---

archive/issue_comments_377522.json:
```json
{
    "body": "You built sage's gcc, the buildbot doesn't and runs XCode clang",
    "created_at": "2019-03-13T18:44:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377522",
    "user": "vbraun"
}
```

You built sage's gcc, the buildbot doesn't and runs XCode clang



---

archive/issue_comments_377523.json:
```json
{
    "body": "I get the same error on OS X (not building Sage's gcc).",
    "created_at": "2019-03-13T20:30:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377523",
    "user": "jhpalmieri"
}
```

I get the same error on OS X (not building Sage's gcc).



---

archive/issue_comments_377524.json:
```json
{
    "body": "Confirmed indeed with clang.",
    "created_at": "2019-03-14T08:58:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377524",
    "user": "jdemeyer"
}
```

Confirmed indeed with clang.



---

archive/issue_comments_377525.json:
```json
{
    "body": "The problem is essentially that this doesn't compile:\n\n```\nusing namespace std;\n#include <atomic>\n#include <stdatomic.h>\n```\n",
    "created_at": "2019-03-14T09:12:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377525",
    "user": "jdemeyer"
}
```

The problem is essentially that this doesn't compile:

```
using namespace std;
#include <atomic>
#include <stdatomic.h>
```




---

archive/issue_comments_377526.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-03-14T14:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377526",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_377527.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-14T14:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377527",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_377528.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-03-14T14:12:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377528",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_377529.json:
```json
{
    "body": "I tested on that OS X machine that the cysignals test suite passes and that Sage builds.",
    "created_at": "2019-03-14T14:23:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377529",
    "user": "jdemeyer"
}
```

I tested on that OS X machine that the cysignals test suite passes and that Sage builds.



---

archive/issue_comments_377530.json:
```json
{
    "body": "I'm going to test this on Cygwin in a few minutes, but I don't expect any problems.",
    "created_at": "2019-03-14T14:47:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377530",
    "user": "embray"
}
```

I'm going to test this on Cygwin in a few minutes, but I don't expect any problems.



---

archive/issue_comments_377531.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-03-14T17:30:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377531",
    "user": "embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_377532.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-03-15T08:09:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26833",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26833#issuecomment-377532",
    "user": "vbraun"
}
```

Resolution: fixed
