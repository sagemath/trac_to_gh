# Issue 19751: Update to matplotlib 1.5.1

Issue created by migration from Trac.

Original creator: vbraun

Original creation time: 2016-01-30 20:52:54

CC:  aginiewicz fbissey etn40ff




---

Comment by vbraun created at 2016-01-30 20:56:20

Changing type from PLEASE CHANGE to defect.


---

Comment by vbraun created at 2016-01-30 20:56:20

Changing component from PLEASE CHANGE to packages: standard.


---

Comment by vbraun created at 2016-01-30 20:59:56

New commits:


---

Comment by git created at 2016-01-30 21:00:12

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vbraun created at 2016-01-30 21:01:22

New commits:


---

Comment by vbraun created at 2016-01-30 21:01:22

Changing status from new to needs_review.


---

Comment by dimpase created at 2016-01-30 21:53:04


```
sage -t --warn-long 44.7 src/sage/plot/graphics.py  # 2 doctests failed
sage -t --warn-long 44.7 src/sage/plot/contour_plot.py  # 1 doctest failed
```

something to do with `Contour levels must be increasing`, e.g.

```
sage -t --warn-long 44.7 src/sage/plot/contour_plot.py
**********************************************************************
File "src/sage/plot/contour_plot.py", line 638, in sage.plot.contour_plot.implicit_plot
Failed example:
    implicit_plot(x^2+y^2-2, (x,-3,3), (y,-3,3))
Expected:
    Graphics object consisting of 1 graphics primitive
Got:
    doctest:590: RichReprWarning: Exception in _rich_repr_ while displaying object: Contour levels must be increasing
    Graphics object consisting of 1 graphics primitive
```



---

Comment by dimpase created at 2016-01-30 21:59:17

google says "This error was added in matplotlib 1.5.1 because of a bug in all versions of contourf prior to 1.5.0."


---

Comment by dimpase created at 2016-01-30 22:01:59

Changing status from needs_review to needs_work.


---

Comment by aginiewicz created at 2016-01-30 22:09:00

This was already on sage-devel - https://groups.google.com/forum/#!topic/sage-devel/eeuC8CYUsnM - I thought it was in 1.5.0 as well, now I noticed Fran√ßois explicitly mentioned 1.5.1.

Anyway, I tested that None does not work, but changing default option of contours=[0,0] in implicit_plot to contours=[-1e307,0,1e307] (like in region_plot) seems to work, but I'm not sure if this does not break something else.


---

Comment by dimpase created at 2016-01-31 08:23:11

RTFM :-) The most meaningful output seems to be with `contours=0`. The docs of `contour_plot` say

```
  * "contours" -- integer or list of numbers (default: "None"): If
     a list of numbers is given, then this specifies the contour
     levels to use.  If an integer is given, then this many contour
     lines are used, but the exact levels are determined
     automatically. If "None" is passed (or the option is not given),
     then the number of contour lines is determined automatically, and
     is usually about 5.
```

and this explains why `None` gives you nonsense, usually. `contours=1` give 2 contours, not 1, apparently there is a shift by 1 somewhere...


---

Comment by git created at 2016-02-20 13:24:14

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vbraun created at 2016-02-20 13:29:40

An implicit plot is just a contour plot with a single contour at 0, not two contours at zero. The old `contours=[0,0]` probably never made sense...


---

Comment by vbraun created at 2016-02-20 13:29:40

Changing status from needs_work to needs_review.


---

Comment by dimpase created at 2016-02-20 14:49:19

OK, looks good to me


---

Comment by dimpase created at 2016-02-20 14:49:19

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-02-21 09:52:55

Resolution: fixed
