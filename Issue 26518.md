# Issue 26518: Error integrate with Fricas as algorithm fresnel_sin called

Issue created by migration from https://trac.sagemath.org/ticket/26755

Original creator: @nasser1

Original creation time: 2018-11-24 07:17:55

CC:  slelievre

Keywords: fricas fresnel

I asked about this in https://ask.sagemath.org/question/44369/error-integrate-with-fricas-as-algorithm-fresnel_sin-called/

I thought I should enter a ticket to better track this.

I am using



```
sage: version()
    'SageMath version 8.5.beta2, Release Date: 2018-11-01'
```



Here is the problem. When I type



```
from sympy import fresnelc, fresnels
var('a b c d e m n x ')
r=integrate(x^7*fresnels(b*x),x,algorithm="fricas")

```


sage gives the error



```
TypeError: An error occurred when FriCAS there are no library operations named fresnel_sin in Fricas?

```


But FriCAS does not have fresnel_sin. It has fresnelS and fresnelC , link 

http://fricas.github.io/api/FloatLiouvilianFunctions.html


When running the same command inside Fricas 1.3.4 itself, it works OK



```
integrate(x^7*fresnelS(b*x),x)   

   (3)
                                    2     2
             5   2 5               b %pi x       8   4 8
       (- 7 b %pi x  + 105 b x)sin(--------) + (b %pi x  - 105)fresnelS(b x)
                                       2
     + 
                                    2     2
         7   3 7       3     3     b %pi x
       (b %pi x  - 35 b %pi x )cos(--------)
                                       2
  /
        8   4
     8 b %pi

```


Why the error says when FriCAS evaluated '((x)^(7))*(fresnel_sin((b)*(x)))' when Fricas itself does not have this function?

Notice that there is no problem using default integrate algorithm in sage



```
sage: integrate(x^7*fresnels(b*x),x)
1/8*x^8*fresnel_sin(b*x) - 1/16*sqrt(1/2)*((105*I + 105)*(1/4)^(1/4)*pi*erf(sqrt(1/2*I*pi)*b*x) - (105*I - 105)*(1/4)^(1/4)*pi*erf(sqrt(-1/2*I*pi)*b*x) - 4*(sqrt(1/2)*pi^4*b^7*x^7 - 35*sqrt(1/2)*pi^2*b^3*x^3)*cos(1/2*pi*b^2*x^2) + 28*(sqrt(1/2)*pi^3*b^5*x^5 - 15*sqrt(1/2)*pi*b*x)*sin(1/2*pi*b^2*x^2))/(pi^5*b^8)

```



---

Comment by mantepse created at 2018-11-24 07:37:34

I think that this was just fixed in #26746:


```
sage: from sympy import fresnelc, fresnels
sage: var('a b c d e m n x ')
sage: integrate(x^7*fresnels(b*x),x,algorithm="fricas")
1/8*((pi^3*b^7*x^7 - 35*pi*b^3*x^3)*cos(1/2*pi*b^2*x^2) + (pi^4*b^8*x^8 - 105)*fresnel_sin(b*x) - 7*(pi^2*b^5*x^5 - 15*b*x)*sin(1/2*pi*b^2*x^2))/(pi^4*b^8)
```



---

Comment by mantepse created at 2018-11-24 07:38:19

Changing status from new to needs_review.


---

Comment by chapoton created at 2018-11-24 08:01:56

Changing status from needs_review to positive_review.


---

Comment by @nasser1 created at 2018-11-28 08:51:19

Thanks. This is confirmed fixed in 

 

```
SageMath version 8.5.beta5, Release Date: 2018-11-25   
```

 


```
sage: from sympy import fresnelc, fresnels
sage: var('a b c d e m n x ')
sage: integrate(x^7*fresnels(b*x),x,algorithm="fricas")

1/8*((pi^3*b^7*x^7 - 35*pi*b^3*x^3)*cos(1/2*pi*b^2*x^2) + (pi^4*b^8*x^8 - 105)*fresnel_sin(b*x) - 7*(pi^2*b^5*x^5 - 15*b*x)*sin(1/2*pi*b^2*x^2))/(pi^4*b^8)
sage: 


```



---

Comment by slelievre created at 2019-02-15 04:17:00

Changing keywords from "fricas fresnel" to "fricas, fresnel, integrate".


---

Comment by embray created at 2019-02-26 13:58:00

Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.


---

Comment by embray created at 2019-02-26 13:58:00

Resolution: invalid
