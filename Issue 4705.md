# Issue 4705: Make in-line wysiwyg editor for text cells using TinyMCE

archive/issues_004705.json:
```json
{
    "body": "Assignee: boothby\n\nThis ticket splits off part of #4267.\n\nIt depends on #4704\n\nIssue created by migration from https://trac.sagemath.org/ticket/4705\n\n",
    "created_at": "2008-12-05T01:13:31Z",
    "labels": [
        "component: notebook",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-3.3",
    "title": "Make in-line wysiwyg editor for text cells using TinyMCE",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/4705",
    "user": "https://github.com/jasongrout"
}
```
Assignee: boothby

This ticket splits off part of #4267.

It depends on #4704

Issue created by migration from https://trac.sagemath.org/ticket/4705





---

archive/issue_comments_035385.json:
```json
{
    "body": "Attachment [tinymce-editable.patch](tarball://root/attachments/some-uuid/ticket4705/tinymce-editable.patch) by @jasongrout created at 2008-12-05 01:13:43",
    "created_at": "2008-12-05T01:13:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35385",
    "user": "https://github.com/jasongrout"
}
```

Attachment [tinymce-editable.patch](tarball://root/attachments/some-uuid/ticket4705/tinymce-editable.patch) by @jasongrout created at 2008-12-05 01:13:43



---

archive/issue_comments_035386.json:
```json
{
    "body": "The spkg is at http://sage.math.washington.edu/home/jason/notebook/tinyMCE-3.2.0.2.spkg",
    "created_at": "2008-12-05T01:14:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35386",
    "user": "https://github.com/jasongrout"
}
```

The spkg is at http://sage.math.washington.edu/home/jason/notebook/tinyMCE-3.2.0.2.spkg



---

archive/issue_comments_035387.json:
```json
{
    "body": "Changing assignee from boothby to @jasongrout.",
    "created_at": "2008-12-05T01:15:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35387",
    "user": "https://github.com/jasongrout"
}
```

Changing assignee from boothby to @jasongrout.



---

archive/issue_comments_035388.json:
```json
{
    "body": "Changing status from new to assigned.",
    "created_at": "2008-12-05T01:15:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35388",
    "user": "https://github.com/jasongrout"
}
```

Changing status from new to assigned.



---

archive/issue_comments_035389.json:
```json
{
    "body": "Works for me Apply #4674, #3767, #4704, #4705",
    "created_at": "2008-12-20T21:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35389",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

Works for me Apply #4674, #3767, #4704, #4705



---

archive/issue_comments_035390.json:
```json
{
    "body": "Changing type from defect to enhancement.",
    "created_at": "2008-12-20T21:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35390",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

Changing type from defect to enhancement.



---

archive/issue_comments_035391.json:
```json
{
    "body": "This needs to be tested with a wide variety of browsers and OS combinations before this goes in. So please list what browser/OS combo worked for you.\n\nIt will likely have to wait for 3.4 anyway.\n\nCheers,\n\nMichael",
    "created_at": "2008-12-20T21:18:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35391",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

This needs to be tested with a wide variety of browsers and OS combinations before this goes in. So please list what browser/OS combo worked for you.

It will likely have to wait for 3.4 anyway.

Cheers,

Michael



---

archive/issue_comments_035392.json:
```json
{
    "body": "SHIFT-CLICK on new cell bar doesn't work in Safari on Mac.",
    "created_at": "2008-12-20T21:24:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35392",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

SHIFT-CLICK on new cell bar doesn't work in Safari on Mac.



---

archive/issue_comments_035393.json:
```json
{
    "body": "This is likely due to bugs in the extendedclicks jquery plugin.  The author is willing to work on this, we just need to isolate the problem.",
    "created_at": "2008-12-20T21:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35393",
    "user": "https://github.com/jasongrout"
}
```

This is likely due to bugs in the extendedclicks jquery plugin.  The author is willing to work on this, we just need to isolate the problem.



---

archive/issue_comments_035394.json:
```json
{
    "body": "The bugs in Safari are not from the extendedclicks jquery plugin.  Timothy let me have access to his mac the other day and we determined that it has to do with Safari not evaluating javascript in any html that is inserted into the DOM on-the-fly.  Basically, in this patch, the new cell bar code has been changed from a mousedown event in the html code to a separate javascript function.  That javascript function is not evaluated by default in Safari (but is in FF).  So we need to add the html to the DOM, and then explicitly evaluate the javascript.  There is code to something similar to this, and I'm working on modifications to the patch.",
    "created_at": "2008-12-22T17:30:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35394",
    "user": "https://github.com/jasongrout"
}
```

The bugs in Safari are not from the extendedclicks jquery plugin.  Timothy let me have access to his mac the other day and we determined that it has to do with Safari not evaluating javascript in any html that is inserted into the DOM on-the-fly.  Basically, in this patch, the new cell bar code has been changed from a mousedown event in the html code to a separate javascript function.  That javascript function is not evaluated by default in Safari (but is in FF).  So we need to add the html to the DOM, and then explicitly evaluate the javascript.  There is code to something similar to this, and I'm working on modifications to the patch.



---

archive/issue_comments_035395.json:
```json
{
    "body": "Some documentation:\n\nhttp://www.vulgarisoip.com/2007/06/22/execute-javascript-injected-using-innerhtml-attribute-even-with-safari/\n\nhttp://piecesofrakesh.blogspot.com/2008/10/understanding-eval-scope-spoiler-its.html\n\nhttp://snipplr.com/view/2325/ajax-insert-dynamic-script-into-head/\n\nhttp://www.webdeveloper.com/forum/archive/index.php/t-117817.html\n\nhttp://www.webmaster-talk.com/javascript-forum/116306-safari-pc-3-0-4-css.html\n\nhttp://www.optimalworks.net/blog/2007/web-development/javascript/innerhtml-alternative\n\nhttp://zeta-puppis.com/2006/03/07/javascript-script-execution-in-innerhtml-the-revenge/",
    "created_at": "2008-12-22T21:17:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35395",
    "user": "https://github.com/jasongrout"
}
```

Some documentation:

http://www.vulgarisoip.com/2007/06/22/execute-javascript-injected-using-innerhtml-attribute-even-with-safari/

http://piecesofrakesh.blogspot.com/2008/10/understanding-eval-scope-spoiler-its.html

http://snipplr.com/view/2325/ajax-insert-dynamic-script-into-head/

http://www.webdeveloper.com/forum/archive/index.php/t-117817.html

http://www.webmaster-talk.com/javascript-forum/116306-safari-pc-3-0-4-css.html

http://www.optimalworks.net/blog/2007/web-development/javascript/innerhtml-alternative

http://zeta-puppis.com/2006/03/07/javascript-script-execution-in-innerhtml-the-revenge/



---

archive/issue_comments_035396.json:
```json
{
    "body": "Attachment [safari-fix.patch](tarball://root/attachments/some-uuid/ticket4705/safari-fix.patch) by @jasongrout created at 2008-12-22 23:06:03\n\napply on top of previous patch",
    "created_at": "2008-12-22T23:06:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35396",
    "user": "https://github.com/jasongrout"
}
```

Attachment [safari-fix.patch](tarball://root/attachments/some-uuid/ticket4705/safari-fix.patch) by @jasongrout created at 2008-12-22 23:06:03

apply on top of previous patch



---

archive/issue_comments_035397.json:
```json
{
    "body": "safari-fix seems to take care of all of the Safari issues.\n\nOkay, everyone, hit this with everything that you have.  I've also updated the tinyMCE spkg (available from the above URL) to make the default font style inherit from the notebook.",
    "created_at": "2008-12-22T23:07:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35397",
    "user": "https://github.com/jasongrout"
}
```

safari-fix seems to take care of all of the Safari issues.

Okay, everyone, hit this with everything that you have.  I've also updated the tinyMCE spkg (available from the above URL) to make the default font style inherit from the notebook.



---

archive/issue_comments_035398.json:
```json
{
    "body": "Works with FF 3.0.5 and Safari on Mac OS X.",
    "created_at": "2008-12-22T23:11:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35398",
    "user": "https://trac.sagemath.org/admin/accounts/users/TimothyClemans"
}
```

Works with FF 3.0.5 and Safari on Mac OS X.



---

archive/issue_comments_035399.json:
```json
{
    "body": "To test this on supported browsers, we should test it on Firefox, Opera, and Safari.  I've tested it on FF 3.0.5 on Ubuntu 8.10 and the tinyMCE spkg and this patch seem to work okay.",
    "created_at": "2008-12-22T23:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35399",
    "user": "https://github.com/jasongrout"
}
```

To test this on supported browsers, we should test it on Firefox, Opera, and Safari.  I've tested it on FF 3.0.5 on Ubuntu 8.10 and the tinyMCE spkg and this patch seem to work okay.



---

archive/issue_comments_035400.json:
```json
{
    "body": "Here are complete instructions to apply and test the tinymce patch:\n\nApply the following patches from 4674, 3767, 4704, and 4705, in order:\n\njsmath-spkg.patch\njquery-and-friends-spkg.2.patch\njquery-javascript-cleanup.patch\ntinymce-editable.patch\nsafari-fix.patch\n\nInstall the following packages from the above tickets.  You may have to do ./sage -f <spkg URL> to force an installation if you've already installed an spkg.\n\nhttp://sage.math.washington.edu/home/jason/notebook/jquery-1.2.6.spkg\nhttp://sage.math.washington.edu/home/jason/notebook/jqueryui-1.6r807svn.spkg\nhttp://sage.math.washington.edu/home/jason/notebook/jsmath-3.6a.spkg\nhttp://sage.math.washington.edu/home/jason/notebook/tinyMCE-3.2.0.2.spkg\n\nOptionally, you can also install the jsmath image fonts by installing:\nhttp://sage.math.washington.edu/home/jason/notebook/jsmath-image-fonts-1.3p0.spkg\n\nNow you should be able to shift-click on a new cell bar to create a text cell using tinyMCE.  You should also be able to double-click on an existing text cell to edit it in-place.",
    "created_at": "2008-12-24T14:19:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35400",
    "user": "https://github.com/jasongrout"
}
```

Here are complete instructions to apply and test the tinymce patch:

Apply the following patches from 4674, 3767, 4704, and 4705, in order:

jsmath-spkg.patch
jquery-and-friends-spkg.2.patch
jquery-javascript-cleanup.patch
tinymce-editable.patch
safari-fix.patch

Install the following packages from the above tickets.  You may have to do ./sage -f <spkg URL> to force an installation if you've already installed an spkg.

http://sage.math.washington.edu/home/jason/notebook/jquery-1.2.6.spkg
http://sage.math.washington.edu/home/jason/notebook/jqueryui-1.6r807svn.spkg
http://sage.math.washington.edu/home/jason/notebook/jsmath-3.6a.spkg
http://sage.math.washington.edu/home/jason/notebook/tinyMCE-3.2.0.2.spkg

Optionally, you can also install the jsmath image fonts by installing:
http://sage.math.washington.edu/home/jason/notebook/jsmath-image-fonts-1.3p0.spkg

Now you should be able to shift-click on a new cell bar to create a text cell using tinyMCE.  You should also be able to double-click on an existing text cell to edit it in-place.



---

archive/issue_comments_035401.json:
```json
{
    "body": "I tested this on Safari and Firefox on OS X (10.5).  Everything looks good to me so far.  I will keep using this and see if I run into any problems.\n\n-Marshall",
    "created_at": "2008-12-24T16:17:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35401",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

I tested this on Safari and Firefox on OS X (10.5).  Everything looks good to me so far.  I will keep using this and see if I run into any problems.

-Marshall



---

archive/issue_comments_035402.json:
```json
{
    "body": "The spkg looks good to me. A slightly cleaned up version is at\n\nhttp://sage.math.washington.edu/home/mabshoff/spkgs/tinyMCE-3.2.0.2.p0.spkg\n\nCheers,\n\nMichael",
    "created_at": "2008-12-24T17:47:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35402",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

The spkg looks good to me. A slightly cleaned up version is at

http://sage.math.washington.edu/home/mabshoff/spkgs/tinyMCE-3.2.0.2.p0.spkg

Cheers,

Michael



---

archive/issue_comments_035403.json:
```json
{
    "body": "I followed the instructions in [comment:14 comment 14] and there's at least one small problem. If I shift-click on the new cell bar, I get the TinyMCE editor thingy. If I click \"cancel\" without entering any text, the tooltip text (\"Doubleclick to edit...\") gets put into a text cell at that location.\n\nIf I choose \"Edit\" at the top, the text \"Doubleclick to edit...\" doesn't show up in the notebook, and if I click \"Save changes\", the extraneous text goes away.\n\nThis happens in Firefox, Opera, IE7, and Chrome. I applied all the patches and spkgs to 3.2.3.",
    "created_at": "2009-01-09T02:18:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35403",
    "user": "https://github.com/dandrake"
}
```

I followed the instructions in [comment:14 comment 14] and there's at least one small problem. If I shift-click on the new cell bar, I get the TinyMCE editor thingy. If I click "cancel" without entering any text, the tooltip text ("Doubleclick to edit...") gets put into a text cell at that location.

If I choose "Edit" at the top, the text "Doubleclick to edit..." doesn't show up in the notebook, and if I click "Save changes", the extraneous text goes away.

This happens in Firefox, Opera, IE7, and Chrome. I applied all the patches and spkgs to 3.2.3.



---

archive/issue_comments_035404.json:
```json
{
    "body": "Replying to [comment:17 ddrake]:\n> I followed the instructions in [comment:14 comment 14] and there's at least one small problem. If I shift-click on the new cell bar, I get the TinyMCE editor thingy. If I click \"cancel\" without entering any text, the tooltip text (\"Doubleclick to edit...\") gets put into a text cell at that location.\n> \n> If I choose \"Edit\" at the top, the text \"Doubleclick to edit...\" doesn't show up in the notebook, and if I click \"Save changes\", the extraneous text goes away.\n> \n> This happens in Firefox, Opera, IE7, and Chrome. I applied all the patches and spkgs to 3.2.3.\n\nYes, that sounds like the intended behavior.  Whether or not that should be what happens may be up for debate, though.  The idea is that if you create a text cell, but put nothing in it, it is impossible to edit by double-clicking.  If you make any edits to the cell, though, the filler text goes away.",
    "created_at": "2009-01-09T02:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35404",
    "user": "https://github.com/jasongrout"
}
```

Replying to [comment:17 ddrake]:
> I followed the instructions in [comment:14 comment 14] and there's at least one small problem. If I shift-click on the new cell bar, I get the TinyMCE editor thingy. If I click "cancel" without entering any text, the tooltip text ("Doubleclick to edit...") gets put into a text cell at that location.
> 
> If I choose "Edit" at the top, the text "Doubleclick to edit..." doesn't show up in the notebook, and if I click "Save changes", the extraneous text goes away.
> 
> This happens in Firefox, Opera, IE7, and Chrome. I applied all the patches and spkgs to 3.2.3.

Yes, that sounds like the intended behavior.  Whether or not that should be what happens may be up for debate, though.  The idea is that if you create a text cell, but put nothing in it, it is impossible to edit by double-clicking.  If you make any edits to the cell, though, the filler text goes away.



---

archive/issue_comments_035405.json:
```json
{
    "body": "Replying to [comment:18 jason]:\n> Replying to [comment:17 ddrake]:\n> > I followed the instructions in [comment:14 comment 14] and there's at least one small problem. If I shift-click on the new cell bar, I get the TinyMCE editor thingy. If I click \"cancel\" without entering any text, the tooltip text (\"Doubleclick to edit...\") gets put into a text cell at that location.\n> > \n> > If I choose \"Edit\" at the top, the text \"Doubleclick to edit...\" doesn't show up in the notebook, and if I click \"Save changes\", the extraneous text goes away.\n> > \n> > This happens in Firefox, Opera, IE7, and Chrome. I applied all the patches and spkgs to 3.2.3.\n> \n> Yes, that sounds like the intended behavior.  Whether or not that should be what happens may be up for debate, though.  The idea is that if you create a text cell, but put nothing in it, it is impossible to edit by double-clicking.  If you make any edits to the cell, though, the filler text goes away.\n> \n\nHrm, it may be intended, but I don't like it at all. When I clicked \"cancel\", I wanted the entire business -- text cell and all -- to go away and, well, be cancelled. I had done one thing (shift-click) and when I clicked cancel, I wanted that one thing to be undone. I do see your point though, that shift-clicking (1) creates a text cell, and (2) starts the tinymce editor on it -- and the cancel button cancels (2).\n\nI'm also bothered by the text being \"ghostly\", in that you see it when viewing the notebook normally, but it doesn't show up in the usual text-based \"Edit\".",
    "created_at": "2009-01-09T10:41:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35405",
    "user": "https://github.com/dandrake"
}
```

Replying to [comment:18 jason]:
> Replying to [comment:17 ddrake]:
> > I followed the instructions in [comment:14 comment 14] and there's at least one small problem. If I shift-click on the new cell bar, I get the TinyMCE editor thingy. If I click "cancel" without entering any text, the tooltip text ("Doubleclick to edit...") gets put into a text cell at that location.
> > 
> > If I choose "Edit" at the top, the text "Doubleclick to edit..." doesn't show up in the notebook, and if I click "Save changes", the extraneous text goes away.
> > 
> > This happens in Firefox, Opera, IE7, and Chrome. I applied all the patches and spkgs to 3.2.3.
> 
> Yes, that sounds like the intended behavior.  Whether or not that should be what happens may be up for debate, though.  The idea is that if you create a text cell, but put nothing in it, it is impossible to edit by double-clicking.  If you make any edits to the cell, though, the filler text goes away.
> 

Hrm, it may be intended, but I don't like it at all. When I clicked "cancel", I wanted the entire business -- text cell and all -- to go away and, well, be cancelled. I had done one thing (shift-click) and when I clicked cancel, I wanted that one thing to be undone. I do see your point though, that shift-clicking (1) creates a text cell, and (2) starts the tinymce editor on it -- and the cancel button cancels (2).

I'm also bothered by the text being "ghostly", in that you see it when viewing the notebook normally, but it doesn't show up in the usual text-based "Edit".



---

archive/issue_comments_035406.json:
```json
{
    "body": "I have tested this and it appears to work fine with the following browser/OS combinations:\n\nUbuntu 8.10:\n\n* Firefox 3.0\n\nWin XP SP3:\n\n* Firefox 3.1 beta\n* IE 7\n* Opera (whatever the current version is)\n* Chrome\n\nOS X 10.5:\n\n* Firefox 3.0\n* Safari\n\nJust to screw around, I tried [iCab](http://www.icab.de/), which edited existing fields just fine, but the shift-click on the new cell bar didn't work. I think we can safely ignore the iCab browser market. :)",
    "created_at": "2009-01-09T12:26:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35406",
    "user": "https://github.com/dandrake"
}
```

I have tested this and it appears to work fine with the following browser/OS combinations:

Ubuntu 8.10:

* Firefox 3.0

Win XP SP3:

* Firefox 3.1 beta
* IE 7
* Opera (whatever the current version is)
* Chrome

OS X 10.5:

* Firefox 3.0
* Safari

Just to screw around, I tried [iCab](http://www.icab.de/), which edited existing fields just fine, but the shift-click on the new cell bar didn't work. I think we can safely ignore the iCab browser market. :)



---

archive/issue_comments_035407.json:
```json
{
    "body": "> I'm also bothered by the text being \"ghostly\", in that you see it when \n> viewing the notebook normally, but it doesn't show up in the usual text-based \"Edit\". \n\nI do not like either.  Actually, I'm very puzzled how it is possible that it wouldn't show up in Edit, since when one quits a notebook server and restarts it later, worksheets are loaded from disk entirely using their plane text representation (i.e., what you see in Edit), so it seems to me that if the text created is indeed \"ghostly\" as you claim, it will surely vanish when the server is restarted.",
    "created_at": "2009-01-10T20:53:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35407",
    "user": "https://github.com/williamstein"
}
```

> I'm also bothered by the text being "ghostly", in that you see it when 
> viewing the notebook normally, but it doesn't show up in the usual text-based "Edit". 

I do not like either.  Actually, I'm very puzzled how it is possible that it wouldn't show up in Edit, since when one quits a notebook server and restarts it later, worksheets are loaded from disk entirely using their plane text representation (i.e., what you see in Edit), so it seems to me that if the text created is indeed "ghostly" as you claim, it will surely vanish when the server is restarted.



---

archive/issue_comments_035408.json:
```json
{
    "body": "Maybe there is some confusion here - I think the only \"ghostly\" stuff is the \"Doubleclick to edit...\" message.  It doesn't appear in a view-page-source window.  It does block cell mergers.  It goes away after switching to Edit and saving, but not switching to Edit and canceling.  \n\nI don't think this annoyance is enough to block the inclusion of this functionality - I think we should put it in and make a follow-up ticket to try to change this.  It should be possible to easily delete at least.",
    "created_at": "2009-01-10T23:10:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35408",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

Maybe there is some confusion here - I think the only "ghostly" stuff is the "Doubleclick to edit..." message.  It doesn't appear in a view-page-source window.  It does block cell mergers.  It goes away after switching to Edit and saving, but not switching to Edit and canceling.  

I don't think this annoyance is enough to block the inclusion of this functionality - I think we should put it in and make a follow-up ticket to try to change this.  It should be possible to easily delete at least.



---

archive/issue_comments_035409.json:
```json
{
    "body": "In trying to track down some of the behavior discussed above, I noticed that normal text cells (i.e. non-ghostly ones, with some content) do not have unique ids.  I am not sure if that is relevant to the ghost issue but it does seem like a bad thing and may induce other bugs.  I.e. normal executable cells have and outer id such as \"cell_outer_1\" and an inner id such as \"cell_1\".  The text cells have nested div elements with identical ids, for example both being \"cell_text_1\".",
    "created_at": "2009-01-11T00:11:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35409",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

In trying to track down some of the behavior discussed above, I noticed that normal text cells (i.e. non-ghostly ones, with some content) do not have unique ids.  I am not sure if that is relevant to the ghost issue but it does seem like a bad thing and may induce other bugs.  I.e. normal executable cells have and outer id such as "cell_outer_1" and an inner id such as "cell_1".  The text cells have nested div elements with identical ids, for example both being "cell_text_1".



---

archive/issue_comments_035410.json:
```json
{
    "body": "The ghostly text that is referred to is a TinyMCE setting.  Check the configuration for TinyMCE, right after the TinyMCE is included as a javascript file.  Somewhere in those configuration settings, there is the text \"Double click to edit\" (or whatever the text is).",
    "created_at": "2009-01-11T00:23:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35410",
    "user": "https://github.com/jasongrout"
}
```

The ghostly text that is referred to is a TinyMCE setting.  Check the configuration for TinyMCE, right after the TinyMCE is included as a javascript file.  Somewhere in those configuration settings, there is the text "Double click to edit" (or whatever the text is).



---

archive/issue_comments_035411.json:
```json
{
    "body": "Here are the things that still need to be done to get this in.\n\n* testing with IE 6 on Windows\n* testing with FF 2.0.x on Windows, OSX and Linux\n* testing with Safari on 10.4\n* testing with Opera 9.5 on OSX,  Linux\n* review of the patches themselves\n* review of mabshoff's changes to the spkgs\n* trivial one-line patch to fix the \"ghostly text\" issue (just make the placeholder string the empty string in cell.py (search for \"placeholder\" in cell.py).\n* (maybe can wait for another patch): figure out what is going on with divs with the same id.  My guess is that it is an issue with setting the innerHTMl of an object, rather than replacing the object itself.  When the page is \"Edit\"ed and then reloaded, the duplicate nested IDs go away.  This points to the javascript code that inserts text cells as the problem.\n\nFrom mabshoff:\n> In the end having your assurance that you will available to fix some\n> of the inevitable issues would also be assuring.\n\nYou have my assurance.",
    "created_at": "2009-01-13T15:54:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35411",
    "user": "https://github.com/jasongrout"
}
```

Here are the things that still need to be done to get this in.

* testing with IE 6 on Windows
* testing with FF 2.0.x on Windows, OSX and Linux
* testing with Safari on 10.4
* testing with Opera 9.5 on OSX,  Linux
* review of the patches themselves
* review of mabshoff's changes to the spkgs
* trivial one-line patch to fix the "ghostly text" issue (just make the placeholder string the empty string in cell.py (search for "placeholder" in cell.py).
* (maybe can wait for another patch): figure out what is going on with divs with the same id.  My guess is that it is an issue with setting the innerHTMl of an object, rather than replacing the object itself.  When the page is "Edit"ed and then reloaded, the duplicate nested IDs go away.  This points to the javascript code that inserts text cells as the problem.

From mabshoff:
> In the end having your assurance that you will available to fix some
> of the inevitable issues would also be assuring.

You have my assurance.



---

archive/issue_comments_035412.json:
```json
{
    "body": "It seems a little too demanding to ask that this works on IE 6 on Windows.  Other things don't work on that platform either, or are a little strange.  Is that really officially supported?  If so there should be a lot of tickets for it.  \n\nOn Safari on OS 10.4, I had some oddness inserting a text cell at the very top of a worksheet - nothing seemed to happen but when I re-opened it things were OK, the text cell was there.  That should be a followup ticket if anyone can reproduce it, but not enough to block this ticket getting merged in my opinion.\n\nThings seem to work fine on firefox 2.0.0.13 on my mac and windows machines.\n\nThe ghost text problem is gone, but there should be an easy way to delete an empty cell.  Currently if you open the text editor and delete all text, there is still some residual empty text cell that you can't see but which blocks cell mergers.  This can be deleted in \"Edit\" mode for the worksheet but a followup ticket should be made to make it easier.  Again, I don't think that should block this ticket.\n\nI used mabshoff's version of the tinymce spkg, seems fine.  I have not inspected it in detail.",
    "created_at": "2009-01-13T16:47:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35412",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

It seems a little too demanding to ask that this works on IE 6 on Windows.  Other things don't work on that platform either, or are a little strange.  Is that really officially supported?  If so there should be a lot of tickets for it.  

On Safari on OS 10.4, I had some oddness inserting a text cell at the very top of a worksheet - nothing seemed to happen but when I re-opened it things were OK, the text cell was there.  That should be a followup ticket if anyone can reproduce it, but not enough to block this ticket getting merged in my opinion.

Things seem to work fine on firefox 2.0.0.13 on my mac and windows machines.

The ghost text problem is gone, but there should be an easy way to delete an empty cell.  Currently if you open the text editor and delete all text, there is still some residual empty text cell that you can't see but which blocks cell mergers.  This can be deleted in "Edit" mode for the worksheet but a followup ticket should be made to make it easier.  Again, I don't think that should block this ticket.

I used mabshoff's version of the tinymce spkg, seems fine.  I have not inspected it in detail.



---

archive/issue_comments_035413.json:
```json
{
    "body": "Experience on Sage 3.2.1 with all patches and spkgs installed, using PPC OSX.4.\n\nGeneral: Works great, including tables and lists.  Recommend adding the font-size drop-down menu, perhaps also blockquote, to the standard TinyMCE installation for Sage, since presumably these will often be projected in class and finer control of size outside <h1> style tags would be useful.  Only general problems are known issue that Sage text cells are simply area between math cells, and I had some trouble getting added images to actually show up (but that could be me not knowing how to do them right).  So overall positive, and I would say positive review for Safari 3.2.1.  BUT...\n\nOn Firefox 2.0.0.13, encountered *terrible* bug of some kind, was reproducible on my machine.  When a larger text cell was opened using TinyMCE the rendering engine somehow did not do the scrolling properly, and multiple (six, seven, more) images of the same text showed up below or above the text cell; in addition, I could no longer find the editing panel in this situation and only by luck with scrolling found the save/cancel area to even exit this surreal landscape.  This seems to be a major problem, but I have no idea what the issue is, and am puzzled that Marshall did not encounter it.  If this is reproducible, it should probably be a blocker.",
    "created_at": "2009-01-13T20:22:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35413",
    "user": "https://github.com/kcrisman"
}
```

Experience on Sage 3.2.1 with all patches and spkgs installed, using PPC OSX.4.

General: Works great, including tables and lists.  Recommend adding the font-size drop-down menu, perhaps also blockquote, to the standard TinyMCE installation for Sage, since presumably these will often be projected in class and finer control of size outside <h1> style tags would be useful.  Only general problems are known issue that Sage text cells are simply area between math cells, and I had some trouble getting added images to actually show up (but that could be me not knowing how to do them right).  So overall positive, and I would say positive review for Safari 3.2.1.  BUT...

On Firefox 2.0.0.13, encountered *terrible* bug of some kind, was reproducible on my machine.  When a larger text cell was opened using TinyMCE the rendering engine somehow did not do the scrolling properly, and multiple (six, seven, more) images of the same text showed up below or above the text cell; in addition, I could no longer find the editing panel in this situation and only by luck with scrolling found the save/cancel area to even exit this surreal landscape.  This seems to be a major problem, but I have no idea what the issue is, and am puzzled that Marshall did not encounter it.  If this is reproducible, it should probably be a blocker.



---

archive/issue_comments_035414.json:
```json
{
    "body": "I could not reproduce the larger text cell problem.  Could you post an sws file somewhere that shows that behavior?  How big are you talking about?  I've pasted in a couple of pages worth of text of different types and didn't have a problem.",
    "created_at": "2009-01-13T20:59:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35414",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

I could not reproduce the larger text cell problem.  Could you post an sws file somewhere that shows that behavior?  How big are you talking about?  I've pasted in a couple of pages worth of text of different types and didn't have a problem.



---

archive/issue_comments_035415.json:
```json
{
    "body": "I tested Firefox 2.0.0.20 on Ubuntu Hardy and it appears to work fine. I couldn't reproduce the large text cell problem reported by kcrisman.\n\nNote that Firefox 2.0 has apparently been EOL'ed: [http://www.mozilla.com/en-US/firefox/all-older.html](http://www.mozilla.com/en-US/firefox/all-older.html). How long should we continue testing on that browser? (I'm not being sarcastic, I'm genuinely curious.)",
    "created_at": "2009-01-14T01:22:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35415",
    "user": "https://github.com/dandrake"
}
```

I tested Firefox 2.0.0.20 on Ubuntu Hardy and it appears to work fine. I couldn't reproduce the large text cell problem reported by kcrisman.

Note that Firefox 2.0 has apparently been EOL'ed: [http://www.mozilla.com/en-US/firefox/all-older.html](http://www.mozilla.com/en-US/firefox/all-older.html). How long should we continue testing on that browser? (I'm not being sarcastic, I'm genuinely curious.)



---

archive/issue_comments_035416.json:
```json
{
    "body": "Replying to [comment:29 ddrake]:\n> I tested Firefox 2.0.0.20 on Ubuntu Hardy and it appears to work fine. I couldn't reproduce the large text cell problem reported by kcrisman.\n> \n> Note that Firefox 2.0 has apparently been EOL'ed: [http://www.mozilla.com/en-US/firefox/all-older.html](http://www.mozilla.com/en-US/firefox/all-older.html). How long should we continue testing on that browser? (I'm not being sarcastic, I'm genuinely curious.)\n\nI updated to 2.0.0.20 and the problem persists. However, I downloaded FF3.0.5 and the problem is not there, so it's definitely FF2-specific.  My guess is that a lot of people using FF only on occasion (which might be quite a few PC and Mac people, as opposed to Linux) may not even be aware that FF3 is out there (it was very dimly on my radar), so it would be worth at least some testing.\n\n[Here is a worksheet](http://www.math.uchicago.edu/~crisman/TinyMCE_Test.sws) - click on the \"Here is a problem\" area and then scroll up and down, assuming that area appears toward the bottom of your initial browser window.\n\nI am not sure what the problem is - presumably something Aqua+OSX.4+PPC+FF2 related.  It would be nice for people to check out whether this problem shows up in any other less heavily used browsers - Konqueror, for example, if that's still in use.  If this is the only place it happens, perhaps it's not the worst thing ever - though it IS really hard to use in this one case.",
    "created_at": "2009-01-14T17:04:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35416",
    "user": "https://github.com/kcrisman"
}
```

Replying to [comment:29 ddrake]:
> I tested Firefox 2.0.0.20 on Ubuntu Hardy and it appears to work fine. I couldn't reproduce the large text cell problem reported by kcrisman.
> 
> Note that Firefox 2.0 has apparently been EOL'ed: [http://www.mozilla.com/en-US/firefox/all-older.html](http://www.mozilla.com/en-US/firefox/all-older.html). How long should we continue testing on that browser? (I'm not being sarcastic, I'm genuinely curious.)

I updated to 2.0.0.20 and the problem persists. However, I downloaded FF3.0.5 and the problem is not there, so it's definitely FF2-specific.  My guess is that a lot of people using FF only on occasion (which might be quite a few PC and Mac people, as opposed to Linux) may not even be aware that FF3 is out there (it was very dimly on my radar), so it would be worth at least some testing.

[Here is a worksheet](http://www.math.uchicago.edu/~crisman/TinyMCE_Test.sws) - click on the "Here is a problem" area and then scroll up and down, assuming that area appears toward the bottom of your initial browser window.

I am not sure what the problem is - presumably something Aqua+OSX.4+PPC+FF2 related.  It would be nice for people to check out whether this problem shows up in any other less heavily used browsers - Konqueror, for example, if that's still in use.  If this is the only place it happens, perhaps it's not the worst thing ever - though it IS really hard to use in this one case.



---

archive/issue_comments_035417.json:
```json
{
    "body": "I guess I can reproduce this - if I edit your \"Here is a problem area\" text cell, and then try to scroll the entire worksheet, the lower cells get messed up - sort of like tracers.  This is not good, but doesn't seem awful to me - if you are editing a text cell, you usually don't need to scroll around the whole worksheet?  \n\nLike some other things mentioned in this ticket, I think this deserves a followup ticket but shouldn't block the inclusion of this.  I think the only reason to block this patch is if it messes up some existing functionality or doctests.",
    "created_at": "2009-01-15T01:30:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35417",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

I guess I can reproduce this - if I edit your "Here is a problem area" text cell, and then try to scroll the entire worksheet, the lower cells get messed up - sort of like tracers.  This is not good, but doesn't seem awful to me - if you are editing a text cell, you usually don't need to scroll around the whole worksheet?  

Like some other things mentioned in this ticket, I think this deserves a followup ticket but shouldn't block the inclusion of this.  I think the only reason to block this patch is if it messes up some existing functionality or doctests.



---

archive/issue_events_010760.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-01-15T01:37:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "milestone": "sage-3.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4705#event-10760"
}
```



---

archive/issue_comments_035418.json:
```json
{
    "body": "Replying to [comment:31 mhampton]:\n\n> Like some other things mentioned in this ticket, I think this deserves a followup ticket but shouldn't block the inclusion of this.  I think the only reason to block this patch is if it messes up some existing functionality or doctests.\n\nYes, if the patch here in question does not mess up existing functionality, but has issues with the new functionality with some browsers this can be dealt with via a followup ticket. Getting this in working 99% now is much better than it bitrotting and I think Jason will be much happier, too :)\n\nSo someone give this a final positive review and it is in.\n\nCheers,\n\nMichael",
    "created_at": "2009-01-15T01:37:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35418",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

Replying to [comment:31 mhampton]:

> Like some other things mentioned in this ticket, I think this deserves a followup ticket but shouldn't block the inclusion of this.  I think the only reason to block this patch is if it messes up some existing functionality or doctests.

Yes, if the patch here in question does not mess up existing functionality, but has issues with the new functionality with some browsers this can be dealt with via a followup ticket. Getting this in working 99% now is much better than it bitrotting and I think Jason will be much happier, too :)

So someone give this a final positive review and it is in.

Cheers,

Michael



---

archive/issue_comments_035419.json:
```json
{
    "body": "I think now that people have hit this on a variety of platform combinations it should be merged.  Whatever alpha or release candidate it comes out on, I think it should be highlighted as something people should pound on, and we can make the necessary followup tickets.  But to move this forward it should go in.",
    "created_at": "2009-01-15T02:10:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35419",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

I think now that people have hit this on a variety of platform combinations it should be merged.  Whatever alpha or release candidate it comes out on, I think it should be highlighted as something people should pound on, and we can make the necessary followup tickets.  But to move this forward it should go in.



---

archive/issue_comments_035420.json:
```json
{
    "body": "Replying to [comment:33 mhampton]:\n> I think now that people have hit this on a variety of platform combinations it should be merged.  Whatever alpha or release candidate it comes out on, I think it should be highlighted as something people should pound on, and we can make the necessary followup tickets.  But to move this forward it should go in.\nI wasn't sure how picky to be.  Yes, and mabshoff's comment about Jason not wanting bitrot is certainly reasonable.\n\nDoes this mean that \n\n>   * testing with IE 6 on Windows\n>   * testing with Opera 9.5 on OSX,  Linux\n>   * review of the patches themselves\n>   * review of mabshoff's changes to the spkgs\n\nis all done?  I only looked at functionality, not the code.  \n\nLet the followup tickets begin!",
    "created_at": "2009-01-15T02:19:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35420",
    "user": "https://github.com/kcrisman"
}
```

Replying to [comment:33 mhampton]:
> I think now that people have hit this on a variety of platform combinations it should be merged.  Whatever alpha or release candidate it comes out on, I think it should be highlighted as something people should pound on, and we can make the necessary followup tickets.  But to move this forward it should go in.
I wasn't sure how picky to be.  Yes, and mabshoff's comment about Jason not wanting bitrot is certainly reasonable.

Does this mean that 

>   * testing with IE 6 on Windows
>   * testing with Opera 9.5 on OSX,  Linux
>   * review of the patches themselves
>   * review of mabshoff's changes to the spkgs

is all done?  I only looked at functionality, not the code.  

Let the followup tickets begin!



---

archive/issue_comments_035421.json:
```json
{
    "body": "Most of my entire next week is devoted to Sage at SD12.  FYI, I can certainly make followup tickets to this a priority in the next week.\n\nI most certainly second the comment that Jason will be very happy to see this finally go in!",
    "created_at": "2009-01-15T02:54:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35421",
    "user": "https://github.com/jasongrout"
}
```

Most of my entire next week is devoted to Sage at SD12.  FYI, I can certainly make followup tickets to this a priority in the next week.

I most certainly second the comment that Jason will be very happy to see this finally go in!



---

archive/issue_comments_035422.json:
```json
{
    "body": "Attachment [ghost-text.patch](tarball://root/attachments/some-uuid/ticket4705/ghost-text.patch) by @jasongrout created at 2009-01-16 17:53:16",
    "created_at": "2009-01-16T17:53:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35422",
    "user": "https://github.com/jasongrout"
}
```

Attachment [ghost-text.patch](tarball://root/attachments/some-uuid/ticket4705/ghost-text.patch) by @jasongrout created at 2009-01-16 17:53:16



---

archive/issue_comments_035423.json:
```json
{
    "body": "The ghost-text.patch corrects the ghostly text mentioned above and should be applied on top of the other patches.",
    "created_at": "2009-01-16T17:54:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35423",
    "user": "https://github.com/jasongrout"
}
```

The ghost-text.patch corrects the ghostly text mentioned above and should be applied on top of the other patches.



---

archive/issue_events_010761.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-01-19T08:11:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/4705#event-10761"
}
```



---

archive/issue_comments_035424.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2009-01-19T08:11:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35424",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

Resolution: fixed



---

archive/issue_comments_035425.json:
```json
{
    "body": "Merged tinymce-editable.patch,  safari-fix.patch, ghost-text.patch in Sage 3.3.alpha0.",
    "created_at": "2009-01-19T08:11:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/4705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/4705#issuecomment-35425",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

Merged tinymce-editable.patch,  safari-fix.patch, ghost-text.patch in Sage 3.3.alpha0.
