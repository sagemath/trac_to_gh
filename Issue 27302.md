# Issue 27302: py3: add _reduce__ to eclib modular symbol

archive/issues_027302.json:
```json
{
    "body": "CC:  @embray @jdemeyer @tscrim\n\nto fix the last doctest in schemes/elliptic_curves/\n\nIssue created by migration from https://trac.sagemath.org/ticket/27539\n\n",
    "created_at": "2019-03-23T12:08:29Z",
    "labels": [
        "python3",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.8",
    "title": "py3: add _reduce__ to eclib modular symbol",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27302",
    "user": "@fchapoton"
}
```
CC:  @embray @jdemeyer @tscrim

to fix the last doctest in schemes/elliptic_curves/

Issue created by migration from https://trac.sagemath.org/ticket/27539





---

archive/issue_comments_384950.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-03-23T12:08:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27302#issuecomment-384950",
    "user": "@fchapoton"
}
```

New commits:



---

archive/issue_comments_384951.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-03-23T12:08:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27302#issuecomment-384951",
    "user": "@fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_384952.json:
```json
{
    "body": "green bot, please review",
    "created_at": "2019-03-23T17:22:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27302#issuecomment-384952",
    "user": "@fchapoton"
}
```

green bot, please review



---

archive/issue_comments_384953.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-03-23T22:23:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27302#issuecomment-384953",
    "user": "@tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_384954.json:
```json
{
    "body": "LGTM.",
    "created_at": "2019-03-23T22:23:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27302#issuecomment-384954",
    "user": "@tscrim"
}
```

LGTM.



---

archive/issue_comments_384955.json:
```json
{
    "body": "It might be good if any test for a `__reduce__` method actually demonstrated pickling/unpickling, since that's what this is for.\n\nA more general question though: Although I'm sure there's a good reason, it's not entirely clear from this ticket, or your commit message, why adding this was necessary for Python 3 support?  What exactly is this fixing, and why did this need a special `__reduce__` method when it didn't before?",
    "created_at": "2019-03-25T11:03:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27302#issuecomment-384955",
    "user": "@embray"
}
```

It might be good if any test for a `__reduce__` method actually demonstrated pickling/unpickling, since that's what this is for.

A more general question though: Although I'm sure there's a good reason, it's not entirely clear from this ticket, or your commit message, why adding this was necessary for Python 3 support?  What exactly is this fixing, and why did this need a special `__reduce__` method when it didn't before?



---

archive/issue_comments_384956.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2019-03-25T11:03:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27302#issuecomment-384956",
    "user": "@embray"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_384957.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-03-25T19:43:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27302#issuecomment-384957",
    "user": "@vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_384958.json:
```json
{
    "body": "just noticed that there is more positive review necromancy on this ticket, but the question is imho better suited for sage-devel so how about you take it there?",
    "created_at": "2019-03-25T19:49:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27302#issuecomment-384958",
    "user": "@vbraun"
}
```

just noticed that there is more positive review necromancy on this ticket, but the question is imho better suited for sage-devel so how about you take it there?



---

archive/issue_comments_384959.json:
```json
{
    "body": "Not really--I think Frederic could easily answer my question here.  I don't mind that it was merged but I still think this should be answered better...",
    "created_at": "2019-03-26T11:56:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27302#issuecomment-384959",
    "user": "@embray"
}
```

Not really--I think Frederic could easily answer my question here.  I don't mind that it was merged but I still think this should be answered better...



---

archive/issue_comments_384960.json:
```json
{
    "body": "Set assignee to @fchapoton.",
    "created_at": "2019-03-26T11:56:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27302#issuecomment-384960",
    "user": "@embray"
}
```

Set assignee to @fchapoton.



---

archive/issue_comments_384961.json:
```json
{
    "body": "So I can somewhat answer why I believe there was the necessity. The class is only a subclass of `object`, so it has no pickling support by default, which I think the python behavior changed in regard to how it handles this. My guess is some test was there is a test that uses this as part of its pickle.",
    "created_at": "2019-03-26T13:36:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27302#issuecomment-384961",
    "user": "@tscrim"
}
```

So I can somewhat answer why I believe there was the necessity. The class is only a subclass of `object`, so it has no pickling support by default, which I think the python behavior changed in regard to how it handles this. My guess is some test was there is a test that uses this as part of its pickle.



---

archive/issue_comments_384962.json:
```json
{
    "body": "I still think that information about general py2/3 differences in Sage code should be publicized more widely",
    "created_at": "2019-03-27T08:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27302#issuecomment-384962",
    "user": "@vbraun"
}
```

I still think that information about general py2/3 differences in Sage code should be publicized more widely



---

archive/issue_comments_384963.json:
```json
{
    "body": "I ran the tests for this sub-package on an older Python 3 build and had two test failures, one of which was obviously the one that this ticket was intended to fix, so I have updated the description with that additional info.\n\nThe question you have to ask is *why* does this fail on Python 3 but not on Python 2? I've spent a bit of time looking into it and this is still not entirely clear to me.  This may well be the simplest and most obvious solution, and I have no problem with it on its face.  I'm just a little unsettled by not knowing why this worked before and now doesn't (even with the same pickle protocol it fails).",
    "created_at": "2019-03-27T19:06:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27302#issuecomment-384963",
    "user": "@embray"
}
```

I ran the tests for this sub-package on an older Python 3 build and had two test failures, one of which was obviously the one that this ticket was intended to fix, so I have updated the description with that additional info.

The question you have to ask is *why* does this fail on Python 3 but not on Python 2? I've spent a bit of time looking into it and this is still not entirely clear to me.  This may well be the simplest and most obvious solution, and I have no problem with it on its face.  I'm just a little unsettled by not knowing why this worked before and now doesn't (even with the same pickle protocol it fails).
