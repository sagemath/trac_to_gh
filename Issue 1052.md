# Issue 1052: implement more functionality for class groups of number fields

archive/issues_001052.json:
```json
{
    "body": "Assignee: @williamstein\n\nThere are some feature requests in this email.\n\n\n```\nOn 11/1/07, Utpal Sarkar wrote:\n> I'm doing some simple things with class groups, and some things don't\n> work as expected.\n> Let G be a class group of a number field. \n\nsage: K.<a> = NumberField(x^2 + 23)\nsage: G = K.class_group(); G\nClass group of order 3 with structure C3 of Number Field in a with defining polynomial x^2 + 23\n\n> I am interested in obtaining\n> the actual ideal classes\n> (is there an easy direct way? list(G) returns abstract elements. Is it\n> possible to obtain a map from the class group to the ideal group,\n> mapping class group elements to representatives?)\n\nThis is not implemented yet (the function list is just\nsomething implemented in the base abstract abelian\ngroup class, which is inherited -- it doesn't do anything\nuseful in this case, really.)   Class groups were only\nadded to sage very recently, and aren't fully implemented.\nAdding code to enumerate all elements will show up in Sage\nsoon, but it will take some work. \n\n> Since generators of G can be obtained as ideal classes, to obtain all\n> of them you just have to multiply powers of the generators, and for\n> that it would be useful to know the orders of the generators.\n> When I call\n> (G.0).order()\n> it shows an error message saying that it is not implemented (which\n> seems strange).\n\nIt isn't implemented.  You could implement a dumb order\nfunction though:\n\nsage: K.<a> = NumberField(x^2 + 23)\nsage: G = K.class_group(); G\nClass group of order 3 with structure C3 of Number Field in a with defining polynomial x^2 + 23\nsage: G.gens()\n[Fractional ideal class (2, 1/2*a - 1/2)]\nsage: a = G.0\nsage: def myorder(I):\n...       n = 1\n...       J = I\n...       while J != 1:\n...           J = J * I\n...           n += 1\n...       return n\nsage: myorder(a)\n3\n\n--\n\nI don't recommend doing this -- it's much better to understand\nhow fractional ideals, etc. are represented using the PARI\nC library in Sage, then use a call to PARI to determine the\norder of the fractional ideal class.   This is what I'll do\nwhen I implement this in the Sage library. \n\n>  I tried to work around this by generating the\n> subgroups of G generated by these generators of G in turn to obtain\n> their orders, but when I say\n> G.subgroup([G.0])\n> or\n> G.subgroup(G.gens())\n> an error results, saying that the elements passed don't belong to G.\n\nThat's because creating subgroups of ideal class groups is not implemented.  Sage should produce a NotImplementedError in this case too. \n\n\n\n -- William}}}\n\nIssue created by migration from https://trac.sagemath.org/ticket/1052\n\n",
    "created_at": "2007-11-01T19:34:23Z",
    "labels": [
        "component: number theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "implement more functionality for class groups of number fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/1052",
    "user": "https://github.com/williamstein"
}
```
Assignee: @williamstein

There are some feature requests in this email.


```
On 11/1/07, Utpal Sarkar wrote:
> I'm doing some simple things with class groups, and some things don't
> work as expected.
> Let G be a class group of a number field. 

sage: K.<a> = NumberField(x^2 + 23)
sage: G = K.class_group(); G
Class group of order 3 with structure C3 of Number Field in a with defining polynomial x^2 + 23

> I am interested in obtaining
> the actual ideal classes
> (is there an easy direct way? list(G) returns abstract elements. Is it
> possible to obtain a map from the class group to the ideal group,
> mapping class group elements to representatives?)

This is not implemented yet (the function list is just
something implemented in the base abstract abelian
group class, which is inherited -- it doesn't do anything
useful in this case, really.)   Class groups were only
added to sage very recently, and aren't fully implemented.
Adding code to enumerate all elements will show up in Sage
soon, but it will take some work. 

> Since generators of G can be obtained as ideal classes, to obtain all
> of them you just have to multiply powers of the generators, and for
> that it would be useful to know the orders of the generators.
> When I call
> (G.0).order()
> it shows an error message saying that it is not implemented (which
> seems strange).

It isn't implemented.  You could implement a dumb order
function though:

sage: K.<a> = NumberField(x^2 + 23)
sage: G = K.class_group(); G
Class group of order 3 with structure C3 of Number Field in a with defining polynomial x^2 + 23
sage: G.gens()
[Fractional ideal class (2, 1/2*a - 1/2)]
sage: a = G.0
sage: def myorder(I):
...       n = 1
...       J = I
...       while J != 1:
...           J = J * I
...           n += 1
...       return n
sage: myorder(a)
3

--

I don't recommend doing this -- it's much better to understand
how fractional ideals, etc. are represented using the PARI
C library in Sage, then use a call to PARI to determine the
order of the fractional ideal class.   This is what I'll do
when I implement this in the Sage library. 

>  I tried to work around this by generating the
> subgroups of G generated by these generators of G in turn to obtain
> their orders, but when I say
> G.subgroup([G.0])
> or
> G.subgroup(G.gens())
> an error results, saying that the elements passed don't belong to G.

That's because creating subgroups of ideal class groups is not implemented.  Sage should produce a NotImplementedError in this case too. 



 -- William}}}

Issue created by migration from https://trac.sagemath.org/ticket/1052





---

archive/issue_comments_006381.json:
```json
{
    "body": "NOTE: The AbelianGroup class needs to be refactored, so there is an abstract base class, with lots of NotImplementedErrors, then AbelianGroup_that_David_implemented derives from that as does ClassGroup.   Same with elements.  This will avoid a lot of the confusion in evidence in the above email.",
    "created_at": "2007-11-01T19:36:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1052#issuecomment-6381",
    "user": "https://github.com/williamstein"
}
```

NOTE: The AbelianGroup class needs to be refactored, so there is an abstract base class, with lots of NotImplementedErrors, then AbelianGroup_that_David_implemented derives from that as does ClassGroup.   Same with elements.  This will avoid a lot of the confusion in evidence in the above email.



---

archive/issue_comments_006382.json:
```json
{
    "body": "\n```\nsage: K.<a> = NumberField(x^3 + 1838)\nsage: C = K.class_group(); C\nClass group of order 27 with structure C9 x C3 of Number Field in a with defining polynomial x^3 + 1838\nsage: C.gens()\n[Fractional ideal class (50, a - 8), Fractional ideal class (26, a - 2)]\nsage: I = C.gen(0)\nsage: I^-1\n---------------------------------------------------------------------------\n<type 'exceptions.AttributeError'>        Traceback (most recent call last)\n\n/Users/ncalexan/sage-2.7.2/devel/sage-bugday2/<ipython console> in <module>()\n\n/Users/ncalexan/sage-2.7.2/devel/sage-bugday2/element.pyx in sage.structure.element.MonoidElement.__pow__()\n\n/Users/ncalexan/sage-2.7.2/devel/sage-bugday2/element.pyx in sage.structure.element.generic_power_c()\n\n/Users/ncalexan/sage-2.7.2/devel/sage-bugday2/element.pyx in sage.structure.element.MultiplicativeGroupElement.__invert__()\n\n/Users/ncalexan/sage-2.7.2/devel/sage-bugday2/element.pyx in sage.structure.element.MultiplicativeGroupElement.__div__()\n\n/Users/ncalexan/sage-2.7.2/devel/sage-bugday2/coerce.pyx in sage.structure.coerce.CoercionModel_cache_maps.bin_op_c()\n\n/Users/ncalexan/sage-2.7.2/devel/sage-bugday2/element.pyx in sage.structure.element.MultiplicativeGroupElement.__div__()\n\n/Users/ncalexan/sage-2.7.2/devel/sage-bugday2/element.pyx in sage.structure.element.MultiplicativeGroupElement._div_()\n\n/Users/ncalexan/sage-2.7.2/devel/sage-bugday2/element.pyx in sage.structure.element.MultiplicativeGroupElement._div_c_impl()\n\n<type 'exceptions.AttributeError'>: 'ClassGroup' object has no attribute 'fraction_field'\n```\n",
    "created_at": "2007-11-05T05:07:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1052#issuecomment-6382",
    "user": "https://github.com/ncalexan"
}
```


```
sage: K.<a> = NumberField(x^3 + 1838)
sage: C = K.class_group(); C
Class group of order 27 with structure C9 x C3 of Number Field in a with defining polynomial x^3 + 1838
sage: C.gens()
[Fractional ideal class (50, a - 8), Fractional ideal class (26, a - 2)]
sage: I = C.gen(0)
sage: I^-1
---------------------------------------------------------------------------
<type 'exceptions.AttributeError'>        Traceback (most recent call last)

/Users/ncalexan/sage-2.7.2/devel/sage-bugday2/<ipython console> in <module>()

/Users/ncalexan/sage-2.7.2/devel/sage-bugday2/element.pyx in sage.structure.element.MonoidElement.__pow__()

/Users/ncalexan/sage-2.7.2/devel/sage-bugday2/element.pyx in sage.structure.element.generic_power_c()

/Users/ncalexan/sage-2.7.2/devel/sage-bugday2/element.pyx in sage.structure.element.MultiplicativeGroupElement.__invert__()

/Users/ncalexan/sage-2.7.2/devel/sage-bugday2/element.pyx in sage.structure.element.MultiplicativeGroupElement.__div__()

/Users/ncalexan/sage-2.7.2/devel/sage-bugday2/coerce.pyx in sage.structure.coerce.CoercionModel_cache_maps.bin_op_c()

/Users/ncalexan/sage-2.7.2/devel/sage-bugday2/element.pyx in sage.structure.element.MultiplicativeGroupElement.__div__()

/Users/ncalexan/sage-2.7.2/devel/sage-bugday2/element.pyx in sage.structure.element.MultiplicativeGroupElement._div_()

/Users/ncalexan/sage-2.7.2/devel/sage-bugday2/element.pyx in sage.structure.element.MultiplicativeGroupElement._div_c_impl()

<type 'exceptions.AttributeError'>: 'ClassGroup' object has no attribute 'fraction_field'
```




---

archive/issue_comments_006383.json:
```json
{
    "body": "Changing assignee from @williamstein to @loefflerd.",
    "created_at": "2009-07-20T19:54:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1052#issuecomment-6383",
    "user": "https://github.com/loefflerd"
}
```

Changing assignee from @williamstein to @loefflerd.



---

archive/issue_comments_006384.json:
```json
{
    "body": "Changing component from number theory to number fields.",
    "created_at": "2009-07-20T19:54:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1052#issuecomment-6384",
    "user": "https://github.com/loefflerd"
}
```

Changing component from number theory to number fields.



---

archive/issue_comments_006385.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-10-10T21:04:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1052#issuecomment-6385",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_006386.json:
```json
{
    "body": "The following works for me in sage-4.6.alpha3, so needs_review as \"already fixed\".\n\n\n```\nsage: K.<a> = NumberField(x^2 + 23)\nsage: G = K.class_group(); G\nClass group of order 3 with structure C3 of Number Field in a with defining polynomial x^2 + 23\nsage: (G.0).order()\n3\nsage: list(G)\n[Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a - 1/2), Fractional ideal class (2, 1/2*a + 1/2)]\n```\n",
    "created_at": "2010-10-10T21:04:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1052#issuecomment-6386",
    "user": "https://github.com/jdemeyer"
}
```

The following works for me in sage-4.6.alpha3, so needs_review as "already fixed".


```
sage: K.<a> = NumberField(x^2 + 23)
sage: G = K.class_group(); G
Class group of order 3 with structure C3 of Number Field in a with defining polynomial x^2 + 23
sage: (G.0).order()
3
sage: list(G)
[Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a - 1/2), Fractional ideal class (2, 1/2*a + 1/2)]
```




---

archive/issue_comments_006387.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2010-10-31T20:57:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1052#issuecomment-6387",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_006388.json:
```json
{
    "body": "I agree with Jeroen, and Nick A's example also now works, so I have made the \"positive review\" and the next release manager can mark it as fixed.",
    "created_at": "2010-10-31T20:57:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1052#issuecomment-6388",
    "user": "https://github.com/JohnCremona"
}
```

I agree with Jeroen, and Nick A's example also now works, so I have made the "positive review" and the next release manager can mark it as fixed.



---

archive/issue_events_001175.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-11-01T10:21:15Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/1052",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/1052#event-1175"
}
```



---

archive/issue_comments_006389.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2010-11-01T10:21:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1052#issuecomment-6389",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: duplicate
