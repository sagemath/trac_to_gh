# Issue 14692: Implement symbolic confluent hypergeometric functions

Issue created by migration from https://trac.sagemath.org/ticket/14896

Original creator: eviatarbach

Original creation time: 2013-07-16 05:23:21

Assignee: burcin

CC:  kcrisman benjaminfjones

This patch implements the Kummer confluent hypergeometric functions `hypergeometric_M` and `hypergeometric_U` (superseding the previous numerical-only version), complete with numeric evaluation, simplification, and transformation to generalized hypergeometric functions.


---

Attachment

Whittaker functions can be easily implemented similarly; the reason I didn't include them in this patch is because the Maxima conversion is a bit more complicated.


---

Attachment


---

Comment by eviatarbach created at 2013-07-17 00:08:17

Last patch, to be applied independently, adds LaTeX names which I forgot in the original.


---

Comment by eviatarbach created at 2013-07-17 00:08:17

Changing status from new to needs_review.


---

Comment by chapoton created at 2014-03-06 17:08:10

Changing keywords from "" to "hypergeometric".


---

Comment by knsam created at 2014-05-07 20:42:17

Changing status from needs_review to needs_work.


---

Comment by knsam created at 2014-05-07 20:43:23

This one does not have a valid git branch attached to it... So, I have set it to "needs work". I am willing to review this ticket once there is a valid git branch.


---

Comment by nbruin created at 2014-05-08 07:25:16

is this a dupe of #2516?


---

Comment by eviatarbach created at 2014-05-08 07:30:56

No. Confluent hypergeometric functions are a specific type of hypergeometric function, which are solutions to [Kummer's differential equation](https://en.wikipedia.org/wiki/Confluent_hypergeometric_function#Kummer.27s_equation).

Thanks for offering to review, Kannappan! I'm new to the Git workflow, but I'll try to create the branch as soon as possible.


---

Comment by jkeitel created at 2014-05-21 07:32:00

I've created a git branch and fixed a few failing doctests. There are still many functions that do not have docstrings.
----
Last 10 new commits:


---

Comment by rws created at 2014-07-16 13:47:15

Documentation as is looks good. I fixed a newly appearing doctest fail.
----
Last 10 new commits:


---

Comment by rws created at 2014-07-16 14:04:57

Seems I found a Maxima interface problem with `hypergeometric`:

```
sage: hypergeometric_M(1,b,x).simplify_hypergeometric()
(b - 1)*x^(-b + 1)*e^x*gamma_greek(b - 1, x)
sage: hypergeometric([1],[b],x).simplify_hypergeometric()
(b - 1)*x^(-b + 1)*e^x*gamma_greek(b - 1, x)
```

Of course that should be `gamma`.


---

Comment by nbruin created at 2014-07-16 15:31:09

Replying to [comment:14 rws]:
> {{{
> (b - 1)*x^(-b + 1)*e^x*gamma_greek(b - 1, x)
> }}}
> Of course that should be `gamma`.
I'm not so sure: according to the maxima documentation:

 - gamma - gamma function (complete)
 - gamma_greek - lower incomplete gamma function
 - gamma_incomplete - upper incomplete gamma function

in sage, gamma(a,z) is documented to be the upper gamma function, which gets translated appropriately. We might not have a lower gamma function yet.


---

Comment by kcrisman created at 2014-07-17 02:51:40

> > {{{
> > (b - 1)*x^(-b + 1)*e^x*gamma_greek(b - 1, x)
> > }}}
> > Of course that should be `gamma`.
> I'm not so sure: according to the maxima documentation:
> 
>  - gamma - gamma function (complete)
>  - gamma_greek - lower incomplete gamma function
>  - gamma_incomplete - upper incomplete gamma function
Good catch.
> in sage, gamma(a,z) is documented to be the upper gamma function, which gets translated appropriately. We might not have a lower gamma function yet.
Maybe we can make it by gamma - upper incomplete?


---

Comment by rws created at 2014-07-17 08:48:34

Replying to [comment:16 kcrisman]:
> Maybe we can make it by gamma - upper incomplete?
Maybe define it in `special.py` both as maxima and Sage-evaluated (gamma-gamma_inc) function. Objections?


---

Comment by nbruin created at 2014-07-17 16:14:00

If maxima can produce `gamma_greek` spontaneously, then we should be able to make sense of it. The most straightforward way is by having a transliteration, `gamma_incomplete_lower` or `gamma_lower` perhaps. Adding new symbolic functions isn't _that_ laborious, is it? Simplification methods can be grown later.

FYI: Mathematica seems to have Gamma[a,z] for upper and Gamma[a,0,z] for lower; Maple seems to have upper Gamma. So it does seem packages have been gravitating to the upper one more than the lower one. However, if that means our confluent hypergeometric functions always end up being translated into a more convoluted expression than a straight gamma_lower would give, we're not doing ourselves favours

(e.g., for numerical work: do you really want to evaluate gamma_lower(a,z) as gamma(z)-gamma_upper(a,z) ?)

Without strong indications in either direction, I'd be hesitant to make a choice and rather follow the lead of our main underlying engine: implement gamma_lower.


---

Comment by rws created at 2014-07-22 08:51:03

Changing status from needs_work to needs_review.


---

Comment by rws created at 2014-07-22 08:51:03

I think this warrants a ticket of its own: #16697

And it should not stay in the way of this issue. The reason for needs-work was the missing git branch (comment:8). Please review.


---

Comment by nbruin created at 2014-07-22 15:35:34

I don't think this can be merged independently (but it can be reviewed independently) because without #16697, it can create problematic expressions (gamma_greek has no meaning in sage).
So I'm setting #16697 (which should be easy) as a dependency for this ticket.


---

Comment by git created at 2014-07-25 15:59:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-07-26 06:56:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-08-06 16:22:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-09-01 07:54:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-09-01 08:02:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2014-09-01 08:52:33

Changing keywords from "hypergeometric" to "hypergeometric, kummer".


---

Comment by git created at 2014-12-11 10:10:57

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by kcrisman created at 2015-02-03 02:51:34

Changing status from needs_review to needs_work.


---

Comment by kcrisman created at 2015-02-03 02:51:34

This branch is sadly red.


---

Comment by git created at 2015-02-03 08:41:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2015-02-03 08:42:00

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2015-03-16 15:56:27

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2015-03-16 15:56:27

branch is red, needs rebase


---

Comment by git created at 2015-03-17 07:50:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2015-03-17 07:51:40

Also needs merge in of updated #16697 and a squash.


---

Comment by rws created at 2015-03-17 16:32:37

Pending because #16697 is pending.


---

Comment by rws created at 2016-05-21 13:12:34

Changing status from needs_work to needs_review.


---

Comment by rws created at 2016-05-21 13:12:34

Updated with newest #16697, squashed into three tickets, removed pending. Please review.
----
New commits:


---

Comment by rws created at 2016-05-21 13:16:08

Please review/merge #16697 first (its commit metadata is missing here).


---

Comment by paulmasson created at 2016-06-28 21:36:24

Ralf, I'm trying to merge existing commits to a branch that already includes #16697 but I'm getting errors:



```
    STDOUT: Auto-merging src/sage/symbolic/expression_conversions.py
    STDOUT: CONFLICT (content): Merge conflict in src/sage/symbolic/expression_conversions.py
    STDOUT: Auto-merging src/sage/symbolic/expression.pyx
    STDOUT: Auto-merging src/sage/functions/special.py
    STDOUT: Auto-merging src/sage/functions/other.py
    STDOUT: CONFLICT (content): Merge conflict in src/sage/functions/other.py
    STDOUT: Auto-merging src/sage/functions/hypergeometric.py
    STDOUT: Auto-merging src/sage/functions/all.py
    STDOUT: CONFLICT (content): Merge conflict in src/sage/functions/all.py
    STDOUT: Automatic merge failed; fix conflicts and then commit the result.
```


Am I doing something wrong or do these commits need updating after all this time? Would like to get this one reviewed.


---

Comment by git created at 2016-06-29 05:53:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by paulmasson created at 2016-06-29 20:21:22

Still getting an error:



```
    STDOUT: Auto-merging src/sage/symbolic/expression_conversions.py
    STDOUT: CONFLICT (content): Merge conflict in src/sage/symbolic/expression_conversions.py
    STDOUT: Auto-merging src/sage/functions/all.py
    STDOUT: Automatic merge failed; fix conflicts and then commit the result.
```



---

Comment by rws created at 2016-06-30 05:34:37

As you can see at the top of the ticket the branch cleanly merges with beta5. So you seem to want to merge it with a different version? And why merge at all? Just `git trac checkout 14896` and compile.


---

Comment by paulmasson created at 2016-06-30 20:52:34

I assumed I needed keep track of changes from#16697 manually, but clearly Trac does that automatically.

Running a `doctest` on symbolic/expression_conversions.py gives an error:


```
ValueError: line 93 of the docstring for sage.symbolic.expression_conversions.InterfaceInit.derivative has inconsistent leading whitespace: '======='
```


This is the same file that had a merge conflict.


---

Comment by git created at 2016-07-01 05:41:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2016-07-01 05:42:33

I updated to beta6 and had a merge conflict there too which should be resolved now. Let's try again, please.


---

Comment by paulmasson created at 2016-07-01 20:07:41

Changing status from needs_review to positive_review.


---

Comment by paulmasson created at 2016-07-01 20:07:41

Doctests all pass. Documentation builds. Random numeric testing accurate and both functions plot. Symbolic behavior as expected.

Looks good to me.


---

Comment by rws created at 2016-07-02 04:46:24

Thanks for the review.


---

Comment by vbraun created at 2016-07-02 12:07:33

Resolution: fixed
