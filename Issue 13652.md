# Issue 13652: Add a top_class method to the Steenrod algebra

Issue created by migration from Trac.

Original creator: cnassau

Original creation time: 2012-12-21 11:55:52

Assignee: jhpalmieri

Keywords: Steenrod algebra

The attached patch introduces a new method `top_class` that computes the highest dimensional basis element of a finite sub algebra of the Steenrod algebra:

   {{{#!python
     sage: SteenrodAlgebra(3,profile=((2,1),(2,2,2,2))).top_class()
     Q_0 Q_1 Q_2 Q_3 P(8,2)
     sage: SteenrodAlgebra(2,profile=(3,2,1),basis='pst').top_class()
     P^0_1 P^0_2 P^1_1 P^0_3 P^1_2 P^2_1
     sage: SteenrodAlgebra(7).top_class()
     Traceback (most recent call last):
     ...
     ValueError: the algebra is not finite dimensional
   }}}



---

Comment by cnassau created at 2012-12-21 11:58:47

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2013-02-07 22:17:41

I suppose it might be slightly better to define `AM` to just be `SteenrodAlgebra(basis='milnor', p=p)`: you just need to multiply in it, you don't need to use its profile function. If someone is working with many subalgebras at a single prime, then each call to your version of `AM` will create a new subalgebra, whereas each call to `SteenrodAlgebra(basis='milnor', p=p)` just will only create an instance of the Steenrod algebra the first time through.

Otherwise, this looks good to me.


---

Attachment

Replying to [comment:2 jhpalmieri]:
> I suppose it might be slightly better to define `AM` to just be `SteenrodAlgebra(basis='milnor', p=p)`: you just need to multiply in it, you don't need to use its profile function. If someone is working with many subalgebras at a single prime, then each call to your version of `AM` will create a new subalgebra, whereas each call to `SteenrodAlgebra(basis='milnor', p=p)` just will only create an instance of the Steenrod algebra the first time through.
> 
> Otherwise, this looks good to me.

I have changed the line as you suggested, but also added a cast to self at the end. This is intended to make sure that

```
A.top_class().parent() is A
```

although I don't know if that's important. Anyway, I have also added this as a doctest.

Thanks for looking into this, \\
Christian


---

Comment by jhpalmieri created at 2013-02-08 20:20:02

Perhaps for another ticket: I think your code reveals a bug. What do you think about this change:

```diff
diff --git a/sage/algebras/steenrod/steenrod_algebra.py b/sage/algebras/steenrod/steenrod_algebra.py
--- a/sage/algebras/steenrod/steenrod_algebra.py
+++ b/sage/algebras/steenrod/steenrod_algebra.py
`@``@` -2008,8 +2008,9 `@``@`
             else:
                 a = x.milnor()
                 if self.basis_name() == 'milnor':
-                    return a
-                return a.change_basis(self.basis_name())
+                    return self._from_dict(a.monomial_coefficients(), coerce=True)
+                a = a.change_basis(self.basis_name())
+                return self._from_dict(a.monomial_coefficients(), coerce=True)
         raise ValueError("Element does not lie in this Steenrod algebra")
 
     def __contains__(self, x):
```

As it stands:

```
sage: SteenrodAlgebra(2,profile=(3,2,1), basis='pst')(Sq(4)).parent()
mod 2 Steenrod algebra, pst_revz basis
```

With the change:

```
sage: SteenrodAlgebra(2,profile=(3,2,1), basis='pst')(Sq(4)).parent()
sub-Hopf algebra of mod 2 Steenrod algebra, pst_revz basis, profile function [3, 2, 1]
```

My suggested patch would need some doctests, but it would also allow you to change your last line:

```diff
diff --git a/sage/algebras/steenrod/steenrod_algebra.py b/sage/algebras/steenrod/steenrod_algebra.py
--- a/sage/algebras/steenrod/steenrod_algebra.py
+++ b/sage/algebras/steenrod/steenrod_algebra.py
`@``@` -2821,7 +2822,7 `@``@`
             e = [k for k in range(0,len(ep)) if ep[k]==2]
             r = [p**k-1 for k in rp]
             ans = AM.monomial((tuple(e),tuple(r)))
-        return self(ans.change_basis(self.basis_name()))
+        return self(ans)
 
     def order(self):
         r"""
```



---

Comment by cnassau created at 2013-02-08 22:13:13

Replying to [comment:4 jhpalmieri]:

I think I would generally expect that "`P(x).parent() is P`" for every parent `P`, so your change seems pretty sensible. But maybe this expectation is too naive, as I've recently come across the (new?) notion of a "facade set" - I haven't studied those but they made me wonder whether a subalgebra should best be a facade for the ambient parent? Currently I have no idea what the impact of that approach would be... so I think we should indeed leave this question for a different ticket.

Best, \\
Christian


---

Comment by jhpalmieri created at 2013-02-11 23:01:19

Looks good to me.


---

Comment by jhpalmieri created at 2013-02-11 23:01:19

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-02-17 22:43:28

Resolution: fixed
