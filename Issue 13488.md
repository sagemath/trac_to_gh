# Issue 13488: factor_trial_division returns Python longs as exponents

Issue created by migration from https://trac.sagemath.org/ticket/13692

Original creator: dimpase

Original creation time: 2012-11-08 06:54:22

Assignee: was

unlike the rest (?) of Sage, factor_trial_division returns wants exponents of powers to be Python longs:

```
sage: from sage.rings.factorint import factor_trial_division
sage: [t for t in factor_trial_division(8)]
[(2, 3L)]
```

It is a bug or a feature? It leads to this kind of data also being returned by factor():

```
sage: [t for t in Integer(8).factor(limit=1000)]
[(2, 3L)]
```

as opposed to 

```
sage: [t for t in Integer(8).factor()]
[(2, 3)]
```

See this [sage-support thread](https://groups.google.com/d/topic/sage-support/whnvwlDrAEo/discussion).
Something should be fixed - either factor(), or factor_trial_division()


---

Comment by nbruin created at 2012-11-08 07:25:07

Changing status from new to needs_review.


---

Comment by nbruin created at 2012-11-08 07:25:07

Problem was that exponent was a `cdef unsigned long`, which doesn't necessarily fit in a python int, so apparently cython converts that to a python long automatically.

By defining it to be a `cdef long` instead I don't think we'll get any overflow (it's an exponent of a prime in the factorization of an integer!) and now the exponent is returned as a `python int` instead. Unless people feel strongly that this should be cast to a `Integer` instead, I think this should be sufficient.


---

Comment by dimpase created at 2012-11-08 09:43:03

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2012-11-08 09:43:03

Replying to [comment:2 nbruin]:
> Problem was that exponent was a `cdef unsigned long`, which doesn't necessarily fit in a python int, so apparently cython converts that to a python long automatically.
> 
> By defining it to be a `cdef long` instead I don't think we'll get any overflow (it's an exponent of a prime in the factorization of an integer!) and now the exponent is returned as a `python int` instead. Unless people feel strongly that this should be cast to a `Integer` instead, I think this should be sufficient.

To have the exponents of type int() is consistent, it seem. Looks good, positive review.


---

Comment by jdemeyer created at 2012-11-08 14:11:35

The documentation is misformatted.  It should be

```
TESTS:

Test that :trac:`13692` is solved::

    sage: from sage.rings.factorint import factor_trial_division 
```



---

Comment by jdemeyer created at 2012-11-08 14:11:35

Changing status from positive_review to needs_work.


---

Attachment

fix


---

Comment by nbruin created at 2012-11-08 17:14:49

Changing status from needs_work to positive_review.


---

Comment by nbruin created at 2012-11-08 17:14:49

Test section formatting amended


---

Comment by jdemeyer created at 2012-11-13 08:21:52

Resolution: fixed
