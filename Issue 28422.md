# Issue 28422: revert #28631

Issue created by migration from https://trac.sagemath.org/ticket/28659

Original creator: vdelecroix

Original creation time: 2019-10-27 00:12:39

CC:  tscrim soehms

The ticket #28631 introduced a vastly incomplete factorization of polynomials in the universal cyclotomic field.

```
{{{
sage: (x**2 - 3).factor()
x^2 - 3
sage: r = UCF(3).sqrt()
sage: r
E(12)^7 - E(12)^11
sage: (x - r) * (x + r)
x^2 - 3
}}}
```

The simplest is to revert all changes.


---

Comment by vdelecroix created at 2019-10-27 00:21:04

New commits:


---

Comment by vdelecroix created at 2019-10-27 00:21:04

Changing status from new to needs_review.


---

Comment by soehms created at 2019-10-27 15:21:13

I would prefer to have an implementation of `_factor_univariate_polynomial` remaining. Two reasons for this I've given in #28631#comment:7
Another reason is to prevent developers in future of not becoming aware that there is a serious reason that the implementation of factorization over UCF  
is avoided in general (since it is a non trivial task).

This could be achieved by the following bug-fix of #28631:


```diff
         if len(F) == 1:
+            if cycl_pol.degree() > 1:
+                raise NotImplementedError('Cannot factor this polynomial' )
             return F

```


in addition with a doc-test for this ticket (with the example of the description)!


---

Comment by vdelecroix created at 2019-10-27 17:35:09

Your version is also "broken" on

```
((x^2 + x + 1)**2).factor()
```


I will try to make a reasonable partial implementation and add a note why this is non trivial.


---

Comment by git created at 2019-10-27 18:13:41

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vdelecroix created at 2019-10-27 18:14:58

Here is a more reasonable fix. It factorizes into product of linear forms as long as it is a product of cyclotomic polynomials and degree 2 factors.

The case of degree 3 should be doable "by hand". For higher degree, one needs to go through more Galois theory.


---

Comment by vdelecroix created at 2019-10-27 18:22:08

This should actually work

```
sage: (x^3 - 8).factor()
```



---

Comment by vdelecroix created at 2019-10-27 18:22:08

Changing status from needs_review to needs_work.


---

Comment by git created at 2019-10-27 18:34:30

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vdelecroix created at 2019-10-27 18:34:55

Indeed, I forgot degree one polynomials. Now it should be ok.


---

Comment by vdelecroix created at 2019-10-27 18:34:55

Changing status from needs_work to needs_review.


---

Comment by git created at 2019-10-27 18:44:02

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by soehms created at 2019-10-28 19:39:08

Thanks for your agreement and for improving the implementation more than I expected! Indeed, transferring the problem to the cyclotomic fields was no good idea!
It is more reasonable (and surely more performant) to restrict to rational polynomials and do calculations inside the UCF, as you did. But maybe you should change the comment above that restriction:

`find a common cyclotomic field for the coefficients and change base ring`

since it might be misleading now. If this is done, you may switch to positive review!


---

Comment by git created at 2019-10-28 19:47:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2019-10-28 19:54:57

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-10-29 23:42:03

Resolution: fixed
