# Issue 21899: Upgrade to pynac-0.7.3

archive/issues_021899.json:
```json
{
    "body": "Main addition is Gosper summation (see Sage #22090 for details).\n\nhttps://github.com/pynac/pynac/releases/download/pynac-0.7.3/pynac-0.7.3.tar.bz2\n\nIssue created by migration from https://trac.sagemath.org/ticket/22136\n\n",
    "created_at": "2017-01-04T16:21:25Z",
    "labels": [
        "packages: standard",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.6",
    "title": "Upgrade to pynac-0.7.3",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21899",
    "user": "rws"
}
```
Main addition is Gosper summation (see Sage #22090 for details).

https://github.com/pynac/pynac/releases/download/pynac-0.7.3/pynac-0.7.3.tar.bz2

Issue created by migration from https://trac.sagemath.org/ticket/22136





---

archive/issue_comments_303935.json:
```json
{
    "body": "No Python code or doctest changes with this version. The Gosper sum interface is handled in #22090.\n----\nNew commits:",
    "created_at": "2017-01-04T16:26:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21899#issuecomment-303935",
    "user": "rws"
}
```

No Python code or doctest changes with this version. The Gosper sum interface is handled in #22090.
----
New commits:



---

archive/issue_comments_303936.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-01-04T16:26:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21899#issuecomment-303936",
    "user": "rws"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_303937.json:
```json
{
    "body": "LGTM. Off to the build bots.",
    "created_at": "2017-01-04T23:18:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21899#issuecomment-303937",
    "user": "tscrim"
}
```

LGTM. Off to the build bots.



---

archive/issue_comments_303938.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-01-04T23:18:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21899#issuecomment-303938",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_303939.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2017-01-05T07:24:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21899#issuecomment-303939",
    "user": "rws"
}
```

Changing priority from major to critical.



---

archive/issue_comments_303940.json:
```json
{
    "body": "If you think that needs to be in 7.5 it should be made a blocker, otherwise I am afraid it will be 7.6 material at this stage.",
    "created_at": "2017-01-05T09:39:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21899#issuecomment-303940",
    "user": "fbissey"
}
```

If you think that needs to be in 7.5 it should be made a blocker, otherwise I am afraid it will be 7.6 material at this stage.



---

archive/issue_comments_303941.json:
```json
{
    "body": "Right. A blocker it's not.",
    "created_at": "2017-01-05T10:05:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21899#issuecomment-303941",
    "user": "rws"
}
```

Right. A blocker it's not.



---

archive/issue_comments_303942.json:
```json
{
    "body": "Well I can build sage but the documentation building fails because of undefined symbols\n\n```\nTraceback (most recent call last):\n  File \"sage_setup/docbuild/__main__.py\", line 1, in <module>\n    from sage_setup.docbuild import main\n  File \"/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/sage_setup/docbuild/__init__.py\", line 23, in <module>\n    import sage.all\n  File \"/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/lib/sage/all.py\", line 107, in <module>\n    from sage.symbolic.all   import *\n  File \"/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/lib/sage/symbolic/all.py\", line 3, in <module>\n    from sage.libs.pynac.pynac import I\nImportError: /usr/lib64/libpynac.so.9: undefined symbol: _ZN5GiNaC9resultantERKNS_2exES2_S2_\n```\n\nAnd indeed it is undefined\n\n```\nldd -r /usr/lib64/libpynac.so.9\n\tlinux-vdso.so.1 (0x00007ffd289ee000)\n\tlibpython2.7.so.1.0 => /usr/lib64/libpython2.7.so.1.0 (0x00007fab6d1a9000)\n\tlibfactory-4.0.3.so => /usr/lib64/libfactory-4.0.3.so (0x00007fab6cde3000)\n\tlibgiac.so.0 => /usr/lib64/libgiac.so.0 (0x00007fab6beb9000)\n\tlibflint.so.13 => /usr/lib64/libflint.so.13 (0x00007fab6b944000)\n\tlibgmp.so.10 => /usr/lib64/libgmp.so.10 (0x00007fab6b6d3000)\n\tlibstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/5.4.0/libstdc++.so.6 (0x00007fab6b2d9000)\n\tlibm.so.6 => /lib64/libm.so.6 (0x00007fab6afdb000)\n\tlibc.so.6 => /lib64/libc.so.6 (0x00007fab6ac3f000)\n\tlibgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/5.4.0/libgcc_s.so.1 (0x00007fab6aa27000)\n\tlibpthread.so.0 => /lib64/libpthread.so.0 (0x00007fab6a80b000)\n\tlibdl.so.2 => /lib64/libdl.so.2 (0x00007fab6a607000)\n\tlibutil.so.1 => /lib64/libutil.so.1 (0x00007fab6a403000)\n\tlibsingular_resources-4.0.3.so => /usr/lib64/libsingular_resources-4.0.3.so (0x00007fab6a1fd000)\n\tlibomalloc-0.9.6.so => /usr/lib64/libomalloc-0.9.6.so (0x00007fab69ff2000)\n\tlibntl.so.31 => /usr/lib64/libntl.so.31 (0x00007fab69bd8000)\n\tlibpari-gmp-2.8.so.0 => /usr/lib64/libpari-gmp-2.8.so.0 (0x00007fab693bb000)\n\tlibgsl.so.19 => /usr/lib64/libgsl.so.19 (0x00007fab68f72000)\n\tlibreflapack.so.3 => /usr/lib64/libreflapack.so.3 (0x00007fab68794000)\n\tlibopenblas_threads.so.0 => /usr/lib64/libopenblas_threads.so.0 (0x00007fab681fc000)\n\tlibrt.so.1 => /lib64/librt.so.1 (0x00007fab67ff4000)\n\tlibao.so.4 => /usr/lib64/libao.so.4 (0x00007fab67dea000)\n\tlibpng16.so.16 => /usr/lib64/libpng16.so.16 (0x00007fab67bb8000)\n\tlibmpfi.so.0 => /usr/lib64/libmpfi.so.0 (0x00007fab679a2000)\n\tlibmpfr.so.4 => /usr/lib64/libmpfr.so.4 (0x00007fab67740000)\n\t/lib64/ld-linux-x86-64.so.2 (0x000055bbd691d000)\n\tlibgf2x.so.1 => /usr/lib64/libgf2x.so.1 (0x00007fab6752a000)\n\tlibgfortran.so.3 => /usr/lib/gcc/x86_64-pc-linux-gnu/5.4.0/libgfortran.so.3 (0x00007fab671fd000)\n\tlibz.so.1 => /lib64/libz.so.1 (0x00007fab66fe8000)\n\tlibquadmath.so.0 => /usr/lib/gcc/x86_64-pc-linux-gnu/5.4.0/libquadmath.so.0 (0x00007fab66da8000)\nundefined symbol: _ZN5GiNaC9resultantERKNS_2exES2_S2_\t(/usr/lib64/libpynac.so.9)\n```\n\nFinally\n\n```\nc++filt _ZN5GiNaC9resultantERKNS_2exES2_S2_\nGiNaC::resultant(GiNaC::ex const&, GiNaC::ex const&, GiNaC::ex const&)\n```\n",
    "created_at": "2017-01-05T21:23:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21899#issuecomment-303942",
    "user": "fbissey"
}
```

Well I can build sage but the documentation building fails because of undefined symbols

```
Traceback (most recent call last):
  File "sage_setup/docbuild/__main__.py", line 1, in <module>
    from sage_setup.docbuild import main
  File "/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/sage_setup/docbuild/__init__.py", line 23, in <module>
    import sage.all
  File "/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/lib/sage/all.py", line 107, in <module>
    from sage.symbolic.all   import *
  File "/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/lib/sage/symbolic/all.py", line 3, in <module>
    from sage.libs.pynac.pynac import I
ImportError: /usr/lib64/libpynac.so.9: undefined symbol: _ZN5GiNaC9resultantERKNS_2exES2_S2_
```

And indeed it is undefined

```
ldd -r /usr/lib64/libpynac.so.9
	linux-vdso.so.1 (0x00007ffd289ee000)
	libpython2.7.so.1.0 => /usr/lib64/libpython2.7.so.1.0 (0x00007fab6d1a9000)
	libfactory-4.0.3.so => /usr/lib64/libfactory-4.0.3.so (0x00007fab6cde3000)
	libgiac.so.0 => /usr/lib64/libgiac.so.0 (0x00007fab6beb9000)
	libflint.so.13 => /usr/lib64/libflint.so.13 (0x00007fab6b944000)
	libgmp.so.10 => /usr/lib64/libgmp.so.10 (0x00007fab6b6d3000)
	libstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/5.4.0/libstdc++.so.6 (0x00007fab6b2d9000)
	libm.so.6 => /lib64/libm.so.6 (0x00007fab6afdb000)
	libc.so.6 => /lib64/libc.so.6 (0x00007fab6ac3f000)
	libgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/5.4.0/libgcc_s.so.1 (0x00007fab6aa27000)
	libpthread.so.0 => /lib64/libpthread.so.0 (0x00007fab6a80b000)
	libdl.so.2 => /lib64/libdl.so.2 (0x00007fab6a607000)
	libutil.so.1 => /lib64/libutil.so.1 (0x00007fab6a403000)
	libsingular_resources-4.0.3.so => /usr/lib64/libsingular_resources-4.0.3.so (0x00007fab6a1fd000)
	libomalloc-0.9.6.so => /usr/lib64/libomalloc-0.9.6.so (0x00007fab69ff2000)
	libntl.so.31 => /usr/lib64/libntl.so.31 (0x00007fab69bd8000)
	libpari-gmp-2.8.so.0 => /usr/lib64/libpari-gmp-2.8.so.0 (0x00007fab693bb000)
	libgsl.so.19 => /usr/lib64/libgsl.so.19 (0x00007fab68f72000)
	libreflapack.so.3 => /usr/lib64/libreflapack.so.3 (0x00007fab68794000)
	libopenblas_threads.so.0 => /usr/lib64/libopenblas_threads.so.0 (0x00007fab681fc000)
	librt.so.1 => /lib64/librt.so.1 (0x00007fab67ff4000)
	libao.so.4 => /usr/lib64/libao.so.4 (0x00007fab67dea000)
	libpng16.so.16 => /usr/lib64/libpng16.so.16 (0x00007fab67bb8000)
	libmpfi.so.0 => /usr/lib64/libmpfi.so.0 (0x00007fab679a2000)
	libmpfr.so.4 => /usr/lib64/libmpfr.so.4 (0x00007fab67740000)
	/lib64/ld-linux-x86-64.so.2 (0x000055bbd691d000)
	libgf2x.so.1 => /usr/lib64/libgf2x.so.1 (0x00007fab6752a000)
	libgfortran.so.3 => /usr/lib/gcc/x86_64-pc-linux-gnu/5.4.0/libgfortran.so.3 (0x00007fab671fd000)
	libz.so.1 => /lib64/libz.so.1 (0x00007fab66fe8000)
	libquadmath.so.0 => /usr/lib/gcc/x86_64-pc-linux-gnu/5.4.0/libquadmath.so.0 (0x00007fab66da8000)
undefined symbol: _ZN5GiNaC9resultantERKNS_2exES2_S2_	(/usr/lib64/libpynac.so.9)
```

Finally

```
c++filt _ZN5GiNaC9resultantERKNS_2exES2_S2_
GiNaC::resultant(GiNaC::ex const&, GiNaC::ex const&, GiNaC::ex const&)
```




---

archive/issue_comments_303943.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-01-05T23:25:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21899#issuecomment-303943",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_303944.json:
```json
{
    "body": "Replying to [comment:8 fbissey]:\n> Well I can build sage but the documentation building fails because of undefined symbols\n\nCannot confirm. You probably built Pynac without \"--with-giac=no\". The broken giac support is fixed in pynac git. See also https://github.com/pynac/pynac/issues/223",
    "created_at": "2017-01-06T07:46:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21899#issuecomment-303944",
    "user": "rws"
}
```

Replying to [comment:8 fbissey]:
> Well I can build sage but the documentation building fails because of undefined symbols

Cannot confirm. You probably built Pynac without "--with-giac=no". The broken giac support is fixed in pynac git. See also https://github.com/pynac/pynac/issues/223



---

archive/issue_comments_303945.json:
```json
{
    "body": "My dev machine seems to be down, I have now read the github issue and like them I enabled giac support so thats probably it. I'll include that commit in sage-on-gentoo at the first opportunity. Since I am taking proper holidays with my familly we may be looking at the 16th of January if I don't get access to my box by tomorrow.",
    "created_at": "2017-01-06T07:56:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21899#issuecomment-303945",
    "user": "fbissey"
}
```

My dev machine seems to be down, I have now read the github issue and like them I enabled giac support so thats probably it. I'll include that commit in sage-on-gentoo at the first opportunity. Since I am taking proper holidays with my familly we may be looking at the 16th of January if I don't get access to my box by tomorrow.



---

archive/issue_comments_303946.json:
```json
{
    "body": "This fails to build for me on OS X. I'm attaching the log file from a serial build.",
    "created_at": "2017-01-07T02:17:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21899#issuecomment-303946",
    "user": "jhpalmieri"
}
```

This fails to build for me on OS X. I'm attaching the log file from a serial build.



---

archive/issue_comments_303947.json:
```json
{
    "body": "No, it's too big to attach. It's here: http://www.math.washington.edu/~palmieri/Sage/pynac-0.7.3.log",
    "created_at": "2017-01-07T02:20:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21899#issuecomment-303947",
    "user": "jhpalmieri"
}
```

No, it's too big to attach. It's here: http://www.math.washington.edu/~palmieri/Sage/pynac-0.7.3.log



---

archive/issue_comments_303948.json:
```json
{
    "body": "See #22147 for the follow up on OS X.",
    "created_at": "2017-01-07T08:46:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21899#issuecomment-303948",
    "user": "fbissey"
}
```

See #22147 for the follow up on OS X.
