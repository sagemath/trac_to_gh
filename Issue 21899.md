# Issue 21899: Upgrade to pynac-0.7.3

Issue created by migration from Trac.

Original creator: rws

Original creation time: 2017-01-04 16:21:25

Main addition is Gosper summation (see Sage #22090 for details).

https://github.com/pynac/pynac/releases/download/pynac-0.7.3/pynac-0.7.3.tar.bz2


---

Comment by rws created at 2017-01-04 16:26:53

No Python code or doctest changes with this version. The Gosper sum interface is handled in #22090.
----
New commits:


---

Comment by rws created at 2017-01-04 16:26:53

Changing status from new to needs_review.


---

Comment by tscrim created at 2017-01-04 23:18:36

LGTM. Off to the build bots.


---

Comment by tscrim created at 2017-01-04 23:18:36

Changing status from needs_review to positive_review.


---

Comment by rws created at 2017-01-05 07:24:14

Changing priority from major to critical.


---

Comment by fbissey created at 2017-01-05 09:39:37

If you think that needs to be in 7.5 it should be made a blocker, otherwise I am afraid it will be 7.6 material at this stage.


---

Comment by rws created at 2017-01-05 10:05:45

Right. A blocker it's not.


---

Comment by fbissey created at 2017-01-05 21:23:39

Well I can build sage but the documentation building fails because of undefined symbols

```
Traceback (most recent call last):
  File "sage_setup/docbuild/__main__.py", line 1, in <module>
    from sage_setup.docbuild import main
  File "/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/sage_setup/docbuild/__init__.py", line 23, in <module>
    import sage.all
  File "/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/lib/sage/all.py", line 107, in <module>
    from sage.symbolic.all   import *
  File "/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/lib/sage/symbolic/all.py", line 3, in <module>
    from sage.libs.pynac.pynac import I
ImportError: /usr/lib64/libpynac.so.9: undefined symbol: _ZN5GiNaC9resultantERKNS_2exES2_S2_
```

And indeed it is undefined

```
ldd -r /usr/lib64/libpynac.so.9
	linux-vdso.so.1 (0x00007ffd289ee000)
	libpython2.7.so.1.0 => /usr/lib64/libpython2.7.so.1.0 (0x00007fab6d1a9000)
	libfactory-4.0.3.so => /usr/lib64/libfactory-4.0.3.so (0x00007fab6cde3000)
	libgiac.so.0 => /usr/lib64/libgiac.so.0 (0x00007fab6beb9000)
	libflint.so.13 => /usr/lib64/libflint.so.13 (0x00007fab6b944000)
	libgmp.so.10 => /usr/lib64/libgmp.so.10 (0x00007fab6b6d3000)
	libstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/5.4.0/libstdc++.so.6 (0x00007fab6b2d9000)
	libm.so.6 => /lib64/libm.so.6 (0x00007fab6afdb000)
	libc.so.6 => /lib64/libc.so.6 (0x00007fab6ac3f000)
	libgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/5.4.0/libgcc_s.so.1 (0x00007fab6aa27000)
	libpthread.so.0 => /lib64/libpthread.so.0 (0x00007fab6a80b000)
	libdl.so.2 => /lib64/libdl.so.2 (0x00007fab6a607000)
	libutil.so.1 => /lib64/libutil.so.1 (0x00007fab6a403000)
	libsingular_resources-4.0.3.so => /usr/lib64/libsingular_resources-4.0.3.so (0x00007fab6a1fd000)
	libomalloc-0.9.6.so => /usr/lib64/libomalloc-0.9.6.so (0x00007fab69ff2000)
	libntl.so.31 => /usr/lib64/libntl.so.31 (0x00007fab69bd8000)
	libpari-gmp-2.8.so.0 => /usr/lib64/libpari-gmp-2.8.so.0 (0x00007fab693bb000)
	libgsl.so.19 => /usr/lib64/libgsl.so.19 (0x00007fab68f72000)
	libreflapack.so.3 => /usr/lib64/libreflapack.so.3 (0x00007fab68794000)
	libopenblas_threads.so.0 => /usr/lib64/libopenblas_threads.so.0 (0x00007fab681fc000)
	librt.so.1 => /lib64/librt.so.1 (0x00007fab67ff4000)
	libao.so.4 => /usr/lib64/libao.so.4 (0x00007fab67dea000)
	libpng16.so.16 => /usr/lib64/libpng16.so.16 (0x00007fab67bb8000)
	libmpfi.so.0 => /usr/lib64/libmpfi.so.0 (0x00007fab679a2000)
	libmpfr.so.4 => /usr/lib64/libmpfr.so.4 (0x00007fab67740000)
	/lib64/ld-linux-x86-64.so.2 (0x000055bbd691d000)
	libgf2x.so.1 => /usr/lib64/libgf2x.so.1 (0x00007fab6752a000)
	libgfortran.so.3 => /usr/lib/gcc/x86_64-pc-linux-gnu/5.4.0/libgfortran.so.3 (0x00007fab671fd000)
	libz.so.1 => /lib64/libz.so.1 (0x00007fab66fe8000)
	libquadmath.so.0 => /usr/lib/gcc/x86_64-pc-linux-gnu/5.4.0/libquadmath.so.0 (0x00007fab66da8000)
undefined symbol: _ZN5GiNaC9resultantERKNS_2exES2_S2_	(/usr/lib64/libpynac.so.9)
```

Finally

```
c++filt _ZN5GiNaC9resultantERKNS_2exES2_S2_
GiNaC::resultant(GiNaC::ex const&, GiNaC::ex const&, GiNaC::ex const&)
```



---

Comment by vbraun created at 2017-01-05 23:25:03

Resolution: fixed


---

Comment by rws created at 2017-01-06 07:46:55

Replying to [comment:8 fbissey]:
> Well I can build sage but the documentation building fails because of undefined symbols

Cannot confirm. You probably built Pynac without "--with-giac=no". The broken giac support is fixed in pynac git. See also https://github.com/pynac/pynac/issues/223


---

Comment by fbissey created at 2017-01-06 07:56:01

My dev machine seems to be down, I have now read the github issue and like them I enabled giac support so thats probably it. I'll include that commit in sage-on-gentoo at the first opportunity. Since I am taking proper holidays with my familly we may be looking at the 16th of January if I don't get access to my box by tomorrow.


---

Comment by jhpalmieri created at 2017-01-07 02:17:52

This fails to build for me on OS X. I'm attaching the log file from a serial build.


---

Comment by jhpalmieri created at 2017-01-07 02:20:15

No, it's too big to attach. It's here: http://www.math.washington.edu/~palmieri/Sage/pynac-0.7.3.log


---

Comment by fbissey created at 2017-01-07 08:46:52

See #22147 for the follow up on OS X.
