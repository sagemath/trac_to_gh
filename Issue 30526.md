# Issue 30526: improve setting global options to None

Issue created by migration from https://trac.sagemath.org/ticket/30763

Original creator: @mwageringel

Original creation time: 2020-10-13 17:52:14

The `__call__` method of global options is used as getter and setter. This ticket improves this method to properly handle values of `None`.

For example:

```python
sage: from sage.structure.global_options import GlobalOptions
sage: class config(GlobalOptions):
....:     size = dict(default=42,
....:                 description='integer or None',
....:                 checker=lambda val: val is None or val >= 0)
sage: config.size(None)  # this should set the option to `None`
42
```

(See #30755 for an actual example where `None` is used as a value.)

This can be used as a workaround instead:

```python
sage: config.size = None
sage: config.size() is None
True
```


This ticket makes `config.size(None)` work as a setter. Additionally, a deprecation is added for the keyword-argument syntax `config.size(value=None)`, as it is not usually used and this will simplify the implementation a little.



---

Comment by @mwageringel created at 2020-10-13 17:56:01

New commits:


---

Comment by @mwageringel created at 2020-10-13 17:56:01

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2020-11-30 05:38:29

Wouldn't it be simpler to just use a unique object instead of `None` as the default argument?  Then no change of the interface is necessary


---

Comment by @mwageringel created at 2020-11-30 17:48:01

Well, yes, but I think that it is common to use `None` as a default value/no preferred choice. For example, in Sage, this is the case for the [preferences of the display manager](https://gitlab.com/sagemath/sage/-/blob/020bd59ec28717bfab9af44d2231c53da1ff99f1/src/sage/repl/rich_output/preferences.py#L7-9) (though, these are distinct from `GlobalOptions`).

Note that, in the example from the description, `config.size()` still keeps working as a getter, so the interface does not really change.


---

Comment by mkoeppe created at 2021-03-15 22:07:04

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.


---

Comment by mkoeppe created at 2021-07-19 00:44:56

Setting a new milestone for this ticket based on a cursory review.


---

Comment by mkoeppe created at 2021-12-18 19:53:12

Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.


---

Comment by vdelecroix created at 2021-12-29 11:43:31

The proposed change is reasonable and simplifies (actually will simplify in the future) the implementation of `__call__`.


---

Comment by vdelecroix created at 2021-12-29 11:43:31

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2022-02-16 23:56:50

Resolution: fixed
