# Issue 30603: small improvement in Hasse diagram

archive/issues_030603.json:
```json
{
    "body": "CC:  @tscrim\n\nfaster \"are_comparable\" and \"are_incomparable\" methods\n\nIssue created by migration from https://trac.sagemath.org/ticket/30840\n\n",
    "created_at": "2020-10-30T10:09:04Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "small improvement in Hasse diagram",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30603",
    "user": "https://github.com/fchapoton"
}
```
CC:  @tscrim

faster "are_comparable" and "are_incomparable" methods

Issue created by migration from https://trac.sagemath.org/ticket/30840





---

archive/issue_comments_436680.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-10-30T10:09:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436680",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_436681.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-10-30T10:09:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436681",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_436682.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-30T17:57:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436682",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_436683.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-10-30T17:57:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436683",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_436684.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-30T18:12:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436684",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_436685.json:
```json
{
    "body": "Changing keywords from \"\" to \"poset\".",
    "created_at": "2020-10-30T19:53:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436685",
    "user": "https://github.com/fchapoton"
}
```

Changing keywords from "" to "poset".



---

archive/issue_comments_436686.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-30T21:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436686",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_436687.json:
```json
{
    "body": "adding some before/after timings. Not so conclusive maybe ?",
    "created_at": "2020-10-31T08:20:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436687",
    "user": "https://github.com/fchapoton"
}
```

adding some before/after timings. Not so conclusive maybe ?



---

archive/issue_comments_436688.json:
```json
{
    "body": "more timings",
    "created_at": "2020-10-31T08:33:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436688",
    "user": "https://github.com/fchapoton"
}
```

more timings



---

archive/issue_comments_436689.json:
```json
{
    "body": "bot is morally green. Any opinion ?",
    "created_at": "2020-11-05T20:00:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436689",
    "user": "https://github.com/fchapoton"
}
```

bot is morally green. Any opinion ?



---

archive/issue_comments_436690.json:
```json
{
    "body": "I think this is good. It seems like the timings get no worse (or perhaps slightly), but sometimes significantly better.\n\nSome technical comments:\n\n`IncreasingChains` documentation is weird. I would move the `__init__` docstring to the class level.\n\nWhy this removal?\n\n```diff\n-        Eventually the following syntax will be accepted::\n-\n-            sage: C.subset(size = 2) # todo: not implemented\n-\n```\n\nYou probably could get a little more speed out of the `IncreasingChains` by type specifying variables. I am thinking for `_vertices` and `_greater_than` being lists (or even more specific for `_vertices`, an array of `Py_ssize_t`). I wonder slightly about the use of hash tables versus (ordered?) lists for the `_greater_than` as the number of covers of an element tends to be relatively small compared to the number of elements in a poset. However, this isn't anything worth holding up this ticket for.",
    "created_at": "2020-11-05T23:00:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436690",
    "user": "https://github.com/tscrim"
}
```

I think this is good. It seems like the timings get no worse (or perhaps slightly), but sometimes significantly better.

Some technical comments:

`IncreasingChains` documentation is weird. I would move the `__init__` docstring to the class level.

Why this removal?

```diff
-        Eventually the following syntax will be accepted::
-
-            sage: C.subset(size = 2) # todo: not implemented
-
```

You probably could get a little more speed out of the `IncreasingChains` by type specifying variables. I am thinking for `_vertices` and `_greater_than` being lists (or even more specific for `_vertices`, an array of `Py_ssize_t`). I wonder slightly about the use of hash tables versus (ordered?) lists for the `_greater_than` as the number of covers of an element tends to be relatively small compared to the number of elements in a poset. However, this isn't anything worth holding up this ticket for.



---

archive/issue_comments_436691.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-11-06T11:19:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436691",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_436692.json:
```json
{
    "body": "I have added some cdef in the methods.\n\nStupid me, but how to give types to attributes of the class when then class itself cannot be \"cdef'ed\" ?",
    "created_at": "2020-11-06T11:20:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436692",
    "user": "https://github.com/fchapoton"
}
```

I have added some cdef in the methods.

Stupid me, but how to give types to attributes of the class when then class itself cannot be "cdef'ed" ?



---

archive/issue_comments_436693.json:
```json
{
    "body": "Thank you for the changes.\n\nAh, I didn't notice that it was not an extension class. Actually, that is something we should change very soon by moving and making `SearchForest` into the `recursively_enumerated_set.pyx`... At least that aspect should be trivial: to move and `cdef` the class.\n\nUnfortunately I don't think you can do that. Although you can type cast it everywhere it could be useful.\n\nAlso, the `IncreasingChains.__init__` now needs a doctest; a good old `TestSuite(foo).run()` perhaps.",
    "created_at": "2020-11-06T22:00:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436693",
    "user": "https://github.com/tscrim"
}
```

Thank you for the changes.

Ah, I didn't notice that it was not an extension class. Actually, that is something we should change very soon by moving and making `SearchForest` into the `recursively_enumerated_set.pyx`... At least that aspect should be trivial: to move and `cdef` the class.

Unfortunately I don't think you can do that. Although you can type cast it everywhere it could be useful.

Also, the `IncreasingChains.__init__` now needs a doctest; a good old `TestSuite(foo).run()` perhaps.



---

archive/issue_comments_436694.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-11-07T13:53:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436694",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_436695.json:
```json
{
    "body": "ok, then here is the missing doctest. Maybe good to go ?",
    "created_at": "2020-11-07T13:54:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436695",
    "user": "https://github.com/fchapoton"
}
```

ok, then here is the missing doctest. Maybe good to go ?



---

archive/issue_comments_436696.json:
```json
{
    "body": "Yes, this is good. We can make further improvements later on.",
    "created_at": "2020-11-08T00:42:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436696",
    "user": "https://github.com/tscrim"
}
```

Yes, this is good. We can make further improvements later on.



---

archive/issue_comments_436697.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-11-08T00:42:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436697",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_436698.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2020-11-08T08:54:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436698",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_436699.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-11-08T08:54:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436699",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_436700.json:
```json
{
    "body": "Thanks, Travis. Setting back to positive after a simple rebase.",
    "created_at": "2020-11-08T08:54:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436700",
    "user": "https://github.com/fchapoton"
}
```

Thanks, Travis. Setting back to positive after a simple rebase.



---

archive/issue_comments_436701.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-11-08T08:54:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436701",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_436702.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-11-22T15:06:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30603#issuecomment-436702",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_080473.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-11-22T15:06:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30603",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30603#event-80473"
}
```
