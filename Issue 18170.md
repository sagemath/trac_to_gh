# Issue 18170: Fix standard_packages(), optional_packages(), and experimental_packages()

Issue created by migration from https://trac.sagemath.org/ticket/18407

Original creator: ncohen

Original creation time: 2015-05-12 14:54:14

CC:  vdelecroix vbraun leif

Those functions are broken (and not doctested) in the latest beta. This branches fixes it.


---

Comment by ncohen created at 2015-05-12 14:54:49

Changing status from new to needs_review.


---

Comment by git created at 2015-05-12 14:54:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2015-05-12 15:02:47

Is it disjoint from the bash scripts that we have

```
$ sage -standard
Using Sage Server http://www.sagemath.org/packages

Standard packages:

atlas-3.10.1.p7 ........................ installed version: 3.10.2
boehm_gc-7.2d.p0 ....................... already installed
boost_cropped-1.52.0 ................... already installed
...
tachyon-0.98.9.p5 ...................... already installed
zlib-1.2.8.p0 .......................... already installed
zn_poly-0.9.p11 ........................ already installed

$ sage -optional
Using Sage Server http://www.sagemath.org/packages

Optional packages:

4ti2-1.6.2 ............................. not installed
PyQt_x11-4.9.1.p0 ...................... not installed
TOPCOM-0.17.4 .......................... not installed
autotools-20121217 ..................... not installed
...
trac-0.11.5.p0 ......................... not installed
valgrind-3.8.1.p0 ...................... not installed
zeromq-3.2.0.p0 ........................ installed version: 4.0.5
```



---

Comment by leif created at 2015-05-12 15:03:08

Hmmm,

 * that's only part of the problem,
 * I was going to rather fix it by adding a `--machine-readable` (say) option to `sage-list-packages` (at #16759, but I haven't written any code yet, also because of #15642).


---

Comment by ncohen created at 2015-05-12 15:03:38

> Is it disjoint from the bash scripts that we have

No, it parses the output.


---

Comment by ncohen created at 2015-05-12 15:05:24

>  * that's only part of the problem,
>  * I was going to rather fix it by adding a `--machine-readable` (say) option to `sage-list-packages` (at #16759, but I haven't written any code yet, also because of #15642).

Well, that branch fixes the old function, and has the nice property of being ready and implemented. We will still need those functions in the long run, so it is not incompatible with what you plan on doing anyway. I really have nothing against seeing this parsing code rewritten in the future.

I am writing a doc patch at the moment, which uses these functions to make sure that all packages appear in our doc.

Nathann


---

Comment by leif created at 2015-05-12 15:16:20

Hmmm ok, although it now exposes the brokenness of the shell script in Python as well... ;-)

One tiny thing:

```python
        print("Standard package list (shown above) appears to be currently")
```

=>

```python
        print("List of %s packages (shown above) appears to be currently" % package_type)
```



---

Comment by ncohen created at 2015-05-12 15:19:59

Can you add a commit? I am working on another patch at the moment.


---

Comment by git created at 2015-05-12 15:40:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2015-05-12 15:43:42

Thanks !! I am almost done with my other patch which lists all packages in the doc. I also noticed some problem in the output of this one, which I will fix real soon `;-)`


---

Comment by leif created at 2015-05-12 15:44:32

Replying to [comment:8 ncohen]:
> Can you add a commit? I am working on another patch at the moment.

Done, but

```
$ ./sage -c 'print optional_packages()'
(['4ti2', 'git', 'pyzmq', 'zeromq'], ['PyQt_x11', 'TOPCOM', 'autotools', 'beautifulsoup', 'benzene', 'biopython', 'brian', 'buckygen', 'cbc', 'ccache', 'chomp', 'cluster_seed', 'coxeter3', 'cryptominisat', 'cunningham_tables', 'database_cremona_ellcurve', 'database_gap', 'database_jones_numfield', 'database_kohel', 'database_odlyzko_zeta .................. not installe', 'database_pari', 'database_stein_watkins_mini.p0 ......... not installe', 'database_symbolic_data', 'dot2tex', 'extra_docs', 'gap_packages', 'gcc', 'gdbm', 'ginv-1.9', 'gnuplotpy', 'guppy', 'java3d', 'kash3-2008-07', 'knoboo', 'libogg', 'libtheora', 'lie', 'lrs', 'mpi4py', 'nauty', 'normaliz', 'nose', 'nzmath', 'openmpi', 'openssl', 'ore_algebra', 'p_group_cohomology', 'patchbot', 'phc', 'pybtex', 'pycryptoplus-20100809', 'pyx', 'qhull', 'sage_mode', 'sip', 'trac', 'valgrind'])
$ ./sage -c 'print experimental_packages()'
(['pexpect'], ['PyQt4', 'PyVTK', 'QScintilla2', 'asymptote', 'bison', 'boost_1_34_1 ........................... not installe', 'cadabra', 'clapack', 'clisp', 'cmake', 'csdp', 'dvipng', 'ets', 'fes', 'flex', 'gcc', 'gdb', 'gnofract4d', 'gnuplot', 'graphviz', 'latte_int', 'libcprops', 'libjpeg', 'libsigsegv', 'macaulay2-1.1', 'mayavi_2.2.1 ........................... not installe', 'meataxe', 'modglue', 'mpich2', 'numarray', 'numeric', 'openopt', 'pcre', 'phcpack', 'polymake', 'processing', 'pygame', 'pygsl', 'pygtk', 'pynifti', 'pyqt', 'pyrexembed-0.1.1', 'qasm', 'qepcad', 'quantlib', 'quantlib_swig', 'reallib3-linux', 'sandpile', 'scitools++ ............................. not installe', 'semigroupe-2.0', 'simpqs', 'sip', 'soya', 'soya_cvs', 'superlu', 'surf', 'vtk_meta', 'wxPython', 'yafray', 'yassl'])
```



---

Comment by leif created at 2015-05-12 15:44:32

Changing status from needs_review to needs_work.


---

Comment by leif created at 2015-05-12 15:47:14

Seems you already noticed the _pas installé_(?)


---

Comment by git created at 2015-05-12 15:51:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2015-05-12 15:51:43

> Seems you already noticed the _pas installé_(?)

Indeed. But come on, that's written in french on my console too `;-)`

Nathann


---

Comment by ncohen created at 2015-05-12 15:51:43

Changing status from needs_work to needs_review.


---

Comment by leif created at 2015-05-12 16:07:52

Replying to [comment:14 ncohen]:
> > Seems you already noticed the _pas installé_(?)
> 
> Indeed. But come on, that's written in french on my console too `;-)`

I thought you'd just `s/not/pas/`...




And I won't complain about removing `lambda` I love so much, nor efficiency w.r.t. using `in` *and* `.rfind()`. ;-)


---

Comment by leif created at 2015-05-12 16:07:52

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2015-05-12 16:09:40

> And I won't complain about removing `lambda` I love so much, nor efficiency w.r.t. using `in` *and* `.rfind()`. ;-)

I would have loved to do it with lambda functions only, but I really needed to define a variable here `:-P`

Thank you very much for the review. The list of packages is built by #18408 `:-)`

Nathann


---

Comment by leif created at 2015-05-12 16:31:51

Hmmm, may I revert the status or do we have to open a follow-up? XD

We have to `s/# internet/# optional -- internet/` I think...

Sorry, tested but missed that somehow.


---

Comment by ncohen created at 2015-05-12 16:33:51

Changing status from positive_review to needs_work.


---

Comment by ncohen created at 2015-05-12 16:33:51

> Hmmm, may I revert the status or do we have to open a follow-up? XD

Oh True, True `:-/`

Just a second.

Nathann


---

Comment by git created at 2015-05-12 16:34:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2015-05-12 16:35:15

Changing status from needs_work to needs_review.


---

Comment by leif created at 2015-05-12 16:38:54

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-05-13 11:33:42

Resolution: fixed
