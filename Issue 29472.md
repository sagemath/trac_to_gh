# Issue 29472: Frobenius on elliptic curves in Weierstrass form

Issue created by migration from https://trac.sagemath.org/ticket/29709

Original creator: jen

Original creation time: 2020-05-18 17:43:17

CC:  roed edgarcosta

The code for computing Frobenius on a point on an elliptic curve over a p-adic field would like the elliptic curve to be in the form y<sup>2</sup> = f(x). So it should raise an error if one of a_1 or a_3 is not zero, but instead it checks if one of  a_1  or a_2 is not zero:


```
sage: E = EllipticCurve([0,1,0,1,1])
sage: E
Elliptic Curve defined by y^2 = x^3 + x^2 + x + 1 over Rational Field
sage: EK = E.change_ring(Qp(7,10))
sage: EK.frobenius(EK(1,2))
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-4-77549f6ac826> in <module>()
----> 1 EK.frobenius(EK(Integer(1),Integer(2)))

/ext/sage/sage-8.9_1804/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/ell_padic_field.pyc in frobenius(self, P)
     71             a1, a2, a3, a4, a6 = self.a_invariants()
     72             if a1 != 0 or a2 != 0:
---> 73                 raise NotImplementedError("Curve must be in weierstrass normal form.")
     74 
     75             f = x*x*x + a2*x*x + a4*x + a6

NotImplementedError: Curve must be in weierstrass normal form.
```


Note that one can work around this by pretending the elliptic curve is a hyperelliptic curve:


```
sage: R.<x> = QQ['x']
sage: H = HyperellipticCurve(x^3 + x^2 + x + 1)
sage: HK = H.change_ring(Qp(7,10))
sage: HK.frobenius(HK(1,2))
(1 + O(7^10) : 2 + O(7^10) : 1 + O(7^10))
```

so this isn't urgent, but it'd be nice to fix.



---

Comment by alexjbest created at 2020-08-11 04:57:25

New commits:


---

Comment by alexjbest created at 2020-08-11 04:57:25

Changing status from new to needs_review.


---

Comment by alexjbest created at 2020-08-11 04:57:25

Changing keywords from "" to "padics, elliptic curves".


---

Comment by kedlaya created at 2020-08-11 23:26:22

Looks fine to me. Once patchbot comes up green, you can set this to positive review.


---

Comment by alexjbest created at 2020-08-12 22:04:51

Changing status from needs_review to positive_review.


---

Comment by alexjbest created at 2020-08-12 22:04:51

Thanks!


---

Comment by vbraun created at 2020-08-23 16:28:06

Resolution: fixed
