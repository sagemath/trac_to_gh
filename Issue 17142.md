# Issue 17142: Add a 'all' option to the .nth_root() method of algebraic numbers

Issue created by migration from https://trac.sagemath.org/ticket/17379

Original creator: tmonteil

Original creation time: 2014-11-21 18:38:43

CC:  vdelecroix

There is currently no `all` option for the .nth_root() method of algebraic numbers:


```
sage: a = QQbar(-1)
sage: a.nth_root(3)
0.500000000000000? + 0.866025403784439?*I
sage: a.nth_root(3, all=True)
...
TypeError: nth_root() got an unexpected keyword argument 'all'
```


while such an option exists for other representations of complex numbers:


```
sage: a = CDF(-1)
sage: sage: a.nth_root(3)
0.5000000000000001 + 0.8660254037844386*I
sage: sage: a.nth_root(3, all=True)
[0.5000000000000001 + 0.8660254037844386*I,
 -1.0 + 3.4393603416671414e-16*I,
 0.49999999999999933 - 0.8660254037844389*I]
```


The aim of this ticket is to provide one.


---

Comment by tmonteil created at 2015-06-25 17:15:35

New commits:


---

Comment by tmonteil created at 2015-06-25 17:15:35

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2015-06-25 17:26:20

Use `**` instead of `__pow__` (the former is faster).


---

Comment by jdemeyer created at 2015-06-25 17:26:20

Changing status from needs_review to needs_work.


---

Comment by git created at 2015-06-25 17:42:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tmonteil created at 2015-06-25 17:44:23

Changing status from needs_work to needs_review.


---

Comment by tmonteil created at 2015-06-25 17:44:23

I did it. Does `a**b` not just call `a.__pow__(b)` ? I do not see any difference with timeit. Note that there are other uses of `__pow__` on the same file.


---

Comment by vdelecroix created at 2015-08-03 08:24:37

Replying to [comment:6 tmonteil]:
> I did it. Does `a**b` not just call `a.__pow__(b)` ? I do not see any difference with timeit. Note that there are other uses of `__pow__` on the same file.

As far as I understand: It does. When you do `__pow__` there is an introspection (= lookup in the dictionary of methods). But for special methods there are dedicated slots and when you do `**` there is no lookup since you access directly to this slot.


---

Comment by vdelecroix created at 2015-08-03 08:26:50

Why did you remove

```diff
- Note that for odd `n` and negative real numbers, ``AlgebraicReal``
- and ``AlgebraicNumber`` values give different answers: ``AlgebraicReal``
- values prefer real results, and ``AlgebraicNumber`` values
- return the principal root.
```



---

Comment by vdelecroix created at 2015-08-03 08:27:05

Changing status from needs_review to needs_info.


---

Comment by tmonteil created at 2015-08-05 23:38:37

Replying to [comment:8 vdelecroix]:
> Why did you remove
> {{{#!diff
> - Note that for odd `n` and negative real numbers, ``AlgebraicReal``
> - and ``AlgebraicNumber`` values give different answers: ``AlgebraicReal``
> - values prefer real results, and ``AlgebraicNumber`` values
> - return the principal root.
> }}}

I did not remove it, i moved it into a `WARNING` section, after the `INPUT` section since it only makes sense when the input has `all=`False``.


---

Comment by tmonteil created at 2015-08-05 23:38:46

Changing status from needs_info to needs_review.


---

Comment by vdelecroix created at 2015-08-06 15:27:35

I am not sure `see :trac:`17379`` is appropriate for a change that is not a bugfix. Are you willing to see reference to trac for each new feature implemented?

Do you have an idea why this is long

```
sage: AA(-2).nth_root(5, all=True) == QQbar(-2).nth_root(5, all=True) # long time
```


Vincent


---

Comment by vdelecroix created at 2015-11-28 15:21:26

Replying to [comment:12 vdelecroix]:
> I am not sure `see :trac:`17379`` is appropriate for a change that is not a bugfix. Are you willing to see reference to trac for each new feature implemented?

What about it?

> Do you have an idea why this is long
> {{{
> sage: AA(-2).nth_root(5, all=True) == QQbar(-2).nth_root(5, all=True) # long time
> }}}

It is because of `exactify`... `AA` and `QQbar` are sometimes by far too lazy.


---

Comment by vdelecroix created at 2015-11-28 15:21:37

Changing status from needs_review to needs_info.


---

Comment by git created at 2015-12-02 13:53:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tmonteil created at 2015-12-02 13:55:47

Replying to [comment:12 vdelecroix]:
> I am not sure `see :trac:`17379`` is appropriate for a change that is not a bugfix. Are you willing to see reference to trac for each new feature implemented?

I don't think it hurts, but i removed it.


---

Comment by tmonteil created at 2015-12-02 13:55:47

Changing status from needs_info to needs_review.


---

Comment by vdelecroix created at 2015-12-02 19:43:09

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-12-02 23:51:53

Merge conflict, try next beta


---

Comment by vbraun created at 2015-12-02 23:51:53

Changing status from positive_review to needs_work.


---

Comment by tmonteil created at 2015-12-03 12:00:31

I don't understand how it is possible, i merged the branch with 6.10.beta6 before the last commit.


---

Comment by jdemeyer created at 2015-12-03 14:13:29

Most likely a conflict with #19597.


---

Comment by tmonteil created at 2015-12-03 14:58:42

So i just have to wait for 6.10.beta7 to be out and merge, right ?


---

Comment by git created at 2015-12-07 11:57:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tmonteil created at 2015-12-07 11:59:32

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2015-12-07 18:03:39

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2015-12-07 19:07:01

I haven't really reviewed this.


---

Comment by vbraun created at 2015-12-09 17:54:54

Resolution: fixed
