# Issue 14463: Matroid union

archive/issues_014463.json:
```json
{
    "body": "Assignee: sage-combinat\n\nCC:  @darijgr\n\nKeywords: matroid\n\nAdd matroid union to the matroids module.\n\nIssue created by migration from https://trac.sagemath.org/ticket/14667\n\n",
    "created_at": "2013-05-30T18:17:54Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Matroid union",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14463",
    "user": "https://trac.sagemath.org/admin/accounts/users/Stefan"
}
```
Assignee: sage-combinat

CC:  @darijgr

Keywords: matroid

Add matroid union to the matroids module.

Issue created by migration from https://trac.sagemath.org/ticket/14667





---

archive/issue_comments_182778.json:
```json
{
    "body": "Changing component from combinatorics to matroid theory.",
    "created_at": "2013-09-13T13:44:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14463#issuecomment-182778",
    "user": "https://trac.sagemath.org/admin/accounts/users/Stefan"
}
```

Changing component from combinatorics to matroid theory.



---

archive/issue_comments_182779.json:
```json
{
    "body": "Changing assignee from sage-combinat to Stefanf.",
    "created_at": "2013-09-13T13:44:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14463#issuecomment-182779",
    "user": "https://trac.sagemath.org/admin/accounts/users/Stefan"
}
```

Changing assignee from sage-combinat to Stefanf.



---

archive/issue_comments_182780.json:
```json
{
    "body": "Hi,\nI want to implement the function.May i know the preferred signature of the function and where should i add it.\nThanks!",
    "created_at": "2014-02-14T14:26:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14463#issuecomment-182780",
    "user": "https://github.com/Rajesh-Veeranki"
}
```

Hi,
I want to implement the function.May i know the preferred signature of the function and where should i add it.
Thanks!



---

archive/issue_comments_182781.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-02-16T02:47:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14463#issuecomment-182781",
    "user": "https://github.com/Rajesh-Veeranki"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_182782.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-02-17T19:26:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14463#issuecomment-182782",
    "user": "https://trac.sagemath.org/admin/accounts/users/Stefan"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_182783.json:
```json
{
    "body": "1) I would not import this into the main namespace; rather I'd create a \"submenu\" matroids.constructions, just like we have matroids.named_matroids now.\n\n2) Instead of computing the full list of bases, which is an expensive operation, I'd return a RankMatroid with the appropriate rank function (implemented efficiently using matroid intersection). Matroid Union is likely to be applied to fairly large matroids, derived from graphs, whereas BasisMatroid is optimized for small matroids.\n\n----\nNew commits:",
    "created_at": "2014-02-17T19:26:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14463#issuecomment-182783",
    "user": "https://trac.sagemath.org/admin/accounts/users/Stefan"
}
```

1) I would not import this into the main namespace; rather I'd create a "submenu" matroids.constructions, just like we have matroids.named_matroids now.

2) Instead of computing the full list of bases, which is an expensive operation, I'd return a RankMatroid with the appropriate rank function (implemented efficiently using matroid intersection). Matroid Union is likely to be applied to fairly large matroids, derived from graphs, whereas BasisMatroid is optimized for small matroids.

----
New commits:



---

archive/issue_comments_182784.json:
```json
{
    "body": "Dear Prof.Stefan,\n\nI have implemented the matroid union (for 2 matroids) using Rank Matroid.The rank function I used is\nrank_(M1UM2)(X) = max ( |Y|+rM2(X)) where Y belongs to M1 intersection M2*, Y subset of X\n\n\n```\ndef MatroidUnion(M0,M1):\n\n\t#Constructing matroid union from two matroids\n\t#rank(X) = max ( |Y| + rM2(X) ) where Y subset of X, and Y belongs to M0 \\cap M1.dual()\n\n\tcommon_ground_set = M0.groundset()\n\tcommon_ground_set = common_ground_set.union(M1.groundset())\n\n\tdef f(X):\n\t\tground_set = common_ground_set.intersection(X)\n\t\tdelSet = common_ground_set-ground_set\n\n\t\tdef h(X):\n\t\t\treturn M0.rank(set(X).intersection(M0.groundset()))\n\n\t\t#Extending matroid M0 to the union of groundsets\n\t\tI0 = RankMatroid(groundset=common_ground_set,rank_function=h)\n\n\t\tdef g(X):\n\t\t\treturn M1.rank(set(X).intersection(M1.groundset()))\n\n\t\t#Extending matroid M1 to the  union of groundsets\n\t\tI1 = RankMatroid(groundset=common_ground_set,rank_function=g)\n\n\t\t#Restricting matroid M0 to set X\n\t\tI0 = I0.delete(delSet)\n\n\t\t#Taking M1 dual and restricting to set X\n\t\tI1 = I1.dual()\n\t\tI1 = I1.delete(delSet)\n\n\t\t# rank(X) = max ( |Y| + rM2(X) ) where Y subset of X, and Y belongs to I0 \\cap I1\n\t\tr1 = len(I0.intersection(I1))\n\t\tr2 = M1.rank(set(X).intersection(M1.groundset()))\n\t\treturn r1+r2\n\n\n\treturn RankMatroid(groundset=common_ground_set,rank_function=f)\n```\n\n\nThis works just fine. What are your comments on this?\nI plan to implement MatroidUnion for any no.of matroids, by calling MatriodUnion for 2 matroids each time.\n\nThanks!",
    "created_at": "2014-02-23T07:27:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14463#issuecomment-182784",
    "user": "https://github.com/Rajesh-Veeranki"
}
```

Dear Prof.Stefan,

I have implemented the matroid union (for 2 matroids) using Rank Matroid.The rank function I used is
rank_(M1UM2)(X) = max ( |Y|+rM2(X)) where Y belongs to M1 intersection M2*, Y subset of X


```
def MatroidUnion(M0,M1):

	#Constructing matroid union from two matroids
	#rank(X) = max ( |Y| + rM2(X) ) where Y subset of X, and Y belongs to M0 \cap M1.dual()

	common_ground_set = M0.groundset()
	common_ground_set = common_ground_set.union(M1.groundset())

	def f(X):
		ground_set = common_ground_set.intersection(X)
		delSet = common_ground_set-ground_set

		def h(X):
			return M0.rank(set(X).intersection(M0.groundset()))

		#Extending matroid M0 to the union of groundsets
		I0 = RankMatroid(groundset=common_ground_set,rank_function=h)

		def g(X):
			return M1.rank(set(X).intersection(M1.groundset()))

		#Extending matroid M1 to the  union of groundsets
		I1 = RankMatroid(groundset=common_ground_set,rank_function=g)

		#Restricting matroid M0 to set X
		I0 = I0.delete(delSet)

		#Taking M1 dual and restricting to set X
		I1 = I1.dual()
		I1 = I1.delete(delSet)

		# rank(X) = max ( |Y| + rM2(X) ) where Y subset of X, and Y belongs to I0 \cap I1
		r1 = len(I0.intersection(I1))
		r2 = M1.rank(set(X).intersection(M1.groundset()))
		return r1+r2


	return RankMatroid(groundset=common_ground_set,rank_function=f)
```


This works just fine. What are your comments on this?
I plan to implement MatroidUnion for any no.of matroids, by calling MatriodUnion for 2 matroids each time.

Thanks!



---

archive/issue_comments_182785.json:
```json
{
    "body": "Already implemented in sage.matroids.union_matroid",
    "created_at": "2016-04-04T19:08:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14463#issuecomment-182785",
    "user": "https://trac.sagemath.org/admin/accounts/users/Stefan"
}
```

Already implemented in sage.matroids.union_matroid



---

archive/issue_comments_182786.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-06-02T13:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14463#issuecomment-182786",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_182787.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2017-07-13T07:54:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14463#issuecomment-182787",
    "user": "https://github.com/embray"
}
```

Resolution: wontfix



---

archive/issue_comments_182788.json:
```json
{
    "body": "Closing tickets in the sage-duplicate/invalid/wontfix module with positive_review (i.e. someone has confirmed they should be closed).",
    "created_at": "2017-07-13T07:54:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14463#issuecomment-182788",
    "user": "https://github.com/embray"
}
```

Closing tickets in the sage-duplicate/invalid/wontfix module with positive_review (i.e. someone has confirmed they should be closed).
