# Issue 18101: bell_polynomial(n,k) should always return a polynomial

archive/issues_018101.json:
```json
{
    "body": "CC:  @kevindilks\n\nAs reported in [this ask question](http://ask.sagemath.org/question/26682/bell_polynomialnkcoefficients-raises-an-error/), `bell_polynomial(n,k)` sometimes returns a rational number, while the documents claims that it outputs a polynomial in `n-k+1` variables over `\\QQ`.\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/18338\n\n",
    "created_at": "2015-04-29T20:12:06Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.7",
    "title": "bell_polynomial(n,k) should always return a polynomial",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18101",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```
CC:  @kevindilks

As reported in [this ask question](http://ask.sagemath.org/question/26682/bell_polynomialnkcoefficients-raises-an-error/), `bell_polynomial(n,k)` sometimes returns a rational number, while the documents claims that it outputs a polynomial in `n-k+1` variables over `\QQ`.


Issue created by migration from https://trac.sagemath.org/ticket/18338





---

archive/issue_comments_243631.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-29T20:46:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18101#issuecomment-243631",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_243632.json:
```json
{
    "body": "Side question : is there a good reason for the variables to start at `x_1` and not `x_0` ?\n\n---\nNew commits:",
    "created_at": "2015-04-29T20:46:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18101#issuecomment-243632",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Side question : is there a good reason for the variables to start at `x_1` and not `x_0` ?

---
New commits:



---

archive/issue_comments_243633.json:
```json
{
    "body": "Replying to [comment:2 tmonteil]:\n> Side question : is there a good reason for the variables to start at `x_1` and not `x_0` ?\n\n\nIndeed, it would be much simpler without this ugly\n\n```\nR = QQ[tuple(['x_'+str(i) for i in range(1, n-k+2)])]\n```\nthat would just become\n\n```\nR = PolynomialRing(QQ, 'x', n-k+1)\n```\nOn the other hand, [wikipedia](http://en.wikipedia.org/wiki/Bell_polynomials) starts at 1.\n\nVincent",
    "created_at": "2015-04-29T22:43:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18101#issuecomment-243633",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:2 tmonteil]:
> Side question : is there a good reason for the variables to start at `x_1` and not `x_0` ?


Indeed, it would be much simpler without this ugly

```
R = QQ[tuple(['x_'+str(i) for i in range(1, n-k+2)])]
```
that would just become

```
R = PolynomialRing(QQ, 'x', n-k+1)
```
On the other hand, [wikipedia](http://en.wikipedia.org/wiki/Bell_polynomials) starts at 1.

Vincent



---

archive/issue_comments_243634.json:
```json
{
    "body": "Vincent, this is indeed the core question and I am happy that you mention it!\n\nThe old way to enumerate things here (not only at Wikipedia) is to to start with x_1 and to let the lower triangular matrix of coefficients start at the offset (1,1). Nevertheless the same authors define B_{0,0} = 1 but simply ignore B_{0,k} for k>0. This is a big problem affecting many number triangles on OEIS in particular older versions of the Stirling numbers (see for example the unfortunate (1,1) based definition https://oeis.org/A008275) and of the Lah numbers (https://oeis.org/A008297).\n\nSo it depends on how bold the authors of Sage want to be: I am certainly in favor of the definition with x_0, x_1,... which makes thing much cleaner and in agreement with the definition of the Stirling numbers and Lah numbers as they are defined in the recent literature (D. E. Knuth for example, Concrete Mathematics) with an offset (0,0).\n\nPeter\n\nADDED: For what it's worth I explain my point of view a bit more explicit here:\n\nhttps://oeis.org/wiki/User:Peter_Luschny/Marginalia\n\n(Link updated.)",
    "created_at": "2015-04-30T11:41:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18101#issuecomment-243634",
    "user": "https://github.com/PeterLuschny"
}
```

Vincent, this is indeed the core question and I am happy that you mention it!

The old way to enumerate things here (not only at Wikipedia) is to to start with x_1 and to let the lower triangular matrix of coefficients start at the offset (1,1). Nevertheless the same authors define B_{0,0} = 1 but simply ignore B_{0,k} for k>0. This is a big problem affecting many number triangles on OEIS in particular older versions of the Stirling numbers (see for example the unfortunate (1,1) based definition https://oeis.org/A008275) and of the Lah numbers (https://oeis.org/A008297).

So it depends on how bold the authors of Sage want to be: I am certainly in favor of the definition with x_0, x_1,... which makes thing much cleaner and in agreement with the definition of the Stirling numbers and Lah numbers as they are defined in the recent literature (D. E. Knuth for example, Concrete Mathematics) with an offset (0,0).

Peter

ADDED: For what it's worth I explain my point of view a bit more explicit here:

https://oeis.org/wiki/User:Peter_Luschny/Marginalia

(Link updated.)



---

archive/issue_comments_243635.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-04T14:26:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18101#issuecomment-243635",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_243636.json:
```json
{
    "body": "While we are at it, is there a good reason for the base ring of the polynomials to be `QQ` and not `ZZ` ?",
    "created_at": "2015-05-04T14:28:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18101#issuecomment-243636",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

While we are at it, is there a good reason for the base ring of the polynomials to be `QQ` and not `ZZ` ?



---

archive/issue_comments_243637.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-21T15:46:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18101#issuecomment-243637",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_243638.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-05-23T21:47:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18101#issuecomment-243638",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_243639.json:
```json
{
    "body": "This is ugly\n\n```diff\n- return result\n+ return R(result)\n```\nCould you instead make it in such way that the coefficients belong to `ZZ`. With the current version you are intensively using coercion `ZZ[x0,x1,...] -> QQ[x0,x1,...]` for no good reasons. i.e. just use `//` instead of `/` here\n\n```\ncoefficient = factorial(n) / (factorial_product * power_factorial_product)\n```",
    "created_at": "2015-05-23T21:47:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18101#issuecomment-243639",
    "user": "https://github.com/videlec"
}
```

This is ugly

```diff
- return result
+ return R(result)
```
Could you instead make it in such way that the coefficients belong to `ZZ`. With the current version you are intensively using coercion `ZZ[x0,x1,...] -> QQ[x0,x1,...]` for no good reasons. i.e. just use `//` instead of `/` here

```
coefficient = factorial(n) / (factorial_product * power_factorial_product)
```



---

archive/issue_comments_243640.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-31T20:23:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18101#issuecomment-243640",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_243641.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-05-31T20:26:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18101#issuecomment-243641",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_243642.json:
```json
{
    "body": "Docstring giving definition for the Bell Polynomial needs to be changed to reflect the new numbering of x_0,x_1,... as opposed to x_1,x_2,... .",
    "created_at": "2015-06-09T17:14:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18101#issuecomment-243642",
    "user": "https://github.com/kevindilks"
}
```

Docstring giving definition for the Bell Polynomial needs to be changed to reflect the new numbering of x_0,x_1,... as opposed to x_1,x_2,... .



---

archive/issue_comments_243643.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-10T06:23:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18101#issuecomment-243643",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_243644.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-10T06:39:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18101#issuecomment-243644",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_243645.json:
```json
{
    "body": "Thanks to notice, i have updated the formula (that was actually missing some braces and was unreadable, see http://doc.sagemath.org/html/en/reference/combinat/sage/combinat/combinat.html#sage.combinat.combinat.bell_polynomial)",
    "created_at": "2015-06-10T06:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18101#issuecomment-243645",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Thanks to notice, i have updated the formula (that was actually missing some braces and was unreadable, see http://doc.sagemath.org/html/en/reference/combinat/sage/combinat/combinat.html#sage.combinat.combinat.bell_polynomial)



---

archive/issue_comments_243646.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-10-02T02:50:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18101#issuecomment-243646",
    "user": "https://github.com/kevindilks"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_243647.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-10-12T07:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18101",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18101#issuecomment-243647",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_051745.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-10-12T07:16:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18101",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18101#event-51745"
}
```
