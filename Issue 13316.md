# Issue 13316: Derivative/integral of cubic splines in sage/gsl/interpolation.pyx

Issue created by migration from https://trac.sagemath.org/ticket/13520

Original creator: jvkersch

Original creation time: 2012-09-22 18:00:05

Assignee: jason, jkantor

CC:  kcrisman

Keywords: spline, gsl

This patch exposes methods from GSL to compute derivatives and definite integrals of cubic splines. This is done by adding two member functions to ```sage.gsl.interpolation.Spline```.


---

Comment by jvkersch created at 2012-09-22 18:07:38

Changing status from new to needs_review.


---

Comment by tscrim created at 2012-10-07 19:01:29

Changing status from needs_review to needs_work.


---

Comment by tscrim created at 2012-10-07 19:01:29

I get some precision errors:

```
**********************************************************************
File "/home/travis/sage-5.4.beta1/devel/sage-reviews/sage/gsl/interpolation.pyx", line 77:
    sage: s.derivative(5)
Expected:
    -0.16230085261803096
Got:
    -0.16230085261803057
**********************************************************************
File "/home/travis/sage-5.4.beta1/devel/sage-reviews/sage/gsl/interpolation.pyx", line 79:
    sage: s.derivative(6)
Expected:
    0.20997986285714798
Got:
    0.20997986285714818
**********************************************************************
File "/home/travis/sage-5.4.beta1/devel/sage-reviews/sage/gsl/interpolation.pyx", line 81:
    sage: s.derivative(5, order=2)
Expected:
    -3.0874707456138095
Got:
    -3.0874707456138086
**********************************************************************
```

I am running the tests on Ubuntu 10.04 on a VirtualBox VM with a host of Intel Core Duo T6400, with a 64-bit Vista OS.


---

Comment by jvkersch created at 2012-10-15 18:51:53

Changing status from needs_work to needs_review.


---

Comment by jvkersch created at 2012-10-15 18:51:53

Thanks for letting me know about the precision issues. I've uploaded a new patch where I've truncated the offending floating point numbers.


---

Comment by tscrim created at 2012-10-15 22:28:35

Almost:

```
File "/home/travis/sage-5.4.beta1/devel/sage-reviews/sage/gsl/interpolation.pyx", line 79:
    sage: s.derivative(6)
Expected:
    0.209979862857147...
Got:
    0.20997986285714818
**********************************************************************
File "/home/travis/sage-5.4.beta1/devel/sage-reviews/sage/gsl/interpolation.pyx", line 81:
    sage: s.derivative(5, order=2)
Expected:
    -3.087470745613809...
Got:
    -3.0874707456138086
```

Just remove the 7 and the 9 on the respective lines and then all tests passed for me. Thanks.


---

Attachment

Aaahhh :) Ok, I've removed those digits in the latest version of the patch.


---

Comment by tscrim created at 2012-10-16 15:26:52

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2012-10-16 15:26:52

Works for me now. Thank you.

Travis


---

Comment by jvkersch created at 2012-10-17 10:30:32

Thanks for the positive review and for the many helpful comments!


---

Comment by jdemeyer created at 2012-11-01 12:03:11

Resolution: fixed
