# Issue 23187: Compute square root of positive semidefinite matrix

Issue created by migration from https://trac.sagemath.org/ticket/23424

Original creator: stumpc5

Original creation time: 2017-07-13 14:52:32

CC:  dimpase nthiery jmichel tscrim

Keywords: matrix root

This is more a question, I do not have checked how to actually do it.

An (Hermitian) positive semidefinite matrix M has a unique positive semidefinite square root T, this is, M = T^2.

I would like to have this square root implemented as I need it for some further computations. This is already possible numerically as in


```
sage: W = RootSystem(['A',3])
sage: C = W.cartan_matrix()
sage: D, S = C.eigenmatrix_right()
sage: D

[                  2                   0                   0]
[                  0 0.5857864376269049?                   0]
[                  0                   0  3.414213562373095?]
sage: S

[                  1                   1                   1]
[                  0  1.414213562373095? -1.414213562373095?]
[                 -1                   1                   1]
sage: T = S*diagonal_matrix([sqrt(x) for x in D.diagonal()])*S^-1
sage: T

[   1.360388263624736?  -0.3826834323650898? -0.05382529874835926?]
[ -0.3826834323650898?    1.306562964876377?  -0.3826834323650898?]
[-0.05382529874835926?  -0.3826834323650898?    1.360388263624736?]
sage: T^2 == C
True
```

It would be great to (1) have this exact (in some field extension in which the square roots live) and (2) to have the positive semidefinite decomposition.


---

Comment by dimpase created at 2017-07-17 13:27:52

Changing status from new to needs_info.


---

Comment by dimpase created at 2017-07-17 13:27:52

The example in the ticket description is actually an exact computation, just displayed in a slightly misleading way. Indeed, one computes in `QQbar` here:

```
sage: d1=D[1][1]
sage: d1
0.5857864376269049?
sage: d1.minpoly()
x^2 - 4*x + 2
sage: d1.sqrt().minpoly()
x^4 - 4*x^2 + 2
sage: type(d1)
<class 'sage.rings.qqbar.AlgebraicNumber'>
```

Thus, what is the question? This way it seems like an implementation is already there.


---

Comment by stumpc5 created at 2017-07-17 15:31:44

Oh, I indeed missed this. Updated description.


---

Comment by dimpase created at 2017-07-17 16:00:48

IMHO it is more of a mathematical question whether you get a p.s.d. T.

In the basis of the columns of S, one has the quadratic form, given by M in the standard basis, diagonal, given by D, with nonnegative entries (i.e. M=SDS<sup>-1</sup>).
The square root T is a power series in M, and thus given by T=SD<sup>1/2</sup>S<sup>-1</sup>, 
a p.s.d. matrix with eigenvalues given by D<sup>1/2</sup>, thus all positive whenever D>0.

What can still go wrong is that T is not equal to T<sup>*</sup>. 

However we know that D=D<sup>*</sup> and so M<sup>*</sup>=M=SDS<sup>-1</sup>=S<sup>*-1</sup>DS<sup>*</sup>, implying S<sup>*</sup>SD=DS<sup>*</sup>S.
Thus any power of D commutes with S<sup>*</sup>S, thus S<sup>*</sup>SD<sup>1/2</sup>=D<sup>1/2</sup>S<sup>*</sup>S implying T=T<sup>*</sup>.

Anything I still miss?


---

Comment by stumpc5 created at 2018-05-30 13:28:00

Changing keywords from "matrix root" to "matrix root, days93.51".


---

Comment by stumpc5 created at 2018-05-30 13:28:00

duplicate of #25464


---

Comment by stumpc5 created at 2018-05-30 13:28:00

Resolution: duplicate
