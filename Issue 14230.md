# Issue 14230: Implement feedback_vertex_set for graphs

Issue created by migration from Trac.

Original creator: ncohen

Original creation time: 2013-04-10 08:13:52

Assignee: jason, ncohen, rlm

CC:  tmonteil vdelecroix dimpase kini




---

Attachment


---

Comment by ncohen created at 2013-04-10 13:16:26

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2013-06-03 18:38:56

Changing status from needs_review to needs_work.


---

Attachment


```
sage -t graphs/generic_graph.py
**********************************************************************
File "graphs/generic_graph.py", line 6137, in sage.graphs.generic_graph.GenericGraph.feedback_vertex_set
Failed example:
    g.feedback_vertex_set()
Expected:
    [1, 3, 5]
Got:
    [0, 3, 6]
**********************************************************************
```



---

Comment by ncohen created at 2013-06-03 21:36:18

Did you by any chance install CPLEX or a LP solver which is not GLPK ? `:-P`

Nathann


---

Comment by vdelecroix created at 2013-06-04 04:58:14

Replying to [comment:3 ncohen]:
> Did you by any chance install CPLEX or a LP solver which is not GLPK ? `:-P`

Nope. And patchbot neither.


---

Comment by ncohen created at 2013-06-04 18:27:51

Yep. Most probably because I am the one who installed it, and I did not remember `>_<`

Nathann


---

Comment by ncohen created at 2013-06-04 18:32:53

Changing status from needs_work to needs_review.


---

Comment by ncohen created at 2013-06-04 18:32:53

Updated. Sorryyyyyyyyyyyyyyyyyyyyyyyyyyyyy `^^;`

Nathann


---

Attachment


---

Comment by vdelecroix created at 2013-06-05 06:46:03

I update a patch with several corrections in the documentation. If you are happy, make it positive review.

Two curiosities:

I just learn that for verbosity, there is `sage.misc.misc.verbose`.

Why

```
[v for v in self if p.get_values(b[v]) < .5]
```

instead of

```
[v for v in self if p.get_values(b[v]) == 0.]
```



---

Comment by ncohen created at 2013-06-05 07:54:43

Yoooooooooooooooo !!!

> I just learn that for verbosity, there is `sage.misc.misc.verbose`.

`>_<`

Yeah... Right `>_<`

Pretty good idea... But this will require a LARGE patch `:-PPPPPP`

I have one thousand different functions with a verbosity level, though most of them are LP-related. I wonder if it's a good idea to have a global function to do that rather than a flag for each function... HMmmmmmm `O_o`

> Why
> {{{
> [v for v in self if p.get_values(b[v]) < .5]
> }}}
> instead of
> {{{
> [v for v in self if p.get_values(b[v]) == 0.]
> }}}

Because this is old code, written before integer values were automatically rounded. I will update this in a second.

Nathann


---

Attachment


---

Comment by ncohen created at 2013-06-05 08:03:19

Here it is ! Patch updated to fix a couple of .5 that remained. Could you give it a final check, and set the ticket to positive review if you agree ? Thanks for your changes to the doc !

Nathann


---

Comment by vdelecroix created at 2013-06-05 08:19:22

To twist the alphabetic logic of patchbot:

apply trac_14434-move.patch trac_14434.patch trac_14434-doctest.patch trac_14434-clean_doc.patch Download


---

Comment by vdelecroix created at 2013-06-05 08:19:22

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-06-10 08:41:34

Resolution: fixed


---

Comment by jdemeyer created at 2013-06-12 07:48:58

Changing status from closed to new.


---

Comment by jdemeyer created at 2013-06-12 07:48:58

This breaks on some 32-bit systems, in particular arando (Linux Ubuntu 13.04 i686):

```
sage -t --long devel/sage/sage/graphs/generic_graph.py
**********************************************************************
File "devel/sage/sage/graphs/generic_graph.py", line 6219, in sage.graphs.generic_graph.GenericGraph.feedback_vertex_set
Failed example:
    fvs = g.feedback_vertex_set()
Exception raised:
    Traceback (most recent call last):
      File "/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.11.beta1/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 475, in _run
        self.execute(example, compiled, test.globs)
      File "/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.11.beta1/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 834, in execute
        exec compiled in globs
      File "<doctest sage.graphs.generic_graph.GenericGraph.feedback_vertex_set[1]>", line 1, in <module>
        fvs = g.feedback_vertex_set()
      File "/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.11.beta1/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 6311, in feedback_vertex_set
        isok, certificate = h.is_forest(certificate = True)
    TypeError: 'NoneType' object is not iterable
**********************************************************************
File "devel/sage/sage/graphs/generic_graph.py", line 6220, in sage.graphs.generic_graph.GenericGraph.feedback_vertex_set
Failed example:
    len(fvs)
Exception raised:
    Traceback (most recent call last):
      File "/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.11.beta1/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 475, in _run
        self.execute(example, compiled, test.globs)
      File "/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.11.beta1/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 834, in execute
        exec compiled in globs
      File "<doctest sage.graphs.generic_graph.GenericGraph.feedback_vertex_set[2]>", line 1, in <module>
        len(fvs)
    NameError: name 'fvs' is not defined
**********************************************************************
File "devel/sage/sage/graphs/generic_graph.py", line 6222, in sage.graphs.generic_graph.GenericGraph.feedback_vertex_set
Failed example:
    g.delete_vertices(fvs)
Exception raised:
    Traceback (most recent call last):
      File "/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.11.beta1/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 475, in _run
        self.execute(example, compiled, test.globs)
      File "/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.11.beta1/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 834, in execute
        exec compiled in globs
      File "<doctest sage.graphs.generic_graph.GenericGraph.feedback_vertex_set[3]>", line 1, in <module>
        g.delete_vertices(fvs)
    NameError: name 'fvs' is not defined
**********************************************************************
File "devel/sage/sage/graphs/generic_graph.py", line 6223, in sage.graphs.generic_graph.GenericGraph.feedback_vertex_set
Failed example:
    g.is_forest()
Expected:
    True
Got:
    False
**********************************************************************
```



---

Comment by jdemeyer created at 2013-06-12 07:48:58

Resolution changed from fixed to 


---

Comment by ncohen created at 2013-06-12 07:59:25

Is there a way for me to get access to this machine ? I really have no idea what's happening and I cannot reproduce the bug `O_o`

Nathann


---

Comment by jdemeyer created at 2013-06-12 09:15:19

Replying to [comment:15 ncohen]:
> Is there a way for me to get access to this machine ? I really have no idea what's happening and I cannot reproduce the bug `O_o`

Ask Dima or Keshav.


---

Comment by ncohen created at 2013-06-13 09:33:28

Well... Guys ? Do you have any idea ? `O_o`

Nathann


---

Comment by jdemeyer created at 2013-06-13 09:39:41

Nathann, do you access to *any 32-bit* machine? Because this looks like a 32/64 bit issue, nothing particular to arando.


---

Comment by ncohen created at 2013-06-13 09:42:37

No I don't, and I don't see why this code would react to something like that either `:-/`

Nathann


---

Comment by jdemeyer created at 2013-06-13 09:47:44

It could also be a hashing issue, do you use a `dict` somewhere and rely on its order for example?


---

Comment by ncohen created at 2013-06-13 10:06:04

Looks like it is a problem in `Graph.is_tree()`. But if I can't test it, it's hard to debug... `:-/`

Nathann


---

Comment by dimpase created at 2013-06-13 10:54:07

Replying to [comment:21 ncohen]:
> Looks like it is a problem in `Graph.is_tree()`. But if I can't test it, it's hard to debug... `:-/`
> 
> Nathann
I'll make you an account. 
The only way to get to that 32-bit machine is by reverse ssh, so you will have to ssh to boxen first...


---

Comment by ncohen created at 2013-06-13 14:11:55

Changing status from new to needs_review.


---

Attachment

I'm an idiot `>_<`

Nathann


---

Attachment

just to make sure that patchbot does not get confused, I removed "Or..." part.


---

Comment by ncohen created at 2013-06-13 22:18:09

Apply trac_14434-ALL.patch


---

Comment by vdelecroix created at 2013-07-07 17:03:29

Good to go!


---

Comment by vdelecroix created at 2013-07-07 17:03:29

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2013-07-07 17:04:26

Cool ! Thank you for the review `:-)`

Nathann


---

Comment by jdemeyer created at 2013-08-19 06:44:54

Resolution: fixed
