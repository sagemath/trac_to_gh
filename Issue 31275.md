# Issue 31275: Implementation of the graded quasimodular forms ring

archive/issues_031275.json:
```json
{
    "body": "CC:  slelievre vdelecroix\n\nKeywords: graded quasimodular forms gsoc2021\n\nThe goal of this ticket is to implement the ring of graded quasimodular forms as there are no such functionality in [SageMath](SageMath) (as of v9.2). More precisely, the goal is to first implement a class named `QuasiModularFormsRing` with similar methods and feature as the class `ModularFormsRing`. Second, it would be desirable to implement the Block-Okounkov bracket that, given a shifed symmetric polynomial, produces a quasimodular form.\n\nThis initial implementation is really \"primitive\" and work only for the full modular groups. However, it would be great to support quasimodular forms for higher level congruence subgroups.\n\nThis is my first ticket for a new enhancement, so any comments and insight about how to correctly do this is more than welcome.\n\nIssue created by migration from https://trac.sagemath.org/ticket/31512\n\n",
    "created_at": "2021-03-18T18:01:05Z",
    "labels": [
        "modular forms",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Implementation of the graded quasimodular forms ring",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31275",
    "user": "@DavidAyotte"
}
```
CC:  slelievre vdelecroix

Keywords: graded quasimodular forms gsoc2021

The goal of this ticket is to implement the ring of graded quasimodular forms as there are no such functionality in [SageMath](SageMath) (as of v9.2). More precisely, the goal is to first implement a class named `QuasiModularFormsRing` with similar methods and feature as the class `ModularFormsRing`. Second, it would be desirable to implement the Block-Okounkov bracket that, given a shifed symmetric polynomial, produces a quasimodular form.

This initial implementation is really "primitive" and work only for the full modular groups. However, it would be great to support quasimodular forms for higher level congruence subgroups.

This is my first ticket for a new enhancement, so any comments and insight about how to correctly do this is more than welcome.

Issue created by migration from https://trac.sagemath.org/ticket/31512





---

archive/issue_comments_447004.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-03-18T18:06:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447004",
    "user": "@DavidAyotte"
}
```

New commits:



---

archive/issue_comments_447005.json:
```json
{
    "body": "Set assignee to @DavidAyotte.",
    "created_at": "2021-03-18T18:06:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447005",
    "user": "@DavidAyotte"
}
```

Set assignee to @DavidAyotte.



---

archive/issue_comments_447006.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-03-18T19:45:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447006",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447007.json:
```json
{
    "body": "Hi David,\n\nGreat start.\n\nLet us stick to `SL(2,Z)` in this ticket. Further improvements (other congruence subgroups, Bloch-Okounkov brackets should be reserved for other tickets).\n\nSome concrete remarks\n- `QuasiModularFormsRing` could simply be `QuasiModularForms`\n- The main class should inherit from `Parent` and the category should be properly initialized, see https://doc.sagemath.org/html/en/thematic_tutorials/coercion_and_categories.html\n- The objective is to manipulate exact formal objects. Not approximate q-series. The following operations should be available on the elements\n  - equality tests between two qm-forms\n  - decomposition of a qm-form with respect to the grading (ie by level)\n  - testing modularity\n  - computing the q-series expansion of a qm-form (arbitrary precision)\n  - multiplication by a modular form (maybe the simplest to achieve this is to define qm-forms as an algebra over modular forms?)\n  - (further ticket) computing algebraic or differential equations (for that purpose it is necessary to have formal derivatives, not the derivative of the q-expansion)\n  - (further ticket) asymptotics of coefficients\n- The following methods should be available on the parent (the algebra itself)\n  - vector space basis of a given graded component\n  - basis and generators up to modular forms",
    "created_at": "2021-03-19T10:29:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447007",
    "user": "vdelecroix"
}
```

Hi David,

Great start.

Let us stick to `SL(2,Z)` in this ticket. Further improvements (other congruence subgroups, Bloch-Okounkov brackets should be reserved for other tickets).

Some concrete remarks
- `QuasiModularFormsRing` could simply be `QuasiModularForms`
- The main class should inherit from `Parent` and the category should be properly initialized, see https://doc.sagemath.org/html/en/thematic_tutorials/coercion_and_categories.html
- The objective is to manipulate exact formal objects. Not approximate q-series. The following operations should be available on the elements
  - equality tests between two qm-forms
  - decomposition of a qm-form with respect to the grading (ie by level)
  - testing modularity
  - computing the q-series expansion of a qm-form (arbitrary precision)
  - multiplication by a modular form (maybe the simplest to achieve this is to define qm-forms as an algebra over modular forms?)
  - (further ticket) computing algebraic or differential equations (for that purpose it is necessary to have formal derivatives, not the derivative of the q-expansion)
  - (further ticket) asymptotics of coefficients
- The following methods should be available on the parent (the algebra itself)
  - vector space basis of a given graded component
  - basis and generators up to modular forms



---

archive/issue_comments_447008.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-03-24T14:39:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447008",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447009.json:
```json
{
    "body": "Replying to [comment:6 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> ||[9fa1397](https://git.sagemath.org/sage.git/commit/?id=9fa1397adf5b3412c1974551f1ebe8d564892d38)||`Changed the name of the main class to QuasiModularForms. Added inheritance from Parent and UniqueRepresentation. Implemented category framework to the main class`||\n\nI just realized that there are some inconsistencies in the code of that commit. They will be fixed this week.",
    "created_at": "2021-03-24T20:44:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447009",
    "user": "@DavidAyotte"
}
```

Replying to [comment:6 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[9fa1397](https://git.sagemath.org/sage.git/commit/?id=9fa1397adf5b3412c1974551f1ebe8d564892d38)||`Changed the name of the main class to QuasiModularForms. Added inheritance from Parent and UniqueRepresentation. Implemented category framework to the main class`||

I just realized that there are some inconsistencies in the code of that commit. They will be fixed this week.



---

archive/issue_comments_447010.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-03-25T15:32:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447010",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447011.json:
```json
{
    "body": "Changing keywords from \"graded quasimodular forms gsoc2021\" to \"quasimodular-forms gsoc2021\".",
    "created_at": "2021-03-25T18:13:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447011",
    "user": "vdelecroix"
}
```

Changing keywords from "graded quasimodular forms gsoc2021" to "quasimodular-forms gsoc2021".



---

archive/issue_comments_447012.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-06-09T18:47:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447012",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447013.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-22T14:37:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447013",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447014.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2021-07-28T02:36:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447014",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_447015.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-03T02:04:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447015",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447016.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-03T03:12:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447016",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447017.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-03T16:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447017",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447018.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-03T18:29:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447018",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447019.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-04T16:58:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447019",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447020.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-05T14:55:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447020",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447021.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-05T20:06:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447021",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447022.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-08-05T20:07:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447022",
    "user": "@DavidAyotte"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_447023.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-06T13:25:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447023",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447024.json:
```json
{
    "body": "This\n\n```\n        if not self._polynomial.degree():\n            return self._polynomial[0].is_modular_form()\n        else:\n            return False\n```\n\nis equivalent to\n\n```\nreturn not self._polynomial.degree() and self._polynomial[0].is_modular_form()\n```\n\n\n\nWhy do you store base ring in the element (attribute `__base_ring`)? This would better be accessed through the parent. Note that `ModuleElement` has a default implementation of the method `base_ring` as\n\n```\ndef base_ring(self):\n    return self._parent.base_ring()\n```\n\nAlso, since you inherit from `Parent`, there is already a slot dedicated to that. Namely `_base`. This is initialized inside the constructor\n\n```\nParent.__init__(self, base=..., category=...)\n```\n\nSo : remove `__base_ring` from both `QuasiModularForms` and `QuasiModularFormsElement`.\n(I believe the same could be done for modular forms. But leave that to another ticket)",
    "created_at": "2021-08-07T10:33:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447024",
    "user": "vdelecroix"
}
```

This

```
        if not self._polynomial.degree():
            return self._polynomial[0].is_modular_form()
        else:
            return False
```

is equivalent to

```
return not self._polynomial.degree() and self._polynomial[0].is_modular_form()
```



Why do you store base ring in the element (attribute `__base_ring`)? This would better be accessed through the parent. Note that `ModuleElement` has a default implementation of the method `base_ring` as

```
def base_ring(self):
    return self._parent.base_ring()
```

Also, since you inherit from `Parent`, there is already a slot dedicated to that. Namely `_base`. This is initialized inside the constructor

```
Parent.__init__(self, base=..., category=...)
```

So : remove `__base_ring` from both `QuasiModularForms` and `QuasiModularFormsElement`.
(I believe the same could be done for modular forms. But leave that to another ticket)



---

archive/issue_comments_447025.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-08-07T10:33:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447025",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_447026.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-09T14:53:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447026",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447027.json:
```json
{
    "body": "Thanks a lot! I had forgotten about the base ring attribute after implementing the parent/element framework. I will open a ticket to fix this for the class `ModularFormsRing`.",
    "created_at": "2021-08-09T14:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447027",
    "user": "@DavidAyotte"
}
```

Thanks a lot! I had forgotten about the base ring attribute after implementing the parent/element framework. I will open a ticket to fix this for the class `ModularFormsRing`.



---

archive/issue_comments_447028.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-08-09T14:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447028",
    "user": "@DavidAyotte"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_447029.json:
```json
{
    "body": "Why is it only implemented for SL(2,Z)? The isomorphism `QM = M[E2]` is valid in general.",
    "created_at": "2021-08-16T15:03:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447029",
    "user": "vdelecroix"
}
```

Why is it only implemented for SL(2,Z)? The isomorphism `QM = M[E2]` is valid in general.



---

archive/issue_comments_447030.json:
```json
{
    "body": "typo: `def weigt_2_eisenstein_series(self):` (missing a h)",
    "created_at": "2021-08-16T15:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447030",
    "user": "vdelecroix"
}
```

typo: `def weigt_2_eisenstein_series(self):` (missing a h)



---

archive/issue_comments_447031.json:
```json
{
    "body": "Replying to [comment:28 vdelecroix]:\n> Why is it only implemented for SL(2,Z)? The isomorphism `QM = M[E2]` is valid in general.\n\nI will check if this doesn't break anything, but I mostly stick to the case of SL2Z because of comment:5. But thanks for reminding me this isomorphism, it should not be a problem.",
    "created_at": "2021-08-16T15:17:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447031",
    "user": "@DavidAyotte"
}
```

Replying to [comment:28 vdelecroix]:
> Why is it only implemented for SL(2,Z)? The isomorphism `QM = M[E2]` is valid in general.

I will check if this doesn't break anything, but I mostly stick to the case of SL2Z because of comment:5. But thanks for reminding me this isomorphism, it should not be a problem.



---

archive/issue_comments_447032.json:
```json
{
    "body": "Better to switch `DAVID AYOTTE` -> `David Ayotte`",
    "created_at": "2021-08-16T15:31:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447032",
    "user": "vdelecroix"
}
```

Better to switch `DAVID AYOTTE` -> `David Ayotte`



---

archive/issue_comments_447033.json:
```json
{
    "body": "Maybe we made a mistake, but the initialization from polynomial is confusing. The reason is that both `E2 * E4 - 3 * E2^2` and `-1/24 + q + 3*q^2 + 4*q^3 + 7*q^4 + 6*q^5` are polynomials.",
    "created_at": "2021-08-16T15:36:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447033",
    "user": "vdelecroix"
}
```

Maybe we made a mistake, but the initialization from polynomial is confusing. The reason is that both `E2 * E4 - 3 * E2^2` and `-1/24 + q + 3*q^2 + 4*q^3 + 7*q^4 + 6*q^5` are polynomials.



---

archive/issue_comments_447034.json:
```json
{
    "body": "Replying to [comment:32 vdelecroix]:\n> Maybe we made a mistake, but the initialization from polynomial is confusing. The reason is that both `E2 * E4 - 3 * E2^2` and `-1/24 + q + 3*q^2 + 4*q^3 + 7*q^4 + 6*q^5` are polynomials.\n\nThis is in fact really important. To fix this confusion, my idea would be to give more examples and explanations in the doc. Do you have an other idea to fix this?",
    "created_at": "2021-08-16T15:50:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447034",
    "user": "@DavidAyotte"
}
```

Replying to [comment:32 vdelecroix]:
> Maybe we made a mistake, but the initialization from polynomial is confusing. The reason is that both `E2 * E4 - 3 * E2^2` and `-1/24 + q + 3*q^2 + 4*q^3 + 7*q^4 + 6*q^5` are polynomials.

This is in fact really important. To fix this confusion, my idea would be to give more examples and explanations in the doc. Do you have an other idea to fix this?



---

archive/issue_comments_447035.json:
```json
{
    "body": "In the case of `ModularFormsRing._element_constructor_`, when the input is a polynomial the code calls `from_polynomial`. This is very different from what is happening with the quasimodular forms.",
    "created_at": "2021-08-16T15:57:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447035",
    "user": "vdelecroix"
}
```

In the case of `ModularFormsRing._element_constructor_`, when the input is a polynomial the code calls `from_polynomial`. This is very different from what is happening with the quasimodular forms.



---

archive/issue_comments_447036.json:
```json
{
    "body": "Replying to [comment:34 vdelecroix]:\n> In the case of `ModularFormsRing._element_constructor_`, when the input is a polynomial the code calls `from_polynomial`. This is very different from what is happening with the quasimodular forms.\n\nOk, so maybe the element constructor of `ModularFormsRing` should not call `from_polynomial`. What do you think?",
    "created_at": "2021-08-16T17:09:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447036",
    "user": "@DavidAyotte"
}
```

Replying to [comment:34 vdelecroix]:
> In the case of `ModularFormsRing._element_constructor_`, when the input is a polynomial the code calls `from_polynomial`. This is very different from what is happening with the quasimodular forms.

Ok, so maybe the element constructor of `ModularFormsRing` should not call `from_polynomial`. What do you think?



---

archive/issue_comments_447037.json:
```json
{
    "body": "Replying to [comment:35 gh-DavidAyotte]:\n> Replying to [comment:34 vdelecroix]:\n> > In the case of `ModularFormsRing._element_constructor_`, when the input is a polynomial the code calls `from_polynomial`. This is very different from what is happening with the quasimodular forms.\n> \n> Ok, so maybe the element constructor of `ModularFormsRing` should not call `from_polynomial`. What do you think?\n\nI think it would be fine to allow both. It just needs more parsing of the input\n- univariate polynomial ring with generator `q` -> q-expansion (raise a `NotImplementedError` for now)\n- multivariate polynomial ring with rational or finite field coefficients -> call `from_polynomial` as it is now.",
    "created_at": "2021-08-16T17:43:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447037",
    "user": "vdelecroix"
}
```

Replying to [comment:35 gh-DavidAyotte]:
> Replying to [comment:34 vdelecroix]:
> > In the case of `ModularFormsRing._element_constructor_`, when the input is a polynomial the code calls `from_polynomial`. This is very different from what is happening with the quasimodular forms.
> 
> Ok, so maybe the element constructor of `ModularFormsRing` should not call `from_polynomial`. What do you think?

I think it would be fine to allow both. It just needs more parsing of the input
- univariate polynomial ring with generator `q` -> q-expansion (raise a `NotImplementedError` for now)
- multivariate polynomial ring with rational or finite field coefficients -> call `from_polynomial` as it is now.



---

archive/issue_comments_447038.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-16T19:17:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447038",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447039.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-30T14:25:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447039",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447040.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-08T13:49:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447040",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447041.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-08T13:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447041",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447042.json:
```json
{
    "body": "Two small remarks:\n\nIn the element, why are you storing both the polynomial and its coefficients? The latter is only used in `q_expansion` for which you could have use equally the polynomial.\n\nThe methods `is_modular_form` and `is_graded_modular_form` are not quite right for the zero element as\n\n```\nsage: QQ['x'].zero().degree()\n-1\n```\n",
    "created_at": "2021-09-08T15:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447042",
    "user": "vdelecroix"
}
```

Two small remarks:

In the element, why are you storing both the polynomial and its coefficients? The latter is only used in `q_expansion` for which you could have use equally the polynomial.

The methods `is_modular_form` and `is_graded_modular_form` are not quite right for the zero element as

```
sage: QQ['x'].zero().degree()
-1
```




---

archive/issue_comments_447043.json:
```json
{
    "body": "> Two small remarks:\n> \n> In the element, why are you storing both the polynomial and its coefficients? The latter is only used in `q_expansion` for which you could have use equally the polynomial.\n\nSince the coefficient attribute is used only once, I will drop it.\n\n\\\\\n> The methods `is_modular_form` and `is_graded_modular_form` are not quite right for the zero element as\n> {{{\n> sage: QQ['x'].zero().degree()\n> -1\n> }}}\n\nOops, thanks for finding this! I had forgotten that there was a special rule for the degree of the zero polynomial. I'll fix this.",
    "created_at": "2021-09-08T16:13:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447043",
    "user": "@DavidAyotte"
}
```

> Two small remarks:
> 
> In the element, why are you storing both the polynomial and its coefficients? The latter is only used in `q_expansion` for which you could have use equally the polynomial.

Since the coefficient attribute is used only once, I will drop it.

\\
> The methods `is_modular_form` and `is_graded_modular_form` are not quite right for the zero element as
> {{{
> sage: QQ['x'].zero().degree()
> -1
> }}}

Oops, thanks for finding this! I had forgotten that there was a special rule for the degree of the zero polynomial. I'll fix this.



---

archive/issue_comments_447044.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-08T16:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447044",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447045.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-09-09T06:55:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447045",
    "user": "vdelecroix"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_447046.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-09-25T23:17:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31275",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31275#issuecomment-447046",
    "user": "vbraun"
}
```

Resolution: fixed
