# Issue 21941: Update the Sage Development Process documentation for new users

Issue created by migration from Trac.

Original creator: jessicapalencia

Original creation time: 2017-01-12 11:36:14

CC:  jen vivianepons nthiery egunawan jdemeyer embray dimpase

Keywords: doc, documentation, developer's guide, days82

At Sage Days 82, we referred many new users to the Sage Development Process documentation and found many errors or points that need clarification.


---

Comment by jen created at 2017-01-12 16:53:56

New commits:


---

Comment by jen created at 2017-01-12 16:54:36

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2017-01-12 19:44:30


```diff
+    If your system supports multiprocessing and you want to use multiple 
+    processors to build Sage, replace the last line above by::
+
+    [user`@`localhost sage]$ make -jNUM
```

The current recommendation seems to be to use 

```
    export MAKE="make -jNUM"
    make
```

instead. See discussion in #21610.


---

Comment by dimpase created at 2017-01-12 19:55:16

Replying to [comment:7 mkoeppe]:
> The current recommendation seems to be to use 
> {{{
>     export MAKE="make -jNUM"
>     make
> }}}
> instead. See discussion in #21610. 
indeed, as indicated in #21610, one can get away with toplevel `make -jNUM`, but
only after some work, and assuming `make`'s version is at least 4.2.1.


---

Comment by paulmasson created at 2017-01-12 20:13:56

Replying to [comment:8 dimpase]:
> indeed, as indicated in #21610, one can get away with toplevel `make -jNUM`, but
> only after some work, and assuming `make`'s version is at least 4.2.1. 
I run `make -j10` all the time on OS X Sierra (`make` version 3.81) without doing anything else and have no apparent problems. Does that just mean that the process falls back to a single job for parts of the build, like the documentation?


---

Comment by paulmasson created at 2017-01-12 20:16:07

On a minor note, there are a couple really long lines added in this commit. Please break them to keep all lines in a file to about the same length. That makes them easier to read.


---

Comment by dimpase created at 2017-01-12 20:50:57

Replying to [comment:9 paulmasson]:
> Replying to [comment:8 dimpase]:
> > indeed, as indicated in #21610, one can get away with toplevel `make -jNUM`, but
> > only after some work, and assuming `make`'s version is at least 4.2.1. 
> I run `make -j10` all the time on OS X Sierra (`make` version 3.81) without doing anything else and have no apparent problems. Does that just mean that the process falls back to a single job for parts of the build, like the documentation?

most probably the latter. Could you try the other way on the documentation, whether there is a speed difference for you?


---

Comment by paulmasson created at 2017-01-12 21:50:34

Replying to [comment:11 dimpase]:
> Replying to [comment:9 paulmasson]:
> > Replying to [comment:8 dimpase]:
> > > indeed, as indicated in #21610, one can get away with toplevel `make -jNUM`, but
> > > only after some work, and assuming `make`'s version is at least 4.2.1. 
> > I run `make -j10` all the time on OS X Sierra (`make` version 3.81) without doing anything else and have no apparent problems. Does that just mean that the process falls back to a single job for parts of the build, like the documentation?
> 
> most probably the latter. Could you try the other way on the documentation, whether there is a speed difference for you?
With plain `make -j10` documentation takes 1284 seconds to build, with `export` it takes 1155 seconds. Not enough of a difference for me to stop using the simpler command.


---

Comment by dimpase created at 2017-01-12 22:28:59

Replying to [comment:12 paulmasson]:
> Replying to [comment:11 dimpase]:
> > Replying to [comment:9 paulmasson]:
> > > Replying to [comment:8 dimpase]:
> > > > indeed, as indicated in #21610, one can get away with toplevel `make -jNUM`, but
> > > > only after some work, and assuming `make`'s version is at least 4.2.1. 
> > > I run `make -j10` all the time on OS X Sierra (`make` version 3.81) without doing anything else and have no apparent problems. Does that just mean that the process falls back to a single job for parts of the build, like the documentation?
> > 
> > most probably the latter. Could you try the other way on the documentation, whether there is a speed difference for you?
> With plain `make -j10` documentation takes 1284 seconds to build, with `export` it takes 1155 seconds. Not enough of a difference for me to stop using the simpler command.

My bad, documentation build apparently somehow gets hold of '-j10'---you could see this
by looking at 'top' output and observing about 10 python processes running.

What would matter is building of Sage packages - each of them would be built with '-j1'.


---

Comment by jhpalmieri created at 2017-01-13 04:40:48

On one machine, when I built with `MAKE='make -j6'`, `make build` took 99 minutes. With `MAKE` unset, `make -j6 build` took 107 minutes.


---

Comment by git created at 2017-01-13 13:56:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jessicapalencia created at 2017-01-13 13:59:33

We addressed all the comments above.


---

Comment by dimpase created at 2017-01-13 17:32:10

Replying to [comment:14 jhpalmieri]:
> On one machine, when I built with `MAKE='make -j6'`, `make build` took 99 minutes. With `MAKE` unset, `make -j6 build` took 107 minutes.

I did `make distclean` followed by `make -j8` on an 8-core Linux machine
I got, with `MAKE` set to `make -j8`

```
real    41m35.245s
user    259m17.166s
sys     13m55.563s
```

and with `MAKE` unset (don't forget to actually run `unset MAKE` before trying)

```
real    55m40.123s
user    219m20.552s
sys     13m30.681s
```

which is almost 30% slowdown (w.r.t. the wall clock).


---

Comment by dimpase created at 2017-01-13 18:29:09

isn't 

```
$ export MAKE='make -jNUM'
$ $MAKE
```

more effective than

```
$ MAKE='make -jNUM' make
```

(unless for some reason you really do not want to keep building with `-jNUM` next time?)


---

Comment by jhpalmieri created at 2017-01-13 18:38:50

I think the right place to give full details about how to set the `MAKE` environment variable is in the ["Environment variables" section of the Sage installation guide](http://doc.sagemath.org/html/en/installation/source.html#environment-variables). So the brief comments in the developer's guide don't need to be perfect, for example with respect to

```
$ MAKE='make -jNUM' make
```

vs.

```
$ export MAKE='make -jNUM'
$ make
```



---

Comment by dimpase created at 2017-01-13 18:41:46

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2017-01-13 18:41:46

OK. Other reviewers, please feel free to write themselves in.


---

Comment by tscrim created at 2017-01-13 18:55:08

Changing status from positive_review to needs_work.


---

Comment by tscrim created at 2017-01-13 18:55:08

Two very minor things:

- We are trying to standardize `.. NOTE::` instead of `.. note::`.
- Some of your line breaks make some lines unnaturally short to me.

The more important of the two is the first one.


---

Comment by dimpase created at 2017-01-13 19:05:34

when the day comes, someone will make a script to fix the other 500+ occurences...

```
$ grep -R "note::" src/sage/ | wc -l
513
```



---

Comment by dimpase created at 2017-01-13 19:05:34

Changing status from needs_work to positive_review.


---

Comment by tscrim created at 2017-01-13 19:21:01

Changing status from positive_review to needs_work.


---

Comment by tscrim created at 2017-01-13 19:21:01


```
travis`@`apricot:~/sage-build$ grep -R "NOTE::" src/sage/ | wc -l
1636
```

We don't have to make it worse.


---

Comment by dimpase created at 2017-01-13 19:25:01

Changing status from needs_work to positive_review.


---

Comment by dimpase created at 2017-01-13 19:25:01

Well, instead of arguing here, make a ticket to fix this Sage-wise :-)
With about 25% for `note::` vs 75% for `NOTE::`, it's a bit premature to make a fuss about it.


---

Comment by mkoeppe created at 2017-01-13 19:25:53

Is there a patchbot script that checks on these things?


---

Comment by dimpase created at 2017-01-13 19:29:09

IMHO one wants to propose changes like this, which are more of matter of taste than anything else, it's more appropriate to push a commit to fix it, instead of keep setting this to "needs work". Because the latter isn't really the case.


---

Comment by tscrim created at 2017-01-13 19:36:45

Instead of sweeping things under the rug, let's make sure things are done right. These are not a "matter of taste" but conventions we have set in Sage that we should adhere to. Here's you're branch, where I noticed some other things that needed fixing too.
----
New commits:


---

Comment by tscrim created at 2017-01-13 19:36:45

Changing status from positive_review to needs_review.


---

Comment by git created at 2017-01-13 19:37:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2017-01-13 19:45:28

Note `NOTE` vs `note` is not a written convention. Anyway.


---

Comment by dimpase created at 2017-01-13 19:45:28

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2017-01-13 19:47:25

See http://doc.sagemath.org/html/en/developer/coding_basics.html


---

Comment by dimpase created at 2017-01-13 19:52:31

Replying to [comment:32 tscrim]:
> See http://doc.sagemath.org/html/en/developer/coding_basics.html

`A NOTE block for tips/tricks (optional).`

Does it say it must be all-caps? No. Actually I don't like all-caps, they scream too much at your face...


---

Comment by mkoeppe created at 2017-01-21 21:54:20

I know this ticket is already on positive review, but I'd like to suggest to change it to

```
make V=0
```

This makes the output much less overwhelming.


---

Comment by dimpase created at 2017-01-21 21:57:34

Actually I never heard about `V=0`. Perhaps it's less common knowledge than you think, and a more detailed explanation ought to be added.


---

Comment by jhpalmieri created at 2017-01-21 22:34:59

We already have an installation manual where fine points of `make` should go. I would suggest documenating `make V=0` there, and perhaps putting a pointer to the installation manual in the developer's manual.


---

Comment by mkoeppe created at 2017-01-21 23:28:49

I added this feature some time last year in #21539.
Looks like I forgot to advertise it in the documentation.


---

Comment by mkoeppe created at 2017-01-22 04:51:33

#22227 adds the documentation of `make V=0.`


---

Comment by vbraun created at 2017-01-23 22:52:41

Resolution: fixed
