# Issue 23831: py3: some care for .values()[...]

archive/issues_023831.json:
```json
{
    "body": "part of #15981\n\nIssue created by migration from https://trac.sagemath.org/ticket/24068\n\n",
    "created_at": "2017-10-19T19:22:44Z",
    "labels": [
        "python3",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "py3: some care for .values()[...]",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23831",
    "user": "@fchapoton"
}
```
part of #15981

Issue created by migration from https://trac.sagemath.org/ticket/24068





---

archive/issue_comments_333813.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-10-19T19:23:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333813",
    "user": "@fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_333814.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-10-19T19:23:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333814",
    "user": "@fchapoton"
}
```

New commits:



---

archive/issue_comments_333815.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-19T19:26:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333815",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_333816.json:
```json
{
    "body": "For this change:\n\n```diff\ndiff --git a/src/sage/combinat/combinat.py b/src/sage/combinat/combinat.py\nindex 9602889..1cdb339 100644\n--- a/src/sage/combinat/combinat.py\n+++ b/src/sage/combinat/combinat.py\n@@ -144,7 +144,7 @@ Functions and classes\n #*****************************************************************************\n from __future__ import absolute_import\n from six.moves import range\n-from six import iteritems, add_metaclass\n+from six import iteritems, add_metaclass, itervalues\n \n from sage.interfaces.all import maxima\n from sage.rings.all import ZZ, QQ, Integer, infinity\n@@ -1293,7 +1293,7 @@ class CombinatorialElement(CombinatorialObject, Element):\n         if len(args) == 1 and not kwds:\n             L = args[0]\n         elif len(kwds) == 1 and not args:\n-            L = kwds.values()[0]\n+            L = next(itervalues(kwds))\n         else:\n             raise TypeError(\"__init__() takes exactly 2 arguments ({} given)\".format(1+len(args)+len(kwds)))\n         super(CombinatorialElement, self).__init__(L)\n```\n\nwe should be able to do `L, = kwds.values()`.",
    "created_at": "2017-10-19T21:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333816",
    "user": "@tscrim"
}
```

For this change:

```diff
diff --git a/src/sage/combinat/combinat.py b/src/sage/combinat/combinat.py
index 9602889..1cdb339 100644
--- a/src/sage/combinat/combinat.py
+++ b/src/sage/combinat/combinat.py
@@ -144,7 +144,7 @@ Functions and classes
 #*****************************************************************************
 from __future__ import absolute_import
 from six.moves import range
-from six import iteritems, add_metaclass
+from six import iteritems, add_metaclass, itervalues
 
 from sage.interfaces.all import maxima
 from sage.rings.all import ZZ, QQ, Integer, infinity
@@ -1293,7 +1293,7 @@ class CombinatorialElement(CombinatorialObject, Element):
         if len(args) == 1 and not kwds:
             L = args[0]
         elif len(kwds) == 1 and not args:
-            L = kwds.values()[0]
+            L = next(itervalues(kwds))
         else:
             raise TypeError("__init__() takes exactly 2 arguments ({} given)".format(1+len(args)+len(kwds)))
         super(CombinatorialElement, self).__init__(L)
```

we should be able to do `L, = kwds.values()`.



---

archive/issue_comments_333817.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-20T06:53:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333817",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_333818.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-20T10:04:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333818",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_333819.json:
```json
{
    "body": "Sometimes you use `iter(x.values())` and sometimes `itervalues(x)`. Wouldn't it be better to always use `six.itervalues`?",
    "created_at": "2017-10-20T11:23:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333819",
    "user": "@jdemeyer"
}
```

Sometimes you use `iter(x.values())` and sometimes `itervalues(x)`. Wouldn't it be better to always use `six.itervalues`?



---

archive/issue_comments_333820.json:
```json
{
    "body": "I only used iter(x.values()) when the other option was not working.",
    "created_at": "2017-10-20T11:56:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333820",
    "user": "@fchapoton"
}
```

I only used iter(x.values()) when the other option was not working.



---

archive/issue_comments_333821.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-10-20T14:58:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333821",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_333822.json:
```json
{
    "body": "Replying to [comment:7 chapoton]:\n> I only used iter(x.values()) when the other option was not working.\n\nBecause you are changing the `values()` method for a non-dict!",
    "created_at": "2017-10-20T14:58:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333822",
    "user": "@jdemeyer"
}
```

Replying to [comment:7 chapoton]:
> I only used iter(x.values()) when the other option was not working.

Because you are changing the `values()` method for a non-dict!



---

archive/issue_comments_333823.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-20T15:14:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333823",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_333824.json:
```json
{
    "body": "indeed. Corrected",
    "created_at": "2017-10-20T15:15:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333824",
    "user": "@fchapoton"
}
```

indeed. Corrected



---

archive/issue_comments_333825.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-10-20T15:15:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333825",
    "user": "@fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_333826.json:
```json
{
    "body": "green bot now at last",
    "created_at": "2017-10-20T18:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333826",
    "user": "@fchapoton"
}
```

green bot now at last



---

archive/issue_comments_333827.json:
```json
{
    "body": "ping?",
    "created_at": "2017-10-22T19:02:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333827",
    "user": "@fchapoton"
}
```

ping?



---

archive/issue_comments_333828.json:
```json
{
    "body": "I disagree with\n\n```diff\ndiff --git a/src/sage/graphs/generic_graph.py b/src/sage/graphs/generic_graph.py\nindex c3d5fe5..d5d6c5a 100644\n--- a/src/sage/graphs/generic_graph.py\n+++ b/src/sage/graphs/generic_graph.py\n@@ -13101,7 +13101,7 @@ class GenericGraph(GenericGraph_pyx):\n         From this embedding, we can clearly build an interval graph\n         isomorphic to the previous one::\n \n-            sage: g2 = graphs.IntervalGraph(d.values())\n+            sage: g2 = graphs.IntervalGraph(list(d.values()))\n             sage: g2.is_isomorphic(g)\n             True\n```\n\nInstead, I suggest\n\n```diff\ndiff --git a/src/sage/graphs/generators/intersection.py b/src/sage/graphs/generators/intersection.py\nindex a81c4a6..ba5b6a7 100644\n--- a/src/sage/graphs/generators/intersection.py\n+++ b/src/sage/graphs/generators/intersection.py\n@@ -90,6 +90,7 @@ def IntervalGraph(intervals, points_ordered = False):\n         sage: g.edges() == h.edges()\n         True\n     \"\"\"\n+    intervals = list(intervals)\n \n     n = len(intervals)\n     g = Graph(n)\n```\n\n\nIn `src/sage/rings/polynomial/multi_polynomial_ring.py`, some indentation is wrong (not a multiple of 4). Since you're change that code anyway, better fix that.\n\nIn `src/sage/sets/set_from_iterator.py`, you can remove the `assert` since the new code already checks that.\n\nThat's all.",
    "created_at": "2017-10-25T13:50:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333828",
    "user": "@jdemeyer"
}
```

I disagree with

```diff
diff --git a/src/sage/graphs/generic_graph.py b/src/sage/graphs/generic_graph.py
index c3d5fe5..d5d6c5a 100644
--- a/src/sage/graphs/generic_graph.py
+++ b/src/sage/graphs/generic_graph.py
@@ -13101,7 +13101,7 @@ class GenericGraph(GenericGraph_pyx):
         From this embedding, we can clearly build an interval graph
         isomorphic to the previous one::
 
-            sage: g2 = graphs.IntervalGraph(d.values())
+            sage: g2 = graphs.IntervalGraph(list(d.values()))
             sage: g2.is_isomorphic(g)
             True
```

Instead, I suggest

```diff
diff --git a/src/sage/graphs/generators/intersection.py b/src/sage/graphs/generators/intersection.py
index a81c4a6..ba5b6a7 100644
--- a/src/sage/graphs/generators/intersection.py
+++ b/src/sage/graphs/generators/intersection.py
@@ -90,6 +90,7 @@ def IntervalGraph(intervals, points_ordered = False):
         sage: g.edges() == h.edges()
         True
     """
+    intervals = list(intervals)
 
     n = len(intervals)
     g = Graph(n)
```


In `src/sage/rings/polynomial/multi_polynomial_ring.py`, some indentation is wrong (not a multiple of 4). Since you're change that code anyway, better fix that.

In `src/sage/sets/set_from_iterator.py`, you can remove the `assert` since the new code already checks that.

That's all.



---

archive/issue_comments_333829.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-10-25T13:50:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333829",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_333830.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-26T07:36:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333830",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_333831.json:
```json
{
    "body": "Thanks. All done",
    "created_at": "2017-10-26T07:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333831",
    "user": "@fchapoton"
}
```

Thanks. All done



---

archive/issue_comments_333832.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-10-26T07:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333832",
    "user": "@fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_333833.json:
```json
{
    "body": "positive review if the patchbot passes.",
    "created_at": "2017-10-26T08:01:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333833",
    "user": "@jdemeyer"
}
```

positive review if the patchbot passes.



---

archive/issue_comments_333834.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-26T20:11:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333834",
    "user": "@tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_333835.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-10-29T10:31:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23831#issuecomment-333835",
    "user": "@vbraun"
}
```

Resolution: fixed
