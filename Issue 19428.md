# Issue 19428: Bug in semi-global minimal models of elliptic curves

Issue created by migration from Trac.

Original creator: cremona

Original creation time: 2015-12-03 15:44:35

Keywords: minimal model

In #18662 I implemented global and semi-global minimal models for elliptic curves over number fields.  I have used this code a lot in preparing data for he LMFDB.  I just ran into a bug -- the curve here is defined over a non-Galois cubic field and the error comes when doing a computation with the base change to the Galois closure:

```
K.<a> =	NumberField(x^3 - 7*x - 5)
E = EllipticCurve([a, 0, 1, 2*a^2 + 5*a + 3, -a^2 - 3*a - 2])
assert E.conductor().norm() ==	8
G = K.galois_group(names='b')
EL = conj_curve(E,G[0])
L = EL.base_field()
assert L.class_number()	== 2
EL.isogeny_class()
#RuntimeError: Error in check_Kraus_global combining transforms at 2 and 3                     
```


I will work on fixing this right away.


---

Comment by cremona created at 2015-12-09 17:53:57

Changing status from new to needs_review.


---

Comment by cremona created at 2015-12-09 17:53:57

This was harder than expected.  When you have local transformations which work at each prime dividing 2, to get one which works at all these simultaneously is not just a question of applying CRT.  See the comments in the code for more details.
----
New commits:


---

Comment by vbraun created at 2016-01-07 23:19:40

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-01-08 19:17:33

Resolution: fixed
