# Issue 11957: MPolynomial_libsingular.is_squarefree fails with linear factors

Issue created by migration from https://trac.sagemath.org/ticket/12129

Original creator: culler

Original creation time: 2011-12-09 03:17:27

Assignee: AlexGhitza

CC:  jakobkroeker

Keywords: square free


```
sage: x, y = QQ['x','y'].gens()
sage: f = x*y
sage: f.is_squarefree()
False
sage: f = (x+y)*(x+3)
sage: f.is_squarefree()
False
```


This may be related to an inconsistency in the Singular sqrfree function, which sometimes includes a unit in the square free factorization, but other times does not.


---

Comment by zimmerma created at 2012-05-11 07:20:25

see also #12198 and #12404. Maybe some of those tickets can be removed as duplicate.

Paul


---

Comment by cremona created at 2017-11-12 13:42:27

This can surely be closed as the examples posted are now computed correctly.  Same as at #12198.


---

Comment by tscrim created at 2017-11-13 00:54:24

Changing status from new to needs_review.


---

Comment by tscrim created at 2017-11-13 00:54:30

Changing status from needs_review to positive_review.


---

Comment by zimmerma created at 2017-11-13 06:29:36

shouldn't we include a non-regression test?


---

Comment by tscrim created at 2017-11-13 06:31:50

I am not opposed. Feel free to use this ticket for that.


---

Comment by zimmerma created at 2017-11-13 08:00:27

here is a corresponding patch:

```
--- a/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx
+++ b/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx
@@ -4734,6 +4734,18 @@ cdef class MPolynomial_libsingular(MPolynomial):
             sage: h = f^2
             sage: h.is_squarefree()
             False
+
+        TESTS::
+
+Check if :trac:`12129` is fixed::
+
+            sage: x, y = QQ['x','y'].gens()
+            sage: f = x*y
+            sage: f.is_squarefree()
+            True
+            sage: f = (x+y)*(x+3)
+            sage: f.is_squarefree()
+            True
         """
         # TODO:  Use Singular (4.x) intrinsics.  (Temporary solution from #17254.)
         return all([ e == 1 for (f, e) in self.factor() ])
```



---

Comment by cremona created at 2017-11-13 09:23:53

I agree that tests should be added, both here and at #12198, but was a little too lazy to do it myself.


---

Comment by cremona created at 2017-11-13 09:41:33

Changing status from positive_review to needs_review.


---

Comment by cremona created at 2017-11-13 09:41:33

Travis could you re-review this?  I thought that this doctest would do for both tickets.  Thanks.
----
New commits:


---

Comment by tscrim created at 2017-11-13 10:41:07

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2017-11-13 10:41:07

I was also a little too lazy to do it as well. `^^;;` Thanks Paul and John.


---

Comment by embray created at 2017-12-12 08:23:33

Resolution: wontfix
