# Issue 11957: MPolynomial_libsingular.is_squarefree fails with linear factors

archive/issues_011957.json:
```json
{
    "body": "Assignee: @aghitza\n\nCC:  jakobkroeker\n\nKeywords: square free\n\n\n```\nsage: x, y = QQ['x','y'].gens()\nsage: f = x*y\nsage: f.is_squarefree()\nFalse\nsage: f = (x+y)*(x+3)\nsage: f.is_squarefree()\nFalse\n```\n\n\nThis may be related to an inconsistency in the Singular sqrfree function, which sometimes includes a unit in the square free factorization, but other times does not.\n\nIssue created by migration from https://trac.sagemath.org/ticket/12129\n\n",
    "created_at": "2011-12-09T03:17:27Z",
    "labels": [
        "algebra",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "MPolynomial_libsingular.is_squarefree fails with linear factors",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11957",
    "user": "@culler"
}
```
Assignee: @aghitza

CC:  jakobkroeker

Keywords: square free


```
sage: x, y = QQ['x','y'].gens()
sage: f = x*y
sage: f.is_squarefree()
False
sage: f = (x+y)*(x+3)
sage: f.is_squarefree()
False
```


This may be related to an inconsistency in the Singular sqrfree function, which sometimes includes a unit in the square free factorization, but other times does not.

Issue created by migration from https://trac.sagemath.org/ticket/12129





---

archive/issue_comments_137507.json:
```json
{
    "body": "see also #12198 and #12404. Maybe some of those tickets can be removed as duplicate.\n\nPaul",
    "created_at": "2012-05-11T07:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11957#issuecomment-137507",
    "user": "@zimmermann6"
}
```

see also #12198 and #12404. Maybe some of those tickets can be removed as duplicate.

Paul



---

archive/issue_comments_137508.json:
```json
{
    "body": "This can surely be closed as the examples posted are now computed correctly.  Same as at #12198.",
    "created_at": "2017-11-12T13:42:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11957#issuecomment-137508",
    "user": "@JohnCremona"
}
```

This can surely be closed as the examples posted are now computed correctly.  Same as at #12198.



---

archive/issue_comments_137509.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-11-13T00:54:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11957#issuecomment-137509",
    "user": "@tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_137510.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-11-13T00:54:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11957#issuecomment-137510",
    "user": "@tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_137511.json:
```json
{
    "body": "shouldn't we include a non-regression test?",
    "created_at": "2017-11-13T06:29:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11957#issuecomment-137511",
    "user": "@zimmermann6"
}
```

shouldn't we include a non-regression test?



---

archive/issue_comments_137512.json:
```json
{
    "body": "I am not opposed. Feel free to use this ticket for that.",
    "created_at": "2017-11-13T06:31:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11957#issuecomment-137512",
    "user": "@tscrim"
}
```

I am not opposed. Feel free to use this ticket for that.



---

archive/issue_comments_137513.json:
```json
{
    "body": "here is a corresponding patch:\n\n```\n--- a/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx\n+++ b/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx\n@@ -4734,6 +4734,18 @@ cdef class MPolynomial_libsingular(MPolynomial):\n             sage: h = f^2\n             sage: h.is_squarefree()\n             False\n+\n+        TESTS::\n+\n+Check if :trac:`12129` is fixed::\n+\n+            sage: x, y = QQ['x','y'].gens()\n+            sage: f = x*y\n+            sage: f.is_squarefree()\n+            True\n+            sage: f = (x+y)*(x+3)\n+            sage: f.is_squarefree()\n+            True\n         \"\"\"\n         # TODO:  Use Singular (4.x) intrinsics.  (Temporary solution from #17254.)\n         return all([ e == 1 for (f, e) in self.factor() ])\n```\n",
    "created_at": "2017-11-13T08:00:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11957#issuecomment-137513",
    "user": "@zimmermann6"
}
```

here is a corresponding patch:

```
--- a/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx
+++ b/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx
@@ -4734,6 +4734,18 @@ cdef class MPolynomial_libsingular(MPolynomial):
             sage: h = f^2
             sage: h.is_squarefree()
             False
+
+        TESTS::
+
+Check if :trac:`12129` is fixed::
+
+            sage: x, y = QQ['x','y'].gens()
+            sage: f = x*y
+            sage: f.is_squarefree()
+            True
+            sage: f = (x+y)*(x+3)
+            sage: f.is_squarefree()
+            True
         """
         # TODO:  Use Singular (4.x) intrinsics.  (Temporary solution from #17254.)
         return all([ e == 1 for (f, e) in self.factor() ])
```




---

archive/issue_comments_137514.json:
```json
{
    "body": "I agree that tests should be added, both here and at #12198, but was a little too lazy to do it myself.",
    "created_at": "2017-11-13T09:23:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11957#issuecomment-137514",
    "user": "@JohnCremona"
}
```

I agree that tests should be added, both here and at #12198, but was a little too lazy to do it myself.



---

archive/issue_comments_137515.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2017-11-13T09:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11957#issuecomment-137515",
    "user": "@JohnCremona"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_137516.json:
```json
{
    "body": "Travis could you re-review this?  I thought that this doctest would do for both tickets.  Thanks.\n----\nNew commits:",
    "created_at": "2017-11-13T09:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11957#issuecomment-137516",
    "user": "@JohnCremona"
}
```

Travis could you re-review this?  I thought that this doctest would do for both tickets.  Thanks.
----
New commits:



---

archive/issue_comments_137517.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-11-13T10:41:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11957#issuecomment-137517",
    "user": "@tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_137518.json:
```json
{
    "body": "I was also a little too lazy to do it as well. `^^;;` Thanks Paul and John.",
    "created_at": "2017-11-13T10:41:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11957#issuecomment-137518",
    "user": "@tscrim"
}
```

I was also a little too lazy to do it as well. `^^;;` Thanks Paul and John.



---

archive/issue_comments_137519.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2017-12-12T08:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11957#issuecomment-137519",
    "user": "@embray"
}
```

Resolution: wontfix
