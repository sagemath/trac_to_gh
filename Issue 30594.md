# Issue 30594: Cython install race: Cython/__pycache__': File exists

Issue created by migration from https://trac.sagemath.org/ticket/30831

Original creator: vbraun

Original creation time: 2020-10-25 23:31:05

CC:  slelievre

Parallel build can trip when installing cython:

```
Successfully built Cython
Removed build tracker: '/tmp/pip-req-tracker-omresmjl'
Using pip 20.2.3 from /var/lib/buildbot/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeqip0oidmas391y/local/lib/python3.8/site-packages/pip (python 3.8)
Non-user install because site-packages writeable
Ignoring indexes: https://pypi.org/simple
Created temporary directory: /tmp/pip-ephem-wheel-cache-qr4uo5i7
Created temporary directory: /tmp/pip-req-tracker-o36lik7l
Initialized build tracking at /tmp/pip-req-tracker-o36lik7l
Created build tracker: /tmp/pip-req-tracker-o36lik7l
Entered build tracker: /tmp/pip-req-tracker-o36lik7l
Created temporary directory: /tmp/pip-install-92nkij1k
Processing ./dist/Cython-0.29.21-cp38-cp38-linux_i686.whl
  Added Cython==0.29.21 from file:///var/lib/buildbot/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeqip0oidmas391y/local/var/tmp/sage/build/cython-0.29.21/src/dist/Cython-0.29.21-cp38-cp38-linux_i686.whl to build tracker '/tmp/pip-req-tracker-o36lik7l'
  Removed Cython==0.29.21 from file:///var/lib/buildbot/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeqip0oidmas391y/local/var/tmp/sage/build/cython-0.29.21/src/dist/Cython-0.29.21-cp38-cp38-linux_i686.whl from build tracker '/tmp/pip-req-tracker-o36lik7l'
Installing collected packages: Cython

  Creating /var/lib/buildbot/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeqip0oidmas391y/local/var/tmp/sage/build/cython-0.29.21/inst/var/lib/buildbot/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeqip0oidmas391y/local/bin
  changing mode of /var/lib/buildbot/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeqip0oidmas391y/local/var/tmp/sage/build/cython-0.29.21/inst/var/lib/buildbot/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeqip0oidmas391y/local/bin/cygdb to 755
  changing mode of /var/lib/buildbot/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeqip0oidmas391y/local/var/tmp/sage/build/cython-0.29.21/inst/var/lib/buildbot/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeqip0oidmas391y/local/bin/cython to 755
  changing mode of /var/lib/buildbot/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeqip0oidmas391y/local/var/tmp/sage/build/cython-0.29.21/inst/var/lib/buildbot/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeqip0oidmas391y/local/bin/cythonize to 755
Successfully installed Cython-0.29.21
Removed build tracker: '/tmp/pip-req-tracker-o36lik7l'

real    5m40.814s
user    1m48.492s
sys     0m3.965s
Copying package files from temporary location /var/lib/buildbot/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeqip0oidmas391y/local/var/tmp/sage/build/cython-0.29.21/inst to /var/lib/buildbot/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeqip0oidmas391y/local
cp: cannot create directory '/var/lib/buildbot/slave/binary_pkg/build/source/SageMath/jc4b6yulaujayb9sr94ia88eourzeqip0oidmas391y/local/./lib/python3.8/site-packages/Cython/__pycache__': File exists
```



---

Comment by mkoeppe created at 2020-10-26 02:52:29

Another instance of #29585


---

Comment by slelievre created at 2020-10-26 15:33:35

Changing keywords from "" to "build, cython, race".


---

Comment by slelievre created at 2020-10-26 15:33:35

Changing type from PLEASE CHANGE to defect.


---

Comment by slelievre created at 2020-10-26 15:33:35

Changing component from PLEASE CHANGE to build.


---

Comment by mkoeppe created at 2020-11-02 22:16:50

Let's close this as a dup of #29585


---

Comment by mkoeppe created at 2020-11-02 22:16:50

Changing status from new to needs_review.


---

Comment by slelievre created at 2021-08-19 22:09:48

Okay.


---

Comment by slelievre created at 2021-08-19 22:09:48

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2021-08-26 02:08:43

Resolution: invalid
