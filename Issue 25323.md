# Issue 25323: Memory leak in root system

Issue created by migration from Trac.

Original creator: nbruin

Original creation time: 2018-06-11 20:05:31


```
import gc
from collections import Counter
gc.collect()
pre={id(a) for a in gc.get_objects()}
for n in [1..50]:
  r=RootSystem(['A',n])
del r
gc.collect()
T=Counter(str(type(a)) for a in gc.get_objects() if id(a) not in pre)
[t for t in T.iteritems() if 'RootSystem' in t[0]]
```

prints

```
[("<class 'sage.combinat.root_system.root_system.RootSystem'>", 100)]
```

The `as_dual_of` creation parameter ensures a permanent reference is introduced to the dual root system in its `UniqueRepresentation` construction parameter key.

Probably a solution would be to use a `UniqueFactory` instead, which can preprocess its arguments before storing them as a key in a global dict. To be safe, perhaps strip the key down to just integers and strings (that should be quite doable here).


---

Comment by nbruin created at 2018-06-12 00:27:47

Duplicate of #18426.


---

Comment by nbruin created at 2018-06-12 00:27:47

Changing status from new to needs_review.


---

Comment by tscrim created at 2018-06-12 03:20:14

Changing status from needs_review to positive_review.


---

Comment by embray created at 2019-02-26 13:58:00

Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.


---

Comment by embray created at 2019-02-26 13:58:00

Resolution: invalid
