# Issue 20550: A class to manage Golay Codes

archive/issues_020550.json:
```json
{
    "body": "CC:  dlucas jsrn richmond jlavauzelle danielaugot\n\nThere are four types of Golay Codes, Extended Binary, Binary, Extended Ternary and Ternary. The aim of this ticket is to refactor the current methods for constructing these codes into one single Golay Code class (based on the new API) that provides for combinatorial properties as well as encoding and decoding algorithms for each type of Golay code.\n\nIssue created by migration from https://trac.sagemath.org/ticket/20787\n\n",
    "created_at": "2016-06-08T17:02:47Z",
    "labels": [
        "coding theory",
        "major",
        "enhancement"
    ],
    "title": "A class to manage Golay Codes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20550",
    "user": "arpitdm"
}
```
CC:  dlucas jsrn richmond jlavauzelle danielaugot

There are four types of Golay Codes, Extended Binary, Binary, Extended Ternary and Ternary. The aim of this ticket is to refactor the current methods for constructing these codes into one single Golay Code class (based on the new API) that provides for combinatorial properties as well as encoding and decoding algorithms for each type of Golay code.

Issue created by migration from https://trac.sagemath.org/ticket/20787





---

archive/issue_comments_283805.json:
```json
{
    "body": "Hello,\n\nI'm completing the implementation pushed by Arpit some months ago.\nI have one question related to extended Golay codes:\n\nAs extended codes are implemented as a proper class in Sage, from which it is possible to\nget the \"structured representation\" of the extended code, if it exists, it would be possible to do the following:\n\n\n```\n    sage: C = codes.GolayCode(\"binary\", \"extended\")\n    sage: C\n    Extended code coming from [23, 12, 8] Golay code over GF(2)\n    sage: C.structured_representation()\n    [24, 12, 8] Golay code over GF(2)\n```\n\n\nHowever, I think it is *not* the best way to do it, as I'm quite sure no one cares\nabout the fact that an extended Golay is an extended code, but one cares about extended\nGolay codes being Golay codes, with their set of specific properties.\n\nThat's why I suggest we just return a Golay code and drop the *extended* description if\nsomeone asks for an extended Golay code.\n\nAnother question:\n\nfor now, the constructor works as follow:\n\n`GolayCode(alphabet, extended)`, where `alphabet` has to be either `binary` or `ternary` and `extended` is a boolean.\nDo you think it's a good idea to allow the user to pass `GF(2)`/`GF(3)` directly to\nalphabet? It seems quite natural to me to allow such an input.\nAlso, I'd tend to set `extended` to `False` by default.\nAny comments?\n\nDavid\n----\nNew commits:",
    "created_at": "2016-08-25T05:30:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283805",
    "user": "dlucas"
}
```

Hello,

I'm completing the implementation pushed by Arpit some months ago.
I have one question related to extended Golay codes:

As extended codes are implemented as a proper class in Sage, from which it is possible to
get the "structured representation" of the extended code, if it exists, it would be possible to do the following:


```
    sage: C = codes.GolayCode("binary", "extended")
    sage: C
    Extended code coming from [23, 12, 8] Golay code over GF(2)
    sage: C.structured_representation()
    [24, 12, 8] Golay code over GF(2)
```


However, I think it is *not* the best way to do it, as I'm quite sure no one cares
about the fact that an extended Golay is an extended code, but one cares about extended
Golay codes being Golay codes, with their set of specific properties.

That's why I suggest we just return a Golay code and drop the *extended* description if
someone asks for an extended Golay code.

Another question:

for now, the constructor works as follow:

`GolayCode(alphabet, extended)`, where `alphabet` has to be either `binary` or `ternary` and `extended` is a boolean.
Do you think it's a good idea to allow the user to pass `GF(2)`/`GF(3)` directly to
alphabet? It seems quite natural to me to allow such an input.
Also, I'd tend to set `extended` to `False` by default.
Any comments?

David
----
New commits:



---

archive/issue_comments_283806.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2016-08-25T05:34:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283806",
    "user": "dlucas"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_283807.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd75\".",
    "created_at": "2016-08-25T05:34:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283807",
    "user": "dlucas"
}
```

Changing keywords from "" to "sd75".



---

archive/issue_comments_283808.json:
```json
{
    "body": "Hi everyone,\n\nthere is no `codes.GolayCode` in my namespace. As a consequence ./sage -t src/codes/coding vastly fails.\n\nDaniel",
    "created_at": "2016-08-25T13:59:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283808",
    "user": "danielaugot"
}
```

Hi everyone,

there is no `codes.GolayCode` in my namespace. As a consequence ./sage -t src/codes/coding vastly fails.

Daniel



---

archive/issue_comments_283809.json:
```json
{
    "body": "Replying to [comment:4 danielaugot]:\n> Hi everyone,\n> \n> there is no `codes.GolayCode` in my namespace. As a consequence ./sage -t src/codes/coding vastly fails.\n> \n> Daniel\nAs of now, there isn't a single class in Sage for Golay codes. You need to use `codes.BinaryGolayCode`, `codes.ExtendedBinaryGolayCode`, `codes.TernaryGolayCode`, `codes.ExtendedTernaryGolayCode`.",
    "created_at": "2016-08-25T14:07:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283809",
    "user": "arpitdm"
}
```

Replying to [comment:4 danielaugot]:
> Hi everyone,
> 
> there is no `codes.GolayCode` in my namespace. As a consequence ./sage -t src/codes/coding vastly fails.
> 
> Daniel
As of now, there isn't a single class in Sage for Golay codes. You need to use `codes.BinaryGolayCode`, `codes.ExtendedBinaryGolayCode`, `codes.TernaryGolayCode`, `codes.ExtendedTernaryGolayCode`.



---

archive/issue_comments_283810.json:
```json
{
    "body": "Hi Arpit\n\nnow codes.GolayCode is in the namespace.\n\nDaniel\n----\nNew commits:",
    "created_at": "2016-08-25T14:52:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283810",
    "user": "danielaugot"
}
```

Hi Arpit

now codes.GolayCode is in the namespace.

Daniel
----
New commits:



---

archive/issue_comments_283811.json:
```json
{
    "body": "Thanks for doing this Daniel!\n\nI actually did it on my side this morning, and intended to push it later.\n\nAnyway, my latest push \ncontains some fixes wrt. input sanitization, plus some bug fixes\n(e.g. `dual_code` method was returning `self` whichever Golay code `self` was...\nWhich includes codes whose length is odd, `G23` and `G11`, which is mathematically impossible).\n\nPlease note that quite a lot of doctests are still broken, I'm working on it.\nThe encoder is far from being fully implemented, and I did not investigate\ndecoding capabilities nor properties related to Golay codes' automorphism groups.\nI'm not sure I'll take care of automorphism groups in this ticket BTW.\n\nDavid\n----\nNew commits:",
    "created_at": "2016-08-25T15:01:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283811",
    "user": "dlucas"
}
```

Thanks for doing this Daniel!

I actually did it on my side this morning, and intended to push it later.

Anyway, my latest push 
contains some fixes wrt. input sanitization, plus some bug fixes
(e.g. `dual_code` method was returning `self` whichever Golay code `self` was...
Which includes codes whose length is odd, `G23` and `G11`, which is mathematically impossible).

Please note that quite a lot of doctests are still broken, I'm working on it.
The encoder is far from being fully implemented, and I did not investigate
decoding capabilities nor properties related to Golay codes' automorphism groups.
I'm not sure I'll take care of automorphism groups in this ticket BTW.

David
----
New commits:



---

archive/issue_comments_283812.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-27T06:11:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283812",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_283813.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2016-08-27T06:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283813",
    "user": "dlucas"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_283814.json:
```json
{
    "body": "Hello,\n\nI finished the implementation of a proper class for Golay codes.\nSome notes on design:\n\n- `codes.GolayCode` now takes `GF(2)/GF(3)` as input instead of `\"binary\"/\"ternary\"`, and `extended=True/False` instead of a string `\"true\"/\"false\"`. I also chose to set `extended` to `True` by default.\n\n- This ticket does not implement anything related to automorphism groups of Golay codes.\n\n- I completely removed the encoder proposed in the initial implementation, as it was a\n  copy of `linear_code.LinearCodeGeneratorMatrixEncoder`.\n\n- I chose to slightly modify the output of `_str_` if the code is extended or not.\n  `codes.GolayCode(GF(2), True)` replies `\"blah extended Golay code blah\"`, and\n  `codes.GolayCode(GF(2), False)` replies `\"blah Golay code blah\"`. I think such a \n  behaviour is more informative to the user than just outputting the triple [n, k, d]. \n\n\nOpening for review.\n\nDavid",
    "created_at": "2016-08-27T06:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283814",
    "user": "dlucas"
}
```

Hello,

I finished the implementation of a proper class for Golay codes.
Some notes on design:

- `codes.GolayCode` now takes `GF(2)/GF(3)` as input instead of `"binary"/"ternary"`, and `extended=True/False` instead of a string `"true"/"false"`. I also chose to set `extended` to `True` by default.

- This ticket does not implement anything related to automorphism groups of Golay codes.

- I completely removed the encoder proposed in the initial implementation, as it was a
  copy of `linear_code.LinearCodeGeneratorMatrixEncoder`.

- I chose to slightly modify the output of `_str_` if the code is extended or not.
  `codes.GolayCode(GF(2), True)` replies `"blah extended Golay code blah"`, and
  `codes.GolayCode(GF(2), False)` replies `"blah Golay code blah"`. I think such a 
  behaviour is more informative to the user than just outputting the triple [n, k, d]. 


Opening for review.

David



---

archive/issue_comments_283815.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-29T12:44:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283815",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_283816.json:
```json
{
    "body": "Hello,\n\nI updated this branch to the latest beta (7.4b2), and fixed some broken doctests I forgot last time.\nAccording to the patchbot, there's one more doctest to fix in `linear_code.py`, l.1396... \nExcept that it passes just fine on my machine (while the patchbot complains about some `ZeroDivisionError`). \n\nDavid",
    "created_at": "2016-08-29T12:46:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283816",
    "user": "dlucas"
}
```

Hello,

I updated this branch to the latest beta (7.4b2), and fixed some broken doctests I forgot last time.
According to the patchbot, there's one more doctest to fix in `linear_code.py`, l.1396... 
Except that it passes just fine on my machine (while the patchbot complains about some `ZeroDivisionError`). 

David



---

archive/issue_comments_283817.json:
```json
{
    "body": "there is a misprint (missing `r`) in `coding/code_constructions.py`\n\n```\ndeprecation(20787, \"codes.ExtendedTernayGolayCode...\n```\n\nI also think that in the examples the parameter `extended=` should be present,\notherwise it's very confusing that `GolayCode(GF(2))` returns the extended code.\n\nI will post a rebased branch with these changes.",
    "created_at": "2016-12-30T18:13:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283817",
    "user": "dimpase"
}
```

there is a misprint (missing `r`) in `coding/code_constructions.py`

```
deprecation(20787, "codes.ExtendedTernayGolayCode...
```

I also think that in the examples the parameter `extended=` should be present,
otherwise it's very confusing that `GolayCode(GF(2))` returns the extended code.

I will post a rebased branch with these changes.



---

archive/issue_comments_283818.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-12-30T18:54:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283818",
    "user": "dimpase"
}
```

New commits:



---

archive/issue_comments_283819.json:
```json
{
    "body": "doctest failures in patchbot?",
    "created_at": "2017-01-07T07:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283819",
    "user": "cheuberg"
}
```

doctest failures in patchbot?



---

archive/issue_comments_283820.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-01-07T07:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283820",
    "user": "cheuberg"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_283821.json:
```json
{
    "body": "indeed. One is easy to fix:\n\n```\n--- a/src/sage/coding/golay_code.py\n+++ b/src/sage/coding/golay_code.py\n@@ -8,7 +8,7 @@ perfect codes, while their extended versions are self-dual codes.\n \n REFERENCES:\n \n-    - [HP03]_ pp. 31-33 for a definition of Golay codes.\n+    - [HP2003]_ pp. 31-33 for a definition of Golay codes.\n \n```\n\nthe other two (failures of long tests --- have the authors ever checked these?)\nwould need work:\n\n```\nFile \"src/sage/coding/linear_code.py\", line 1170, in sage.coding.linear_code.AbstractLinearCode.chinen_polynomial\nFailed example:\n    C.chinen_polynomial()       # long time\n...\nZeroDivisionError: rational division by zero\n```\n\n\n\n```\nFile \"src/sage/matroids/catalog.py\", line 1420, in sage.matroids.catalog.ExtendedBinaryGolayCode\nFailed example:\n    C.is_permutation_equivalent(codes.GolayCode(GF(2)) # long time\nException raised:\n...\nSyntaxError: unexpected EOF while parsing\n```\n",
    "created_at": "2017-01-08T10:06:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283821",
    "user": "dimpase"
}
```

indeed. One is easy to fix:

```
--- a/src/sage/coding/golay_code.py
+++ b/src/sage/coding/golay_code.py
@@ -8,7 +8,7 @@ perfect codes, while their extended versions are self-dual codes.
 
 REFERENCES:
 
-    - [HP03]_ pp. 31-33 for a definition of Golay codes.
+    - [HP2003]_ pp. 31-33 for a definition of Golay codes.
 
```

the other two (failures of long tests --- have the authors ever checked these?)
would need work:

```
File "src/sage/coding/linear_code.py", line 1170, in sage.coding.linear_code.AbstractLinearCode.chinen_polynomial
Failed example:
    C.chinen_polynomial()       # long time
...
ZeroDivisionError: rational division by zero
```



```
File "src/sage/matroids/catalog.py", line 1420, in sage.matroids.catalog.ExtendedBinaryGolayCode
Failed example:
    C.is_permutation_equivalent(codes.GolayCode(GF(2)) # long time
Exception raised:
...
SyntaxError: unexpected EOF while parsing
```




---

archive/issue_comments_283822.json:
```json
{
    "body": "The following tests are passed. For the binary case, let us try the manual extension\n\n```\nsage: G = codes.GolayCode(GF(2),False) #shortened binary Golay code\nsage: G0 = codes.GolayCode(GF(2),True) #binary Golay code\nsage: G0prime = G.extended_code() # manual extension\nsage: G0.generator_matrix() * G0prime.parity_check_matrix().transpose() == 0 # basic test of mathematical correctness\nTrue\n```\n\nLet us try self-duality\n\n```\nsage: G0perp = G0.dual_code()\nsage: G0.generator_matrix() * G0perp.generator_matrix().transpose() == 0 # basic test of mathematical correctness\nTrue\n```\n\nSame business for the ternary code: extension\n\n```\nsage: G = codes.GolayCode(GF(3),False) # shortened ternary Golay code\nsage: G0 = codes.GolayCode(GF(3),True) # ternary Golay code\nsage: G0prime = G.extended_code() # manual extension\nsage: G0.generator_matrix() * G0prime.parity_check_matrix().transpose() == 0 # basic test of mathematical correctness\nTrue\n```\n\nself-duality\n\n```\nsage: G0perp = G0.dual_code()\nsage: G0.generator_matrix() * G0perp.generator_matrix().transpose() == 0 # basic test of mathematical correctness\nTrue\n```\n",
    "created_at": "2017-02-07T10:36:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283822",
    "user": "danielaugot"
}
```

The following tests are passed. For the binary case, let us try the manual extension

```
sage: G = codes.GolayCode(GF(2),False) #shortened binary Golay code
sage: G0 = codes.GolayCode(GF(2),True) #binary Golay code
sage: G0prime = G.extended_code() # manual extension
sage: G0.generator_matrix() * G0prime.parity_check_matrix().transpose() == 0 # basic test of mathematical correctness
True
```

Let us try self-duality

```
sage: G0perp = G0.dual_code()
sage: G0.generator_matrix() * G0perp.generator_matrix().transpose() == 0 # basic test of mathematical correctness
True
```

Same business for the ternary code: extension

```
sage: G = codes.GolayCode(GF(3),False) # shortened ternary Golay code
sage: G0 = codes.GolayCode(GF(3),True) # ternary Golay code
sage: G0prime = G.extended_code() # manual extension
sage: G0.generator_matrix() * G0prime.parity_check_matrix().transpose() == 0 # basic test of mathematical correctness
True
```

self-duality

```
sage: G0perp = G0.dual_code()
sage: G0.generator_matrix() * G0perp.generator_matrix().transpose() == 0 # basic test of mathematical correctness
True
```




---

archive/issue_comments_283823.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2017-02-07T16:35:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283823",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_283824.json:
```json
{
    "body": "Almost OK, but the test coverage\n\n```\n./sage -t --long src/sage/coding/\n```\n\ndoes not work because `chinen_polynomial()`  BOOMs on the ternary Golay code.",
    "created_at": "2017-02-07T16:46:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283824",
    "user": "danielaugot"
}
```

Almost OK, but the test coverage

```
./sage -t --long src/sage/coding/
```

does not work because `chinen_polynomial()`  BOOMs on the ternary Golay code.



---

archive/issue_comments_283825.json:
```json
{
    "body": "Are you debugging this?",
    "created_at": "2017-02-07T17:43:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283825",
    "user": "dimpase"
}
```

Are you debugging this?



---

archive/issue_comments_283826.json:
```json
{
    "body": "I was trying to check `golay_code.py`, and also adding some tests.\n\nThis is passed:\n\n\n```\n./sage -t --long src/sage/coding/golay_code.py\n```\n\nThis is also passed:\n\n```\n./sage -t src/sage/coding/\n```\n\nbut this one fails:\n\n```\n./sage -t --long src/sage/coding/\n```\n\nbecause of `linear_code.py`.\n\nI have not much time to investigate why `chinen_polynomial()` fails in linear_code.py. \n\nI do not know the best way to make progress : remove the test, deprecate the function, understand why the code is not functionning on the ternary Golay code ?",
    "created_at": "2017-02-08T09:31:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283826",
    "user": "danielaugot"
}
```

I was trying to check `golay_code.py`, and also adding some tests.

This is passed:


```
./sage -t --long src/sage/coding/golay_code.py
```

This is also passed:

```
./sage -t src/sage/coding/
```

but this one fails:

```
./sage -t --long src/sage/coding/
```

because of `linear_code.py`.

I have not much time to investigate why `chinen_polynomial()` fails in linear_code.py. 

I do not know the best way to make progress : remove the test, deprecate the function, understand why the code is not functionning on the ternary Golay code ?



---

archive/issue_comments_283827.json:
```json
{
    "body": "The bug is in `zeta_polynomial()`, as should be clear from the log:\n\n```\nsage -t --long --warn-long 63.1 coding/linear_code.py\n**********************************************************************\nFile \"coding/linear_code.py\", line 1176, in sage.coding.linear_code.AbstractLinearCode.chinen_polynomial\nFailed example:\n    C.chinen_polynomial()       # long time\nException raised:\n    Traceback (most recent call last):\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.coding.linear_code.AbstractLinearCode.chinen_polynomial[3]>\", line 1, in <module>\n        C.chinen_polynomial()       # long time\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/coding/linear_code.py\", line 1199, in chinen_polynomial\n        P = RT(C.zeta_polynomial())\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/coding/linear_code.py\", line 3437, in zeta_polynomial\n        b = [Bs[i]/binomial(n,i+d) for i in range(len(Bs))]\n      File \"sage/structure/element.pyx\", line 1711, in sage.structure.element.Element.__truediv__ (build/cythonized/sage/structure/element.c:13260)\n        return coercion_model.bin_op(left, right, truediv)\n      File \"sage/structure/coerce.pyx\", line 1053, in sage.structure.coerce.CoercionModel_cache_maps.bin_op (build/cythonized/sage/structure/coerce.c:9336)\n        return PyObject_CallObject(op, xy)\n      File \"sage/structure/element.pyx\", line 1709, in sage.structure.element.Element.__truediv__ (build/cythonized/sage/structure/element.c:13225)\n        return (<Element>left)._div_(right)\n      File \"sage/rings/rational.pyx\", line 2313, in sage.rings.rational.Rational._div_ (build/cythonized/sage/rings/rational.c:21599)\n        raise ZeroDivisionError('rational division by zero')\n    ZeroDivisionError: rational division by zero\n```\n\nIndeed, here it is: \n\n```\nsage: C = codes.GolayCode(GF(3), False)\nsage: C.zeta_polynomial()\n---------------------------------------------------------------------------\nZeroDivisionError                         Traceback (most recent call last)\n<ipython-input-4-8fcefbaf83d4> in <module>()\n----> 1 C.zeta_polynomial()\n\n/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/coding/linear_code.pyc in zeta_polynomial(self, name)\n   3435         B = A(x+y,y,T)-(x+y)**n\n   3436         Bs = B.coefficients()\n-> 3437         b = [Bs[i]/binomial(n,i+d) for i in range(len(Bs))]\n   3438         r = n-d-dperp+2\n   3439         P_coeffs = []\n...\nZeroDivisionError: rational division by zero\n```\n\nso just some silly indexing bug, `binomial(n,i+d)` becomes 0...",
    "created_at": "2017-02-08T11:20:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283827",
    "user": "dimpase"
}
```

The bug is in `zeta_polynomial()`, as should be clear from the log:

```
sage -t --long --warn-long 63.1 coding/linear_code.py
**********************************************************************
File "coding/linear_code.py", line 1176, in sage.coding.linear_code.AbstractLinearCode.chinen_polynomial
Failed example:
    C.chinen_polynomial()       # long time
Exception raised:
    Traceback (most recent call last):
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.coding.linear_code.AbstractLinearCode.chinen_polynomial[3]>", line 1, in <module>
        C.chinen_polynomial()       # long time
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/coding/linear_code.py", line 1199, in chinen_polynomial
        P = RT(C.zeta_polynomial())
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/coding/linear_code.py", line 3437, in zeta_polynomial
        b = [Bs[i]/binomial(n,i+d) for i in range(len(Bs))]
      File "sage/structure/element.pyx", line 1711, in sage.structure.element.Element.__truediv__ (build/cythonized/sage/structure/element.c:13260)
        return coercion_model.bin_op(left, right, truediv)
      File "sage/structure/coerce.pyx", line 1053, in sage.structure.coerce.CoercionModel_cache_maps.bin_op (build/cythonized/sage/structure/coerce.c:9336)
        return PyObject_CallObject(op, xy)
      File "sage/structure/element.pyx", line 1709, in sage.structure.element.Element.__truediv__ (build/cythonized/sage/structure/element.c:13225)
        return (<Element>left)._div_(right)
      File "sage/rings/rational.pyx", line 2313, in sage.rings.rational.Rational._div_ (build/cythonized/sage/rings/rational.c:21599)
        raise ZeroDivisionError('rational division by zero')
    ZeroDivisionError: rational division by zero
```

Indeed, here it is: 

```
sage: C = codes.GolayCode(GF(3), False)
sage: C.zeta_polynomial()
---------------------------------------------------------------------------
ZeroDivisionError                         Traceback (most recent call last)
<ipython-input-4-8fcefbaf83d4> in <module>()
----> 1 C.zeta_polynomial()

/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/coding/linear_code.pyc in zeta_polynomial(self, name)
   3435         B = A(x+y,y,T)-(x+y)**n
   3436         Bs = B.coefficients()
-> 3437         b = [Bs[i]/binomial(n,i+d) for i in range(len(Bs))]
   3438         r = n-d-dperp+2
   3439         P_coeffs = []
...
ZeroDivisionError: rational division by zero
```

so just some silly indexing bug, `binomial(n,i+d)` becomes 0...



---

archive/issue_comments_283828.json:
```json
{
    "body": "And digging further, one sees that the weight enumerator of `codes.GolayCode(GF(3), False)` is inconsistent with the Sage's convention that it is homogeneous bivariate polynomial rather than the univariate one:\n\n```\nsage: C = codes.GolayCode(GF(3), False)\nsage: C.weight_enumerator()\n24*x^11 + 110*x^9 + 330*x^8 + 132*x^6 + 132*x^5 + 1\n```\n\nwhereas\n\n```\nsage: C=codes.HammingCode(GF(2), 3)\nsage: C.weight_enumerator()\nx^7 + 7*x^4*y^3 + 7*x^3*y^4 + y^7\n```\n\nand\n\n```\nsage: C=codes.GolayCode(GF(3),False)\nsage: L=LinearCode(C.generator_matrix())\nsage: L.weight_enumerator()\nx^11 + 132*x^6*y^5 + 132*x^5*y^6 + 330*x^3*y^8 + 110*x^2*y^9 + 24*y^11\n```\n\n\nSo the bug is in the code in the branch under review, and trivial to fix.\n\nTLDR: before blaming old code, make sure that the new code is not buggy :-)",
    "created_at": "2017-02-08T11:55:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283828",
    "user": "dimpase"
}
```

And digging further, one sees that the weight enumerator of `codes.GolayCode(GF(3), False)` is inconsistent with the Sage's convention that it is homogeneous bivariate polynomial rather than the univariate one:

```
sage: C = codes.GolayCode(GF(3), False)
sage: C.weight_enumerator()
24*x^11 + 110*x^9 + 330*x^8 + 132*x^6 + 132*x^5 + 1
```

whereas

```
sage: C=codes.HammingCode(GF(2), 3)
sage: C.weight_enumerator()
x^7 + 7*x^4*y^3 + 7*x^3*y^4 + y^7
```

and

```
sage: C=codes.GolayCode(GF(3),False)
sage: L=LinearCode(C.generator_matrix())
sage: L.weight_enumerator()
x^11 + 132*x^6*y^5 + 132*x^5*y^6 + 330*x^3*y^8 + 110*x^2*y^9 + 24*y^11
```


So the bug is in the code in the branch under review, and trivial to fix.

TLDR: before blaming old code, make sure that the new code is not buggy :-)



---

archive/issue_comments_283829.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-09T17:27:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283829",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_283830.json:
```json
{
    "body": "removed the useless (the one from the parent class is just as fast) `weight_enumerator()`. And fixed typos in weight distributions data (yes, indeed, do you guys ever check the code you write? :-( ).",
    "created_at": "2017-02-09T17:37:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283830",
    "user": "dimpase"
}
```

removed the useless (the one from the parent class is just as fast) `weight_enumerator()`. And fixed typos in weight distributions data (yes, indeed, do you guys ever check the code you write? :-( ).



---

archive/issue_comments_283831.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-02-09T17:37:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283831",
    "user": "dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_283832.json:
```json
{
    "body": "Replying to [comment:27 dimpase]:\n> removed the useless (the one from the parent class is just as fast) `weight_enumerator()`. And fixed typos in weight distributions data (yes, indeed, do you guys ever check the code you write? :-( ).\n\nyes, this does fix the Chinen polynomial bug, as the weight enumerators are now correct.",
    "created_at": "2017-02-09T17:58:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283832",
    "user": "dimpase"
}
```

Replying to [comment:27 dimpase]:
> removed the useless (the one from the parent class is just as fast) `weight_enumerator()`. And fixed typos in weight distributions data (yes, indeed, do you guys ever check the code you write? :-( ).

yes, this does fix the Chinen polynomial bug, as the weight enumerators are now correct.



---

archive/issue_comments_283833.json:
```json
{
    "body": "All tests pass, with the option `--long`.",
    "created_at": "2017-02-09T18:14:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283833",
    "user": "danielaugot"
}
```

All tests pass, with the option `--long`.



---

archive/issue_comments_283834.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-02-09T18:27:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283834",
    "user": "danielaugot"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_283835.json:
```json
{
    "body": "\n```\n[dochtml] OSError: [coding   ] /mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/coding/golay_code.py:docstring of sage.coding.golay_code:8: WARNING: citation not found: HP03\n[dochtml] \nMakefile:1083: recipe for target 'doc-html' failed\n```\n",
    "created_at": "2017-02-09T23:32:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283835",
    "user": "vbraun"
}
```


```
[dochtml] OSError: [coding   ] /mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/coding/golay_code.py:docstring of sage.coding.golay_code:8: WARNING: citation not found: HP03
[dochtml] 
Makefile:1083: recipe for target 'doc-html' failed
```




---

archive/issue_comments_283836.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-02-09T23:32:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283836",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_283837.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-09T23:58:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283837",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_283838.json:
```json
{
    "body": "IMHO we deserve co-authorship on this :-)",
    "created_at": "2017-02-10T00:03:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283838",
    "user": "dimpase"
}
```

IMHO we deserve co-authorship on this :-)



---

archive/issue_comments_283839.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-02-10T00:03:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283839",
    "user": "dimpase"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_283840.json:
```json
{
    "body": "I could build the documentation after a `make doc-clean`.",
    "created_at": "2017-02-10T08:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283840",
    "user": "danielaugot"
}
```

I could build the documentation after a `make doc-clean`.



---

archive/issue_comments_283841.json:
```json
{
    "body": "\n```\nsage -t --long src/sage/matroids/catalog.py\n4733**********************************************************************\n4734File \"src/sage/matroids/catalog.py\", line 1420, in sage.matroids.catalog.ExtendedBinaryGolayCode\n4735Failed example:\n4736    C.is_permutation_equivalent(codes.GolayCode(GF(2)) # long time\n4737Exception raised:\n4738    Traceback (most recent call last):\n4739      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n4740        self.compile_and_execute(example, compiler, test.globs)\n4741      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 859, in compile_and_execute\n4742        compiled = compiler(example)\n4743      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in <lambda>\n4744        example.source, filename, \"single\", compileflags, 1)\n4745      File \"<doctest sage.matroids.catalog.ExtendedBinaryGolayCode[2]>\", line 1\n4746        C.is_permutation_equivalent(codes.GolayCode(GF(Integer(2))) # long time\n4747                                                                              ^\n4748    SyntaxError: unexpected EOF while parsing\n4749*********************************************************************\n```\n\nand\n\n```\nsage -t --long src/sage/numerical/backends/generic_backend.pyx\n5210**********************************************************************\n5211File \"src/sage/numerical/backends/generic_backend.pyx\", line 1752, in sage.numerical.backends.generic_backend.get_solver\n5212Failed example:\n5213    delsarte_bound_additive_hamming_space(11,3,4,solver=glpk_exact_solver) # long time\n5214Expected:\n5215    glp_exact...\n5216    ...\n5217    OPTIMAL SOLUTION FOUND\n5218    8\n5219Got:\n5220    doctest:warning\n5221\n```\n",
    "created_at": "2017-02-11T19:20:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283841",
    "user": "vbraun"
}
```


```
sage -t --long src/sage/matroids/catalog.py
4733**********************************************************************
4734File "src/sage/matroids/catalog.py", line 1420, in sage.matroids.catalog.ExtendedBinaryGolayCode
4735Failed example:
4736    C.is_permutation_equivalent(codes.GolayCode(GF(2)) # long time
4737Exception raised:
4738    Traceback (most recent call last):
4739      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
4740        self.compile_and_execute(example, compiler, test.globs)
4741      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 859, in compile_and_execute
4742        compiled = compiler(example)
4743      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in <lambda>
4744        example.source, filename, "single", compileflags, 1)
4745      File "<doctest sage.matroids.catalog.ExtendedBinaryGolayCode[2]>", line 1
4746        C.is_permutation_equivalent(codes.GolayCode(GF(Integer(2))) # long time
4747                                                                              ^
4748    SyntaxError: unexpected EOF while parsing
4749*********************************************************************
```

and

```
sage -t --long src/sage/numerical/backends/generic_backend.pyx
5210**********************************************************************
5211File "src/sage/numerical/backends/generic_backend.pyx", line 1752, in sage.numerical.backends.generic_backend.get_solver
5212Failed example:
5213    delsarte_bound_additive_hamming_space(11,3,4,solver=glpk_exact_solver) # long time
5214Expected:
5215    glp_exact...
5216    ...
5217    OPTIMAL SOLUTION FOUND
5218    8
5219Got:
5220    doctest:warning
5221
```




---

archive/issue_comments_283842.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-02-11T19:20:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283842",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_283843.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-11T20:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283843",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_283844.json:
```json
{
    "body": "the 2nd error comes from #20908 - this ticket has nothing to do with it...\n\n```\nGot:\n    doctest:warning\n...\n    DeprecationWarning: This function will soon be removed from the global namespace. Please call it using codes.bounds.delsarte_bound_additive_hamming_space instead\n    See http://trac.sagemath.org/20908 for details.\n```\n\n\nWhere would you like this to be fixed?",
    "created_at": "2017-02-11T20:53:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283844",
    "user": "dimpase"
}
```

the 2nd error comes from #20908 - this ticket has nothing to do with it...

```
Got:
    doctest:warning
...
    DeprecationWarning: This function will soon be removed from the global namespace. Please call it using codes.bounds.delsarte_bound_additive_hamming_space instead
    See http://trac.sagemath.org/20908 for details.
```


Where would you like this to be fixed?



---

archive/issue_comments_283845.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-02-11T20:58:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283845",
    "user": "dimpase"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_283846.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-02-12T12:35:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283846",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_283847.json:
```json
{
    "body": "Daniel merged #20908 into this branch, so you you need to fix both #20908 and this branch.",
    "created_at": "2017-02-12T12:35:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283847",
    "user": "vbraun"
}
```

Daniel merged #20908 into this branch, so you you need to fix both #20908 and this branch.



---

archive/issue_comments_283848.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-12T21:28:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283848",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_283849.json:
```json
{
    "body": "all right, all right...",
    "created_at": "2017-02-12T21:29:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283849",
    "user": "dimpase"
}
```

all right, all right...



---

archive/issue_comments_283850.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-02-12T21:29:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283850",
    "user": "dimpase"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_283851.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-02-14T18:59:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283851",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_283852.json:
```json
{
    "body": "Thanks a lot, Dima, for so much help. Daniel",
    "created_at": "2017-02-15T17:59:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20550#issuecomment-283852",
    "user": "danielaugot"
}
```

Thanks a lot, Dima, for so much help. Daniel
