# Issue 23760: installed_packages(False) gives wrong version for Python packages with patches

archive/issues_023760.json:
```json
{
    "body": "CC:  @koffie\n\nSage uses a convention to append `.pNUM` to indicate patched or updated packages. However, because of the logic in `installed_packages(False)`, the version number returned by `installed_packages(False)` is the version given by `pip` instead of the Sage version number.\n\nThis causes in particular that optional doctests are not run for such packages. At the moment, the only package with this problem and which has optional doctests is `dot2tex`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/23997\n\n",
    "closed_at": "2017-10-15T09:22:03Z",
    "created_at": "2017-10-09T12:33:33Z",
    "labels": [
        "component: misc",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "installed_packages(False) gives wrong version for Python packages with patches",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23760",
    "user": "https://github.com/jdemeyer"
}
```
CC:  @koffie

Sage uses a convention to append `.pNUM` to indicate patched or updated packages. However, because of the logic in `installed_packages(False)`, the version number returned by `installed_packages(False)` is the version given by `pip` instead of the Sage version number.

This causes in particular that optional doctests are not run for such packages. At the moment, the only package with this problem and which has optional doctests is `dot2tex`.

Issue created by migration from https://trac.sagemath.org/ticket/23997





---

archive/issue_comments_332558.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-10-09T13:53:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23760",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23760#issuecomment-332558",
    "user": "https://github.com/jdemeyer"
}
```

New commits:



---

archive/issue_comments_332559.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-10-09T13:53:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23760",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23760#issuecomment-332559",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_332560.json:
```json
{
    "body": "Makes sense to me.",
    "created_at": "2017-10-09T15:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23760",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23760#issuecomment-332560",
    "user": "https://github.com/tscrim"
}
```

Makes sense to me.



---

archive/issue_comments_332561.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-09T15:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23760",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23760#issuecomment-332561",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_332562.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2017-10-09T19:23:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23760",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23760#issuecomment-332562",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_332563.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2017-10-09T19:23:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23760",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23760#issuecomment-332563",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_332564.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-10-09T19:24:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23760",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23760#issuecomment-332564",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_332565.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-09T19:25:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23760",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23760#issuecomment-332565",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_332566.json:
```json
{
    "body": "Accidentally committed on the wrong branch. Fixed it.",
    "created_at": "2017-10-09T19:25:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23760",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23760#issuecomment-332566",
    "user": "https://github.com/jdemeyer"
}
```

Accidentally committed on the wrong branch. Fixed it.



---

archive/issue_events_061023.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-10-15T09:22:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23760",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23760#event-61023"
}
```



---

archive/issue_comments_332567.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-10-15T09:22:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23760",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23760#issuecomment-332567",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
