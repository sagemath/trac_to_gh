# Issue 15747: Python 3 preparation: Change some code to use more modern Python idioms

archive/issues_015747.json:
```json
{
    "body": "Keywords: python3\n\nThis fixer changes code like `type(x) == T)` and `while 1:` and it introduces the `sorted()` function where appropriate.\n\nThese changes are optional, but they improve style and may provide a small performance gain.\n\nChanges according to `lib2to3/fixes/fix_idioms.py`:\n\n```\n* Change some type comparisons to isinstance() calls:\n    type(x) == T -> isinstance(x, T)\n    type(x) is T -> isinstance(x, T)\n    type(x) != T -> not isinstance(x, T)\n    type(x) is not T -> not isinstance(x, T)\n\n* Change \"while 1:\" into \"while True:\".\n\n* Change both\n    v = list(EXPR)\n    v.sort()\n    foo(v)\n\nand the more general\n    v = EXPR\n    v.sort()\n    foo(v)\n\ninto\n    v = sorted(EXPR)\n    foo(v)\n```\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/15984\n\n",
    "created_at": "2014-03-20T15:18:38Z",
    "labels": [
        "component: distribution"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "Python 3 preparation: Change some code to use more modern Python idioms",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15747",
    "user": "https://github.com/wluebbe"
}
```
Keywords: python3

This fixer changes code like `type(x) == T)` and `while 1:` and it introduces the `sorted()` function where appropriate.

These changes are optional, but they improve style and may provide a small performance gain.

Changes according to `lib2to3/fixes/fix_idioms.py`:

```
* Change some type comparisons to isinstance() calls:
    type(x) == T -> isinstance(x, T)
    type(x) is T -> isinstance(x, T)
    type(x) != T -> not isinstance(x, T)
    type(x) is not T -> not isinstance(x, T)

* Change "while 1:" into "while True:".

* Change both
    v = list(EXPR)
    v.sort()
    foo(v)

and the more general
    v = EXPR
    v.sort()
    foo(v)

into
    v = sorted(EXPR)
    foo(v)
```



Issue created by migration from https://trac.sagemath.org/ticket/15984





---

archive/issue_comments_203604.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-03-28T18:42:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15747#issuecomment-203604",
    "user": "https://github.com/wluebbe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_203605.json:
```json
{
    "body": "* At first I applied the 2to3 tool (idioms) -> first commit  \n* Fixing the doctests failures of the first commit -> second commit. All tests passed.\n* Changed `while 1:` into `while True:` for cython modules -> third commit.\n----\nNew commits:",
    "created_at": "2014-03-28T18:42:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15747#issuecomment-203605",
    "user": "https://github.com/wluebbe"
}
```

* At first I applied the 2to3 tool (idioms) -> first commit  
* Fixing the doctests failures of the first commit -> second commit. All tests passed.
* Changed `while 1:` into `while True:` for cython modules -> third commit.
----
New commits:



---

archive/issue_comments_203606.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-04-03T08:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15747#issuecomment-203606",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_203607.json:
```json
{
    "body": "Rebased on 6.2.beta6 and resolved merge conflicts.",
    "created_at": "2014-04-03T08:46:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15747#issuecomment-203607",
    "user": "https://github.com/wluebbe"
}
```

Rebased on 6.2.beta6 and resolved merge conflicts.



---

archive/issue_comments_203608.json:
```json
{
    "body": "And the test report:\n\n```\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 3214.7 seconds\n```\n",
    "created_at": "2014-04-04T17:07:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15747#issuecomment-203608",
    "user": "https://github.com/wluebbe"
}
```

And the test report:

```
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 3214.7 seconds
```




---

archive/issue_comments_203609.json:
```json
{
    "body": "I think it would also be good to change `x == None` to `x is None` while we're at it.",
    "created_at": "2014-04-06T03:46:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15747#issuecomment-203609",
    "user": "https://github.com/tscrim"
}
```

I think it would also be good to change `x == None` to `x is None` while we're at it.



---

archive/issue_comments_203610.json:
```json
{
    "body": "There are 151 modules (py and pyx combined) which have at least one of `== None` or `!= None`. \n\n\nThe change makes sense as (by far) most modules use `is None` or `is not None`.\n\nBut as this change is already pretty large I would prefer to see this change in a separate ticket/branch.",
    "created_at": "2014-04-06T12:34:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15747#issuecomment-203610",
    "user": "https://github.com/wluebbe"
}
```

There are 151 modules (py and pyx combined) which have at least one of `== None` or `!= None`. 


The change makes sense as (by far) most modules use `is None` or `is not None`.

But as this change is already pretty large I would prefer to see this change in a separate ticket/branch.



---

archive/issue_comments_203611.json:
```json
{
    "body": "I think it fits well with this ticket (plus how many of those modules overlap with this one?). Also one large sweeping change is the same to me as two large sweeping changes (especially with different commits), but with the added benefit of an only one time potential rebase. If you still disagree and want it in a separate ticket, then you can set this to positive review.",
    "created_at": "2014-04-07T19:54:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15747#issuecomment-203611",
    "user": "https://github.com/tscrim"
}
```

I think it fits well with this ticket (plus how many of those modules overlap with this one?). Also one large sweeping change is the same to me as two large sweeping changes (especially with different commits), but with the added benefit of an only one time potential rebase. If you still disagree and want it in a separate ticket, then you can set this to positive review.



---

archive/issue_comments_203612.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-04-08T08:52:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15747#issuecomment-203612",
    "user": "https://github.com/wluebbe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_203613.json:
```json
{
    "body": "I generated 151 patched py and pyx files. 3 pyx files gave doctest failures. And I got merge conflicts with this branch.\n\nTherefor I set this ticket to \"positive review\" (as suggested above).\n\nI will open a separate ticket for `== None` and generate fresh patches when this ticket is merged in a beta or release.",
    "created_at": "2014-04-08T08:52:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15747#issuecomment-203613",
    "user": "https://github.com/wluebbe"
}
```

I generated 151 patched py and pyx files. 3 pyx files gave doctest failures. And I got merge conflicts with this branch.

Therefor I set this ticket to "positive review" (as suggested above).

I will open a separate ticket for `== None` and generate fresh patches when this ticket is merged in a beta or release.



---

archive/issue_events_047009.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-04-08T12:41:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15747",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15747#event-47009"
}
```



---

archive/issue_comments_203614.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-04-08T12:41:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15747#issuecomment-203614",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
