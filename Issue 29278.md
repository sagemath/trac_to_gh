# Issue 29278: spkg-configure for singular

Issue created by migration from https://trac.sagemath.org/ticket/29515

Original creator: @thierry-FreeBSD

Original creation time: 2020-04-15 20:35:16

Keywords: system package

In order to use a system package of singular (see #27330 ), I added a basic spkg-configure.m4.


---

Attachment

spkg-configure.m4 for singular


---

Comment by @thierry-FreeBSD created at 2020-04-15 20:41:10

With the attached file put under build/pkgs/singular configure works:

-----------------------------------------------------------------------------

Checking whether [SageMath](SageMath) should install SPKG singular...

checking whether any of gmp mpfr is installed or will be installed as SPKG... no

checking for libSingular... yes

configure: will use system package and not install SPKG singular

-----------------------------------------------------------------------------

...

singular-4.1.1p2.p0:                         using system package; SPKG will not be installed


But I have remarked that sage builts only when singular has been built with '--with-ntl': some more checks could be added.


---

Comment by @thierry-FreeBSD created at 2020-04-15 20:46:57

And after the build, with the system package, the error already reported in #22175 (freegb.lib not found) occurs (but certainly for another cause):

[dochtml] Build finished. The built documents can be found in /usr/ports/math/sage/work/stage/usr/local/share/doc/sage/inventory/en/reference/tensor_free_modules

[dochtml] Error building the documentation.

[dochtml] Traceback (most recent call last):

[dochtml]   File "/usr/local/lib/python3.7/runpy.py", line 193, in _run_module_as_main

[dochtml]     "__main__", mod_spec)

[dochtml]   File "/usr/local/lib/python3.7/runpy.py", line 85, in _run_code

[dochtml]     exec(code, run_globals)

[dochtml]   File "/usr/ports/math/sage/work/stage/usr/local/lib/python3.7/site-packages/sage_setup/docbuild/__main__.py", line 2, in <module>

[dochtml]     main()

[dochtml]   File "/usr/ports/math/sage/work/stage/usr/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 1720, in main

[dochtml]     builder()

[dochtml]   File "/usr/ports/math/sage/work/stage/usr/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 327, in _wrapper

[dochtml]     getattr(get_builder(document), 'inventory')(*args, **kwds)

[dochtml]   File "/usr/ports/math/sage/work/stage/usr/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 552, in _wrapper

[dochtml]     self._build_everything_except_bibliography(lang, format, *args, **kwds)

[dochtml]   File "/usr/ports/math/sage/work/stage/usr/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 538, in _build_everything_except_bibliography

[dochtml]     build_many(build_ref_doc, non_references)

[dochtml]   File "/usr/ports/math/sage/work/stage/usr/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 280, in build_many

[dochtml]     _build_many(target, args, processes=NUM_THREADS)

[dochtml]   File "/usr/ports/math/sage/work/stage/usr/local/lib/python3.7/site-packages/sage_setup/docbuild/utils.py", line 283, in build_many

[dochtml]     raise worker_exc.original_exception

[dochtml] NameError: Singular library 'freegb.lib' not found

gmake[4]: *** [Makefile:1985: doc-html] Error 1

Note: on my machine freegb.lib is installed under /usr/local/share/singular/LIB/freegb.lib


---

Comment by mkoeppe created at 2020-04-15 21:05:36

dup of #29024


---

Comment by @thierry-FreeBSD created at 2020-04-16 12:35:56

OK, to be closed!

(Because #29024 is not listed in #27330 I did not found it)


---

Comment by mkoeppe created at 2020-04-16 13:41:29

Changing status from new to needs_review.


---

Comment by @mwageringel created at 2020-04-18 17:46:31

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2020-05-14 16:28:54

Resolution: duplicate
