# Issue 23708: Add test for Weil polynomials

Issue created by migration from Trac.

Original creator: kedlaya

Original creation time: 2017-09-30 17:19:23

Keywords: Weil polynomial, sd91

We are adding a function that tests whether a given polynomial is a Weil polynomial for a given prime power q, i.e., whether its complex roots all have absolute value `sqrt(q)`.


---

Comment by kedlaya created at 2017-09-30 23:37:41

One easy way to do this would be to combine the "inverse reciprocal transform" from #23947 with the existing `all_roots_in_interval` method of polynomials (which wraps Pari's implementation of Sturm sequences).


---

Comment by dzb created at 2017-10-01 22:51:53

Changing status from new to needs_review.


---

Comment by dzb created at 2017-10-01 22:51:53

Implemented `is_weil_polynomial`
----
New commits:


---

Comment by roed created at 2017-10-01 23:47:05

Made changes; if Kiran is happy then we can give this a positive review.
----
New commits:


---

Comment by kedlaya created at 2017-10-02 00:34:25

Changing status from needs_review to positive_review.


---

Comment by kedlaya created at 2017-10-02 00:34:25

Looks good to me.


---

Comment by kedlaya created at 2017-10-02 03:13:19

Changing status from positive_review to needs_work.


---

Comment by kedlaya created at 2017-10-02 03:13:19

Sorry, backing out the positive review due to some failing doctests. More soon.


---

Comment by kedlaya created at 2017-10-02 03:32:57

I fixed the issue with the doctests. Also, I don't like redefining `self` within a method definition.

All tests now pass on k8s. Since I touched the code last, someone other than me should check my work and then set a positive review.
----
New commits:


---

Comment by kedlaya created at 2017-10-02 03:32:57

Changing status from needs_work to needs_review.


---

Comment by roed created at 2017-10-02 03:44:36

Looks good to me.  Positive review once tests pass.


---

Comment by roed created at 2017-10-02 17:24:37

Changing status from needs_review to positive_review.


---

Comment by roed created at 2017-10-02 17:24:37

David Zureick-Brown isn't a trusted author, so patchbot won't run.  I ran tests on k8s with no failures.  Positive review.


---

Comment by vbraun created at 2017-10-07 21:19:00

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2017-10-07 21:19:00


```
[dochtml] OSError: [polynomia] docstring of sage.rings.polynomial.polynomial_element.Polynomial.is_weil_polynomial:10: WARNING: Bullet list ends without a blank line; unexpected unindent.
```



---

Comment by git created at 2017-10-08 03:32:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by kedlaya created at 2017-10-08 03:41:01

Looks like there was some dodgy formatting in the docstring. Let's see if I managed to fix it.


---

Comment by kedlaya created at 2017-10-08 03:41:01

Changing status from needs_work to needs_review.


---

Comment by roed created at 2017-10-09 00:48:44

Changing status from needs_review to positive_review.


---

Comment by roed created at 2017-10-09 00:48:44

Seems fine, though I think it's better if True has double backticks around it.


---

Comment by git created at 2017-10-09 00:53:31

Changing status from positive_review to needs_review.


---

Comment by git created at 2017-10-09 00:53:31

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by kedlaya created at 2017-10-09 00:54:32

I added the double backticks around True in the second line. In the one-sentence summary, I think the convention is not to use them.


---

Comment by roed created at 2017-10-10 00:54:24

Good enough, though I think the convention would be `Return whether this is a Weil polynomial` rather than `Return True if this is a Weil polynomial`.


---

Comment by roed created at 2017-10-10 00:54:24

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-10-22 05:51:53

Resolution: fixed
