# Issue 23571: Keep embedding info when converting algebraics to number field in projective morphism

archive/issues_023571.json:
```json
{
    "body": "CC:  @bhutz\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/23808\n\n",
    "created_at": "2017-09-08T16:23:45Z",
    "labels": [
        "component: please change"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Keep embedding info when converting algebraics to number field in projective morphism",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23571",
    "user": "https://github.com/pfili"
}
```
CC:  @bhutz



Issue created by migration from https://trac.sagemath.org/ticket/23808





---

archive/issue_comments_329855.json:
```json
{
    "body": "The following code used to fail:\n\n```python\nR.<t>=PolynomialRing(QQ)\ns = (t^3+t+1).roots(QQbar)[0][0]\nP.<x,y>=ProjectiveSpace(QQbar,1)\nH = Hom(P,P)\nf = H([s*x^3-13*y^3, y^3-15*y^3])\nf_alg = f._number_field_from_algebraics()\nf_alg.change_ring(QQbar) # Used to fail\n```\n\n\nThe problem was that the number field being defined over which f_alg was defined should include an embedding, telling Sage where to send the generator in the real/complex numbers. (After all, QQbar elements all have this embedding information.) This information was present but was not being used when defining the number field (possibly due to a quirk in the code from qqbar.py). The fix now updates the code to specify this embedding when creating the number field. \n----\nNew commits:",
    "created_at": "2017-09-08T16:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23571#issuecomment-329855",
    "user": "https://github.com/pfili"
}
```

The following code used to fail:

```python
R.<t>=PolynomialRing(QQ)
s = (t^3+t+1).roots(QQbar)[0][0]
P.<x,y>=ProjectiveSpace(QQbar,1)
H = Hom(P,P)
f = H([s*x^3-13*y^3, y^3-15*y^3])
f_alg = f._number_field_from_algebraics()
f_alg.change_ring(QQbar) # Used to fail
```


The problem was that the number field being defined over which f_alg was defined should include an embedding, telling Sage where to send the generator in the real/complex numbers. (After all, QQbar elements all have this embedding information.) This information was present but was not being used when defining the number field (possibly due to a quirk in the code from qqbar.py). The fix now updates the code to specify this embedding when creating the number field. 
----
New commits:



---

archive/issue_comments_329856.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2017-09-08T16:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23571#issuecomment-329856",
    "user": "https://github.com/pfili"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_329857.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-09-08T16:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23571#issuecomment-329857",
    "user": "https://github.com/pfili"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_329858.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to algebraic geometry.",
    "created_at": "2017-09-08T16:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23571#issuecomment-329858",
    "user": "https://github.com/pfili"
}
```

Changing component from PLEASE CHANGE to algebraic geometry.



---

archive/issue_comments_329859.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-09-08T21:17:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23571#issuecomment-329859",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_329860.json:
```json
{
    "body": "You should add a test to show that the bug has been fixed.  You can use\n\n```\n:trac:`23808`\n```\n\nto refer to this ticket in the docstring.",
    "created_at": "2017-09-08T21:17:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23571#issuecomment-329860",
    "user": "https://github.com/roed314"
}
```

You should add a test to show that the bug has been fixed.  You can use

```
:trac:`23808`
```

to refer to this ticket in the docstring.



---

archive/issue_comments_329861.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-08T23:05:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23571#issuecomment-329861",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_329862.json:
```json
{
    "body": "Replying to [comment:3 roed]:\n> You should add a test to show that the bug has been fixed.  You can use\n> {{{\n> :trac:`23808`\n> }}}\n> to refer to this ticket in the docstring.\n\nThanks, David, I added the example.",
    "created_at": "2017-09-08T23:08:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23571#issuecomment-329862",
    "user": "https://github.com/pfili"
}
```

Replying to [comment:3 roed]:
> You should add a test to show that the bug has been fixed.  You can use
> {{{
> :trac:`23808`
> }}}
> to refer to this ticket in the docstring.

Thanks, David, I added the example.



---

archive/issue_comments_329863.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-09-08T23:08:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23571#issuecomment-329863",
    "user": "https://github.com/pfili"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_329864.json:
```json
{
    "body": "You should change `print f` to just `f` for Python 3 compatibility.  Other than that, looks good and positive review once patchbot approves.",
    "created_at": "2017-09-09T00:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23571#issuecomment-329864",
    "user": "https://github.com/roed314"
}
```

You should change `print f` to just `f` for Python 3 compatibility.  Other than that, looks good and positive review once patchbot approves.



---

archive/issue_comments_329865.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-09-09T00:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23571#issuecomment-329865",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_329866.json:
```json
{
    "body": "Also, note that there is a similar function for points that should be modified at the same time.",
    "created_at": "2017-09-09T15:43:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23571#issuecomment-329866",
    "user": "https://github.com/bhutz"
}
```

Also, note that there is a similar function for points that should be modified at the same time.



---

archive/issue_comments_329867.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-09T16:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23571#issuecomment-329867",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_329868.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-09-09T16:44:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23571#issuecomment-329868",
    "user": "https://github.com/pfili"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_329869.json:
```json
{
    "body": "Replying to [comment:7 roed]:\n> You should change `print f` to just `f` for Python 3 compatibility.  Other than that, looks good and positive review once patchbot approves.\n\nThanks, David, I have changed that as well.",
    "created_at": "2017-09-09T16:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23571#issuecomment-329869",
    "user": "https://github.com/pfili"
}
```

Replying to [comment:7 roed]:
> You should change `print f` to just `f` for Python 3 compatibility.  Other than that, looks good and positive review once patchbot approves.

Thanks, David, I have changed that as well.



---

archive/issue_comments_329870.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-09-09T17:30:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23571#issuecomment-329870",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_329871.json:
```json
{
    "body": "This looks fine to me. I also added a description.",
    "created_at": "2017-09-09T17:30:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23571#issuecomment-329871",
    "user": "https://github.com/bhutz"
}
```

This looks fine to me. I also added a description.



---

archive/issue_comments_329872.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-09-11T13:46:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23571#issuecomment-329872",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
