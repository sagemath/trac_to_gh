# Issue 13322: simple incorrect limit

Issue created by migration from Trac.

Original creator: pang

Original creation time: 2012-09-24 13:11:31

Assignee: burcin

Keywords: symbolic, limit

Sage incorrectly computes:


```
var('n')
l  = (3^n + (-2)^n) / (3^(n+1) + (-2)^(n+1))
l.limit(n=oo)
```

gives 0.

However, 



```
var('n')
l  = (3^n + (-2.0)^n) / (3^(n+1) + (-2)^(n+1))
l.limit(n=oo)
```


gives the correct result 1/3, and


```
var('n')
assume(n,'integer')
l  = (3^n + (-2)^n) / (3^(n+1) + (-2)^(n+1))
l.limit(n=oo)
```


also does.

maxima also gives the value 0 to the corresponding limits, but changing (-2)\^n by (-2.0)\^n only produce meaningless results.


---

Comment by kcrisman created at 2012-09-28 01:51:50

Did you report this upstream?


---

Comment by dimpase created at 2012-10-28 05:27:23

Replying to [comment:1 kcrisman]:
> Did you report this upstream?

I'd rather say: did you try this with maxima 5.28.0 ? (Sage still uses 5.26.0)


---

Comment by kcrisman created at 2012-10-29 19:39:27

Well, fair enough.

```
Maxima 5.28.0 http://maxima.sourceforge.net
using Lisp SBCL 1.0.55.0-abb03f9

(%i2) limit( (3^n+(-2.0)^n)/(3^(n+1)+(-2)^(n+1)),n,inf);

rat: replaced -2.0 by -2/1 = -2.0

rat: replaced -2.0 by -2/1 = -2.0

rat: replaced 3.141592653589793 by 80143857/25510582 = 3.141592653589793

rat: replaced 3.141592653589793 by 80143857/25510582 = 3.141592653589793

rat: replaced -.693147180559945 by -13614799/19642003 = -.693147180559946

rat: replaced -.693147180559945 by -13614799/19642003 = -.693147180559946

rat: replaced -.693147180559945 by -13614799/19642003 = -.693147180559946

rat: replaced -.693147180559945 by -13614799/19642003 = -.693147180559946

rat: replaced -.693147180559945 by -13614799/19642003 = -.693147180559946

rat: replaced .6931471805599453 by 13614799/19642003 = 0.693147180559946
(%o2)                                  0
(%i3) limit( (3^n+(-2)^n)/(3^(n+1)+(-2)^(n+1)),n,inf);
(%o3)                                  0
```

while

```
sage: [l.subs(n=k) for k in [1.,10.^1,10.^2,10.^4,10.^6,10.^8,10.^10]]
[0.0769230769230769, 0.343080200343806, 0.333333333333333, 0.333333333333333, 0.333333333333333, 0.333333333333333, 0.333333333333333]
```



---

Comment by pang created at 2012-10-29 21:28:15

Karl, thanks for testing. By "report upstream": you mean to maxima? I didn't. I was puzzled that Sage and maxima behave so differently, so I chose to leave it for the expert. Should I?


---

Comment by dimpase created at 2012-10-30 10:16:58

Replying to [comment:4 pang]:
> Karl, thanks for testing. By "report upstream": you mean to maxima? I didn't. I was puzzled that Sage and maxima behave so differently, so I chose to leave it for the expert. Should I?

Well, 5.26.0 is an old version, and if the bug does not show itself in 5.28.0, such a report makes little sense.
By the way, Karl's 5.28.0 is compiled with a different Lisp compiler, SBCL, not ECL, so it's not the end of the story. E.g. there could be a bug in ECL, and not in Maxima.


---

Comment by pang created at 2012-10-30 11:23:14

Replying to [comment:5 dimpase]:
> Well, 5.26.0 is an old version, and if the bug does not show itself in 5.28.0, such a report makes little sense.

The bug does show in 5.28: it gives 0 instead of 1/3.


---

Comment by dimpase created at 2012-10-30 13:38:24

Replying to [comment:6 pang]:
> Replying to [comment:5 dimpase]:
> > Well, 5.26.0 is an old version, and if the bug does not show itself in 5.28.0, such a report makes little sense.
> 
> The bug does show in 5.28: it gives 0 instead of 1/3.
oops, I wasn't paying enough attention :-)
Then, sure, report it to upstream, by all means!


---

Comment by jdemeyer created at 2013-06-13 09:23:17

Fixed in Maxima 5.30.0: #13973.


---

Comment by pbruin created at 2014-05-29 21:54:31

Changing priority from minor to trivial.


---

Comment by pbruin created at 2014-05-29 21:54:31

Added the example from the original report as a doctest.


---

Comment by pbruin created at 2014-05-29 21:54:31

Changing status from new to needs_review.


---

Comment by tscrim created at 2014-05-30 01:45:20

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2014-05-30 01:45:20

LGTM.


---

Comment by kcrisman created at 2014-05-30 02:16:41

Ah, and this branch is properly based on the Maxima update, phew :-)


---

Comment by vbraun created at 2014-06-02 15:56:35

Resolution: fixed
