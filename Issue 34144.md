# Issue 34144: Add infinte q-Pochhammer symbol

archive/issues_034144.json:
```json
{
    "body": "CC:  @mantepse @fchapoton\n\n`(z; q)_{\\infty}` has a nice expression for its coefficients in `z`. We implement this very important series as a lazy Laurent series.\n\nIssue created by migration from https://trac.sagemath.org/ticket/34381\n\n",
    "created_at": "2022-08-17T02:30:55Z",
    "labels": [
        "component: algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Add infinte q-Pochhammer symbol",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34144",
    "user": "https://github.com/tscrim"
}
```
CC:  @mantepse @fchapoton

`(z; q)_{\infty}` has a nice expression for its coefficients in `z`. We implement this very important series as a lazy Laurent series.

Issue created by migration from https://trac.sagemath.org/ticket/34381





---

archive/issue_comments_483846.json:
```json
{
    "body": "After doing this, we might want to move the construction of the underlying function to the lazy series ring. We might also want to special case composition of a lazy Laurent series with a monomial in a lazy Laurent series.\n----\nNew commits:",
    "created_at": "2022-08-17T03:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483846",
    "user": "https://github.com/tscrim"
}
```

After doing this, we might want to move the construction of the underlying function to the lazy series ring. We might also want to special case composition of a lazy Laurent series with a monomial in a lazy Laurent series.
----
New commits:



---

archive/issue_comments_483847.json:
```json
{
    "body": "Changing keywords from \"\" to \"q_pochhammer, euler function\".",
    "created_at": "2022-08-17T03:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483847",
    "user": "https://github.com/tscrim"
}
```

Changing keywords from "" to "q_pochhammer, euler function".



---

archive/issue_comments_483848.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-08-17T03:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483848",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_483849.json:
```json
{
    "body": "This also does not conflict with #32324.",
    "created_at": "2022-08-17T03:14:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483849",
    "user": "https://github.com/tscrim"
}
```

This also does not conflict with #32324.



---

archive/issue_comments_483850.json:
```json
{
    "body": "Cool!  It makes me happy to see so many possibilities opening up!\n\nQuestion: what do you mean with moving the construction of the underlying function to the `LazyLaurentSeriesRing`?\n\nIdea / Suggestion: maybe it makes sense to use \"dummy\" (or something similar) instead of \"z\" for the variable name, to make it clear to the reader that it plays no role.  Of course, this would equally apply to all the other special functions.  I am not sure about the benefit / cost ratio, I am not even sure that there would be a benefit.",
    "created_at": "2022-08-17T06:27:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483850",
    "user": "https://github.com/mantepse"
}
```

Cool!  It makes me happy to see so many possibilities opening up!

Question: what do you mean with moving the construction of the underlying function to the `LazyLaurentSeriesRing`?

Idea / Suggestion: maybe it makes sense to use "dummy" (or something similar) instead of "z" for the variable name, to make it clear to the reader that it plays no role.  Of course, this would equally apply to all the other special functions.  I am not sure about the benefit / cost ratio, I am not even sure that there would be a benefit.



---

archive/issue_comments_483851.json:
```json
{
    "body": "Replying to [comment:4 mantepse]:\n> Question: what do you mean with moving the construction of the underlying function to the `LazyLaurentSeriesRing`?\n\nFor each of these special functions, we first construct a series `f`. So I propose having, e.g., `L.sin()` return `f(z) = sin(z)` in the variable of that lazy Laurent series ring. This avoids a composition call. I feel like it might make for a more natural home for, e.g., `euler()`.\n\n> Idea / Suggestion: maybe it makes sense to use \"dummy\" (or something similar) instead of \"z\" for the variable name, to make it clear to the reader that it plays no role.  Of course, this would equally apply to all the other special functions.  I am not sure about the benefit / cost ratio, I am not even sure that there would be a benefit.\n\nIt gets substituted out every time. So it is never visible, and so I see no net change (although it would make a bug easier to spot if we ended up in the very unlikely scenario that the composition returned the wrong parent). If we wanted to do this, we should do it for all special functions simultaneously on a follow-up ticket.",
    "created_at": "2022-08-17T07:04:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483851",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:4 mantepse]:
> Question: what do you mean with moving the construction of the underlying function to the `LazyLaurentSeriesRing`?

For each of these special functions, we first construct a series `f`. So I propose having, e.g., `L.sin()` return `f(z) = sin(z)` in the variable of that lazy Laurent series ring. This avoids a composition call. I feel like it might make for a more natural home for, e.g., `euler()`.

> Idea / Suggestion: maybe it makes sense to use "dummy" (or something similar) instead of "z" for the variable name, to make it clear to the reader that it plays no role.  Of course, this would equally apply to all the other special functions.  I am not sure about the benefit / cost ratio, I am not even sure that there would be a benefit.

It gets substituted out every time. So it is never visible, and so I see no net change (although it would make a bug easier to spot if we ended up in the very unlikely scenario that the composition returned the wrong parent). If we wanted to do this, we should do it for all special functions simultaneously on a follow-up ticket.



---

archive/issue_comments_483852.json:
```json
{
    "body": "Replying to [comment:5 tscrim]:\n> Replying to [comment:4 mantepse]:\n> > Question: what do you mean with moving the construction of the underlying function to the `LazyLaurentSeriesRing`?\n> \n> For each of these special functions, we first construct a series `f`. So I propose having, e.g., `L.sin()` return `f(z) = sin(z)` in the variable of that lazy Laurent series ring. This avoids a composition call. I feel like it might make for a more natural home for, e.g., `euler()`.\n\nIndeed, that makes a lot of sense to me.  Similarly for all the other special functions where we end up composing with self in the last line.",
    "created_at": "2022-08-17T08:26:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483852",
    "user": "https://github.com/mantepse"
}
```

Replying to [comment:5 tscrim]:
> Replying to [comment:4 mantepse]:
> > Question: what do you mean with moving the construction of the underlying function to the `LazyLaurentSeriesRing`?
> 
> For each of these special functions, we first construct a series `f`. So I propose having, e.g., `L.sin()` return `f(z) = sin(z)` in the variable of that lazy Laurent series ring. This avoids a composition call. I feel like it might make for a more natural home for, e.g., `euler()`.

Indeed, that makes a lot of sense to me.  Similarly for all the other special functions where we end up composing with self in the last line.



---

archive/issue_comments_483853.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2022-08-22T07:55:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483853",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_483854.json:
```json
{
    "body": "Replying to [comment:6 mantepse]:\n> Replying to [comment:5 tscrim]:\n> > Replying to [comment:4 mantepse]:\n> > > Question: what do you mean with moving the construction of the underlying function to the `LazyLaurentSeriesRing`?\n> > \n> > For each of these special functions, we first construct a series `f`. So I propose having, e.g., `L.sin()` return `f(z) = sin(z)` in the variable of that lazy Laurent series ring. This avoids a composition call. I feel like it might make for a more natural home for, e.g., `euler()`.\n> \n> Indeed, that makes a lot of sense to me.  Similarly for all the other special functions where we end up composing with self in the last line.\n\nI did this just for the functions implemented on this ticket. Although I forgot to revert back my merge with #32324, but since that is positively reviewed, I am just adding it as a dependency (if you'll allow me to be lazy about it).",
    "created_at": "2022-08-22T07:56:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483854",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:6 mantepse]:
> Replying to [comment:5 tscrim]:
> > Replying to [comment:4 mantepse]:
> > > Question: what do you mean with moving the construction of the underlying function to the `LazyLaurentSeriesRing`?
> > 
> > For each of these special functions, we first construct a series `f`. So I propose having, e.g., `L.sin()` return `f(z) = sin(z)` in the variable of that lazy Laurent series ring. This avoids a composition call. I feel like it might make for a more natural home for, e.g., `euler()`.
> 
> Indeed, that makes a lot of sense to me.  Similarly for all the other special functions where we end up composing with self in the last line.

I did this just for the functions implemented on this ticket. Although I forgot to revert back my merge with #32324, but since that is positively reviewed, I am just adding it as a dependency (if you'll allow me to be lazy about it).



---

archive/issue_comments_483855.json:
```json
{
    "body": "No problem.  For #32367 I need a few more operations on lazy series, like reversion for `LazySymmetricFunctions`, \"functorial composition\", etc., see #34383.  However, I think I am making progress.\n\nDo you prefer to get `LazyTaylorSeries` into sage, and rename it to `LazyPowerSeries` later?  I would need more time (and possibly a zoom call) to be able to get rid of `LazyPowerSeries` right now.",
    "created_at": "2022-08-22T08:07:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483855",
    "user": "https://github.com/mantepse"
}
```

No problem.  For #32367 I need a few more operations on lazy series, like reversion for `LazySymmetricFunctions`, "functorial composition", etc., see #34383.  However, I think I am making progress.

Do you prefer to get `LazyTaylorSeries` into sage, and rename it to `LazyPowerSeries` later?  I would need more time (and possibly a zoom call) to be able to get rid of `LazyPowerSeries` right now.



---

archive/issue_comments_483856.json:
```json
{
    "body": "Replying to [comment:9 mantepse]:\n> No problem.  For #32367 I need a few more operations on lazy series, like reversion for `LazySymmetricFunctions`, \"functorial composition\", etc., see #34383.  However, I think I am making progress.\n\nThat's good to hear. Let me know if I can help.\n\n> Do you prefer to get `LazyTaylorSeries` into sage, and rename it to `LazyPowerSeries` later?  I would need more time (and possibly a zoom call) to be able to get rid of `LazyPowerSeries` right now.\n\nYes. I think it would be good to have that functionality available and get people to start using it.\n\nSend me an email if you want to do a Zoom call too.",
    "created_at": "2022-08-22T08:27:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483856",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:9 mantepse]:
> No problem.  For #32367 I need a few more operations on lazy series, like reversion for `LazySymmetricFunctions`, "functorial composition", etc., see #34383.  However, I think I am making progress.

That's good to hear. Let me know if I can help.

> Do you prefer to get `LazyTaylorSeries` into sage, and rename it to `LazyPowerSeries` later?  I would need more time (and possibly a zoom call) to be able to get rid of `LazyPowerSeries` right now.

Yes. I think it would be good to have that functionality available and get people to start using it.

Send me an email if you want to do a Zoom call too.



---

archive/issue_comments_483857.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-29T01:08:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483857",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_483858.json:
```json
{
    "body": "Bot was green modulo the pyflakes issues, which I have just pushed. I have also tested this locally post change.",
    "created_at": "2022-08-29T01:08:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483858",
    "user": "https://github.com/tscrim"
}
```

Bot was green modulo the pyflakes issues, which I have just pushed. I have also tested this locally post change.



---

archive/issue_comments_483859.json:
```json
{
    "body": "Changing keywords from \"q_pochhammer, euler function\" to \"q_pochhammer, euler function, LazyPowerSeries\".",
    "created_at": "2022-09-15T19:01:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483859",
    "user": "https://github.com/mantepse"
}
```

Changing keywords from "q_pochhammer, euler function" to "q_pochhammer, euler function, LazyPowerSeries".



---

archive/issue_comments_483860.json:
```json
{
    "body": "I am a bit unhappy about the amount of (documentation) duplication, especially, since it would be nice to do this for all the \"special\" functions.",
    "created_at": "2022-09-15T19:37:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483860",
    "user": "https://github.com/mantepse"
}
```

I am a bit unhappy about the amount of (documentation) duplication, especially, since it would be nice to do this for all the "special" functions.



---

archive/issue_comments_483861.json:
```json
{
    "body": "Unfortunately that is not possible. Note that they are actually different functions with different doctests. We can make a link, but we cannot do any duplication.",
    "created_at": "2022-09-15T23:58:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483861",
    "user": "https://github.com/tscrim"
}
```

Unfortunately that is not possible. Note that they are actually different functions with different doctests. We can make a link, but we cannot do any duplication.



---

archive/issue_comments_483862.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-22T07:37:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483862",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_483863.json:
```json
{
    "body": "One tiny thing: I think that we should be explicit that the function passed should be interpreted as coefficients:\n\n```\nsage: L.<q> = LazyLaurentSeriesRing(ZZ)\nsage: phi = q.euler()\nsage: phi\n1 - q - q^2 + q^5 + O(q^7)\nsage: L.<q> = LazyLaurentSeriesRing(LazyDirichletSeriesRing(QQ, \"s\"))\nsage: phi = q.euler()\nsage: phi\n(-1 - 1/(2^s) + 1/(5^s) + 1/(7^s) + O(1/(8^s)))\n```\n\n\n\n```diff\ndiff --git a/src/sage/rings/lazy_series_ring.py b/src/sage/rings/lazy_series_ring.py\nindex b7b1953f52f..51e2b1c365f 100644\n--- a/src/sage/rings/lazy_series_ring.py\n+++ b/src/sage/rings/lazy_series_ring.py\n@@ -1550,7 +1550,7 @@ class LazyLaurentSeriesRing(LazySeriesRing):\n         one = qP.one()\n         def coeff(n):\n             return (-1)**n * q**binomial(n, 2) / qP.prod(one - q**i for i in range(1, n+1))\n-        return self(coeff, valuation=0)\n+        return self(coefficients=coeff, valuation=0)\n \n     def euler(self):\n         r\"\"\"\n@@ -1588,7 +1588,7 @@ class LazyLaurentSeriesRing(LazySeriesRing):\n             if rem:\n                 return ZZ.zero()\n             return (-1) ** ((m + 1) // 6)\n-        return self(coeff, valuation=0)\n+        return self(coefficients=coeff, valuation=0)\n ######################################################################\n```\n\n\nIf this looks OK to you, let's go (with a big \"thank you\" for reviewing all the other issues, and being careful with #15248, etc.)!",
    "created_at": "2022-10-22T08:07:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483863",
    "user": "https://github.com/mantepse"
}
```

One tiny thing: I think that we should be explicit that the function passed should be interpreted as coefficients:

```
sage: L.<q> = LazyLaurentSeriesRing(ZZ)
sage: phi = q.euler()
sage: phi
1 - q - q^2 + q^5 + O(q^7)
sage: L.<q> = LazyLaurentSeriesRing(LazyDirichletSeriesRing(QQ, "s"))
sage: phi = q.euler()
sage: phi
(-1 - 1/(2^s) + 1/(5^s) + 1/(7^s) + O(1/(8^s)))
```



```diff
diff --git a/src/sage/rings/lazy_series_ring.py b/src/sage/rings/lazy_series_ring.py
index b7b1953f52f..51e2b1c365f 100644
--- a/src/sage/rings/lazy_series_ring.py
+++ b/src/sage/rings/lazy_series_ring.py
@@ -1550,7 +1550,7 @@ class LazyLaurentSeriesRing(LazySeriesRing):
         one = qP.one()
         def coeff(n):
             return (-1)**n * q**binomial(n, 2) / qP.prod(one - q**i for i in range(1, n+1))
-        return self(coeff, valuation=0)
+        return self(coefficients=coeff, valuation=0)
 
     def euler(self):
         r"""
@@ -1588,7 +1588,7 @@ class LazyLaurentSeriesRing(LazySeriesRing):
             if rem:
                 return ZZ.zero()
             return (-1) ** ((m + 1) // 6)
-        return self(coeff, valuation=0)
+        return self(coefficients=coeff, valuation=0)
 ######################################################################
```


If this looks OK to you, let's go (with a big "thank you" for reviewing all the other issues, and being careful with #15248, etc.)!



---

archive/issue_comments_483864.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-10-24T08:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483864",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_483865.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-28T07:04:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483865",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_483866.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-10-28T07:05:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483866",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_483867.json:
```json
{
    "body": "Good catch. Thank you.\n\n(No problem. Sorry I haven't been able to work so much on the other tickets, but I right now have a bit of time at least.)",
    "created_at": "2022-10-28T07:05:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483867",
    "user": "https://github.com/tscrim"
}
```

Good catch. Thank you.

(No problem. Sorry I haven't been able to work so much on the other tickets, but I right now have a bit of time at least.)



---

archive/issue_comments_483868.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-10-28T10:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483868",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_483869.json:
```json
{
    "body": "Thank you.",
    "created_at": "2022-10-29T08:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483869",
    "user": "https://github.com/tscrim"
}
```

Thank you.



---

archive/issue_events_030724.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2022-11-07T20:26:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34144#event-30724"
}
```



---

archive/issue_comments_483870.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-11-07T20:26:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34144#issuecomment-483870",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
