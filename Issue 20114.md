# Issue 20114: sage.libs.ppl.MIP_Problem and PPLBackend: Add support for integer variables

Issue created by migration from https://trac.sagemath.org/ticket/20351

Original creator: mkoeppe

Original creation time: 2016-04-03 16:13:17

CC:  dimpase vdelecroix jdemeyer

Keywords: lp

PPL is a rational MIP solver. 
Its support for integer variables should be exposed in Sage.


---

Comment by dimpase created at 2016-04-03 17:12:10

Good catch! I wish I knew this when I still had the student, who wrote the Cython bindings for the ppl LP, around. (He is now at Facebook...)


---

Comment by mkoeppe created at 2016-04-03 17:28:54

Replying to [comment:2 dimpase]:
> Good catch! I wish I knew this when I still had the student, who wrote the Cython bindings for the ppl LP, around. (He is now at Facebook...)

I'll write it if you review my other tickets ;)


---

Comment by git created at 2016-04-04 07:25:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2016-04-04 07:27:20

Changing status from new to needs_review.


---

Comment by dimpase created at 2016-04-04 09:55:36

Are indices of variables 0-based, 1-based?
Could this info be added to docs?


---

Comment by dimpase created at 2016-04-04 10:27:26

Can one use this to generate integer hull of a polytope defined by inequalities (perhaps after adjusting the corresponding Polyhedron code)?
Or is this optimisation-only thing?


---

Comment by mkoeppe created at 2016-04-04 18:59:12

> Are indices of variables 0-based, 1-based?
> Could this info be added to docs?

This is already documented in the class docstring of `Variable`. (It's 0-based.)

> Can one use this to generate integer hull of a polytope defined by inequalities (perhaps after adjusting the corresponding Polyhedron code)?
> Or is this optimisation-only thing?

No, PPL does not have code for computing integer hulls. 
The closest that there is in the polyhedron code is the following interesting function:


```
void Parma_Polyhedra_Library::Polyhedron::drop_some_non_integer_points(Complexity_Class complexity = ANY_COMPLEXITY)	
Possibly tightens *this by dropping some points with non-integer coordinates.
```


I would be quite interested in having code in Sage that computes a polyhedron given only by a linear optimization oracle [for example, implemented by a MIP solver], see for example http://arxiv.org/pdf/1412.3987.pdf. But this has nothing to do with this ticket.


---

Comment by dimpase created at 2016-04-04 19:50:50

IMHO in `add_to_integer_space_dimensions` one should have `sig_on()` inside `try:` block, not outside. And `sig_off()` should be immediately after the call to the backend.

see [catch_interrupts()](http://www.sagemath.org/git-developer-guide/coding_in_cython.html)


---

Comment by mkoeppe created at 2016-04-05 05:14:29

The code in `add_to_integer_space_dimensions` matches the last example in the documentation that you cited. I'm assuming it's correct. Besides, it was copy-paste from elsewhere in ppl.pyx. 

```
Alternatively, you can use try/finally which will also catch exceptions raised by subroutines inside the try:

def try_finally_example():
    sig_on()
    try:
        # (some long computation, potentially raising exceptions)
    finally:
        sig_off()
    return something
```



---

Comment by dimpase created at 2016-04-05 08:16:30

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2016-04-05 08:16:30

OK, good. Although I am a bit concerned about few `def` statements that could be `cdef` or `cpdef`, for efficiency reasons.


---

Comment by vbraun created at 2016-04-05 16:41:18

Resolution: fixed
