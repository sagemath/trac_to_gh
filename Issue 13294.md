# Issue 13294: 4ti2 fails to build on Debian wheezy

Issue created by migration from https://trac.sagemath.org/ticket/13498

Original creator: novoselt

Original creation time: 2012-09-17 01:52:05

Assignee: tbd

CC:  mhampton dperkinson

Log attached.


---

Attachment


---

Comment by leif created at 2013-04-21 16:36:20

Changing keywords from "" to "-fpermissive C++11".


---

Comment by leif created at 2013-04-21 16:38:09

Changing keywords from "-fpermissive C++11" to "-fpermissive C++11 spkg".


---

Comment by leif created at 2013-04-21 17:06:14

Unfortunately, just adding `-fpermissive` is not sufficient:

```
RaySupportAlgorithm.tpp:792:44: error: no matching function for call to ‘sort(_4ti2_::VectorArray&, std::vector<_4ti2_::ShortDenseIndexSet, std::allocator<_4ti2_::ShortDenseIndexSet> >&, _4ti2_::Index&, int&, int&, int&)’
RaySupportAlgorithm.tpp:792:44: error: no matching function for call to ‘sort(_4ti2_::VectorArray&, std::vector<_4ti2_::LongDenseIndexSet, std::allocator<_4ti2_::LongDenseIndexSet> >&, _4ti2_::Index&, int&, int&, int&)’
RayMatrixAlgorithm.tpp:884:44: error: no matching function for call to ‘sort(_4ti2_::VectorArray&, std::vector<_4ti2_::ShortDenseIndexSet, std::allocator<_4ti2_::ShortDenseIndexSet> >&, _4ti2_::Index&, int&, int&, int&)’
RayMatrixAlgorithm.tpp:884:44: error: no matching function for call to ‘sort(_4ti2_::VectorArray&, std::vector<_4ti2_::LongDenseIndexSet, std::allocator<_4ti2_::LongDenseIndexSet> >&, _4ti2_::Index&, int&, int&, int&)’
```



---

Comment by leif created at 2013-04-21 19:36:11

Replying to [comment:4 leif]:
> Unfortunately, just adding `-fpermissive` is not sufficient:
> {{{
> RaySupportAlgorithm.tpp:792:44: error: no matching function for call to ‘sort(_4ti2_::VectorArray&, std::vector<_4ti2_::ShortDenseIndexSet, std::allocator<_4ti2_::ShortDenseIndexSet> >&, _4ti2_::Index&, int&, int&, int&)’
> RaySupportAlgorithm.tpp:792:44: error: no matching function for call to ‘sort(_4ti2_::VectorArray&, std::vector<_4ti2_::LongDenseIndexSet, std::allocator<_4ti2_::LongDenseIndexSet> >&, _4ti2_::Index&, int&, int&, int&)’
> RayMatrixAlgorithm.tpp:884:44: error: no matching function for call to ‘sort(_4ti2_::VectorArray&, std::vector<_4ti2_::ShortDenseIndexSet, std::allocator<_4ti2_::ShortDenseIndexSet> >&, _4ti2_::Index&, int&, int&, int&)’
> RayMatrixAlgorithm.tpp:884:44: error: no matching function for call to ‘sort(_4ti2_::VectorArray&, std::vector<_4ti2_::LongDenseIndexSet, std::allocator<_4ti2_::LongDenseIndexSet> >&, _4ti2_::Index&, int&, int&, int&)’
> }}}

Using `RayImplementation<IndexSet>::sort` there solves these for me (GCC 4.8.0).


---

Comment by leif created at 2013-04-21 19:47:24

Note that also the doctests are broken with the new doctesting framework (in Sage 5.9.*).


---

Comment by leif created at 2013-04-23 15:02:05

Replying to [comment:8 leif]:
> Note that also the doctests are broken with the new doctesting framework (in Sage 5.9.*).

P.S.:  I.e., some are of the form

```

Failed example:
    four_ti_2.graver([1,2,3]) # optional - 4ti2
Expected:
    [ 2 -1  0]
    [ 3  0 -1]
    [ 1  1 -1]
    [ 1 -2  1]
    [ 0  3 -2]
Got:
    -------------------------------------------------
    4ti2 version 1.3.2, Copyright (C) 2006 4ti2 team.
    4ti2 comes with ABSOLUTELY NO WARRANTY.
    This is free software, and you are welcome
    to redistribute it under certain conditions.
    For details, see the file COPYING.
    -------------------------------------------------
    <BLANKLINE>
    Linear integer system to solve:
    <BLANKLINE>
    + + + 
    - - - 
    <BLANKLINE>
    1 2 3 = 0
    <BLANKLINE>
    Linear integer system of homogeneous equalities to solve:
    <BLANKLINE>
    + + + 
    - - - 
    <BLANKLINE>
    1 2 3 = 0
    <BLANKLINE>
    <BLANKLINE>
    Appending variable 1... Solutions: 4, Step: 0.00 secs, Time: 0.00 secs
    Appending variable 2... Solutions: 4, Step: 0.00 secs, Time: 0.00 secs
    Appending variable 3... Solutions: 10, Step: 0.00 secs, Time: 0.00 secs
    <BLANKLINE>
    Final basis has 1 inhomogeneous, 10 homogeneous and 0 free elements.
    Writing 5 vectors to graver file, with respect to symmetry.
    <BLANKLINE>
    4ti2 Total Time: 0.00 secs
    [ 2 -1  0]
    [ 3  0 -1]
    [ 1  1 -1]
    [ 1 -2  1]
    [ 0  3 -2]
```

(because 4ti2's output to `stderr` is part of `Got:` now as well).




Not sure why one meanwhile gets

```
checking for GMP >= 3.1.1... configure: WARNING: GNU MP not found.
4ti2 will be built without support for arbitrary-precision computations.
configure: WARNING: Unable to use the GNU MP C++ library.
Please make sure that GNU MP was configured with "--enable-cxx".
4ti2 will be built without support for arbitrary-precision computations.
```

such that `4ti2gmp` doesn't get built (also leading to failing doctests).


---

Comment by leif created at 2013-04-23 15:06:57

Replying to [comment:9 leif]:
> Not sure why one meanwhile gets
> {{{
> checking for GMP >= 3.1.1... configure: WARNING: GNU MP not found.
> 4ti2 will be built without support for arbitrary-precision computations.
> configure: WARNING: Unable to use the GNU MP C++ library.
> Please make sure that GNU MP was configured with "--enable-cxx".
> 4ti2 will be built without support for arbitrary-precision computations.
> }}}
> such that `4ti2gmp` doesn't get built (also leading to failing doctests).

Ok, this is due to

```
g++-4.8.0: error: unrecognized command line option '-R'
```

in the `configure` tests.


---

Comment by leif created at 2013-04-28 15:34:33

Replying to [ticket:13498 dimpase]:
> From sage-devel (April 2013):
> {{{
> 4ti2 version 1.5 quietly lives in http://www.math.ucdavis.edu/~latte/software/latte-integrale-1.5.3.tar.gz
> on http://www.math.ucdavis.edu/~latte/software.php 
> 
> That version 1.5 still does not work on OSX, but at least it works on Linux, as far as I recall.
> }}}

Do you mean it doesn't build with Apple's GCC 4.2.1?

Works for me if I "fix" (or bypass) the pretty useless `configure` test for `cstdint`, or e.g. use Sage's GCC 4.6.3 instead, on MacOS X 10.6.8 at least.


---

Comment by dimpase created at 2013-05-19 13:28:16

Replying to [comment:13 leif]:
> Replying to [ticket:13498 dimpase]:
> > From sage-devel (April 2013):
> > {{{
> > 4ti2 version 1.5 quietly lives in http://www.math.ucdavis.edu/~latte/software/latte-integrale-1.5.3.tar.gz
> > on http://www.math.ucdavis.edu/~latte/software.php 
> > 
> > That version 1.5 still does not work on OSX, but at least it works on Linux, as far as I recall.
> > }}}
> 
> Do you mean it doesn't build with Apple's GCC 4.2.1?
> 
> Works for me if I "fix" (or bypass) the pretty useless `configure` test for `cstdint`, or e.g. use Sage's GCC 4.6.3 instead, on MacOS X 10.6.8 at least.

Please see https://groups.google.com/d/msg/sage-combinat-devel/h24CbBjXp6o/P-y5zIgou7oJ

Perhaps someone can update the 4ti2 optional spkg, at last?


---

Comment by leif created at 2013-05-19 16:49:07

Replying to [comment:14 dimpase]:
> Replying to [comment:13 leif]:
> > Replying to [ticket:13498 dimpase]:
> > > That version 1.5 still does not work on OSX, but at least it works on Linux, as far as I recall.
> > 
> > Do you mean it doesn't build with Apple's GCC 4.2.1?
> > 
> > Works for me if I "fix" (or bypass) the pretty useless `configure` test for `cstdint`, or e.g. use Sage's GCC 4.6.3 instead, on MacOS X 10.6.8 at least.
> 
> Please see https://groups.google.com/d/msg/sage-combinat-devel/h24CbBjXp6o/P-y5zIgou7oJ

William's post doesn't mention MacOS X at all...

(And I've already noted that `4ti2gmp` currently doesn't get built because 4ti2 doesn't detect GMP/MPIR properly, IIRC just some `configure` flaw as well.  I think LattE ships with some dead old version of GMP, which in turn won't build with contemporary versions of GCC either.)



 
> Perhaps someone can update the 4ti2 optional spkg, at last?

I could give it a try (again); that's why I was asking what the alleged problems with MacOS X were ... ;-)


---

Comment by dimpase created at 2013-05-19 17:03:52

Replying to [comment:15 leif]:
> > Perhaps someone can update the 4ti2 optional spkg, at last?
> 
> I could give it a try (again); that's why I was asking what the alleged problems with MacOS X were ... ;-)

I think I tried last time in Sept 2012, within Sage shell, i.e. running (probably?) a better gcc than shipped by Apple.

Anyhow, I am willing to test on OSX, but I don't have time to do packaging.


---

Comment by leif created at 2013-05-19 17:11:56

Replying to [comment:14 dimpase]:
> Please see https://groups.google.com/d/msg/sage-combinat-devel/h24CbBjXp6o/P-y5zIgou7oJ

(Alternatively, since Google "forums" suck: [http://groups.google.com/group/sage-combinat-devel/browse_thread/thread/876e026c18d7a7aa](http://groups.google.com/group/sage-combinat-devel/browse_thread/thread/876e026c18d7a7aa))

Just for reference, citing William:

> Somebody has revived the project at github: [https://github.com/tom111/4ti2](https://github.com/tom111/4ti2) 
> However, this has no `./configure` file, so when I do "automake", then 
> `./configure`, I get:
> {{{
> salvus`@`compute2a:/usr/local/sage/sage-5.10.beta3/tmp/4ti2$ ./configure 
> ./configure: line 1818: syntax error near unexpected token `foreign' 
> ./configure: line 1818: `AM_INIT_AUTOMAKE(foreign)' 
> }}}
That's presumably just due to using too "new" autotools...


---

Comment by mmarco created at 2013-07-01 12:02:54

I could compile it without complaining, but it didn't build the 4ti2gmp binary. The reason for that is that the configure script didn't find GMP.


---

Comment by leif created at 2013-07-01 12:42:58

Replying to [comment:18 mmarco]:
> I could compile it without complaining,

with an older version of GCC I guess.




> but it didn't build the 4ti2gmp binary. The reason for that is that the configure script didn't find GMP.

That's presumably because of the error mentioned [comment:10 above].  (If you keep the spkg build dir, you could take a look at `.../src/config.log`).


---

Comment by mmarco created at 2013-07-01 12:51:12

Yes, you are absolutely right. I have gcc-4.6.3 on my system. But i thought that sage would use its own gcc version.


---

Comment by chapoton created at 2013-07-18 13:27:44

Changing keywords from "-fpermissive C++11 spkg" to "-fpermissive C++11 spkg 4ti2".


---

Comment by dimpase created at 2013-09-07 03:15:52

4ti2 1.6 has been [released ](http://4ti2.de/). As a standalone it builds on (most) Sage platforms. I'll give it a shot, with the aim to update the 4ti2 spkg.


---

Comment by dimpase created at 2013-09-07 13:37:30

Replying to [comment:23 dimpase]:
> 4ti2 1.6 has been [released ](http://4ti2.de/). As a standalone it builds on (most) Sage platforms. I'll give it a shot, with the aim to update the 4ti2 spkg.

The ticket to update to 1.6 is #15172.


---

Comment by dimpase created at 2013-12-25 04:42:28

Changing status from new to needs_review.


---

Comment by dimpase created at 2013-12-25 04:44:34

This is fixed by 4ti2 update.


---

Comment by dimpase created at 2013-12-25 04:44:34

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2013-12-25 13:08:12

Resolution: fixed
