# Issue 16142: Compute Hasse invariant over number fields and fix current implementation

archive/issues_016142.json:
```json
{
    "body": "This patch will enhance the current functions hasse_invariant and hasse_invariant_OMeara to include computations of Hasse invariant for quadratic forms over number fields.  In addition, this patch fixes an indexing error in the original hasse_invariant_OMeara code, which currently reads\n\n```\nfor j in range(n-1):\n    for k in range(j, n):\n```\n\nbut should read \n\n```\nfor j in range(n):\n    for k in range(j, n):\n```\n\nto be consistent with OMeara's algorithm. \n\nIssue created by migration from https://trac.sagemath.org/ticket/16379\n\n",
    "created_at": "2014-05-20T09:25:46Z",
    "labels": [
        "quadratic forms",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Compute Hasse invariant over number fields and fix current implementation",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16142",
    "user": "@annahaensch"
}
```
This patch will enhance the current functions hasse_invariant and hasse_invariant_OMeara to include computations of Hasse invariant for quadratic forms over number fields.  In addition, this patch fixes an indexing error in the original hasse_invariant_OMeara code, which currently reads

```
for j in range(n-1):
    for k in range(j, n):
```

but should read 

```
for j in range(n):
    for k in range(j, n):
```

to be consistent with OMeara's algorithm. 

Issue created by migration from https://trac.sagemath.org/ticket/16379





---

archive/issue_comments_210751.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-21T09:33:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16142#issuecomment-210751",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_210752.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-05-21T09:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16142#issuecomment-210752",
    "user": "@annahaensch"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_210753.json:
```json
{
    "body": "Looks good to me except for two minor points:\n- it is best to keep existing doctests as far as possible; only add new ones, and fix old ones if necessary instead of replacing them;\n- your patch introduces trailing whitespace on several lines (use e.g. `git diff --color develop...YOURBRANCH` to see this); this is discouraged, so could you remove it if and when you make another commit?\n(The patchbot encountered a doctest failure on 6.3.beta1, but it seems to be unrelated to your patch.)",
    "created_at": "2014-05-23T10:03:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16142#issuecomment-210753",
    "user": "@pjbruin"
}
```

Looks good to me except for two minor points:
- it is best to keep existing doctests as far as possible; only add new ones, and fix old ones if necessary instead of replacing them;
- your patch introduces trailing whitespace on several lines (use e.g. `git diff --color develop...YOURBRANCH` to see this); this is discouraged, so could you remove it if and when you make another commit?
(The patchbot encountered a doctest failure on 6.3.beta1, but it seems to be unrelated to your patch.)



---

archive/issue_comments_210754.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-23T11:48:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16142#issuecomment-210754",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_210755.json:
```json
{
    "body": "Coming back to this point:\n> - it is best to keep existing doctests as far as possible; only add new ones, and fix old ones if necessary instead of replacing them;\nI now see that there were two identical doctests (with `DiagonalQuadraticForm(ZZ, [1, -1, -1])`) and you changed `[1, -1, -1]` to `[1, -1, 5]` in both of them.  Could you change one of them back to `[1, -1, -1]`?  Then we get both your new doctest and the old one, instead of duplicates.",
    "created_at": "2014-05-23T12:53:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16142#issuecomment-210755",
    "user": "@pjbruin"
}
```

Coming back to this point:
> - it is best to keep existing doctests as far as possible; only add new ones, and fix old ones if necessary instead of replacing them;
I now see that there were two identical doctests (with `DiagonalQuadraticForm(ZZ, [1, -1, -1])`) and you changed `[1, -1, -1]` to `[1, -1, 5]` in both of them.  Could you change one of them back to `[1, -1, -1]`?  Then we get both your new doctest and the old one, instead of duplicates.



---

archive/issue_comments_210756.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-23T13:45:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16142#issuecomment-210756",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_210757.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-23T13:49:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16142#issuecomment-210757",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_210758.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-05-23T14:28:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16142#issuecomment-210758",
    "user": "@pjbruin"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_210759.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-05-25T10:09:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16142#issuecomment-210759",
    "user": "@vbraun"
}
```

Resolution: fixed
