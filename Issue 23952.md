# Issue 23952: Python 2 libpython symlink not created correctly on Cygwin

Issue created by migration from https://trac.sagemath.org/ticket/24189

Original creator: embray

Original creation time: 2017-11-10 13:52:26

CC:  charpent

#23781 introduced a regression that the symlink from `lib/python2.7/config/libpython2.7.dll.a` to `lib/libpython2.7.dll.a` is not created properly.

On Python 3 this "config" directory name is formatted "config-<PYTHON_LDVERSION>" whereas on Python 2 it should be just "config".

This prevents extension modules from linking to the correct libpython2.7 on Cygwin.


---

Comment by embray created at 2017-11-10 13:52:50

I have a patch for this already--I'm just testing to make sure it works.


---

Comment by embray created at 2017-11-10 18:22:15

Changing keywords from "" to "windows cygwin python2".


---

Comment by embray created at 2017-11-10 18:22:15

Changing status from new to needs_review.


---

Comment by embray created at 2017-11-10 18:22:15

New commits:


---

Comment by charpent created at 2017-11-10 22:17:05

On Windos 10 + "Fall Creators Update", sage8.0.rc0+#24121+#24189, cython compiles.

However, Sage does not compile : fpylll fails to build (consistently). See enclosed log.


---

Comment by charpent created at 2017-11-10 22:18:08

failure to build fpyll.


---

Attachment

Is your fpylll build fixed by #24191?


---

Comment by charpent created at 2017-11-11 13:07:02

Changing status from needs_review to positive_review.


---

Comment by charpent created at 2017-11-11 13:07:02

Replying to [comment:4 tscrim]:
> Is your fpylll build fixed by #24191?

Yes and no : fpylll compiles, but Sage does not build. I get an error at Sagelib's compilation :

```
[sagelib-8.1.rc0] gcc -I/usr/include/ncurses -fno-strict-aliasing -g -O2 -DNDEBU
G -g -fwrapv -O3 -Wall -Wno-unused -I/home/charpent/sage/local/lib/python2.7/sit
e-packages/cysignals -I/home/charpent/sage/local/include -I/home/charpent/sage/l
ocal/include/python2.7 -I/home/charpent/sage/local/lib/python2.7/site-packages/n
umpy/core/include -I/home/charpent/sage/src -I/home/charpent/sage/src/sage/ext -
Ibuild/cythonized -I/home/charpent/sage/local/include/python2.7 -c build/cythoni
zed/sage/graphs/graph_decompositions/fast_digraph.c -o build/temp.cygwin-2.9.0-x
86_64-2.7/build/cythonized/sage/graphs/graph_decompositions/fast_digraph.o -fno-
strict-aliasing -DCYTHON_CLINE_IN_TRACEBACK=1 -std=c99
[sagelib-8.1.rc0] error: command 'gcc' failed with exit status 1
[sagelib-8.1.rc0] make[3]: *** [Makefile:33: sage] Error 1
[sagelib-8.1.rc0] make[3] : on quitte le répertoire « /home/charpent/sage/src »
```


I //think// I'm bitten by #24192, which I'll try next. But, as far as I understand, that implies restarting with `make distclean`. That will be long.

`positive review` on this ticket as well as for #24197, which turns out to be a buplicate.


---

Comment by embray created at 2017-11-11 13:18:20

I don't think you need to do a `make distclean` but it will require rebuilding all of the sage library at least.


---

Comment by vbraun created at 2017-11-15 01:24:22

Resolution: fixed
