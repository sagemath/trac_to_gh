# Issue 28977: apply_map fails for sparse zero matrix

Issue created by migration from https://trac.sagemath.org/ticket/29214

Original creator: @mwageringel

Original creation time: 2020-02-18 13:25:26

If a sparse matrix does not contain any non-zero entries, `apply_map` fails to determine the base ring of the result:

```
sage: matrix(RR, 2, 2, sparse=True).apply_map(abs)
...
TypeError: base_ring (=Category of objects) must be a ring
```

This causes problems when computing matrix norms, for example:

```
sage: matrix(CDF, 2, 2, sparse=True).norm(1)
...
TypeError: base_ring (=Category of objects) must be a ring
```

This is solved by determining the base ring from the image of the zero entries.



---

Comment by @mwageringel created at 2020-02-18 13:30:01

New commits:


---

Comment by @mwageringel created at 2020-02-18 13:30:01

Changing status from new to needs_review.


---

Comment by tscrim created at 2020-02-19 00:16:38

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2020-02-19 00:16:38

LGTM.


---

Comment by vbraun created at 2020-02-21 22:17:19

Resolution: fixed
