# Issue 31778: _sympy_ methods for Set_object_binary subclasses

archive/issues_031778.json:
```json
{
    "body": "CC:  @tscrim @kcrisman @egourgoulhon\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/32015\n\n",
    "created_at": "2021-06-20T20:34:13Z",
    "labels": [
        "interfaces",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "_sympy_ methods for Set_object_binary subclasses",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31778",
    "user": "@mkoeppe"
}
```
CC:  @tscrim @kcrisman @egourgoulhon



Issue created by migration from https://trac.sagemath.org/ticket/32015





---

archive/issue_comments_454091.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-06-21T21:02:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454091",
    "user": "@mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_454092.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2021-06-21T21:02:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454092",
    "user": "@mkoeppe"
}
```

Last 10 new commits:



---

archive/issue_comments_454093.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-01T22:50:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454093",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_454094.json:
```json
{
    "body": "I am not sure about caching the output of `_sympy_`? It creates a clone of the set and ties it to the Sage object. Can you give some reasoning for this?",
    "created_at": "2021-07-02T05:57:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454094",
    "user": "@tscrim"
}
```

I am not sure about caching the output of `_sympy_`? It creates a clone of the set and ties it to the Sage object. Can you give some reasoning for this?



---

archive/issue_comments_454095.json:
```json
{
    "body": "If one makes one computation with the sympy version of a set, it's likely that another computation will be made -- so saving the result seemed a good idea.",
    "created_at": "2021-07-02T06:07:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454095",
    "user": "@mkoeppe"
}
```

If one makes one computation with the sympy version of a set, it's likely that another computation will be made -- so saving the result seemed a good idea.



---

archive/issue_comments_454096.json:
```json
{
    "body": "I would expect someone to store said Sympy version if they were going to use it again. Granted, I expect this to not be a problem either way. My instinct is to err on the side of not caching, but I don't have a strong opinion on this. So you either change it or not; once decided, you can set a positive review.",
    "created_at": "2021-07-02T06:58:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454096",
    "user": "@tscrim"
}
```

I would expect someone to store said Sympy version if they were going to use it again. Granted, I expect this to not be a problem either way. My instinct is to err on the side of not caching, but I don't have a strong opinion on this. So you either change it or not; once decided, you can set a positive review.



---

archive/issue_comments_454097.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-07-02T07:01:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454097",
    "user": "@mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_454098.json:
```json
{
    "body": "Thanks! I'm keeping it as is.",
    "created_at": "2021-07-02T07:01:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454098",
    "user": "@mkoeppe"
}
```

Thanks! I'm keeping it as is.



---

archive/issue_comments_454099.json:
```json
{
    "body": "\n```\n[docpdf] \n[docpdf] Overfull \\hbox (22.51231p\n[docpdf] ! Missing { inserted.\n[docpdf] <to be read again> \n[docpdf]                    _\n[docpdf] l.1488 ...n{}in class providing the operators \\(__\n[docpdf]                                                   add__\\) and \\(__sub__\\).\n[docpdf] ? \n[docpdf] [809\n[docpdf] ! Emergency stop.\n[docpdf] <to be read again> \n[docpdf]                    _\n[docpdf] l.1488 ...n{}in class providing the operators \\(__\n[docpdf]                                                   add__\\) and \\(__sub__\\).\n[docpdf] !  ==> Fatal error occurred, no output PDF file produced!\n```\n",
    "created_at": "2021-07-08T21:14:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454099",
    "user": "@vbraun"
}
```


```
[docpdf] 
[docpdf] Overfull \hbox (22.51231p
[docpdf] ! Missing { inserted.
[docpdf] <to be read again> 
[docpdf]                    _
[docpdf] l.1488 ...n{}in class providing the operators \(__
[docpdf]                                                   add__\) and \(__sub__\).
[docpdf] ? 
[docpdf] [809
[docpdf] ! Emergency stop.
[docpdf] <to be read again> 
[docpdf]                    _
[docpdf] l.1488 ...n{}in class providing the operators \(__
[docpdf]                                                   add__\) and \(__sub__\).
[docpdf] !  ==> Fatal error occurred, no output PDF file produced!
```




---

archive/issue_comments_454100.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-07-08T21:14:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454100",
    "user": "@vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_454101.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-08T21:39:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454101",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_454102.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2021-07-08T21:39:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454102",
    "user": "@mkoeppe"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_454103.json:
```json
{
    "body": "Tests fail",
    "created_at": "2021-07-09T23:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454103",
    "user": "@vbraun"
}
```

Tests fail



---

archive/issue_comments_454104.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-07-09T23:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454104",
    "user": "@vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_454105.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-09T23:33:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454105",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_454106.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-09T23:38:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454106",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_454107.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-07-09T23:39:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454107",
    "user": "@mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_454108.json:
```json
{
    "body": "LGTM.",
    "created_at": "2021-07-10T03:45:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454108",
    "user": "@tscrim"
}
```

LGTM.



---

archive/issue_comments_454109.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-07-10T03:45:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454109",
    "user": "@tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_454110.json:
```json
{
    "body": "\n```\nFile \"src/sage/categories/sets_cat.py\", line 1720, in sage.categories.sets_cat.Sets.ParentMethods._sympy_\nFailed example:\n    sF = F._sympy_(); sF\nExpected:\n    SageSet({1, 2})\nGot:\n    Set(1, 2)\n```\n\n\nand\n\n\n```\nFile \"src/sage/categories/sets_cat.py\", line 1722, in sage.categories.sets_cat.Sets.ParentMethods._sympy_\nFailed example:\n    sF._sage_() is F\nException raised:\n    Traceback (most recent call last):\n      File \"/data/pell/lipnik/patchbot/local/lib/python3.9/site-packages/sage/doctest/forker.py\", line 718, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/data/pell/lipnik/patchbot/local/lib/python3.9/site-packages/sage/doctest/forker.py\", line 1137, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.categories.sets_cat.Sets.ParentMethods._sympy_[12]>\", line 1, in <module>\n        sF._sage_() is F\n    AttributeError: 'Set' object has no attribute '_sage_'\n```\n",
    "created_at": "2021-07-13T00:32:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454110",
    "user": "@mjungmath"
}
```


```
File "src/sage/categories/sets_cat.py", line 1720, in sage.categories.sets_cat.Sets.ParentMethods._sympy_
Failed example:
    sF = F._sympy_(); sF
Expected:
    SageSet({1, 2})
Got:
    Set(1, 2)
```


and


```
File "src/sage/categories/sets_cat.py", line 1722, in sage.categories.sets_cat.Sets.ParentMethods._sympy_
Failed example:
    sF._sage_() is F
Exception raised:
    Traceback (most recent call last):
      File "/data/pell/lipnik/patchbot/local/lib/python3.9/site-packages/sage/doctest/forker.py", line 718, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/data/pell/lipnik/patchbot/local/lib/python3.9/site-packages/sage/doctest/forker.py", line 1137, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.categories.sets_cat.Sets.ParentMethods._sympy_[12]>", line 1, in <module>
        sF._sage_() is F
    AttributeError: 'Set' object has no attribute '_sage_'
```




---

archive/issue_comments_454111.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-07-13T00:32:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454111",
    "user": "@mjungmath"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_454112.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-13T00:57:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454112",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_454113.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-07-13T00:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454113",
    "user": "@mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_454114.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-07-13T01:01:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454114",
    "user": "@tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_454115.json:
```json
{
    "body": "Thanks for catching that.",
    "created_at": "2021-07-13T01:01:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454115",
    "user": "@tscrim"
}
```

Thanks for catching that.



---

archive/issue_comments_454116.json:
```json
{
    "body": "\n```\nsage -t --random-seed=0 src/sage/categories/sets_cat.py\n    [478 tests, 0.52 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\n```\n",
    "created_at": "2021-07-13T01:12:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454116",
    "user": "@mjungmath"
}
```


```
sage -t --random-seed=0 src/sage/categories/sets_cat.py
    [478 tests, 0.52 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
```




---

archive/issue_comments_454117.json:
```json
{
    "body": "Thanks!",
    "created_at": "2021-07-13T01:36:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454117",
    "user": "@mkoeppe"
}
```

Thanks!



---

archive/issue_comments_454118.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2021-07-19T01:57:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454118",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_454119.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2021-07-19T01:57:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454119",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_454120.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-07-19T01:57:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454120",
    "user": "@mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_454121.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-07-23T20:11:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31778",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31778#issuecomment-454121",
    "user": "@vbraun"
}
```

Resolution: fixed
