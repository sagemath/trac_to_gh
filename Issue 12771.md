# Issue 12771: Tableau_class.__div__,  Partition_class.__div__ are checking domination when they should check inclusion

archive/issues_012771.json:
```json
{
    "body": "Assignee: sage-combinat\n\nKeywords: tableau\n\nIf rho and mu are partitions, rho/mu is supposed to return the skew partition rho/mu.  It tries to check that mu is of the right shape for it to be able to do this, but it does this check using the dominates() method, which tests dominance order not inclusion order.  This is not so serious, in that if rho contains mu, then it does also dominate mu, so it will always let correct calculations go through.  The error is then caught by SkewPartition, which realizes it's been handed invalid data.  So this is not actually so bad.  \n\nHowever, the same thing happens when T is a tableau and you calculate T/mu, and there, it causes a \"list index out of range\". \n\n\n```\nsage: rho = Partition((3,2,1))\nsage: mu = Partition((2,1,1,1))\nsage: rho/mu\nValueError: invalid skew partition: [[3, 2, 1], [2, 1, 1, 1]]\n\nsage: t=Tableau([[1,2,3],[4,5],[6]])\nsage: t/mu                         \nIndexError: list index out of range\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/12943\n\n",
    "created_at": "2012-05-13T16:06:24Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.5",
    "title": "Tableau_class.__div__,  Partition_class.__div__ are checking domination when they should check inclusion",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12771",
    "user": "https://github.com/hughrthomas"
}
```
Assignee: sage-combinat

Keywords: tableau

If rho and mu are partitions, rho/mu is supposed to return the skew partition rho/mu.  It tries to check that mu is of the right shape for it to be able to do this, but it does this check using the dominates() method, which tests dominance order not inclusion order.  This is not so serious, in that if rho contains mu, then it does also dominate mu, so it will always let correct calculations go through.  The error is then caught by SkewPartition, which realizes it's been handed invalid data.  So this is not actually so bad.  

However, the same thing happens when T is a tableau and you calculate T/mu, and there, it causes a "list index out of range". 


```
sage: rho = Partition((3,2,1))
sage: mu = Partition((2,1,1,1))
sage: rho/mu
ValueError: invalid skew partition: [[3, 2, 1], [2, 1, 1, 1]]

sage: t=Tableau([[1,2,3],[4,5],[6]])
sage: t/mu                         
IndexError: list index out of range
```


Issue created by migration from https://trac.sagemath.org/ticket/12943





---

archive/issue_comments_152884.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2012-05-13T16:08:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152884",
    "user": "https://github.com/hughrthomas"
}
```

Changing priority from major to minor.



---

archive/issue_comments_152885.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-05-13T16:55:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152885",
    "user": "https://github.com/hughrthomas"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_152886.json:
```json
{
    "body": "Looks good to me.",
    "created_at": "2012-05-13T21:15:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152886",
    "user": "https://github.com/mwhansen"
}
```

Looks good to me.



---

archive/issue_comments_152887.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-05-13T21:15:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152887",
    "user": "https://github.com/mwhansen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_152888.json:
```json
{
    "body": "Thanks, Mike!",
    "created_at": "2012-05-13T21:27:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152888",
    "user": "https://github.com/hughrthomas"
}
```

Thanks, Mike!



---

archive/issue_comments_152889.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-05-14T07:31:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152889",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_152890.json:
```json
{
    "body": "You need to add a proper commit message to the patch, use `hg qrefresh -e` for that.  (Note: multiple lines are allowed, but make sure the first line makes sense by itself).",
    "created_at": "2012-05-14T07:31:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152890",
    "user": "https://github.com/jdemeyer"
}
```

You need to add a proper commit message to the patch, use `hg qrefresh -e` for that.  (Note: multiple lines are allowed, but make sure the first line makes sense by itself).



---

archive/issue_comments_152891.json:
```json
{
    "body": "You might want to add a doctest to tableau for the value error by the way.\nNote: I just moved your patch up the Sage-Combinat queue.",
    "created_at": "2012-05-14T11:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152891",
    "user": "https://github.com/nthiery"
}
```

You might want to add a doctest to tableau for the value error by the way.
Note: I just moved your patch up the Sage-Combinat queue.



---

archive/issue_comments_152892.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-07-28T09:09:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152892",
    "user": "https://github.com/hughrthomas"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_152893.json:
```json
{
    "body": "This looks good. The only change that I woiuld recommend is improving the grammar. Rather than\n\n```\nTo form a skew partition p/q, it must be that q is contained in p\n```\n\nI suggest\n\n```\nTo form the skew partition p/q, q must be contained in p\n```\n\nor even more simply:\n\n```\nthe partition q must be contained in p\n```\n\nOnce you have decided what's best then, following Mike's recommendation, please set this to a positive review.\n\nAndrew",
    "created_at": "2012-08-30T07:52:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152893",
    "user": "https://github.com/AndrewAtLarge"
}
```

This looks good. The only change that I woiuld recommend is improving the grammar. Rather than

```
To form a skew partition p/q, it must be that q is contained in p
```

I suggest

```
To form the skew partition p/q, q must be contained in p
```

or even more simply:

```
the partition q must be contained in p
```

Once you have decided what's best then, following Mike's recommendation, please set this to a positive review.

Andrew



---

archive/issue_comments_152894.json:
```json
{
    "body": "Attachment [trac_12943-skew-partition-construction-bug-ht.patch](tarball://root/attachments/some-uuid/ticket12943/trac_12943-skew-partition-construction-bug-ht.patch) by @hughrthomas created at 2012-09-26 06:22:54",
    "created_at": "2012-09-26T06:22:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152894",
    "user": "https://github.com/hughrthomas"
}
```

Attachment [trac_12943-skew-partition-construction-bug-ht.patch](tarball://root/attachments/some-uuid/ticket12943/trac_12943-skew-partition-construction-bug-ht.patch) by @hughrthomas created at 2012-09-26 06:22:54



---

archive/issue_comments_152895.json:
```json
{
    "body": "Hi Andrew--\n\nI improved the grammar as you requested.  I also realized that I had somehow gotten things out of order in the tableau patch -- it was checking that the inputs were sensible after it had started processing them, rather than before.  I fixed this too.  I would therefore prefer that you set the positive review yourself, if you don't mind.  \n\nThanks for reviewing this.  I apologize for wasting everyone's time with this ticket, which is a rather minuscule improvement.  I will try to restrain myself from indulging in similar tidying impulses in the future.  \n\ncheers,\n\nHugh",
    "created_at": "2012-09-26T06:31:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152895",
    "user": "https://github.com/hughrthomas"
}
```

Hi Andrew--

I improved the grammar as you requested.  I also realized that I had somehow gotten things out of order in the tableau patch -- it was checking that the inputs were sensible after it had started processing them, rather than before.  I fixed this too.  I would therefore prefer that you set the positive review yourself, if you don't mind.  

Thanks for reviewing this.  I apologize for wasting everyone's time with this ticket, which is a rather minuscule improvement.  I will try to restrain myself from indulging in similar tidying impulses in the future.  

cheers,

Hugh



---

archive/issue_comments_152896.json:
```json
{
    "body": "Replying to [comment:9 hthomas]:\n> Thanks for reviewing this.  I apologize for wasting everyone's time with this ticket, which is a rather minuscule improvement.  I will try to restrain myself from indulging in similar tidying impulses in the future.  \n\nDon't! Sage also needs those small improvements :-) On the other hand, given that there was some refactoring going on with tableaux, an alternative would have been to propose a little patch to be folded into Andrew's ticket rather than creating a new ticket. But we don't want too big tickets either, so it's just a question of balance.\n\nThanks!\n                                      Nicolas",
    "created_at": "2012-09-26T11:44:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152896",
    "user": "https://github.com/nthiery"
}
```

Replying to [comment:9 hthomas]:
> Thanks for reviewing this.  I apologize for wasting everyone's time with this ticket, which is a rather minuscule improvement.  I will try to restrain myself from indulging in similar tidying impulses in the future.  

Don't! Sage also needs those small improvements :-) On the other hand, given that there was some refactoring going on with tableaux, an alternative would have been to propose a little patch to be folded into Andrew's ticket rather than creating a new ticket. But we don't want too big tickets either, so it's just a question of balance.

Thanks!
                                      Nicolas



---

archive/issue_comments_152897.json:
```json
{
    "body": "Replying to [comment:10 nthiery]:\n> But we don't want too big tickets either\n+1\n\nI usually prefer separate tickets for separate issues, which is much easier to review (but needs slightly more effort for the author).",
    "created_at": "2012-09-26T11:56:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152897",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:10 nthiery]:
> But we don't want too big tickets either
+1

I usually prefer separate tickets for separate issues, which is much easier to review (but needs slightly more effort for the author).



---

archive/issue_comments_152898.json:
```json
{
    "body": "Hi Hugh.\n\nThe patch looks good. I ran tests with the initial patch -- they passed -- but haven't done retested the patch. The patchbot doesn't seem to want to run the tests for me either and I am not sure how to make it do so.\n\nAssuming that the tests all pass, I give it a positive review.\n\nAlso, I agree with Nicolas and Jeroen that large patches should be avoided (even though I seem to have mainly large patches in the queue...)\n\nAndrew\n\n--\n\nFor the patchbot:\n\nApply  trac_12943-skew-partition-construction-bug-ht.patch",
    "created_at": "2012-09-26T12:39:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152898",
    "user": "https://github.com/AndrewAtLarge"
}
```

Hi Hugh.

The patch looks good. I ran tests with the initial patch -- they passed -- but haven't done retested the patch. The patchbot doesn't seem to want to run the tests for me either and I am not sure how to make it do so.

Assuming that the tests all pass, I give it a positive review.

Also, I agree with Nicolas and Jeroen that large patches should be avoided (even though I seem to have mainly large patches in the queue...)

Andrew

--

For the patchbot:

Apply  trac_12943-skew-partition-construction-bug-ht.patch



---

archive/issue_comments_152899.json:
```json
{
    "body": "`@`Andrew: I have kicked the patchbot, so hopefully it will now test the patch.  When (/if) it's green, I will set a positive review on your behalf.  Thanks!\n\n`@`Nicolas: Thanks for the encouragement.",
    "created_at": "2012-09-26T16:35:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152899",
    "user": "https://github.com/hughrthomas"
}
```

`@`Andrew: I have kicked the patchbot, so hopefully it will now test the patch.  When (/if) it's green, I will set a positive review on your behalf.  Thanks!

`@`Nicolas: Thanks for the encouragement.



---

archive/issue_comments_152900.json:
```json
{
    "body": "The patchbot didn't seem interested in checking so I have just ran the tests \"by hand\". Everything passes so I'll given this a positive review.",
    "created_at": "2012-09-27T12:41:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152900",
    "user": "https://github.com/AndrewAtLarge"
}
```

The patchbot didn't seem interested in checking so I have just ran the tests "by hand". Everything passes so I'll given this a positive review.



---

archive/issue_comments_152901.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-09-27T12:43:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152901",
    "user": "https://github.com/AndrewAtLarge"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_152902.json:
```json
{
    "body": "Thanks, Andrew!\n\nI tried to run the patchbot on my machine, but didn't do it right, which is the explanation for the red blob that has appeared.  I will try to do it again, right, and make the red blob go away.",
    "created_at": "2012-09-27T17:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152902",
    "user": "https://github.com/hughrthomas"
}
```

Thanks, Andrew!

I tried to run the patchbot on my machine, but didn't do it right, which is the explanation for the red blob that has appeared.  I will try to do it again, right, and make the red blob go away.



---

archive/issue_events_035392.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-28T11:38:07Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "milestone": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12771#event-35392"
}
```



---

archive/issue_events_035393.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-10-17T21:14:45Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "milestone": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12771#event-35393"
}
```



---

archive/issue_events_035394.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-10-17T21:14:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12771#event-35394"
}
```



---

archive/issue_events_035395.json:
```json
{
    "actor": "https://github.com/AndrewAtLarge",
    "created_at": "2012-10-18T20:25:34Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12771#event-35395"
}
```



---

archive/issue_events_035396.json:
```json
{
    "actor": "https://github.com/AndrewAtLarge",
    "created_at": "2012-10-18T20:25:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "milestone": "sage-5.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12771#event-35396"
}
```



---

archive/issue_events_035397.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-11-01T12:01:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12771#event-35397"
}
```



---

archive/issue_comments_152903.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-11-01T12:01:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12771",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12771#issuecomment-152903",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
