# Issue 12771: Tableau_class.__div__,  Partition_class.__div__ are checking domination when they should check inclusion

Issue created by migration from Trac.

Original creator: hthomas

Original creation time: 2012-05-13 16:06:24

Assignee: sage-combinat

Keywords: tableau

If rho and mu are partitions, rho/mu is supposed to return the skew partition rho/mu.  It tries to check that mu is of the right shape for it to be able to do this, but it does this check using the dominates() method, which tests dominance order not inclusion order.  This is not so serious, in that if rho contains mu, then it does also dominate mu, so it will always let correct calculations go through.  The error is then caught by SkewPartition, which realizes it's been handed invalid data.  So this is not actually so bad.  

However, the same thing happens when T is a tableau and you calculate T/mu, and there, it causes a "list index out of range". 


```
sage: rho = Partition((3,2,1))
sage: mu = Partition((2,1,1,1))
sage: rho/mu
ValueError: invalid skew partition: [[3, 2, 1], [2, 1, 1, 1]]

sage: t=Tableau([[1,2,3],[4,5],[6]])
sage: t/mu                         
IndexError: list index out of range
```



---

Comment by hthomas created at 2012-05-13 16:08:55

Changing priority from major to minor.


---

Comment by hthomas created at 2012-05-13 16:55:20

Changing status from new to needs_review.


---

Comment by mhansen created at 2012-05-13 21:15:40

Looks good to me.


---

Comment by mhansen created at 2012-05-13 21:15:40

Changing status from needs_review to positive_review.


---

Comment by hthomas created at 2012-05-13 21:27:23

Thanks, Mike!


---

Comment by jdemeyer created at 2012-05-14 07:31:10

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2012-05-14 07:31:10

You need to add a proper commit message to the patch, use `hg qrefresh -e` for that.  (Note: multiple lines are allowed, but make sure the first line makes sense by itself).


---

Comment by nthiery created at 2012-05-14 11:09:54

You might want to add a doctest to tableau for the value error by the way.
Note: I just moved your patch up the Sage-Combinat queue.


---

Comment by hthomas created at 2012-07-28 09:09:55

Changing status from needs_work to needs_review.


---

Comment by andrew.mathas created at 2012-08-30 07:52:35

This looks good. The only change that I woiuld recommend is improving the grammar. Rather than

```
To form a skew partition p/q, it must be that q is contained in p
```

I suggest

```
To form the skew partition p/q, q must be contained in p
```

or even more simply:

```
the partition q must be contained in p
```

Once you have decided what's best then, following Mike's recommendation, please set this to a positive review.

Andrew


---

Attachment


---

Comment by hthomas created at 2012-09-26 06:31:10

Hi Andrew--

I improved the grammar as you requested.  I also realized that I had somehow gotten things out of order in the tableau patch -- it was checking that the inputs were sensible after it had started processing them, rather than before.  I fixed this too.  I would therefore prefer that you set the positive review yourself, if you don't mind.  

Thanks for reviewing this.  I apologize for wasting everyone's time with this ticket, which is a rather minuscule improvement.  I will try to restrain myself from indulging in similar tidying impulses in the future.  

cheers,

Hugh


---

Comment by nthiery created at 2012-09-26 11:44:00

Replying to [comment:9 hthomas]:
> Thanks for reviewing this.  I apologize for wasting everyone's time with this ticket, which is a rather minuscule improvement.  I will try to restrain myself from indulging in similar tidying impulses in the future.  

Don't! Sage also needs those small improvements :-) On the other hand, given that there was some refactoring going on with tableaux, an alternative would have been to propose a little patch to be folded into Andrew's ticket rather than creating a new ticket. But we don't want too big tickets either, so it's just a question of balance.

Thanks!
                                      Nicolas


---

Comment by jdemeyer created at 2012-09-26 11:56:12

Replying to [comment:10 nthiery]:
> But we don't want too big tickets either
+1

I usually prefer separate tickets for separate issues, which is much easier to review (but needs slightly more effort for the author).


---

Comment by andrew.mathas created at 2012-09-26 12:39:02

Hi Hugh.

The patch looks good. I ran tests with the initial patch -- they passed -- but haven't done retested the patch. The patchbot doesn't seem to want to run the tests for me either and I am not sure how to make it do so.

Assuming that the tests all pass, I give it a positive review.

Also, I agree with Nicolas and Jeroen that large patches should be avoided (even though I seem to have mainly large patches in the queue...)

Andrew

--

For the patchbot:

Apply  trac_12943-skew-partition-construction-bug-ht.patch


---

Comment by hthomas created at 2012-09-26 16:35:30

`@`Andrew: I have kicked the patchbot, so hopefully it will now test the patch.  When (/if) it's green, I will set a positive review on your behalf.  Thanks!

`@`Nicolas: Thanks for the encouragement.


---

Comment by andrew.mathas created at 2012-09-27 12:41:00

The patchbot didn't seem interested in checking so I have just ran the tests "by hand". Everything passes so I'll given this a positive review.


---

Comment by andrew.mathas created at 2012-09-27 12:43:48

Changing status from needs_review to positive_review.


---

Comment by hthomas created at 2012-09-27 17:41:23

Thanks, Andrew!

I tried to run the patchbot on my machine, but didn't do it right, which is the explanation for the red blob that has appeared.  I will try to do it again, right, and make the red blob go away.


---

Comment by jdemeyer created at 2012-11-01 12:01:30

Resolution: fixed
