# Issue 17288: Maxima fails to build when Automake 1.11 is not installed

Issue created by migration from Trac.

Original creator: pbruin

Original creation time: 2014-12-18 18:07:12

CC:  rws fbissey

Keywords: maxima automake

As discussed on [sage-release](https://groups.google.com/forum/#!topic/sage-release/bfrzhrmfWik), the latest Maxima upgrade (#17514) inadvertently introduced a dependency on Automake 1.11.  This is caused by `build/pkgs/maxima/patches/makeinfo.patch`, which patches a `Makefile.am` but not the corresponding `Makefile.in`.


---

Comment by pbruin created at 2014-12-18 18:10:07

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2014-12-18 18:30:31

Changing priority from critical to blocker.


---

Comment by fbissey created at 2014-12-18 18:55:43

I feel responsible for missing that in the previous ticket, but it should preferably be tested with someone that doesn't have automake installed.


---

Comment by jdemeyer created at 2014-12-18 19:41:36

Ideally, errors like these should be tested on the buildbot (I used to do that).


---

Comment by fbissey created at 2014-12-18 20:24:16

Looks like I can test it on my macbook, I didn't do that with the original ticket. But I feel stupid to have missed that in the review, it's probably the fact that I don't need to worry about it with ebuilds in Gentoo.


---

Comment by vbraun created at 2014-12-18 21:42:29

will be tested on my osx buildbot but its still in a moving box....


---

Comment by fbissey created at 2014-12-18 21:45:17

Building from scratch with included patch is in progress here.


---

Comment by fbissey created at 2014-12-18 22:10:50

Bother, the mac has makeinfo so it is not really fully tested. Once the build is finished I'll hide makeinfo and rebuild maxima.


---

Comment by pbruin created at 2014-12-18 22:18:48

Replying to [comment:3 fbissey]:
> I feel responsible for missing that in the previous ticket
No need to; as they say, "the author takes responsibility for any remaining mistakes"...


---

Comment by fbissey created at 2014-12-18 23:23:47

Changing status from needs_review to positive_review.


---

Comment by fbissey created at 2014-12-18 23:23:47

Success

```
/bin/sh /Users/fbissey/build/sage-6.5.beta3/local/var/tmp/sage/build/maxima-5.35.1.p1/src/missing --run makeinfo --split-size=1000000 maxima.texi
pattern=`printf "\t"` ; \
	bad_files=`find . -name '*.texi' -print | xargs /usr/bin/grep -E -l -e "$pattern"` ; \
	[ -z  "$bad_files" ] || ( echo "WARNING: The following files have unexpanded Tabs: $bad_files" ; \
	echo "Run /doc/info/fix_tab to fix the problem." )
/Users/fbissey/build/sage-6.5.beta3/local/var/tmp/sage/build/maxima-5.35.1.p1/src/missing: line 52: makeinfo: command not found
WARNING: `makeinfo' is missing on your system.  You should only need it if
         you modified a `.texi' or `.texinfo' file, or any other file
         indirectly affecting the aspect of the manual.  The spurious
         call might also be the consequence of using a buggy `make' (AIX,
         DU, IRIX).  You might want to install the `Texinfo' package or
         the `GNU make' package.  Grab either from any GNU archive site.
```

but everything go through to the end.


---

Comment by pbruin created at 2014-12-19 07:24:43

Yes, that is what I get too.  The fact that `makeinfo` needs to be run when installing Maxima out of the box is an upstream bug, I guess.


---

Comment by fbissey created at 2014-12-19 09:53:37

Replying to [comment:11 pbruin]:
> Yes, that is what I get too.  The fact that `makeinfo` needs to be run when installing Maxima out of the box is an upstream bug, I guess.
I had a long conversation with David Kirkby when I introduced the "touch" trick way back when the problem appeared, I am not sure it is all on trac but at the time upstream was a bit confused that there was a problem. It was like they didn't really use the "install" target.


---

Comment by pbruin created at 2014-12-19 10:18:37

Replying to [comment:12 fbissey]:
> Replying to [comment:11 pbruin]:
> > Yes, that is what I get too.  The fact that `makeinfo` needs to be run when installing Maxima out of the box is an upstream bug, I guess.
> I had a long conversation with David Kirkby when I introduced the "touch" trick way back when the problem appeared, I am not sure it is all on trac but at the time upstream was a bit confused that there was a problem. It was like they didn't really use the "install" target.
There is indeed a long discussion about this on #10773.  I don't know precisely why the "touch" trick stopped working; perhaps `make` clobbers some dependencies of `maxima.info`.  Anyway, the current fix seems to work as well.


---

Comment by fbissey created at 2014-12-19 10:44:47

The current fix is superior. In fact we probably won't notice when it stopped being necessary - if it ever happens.


---

Comment by pbruin created at 2014-12-19 11:16:52

I must have concluded too hastily that the "touch" trick stopped working.  I checked again (by removing `makeinfo.patch` and reinstating the "touch" code) and everything worked fine, even when touching only `maxima.info`.  So it seems that the only problem is that `maxima.info` depends on `include-maxima.texi`, which is generated by `configure`.


---

Comment by vbraun created at 2014-12-21 21:45:30

Resolution: fixed
