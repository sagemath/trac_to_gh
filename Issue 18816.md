# Issue 18816: arboricity of a undirected graph

Issue created by migration from https://trac.sagemath.org/ticket/19053

Original creator: chaoxu

Original creation time: 2015-08-18 19:16:25

#19027 implements matroid partition. One can use it directly to find the arboricity of the graph. https://en.wikipedia.org/wiki/Arboricity


---

Comment by ncohen created at 2015-08-18 21:19:21

Could you add the new graph function to the index at the top of the file? Sorry for asking this now, before you even set the ticket to `needs_review`, but that's one of the things that easily goes unnoticed.

(I have plans to make the building of this index a bit easier in the future)

Nathann

P.S.: Thank you very much for thia addition !
----
New commits:


---

Comment by git created at 2015-08-19 01:41:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-08-19 04:41:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2015-08-19 08:21:35

Thank you!


---

Comment by git created at 2015-09-16 14:25:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2015-09-20 10:18:01

Is this ticket ready for review?


---

Comment by chaoxu created at 2015-09-20 14:47:05

It's ready for review.
In order to have a reasonable performance, it will require this minor change in ticket #19254.
It is probably too slow for any graph with more than 200 edges.


---

Comment by chaoxu created at 2015-09-20 14:47:05

Changing status from new to needs_review.


---

Comment by dcoudert created at 2015-09-20 15:25:16

* You must add tests for graphs with no vertices or no edges.

```
sage: G = Graph()
sage: G.arboricity(True)
---------------------------------------------------------------------------
ZeroDivisionError                         Traceback (most recent call last)
<ipython-input-9-065f5ba4c546> in <module>()
----> 1 G.arboricity(True)

/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/graphs/graph.pyc in arboricity(self, certificate)
   7076         """
   7077         from sage.matroids.constructor import Matroid
-> 7078         P = Matroid(self).partition()
   7079         if certificate:
   7080           return (len(P),[self.subgraph(edges=forest) for forest in P])

/Users/dcoudert/sage/src/sage/matroids/matroid.pyx in sage.matroids.matroid.Matroid.partition (/Users/dcoudert/sage/src/build/cythonized/sage/matroids/matroid.c:63561)()
   6713             return True, Y
   6714 
-> 6715     cpdef partition(self):
   6716         r"""
   6717         Returns a minimum number of disjoint independent sets that covers the

/Users/dcoudert/sage/src/sage/matroids/matroid.pyx in sage.matroids.matroid.Matroid.partition (/Users/dcoudert/sage/src/build/cythonized/sage/matroids/matroid.c:62657)()
   6746         n = self.size()
   6747         r = self.rank()
-> 6748         hi = -(-n//r)
   6749         lo = hi
   6750         X = set()

ZeroDivisionError: integer division or modulo by zero
sage: G.arboricity()
---------------------------------------------------------------------------
ZeroDivisionError                         Traceback (most recent call last)
...
ZeroDivisionError: integer division or modulo by zero

sage: G = Graph(1)
sage: G.arboricity(True)
---------------------------------------------------------------------------
ZeroDivisionError                         Traceback (most recent call last)
...
ZeroDivisionError: integer division or modulo by zero

sage: G = Graph(2)
sage: G.arboricity(True)
---------------------------------------------------------------------------
ZeroDivisionError                         Traceback (most recent call last)
...
ZeroDivisionError: integer division or modulo by zero

sage: G = graphs.PetersenGraph()
sage: G.add_vertex(20)
sage: G.arboricity()
2
```

  More precisely, start with:

```
if self.size()==0:
    return (0,[]) if certificate else 0
```


* In the list of methods (top of the file), you should write `Return` instead of `Returns` to be consistent with the method description.

* I tried the method with a GNP graph of order 100 and it's really long. Unfortunately, we can not CRTL-C the computations, the partition method does not handle signals :(

David.


---

Comment by dcoudert created at 2015-09-20 15:25:16

Changing status from needs_review to needs_work.


---

Comment by git created at 2015-09-23 18:16:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2015-09-24 18:41:55

You have added the dependency to #19275 without merge.
Also you should add a test with `G = Graph()` and/or `G = Graph(2)`.
David.


---

Comment by @vipul79321 created at 2020-02-15 10:08:33

Changing status from needs_work to needs_review.


---

Comment by git created at 2020-02-15 10:09:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @vipul79321 created at 2020-02-15 10:12:33

Replying to [comment:12 dcoudert]:
> You have added the dependency to #19275 without merge.
> Also you should add a test with `G = Graph()` and/or `G = Graph(2)`.
> David.
After fixing of tickets #19275, #19027, #19254. We can restart the work on this. I have added doctest for `G=Graph()`.
The only remaining issue is of time complexity which heavily depends on the `Partition` method of Matroids.


---

Comment by dcoudert created at 2020-02-15 11:25:28

Changing status from needs_review to needs_work.


---

Comment by dcoudert created at 2020-02-15 11:25:28

Several comments.

- There is a TAB that must be removed. To know that is suffices to run the tests `./sage -t src/sage/graphs/graph.py`

```
sage -t src/sage/graphs/graph.py
    Error: TAB character found at line 8648
    [1081 tests, 16.44 s]
----------------------------------------------------------------------
sage -t src/sage/graphs/graph.py  # Tab character found
----------------------------------------------------------------------
```


- At the beginning of the method, use `r"""` instead of `"""` to enable latex mode. Then ``a`` is treated using latex

- small change to unify the style with other methods

```diff
-        - ``certificate`` -- boolean (default: ``False``) Whether to return 
-          a certificate.
+        - ``certificate`` -- boolean (default: ``False``); whether to return 
+          a certificate.
```


- ```(a, F)``` -> ``(a, F)``

- I propose to remove the seealso block and to do

```diff
-        Represent the graph as a graphical matroid, then apply matroid partition
-        algorithm in the matroids module.
+        Represent the graph as a graphical matroid, then apply matroid
+        :meth:`sage.matroid.partition` algorithm from the matroids module.
```


- add spaces around `==`, so `)==G.size()` -> `) == G.size()`

- `g=Graph()` -> `g = Graph()`

- a space is needed after the `,`, and the parenthesis are optional here

```diff
-          return (len(P),[self.subgraph(edges=forest) for forest in P])
+          return len(P), [self.subgraph(edges=forest) for forest in P]
```



---

Comment by git created at 2020-02-15 16:01:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @vipul79321 created at 2020-02-15 16:02:11

Changing status from needs_work to needs_review.


---

Comment by dcoudert created at 2020-02-15 16:15:27

Please add your full name in the Authors field.


---

Comment by dcoudert created at 2020-02-15 17:53:14

LGTM.


---

Comment by dcoudert created at 2020-02-15 17:53:14

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-02-21 22:17:17

Resolution: fixed
