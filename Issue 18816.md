# Issue 18816: arboricity of a undirected graph

archive/issues_018816.json:
```json
{
    "body": "#19027 implements matroid partition. One can use it directly to find the arboricity of the graph. https://en.wikipedia.org/wiki/Arboricity\n\nIssue created by migration from https://trac.sagemath.org/ticket/19053\n\n",
    "created_at": "2015-08-18T19:16:25Z",
    "labels": [
        "graph theory",
        "trivial",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "arboricity of a undirected graph",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18816",
    "user": "@chaoxu"
}
```
#19027 implements matroid partition. One can use it directly to find the arboricity of the graph. https://en.wikipedia.org/wiki/Arboricity

Issue created by migration from https://trac.sagemath.org/ticket/19053





---

archive/issue_comments_257350.json:
```json
{
    "body": "Could you add the new graph function to the index at the top of the file? Sorry for asking this now, before you even set the ticket to `needs_review`, but that's one of the things that easily goes unnoticed.\n\n(I have plans to make the building of this index a bit easier in the future)\n\nNathann\n\nP.S.: Thank you very much for thia addition !\n----\nNew commits:",
    "created_at": "2015-08-18T21:19:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257350",
    "user": "@nathanncohen"
}
```

Could you add the new graph function to the index at the top of the file? Sorry for asking this now, before you even set the ticket to `needs_review`, but that's one of the things that easily goes unnoticed.

(I have plans to make the building of this index a bit easier in the future)

Nathann

P.S.: Thank you very much for thia addition !
----
New commits:



---

archive/issue_comments_257351.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-08-19T01:41:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257351",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_257352.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-08-19T04:41:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257352",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_257353.json:
```json
{
    "body": "Thank you!",
    "created_at": "2015-08-19T08:21:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257353",
    "user": "@nathanncohen"
}
```

Thank you!



---

archive/issue_comments_257354.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-16T14:25:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257354",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_257355.json:
```json
{
    "body": "Is this ticket ready for review?",
    "created_at": "2015-09-20T10:18:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257355",
    "user": "@dcoudert"
}
```

Is this ticket ready for review?



---

archive/issue_comments_257356.json:
```json
{
    "body": "It's ready for review.\nIn order to have a reasonable performance, it will require this minor change in ticket #19254.\nIt is probably too slow for any graph with more than 200 edges.",
    "created_at": "2015-09-20T14:47:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257356",
    "user": "@chaoxu"
}
```

It's ready for review.
In order to have a reasonable performance, it will require this minor change in ticket #19254.
It is probably too slow for any graph with more than 200 edges.



---

archive/issue_comments_257357.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-09-20T14:47:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257357",
    "user": "@chaoxu"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_257358.json:
```json
{
    "body": "* You must add tests for graphs with no vertices or no edges.\n\n```\nsage: G = Graph()\nsage: G.arboricity(True)\n---------------------------------------------------------------------------\nZeroDivisionError                         Traceback (most recent call last)\n<ipython-input-9-065f5ba4c546> in <module>()\n----> 1 G.arboricity(True)\n\n/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/graphs/graph.pyc in arboricity(self, certificate)\n   7076         \"\"\"\n   7077         from sage.matroids.constructor import Matroid\n-> 7078         P = Matroid(self).partition()\n   7079         if certificate:\n   7080           return (len(P),[self.subgraph(edges=forest) for forest in P])\n\n/Users/dcoudert/sage/src/sage/matroids/matroid.pyx in sage.matroids.matroid.Matroid.partition (/Users/dcoudert/sage/src/build/cythonized/sage/matroids/matroid.c:63561)()\n   6713             return True, Y\n   6714 \n-> 6715     cpdef partition(self):\n   6716         r\"\"\"\n   6717         Returns a minimum number of disjoint independent sets that covers the\n\n/Users/dcoudert/sage/src/sage/matroids/matroid.pyx in sage.matroids.matroid.Matroid.partition (/Users/dcoudert/sage/src/build/cythonized/sage/matroids/matroid.c:62657)()\n   6746         n = self.size()\n   6747         r = self.rank()\n-> 6748         hi = -(-n//r)\n   6749         lo = hi\n   6750         X = set()\n\nZeroDivisionError: integer division or modulo by zero\nsage: G.arboricity()\n---------------------------------------------------------------------------\nZeroDivisionError                         Traceback (most recent call last)\n...\nZeroDivisionError: integer division or modulo by zero\n\nsage: G = Graph(1)\nsage: G.arboricity(True)\n---------------------------------------------------------------------------\nZeroDivisionError                         Traceback (most recent call last)\n...\nZeroDivisionError: integer division or modulo by zero\n\nsage: G = Graph(2)\nsage: G.arboricity(True)\n---------------------------------------------------------------------------\nZeroDivisionError                         Traceback (most recent call last)\n...\nZeroDivisionError: integer division or modulo by zero\n\nsage: G = graphs.PetersenGraph()\nsage: G.add_vertex(20)\nsage: G.arboricity()\n2\n```\n\n  More precisely, start with:\n\n```\nif self.size()==0:\n    return (0,[]) if certificate else 0\n```\n\n\n* In the list of methods (top of the file), you should write `Return` instead of `Returns` to be consistent with the method description.\n\n* I tried the method with a GNP graph of order 100 and it's really long. Unfortunately, we can not CRTL-C the computations, the partition method does not handle signals :(\n\nDavid.",
    "created_at": "2015-09-20T15:25:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257358",
    "user": "@dcoudert"
}
```

* You must add tests for graphs with no vertices or no edges.

```
sage: G = Graph()
sage: G.arboricity(True)
---------------------------------------------------------------------------
ZeroDivisionError                         Traceback (most recent call last)
<ipython-input-9-065f5ba4c546> in <module>()
----> 1 G.arboricity(True)

/Users/dcoudert/sage/local/lib/python2.7/site-packages/sage/graphs/graph.pyc in arboricity(self, certificate)
   7076         """
   7077         from sage.matroids.constructor import Matroid
-> 7078         P = Matroid(self).partition()
   7079         if certificate:
   7080           return (len(P),[self.subgraph(edges=forest) for forest in P])

/Users/dcoudert/sage/src/sage/matroids/matroid.pyx in sage.matroids.matroid.Matroid.partition (/Users/dcoudert/sage/src/build/cythonized/sage/matroids/matroid.c:63561)()
   6713             return True, Y
   6714 
-> 6715     cpdef partition(self):
   6716         r"""
   6717         Returns a minimum number of disjoint independent sets that covers the

/Users/dcoudert/sage/src/sage/matroids/matroid.pyx in sage.matroids.matroid.Matroid.partition (/Users/dcoudert/sage/src/build/cythonized/sage/matroids/matroid.c:62657)()
   6746         n = self.size()
   6747         r = self.rank()
-> 6748         hi = -(-n//r)
   6749         lo = hi
   6750         X = set()

ZeroDivisionError: integer division or modulo by zero
sage: G.arboricity()
---------------------------------------------------------------------------
ZeroDivisionError                         Traceback (most recent call last)
...
ZeroDivisionError: integer division or modulo by zero

sage: G = Graph(1)
sage: G.arboricity(True)
---------------------------------------------------------------------------
ZeroDivisionError                         Traceback (most recent call last)
...
ZeroDivisionError: integer division or modulo by zero

sage: G = Graph(2)
sage: G.arboricity(True)
---------------------------------------------------------------------------
ZeroDivisionError                         Traceback (most recent call last)
...
ZeroDivisionError: integer division or modulo by zero

sage: G = graphs.PetersenGraph()
sage: G.add_vertex(20)
sage: G.arboricity()
2
```

  More precisely, start with:

```
if self.size()==0:
    return (0,[]) if certificate else 0
```


* In the list of methods (top of the file), you should write `Return` instead of `Returns` to be consistent with the method description.

* I tried the method with a GNP graph of order 100 and it's really long. Unfortunately, we can not CRTL-C the computations, the partition method does not handle signals :(

David.



---

archive/issue_comments_257359.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-09-20T15:25:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257359",
    "user": "@dcoudert"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_257360.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-23T18:16:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257360",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_257361.json:
```json
{
    "body": "You have added the dependency to #19275 without merge.\nAlso you should add a test with `G = Graph()` and/or `G = Graph(2)`.\nDavid.",
    "created_at": "2015-09-24T18:41:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257361",
    "user": "@dcoudert"
}
```

You have added the dependency to #19275 without merge.
Also you should add a test with `G = Graph()` and/or `G = Graph(2)`.
David.



---

archive/issue_comments_257362.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-02-15T10:08:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257362",
    "user": "@vipul79321"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_257363.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-02-15T10:09:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257363",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_257364.json:
```json
{
    "body": "Replying to [comment:12 dcoudert]:\n> You have added the dependency to #19275 without merge.\n> Also you should add a test with `G = Graph()` and/or `G = Graph(2)`.\n> David.\nAfter fixing of tickets #19275, #19027, #19254. We can restart the work on this. I have added doctest for `G=Graph()`.\nThe only remaining issue is of time complexity which heavily depends on the `Partition` method of Matroids.",
    "created_at": "2020-02-15T10:12:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257364",
    "user": "@vipul79321"
}
```

Replying to [comment:12 dcoudert]:
> You have added the dependency to #19275 without merge.
> Also you should add a test with `G = Graph()` and/or `G = Graph(2)`.
> David.
After fixing of tickets #19275, #19027, #19254. We can restart the work on this. I have added doctest for `G=Graph()`.
The only remaining issue is of time complexity which heavily depends on the `Partition` method of Matroids.



---

archive/issue_comments_257365.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-02-15T11:25:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257365",
    "user": "@dcoudert"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_257366.json:
```json
{
    "body": "Several comments.\n\n- There is a TAB that must be removed. To know that is suffices to run the tests `./sage -t src/sage/graphs/graph.py`\n\n```\nsage -t src/sage/graphs/graph.py\n    Error: TAB character found at line 8648\n    [1081 tests, 16.44 s]\n----------------------------------------------------------------------\nsage -t src/sage/graphs/graph.py  # Tab character found\n----------------------------------------------------------------------\n```\n\n\n- At the beginning of the method, use `r\"\"\"` instead of `\"\"\"` to enable latex mode. Then ``a`` is treated using latex\n\n- small change to unify the style with other methods\n\n```diff\n-        - ``certificate`` -- boolean (default: ``False``) Whether to return \n-          a certificate.\n+        - ``certificate`` -- boolean (default: ``False``); whether to return \n+          a certificate.\n```\n\n\n- ```(a, F)``` -> ``(a, F)``\n\n- I propose to remove the seealso block and to do\n\n```diff\n-        Represent the graph as a graphical matroid, then apply matroid partition\n-        algorithm in the matroids module.\n+        Represent the graph as a graphical matroid, then apply matroid\n+        :meth:`sage.matroid.partition` algorithm from the matroids module.\n```\n\n\n- add spaces around `==`, so `)==G.size()` -> `) == G.size()`\n\n- `g=Graph()` -> `g = Graph()`\n\n- a space is needed after the `,`, and the parenthesis are optional here\n\n```diff\n-          return (len(P),[self.subgraph(edges=forest) for forest in P])\n+          return len(P), [self.subgraph(edges=forest) for forest in P]\n```\n",
    "created_at": "2020-02-15T11:25:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257366",
    "user": "@dcoudert"
}
```

Several comments.

- There is a TAB that must be removed. To know that is suffices to run the tests `./sage -t src/sage/graphs/graph.py`

```
sage -t src/sage/graphs/graph.py
    Error: TAB character found at line 8648
    [1081 tests, 16.44 s]
----------------------------------------------------------------------
sage -t src/sage/graphs/graph.py  # Tab character found
----------------------------------------------------------------------
```


- At the beginning of the method, use `r"""` instead of `"""` to enable latex mode. Then ``a`` is treated using latex

- small change to unify the style with other methods

```diff
-        - ``certificate`` -- boolean (default: ``False``) Whether to return 
-          a certificate.
+        - ``certificate`` -- boolean (default: ``False``); whether to return 
+          a certificate.
```


- ```(a, F)``` -> ``(a, F)``

- I propose to remove the seealso block and to do

```diff
-        Represent the graph as a graphical matroid, then apply matroid partition
-        algorithm in the matroids module.
+        Represent the graph as a graphical matroid, then apply matroid
+        :meth:`sage.matroid.partition` algorithm from the matroids module.
```


- add spaces around `==`, so `)==G.size()` -> `) == G.size()`

- `g=Graph()` -> `g = Graph()`

- a space is needed after the `,`, and the parenthesis are optional here

```diff
-          return (len(P),[self.subgraph(edges=forest) for forest in P])
+          return len(P), [self.subgraph(edges=forest) for forest in P]
```




---

archive/issue_comments_257367.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-02-15T16:01:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257367",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_257368.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-02-15T16:02:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257368",
    "user": "@vipul79321"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_257369.json:
```json
{
    "body": "Please add your full name in the Authors field.",
    "created_at": "2020-02-15T16:15:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257369",
    "user": "@dcoudert"
}
```

Please add your full name in the Authors field.



---

archive/issue_comments_257370.json:
```json
{
    "body": "LGTM.",
    "created_at": "2020-02-15T17:53:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257370",
    "user": "@dcoudert"
}
```

LGTM.



---

archive/issue_comments_257371.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-02-15T17:53:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257371",
    "user": "@dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_257372.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-02-21T22:17:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18816",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18816#issuecomment-257372",
    "user": "@vbraun"
}
```

Resolution: fixed
