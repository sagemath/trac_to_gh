# Issue 12694: Bug in Sage's monodromy pairing on elements of Brandt modules

archive/issues_012694.json:
```json
{
    "body": "Assignee: @craigcitro\n\nKeywords: Brandt module, monodromy pairing\n\n\nIn Magma:\n\n```\nBr:=BrandtModule(2,7);\ng:=Br.1-Br.2;\nInnerProduct(g,g);\n6\n```\n\nIn Sage:\n\n```\nBr = BrandtModule(2,7)\ng1,g2 = Br.basis()\ng = g1-g2\nprint g1,g2\nprint g.monodromy_pairing(g)\n(1, 0) (0, 1)\n2\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/12866\n\n",
    "created_at": "2012-04-21T21:08:48Z",
    "labels": [
        "component: modular forms",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "Bug in Sage's monodromy pairing on elements of Brandt modules",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12694",
    "user": "https://github.com/adeines"
}
```
Assignee: @craigcitro

Keywords: Brandt module, monodromy pairing


In Magma:

```
Br:=BrandtModule(2,7);
g:=Br.1-Br.2;
InnerProduct(g,g);
6
```

In Sage:

```
Br = BrandtModule(2,7)
g1,g2 = Br.basis()
g = g1-g2
print g1,g2
print g.monodromy_pairing(g)
(1, 0) (0, 1)
2
```


Issue created by migration from https://trac.sagemath.org/ticket/12866





---

archive/issue_comments_151430.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-08-26T02:34:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12694",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12694#issuecomment-151430",
    "user": "https://github.com/tornaria"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_151431.json:
```json
{
    "body": "I rebased Aly's patch to sage-6.4.beta1. I added a series of commits to fix a typo in her patch, add some explanation of the computation that is being done, and then an asymptotic improvement so that the monodromy pairing can be computed in O(n) rather than O(n<sup>2</sup>) ideal computations.\n----\nNew commits:",
    "created_at": "2014-08-26T02:34:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12694",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12694#issuecomment-151431",
    "user": "https://github.com/tornaria"
}
```

I rebased Aly's patch to sage-6.4.beta1. I added a series of commits to fix a typo in her patch, add some explanation of the computation that is being done, and then an asymptotic improvement so that the monodromy pairing can be computed in O(n) rather than O(n<sup>2</sup>) ideal computations.
----
New commits:



---

archive/issue_comments_151432.json:
```json
{
    "body": "I have made a branch with other changes to the file:\n\n- many doc enhancements, and problems corrected\n- use of cached_method instead of custom cache\n- other small code changes.\n\n----\nNew commits:",
    "created_at": "2016-03-14T16:21:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12694",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12694#issuecomment-151432",
    "user": "https://github.com/fchapoton"
}
```

I have made a branch with other changes to the file:

- many doc enhancements, and problems corrected
- use of cached_method instead of custom cache
- other small code changes.

----
New commits:



---

archive/issue_comments_151433.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-30T06:19:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12694",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12694#issuecomment-151433",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_151434.json:
```json
{
    "body": "I have checked the code of the authors.\nMy own changes are purely cosmetic, and I have double-checked them.\nThe bot has given a green light.\n\nTherefore I am going to set this to positive review.",
    "created_at": "2016-08-04T16:07:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12694",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12694#issuecomment-151434",
    "user": "https://github.com/fchapoton"
}
```

I have checked the code of the authors.
My own changes are purely cosmetic, and I have double-checked them.
The bot has given a green light.

Therefore I am going to set this to positive review.



---

archive/issue_comments_151435.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-08-04T16:07:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12694",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12694#issuecomment-151435",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_012670.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-07T20:01:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12694",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12694#event-12670"
}
```



---

archive/issue_comments_151436.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-08-07T20:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12694",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12694#issuecomment-151436",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
