# Issue 12694: Bug in Sage's monodromy pairing on elements of Brandt modules

Issue created by migration from Trac.

Original creator: aly.deines

Original creation time: 2012-04-21 21:08:48

Assignee: craigcitro

Keywords: Brandt module, monodromy pairing


In Magma:

```
Br:=BrandtModule(2,7);
g:=Br.1-Br.2;
InnerProduct(g,g);
6
```

In Sage:

```
Br = BrandtModule(2,7)
g1,g2 = Br.basis()
g = g1-g2
print g1,g2
print g.monodromy_pairing(g)
(1, 0) (0, 1)
2
```



---

Comment by tornaria created at 2014-08-26 02:34:40

Changing status from new to needs_review.


---

Comment by tornaria created at 2014-08-26 02:34:40

I rebased Aly's patch to sage-6.4.beta1. I added a series of commits to fix a typo in her patch, add some explanation of the computation that is being done, and then an asymptotic improvement so that the monodromy pairing can be computed in O(n) rather than O(n<sup>2</sup>) ideal computations.
----
New commits:


---

Comment by chapoton created at 2016-03-14 16:21:38

I have made a branch with other changes to the file:

- many doc enhancements, and problems corrected
- use of cached_method instead of custom cache
- other small code changes.

----
New commits:


---

Comment by git created at 2016-07-30 06:19:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-08-04 16:07:56

I have checked the code of the authors.
My own changes are purely cosmetic, and I have double-checked them.
The bot has given a green light.

Therefore I am going to set this to positive review.


---

Comment by chapoton created at 2016-08-04 16:07:56

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-08-07 20:01:49

Resolution: fixed
