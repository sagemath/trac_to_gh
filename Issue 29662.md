# Issue 29662: Two bugs with dilation

Issue created by migration from https://trac.sagemath.org/ticket/29899

Original creator: @kliem

Original creation time: 2020-06-19 15:47:29

CC:  jipilab @laisrast

Keywords: polyhedra, dilation

The new dilation with #29200 shows us two bugs:


```
sage: 2*Polyhedron([[]], backend='cdd')
...
TypeError ...
```


and


```
sage: K.<sqrt2> = QuadraticField(2)
sage: sqrt2*Polyhedron(backend='normaliz')
...
AttributeError
```


There are two tiny fixes to it:
- Make sure to tell the empty polyhedron appart at `Polyhedron_base.__init__`.
- Add a trivial equation for initialization of the universe polyhedron with backend `cdd`.

#29842 will add doctests to this.


---

Comment by @kliem created at 2020-06-19 15:52:36

New commits:


---

Comment by @kliem created at 2020-06-19 15:52:36

Changing status from new to needs_review.


---

Comment by @kliem created at 2020-06-19 15:56:40

What also doesn't work for `cdd` and this is how the `TestSuite` detected the problem is `2*Polyhedron(backend='cdd')`. The problem is that it tries to discover the action via

`parent(Polyhedron(backend='cdd')).an_element()`, which is `Polyhedron([[]], backend='cdd')`.


---

Comment by @kliem created at 2020-06-19 16:03:07

There is no thing as a trivial equation of course.


---

Comment by git created at 2020-06-19 16:03:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-06-19 16:14:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @kliem created at 2020-06-19 16:17:49

Again, the branch that I push into public/29842 in a second really tests those things. Otherwise, I wouldn't have discovered this stuff in the first place.


---

Comment by mkoeppe created at 2020-06-22 04:57:56

I think you should add a doctest that more specifically illustrates this subtle point of the behavior of `Polyhedron_base.__init__` when generators are involved.


---

Comment by git created at 2020-06-22 08:28:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-06-22 17:31:43

inequalites -> inequalities.

Also could you rephrase/expand the comment involving "The damage is limited." I don't fully understand it


---

Comment by @kliem created at 2020-06-22 17:40:50

I will improve this.

The reason for using generators is that we don't have to build a list/tuple that is possibly discarded. Once we are there, we need to generate all the generators. Of course it might be better if you can really just generate them, when you feed them to the backend, but the backends require that you don't call `_init_from_Vrepresentation`, when vertices and rays and lines are empty. So we should respect that.


---

Comment by mkoeppe created at 2020-07-04 19:48:09

Changing status from needs_review to needs_work.


---

Comment by @kliem created at 2020-07-05 07:49:02

Changing status from needs_work to needs_review.


---

Comment by @kliem created at 2020-07-05 07:49:02

New commits:


---

Comment by mkoeppe created at 2020-07-19 05:36:12

Changing status from needs_review to positive_review.


---

Comment by @kliem created at 2020-07-19 06:28:02

Thank you.


---

Comment by vbraun created at 2020-07-25 22:51:16

Resolution: fixed
