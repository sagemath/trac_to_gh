# Issue 26352: allow custom multiplication function in power

Issue created by migration from Trac.

Original creator: vdelecroix

Original creation time: 2018-10-29 11:45:20

CC:  cpernet jdemeyer

Add an option in `sage.arith.power.generic_power` for custom multiplication function.


---

Comment by vdelecroix created at 2018-10-29 12:50:06

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2018-10-29 12:50:06

New commits:


---

Comment by git created at 2018-10-29 12:50:47

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2018-10-29 15:42:38

It would be cool if you could pass a C function pointer. That way, you would strictly generalize the existing code (using `PyNumber_Multiply` in place of `*`).


---

Comment by vdelecroix created at 2018-10-29 15:55:58

`PyNumber_InPlaceMultiply`?


---

Comment by dkrenn created at 2019-03-28 08:49:29

Changing status from needs_review to needs_work.


---

Comment by dkrenn created at 2019-03-28 08:49:29

Looks almost good to me, three very minor comments:

1. Is this kind of a convention to name function with postfix `2`?
   {{{#!diff
    cdef generic_power_pos(a, ulong_or_object n)  # n > 0
   +cdef generic_power_pos2(a, ulong_or_object n, mul)
   }}}
   Could something more descriptive be found easily?

2. parameter is called ``inv``, isn't it?
   {{{#!diff
   +    - ``invert`` -- an optional function for inversion (only used
   }}}

3. This is more like a question: 
   {{{#!diff
   +cdef generic_power_pos2(a, ulong_or_object n, mul):
   +    """
   +    Return `a^n` where `n > 0`.
   +    """
   }}}
   Are there no doctests required here? What is the rule? (Coverage is happy)


---

Comment by vdelecroix created at 2019-03-30 07:00:04

I think that comment:3 should also be considered. But we thought about it and did not arrive to any reasonable conclusion.
