# Issue 21322: Move sage-the-distribution scripts from src/bin to build/bin

Issue created by migration from Trac.

Original creator: mkoeppe

Original creation time: 2016-09-22 04:53:48

CC:  jdemeyer vbraun embray isuruf jhpalmieri fbissey kcrisman mjo arojas dimpase

This list includes probably:
 - `sage-download-upstream`
 - `sage-fix-pkg-checksums`
and perhaps more.


---

Comment by embray created at 2016-09-28 06:23:48

+1

Also `sage-pip-install` of #21441, but I might wait until that ticket is merged first, then move that script along with the others.


---

Comment by jdemeyer created at 2016-09-29 14:49:27

Replying to [comment:2 embray]:
> +1
> 
> Also `sage-pip-install` of #21441

I already moved that in #21441 (which still needs review by the way).


---

Comment by vdelecroix created at 2018-08-03 19:20:18

update milestone 8.3 -> 8.4


---

Comment by embray created at 2019-06-14 14:54:19

As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).


---

Comment by mkoeppe created at 2020-03-03 00:00:14

New commits:


---

Comment by git created at 2020-03-03 00:17:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-03-03 00:21:26

Changing status from new to needs_review.


---

Comment by git created at 2020-03-08 20:38:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-03-17 03:45:24

This ticket could use some help from distribution packagers...


---

Comment by git created at 2020-03-18 01:56:19

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2020-03-18 02:02:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-03-19 17:02:31

Changing status from needs_review to needs_work.


---

Comment by arojas created at 2020-03-21 18:40:52

This breaks if you try to install sagelib with setup.py without running configure first (as some distros do) since sage-env-config doesn't exist in that case. At least sage-env and sage-env-config should be optional.


---

Comment by @Shlokatadistance created at 2020-03-21 20:41:39

Can this build also configure a better link or communication between SAGE_LOCAL or SAGE_SCRIPTS_DIR variables?


---

Comment by mkoeppe created at 2020-03-22 03:21:19

Replying to [comment:32 gh-Shlokatadistance]:
> Can this build also configure a better link or communication between SAGE_LOCAL or SAGE_SCRIPTS_DIR variables? 
Take a look at #25486


---

Comment by git created at 2020-06-12 21:29:22

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:


---

Comment by git created at 2020-06-12 21:38:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-06-12 21:42:06

Changing status from needs_work to needs_review.


---

Comment by git created at 2020-06-13 00:38:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-06-18 04:55:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-06-18 05:56:19

(this script is deleted in #29111)


---

Comment by git created at 2020-06-20 23:40:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-06-20 23:40:54

(these scripts are deleted in #29920)


---

Comment by fbissey created at 2020-06-20 23:50:35

A bit much to ask but is there a way to override the `scripts` variable in `setup.py`? Apart from patching that is. I and other distros will pick and choose what we install and certainly, even where. We can do things after install is run if needs be. 

But building and providing our own list would be a nice to have.


---

Comment by mkoeppe created at 2020-06-20 23:56:01

Replying to [comment:47 fbissey]:
> A bit much to ask but is there a way to override the `scripts` variable in `setup.py`? Apart from patching that is. I and other distros will pick and choose what we install and certainly, even where. We can do things after install is run if needs be. 
> 
> But building and providing our own list would be a nice to have.

Adding hooks for distributors is not a good direction for development.  It's better to sort out in sagelib itself which scripts should be considered part of sagelib, and which ones are provided by sage-the-distribution instead.


---

Comment by mkoeppe created at 2020-06-20 23:58:39

This can be done on follow-up tickets of this ticket.
You can help by categorizing the scripts in the section "Uncategorized scripts in alphabetical order".


---

Comment by fbissey created at 2020-06-21 00:01:33

Replying to [comment:49 mkoeppe]:
> This can be done on follow-up tickets of this ticket.
> You can help by categorizing the scripts in the section "Uncategorized scripts in alphabetical order".
> 

I'll think about it. Like I said it is a "nice to have", not a must have. But this will mark a transition for distros. Before this, most of us were manually installing a selection of scripts. Suddenly the install won't be manual anymore :)


---

Comment by mkoeppe created at 2020-06-21 00:19:03

In fact, the scripts that belong to sage-the-distribution could perhaps be assigned to `sage_setup` (#29847) -- this distutils package that would be installed by sage-the-distribution but not by distros.


---

Comment by jhpalmieri created at 2020-06-21 02:17:13

Replying to [comment:49 mkoeppe]:
> This can be done on follow-up tickets of this ticket.
> You can help by categorizing the scripts in the section "Uncategorized scripts in alphabetical order".

Here are some thoughts:

Perhaps could just be deleted:
- `sage-cython`: #29923
- `sage-native-execute`: look at the script and see #9386. 
- `sage-open`: I wonder if the comment in that script is still valid; perhaps it can be deleted, or done purely in Python in sage/misc/viewer.py, the only place it's used. Maybe I'll look into this.
- `sage-pypkg-location`: apparently unused
- `sage-unzip` is in the listed, but the script itself is gone, isn't it?


Doctesting-related scripts. Where do these go?
- sage-runtests
- coverage scripts
- sage-fix-doctests
- sage-startuptime

In the libexec group:
- sage-cleaner?

Only relevant for sage-the-distribution:
- `sage-download`
- `sage-clone-source`
- `sage-sdist`
- `sage-location`


---

Comment by mkoeppe created at 2020-06-21 02:31:53

Replying to [comment:52 jhpalmieri]:
> Doctesting-related scripts. Where do these go?
> - sage-runtests
> - coverage scripts
> - sage-fix-doctests

Per #29111, they are sagelib scripts.

> - sage-startuptime

Not sure about this one.


---

Comment by git created at 2020-06-21 02:33:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-06-21 02:40:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-06-21 02:45:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-06-23 21:48:28

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by git created at 2020-06-23 21:51:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-06-23 21:51:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jhpalmieri created at 2020-06-24 16:24:11

I run into problems unless I make this change:

```diff
diff --git a/src/setup.py b/src/setup.py
index 9970525cf9..85a32a5962 100755
--- a/src/setup.py
+++ b/src/setup.py
`@``@` -162,7 +162,6 `@``@` code = setup(name = 'sage',
                  'bin/sage-rebaseall.sh',
                  'bin/sage-rst2sws',
                  'bin/sage-rst2txt',
-                 'bin/sage-rsyncdist',
                  'bin/sage-run',
                  'bin/sage-run-cython',
                  'bin/sage-startuptime.py',
```



---

Comment by git created at 2020-06-24 18:26:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-06-29 17:33:58

Needs review


---

Comment by jhpalmieri created at 2020-06-29 21:30:44

Looks okay to me.


---

Comment by jhpalmieri created at 2020-06-29 21:30:44

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2020-06-30 00:14:45

Thanks!


---

Comment by git created at 2020-07-04 16:20:24

Changing status from positive_review to needs_review.


---

Comment by git created at 2020-07-04 16:20:24

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by mkoeppe created at 2020-07-04 16:20:41

Changing status from needs_review to positive_review.


---

Comment by git created at 2020-07-08 23:22:53

Changing status from positive_review to needs_review.


---

Comment by git created at 2020-07-08 23:22:53

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by mkoeppe created at 2020-07-08 23:25:56

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-07-10 19:34:13

Resolution: fixed
