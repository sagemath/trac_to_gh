# Issue 21393: py3 make doctest of matrix2 future-proof

Issue created by migration from https://trac.sagemath.org/ticket/21630

Original creator: chapoton

Original creation time: 2016-10-03 15:36:14

CC:  tscrim

because range will be an iterator in python3


---

Comment by chapoton created at 2016-10-03 15:36:48

New commits:


---

Comment by chapoton created at 2016-10-03 15:36:48

Changing status from new to needs_review.


---

Comment by jmantysalo created at 2016-10-03 16:53:59

I would vote for this ticket. But maybe I still ask Travis opinion:

This ticket changes `matrix(ZZ,3,range(9))` to `matrix(ZZ,3,3,range(9))` etc. I think it is good to use examples with both row- and column-count given. Do you agree on that?

(Tests passed etc, so otherwise this is a positive review.)


---

Comment by tscrim created at 2016-10-03 17:56:00

I can understand why this was done, but I think it is good to have the shortcut and used in tests. In particular, it forces us to make updates to the constructor or change the doctests and drop the behavior after a discussion at switch time. I don't have a strong opinion either way for this, but just my 2 cents.


---

Comment by jmantysalo created at 2016-10-03 18:09:24

Is there still left enought of those test with only one dimension given after this patch?


---

Comment by chapoton created at 2016-10-03 19:34:31

There remains a lot of them, for example in src/sage/matrix/matrix0.pyx

I think we should only keep *one* such doctest.

EDIT:

```
git grep -P -c "matrix\([^,0-9]*,[0-9]\s*,\s*range"
src/doc/de/tutorial/introduction.rst:1
src/doc/en/tutorial/introduction.rst:1
src/doc/es/tutorial/introduction.rst:1
src/doc/fr/tutorial/introduction.rst:1
src/doc/ja/tutorial/introduction.rst:1
src/doc/pt/tutorial/introduction.rst:1
src/doc/ru/tutorial/introduction.rst:1
src/sage/interfaces/giac.py:1
src/sage/interfaces/maple.py:2
src/sage/matrix/matrix0.pyx:13
src/sage/matrix/matrix1.pyx:2
src/sage/matrix/matrix2.pyx:13
src/sage/matrix/matrix_double_dense.pyx:15
src/sage/matrix/matrix_integer_dense.pyx:7
src/sage/matrix/matrix_integer_sparse.pyx:2
src/sage/matrix/matrix_rational_dense.pyx:5
src/sage/matrix/matrix_rational_sparse.pyx:4
src/sage/matrix/matrix_real_double_dense.pyx:1
src/sage/modules/matrix_morphism.py:1
```



---

Comment by jmantysalo created at 2016-10-04 04:54:51

Replying to [comment:6 chapoton]:
> There remains a lot of them, for example in src/sage/matrix/matrix0.pyx

OK then.

> I think we should only keep *one* such doctest.

Yes, maybe. Then it should be on test block and clearly marked what it is for.

> {{{
> git grep -P 
> }}}

Perl-style regexps... scary.


---

Comment by jmantysalo created at 2016-10-04 04:54:51

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-10-05 22:41:43

Resolution: fixed
