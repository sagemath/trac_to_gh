# Issue 21393: py3 make doctest of matrix2 future-proof

archive/issues_021393.json:
```json
{
    "body": "CC:  tscrim\n\nbecause range will be an iterator in python3\n\nIssue created by migration from https://trac.sagemath.org/ticket/21630\n\n",
    "created_at": "2016-10-03T15:36:14Z",
    "labels": [
        "python3",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "py3 make doctest of matrix2 future-proof",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21393",
    "user": "chapoton"
}
```
CC:  tscrim

because range will be an iterator in python3

Issue created by migration from https://trac.sagemath.org/ticket/21630





---

archive/issue_comments_297052.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-10-03T15:36:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21393#issuecomment-297052",
    "user": "chapoton"
}
```

New commits:



---

archive/issue_comments_297053.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-10-03T15:36:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21393#issuecomment-297053",
    "user": "chapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_297054.json:
```json
{
    "body": "I would vote for this ticket. But maybe I still ask Travis opinion:\n\nThis ticket changes `matrix(ZZ,3,range(9))` to `matrix(ZZ,3,3,range(9))` etc. I think it is good to use examples with both row- and column-count given. Do you agree on that?\n\n(Tests passed etc, so otherwise this is a positive review.)",
    "created_at": "2016-10-03T16:53:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21393#issuecomment-297054",
    "user": "jmantysalo"
}
```

I would vote for this ticket. But maybe I still ask Travis opinion:

This ticket changes `matrix(ZZ,3,range(9))` to `matrix(ZZ,3,3,range(9))` etc. I think it is good to use examples with both row- and column-count given. Do you agree on that?

(Tests passed etc, so otherwise this is a positive review.)



---

archive/issue_comments_297055.json:
```json
{
    "body": "I can understand why this was done, but I think it is good to have the shortcut and used in tests. In particular, it forces us to make updates to the constructor or change the doctests and drop the behavior after a discussion at switch time. I don't have a strong opinion either way for this, but just my 2 cents.",
    "created_at": "2016-10-03T17:56:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21393#issuecomment-297055",
    "user": "tscrim"
}
```

I can understand why this was done, but I think it is good to have the shortcut and used in tests. In particular, it forces us to make updates to the constructor or change the doctests and drop the behavior after a discussion at switch time. I don't have a strong opinion either way for this, but just my 2 cents.



---

archive/issue_comments_297056.json:
```json
{
    "body": "Is there still left enought of those test with only one dimension given after this patch?",
    "created_at": "2016-10-03T18:09:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21393#issuecomment-297056",
    "user": "jmantysalo"
}
```

Is there still left enought of those test with only one dimension given after this patch?



---

archive/issue_comments_297057.json:
```json
{
    "body": "There remains a lot of them, for example in src/sage/matrix/matrix0.pyx\n\nI think we should only keep *one* such doctest.\n\nEDIT:\n\n```\ngit grep -P -c \"matrix\\([^,0-9]*,[0-9]\\s*,\\s*range\"\nsrc/doc/de/tutorial/introduction.rst:1\nsrc/doc/en/tutorial/introduction.rst:1\nsrc/doc/es/tutorial/introduction.rst:1\nsrc/doc/fr/tutorial/introduction.rst:1\nsrc/doc/ja/tutorial/introduction.rst:1\nsrc/doc/pt/tutorial/introduction.rst:1\nsrc/doc/ru/tutorial/introduction.rst:1\nsrc/sage/interfaces/giac.py:1\nsrc/sage/interfaces/maple.py:2\nsrc/sage/matrix/matrix0.pyx:13\nsrc/sage/matrix/matrix1.pyx:2\nsrc/sage/matrix/matrix2.pyx:13\nsrc/sage/matrix/matrix_double_dense.pyx:15\nsrc/sage/matrix/matrix_integer_dense.pyx:7\nsrc/sage/matrix/matrix_integer_sparse.pyx:2\nsrc/sage/matrix/matrix_rational_dense.pyx:5\nsrc/sage/matrix/matrix_rational_sparse.pyx:4\nsrc/sage/matrix/matrix_real_double_dense.pyx:1\nsrc/sage/modules/matrix_morphism.py:1\n```\n",
    "created_at": "2016-10-03T19:34:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21393#issuecomment-297057",
    "user": "chapoton"
}
```

There remains a lot of them, for example in src/sage/matrix/matrix0.pyx

I think we should only keep *one* such doctest.

EDIT:

```
git grep -P -c "matrix\([^,0-9]*,[0-9]\s*,\s*range"
src/doc/de/tutorial/introduction.rst:1
src/doc/en/tutorial/introduction.rst:1
src/doc/es/tutorial/introduction.rst:1
src/doc/fr/tutorial/introduction.rst:1
src/doc/ja/tutorial/introduction.rst:1
src/doc/pt/tutorial/introduction.rst:1
src/doc/ru/tutorial/introduction.rst:1
src/sage/interfaces/giac.py:1
src/sage/interfaces/maple.py:2
src/sage/matrix/matrix0.pyx:13
src/sage/matrix/matrix1.pyx:2
src/sage/matrix/matrix2.pyx:13
src/sage/matrix/matrix_double_dense.pyx:15
src/sage/matrix/matrix_integer_dense.pyx:7
src/sage/matrix/matrix_integer_sparse.pyx:2
src/sage/matrix/matrix_rational_dense.pyx:5
src/sage/matrix/matrix_rational_sparse.pyx:4
src/sage/matrix/matrix_real_double_dense.pyx:1
src/sage/modules/matrix_morphism.py:1
```




---

archive/issue_comments_297058.json:
```json
{
    "body": "Replying to [comment:6 chapoton]:\n> There remains a lot of them, for example in src/sage/matrix/matrix0.pyx\n\nOK then.\n\n> I think we should only keep *one* such doctest.\n\nYes, maybe. Then it should be on test block and clearly marked what it is for.\n\n> {{{\n> git grep -P \n> }}}\n\nPerl-style regexps... scary.",
    "created_at": "2016-10-04T04:54:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21393#issuecomment-297058",
    "user": "jmantysalo"
}
```

Replying to [comment:6 chapoton]:
> There remains a lot of them, for example in src/sage/matrix/matrix0.pyx

OK then.

> I think we should only keep *one* such doctest.

Yes, maybe. Then it should be on test block and clearly marked what it is for.

> {{{
> git grep -P 
> }}}

Perl-style regexps... scary.



---

archive/issue_comments_297059.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-10-04T04:54:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21393#issuecomment-297059",
    "user": "jmantysalo"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_297060.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-10-05T22:41:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21393#issuecomment-297060",
    "user": "vbraun"
}
```

Resolution: fixed
