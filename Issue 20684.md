# Issue 20684: LatticePoset: add function to get lattice of sublattices

Issue created by migration from https://trac.sagemath.org/ticket/20921

Original creator: jmantysalo

Original creation time: 2016-07-02 05:42:39

CC:  tscrim

Keywords: latticeposet

Add a function to get the lattice of sublattices.

(First wait #20669 to get closed.)


---

Comment by tscrim created at 2016-07-02 14:56:07

Changing keywords from "latticeposet" to "lattice poset".


---

Comment by jmantysalo created at 2016-07-02 20:27:31

Isn't "lattice" an ambiguous keyword? It refers to two different things, try to click it and see.


---

Comment by tscrim created at 2016-07-03 00:16:41

In and of itself, yes, "lattice" is ambiguous. However, "latticeposet" is not a word (in English), but having the "lattice poset" together makes it clear. (More of a random note, there are also 2 other distinct non-mathematical uses of the word lattice that comes to mind as well.)

However, you're free to build here upon #20669 before it gets released in a beta.


---

Comment by jmantysalo created at 2016-07-03 06:10:08

Replying to [comment:4 tscrim]:
> In and of itself, yes, "lattice" is ambiguous. However, "latticeposet" is not a word (in English), but having the "lattice poset" together makes it clear.

But trac does not seem to accept two words keyphrase. Trying to put "foo bar, xyzzy" as keywords does just what "foo, bar, xyzzy" would do. lattice_poset maybe?

> However, you're free to build here upon #20669 before it gets released in a beta.

True, but Volker releases betas so often that it makes no big delay.


---

Comment by jmantysalo created at 2016-07-03 14:15:52

Not ready, but I save it here and will continue on another computer after next beta.
----
New commits:


---

Comment by git created at 2016-07-08 15:07:17

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jmantysalo created at 2016-07-08 15:09:09

Changing status from new to needs_review.


---

Comment by jmantysalo created at 2016-07-22 05:40:56

Just pinging... Examples are hard, as even very small lattice can generate a big lattice of sublattices.


---

Comment by tscrim created at 2016-07-22 14:08:26

I would write the input section as:

```
        - ``element_constructor`` -- string; can be one of the following:

          * ``'lattice'`` - (the default) elements of the lattice will
            be lattices that correspond to sublattices of ``self``
          * ``'tuple'`` - elements are tuples of elements of the
            sublattices of ``self``
          * ``'integer'`` - the elements are plain integers
```

Also, it looks like you have an unneeded import of `DiGraph`. Otherwise LGTM.


---

Comment by git created at 2016-07-22 14:25:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2016-07-22 14:27:33

Corrected those. I used format "original lattice", as `self` is not very much used in docstring in this file.

Should it be "elements" or "the elements"?


---

Comment by tscrim created at 2016-07-22 14:39:46

Formally (i.e., if a English professor looked at it), I'm not sure if the "the" is necessary here because it is plural and the structure of the sentence is declarative. Feel free to add it as it is not wrong. Also, I missed this above, it should just be `(default)`, i.e., no "the" there. Thanks.


---

Comment by git created at 2016-07-22 16:51:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2016-07-22 16:54:02

Replying to [comment:14 tscrim]:
> Formally (i.e., if a English professor looked at it), I'm not sure if the "the" is necessary here because it is plural and the structure of the sentence is declarative. Feel free to add it as it is not wrong.

If it is not needed, I can left it off. I was just wondering when you wrote "tuple - elements are" vs. "integer - the elements".

Ready now?


---

Comment by tscrim created at 2016-07-22 16:55:11

Replying to [comment:16 jmantysalo]:
> Replying to [comment:14 tscrim]:
> > Formally (i.e., if a English professor looked at it), I'm not sure if the "the" is necessary here because it is plural and the structure of the sentence is declarative. Feel free to add it as it is not wrong.
> 
> If it is not needed, I can left it off. I was just wondering when you wrote "tuple - elements are" vs. "integer - the elements".

Whoops, my bad.

> Ready now?

Yep. Thanks.


---

Comment by tscrim created at 2016-07-22 16:55:11

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-07-23 11:51:22


```
sage -t --long src/sage/combinat/posets/lattices.py
**********************************************************************
File "src/sage/combinat/posets/lattices.py", line 1743, in sage.combinat.posets.lattices.FiniteLatticePoset.sublattices_lattice
Failed example:
    sll = L.sublattices_lattice()
Exception raised:
    Traceback (most recent call last):
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 499, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 862, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.combinat.posets.lattices.FiniteLatticePoset.sublattices_lattice[4]>", line 1, in <module>
        sll = L.sublattices_lattice()
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/posets/lattices.py", line 1868, in sublattices_lattice
        G.relabel(lambda x: self.sublattice(x))
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 19817, in relabel
        perm = dict( [ i, perm(i) ] for i in self.vertices() )
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 19817, in <genexpr>
        perm = dict( [ i, perm(i) ] for i in self.vertices() )
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/posets/lattices.py", line 1868, in <lambda>
        G.relabel(lambda x: self.sublattice(x))
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/posets/lattices.py", line 1680, in sublattice
        return LatticePoset(self.subposet(current_set))
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/posets/posets.py", line 4513, in subposet
        elements = [self(e) for e in elements]
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/posets/posets.py", line 1232, in __call__
        return super(FinitePoset, self).__call__(element)
      File "sage/structure/parent.pyx", line 1107, in sage.structure.parent.Parent.__call__ (/home/buildbot/slave/sage_git/build/src/build/cythonized/sage/structure/parent.c:9904)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 110, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/home/buildbot/slave/sage_git/build/src/build/cythonized/sage/structure/coerce_maps.c:4651)
        raise
      File "sage/structure/coerce_maps.pyx", line 105, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/home/buildbot/slave/sage_git/build/src/build/cythonized/sage/structure/coerce_maps.c:4539)
        return C._element_constructor(x)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/posets/posets.py", line 1208, in _element_constructor_
        % type(element))
    ValueError: <type 'int'> is not an element of this poset
**********************************************************************
File "src/sage/combinat/posets/lattices.py", line 1844, in sage.combinat.posets.lattices.FiniteLatticePoset.sublattices_lattice
Failed example:
    sll = L.sublattices_lattice()
Exception raised:
    Traceback (most recent call last):
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 499, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 862, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.combinat.posets.lattices.FiniteLatticePoset.sublattices_lattice[4]>", line 1, in <module>
        sll = L.sublattices_lattice()
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/posets/lattices.py", line 1868, in sublattices_lattice
        G.relabel(lambda x: self.sublattice(x))
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 19817, in relabel
        perm = dict( [ i, perm(i) ] for i in self.vertices() )
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 19817, in <genexpr>
        perm = dict( [ i, perm(i) ] for i in self.vertices() )
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/posets/lattices.py", line 1868, in <lambda>
        G.relabel(lambda x: self.sublattice(x))
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/posets/lattices.py", line 1680, in sublattice
        return LatticePoset(self.subposet(current_set))
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/posets/posets.py", line 4513, in subposet
        elements = [self(e) for e in elements]
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/posets/posets.py", line 1232, in __call__
        return super(FinitePoset, self).__call__(element)
      File "sage/structure/parent.pyx", line 1107, in sage.structure.parent.Parent.__call__ (/home/buildbot/slave/sage_git/build/src/build/cythonized/sage/structure/parent.c:9904)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 110, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/home/buildbot/slave/sage_git/build/src/build/cythonized/sage/structure/coerce_maps.c:4651)
        raise
      File "sage/structure/coerce_maps.pyx", line 105, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/home/buildbot/slave/sage_git/build/src/build/cythonized/sage/structure/coerce_maps.c:4539)
        return C._element_constructor(x)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/posets/posets.py", line 1208, in _element_constructor_
        % type(element))
    ValueError: <type 'int'> is not an element of this poset
**********************************************************************
File "src/sage/combinat/posets/lattices.py", line 1856, in sage.combinat.posets.lattices.FiniteLatticePoset.sublattices_lattice
Failed example:
    sll.is_isomorphic(Posets.BoolenLattice(3))
Exception raised:
    Traceback (most recent call last):
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 499, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 862, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.combinat.posets.lattices.FiniteLatticePoset.sublattices_lattice[10]>", line 1, in <module>
        sll.is_isomorphic(Posets.BoolenLattice(Integer(3)))
    AttributeError: type object 'Posets' has no attribute 'BoolenLattice'
**********************************************************************
1 item had failures:
   3 of  24 in sage.combinat.posets.lattices.FiniteLatticePoset.sublattices_lattice
    [310 tests, 3 failures, 0.75 s]
```



---

Comment by vbraun created at 2016-07-23 11:51:22

Changing status from positive_review to needs_work.


---

Comment by git created at 2016-07-23 19:53:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2016-07-23 19:54:55

AARGHS! There was my temporary copy still in the branch. Now it is removed and tests passed.


---

Comment by jmantysalo created at 2016-07-23 19:54:55

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2016-07-26 03:54:43

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-07-27 20:24:45

Resolution: fixed
