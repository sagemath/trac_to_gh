# Issue 17988: Missing polytopes in the library

Issue created by migration from https://trac.sagemath.org/ticket/18225

Original creator: vdelecroix

Original creation time: 2015-04-16 17:06:12

CC:  ncohen mkoeppe bedutra pjxiao

Keywords: beginner

Sage forgot the existence of some polyhedras!

Platonic (or regular) solids:
 - [tetrahedron](https://en.wikipedia.org/wiki/Tetrahedron)
 - [octahedron](https://en.wikipedia.org/wiki/Octahedron)

Archmidian (or semi-regular) solids:
 - [truncated tetrahedron](https://en.wikipedia.org/wiki/Truncated_tetrahedron)
 - [truncated cube](https://en.wikipedia.org/wiki/Truncated_cube)
 - [truncated octahedron (truncated tetratetrahedron)](https://en.wikipedia.org/wiki/Truncated_octahedron)
 - [snub cube (snub cuboctahedron)](https://en.wikipedia.org/wiki/Snub_cube)
 - [icosidodecahedron](https://en.wikipedia.org/wiki/Icosidodecahedron)
 - [truncated icosahedron](https://en.wikipedia.org/wiki/Truncated_dodecahedron)
 - [rhombicosidodecahedron (small rhombicosidodecahedron)](https://en.wikipedia.org/wiki/Rhombicosidodecahedron)
 - [truncated icosidodecahedron (great rhombicosidodecahedron)](https://en.wikipedia.org/wiki/Truncated_icosidodecahedron)
 - [snub dodecahedron (snub icosidodecahedron)](https://en.wikipedia.org/wiki/Snub_dodecahedron)

And possibly:

 - [the elongated square gyrobicupola or pseudorhombicuboctahedron](https://en.wikipedia.org/wiki/Elongated_square_gyrobicupola)


---

Comment by chapoton created at 2015-05-24 20:33:57

New commits:


---

Comment by git created at 2015-05-25 08:35:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-05-26 19:48:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-05-27 06:35:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2015-05-28 10:24:43

in fact octahedron was already known as a lattice polytope (lattice_polytope.cross_polytope)


---

Comment by git created at 2015-05-30 18:46:43

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-06-02 19:55:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-06-12 19:46:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-06-19 19:17:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-06-19 19:32:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2015-06-19 19:34:23

Changing keywords from "beginner" to "beginner, polytope".


---

Comment by chapoton created at 2015-06-19 19:34:23

New commits:


---

Comment by ncohen created at 2015-07-02 15:25:39

Hello Frédéric,

Could we decide something about this Icosidodecahedron thing? My patch at #18775 also contains two graph constructors that I need. Do you know when you will be done with this ticket?

Nathann


---

Comment by chapoton created at 2015-07-03 02:21:59

I will not be able to do anything for the next 2 weeks. Please go ahead if you can find a reviewer for your ticket.


---

Comment by git created at 2015-08-09 08:28:43

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by nvcleemp created at 2015-11-13 14:12:52

Hello Frédéric

I needed the rhombicosidodecahedron, so I implemented it. Is it OK if I push it to this ticket, or will this interfere with what you're doing?

Cheers
Nico


---

Comment by chapoton created at 2015-11-13 14:23:33

Hello,

no problem. You can just add this to the existing branch. I am no longer active on this ticket. Maybe it would be a good time to get it into sage, as a good first step, even if it does not implement everything suggested.


---

Comment by vdelecroix created at 2015-11-13 14:30:53

Replying to [comment:17 chapoton]:
> Hello,
> 
> no problem. You can just add this to the existing branch. I am no longer active on this ticket. Maybe it would be a good time to get it into sage, as a good first step, even if it does not implement everything suggested.

You are free to split it into several tickets.

Quick remark on the code: some of the constructors do not accept `exact`/`base_ring` as arguments. I know that some of them are infinitely slow with `exact=True`. There are already some of them that have default `exact=False` that is fine with me if there is a clear warning.

PS: I have code that improves the generic double description algorithm and makes the constructions reasonable over QQbar... but it needs a bit of cleaning.


---

Comment by nvcleemp created at 2015-11-13 14:45:28

Hmm, I seem to be unable to push to this branch, even though it starts with public. This is what I do



```
$ git push trac public/ticket/18225
git@trac.sagemath.org's password: 
Permission denied, please try again.
```


The password which I enter is my password for Trac.


---

Comment by chapoton created at 2015-11-13 14:47:39

You should rather set-up a ssh key to push to trac, this is much more convenient.

http://doc.sagemath.org/html/en/developer/trac.html#section-trac-ssh-key


---

Comment by git created at 2015-11-13 15:34:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by nvcleemp created at 2015-11-13 15:40:51

I changed the description of the ticket a bit in order to give an easy overview of which polytopes are done.


---

Comment by git created at 2015-11-13 15:54:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2015-11-13 18:40:31

ok, let us turn the ticket to needs review, and try to incorporate it in sage.


---

Comment by chapoton created at 2015-11-13 18:40:31

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2015-11-13 22:47:57

Replying to [comment:18 vdelecroix]:
> PS: I have code that improves the generic double description algorithm and makes the constructions reasonable over QQbar... but it needs a bit of cleaning.

Is this code already on a ticket? We'd be quite interested in testing it.


---

Comment by git created at 2015-11-14 06:47:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by nvcleemp created at 2015-11-14 07:05:52

OK, I quickly had a look at also adding the snub dodecahedron, but since I'm not really familiar with number fields (in Sage), this won't be happening soon, so I think it will indeed be best to just get this into Sage. Unless somebody wants to explain to me how to get the correct field for these coordinates. The information is available at [snub dodecahedron coordinates](https://en.wikipedia.org/wiki/Snub_dodecahedron#Cartesian_coordinates).


---

Comment by tscrim created at 2015-11-15 15:12:48

Here is how you can create `phi` and `xi`:

```
sage: Q = QuadraticField(5, 'sqrt5')
sage: sqrt5 = Q.gen()
sage: phi = (1 + sqrt5)/2
sage: R.<x> = Q[]
sage: A = NumberField(x^3 - 2*x - phi, 'xi')
sage: xi = A.gen()
```

You can also use `RDF` for an `exact=False` input.

Edit - Missed one command


---

Comment by nvcleemp created at 2015-11-15 16:05:15

Replying to [comment:30 tscrim]:
> Here is how you can create `phi` and `xi`:
> {{{
> sage: Q = QuadraticField(5, 'sqrt5')
> sage: sqrt5 = Q.gen()
> sage: phi = (1 + sqrt5)/2
> sage: A = NumberField(x^3 - 2*x - phi, 'xi')
> sage: xi = A.gen()
> }}}
> You can also use `RDF` for an `exact=False` input.

I had already tried something similar, but then and now I get the same error:


```
sage: A = NumberField(x^3 -2*x - phi, 'xi')
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-5-44b6c4f1fa2d> in <module>()
----> 1 A = NumberField(x**Integer(3) -Integer(2)*x - phi, 'xi')

/home/nvcleemp/Sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.pyc in NumberField(polynomial, name, check, names, embedding, latex_name, assume_disc_small, maximize_at_primes, structure)
    454         return NumberFieldTower(polynomial, names=name, check=check, embeddings=embedding, latex_names=latex_name, assume_disc_small=assume_disc_small, maximize_at_primes=maximize_at_primes, structures=structure)
    455 
--> 456     return NumberField_version2(polynomial=polynomial, name=name, check=check, embedding=embedding, latex_name=latex_name, assume_disc_small=assume_disc_small, maximize_at_primes=maximize_at_primes, structure=structure)
    457 
    458 class NumberFieldFactory(UniqueFactory):

/home/nvcleemp/Sage/sage/src/sage/structure/factory.pyx in sage.structure.factory.UniqueFactory.__call__ (/home/nvcleemp/Sage/sage/src/build/cythonized/sage/structure/factory.c:1231)()
    362             False
    363         """
--> 364         key, kwds = self.create_key_and_extra_args(*args, **kwds)
    365         version = self.get_version(sage_version)
    366         return self.get_object(version, key, kwds)

/home/nvcleemp/Sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.pyc in create_key_and_extra_args(self, polynomial, name, check, embedding, latex_name, assume_disc_small, maximize_at_primes, structure)
    530                 polynomial = polynomial.polynomial(QQ)
    531             except (AttributeError, TypeError):
--> 532                 raise TypeError("polynomial (=%s) must be a polynomial." % polynomial)
    533 
    534         # convert polynomial to a polynomial over a field

TypeError: polynomial (=x^3 - 2*x - 1/2*sqrt(5) - 1/2) must be a polynomial.
```



---

Comment by tscrim created at 2015-11-15 16:49:47

Ah, sorry, I forgot to copy in

```
sage: R.<x> = Q[]
```



---

Comment by nvcleemp created at 2015-11-16 09:45:34

Replying to [comment:32 tscrim]:
> Ah, sorry, I forgot to copy in
> {{{
> sage: R.<x> = Q[]
> }}}

Almost there. It works on the command line, but in the code I get this error:


```
  File "/home/nvcleemp/Sage/sage/local/lib/python2.7/site-packages/sage/geometry/polyhedron/library.py", line 1320
    R.<x> = Q[]
      ^
SyntaxError: invalid syntax
```


And maybe I can also already anticipate and ask another question I will probably have some problem with. How can I specify xi in the `exact=False` case (i.e., when using RDF)?


---

Comment by chapoton created at 2015-11-16 16:55:56

Thanks for working on that.

For the first question, you should use instead

```
R = PolynomialRing(Q, 'x')
x = R.gen()
```



---

Comment by chapoton created at 2015-11-16 17:00:05

For the second question, you can choose the good one among the possible real embeddings of A:

```
sage: A.embeddings(RDF)
```

name it 'phi' and then re-define xi as  'phi(xi)'


---

Comment by tscrim created at 2015-11-16 17:00:40

For `\xi`, you first can define `phi = (1 + base_ring(5).sqrt()) / 2` where `base_ring = RDF` (or whatever was passed in; see `icosidodecahedron_V2`). Then use the formula on the wikipedia page using `foo.nth_root(3)` for the cube root.


---

Comment by git created at 2015-11-17 08:36:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by nvcleemp created at 2015-11-17 08:39:31

Ok, this is a first version, but exact is not working. I guess this might be the same problem as Frédéric had with the snub cube, but I don't know. Constructing the object gives now problem, but calling `f_vector()` gives the wrong result. Also calling `show()` gives the following error message:


```
sage: sd.show()
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-4-4566439ff143> in <module>()
----> 1 sd.show()

/home/nvcleemp/Sage/sage/local/lib/python2.7/site-packages/sage/geometry/polyhedron/base.pyc in show(self, **kwds)
    706             sage: square.show(point='red')
    707         """
--> 708         self.plot(**kwds).show()
    709 
    710     def _repr_(self):

/home/nvcleemp/Sage/sage/local/lib/python2.7/site-packages/sage/geometry/polyhedron/base.pyc in plot(self, point, line, polygon, wireframe, fill, projection_direction, **kwds)
    678                 raise NotImplementedError('plotting of {0}-dimensional polyhedra not implemented'
    679                                           .format(self.ambient_dim()))
--> 680         return plot_method(*opts)
    681 
    682     def show(self, **kwds):

/home/nvcleemp/Sage/sage/local/lib/python2.7/site-packages/sage/geometry/polyhedron/plot.pyc in render_3d(self, point_opts, line_opts, polygon_opts)
   1246         if isinstance(point_opts, dict):
   1247             point_opts.setdefault('width', 3)
-> 1248             plt += self.render_vertices_3d(**point_opts)
   1249         if isinstance(line_opts, dict):
   1250             line_opts.setdefault('width', 3)

/home/nvcleemp/Sage/sage/local/lib/python2.7/site-packages/sage/geometry/polyhedron/plot.pyc in render_vertices_3d(self, **kwds)
   1080             ((-1.0, -1.0, -1.0), (1.0, 1.0, 1.0))
   1081         """
-> 1082         return point3d(self.coordinates_of(self.points), **kwds)
   1083 
   1084 

/home/nvcleemp/Sage/sage/local/lib/python2.7/site-packages/sage/plot/plot3d/shapes2.pyc in point3d(v, size, **kwds)
   1105             pass
   1106 
-> 1107     A = sum([Point(z, size, **kwds) for z in v])
   1108     A._set_extra_kwds(kwds)
   1109     return A

/home/nvcleemp/Sage/sage/local/lib/python2.7/site-packages/sage/plot/plot3d/shapes2.pyc in __init__(self, center, size, **kwds)
    717         """
    718         PrimitiveObject.__init__(self, **kwds)
--> 719         self.loc = (float(center[0]), float(center[1]), float(center[2]))
    720         self.size = size
    721         self._set_extra_kwds(kwds)

/home/nvcleemp/Sage/sage/src/sage/rings/number_field/number_field_element.pyx in sage.rings.number_field.number_field_element.NumberFieldElement.__float__ (/home/nvcleemp/Sage/sage/src/build/cythonized/sage/rings/number_field/number_field_element.cpp:15292)()
   1409         """
   1410         if self.parent().coerce_embedding() is None:
-> 1411             return float(self.base_ring()(self))
   1412         else:
   1413             c = complex(self)

/home/nvcleemp/Sage/sage/src/sage/structure/parent.pyx in sage.structure.parent.Parent.__call__ (/home/nvcleemp/Sage/sage/src/build/cythonized/sage/structure/parent.c:9547)()
   1095         if mor is not None:
   1096             if no_extra_args:
-> 1097                 return mor._call_(x)
   1098             else:
   1099                 return mor._call_with_args(x, args, kwds)

/home/nvcleemp/Sage/sage/src/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/home/nvcleemp/Sage/sage/src/build/cythonized/sage/structure/coerce_maps.c:4425)()
    107                 print type(C), C
    108                 print type(C._element_constructor), C._element_constructor
--> 109             raise
    110 
    111     cpdef Element _call_with_args(self, x, args=(), kwds={}):

/home/nvcleemp/Sage/sage/src/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/home/nvcleemp/Sage/sage/src/build/cythonized/sage/structure/coerce_maps.c:4332)()
    102         cdef Parent C = self._codomain
    103         try:
--> 104             return C._element_constructor(x)
    105         except Exception:
    106             if print_warnings:

/home/nvcleemp/Sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.pyc in _element_constructor_(self, x)
   1401                     return self._element_class(self, x)
   1402                 x = L(x)
-> 1403             return self._coerce_from_other_number_field(x)
   1404         elif sage.interfaces.gap.is_GapElement(x):
   1405             s = repr(x)

/home/nvcleemp/Sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.pyc in _coerce_from_other_number_field(self, x)
   6317             Kgen = F(Kgen)
   6318         else:
-> 6319             raise TypeError("No compatible natural embeddings found for %s and %s"%(KF,LF))
   6320 
   6321         # List of candidates for K(x)

TypeError: No compatible natural embeddings found for Real Lazy Field and Number Field in xi with defining polynomial x^3 - 2*x - 1/2*sqrt5 - 1/2 over its base field
```



---

Comment by tscrim created at 2015-11-17 15:39:35

Then why don't we just use RDF and not have an `exact` option for now. We can always give exact versions for both this (and the snub cube) later.


---

Comment by git created at 2015-11-18 08:19:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by nvcleemp created at 2015-11-18 08:20:56

OK, then this should be the last of the polyhedra for this ticket.


---

Comment by ncohen created at 2015-11-18 08:56:54

Would you mind if I added an automatic index of functions to this file? The list is growing.

Nathann


---

Comment by nvcleemp created at 2015-11-18 08:58:21

I certainly wouldn't mind. If I knew how to, I would have done it myself probably.

Cheers
Nico


---

Comment by ncohen created at 2015-11-18 09:04:01

> I certainly wouldn't mind. If I knew how to, I would have done it myself probably.

I wrote #19482 to fix this very problem.

Nathann


---

Comment by ncohen created at 2015-11-18 09:11:12

(doing it at the moment. Turns out that the 'imported' function are not so easy to sort out)


---

Comment by ncohen created at 2015-11-18 10:17:14

Hello again,

There was a small problem in the index code, which I now fixed at #19596.

If used in the library.py file without the fix, two functions are missing: `associahedron` and `flow_polytope`.

We have several ways out (tell me what you prefer):

1) We don't add any index in this ticket, waiting for #19596 to be reviewed

2) We add the index in this ticket, with #19596 as a dependency

3) We add the index in this ticket without #19596 as a dependency, and the two missing elements will appear whenever #19596 will be merged (possibly before the next beta anyway)

Have fun,

Nathann


---

Comment by vdelecroix created at 2015-11-18 18:14:00

Replying to [comment:38 nvcleemp]:
> Ok, this is a first version, but exact is not working. I guess this might be the same problem as Frédéric had with the snub cube, but I don't know. Constructing the object gives now problem, but calling `f_vector()` gives the wrong result. Also calling `show()` gives the following error message:


The problem is that comparisons (ie using `<` or `>`) does only work for quadratic field. There is a ticket needing review for that #17830. In the mean time everything is working well (but slowly) with `AA` the algebraic field:

```
sage: AA(3).sqrt().sqrt() < AA(2).sqrt()
True
```

You can notice that number fields for polyhedra are only used with quadratic fields...


---

Comment by nvcleemp created at 2015-11-19 06:42:26

Replying to [comment:46 ncohen]:
> We have several ways out (tell me what you prefer):
> 
> 1) We don't add any index in this ticket, waiting for #19596 to be reviewed
> 
> 2) We add the index in this ticket, with #19596 as a dependency
> 
> 3) We add the index in this ticket without #19596 as a dependency, and the two missing elements will appear whenever #19596 will be merged (possibly before the next beta anyway)

I don't have any real preference. As long as this ticket gets through fast. ;-) I will try to have a look at #19596 today or tomorrow.

Cheers
Nico


---

Comment by tscrim created at 2015-11-19 13:42:43

Replying to [comment:46 ncohen]:
> 3) We add the index in this ticket without #19596 as a dependency, and the two missing elements will appear whenever #19596 will be merged (possibly before the next beta anyway)

It's a separate issue in a way and this could be used as a test for #19596.


---

Comment by vbraun created at 2015-12-28 21:18:16

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-12-29 17:52:13

Resolution: fixed
