# Issue 12602: various enhancements for Coxeter and Weyl groups

archive/issues_012602.json:
```json
{
    "body": "Assignee: sage-combinat\n\nCC:  @nthiery @anneschilling\n\nKeywords: coxeter group, weyl group\n\nVarious enhancements to Coxeter groups and Weyl groups.\n\n1. Computes inversions for Coxeter/Weyl groups. They occur in three forms: reflections, roots, and coroots. \n\nNew Coxeter group element methods:\ncategories/coxeter_groups.py\n\napply_conjugation_by_simple_reflection\nlength_decreasing_reflections_right\nlength_decreasing_reflections_left\n\nNew Weyl group element methods:\ncategories/weyl_groups.py\n\nreflection_to_root\nreflection_to_coroot\ninversions\n\nNew root space element method:\ncombinat/root_system/root_space.py\n\nassociated_reflection\n\nBruhat covering relations have an associated inversion. Accordingly,\nwe have added versions of the Coxeter group element methods bruhat_lower_covers and bruhat_upper_covers which incorporate the inversion data:\n\nNew Coxeter group element methods:\ncategories/coxeter_groups.py\n\nbruhat_cocovers_reflections\nbruhat_covers_reflections\n\nNew Weyl group element methods:\ncategories/weyl_groups.py\n\nbruhat_cocovers_coroots\nbruhat_covers_coroots\n\n2. Installs the Demazure or 0-Hecke product for Coxeter groups\n\nNew Coxeter group parent method:\ncategories/coxeter_groups.py\n\ndemazure_product\n\nNew Coxeter group element methods:\ncategories/coxeter_groups.py\n\napply_demazure_simple_reflection\napply_demazure_product\nmin_demazure_product_greater\n\n3. Computes canonical lifts from quotients by parabolic subgroups.\nThis requires Deodhar's recovery of the Bruhat order on a Coxeter group from that on a parabolic subgroup and the quotient by that subgroup.\n\nNew Coxeter group element methods:\ncategories/coxeter_groups.py\n\ndeodhar_factor_element\ndeodhar_lift_up\ndeodhar_lift_down\n\n4. Two random little methods for root systems\n\nsage/combinat/root_system/root_lattice_realizations.py:\nnew parent method:\npositive_roots_by_height\n\nsage/combinat/root_system/root_space.py:\nnew element method:\nmax_coroot_le\n\nIssue created by migration from https://trac.sagemath.org/ticket/12774\n\n",
    "created_at": "2012-03-28T20:13:41Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.8",
    "title": "various enhancements for Coxeter and Weyl groups",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12602",
    "user": "https://trac.sagemath.org/admin/accounts/users/mshimo"
}
```
Assignee: sage-combinat

CC:  @nthiery @anneschilling

Keywords: coxeter group, weyl group

Various enhancements to Coxeter groups and Weyl groups.

1. Computes inversions for Coxeter/Weyl groups. They occur in three forms: reflections, roots, and coroots. 

New Coxeter group element methods:
categories/coxeter_groups.py

apply_conjugation_by_simple_reflection
length_decreasing_reflections_right
length_decreasing_reflections_left

New Weyl group element methods:
categories/weyl_groups.py

reflection_to_root
reflection_to_coroot
inversions

New root space element method:
combinat/root_system/root_space.py

associated_reflection

Bruhat covering relations have an associated inversion. Accordingly,
we have added versions of the Coxeter group element methods bruhat_lower_covers and bruhat_upper_covers which incorporate the inversion data:

New Coxeter group element methods:
categories/coxeter_groups.py

bruhat_cocovers_reflections
bruhat_covers_reflections

New Weyl group element methods:
categories/weyl_groups.py

bruhat_cocovers_coroots
bruhat_covers_coroots

2. Installs the Demazure or 0-Hecke product for Coxeter groups

New Coxeter group parent method:
categories/coxeter_groups.py

demazure_product

New Coxeter group element methods:
categories/coxeter_groups.py

apply_demazure_simple_reflection
apply_demazure_product
min_demazure_product_greater

3. Computes canonical lifts from quotients by parabolic subgroups.
This requires Deodhar's recovery of the Bruhat order on a Coxeter group from that on a parabolic subgroup and the quotient by that subgroup.

New Coxeter group element methods:
categories/coxeter_groups.py

deodhar_factor_element
deodhar_lift_up
deodhar_lift_down

4. Two random little methods for root systems

sage/combinat/root_system/root_lattice_realizations.py:
new parent method:
positive_roots_by_height

sage/combinat/root_system/root_space.py:
new element method:
max_coroot_le

Issue created by migration from https://trac.sagemath.org/ticket/12774





---

archive/issue_comments_149657.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-03-31T06:33:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149657",
    "user": "https://trac.sagemath.org/admin/accounts/users/mshimo"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_149658.json:
```json
{
    "body": "I went through your changes for Coxeter groups -- it looks nice and clean so far! I  attach a review patch with several minor modifications. I used your patch from the combinat queue, so please update the one here if necessary. Also, please update the header of the patch file (concerns auther and dependencies).\n\nBest, Christian",
    "created_at": "2012-08-11T17:24:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149658",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

I went through your changes for Coxeter groups -- it looks nice and clean so far! I  attach a review patch with several minor modifications. I used your patch from the combinat queue, so please update the one here if necessary. Also, please update the header of the patch file (concerns auther and dependencies).

Best, Christian



---

archive/issue_comments_149659.json:
```json
{
    "body": "Hi Mark,\n\nI also went through categories/weyl_groups and made some minor changes. The only interesting is: I merged reflection_to_coroot into reflection_to_root and added an optional argument.\n\nI hope to finish my review tonight...\n\nbtw: the patch needs to be rebased for sage-5.3.beta0 once we finish it.\n\nBest, Christian",
    "created_at": "2012-08-13T08:57:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149659",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Hi Mark,

I also went through categories/weyl_groups and made some minor changes. The only interesting is: I merged reflection_to_coroot into reflection_to_root and added an optional argument.

I hope to finish my review tonight...

btw: the patch needs to be rebased for sage-5.3.beta0 once we finish it.

Best, Christian



---

archive/issue_comments_149660.json:
```json
{
    "body": "Hi,\n\nconcerning the modifications in RootLatticeRealizations:\n\n- why don't we move this file into categories? (this might be answered somewhere else but I don't remember right now)\n\n- shouldn't we implement the various methods for roots (roots, positive_roots, negative_roots, -_parabolic, -_nonparabolic, ...) right away as well for general Coxeter groups? It looks like we are not very far from that anyway (I actually do some rudimentary implementation in my other patch on Coxeter groups, but this part would perfectly fit here)\n\nChristian",
    "created_at": "2012-08-14T08:53:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149660",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Hi,

concerning the modifications in RootLatticeRealizations:

- why don't we move this file into categories? (this might be answered somewhere else but I don't remember right now)

- shouldn't we implement the various methods for roots (roots, positive_roots, negative_roots, -_parabolic, -_nonparabolic, ...) right away as well for general Coxeter groups? It looks like we are not very far from that anyway (I actually do some rudimentary implementation in my other patch on Coxeter groups, but this part would perfectly fit here)

Christian



---

archive/issue_comments_149661.json:
```json
{
    "body": "apply trac_12774-coxeter-ms-v2.patch",
    "created_at": "2012-11-19T17:25:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149661",
    "user": "https://github.com/fchapoton"
}
```

apply trac_12774-coxeter-ms-v2.patch



---

archive/issue_comments_149662.json:
```json
{
    "body": "apply trac_12774-coxeter-ms-v2.patch",
    "created_at": "2012-11-19T19:46:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149662",
    "user": "https://github.com/fchapoton"
}
```

apply trac_12774-coxeter-ms-v2.patch



---

archive/issue_comments_149663.json:
```json
{
    "body": "apply trac_12774-coxeter-ms-v2.patch\n\nI have just folded and rebased this patch. The bot seems to be green and happy.\n\nThis looks good to me. Anne, Nicolas, Christian, do you want to have a look ?",
    "created_at": "2012-11-19T20:22:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149663",
    "user": "https://github.com/fchapoton"
}
```

apply trac_12774-coxeter-ms-v2.patch

I have just folded and rebased this patch. The bot seems to be green and happy.

This looks good to me. Anne, Nicolas, Christian, do you want to have a look ?



---

archive/issue_comments_149664.json:
```json
{
    "body": "apply trac_12774-coxeter-ms-v2.patch\n\nI have corrected the deprecations",
    "created_at": "2012-11-19T20:48:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149664",
    "user": "https://github.com/fchapoton"
}
```

apply trac_12774-coxeter-ms-v2.patch

I have corrected the deprecations



---

archive/issue_comments_149665.json:
```json
{
    "body": "Replying to [comment:9 chapoton]:\n> apply trac_12774-coxeter-ms-v2.patch\n> \n> I have just folded and rebased this patch. The bot seems to be green and happy.\n> \n> This looks good to me. Anne, Nicolas, Christian, do you want to have a look ?\n\n\nHas Mark answered or taken into account all of Christian's previous comments? If not, that should be done first!\n\nAnne",
    "created_at": "2012-11-20T08:02:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149665",
    "user": "https://github.com/anneschilling"
}
```

Replying to [comment:9 chapoton]:
> apply trac_12774-coxeter-ms-v2.patch
> 
> I have just folded and rebased this patch. The bot seems to be green and happy.
> 
> This looks good to me. Anne, Nicolas, Christian, do you want to have a look ?


Has Mark answered or taken into account all of Christian's previous comments? If not, that should be done first!

Anne



---

archive/issue_comments_149666.json:
```json
{
    "body": "What are cocovers? should the new methods be named instead bruhat_upper_covers_* / bruhat_lower_covers_* for consistency with posets?\n\nCheers,\n                                 Nicolas",
    "created_at": "2012-11-21T21:07:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149666",
    "user": "https://github.com/nthiery"
}
```

What are cocovers? should the new methods be named instead bruhat_upper_covers_* / bruhat_lower_covers_* for consistency with posets?

Cheers,
                                 Nicolas



---

archive/issue_comments_149667.json:
```json
{
    "body": "Regarding Comment 6, first question: I don't know. (Nicolas, can you answer this?)\nHowever I tried to put certain things involving root systems into\ncategories and had my first encounter with import loops.\nComment 6 second question: Since I don't know how much work it would take (and since my methods\nuse root data, which is more information than the Cartan data needed for a Coxeter group) \nmy vote is to finalize this patch without the extension to Coxeter groups.\n\nRegarding Comment 12: Cocovers are what you are calling \"lower covers\" and covers are what you are calling\n\"upper covers\". I can change the names if you insist.",
    "created_at": "2013-02-12T13:54:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149667",
    "user": "https://trac.sagemath.org/admin/accounts/users/mshimo"
}
```

Regarding Comment 6, first question: I don't know. (Nicolas, can you answer this?)
However I tried to put certain things involving root systems into
categories and had my first encounter with import loops.
Comment 6 second question: Since I don't know how much work it would take (and since my methods
use root data, which is more information than the Cartan data needed for a Coxeter group) 
my vote is to finalize this patch without the extension to Coxeter groups.

Regarding Comment 12: Cocovers are what you are calling "lower covers" and covers are what you are calling
"upper covers". I can change the names if you insist.



---

archive/issue_comments_149668.json:
```json
{
    "body": "Does the version of the patch here reflection the current status?",
    "created_at": "2013-02-14T13:57:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149668",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Does the version of the patch here reflection the current status?



---

archive/issue_comments_149669.json:
```json
{
    "body": "Replying to [comment:14 stumpc5]:\n> Does the version of the patch here reflection the current status?\n\n\nI didn't change anything yet. \nThe only additional changes I was planning to make (but have not yet made)\nwere the method renamings that Nicolas suggested.",
    "created_at": "2013-02-14T14:23:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149669",
    "user": "https://trac.sagemath.org/admin/accounts/users/mshimo"
}
```

Replying to [comment:14 stumpc5]:
> Does the version of the patch here reflection the current status?


I didn't change anything yet. 
The only additional changes I was planning to make (but have not yet made)
were the method renamings that Nicolas suggested.



---

archive/issue_comments_149670.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-02-14T22:07:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149670",
    "user": "https://github.com/anneschilling"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_149671.json:
```json
{
    "body": "Mark and I went through the patch at Sage Days 45 and reviewed it together. Everything looks fine!",
    "created_at": "2013-02-14T22:11:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149671",
    "user": "https://github.com/anneschilling"
}
```

Mark and I went through the patch at Sage Days 45 and reviewed it together. Everything looks fine!



---

archive/issue_comments_149672.json:
```json
{
    "body": "Changing keywords from \"coxeter group, weyl group\" to \"coxeter group, weyl group, days45\".",
    "created_at": "2013-02-14T22:13:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149672",
    "user": "https://github.com/anneschilling"
}
```

Changing keywords from "coxeter group, weyl group" to "coxeter group, weyl group, days45".



---

archive/issue_events_034721.json:
```json
{
    "actor": "https://github.com/anneschilling",
    "created_at": "2013-02-14T22:19:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "milestone": "sage-5.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12602#event-34721"
}
```



---

archive/issue_comments_149673.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-02-15T08:23:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149673",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_149674.json:
```json
{
    "body": "You should not use \"assert\" for bad user input, only to check for actual bugs. Bad input should probably give a `ValueError` instead. The correct use for `assert` is to check for conditions which you *know* are true if the program wouldn't have bugs.\n\nIf there is any way at all to reproduce an `AssertionError` using documented public functions, that is by definition a bug.",
    "created_at": "2013-02-15T08:23:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149674",
    "user": "https://github.com/jdemeyer"
}
```

You should not use "assert" for bad user input, only to check for actual bugs. Bad input should probably give a `ValueError` instead. The correct use for `assert` is to check for conditions which you *know* are true if the program wouldn't have bugs.

If there is any way at all to reproduce an `AssertionError` using documented public functions, that is by definition a bug.



---

archive/issue_comments_149675.json:
```json
{
    "body": "Attachment [trac_12774-coxeter-ms.patch](tarball://root/attachments/some-uuid/ticket12774/trac_12774-coxeter-ms.patch) by mshimo created at 2013-02-15 20:20:49",
    "created_at": "2013-02-15T20:20:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149675",
    "user": "https://trac.sagemath.org/admin/accounts/users/mshimo"
}
```

Attachment [trac_12774-coxeter-ms.patch](tarball://root/attachments/some-uuid/ticket12774/trac_12774-coxeter-ms.patch) by mshimo created at 2013-02-15 20:20:49



---

archive/issue_comments_149676.json:
```json
{
    "body": "Looks good now!",
    "created_at": "2013-02-15T21:06:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149676",
    "user": "https://github.com/anneschilling"
}
```

Looks good now!



---

archive/issue_comments_149677.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2013-02-15T21:07:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149677",
    "user": "https://github.com/anneschilling"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_149678.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-02-17T22:42:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12602#issuecomment-149678",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_034722.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-02-17T22:42:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12602",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12602#event-34722"
}
```
