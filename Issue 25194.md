# Issue 25194: Timeouts in lattice precision

archive/issues_025194.json:
```json
{
    "body": "CC:  @xcaruso @roed314 @fchapoton\n\nThe patchbots time out with some lattice precision tests https://patchbot.sagemath.org/log/0/Ubuntu/18.04/x86_64/4.15.0-20-generic/petitbonum/2018-05-11%2012:03:31?short\n\nI have also seen the same issues with [GitLab](GitLab) CI tests. The timeout is in `padic_lattice_element` here:\n\n```\nsage: R = ZpLC(2, label='init') # indirect doctest ## line 868 ##\nsage: R ## line 869 ##\n2-adic Ring with lattice-cap precision (label: init)\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 871 ##\n0\nsage: R = ZpLC(7, label='init') ## line 878 ##\nsage: TestSuite(R).run(skip='_test_teichmuller') ## line 879 ##\n```\n\n\nand in `padic_base_leaves` here\n\n```\nsage: TestSuite(R).run(skip=['_test_teichmuller']) ## line 13 ##\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/25431\n\n",
    "created_at": "2018-05-23T11:49:01Z",
    "labels": [
        "padics",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "Timeouts in lattice precision",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25194",
    "user": "@saraedum"
}
```
CC:  @xcaruso @roed314 @fchapoton

The patchbots time out with some lattice precision tests https://patchbot.sagemath.org/log/0/Ubuntu/18.04/x86_64/4.15.0-20-generic/petitbonum/2018-05-11%2012:03:31?short

I have also seen the same issues with [GitLab](GitLab) CI tests. The timeout is in `padic_lattice_element` here:

```
sage: R = ZpLC(2, label='init') # indirect doctest ## line 868 ##
sage: R ## line 869 ##
2-adic Ring with lattice-cap precision (label: init)
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 871 ##
0
sage: R = ZpLC(7, label='init') ## line 878 ##
sage: TestSuite(R).run(skip='_test_teichmuller') ## line 879 ##
```


and in `padic_base_leaves` here

```
sage: TestSuite(R).run(skip=['_test_teichmuller']) ## line 13 ##
```


Issue created by migration from https://trac.sagemath.org/ticket/25431





---

archive/issue_comments_354720.json:
```json
{
    "body": "I have not run doctests yet, so let's see if the patchbots are happy now.\n----\nNew commits:",
    "created_at": "2018-05-23T12:16:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25194#issuecomment-354720",
    "user": "@saraedum"
}
```

I have not run doctests yet, so let's see if the patchbots are happy now.
----
New commits:



---

archive/issue_comments_354721.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-05-23T12:16:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25194#issuecomment-354721",
    "user": "@saraedum"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_354722.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-05-23T12:19:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25194#issuecomment-354722",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_354723.json:
```json
{
    "body": "I have launched my patchbot having the timeout issue, to see if the branch brings any progress.",
    "created_at": "2018-05-23T19:25:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25194#issuecomment-354723",
    "user": "@fchapoton"
}
```

I have launched my patchbot having the timeout issue, to see if the branch brings any progress.



---

archive/issue_comments_354724.json:
```json
{
    "body": "This indeed seems to fix the timeout issue (see petibonum report)\n\nNote: my patchbot has found some pyflakes errors in the modified files, see the pyflakes plugin.",
    "created_at": "2018-05-24T05:25:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25194#issuecomment-354724",
    "user": "@fchapoton"
}
```

This indeed seems to fix the timeout issue (see petibonum report)

Note: my patchbot has found some pyflakes errors in the modified files, see the pyflakes plugin.



---

archive/issue_comments_354725.json:
```json
{
    "body": "FYI: short doctests should take at most 1 second or so and long doctests at most 30 seconds (unless for exceptional reasons).",
    "created_at": "2018-05-24T19:39:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25194#issuecomment-354725",
    "user": "@jdemeyer"
}
```

FYI: short doctests should take at most 1 second or so and long doctests at most 30 seconds (unless for exceptional reasons).



---

archive/issue_comments_354726.json:
```json
{
    "body": "I fixed the pyflakes warnings.\n----\nNew commits:",
    "created_at": "2018-05-24T22:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25194#issuecomment-354726",
    "user": "@xcaruso"
}
```

I fixed the pyflakes warnings.
----
New commits:



---

archive/issue_comments_354727.json:
```json
{
    "body": "Xavier, your changes look good. Can you review my original changes?",
    "created_at": "2018-05-26T11:08:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25194#issuecomment-354727",
    "user": "@saraedum"
}
```

Xavier, your changes look good. Can you review my original changes?



---

archive/issue_comments_354728.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-05-26T14:58:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25194#issuecomment-354728",
    "user": "@loefflerd"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_354729.json:
```json
{
    "body": "Changes look reasonable + it gets the timings down to an acceptable level. Positive review.",
    "created_at": "2018-05-26T14:58:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25194#issuecomment-354729",
    "user": "@loefflerd"
}
```

Changes look reasonable + it gets the timings down to an acceptable level. Positive review.



---

archive/issue_comments_354730.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-28T07:45:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25194#issuecomment-354730",
    "user": "@vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_354731.json:
```json
{
    "body": "As noted on the mailing list, I am also getting\n\n\n```\nsage -t src/sage/rings/padics/padic_base_leaves.py\n    Timed out (with segmentation fault after interrupt)\n```\n\n\non cygwin.  I will test this patch and see if the tests at least pass with these tests skipped by default (and I will also test with `--long`)",
    "created_at": "2018-05-31T09:48:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25194",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25194#issuecomment-354731",
    "user": "@embray"
}
```

As noted on the mailing list, I am also getting


```
sage -t src/sage/rings/padics/padic_base_leaves.py
    Timed out (with segmentation fault after interrupt)
```


on cygwin.  I will test this patch and see if the tests at least pass with these tests skipped by default (and I will also test with `--long`)
