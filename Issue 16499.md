# Issue 16499: sagenb: SandboxViolation in webassets

archive/issues_016499.json:
```json
{
    "body": "CC:  ppurka leif rws fbissey\n\n\n```\nProcessing webassets-0.9.tar.gz\nWriting /tmp/easy_install-hklIUJ/webassets-0.9/setup.cfg\nRunning webassets-0.9/setup.py -q bdist_egg --dist-dir /tmp/easy_install-hklIUJ/webassets-0.9/egg-dist-tmp-Cwkw_W\nerror: SandboxViolation: chmod('/home/buildslave-sage/slave/sage_git/dot_sage/.python-eggs/Pillow-2.2.2-py2.7-linux-x86_64.egg-tmp/PIL/tmpelb5a7.$extract', 493) {}\n```\n\nPossibly due to the newer setuptools doing a better job at checking for shenanigans...\n\nIssue created by migration from https://trac.sagemath.org/ticket/16736\n\n",
    "created_at": "2014-07-30T01:42:26Z",
    "labels": [
        "user interface",
        "major",
        "bug"
    ],
    "title": "sagenb: SandboxViolation in webassets",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16499",
    "user": "vbraun"
}
```
CC:  ppurka leif rws fbissey


```
Processing webassets-0.9.tar.gz
Writing /tmp/easy_install-hklIUJ/webassets-0.9/setup.cfg
Running webassets-0.9/setup.py -q bdist_egg --dist-dir /tmp/easy_install-hklIUJ/webassets-0.9/egg-dist-tmp-Cwkw_W
error: SandboxViolation: chmod('/home/buildslave-sage/slave/sage_git/dot_sage/.python-eggs/Pillow-2.2.2-py2.7-linux-x86_64.egg-tmp/PIL/tmpelb5a7.$extract', 493) {}
```

Possibly due to the newer setuptools doing a better job at checking for shenanigans...

Issue created by migration from https://trac.sagemath.org/ticket/16736





---

archive/issue_comments_216979.json:
```json
{
    "body": "The reason is that webasset setup.py imports sphinx to do some crap. Which ultimately imports PIL/Pillow which causes the egg to be unpacked, violating the sandbox.\n\nWhy does sagenb come with webassets to start with? Its not used anywhere, it seems. Some packaged js files were generated with it?",
    "created_at": "2014-07-30T02:45:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216979",
    "user": "vbraun"
}
```

The reason is that webasset setup.py imports sphinx to do some crap. Which ultimately imports PIL/Pillow which causes the egg to be unpacked, violating the sandbox.

Why does sagenb come with webassets to start with? Its not used anywhere, it seems. Some packaged js files were generated with it?



---

archive/issue_comments_216980.json:
```json
{
    "body": "I guess the ideal solution would be to use distutils / pip instead of easy_install (who cares about binary eggs)? Though that would probably be a bigger task. For now, just allow chmod outside of the setuptools sandbox (and, really, fixing permissions isn't so bad).\n\nUpdating to the latest setuptools alone didn't fix it, but we should do that anyway.\n----\nNew commits:",
    "created_at": "2014-07-30T03:19:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216980",
    "user": "vbraun"
}
```

I guess the ideal solution would be to use distutils / pip instead of easy_install (who cares about binary eggs)? Though that would probably be a bigger task. For now, just allow chmod outside of the setuptools sandbox (and, really, fixing permissions isn't so bad).

Updating to the latest setuptools alone didn't fix it, but we should do that anyway.
----
New commits:



---

archive/issue_comments_216981.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-07-30T03:19:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216981",
    "user": "vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_216982.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2014-07-30T03:20:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216982",
    "user": "vbraun"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_216983.json:
```json
{
    "body": "Not sure what webassets does either. Is it just me or there is a violent inflation in setuptools version numbers - worse than chrome even.",
    "created_at": "2014-07-30T03:30:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216983",
    "user": "fbissey"
}
```

Not sure what webassets does either. Is it just me or there is a violent inflation in setuptools version numbers - worse than chrome even.



---

archive/issue_comments_216984.json:
```json
{
    "body": "In fact I hadn't noticed that webassets had been upgraded past 0.7.1.",
    "created_at": "2014-07-30T03:42:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216984",
    "user": "fbissey"
}
```

In fact I hadn't noticed that webassets had been upgraded past 0.7.1.



---

archive/issue_comments_216985.json:
```json
{
    "body": "The whole packages-inside-sagenb thing needs to be fixed at one point, too. But this is also not the scope of this ticket, but make a new beta that can be installed from scratch.",
    "created_at": "2014-07-30T03:46:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216985",
    "user": "vbraun"
}
```

The whole packages-inside-sagenb thing needs to be fixed at one point, too. But this is also not the scope of this ticket, but make a new beta that can be installed from scratch.



---

archive/issue_comments_216986.json:
```json
{
    "body": "This seems to be caused by #16733, so I'll unmerge that upgrade until somebody can review this.",
    "created_at": "2014-07-30T21:13:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216986",
    "user": "vbraun"
}
```

This seems to be caused by #16733, so I'll unmerge that upgrade until somebody can review this.



---

archive/issue_comments_216987.json:
```json
{
    "body": "Changing priority from blocker to major.",
    "created_at": "2014-07-30T21:14:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216987",
    "user": "vbraun"
}
```

Changing priority from blocker to major.



---

archive/issue_comments_216988.json:
```json
{
    "body": "Changing component from user interface to packages: standard.",
    "created_at": "2014-07-30T21:14:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216988",
    "user": "vbraun"
}
```

Changing component from user interface to packages: standard.



---

archive/issue_comments_216989.json:
```json
{
    "body": "I am not convinced by the solution I will try something in the next few hours before accepting this.",
    "created_at": "2014-07-31T05:24:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216989",
    "user": "fbissey"
}
```

I am not convinced by the solution I will try something in the next few hours before accepting this.



---

archive/issue_comments_216990.json:
```json
{
    "body": "So far I haven't been able to reproduce this. I am guessing this is a from scratch install while I am working on top of beta7 which may have an impact.",
    "created_at": "2014-07-31T09:53:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216990",
    "user": "fbissey"
}
```

So far I haven't been able to reproduce this. I am guessing this is a from scratch install while I am working on top of beta7 which may have an impact.



---

archive/issue_comments_216991.json:
```json
{
    "body": "You probably need to (re-)install by hand the new docutils and pillow. Or rebuild from scratch (with #16733 merged in).",
    "created_at": "2014-07-31T14:01:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216991",
    "user": "vbraun"
}
```

You probably need to (re-)install by hand the new docutils and pillow. Or rebuild from scratch (with #16733 merged in).



---

archive/issue_comments_216992.json:
```json
{
    "body": "This is very curious. I merged #16733 and this ticket w/o the `sandbox.patch` (the patch was removed and the change was committed with `git commit -a`). The following sequence did not give a `SandboxViolation` in webassets:\n* ./sage -f docutils\n* ./sage -f setuptools\n* ./sage -f sagenb\nBut the following sequence did yield the violation (new docutils installed)\n* ./sage -f pillow\n* ./sage -f setuptools\n* ./sage -f sagenb\nThen adding the sandbox patch in and doing\n* ./sage -f setuptools\n* ./sage -f sagenb\nseemed to resolve things. So where is the real problem? Maybe it doesn't matter. The sandbox patch does work.",
    "created_at": "2014-08-02T19:13:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216992",
    "user": "strogdon"
}
```

This is very curious. I merged #16733 and this ticket w/o the `sandbox.patch` (the patch was removed and the change was committed with `git commit -a`). The following sequence did not give a `SandboxViolation` in webassets:
* ./sage -f docutils
* ./sage -f setuptools
* ./sage -f sagenb
But the following sequence did yield the violation (new docutils installed)
* ./sage -f pillow
* ./sage -f setuptools
* ./sage -f sagenb
Then adding the sandbox patch in and doing
* ./sage -f setuptools
* ./sage -f sagenb
seemed to resolve things. So where is the real problem? Maybe it doesn't matter. The sandbox patch does work.



---

archive/issue_comments_216993.json:
```json
{
    "body": "Interesting digging Steve. I am sure the patch works, I just think it is the wrong thing to do but I don't know any alternative, apart from trying to upgrade webassets since there is a newer release - of course it is likely it will suffer the same fate.",
    "created_at": "2014-08-02T20:06:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216993",
    "user": "fbissey"
}
```

Interesting digging Steve. I am sure the patch works, I just think it is the wrong thing to do but I don't know any alternative, apart from trying to upgrade webassets since there is a newer release - of course it is likely it will suffer the same fate.



---

archive/issue_comments_216994.json:
```json
{
    "body": "I tried upgrading webassets and it didn't work. The setup.py is till importing sphinx, so it'll die if that ends up pulling in pil(low)",
    "created_at": "2014-08-03T00:53:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216994",
    "user": "vbraun"
}
```

I tried upgrading webassets and it didn't work. The setup.py is till importing sphinx, so it'll die if that ends up pulling in pil(low)



---

archive/issue_comments_216995.json:
```json
{
    "body": "OK so that potentially pushes the problem in sphinx and upgrading that brings its own problems. Or may be pillow, that would be easier to try that.",
    "created_at": "2014-08-03T03:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216995",
    "user": "fbissey"
}
```

OK so that potentially pushes the problem in sphinx and upgrading that brings its own problems. Or may be pillow, that would be easier to try that.



---

archive/issue_comments_216996.json:
```json
{
    "body": "I've installed sphinx-1.2.2, merged #16733 and this ticket w/o the sandbox patch and I have no `SandboxViolation`. However, #16396 can't be merged w/o some work. Is it possible that sphinx-1.2.2 doesn't import pillow? I believe what I've done is correct. But maybe the sandbox patch is the thing to do in the short-term.",
    "created_at": "2014-08-03T05:11:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216996",
    "user": "strogdon"
}
```

I've installed sphinx-1.2.2, merged #16733 and this ticket w/o the sandbox patch and I have no `SandboxViolation`. However, #16396 can't be merged w/o some work. Is it possible that sphinx-1.2.2 doesn't import pillow? I believe what I've done is correct. But maybe the sandbox patch is the thing to do in the short-term.



---

archive/issue_comments_216997.json:
```json
{
    "body": "I really think that shooting an element of the sandbox for just one package is not good. It would be better if an exception could be made until we fix the faulty package rather than sabotaging setuptools.",
    "created_at": "2014-08-03T22:49:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216997",
    "user": "fbissey"
}
```

I really think that shooting an element of the sandbox for just one package is not good. It would be better if an exception could be made until we fix the faulty package rather than sabotaging setuptools.



---

archive/issue_comments_216998.json:
```json
{
    "body": "OK the call to sphinx in webassets is really limited to\n\n```\ntry:\n    from sphinx.setup_command import BuildDoc\n    cmdclass = {'build_sphinx': BuildDoc}\nexcept ImportError:\n    cmdclass = {}\n```\n\nat the top of setup.py There are calls in docs/conf.py but they probably won't be called if we remove the above. I propose we have a patched webassets in sagenb rather than breaking setuptools' sandbox.",
    "created_at": "2014-08-03T22:58:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216998",
    "user": "fbissey"
}
```

OK the call to sphinx in webassets is really limited to

```
try:
    from sphinx.setup_command import BuildDoc
    cmdclass = {'build_sphinx': BuildDoc}
except ImportError:
    cmdclass = {}
```

at the top of setup.py There are calls in docs/conf.py but they probably won't be called if we remove the above. I propose we have a patched webassets in sagenb rather than breaking setuptools' sandbox.



---

archive/issue_comments_216999.json:
```json
{
    "body": "Perhaps naive but is there any undesirable side effect of adding something like\n\n`export PYTHON_EGG_CACHE=\"./.python-eggs\"` \n\nto `build/pkgs/sagenb/spkg-install`? I'm not sure where `\".\"` is during the install of sagenb but it's apparently not outside the sandbox.",
    "created_at": "2014-08-04T23:40:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-216999",
    "user": "strogdon"
}
```

Perhaps naive but is there any undesirable side effect of adding something like

`export PYTHON_EGG_CACHE="./.python-eggs"` 

to `build/pkgs/sagenb/spkg-install`? I'm not sure where `"."` is during the install of sagenb but it's apparently not outside the sandbox.



---

archive/issue_comments_217000.json:
```json
{
    "body": "Doing the above, a build from scratch was successful w/o the sandbox patch.",
    "created_at": "2014-08-05T03:52:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217000",
    "user": "strogdon"
}
```

Doing the above, a build from scratch was successful w/o the sandbox patch.



---

archive/issue_comments_217001.json:
```json
{
    "body": "Replying to [comment:22 strogdon]:\n> Doing the above, a build from scratch was successful w/o the sandbox patch.\n\nI definitely would take that over the current patch. It is much simpler.",
    "created_at": "2014-08-05T10:48:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217001",
    "user": "fbissey"
}
```

Replying to [comment:22 strogdon]:
> Doing the above, a build from scratch was successful w/o the sandbox patch.

I definitely would take that over the current patch. It is much simpler.



---

archive/issue_comments_217002.json:
```json
{
    "body": "Putting the egg cache in a location that you aren't sure of is potentially a security issue.\n\nI've asked on sage-devel whether we can remove webassets: https://groups.google.com/d/msg/sage-devel/fEeGgVWuk7I/Nmc5kcVXfZYJ",
    "created_at": "2014-08-05T12:46:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217002",
    "user": "vbraun"
}
```

Putting the egg cache in a location that you aren't sure of is potentially a security issue.

I've asked on sage-devel whether we can remove webassets: https://groups.google.com/d/msg/sage-devel/fEeGgVWuk7I/Nmc5kcVXfZYJ



---

archive/issue_comments_217003.json:
```json
{
    "body": "Any news? If you want a different solution then post a branch...",
    "created_at": "2014-08-11T14:29:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217003",
    "user": "vbraun"
}
```

Any news? If you want a different solution then post a branch...



---

archive/issue_comments_217004.json:
```json
{
    "body": "I think the best fix is to push for #16396 to be finished.",
    "created_at": "2014-08-11T21:15:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217004",
    "user": "fbissey"
}
```

I think the best fix is to push for #16396 to be finished.



---

archive/issue_comments_217005.json:
```json
{
    "body": "Just to note that [the reason for webassets](https://groups.google.com/d/msg/sage-devel/fEeGgVWuk7I/nDOHbclqLUAJ) was discovered, though hopefully this is a moot point now that #16396 is positive review.",
    "created_at": "2014-10-21T20:22:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217005",
    "user": "kcrisman"
}
```

Just to note that [the reason for webassets](https://groups.google.com/d/msg/sage-devel/fEeGgVWuk7I/nDOHbclqLUAJ) was discovered, though hopefully this is a moot point now that #16396 is positive review.



---

archive/issue_comments_217006.json:
```json
{
    "body": "I very much hope we can fix it invalid once the whole new docutils/sphinx/sagenb is in.",
    "created_at": "2014-10-21T20:51:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217006",
    "user": "fbissey"
}
```

I very much hope we can fix it invalid once the whole new docutils/sphinx/sagenb is in.



---

archive/issue_comments_217007.json:
```json
{
    "body": "If things are fixed then there is perhaps the question of whether to upgrade setuptools anyway. But maybe another ticket.",
    "created_at": "2014-10-21T22:20:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217007",
    "user": "strogdon"
}
```

If things are fixed then there is perhaps the question of whether to upgrade setuptools anyway. But maybe another ticket.



---

archive/issue_comments_217008.json:
```json
{
    "body": "OK, I've merged #16396 and #16733 on top of 6.4.beta6 and I don't see the `SandboxViolation` when building sagenb. I would feel more comfortable if someone else would also confirm this. I also tried things with setuptool-5.4.1 and when rebuilding sphinx-1.2.2 (after a make) I get an error\n\n```\nRemoving old version of Sphinx...\nrm: cannot remove '/64bitdev/storage/sage-git_develop/sage/local/lib/python/site-packages/Sphinx-1.2.2-py2.7.egg/sphinx': Directo\nry not empty\nError building Sphinx: 'Error deleting previous version'\n```\n\n\nThe only file in the subject folder is\n\n```\nls /64bitdev/storage/sage-git_develop/sage/local/lib/python/site-packages/Sphinx-1.2.2-py2.7.egg/sphinx\n__init__.pyc\n```\n",
    "created_at": "2014-10-21T23:59:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217008",
    "user": "strogdon"
}
```

OK, I've merged #16396 and #16733 on top of 6.4.beta6 and I don't see the `SandboxViolation` when building sagenb. I would feel more comfortable if someone else would also confirm this. I also tried things with setuptool-5.4.1 and when rebuilding sphinx-1.2.2 (after a make) I get an error

```
Removing old version of Sphinx...
rm: cannot remove '/64bitdev/storage/sage-git_develop/sage/local/lib/python/site-packages/Sphinx-1.2.2-py2.7.egg/sphinx': Directo
ry not empty
Error building Sphinx: 'Error deleting previous version'
```


The only file in the subject folder is

```
ls /64bitdev/storage/sage-git_develop/sage/local/lib/python/site-packages/Sphinx-1.2.2-py2.7.egg/sphinx
__init__.pyc
```




---

archive/issue_comments_217009.json:
```json
{
    "body": "Well I'm unable to reproduce the above sphinx build error. I'm not sure what the source could have been. Also I see no `SandboxViolation` with setuptools-5.4.1 added on top of #16396 and #16733 without the `sandbox.patch`.",
    "created_at": "2014-10-22T04:20:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217009",
    "user": "strogdon"
}
```

Well I'm unable to reproduce the above sphinx build error. I'm not sure what the source could have been. Also I see no `SandboxViolation` with setuptools-5.4.1 added on top of #16396 and #16733 without the `sandbox.patch`.



---

archive/issue_comments_217010.json:
```json
{
    "body": "A bit late. I just noticed we haven't updated docutils in 6.4.rc0/rc1 because this ticket is blocking it. This is a positive review \"works for me/invalid\" I guess.",
    "created_at": "2014-11-02T00:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217010",
    "user": "fbissey"
}
```

A bit late. I just noticed we haven't updated docutils in 6.4.rc0/rc1 because this ticket is blocking it. This is a positive review "works for me/invalid" I guess.



---

archive/issue_comments_217011.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-11-02T00:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217011",
    "user": "fbissey"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_217012.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2014-11-15T16:25:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217012",
    "user": "vbraun"
}
```

Resolution: invalid



---

archive/issue_comments_217013.json:
```json
{
    "body": "You are supposed to set the milestone to invalid...",
    "created_at": "2014-11-15T16:25:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217013",
    "user": "vbraun"
}
```

You are supposed to set the milestone to invalid...



---

archive/issue_comments_217014.json:
```json
{
    "body": "FWCW, I just triggered it again while building Sage in a subdirectory of /tmp:\n\n```\nProcessing webassets-0.10.1.tar.gz\nWriting /tmp/easy_install-OSzZkb/webassets-0.10.1/setup.cfg\nRunning webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-OSzZkb/webassets-0.10.1/egg-dist-tmp-H58hNo\nerror: SandboxViolation: chmod('/home/vbraun/.sage/.python-eggs/Pillow-2.2.2-py2.7-linux-x86_64.egg-tmp/PIL/tmpMF0VYS.$extract', 493) {}\n```\n",
    "created_at": "2015-01-06T22:54:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217014",
    "user": "vbraun"
}
```

FWCW, I just triggered it again while building Sage in a subdirectory of /tmp:

```
Processing webassets-0.10.1.tar.gz
Writing /tmp/easy_install-OSzZkb/webassets-0.10.1/setup.cfg
Running webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-OSzZkb/webassets-0.10.1/egg-dist-tmp-H58hNo
error: SandboxViolation: chmod('/home/vbraun/.sage/.python-eggs/Pillow-2.2.2-py2.7-linux-x86_64.egg-tmp/PIL/tmpMF0VYS.$extract', 493) {}
```




---

archive/issue_comments_217015.json:
```json
{
    "body": "This is curious. I did a fresh build under /tmp after cloning from the `develop` branch and I get on my gentoo box:\n\n```\nProcessing webassets-0.10.1.tar.gz\nWriting /tmp/easy_install-KBbcXK/webassets-0.10.1/setup.cfg\nRunning webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-KBbcXK/webassets-0.10.1/egg-dist-tmp-7cFRfA\nwarning: no files found matching 'run_tests.py'\nno previously-included directories found matching 'docs/_build'\nwarning: no previously-included files matching 'out.css' found under directory 'examples'\nwarning: no previously-included files matching 'out.js' found under directory 'examples'\nno previously-included directories found matching 'examples/appengine-sdk'\nwarning: no previously-included files matching '*.pyc' found anywhere in distribution\nwarning: no previously-included files matching '.gitignore' found anywhere in distribution\nwarning: no previously-included files matching '*.orig' found anywhere in distribution\nwarning: no previously-included files matching 'webassets-cache/*' found anywhere in distribution\nwarning: no previously-included files matching '.sass-cache/*' found anywhere in distribution\nzip_safe flag not set; analyzing archive contents...\nwebassets.filter.__init__: module references __file__\nAdding webassets 0.10.1 to easy-install.pth file\nInstalling webassets script to /tmp/sage_sandbox/sage/local/bin\n\nInstalled /tmp/sage_sandbox/sage/local/lib/python2.7/site-packages/webassets-0.10.1-py2.7.egg\nProcessing dependencies for webassets==0.10.1\nFinished processing dependencies for webassets==0.10.1\n```\n\nI wonder what's up?",
    "created_at": "2015-01-07T06:37:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217015",
    "user": "strogdon"
}
```

This is curious. I did a fresh build under /tmp after cloning from the `develop` branch and I get on my gentoo box:

```
Processing webassets-0.10.1.tar.gz
Writing /tmp/easy_install-KBbcXK/webassets-0.10.1/setup.cfg
Running webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-KBbcXK/webassets-0.10.1/egg-dist-tmp-7cFRfA
warning: no files found matching 'run_tests.py'
no previously-included directories found matching 'docs/_build'
warning: no previously-included files matching 'out.css' found under directory 'examples'
warning: no previously-included files matching 'out.js' found under directory 'examples'
no previously-included directories found matching 'examples/appengine-sdk'
warning: no previously-included files matching '*.pyc' found anywhere in distribution
warning: no previously-included files matching '.gitignore' found anywhere in distribution
warning: no previously-included files matching '*.orig' found anywhere in distribution
warning: no previously-included files matching 'webassets-cache/*' found anywhere in distribution
warning: no previously-included files matching '.sass-cache/*' found anywhere in distribution
zip_safe flag not set; analyzing archive contents...
webassets.filter.__init__: module references __file__
Adding webassets 0.10.1 to easy-install.pth file
Installing webassets script to /tmp/sage_sandbox/sage/local/bin

Installed /tmp/sage_sandbox/sage/local/lib/python2.7/site-packages/webassets-0.10.1-py2.7.egg
Processing dependencies for webassets==0.10.1
Finished processing dependencies for webassets==0.10.1
```

I wonder what's up?



---

archive/issue_comments_217016.json:
```json
{
    "body": "OK guys that prompt 2 questions from me:\n\n* Is it only happening when building in /tmp ?\n* /tmp/easy_install-${random}? is it really the spkg being installed or easy_install acting on its own?",
    "created_at": "2015-01-07T07:03:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217016",
    "user": "fbissey"
}
```

OK guys that prompt 2 questions from me:

* Is it only happening when building in /tmp ?
* /tmp/easy_install-${random}? is it really the spkg being installed or easy_install acting on its own?



---

archive/issue_comments_217017.json:
```json
{
    "body": "Only happens when building in /tmp. Seems that easy_install does something different in that case.",
    "created_at": "2015-01-07T09:21:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217017",
    "user": "vbraun"
}
```

Only happens when building in /tmp. Seems that easy_install does something different in that case.



---

archive/issue_comments_217018.json:
```json
{
    "body": "I'm getting this again with sagenb-11.4 on some but not all user accounts. No idea what the difference is. This is in my home directory, not compiling in /tmp. \n\n```\nProcessing webassets-0.10.1.tar.gz\nWriting /tmp/easy_install-AR1rXi/webassets-0.10.1/setup.cfg\nRunning webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-AR1rXi/webassets-0.10.1/egg-dist-tmp-dpb_Mg\nerror: SandboxViolation: chmod('/home/vbraun/.sage/.python-eggs/Pillow-2.2.2-py2.7-linux-x86_64.egg-tmp/PIL/tmpZhc7i8.$extract', 493) {}\n```\n\nHow about we just get rid of the unused webassets?",
    "created_at": "2015-02-16T22:35:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217018",
    "user": "vbraun"
}
```

I'm getting this again with sagenb-11.4 on some but not all user accounts. No idea what the difference is. This is in my home directory, not compiling in /tmp. 

```
Processing webassets-0.10.1.tar.gz
Writing /tmp/easy_install-AR1rXi/webassets-0.10.1/setup.cfg
Running webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-AR1rXi/webassets-0.10.1/egg-dist-tmp-dpb_Mg
error: SandboxViolation: chmod('/home/vbraun/.sage/.python-eggs/Pillow-2.2.2-py2.7-linux-x86_64.egg-tmp/PIL/tmpZhc7i8.$extract', 493) {}
```

How about we just get rid of the unused webassets?



---

archive/issue_comments_217019.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2015-02-16T22:35:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217019",
    "user": "vbraun"
}
```

Changing status from closed to new.



---

archive/issue_comments_217020.json:
```json
{
    "body": "Resolution changed from invalid to ",
    "created_at": "2015-02-16T22:35:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217020",
    "user": "vbraun"
}
```

Resolution changed from invalid to 



---

archive/issue_comments_217021.json:
```json
{
    "body": "PS: the directory is created by setuptools just for webassets:\n\n```\n$ grep AR1rXi logs/pkgs/sagenb.log \nWriting /tmp/easy_install-AR1rXi/webassets-0.10.1/setup.cfg\nRunning webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-AR1rXi/webassets-0.10.1/egg-dist-tmp-dpb_Mg\n```\n",
    "created_at": "2015-02-16T22:36:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217021",
    "user": "vbraun"
}
```

PS: the directory is created by setuptools just for webassets:

```
$ grep AR1rXi logs/pkgs/sagenb.log 
Writing /tmp/easy_install-AR1rXi/webassets-0.10.1/setup.cfg
Running webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-AR1rXi/webassets-0.10.1/egg-dist-tmp-dpb_Mg
```




---

archive/issue_comments_217022.json:
```json
{
    "body": "Yes get rid of it, especially if it is such a headache. Is the problem happening on some distros and not others or something more subtle?",
    "created_at": "2015-02-16T22:42:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217022",
    "user": "fbissey"
}
```

Yes get rid of it, especially if it is such a headache. Is the problem happening on some distros and not others or something more subtle?



---

archive/issue_comments_217023.json:
```json
{
    "body": "A different account can install webassets (again in its respective home directory):\n\n```\nProcessing webassets-0.10.1.tar.gz\nWriting /tmp/easy_install-Fd5CnH/webassets-0.10.1/setup.cfg\nRunning webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-Fd5CnH/webassets-0.10.1/egg-dist-tmp-f2qRbU\nwarning: no files found matching 'run_tests.py'\n[...]\n```\n",
    "created_at": "2015-02-16T22:45:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217023",
    "user": "vbraun"
}
```

A different account can install webassets (again in its respective home directory):

```
Processing webassets-0.10.1.tar.gz
Writing /tmp/easy_install-Fd5CnH/webassets-0.10.1/setup.cfg
Running webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-Fd5CnH/webassets-0.10.1/egg-dist-tmp-f2qRbU
warning: no files found matching 'run_tests.py'
[...]
```




---

archive/issue_comments_217024.json:
```json
{
    "body": "Again, webassets is there so that people can use the \"newui\" branch of sagenb, which apparently people are indeed trying out and using (based on discussions there).",
    "created_at": "2015-02-17T01:08:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217024",
    "user": "kcrisman"
}
```

Again, webassets is there so that people can use the "newui" branch of sagenb, which apparently people are indeed trying out and using (based on discussions there).



---

archive/issue_comments_217025.json:
```json
{
    "body": "Just off the top of my head. Would it be possible to avoid the issue by removing webassets from sagenb and then installing it separately?",
    "created_at": "2015-02-17T03:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217025",
    "user": "strogdon"
}
```

Just off the top of my head. Would it be possible to avoid the issue by removing webassets from sagenb and then installing it separately?



---

archive/issue_comments_217026.json:
```json
{
    "body": "If you need webassets you can just \"pip install webassets\". But if its not used by default then don't ship it.",
    "created_at": "2015-02-17T09:20:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217026",
    "user": "vbraun"
}
```

If you need webassets you can just "pip install webassets". But if its not used by default then don't ship it.



---

archive/issue_comments_217027.json:
```json
{
    "body": "> If you need webassets you can just \"pip install webassets\". But if its not used by default then don't ship it.\n\nI'd be open to a pull request, but whatever solution there is should probably have a good and easy way to tell a user to install webassets *before* they attempt to switch to that.  It's also possible migeruhito's changes with that will have removed the need for webassets, I really know nothing about it beyond why it was added (included not knowing why that was actually necessary).",
    "created_at": "2015-02-17T12:43:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217027",
    "user": "kcrisman"
}
```

> If you need webassets you can just "pip install webassets". But if its not used by default then don't ship it.

I'd be open to a pull request, but whatever solution there is should probably have a good and easy way to tell a user to install webassets *before* they attempt to switch to that.  It's also possible migeruhito's changes with that will have removed the need for webassets, I really know nothing about it beyond why it was added (included not knowing why that was actually necessary).



---

archive/issue_comments_217028.json:
```json
{
    "body": "Then just add it to the instructions for trying out the newui branch, wherever those might be.",
    "created_at": "2015-02-17T13:19:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217028",
    "user": "vbraun"
}
```

Then just add it to the instructions for trying out the newui branch, wherever those might be.



---

archive/issue_comments_217029.json:
```json
{
    "body": "webassets is being removed at #14840.",
    "created_at": "2016-04-07T20:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217029",
    "user": "jdemeyer"
}
```

webassets is being removed at #14840.



---

archive/issue_comments_217030.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-04-07T20:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217030",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_217031.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-04-07T20:23:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217031",
    "user": "jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_217032.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-06-12T12:02:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16499#issuecomment-217032",
    "user": "vbraun"
}
```

Resolution: fixed
