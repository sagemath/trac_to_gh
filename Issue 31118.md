# Issue 31118: upgrade lrslib to 2.0

archive/issues_031118.json:
```json
{
    "body": "CC:  arojas aschilling chapoton tscrim @thierry-freebsd mjo mkoeppe fbissey asbuch slelievre\n\nlrslib 2.0 is out https://bitbucket.org/asbuch/lrcalc/src/master/ChangeLog\n\nIssue created by migration from https://trac.sagemath.org/ticket/31355\n\n",
    "created_at": "2021-02-07T16:27:16Z",
    "labels": [
        "packages: optional",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.6",
    "title": "upgrade lrslib to 2.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31118",
    "user": "tmonteil"
}
```
CC:  arojas aschilling chapoton tscrim @thierry-freebsd mjo mkoeppe fbissey asbuch slelievre

lrslib 2.0 is out https://bitbucket.org/asbuch/lrcalc/src/master/ChangeLog

Issue created by migration from https://trac.sagemath.org/ticket/31355





---

archive/issue_comments_444485.json:
```json
{
    "body": "I get the following error when doctesting:\n\n\n```\nImportError: /opt/sagemath/sage/local/lib/python3.7/site-packages/sage/libs/lrcalc/lrcalc.cpython-37m-x86_64-linux-gnu.so: undefined symbol: st_new\n```\n\n----\nNew commits:",
    "created_at": "2021-02-07T17:37:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444485",
    "user": "tmonteil"
}
```

I get the following error when doctesting:


```
ImportError: /opt/sagemath/sage/local/lib/python3.7/site-packages/sage/libs/lrcalc/lrcalc.cpython-37m-x86_64-linux-gnu.so: undefined symbol: st_new
```

----
New commits:



---

archive/issue_comments_444486.json:
```json
{
    "body": "This has major API changes. Large parts of lrcalc.pyx needs to be rewritten because the used functions have been removed or modified.",
    "created_at": "2021-02-07T17:47:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444486",
    "user": "arojas"
}
```

This has major API changes. Large parts of lrcalc.pyx needs to be rewritten because the used functions have been removed or modified.



---

archive/issue_comments_444487.json:
```json
{
    "body": "I see, any help welcome !",
    "created_at": "2021-02-07T18:29:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444487",
    "user": "tmonteil"
}
```

I see, any help welcome !



---

archive/issue_comments_444488.json:
```json
{
    "body": "The existing spkg-configure.m4 needs to be updated to detect v2.0 (once it actually works), too.",
    "created_at": "2021-02-11T01:57:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444488",
    "user": "mjo"
}
```

The existing spkg-configure.m4 needs to be updated to detect v2.0 (once it actually works), too.



---

archive/issue_comments_444489.json:
```json
{
    "body": "Some information from Anders:\n\n> I recently put out a new version of my lrcalc program, much of it is\n> rewritten, and some of the most important functions are close to twice as fast\n> as before.\u00a0 Some special cases have also been optimized to run a lot faster.\n>\n> I have included some (pure) Python3 bindings in the repository, so I think\n> this update will be easy.\u00a0 But I don't understand Sage well enough to do it\n> myself.\n\nFor reference, some pointers:\n\n- Sage's lrcalc package: https://git.sagemath.org/sage.git/tree/build/pkgs/lrcalc\n- Sage's lrcalc bindings: https://github.com/sagemath/sagetrac-mirror/blob/master/src/sage/libs/lcalc",
    "created_at": "2021-02-16T06:37:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444489",
    "user": "nthiery"
}
```

Some information from Anders:

> I recently put out a new version of my lrcalc program, much of it is
> rewritten, and some of the most important functions are close to twice as fast
> as before.  Some special cases have also been optimized to run a lot faster.
>
> I have included some (pure) Python3 bindings in the repository, so I think
> this update will be easy.  But I don't understand Sage well enough to do it
> myself.

For reference, some pointers:

- Sage's lrcalc package: https://git.sagemath.org/sage.git/tree/build/pkgs/lrcalc
- Sage's lrcalc bindings: https://github.com/sagemath/sagetrac-mirror/blob/master/src/sage/libs/lcalc



---

archive/issue_comments_444490.json:
```json
{
    "body": "The Python bindings are only in the repository and a bit raw, so probably only useful as examples.  But I expect they are easier to start from than the .h files.",
    "created_at": "2021-02-16T22:25:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444490",
    "user": "@asbuch"
}
```

The Python bindings are only in the repository and a bit raw, so probably only useful as examples.  But I expect they are easier to start from than the .h files.



---

archive/issue_comments_444491.json:
```json
{
    "body": "Replying to [comment:10 gh-asbuch]:\n> The Python bindings are only in the repository and a bit raw, so probably only useful as examples.  But I expect they are easier to start from than the .h files.\n\nActually, they are almost equivalent to the current bindings in Sage. The attached branch replaces lrcalc.pyx with a thin wrapper over lrcalc's bindings.\n\nIt mostly just translates the output from lrcalc to sage notation. The only function of lrcalc.pyx that isn't straghtforward to port is quantum multiplication: I found no way to recover the q-grading from lrcalc's output, so this is reimplemented in the patch.\n\nThe branch needs an update of lrcalc to include python bindings.\n----\nNew commits:",
    "created_at": "2021-02-21T12:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444491",
    "user": "arojas"
}
```

Replying to [comment:10 gh-asbuch]:
> The Python bindings are only in the repository and a bit raw, so probably only useful as examples.  But I expect they are easier to start from than the .h files.

Actually, they are almost equivalent to the current bindings in Sage. The attached branch replaces lrcalc.pyx with a thin wrapper over lrcalc's bindings.

It mostly just translates the output from lrcalc to sage notation. The only function of lrcalc.pyx that isn't straghtforward to port is quantum multiplication: I found no way to recover the q-grading from lrcalc's output, so this is reimplemented in the patch.

The branch needs an update of lrcalc to include python bindings.
----
New commits:



---

archive/issue_comments_444492.json:
```json
{
    "body": "Replying to [comment:10 gh-asbuch]:\n> The Python bindings are only in the repository and a bit raw, so probably only useful as examples.  But I expect they are easier to start from than the .h files.\n\nSince you are here and I can not find a bug tracker for lrcalc: the setup.py is missing metadata, so the egg for lrcalc gets installed as UNKNOWN-0.0.0.0",
    "created_at": "2021-02-21T12:09:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444492",
    "user": "arojas"
}
```

Replying to [comment:10 gh-asbuch]:
> The Python bindings are only in the repository and a bit raw, so probably only useful as examples.  But I expect they are easier to start from than the .h files.

Since you are here and I can not find a bug tracker for lrcalc: the setup.py is missing metadata, so the egg for lrcalc gets installed as UNKNOWN-0.0.0.0



---

archive/issue_comments_444493.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-21T12:39:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444493",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444494.json:
```json
{
    "body": "If my bindings are used, then that will make it easier to keep things compatible if I make more changes to the C interface.  I should be able to keep the Python interface stable, at least up to reordering of output.\n\nQuantum function: I will add a function mult_quantum_pairs that returns a dict from ((partition),d) to integers, you can switch to that if you want.\n\nsetup.py: Does the following include the tags you are looking for?  Suggestions welcome!\n\n\n```\nsetup(name='lrcalc',\n    version='2.0.0',\n    description='Littlewood-Richardson Calculator',\n    long_description='Littlewood-Richardson Calculator',\n    url='https://math.rutgers.edu/~asbuch/lrcalc',\n    author='Anders Skovsted Buch',\n    license='GPL3',\n    ext_modules = cythonize([\n        Extension(\"lrcalc\", [\"lrcalc.pyx\"],\n                  libraries=[\"lrcalc\"])\n    ])\n)\n```\n",
    "created_at": "2021-02-21T14:59:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444494",
    "user": "@asbuch"
}
```

If my bindings are used, then that will make it easier to keep things compatible if I make more changes to the C interface.  I should be able to keep the Python interface stable, at least up to reordering of output.

Quantum function: I will add a function mult_quantum_pairs that returns a dict from ((partition),d) to integers, you can switch to that if you want.

setup.py: Does the following include the tags you are looking for?  Suggestions welcome!


```
setup(name='lrcalc',
    version='2.0.0',
    description='Littlewood-Richardson Calculator',
    long_description='Littlewood-Richardson Calculator',
    url='https://math.rutgers.edu/~asbuch/lrcalc',
    author='Anders Skovsted Buch',
    license='GPL3',
    ext_modules = cythonize([
        Extension("lrcalc", ["lrcalc.pyx"],
                  libraries=["lrcalc"])
    ])
)
```




---

archive/issue_comments_444495.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-21T17:14:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444495",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444496.json:
```json
{
    "body": "Replying to [comment:15 gh-asbuch]:\n> setup.py: Does the following include the tags you are looking for?  Suggestions welcome!\n> \n> {{{\n> setup(name='lrcalc',\n>     version='2.0.0',\n>     description='Littlewood-Richardson Calculator',\n>     long_description='Littlewood-Richardson Calculator',\n>     url='https://math.rutgers.edu/~asbuch/lrcalc',\n>     author='Anders Skovsted Buch',\n>     license='GPL3',\n>     ext_modules = cythonize([\n>         Extension(\"lrcalc\", [\"lrcalc.pyx\"],\n>                   libraries=[\"lrcalc\"])\n>     ])\n> )\n> }}}\n\nThat works, thanks. Also, although maybe it is a little bit too late for that, it would be good to bump the soversion of the C shared library since the API changed.",
    "created_at": "2021-02-21T17:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444496",
    "user": "arojas"
}
```

Replying to [comment:15 gh-asbuch]:
> setup.py: Does the following include the tags you are looking for?  Suggestions welcome!
> 
> {{{
> setup(name='lrcalc',
>     version='2.0.0',
>     description='Littlewood-Richardson Calculator',
>     long_description='Littlewood-Richardson Calculator',
>     url='https://math.rutgers.edu/~asbuch/lrcalc',
>     author='Anders Skovsted Buch',
>     license='GPL3',
>     ext_modules = cythonize([
>         Extension("lrcalc", ["lrcalc.pyx"],
>                   libraries=["lrcalc"])
>     ])
> )
> }}}

That works, thanks. Also, although maybe it is a little bit too late for that, it would be good to bump the soversion of the C shared library since the API changed.



---

archive/issue_comments_444497.json:
```json
{
    "body": "Replying to [comment:17 arojas]:\n> Replying to [comment:15 gh-asbuch]:\n> > setup.py: Does the following include the tags you are looking for?  Suggestions welcome!\n> > \n> > {{{\n> > setup(name='lrcalc',\n> >     version='2.0.0',\n> >     description='Littlewood-Richardson Calculator',\n> >     long_description='Littlewood-Richardson Calculator',\n> >     url='https://math.rutgers.edu/~asbuch/lrcalc',\n> >     author='Anders Skovsted Buch',\n> >     license='GPL3',\n> >     ext_modules = cythonize([\n> >         Extension(\"lrcalc\", [\"lrcalc.pyx\"],\n> >                   libraries=[\"lrcalc\"])\n> >     ])\n> > )\n> > }}}\n> \n> That works, thanks. Also, although maybe it is a little bit too late for that, it would be good to bump the soversion of the C shared library since the API changed.\n\nI changed the version to \"2.0.0\" and thought that was in line with [this page](https://www.gnu.org/software/libtool/manual/html_node/Updating-version-info.html).  Please let me know if I am doing something wrong.",
    "created_at": "2021-02-21T17:38:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444497",
    "user": "@asbuch"
}
```

Replying to [comment:17 arojas]:
> Replying to [comment:15 gh-asbuch]:
> > setup.py: Does the following include the tags you are looking for?  Suggestions welcome!
> > 
> > {{{
> > setup(name='lrcalc',
> >     version='2.0.0',
> >     description='Littlewood-Richardson Calculator',
> >     long_description='Littlewood-Richardson Calculator',
> >     url='https://math.rutgers.edu/~asbuch/lrcalc',
> >     author='Anders Skovsted Buch',
> >     license='GPL3',
> >     ext_modules = cythonize([
> >         Extension("lrcalc", ["lrcalc.pyx"],
> >                   libraries=["lrcalc"])
> >     ])
> > )
> > }}}
> 
> That works, thanks. Also, although maybe it is a little bit too late for that, it would be good to bump the soversion of the C shared library since the API changed.

I changed the version to "2.0.0" and thought that was in line with [this page](https://www.gnu.org/software/libtool/manual/html_node/Updating-version-info.html).  Please let me know if I am doing something wrong.



---

archive/issue_comments_444498.json:
```json
{
    "body": "Replying to [comment:18 gh-asbuch]:\n> I changed the version to \"2.0.0\" and thought that was in line with [this page](https://www.gnu.org/software/libtool/manual/html_node/Updating-version-info.html).  Please let me know if I am doing something wrong.\n\nYou need to change the -version-info in https://bitbucket.org/asbuch/lrcalc/src/master/src/Makefile.am#lines-23",
    "created_at": "2021-02-21T18:01:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444498",
    "user": "arojas"
}
```

Replying to [comment:18 gh-asbuch]:
> I changed the version to "2.0.0" and thought that was in line with [this page](https://www.gnu.org/software/libtool/manual/html_node/Updating-version-info.html).  Please let me know if I am doing something wrong.

You need to change the -version-info in https://bitbucket.org/asbuch/lrcalc/src/master/src/Makefile.am#lines-23



---

archive/issue_comments_444499.json:
```json
{
    "body": "Replying to [comment:19 arojas]:\n> Replying to [comment:18 gh-asbuch]:\n> > I changed the version to \"2.0.0\" and thought that was in line with [this page](https://www.gnu.org/software/libtool/manual/html_node/Updating-version-info.html).  Please let me know if I am doing something wrong.\n> \n> You need to change the -version-info in https://bitbucket.org/asbuch/lrcalc/src/master/src/Makefile.am#lines-23\n\nI see, thanks!  According to conventions, is that line in Makefile.am independent from this line in configure.am:\n\n\n```\nAC_INIT([lrcalc],[2.0.0],[asbuch at math rutgers edu])\n```\n",
    "created_at": "2021-02-21T18:32:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444499",
    "user": "@asbuch"
}
```

Replying to [comment:19 arojas]:
> Replying to [comment:18 gh-asbuch]:
> > I changed the version to "2.0.0" and thought that was in line with [this page](https://www.gnu.org/software/libtool/manual/html_node/Updating-version-info.html).  Please let me know if I am doing something wrong.
> 
> You need to change the -version-info in https://bitbucket.org/asbuch/lrcalc/src/master/src/Makefile.am#lines-23

I see, thanks!  According to conventions, is that line in Makefile.am independent from this line in configure.am:


```
AC_INIT([lrcalc],[2.0.0],[asbuch at math rutgers edu])
```




---

archive/issue_comments_444500.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-22T11:32:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444500",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444501.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-22T11:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444501",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444502.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-22T11:50:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444502",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444503.json:
```json
{
    "body": "spkg-configure needs to be updated to check whether the python bindings are installed, and build sage's spkg otherwise.",
    "created_at": "2021-02-22T11:52:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444503",
    "user": "arojas"
}
```

spkg-configure needs to be updated to check whether the python bindings are installed, and build sage's spkg otherwise.



---

archive/issue_comments_444504.json:
```json
{
    "body": "Sorry for the moving target.  However, 2.1 should bring only more speed and no new problems.\n\nThe mult_quantum() function now takes an optional boolean arguments \"degrees\" that causes it to replace each key part with (part,d).",
    "created_at": "2021-02-22T15:53:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444504",
    "user": "@asbuch"
}
```

Sorry for the moving target.  However, 2.1 should bring only more speed and no new problems.

The mult_quantum() function now takes an optional boolean arguments "degrees" that causes it to replace each key part with (part,d).



---

archive/issue_comments_444505.json:
```json
{
    "body": "Replying to [comment:24 arojas]:\n> spkg-configure needs to be updated to check whether the python bindings are installed, and build sage's spkg otherwise.\n\nWe cannot use Python packages from the system, see #29023.\n\nAn SPKG providing both a library and Python bindings to it should be split into 2 SPKGs.",
    "created_at": "2021-02-22T16:06:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444505",
    "user": "mkoeppe"
}
```

Replying to [comment:24 arojas]:
> spkg-configure needs to be updated to check whether the python bindings are installed, and build sage's spkg otherwise.

We cannot use Python packages from the system, see #29023.

An SPKG providing both a library and Python bindings to it should be split into 2 SPKGs.



---

archive/issue_comments_444506.json:
```json
{
    "body": "Anders, the Python package should declare its build dependencies (in particular Cython) by putting a `pyproject.toml` file next to the `setup.py`; see https://snarky.ca/what-the-heck-is-pyproject-toml/",
    "created_at": "2021-02-22T16:12:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444506",
    "user": "mkoeppe"
}
```

Anders, the Python package should declare its build dependencies (in particular Cython) by putting a `pyproject.toml` file next to the `setup.py`; see https://snarky.ca/what-the-heck-is-pyproject-toml/



---

archive/issue_comments_444507.json:
```json
{
    "body": "Replying to [comment:28 mkoeppe]:\n> Replying to [comment:24 arojas]:\n> > spkg-configure needs to be updated to check whether the python bindings are installed, and build sage's spkg otherwise.\n> \n> We cannot use Python packages from the system, see #29023.\n> \n> An SPKG providing both a library and Python bindings to it should be split into 2 SPKGs. \n> \n\nThen maybe sage shouldn't support using system lrcalc 2.x for now, the bindings and the C library should obviously be kept at the same version.\n\nIn any case, the sagelib side should be ready now, please someone else take care of the build side.",
    "created_at": "2021-02-22T16:23:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444507",
    "user": "arojas"
}
```

Replying to [comment:28 mkoeppe]:
> Replying to [comment:24 arojas]:
> > spkg-configure needs to be updated to check whether the python bindings are installed, and build sage's spkg otherwise.
> 
> We cannot use Python packages from the system, see #29023.
> 
> An SPKG providing both a library and Python bindings to it should be split into 2 SPKGs. 
> 

Then maybe sage shouldn't support using system lrcalc 2.x for now, the bindings and the C library should obviously be kept at the same version.

In any case, the sagelib side should be ready now, please someone else take care of the build side.



---

archive/issue_comments_444508.json:
```json
{
    "body": "Whether we support system lrcalc or not, non-Python and Python installations need to be split into two separate SPKGs (they can share the same tarball).",
    "created_at": "2021-02-22T16:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444508",
    "user": "mkoeppe"
}
```

Whether we support system lrcalc or not, non-Python and Python installations need to be split into two separate SPKGs (they can share the same tarball).



---

archive/issue_comments_444509.json:
```json
{
    "body": "Is this the `pyproject.toml` that you need? If so, then I can add that.\n\n```\n[build-system]\nrequires = [\"setuptools\", \"cython\"]\nbuild-backend = \"setuptools.build_meta\"\n```\n\n\nRegarding splitting into SPKGs, I am not familiar with the details of Python's package system. Maybe one day I will read up on this and make it possible to say `pip install lrcalc`, but this is not likely to happen soon. One way to proceed for now is to copy my files `liblrcalc.pxd` and `lrcalc.pyx` to the Sage repository next to Nicolas' files. Changes to `liblrcalc`'s interface are not likely to happen soon, but even if that happened, Sage could be brought up-to-date with another copy command. Not perfect, but maybe still a small improvement to the way `lrcalc` has been integrated in the past?",
    "created_at": "2021-02-22T18:13:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444509",
    "user": "@asbuch"
}
```

Is this the `pyproject.toml` that you need? If so, then I can add that.

```
[build-system]
requires = ["setuptools", "cython"]
build-backend = "setuptools.build_meta"
```


Regarding splitting into SPKGs, I am not familiar with the details of Python's package system. Maybe one day I will read up on this and make it possible to say `pip install lrcalc`, but this is not likely to happen soon. One way to proceed for now is to copy my files `liblrcalc.pxd` and `lrcalc.pyx` to the Sage repository next to Nicolas' files. Changes to `liblrcalc`'s interface are not likely to happen soon, but even if that happened, Sage could be brought up-to-date with another copy command. Not perfect, but maybe still a small improvement to the way `lrcalc` has been integrated in the past?



---

archive/issue_comments_444510.json:
```json
{
    "body": "Replying to [comment:32 gh-asbuch]:\n> Is this the `pyproject.toml` that you need? If so, then I can add that.\n> {{{\n> [build-system]\n> requires = [\"setuptools\", \"cython\"]\n> build-backend = \"setuptools.build_meta\"\n> }}}\n\nYes, that's good; best to add `\"wheel\"` in requires too.\n\n> Regarding splitting into SPKGs, I am not familiar with the details of Python's package system. \n\nThis is actually Sage-specific, not related to Python packaging, so not a task for you as the upstream author.\n\n\"Best practices\" on your side would be to create a source distribution for the Python library, using `setup.py sdist` and to upload it to PyPI.  On the Sage packaging side, we can then use that as our upstream for a `lrcalc_python` SPKG.",
    "created_at": "2021-02-22T18:19:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444510",
    "user": "mkoeppe"
}
```

Replying to [comment:32 gh-asbuch]:
> Is this the `pyproject.toml` that you need? If so, then I can add that.
> {{{
> [build-system]
> requires = ["setuptools", "cython"]
> build-backend = "setuptools.build_meta"
> }}}

Yes, that's good; best to add `"wheel"` in requires too.

> Regarding splitting into SPKGs, I am not familiar with the details of Python's package system. 

This is actually Sage-specific, not related to Python packaging, so not a task for you as the upstream author.

"Best practices" on your side would be to create a source distribution for the Python library, using `setup.py sdist` and to upload it to PyPI.  On the Sage packaging side, we can then use that as our upstream for a `lrcalc_python` SPKG.



---

archive/issue_comments_444511.json:
```json
{
    "body": "Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-24T02:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444511",
    "user": "mkoeppe"
}
```

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_444512.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-06-26T09:21:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444512",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444513.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-06-26T09:23:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444513",
    "user": "arojas"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_444514.json:
```json
{
    "body": "Trying to move this forward",
    "created_at": "2021-06-26T09:23:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444514",
    "user": "arojas"
}
```

Trying to move this forward



---

archive/issue_comments_444515.json:
```json
{
    "body": "-1 on using a Python package that is not on PyPI",
    "created_at": "2021-06-27T16:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444515",
    "user": "mkoeppe"
}
```

-1 on using a Python package that is not on PyPI



---

archive/issue_comments_444516.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-06-27T16:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444516",
    "user": "mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_444517.json:
```json
{
    "body": "Setting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444517",
    "user": "mkoeppe"
}
```

Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_comments_444518.json:
```json
{
    "body": "Replying to [comment:38 mkoeppe]:\n> -1 on using a Python package that is not on PyPI\n\nwe have to move forward here, still. So we can either use the non-PyPI package, or facilitate\na release on PyPI...",
    "created_at": "2021-09-04T09:21:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444518",
    "user": "dimpase"
}
```

Replying to [comment:38 mkoeppe]:
> -1 on using a Python package that is not on PyPI

we have to move forward here, still. So we can either use the non-PyPI package, or facilitate
a release on PyPI...



---

archive/issue_comments_444519.json:
```json
{
    "body": "Replying to [comment:40 dimpase]:\n> Replying to [comment:38 mkoeppe]:\n> > -1 on using a Python package that is not on PyPI\n> \n> we have to move forward here, still. So we can either use the non-PyPI package, or facilitate\n> a release on PyPI...\n\nLet me suggest to postpone helping upstream to use PyPI to another ticket.",
    "created_at": "2021-09-04T11:35:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444519",
    "user": "tmonteil"
}
```

Replying to [comment:40 dimpase]:
> Replying to [comment:38 mkoeppe]:
> > -1 on using a Python package that is not on PyPI
> 
> we have to move forward here, still. So we can either use the non-PyPI package, or facilitate
> a release on PyPI...

Let me suggest to postpone helping upstream to use PyPI to another ticket.



---

archive/issue_comments_444520.json:
```json
{
    "body": "It would block the Sage library (`sagemath-standard`) from being pushed to PyPI, so no, that's not a viable approach.",
    "created_at": "2021-09-04T16:21:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444520",
    "user": "mkoeppe"
}
```

It would block the Sage library (`sagemath-standard`) from being pushed to PyPI, so no, that's not a viable approach.



---

archive/issue_comments_444521.json:
```json
{
    "body": "Replying to [comment:40 dimpase]:\n> facilitate a release on PyPI...\n\nFacilitated now by providing this link: https://realpython.com/pypi-publish-python-package/#publishing-to-pypi",
    "created_at": "2021-09-04T17:15:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444521",
    "user": "mkoeppe"
}
```

Replying to [comment:40 dimpase]:
> facilitate a release on PyPI...

Facilitated now by providing this link: https://realpython.com/pypi-publish-python-package/#publishing-to-pypi



---

archive/issue_comments_444522.json:
```json
{
    "body": "Someone would probably need to provide a PR for upstream, not just an RTFM link.",
    "created_at": "2021-09-10T08:37:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444522",
    "user": "dimpase"
}
```

Someone would probably need to provide a PR for upstream, not just an RTFM link.



---

archive/issue_comments_444523.json:
```json
{
    "body": "No PR is needed, the upstream maintainer really just needs to type `python3 setup.py sdist && twine upload dist/*`",
    "created_at": "2021-09-10T17:45:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444523",
    "user": "mkoeppe"
}
```

No PR is needed, the upstream maintainer really just needs to type `python3 setup.py sdist && twine upload dist/*`



---

archive/issue_comments_444524.json:
```json
{
    "body": "Changing keywords from \"\" to \"upgrade, lrcalc\".",
    "created_at": "2021-09-19T10:04:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444524",
    "user": "slelievre"
}
```

Changing keywords from "" to "upgrade, lrcalc".



---

archive/issue_comments_444525.json:
```json
{
    "body": "Cc-ing the lrcalc maintainer (hi Anders!).",
    "created_at": "2021-09-19T10:04:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444525",
    "user": "slelievre"
}
```

Cc-ing the lrcalc maintainer (hi Anders!).



---

archive/issue_comments_444526.json:
```json
{
    "body": "I would like to have lrcalc available on PyPI, but I have not had time to figure out how to put it there. I don't know how to make sure the Python bindings can find the C library, but if PyPI has some magic that can handle that with the above command, then great. I tried this:\n\n\n```\npython3 setup.py sdist\ntwine upload --repository testpypi dist/*\n```\n\n\nThat appeared to work, and resulted in [https://test.pypi.org/project/lrcalc/](https://test.pypi.org/project/lrcalc/) appearing on TestPyPI. However, when I use the pip command displayed there, I get a lot of errors. I'm not eager to have a defunct project in public view on PyPI.\n\nAll that said, I can't help thinking that if Sage was able to include the previous version of lrcalc that did not come with Python bindings, but is unable to include the new version, with or without using the supplied bindings, then something in the project must have gotten less flexible in the last few years.",
    "created_at": "2021-09-19T18:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444526",
    "user": "asbuch"
}
```

I would like to have lrcalc available on PyPI, but I have not had time to figure out how to put it there. I don't know how to make sure the Python bindings can find the C library, but if PyPI has some magic that can handle that with the above command, then great. I tried this:


```
python3 setup.py sdist
twine upload --repository testpypi dist/*
```


That appeared to work, and resulted in [https://test.pypi.org/project/lrcalc/](https://test.pypi.org/project/lrcalc/) appearing on TestPyPI. However, when I use the pip command displayed there, I get a lot of errors. I'm not eager to have a defunct project in public view on PyPI.

All that said, I can't help thinking that if Sage was able to include the previous version of lrcalc that did not come with Python bindings, but is unable to include the new version, with or without using the supplied bindings, then something in the project must have gotten less flexible in the last few years.



---

archive/issue_comments_444527.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-19T18:23:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444527",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444528.json:
```json
{
    "body": "Replying to [comment:47 asbuch]:\n> All that said, I can't help thinking that if Sage was able to include the previous version of lrcalc that did not come with Python bindings, but is unable to include the new version, with or without using the supplied bindings, then something in the project must have gotten less flexible in the last few years.\n\nThe thing is that the API changes in lrcalc 2 require an almost complete rewrite of sage's interface, which would essentially make it a duplicate of your python bindings, and doing that doesn't make much sense to me.\n\nAnother solution would be to include a copy of your pyx in sage, if the licence allows it.",
    "created_at": "2021-09-19T18:38:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444528",
    "user": "arojas"
}
```

Replying to [comment:47 asbuch]:
> All that said, I can't help thinking that if Sage was able to include the previous version of lrcalc that did not come with Python bindings, but is unable to include the new version, with or without using the supplied bindings, then something in the project must have gotten less flexible in the last few years.

The thing is that the API changes in lrcalc 2 require an almost complete rewrite of sage's interface, which would essentially make it a duplicate of your python bindings, and doing that doesn't make much sense to me.

Another solution would be to include a copy of your pyx in sage, if the licence allows it.



---

archive/issue_comments_444529.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-19T18:42:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444529",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444530.json:
```json
{
    "body": "Replying to [comment:47 asbuch]:\n> I don't know how to make sure the Python bindings can find the C library\n\nNo need to worry about this. It is the responsibility of the user to install the C library. This is normal.\n\nBut it would be a good idea to explain this in the Python package's README (which would appear in the \"Project description\" at https://test.pypi.org/project/lrcalc/#description)\n\nSee https://pypi.org/project/pplpy/ for inspiration.",
    "created_at": "2021-09-19T18:44:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444530",
    "user": "mkoeppe"
}
```

Replying to [comment:47 asbuch]:
> I don't know how to make sure the Python bindings can find the C library

No need to worry about this. It is the responsibility of the user to install the C library. This is normal.

But it would be a good idea to explain this in the Python package's README (which would appear in the "Project description" at https://test.pypi.org/project/lrcalc/#description)

See https://pypi.org/project/pplpy/ for inspiration.



---

archive/issue_comments_444531.json:
```json
{
    "body": "In `lrcalc/python`, probably best to change `README.Python` to either `README.md` or `README.rst`",
    "created_at": "2021-09-19T18:49:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444531",
    "user": "mkoeppe"
}
```

In `lrcalc/python`, probably best to change `README.Python` to either `README.md` or `README.rst`



---

archive/issue_comments_444532.json:
```json
{
    "body": "The file on TestPyPI does not include the `.pyx` and `.pxd` files but it ships a generated `.c` file that is not needed. To fix this, you can create a file `MANIFEST.in`",
    "created_at": "2021-09-19T18:54:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444532",
    "user": "mkoeppe"
}
```

The file on TestPyPI does not include the `.pyx` and `.pxd` files but it ships a generated `.c` file that is not needed. To fix this, you can create a file `MANIFEST.in`



---

archive/issue_comments_444533.json:
```json
{
    "body": "Replying to [comment:50 arojas]:\n> Replying to [comment:47 asbuch]:\n> > All that said, I can't help thinking that if Sage was able to include the previous version of lrcalc that did not come with Python bindings, but is unable to include the new version, with or without using the supplied bindings, then something in the project must have gotten less flexible in the last few years.\n> \n> The thing is that the API changes in lrcalc 2 require an almost complete rewrite of sage's interface, which would essentially make it a duplicate of your python bindings, and doing that doesn't make much sense to me.\n> \n> Another solution would be to include a copy of your pyx in sage, if the licence allows it.\n\nThis is what I imagined would happen when I wrote the Python bindings. I think I also suggested it at some point. Lrcalc is GPL v3, is Sage not compatible with that?",
    "created_at": "2021-09-19T19:40:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444533",
    "user": "asbuch"
}
```

Replying to [comment:50 arojas]:
> Replying to [comment:47 asbuch]:
> > All that said, I can't help thinking that if Sage was able to include the previous version of lrcalc that did not come with Python bindings, but is unable to include the new version, with or without using the supplied bindings, then something in the project must have gotten less flexible in the last few years.
> 
> The thing is that the API changes in lrcalc 2 require an almost complete rewrite of sage's interface, which would essentially make it a duplicate of your python bindings, and doing that doesn't make much sense to me.
> 
> Another solution would be to include a copy of your pyx in sage, if the licence allows it.

This is what I imagined would happen when I wrote the Python bindings. I think I also suggested it at some point. Lrcalc is GPL v3, is Sage not compatible with that?



---

archive/issue_comments_444534.json:
```json
{
    "body": "The Sage library is \"GPL v2 or later\", I don't think we can put a GPL v3-only module in.",
    "created_at": "2021-09-19T19:41:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444534",
    "user": "mkoeppe"
}
```

The Sage library is "GPL v2 or later", I don't think we can put a GPL v3-only module in.



---

archive/issue_comments_444535.json:
```json
{
    "body": "If you relicense the Python bindings to GPL v2 or later, people here on the ticket can probably adapt your code and put it in the Sage library; in this case, we don't need to bother you with Python packaging details.",
    "created_at": "2021-09-19T19:45:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444535",
    "user": "mkoeppe"
}
```

If you relicense the Python bindings to GPL v2 or later, people here on the ticket can probably adapt your code and put it in the Sage library; in this case, we don't need to bother you with Python packaging details.



---

archive/issue_comments_444536.json:
```json
{
    "body": "Replying to [comment:54 mkoeppe]:\n> The file on TestPyPI does not include the `.pyx` and `.pxd` files but it ships a generated `.c` file that is not needed. To fix this, you can create a file `MANIFEST.in`\n\nThanks, this is helpful. Do you know a place where I can find a minimal MANIFEST.in to modify?",
    "created_at": "2021-09-19T19:45:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444536",
    "user": "asbuch"
}
```

Replying to [comment:54 mkoeppe]:
> The file on TestPyPI does not include the `.pyx` and `.pxd` files but it ships a generated `.c` file that is not needed. To fix this, you can create a file `MANIFEST.in`

Thanks, this is helpful. Do you know a place where I can find a minimal MANIFEST.in to modify?



---

archive/issue_comments_444537.json:
```json
{
    "body": "https://gitlab.com/videlec/pplpy/-/blob/master/MANIFEST.in is a good example",
    "created_at": "2021-09-19T19:48:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444537",
    "user": "mkoeppe"
}
```

https://gitlab.com/videlec/pplpy/-/blob/master/MANIFEST.in is a good example



---

archive/issue_comments_444538.json:
```json
{
    "body": "Replying to [comment:56 mkoeppe]:\n> The Sage library is \"GPL v2 or later\", I don't think we can put a GPL v3-only module in.\n\nYou can hereby consider any files you need to copy as also licensed \"GPL v2 or later\". Is this official enough?",
    "created_at": "2021-09-19T19:48:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444538",
    "user": "asbuch"
}
```

Replying to [comment:56 mkoeppe]:
> The Sage library is "GPL v2 or later", I don't think we can put a GPL v3-only module in.

You can hereby consider any files you need to copy as also licensed "GPL v2 or later". Is this official enough?



---

archive/issue_comments_444539.json:
```json
{
    "body": "Replying to [comment:59 mkoeppe]:\n> https://gitlab.com/videlec/pplpy/-/blob/master/MANIFEST.in is a good example\n\nThanks, I will give that a try then.",
    "created_at": "2021-09-19T19:49:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444539",
    "user": "asbuch"
}
```

Replying to [comment:59 mkoeppe]:
> https://gitlab.com/videlec/pplpy/-/blob/master/MANIFEST.in is a good example

Thanks, I will give that a try then.



---

archive/issue_comments_444540.json:
```json
{
    "body": "Replying to [comment:60 asbuch]:\n> Is this official enough?\n\nPretty sure it is, thanks",
    "created_at": "2021-09-19T19:51:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444540",
    "user": "mkoeppe"
}
```

Replying to [comment:60 asbuch]:
> Is this official enough?

Pretty sure it is, thanks



---

archive/issue_comments_444541.json:
```json
{
    "body": "Replying to [comment:58 asbuch]:\n> Replying to [comment:54 mkoeppe]:\n> > The file on TestPyPI does not include the `.pyx` and `.pxd` files but it ships a generated `.c` file that is not needed. To fix this, you can create a file `MANIFEST.in`\n> \n> Thanks, this is helpful. Do you know a place where I can find a minimal MANIFEST.in to modify?\n\nNow the .pyx and .pxd files are included and the .c file is gone, but I get the same result when I try to install with pip. I have liblrcalc installed in /usr/local/lib.",
    "created_at": "2021-09-19T20:35:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444541",
    "user": "asbuch"
}
```

Replying to [comment:58 asbuch]:
> Replying to [comment:54 mkoeppe]:
> > The file on TestPyPI does not include the `.pyx` and `.pxd` files but it ships a generated `.c` file that is not needed. To fix this, you can create a file `MANIFEST.in`
> 
> Thanks, this is helpful. Do you know a place where I can find a minimal MANIFEST.in to modify?

Now the .pyx and .pxd files are included and the .c file is gone, but I get the same result when I try to install with pip. I have liblrcalc installed in /usr/local/lib.



---

archive/issue_comments_444542.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-19T20:41:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444542",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444543.json:
```json
{
    "body": "Works fine now here on the branch",
    "created_at": "2021-09-19T20:41:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444543",
    "user": "mkoeppe"
}
```

Works fine now here on the branch



---

archive/issue_comments_444544.json:
```json
{
    "body": "Replying to [comment:63 asbuch]:\n> I get the same result when I try to install with pip. I have liblrcalc installed in /usr/local/lib.\n\nIf you post some logs, I can take a look",
    "created_at": "2021-09-19T20:42:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444544",
    "user": "mkoeppe"
}
```

Replying to [comment:63 asbuch]:
> I get the same result when I try to install with pip. I have liblrcalc installed in /usr/local/lib.

If you post some logs, I can take a look



---

archive/issue_comments_444545.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-19T20:46:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444545",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444546.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-19T21:09:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444546",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444547.json:
```json
{
    "body": "Replying to [comment:66 mkoeppe]:\n> Replying to [comment:63 asbuch]:\n> > I get the same result when I try to install with pip. I have liblrcalc installed in /usr/local/lib.\n> \n> If you post some logs, I can take a look\n\nThanks! I created a new Python environment with \"mkvirtualenv lrcalc_test\", then I tried to install with pip and got the following result:\n\n\n```\n> pip install -i https://test.pypi.org/simple/ lrcalc\nLooking in indexes: https://test.pypi.org/simple/\nCollecting lrcalc\n  Downloading https://test-files.pythonhosted.org/packages/d4/c8/c3988b0714fd225cdc4664f79b57161b8292c43eaad3ff81698d3db58147/lrcalc-2.0.1.tar.gz (15 kB)\n  Installing build dependencies ... error\n  ERROR: Command errored out with exit status 1:\n   command: /home/user/lib/virtualenvs/lrcalc_test/bin/python /home/user/lib/virtualenvs/lrcalc_test/lib/python3.8/site-packages/pip install --ignore-installed --no-user --prefix /tmp/pip-build-env-cz4e5gzo/overlay --no-warn-script-location --no-binary :none: --only-binary :none: -i https://test.pypi.org/simple/ -- setuptools cython wheel\n       cwd: None\n  Complete output (3 lines):\n  Looking in indexes: https://test.pypi.org/simple/\n  ERROR: Could not find a version that satisfies the requirement setuptools (from versions: none)\n  ERROR: No matching distribution found for setuptools\n  ----------------------------------------\nERROR: Command errored out with exit status 1: /home/user/lib/virtualenvs/lrcalc_test/bin/python /home/user/lib/virtualenvs/lrcalc_test/lib/python3.8/site-packages/pip install --ignore-installed --no-user --prefix /tmp/pip-build-env-cz4e5gzo/overlay --no-warn-script-location --no-binary :none: --only-binary :none: -i https://test.pypi.org/simple/ -- setuptools cython wheel Check the logs for full command output.\n```\n",
    "created_at": "2021-09-19T21:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444547",
    "user": "asbuch"
}
```

Replying to [comment:66 mkoeppe]:
> Replying to [comment:63 asbuch]:
> > I get the same result when I try to install with pip. I have liblrcalc installed in /usr/local/lib.
> 
> If you post some logs, I can take a look

Thanks! I created a new Python environment with "mkvirtualenv lrcalc_test", then I tried to install with pip and got the following result:


```
> pip install -i https://test.pypi.org/simple/ lrcalc
Looking in indexes: https://test.pypi.org/simple/
Collecting lrcalc
  Downloading https://test-files.pythonhosted.org/packages/d4/c8/c3988b0714fd225cdc4664f79b57161b8292c43eaad3ff81698d3db58147/lrcalc-2.0.1.tar.gz (15 kB)
  Installing build dependencies ... error
  ERROR: Command errored out with exit status 1:
   command: /home/user/lib/virtualenvs/lrcalc_test/bin/python /home/user/lib/virtualenvs/lrcalc_test/lib/python3.8/site-packages/pip install --ignore-installed --no-user --prefix /tmp/pip-build-env-cz4e5gzo/overlay --no-warn-script-location --no-binary :none: --only-binary :none: -i https://test.pypi.org/simple/ -- setuptools cython wheel
       cwd: None
  Complete output (3 lines):
  Looking in indexes: https://test.pypi.org/simple/
  ERROR: Could not find a version that satisfies the requirement setuptools (from versions: none)
  ERROR: No matching distribution found for setuptools
  ----------------------------------------
ERROR: Command errored out with exit status 1: /home/user/lib/virtualenvs/lrcalc_test/bin/python /home/user/lib/virtualenvs/lrcalc_test/lib/python3.8/site-packages/pip install --ignore-installed --no-user --prefix /tmp/pip-build-env-cz4e5gzo/overlay --no-warn-script-location --no-binary :none: --only-binary :none: -i https://test.pypi.org/simple/ -- setuptools cython wheel Check the logs for full command output.
```




---

archive/issue_comments_444548.json:
```json
{
    "body": "When you use `-i`, it overrides the default package index URL, so it cannot find `setuptools` any more. (It does not matter that `setuptools` is already installed in your venv -- this is Python's build isolation.)",
    "created_at": "2021-09-19T21:37:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444548",
    "user": "mkoeppe"
}
```

When you use `-i`, it overrides the default package index URL, so it cannot find `setuptools` any more. (It does not matter that `setuptools` is already installed in your venv -- this is Python's build isolation.)



---

archive/issue_comments_444549.json:
```json
{
    "body": "You can use `--extra-index-url` instead of `-i`.",
    "created_at": "2021-09-19T21:39:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444549",
    "user": "mkoeppe"
}
```

You can use `--extra-index-url` instead of `-i`.



---

archive/issue_comments_444550.json:
```json
{
    "body": "Replying to [comment:72 mkoeppe]:\n> You can use `--extra-index-url` instead of `-i`.\n\nThat made a difference, thanks! I hope this problem will go away if I post to PyPI? I assume the PyPI website will show the command \"pip install lrcalc\"?",
    "created_at": "2021-09-19T21:43:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444550",
    "user": "asbuch"
}
```

Replying to [comment:72 mkoeppe]:
> You can use `--extra-index-url` instead of `-i`.

That made a difference, thanks! I hope this problem will go away if I post to PyPI? I assume the PyPI website will show the command "pip install lrcalc"?



---

archive/issue_comments_444551.json:
```json
{
    "body": "Replying to [comment:73 asbuch]:\n> I hope this problem will go away if I post to PyPI? I assume the PyPI website will show the command \"pip install lrcalc\"?\nThat's right.",
    "created_at": "2021-09-19T21:51:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444551",
    "user": "mkoeppe"
}
```

Replying to [comment:73 asbuch]:
> I hope this problem will go away if I post to PyPI? I assume the PyPI website will show the command "pip install lrcalc"?
That's right.



---

archive/issue_comments_444552.json:
```json
{
    "body": "Here it is: https://pypi.org/project/lrcalc/\n\nMany thanks to Matthias for all the help with this!",
    "created_at": "2021-09-20T01:52:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444552",
    "user": "asbuch"
}
```

Here it is: https://pypi.org/project/lrcalc/

Many thanks to Matthias for all the help with this!



---

archive/issue_comments_444553.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-20T03:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444553",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444554.json:
```json
{
    "body": "Replying to [comment:75 asbuch]:\n> Here it is: https://pypi.org/project/lrcalc/\n\nLooking great!",
    "created_at": "2021-09-20T03:13:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444554",
    "user": "mkoeppe"
}
```

Replying to [comment:75 asbuch]:
> Here it is: https://pypi.org/project/lrcalc/

Looking great!



---

archive/issue_comments_444555.json:
```json
{
    "body": "There's one more detail in the actual C library `lrcalc`. In the `lib..._la_LDFLAGS` in `Makefile.am`, it would be good to add the flag `-no-undefined` - similar to this change: https://github.com/dimpase/autocliquer/commit/ea653f1f65fc0cdd656f7be45726f844862f2229\n\nThis will enable building a shared library on the Cygwin platform (see #29152, #30814).",
    "created_at": "2021-09-20T04:02:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444555",
    "user": "mkoeppe"
}
```

There's one more detail in the actual C library `lrcalc`. In the `lib..._la_LDFLAGS` in `Makefile.am`, it would be good to add the flag `-no-undefined` - similar to this change: https://github.com/dimpase/autocliquer/commit/ea653f1f65fc0cdd656f7be45726f844862f2229

This will enable building a shared library on the Cygwin platform (see #29152, #30814).



---

archive/issue_comments_444556.json:
```json
{
    "body": "Also the tarballs for the library and the Python sdist have the same name. I have already worked around this on the Sage side by having the library's tarball renamed, so no action is needed. But it might be a good idea to avoid this potential confusion.",
    "created_at": "2021-09-20T04:06:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444556",
    "user": "mkoeppe"
}
```

Also the tarballs for the library and the Python sdist have the same name. I have already worked around this on the Sage side by having the library's tarball renamed, so no action is needed. But it might be a good idea to avoid this potential confusion.



---

archive/issue_comments_444557.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-09-20T04:07:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444557",
    "user": "mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_444558.json:
```json
{
    "body": "Replying to [comment:80 mkoeppe]:\n> Also the tarballs for the library and the Python sdist have the same name. I have already worked around this on the Sage side by having the library's tarball renamed, so no action is needed. But it might be a good idea to avoid this potential confusion.\n\nThanks for the comments! I added the -no-undefined flag. I may try to change the PyPI tarball name to lrcalc-bindings-x.y.z.tar.gz next time I need to make changes. (Maybe there is an option to setuptools to make this happen automagically?)",
    "created_at": "2021-09-20T15:50:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444558",
    "user": "asbuch"
}
```

Replying to [comment:80 mkoeppe]:
> Also the tarballs for the library and the Python sdist have the same name. I have already worked around this on the Sage side by having the library's tarball renamed, so no action is needed. But it might be a good idea to avoid this potential confusion.

Thanks for the comments! I added the -no-undefined flag. I may try to change the PyPI tarball name to lrcalc-bindings-x.y.z.tar.gz next time I need to make changes. (Maybe there is an option to setuptools to make this happen automagically?)



---

archive/issue_comments_444559.json:
```json
{
    "body": "I am not aware of an option to customize it in `setuptools`, I think it's a fixed format that uses the distribution package's name (`lrcalc`). Maybe easier to rename the C library package in configure.ac",
    "created_at": "2021-09-20T17:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444559",
    "user": "mkoeppe"
}
```

I am not aware of an option to customize it in `setuptools`, I think it's a fixed format that uses the distribution package's name (`lrcalc`). Maybe easier to rename the C library package in configure.ac



---

archive/issue_comments_444560.json:
```json
{
    "body": "Replying to [comment:83 mkoeppe]:\n> I am not aware of an option to customize it in `setuptools`, I think it's a fixed format that uses the distribution package's name (`lrcalc`). Maybe easier to rename the C library package in configure.ac\n\nOk, thanks. In that case I will see if it works if I change the name of the .tar.gz before I upload it with twine. I don't want to change the name I have used for the main package for many years. If the name conflict is a problem, then I would rather change the name of the PyPI project.",
    "created_at": "2021-09-20T21:09:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444560",
    "user": "asbuch"
}
```

Replying to [comment:83 mkoeppe]:
> I am not aware of an option to customize it in `setuptools`, I think it's a fixed format that uses the distribution package's name (`lrcalc`). Maybe easier to rename the C library package in configure.ac

Ok, thanks. In that case I will see if it works if I change the name of the .tar.gz before I upload it with twine. I don't want to change the name I have used for the main package for many years. If the name conflict is a problem, then I would rather change the name of the PyPI project.



---

archive/issue_comments_444561.json:
```json
{
    "body": "Needs a rebase `:/`",
    "created_at": "2021-10-03T08:40:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444561",
    "user": "tscrim"
}
```

Needs a rebase `:/`



---

archive/issue_comments_444562.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-03T16:37:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444562",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444563.json:
```json
{
    "body": "Some comments:\n\nShouldn't the doc for `def _lrcalc_dict_to_sage(result):` go after the implementation?\n\nI think the extra `dict` call here is unnecessary:\n\n```diff\n-return dict({_Partitions(i):Integer(k) for i,k in result.items()})\n+return {_Partitions(la): Integer(k) for la,k in result.items()}\n```\n\n(I changed the variable to make it more clear that it is a partition being returned.)\n\n```diff\n-return dict({tuple(_Partitions(j) for j in i):Integer(k) for i,k in result.items()})\n+return {tuple(_Partitions(mu) for mu in la): Integer(k) for la,k in result.items()}\n```\n\nAlso, is the `list` call necessary here?\n\n```diff\n-return dict({Permutation(list(i)):Integer(k) for i,k in result.items()})\n+return {Permutation(list(la)): Integer(k) for la,k in result.items()}\n```\n\n\nFor speed and memory usage (1 object instead of 2):\n\n```diff\n     for i,k in result.items():\n-        output[_Partitions(i[0])] = output.get(_Partitions(i[0]), P.zero()) + k*quantum**(i[1])\n+        la = _Partitions(i[0])\n+        output[la] = output.get(la, P.zero()) + k*quantum**(i[1])\n```\n\n\nI believe this could be simplified:\n\n```diff\n-        while True:\n-            try:\n-                word = Word([i+1 for i in next(iterator)])\n-                yield SkewTableaux().from_shape_and_word(shape, word)\n-            except StopIteration:\n-                break\n+        ST = SkewTableaux()\n+        for data in iterator:\n+            yield ST.from_shape_and_word(shape, Word([i+1 for i in data]))\n```\n\nand similarly if `weight` is given. However, I think it would make sense to make `wt = tuple(weight)` and then get the weight of the word (perhaps before even constructing `Word`) first to avoid creating transient objects. We also don't need `word` to be a subclass of `Word`; a `list` is sufficient.",
    "created_at": "2021-10-03T23:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444563",
    "user": "tscrim"
}
```

Some comments:

Shouldn't the doc for `def _lrcalc_dict_to_sage(result):` go after the implementation?

I think the extra `dict` call here is unnecessary:

```diff
-return dict({_Partitions(i):Integer(k) for i,k in result.items()})
+return {_Partitions(la): Integer(k) for la,k in result.items()}
```

(I changed the variable to make it more clear that it is a partition being returned.)

```diff
-return dict({tuple(_Partitions(j) for j in i):Integer(k) for i,k in result.items()})
+return {tuple(_Partitions(mu) for mu in la): Integer(k) for la,k in result.items()}
```

Also, is the `list` call necessary here?

```diff
-return dict({Permutation(list(i)):Integer(k) for i,k in result.items()})
+return {Permutation(list(la)): Integer(k) for la,k in result.items()}
```


For speed and memory usage (1 object instead of 2):

```diff
     for i,k in result.items():
-        output[_Partitions(i[0])] = output.get(_Partitions(i[0]), P.zero()) + k*quantum**(i[1])
+        la = _Partitions(i[0])
+        output[la] = output.get(la, P.zero()) + k*quantum**(i[1])
```


I believe this could be simplified:

```diff
-        while True:
-            try:
-                word = Word([i+1 for i in next(iterator)])
-                yield SkewTableaux().from_shape_and_word(shape, word)
-            except StopIteration:
-                break
+        ST = SkewTableaux()
+        for data in iterator:
+            yield ST.from_shape_and_word(shape, Word([i+1 for i in data]))
```

and similarly if `weight` is given. However, I think it would make sense to make `wt = tuple(weight)` and then get the weight of the word (perhaps before even constructing `Word`) first to avoid creating transient objects. We also don't need `word` to be a subclass of `Word`; a `list` is sufficient.



---

archive/issue_comments_444564.json:
```json
{
    "body": "Replying to [comment:89 tscrim]:\n> Some comments:\n\nThanks for the suggestions, all implemented now.\n\n> Also, is the `list` call necessary here?\n> {{{#!diff\n> -return dict({Permutation(list(i)):Integer(k) for i,k in result.items()})\n> +return {Permutation(list(la)): Integer(k) for la,k in result.items()}\n> }}}\n\nYes, otherwise the Permutation constructor will interpret the tuple input as cycle notation.\n----\nNew commits:",
    "created_at": "2021-10-10T11:30:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444564",
    "user": "arojas"
}
```

Replying to [comment:89 tscrim]:
> Some comments:

Thanks for the suggestions, all implemented now.

> Also, is the `list` call necessary here?
> {{{#!diff
> -return dict({Permutation(list(i)):Integer(k) for i,k in result.items()})
> +return {Permutation(list(la)): Integer(k) for la,k in result.items()}
> }}}

Yes, otherwise the Permutation constructor will interpret the tuple input as cycle notation.
----
New commits:



---

archive/issue_comments_444565.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-11T16:17:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444565",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444566.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-20T07:05:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444566",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444567.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-12-12T13:39:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444567",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444568.json:
```json
{
    "body": "Ping. Anything else needed here?",
    "created_at": "2021-12-12T13:40:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444568",
    "user": "arojas"
}
```

Ping. Anything else needed here?



---

archive/issue_comments_444569.json:
```json
{
    "body": "What is the minimum lrcalc version required by lrcalc_python?",
    "created_at": "2021-12-12T14:33:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444569",
    "user": "dimpase"
}
```

What is the minimum lrcalc version required by lrcalc_python?



---

archive/issue_comments_444570.json:
```json
{
    "body": "lrcalc and lrcalc_python come from the same repo, so I suppose the versions need to match.",
    "created_at": "2021-12-12T17:38:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444570",
    "user": "arojas"
}
```

lrcalc and lrcalc_python come from the same repo, so I suppose the versions need to match.



---

archive/issue_comments_444571.json:
```json
{
    "body": "A number of distrbutions have system-wide lrcalc installations, some still version 1.*, and those can be picked up  by Sage.\n\nIf these are not compatible they should not be used.",
    "created_at": "2021-12-12T17:46:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444571",
    "user": "dimpase"
}
```

A number of distrbutions have system-wide lrcalc installations, some still version 1.*, and those can be picked up  by Sage.

If these are not compatible they should not be used.



---

archive/issue_comments_444572.json:
```json
{
    "body": "1.* will not be picked up, the `ivector.h` header was introduced in 2.0. Don't know about 2.0, according to repology only gentoo is shipping that. `@`fbissey, any reason it hasn't been updated to 2.1?",
    "created_at": "2021-12-12T17:53:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444572",
    "user": "arojas"
}
```

1.* will not be picked up, the `ivector.h` header was introduced in 2.0. Don't know about 2.0, according to repology only gentoo is shipping that. `@`fbissey, any reason it hasn't been updated to 2.1?



---

archive/issue_comments_444573.json:
```json
{
    "body": "I just have been quite busy. And since `@`mjo has migrated a lot of packages to the main tree, I feel less personal pressure to update. We have 2.0 in the main tree but not 2.1 yet. I will have to see what needs to be done.",
    "created_at": "2021-12-12T18:40:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444573",
    "user": "fbissey"
}
```

I just have been quite busy. And since `@`mjo has migrated a lot of packages to the main tree, I feel less personal pressure to update. We have 2.0 in the main tree but not 2.1 yet. I will have to see what needs to be done.



---

archive/issue_comments_444574.json:
```json
{
    "body": "`lrcalc_python/SPKG.rst` claims it is GPL2+ but https://bitbucket.org/asbuch/lrcalc/src/master/python/ and https://bitbucket.org/asbuch/lrcalc/src/master/python/setup.py make it pretty clear that it is GPL3.",
    "created_at": "2021-12-12T21:33:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444574",
    "user": "fbissey"
}
```

`lrcalc_python/SPKG.rst` claims it is GPL2+ but https://bitbucket.org/asbuch/lrcalc/src/master/python/ and https://bitbucket.org/asbuch/lrcalc/src/master/python/setup.py make it pretty clear that it is GPL3.



---

archive/issue_comments_444575.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-12-12T22:21:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444575",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444576.json:
```json
{
    "body": "Replying to [comment:98 dimpase]:\n> A number of distrbutions have system-wide lrcalc installations, some still version 1.*, and those can be picked up  by Sage.\n> \n> If these are not compatible they should not be used.\n\nActually `spkg-configure` didn't work at all because it was using C++ instead of C. Fixed it now and added a check for a header only present in 2.1 so it will fail with older versions.\n\nFixed the license too, should be ready to go now.",
    "created_at": "2021-12-12T22:23:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444576",
    "user": "arojas"
}
```

Replying to [comment:98 dimpase]:
> A number of distrbutions have system-wide lrcalc installations, some still version 1.*, and those can be picked up  by Sage.
> 
> If these are not compatible they should not be used.

Actually `spkg-configure` didn't work at all because it was using C++ instead of C. Fixed it now and added a check for a header only present in 2.1 so it will fail with older versions.

Fixed the license too, should be ready to go now.



---

archive/issue_comments_444577.json:
```json
{
    "body": "I have opened a PR for getting 2.1 in Gentoo and I have an ebuild ready for the python bindings for the sage-on-gentoo overlay just waiting for the PR inclusion before going live [because of dependencies requirements, cannot go in until lrcalc-2.1 is present].",
    "created_at": "2021-12-12T22:30:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444577",
    "user": "fbissey"
}
```

I have opened a PR for getting 2.1 in Gentoo and I have an ebuild ready for the python bindings for the sage-on-gentoo overlay just waiting for the PR inclusion before going live [because of dependencies requirements, cannot go in until lrcalc-2.1 is present].



---

archive/issue_comments_444578.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-12-24T09:22:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444578",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444579.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-01-09T11:47:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444579",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_444580.json:
```json
{
    "body": "Ping, hope to get this in 9.6",
    "created_at": "2022-02-22T20:30:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444580",
    "user": "arojas"
}
```

Ping, hope to get this in 9.6



---

archive/issue_comments_444581.json:
```json
{
    "body": "Does Sage's auto-download mechanism automatically rename the tarballs to their appropriate values. I am worried that both tarballs (lib and python) are called `lrcalc-2.1.tar.gz` on their respective upstream locations.\n\nI made a few other little tweaks and checked the tests. If my changes are good, then it is a positive review.\n----\nNew commits:",
    "created_at": "2022-02-23T04:42:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444581",
    "user": "tscrim"
}
```

Does Sage's auto-download mechanism automatically rename the tarballs to their appropriate values. I am worried that both tarballs (lib and python) are called `lrcalc-2.1.tar.gz` on their respective upstream locations.

I made a few other little tweaks and checked the tests. If my changes are good, then it is a positive review.
----
New commits:



---

archive/issue_comments_444582.json:
```json
{
    "body": "Replying to [comment:109 tscrim]:\n> Does Sage's auto-download mechanism automatically rename the tarballs to their appropriate values. I am worried that both tarballs (lib and python) are called `lrcalc-2.1.tar.gz` on their respective upstream locations.\n\nYes, it is renamed to the value given in the `tarball` field of `checksums.ini`. See comment:80.",
    "created_at": "2022-02-23T04:52:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444582",
    "user": "mkoeppe"
}
```

Replying to [comment:109 tscrim]:
> Does Sage's auto-download mechanism automatically rename the tarballs to their appropriate values. I am worried that both tarballs (lib and python) are called `lrcalc-2.1.tar.gz` on their respective upstream locations.

Yes, it is renamed to the value given in the `tarball` field of `checksums.ini`. See comment:80.



---

archive/issue_comments_444583.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-02-23T07:43:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444583",
    "user": "arojas"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_444584.json:
```json
{
    "body": "Thanks",
    "created_at": "2022-02-23T07:43:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444584",
    "user": "arojas"
}
```

Thanks



---

archive/issue_comments_444585.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-02-27T22:00:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31118",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31118#issuecomment-444585",
    "user": "vbraun"
}
```

Resolution: fixed
