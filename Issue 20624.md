# Issue 20624: numbers.Rational, numbers.Integer, etc. interfaces not implemented correctly

Issue created by migration from https://trac.sagemath.org/ticket/20861

Original creator: dgulotta

Original creation time: 2016-06-22 14:05:43

CC:  jdemeyer mcbell slelievre

The file numbers_abc.py registers some Sage classes as instances of numbers.Rational, numbers.Integer, etc.  However, none of these classes implement the interfaces entirely correctly, because members that the interface expects to be properties (e. g. numerator and denominator in numbers.Rational) are instead functions.

Attempts to use these interfaces will fail in a way that may be confusing to the user:

```
sage: import fractions
sage: fractions.Fraction(1/2)
Fraction(<built-in method numerator of sage.rings.rational.Rational object at 0x7f4268425b30>, <built-in method denominator of sage.rings.rational.Rational object at 0x7f4268425b30>)
sage: fractions.Fraction(1,2)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-3-cee53c78dd93> in <module>()
----> 1 fractions.Fraction(Integer(1),Integer(2))

/home/dan/SageMath/local/lib/python/fractions.pyc in __new__(cls, numerator, denominator)
    152             isinstance(denominator, Rational)):
    153             numerator, denominator = (
--> 154                 numerator.numerator * denominator.denominator,
    155                 denominator.numerator * numerator.denominator
    156                 )

TypeError: unsupported operand type(s) for *: 'builtin_function_or_method' and 'builtin_function_or_method'
```



---

Comment by jdemeyer created at 2016-06-22 14:58:01

Honestly, I don't think this is easy to fix. Sage has a history of using methods for these and related things. So either we drop internal consistency within Sage or we drop compatibility with the numbers ABC.


---

Comment by slelievre created at 2019-07-23 15:42:34

Changing keywords from "" to "rational, numerator, denominator".


---

Comment by slelievre created at 2019-07-23 15:42:34

Changing status from new to needs_review.


---

Comment by slelievre created at 2019-07-23 15:42:34

Proposing to close as a duplicate of #28234 where a solution is being proposed.


---

Comment by jdemeyer created at 2019-08-02 17:05:46

To the OP: why do you care about Python fractions? It's a serious question since Guido van Rossum seems quite negative about them (see https://discuss.python.org/t/pep-3141-ratio-instead-of-numerator-denominator/2037/27?u=jdemeyer)


---

Comment by dgulotta created at 2019-08-02 18:18:37

I filed the bug mainly because it seems like a bad idea to claim to implement interfaces that are not actually implemented.  I probably should have been more clear about this, but I would consider just not registering the instances to be a solution to the problem.


---

Comment by jdemeyer created at 2019-08-02 20:18:34

Resolution: duplicate


---

Comment by jdemeyer created at 2019-08-02 20:18:34

OK, thanks for that info, it's useful to know! I'm closing this now as duplicate of #28234.
