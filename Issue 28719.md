# Issue 28719: correct AC_CHECK_PROG call in spkg-configure for bzip2

Issue created by migration from https://trac.sagemath.org/ticket/28956

Original creator: dimpase

Original creation time: 2020-01-06 07:33:40

CC:  mjo

as noticed in #27182#comment:12
it is incorrect, and always fails

```
configure:10531: checking for break
configure:10561: result: no
```

As the fail action is noop, it "works", always.



---

Comment by git created at 2020-01-06 09:43:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2020-01-06 09:44:13

Changing status from new to needs_review.


---

Comment by embray created at 2020-01-06 13:25:08

Changing status from needs_review to positive_review.


---

Comment by mjo created at 2020-01-06 15:19:18

Changing status from positive_review to needs_work.


---

Comment by mjo created at 2020-01-06 15:19:18

I still think this is funky. If I rename my /bin/bzip2 program, the test succeeds:


```
$ sudo mv /bin/bzip2 /bin/bzip2.bak
$ ./configure
...
configure: === checking whether to install the bzip2 SPKG ===
checking bzlib.h usability... yes
checking bzlib.h presence... yes
checking for bzlib.h... yes
checking for library containing BZ2_bzCompress... -lbz2
checking for bzip2... sage_spkg_install_bzip2=yes
...
    bzip2-1.0.6-20150304.p0 will not be installed (configure check)
```


The value of the bzip2prog variable is being set to the string `sage_spkg_install_bzip2=yes` but that snippet is never actually executed.


---

Comment by dimpase created at 2020-01-06 17:19:51

oops. I forgot that the semantic of these macros is different, they don't specify actions.


---

Comment by git created at 2020-01-07 11:54:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2020-01-07 11:55:18

Changing status from needs_work to needs_review.


---

Comment by mjo created at 2020-01-07 15:03:13

I think we have a winner.


---

Comment by mjo created at 2020-01-07 15:03:13

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-01-11 17:45:12

Resolution: fixed
