# Issue 11827: Renaming lazy attributes

Issue created by migration from https://trac.sagemath.org/ticket/11999

Original creator: SimonKing

Original creation time: 2011-11-07 12:22:03

Assignee: jason

CC:  nthiery

Currently, it is not possible to take an existing lazy attribute and assign it to a different name. The reason is that a lazy attribute overwrites itself by a usual attribute of its `__name__`. But `__name__` is created during initialisation of the lazy attribute. Thus, we have the following example:

```
sage: class Foo(object):
....:     @lazy_attribute
....:     def _bar(self):
....:         return 5
....:     bar = _bar
....:     
sage: f = Foo()
sage: f.bar  # it seems to work,...
5
sage: f.__dict__['bar'] # ... but the lazy attribute has not become a usual attribute
Traceback (most recent call last):
...
KeyError: 'bar'
sage: f.__dict__['_bar']
5
```

By consequence, `f.bar` is much slower than `f._bar`:

```
sage: %timeit f.bar
625 loops, best of 3: 2.78 µs per loop
sage: %timeit f._bar
625 loops, best of 3: 185 ns per loop
```


I suggest to provide lazy attributes with a method `rename()`, returning a copy of that lazy attribute under a new name.

Example, which is a doc test of my patch:

```
sage: class Foo(object):
....:     @lazy_attribute
....:     def _bar(self):
....:         return 5
....:     bar = _bar.rename("bar")
....:     
sage: f = Foo()
sage: f.bar
5
sage: f.__dict__['bar']
5
sage: %timeit f.bar
625 loops, best of 3: 184 ns per loop
sage: %timeit f._bar
625 loops, best of 3: 184 ns per loop
```




---

Comment by SimonKing created at 2011-11-07 12:23:27

Add the possibility to rename a lazy attribute


---

Comment by SimonKing created at 2011-11-07 12:23:40

Changing status from new to needs_review.


---

Attachment


---

Comment by jdemeyer created at 2012-07-27 20:41:54

Please fill in your real name as Author.


---

Comment by tscrim created at 2012-10-15 00:40:18

Changing status from needs_review to needs_work.


---

Comment by tscrim created at 2012-10-15 00:40:18

I believe you should mention that the renamed name needs to match.

```
sage: class Foo(object):
....:     @lazy_attribute
....:     def attr(self):
....:         return 5
....:     bar = attr
....:     renamed = attr.rename("renamed")
....:     diffname = attr.rename("renamed")
....:
sage: f = Foo()
sage: f.bar
5
sage: f.attr
5
sage: f.renamed
5
sage: f.diffname
5
sage: %timeit f.bar
625 loops, best of 3: 15.8 µs per loop
sage: %timeit f.attr
625 loops, best of 3: 344 ns per loop
sage: %timeit f.renamed
625 loops, best of 3: 355 ns per loop
sage: %timeit f.diffname
625 loops, best of 3: 23.2 µs per loop
sage: f.__dict__
{'renamed': 5, 'attr': 5}
```

Additionally please use auto trac linking `:trac:`11999`` in the doc. Functionally it looks good.
