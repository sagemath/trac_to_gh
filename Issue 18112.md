# Issue 18112: Tensor product

archive/issues_018112.json:
```json
{
    "body": "CC:  nthiery tscrim chapoton\n\nKeywords: tensor, categories\n\nHello every one,\n\n\n```\nsage: h = SymmetricFunctions(QQ).h()\nsage: tensor([h]) # I assume that return h?\nSymmetric Functions over Rational Field in the homogeneous basis\nsage: h == tensor([h])\nFalse\n```\n\n\nIt must be a little mistake but I don't find the good category code where change that issue. \n\nIssue created by migration from https://trac.sagemath.org/ticket/18349\n\n",
    "created_at": "2015-05-01T16:46:10Z",
    "labels": [
        "categories",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Tensor product",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18112",
    "user": "elixyre"
}
```
CC:  nthiery tscrim chapoton

Keywords: tensor, categories

Hello every one,


```
sage: h = SymmetricFunctions(QQ).h()
sage: tensor([h]) # I assume that return h?
Symmetric Functions over Rational Field in the homogeneous basis
sage: h == tensor([h])
False
```


It must be a little mistake but I don't find the good category code where change that issue. 

Issue created by migration from https://trac.sagemath.org/ticket/18349





---

archive/issue_comments_244135.json:
```json
{
    "body": "I suppose the bug is in ** sage.categories.covariant_functorial_construction.CovariantFunctorialConstruction._call_ ** but I don't understand what the code means.",
    "created_at": "2015-05-01T16:52:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18112#issuecomment-244135",
    "user": "elixyre"
}
```

I suppose the bug is in ** sage.categories.covariant_functorial_construction.CovariantFunctorialConstruction._call_ ** but I don't understand what the code means.



---

archive/issue_comments_244136.json:
```json
{
    "body": "Salut Jean-Baptiste,\n\n`h` and `tensor([h])` are indeed distinct, the latter being a\n(one-fold) tensor product:\n\n```\n    sage: h = SymmetricFunctions(QQ).h()\n    sage: h1 = tensor([h])\n    sage: type(h1)\n    <class 'sage.combinat.free_module.CombinatorialFreeModule_Tensor_with_category'>\n```\n\n\nIn particular, the basis is indexed by (singleton) tuples of\npartitions, instead of partitions:\n\n```\n    sage: h1.basis().keys().an_element()\n    ([],)\n    sage: h.basis().keys().an_element()\n    []\n```\n\n\nGiven that a one-fold tensor product of a single space V as above is\ntrivially isomorphic to V, the above behavior may look disappointing\nat first. Yet making the distinction explicit is on purpose. The\nrationale is that this enables writing generic code in a uniform way\nwhen constructing the tensor product of a list of spaces; otherwise\none would need to always special case the singleton list (btw:\nideally, we would want to support the empty list as well).\n\nNote that we have the same behavior for e.g. one-fold cartesian\nproducts:\n\n```\n    sage: p2 = cartesian_product([Partitions()])\n    sage: p2\n    The cartesian product of (Partitions,)\n    sage: type(p2)\n    <class 'sage.sets.cartesian_product.CartesianProduct_with_category'>\n    sage: p2.an_element()\n    ([],)\n```\n\n\nThis being said, and unlike for cartesian products, the repr of\none-fold tensor products, as currently returned by\n`CombinatorialFreeModule_Tensor_with_category._repr_`, is indeed very\nmisleading. So I am requalifying this ticket to fix this. Thanks for\nreporting!\n\nWould you have a suggestion for a good repr in this case?\n\nWe also probably want to highlight the above behavior in the\ndocumentation of `tensor?`.\n\nCheers,\n                                       Nicolas",
    "created_at": "2015-05-02T07:19:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18112#issuecomment-244136",
    "user": "nthiery"
}
```

Salut Jean-Baptiste,

`h` and `tensor([h])` are indeed distinct, the latter being a
(one-fold) tensor product:

```
    sage: h = SymmetricFunctions(QQ).h()
    sage: h1 = tensor([h])
    sage: type(h1)
    <class 'sage.combinat.free_module.CombinatorialFreeModule_Tensor_with_category'>
```


In particular, the basis is indexed by (singleton) tuples of
partitions, instead of partitions:

```
    sage: h1.basis().keys().an_element()
    ([],)
    sage: h.basis().keys().an_element()
    []
```


Given that a one-fold tensor product of a single space V as above is
trivially isomorphic to V, the above behavior may look disappointing
at first. Yet making the distinction explicit is on purpose. The
rationale is that this enables writing generic code in a uniform way
when constructing the tensor product of a list of spaces; otherwise
one would need to always special case the singleton list (btw:
ideally, we would want to support the empty list as well).

Note that we have the same behavior for e.g. one-fold cartesian
products:

```
    sage: p2 = cartesian_product([Partitions()])
    sage: p2
    The cartesian product of (Partitions,)
    sage: type(p2)
    <class 'sage.sets.cartesian_product.CartesianProduct_with_category'>
    sage: p2.an_element()
    ([],)
```


This being said, and unlike for cartesian products, the repr of
one-fold tensor products, as currently returned by
`CombinatorialFreeModule_Tensor_with_category._repr_`, is indeed very
misleading. So I am requalifying this ticket to fix this. Thanks for
reporting!

Would you have a suggestion for a good repr in this case?

We also probably want to highlight the above behavior in the
documentation of `tensor?`.

Cheers,
                                       Nicolas



---

archive/issue_comments_244137.json:
```json
{
    "body": "Thanks, it seems clear to me now.\n\nReplying to [comment:2 nthiery]:\n> Would you have a suggestion for a good repr in this case?\n\nI don't have any opinion, may be:\n\n```\nsage: h = Sym(QQ).h()\nsage: tensor([h])\nTensor:[Symmetric Functions over Rational Field in the homogeneous basis]\n```\n\n?\n\nReplying to [comment:2 nthiery]:\n> We also probably want to highlight the above behavior in the\n> documentation of `tensor?`.\n\nMay be... \n\nIn this way, I have an other stupid question, when we have a tensor product:\n\n\n```\nsage: S = NCSF(QQ).S()\nsage: t = tensor([h, S])\n```\n\n\nThere is a friendly way to recover `h` and `S` from `t`?",
    "created_at": "2015-05-03T09:22:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18112#issuecomment-244137",
    "user": "elixyre"
}
```

Thanks, it seems clear to me now.

Replying to [comment:2 nthiery]:
> Would you have a suggestion for a good repr in this case?

I don't have any opinion, may be:

```
sage: h = Sym(QQ).h()
sage: tensor([h])
Tensor:[Symmetric Functions over Rational Field in the homogeneous basis]
```

?

Replying to [comment:2 nthiery]:
> We also probably want to highlight the above behavior in the
> documentation of `tensor?`.

May be... 

In this way, I have an other stupid question, when we have a tensor product:


```
sage: S = NCSF(QQ).S()
sage: t = tensor([h, S])
```


There is a friendly way to recover `h` and `S` from `t`?



---

archive/issue_comments_244138.json:
```json
{
    "body": "At the price of breaking encapsulation, you can do `t._sets`. There should be a method `t.tensor_factors()`. It's probably been implemented by Mark, typically in #15832.",
    "created_at": "2015-05-03T09:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18112#issuecomment-244138",
    "user": "nthiery"
}
```

At the price of breaking encapsulation, you can do `t._sets`. There should be a method `t.tensor_factors()`. It's probably been implemented by Mark, typically in #15832.



---

archive/issue_comments_244139.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18112",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18112#issuecomment-244139",
    "user": "mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.
