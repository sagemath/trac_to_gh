# Issue 12960: Small string formatting bug in Graph.delete_vertex

Issue created by migration from https://trac.sagemath.org/ticket/13132

Original creator: tjolivet

Original creation time: 2012-06-18 22:13:57

Assignee: jason, ncohen, rlm

If we remove a vertex which is a tuple from a graph which does not contain this vertex, Sage fails because it raises a `TypeError` instead of the usual `RuntimeError: Vertex (1) not in the graph.`


```
sage: G = Graph()
sage: G.delete_vertex((1,'a'))
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/home/jaje/e_one_star/<ipython console> in <module>()

/home/jaje/sage-5.0.1/local/lib/python2.7/site-packages/sage/graphs/generic_graph.pyc in delete_vertex(self, vertex, in_order)
   7247             vertex = self.vertices()[vertex]
   7248         if vertex not in self:
-> 7249             raise RuntimeError("Vertex (%s) not in the graph."%vertex)
   7250 
   7251         attributes_to_update = ('_pos', '_assoc', '_embedding')

TypeError: not all arguments converted during string formatting
```


This is because the source code reads

```
raise RuntimeError("Vertex (%s) not in the graph."%vertex)
```

so it fails if `vertex` is a tuple (too many values to unpack for the `%s`), as illustrated here:


```
sage: "BLA%sBLA"%(1,'a')      
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/home/jaje/e_one_star/<ipython console> in <module>()

TypeError: not all arguments converted during string formatting
sage: "BLA%sBLA"%str((1,'a'))
"BLA(1, 'a')BLA"
```


I guess this bug can just be corrected by replacing all the occurrences of `%vertex` by `%str(vertex)`. It also occurs in `DiGraph.delete_vertex`.


---

Attachment

This patch solves the problem for Graph and DiGraph since the function is in `generic_graph.py`. The `delete_vertices` also add the same bug.


---

Comment by dcoudert created at 2012-08-09 23:50:13

Changing status from new to needs_review.


---

Comment by tjolivet created at 2012-08-10 00:25:50

Changing status from needs_review to positive_review.


---

Comment by tjolivet created at 2012-08-10 00:25:59

Thanks!


---

Comment by dcoudert created at 2012-08-10 00:33:28

You are welcome.


---

Comment by jdemeyer created at 2012-08-14 07:04:01

Resolution: fixed
