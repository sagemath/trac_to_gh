# Issue 11544: remove twisted.persisted.styles import

Issue created by migration from https://trac.sagemath.org/ticket/11716

Original creator: saraedum

Original creation time: 2011-08-22 19:43:23

Assignee: jason

The import of _twisted.persisted.styles_ takes a significant amount of time on sage startup:

```
$ time ./sage -startuptime|grep twisted.persisted.styles:
 twisted.persisted.styles: 0.093 (sage.all)

real    0m1.422s
```


Most functionality from that module seems not to be used in sage. The attached patch removes everything but the needed functionality:

```
$ time ./sage -startuptime|grep twisted.persisted.styles:

real    0m1.280s
```



---

Comment by mhansen created at 2011-08-22 22:14:34

I like the idea of this, but I think that the methods should be moved into say "sage.misc.fpickle" instead of "sage.misc.cachefunc".


---

Attachment


---

Comment by saraedum created at 2011-08-23 00:07:11

Good point. I was actually unsure where to put it. I fixed the patch accordingly. I'm waiting for the doctests to finish now.


---

Comment by saraedum created at 2011-08-23 03:12:22

Passed the doctests against 4.7.2.alpha2.


---

Comment by saraedum created at 2011-08-23 03:12:22

Changing status from new to needs_review.


---

Comment by robertwb created at 2011-08-23 05:49:39

Changing status from needs_review to positive_review.


---

Comment by robertwb created at 2011-08-23 05:49:39

That one was at the top of my hit list too--I'm relieved it turned out to be so painless.


---

Comment by jdemeyer created at 2011-08-23 06:40:16

saraedum: please add your real name as Author on this ticket.  It would also be good to put yourself on [http://trac.sagemath.org/sage_trac/#AccountNamesMappedtoRealNames](http://trac.sagemath.org/sage_trac/#AccountNamesMappedtoRealNames).


---

Comment by jdemeyer created at 2011-08-23 06:51:57

Changing priority from minor to critical.


---

Comment by jdemeyer created at 2011-08-23 06:51:57

Changing component from misc to performance.


---

Comment by was created at 2011-08-24 18:48:49

I added saraedum's real name to the Author on the ticket at the wiki.


---

Comment by was created at 2011-08-24 23:30:35

Changing keywords from "" to "sd32".


---

Comment by leif created at 2011-09-08 12:13:51

Changing keywords from "sd32" to "sd32 start-up time startup".


---

Comment by leif created at 2011-09-17 05:15:56

Resolution: fixed


---

Comment by leif created at 2011-09-28 16:50:50

"Proper" Mercurial changeset replacement patch.


---

Attachment

I've attached a `*.proper.patch`, which is identical except that I removed the "garbage" before "`# HG changeset patch`", i.e., I deleted the first line "`exporting patch:`", since Jeroen's current merger rejects such patches.

For now, please make sure all your patches start with "`# HG changeset patch`", i.e., have it on the first line without any preceding messages or whatever.

I've relaxed that in _my version_ of the merger, but Jeroen and maybe others are likely to use his more restrictive one.
