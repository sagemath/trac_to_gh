# Issue 27205: Implement option for factoring differentials out of Weyl algebras

archive/issues_027205.json:
```json
{
    "body": "CC:  chapoton\n\nKeywords: Weyl algebra\n\nIt is natural to write the elements of the (differential) Weyl algebra with the differentials factored out (on the right). This is a common expression for the elements in the single variable case.\n\nIssue created by migration from https://trac.sagemath.org/ticket/27442\n\n",
    "created_at": "2019-03-08T04:43:52Z",
    "labels": [
        "algebra",
        "major",
        "enhancement"
    ],
    "title": "Implement option for factoring differentials out of Weyl algebras",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27205",
    "user": "tscrim"
}
```
CC:  chapoton

Keywords: Weyl algebra

It is natural to write the elements of the (differential) Weyl algebra with the differentials factored out (on the right). This is a common expression for the elements in the single variable case.

Issue created by migration from https://trac.sagemath.org/ticket/27442





---

archive/issue_comments_383300.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-03-08T04:49:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27205#issuecomment-383300",
    "user": "tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_383301.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-03-08T04:49:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27205#issuecomment-383301",
    "user": "tscrim"
}
```

New commits:



---

archive/issue_comments_383302.json:
```json
{
    "body": "I would appreciate a review here (bot is morally green), but I will understand if you do not want to as this is not a trivial ticket.",
    "created_at": "2019-03-11T22:36:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27205#issuecomment-383302",
    "user": "tscrim"
}
```

I would appreciate a review here (bot is morally green), but I will understand if you do not want to as this is not a trivial ticket.



---

archive/issue_comments_383303.json:
```json
{
    "body": "Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27205#issuecomment-383303",
    "user": "embray"
}
```

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_comments_383304.json:
```json
{
    "body": "A couple of small remarks:\n1. `for e,g in`: Not sure if PEP8 would say `for e, g in` (space after comma) here. (found three times)\n2. `[True,False]` (very last line of patch): here PEP8 for sure\n2. Also `R.<x,y,z>`, `x,y,z,dx,dy,dz`, `t,dt` should IMO been written with space after comma.\n3. `factor_differentials` is not doctested.\n4. `(8*t^3 + 18*t)dt^1` (discussion): Should there be a `*` before the `dt`? (In some sense, this would be closer to a representation that one could feed back into the system and let it evaluate (i.e. correct Python syntax). However, I am aware that this might not be a major usecase (if at all).\n5. Latex `d^{3}_{t}`: I simply do not know if this is the standard convention to write to typeset it; I simply believe you here and just wanted it noted.\n\nOtherwise, LGTM.",
    "created_at": "2019-03-27T13:55:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27205#issuecomment-383304",
    "user": "dkrenn"
}
```

A couple of small remarks:
1. `for e,g in`: Not sure if PEP8 would say `for e, g in` (space after comma) here. (found three times)
2. `[True,False]` (very last line of patch): here PEP8 for sure
2. Also `R.<x,y,z>`, `x,y,z,dx,dy,dz`, `t,dt` should IMO been written with space after comma.
3. `factor_differentials` is not doctested.
4. `(8*t^3 + 18*t)dt^1` (discussion): Should there be a `*` before the `dt`? (In some sense, this would be closer to a representation that one could feed back into the system and let it evaluate (i.e. correct Python syntax). However, I am aware that this might not be a major usecase (if at all).
5. Latex `d^{3}_{t}`: I simply do not know if this is the standard convention to write to typeset it; I simply believe you here and just wanted it noted.

Otherwise, LGTM.



---

archive/issue_comments_383305.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-03-27T13:55:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27205#issuecomment-383305",
    "user": "dkrenn"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_383306.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-16T01:22:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27205#issuecomment-383306",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383307.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-04-16T01:23:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27205#issuecomment-383307",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_383308.json:
```json
{
    "body": "Replying to [comment:4 dkrenn]:\n> A couple of small remarks:\n> 1. `for e,g in`: Not sure if PEP8 would say `for e, g in` (space after comma) here. (found three times)\n\nPEP8 allows you to remove the space for operators when inside of a lower precedence operator. So IMO the no space is fine (and can be more readable). However, I don't care so strongly and have changed it.\n\n> 2. `[True,False]` (very last line of patch): here PEP8 for sure\n\nSee above.\n\n> 2. Also `R.<x,y,z>`, `x,y,z,dx,dy,dz`, `t,dt` should IMO been written with space after comma.\n\nIMO, the `R.<x,y,z>` looks better and is easier to read (and fits PEP8 in the sense given above). However, I agree that there can be spacing for the list of generators, so I have changed those.\n\n> 3. `factor_differentials` is not doctested.\n\nWhoops, thanks. Fixed.\n\n> 4. `(8*t^3 + 18*t)dt^1` (discussion): Should there be a `*` before the `dt`? (In some sense, this would be closer to a representation that one could feed back into the system and let it evaluate (i.e. correct Python syntax). However, I am aware that this might not be a major usecase (if at all).\n\nThat is a good point. I have added that.\n\n> 5. Latex `d^{3}_{t}`: I simply do not know if this is the standard convention to write to typeset it; I simply believe you here and just wanted it noted.\n\nIt was a good thing to note. In PDEs, people use d<sub>t</sub> for the derivative wrt t. However, in this case, I used the del/`\\partial` notation, so I changed it to be consistent with that.",
    "created_at": "2019-04-16T01:27:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27205#issuecomment-383308",
    "user": "tscrim"
}
```

Replying to [comment:4 dkrenn]:
> A couple of small remarks:
> 1. `for e,g in`: Not sure if PEP8 would say `for e, g in` (space after comma) here. (found three times)

PEP8 allows you to remove the space for operators when inside of a lower precedence operator. So IMO the no space is fine (and can be more readable). However, I don't care so strongly and have changed it.

> 2. `[True,False]` (very last line of patch): here PEP8 for sure

See above.

> 2. Also `R.<x,y,z>`, `x,y,z,dx,dy,dz`, `t,dt` should IMO been written with space after comma.

IMO, the `R.<x,y,z>` looks better and is easier to read (and fits PEP8 in the sense given above). However, I agree that there can be spacing for the list of generators, so I have changed those.

> 3. `factor_differentials` is not doctested.

Whoops, thanks. Fixed.

> 4. `(8*t^3 + 18*t)dt^1` (discussion): Should there be a `*` before the `dt`? (In some sense, this would be closer to a representation that one could feed back into the system and let it evaluate (i.e. correct Python syntax). However, I am aware that this might not be a major usecase (if at all).

That is a good point. I have added that.

> 5. Latex `d^{3}_{t}`: I simply do not know if this is the standard convention to write to typeset it; I simply believe you here and just wanted it noted.

It was a good thing to note. In PDEs, people use d<sub>t</sub> for the derivative wrt t. However, in this case, I used the del/`\partial` notation, so I changed it to be consistent with that.



---

archive/issue_comments_383309.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-04-16T08:55:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27205#issuecomment-383309",
    "user": "dkrenn"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_383310.json:
```json
{
    "body": "Replying to [comment:8 tscrim]:\n> Replying to [comment:4 dkrenn]:\n> > A couple of small remarks:\n> > 1. `for e,g in`: Not sure if PEP8 would say `for e, g in` (space after comma) here. (found three times)\n> \n> PEP8 allows you to remove the space for operators when inside of a lower precedence operator. So IMO the no space is fine (and can be more readable). However, I don't care so strongly and have changed it.\n\nI see. I know of this rule, but never interpreted it for skipping space after a comma. If I would have known that, I might would have reviewed differently. Anyways, thanks for changing; I think that in many parts of [SageMath](SageMath), there are spaces after commas.\n\n> > 2. Also `R.<x,y,z>`, `x,y,z,dx,dy,dz`, `t,dt` should IMO been written with space after comma.\n> \n> IMO, the `R.<x,y,z>` looks better and is easier to read (and fits PEP8 in the sense given above). However, I agree that there can be spacing for the list of generators, so I have changed those.\n\nThanks. LGTM.\n\n> > 3. `factor_differentials` is not doctested.\n> \n> Whoops, thanks. Fixed.\n\nLGTM.\n\n> > 4. `(8*t^3 + 18*t)dt^1` (discussion): Should there be a `*` before the `dt`? (In some sense, this would be closer to a representation that one could feed back into the system and let it evaluate (i.e. correct Python syntax). However, I am aware that this might not be a major usecase (if at all).\n> \n> That is a good point. I have added that.\n\nThanks.\n\n> > 5. Latex `d^{3}_{t}`: I simply do not know if this is the standard convention to write to typeset it; I simply believe you here and just wanted it noted.\n> \n> It was a good thing to note. In PDEs, people use d<sub>t</sub> for the derivative wrt t. However, in this case, I used the del/`\\partial` notation, so I changed it to be consistent with that.\n\nOk, thank you for the explanation.\n\nSo, for me this everything looks fine. Once the patchbot is happy, this is a positive review.",
    "created_at": "2019-04-16T08:55:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27205#issuecomment-383310",
    "user": "dkrenn"
}
```

Replying to [comment:8 tscrim]:
> Replying to [comment:4 dkrenn]:
> > A couple of small remarks:
> > 1. `for e,g in`: Not sure if PEP8 would say `for e, g in` (space after comma) here. (found three times)
> 
> PEP8 allows you to remove the space for operators when inside of a lower precedence operator. So IMO the no space is fine (and can be more readable). However, I don't care so strongly and have changed it.

I see. I know of this rule, but never interpreted it for skipping space after a comma. If I would have known that, I might would have reviewed differently. Anyways, thanks for changing; I think that in many parts of [SageMath](SageMath), there are spaces after commas.

> > 2. Also `R.<x,y,z>`, `x,y,z,dx,dy,dz`, `t,dt` should IMO been written with space after comma.
> 
> IMO, the `R.<x,y,z>` looks better and is easier to read (and fits PEP8 in the sense given above). However, I agree that there can be spacing for the list of generators, so I have changed those.

Thanks. LGTM.

> > 3. `factor_differentials` is not doctested.
> 
> Whoops, thanks. Fixed.

LGTM.

> > 4. `(8*t^3 + 18*t)dt^1` (discussion): Should there be a `*` before the `dt`? (In some sense, this would be closer to a representation that one could feed back into the system and let it evaluate (i.e. correct Python syntax). However, I am aware that this might not be a major usecase (if at all).
> 
> That is a good point. I have added that.

Thanks.

> > 5. Latex `d^{3}_{t}`: I simply do not know if this is the standard convention to write to typeset it; I simply believe you here and just wanted it noted.
> 
> It was a good thing to note. In PDEs, people use d<sub>t</sub> for the derivative wrt t. However, in this case, I used the del/`\partial` notation, so I changed it to be consistent with that.

Ok, thank you for the explanation.

So, for me this everything looks fine. Once the patchbot is happy, this is a positive review.



---

archive/issue_comments_383311.json:
```json
{
    "body": "Thanks. PEP8 allows for some flexibility and interpretation. Bottom line is being consistent and what looks \"good\".\n\nSo the patchbot is essentially happy modulo one bad doctest (I swore I tested the file before pushing...), which I will fix when I get to my desktop tomorrow morning (I am based in Australia).",
    "created_at": "2019-04-16T11:19:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27205#issuecomment-383311",
    "user": "tscrim"
}
```

Thanks. PEP8 allows for some flexibility and interpretation. Bottom line is being consistent and what looks "good".

So the patchbot is essentially happy modulo one bad doctest (I swore I tested the file before pushing...), which I will fix when I get to my desktop tomorrow morning (I am based in Australia).



---

archive/issue_comments_383312.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-04-17T00:46:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27205#issuecomment-383312",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_383313.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-04-17T00:47:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27205#issuecomment-383313",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_383314.json:
```json
{
    "body": "I fixed that one doctest and did a force push since it was a trivial change. With that, I now get the file passing all tests:\n\n```\nUsing --optional=4ti2,coxeter3,dochtml,dot2tex,gambit,latte_int,lidia,lrslib,meataxe,memlimit,mpir,normaliz,p_group_cohomology,pynormaliz,python2,sage,sirocco\nDoctesting 1 file using 8 threads.\nsage -t --long weyl_algebra.py\n    [196 tests, 0.16 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 0.2 seconds\n    cpu time: 0.2 seconds\n    cumulative wall time: 0.2 seconds\n```\n\nThis with the previous green bot, I am allowing myself to set a positive review. If you disagree Daniel (and want to wait for another patchbot), just set it back to needs review.\n\nThank you for the review.",
    "created_at": "2019-04-17T00:47:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27205#issuecomment-383314",
    "user": "tscrim"
}
```

I fixed that one doctest and did a force push since it was a trivial change. With that, I now get the file passing all tests:

```
Using --optional=4ti2,coxeter3,dochtml,dot2tex,gambit,latte_int,lidia,lrslib,meataxe,memlimit,mpir,normaliz,p_group_cohomology,pynormaliz,python2,sage,sirocco
Doctesting 1 file using 8 threads.
sage -t --long weyl_algebra.py
    [196 tests, 0.16 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 0.2 seconds
    cpu time: 0.2 seconds
    cumulative wall time: 0.2 seconds
```

This with the previous green bot, I am allowing myself to set a positive review. If you disagree Daniel (and want to wait for another patchbot), just set it back to needs review.

Thank you for the review.



---

archive/issue_comments_383315.json:
```json
{
    "body": "Replying to [comment:12 tscrim]:\n> I fixed that one doctest and [...]\n> This with the previous green bot, I am allowing myself to set a positive review. If you disagree Daniel (and want to wait for another patchbot), just set it back to needs review.\n\nFine for me, thank you.\n\n> Thank you for the review.\n\nYou're welcome.",
    "created_at": "2019-04-17T07:32:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27205#issuecomment-383315",
    "user": "dkrenn"
}
```

Replying to [comment:12 tscrim]:
> I fixed that one doctest and [...]
> This with the previous green bot, I am allowing myself to set a positive review. If you disagree Daniel (and want to wait for another patchbot), just set it back to needs review.

Fine for me, thank you.

> Thank you for the review.

You're welcome.



---

archive/issue_comments_383316.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-04-18T19:56:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27205#issuecomment-383316",
    "user": "vbraun"
}
```

Resolution: fixed
