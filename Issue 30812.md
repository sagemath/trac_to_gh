# Issue 30812: Some virtual env tool rewrites sage-version.sh as if it is a Python script

archive/issues_030812.json:
```json
{
    "body": "CC:  @tobiasdiez jhpalmieri\n\n(from #31004)\n\nIssue created by migration from https://trac.sagemath.org/ticket/31049\n\n",
    "created_at": "2020-12-14T18:14:27Z",
    "labels": [
        "scripts",
        "major",
        "bug"
    ],
    "title": "Some virtual env tool rewrites sage-version.sh as if it is a Python script",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30812",
    "user": "mkoeppe"
}
```
CC:  @tobiasdiez jhpalmieri

(from #31004)

Issue created by migration from https://trac.sagemath.org/ticket/31049





---

archive/issue_comments_440449.json:
```json
{
    "body": "Saving the continuation:\n\n`pip install virtualenv` embeds absolute path to Python interpreter \u00b7 Issue #5048 \u00b7 pypa/pip\nhttps://github.com/pypa/pip/issues/5048\n\nSearch \u2014 Bitbucket\nhttps://bitbucket.org/search?q=repo%3Adistlib%20ScriptMaker&account=%7Beeed5f62-f24a-4bdd-9190-1966bfb7cf0e%7D\n\nWelcome to distlib\u2019s documentation! \u2014 Distlib 0.3.1 documentation\nhttps://distlib.readthedocs.io/en/stable/\n\npypa / distlib / tests / test_scripts.py \u2014 Bitbucket\nhttps://bitbucket.org/pypa/distlib/src/207d4599a330913d51a4c5865745a49e11e851cb/tests/test_scripts.py?at=master#test_scripts.py-24,41,67,113\n\npypa / distlib / docs / tutorial.rst \u2014 Bitbucket\nhttps://bitbucket.org/pypa/distlib/src/207d4599a330913d51a4c5865745a49e11e851cb/docs/tutorial.rst?at=master#tutorial.rst-1159,1163:1164,1185,1226:1227,1277,1279\n\npip/wheel.py at facc1e56582e60371170c0cb3f955c9c7cd96790 \u00b7 pypa/pip\nhttps://github.com/pypa/pip/blob/facc1e56582e60371170c0cb3f955c9c7cd96790/src/pip/_internal/operations/install/wheel.py",
    "created_at": "2021-03-20T18:59:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30812",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30812#issuecomment-440449",
    "user": "mkoeppe"
}
```

Saving the continuation:

`pip install virtualenv` embeds absolute path to Python interpreter · Issue #5048 · pypa/pip
https://github.com/pypa/pip/issues/5048

Search — Bitbucket
https://bitbucket.org/search?q=repo%3Adistlib%20ScriptMaker&account=%7Beeed5f62-f24a-4bdd-9190-1966bfb7cf0e%7D

Welcome to distlib’s documentation! — Distlib 0.3.1 documentation
https://distlib.readthedocs.io/en/stable/

pypa / distlib / tests / test_scripts.py — Bitbucket
https://bitbucket.org/pypa/distlib/src/207d4599a330913d51a4c5865745a49e11e851cb/tests/test_scripts.py?at=master#test_scripts.py-24,41,67,113

pypa / distlib / docs / tutorial.rst — Bitbucket
https://bitbucket.org/pypa/distlib/src/207d4599a330913d51a4c5865745a49e11e851cb/docs/tutorial.rst?at=master#tutorial.rst-1159,1163:1164,1185,1226:1227,1277,1279

pip/wheel.py at facc1e56582e60371170c0cb3f955c9c7cd96790 · pypa/pip
https://github.com/pypa/pip/blob/facc1e56582e60371170c0cb3f955c9c7cd96790/src/pip/_internal/operations/install/wheel.py



---

archive/issue_comments_440450.json:
```json
{
    "body": "Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-24T02:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30812",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30812#issuecomment-440450",
    "user": "mkoeppe"
}
```

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_440451.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2022-07-22T22:54:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30812",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30812#issuecomment-440451",
    "user": "mkoeppe"
}
```

Changing priority from major to critical.



---

archive/issue_comments_440452.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-07-23T00:18:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30812",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30812#issuecomment-440452",
    "user": "mkoeppe"
}
```

New commits:



---

archive/issue_comments_440453.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-07-23T00:18:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30812",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30812#issuecomment-440453",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_440454.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-23T02:56:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30812",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30812#issuecomment-440454",
    "user": "jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_440455.json:
```json
{
    "body": "I'm not sure why a file with suffix `.sh` should be treated as a Python file, but this seems to fix the problem.",
    "created_at": "2022-07-23T02:56:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30812",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30812#issuecomment-440455",
    "user": "jhpalmieri"
}
```

I'm not sure why a file with suffix `.sh` should be treated as a Python file, but this seems to fix the problem.



---

archive/issue_comments_440456.json:
```json
{
    "body": "Thanks!",
    "created_at": "2022-07-23T03:05:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30812",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30812#issuecomment-440456",
    "user": "mkoeppe"
}
```

Thanks!



---

archive/issue_comments_440457.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-07-28T19:11:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30812",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30812#issuecomment-440457",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_440458.json:
```json
{
    "body": "By the way, why do the errors in the ticket description not cause the program to quit with an error? I see these in the `sagemath_doc_html-none` log file, but docbuilding continues nonetheless.",
    "created_at": "2022-08-01T00:40:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30812",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30812#issuecomment-440458",
    "user": "jhpalmieri"
}
```

By the way, why do the errors in the ticket description not cause the program to quit with an error? I see these in the `sagemath_doc_html-none` log file, but docbuilding continues nonetheless.



---

archive/issue_comments_440459.json:
```json
{
    "body": "`sage-version.sh` is invoked by `src/bin/sage`, which just ignores the error",
    "created_at": "2022-08-01T00:44:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30812",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30812#issuecomment-440459",
    "user": "mkoeppe"
}
```

`sage-version.sh` is invoked by `src/bin/sage`, which just ignores the error
