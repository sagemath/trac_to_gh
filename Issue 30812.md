# Issue 30812: Some virtual env tool rewrites sage-version.sh as if it is a Python script

Issue created by migration from https://trac.sagemath.org/ticket/31049

Original creator: mkoeppe

Original creation time: 2020-12-14 18:14:27

CC:  @tobiasdiez jhpalmieri

(from #31004)


---

Comment by mkoeppe created at 2021-03-20 18:59:12

Saving the continuation:

`pip install virtualenv` embeds absolute path to Python interpreter · Issue #5048 · pypa/pip
https://github.com/pypa/pip/issues/5048

Search — Bitbucket
https://bitbucket.org/search?q=repo%3Adistlib%20ScriptMaker&account=%7Beeed5f62-f24a-4bdd-9190-1966bfb7cf0e%7D

Welcome to distlib’s documentation! — Distlib 0.3.1 documentation
https://distlib.readthedocs.io/en/stable/

pypa / distlib / tests / test_scripts.py — Bitbucket
https://bitbucket.org/pypa/distlib/src/207d4599a330913d51a4c5865745a49e11e851cb/tests/test_scripts.py?at=master#test_scripts.py-24,41,67,113

pypa / distlib / docs / tutorial.rst — Bitbucket
https://bitbucket.org/pypa/distlib/src/207d4599a330913d51a4c5865745a49e11e851cb/docs/tutorial.rst?at=master#tutorial.rst-1159,1163:1164,1185,1226:1227,1277,1279

pip/wheel.py at facc1e56582e60371170c0cb3f955c9c7cd96790 · pypa/pip
https://github.com/pypa/pip/blob/facc1e56582e60371170c0cb3f955c9c7cd96790/src/pip/_internal/operations/install/wheel.py


---

Comment by mkoeppe created at 2021-03-24 02:04:25

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.


---

Comment by mkoeppe created at 2022-07-22 22:54:27

Changing priority from major to critical.


---

Comment by mkoeppe created at 2022-07-23 00:18:33

New commits:


---

Comment by mkoeppe created at 2022-07-23 00:18:33

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2022-07-23 02:56:56

Changing status from needs_review to positive_review.


---

Comment by jhpalmieri created at 2022-07-23 02:56:56

I'm not sure why a file with suffix `.sh` should be treated as a Python file, but this seems to fix the problem.


---

Comment by mkoeppe created at 2022-07-23 03:05:55

Thanks!


---

Comment by vbraun created at 2022-07-28 19:11:16

Resolution: fixed


---

Comment by jhpalmieri created at 2022-08-01 00:40:22

By the way, why do the errors in the ticket description not cause the program to quit with an error? I see these in the `sagemath_doc_html-none` log file, but docbuilding continues nonetheless.


---

Comment by mkoeppe created at 2022-08-01 00:44:41

`sage-version.sh` is invoked by `src/bin/sage`, which just ignores the error
