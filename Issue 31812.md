# Issue 31812: Update FriCAS to 1.3.7

Issue created by migration from https://trac.sagemath.org/ticket/32049

Original creator: mantepse

Original creation time: 2021-06-24 11:22:40

CC:  slelievre chapoton

Keywords: fricas

A preliminary release branch is at https://sourceforge.net/projects/fricas/files/fricas/1.3.7/fricas-1.3.7-full.tar.bz2


This ticket is to upgrade to FriCAS 1.3.7 and track dependencies.

Tarball: see checksums.ini

Note that FriCAS has switched to using Git and the primary repository is now the one at GitHub, but the homepage remains at Sourceforge:

- https://fricas.sourceforge.net

and we still get source tarballs from Sourceforge since those available at GitHub are not the full source archives we need.

- http://fricas.sourceforge.net/
- https://github.com/fricas/fricas/releases

Our last update was to Fricas 1.3.6 in #27309 in 2020.

To try this ticket from your Sage root directory, with `git-trac-command` installed:

1. `git trac try `
2. `SAGE_SPKG="sage-spkg -o" ./sage -i fricas` (or use `./configure --enable-download-from-upstream-url` first)
3. `./sage -t --optional=fricas,sage src/sage/interfaces/fricas.py`


---

Comment by mantepse created at 2021-06-24 11:23:47

Changing type from PLEASE CHANGE to enhancement.


---

Comment by dimpase created at 2021-06-27 10:57:31

branch?


---

Comment by mantepse created at 2021-07-07 08:42:29

New commits:


---

Comment by mantepse created at 2021-07-07 08:42:29

Changing status from new to needs_review.


---

Comment by dimpase created at 2021-07-08 08:15:37

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2021-07-08 08:15:37

lgtm


---

Comment by dimpase created at 2021-07-08 12:53:58

does not build on macOS:

```
[fricas-1.3.7.p1] No legacy uninstaller found for 'fricas'; nothing to do
[fricas-1.3.7.p1] Configuring fricas-1.3.7.p1
[fricas-1.3.7.p1] configure: WARNING: unrecognized options: --disable-static, --disable-maintainer-mode, --disable-dependency-tracking
[fricas-1.3.7.p1] checking build system type... x86_64-apple-darwin20.5.0
[fricas-1.3.7.p1] checking host system type... x86_64-apple-darwin20.5.0
[fricas-1.3.7.p1] checking target system type... x86_64-apple-darwin20.5.0
[fricas-1.3.7.p1] checking for in-tree build on case insensitive file system... configure: error: in tree build on case insensitive file system is not supported. Use out-of-source build instead.
[fricas-1.3.7.p1] configure: WARNING: unrecognized options: --disable-static
[fricas-1.3.7.p1] checking build system type... x86_64-apple-darwin20.5.0
[fricas-1.3.7.p1] checking host system type... x86_64-apple-darwin20.5.0
[fricas-1.3.7.p1] checking target system type... x86_64-apple-darwin20.5.0
[fricas-1.3.7.p1] checking for in-tree build on case insensitive file system... configure: error: in tree build on case insensitive file system is not supported. Use out-of-source build instead.
[fricas-1.3.7.p1] ********************************************************************************
[fricas-1.3.7.p1] Error configuring fricas-1.3.7.p1 See the file
```



---

Comment by dimpase created at 2021-07-08 12:53:58

Changing status from positive_review to needs_work.


---

Comment by mantepse created at 2021-07-08 13:22:51

I do not have access to macOS, can you do something about this?  Or do you know who could?


---

Comment by dimpase created at 2021-07-08 13:29:26

trying to fix it now. Probably it's a red herring (see https://github.com/fricas/fricas/issues/38), but it needs a patch. I've disabled the test in question and checking if it still works.


---

Comment by dimpase created at 2021-07-08 13:44:04

builds and tests fine with

```diff
--- /dev/null
+++ b/build/pkgs/fricas/patches/remove_case_insensitive_test.patch
@@ -0,0 +1,13 @@
+diff --git a/configure b/configure
+index a49f75a..960d412 100755
+--- a/configure
++++ b/configure
+@@ -2470,7 +2470,7 @@ fi
+ 
+ { $as_echo "$as_me:${as_lineno-$LINENO}: checking for in-tree build on case insensitive file system" >&5
+ $as_echo_n "checking for in-tree build on case insensitive file system... " >&6; }
+-if test "$fricas_top_srcdir" = "$fricas_pwd"; then
++if test "$fricas_top_srcdir" = xfoobla; then
+    rm -f ac_TEST_filenames_CASE_sensitive ac_test_filenames_case_sensitive
+    echo foo > ac_test_filenames_case_sensitive
+    if test -f ac_TEST_filenames_CASE_sensitive; then
```



---

Comment by dimpase created at 2021-07-08 14:33:18

OK, this will do.
----
New commits:


---

Comment by dimpase created at 2021-07-08 14:33:18

Changing status from needs_work to positive_review.


---

Comment by mantepse created at 2021-07-08 15:02:52

Thank you!


---

Comment by vbraun created at 2021-07-18 22:53:25

Resolution: fixed
