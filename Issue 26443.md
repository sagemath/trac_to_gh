# Issue 26443: clean generic_graph.py (part 14) - visualization

Issue created by migration from Trac.

Original creator: dcoudert

Original creation time: 2018-11-11 18:58:42

CC:  tscrim chapoton

Keywords: py3, graph

We clean (PEP8 and avoid `.vertices` / `.edges`) methods related to graph visualization: `_color_by_label`, `latex_options`, `set_latex_options`, `layout`, `layout_spring`, `layout_ranked`, `layout_extend_randomly`, `layout_circular`, `layout_tree`, `layout_graphviz`, `_layout_bounding_box`, `_circle_embedding`, `_line_embedding`, `graphplot`, `_rich_repr_`, `plot`, `show`, `plot3d`, `show3d`, `_keys_for_vertices`, `graphviz_string`, `graphviz_to_file_named`, and `tachyon_vertex_plot`.

Remaining calls to `.vertices`:
- `layout_circular` calls `_circle_embedding` with a list of vertices ordered by `.vertices`. Changing this will change the layout.

- `_keys_for_vertices` returns a mapping vertex to unique string identifier as required by `dot2tex`. It uses the order of `self.vertices()` to build the mapping. It is then used in `graphviz_string` and `layout_graphviz`. 

Any advice for these 2 cases is more than welcome ;)


---

Comment by dcoudert created at 2018-11-11 19:00:04

Changing status from new to needs_review.


---

Comment by dcoudert created at 2018-11-11 19:00:04

New commits:


---

Comment by chapoton created at 2018-12-03 07:13:32

one failing doctest, and one plugin warning (missing `r'''`)


---

Comment by git created at 2018-12-03 12:12:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2018-12-03 12:13:25

I fixed the plugin warning, but I don't find the failing doctest. Which one is it ?


---

Comment by chapoton created at 2018-12-03 12:26:16

in the patchbot:

```
sage -t --long --warn-long 55.5 src/sage/graphs/generic_graph.py
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 19671, in sage.graphs.generic_graph.GenericGraph.?
Failed example:
    P.plot3d(engine='tachyon', edge_colors=edge_colors).show() # long time
Exception raised:
    Traceback (most recent call last):
      File "/home/chapoton/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/chapoton/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1086, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.graphs.generic_graph.GenericGraph.?[20]>", line 1, in <module>
        P.plot3d(engine='tachyon', edge_colors=edge_colors).show() # long time
      File "/home/chapoton/sage/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 19788, in plot3d
        for u,v,l in edge_colors[color]:
    TypeError: 'int' object is not iterable
```



---

Comment by git created at 2018-12-03 12:45:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2018-12-03 12:46:55

ok, fixed.


---

Comment by chapoton created at 2018-12-03 16:31:59

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2018-12-03 16:31:59

ok, let it be. But.. 

* not a good idea (rather a very bad idea) to mix **many** trivial pep8 changes with non trivial code changes. A few pep8 changes are ok. I myself try hard to refrain to do that, as tempting as it would be. Let us hope that your graph tickets will be reviewed nevertheless.

* pep8 should not be enforced in the doctests, no way. It's only for the code.


---

Comment by dcoudert created at 2018-12-03 16:35:04

May be I should split the other tickets into easier to review tickets... Some of them are way too big.


---

Comment by vbraun created at 2018-12-07 12:10:36

Resolution: fixed
