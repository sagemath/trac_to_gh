# Issue 14716: Graph drawing in javascript using d3.js

archive/issues_014716.json:
```json
{
    "body": "CC:  bonfroy\n\nAs the title says.\n\nThis drawing method will be as good as the examples that are used to tune its parameters `:-)`\n\nNathann\n\nIssue created by migration from https://trac.sagemath.org/ticket/14953\n\n",
    "created_at": "2013-07-22T21:29:40Z",
    "labels": [
        "graph theory",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Graph drawing in javascript using d3.js",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14716",
    "user": "@nathanncohen"
}
```
CC:  bonfroy

As the title says.

This drawing method will be as good as the examples that are used to tune its parameters `:-)`

Nathann

Issue created by migration from https://trac.sagemath.org/ticket/14953





---

archive/issue_comments_187556.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-07-22T21:34:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187556",
    "user": "@nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_187557.json:
```json
{
    "body": "Attachment [trac_14953.patch](tarball://root/attachments/some-uuid/ticket14953/trac_14953.patch) by @nathanncohen created at 2013-08-13 16:53:40",
    "created_at": "2013-08-13T16:53:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187557",
    "user": "@nathanncohen"
}
```

Attachment [trac_14953.patch](tarball://root/attachments/some-uuid/ticket14953/trac_14953.patch) by @nathanncohen created at 2013-08-13 16:53:40



---

archive/issue_comments_187558.json:
```json
{
    "body": "Attachment [trac_14953_review1.patch](tarball://root/attachments/some-uuid/ticket14953/trac_14953_review1.patch) by @fchapoton created at 2013-08-29 12:52:43\n\nvery nice tool. Here is a purely cosmetic review patch\n\nI still have to finish the review, but later",
    "created_at": "2013-08-29T12:52:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187558",
    "user": "@fchapoton"
}
```

Attachment [trac_14953_review1.patch](tarball://root/attachments/some-uuid/ticket14953/trac_14953_review1.patch) by @fchapoton created at 2013-08-29 12:52:43

very nice tool. Here is a purely cosmetic review patch

I still have to finish the review, but later



---

archive/issue_comments_187559.json:
```json
{
    "body": "Well if you have some time to review that ?.... `:-P`",
    "created_at": "2013-10-30T13:08:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187559",
    "user": "@nathanncohen"
}
```

Well if you have some time to review that ?.... `:-P`



---

archive/issue_comments_187560.json:
```json
{
    "body": "Now a GIT patch.",
    "created_at": "2013-11-05T10:03:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187560",
    "user": "@nathanncohen"
}
```

Now a GIT patch.



---

archive/issue_comments_187561.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2013-11-05T10:04:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187561",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_187562.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-05-09T10:07:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187562",
    "user": "@rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_187563.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-12T09:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187563",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_187564.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-05-12T09:04:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187564",
    "user": "@nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_187565.json:
```json
{
    "body": "Fixed. If you feel like giving it a review ... It is 10 months old already `:-P`\n\nNathann",
    "created_at": "2014-05-12T09:04:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187565",
    "user": "@nathanncohen"
}
```

Fixed. If you feel like giving it a review ... It is 10 months old already `:-P`

Nathann



---

archive/issue_comments_187566.json:
```json
{
    "body": "One must be online to use this stuff, right?",
    "created_at": "2014-05-24T21:23:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187566",
    "user": "@dimpase"
}
```

One must be online to use this stuff, right?



---

archive/issue_comments_187567.json:
```json
{
    "body": "Right now yes, but there is no \"technical\" reason. Right now, it loads the javascript files d3.js from some URL, all this is not contained in the patch. We can later change that or write a spkg containing those files, and there will be no need of that anymore.\n\nNathann",
    "created_at": "2014-05-25T06:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187567",
    "user": "@nathanncohen"
}
```

Right now yes, but there is no "technical" reason. Right now, it loads the javascript files d3.js from some URL, all this is not contained in the patch. We can later change that or write a spkg containing those files, and there will be no need of that anymore.

Nathann



---

archive/issue_comments_187568.json:
```json
{
    "body": "looks good. I'll check that the docs build, and then it should be good to go.",
    "created_at": "2014-05-27T08:42:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187568",
    "user": "@dimpase"
}
```

looks good. I'll check that the docs build, and then it should be good to go.



---

archive/issue_comments_187569.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-05-27T23:23:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187569",
    "user": "@dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_187570.json:
```json
{
    "body": "Wow ! Thank you very much ! `:-)`\n\nIf you do not feel like sleeping there is a combinatorial_map war on Sage-devel. It got so rewarding I even closed #16403 just stop talking.\n\nNathann",
    "created_at": "2014-05-27T23:29:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187570",
    "user": "@nathanncohen"
}
```

Wow ! Thank you very much ! `:-)`

If you do not feel like sleeping there is a combinatorial_map war on Sage-devel. It got so rewarding I even closed #16403 just stop talking.

Nathann



---

archive/issue_comments_187571.json:
```json
{
    "body": "Pops up a browser window when running \"make ptestlong\"... please find a better way of automated testing ;-)",
    "created_at": "2014-05-29T15:27:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187571",
    "user": "@vbraun"
}
```

Pops up a browser window when running "make ptestlong"... please find a better way of automated testing ;-)



---

archive/issue_comments_187572.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-05-29T15:27:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187572",
    "user": "@vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_187573.json:
```json
{
    "body": "Also, anything that requires internet must be marked as `# optional - internet`.",
    "created_at": "2014-05-29T15:28:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187573",
    "user": "@vbraun"
}
```

Also, anything that requires internet must be marked as `# optional - internet`.



---

archive/issue_comments_187574.json:
```json
{
    "body": "Hmmmmm... Is there a way to test anything that this patch does ?... `:-/`\n\nNathann",
    "created_at": "2014-05-29T16:39:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187574",
    "user": "@nathanncohen"
}
```

Hmmmmm... Is there a way to test anything that this patch does ?... `:-/`

Nathann



---

archive/issue_comments_187575.json:
```json
{
    "body": "You can split the html generation from the show() function and doctest it as usual. Show can just check `DOCTEST_MODE` to avoid starting the browser.\n\nAlso, don't load the html template from `SAGE_SRC`. Thats the source code, if you need files at runtime then they must be installed under `SAGE_LOCAL`. You should probably put it somewhere under `src/ext` and then use `SAGE_EXTCODE` to refer to it.",
    "created_at": "2014-05-29T17:24:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187575",
    "user": "@vbraun"
}
```

You can split the html generation from the show() function and doctest it as usual. Show can just check `DOCTEST_MODE` to avoid starting the browser.

Also, don't load the html template from `SAGE_SRC`. Thats the source code, if you need files at runtime then they must be installed under `SAGE_LOCAL`. You should probably put it somewhere under `src/ext` and then use `SAGE_EXTCODE` to refer to it.



---

archive/issue_comments_187576.json:
```json
{
    "body": "Here is a commit to implement all that. The down side is that you have to run \"make\" for the .html file to be copied in SAGE_EXTCODE ..... That's what Volker wanted.\n\nNathann\n----\nNew commits:",
    "created_at": "2014-06-02T10:35:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187576",
    "user": "@nathanncohen"
}
```

Here is a commit to implement all that. The down side is that you have to run "make" for the .html file to be copied in SAGE_EXTCODE ..... That's what Volker wanted.

Nathann
----
New commits:



---

archive/issue_comments_187577.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-06-02T10:35:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187577",
    "user": "@nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_187578.json:
```json
{
    "body": "lgtm",
    "created_at": "2014-06-02T12:58:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187578",
    "user": "@vbraun"
}
```

lgtm



---

archive/issue_comments_187579.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-06-02T12:58:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187579",
    "user": "@vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_187580.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-06-02T15:56:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187580",
    "user": "@vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_187581.json:
```json
{
    "body": "Hi, i do not like the need to fetch a file from the internet to let this work. My question for a future ticket is the following: if i understand correctly, `src/ext` is a kind of place where we put external source code that is not big enough to deserve a package, am i right ? In this case, is this the right place to copy the file d3.v3.min.js for offline use ?",
    "created_at": "2014-06-03T16:01:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187581",
    "user": "tmonteil"
}
```

Hi, i do not like the need to fetch a file from the internet to let this work. My question for a future ticket is the following: if i understand correctly, `src/ext` is a kind of place where we put external source code that is not big enough to deserve a package, am i right ? In this case, is this the right place to copy the file d3.v3.min.js for offline use ?



---

archive/issue_comments_187582.json:
```json
{
    "body": "Yoooooooooooooo !\n\n> Hi, i do not like the need to fetch a file from the internet to let this work. My question for a future ticket is the following: if i understand correctly, `src/ext` is a kind of place where we put external source code that is not big enough to deserve a package, am i right ? In this case, is this the right place to copy the file d3.v3.min.js for offline use ?\n\nHMmmmmmm.... I am interested by Volker's answer, but I would say that stuff in src/ should be reviewed... Sooooooo no third-party code should be there. Besides, it is very easy to write spkg now with git. \n\nThis being said, I do not know which files we are allowed to read at runtime...\n\nNathann",
    "created_at": "2014-06-03T16:03:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187582",
    "user": "@nathanncohen"
}
```

Yoooooooooooooo !

> Hi, i do not like the need to fetch a file from the internet to let this work. My question for a future ticket is the following: if i understand correctly, `src/ext` is a kind of place where we put external source code that is not big enough to deserve a package, am i right ? In this case, is this the right place to copy the file d3.v3.min.js for offline use ?

HMmmmmmm.... I am interested by Volker's answer, but I would say that stuff in src/ should be reviewed... Sooooooo no third-party code should be there. Besides, it is very easy to write spkg now with git. 

This being said, I do not know which files we are allowed to read at runtime...

Nathann



---

archive/issue_comments_187583.json:
```json
{
    "body": "No, `SAGE_EXT` is where we install non-Python Sage source code. Its not a dump for third-party stuff that you don't want to package.",
    "created_at": "2014-06-03T16:04:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187583",
    "user": "@vbraun"
}
```

No, `SAGE_EXT` is where we install non-Python Sage source code. Its not a dump for third-party stuff that you don't want to package.



---

archive/issue_comments_187584.json:
```json
{
    "body": "Volker : if we package this code how can we access it at runtime ? What would the spkg-install do, and where would it copy the .js file ?\n\nNathann",
    "created_at": "2014-06-03T16:07:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187584",
    "user": "@nathanncohen"
}
```

Volker : if we package this code how can we access it at runtime ? What would the spkg-install do, and where would it copy the .js file ?

Nathann



---

archive/issue_comments_187585.json:
```json
{
    "body": "OK, so we have to make a spkg that just copy the `d3.v3.min.js` file into `./local/share/d3.js/` directory, then we can use `from sage.misc.misc import SAGE_SHARE` to get it. It that the correct procedure ? Or do we need to recompile the .js file from sources ?",
    "created_at": "2014-06-03T16:27:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187585",
    "user": "tmonteil"
}
```

OK, so we have to make a spkg that just copy the `d3.v3.min.js` file into `./local/share/d3.js/` directory, then we can use `from sage.misc.misc import SAGE_SHARE` to get it. It that the correct procedure ? Or do we need to recompile the .js file from sources ?



---

archive/issue_comments_187586.json:
```json
{
    "body": "there could be copyright issues that would preclude one from distributing it with Sage, so it will need to stay an optional Sage package, whether you like it or not. \n\nIANAL. Here is the licence:  https://github.com/mbostock/d3/blob/master/LICENSE",
    "created_at": "2014-06-03T16:42:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187586",
    "user": "@dimpase"
}
```

there could be copyright issues that would preclude one from distributing it with Sage, so it will need to stay an optional Sage package, whether you like it or not. 

IANAL. Here is the licence:  https://github.com/mbostock/d3/blob/master/LICENSE



---

archive/issue_comments_187587.json:
```json
{
    "body": "IANAL either, this is a [Modified BSD License](http://opensource.org/licenses/BSD-3-Clause), which is GPL-compatible according to the [FSF](https://www.gnu.org/licenses/license-list.html#ModifiedBSD) (see also [wikipedia](https://en.wikipedia.org/wiki/BSD_licenses#3-clause)). So it is OK to have it as a standard spkg, right ?",
    "created_at": "2014-06-03T18:59:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187587",
    "user": "tmonteil"
}
```

IANAL either, this is a [Modified BSD License](http://opensource.org/licenses/BSD-3-Clause), which is GPL-compatible according to the [FSF](https://www.gnu.org/licenses/license-list.html#ModifiedBSD) (see also [wikipedia](https://en.wikipedia.org/wiki/BSD_licenses#3-clause)). So it is OK to have it as a standard spkg, right ?



---

archive/issue_comments_187588.json:
```json
{
    "body": "This is now #16434 so that i will learn how to package.",
    "created_at": "2014-06-03T19:09:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187588",
    "user": "tmonteil"
}
```

This is now #16434 so that i will learn how to package.



---

archive/issue_comments_187589.json:
```json
{
    "body": "See also #16438 which links both features.",
    "created_at": "2014-06-04T15:36:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14716#issuecomment-187589",
    "user": "tmonteil"
}
```

See also #16438 which links both features.
