# Issue 14716: Graph drawing in javascript using d3.js

Issue created by migration from https://trac.sagemath.org/ticket/14953

Original creator: ncohen

Original creation time: 2013-07-22 21:29:40

CC:  bonfroy

As the title says.

This drawing method will be as good as the examples that are used to tune its parameters `:-)`

Nathann


---

Comment by ncohen created at 2013-07-22 21:34:00

Changing status from new to needs_review.


---

Attachment


---

Attachment

very nice tool. Here is a purely cosmetic review patch

I still have to finish the review, but later


---

Comment by ncohen created at 2013-10-30 13:08:37

Well if you have some time to review that ?.... `:-P`


---

Comment by ncohen created at 2013-11-05 10:03:50

Now a GIT patch.


---

Comment by git created at 2013-11-05 10:04:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2014-05-09 10:07:39

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-05-12 09:04:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2014-05-12 09:04:52

Changing status from needs_work to needs_review.


---

Comment by ncohen created at 2014-05-12 09:04:52

Fixed. If you feel like giving it a review ... It is 10 months old already `:-P`

Nathann


---

Comment by dimpase created at 2014-05-24 21:23:49

One must be online to use this stuff, right?


---

Comment by ncohen created at 2014-05-25 06:51:44

Right now yes, but there is no "technical" reason. Right now, it loads the javascript files d3.js from some URL, all this is not contained in the patch. We can later change that or write a spkg containing those files, and there will be no need of that anymore.

Nathann


---

Comment by dimpase created at 2014-05-27 08:42:34

looks good. I'll check that the docs build, and then it should be good to go.


---

Comment by dimpase created at 2014-05-27 23:23:28

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2014-05-27 23:29:34

Wow ! Thank you very much ! `:-)`

If you do not feel like sleeping there is a combinatorial_map war on Sage-devel. It got so rewarding I even closed #16403 just stop talking.

Nathann


---

Comment by vbraun created at 2014-05-29 15:27:45

Pops up a browser window when running "make ptestlong"... please find a better way of automated testing ;-)


---

Comment by vbraun created at 2014-05-29 15:27:45

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2014-05-29 15:28:50

Also, anything that requires internet must be marked as `# optional - internet`.


---

Comment by ncohen created at 2014-05-29 16:39:00

Hmmmmm... Is there a way to test anything that this patch does ?... `:-/`

Nathann


---

Comment by vbraun created at 2014-05-29 17:24:26

You can split the html generation from the show() function and doctest it as usual. Show can just check `DOCTEST_MODE` to avoid starting the browser.

Also, don't load the html template from `SAGE_SRC`. Thats the source code, if you need files at runtime then they must be installed under `SAGE_LOCAL`. You should probably put it somewhere under `src/ext` and then use `SAGE_EXTCODE` to refer to it.


---

Comment by ncohen created at 2014-06-02 10:35:31

Here is a commit to implement all that. The down side is that you have to run "make" for the .html file to be copied in SAGE_EXTCODE ..... That's what Volker wanted.

Nathann
----
New commits:


---

Comment by ncohen created at 2014-06-02 10:35:31

Changing status from needs_work to needs_review.


---

Comment by vbraun created at 2014-06-02 12:58:24

lgtm


---

Comment by vbraun created at 2014-06-02 12:58:24

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-06-02 15:56:22

Resolution: fixed


---

Comment by tmonteil created at 2014-06-03 16:01:16

Hi, i do not like the need to fetch a file from the internet to let this work. My question for a future ticket is the following: if i understand correctly, `src/ext` is a kind of place where we put external source code that is not big enough to deserve a package, am i right ? In this case, is this the right place to copy the file d3.v3.min.js for offline use ?


---

Comment by ncohen created at 2014-06-03 16:03:49

Yoooooooooooooo !

> Hi, i do not like the need to fetch a file from the internet to let this work. My question for a future ticket is the following: if i understand correctly, `src/ext` is a kind of place where we put external source code that is not big enough to deserve a package, am i right ? In this case, is this the right place to copy the file d3.v3.min.js for offline use ?

HMmmmmmm.... I am interested by Volker's answer, but I would say that stuff in src/ should be reviewed... Sooooooo no third-party code should be there. Besides, it is very easy to write spkg now with git. 

This being said, I do not know which files we are allowed to read at runtime...

Nathann


---

Comment by vbraun created at 2014-06-03 16:04:13

No, `SAGE_EXT` is where we install non-Python Sage source code. Its not a dump for third-party stuff that you don't want to package.


---

Comment by ncohen created at 2014-06-03 16:07:23

Volker : if we package this code how can we access it at runtime ? What would the spkg-install do, and where would it copy the .js file ?

Nathann


---

Comment by tmonteil created at 2014-06-03 16:27:02

OK, so we have to make a spkg that just copy the `d3.v3.min.js` file into `./local/share/d3.js/` directory, then we can use `from sage.misc.misc import SAGE_SHARE` to get it. It that the correct procedure ? Or do we need to recompile the .js file from sources ?


---

Comment by dimpase created at 2014-06-03 16:42:45

there could be copyright issues that would preclude one from distributing it with Sage, so it will need to stay an optional Sage package, whether you like it or not. 

IANAL. Here is the licence:  https://github.com/mbostock/d3/blob/master/LICENSE


---

Comment by tmonteil created at 2014-06-03 18:59:48

IANAL either, this is a [Modified BSD License](http://opensource.org/licenses/BSD-3-Clause), which is GPL-compatible according to the [FSF](https://www.gnu.org/licenses/license-list.html#ModifiedBSD) (see also [wikipedia](https://en.wikipedia.org/wiki/BSD_licenses#3-clause)). So it is OK to have it as a standard spkg, right ?


---

Comment by tmonteil created at 2014-06-03 19:09:35

This is now #16434 so that i will learn how to package.


---

Comment by tmonteil created at 2014-06-04 15:36:25

See also #16438 which links both features.
