# Issue 12036: LU decomposition gives wrong results on cyclotomic matrices

archive/issues_012036.json:
```json
{
    "body": "Assignee: jason, was\n\nCC:  @rbeezer @jasongrout\n\ncreate a cyclotomic matrix: (in this case it's even with all integer entries)\n\n```\nsage: tgg=SymmetricGroup(5).character_table()\nsage: type(tgg)\n<type 'sage.matrix.matrix_cyclo_dense.Matrix_cyclo_dense'>\nsage: tgg.rank()\n7\nsage: p,l,u=tgg.LU()\nsage: (l*u).rank()\n5\n```\n\nindeed, u is wrong:\n\n```\n\nsage: u\n[ 1 -1  1  1 -1 -1  1]\n[ 0 -2  0  1  1  0 -1]\n[ 0  0  1 -1 -1  1  0]\n[ 0  0  0  0  0  0  1]\n[ 0  0  0  0  1 -1  0]\n[ 0  0  0  0  0  0 -1]\n[ 0  0  0  0  0  0  1]\nsage: u.rank()\n5\n```\n\nConverting tgg into int() works for this particular case, but in general this will be not possible.\n\nIssue created by migration from https://trac.sagemath.org/ticket/12208\n\n",
    "created_at": "2011-12-21T03:55:15Z",
    "labels": [
        "component: linear algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.8",
    "title": "LU decomposition gives wrong results on cyclotomic matrices",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12036",
    "user": "https://github.com/dimpase"
}
```
Assignee: jason, was

CC:  @rbeezer @jasongrout

create a cyclotomic matrix: (in this case it's even with all integer entries)

```
sage: tgg=SymmetricGroup(5).character_table()
sage: type(tgg)
<type 'sage.matrix.matrix_cyclo_dense.Matrix_cyclo_dense'>
sage: tgg.rank()
7
sage: p,l,u=tgg.LU()
sage: (l*u).rank()
5
```

indeed, u is wrong:

```

sage: u
[ 1 -1  1  1 -1 -1  1]
[ 0 -2  0  1  1  0 -1]
[ 0  0  1 -1 -1  1  0]
[ 0  0  0  0  0  0  1]
[ 0  0  0  0  1 -1  0]
[ 0  0  0  0  0  0 -1]
[ 0  0  0  0  0  0  1]
sage: u.rank()
5
```

Converting tgg into int() works for this particular case, but in general this will be not possible.

Issue created by migration from https://trac.sagemath.org/ticket/12208





---

archive/issue_comments_138928.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2011-12-21T03:56:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138928",
    "user": "https://github.com/dimpase"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_138929.json:
```json
{
    "body": "Works for me.  Obviously, I get a very different `u` matrix.  Very curious.  Any ideas on what could be different?\n\nThis is on 64-bit Ubuntu 11.04, built from source.\n\n\n```\n----------------------------------------------------------------------\n----------------------------------------------------------------------\n**********************************************************************\n*                                                                    *\n* Warning: this is a prerelease version, and it may be unstable.     *\n*                                                                    *\n**********************************************************************\nsage: tgg=SymmetricGroup(5).character_table()\nsage: p,l,u = tgg.LU()\nsage: (p*l*u - tgg).norm()\n0.0\nsage: (l*u).rank()\n7\nsage: u\n[   6    0   -2    0    0    0    1]\n[   0   -2  4/3    1    1    0 -5/3]\n[   0    0 10/3 -1/2  3/2   -1 -5/3]\n[   0    0    0 12/5 -6/5  4/5   -2]\n[   0    0    0    0   -3    2    0]\n[   0    0    0    0    0   -2  5/2]\n[   0    0    0    0    0    0    5]\n```\n",
    "created_at": "2011-12-21T05:15:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138929",
    "user": "https://github.com/rbeezer"
}
```

Works for me.  Obviously, I get a very different `u` matrix.  Very curious.  Any ideas on what could be different?

This is on 64-bit Ubuntu 11.04, built from source.


```
----------------------------------------------------------------------
----------------------------------------------------------------------
**********************************************************************
*                                                                    *
* Warning: this is a prerelease version, and it may be unstable.     *
*                                                                    *
**********************************************************************
sage: tgg=SymmetricGroup(5).character_table()
sage: p,l,u = tgg.LU()
sage: (p*l*u - tgg).norm()
0.0
sage: (l*u).rank()
7
sage: u
[   6    0   -2    0    0    0    1]
[   0   -2  4/3    1    1    0 -5/3]
[   0    0 10/3 -1/2  3/2   -1 -5/3]
[   0    0    0 12/5 -6/5  4/5   -2]
[   0    0    0    0   -3    2    0]
[   0    0    0    0    0   -2  5/2]
[   0    0    0    0    0    0    5]
```




---

archive/issue_comments_138930.json:
```json
{
    "body": "Dear Dima,\n\nThe code for this does not use any libraries, nor anything too advanced.  For the most part it is just field operations.\n\nJust as an experiment, you could try the `pivot` options with your example.  `pivot='partial'` would basically bypass a call to `abs()`.  Results are cached, so be aware of that when testing.\n\nRob",
    "created_at": "2011-12-21T06:54:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138930",
    "user": "https://github.com/rbeezer"
}
```

Dear Dima,

The code for this does not use any libraries, nor anything too advanced.  For the most part it is just field operations.

Just as an experiment, you could try the `pivot` options with your example.  `pivot='partial'` would basically bypass a call to `abs()`.  Results are cached, so be aware of that when testing.

Rob



---

archive/issue_comments_138931.json:
```json
{
    "body": "Replying to [comment:4 rbeezer]:\n> Dear Dima,\n> \n> The code for this does not use any libraries, nor anything too advanced.  For the most part it is just field operations.\n> \n> Just as an experiment, you could try the `pivot` options with your example.  `pivot='partial'` would basically bypass a call to `abs()`.  Results are cached, so be aware of that when testing.\n> \n\nHi Rob,\n\n`pivot='partial'` gives the wrong result, while `pivot='nonzero'` computes the things correctly.\n\nDima\n\n\n> Rob",
    "created_at": "2011-12-21T15:05:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138931",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:4 rbeezer]:
> Dear Dima,
> 
> The code for this does not use any libraries, nor anything too advanced.  For the most part it is just field operations.
> 
> Just as an experiment, you could try the `pivot` options with your example.  `pivot='partial'` would basically bypass a call to `abs()`.  Results are cached, so be aware of that when testing.
> 

Hi Rob,

`pivot='partial'` gives the wrong result, while `pivot='nonzero'` computes the things correctly.

Dima


> Rob



---

archive/issue_comments_138932.json:
```json
{
    "body": "Replying to [comment:5 dimpase]:\n> Replying to [comment:4 rbeezer]:\n> >  `pivot='partial'` would basically bypass a call to `abs()`\n> `pivot='partial'` gives the wrong result, while `pivot='nonzero'` computes the things correctly.\n\nOK, I had it backwards (it was late!) and your results I think might point out the root cause.\n\nIt looks to me like the `abs()` of a number field elements are MPFR real numbers.  So while searching for a \"largest\" element in a column, there may be some zero/nonzero confusion?\n\nPerhaps we should check that the return value of the absolute value function lives in the fraction field of the base ring before allowing partial pivoting?  In other words, we need an exact result to proceed.  The implementation is really only designed for this case.  Does that sound like a reasonable solution to you?\n\nOr maybe there is a better function to be using for the \"magnitude\" of an element of an arbitrary ring/field?  Maybe a question for sage-devel - I can't think of the answer.\n\nRob",
    "created_at": "2011-12-21T18:01:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138932",
    "user": "https://github.com/rbeezer"
}
```

Replying to [comment:5 dimpase]:
> Replying to [comment:4 rbeezer]:
> >  `pivot='partial'` would basically bypass a call to `abs()`
> `pivot='partial'` gives the wrong result, while `pivot='nonzero'` computes the things correctly.

OK, I had it backwards (it was late!) and your results I think might point out the root cause.

It looks to me like the `abs()` of a number field elements are MPFR real numbers.  So while searching for a "largest" element in a column, there may be some zero/nonzero confusion?

Perhaps we should check that the return value of the absolute value function lives in the fraction field of the base ring before allowing partial pivoting?  In other words, we need an exact result to proceed.  The implementation is really only designed for this case.  Does that sound like a reasonable solution to you?

Or maybe there is a better function to be using for the "magnitude" of an element of an arbitrary ring/field?  Maybe a question for sage-devel - I can't think of the answer.

Rob



---

archive/issue_comments_138933.json:
```json
{
    "body": "For information purposes only, not intended as real fix",
    "created_at": "2011-12-21T18:26:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138933",
    "user": "https://github.com/rbeezer"
}
```

For information purposes only, not intended as real fix



---

archive/issue_comments_138934.json:
```json
{
    "body": "Attachment [trac_12208_LU_quick.patch](tarball://root/attachments/some-uuid/ticket12208/trac_12208_LU_quick.patch) by @rbeezer created at 2011-12-21 18:30:57\n\nReplying to [comment:6 rbeezer]:\n> Or maybe there is a better function to be using for the \"magnitude\" of an element of an arbitrary ring/field?  Maybe a question for sage-devel - I can't think of the answer.\n\nAnswering my own question.  Maybe the `norm()` function (or method) is a better choice.  For a negative rational, it returns the negative value, which I find odd (but maybe appropriate?).\n\nWith test patch, I only get one doctest failure (a permutation matrix changes) and the original example still gives the same `U` matrix.\n\nDima - would you like to try out the test patch (built on 4.8.alpha3)?  I'm not sure yet it is the best solution, but it could be.\n\nRob",
    "created_at": "2011-12-21T18:30:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138934",
    "user": "https://github.com/rbeezer"
}
```

Attachment [trac_12208_LU_quick.patch](tarball://root/attachments/some-uuid/ticket12208/trac_12208_LU_quick.patch) by @rbeezer created at 2011-12-21 18:30:57

Replying to [comment:6 rbeezer]:
> Or maybe there is a better function to be using for the "magnitude" of an element of an arbitrary ring/field?  Maybe a question for sage-devel - I can't think of the answer.

Answering my own question.  Maybe the `norm()` function (or method) is a better choice.  For a negative rational, it returns the negative value, which I find odd (but maybe appropriate?).

With test patch, I only get one doctest failure (a permutation matrix changes) and the original example still gives the same `U` matrix.

Dima - would you like to try out the test patch (built on 4.8.alpha3)?  I'm not sure yet it is the best solution, but it could be.

Rob



---

archive/issue_comments_138935.json:
```json
{
    "body": "Replying to [comment:7 rbeezer]:\n> Replying to [comment:6 rbeezer]:\n> > Or maybe there is a better function to be using for the \"magnitude\" of an element of an arbitrary ring/field?  Maybe a question for sage-devel - I can't think of the answer.\n> \n> Answering my own question.  Maybe the `norm()` function (or method) is a better choice.  For a negative rational, it returns the negative value, which I find odd (but maybe appropriate?).\n> \n> With test patch, I only get one doctest failure (a permutation matrix changes) and the original example still gives the same `U` matrix.\n> \n> Dima - would you like to try out the test patch (built on 4.8.alpha3)?  I'm not sure yet it is the best solution, but it could be.\n\nyes, this fixes the problem.\n\nDima\n\n> \n> Rob",
    "created_at": "2011-12-26T17:38:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138935",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:7 rbeezer]:
> Replying to [comment:6 rbeezer]:
> > Or maybe there is a better function to be using for the "magnitude" of an element of an arbitrary ring/field?  Maybe a question for sage-devel - I can't think of the answer.
> 
> Answering my own question.  Maybe the `norm()` function (or method) is a better choice.  For a negative rational, it returns the negative value, which I find odd (but maybe appropriate?).
> 
> With test patch, I only get one doctest failure (a permutation matrix changes) and the original example still gives the same `U` matrix.
> 
> Dima - would you like to try out the test patch (built on 4.8.alpha3)?  I'm not sure yet it is the best solution, but it could be.

yes, this fixes the problem.

Dima

> 
> Rob



---

archive/issue_comments_138936.json:
```json
{
    "body": "Replying to [comment:8 dimpase]:\n> Replying to [comment:7 rbeezer]:\n> > Replying to [comment:6 rbeezer]:\n> > > Or maybe there is a better function to be using for the \"magnitude\" of an element of an arbitrary ring/field?  Maybe a question for sage-devel - I can't think of the answer.\n> > \n> > Answering my own question.  Maybe the `norm()` function (or method) is a better choice.  For a negative rational, it returns the negative value, which I find odd (but maybe appropriate?).\n> > \n> > With test patch, I only get one doctest failure (a permutation matrix changes) and the original example still gives the same `U` matrix.\n> > \n> > Dima - would you like to try out the test patch (built on 4.8.alpha3)?  I'm not sure yet it is the best solution, but it could be.\n> \n> yes, this fixes the problem.\n\nI tried digging deeper into the problem, and I found that the original (unpatched) code does not work on MacOSX, because the condition in `if entry > max_entry:` on the line 9338 of matrix2.pyx is never True. This means that the comparison between \n`entry` of  type `sage.rings.real_mpfr.RealNumber`  and `max_entry` of   type `sage.rings.number_field.number_field_element.NumberFieldElement_absolute` (the latter is initially set to `F(0)`) is broken. \n\nIndeed, on MacOSX\n\n```\nsage: F = RealField()\nsage: k.<i> = NumberField(x^3 +x + 1)\nsage: F(1).abs() > 0*i\n```\n\nprints False, and on Linux it prints True!\n\n\nBy the way, if I replace `max_entry = zero` on line 9334 with `max_entry = zero.abs()` then the code works, as this does the right type of coersion. \n\nOverall, this looks like a  bug in number fields part of Sage one has to dig up.\n\nDima",
    "created_at": "2011-12-30T06:11:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138936",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:8 dimpase]:
> Replying to [comment:7 rbeezer]:
> > Replying to [comment:6 rbeezer]:
> > > Or maybe there is a better function to be using for the "magnitude" of an element of an arbitrary ring/field?  Maybe a question for sage-devel - I can't think of the answer.
> > 
> > Answering my own question.  Maybe the `norm()` function (or method) is a better choice.  For a negative rational, it returns the negative value, which I find odd (but maybe appropriate?).
> > 
> > With test patch, I only get one doctest failure (a permutation matrix changes) and the original example still gives the same `U` matrix.
> > 
> > Dima - would you like to try out the test patch (built on 4.8.alpha3)?  I'm not sure yet it is the best solution, but it could be.
> 
> yes, this fixes the problem.

I tried digging deeper into the problem, and I found that the original (unpatched) code does not work on MacOSX, because the condition in `if entry > max_entry:` on the line 9338 of matrix2.pyx is never True. This means that the comparison between 
`entry` of  type `sage.rings.real_mpfr.RealNumber`  and `max_entry` of   type `sage.rings.number_field.number_field_element.NumberFieldElement_absolute` (the latter is initially set to `F(0)`) is broken. 

Indeed, on MacOSX

```
sage: F = RealField()
sage: k.<i> = NumberField(x^3 +x + 1)
sage: F(1).abs() > 0*i
```

prints False, and on Linux it prints True!


By the way, if I replace `max_entry = zero` on line 9334 with `max_entry = zero.abs()` then the code works, as this does the right type of coersion. 

Overall, this looks like a  bug in number fields part of Sage one has to dig up.

Dima



---

archive/issue_comments_138937.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2011-12-30T06:11:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138937",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_138938.json:
```json
{
    "body": "Replying to [comment:9 dimpase]:\n\nDima - excellent detective work.  And excellent timing, I was just sitting down to look at this again.\n\n> By the way, if I replace `max_entry = zero` on line 9334 with `max_entry = zero.abs()` then the code works, as this does the right type of coersion. \n> \n> Overall, this looks like a  bug in number fields part of Sage one has to dig up.\n\nI like the idea of applying `abs()` to the zero element to get the types to line up.  I will watch the sage-devel thread to see what transpires, and then write a short patch, likely with your example from above as a test.\n\nThanks,\nRob",
    "created_at": "2011-12-30T06:52:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138938",
    "user": "https://github.com/rbeezer"
}
```

Replying to [comment:9 dimpase]:

Dima - excellent detective work.  And excellent timing, I was just sitting down to look at this again.

> By the way, if I replace `max_entry = zero` on line 9334 with `max_entry = zero.abs()` then the code works, as this does the right type of coersion. 
> 
> Overall, this looks like a  bug in number fields part of Sage one has to dig up.

I like the idea of applying `abs()` to the zero element to get the types to line up.  I will watch the sage-devel thread to see what transpires, and then write a short patch, likely with your example from above as a test.

Thanks,
Rob



---

archive/issue_comments_138939.json:
```json
{
    "body": "Replying to [comment:10 rbeezer]:\n> Replying to [comment:9 dimpase]:\n> \n> Dima - excellent detective work.  And excellent timing, I was just sitting down to look at this again.\n> \n> > By the way, if I replace `max_entry = zero` on line 9334 with `max_entry = zero.abs()` then the code works, as this does the right type of coersion. \n> > \n> > Overall, this looks like a  bug in number fields part of Sage one has to dig up.\n> \n> I like the idea of applying `abs()` to the zero element to get the types to line up.  I will watch the sage-devel thread to see what transpires, and then write a short patch, likely with your example from above as a test.\n> \n \nHi Rob, \n\nif abs() is only used to select pivots, it should be perfectly all right to do so.\nThis would be a 1-line patch then.\n\nDima",
    "created_at": "2011-12-30T08:54:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138939",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:10 rbeezer]:
> Replying to [comment:9 dimpase]:
> 
> Dima - excellent detective work.  And excellent timing, I was just sitting down to look at this again.
> 
> > By the way, if I replace `max_entry = zero` on line 9334 with `max_entry = zero.abs()` then the code works, as this does the right type of coersion. 
> > 
> > Overall, this looks like a  bug in number fields part of Sage one has to dig up.
> 
> I like the idea of applying `abs()` to the zero element to get the types to line up.  I will watch the sage-devel thread to see what transpires, and then write a short patch, likely with your example from above as a test.
> 
 
Hi Rob, 

if abs() is only used to select pivots, it should be perfectly all right to do so.
This would be a 1-line patch then.

Dima



---

archive/issue_comments_138940.json:
```json
{
    "body": "Attachment [trac_12208-LU-pivot-fix.patch](tarball://root/attachments/some-uuid/ticket12208/trac_12208-LU-pivot-fix.patch) by @rbeezer created at 2011-12-30 13:23:30",
    "created_at": "2011-12-30T13:23:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138940",
    "user": "https://github.com/rbeezer"
}
```

Attachment [trac_12208-LU-pivot-fix.patch](tarball://root/attachments/some-uuid/ticket12208/trac_12208-LU-pivot-fix.patch) by @rbeezer created at 2011-12-30 13:23:30



---

archive/issue_comments_138941.json:
```json
{
    "body": "Patch takes absolute value of initial maximum column value before searching for a bigger entry, thus creating objects of the same type for subsequent comparisons.\n\n(a) Used the `abs()` function, since that was used in the prior test for its use being possible.\n\n(b) Added Dima's character table example as a test in the docstring.\n\nPasses tests in sage/matrix on 4.8.alpha3 on Linux.",
    "created_at": "2011-12-30T13:28:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138941",
    "user": "https://github.com/rbeezer"
}
```

Patch takes absolute value of initial maximum column value before searching for a bigger entry, thus creating objects of the same type for subsequent comparisons.

(a) Used the `abs()` function, since that was used in the prior test for its use being possible.

(b) Added Dima's character table example as a test in the docstring.

Passes tests in sage/matrix on 4.8.alpha3 on Linux.



---

archive/issue_comments_138942.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2011-12-30T13:28:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138942",
    "user": "https://github.com/rbeezer"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_138943.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-12-30T18:19:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138943",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_138944.json:
```json
{
    "body": "Replying to [comment:12 rbeezer]:\n> Patch takes absolute value of initial maximum column value before searching for a bigger entry, thus creating objects of the same type for subsequent comparisons.\n> \n> (a) Used the `abs()` function, since that was used in the prior test for its use being possible.\n> \n> (b) Added Dima's character table example as a test in the docstring.\n> \n> Passes tests in sage/matrix on 4.8.alpha3 on Linux.\n\nOK, works on MacOSX too. Good.",
    "created_at": "2011-12-30T18:19:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138944",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:12 rbeezer]:
> Patch takes absolute value of initial maximum column value before searching for a bigger entry, thus creating objects of the same type for subsequent comparisons.
> 
> (a) Used the `abs()` function, since that was used in the prior test for its use being possible.
> 
> (b) Added Dima's character table example as a test in the docstring.
> 
> Passes tests in sage/matrix on 4.8.alpha3 on Linux.

OK, works on MacOSX too. Good.



---

archive/issue_comments_138945.json:
```json
{
    "body": "Replying to [comment:13 dimpase]:\n> OK, works on MacOSX too. Good.\n\nGreat!  Glad to hear it solves the OSX problem, and overall it should have been this way from the start.  Thanks for sticking with this one.\n\nRob",
    "created_at": "2011-12-30T18:50:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138945",
    "user": "https://github.com/rbeezer"
}
```

Replying to [comment:13 dimpase]:
> OK, works on MacOSX too. Good.

Great!  Glad to hear it solves the OSX problem, and overall it should have been this way from the start.  Thanks for sticking with this one.

Rob



---

archive/issue_comments_138946.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-12-31T10:35:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12036#issuecomment-138946",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
