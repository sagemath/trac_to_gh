# Issue 28827: is_galois() / automorphisms() can be made faster

archive/issues_028827.json:
```json
{
    "body": "Keywords: is_galois,automorphisms\n\nLet `K.<a> = NumberField(f)`. The method `K.is_galois()` does the following:\n\n\n```\nif self.degree() < 12:\n    return self.galois_group(type='pari').order() == self.degree()\nelse:\n    return len(self.automorphisms()) == self.degree()\n```\n\n\nThe method `K.automorphisms()` [defined here](https://github.com/sagemath/sage/blob/31cb54b77951c888af513734ca36ac045fa9ca86/src/sage/rings/number_field/number_field.py#L8329) runs essentially the PARI code\n\n\n```\nnfgaloisconj(nfinit(f))\n```\n\n\nto compute the automorphisms, followed by some conversions.\nAs [just discussed on pari-users](https://pari.math.u-bordeaux.fr/archives/pari-users-2001/msg00002.html), it is faster to run instead\n\n\n```\nnfgaloisconj(f)\n```\n\n\nbecause `nfinit` computes the full factorization of the discriminant of the polynomial, which is not (always) needed.\n\nThe question is whether the `nfinit(f)` data is really needed for the conversions in `K.automorphisms()`. If it is not needed, then the optimization (that is, calling `nfgaloisconj(f)` instead) can be implemented there. If it is needed, then the optimization can be implemented in `is_galois()`.\n\nEither way, this would make `is_galois()` work faster for extensions of high degree.\n\nThe fact that it is currently slow was [reported on Ask SageMath](https://ask.sagemath.org/question/49620/is_galois-computation/), which led me to investigate.\n\nIssue created by migration from https://trac.sagemath.org/ticket/29064\n\n",
    "created_at": "2020-01-21T23:36:23Z",
    "labels": [
        "component: number fields"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "is_galois() / automorphisms() can be made faster",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28827",
    "user": "https://github.com/rburing"
}
```
Keywords: is_galois,automorphisms

Let `K.<a> = NumberField(f)`. The method `K.is_galois()` does the following:


```
if self.degree() < 12:
    return self.galois_group(type='pari').order() == self.degree()
else:
    return len(self.automorphisms()) == self.degree()
```


The method `K.automorphisms()` [defined here](https://github.com/sagemath/sage/blob/31cb54b77951c888af513734ca36ac045fa9ca86/src/sage/rings/number_field/number_field.py#L8329) runs essentially the PARI code


```
nfgaloisconj(nfinit(f))
```


to compute the automorphisms, followed by some conversions.
As [just discussed on pari-users](https://pari.math.u-bordeaux.fr/archives/pari-users-2001/msg00002.html), it is faster to run instead


```
nfgaloisconj(f)
```


because `nfinit` computes the full factorization of the discriminant of the polynomial, which is not (always) needed.

The question is whether the `nfinit(f)` data is really needed for the conversions in `K.automorphisms()`. If it is not needed, then the optimization (that is, calling `nfgaloisconj(f)` instead) can be implemented there. If it is needed, then the optimization can be implemented in `is_galois()`.

Either way, this would make `is_galois()` work faster for extensions of high degree.

The fact that it is currently slow was [reported on Ask SageMath](https://ask.sagemath.org/question/49620/is_galois-computation/), which led me to investigate.

Issue created by migration from https://trac.sagemath.org/ticket/29064





---

archive/issue_comments_407145.json:
```json
{
    "body": "Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.",
    "created_at": "2020-04-14T19:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28827#issuecomment-407145",
    "user": "https://github.com/mkoeppe"
}
```

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.



---

archive/issue_comments_407146.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28827",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28827#issuecomment-407146",
    "user": "https://github.com/mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.
