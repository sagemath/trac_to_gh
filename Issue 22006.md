# Issue 22006: Upgrade to boost 1.62

archive/issues_022006.json:
```json
{
    "body": "CC:  @kiwifb\n\nI am creating this ticket to mention a patch that fixes some doctests when using boost 1.62 or higher.\n\nThe hash function for boost::hash_combine() which is called in \nlibbrial/include/polybori/routines/pbori_routines_hash.h was changed for\nboost 1.62 in the commit\nhttps://github.com/boostorg/functional/commit/45eeb170f2b1372b4b5e52744d3c51eddb285b42\n\nTherefore some brial hashes that are tested in doctests changed.\n\nHere is the patch:\nhttps://anonscm.debian.org/cgit/debian-science/packages/sagemath.git/tree/debian/patches/u1-version-pbori-boost1.62-hashes.patch?h=experimental\n\nIssue created by migration from https://trac.sagemath.org/ticket/22243\n\n",
    "created_at": "2017-01-24T11:45:15Z",
    "labels": [
        "component: misc",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "Upgrade to boost 1.62",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22006",
    "user": "https://github.com/tobihan"
}
```
CC:  @kiwifb

I am creating this ticket to mention a patch that fixes some doctests when using boost 1.62 or higher.

The hash function for boost::hash_combine() which is called in 
libbrial/include/polybori/routines/pbori_routines_hash.h was changed for
boost 1.62 in the commit
https://github.com/boostorg/functional/commit/45eeb170f2b1372b4b5e52744d3c51eddb285b42

Therefore some brial hashes that are tested in doctests changed.

Here is the patch:
https://anonscm.debian.org/cgit/debian-science/packages/sagemath.git/tree/debian/patches/u1-version-pbori-boost1.62-hashes.patch?h=experimental

Issue created by migration from https://trac.sagemath.org/ticket/22243





---

archive/issue_comments_305445.json:
```json
{
    "body": "For some strange reason I think going to a new boost on OS X won't change the hash which seems bizarre has it means it is much less portable.\n\nI haven't built a sage on OS X with boost-1.62.0+ but I have run brial's testsuite and it looks like the tests about hashes do not change between 1.58.0 and 1.65.1 so I expect the same thing to happen in sage. It seems to be an apple specific thing, I tried clang on linux and I just get the same results as with gcc.",
    "created_at": "2018-03-08T01:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22006#issuecomment-305445",
    "user": "https://github.com/kiwifb"
}
```

For some strange reason I think going to a new boost on OS X won't change the hash which seems bizarre has it means it is much less portable.

I haven't built a sage on OS X with boost-1.62.0+ but I have run brial's testsuite and it looks like the tests about hashes do not change between 1.58.0 and 1.65.1 so I expect the same thing to happen in sage. It seems to be an apple specific thing, I tried clang on linux and I just get the same results as with gcc.



---

archive/issue_comments_305446.json:
```json
{
    "body": "I don't think we should check for the actual (meaningless) hash values but should just check that the hashes are sane. (A pattern which we use in many other places already.)\n----\nNew commits:",
    "created_at": "2018-04-01T20:18:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22006#issuecomment-305446",
    "user": "https://github.com/saraedum"
}
```

I don't think we should check for the actual (meaningless) hash values but should just check that the hashes are sane. (A pattern which we use in many other places already.)
----
New commits:



---

archive/issue_comments_305447.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-04-01T20:18:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22006#issuecomment-305447",
    "user": "https://github.com/saraedum"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_305448.json:
```json
{
    "body": "Changing keywords from \"\" to \"debian, BRiAl, boost\".",
    "created_at": "2018-04-01T20:19:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22006#issuecomment-305448",
    "user": "https://github.com/saraedum"
}
```

Changing keywords from "" to "debian, BRiAl, boost".



---

archive/issue_comments_305449.json:
```json
{
    "body": "I'd be ok with that. We should update boost and boost_cropped in sync. This is not the case now but that would be more sane and avoid any issue because of different version of boost used.",
    "created_at": "2018-04-01T20:21:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22006#issuecomment-305449",
    "user": "https://github.com/kiwifb"
}
```

I'd be ok with that. We should update boost and boost_cropped in sync. This is not the case now but that would be more sane and avoid any issue because of different version of boost used.



---

archive/issue_comments_305450.json:
```json
{
    "body": "fbissey, I am not sure I understand what you propose. Are you saying that we should also update boost as part of this ticket?",
    "created_at": "2018-04-05T14:18:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22006#issuecomment-305450",
    "user": "https://github.com/saraedum"
}
```

fbissey, I am not sure I understand what you propose. Are you saying that we should also update boost as part of this ticket?



---

archive/issue_comments_305451.json:
```json
{
    "body": "fbissey, would you mind reviewing this?",
    "created_at": "2018-04-21T19:15:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22006#issuecomment-305451",
    "user": "https://github.com/saraedum"
}
```

fbissey, would you mind reviewing this?



---

archive/issue_comments_305452.json:
```json
{
    "body": "Must have missed your earlier comment. There was that ticket about upgrading boost and I must have mixed the tickets up. But this looks good to me and reduce the complexity of my ebuild and my patches.",
    "created_at": "2018-04-21T20:41:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22006#issuecomment-305452",
    "user": "https://github.com/kiwifb"
}
```

Must have missed your earlier comment. There was that ticket about upgrading boost and I must have mixed the tickets up. But this looks good to me and reduce the complexity of my ebuild and my patches.



---

archive/issue_comments_305453.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-04-21T20:41:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22006#issuecomment-305453",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_305454.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-08T17:27:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22006#issuecomment-305454",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
