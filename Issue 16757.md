# Issue 16757: Simplicial Complex from boolean function

archive/issues_016757.json:
```json
{
    "body": "CC:  vinceknight kcrisman dimpase jdemeyer nthiery vdelecroix jhpalmieri\n\nAs discussed in https://groups.google.com/d/topic/sage-devel/os1LzBjsYnQ/discussion, here is a ticket to implement a function that returns, given a boolean monotone function `f` on the subsets of a set `X`, all subsets `S` of `X` such that `f(S)` is True.\n\nThe implementation assumes that `f` is very costly to evaluate, and so caches as much as possible. It can also compute in parallel.\n\nNathann\n\nIssue created by migration from https://trac.sagemath.org/ticket/16994\n\n",
    "created_at": "2014-09-16T15:26:16Z",
    "labels": [
        "combinatorics",
        "major",
        "enhancement"
    ],
    "title": "Simplicial Complex from boolean function",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16757",
    "user": "ncohen"
}
```
CC:  vinceknight kcrisman dimpase jdemeyer nthiery vdelecroix jhpalmieri

As discussed in https://groups.google.com/d/topic/sage-devel/os1LzBjsYnQ/discussion, here is a ticket to implement a function that returns, given a boolean monotone function `f` on the subsets of a set `X`, all subsets `S` of `X` such that `f(S)` is True.

The implementation assumes that `f` is very costly to evaluate, and so caches as much as possible. It can also compute in parallel.

Nathann

Issue created by migration from https://trac.sagemath.org/ticket/16994





---

archive/issue_comments_221490.json:
```json
{
    "body": "Here it is, at long last. I also removed the `**kwds` from `SimplicialComplex`, because I hate to see things like that work:\n\n\n```\nsage: SimplicialComplex(aergahgae=\"erharh\")\nSimplicial complex with vertex set () and facets {()}\n```\n\n\nIt is the kind of things that makes you waste 30minutes over a typo in the function's input.\n\nNathann",
    "created_at": "2014-09-16T16:23:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221490",
    "user": "ncohen"
}
```

Here it is, at long last. I also removed the `**kwds` from `SimplicialComplex`, because I hate to see things like that work:


```
sage: SimplicialComplex(aergahgae="erharh")
Simplicial complex with vertex set () and facets {()}
```


It is the kind of things that makes you waste 30minutes over a typo in the function's input.

Nathann



---

archive/issue_comments_221491.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-09-16T16:23:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221491",
    "user": "ncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_221492.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-16T16:24:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221492",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_221493.json:
```json
{
    "body": "Anybody ?...",
    "created_at": "2014-09-23T11:39:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221493",
    "user": "ncohen"
}
```

Anybody ?...



---

archive/issue_comments_221494.json:
```json
{
    "body": "I'm having a look now.",
    "created_at": "2014-09-23T12:40:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221494",
    "user": "dimpase"
}
```

I'm having a look now.



---

archive/issue_comments_221495.json:
```json
{
    "body": "there is `is_mutable` and `is_immutable`... shouldn't one of these go?",
    "created_at": "2014-09-23T12:44:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221495",
    "user": "dimpase"
}
```

there is `is_mutable` and `is_immutable`... shouldn't one of these go?



---

archive/issue_comments_221496.json:
```json
{
    "body": "> there is `is_mutable` and `is_immutable`... shouldn't one of these go?\n\nThese days I try to keep the amount of wars I start to a minimum.\n\nI also want to stop fighting other people on their own grounds. I noticed that it decreased my chances of actually achieving anything, even when I am right.\n\nNathann",
    "created_at": "2014-09-23T12:50:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221496",
    "user": "ncohen"
}
```

> there is `is_mutable` and `is_immutable`... shouldn't one of these go?

These days I try to keep the amount of wars I start to a minimum.

I also want to stop fighting other people on their own grounds. I noticed that it decreased my chances of actually achieving anything, even when I am right.

Nathann



---

archive/issue_comments_221497.json:
```json
{
    "body": "No vertices?!\n\n\n```\nsage: SimplicialComplex(from_characteristic_function=(lambda x:sum(x)<=4,range(5)))\n      Simplicial complex with vertex set () and facets {(0, 4), (0, 1, 2), (0, 1, 3)}\n```\n\n\ncf\n\n```\nsage: SimplicialComplex([(0, 4), (0, 1, 2), (0, 1, 3)])\nSimplicial complex with vertex set (0, 1, 2, 3, 4) and facets {(0, 4), (0, 1, 2), (0, 1, 3)}\n```\n\n\nadd vertices please... (e.g. take the union of facets)",
    "created_at": "2014-09-23T13:05:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221497",
    "user": "dimpase"
}
```

No vertices?!


```
sage: SimplicialComplex(from_characteristic_function=(lambda x:sum(x)<=4,range(5)))
      Simplicial complex with vertex set () and facets {(0, 4), (0, 1, 2), (0, 1, 3)}
```


cf

```
sage: SimplicialComplex([(0, 4), (0, 1, 2), (0, 1, 3)])
Simplicial complex with vertex set (0, 1, 2, 3, 4) and facets {(0, 4), (0, 1, 2), (0, 1, 3)}
```


add vertices please... (e.g. take the union of facets)



---

archive/issue_comments_221498.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-09-23T13:09:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221498",
    "user": "dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_221499.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-09-23T13:19:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221499",
    "user": "ncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_221500.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-23T13:19:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221500",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_221501.json:
```json
{
    "body": "How about adding some real example? E.g. I tested that the output (the famous 168 hyperovals in PG(2,4)) is correct on the following:\n\n```\nsage: l=map(Set,ProjectiveGeometryDesign(2,1,GF(4,name='a')).blocks())\nsage: SimplicialComplex(from_characteristic_function=(lambda S: not exists(l, lambda x: Set(S).intersection(x).cardinality()>2)[0],range(21)))\nSimplicial complex with 21 vertices and 168 facets\n```\n\ntakes 8 seconds on my desktop, so should be marked `# long time`",
    "created_at": "2014-09-23T14:27:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221501",
    "user": "dimpase"
}
```

How about adding some real example? E.g. I tested that the output (the famous 168 hyperovals in PG(2,4)) is correct on the following:

```
sage: l=map(Set,ProjectiveGeometryDesign(2,1,GF(4,name='a')).blocks())
sage: SimplicialComplex(from_characteristic_function=(lambda S: not exists(l, lambda x: Set(S).intersection(x).cardinality()>2)[0],range(21)))
Simplicial complex with 21 vertices and 168 facets
```

takes 8 seconds on my desktop, so should be marked `# long time`



---

archive/issue_comments_221502.json:
```json
{
    "body": "> How about adding some real example?\n\nPlease add a commit if you want this example to be included.\n\nNathann",
    "created_at": "2014-09-23T14:30:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221502",
    "user": "ncohen"
}
```

> How about adding some real example?

Please add a commit if you want this example to be included.

Nathann



---

archive/issue_comments_221503.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-09-23T14:45:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221503",
    "user": "dimpase"
}
```

New commits:



---

archive/issue_comments_221504.json:
```json
{
    "body": "Otherwise LGTM. So you can flip this to positive review if you like my commit :-)",
    "created_at": "2014-09-23T14:47:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221504",
    "user": "dimpase"
}
```

Otherwise LGTM. So you can flip this to positive review if you like my commit :-)



---

archive/issue_comments_221505.json:
```json
{
    "body": "I was wondering what was the difference between \"any\" and \"exists\" and I found that in the docstring of \"exists\":\n\n\n```\n   Note that this function is NOT suitable to be used in an if-\n   statement or in any place where a boolean expression is expected.\n   For those situations, use the Python built-in\n```\n\n\nI don't understand why, however `O_o`\n\nNathann",
    "created_at": "2014-09-23T14:47:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221505",
    "user": "ncohen"
}
```

I was wondering what was the difference between "any" and "exists" and I found that in the docstring of "exists":


```
   Note that this function is NOT suitable to be used in an if-
   statement or in any place where a boolean expression is expected.
   For those situations, use the Python built-in
```


I don't understand why, however `O_o`

Nathann



---

archive/issue_comments_221506.json:
```json
{
    "body": "Also, there was a text just before my example that talked about sets whose sum is smaller than 4. Could you add some other text before yours ?\n\nNathann",
    "created_at": "2014-09-23T14:51:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221506",
    "user": "ncohen"
}
```

Also, there was a text just before my example that talked about sets whose sum is smaller than 4. Could you add some other text before yours ?

Nathann



---

archive/issue_comments_221507.json:
```json
{
    "body": "Replying to [comment:16 ncohen]:\n> I was wondering what was the difference between \"any\" and \"exists\" and I found that in the docstring of \"exists\":\n> \n> {{{\n>    Note that this function is NOT suitable to be used in an if-\n>    statement or in any place where a boolean expression is expected.\n>    For those situations, use the Python built-in\n> }}}\n> \n> I don't understand why, however `O_o`\n\nAh, I see - that's cause exists returns a pair! (notice `[0]` I had to put in).\nOK, I'll fix this. Just a second",
    "created_at": "2014-09-23T14:52:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221507",
    "user": "dimpase"
}
```

Replying to [comment:16 ncohen]:
> I was wondering what was the difference between "any" and "exists" and I found that in the docstring of "exists":
> 
> {{{
>    Note that this function is NOT suitable to be used in an if-
>    statement or in any place where a boolean expression is expected.
>    For those situations, use the Python built-in
> }}}
> 
> I don't understand why, however `O_o`

Ah, I see - that's cause exists returns a pair! (notice `[0]` I had to put in).
OK, I'll fix this. Just a second



---

archive/issue_comments_221508.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-23T15:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221508",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_221509.json:
```json
{
    "body": "OK, done.",
    "created_at": "2014-09-23T15:03:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221509",
    "user": "dimpase"
}
```

OK, done.



---

archive/issue_comments_221510.json:
```json
{
    "body": "Well.. Looks good, thanks `:-)`\n\nNathann",
    "created_at": "2014-09-23T15:04:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221510",
    "user": "ncohen"
}
```

Well.. Looks good, thanks `:-)`

Nathann



---

archive/issue_comments_221511.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-23T15:04:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221511",
    "user": "ncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_221512.json:
```json
{
    "body": "Hmmm... Funny. Your simplicial complex is a `(21,6,12)`-BIBD. And not one that we already have in the database.\n\n\n```\nsage: l=map(Set, designs.ProjectiveGeometryDesign(2,1,GF(4,name='a')))         \nsage: S=SimplicialComplex(from_characteristic_function=(lambda S: not any(Set(S).intersection(x).cardinality()>2 for x in l), range(21))) # long time\nsage: IS=IncidenceStructure([list(x) for x in s.maximal_faces()])\nsage: IS.is_t_design(return_parameters=True)\n(True, (2, 21, 6, 12))\nsage: (21,6,12) in sage.combinat.designs.database.DF\nFalse\n```\n\n\nI mean: currently the BIBD constructor does not even accept a `lambda` parameter, but we could have had a difference family for it.\n\n\n```\nsage: (0,9,10,12,16,13,18,11,7,8,1,4,5,3,2,15,19,6,14,20,17) in IS.automorphism_group()\nTrue\n```\n\n\nAnd it turns out that there is a cyclic automorphism acting on the hypergraph, so there IS such a difference family.\n\nHmmmm.... \n\nNathann",
    "created_at": "2014-09-23T15:17:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221512",
    "user": "ncohen"
}
```

Hmmm... Funny. Your simplicial complex is a `(21,6,12)`-BIBD. And not one that we already have in the database.


```
sage: l=map(Set, designs.ProjectiveGeometryDesign(2,1,GF(4,name='a')))         
sage: S=SimplicialComplex(from_characteristic_function=(lambda S: not any(Set(S).intersection(x).cardinality()>2 for x in l), range(21))) # long time
sage: IS=IncidenceStructure([list(x) for x in s.maximal_faces()])
sage: IS.is_t_design(return_parameters=True)
(True, (2, 21, 6, 12))
sage: (21,6,12) in sage.combinat.designs.database.DF
False
```


I mean: currently the BIBD constructor does not even accept a `lambda` parameter, but we could have had a difference family for it.


```
sage: (0,9,10,12,16,13,18,11,7,8,1,4,5,3,2,15,19,6,14,20,17) in IS.automorphism_group()
True
```


And it turns out that there is a cyclic automorphism acting on the hypergraph, so there IS such a difference family.

Hmmmm.... 

Nathann



---

archive/issue_comments_221513.json:
```json
{
    "body": "Replying to [comment:22 ncohen]:\n> Hmmm... Funny. Your simplicial complex is a `(21,6,12)`-BIBD. \n\nthis is not too surprising: these are the 168 octads containing a pair from a \ngiven triple of points in the famous Steiner system S(5,8,24) on 24 points.\n\n> And it turns out that there is a cyclic automorphism acting on the hypergraph, so there IS such a difference family.\n\nyep, there got to be lots of such automorphisms (the full group of automorphisms is quite big).",
    "created_at": "2014-09-23T15:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221513",
    "user": "dimpase"
}
```

Replying to [comment:22 ncohen]:
> Hmmm... Funny. Your simplicial complex is a `(21,6,12)`-BIBD. 

this is not too surprising: these are the 168 octads containing a pair from a 
given triple of points in the famous Steiner system S(5,8,24) on 24 points.

> And it turns out that there is a cyclic automorphism acting on the hypergraph, so there IS such a difference family.

yep, there got to be lots of such automorphisms (the full group of automorphisms is quite big).



---

archive/issue_comments_221514.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-09-25T12:05:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16757#issuecomment-221514",
    "user": "vbraun"
}
```

Resolution: fixed
