# Issue 21190: implement show using embedded graph for ordered trees

Issue created by migration from https://trac.sagemath.org/ticket/21427

Original creator: chapoton

Original creation time: 2016-09-05 18:48:06

CC:  tscrim darij kdilks hivert boussica

implement a way to display ordered trees correctly as graphs
(only works for unlabelled or with distinct labels)

using #21394


---

Comment by chapoton created at 2016-09-05 18:48:46

New commits:


---

Comment by chapoton created at 2016-09-05 18:48:46

Changing status from new to needs_review.


---

Comment by chapoton created at 2016-09-05 18:49:21

This is not completely good, but still better than nothing.


---

Comment by tscrim created at 2016-09-06 14:37:33

Thanks. This is a good addition. One minor thing, could you put the output of the plots in `.. PLOT::` blocks?


---

Comment by chapoton created at 2016-09-06 14:59:01

I am not quite sure of the correct syntax for `.. PLOT`. Maybe I should rather implement a `plot` method, instead of a `show` method ?


---

Comment by tscrim created at 2016-09-06 15:33:59

Oh, right, I think it is better to have a `plot` method than `show` as `show` redirects to `plot`.

For examples of `.. PLOT::`, you can see `src/sage/plot/plot.py`.


---

Comment by git created at 2016-09-06 15:38:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2016-09-06 15:45:16

How about for unlabeled ordered trees, we use the canonical labeling in order to get the root?


---

Comment by git created at 2016-09-06 15:48:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-09-06 15:50:39

This should now be ready for review, except for the root issue.

The problem with canonical labeling is that we use the canonical labelling of the **graph**, not the one of the tree. So we cannot assume that the root has number 0.


---

Comment by tscrim created at 2016-09-06 15:58:31

However, there is a canonical labeling for the tree, so it becomes a labeled ordered tree, which we can then get a unique plot. So something like this:

```python
        try:
            root = self.label()
            g = self.to_undirected_graph()
            return g.plot(layout='tree', tree_root=root, tree_orientation="down")
        except AttributeError:
            return self.canonical_labelling().plot()
```

I don't necessarily see why this wouldn't work, but maybe I'm missing something.

We should also changed the `show` to `plot` inside the method (which will re-introduce output).


---

Comment by git created at 2016-09-06 18:08:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-09-06 18:12:12

Ok, I did something for the unlabelled case. At least now the displayed shape should be correct, and the tree rooted at the correct vertex.


---

Comment by tscrim created at 2016-09-06 18:25:19

Thanks, the plotting looks good modulo that it is the mirror image. Is there a reason why are the children reversed?


---

Comment by chapoton created at 2016-09-06 18:36:03

to test correctly, you should merge with #21394 (closed, but not yet in beta)


---

Comment by tscrim created at 2016-09-06 18:43:11

Ah right. Forgot about that. Positive review.


---

Comment by tscrim created at 2016-09-06 18:43:11

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-09-07 06:45:37

PDF docs don't build

```
[docpdf] ! Package inputenc Error: Unicode char \u8:╭ not set up for use with LaTeX.
[docpdf] 
[docpdf] See the inputenc package documentation for explanation.
[docpdf] Type  H <return>  for immediate help.
[docpdf]  ...                                              
[docpdf]                                                   
[docpdf] l.113779 \PYG{g+go}{╭-o-╮}
[docpdf]                               
[docpdf] ? 
[docpdf] ! Emergency stop.
[docpdf]  ...                                              
[docpdf]                                                   
[docpdf] l.113779 \PYG{g+go}{╭-o-╮}
```



---

Comment by tscrim created at 2016-09-07 14:04:07

Changing status from positive_review to needs_work.


---

Comment by tscrim created at 2016-09-07 14:04:07

~~Is this the first time we are actually including unicode in the pdf doc (i.e., not hidden in `_unicode_art_`)?~~ The pdf builder doesn't like these unicode characters. Perhaps the easiest thing to do would be to convert the examples to ascii art?


---

Comment by chapoton created at 2016-09-07 14:07:53

not the first time, see abstract_trees, where there is the same thing with no complaints. The only difference I can see is that now we did not use `r"""`

But adding this does not solve the issue, it seems..


---

Comment by tscrim created at 2016-09-07 14:28:19

Replying to [comment:19 chapoton]:
> not the first time, see abstract_trees, where there is the same thing with no complaints. The only difference I can see is that now we did not use `r"""`
> 
> But adding this does not solve the issue, it seems..

I only see the unicode trees in the unicode art, so I am not surprised this doesn't make a difference. I think it would be something we'd need to setup with the pdf builder, and I think that's more trouble than its worth right now.


---

Comment by git created at 2016-09-07 14:32:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-09-07 14:32:54

I just replaced unicode_art by ascii_art


---

Comment by tscrim created at 2016-09-07 14:33:52

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2016-09-10 09:00:13

Resolution: fixed
