# Issue 25494: sage-spkg-uninstall: global name 'cur_dir' is not defined

Issue created by migration from https://trac.sagemath.org/ticket/25731

Original creator: jdemeyer

Original creation time: 2018-07-01 16:48:41

CC:  embray

In `build/sage_bootstrap/uninstall.py` there is

```
            print("Warning: Directory '{0}' not found".format(
                cur_dir), file=sys.stderr)
```

but the variable `cur_dir` is not defined.

More concretely, Rebecca Miller got this error:

```
 sage-spkg-uninstall pkgconf '/Users/RebeccaMiller/sage-develop/local'

Uninstalling existing 'pkgconf'

Warning: File '/share/man/man1/pkgconf.1' not found

Error during uninstallation of 'pkgconf': global name 'cur_dir' is not defined

make[1]: *** [pkgconf-clean] Error 1
```



---

Comment by jhpalmieri created at 2018-07-01 18:52:52

I've seen this when upgrading from 8.3.beta6 to 8.3.beta7 – see https://groups.google.com/d/msg/sage-release/H5pcrftzR8c/MxNx2dlEBwAJ – but in my case, it did not result in the `make` process ending.


---

Comment by jdemeyer created at 2018-07-01 20:55:58

In both cases (you and Rebecca Miller), the problem was really caused by relative filenames starting with `/`:

```
Warning: File '/include/linbox/algorithms/gauss/gauss-det-gf2.inl' not found
```



---

Comment by jdemeyer created at 2018-07-05 08:16:12

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2018-07-05 08:16:12

New commits:


---

Comment by chapoton created at 2018-07-06 07:48:41

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2018-07-06 07:48:41

looks good enough


---

Comment by embray created at 2018-07-06 08:36:44

I would add that I don't really think the uninstaller should have been enabled yet, or at least there shouldn't be a final release until a little more work is done to implement the "legacy uninstall" scripts for some packages. I talk about this in #25140. Without it, transitioning to the new package uninstall system might be a little flaky (this issue obviously was just a variable renaming typo).


---

Comment by slelievre created at 2018-07-06 12:18:04

Changing keywords from "" to "days94".


---

Comment by @fusion809 created at 2018-07-06 13:07:22

If it helps I had the same issue and I uploaded the full logs to the Google Group of sage-devel: https://groups.google.com/d/msg/sage-devel/AZklanDxykc/G9_Myei1CAAJ.


---

Comment by vbraun created at 2018-07-08 13:05:39

Resolution: fixed
