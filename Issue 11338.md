# Issue 11338: do not sdist the SAGE_ROOT hg repository

archive/issues_011338.json:
```json
{
    "body": "CC:  @jhpalmieri @vbraun @nexttime\n\nWhen sdist-ing Sage, there is absolutely no reason to distribute the SAGE_ROOT hg repository.  The hg repository should still be in the SAGE_ROOT spkg, so after Sage is built, there will be an hg repository present.  But before the Sage build, the hg repository serves no purpose.\n\nSee also #9433 and #11073.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11510\n\n",
    "created_at": "2011-06-16T19:04:05Z",
    "labels": [
        "component: scripts"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "do not sdist the SAGE_ROOT hg repository",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11338",
    "user": "https://github.com/jdemeyer"
}
```
CC:  @jhpalmieri @vbraun @nexttime

When sdist-ing Sage, there is absolutely no reason to distribute the SAGE_ROOT hg repository.  The hg repository should still be in the SAGE_ROOT spkg, so after Sage is built, there will be an hg repository present.  But before the Sage build, the hg repository serves no purpose.

See also #9433 and #11073.

Issue created by migration from https://trac.sagemath.org/ticket/11510





---

archive/issue_comments_125116.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-06-16T20:01:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11338#issuecomment-125116",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_125117.json:
```json
{
    "body": "Apply to SCRIPTS repository local/bin",
    "created_at": "2011-06-17T12:11:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11338#issuecomment-125117",
    "user": "https://github.com/jdemeyer"
}
```

Apply to SCRIPTS repository local/bin



---

archive/issue_comments_125118.json:
```json
{
    "body": "Attachment [11510_sdist.patch](tarball://root/attachments/some-uuid/ticket11510/11510_sdist.patch) by @jdemeyer created at 2011-06-20 19:13:13",
    "created_at": "2011-06-20T19:13:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11338#issuecomment-125118",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [11510_sdist.patch](tarball://root/attachments/some-uuid/ticket11510/11510_sdist.patch) by @jdemeyer created at 2011-06-20 19:13:13



---

archive/issue_comments_125119.json:
```json
{
    "body": "For testing purposes, this patch has been included in a trial [sage-4.7.1.alpha4](http://boxen.math.washington.edu/home/release/sage-4.7.1.alpha4/).  The following were tested successfully:\n1. Building a source tarball using the patched `sage-sdist`\n2. Building Sage completely from source using that tarball\n3. Upgrading from sage-4.6 (which does not include #9433)\n4. Upgrading from sage-4.7 (which does include #9433)\n5. `make ptestlong` in all these builds",
    "created_at": "2011-06-20T19:18:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11338#issuecomment-125119",
    "user": "https://github.com/jdemeyer"
}
```

For testing purposes, this patch has been included in a trial [sage-4.7.1.alpha4](http://boxen.math.washington.edu/home/release/sage-4.7.1.alpha4/).  The following were tested successfully:
1. Building a source tarball using the patched `sage-sdist`
2. Building Sage completely from source using that tarball
3. Upgrading from sage-4.6 (which does not include #9433)
4. Upgrading from sage-4.7 (which does include #9433)
5. `make ptestlong` in all these builds



---

archive/issue_comments_125120.json:
```json
{
    "body": "Two comments:\n\n- is there a problem with distributing the root repo?  It takes up a little disk space, but it's pretty innocuous, isn't it?\n\n- I can think of one situation where it might be useful to distribute the repo: someone has downloaded Sage and wants to immediately apply a patch to \"Makefile\", \"spkg/standard/deps\", etc.  Without the root repo, this is inconvenient.",
    "created_at": "2011-06-29T21:37:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11338#issuecomment-125120",
    "user": "https://github.com/jhpalmieri"
}
```

Two comments:

- is there a problem with distributing the root repo?  It takes up a little disk space, but it's pretty innocuous, isn't it?

- I can think of one situation where it might be useful to distribute the repo: someone has downloaded Sage and wants to immediately apply a patch to "Makefile", "spkg/standard/deps", etc.  Without the root repo, this is inconvenient.



---

archive/issue_comments_125121.json:
```json
{
    "body": "Replying to [comment:5 jhpalmieri]:\n> Two comments:\n> \n>  - is there a problem with distributing the root repo?  It takes up a little disk space, but it's pretty innocuous, isn't it?\nLots of small files on the mirrors, not sure whether this is a desirable situation.  I can imagine that mirrors are optimized for just a few very large files.\n\n>  - I can think of one situation where it might be useful to distribute the repo: someone has downloaded Sage and wants to immediately apply a patch to \"Makefile\", \"spkg/standard/deps\", etc.  Without the root repo, this is inconvenient.  \nWell, one can always do a standard `patch -p1` but I agree that you have a point.",
    "created_at": "2011-07-01T20:49:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11338#issuecomment-125121",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:5 jhpalmieri]:
> Two comments:
> 
>  - is there a problem with distributing the root repo?  It takes up a little disk space, but it's pretty innocuous, isn't it?
Lots of small files on the mirrors, not sure whether this is a desirable situation.  I can imagine that mirrors are optimized for just a few very large files.

>  - I can think of one situation where it might be useful to distribute the repo: someone has downloaded Sage and wants to immediately apply a patch to "Makefile", "spkg/standard/deps", etc.  Without the root repo, this is inconvenient.  
Well, one can always do a standard `patch -p1` but I agree that you have a point.



---

archive/issue_comments_125122.json:
```json
{
    "body": "The way I understood it, the root repo would be directly part of the Sage tarball and not wrapped into an extra spkg. Updating Sage could be done with a mercurial bundle. \n\nThat way, a first install as well as updates could always assume that the root repo is of the newest version.\n\nI noticed before that first building Sage, then applying patches, and then rebuilding Sage is somewhat annoying. +1 from me :-)",
    "created_at": "2011-07-01T20:58:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11338#issuecomment-125122",
    "user": "https://github.com/vbraun"
}
```

The way I understood it, the root repo would be directly part of the Sage tarball and not wrapped into an extra spkg. Updating Sage could be done with a mercurial bundle. 

That way, a first install as well as updates could always assume that the root repo is of the newest version.

I noticed before that first building Sage, then applying patches, and then rebuilding Sage is somewhat annoying. +1 from me :-)



---

archive/issue_comments_125123.json:
```json
{
    "body": "Jeroen: fortunately, the root repo doesn't track very many files, so its presence doesn't add a lot of files, maybe 40-50, but not hundreds.\n\nVolker: yes, updating is the issue. I would be happy if the root repo weren't part of an spkg, but then we would need to revise the way it's handled in updates.  To use bundles, would \"sage -sdist\" store a bundle file with the other spkgs, and then \"sage -upgrade\" would download it and apply it?",
    "created_at": "2011-07-03T15:27:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11338#issuecomment-125123",
    "user": "https://github.com/jhpalmieri"
}
```

Jeroen: fortunately, the root repo doesn't track very many files, so its presence doesn't add a lot of files, maybe 40-50, but not hundreds.

Volker: yes, updating is the issue. I would be happy if the root repo weren't part of an spkg, but then we would need to revise the way it's handled in updates.  To use bundles, would "sage -sdist" store a bundle file with the other spkgs, and then "sage -upgrade" would download it and apply it?



---

archive/issue_comments_125124.json:
```json
{
    "body": "Should this be closed as \"wontfix\"?",
    "created_at": "2011-11-06T00:09:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11338#issuecomment-125124",
    "user": "https://github.com/jdemeyer"
}
```

Should this be closed as "wontfix"?



---

archive/issue_comments_125125.json:
```json
{
    "body": "Replying to [comment:11 jdemeyer]:\n> Should this be closed as \"wontfix\"?\n\nDon't know.  Have you changed your mind?\n\nThere are advantages and disadvantages of having it there \"from the beginning\", although I tend to prefer having it.\n\nWhether we need a separate sage_root *spkg*, also updated on every release, is IMHO orthogonal.",
    "created_at": "2011-11-06T01:11:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11338#issuecomment-125125",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:11 jdemeyer]:
> Should this be closed as "wontfix"?

Don't know.  Have you changed your mind?

There are advantages and disadvantages of having it there "from the beginning", although I tend to prefer having it.

Whether we need a separate sage_root *spkg*, also updated on every release, is IMHO orthogonal.



---

archive/issue_comments_125126.json:
```json
{
    "body": "Replying to [comment:12 leif]:\n> Replying to [comment:11 jdemeyer]:\n> > Should this be closed as \"wontfix\"?\n> \n> Don't know.  Have you changed your mind?\nIt seems I have the minority opinion here and also it is not such an important ticket.",
    "created_at": "2011-11-06T09:55:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11338#issuecomment-125126",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:12 leif]:
> Replying to [comment:11 jdemeyer]:
> > Should this be closed as "wontfix"?
> 
> Don't know.  Have you changed your mind?
It seems I have the minority opinion here and also it is not such an important ticket.



---

archive/issue_comments_125127.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2012-08-13T12:22:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11338#issuecomment-125127",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: wontfix



---

archive/issue_events_011425.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-08-13T12:22:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11338",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11338#event-11425"
}
```
