# Issue 25803: using iterators inside some "all, any, sorted, tuple" in pyx files

Issue created by migration from Trac.

Original creator: chapoton

Original creation time: 2018-08-10 06:52:39




---

Comment by chapoton created at 2018-08-10 06:53:12

New commits:


---

Comment by chapoton created at 2018-08-10 06:53:12

Changing status from new to needs_review.


---

Comment by git created at 2018-08-10 08:32:48

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2018-08-10 09:55:17

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by tscrim created at 2018-08-10 09:58:43

So like Python, it is faster to create a tuple from a list (comprehension) than from a generator:

```
sage: %%cython
....: def foo(n):
....:     return tuple([i for i in range(n)])
....: def bar(n):
....:     return tuple(i for i in range(n))
....: 
sage: %timeit foo(100)
The slowest run took 9.13 times longer than the fastest. This could mean that an intermediate result is being cached.
1000000 loops, best of 3: 1.85 µs per loop
sage: %timeit bar(100)
The slowest run took 4.90 times longer than the fastest. This could mean that an intermediate result is being cached.
100000 loops, best of 3: 3.07 µs per loop
```

For `frozenset`, it is also faster, but not as pronounced:

```
sage: %%cython
....: def foo(n):
....:     return frozenset([i for i in range(n)])
....: def bar(n):
....:     return frozenset(i for i in range(n))
....: 
sage: %timeit foo(100)
The slowest run took 6.06 times longer than the fastest. This could mean that an intermediate result is being cached.
100000 loops, best of 3: 3.32 µs per loop
sage: %timeit bar(100)
The slowest run took 12.88 times longer than the fastest. This could mean that an intermediate result is being cached.
100000 loops, best of 3: 3.81 µs per loop
```



---

Comment by git created at 2018-08-11 14:41:55

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by chapoton created at 2018-08-11 14:43:37

The changes to tuple and frozenset have been undone.


---

Comment by tscrim created at 2018-08-11 14:48:45

Thank you. LGTM.


---

Comment by tscrim created at 2018-08-11 14:48:45

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-08-20 23:38:40

Resolution: fixed
