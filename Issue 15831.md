# Issue 15831: Use base_ring in chord_and_tangent

Issue created by migration from Trac.

Original creator: jkeitel

Original creation time: 2014-04-07 08:40:28

CC:  vbraun

Right now, the following fails:


```
sage: from sage.schemes.elliptic_curves.constructor import chord_and_tangent
sage: R = PolynomialRing(QQ, 'x,y,z')
sage: x,y,z = R.gens()
sage: cubic = x**3 - 4*x**2*y - 65*x*y**2 + 3*x*y*z - 76*y*z**2
sage: f0 = (0, 1, 0)
sage: chord_and_tangent(cubic, f0)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-9-05d9ab02db04> in <module>()
----> 1 chord_and_tangent(cubic, f0)

/home/pcl337b/jkeitel/sage/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/constructor.pyc in chord_and_tangent(F, P)
    898             g = F.substitute({x:y, y:x})
    899             Q = [P[1], P[0], P[2]]
--> 900             R = chord_and_tangent(g, Q)
    901             return [R[1], R[0], R[2]]
    902         elif dz != 0:

/home/pcl337b/jkeitel/sage/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/constructor.pyc in chord_and_tangent(F, P)
    917         g = F.substitute({x:z, z:x})
    918         Q = [P[2], P[1], P[0]]
--> 919         R = chord_and_tangent(g, Q)
    920         return [R[2], R[1], R[0]]
    921     # Ft has a double zero at t=0 by construction, which we now remove

/home/pcl337b/jkeitel/sage/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/constructor.pyc in chord_and_tangent(F, P)
    924     # first case: the third point is at t=infinity
    925     if Ft.is_constant():
--> 926         return projective_point([dy, -dx, 0])
    927     # second case: the third point is at finite t
    928     else:

/home/pcl337b/jkeitel/sage/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/constructor.pyc in projective_point(p)
    955     from sage.rings.integer import GCD_list, LCM_list
    956     try:
--> 957         p_gcd = GCD_list([x.numerator() for x in p])
    958         p_lcm = LCM_list([x.denominator() for x in p])
    959     except AttributeError:

TypeError: 'int' object is not callable
```


This is very simple to fix - convert a 0 into an element of the base ring of the curve and I've attached a branch that does that.


---

Comment by jkeitel created at 2014-04-07 08:42:44

Changing status from new to needs_review.


---

Comment by jkeitel created at 2014-04-07 08:42:44

New commits:


---

Comment by pbruin created at 2014-04-07 10:39:10

Changing status from needs_review to needs_work.


---

Comment by pbruin created at 2014-04-07 10:39:10

Looks good, but the line `See :trac:`16068`::` is indented one level too many.

(I wonder why this function is called `chord_and_tangent` given that it only implements the "tangent" part, but that is irrelevant for this bug.)


---

Comment by pbruin created at 2014-04-07 10:39:10

Changing type from PLEASE CHANGE to defect.


---

Comment by git created at 2014-04-07 10:48:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jkeitel created at 2014-04-07 10:49:27

Changing status from needs_work to needs_review.


---

Comment by jkeitel created at 2014-04-07 10:49:27

Thanks, I've changed the indentation.


---

Comment by pbruin created at 2014-04-07 12:03:17

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-04-07 19:08:55

Resolution: fixed
