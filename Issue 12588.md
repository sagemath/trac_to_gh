# Issue 12588: gfan 0.4plus [p1] fails to build with GCC 4.7.0

archive/issues_012588.json:
```json
{
    "body": "Assignee: @nexttime\n\nCC:  mhampton @williamstein mariah\n\nKeywords: spkg C++11\n\nThis is due to a trivial programming error.  I already have an spkg fixing this, along with a major clean-up of the spkg.\n\nIssue created by migration from https://trac.sagemath.org/ticket/12760\n\n",
    "created_at": "2012-03-27T18:03:56Z",
    "labels": [
        "packages: standard",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0.1",
    "title": "gfan 0.4plus [p1] fails to build with GCC 4.7.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12588",
    "user": "@nexttime"
}
```
Assignee: @nexttime

CC:  mhampton @williamstein mariah

Keywords: spkg C++11

This is due to a trivial programming error.  I already have an spkg fixing this, along with a major clean-up of the spkg.

Issue created by migration from https://trac.sagemath.org/ticket/12760





---

archive/issue_comments_149683.json:
```json
{
    "body": "Attachment [gfan-0.4plus.p1-p2.diff](tarball://root/attachments/some-uuid/ticket12760/gfan-0.4plus.p1-p2.diff) by @nexttime created at 2012-03-27 19:20:25\n\nDiff between the previous spkg in Sage and my new p2 spkg. For reference / review only.",
    "created_at": "2012-03-27T19:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12588#issuecomment-149683",
    "user": "@nexttime"
}
```

Attachment [gfan-0.4plus.p1-p2.diff](tarball://root/attachments/some-uuid/ticket12760/gfan-0.4plus.p1-p2.diff) by @nexttime created at 2012-03-27 19:20:25

Diff between the previous spkg in Sage and my new p2 spkg. For reference / review only.



---

archive/issue_comments_149684.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-03-27T19:30:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12588#issuecomment-149684",
    "user": "@nexttime"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_149685.json:
```json
{
    "body": "This should be reported upstream.",
    "created_at": "2012-03-28T08:37:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12588#issuecomment-149685",
    "user": "@jdemeyer"
}
```

This should be reported upstream.



---

archive/issue_comments_149686.json:
```json
{
    "body": "Replying to [comment:3 jdemeyer]:\n> This should be reported upstream.\n\nThat's one reason why I cc'ed the spkg maintainers... ;-) \n\nNote that Gfan 0.4plus is of late 2009; Gfan 0.5 was released more than a year ago.  Haven't checked whether the latter fixes the C++11 issues, but since it introduces new functionality (and probably also new bugs), I haven't tried using that.",
    "created_at": "2012-03-28T16:06:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12588#issuecomment-149686",
    "user": "@nexttime"
}
```

Replying to [comment:3 jdemeyer]:
> This should be reported upstream.

That's one reason why I cc'ed the spkg maintainers... ;-) 

Note that Gfan 0.4plus is of late 2009; Gfan 0.5 was released more than a year ago.  Haven't checked whether the latter fixes the C++11 issues, but since it introduces new functionality (and probably also new bugs), I haven't tried using that.



---

archive/issue_comments_149687.json:
```json
{
    "body": "Putting in Gfan 0.5 has been on my todo list for a long time but I haven't had a chance to concentrate on it.  The whole interface could use a good overhaul.  If no one else beats me to it I hope to tackle that this summer.  The ticket for that is:\n\n[http://trac.sagemath.org/sage_trac/ticket/11395](http://trac.sagemath.org/sage_trac/ticket/11395)",
    "created_at": "2012-03-28T16:18:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12588#issuecomment-149687",
    "user": "mhampton"
}
```

Putting in Gfan 0.5 has been on my todo list for a long time but I haven't had a chance to concentrate on it.  The whole interface could use a good overhaul.  If no one else beats me to it I hope to tackle that this summer.  The ticket for that is:

[http://trac.sagemath.org/sage_trac/ticket/11395](http://trac.sagemath.org/sage_trac/ticket/11395)



---

archive/issue_comments_149688.json:
```json
{
    "body": "Wuuuuu... Cleaned up a bit too much.\n\nNeeds correction w.r.t. exporting `CFLAG64` and especially `CXXFLAG64` (which is used in the patched Makefile), otherwise build fails on ia64 and most probably also 32-bit systems.",
    "created_at": "2012-04-05T21:34:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12588#issuecomment-149688",
    "user": "@nexttime"
}
```

Wuuuuu... Cleaned up a bit too much.

Needs correction w.r.t. exporting `CFLAG64` and especially `CXXFLAG64` (which is used in the patched Makefile), otherwise build fails on ia64 and most probably also 32-bit systems.



---

archive/issue_comments_149689.json:
```json
{
    "body": "Replying to [comment:6 leif]:\n> Needs correction w.r.t. exporting `CFLAG64` and especially `CXXFLAG64` (which is used in the patched Makefile), otherwise build fails on ia64 and most probably also 32-bit systems.\n\nNow fixed in a new p3.",
    "created_at": "2012-04-05T23:58:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12588#issuecomment-149689",
    "user": "@nexttime"
}
```

Replying to [comment:6 leif]:
> Needs correction w.r.t. exporting `CFLAG64` and especially `CXXFLAG64` (which is used in the patched Makefile), otherwise build fails on ia64 and most probably also 32-bit systems.

Now fixed in a new p3.



---

archive/issue_comments_149690.json:
```json
{
    "body": "Diff between the previous spkg in Sage and my new p3 spkg. For reference / review only.",
    "created_at": "2012-04-06T00:05:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12588#issuecomment-149690",
    "user": "@nexttime"
}
```

Diff between the previous spkg in Sage and my new p3 spkg. For reference / review only.



---

archive/issue_comments_149691.json:
```json
{
    "body": "Attachment [gfan-0.4plus.p2-p3.diff](tarball://root/attachments/some-uuid/ticket12760/gfan-0.4plus.p2-p3.diff) by @nexttime created at 2012-04-06 00:07:05\n\nDiff between my p2 and my p3 spkg.  For reference / review only.",
    "created_at": "2012-04-06T00:07:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12588#issuecomment-149691",
    "user": "@nexttime"
}
```

Attachment [gfan-0.4plus.p2-p3.diff](tarball://root/attachments/some-uuid/ticket12760/gfan-0.4plus.p2-p3.diff) by @nexttime created at 2012-04-06 00:07:05

Diff between my p2 and my p3 spkg.  For reference / review only.



---

archive/issue_comments_149692.json:
```json
{
    "body": "From my updated `SPKG.txt`:\n\n```\nTODO:\n * Use `patch` to apply patches (then also add GNU patch to the dependencies).\n * Clean up `spkg-install` further w.r.t. installation etc.\n * Probably remove `CXXFLAG64` from the (patched) Makefile; instead put it\n   into `LDFLAGS` and use these in the Makefile.\n * The Makefile is still suboptimal; e.g. Sage-specific values shouldn't be\n   hardcoded into it.  That way we could provide a clean patch for upstream,\n   and would later only have to change/set `make` variables in `spkg-install`,\n   without the need to patch the Makefile at all for Sage.\n   Also `CXXFLAGS` aren't used in, i.e. ignored by the current Makefile.\n```\n\n\nI'll probably fix *some* of these *here* **later**<sup>TM</sup> as well, especially item 1, and perhaps also items 3 and 2, but because of #11395, I won't do much more at the moment.",
    "created_at": "2012-04-08T02:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12588#issuecomment-149692",
    "user": "@nexttime"
}
```

From my updated `SPKG.txt`:

```
TODO:
 * Use `patch` to apply patches (then also add GNU patch to the dependencies).
 * Clean up `spkg-install` further w.r.t. installation etc.
 * Probably remove `CXXFLAG64` from the (patched) Makefile; instead put it
   into `LDFLAGS` and use these in the Makefile.
 * The Makefile is still suboptimal; e.g. Sage-specific values shouldn't be
   hardcoded into it.  That way we could provide a clean patch for upstream,
   and would later only have to change/set `make` variables in `spkg-install`,
   without the need to patch the Makefile at all for Sage.
   Also `CXXFLAGS` aren't used in, i.e. ignored by the current Makefile.
```


I'll probably fix *some* of these *here* **later**<sup>TM</sup> as well, especially item 1, and perhaps also items 3 and 2, but because of #11395, I won't do much more at the moment.



---

archive/issue_comments_149693.json:
```json
{
    "body": "You should make all files in `src` world-readable:\n\n```\nchmod -R ugo+r src\n```\n",
    "created_at": "2012-04-26T22:54:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12588#issuecomment-149693",
    "user": "@jdemeyer"
}
```

You should make all files in `src` world-readable:

```
chmod -R ugo+r src
```




---

archive/issue_comments_149694.json:
```json
{
    "body": "Replying to [comment:10 jdemeyer]:\n> You should make all files in `src` world-readable:\n> {{{\n> chmod -R ugo+r src\n> }}}\n\nWell, these have been in before (and the respective files were of course user-readable, and they don't get installed anyway).\n\nAnyway, fixed; new spkg, same place.",
    "created_at": "2012-04-27T00:08:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12588#issuecomment-149694",
    "user": "@nexttime"
}
```

Replying to [comment:10 jdemeyer]:
> You should make all files in `src` world-readable:
> {{{
> chmod -R ugo+r src
> }}}

Well, these have been in before (and the respective files were of course user-readable, and they don't get installed anyway).

Anyway, fixed; new spkg, same place.



---

archive/issue_comments_149695.json:
```json
{
    "body": "I managed to install :\n2bb0b5f4cd0081c1af939294ba2e1859  gfan-0.4plus.p3.spkg\non my debian x86_64 box, using gcc 4.7.0.",
    "created_at": "2012-05-14T14:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12588#issuecomment-149695",
    "user": "Snark"
}
```

I managed to install :
2bb0b5f4cd0081c1af939294ba2e1859  gfan-0.4plus.p3.spkg
on my debian x86_64 box, using gcc 4.7.0.



---

archive/issue_comments_149696.json:
```json
{
    "body": "Looks good to me.",
    "created_at": "2012-05-25T21:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12588#issuecomment-149696",
    "user": "@jdemeyer"
}
```

Looks good to me.



---

archive/issue_comments_149697.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-05-25T21:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12588#issuecomment-149697",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_149698.json:
```json
{
    "body": "Changing keywords from \"spkg C++11\" to \"spkg C++11 sd40.5\".",
    "created_at": "2012-05-25T21:09:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12588#issuecomment-149698",
    "user": "@jdemeyer"
}
```

Changing keywords from "spkg C++11" to "spkg C++11 sd40.5".



---

archive/issue_comments_149699.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-05-31T13:42:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12588#issuecomment-149699",
    "user": "@jdemeyer"
}
```

Resolution: fixed
