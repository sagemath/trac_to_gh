# Issue 22815: Provide coercion for gmpy2 numbers

archive/issues_022815.json:
```json
{
    "body": "CC:  vdelecroix jdemeyer\n\nProvide coercion for gmpy2 numbers for operations -, +, * and /\nThis ticket follow the discussion about coercion for gmpy2 numbers #22928.\n\nIssue created by migration from https://trac.sagemath.org/ticket/23052\n\n",
    "created_at": "2017-05-22T10:18:18Z",
    "labels": [
        "packages: optional",
        "major",
        "enhancement"
    ],
    "title": "Provide coercion for gmpy2 numbers",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22815",
    "user": "vklein"
}
```
CC:  vdelecroix jdemeyer

Provide coercion for gmpy2 numbers for operations -, +, * and /
This ticket follow the discussion about coercion for gmpy2 numbers #22928.

Issue created by migration from https://trac.sagemath.org/ticket/23052





---

archive/issue_comments_319069.json:
```json
{
    "body": "Set assignee to vklein.",
    "created_at": "2017-05-22T10:19:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319069",
    "user": "vklein"
}
```

Set assignee to vklein.



---

archive/issue_comments_319070.json:
```json
{
    "body": "Replying to [ticket:23052 vklein]:\n> Provide coercion for gmpy2 numbers for operations -, +, * and /\n\nThis makes no sense to me. What does it mean to provide coercion for **certain operations** only?",
    "created_at": "2017-05-22T10:26:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319070",
    "user": "jdemeyer"
}
```

Replying to [ticket:23052 vklein]:
> Provide coercion for gmpy2 numbers for operations -, +, * and /

This makes no sense to me. What does it mean to provide coercion for **certain operations** only?



---

archive/issue_comments_319071.json:
```json
{
    "body": "You're right, description updated",
    "created_at": "2017-05-22T11:22:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319071",
    "user": "vklein"
}
```

You're right, description updated



---

archive/issue_comments_319072.json:
```json
{
    "body": "Thanks for the clarification.",
    "created_at": "2017-05-22T11:44:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319072",
    "user": "jdemeyer"
}
```

Thanks for the clarification.



---

archive/issue_comments_319073.json:
```json
{
    "body": "I don't think that this feature is desirable. The behavior should be the same as with `cypari2`\n\n```\nsage: import cypari2\nsage: pari = cypari2.Pari()\nsage: type(pari(1) + 1)\n<type 'cypari2.gen.Gen'>\nsage: type(1 + pari(1))\n<type 'cypari2.gen.Gen'>\n```\n\nMixing `gmpy2` numbers with sage numbers currently raise errors\n\n```\nsage: import gmpy2\nsage: type(gmpy2.mpz(1) + 1)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-2-eeaeca1c122b> in <module>()\n----> 1 type(gmpy2.mpz(Integer(1)) + Integer(1))\n\n/opt/sage/local/lib/python2.7/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__add__ (build/cythonized/sage/rings/integer.c:11460)()\n   1683             return y\n   1684 \n-> 1685         return coercion_model.bin_op(left, right, operator.add)\n   1686 \n   1687     cpdef _add_(self, right):\n\n/opt/sage/local/lib/python2.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:11110)()\n   1208         # We should really include the underlying error.\n   1209         # This causes so much headache.\n-> 1210         raise bin_op_exception(op, x, y)\n   1211 \n   1212     cpdef canonical_coercion(self, x, y):\n\nTypeError: unsupported operand parent(s) for +: '<type 'mpz'>' and 'Integer Ring'\nsage: type(1 + gmpy2.mpz(1))\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-3-ea356a02d58b> in <module>()\n----> 1 type(Integer(1) + gmpy2.mpz(Integer(1)))\n\n/opt/sage/local/lib/python2.7/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__add__ (build/cythonized/sage/rings/integer.c:11460)()\n   1683             return y\n   1684 \n-> 1685         return coercion_model.bin_op(left, right, operator.add)\n   1686 \n   1687     cpdef _add_(self, right):\n\n/opt/sage/local/lib/python2.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:11110)()\n   1208         # We should really include the underlying error.\n   1209         # This causes so much headache.\n-> 1210         raise bin_op_exception(op, x, y)\n   1211 \n   1212     cpdef canonical_coercion(self, x, y):\n\nTypeError: unsupported operand parent(s) for +: 'Integer Ring' and '<type 'mpz'>'\n```\n",
    "created_at": "2019-03-03T10:19:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319073",
    "user": "vdelecroix"
}
```

I don't think that this feature is desirable. The behavior should be the same as with `cypari2`

```
sage: import cypari2
sage: pari = cypari2.Pari()
sage: type(pari(1) + 1)
<type 'cypari2.gen.Gen'>
sage: type(1 + pari(1))
<type 'cypari2.gen.Gen'>
```

Mixing `gmpy2` numbers with sage numbers currently raise errors

```
sage: import gmpy2
sage: type(gmpy2.mpz(1) + 1)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-2-eeaeca1c122b> in <module>()
----> 1 type(gmpy2.mpz(Integer(1)) + Integer(1))

/opt/sage/local/lib/python2.7/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__add__ (build/cythonized/sage/rings/integer.c:11460)()
   1683             return y
   1684 
-> 1685         return coercion_model.bin_op(left, right, operator.add)
   1686 
   1687     cpdef _add_(self, right):

/opt/sage/local/lib/python2.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:11110)()
   1208         # We should really include the underlying error.
   1209         # This causes so much headache.
-> 1210         raise bin_op_exception(op, x, y)
   1211 
   1212     cpdef canonical_coercion(self, x, y):

TypeError: unsupported operand parent(s) for +: '<type 'mpz'>' and 'Integer Ring'
sage: type(1 + gmpy2.mpz(1))
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-3-ea356a02d58b> in <module>()
----> 1 type(Integer(1) + gmpy2.mpz(Integer(1)))

/opt/sage/local/lib/python2.7/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__add__ (build/cythonized/sage/rings/integer.c:11460)()
   1683             return y
   1684 
-> 1685         return coercion_model.bin_op(left, right, operator.add)
   1686 
   1687     cpdef _add_(self, right):

/opt/sage/local/lib/python2.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:11110)()
   1208         # We should really include the underlying error.
   1209         # This causes so much headache.
-> 1210         raise bin_op_exception(op, x, y)
   1211 
   1212     cpdef canonical_coercion(self, x, y):

TypeError: unsupported operand parent(s) for +: 'Integer Ring' and '<type 'mpz'>'
```




---

archive/issue_comments_319074.json:
```json
{
    "body": "To make this work, one has to modify the various binary operators in `gmpy2` (e.g. `GMPy_Integer_Add`).",
    "created_at": "2019-03-03T10:22:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319074",
    "user": "vdelecroix"
}
```

To make this work, one has to modify the various binary operators in `gmpy2` (e.g. `GMPy_Integer_Add`).



---

archive/issue_comments_319075.json:
```json
{
    "body": "Replying to [comment:8 vdelecroix]:\n> To make this work, one has to modify the various binary operators in `gmpy2` (e.g. `GMPy_Integer_Add`).\n\nThis is obviously the right thing to do. Given that\n\n```\nsage: from gmpy2 import mpz\nsage: mpz(1) + int(1)\nmpz(2)\n```\n\nworks, it's actually strange that\n\n```\nsage: from gmpy2 import mpz\nsage: mpz(1) + Integer(1)\nTraceback (most recent call last):\n...\nTypeError: unsupported operand parent(s) for +: '<type 'mpz'>' and 'Integer Ring'\n```\n\ndoesn't work.",
    "created_at": "2019-03-03T10:53:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319075",
    "user": "jdemeyer"
}
```

Replying to [comment:8 vdelecroix]:
> To make this work, one has to modify the various binary operators in `gmpy2` (e.g. `GMPy_Integer_Add`).

This is obviously the right thing to do. Given that

```
sage: from gmpy2 import mpz
sage: mpz(1) + int(1)
mpz(2)
```

works, it's actually strange that

```
sage: from gmpy2 import mpz
sage: mpz(1) + Integer(1)
Traceback (most recent call last):
...
TypeError: unsupported operand parent(s) for +: '<type 'mpz'>' and 'Integer Ring'
```

doesn't work.



---

archive/issue_comments_319076.json:
```json
{
    "body": "Let me update the ticket description then.",
    "created_at": "2019-03-03T10:54:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319076",
    "user": "vdelecroix"
}
```

Let me update the ticket description then.



---

archive/issue_comments_319077.json:
```json
{
    "body": "Changing component from packages: optional to packages: standard.",
    "created_at": "2019-03-03T10:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319077",
    "user": "vdelecroix"
}
```

Changing component from packages: optional to packages: standard.



---

archive/issue_comments_319078.json:
```json
{
    "body": "Changing type from enhancement to defect.",
    "created_at": "2019-03-03T10:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319078",
    "user": "vdelecroix"
}
```

Changing type from enhancement to defect.



---

archive/issue_comments_319079.json:
```json
{
    "body": "The gmpy2 pull request [#217](https://github.com/aleaxit/gmpy/pull/217) has been merged this morning.\\\\\nShould we make a patch based on this or wait for the next gmpy2 release ?",
    "created_at": "2019-03-07T09:47:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319079",
    "user": "vklein"
}
```

The gmpy2 pull request [#217](https://github.com/aleaxit/gmpy/pull/217) has been merged this morning.\\
Should we make a patch based on this or wait for the next gmpy2 release ?



---

archive/issue_comments_319080.json:
```json
{
    "body": "Replying to [comment:14 vklein]:\n> The gmpy2 pull request [#217](https://github.com/aleaxit/gmpy/pull/217) has been merged this morning.\n\nThis is a great news. Thanks for the work!\n\n> Should we make a patch based on this or wait for the next gmpy2 release ?\n\nDo we have a schedule for the next gmpy2 release? Since gmpy2 becomes a standard package for the next Sage release it would be nice if it would happen before.\n\nOtherwise, I am not a big fan of using patches that are integrated upstream but not released yet.",
    "created_at": "2019-03-07T12:50:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319080",
    "user": "vdelecroix"
}
```

Replying to [comment:14 vklein]:
> The gmpy2 pull request [#217](https://github.com/aleaxit/gmpy/pull/217) has been merged this morning.

This is a great news. Thanks for the work!

> Should we make a patch based on this or wait for the next gmpy2 release ?

Do we have a schedule for the next gmpy2 release? Since gmpy2 becomes a standard package for the next Sage release it would be nice if it would happen before.

Otherwise, I am not a big fan of using patches that are integrated upstream but not released yet.



---

archive/issue_comments_319081.json:
```json
{
    "body": "Replying to [comment:15 vdelecroix]:\n> Replying to [comment:14 vklein]:\n> > Should we make a patch based on this or wait for the next gmpy2 release ?\n> \n> Do we have a schedule for the next gmpy2 release? Since gmpy2 becomes a standard package for the next Sage release it would be nice if it would happen before.\n\nSomehow [#199](https://github.com/aleaxit/gmpy/issues/199) is a bit of an answer.",
    "created_at": "2019-03-07T12:52:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319081",
    "user": "vdelecroix"
}
```

Replying to [comment:15 vdelecroix]:
> Replying to [comment:14 vklein]:
> > Should we make a patch based on this or wait for the next gmpy2 release ?
> 
> Do we have a schedule for the next gmpy2 release? Since gmpy2 becomes a standard package for the next Sage release it would be nice if it would happen before.

Somehow [#199](https://github.com/aleaxit/gmpy/issues/199) is a bit of an answer.



---

archive/issue_comments_319082.json:
```json
{
    "body": "After some talk with vdelecroix we agree to make a gmpy2 patch with [#217](https://github.com/aleaxit/gmpy/pull/217).\n----\nNew commits:",
    "created_at": "2019-03-08T09:40:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319082",
    "user": "vklein"
}
```

After some talk with vdelecroix we agree to make a gmpy2 patch with [#217](https://github.com/aleaxit/gmpy/pull/217).
----
New commits:



---

archive/issue_comments_319083.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-03-08T09:40:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319083",
    "user": "vklein"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_319084.json:
```json
{
    "body": "You create a lot of warnings with the macros. This should be fixed.\n\n```\ngmpy2-2.1.0a4.p1]     src/gmpy2_cache.c: In function 'GMPy_MPZ_NewInit':\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:44:60: warning: suggest parentheses around '&&' within '||' [-Wparentheses]\n[gmpy2-2.1.0a4.p1]      #define HAS_STRICT_MPZ_CONVERSION(x) HAS_MPZ_CONVERSION(x) && \\\n[gmpy2-2.1.0a4.p1]                                                                 ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:52:25: note: in expansion of macro 'HAS_STRICT_MPZ_CONVERSION'\n[gmpy2-2.1.0a4.p1]                              HAS_STRICT_MPZ_CONVERSION(x))\n[gmpy2-2.1.0a4.p1]                              ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:61:25: note: in expansion of macro 'IS_INTEGER'\n[gmpy2-2.1.0a4.p1]      #define IS_RATIONAL(x) (IS_INTEGER(x) || IS_RATIONAL_ONLY(x))\n[gmpy2-2.1.0a4.p1]                              ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:64:21: note: in expansion of macro 'IS_RATIONAL'\n[gmpy2-2.1.0a4.p1]      #define IS_REAL(x) (IS_RATIONAL(x) || IS_REAL_ONLY(x))\n[gmpy2-2.1.0a4.p1]                          ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_cache.c:191:9: note: in expansion of macro 'IS_REAL'\n[gmpy2-2.1.0a4.p1]          if (IS_REAL(n)) {\n[gmpy2-2.1.0a4.p1]              ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:46:62: warning: suggest parentheses around '&&' within '||' [-Wparentheses]\n[gmpy2-2.1.0a4.p1]      #define HAS_STRICT_MPFR_CONVERSION(x) HAS_MPFR_CONVERSION(x) && \\\n[gmpy2-2.1.0a4.p1]                                                                   ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:63:63: note: in expansion of macro 'HAS_STRICT_MPFR_CONVERSION'\n[gmpy2-2.1.0a4.p1]      #define IS_REAL_ONLY(x) (MPFR_Check(x) || PyFloat_Check(x) || HAS_STRICT_MPFR_CONVERSION(x))\n[gmpy2-2.1.0a4.p1]                                                                    ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:64:39: note: in expansion of macro 'IS_REAL_ONLY'\n[gmpy2-2.1.0a4.p1]      #define IS_REAL(x) (IS_RATIONAL(x) || IS_REAL_ONLY(x))\n[gmpy2-2.1.0a4.p1]                                            ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_cache.c:191:9: note: in expansion of macro 'IS_REAL'\n[gmpy2-2.1.0a4.p1]          if (IS_REAL(n)) {\n[gmpy2-2.1.0a4.p1]              ^\n```\n",
    "created_at": "2019-03-08T18:46:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319084",
    "user": "vdelecroix"
}
```

You create a lot of warnings with the macros. This should be fixed.

```
gmpy2-2.1.0a4.p1]     src/gmpy2_cache.c: In function 'GMPy_MPZ_NewInit':
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:44:60: warning: suggest parentheses around '&&' within '||' [-Wparentheses]
[gmpy2-2.1.0a4.p1]      #define HAS_STRICT_MPZ_CONVERSION(x) HAS_MPZ_CONVERSION(x) && \
[gmpy2-2.1.0a4.p1]                                                                 ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:52:25: note: in expansion of macro 'HAS_STRICT_MPZ_CONVERSION'
[gmpy2-2.1.0a4.p1]                              HAS_STRICT_MPZ_CONVERSION(x))
[gmpy2-2.1.0a4.p1]                              ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:61:25: note: in expansion of macro 'IS_INTEGER'
[gmpy2-2.1.0a4.p1]      #define IS_RATIONAL(x) (IS_INTEGER(x) || IS_RATIONAL_ONLY(x))
[gmpy2-2.1.0a4.p1]                              ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:64:21: note: in expansion of macro 'IS_RATIONAL'
[gmpy2-2.1.0a4.p1]      #define IS_REAL(x) (IS_RATIONAL(x) || IS_REAL_ONLY(x))
[gmpy2-2.1.0a4.p1]                          ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_cache.c:191:9: note: in expansion of macro 'IS_REAL'
[gmpy2-2.1.0a4.p1]          if (IS_REAL(n)) {
[gmpy2-2.1.0a4.p1]              ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:46:62: warning: suggest parentheses around '&&' within '||' [-Wparentheses]
[gmpy2-2.1.0a4.p1]      #define HAS_STRICT_MPFR_CONVERSION(x) HAS_MPFR_CONVERSION(x) && \
[gmpy2-2.1.0a4.p1]                                                                   ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:63:63: note: in expansion of macro 'HAS_STRICT_MPFR_CONVERSION'
[gmpy2-2.1.0a4.p1]      #define IS_REAL_ONLY(x) (MPFR_Check(x) || PyFloat_Check(x) || HAS_STRICT_MPFR_CONVERSION(x))
[gmpy2-2.1.0a4.p1]                                                                    ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:64:39: note: in expansion of macro 'IS_REAL_ONLY'
[gmpy2-2.1.0a4.p1]      #define IS_REAL(x) (IS_RATIONAL(x) || IS_REAL_ONLY(x))
[gmpy2-2.1.0a4.p1]                                            ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_cache.c:191:9: note: in expansion of macro 'IS_REAL'
[gmpy2-2.1.0a4.p1]          if (IS_REAL(n)) {
[gmpy2-2.1.0a4.p1]              ^
```




---

archive/issue_comments_319085.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-03-08T18:46:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319085",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_319086.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-11T08:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319086",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_319087.json:
```json
{
    "body": "Warnings fixed.",
    "created_at": "2019-03-11T08:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319087",
    "user": "vklein"
}
```

Warnings fixed.



---

archive/issue_comments_319088.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-03-11T08:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319088",
    "user": "vklein"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_319089.json:
```json
{
    "body": "some failures...\n\n```\nDoctesting 3797 files using 14 threads.\nsage -t --long src/sage/arith/misc.py\n**********************************************************************\nFile \"src/sage/arith/misc.py\", line 3120, in sage.arith.misc.crt\nFailed example:\n    crt(mpz(2), mpz(3), mpz(7), mpz(11))\nExpected:\n    58\nGot:\n    mpz(58)\n**********************************************************************\nFile \"src/sage/arith/misc.py\", line 3122, in sage.arith.misc.crt\nFailed example:\n    crt(mpz(2), 3, mpz(7), numpy.int8(11))\nExpected:\n    58\nGot:\n    mpz(58)\n**********************************************************************\n1 item had failures:\n   2 of  37 in sage.arith.misc.crt\n    [1056 tests, 2 failures, 30.02 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/arith/misc.py  # 2 doctests failed\n----------------------------------------------------------------------\n```\n",
    "created_at": "2019-03-11T15:18:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319089",
    "user": "vdelecroix"
}
```

some failures...

```
Doctesting 3797 files using 14 threads.
sage -t --long src/sage/arith/misc.py
**********************************************************************
File "src/sage/arith/misc.py", line 3120, in sage.arith.misc.crt
Failed example:
    crt(mpz(2), mpz(3), mpz(7), mpz(11))
Expected:
    58
Got:
    mpz(58)
**********************************************************************
File "src/sage/arith/misc.py", line 3122, in sage.arith.misc.crt
Failed example:
    crt(mpz(2), 3, mpz(7), numpy.int8(11))
Expected:
    58
Got:
    mpz(58)
**********************************************************************
1 item had failures:
   2 of  37 in sage.arith.misc.crt
    [1056 tests, 2 failures, 30.02 s]
----------------------------------------------------------------------
sage -t --long src/sage/arith/misc.py  # 2 doctests failed
----------------------------------------------------------------------
```




---

archive/issue_comments_319090.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-03-11T15:18:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319090",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_319091.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-11T17:30:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319091",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_319092.json:
```json
{
    "body": "function `sage.arith.misc.crt` fixed",
    "created_at": "2019-03-11T17:32:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319092",
    "user": "vklein"
}
```

function `sage.arith.misc.crt` fixed



---

archive/issue_comments_319093.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-03-11T17:32:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319093",
    "user": "vklein"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_319094.json:
```json
{
    "body": "The patch that you called `PR217.patch` comes from two pull requests ([#217](https://github.com/aleaxit/gmpy/pull/217) and [#218](https://github.com/aleaxit/gmpy/pull/218)). You would better change the name of the patch and mention very explicitely in the header of the patch the urls of the actual pull requests.",
    "created_at": "2019-03-11T19:00:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319094",
    "user": "vdelecroix"
}
```

The patch that you called `PR217.patch` comes from two pull requests ([#217](https://github.com/aleaxit/gmpy/pull/217) and [#218](https://github.com/aleaxit/gmpy/pull/218)). You would better change the name of the patch and mention very explicitely in the header of the patch the urls of the actual pull requests.



---

archive/issue_comments_319095.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-12T07:31:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319095",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_319096.json:
```json
{
    "body": "Patch renamed and links added.",
    "created_at": "2019-03-12T07:32:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319096",
    "user": "vklein"
}
```

Patch renamed and links added.



---

archive/issue_comments_319097.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-03-12T08:47:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319097",
    "user": "vdelecroix"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_319098.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-03-14T18:13:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22815#issuecomment-319098",
    "user": "vbraun"
}
```

Resolution: fixed
