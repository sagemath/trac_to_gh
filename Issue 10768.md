# Issue 10768: faster creation of an ETuple from a list or tuple

Issue created by migration from Trac.

Original creator: pernici

Original creation time: 2011-02-23 16:03:08

Assignee: AlexGhitza

*faster creation of an ETuple from a list or tuple


---

Attachment


---

Comment by pernici created at 2011-02-23 16:18:37

With trac_10834_etuple.patch 
the creation of an ETuple from a list or tuple is faster

main is Sage-4.6 unpatched; run with processor Intel Core i7 2.80GHz

```
main
sage: from sage.rings.polynomial.polydict import ETuple
sage: a = [map(int,[i,1,-5, 3, 1,0]) for i in range(100)]
sage: %timeit map(ETuple,a)
625 loops, best of 3: 130 µs per loop

patch
625 loops, best of 3: 21.5 µs per loop
```



The `multi_polynomial_libsingular exponent` method becomes faster;
here is a benchmark taken from ticket #7587


```
main
sage: R = PolynomialRing(QQ,100,'x')
sage: p = R.random_element(degree=50,terms=50)
sage: timeit('p.exponents()')
625 loops, best of 3: 595 µs per loop
sage: timeit('p.exponents(as_ETuples=False)')
625 loops, best of 3: 78.3 µs per loop

patch
sage: R = PolynomialRing(QQ,100,'x')
sage: p = R.random_element(degree=50,terms=50)
sage: timeit('p.exponents()')
625 loops, best of 3: 119 µs per loop
sage: timeit('p.exponents(as_ETuples=False)')
625 loops, best of 3: 70.9 µs per loop
```



---

Comment by tscrim created at 2013-02-14 17:38:53

Changing status from new to needs_review.


---

Comment by tscrim created at 2013-02-14 17:38:53

I believe this patch is ready for review so I'm marking it as such, and I'm starting the review for it.


---

Comment by tscrim created at 2013-02-16 03:37:26

Changing keywords from "" to "days45".


---

Comment by tscrim created at 2013-02-16 03:37:26

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2013-02-16 03:37:26

Looks good to me.

Before patch (running `5.7.beta3`):

```
sage: %timeit ETuple([5,2,2,1])
100000 loops, best of 3: 6.4 us per loop
sage: %timeit ETuple([5,2,2,1]*20)
10000 loops, best of 3: 54.8 us per loop
sage: L = [5,2,2,1]*10000         
sage: %timeit ETuple(L)           
10 loops, best of 3: 26 ms per loop
sage: %timeit ETuple(L)
10 loops, best of 3: 24.2 ms per loop
```


After patch:

```
sage: %timeit ETuple([5,2,2,1])
100000 loops, best of 3: 3.1 us per loop
sage: %timeit ETuple([5,2,2,1]*20)
10000 loops, best of 3: 26.9 us per loop
sage: L = [5,2,2,1]*10000
sage: %timeit ETuple(L)           
100 loops, best of 3: 5.97 ms per loop
sage: %timeit ETuple(L)
100 loops, best of 3: 6.23 ms per loop
```



---

Comment by jdemeyer created at 2013-02-17 22:41:50

Resolution: fixed
