# Issue 28107: Fix some issues with submanifolds and improve their documentation

archive/issues_028107.json:
```json
{
    "body": "CC:  @florentinj @tscrim\n\nKeywords: manifold, submanifold\n\nWhen constructing a submanifold with Sage 8.8, some options are not taken into account:\n\n```\nsage: M = Manifold(3, 'M')\nsage: S = Manifold(2, 'S', ambient=M, latex_name=r'\\Sigma', start_index=1)\nsage: latex(S)\nS\nsage: S.start_index()\n0\n```\nMoreover the `start_index` parameter is not handled properly in some computational methods of class `PseudoRiemannianSubmanifold`, namely `shift()` and `second_fundamental_form()`.\n\nAnother issue regards the generation of adapted coordinates in method `TopologicalSubmanifold.adapted_chart()`: if the ambient manifold contains a caret in its name, like `E^3`, the generated variable names in `SR.var()` are not valid Python identifiers. \n\nThis ticket fixes the above issues and improves significantly the documentation of submanifolds.\n\nIssue created by migration from https://trac.sagemath.org/ticket/28344\n\n",
    "closed_at": "2019-08-19T22:08:52Z",
    "created_at": "2019-08-12T12:58:35Z",
    "labels": [
        "component: geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Fix some issues with submanifolds and improve their documentation",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28107",
    "user": "https://github.com/egourgoulhon"
}
```
CC:  @florentinj @tscrim

Keywords: manifold, submanifold

When constructing a submanifold with Sage 8.8, some options are not taken into account:

```
sage: M = Manifold(3, 'M')
sage: S = Manifold(2, 'S', ambient=M, latex_name=r'\Sigma', start_index=1)
sage: latex(S)
S
sage: S.start_index()
0
```
Moreover the `start_index` parameter is not handled properly in some computational methods of class `PseudoRiemannianSubmanifold`, namely `shift()` and `second_fundamental_form()`.

Another issue regards the generation of adapted coordinates in method `TopologicalSubmanifold.adapted_chart()`: if the ambient manifold contains a caret in its name, like `E^3`, the generated variable names in `SR.var()` are not valid Python identifiers. 

This ticket fixes the above issues and improves significantly the documentation of submanifolds.

Issue created by migration from https://trac.sagemath.org/ticket/28344





---

archive/issue_comments_396657.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-08-12T12:59:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28107#issuecomment-396657",
    "user": "https://github.com/egourgoulhon"
}
```

New commits:



---

archive/issue_comments_396658.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-08-12T13:03:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28107#issuecomment-396658",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_396659.json:
```json
{
    "body": "Some comments:\n\nMissing linebreak:\n\n```\n            raise NotImplementedError(\"mixed_projection() is implemented only \"                          \"for hypersurfaces\")\n```\nOccurs 3 times.\n\nI would probably write this as `\\cdots` since it is a multiplication operation\n\n```diff\n-            n = \\vec{*}(\\mathrm{d}x_0\\wedge\\mathrm{d}x_1\\wedge...\n+            n = \\vec{*}(\\mathrm{d}x_0\\wedge\\mathrm{d}x_1\\wedge\\ldots\n             \\wedge\\mathrm{d}x_{n-1})\n```\nbut I know some mathematicians have a convention that the only thing that is `\\cdots` is strictly usual multiplication `\\cdot`.\n\nDollar signs snuck in here:\n\n```diff\n-One can then define the embedding $\\phi_t$::\n+One can then define the embedding `\\phi_t`::\n```\n\n```diff\n-and the partial inverse expressing the foliation parameter $t$ as a scalar\n+and the partial inverse expressing the foliation parameter `t` as a scalar\n```\n\nMissing commas after the `...` (which you might consider replacing with `\\ldots`:\n\n```diff\n-        `(x_1,...,x_n,t_1,...t_{m-n})` on `M` such that `(x_1,...x_n)` are\n-        coordinates on `N` and `(t_1,...t_{m-n})` are the `m-n` free parameters\n+        `(x_1,...,x_n,t_1,...,t_{m-n})` on `M` such that `(x_1,...x_n)` are\n+        coordinates on `N` and `(t_1,...,t_{m-n})` are the `m-n` free parameters\n```\n\n```diff\n-          the names of the coordinates `(x_1,...x_n)` and of the parameters\n-          `(t_1,...t_{m-n})`. If ``None``, ``\"_\" + self.ambient()._name`` is\n+          the names of the coordinates `(x_1,...,x_n)` and of the parameters\n+          `(t_1,...,t_{m-n})`. If ``None``, ``\"_\" + self.ambient()._name`` is\n           used\n         - ``latex_postscript`` -- (default: ``None``) string defining the LaTeX\n           name of the coordinates of the adapated chart. This string will be\n-          appended to the LaTeX names of the coordinates `(x_1,...x_n)` and of\n-          the parameters `(t_1,...t_{m-n})`, If ``None``,\n+          appended to the LaTeX names of the coordinates `(x_1,...,x_n)` and of\n+          the parameters `(t_1,...,t_{m-n})`, If ``None``,\n```",
    "created_at": "2019-08-12T13:24:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28107#issuecomment-396659",
    "user": "https://github.com/tscrim"
}
```

Some comments:

Missing linebreak:

```
            raise NotImplementedError("mixed_projection() is implemented only "                          "for hypersurfaces")
```
Occurs 3 times.

I would probably write this as `\cdots` since it is a multiplication operation

```diff
-            n = \vec{*}(\mathrm{d}x_0\wedge\mathrm{d}x_1\wedge...
+            n = \vec{*}(\mathrm{d}x_0\wedge\mathrm{d}x_1\wedge\ldots
             \wedge\mathrm{d}x_{n-1})
```
but I know some mathematicians have a convention that the only thing that is `\cdots` is strictly usual multiplication `\cdot`.

Dollar signs snuck in here:

```diff
-One can then define the embedding $\phi_t$::
+One can then define the embedding `\phi_t`::
```

```diff
-and the partial inverse expressing the foliation parameter $t$ as a scalar
+and the partial inverse expressing the foliation parameter `t` as a scalar
```

Missing commas after the `...` (which you might consider replacing with `\ldots`:

```diff
-        `(x_1,...,x_n,t_1,...t_{m-n})` on `M` such that `(x_1,...x_n)` are
-        coordinates on `N` and `(t_1,...t_{m-n})` are the `m-n` free parameters
+        `(x_1,...,x_n,t_1,...,t_{m-n})` on `M` such that `(x_1,...x_n)` are
+        coordinates on `N` and `(t_1,...,t_{m-n})` are the `m-n` free parameters
```

```diff
-          the names of the coordinates `(x_1,...x_n)` and of the parameters
-          `(t_1,...t_{m-n})`. If ``None``, ``"_" + self.ambient()._name`` is
+          the names of the coordinates `(x_1,...,x_n)` and of the parameters
+          `(t_1,...,t_{m-n})`. If ``None``, ``"_" + self.ambient()._name`` is
           used
         - ``latex_postscript`` -- (default: ``None``) string defining the LaTeX
           name of the coordinates of the adapated chart. This string will be
-          appended to the LaTeX names of the coordinates `(x_1,...x_n)` and of
-          the parameters `(t_1,...t_{m-n})`, If ``None``,
+          appended to the LaTeX names of the coordinates `(x_1,...,x_n)` and of
+          the parameters `(t_1,...,t_{m-n})`, If ``None``,
```



---

archive/issue_comments_396660.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-13T22:20:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28107#issuecomment-396660",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396661.json:
```json
{
    "body": "Replying to [comment:3 tscrim]:\n> Some comments:\n\n\nThanks for yours comments (and prompt reply!). The above commit takes them into account.",
    "created_at": "2019-08-13T22:23:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28107#issuecomment-396661",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:3 tscrim]:
> Some comments:


Thanks for yours comments (and prompt reply!). The above commit takes them into account.



---

archive/issue_comments_396662.json:
```json
{
    "body": "Thank you.",
    "created_at": "2019-08-16T22:53:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28107#issuecomment-396662",
    "user": "https://github.com/tscrim"
}
```

Thank you.



---

archive/issue_comments_396663.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-08-16T22:53:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28107#issuecomment-396663",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_396664.json:
```json
{
    "body": "Many thanks for the review!",
    "created_at": "2019-08-17T09:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28107#issuecomment-396664",
    "user": "https://github.com/egourgoulhon"
}
```

Many thanks for the review!



---

archive/issue_events_070784.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-08-19T22:08:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28107",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28107#event-70784"
}
```



---

archive/issue_comments_396665.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-08-19T22:08:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28107#issuecomment-396665",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
