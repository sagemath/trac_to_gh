# Issue 18703: Polynomials ignore the step argument in __getitem__

archive/issues_018703.json:
```json
{
    "body": "Sage should support a `step` different from 1 in the `__getitem__()` method of polynomials:\n\n```\nsage: R.<x> = ZZ[]\nsage: f = sum(x^j for j in range(5))\nsage: f\nx^4 + x^3 + x^2 + x + 1\nsage: f[-2:4:2]\nx^3 + x^2 + x + 1  # should be x^2 + 1\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/18940\n\n",
    "created_at": "2015-07-22T20:28:09Z",
    "labels": [
        "algebra",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.0",
    "title": "Polynomials ignore the step argument in __getitem__",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18703",
    "user": "pbruin"
}
```
Sage should support a `step` different from 1 in the `__getitem__()` method of polynomials:

```
sage: R.<x> = ZZ[]
sage: f = sum(x^j for j in range(5))
sage: f
x^4 + x^3 + x^2 + x + 1
sage: f[-2:4:2]
x^3 + x^2 + x + 1  # should be x^2 + 1
```


Issue created by migration from https://trac.sagemath.org/ticket/18940





---

archive/issue_comments_255134.json:
```json
{
    "body": "Fixing this for all polynomials is somewhat involved because every polynomial class defines its own `__getitem__()` method.  The following 14 methods are relevant (line numbers for SageMath 6.8.rc0):\n\n```\nlaurent_polynomial.pyx:321:    def __getitem__(self, i):\npadics/polynomial_padic_capped_relative_dense.py:381:    def __getitem__(self, n):\npolynomial_element_generic.py:300:    def __getitem__(self,n):\npolynomial_element.pyx:7608:    def __getitem__(self, n):\npolynomial_gf2x.pyx:64:    def __getitem__(self, i):\npolynomial_integer_dense_flint.pyx:415:    def __getitem__(self, n):\npolynomial_integer_dense_ntl.pyx:284:    def __getitem__(self, n):\npolynomial_modn_dense_ntl.pyx:180:    def __getitem__(self, n):\npolynomial_modn_dense_ntl.pyx:658:    def __getitem__(self, n):\npolynomial_modn_dense_ntl.pyx:1223:    def __getitem__(self, n):\npolynomial_rational_flint.pyx:379:    def __getitem__(self, n):\npolynomial_real_mpfr_dense.pyx:183:    def __getitem__(self, ix):\npolynomial_zmod_flint.pyx:231:    def __getitem__(self, i):\npolynomial_zz_pex.pyx:151:    def __getitem__(self,i):\n```\n",
    "created_at": "2015-07-22T21:49:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255134",
    "user": "pbruin"
}
```

Fixing this for all polynomials is somewhat involved because every polynomial class defines its own `__getitem__()` method.  The following 14 methods are relevant (line numbers for SageMath 6.8.rc0):

```
laurent_polynomial.pyx:321:    def __getitem__(self, i):
padics/polynomial_padic_capped_relative_dense.py:381:    def __getitem__(self, n):
polynomial_element_generic.py:300:    def __getitem__(self,n):
polynomial_element.pyx:7608:    def __getitem__(self, n):
polynomial_gf2x.pyx:64:    def __getitem__(self, i):
polynomial_integer_dense_flint.pyx:415:    def __getitem__(self, n):
polynomial_integer_dense_ntl.pyx:284:    def __getitem__(self, n):
polynomial_modn_dense_ntl.pyx:180:    def __getitem__(self, n):
polynomial_modn_dense_ntl.pyx:658:    def __getitem__(self, n):
polynomial_modn_dense_ntl.pyx:1223:    def __getitem__(self, n):
polynomial_rational_flint.pyx:379:    def __getitem__(self, n):
polynomial_real_mpfr_dense.pyx:183:    def __getitem__(self, ix):
polynomial_zmod_flint.pyx:231:    def __getitem__(self, i):
polynomial_zz_pex.pyx:151:    def __getitem__(self,i):
```




---

archive/issue_comments_255135.json:
```json
{
    "body": "For matrices and vectors, this is done using `get_unsafe()` which is the implementation of `a[i]` for one index `i`. Then the slicing is done by a generic `__getitem__` function.",
    "created_at": "2015-07-23T08:03:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255135",
    "user": "jdemeyer"
}
```

For matrices and vectors, this is done using `get_unsafe()` which is the implementation of `a[i]` for one index `i`. Then the slicing is done by a generic `__getitem__` function.



---

archive/issue_comments_255136.json:
```json
{
    "body": "Replying to [comment:2 jdemeyer]:\n> For matrices and vectors, this is done using `get_unsafe()` which is the implementation of `a[i]` for one index `i`. Then the slicing is done by a generic `__getitem__` function.\nI implemented this suggestion, now testing.",
    "created_at": "2015-10-14T20:50:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255136",
    "user": "pbruin"
}
```

Replying to [comment:2 jdemeyer]:
> For matrices and vectors, this is done using `get_unsafe()` which is the implementation of `a[i]` for one index `i`. Then the slicing is done by a generic `__getitem__` function.
I implemented this suggestion, now testing.



---

archive/issue_comments_255137.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-10-14T21:20:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255137",
    "user": "pbruin"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_255138.json:
```json
{
    "body": "I might review this once the dependency is merged.",
    "created_at": "2015-10-16T11:31:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255138",
    "user": "jdemeyer"
}
```

I might review this once the dependency is merged.



---

archive/issue_comments_255139.json:
```json
{
    "body": "Just a remark: did you have a look at [PySlice_GetIndicesEx](https://docs.python.org/2/c-api/slice.html#c.PySlice_GetIndicesEx)? That might be used to avoid slice arithmetic like\n\n```diff\n+            start, stop, step = n.start, n.stop, n.step\n+            if step is None:\n+                step = 1\n+            if start is None:\n+                start = 0\n+            elif start < 0:\n+                start %= step\n+            if stop is None or stop > d:\n+                stop = d\n```\n",
    "created_at": "2015-10-16T11:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255139",
    "user": "jdemeyer"
}
```

Just a remark: did you have a look at [PySlice_GetIndicesEx](https://docs.python.org/2/c-api/slice.html#c.PySlice_GetIndicesEx)? That might be used to avoid slice arithmetic like

```diff
+            start, stop, step = n.start, n.stop, n.step
+            if step is None:
+                step = 1
+            if start is None:
+                start = 0
+            elif start < 0:
+                start %= step
+            if stop is None or stop > d:
+                stop = d
```




---

archive/issue_comments_255140.json:
```json
{
    "body": "Replying to [comment:7 jdemeyer]:\n> Just a remark: did you have a look at [PySlice_GetIndicesEx](https://docs.python.org/2/c-api/slice.html#c.PySlice_GetIndicesEx)?\nI tried this, but unfortunately it does not return the correct indices for polynomials.  For example, it wraps around negative `start` values (as in the Python convention that `L[-1]` with `L` a list returns the last item in `L`); this is incompatible with Sage's convention that `P[n]` returns 0 if `P` is a polynomial and `n < 0`.",
    "created_at": "2015-10-16T12:01:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255140",
    "user": "pbruin"
}
```

Replying to [comment:7 jdemeyer]:
> Just a remark: did you have a look at [PySlice_GetIndicesEx](https://docs.python.org/2/c-api/slice.html#c.PySlice_GetIndicesEx)?
I tried this, but unfortunately it does not return the correct indices for polynomials.  For example, it wraps around negative `start` values (as in the Python convention that `L[-1]` with `L` a list returns the last item in `L`); this is incompatible with Sage's convention that `P[n]` returns 0 if `P` is a polynomial and `n < 0`.



---

archive/issue_comments_255141.json:
```json
{
    "body": "Replying to [comment:8 pbruin]:\n> Replying to [comment:7 jdemeyer]:\n> > Just a remark: did you have a look at [PySlice_GetIndicesEx](https://docs.python.org/2/c-api/slice.html#c.PySlice_GetIndicesEx)?\n> I tried this, but unfortunately it does not return the correct indices for polynomials.  For example, it wraps around negative `start` values (as in the Python convention that `L[-1]` with `L` a list returns the last item in `L`); this is incompatible with Sage's convention that `P[n]` returns 0 if `P` is a polynomial and `n < 0`.\n\nI think this behavior should be documented: I'd add a `Warning` block to the documentation to specify that it doesn't (and cannot!) respect Python convention. This may be obvious for Laurent polynomials, but it is not clear for polynomials.",
    "created_at": "2015-10-26T13:54:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255141",
    "user": "bruno"
}
```

Replying to [comment:8 pbruin]:
> Replying to [comment:7 jdemeyer]:
> > Just a remark: did you have a look at [PySlice_GetIndicesEx](https://docs.python.org/2/c-api/slice.html#c.PySlice_GetIndicesEx)?
> I tried this, but unfortunately it does not return the correct indices for polynomials.  For example, it wraps around negative `start` values (as in the Python convention that `L[-1]` with `L` a list returns the last item in `L`); this is incompatible with Sage's convention that `P[n]` returns 0 if `P` is a polynomial and `n < 0`.

I think this behavior should be documented: I'd add a `Warning` block to the documentation to specify that it doesn't (and cannot!) respect Python convention. This may be obvious for Laurent polynomials, but it is not clear for polynomials.



---

archive/issue_comments_255142.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-10-26T13:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255142",
    "user": "bruno"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_255143.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-27T16:58:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255143",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255144.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-10-27T17:01:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255144",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_255145.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-10-27T17:03:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255145",
    "user": "pbruin"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_255146.json:
```json
{
    "body": "Replying to [comment:9 bruno]:\n> Replying to [comment:8 pbruin]:\n> > Replying to [comment:7 jdemeyer]:\n> > > Just a remark: did you have a look at [PySlice_GetIndicesEx](https://docs.python.org/2/c-api/slice.html#c.PySlice_GetIndicesEx)?\n> > I tried this, but unfortunately it does not return the correct indices for polynomials.  For example, it wraps around negative `start` values (as in the Python convention that `L[-1]` with `L` a list returns the last item in `L`); this is incompatible with Sage's convention that `P[n]` returns 0 if `P` is a polynomial and `n < 0`.\n> \n> I think this behavior should be documented: I'd add a `Warning` block to the documentation to specify that it doesn't (and cannot!) respect Python convention. This may be obvious for Laurent polynomials, but it is not clear for polynomials.\nOK, I added a warning and an example for this.\n\nAlso, in the meantime I realised that `step <= 0` is (1) not necessarily well-defined, and (2) may cause Sage to crash with the current implementation.  I added a few lines to detect this case and raise an `IndexError`.",
    "created_at": "2015-10-27T17:03:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255146",
    "user": "pbruin"
}
```

Replying to [comment:9 bruno]:
> Replying to [comment:8 pbruin]:
> > Replying to [comment:7 jdemeyer]:
> > > Just a remark: did you have a look at [PySlice_GetIndicesEx](https://docs.python.org/2/c-api/slice.html#c.PySlice_GetIndicesEx)?
> > I tried this, but unfortunately it does not return the correct indices for polynomials.  For example, it wraps around negative `start` values (as in the Python convention that `L[-1]` with `L` a list returns the last item in `L`); this is incompatible with Sage's convention that `P[n]` returns 0 if `P` is a polynomial and `n < 0`.
> 
> I think this behavior should be documented: I'd add a `Warning` block to the documentation to specify that it doesn't (and cannot!) respect Python convention. This may be obvious for Laurent polynomials, but it is not clear for polynomials.
OK, I added a warning and an example for this.

Also, in the meantime I realised that `step <= 0` is (1) not necessarily well-defined, and (2) may cause Sage to crash with the current implementation.  I added a few lines to detect this case and raise an `IndexError`.



---

archive/issue_comments_255147.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-30T14:53:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255147",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255148.json:
```json
{
    "body": "For some classes, you still reimplement `__getitem__` for slices. Why is that? Why cannot you always use the generic implementation for slicing?",
    "created_at": "2015-11-02T09:07:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255148",
    "user": "jdemeyer"
}
```

For some classes, you still reimplement `__getitem__` for slices. Why is that? Why cannot you always use the generic implementation for slicing?



---

archive/issue_comments_255149.json:
```json
{
    "body": "Why not allow `step < 0`? Actually, I think that `step = -1` might be the most mathematically useful value of `step`.",
    "created_at": "2015-11-02T09:14:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255149",
    "user": "jdemeyer"
}
```

Why not allow `step < 0`? Actually, I think that `step = -1` might be the most mathematically useful value of `step`.



---

archive/issue_comments_255150.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2015-11-02T09:43:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255150",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_255151.json:
```json
{
    "body": "Are you sure that the current behaviour is really what we want?\n\n```\nsage: pol = PolynomialRing(QQ, 'x')(range(10))\nsage: pol\n9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2 + x\nsage: pol[2:]\n9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2\n```\n\nI would have expected\n\n```\nsage: pol[2:]\n9*x^7 + 8*x^6 + 7*x^5 + 6*x^4 + 5*x^3 + 4*x^2 + 3*x + 2\n```\n\n\nI know that this branch just extends the current behaviour. However, I think we need to step back and define mathematically what should be returned when asking for `pol[a:b:c]`. The current definition is not very useful.\n\nI think that `list(pol[a:b:c])` should be the same as `list(pol)[a:b:c]`, except for different rules when the range is outside of `0 ... pol.degree()`.",
    "created_at": "2015-11-02T09:43:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255151",
    "user": "jdemeyer"
}
```

Are you sure that the current behaviour is really what we want?

```
sage: pol = PolynomialRing(QQ, 'x')(range(10))
sage: pol
9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2 + x
sage: pol[2:]
9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2
```

I would have expected

```
sage: pol[2:]
9*x^7 + 8*x^6 + 7*x^5 + 6*x^4 + 5*x^3 + 4*x^2 + 3*x + 2
```


I know that this branch just extends the current behaviour. However, I think we need to step back and define mathematically what should be returned when asking for `pol[a:b:c]`. The current definition is not very useful.

I think that `list(pol[a:b:c])` should be the same as `list(pol)[a:b:c]`, except for different rules when the range is outside of `0 ... pol.degree()`.



---

archive/issue_comments_255152.json:
```json
{
    "body": "Peter, what's your use-case for `pol[a:b:c]`, i.e. why did you create this ticket?",
    "created_at": "2015-11-02T09:53:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255152",
    "user": "jdemeyer"
}
```

Peter, what's your use-case for `pol[a:b:c]`, i.e. why did you create this ticket?



---

archive/issue_comments_255153.json:
```json
{
    "body": "For the record, the current definition of `pol[a:b]` was introduced with\n\n```\ncommit ff63a1c2b5798a777dcef6a4366a43dc60a6bebd\nAuthor: William Stein <wstein@gmail.com>\nDate:   Fri Jan 26 02:42:10 2007 -0800\n\n    A huge amount -- starting with writing tons of doctests for power series, pyrex integer_ring, etc.\n    \n        * changed before of polynomial and power series slicing to return objects of the same type,\n          which is much more consistent.\n        * optimized integer constructor\n        * improved random number generation (e.g., ZZ.random_element()) ten times faster and more\n          flexible.\n        * separated out pmem_malloc\n```\n",
    "created_at": "2015-11-02T10:05:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255153",
    "user": "jdemeyer"
}
```

For the record, the current definition of `pol[a:b]` was introduced with

```
commit ff63a1c2b5798a777dcef6a4366a43dc60a6bebd
Author: William Stein <wstein@gmail.com>
Date:   Fri Jan 26 02:42:10 2007 -0800

    A huge amount -- starting with writing tons of doctests for power series, pyrex integer_ring, etc.
    
        * changed before of polynomial and power series slicing to return objects of the same type,
          which is much more consistent.
        * optimized integer constructor
        * improved random number generation (e.g., ZZ.random_element()) ten times faster and more
          flexible.
        * separated out pmem_malloc
```




---

archive/issue_comments_255154.json:
```json
{
    "body": "We currently have\n\n```\nsage: R.<x> = QQ[]\nsage: p = R.random_element((-1, 10)); p\n-2/3*x^10 + 3/2*x^9 - 1/2*x^8 + 10*x^7 + x^6 + 3/2*x^5 + 1/3*x^4 + 5/2*x^3 - x^2 + 29*x - 1\nsage: list(p)\n[-1, 29, -1, 5/2, 1/3, 3/2, 1, 10, -1/2, 3/2, -2/3]\n```\n\nSo `list` does go low to high and the current behavior is consistent with converting to a list.\n\n+1 for supporting negative steps.",
    "created_at": "2015-11-02T16:09:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255154",
    "user": "tscrim"
}
```

We currently have

```
sage: R.<x> = QQ[]
sage: p = R.random_element((-1, 10)); p
-2/3*x^10 + 3/2*x^9 - 1/2*x^8 + 10*x^7 + x^6 + 3/2*x^5 + 1/3*x^4 + 5/2*x^3 - x^2 + 29*x - 1
sage: list(p)
[-1, 29, -1, 5/2, 1/3, 3/2, 1, 10, -1/2, 3/2, -2/3]
```

So `list` does go low to high and the current behavior is consistent with converting to a list.

+1 for supporting negative steps.



---

archive/issue_comments_255155.json:
```json
{
    "body": "Replying to [comment:20 tscrim]:\n> the current behavior is consistent with converting to a list.\n\nWhat do you mean? I think that these two outputs should be equal:\n\n```\nsage: pol = PolynomialRing(QQ, 'x')(range(10))\nsage: list(pol[5:])\n[0, 0, 0, 0, 0, 5, 6, 7, 8, 9]\nsage: list(pol)[5:]\n[5, 6, 7, 8, 9]\n```\n",
    "created_at": "2015-11-02T16:14:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255155",
    "user": "jdemeyer"
}
```

Replying to [comment:20 tscrim]:
> the current behavior is consistent with converting to a list.

What do you mean? I think that these two outputs should be equal:

```
sage: pol = PolynomialRing(QQ, 'x')(range(10))
sage: list(pol[5:])
[0, 0, 0, 0, 0, 5, 6, 7, 8, 9]
sage: list(pol)[5:]
[5, 6, 7, 8, 9]
```




---

archive/issue_comments_255156.json:
```json
{
    "body": "Ah, I see what you mean. I'm sorry, I didn't read your example closely enough and though you were truncating off the 2 leading terms.\n\nHowever, list and slice already don't commute because of the python wrap around, so I'm not so sure on how much we should enforce the exact same behavior (granted, an error gets raised in the polynomial case). I personally would find that the degree was lowered more surprising if we still wanted slices to return polynomials as opposed to a list of the coefficients. Yet I don't really have much invested in this.",
    "created_at": "2015-11-02T17:54:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255156",
    "user": "tscrim"
}
```

Ah, I see what you mean. I'm sorry, I didn't read your example closely enough and though you were truncating off the 2 leading terms.

However, list and slice already don't commute because of the python wrap around, so I'm not so sure on how much we should enforce the exact same behavior (granted, an error gets raised in the polynomial case). I personally would find that the degree was lowered more surprising if we still wanted slices to return polynomials as opposed to a list of the coefficients. Yet I don't really have much invested in this.



---

archive/issue_comments_255157.json:
```json
{
    "body": "Replying to [comment:22 tscrim]:\n> I personally would find that the degree was lowered more surprising\nSo what's in your opinion the correct answer for\n\n```\nsage: pol = PolynomialRing(QQ, 'x')(range(10))\nsage: list(pol[2::2])\n```\n\n\nIf we cannot agree on a \"natural\" definition for `pol[a:b:c]`, perhaps the best compromise is simply\n\n```\nif isinstance(i, slice):\n    raise NotImplementedError(\"polynomial slicing is not defined\")\n```\n",
    "created_at": "2015-11-02T18:14:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255157",
    "user": "jdemeyer"
}
```

Replying to [comment:22 tscrim]:
> I personally would find that the degree was lowered more surprising
So what's in your opinion the correct answer for

```
sage: pol = PolynomialRing(QQ, 'x')(range(10))
sage: list(pol[2::2])
```


If we cannot agree on a "natural" definition for `pol[a:b:c]`, perhaps the best compromise is simply

```
if isinstance(i, slice):
    raise NotImplementedError("polynomial slicing is not defined")
```




---

archive/issue_comments_255158.json:
```json
{
    "body": "Replying to [comment:23 jdemeyer]:\n> Replying to [comment:22 tscrim]:\n> > I personally would find that the degree was lowered more surprising\n> So what's in your opinion the correct answer for\n> {{{\n> sage: pol = PolynomialRing(QQ, 'x')(range(10))\n> sage: list(pol[2::2])\n> }}}\n\nThat depends on if we want a slice of a polynomial returns a polynomial or a simple list of the coefficients. I am (very) slightly in favor of returning a polynomial, so with that `[0, 2, 4, 6, 8]`.\n\n> If we cannot agree on a \"natural\" definition for `pol[a:b:c]`, perhaps the best compromise is simply\n> {{{\n> if isinstance(i, slice):\n>     raise NotImplementedError(\"polynomial slicing is not defined\")\n> }}}\n\nThis would be okay with me as well, but I don't think my opinion here should weigh very much here because I am mostly ambivalent about this behavior since I don't have a use for it.",
    "created_at": "2015-11-02T18:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255158",
    "user": "tscrim"
}
```

Replying to [comment:23 jdemeyer]:
> Replying to [comment:22 tscrim]:
> > I personally would find that the degree was lowered more surprising
> So what's in your opinion the correct answer for
> {{{
> sage: pol = PolynomialRing(QQ, 'x')(range(10))
> sage: list(pol[2::2])
> }}}

That depends on if we want a slice of a polynomial returns a polynomial or a simple list of the coefficients. I am (very) slightly in favor of returning a polynomial, so with that `[0, 2, 4, 6, 8]`.

> If we cannot agree on a "natural" definition for `pol[a:b:c]`, perhaps the best compromise is simply
> {{{
> if isinstance(i, slice):
>     raise NotImplementedError("polynomial slicing is not defined")
> }}}

This would be okay with me as well, but I don't think my opinion here should weigh very much here because I am mostly ambivalent about this behavior since I don't have a use for it.



---

archive/issue_comments_255159.json:
```json
{
    "body": "Replying to [comment:24 tscrim]:\n> That depends on if we want a slice of a polynomial returns a polynomial or a simple list of the coefficients. I am (very) slightly in favor of returning a polynomial, so with that `[0, 2, 4, 6, 8]`.\n\nSorry, I asked a bad question so I cannot interpret your answer. Please try again with this question:\n\n```\nsage: pol = PolynomialRing(QQ, 'x')(range(1,10))\nsage: list(pol[3::2])\n```\n",
    "created_at": "2015-11-02T18:41:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255159",
    "user": "jdemeyer"
}
```

Replying to [comment:24 tscrim]:
> That depends on if we want a slice of a polynomial returns a polynomial or a simple list of the coefficients. I am (very) slightly in favor of returning a polynomial, so with that `[0, 2, 4, 6, 8]`.

Sorry, I asked a bad question so I cannot interpret your answer. Please try again with this question:

```
sage: pol = PolynomialRing(QQ, 'x')(range(1,10))
sage: list(pol[3::2])
```




---

archive/issue_comments_255160.json:
```json
{
    "body": "Replying to [comment:25 jdemeyer]:\n> Replying to [comment:24 tscrim]:\n> > That depends on if we want a slice of a polynomial returns a polynomial or a simple list of the coefficients. I am (very) slightly in favor of returning a polynomial, so with that `[0, 2, 4, 6, 8]`.\n> \n> Sorry, I asked a bad question so I cannot interpret your answer. Please try again with this question:\n> {{{\n> sage: pol = PolynomialRing(QQ, 'x')(range(1,10))\n> sage: list(pol[3::2])\n> }}}\nI would want this:\n\n```\nsage: list(pol[3::2])\n[0, 0, 0, 4, 0, 6, 0, 8]\n```\n\nActually, my answer above was wrong and shouw be `[0, 0, 2, 0, 4, 0, 6, 0, 8]`. [Edit - Some changes due to me not thinking things completely through]\n\nHowever, when trying to think about how this would work for Laurent polynomials, we currently have this behavior for `list`:\n\n```\nsage: R.<x> = LaurentPolynomialRing(QQ)\nsage: p = ~x + 2 + 3*x + 4*x^2\nsage: list(p)\n[1, 2, 3, 4]\nsage: p = 3*x + 4*x^2\nsage: list(p)\n[3, 4]\n```\n\nIn some ways I would say the iterator for polynomials should be changed to agree with that of Laurent polynomials, in that it starts from the lowest degree. Although I understand there are many (good) reasons why we do not want that behavior. I feel that at some point we just have to choose the least bad of all options and then put up warning messages about our choices.",
    "created_at": "2015-11-02T18:52:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255160",
    "user": "tscrim"
}
```

Replying to [comment:25 jdemeyer]:
> Replying to [comment:24 tscrim]:
> > That depends on if we want a slice of a polynomial returns a polynomial or a simple list of the coefficients. I am (very) slightly in favor of returning a polynomial, so with that `[0, 2, 4, 6, 8]`.
> 
> Sorry, I asked a bad question so I cannot interpret your answer. Please try again with this question:
> {{{
> sage: pol = PolynomialRing(QQ, 'x')(range(1,10))
> sage: list(pol[3::2])
> }}}
I would want this:

```
sage: list(pol[3::2])
[0, 0, 0, 4, 0, 6, 0, 8]
```

Actually, my answer above was wrong and shouw be `[0, 0, 2, 0, 4, 0, 6, 0, 8]`. [Edit - Some changes due to me not thinking things completely through]

However, when trying to think about how this would work for Laurent polynomials, we currently have this behavior for `list`:

```
sage: R.<x> = LaurentPolynomialRing(QQ)
sage: p = ~x + 2 + 3*x + 4*x^2
sage: list(p)
[1, 2, 3, 4]
sage: p = 3*x + 4*x^2
sage: list(p)
[3, 4]
```

In some ways I would say the iterator for polynomials should be changed to agree with that of Laurent polynomials, in that it starts from the lowest degree. Although I understand there are many (good) reasons why we do not want that behavior. I feel that at some point we just have to choose the least bad of all options and then put up warning messages about our choices.



---

archive/issue_comments_255161.json:
```json
{
    "body": "Replying to [comment:26 tscrim]:\n> I would want this:\n> {{{\n> sage: list(pol[3::2])\n> [0, 0, 0, 4, 0, 6, 0, 8]\n> }}}\nInteresting. This is indeed what this branch does, but it doesn't correspond with my intuition about what it should do (I would expect `[4, 6, 8]`).",
    "created_at": "2015-11-02T19:02:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255161",
    "user": "jdemeyer"
}
```

Replying to [comment:26 tscrim]:
> I would want this:
> {{{
> sage: list(pol[3::2])
> [0, 0, 0, 4, 0, 6, 0, 8]
> }}}
Interesting. This is indeed what this branch does, but it doesn't correspond with my intuition about what it should do (I would expect `[4, 6, 8]`).



---

archive/issue_comments_255162.json:
```json
{
    "body": "Replying to [comment:18 jdemeyer]:\n> Peter, what's your use-case for `pol[a:b:c]`, i.e. why did you create this ticket?\nBecause of comments 22, 25 and 26 on ticket #15601.",
    "created_at": "2015-11-02T19:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255162",
    "user": "pbruin"
}
```

Replying to [comment:18 jdemeyer]:
> Peter, what's your use-case for `pol[a:b:c]`, i.e. why did you create this ticket?
Because of comments 22, 25 and 26 on ticket #15601.



---

archive/issue_comments_255163.json:
```json
{
    "body": "Replying to [comment:17 jdemeyer]:\n> Are you sure that the current behaviour is really what we want?\n> {{{\n> sage: pol = PolynomialRing(QQ, 'x')(range(10))\n> sage: pol\n> 9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2 + x\n> sage: pol[2:]\n> 9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2\n> }}}\nYes.  The fact that polynomials are usually written with decreasing exponents is just a historical convention.  I think it is absolutely reasonable that `pol[2:]` should return the monomials of degree 2 and higher, whether as a polynomial or as a list.  And in fact\n\n```\nsage: list(pol)\n[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n```\n\nso doing `list(pol)[2:]` also extracts the coefficients of the monomials of degree at least 2.\n\nSimilarly, in PARI, my experience is that `Vecrev` (which does the equivalent of `list` above) is more useful than `Vec` to extract the list of coefficients of a polynomial.",
    "created_at": "2015-11-02T19:53:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255163",
    "user": "pbruin"
}
```

Replying to [comment:17 jdemeyer]:
> Are you sure that the current behaviour is really what we want?
> {{{
> sage: pol = PolynomialRing(QQ, 'x')(range(10))
> sage: pol
> 9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2 + x
> sage: pol[2:]
> 9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2
> }}}
Yes.  The fact that polynomials are usually written with decreasing exponents is just a historical convention.  I think it is absolutely reasonable that `pol[2:]` should return the monomials of degree 2 and higher, whether as a polynomial or as a list.  And in fact

```
sage: list(pol)
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
```

so doing `list(pol)[2:]` also extracts the coefficients of the monomials of degree at least 2.

Similarly, in PARI, my experience is that `Vecrev` (which does the equivalent of `list` above) is more useful than `Vec` to extract the list of coefficients of a polynomial.



---

archive/issue_comments_255164.json:
```json
{
    "body": "Replying to [comment:21 jdemeyer]:\n> Replying to [comment:20 tscrim]:\n> > the current behavior is consistent with converting to a list.\n> \n> What do you mean? I think that these two outputs should be equal:\n> {{{\n> sage: pol = PolynomialRing(QQ, 'x')(range(10))\n> sage: list(pol[5:])\n> [0, 0, 0, 0, 0, 5, 6, 7, 8, 9]\n> sage: list(pol)[5:]\n> [5, 6, 7, 8, 9]\n> }}}\nWhat would you want the output of `pol[5:]` itself to be?",
    "created_at": "2015-11-02T19:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255164",
    "user": "pbruin"
}
```

Replying to [comment:21 jdemeyer]:
> Replying to [comment:20 tscrim]:
> > the current behavior is consistent with converting to a list.
> 
> What do you mean? I think that these two outputs should be equal:
> {{{
> sage: pol = PolynomialRing(QQ, 'x')(range(10))
> sage: list(pol[5:])
> [0, 0, 0, 0, 0, 5, 6, 7, 8, 9]
> sage: list(pol)[5:]
> [5, 6, 7, 8, 9]
> }}}
What would you want the output of `pol[5:]` itself to be?



---

archive/issue_comments_255165.json:
```json
{
    "body": "Replying to [comment:16 jdemeyer]:\n> Why not allow `step < 0`? Actually, I think that `step = -1` might be the most mathematically useful value of `step`.\nWe already have the `reverse()` method for that.  I can think of two possible results for `pol[a:b:-1]`, one of which would be the `reverse()` of the other.  I am afraid allowing `step = -1` would only create confusion...",
    "created_at": "2015-11-02T19:58:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255165",
    "user": "pbruin"
}
```

Replying to [comment:16 jdemeyer]:
> Why not allow `step < 0`? Actually, I think that `step = -1` might be the most mathematically useful value of `step`.
We already have the `reverse()` method for that.  I can think of two possible results for `pol[a:b:-1]`, one of which would be the `reverse()` of the other.  I am afraid allowing `step = -1` would only create confusion...



---

archive/issue_comments_255166.json:
```json
{
    "body": "Mathematically, I can certainly imagine wanting the part of the polynomial between degrees 2 and 5: I might want this:\n\n```\nsage: f\n-10*x^6 + 1/2*x^5 - x^4 + 7*x^3 - 2*x^2 + x - 3\nsage: f[2:6]\n1/2*x^5 - x^4 + 7*x^3 - 2*x^2\n```\n\nI don't know if I would ever want `f[2:6]` to return the polynomial with same coefficients but translated down in degree (i.e., `1/2*x^3 - x^2 + 7*x - 2`). Computationally, though, if I have that second result, I can easily get back to the first one by multiplying by `x^2`. If I have the first, I can get to the second by dividing, but that puts the result in the fraction field, which is probably not what I want. Alternatively, I can also get to the second by creating a polynomial from `list(f)[2:6]`, which is not as intuitive, but not too hard.\n\nSurely different mathematicians will have different points of view on this.\n\nI think this is the issue for me: do we want\n\n```\nsage: list(pol[5:]) == list(pol)[5:]\nTrue\n```\n\nor do we want\n\n```\nsage: pol[:5] + pol[5:] == pol\nTrue\n```\n\nWe can't have both, right? I prefer the second. That is, I tend to think of polynomials as graded objects and slicing is returning some of their homogeneous components, and it seems most natural to do this without regrading the result: if a term is in degree 3 in the original polynomial, it should still be in degree 3 after slicing. I would also like this:\n\n```\nsage: pol[0:10:2] + pol[1:10:2] == pol[0:10]\nTrue\n```\n\nAdding the even terms to the odd terms should yield the original polynomial.\n\nA related question: should `f[2]` return `-2` or `-2 * x^2`?\n\n-----------\n\nWhen it comes down to it, I'm not sure I care which option is implemented as `__getitem__`, but perhaps both should be implemented as methods which are visible via tab-completion, or as a single method with a keyword which determines which option to use.",
    "created_at": "2015-11-02T21:40:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255166",
    "user": "jhpalmieri"
}
```

Mathematically, I can certainly imagine wanting the part of the polynomial between degrees 2 and 5: I might want this:

```
sage: f
-10*x^6 + 1/2*x^5 - x^4 + 7*x^3 - 2*x^2 + x - 3
sage: f[2:6]
1/2*x^5 - x^4 + 7*x^3 - 2*x^2
```

I don't know if I would ever want `f[2:6]` to return the polynomial with same coefficients but translated down in degree (i.e., `1/2*x^3 - x^2 + 7*x - 2`). Computationally, though, if I have that second result, I can easily get back to the first one by multiplying by `x^2`. If I have the first, I can get to the second by dividing, but that puts the result in the fraction field, which is probably not what I want. Alternatively, I can also get to the second by creating a polynomial from `list(f)[2:6]`, which is not as intuitive, but not too hard.

Surely different mathematicians will have different points of view on this.

I think this is the issue for me: do we want

```
sage: list(pol[5:]) == list(pol)[5:]
True
```

or do we want

```
sage: pol[:5] + pol[5:] == pol
True
```

We can't have both, right? I prefer the second. That is, I tend to think of polynomials as graded objects and slicing is returning some of their homogeneous components, and it seems most natural to do this without regrading the result: if a term is in degree 3 in the original polynomial, it should still be in degree 3 after slicing. I would also like this:

```
sage: pol[0:10:2] + pol[1:10:2] == pol[0:10]
True
```

Adding the even terms to the odd terms should yield the original polynomial.

A related question: should `f[2]` return `-2` or `-2 * x^2`?

-----------

When it comes down to it, I'm not sure I care which option is implemented as `__getitem__`, but perhaps both should be implemented as methods which are visible via tab-completion, or as a single method with a keyword which determines which option to use.



---

archive/issue_comments_255167.json:
```json
{
    "body": "Replying to [comment:28 pbruin]:\n> Replying to [comment:18 jdemeyer]:\n> > Peter, what's your use-case for `pol[a:b:c]`, i.e. why did you create this ticket?\n> Because of comments 22, 25 and 26 on ticket #15601.\n\nYou're just justifying a dubious use-case with a different dubious use-case.",
    "created_at": "2015-11-02T21:41:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255167",
    "user": "jdemeyer"
}
```

Replying to [comment:28 pbruin]:
> Replying to [comment:18 jdemeyer]:
> > Peter, what's your use-case for `pol[a:b:c]`, i.e. why did you create this ticket?
> Because of comments 22, 25 and 26 on ticket #15601.

You're just justifying a dubious use-case with a different dubious use-case.



---

archive/issue_comments_255168.json:
```json
{
    "body": "Replying to [comment:29 pbruin]:\n> Similarly, in PARI, my experience is that `Vecrev` (which does the equivalent of `list` above) is more useful than `Vec` to extract the list of coefficients of a polynomial.\n\nI think you are totally misunderstanding me. This is not at all about in *which order* the monomials are extracted. Obviously, PARI's `Vecrev()` is the right thing, I'm not arguing against that.\n\nIt's about\n\n```\n9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2\n```\n\nversus\n\n```\n9*x^7 + 8*x^6 + 7*x^5 + 6*x^4 + 5*x^3 + 4*x^2 + 3*x + 2\n```\n",
    "created_at": "2015-11-02T22:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255168",
    "user": "jdemeyer"
}
```

Replying to [comment:29 pbruin]:
> Similarly, in PARI, my experience is that `Vecrev` (which does the equivalent of `list` above) is more useful than `Vec` to extract the list of coefficients of a polynomial.

I think you are totally misunderstanding me. This is not at all about in *which order* the monomials are extracted. Obviously, PARI's `Vecrev()` is the right thing, I'm not arguing against that.

It's about

```
9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2
```

versus

```
9*x^7 + 8*x^6 + 7*x^5 + 6*x^4 + 5*x^3 + 4*x^2 + 3*x + 2
```




---

archive/issue_comments_255169.json:
```json
{
    "body": "Replying to [comment:30 pbruin]:\n> What would you want the output of `pol[5:]` itself to be?\n\n```\nsage: pol = PolynomialRing(QQ, 'x')(range(10))\nsage: pol[5:]\n9*x^4 + 8*x^3 + 7*x^2 + 6*x + 5\n```\n\n(although, I don't really *want* it to be this, but this is what I would *expect*)",
    "created_at": "2015-11-02T22:02:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255169",
    "user": "jdemeyer"
}
```

Replying to [comment:30 pbruin]:
> What would you want the output of `pol[5:]` itself to be?

```
sage: pol = PolynomialRing(QQ, 'x')(range(10))
sage: pol[5:]
9*x^4 + 8*x^3 + 7*x^2 + 6*x + 5
```

(although, I don't really *want* it to be this, but this is what I would *expect*)



---

archive/issue_comments_255170.json:
```json
{
    "body": "What I **really** want is probably\n\n```\nsage: pol = PolynomialRing(QQ, 'x')(range(10))\nsage: pol[5:]\nDeprecationWarning: slicing polynomials is deprecated...\n```\n",
    "created_at": "2015-11-02T22:19:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255170",
    "user": "jdemeyer"
}
```

What I **really** want is probably

```
sage: pol = PolynomialRing(QQ, 'x')(range(10))
sage: pol[5:]
DeprecationWarning: slicing polynomials is deprecated...
```




---

archive/issue_comments_255171.json:
```json
{
    "body": "In the Sage library, there are use cases for `pol[:n]` (i.e. truncation) and that's also the only case (I think) where both definitions agree.",
    "created_at": "2015-11-02T22:29:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255171",
    "user": "jdemeyer"
}
```

In the Sage library, there are use cases for `pol[:n]` (i.e. truncation) and that's also the only case (I think) where both definitions agree.



---

archive/issue_comments_255172.json:
```json
{
    "body": "So deprecate slicing unless it's a truncation?",
    "created_at": "2015-11-02T22:34:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255172",
    "user": "jhpalmieri"
}
```

So deprecate slicing unless it's a truncation?



---

archive/issue_comments_255173.json:
```json
{
    "body": "One more thought. Let's call this **degree-keeping slicing**:\n\n```\nsage: pol = PolynomialRing(QQ, 'x')(range(10))\nsage: pol[3::2]\n9*x^9 + 7*x^7 + 5*x^5 + 3*x^3\n```\n\nand let's call this **degree-reducing slicing**:\n\n```\nsage: pol = PolynomialRing(QQ, 'x')(range(10))\nsage: pol[3::2]\n9*x^3 + 7*x^2 + 5*x + 3\n```\n\n\nThe implementation of certain divide-and-conquer algorithms (e.g. Karatsuba multiplication and FFT) can be expressed very easily using degree-reducing slicing.\n\nI'm not saying that this is a particularly strong argument for degree-reducing slicing, since most likely you'd implement those algorithms using lists instead of polynomials anyway.",
    "created_at": "2015-11-03T07:38:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255173",
    "user": "jdemeyer"
}
```

One more thought. Let's call this **degree-keeping slicing**:

```
sage: pol = PolynomialRing(QQ, 'x')(range(10))
sage: pol[3::2]
9*x^9 + 7*x^7 + 5*x^5 + 3*x^3
```

and let's call this **degree-reducing slicing**:

```
sage: pol = PolynomialRing(QQ, 'x')(range(10))
sage: pol[3::2]
9*x^3 + 7*x^2 + 5*x + 3
```


The implementation of certain divide-and-conquer algorithms (e.g. Karatsuba multiplication and FFT) can be expressed very easily using degree-reducing slicing.

I'm not saying that this is a particularly strong argument for degree-reducing slicing, since most likely you'd implement those algorithms using lists instead of polynomials anyway.



---

archive/issue_comments_255174.json:
```json
{
    "body": "A new idea, let's call it **double slicing**. The argument to `__getitem__` can be a pair of slices `i, j`, where the slice `i` is used to define the coefficients and the second slice `j` is used to define the exponents. It would allow for example:\n\n```\nsage: pol = PolynomialRing(QQ, 'x')(range(10))\nsage: pol[:, ::2]\n9*x^18 + 8*x^16 + 7*x^14 + 6*x^12 + 5*x^10 + 4*x^8 + 3*x^6 + 2*x^4 + x^2\nsage: pol[:5, 100:]\n4*x^104 + 3*x^103 + 2*x^102 + x^101\n```\n\n\nWe could define shorthands `pol[i]` equivalent to `pol[i, i]` for degree-keeping slicing and `pol[i,]` equivalent to `pol[i, :]` for degree-reducing slicing.\n\nThis would be very general and cover all possible use-cases. The question is: is it over-engineered? Do we really need this?",
    "created_at": "2015-11-03T08:38:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255174",
    "user": "jdemeyer"
}
```

A new idea, let's call it **double slicing**. The argument to `__getitem__` can be a pair of slices `i, j`, where the slice `i` is used to define the coefficients and the second slice `j` is used to define the exponents. It would allow for example:

```
sage: pol = PolynomialRing(QQ, 'x')(range(10))
sage: pol[:, ::2]
9*x^18 + 8*x^16 + 7*x^14 + 6*x^12 + 5*x^10 + 4*x^8 + 3*x^6 + 2*x^4 + x^2
sage: pol[:5, 100:]
4*x^104 + 3*x^103 + 2*x^102 + x^101
```


We could define shorthands `pol[i]` equivalent to `pol[i, i]` for degree-keeping slicing and `pol[i,]` equivalent to `pol[i, :]` for degree-reducing slicing.

This would be very general and cover all possible use-cases. The question is: is it over-engineered? Do we really need this?



---

archive/issue_comments_255175.json:
```json
{
    "body": "I can confirm that the Sage library doesn't use any polynomial slicing except for truncation `pol[:n]`. After adding\n\n```\nif start or step is not None:\n    raise NotImplementedError\n```\n\nto the `__getitem__` methods, the only doctest failures were with slicing in the actual doctest example.",
    "created_at": "2015-11-03T11:10:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255175",
    "user": "jdemeyer"
}
```

I can confirm that the Sage library doesn't use any polynomial slicing except for truncation `pol[:n]`. After adding

```
if start or step is not None:
    raise NotImplementedError
```

to the `__getitem__` methods, the only doctest failures were with slicing in the actual doctest example.



---

archive/issue_comments_255176.json:
```json
{
    "body": "Replying to [comment:34 jdemeyer]:\n> Replying to [comment:29 pbruin]:\n> I think you are totally misunderstanding me. This is not at all about in *which order* the monomials are extracted. Obviously, PARI's `Vecrev()` is the right thing, I'm not arguing against that.\n> \n> It's about\n> {{{\n> 9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2\n> }}}\n> versus\n> {{{\n> 9*x^7 + 8*x^6 + 7*x^5 + 6*x^4 + 5*x^3 + 4*x^2 + 3*x + 2\n> }}}\nOK, I see.  As you can guess from how I interpreted your proposal, for me this is not the expected answer at all.\n\nI would personally be quite happy with just deprecating the `start` and `stop` parameters and allowing polynomial slicing only for `pol[:n]`, i.e. truncation.  I think users can easily implement other forms of slicing via lists.",
    "created_at": "2015-11-03T14:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255176",
    "user": "pbruin"
}
```

Replying to [comment:34 jdemeyer]:
> Replying to [comment:29 pbruin]:
> I think you are totally misunderstanding me. This is not at all about in *which order* the monomials are extracted. Obviously, PARI's `Vecrev()` is the right thing, I'm not arguing against that.
> 
> It's about
> {{{
> 9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2
> }}}
> versus
> {{{
> 9*x^7 + 8*x^6 + 7*x^5 + 6*x^4 + 5*x^3 + 4*x^2 + 3*x + 2
> }}}
OK, I see.  As you can guess from how I interpreted your proposal, for me this is not the expected answer at all.

I would personally be quite happy with just deprecating the `start` and `stop` parameters and allowing polynomial slicing only for `pol[:n]`, i.e. truncation.  I think users can easily implement other forms of slicing via lists.



---

archive/issue_comments_255177.json:
```json
{
    "body": "I think the double-slicing is probably something we don't really need. So I'm also for deprecating the (non-zero?) `start` and `step` conditions.",
    "created_at": "2015-11-03T15:05:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255177",
    "user": "tscrim"
}
```

I think the double-slicing is probably something we don't really need. So I'm also for deprecating the (non-zero?) `start` and `step` conditions.



---

archive/issue_comments_255178.json:
```json
{
    "body": "If we deprecate general slicing, shouldn't we deprecate all kinds of slicing, including `pol[:n]` in favour of the `truncate()` method?",
    "created_at": "2015-11-03T17:21:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255178",
    "user": "jdemeyer"
}
```

If we deprecate general slicing, shouldn't we deprecate all kinds of slicing, including `pol[:n]` in favour of the `truncate()` method?



---

archive/issue_comments_255179.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2015-11-03T17:29:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255179",
    "user": "jdemeyer"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_255180.json:
```json
{
    "body": "Truncation is actually implemented using slicing, so we cannot easily deprecate that.\n\nI am working on a patch.",
    "created_at": "2015-11-03T19:22:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255180",
    "user": "jdemeyer"
}
```

Truncation is actually implemented using slicing, so we cannot easily deprecate that.

I am working on a patch.



---

archive/issue_comments_255181.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-11-04T13:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255181",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_255182.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-11-04T13:22:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255182",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_255183.json:
```json
{
    "body": "Sorry, forgot `src/sage/rings/polynomial/padics/polynomial_padic_capped_relative_dense.py`",
    "created_at": "2015-11-04T13:24:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255183",
    "user": "jdemeyer"
}
```

Sorry, forgot `src/sage/rings/polynomial/padics/polynomial_padic_capped_relative_dense.py`



---

archive/issue_comments_255184.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-11-04T13:24:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255184",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_255185.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-11-04T13:47:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255185",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255186.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-11-04T13:48:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255186",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_255187.json:
```json
{
    "body": "FWIW, I think I have personal code that uses (\u201cdegree-keeping\u201d) slicing of the form `pol[n:]`. I can port it, but I may not be alone...",
    "created_at": "2015-11-10T12:04:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255187",
    "user": "mmezzarobba"
}
```

FWIW, I think I have personal code that uses (“degree-keeping”) slicing of the form `pol[n:]`. I can port it, but I may not be alone...



---

archive/issue_comments_255188.json:
```json
{
    "body": "Cool, what's your use case? I'm curious because I couldn't think of any.",
    "created_at": "2015-11-10T15:01:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255188",
    "user": "jdemeyer"
}
```

Cool, what's your use case? I'm curious because I couldn't think of any.



---

archive/issue_comments_255189.json:
```json
{
    "body": "Replying to [comment:56 jdemeyer]:\n> Cool, what's your use case? I'm curious because I couldn't think of any.\n\nSplitting polynomials that actually represent power series expansions into an \u201capproximation\u201d and a \u201cremainder\u201c; removing the constant term of a polynomial; removing low-order terms that are know to be zero mathematically but are computed as intervals containing zero from a residual \u03a6(pol) where \u03a6 is an operator and pol is a polynomial close to a zero of \u03a6.",
    "created_at": "2015-11-10T17:26:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255189",
    "user": "mmezzarobba"
}
```

Replying to [comment:56 jdemeyer]:
> Cool, what's your use case? I'm curious because I couldn't think of any.

Splitting polynomials that actually represent power series expansions into an “approximation” and a “remainder“; removing the constant term of a polynomial; removing low-order terms that are know to be zero mathematically but are computed as intervals containing zero from a residual Φ(pol) where Φ is an operator and pol is a polynomial close to a zero of Φ.



---

archive/issue_comments_255190.json:
```json
{
    "body": "`@`mmezzarobba: what is your opinion on [comment:40]?",
    "created_at": "2015-11-11T20:57:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255190",
    "user": "jdemeyer"
}
```

`@`mmezzarobba: what is your opinion on [comment:40]?



---

archive/issue_comments_255191.json:
```json
{
    "body": "Replying to [comment:58 jdemeyer]:\n> `@`mmezzarobba: what is your opinion on [comment:40]?\n\nI don't think I'd need it\u2014any of the two basic forms of slicing (either \u201cdegree-keeping\u201d or \u201cdegree-reducing\u201d) is enough for me. Regardless whether \u201cdouble slicing\u201d is implemented, I'd prefer `pol[i:]` to keep working (with one of the two basic meanings, I don't really care which, though I find the \u201cdegree-keeping\u201d version more intuitive with polynomials). It wouldn't be a big effort to change my code to work without slicing in any case.",
    "created_at": "2015-11-11T21:10:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255191",
    "user": "mmezzarobba"
}
```

Replying to [comment:58 jdemeyer]:
> `@`mmezzarobba: what is your opinion on [comment:40]?

I don't think I'd need it—any of the two basic forms of slicing (either “degree-keeping” or “degree-reducing”) is enough for me. Regardless whether “double slicing” is implemented, I'd prefer `pol[i:]` to keep working (with one of the two basic meanings, I don't really care which, though I find the “degree-keeping” version more intuitive with polynomials). It wouldn't be a big effort to change my code to work without slicing in any case.



---

archive/issue_comments_255192.json:
```json
{
    "body": "Fixed a merge conflict.",
    "created_at": "2016-01-13T14:58:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255192",
    "user": "pbruin"
}
```

Fixed a merge conflict.



---

archive/issue_comments_255193.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-01-18T08:05:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255193",
    "user": "rws"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_255194.json:
```json
{
    "body": "This is one of those enhancements I like to do myself. It is also thoroughly done. Since patchbot is happy too, I feel confident to set it positive.",
    "created_at": "2016-01-18T08:05:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255194",
    "user": "rws"
}
```

This is one of those enhancements I like to do myself. It is also thoroughly done. Since patchbot is happy too, I feel confident to set it positive.



---

archive/issue_comments_255195.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-01-20T10:20:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255195",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_255196.json:
```json
{
    "body": "Replying to [comment:41 jdemeyer]:\n> I can confirm that the Sage library doesn't use any polynomial slicing except for truncation `pol[:n]`. After adding\n> {{{\n> if start or step is not None:\n>     raise NotImplementedError\n> }}}\n> to the `__getitem__` methods, the only doctest failures were with slicing in the actual doctest example.\n\nFor a use case where deprecating `pol[n:]` is annoying, if you have an Eisenstein polynomial `pol` and want to compute `p/x^n` modulo `pol`, it's natural to express it as `-(pol[n:] >> n) / (pol[:n] // p)`, where the division is taken modulo `pol`.  Obviously, this is doable with lists.",
    "created_at": "2017-06-11T22:36:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255196",
    "user": "roed"
}
```

Replying to [comment:41 jdemeyer]:
> I can confirm that the Sage library doesn't use any polynomial slicing except for truncation `pol[:n]`. After adding
> {{{
> if start or step is not None:
>     raise NotImplementedError
> }}}
> to the `__getitem__` methods, the only doctest failures were with slicing in the actual doctest example.

For a use case where deprecating `pol[n:]` is annoying, if you have an Eisenstein polynomial `pol` and want to compute `p/x^n` modulo `pol`, it's natural to express it as `-(pol[n:] >> n) / (pol[:n] // p)`, where the division is taken modulo `pol`.  Obviously, this is doable with lists.



---

archive/issue_comments_255197.json:
```json
{
    "body": "Maybe a different solution would be to re-introduce the slicing but with a different interface (not `__getitem__` but an explicit method).",
    "created_at": "2017-06-12T10:00:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18703",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18703#issuecomment-255197",
    "user": "jdemeyer"
}
```

Maybe a different solution would be to re-introduce the slicing but with a different interface (not `__getitem__` but an explicit method).
