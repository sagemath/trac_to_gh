# Issue 16000: IncidenceStructureFromMatrix bug

archive/issues_016000.json:
```json
{
    "body": "CC:  @nathanncohen\n\nThe method IncidenceStructureFromMatrix has a serious bug, and it leads to serious errors in computations. We should fix it ASAP. For example, one may test with HadamardDesign (which uses the buggy implementation of IncidenceStructureFromMatrix). Consider the following output:\n\n\n```\nsage: D = designs.HadamardDesign(11); N = D.incidence_matrix()\nsage: J = matrix(ZZ, 11, 11, [1]*11*11); N*J\n[6 6 6 6 6 6 6 6 6 6 6]\n[6 6 6 6 6 6 6 6 6 6 6]\n[6 6 6 6 6 6 6 6 6 6 6]\n[6 6 6 6 6 6 6 6 6 6 6]\n[6 6 6 6 6 6 6 6 6 6 6]\n[5 5 5 5 5 5 5 5 5 5 5]\n[4 4 4 4 4 4 4 4 4 4 4]\n[4 4 4 4 4 4 4 4 4 4 4]\n[4 4 4 4 4 4 4 4 4 4 4]\n[4 4 4 4 4 4 4 4 4 4 4]\n[4 4 4 4 4 4 4 4 4 4 4]\n```\n\n\nThe bug is the indexing used in the if-testing in the method. \n\nIssue created by migration from https://trac.sagemath.org/ticket/16237\n\n",
    "created_at": "2014-04-25T14:10:10Z",
    "labels": [
        "component: please change"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "IncidenceStructureFromMatrix bug",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16000",
    "user": "https://github.com/KPanComputes"
}
```
CC:  @nathanncohen

The method IncidenceStructureFromMatrix has a serious bug, and it leads to serious errors in computations. We should fix it ASAP. For example, one may test with HadamardDesign (which uses the buggy implementation of IncidenceStructureFromMatrix). Consider the following output:


```
sage: D = designs.HadamardDesign(11); N = D.incidence_matrix()
sage: J = matrix(ZZ, 11, 11, [1]*11*11); N*J
[6 6 6 6 6 6 6 6 6 6 6]
[6 6 6 6 6 6 6 6 6 6 6]
[6 6 6 6 6 6 6 6 6 6 6]
[6 6 6 6 6 6 6 6 6 6 6]
[6 6 6 6 6 6 6 6 6 6 6]
[5 5 5 5 5 5 5 5 5 5 5]
[4 4 4 4 4 4 4 4 4 4 4]
[4 4 4 4 4 4 4 4 4 4 4]
[4 4 4 4 4 4 4 4 4 4 4]
[4 4 4 4 4 4 4 4 4 4 4]
[4 4 4 4 4 4 4 4 4 4 4]
```


The bug is the indexing used in the if-testing in the method. 

Issue created by migration from https://trac.sagemath.org/ticket/16237





---

archive/issue_comments_207440.json:
```json
{
    "body": "Are you working on fixing it ?\n\nNathann",
    "created_at": "2014-04-25T14:14:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207440",
    "user": "https://github.com/nathanncohen"
}
```

Are you working on fixing it ?

Nathann



---

archive/issue_comments_207441.json:
```json
{
    "body": "I have a fix but my GIT foo is not sufficient to upload it! :-( There is only one line of change to make: the if testing condition should be \n\n```\nif M[j, i] != 0\n```\n\n\nas opposed to the `if M[i, j] != 0`. :-) Similarly, I also have code for the HadamardThreeDesign too. :-)",
    "created_at": "2014-04-25T17:01:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207441",
    "user": "https://github.com/KPanComputes"
}
```

I have a fix but my GIT foo is not sufficient to upload it! :-( There is only one line of change to make: the if testing condition should be 

```
if M[j, i] != 0
```


as opposed to the `if M[i, j] != 0`. :-) Similarly, I also have code for the HadamardThreeDesign too. :-)



---

archive/issue_comments_207442.json:
```json
{
    "body": "You can ask on sage-devel if you have problems with GIT. They are writing a tutorial right now, it may give them ideas...",
    "created_at": "2014-04-26T15:02:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207442",
    "user": "https://github.com/nathanncohen"
}
```

You can ask on sage-devel if you have problems with GIT. They are writing a tutorial right now, it may give them ideas...



---

archive/issue_comments_207443.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-05-01T08:16:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207443",
    "user": "https://github.com/KPanComputes"
}
```

New commits:



---

archive/issue_comments_207444.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-05-01T08:22:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207444",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_207445.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2014-05-01T11:04:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207445",
    "user": "https://github.com/KPanComputes"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_207446.json:
```json
{
    "body": "Firstly, the bug described is mathematical. And, that it is a bug is evident from following the code.  This ticket fixes it and ALL doctests pass. However, the reason I have discovered this bug is itself another bug. So, I think, this ticket can double itself to fix this bug too.\n\nSo, the new bug is HadamardDesign method assumes that hadamard_matrix returns a Hadamard matrix whose first row and first column is the all-1 vector while hadamard_matrix method does not. This is why the example given in the method works but the example I describe does not: \n\n\n```\nsage: hadamard_matrix(8)\n[ 1  1  1  1  1  1  1  1]\n[ 1 -1  1 -1  1 -1  1 -1]\n[ 1  1 -1 -1  1  1 -1 -1]\n[ 1 -1 -1  1  1 -1 -1  1]\n[ 1  1  1  1 -1 -1 -1 -1]\n[ 1 -1  1 -1 -1  1 -1  1]\n[ 1  1 -1 -1 -1 -1  1  1]\n[ 1 -1 -1  1 -1  1  1 -1]\nsage: hadamard_matrix(12)\n[ 1  1  1  1  1  1|-1  1  1  1  1  1]\n[ 1  1  1 -1 -1  1| 1 -1  1 -1 -1  1]\n[ 1  1  1  1 -1 -1| 1  1 -1  1 -1 -1]\n[ 1 -1  1  1  1 -1| 1 -1  1 -1  1 -1]\n[ 1 -1 -1  1  1  1| 1 -1 -1  1 -1  1]\n[ 1  1 -1 -1  1  1| 1  1 -1 -1  1 -1]\n[-----------------+-----------------]\n[-1  1  1  1  1  1|-1 -1 -1 -1 -1 -1]\n[ 1 -1  1 -1 -1  1|-1 -1 -1  1  1 -1]\n[ 1  1 -1  1 -1 -1|-1 -1 -1 -1  1  1]\n[ 1 -1  1 -1  1 -1|-1  1 -1 -1 -1  1]\n[ 1 -1 -1  1 -1  1|-1  1  1 -1 -1 -1]\n[ 1  1 -1 -1  1 -1|-1 -1  1  1 -1 -1]\n```\n\n \nSo, to get the ball rolling, should there be a new method called normalised_hadamard_matrix or should we let the method hadamard_matrix take an optional argument like normalised=True or sth like that? \n\nAny suggestions would be welcome.",
    "created_at": "2014-05-01T11:14:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207446",
    "user": "https://github.com/KPanComputes"
}
```

Firstly, the bug described is mathematical. And, that it is a bug is evident from following the code.  This ticket fixes it and ALL doctests pass. However, the reason I have discovered this bug is itself another bug. So, I think, this ticket can double itself to fix this bug too.

So, the new bug is HadamardDesign method assumes that hadamard_matrix returns a Hadamard matrix whose first row and first column is the all-1 vector while hadamard_matrix method does not. This is why the example given in the method works but the example I describe does not: 


```
sage: hadamard_matrix(8)
[ 1  1  1  1  1  1  1  1]
[ 1 -1  1 -1  1 -1  1 -1]
[ 1  1 -1 -1  1  1 -1 -1]
[ 1 -1 -1  1  1 -1 -1  1]
[ 1  1  1  1 -1 -1 -1 -1]
[ 1 -1  1 -1 -1  1 -1  1]
[ 1  1 -1 -1 -1 -1  1  1]
[ 1 -1 -1  1 -1  1  1 -1]
sage: hadamard_matrix(12)
[ 1  1  1  1  1  1|-1  1  1  1  1  1]
[ 1  1  1 -1 -1  1| 1 -1  1 -1 -1  1]
[ 1  1  1  1 -1 -1| 1  1 -1  1 -1 -1]
[ 1 -1  1  1  1 -1| 1 -1  1 -1  1 -1]
[ 1 -1 -1  1  1  1| 1 -1 -1  1 -1  1]
[ 1  1 -1 -1  1  1| 1  1 -1 -1  1 -1]
[-----------------+-----------------]
[-1  1  1  1  1  1|-1 -1 -1 -1 -1 -1]
[ 1 -1  1 -1 -1  1|-1 -1 -1  1  1 -1]
[ 1  1 -1  1 -1 -1|-1 -1 -1 -1  1  1]
[ 1 -1  1 -1  1 -1|-1  1 -1 -1 -1  1]
[ 1 -1 -1  1 -1  1|-1  1  1 -1 -1 -1]
[ 1  1 -1 -1  1 -1|-1 -1  1  1 -1 -1]
```

 
So, to get the ball rolling, should there be a new method called normalised_hadamard_matrix or should we let the method hadamard_matrix take an optional argument like normalised=True or sth like that? 

Any suggestions would be welcome.



---

archive/issue_comments_207447.json:
```json
{
    "body": "Yooooooooo !!\n\n> So, to get the ball rolling, should there be a new method called normalised_hadamard_matrix or should we let the method hadamard_matrix take an optional argument like normalised=True or sth like that?\n\nYour idea is cool ! I would vote for the optional argument. Though it does not make a lot of sense to set it to \"True\" by default... So perhaps we can also normalize them automatically before returning them ?\n\nNathann",
    "created_at": "2014-05-01T12:19:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207447",
    "user": "https://github.com/nathanncohen"
}
```

Yooooooooo !!

> So, to get the ball rolling, should there be a new method called normalised_hadamard_matrix or should we let the method hadamard_matrix take an optional argument like normalised=True or sth like that?

Your idea is cool ! I would vote for the optional argument. Though it does not make a lot of sense to set it to "True" by default... So perhaps we can also normalize them automatically before returning them ?

Nathann



---

archive/issue_comments_207448.json:
```json
{
    "body": "Replying to [comment:8 ncohen]:\n\n> Your idea is cool ! I would vote for the optional argument. Though it does not make a lot of sense to set it to \"True\" by default... So perhaps we can also normalize them automatically before returning them ?\n\nMay be not, because, this is going to take 2n steps for a Hadamard Matrix of order n. And, for many purposes, this is not necessary. So, may be we can have an optional argument and set it to False instead. \n\nDo you agree?",
    "created_at": "2014-05-01T12:23:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207448",
    "user": "https://github.com/KPanComputes"
}
```

Replying to [comment:8 ncohen]:

> Your idea is cool ! I would vote for the optional argument. Though it does not make a lot of sense to set it to "True" by default... So perhaps we can also normalize them automatically before returning them ?

May be not, because, this is going to take 2n steps for a Hadamard Matrix of order n. And, for many purposes, this is not necessary. So, may be we can have an optional argument and set it to False instead. 

Do you agree?



---

archive/issue_comments_207449.json:
```json
{
    "body": "Ahahahah. Okay, as you want. But I do not think these 2n steps will make a difference in any code. Are you sure that creating the matrix takes a linear time ? Or may Python reallocate a partial matrix several times ? Either way is fine !\n\nNathann",
    "created_at": "2014-05-01T12:28:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207449",
    "user": "https://github.com/nathanncohen"
}
```

Ahahahah. Okay, as you want. But I do not think these 2n steps will make a difference in any code. Are you sure that creating the matrix takes a linear time ? Or may Python reallocate a partial matrix several times ? Either way is fine !

Nathann



---

archive/issue_comments_207450.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-05-02T18:44:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207450",
    "user": "https://github.com/KPanComputes"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_207451.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to combinatorics.",
    "created_at": "2014-05-02T18:44:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207451",
    "user": "https://github.com/KPanComputes"
}
```

Changing component from PLEASE CHANGE to combinatorics.



---

archive/issue_comments_207452.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-05-02T18:44:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207452",
    "user": "https://github.com/KPanComputes"
}
```

New commits:



---

archive/issue_comments_207453.json:
```json
{
    "body": "Indeed, the bug that motivated my search is now fixed; with the patch, we have: \n\n```\nsage: D = designs.HadamardDesign(11); N = D.incidence_matrix()\nsage: J = matrix(ZZ, 11, 11, [1]*11*11); N*J\n[5 5 5 5 5 5 5 5 5 5 5]\n[5 5 5 5 5 5 5 5 5 5 5]\n[5 5 5 5 5 5 5 5 5 5 5]\n[5 5 5 5 5 5 5 5 5 5 5]\n[5 5 5 5 5 5 5 5 5 5 5]\n[5 5 5 5 5 5 5 5 5 5 5]\n[5 5 5 5 5 5 5 5 5 5 5]\n[5 5 5 5 5 5 5 5 5 5 5]\n[5 5 5 5 5 5 5 5 5 5 5]\n[5 5 5 5 5 5 5 5 5 5 5]\n[5 5 5 5 5 5 5 5 5 5 5]\n```\n",
    "created_at": "2014-05-02T18:47:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207453",
    "user": "https://github.com/KPanComputes"
}
```

Indeed, the bug that motivated my search is now fixed; with the patch, we have: 

```
sage: D = designs.HadamardDesign(11); N = D.incidence_matrix()
sage: J = matrix(ZZ, 11, 11, [1]*11*11); N*J
[5 5 5 5 5 5 5 5 5 5 5]
[5 5 5 5 5 5 5 5 5 5 5]
[5 5 5 5 5 5 5 5 5 5 5]
[5 5 5 5 5 5 5 5 5 5 5]
[5 5 5 5 5 5 5 5 5 5 5]
[5 5 5 5 5 5 5 5 5 5 5]
[5 5 5 5 5 5 5 5 5 5 5]
[5 5 5 5 5 5 5 5 5 5 5]
[5 5 5 5 5 5 5 5 5 5 5]
[5 5 5 5 5 5 5 5 5 5 5]
[5 5 5 5 5 5 5 5 5 5 5]
```




---

archive/issue_comments_207454.json:
```json
{
    "body": "Hello !\n\nSeveral remarks:\n\n1) I do not think you should change the definition of the Paley matrices... I believe they are well-defined, and if you want a normalized version of them you should not change their definition but rather normalize them when you need them. At the very least, you could have an optional argument \"normalize\" set to False by default in these functions.\n\n2) You seem to use twice the code to normalize a matrix. I guess the best would be to write a function that does that, as it can be useful later, and also useful to the users.\n\n3) There may be a smart way to test if a element of a field is a quadratic residue, but if you need to enumerate all of them anyway you could begin by computing the square of all elements of the field, then decide if each element is a square by testing if it belongs to that list ?... \n\nNathann",
    "created_at": "2014-05-02T19:48:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207454",
    "user": "https://github.com/nathanncohen"
}
```

Hello !

Several remarks:

1) I do not think you should change the definition of the Paley matrices... I believe they are well-defined, and if you want a normalized version of them you should not change their definition but rather normalize them when you need them. At the very least, you could have an optional argument "normalize" set to False by default in these functions.

2) You seem to use twice the code to normalize a matrix. I guess the best would be to write a function that does that, as it can be useful later, and also useful to the users.

3) There may be a smart way to test if a element of a field is a quadratic residue, but if you need to enumerate all of them anyway you could begin by computing the square of all elements of the field, then decide if each element is a square by testing if it belongs to that list ?... 

Nathann



---

archive/issue_comments_207455.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2014-05-02T19:48:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207455",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_207456.json:
```json
{
    "body": "Replying to [comment:13 ncohen]:\n> Hello !\n> \n> Several remarks:\n> \n> 1) I do not think you should change the definition of the Paley matrices... I believe they are well-defined, and if you want a normalized version of them you should not change their definition but rather normalize them when you need them. At the very least, you could have an optional argument \"normalize\" set to False by default in these functions. \n\nNo, I have modified only so much as to remove the edge cases that do not arise. I am not really changing the definition of Paley matrices. There are several floating around in the Literature. I have chosen Horadam's Paley Type I, Type II (I think!). But, this is not standard at all! We could probably have this put explicitly in the documentation. And, this document is not included in the combinat docs! Should we try to add it ? :-) \n \n> \n> 2) You seem to use twice the code to normalize a matrix. I guess the best would be to write a function that does that, as it can be useful later, and also useful to the users.\n> \n\nGood suggestion, I will implement it! \n\n> 3) There may be a smart way to test if a element of a field is a quadratic residue, but if you need to enumerate all of them anyway you could begin by computing the square of all elements of the field, then decide if each element is a square by testing if it belongs to that list ?... \n\nThere are several faster ways to do this! I am planning on implementing this in a later ticket! But, for now, it shall be a TODO notice!  \n\nKannappan.",
    "created_at": "2014-05-02T20:07:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207456",
    "user": "https://github.com/KPanComputes"
}
```

Replying to [comment:13 ncohen]:
> Hello !
> 
> Several remarks:
> 
> 1) I do not think you should change the definition of the Paley matrices... I believe they are well-defined, and if you want a normalized version of them you should not change their definition but rather normalize them when you need them. At the very least, you could have an optional argument "normalize" set to False by default in these functions. 

No, I have modified only so much as to remove the edge cases that do not arise. I am not really changing the definition of Paley matrices. There are several floating around in the Literature. I have chosen Horadam's Paley Type I, Type II (I think!). But, this is not standard at all! We could probably have this put explicitly in the documentation. And, this document is not included in the combinat docs! Should we try to add it ? :-) 
 
> 
> 2) You seem to use twice the code to normalize a matrix. I guess the best would be to write a function that does that, as it can be useful later, and also useful to the users.
> 

Good suggestion, I will implement it! 

> 3) There may be a smart way to test if a element of a field is a quadratic residue, but if you need to enumerate all of them anyway you could begin by computing the square of all elements of the field, then decide if each element is a square by testing if it belongs to that list ?... 

There are several faster ways to do this! I am planning on implementing this in a later ticket! But, for now, it shall be a TODO notice!  

Kannappan.



---

archive/issue_comments_207457.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-05-02T20:24:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207457",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_207458.json:
```json
{
    "body": "Hello Kannappan !!!\n\nOkayokayokayokay, so you implement more or less Horadam's construction with a couple of changes of signs. Okay. It would be nice to clean this file a bit in the future, because right now there is a \"return 0\" in functions who claim to return entries of Hadamard matrices `:-P`\n\nAnyway. I agree with what your branch does, and I added a reviewer's commit in public/16237 to fix a couple of typoes.\n\n1) The first line of the documentation of a function should be a one-line description of what it does\n\n2) Some people complain where a line ends with spaces (\"trailing whitespaces\")\n\n3) Some people complain (the same) when the lines are longer than 80 characters.\n\n4) Some people fight over american/english spelling (but as I never remember which ones, I did nothing about that `:-P`\n\nSooooooooo well.\n\nIf you agree with my changes, you can either :\n\n1) Add my commit to your branch\n\n2) Change the branch to public/16237 (remember that you are the only one with writing access to u/knsam/* branches and that everybody can write to public/* branches\n\nAbout the doc : it seems to be included already http://www.sagemath.org/doc/reference/combinat/sage/combinat/matrices/hadamard_matrix.html\n\nHMmmmmmm... Okay, nothing else to say. Good work !\n\nNathann\n\nP.S. : The custom is the following : usually, the reviewer sets the ticket to `positive_review`, but in this case I added a commit with small modifications. So if you agree with what it does, you can set the ticket to `positive_review` yourself, as you reviewed my changes and I reviewed yours. And if you do not like something in my commits, the custom is to discuss it and fight to the death.",
    "created_at": "2014-05-02T21:16:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207458",
    "user": "https://github.com/nathanncohen"
}
```

Hello Kannappan !!!

Okayokayokayokay, so you implement more or less Horadam's construction with a couple of changes of signs. Okay. It would be nice to clean this file a bit in the future, because right now there is a "return 0" in functions who claim to return entries of Hadamard matrices `:-P`

Anyway. I agree with what your branch does, and I added a reviewer's commit in public/16237 to fix a couple of typoes.

1) The first line of the documentation of a function should be a one-line description of what it does

2) Some people complain where a line ends with spaces ("trailing whitespaces")

3) Some people complain (the same) when the lines are longer than 80 characters.

4) Some people fight over american/english spelling (but as I never remember which ones, I did nothing about that `:-P`

Sooooooooo well.

If you agree with my changes, you can either :

1) Add my commit to your branch

2) Change the branch to public/16237 (remember that you are the only one with writing access to u/knsam/* branches and that everybody can write to public/* branches

About the doc : it seems to be included already http://www.sagemath.org/doc/reference/combinat/sage/combinat/matrices/hadamard_matrix.html

HMmmmmmm... Okay, nothing else to say. Good work !

Nathann

P.S. : The custom is the following : usually, the reviewer sets the ticket to `positive_review`, but in this case I added a commit with small modifications. So if you agree with what it does, you can set the ticket to `positive_review` yourself, as you reviewed my changes and I reviewed yours. And if you do not like something in my commits, the custom is to discuss it and fight to the death.



---

archive/issue_comments_207459.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-05-03T16:49:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207459",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_207460.json:
```json
{
    "body": "Changing status from needs_info to positive_review.",
    "created_at": "2014-05-03T16:51:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207460",
    "user": "https://github.com/KPanComputes"
}
```

Changing status from needs_info to positive_review.



---

archive/issue_comments_207461.json:
```json
{
    "body": "Hi Nathann, \n\nI have set this ticket to positive review, as we discussed! \n\nKannappan.",
    "created_at": "2014-05-03T16:51:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207461",
    "user": "https://github.com/KPanComputes"
}
```

Hi Nathann, 

I have set this ticket to positive review, as we discussed! 

Kannappan.



---

archive/issue_comments_207462.json:
```json
{
    "body": "Okayyyyyyyyyy... Well, in this context it is better to add a commit rather than rewrite the last one. Because this way the reviewer can easily see what exactly you changed since the previous commit. If I want to do it now, I have to re-read the whole branch again and try to find out if everything is there `:-P`\n\nNathann",
    "created_at": "2014-05-03T17:19:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207462",
    "user": "https://github.com/nathanncohen"
}
```

Okayyyyyyyyyy... Well, in this context it is better to add a commit rather than rewrite the last one. Because this way the reviewer can easily see what exactly you changed since the previous commit. If I want to do it now, I have to re-read the whole branch again and try to find out if everything is there `:-P`

Nathann



---

archive/issue_comments_207463.json:
```json
{
    "body": "Sorry about it, I will do it from the next time! \n\nKannappan.",
    "created_at": "2014-05-03T20:11:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207463",
    "user": "https://github.com/KPanComputes"
}
```

Sorry about it, I will do it from the next time! 

Kannappan.



---

archive/issue_comments_207464.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-05-07T06:27:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207464",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_207465.json:
```json
{
    "body": "Documentation does not build",
    "created_at": "2014-05-07T06:27:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207465",
    "user": "https://github.com/vbraun"
}
```

Documentation does not build



---

archive/issue_comments_207466.json:
```json
{
    "body": "Fixed.\n----\nNew commits:",
    "created_at": "2014-05-07T06:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207466",
    "user": "https://github.com/nathanncohen"
}
```

Fixed.
----
New commits:



---

archive/issue_comments_207467.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-05-07T06:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207467",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_207468.json:
```json
{
    "body": "docbuild fails",
    "created_at": "2014-05-12T23:17:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207468",
    "user": "https://github.com/vbraun"
}
```

docbuild fails



---

archive/issue_comments_207469.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-05-12T23:17:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207469",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_207470.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-13T09:06:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207470",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207471.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-05-13T09:06:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207471",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_207472.json:
```json
{
    "body": "Fixed.",
    "created_at": "2014-05-13T09:06:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207472",
    "user": "https://github.com/nathanncohen"
}
```

Fixed.



---

archive/issue_comments_207473.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-05-13T13:11:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16000#issuecomment-207473",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_015571.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2014-05-13T13:11:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16000",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16000#event-15571"
}
```
