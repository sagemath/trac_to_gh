# Issue 10829: segfault in roots() in wrong ring

archive/issues_010829.json:
```json
{
    "body": "Assignee: tbd\n\nCC:  mjo\n\nIf you pass .roots() a ring that it can't handle, usually you get a nice exception, but in some cases it segfaults [4.6.2, OS X 10.6.6]:\n\n\n```\nsage: var(\"a\")\na\nsage: R.<x> = SR[]\nsage: f = x-a\nsage: parent(f)\nUnivariate Polynomial Ring in x over Symbolic Ring\nsage: f.roots(RR)\n\nProgram received signal EXC_BAD_ACCESS, Could not access memory.\nReason: 13 at address: 0x0000000000000000\n0x0000000103c811f5 in mpfr_clear ()\n(gdb) bt\n#0  0x0000000103c811f5 in mpfr_clear ()\n#1  0x0000000105440341 in __pyx_tp_dealloc_4sage_5rings_10polynomial_26polynomial_real_mpfr_dense_PolynomialRealDense ()\n#2  0x000000010006d6f9 in type_call ()\n#3  0x000000010000bc32 in PyObject_Call ()\n#4  0x00000001000b333e in PyEval_EvalFrameEx ()\n#5  0x00000001000b8fd2 in PyEval_EvalCodeEx ()\n#6  0x000000010003af45 in function_call ()\n#7  0x000000010000bc32 in PyObject_Call ()\n#8  0x000000010001dc3b in instancemethod_call ()\n#9  0x000000010000bc32 in PyObject_Call ()\n#10 0x000000010406c46e in __pyx_f_4sage_9structure_11coerce_maps_24DefaultConvertMap_unique__call_ ()\n#11 0x000000010232f690 in __pyx_pf_4sage_9structure_6parent_6Parent___call__ ()\n#12 0x000000010000bc32 in PyObject_Call ()\n#13 0x0000000105103580 in __pyx_pf_4sage_5rings_10polynomial_18polynomial_element_10Polynomial_change_ring (__pyx_v_self=0x10cb32ae0, __pyx_v_R=<value temporarily unavailable, due to optimizations>) at sage/rings/polynomial/polynomial_element.c:16432\n#14 0x000000010000bc32 in PyObject_Call ()\n#15 0x0000000105152ec0 in __pyx_pf_4sage_5rings_10polynomial_18polynomial_element_10Polynomial_roots (__pyx_v_self=0x10cb32ae0, __pyx_args=<value temporarily unavailable, due to optimizations>, __pyx_kwds=<value temporarily unavailable, due to optimizations>) at sage/rings/polynomial/polynomial_element.c:31609\n#16 0x00000001000b7709 in PyEval_EvalFrameEx ()\n#17 0x00000001000b8fd2 in PyEval_EvalCodeEx ()\n#18 0x00000001000b872e in PyEval_EvalFrameEx ()\n#19 0x00000001000b8fd2 in PyEval_EvalCodeEx ()\n#20 0x00000001000b6185 in PyEval_EvalFrameEx ()\n#21 0x00000001000b8fd2 in PyEval_EvalCodeEx ()\n#22 0x00000001000b6185 in PyEval_EvalFrameEx ()\n#23 0x00000001000b7b01 in PyEval_EvalFrameEx ()\n#24 0x00000001000b8fd2 in PyEval_EvalCodeEx ()\n#25 0x00000001000b6185 in PyEval_EvalFrameEx ()\n#26 0x00000001000b8fd2 in PyEval_EvalCodeEx ()\n#27 0x00000001000b6185 in PyEval_EvalFrameEx ()\n#28 0x00000001000b8fd2 in PyEval_EvalCodeEx ()\n#29 0x00000001000b6185 in PyEval_EvalFrameEx ()\n#30 0x00000001000b8fd2 in PyEval_EvalCodeEx ()\n#31 0x00000001000b90b6 in PyEval_EvalCode ()\n#32 0x00000001000dde5e in PyRun_FileExFlags ()\n#33 0x00000001000de119 in PyRun_SimpleFileExFlags ()\n#34 0x00000001000eb61b in Py_Main ()\n#35 0x0000000100000f14 in start ()\n```\n\n\nand similarly for CC.\n\n[Not sure which component this falls under; anyone who knows, please change.]\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/10901\n\n",
    "created_at": "2011-03-10T08:59:24Z",
    "labels": [
        "PLEASE CHANGE",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "segfault in roots() in wrong ring",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10829",
    "user": "dsm"
}
```
Assignee: tbd

CC:  mjo

If you pass .roots() a ring that it can't handle, usually you get a nice exception, but in some cases it segfaults [4.6.2, OS X 10.6.6]:


```
sage: var("a")
a
sage: R.<x> = SR[]
sage: f = x-a
sage: parent(f)
Univariate Polynomial Ring in x over Symbolic Ring
sage: f.roots(RR)

Program received signal EXC_BAD_ACCESS, Could not access memory.
Reason: 13 at address: 0x0000000000000000
0x0000000103c811f5 in mpfr_clear ()
(gdb) bt
#0  0x0000000103c811f5 in mpfr_clear ()
#1  0x0000000105440341 in __pyx_tp_dealloc_4sage_5rings_10polynomial_26polynomial_real_mpfr_dense_PolynomialRealDense ()
#2  0x000000010006d6f9 in type_call ()
#3  0x000000010000bc32 in PyObject_Call ()
#4  0x00000001000b333e in PyEval_EvalFrameEx ()
#5  0x00000001000b8fd2 in PyEval_EvalCodeEx ()
#6  0x000000010003af45 in function_call ()
#7  0x000000010000bc32 in PyObject_Call ()
#8  0x000000010001dc3b in instancemethod_call ()
#9  0x000000010000bc32 in PyObject_Call ()
#10 0x000000010406c46e in __pyx_f_4sage_9structure_11coerce_maps_24DefaultConvertMap_unique__call_ ()
#11 0x000000010232f690 in __pyx_pf_4sage_9structure_6parent_6Parent___call__ ()
#12 0x000000010000bc32 in PyObject_Call ()
#13 0x0000000105103580 in __pyx_pf_4sage_5rings_10polynomial_18polynomial_element_10Polynomial_change_ring (__pyx_v_self=0x10cb32ae0, __pyx_v_R=<value temporarily unavailable, due to optimizations>) at sage/rings/polynomial/polynomial_element.c:16432
#14 0x000000010000bc32 in PyObject_Call ()
#15 0x0000000105152ec0 in __pyx_pf_4sage_5rings_10polynomial_18polynomial_element_10Polynomial_roots (__pyx_v_self=0x10cb32ae0, __pyx_args=<value temporarily unavailable, due to optimizations>, __pyx_kwds=<value temporarily unavailable, due to optimizations>) at sage/rings/polynomial/polynomial_element.c:31609
#16 0x00000001000b7709 in PyEval_EvalFrameEx ()
#17 0x00000001000b8fd2 in PyEval_EvalCodeEx ()
#18 0x00000001000b872e in PyEval_EvalFrameEx ()
#19 0x00000001000b8fd2 in PyEval_EvalCodeEx ()
#20 0x00000001000b6185 in PyEval_EvalFrameEx ()
#21 0x00000001000b8fd2 in PyEval_EvalCodeEx ()
#22 0x00000001000b6185 in PyEval_EvalFrameEx ()
#23 0x00000001000b7b01 in PyEval_EvalFrameEx ()
#24 0x00000001000b8fd2 in PyEval_EvalCodeEx ()
#25 0x00000001000b6185 in PyEval_EvalFrameEx ()
#26 0x00000001000b8fd2 in PyEval_EvalCodeEx ()
#27 0x00000001000b6185 in PyEval_EvalFrameEx ()
#28 0x00000001000b8fd2 in PyEval_EvalCodeEx ()
#29 0x00000001000b6185 in PyEval_EvalFrameEx ()
#30 0x00000001000b8fd2 in PyEval_EvalCodeEx ()
#31 0x00000001000b90b6 in PyEval_EvalCode ()
#32 0x00000001000dde5e in PyRun_FileExFlags ()
#33 0x00000001000de119 in PyRun_SimpleFileExFlags ()
#34 0x00000001000eb61b in Py_Main ()
#35 0x0000000100000f14 in start ()
```


and similarly for CC.

[Not sure which component this falls under; anyone who knows, please change.]


Issue created by migration from https://trac.sagemath.org/ticket/10901





---

archive/issue_comments_114677.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to algebra.",
    "created_at": "2011-04-11T18:05:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10829",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10829#issuecomment-114677",
    "user": "johanbosman"
}
```

Changing component from PLEASE CHANGE to algebra.



---

archive/issue_comments_114678.json:
```json
{
    "body": "Changing priority from minor to major.",
    "created_at": "2011-04-11T18:05:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10829",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10829#issuecomment-114678",
    "user": "johanbosman"
}
```

Changing priority from minor to major.



---

archive/issue_comments_114679.json:
```json
{
    "body": "Changing assignee from tbd to AlexGhitza.",
    "created_at": "2011-04-11T18:05:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10829",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10829#issuecomment-114679",
    "user": "johanbosman"
}
```

Changing assignee from tbd to AlexGhitza.



---

archive/issue_comments_114680.json:
```json
{
    "body": "The patch in #9826 fixes this.",
    "created_at": "2011-04-11T18:05:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10829",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10829#issuecomment-114680",
    "user": "johanbosman"
}
```

The patch in #9826 fixes this.



---

archive/issue_comments_114681.json:
```json
{
    "body": "In the meantime, this seems to've been fixed already:\n\n```\nsage: sage: f.roots(RR)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n...\nTypeError: Cannot evaluate symbolic expression to a numeric value.\n```\n",
    "created_at": "2012-02-29T15:37:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10829",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10829#issuecomment-114681",
    "user": "johanbosman"
}
```

In the meantime, this seems to've been fixed already:

```
sage: sage: f.roots(RR)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
...
TypeError: Cannot evaluate symbolic expression to a numeric value.
```




---

archive/issue_comments_114682.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-02-29T15:37:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10829",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10829#issuecomment-114682",
    "user": "johanbosman"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_114683.json:
```json
{
    "body": "I confirm that the issue is resolved.\n\nI am attaching a trivial patch doctesting this so we notice if we break it again.",
    "created_at": "2012-03-28T23:57:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10829",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10829#issuecomment-114683",
    "user": "AlexGhitza"
}
```

I confirm that the issue is resolved.

I am attaching a trivial patch doctesting this so we notice if we break it again.



---

archive/issue_comments_114684.json:
```json
{
    "body": "Attachment [trac10901.patch](tarball://root/attachments/some-uuid/ticket10901/trac10901.patch) by AlexGhitza created at 2012-03-28 23:58:14",
    "created_at": "2012-03-28T23:58:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10829",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10829#issuecomment-114684",
    "user": "AlexGhitza"
}
```

Attachment [trac10901.patch](tarball://root/attachments/some-uuid/ticket10901/trac10901.patch) by AlexGhitza created at 2012-03-28 23:58:14



---

archive/issue_comments_114685.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-03-29T04:49:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10829",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10829#issuecomment-114685",
    "user": "mjo"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_114686.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-04-19T06:43:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10829",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10829#issuecomment-114686",
    "user": "jdemeyer"
}
```

Resolution: fixed
