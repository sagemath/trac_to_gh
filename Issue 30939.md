# Issue 30939: Add packages from 3-manifolds / computop

archive/issues_030939.json:
```json
{
    "body": "CC:  @NathanDunfield @culler @dimpase @slel\n\nhttps://github.com/3-manifolds/sagedocker/tree/master/sage/scripts\n\nIssue created by migration from https://trac.sagemath.org/ticket/31176\n\n",
    "created_at": "2021-01-03T22:34:54Z",
    "labels": [
        "component: packages: optional"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Add packages from 3-manifolds / computop",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30939",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @NathanDunfield @culler @dimpase @slel

https://github.com/3-manifolds/sagedocker/tree/master/sage/scripts

Issue created by migration from https://trac.sagemath.org/ticket/31176





---

archive/issue_comments_441433.json:
```json
{
    "body": "It should be noted that `SnapPy`, nor any of the other software at \u200b[https://github.com/3-manifolds](https://github.com/3-manifolds), actually depends on, or even uses, `(py)graphviz` or `ipympl`.  A certain amount of the stuff in that Docker image is just there because I used it in some project or other ;-).\n\nAll outside dependencies of `SnapPy` itself are already included in `sage`. That is, \n\n```\nsage -pip install --no-deps snappy spherogram plink FXrays snappy_manifolds\n```\n\nwould be a completely functional \"optional spkg\" for `SnapPy`.",
    "created_at": "2021-01-04T17:54:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30939",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30939#issuecomment-441433",
    "user": "https://github.com/NathanDunfield"
}
```

It should be noted that `SnapPy`, nor any of the other software at â€‹[https://github.com/3-manifolds](https://github.com/3-manifolds), actually depends on, or even uses, `(py)graphviz` or `ipympl`.  A certain amount of the stuff in that Docker image is just there because I used it in some project or other ;-).

All outside dependencies of `SnapPy` itself are already included in `sage`. That is, 

```
sage -pip install --no-deps snappy spherogram plink FXrays snappy_manifolds
```

would be a completely functional "optional spkg" for `SnapPy`.



---

archive/issue_comments_441434.json:
```json
{
    "body": "The `--no-deps` flag is just there to prevent it from pulling in `cypari (!= cypari2)`.  In fact, just `sage -pip install snappy` does the trick but installs the (unused even by `SnapPy` in this context) `cypari` module. Unfortunately, `pip` does not seem to permit you to require one of a list of modules e.g. `cypari|cypari2`, cf [https://github.com/sagemath/cypari2/issues/19#issuecomment-699071738](https://github.com/sagemath/cypari2/issues/19#issuecomment-699071738).",
    "created_at": "2021-01-04T18:04:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30939",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30939#issuecomment-441434",
    "user": "https://github.com/NathanDunfield"
}
```

The `--no-deps` flag is just there to prevent it from pulling in `cypari (!= cypari2)`.  In fact, just `sage -pip install snappy` does the trick but installs the (unused even by `SnapPy` in this context) `cypari` module. Unfortunately, `pip` does not seem to permit you to require one of a list of modules e.g. `cypari|cypari2`, cf [https://github.com/sagemath/cypari2/issues/19#issuecomment-699071738](https://github.com/sagemath/cypari2/issues/19#issuecomment-699071738).



---

archive/issue_comments_441435.json:
```json
{
    "body": "Replying to [comment:4 dunfield]:\n> ... unused even by `SnapPy` in this context ...\nSounds like `cypari` should be an `extras_require`?",
    "created_at": "2021-01-04T18:32:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30939",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30939#issuecomment-441435",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:4 dunfield]:
> ... unused even by `SnapPy` in this context ...
Sounds like `cypari` should be an `extras_require`?



---

archive/issue_comments_441436.json:
```json
{
    "body": "Replying to [comment:6 mkoeppe]:\n> > ... unused even by `SnapPy` in this context ...\n> Sounds like `cypari` should be an `extras_require`?\n\nUnfortunately, outside of Sage, SnapPy does use `cypari` very heavily; it is just that inside of Sage, it uses `cypari2` instead.  The two modules provide identical functionality, but `cypari` is statically linked (and includes an embedded copy of `cysignals`) whereas `cypari2` relies on the external dynamic library `libpari`.\n\n(In case you're curious, the reason `cypari` is statically linked is so we can build self-contained binary wheels to post on PyPI, including for Windows (native, not cygwin), and ship stand-alone SnapPy apps for macOS and Windows.)",
    "created_at": "2021-01-05T01:45:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30939",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30939#issuecomment-441436",
    "user": "https://github.com/NathanDunfield"
}
```

Replying to [comment:6 mkoeppe]:
> > ... unused even by `SnapPy` in this context ...
> Sounds like `cypari` should be an `extras_require`?

Unfortunately, outside of Sage, SnapPy does use `cypari` very heavily; it is just that inside of Sage, it uses `cypari2` instead.  The two modules provide identical functionality, but `cypari` is statically linked (and includes an embedded copy of `cysignals`) whereas `cypari2` relies on the external dynamic library `libpari`.

(In case you're curious, the reason `cypari` is statically linked is so we can build self-contained binary wheels to post on PyPI, including for Windows (native, not cygwin), and ship stand-alone SnapPy apps for macOS and Windows.)



---

archive/issue_comments_441437.json:
```json
{
    "body": "Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-24T02:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30939",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30939#issuecomment-441437",
    "user": "https://github.com/mkoeppe"
}
```

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.
