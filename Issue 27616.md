# Issue 27616: polymake: Install gcc if system gcc older than 5.1

archive/issues_027616.json:
```json
{
    "body": "CC:  dimpase\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/27853\n\n",
    "created_at": "2019-05-20T03:09:42Z",
    "labels": [
        "packages: experimental",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "polymake: Install gcc if system gcc older than 5.1",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27616",
    "user": "mkoeppe"
}
```
CC:  dimpase



Issue created by migration from https://trac.sagemath.org/ticket/27853





---

archive/issue_comments_389698.json:
```json
{
    "body": "Can this be done with spkg-configure?",
    "created_at": "2019-05-20T03:29:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27616#issuecomment-389698",
    "user": "mkoeppe"
}
```

Can this be done with spkg-configure?



---

archive/issue_comments_389699.json:
```json
{
    "body": "Do you mean the  spkg-configure of polymake?\n\nThis might be a bit tricky, I'd just implement a version check, which errors\nout with a message to install a newer gcc. You if needed might tweak spkg-configure of gcc to make it easier.\n\nAs well, very old gcc's (say, 4.4) cannot even compile Sage's gcc.\n\nAlso note that clang typically fakes a gcc, sometimes (on OSX) quite old one.",
    "created_at": "2019-05-20T06:25:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27616#issuecomment-389699",
    "user": "dimpase"
}
```

Do you mean the  spkg-configure of polymake?

This might be a bit tricky, I'd just implement a version check, which errors
out with a message to install a newer gcc. You if needed might tweak spkg-configure of gcc to make it easier.

As well, very old gcc's (say, 4.4) cannot even compile Sage's gcc.

Also note that clang typically fakes a gcc, sometimes (on OSX) quite old one.



---

archive/issue_comments_389700.json:
```json
{
    "body": "on the other hand, yes, in `polymake/spkg-config.m4` you can do something like \n\n```\nSAGE_SPKG_CONFIGURE([gcc], [\n    sage_spkg_install_polymake=yes\n    AC_REQUIRE([SAGE_SPKG_CONFIGURE_GMP])\n    if test $IS_REALLY_GCC = yes ; then\n       AS_CASE([\"$GXX_VERSION.0\"],\n           [[[0-4]].*|5.0.*], [\n               SAGE_MUST_INSTALL_GCC([you have $CXX version $GXX_VERSION, which is too old to build polymake])\n                ])\n    fi\n```\n\n\nbut I am not sure whether this would kick in regardless of the experimental status of polymake.\n\nIn fact I would be in favours of dropping gcc 4 support completely, and require at least 5.1 globally.",
    "created_at": "2019-05-20T11:51:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27616#issuecomment-389700",
    "user": "dimpase"
}
```

on the other hand, yes, in `polymake/spkg-config.m4` you can do something like 

```
SAGE_SPKG_CONFIGURE([gcc], [
    sage_spkg_install_polymake=yes
    AC_REQUIRE([SAGE_SPKG_CONFIGURE_GMP])
    if test $IS_REALLY_GCC = yes ; then
       AS_CASE(["$GXX_VERSION.0"],
           [[[0-4]].*|5.0.*], [
               SAGE_MUST_INSTALL_GCC([you have $CXX version $GXX_VERSION, which is too old to build polymake])
                ])
    fi
```


but I am not sure whether this would kick in regardless of the experimental status of polymake.

In fact I would be in favours of dropping gcc 4 support completely, and require at least 5.1 globally.



---

archive/issue_comments_389701.json:
```json
{
    "body": "I tried this (see branch) but it seems that this script is always run, even if polymake is not requested. \n----\nNew commits:",
    "created_at": "2019-05-20T13:43:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27616#issuecomment-389701",
    "user": "mkoeppe"
}
```

I tried this (see branch) but it seems that this script is always run, even if polymake is not requested. 
----
New commits:



---

archive/issue_comments_389702.json:
```json
{
    "body": "One can have a `--with-polymake=install` (with default value `no`) switch tested in spkg-config, so that its contents is skipped, unless `install` is given as the value of this parameter. Except this would be a non-standard way to install a package. \n\n[Jeez, how much I hate `sage -i/-f` thing... :-)]",
    "created_at": "2019-05-20T16:24:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27616#issuecomment-389702",
    "user": "dimpase"
}
```

One can have a `--with-polymake=install` (with default value `no`) switch tested in spkg-config, so that its contents is skipped, unless `install` is given as the value of this parameter. Except this would be a non-standard way to install a package. 

[Jeez, how much I hate `sage -i/-f` thing... :-)]



---

archive/issue_comments_389703.json:
```json
{
    "body": "Replying to [comment:6 dimpase]:\n> One can have a `--with-polymake=install` (with default value `no`) switch tested in spkg-config, so that its contents is skipped, unless `install` is given as the value of this parameter. Except this would be a non-standard way to install a package. \n\nHardly an improvement.\n\n> [Jeez, how much I hate `sage -i/-f` thing... :-)]\n\nWhere's the ticket that will change \"sage -i PACKAGE\" to just reconfiguration with \"--enable-PACKAGE\" appended to the configure command line and \"make build\"?",
    "created_at": "2019-05-20T16:34:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27616#issuecomment-389703",
    "user": "mkoeppe"
}
```

Replying to [comment:6 dimpase]:
> One can have a `--with-polymake=install` (with default value `no`) switch tested in spkg-config, so that its contents is skipped, unless `install` is given as the value of this parameter. Except this would be a non-standard way to install a package. 

Hardly an improvement.

> [Jeez, how much I hate `sage -i/-f` thing... :-)]

Where's the ticket that will change "sage -i PACKAGE" to just reconfiguration with "--enable-PACKAGE" appended to the configure command line and "make build"?



---

archive/issue_comments_389704.json:
```json
{
    "body": "You can read on recent (mis)adventures in this domain on #27373, #27642...\n\nFeel free to open such a ticket though and cc me on it.",
    "created_at": "2019-05-20T16:46:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27616#issuecomment-389704",
    "user": "dimpase"
}
```

You can read on recent (mis)adventures in this domain on #27373, #27642...

Feel free to open such a ticket though and cc me on it.



---

archive/issue_comments_389705.json:
```json
{
    "body": "how about we re-target this ticket to bump up the minimal gcc version to 5.1?",
    "created_at": "2019-05-20T17:24:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27616#issuecomment-389705",
    "user": "dimpase"
}
```

how about we re-target this ticket to bump up the minimal gcc version to 5.1?



---

archive/issue_comments_389706.json:
```json
{
    "body": "Replying to [comment:9 dimpase]:\n> how about we re-target this ticket to bump up the minimal gcc version to 5.1?\nIt's better if that goal is not associated with an experimental package.",
    "created_at": "2019-05-20T18:55:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27616#issuecomment-389706",
    "user": "mkoeppe"
}
```

Replying to [comment:9 dimpase]:
> how about we re-target this ticket to bump up the minimal gcc version to 5.1?
It's better if that goal is not associated with an experimental package.



---

archive/issue_comments_389707.json:
```json
{
    "body": "As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).",
    "created_at": "2019-06-14T14:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27616#issuecomment-389707",
    "user": "embray"
}
```

As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).



---

archive/issue_comments_389708.json:
```json
{
    "body": "Moving some tickets to 9.2. This is not a promise that I will be working on them.",
    "created_at": "2020-05-01T18:16:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27616#issuecomment-389708",
    "user": "mkoeppe"
}
```

Moving some tickets to 9.2. This is not a promise that I will be working on them.



---

archive/issue_comments_389709.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27616#issuecomment-389709",
    "user": "mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_389710.json:
```json
{
    "body": "outdated, should close",
    "created_at": "2022-07-27T05:33:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27616#issuecomment-389710",
    "user": "mkoeppe"
}
```

outdated, should close



---

archive/issue_comments_389711.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-07-27T05:33:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27616#issuecomment-389711",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_389712.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-27T08:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27616#issuecomment-389712",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_389713.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2022-08-02T06:31:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27616#issuecomment-389713",
    "user": "mkoeppe"
}
```

Resolution: invalid
