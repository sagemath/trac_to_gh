# Issue 32409: Update package sqlite to 3.36.0

archive/issues_032409.json:
```json
{
    "body": "CC:  dimpase\n\nhttps://repology.org/project/sqlite/versions\n\nOur version is outdated. \n\nAt the same time, we expunge the \"Use newer version of config.guess and config.sub\" workaround from #19711.\n\nIssue created by migration from https://trac.sagemath.org/ticket/32646\n\n",
    "created_at": "2021-10-07T02:07:58Z",
    "labels": [
        "packages: standard",
        "major",
        "bug"
    ],
    "title": "Update package sqlite to 3.36.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32409",
    "user": "mkoeppe"
}
```
CC:  dimpase

https://repology.org/project/sqlite/versions

Our version is outdated. 

At the same time, we expunge the "Use newer version of config.guess and config.sub" workaround from #19711.

Issue created by migration from https://trac.sagemath.org/ticket/32646





---

archive/issue_comments_462316.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-10-07T02:29:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32409#issuecomment-462316",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_462317.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-10-07T02:29:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32409#issuecomment-462317",
    "user": "mkoeppe"
}
```

New commits:



---

archive/issue_comments_462318.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-10-07T09:40:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32409#issuecomment-462318",
    "user": "tmonteil"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_462319.json:
```json
{
    "body": "I got:\n\n\n```\n[sqlite-3.36.0] configure: WARNING: unrecognized options: --disable-maintainer-mode\n[sqlite-3.36.0] Building sqlite-3.36.0\n[sqlite-3.36.0] make[3]: *** No rule to make target 'Makefile.am', needed by 'Makefile.in'.  Stop.\n```\n",
    "created_at": "2021-10-07T09:40:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32409#issuecomment-462319",
    "user": "tmonteil"
}
```

I got:


```
[sqlite-3.36.0] configure: WARNING: unrecognized options: --disable-maintainer-mode
[sqlite-3.36.0] Building sqlite-3.36.0
[sqlite-3.36.0] make[3]: *** No rule to make target 'Makefile.am', needed by 'Makefile.in'.  Stop.
```




---

archive/issue_comments_462320.json:
```json
{
    "body": "not sure, but how about\n\n```diff\n--- a/build/pkgs/sqlite/spkg-install.in\n+++ b/build/pkgs/sqlite/spkg-install.in\n@@ -5,8 +5,8 @@ cd src\n export CPPFLAGS=\"$CPPFLAGS -I$SAGE_LOCAL/include\"\n \n # Trac #32646: configure script does not have --disable-maintainer-mode\n-rm -f configure.ac */configure.ac Makefile.am\n+# rm -f configure.ac */configure.ac Makefile.am\n \n-sdh_configure\n+sdh_configure --disable-dependency-tracking\n sdh_make\n sdh_make_install\n```\n",
    "created_at": "2021-10-07T16:50:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32409#issuecomment-462320",
    "user": "dimpase"
}
```

not sure, but how about

```diff
--- a/build/pkgs/sqlite/spkg-install.in
+++ b/build/pkgs/sqlite/spkg-install.in
@@ -5,8 +5,8 @@ cd src
 export CPPFLAGS="$CPPFLAGS -I$SAGE_LOCAL/include"
 
 # Trac #32646: configure script does not have --disable-maintainer-mode
-rm -f configure.ac */configure.ac Makefile.am
+# rm -f configure.ac */configure.ac Makefile.am
 
-sdh_configure
+sdh_configure --disable-dependency-tracking
 sdh_make
 sdh_make_install
```




---

archive/issue_comments_462321.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-07T18:13:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32409#issuecomment-462321",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462322.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-10-07T18:14:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32409#issuecomment-462322",
    "user": "mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_462323.json:
```json
{
    "body": "Here's a new version",
    "created_at": "2021-10-07T18:14:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32409#issuecomment-462323",
    "user": "mkoeppe"
}
```

Here's a new version



---

archive/issue_comments_462324.json:
```json
{
    "body": "it probably doesn't end there,\nautoreconf typically produces much more stuff.",
    "created_at": "2021-10-07T19:25:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32409#issuecomment-462324",
    "user": "dimpase"
}
```

it probably doesn't end there,
autoreconf typically produces much more stuff.



---

archive/issue_comments_462325.json:
```json
{
    "body": "Do you think that `--disable-dependency-tracking` does not do the trick?",
    "created_at": "2021-10-07T19:27:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32409#issuecomment-462325",
    "user": "dimpase"
}
```

Do you think that `--disable-dependency-tracking` does not do the trick?



---

archive/issue_comments_462326.json:
```json
{
    "body": "Replying to [comment:10 dimpase]:\n> it probably doesn't end there,\n> autoreconf typically produces much more stuff.\nOnly the dependencies triggered by `make` matter.",
    "created_at": "2021-10-07T19:28:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32409#issuecomment-462326",
    "user": "mkoeppe"
}
```

Replying to [comment:10 dimpase]:
> it probably doesn't end there,
> autoreconf typically produces much more stuff.
Only the dependencies triggered by `make` matter.



---

archive/issue_comments_462327.json:
```json
{
    "body": "Replying to [comment:11 dimpase]:\n> Do you think that `--disable-dependency-tracking` does not do the trick?\nThis is completely unrelated -- this is for having the C compiler generate dep files",
    "created_at": "2021-10-07T19:28:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32409#issuecomment-462327",
    "user": "mkoeppe"
}
```

Replying to [comment:11 dimpase]:
> Do you think that `--disable-dependency-tracking` does not do the trick?
This is completely unrelated -- this is for having the C compiler generate dep files



---

archive/issue_comments_462328.json:
```json
{
    "body": "Replying to [comment:12 mkoeppe]:\n> Replying to [comment:10 dimpase]:\n> > it probably doesn't end there,\n> > autoreconf typically produces much more stuff.\n> Only the dependencies triggered by `make` matter.\n\nI am not sure. IIRC aclocal or something like this gets triggered by a skew clock on anything generated by autoreconf, unless there is `AM_MAINTAINER_MODE` present and `--disable-maintainer-mode` supplied.\n\nstuff like autom4te.cache/, info files...",
    "created_at": "2021-10-07T20:19:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32409#issuecomment-462328",
    "user": "dimpase"
}
```

Replying to [comment:12 mkoeppe]:
> Replying to [comment:10 dimpase]:
> > it probably doesn't end there,
> > autoreconf typically produces much more stuff.
> Only the dependencies triggered by `make` matter.

I am not sure. IIRC aclocal or something like this gets triggered by a skew clock on anything generated by autoreconf, unless there is `AM_MAINTAINER_MODE` present and `--disable-maintainer-mode` supplied.

stuff like autom4te.cache/, info files...



---

archive/issue_comments_462329.json:
```json
{
    "body": "This is a very simple package without an m4 subdirectory. If you look at `Makefile.in`, you'll see that in particular `aclocal.m4` has no dependencies other than `configure.ac`.\n(Look for variables with suffix `_deps`).",
    "created_at": "2021-10-08T17:30:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32409#issuecomment-462329",
    "user": "mkoeppe"
}
```

This is a very simple package without an m4 subdirectory. If you look at `Makefile.in`, you'll see that in particular `aclocal.m4` has no dependencies other than `configure.ac`.
(Look for variables with suffix `_deps`).



---

archive/issue_comments_462330.json:
```json
{
    "body": "The current branch works (i doctested the files containing the `sqlite` word).\n\nNote that there are `check` and `installcheck` targets in the Makefile (see the `INSTALL` file).",
    "created_at": "2021-10-08T20:25:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32409#issuecomment-462330",
    "user": "tmonteil"
}
```

The current branch works (i doctested the files containing the `sqlite` word).

Note that there are `check` and `installcheck` targets in the Makefile (see the `INSTALL` file).



---

archive/issue_comments_462331.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-10-14T12:12:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32409#issuecomment-462331",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_462332.json:
```json
{
    "body": "Thanks!",
    "created_at": "2021-10-14T15:24:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32409#issuecomment-462332",
    "user": "mkoeppe"
}
```

Thanks!



---

archive/issue_comments_462333.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-10-19T20:31:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32409#issuecomment-462333",
    "user": "vbraun"
}
```

Resolution: fixed
