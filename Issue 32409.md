# Issue 32409: Update package sqlite to 3.36.0

Issue created by migration from https://trac.sagemath.org/ticket/32646

Original creator: mkoeppe

Original creation time: 2021-10-07 02:07:58

CC:  dimpase

https://repology.org/project/sqlite/versions

Our version is outdated. 

At the same time, we expunge the "Use newer version of config.guess and config.sub" workaround from #19711.


---

Comment by mkoeppe created at 2021-10-07 02:29:58

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2021-10-07 02:29:58

New commits:


---

Comment by tmonteil created at 2021-10-07 09:40:27

Changing status from needs_review to needs_work.


---

Comment by tmonteil created at 2021-10-07 09:40:56

I got:


```
[sqlite-3.36.0] configure: WARNING: unrecognized options: --disable-maintainer-mode
[sqlite-3.36.0] Building sqlite-3.36.0
[sqlite-3.36.0] make[3]: *** No rule to make target 'Makefile.am', needed by 'Makefile.in'.  Stop.
```



---

Comment by dimpase created at 2021-10-07 16:50:45

not sure, but how about

```diff
--- a/build/pkgs/sqlite/spkg-install.in
+++ b/build/pkgs/sqlite/spkg-install.in
@@ -5,8 +5,8 @@ cd src
 export CPPFLAGS="$CPPFLAGS -I$SAGE_LOCAL/include"
 
 # Trac #32646: configure script does not have --disable-maintainer-mode
-rm -f configure.ac */configure.ac Makefile.am
+# rm -f configure.ac */configure.ac Makefile.am
 
-sdh_configure
+sdh_configure --disable-dependency-tracking
 sdh_make
 sdh_make_install
```



---

Comment by git created at 2021-10-07 18:13:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-10-07 18:14:35

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2021-10-07 18:14:35

Here's a new version


---

Comment by dimpase created at 2021-10-07 19:25:39

it probably doesn't end there,
autoreconf typically produces much more stuff.


---

Comment by dimpase created at 2021-10-07 19:27:12

Do you think that `--disable-dependency-tracking` does not do the trick?


---

Comment by mkoeppe created at 2021-10-07 19:28:23

Replying to [comment:10 dimpase]:
> it probably doesn't end there,
> autoreconf typically produces much more stuff.
Only the dependencies triggered by `make` matter.


---

Comment by mkoeppe created at 2021-10-07 19:28:52

Replying to [comment:11 dimpase]:
> Do you think that `--disable-dependency-tracking` does not do the trick?
This is completely unrelated -- this is for having the C compiler generate dep files


---

Comment by dimpase created at 2021-10-07 20:19:08

Replying to [comment:12 mkoeppe]:
> Replying to [comment:10 dimpase]:
> > it probably doesn't end there,
> > autoreconf typically produces much more stuff.
> Only the dependencies triggered by `make` matter.

I am not sure. IIRC aclocal or something like this gets triggered by a skew clock on anything generated by autoreconf, unless there is `AM_MAINTAINER_MODE` present and `--disable-maintainer-mode` supplied.

stuff like autom4te.cache/, info files...


---

Comment by mkoeppe created at 2021-10-08 17:30:24

This is a very simple package without an m4 subdirectory. If you look at `Makefile.in`, you'll see that in particular `aclocal.m4` has no dependencies other than `configure.ac`.
(Look for variables with suffix `_deps`).


---

Comment by tmonteil created at 2021-10-08 20:25:15

The current branch works (i doctested the files containing the `sqlite` word).

Note that there are `check` and `installcheck` targets in the Makefile (see the `INSTALL` file).


---

Comment by dimpase created at 2021-10-14 12:12:40

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2021-10-14 15:24:22

Thanks!


---

Comment by vbraun created at 2021-10-19 20:31:16

Resolution: fixed
