# Issue 22143: update cvxopt to 1.1.9

archive/issues_022143.json:
```json
{
    "body": "CC:  @antonio-rojas @embray @kiwifb @timokau @infinity0 pcpa @saraedum @slel @strogdon @tobihan tmonteil\n\ncvxopt 1.1.9 was released in Nov 2016, so we need to update.\n\nIssue created by migration from https://trac.sagemath.org/ticket/22380\n\n",
    "created_at": "2017-02-14T05:47:28Z",
    "labels": [
        "packages: standard",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "update cvxopt to 1.1.9",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22143",
    "user": "@dimpase"
}
```
CC:  @antonio-rojas @embray @kiwifb @timokau @infinity0 pcpa @saraedum @slel @strogdon @tobihan tmonteil

cvxopt 1.1.9 was released in Nov 2016, so we need to update.

Issue created by migration from https://trac.sagemath.org/ticket/22380





---

archive/issue_comments_307529.json:
```json
{
    "body": "Attachment [LICENSE.txt](tarball://root/attachments/some-uuid/ticket22380/LICENSE.txt) by @dimpase created at 2017-02-14 08:58:46\n\nsuite-sparse license",
    "created_at": "2017-02-14T08:58:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307529",
    "user": "@dimpase"
}
```

Attachment [LICENSE.txt](tarball://root/attachments/some-uuid/ticket22380/LICENSE.txt) by @dimpase created at 2017-02-14 08:58:46

suite-sparse license



---

archive/issue_comments_307530.json:
```json
{
    "body": "the 1st task would be to understand whether the Suite tarfile needs to be cut to exclude non-GPL compatible parts (see attachment)...",
    "created_at": "2017-02-14T09:05:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307530",
    "user": "@dimpase"
}
```

the 1st task would be to understand whether the Suite tarfile needs to be cut to exclude non-GPL compatible parts (see attachment)...



---

archive/issue_comments_307531.json:
```json
{
    "body": "I don't know about debian and other but we split `suitesparse` in components in Gentoo. I would be shocked if the other didn't do the same. It looks like upstream integrated a lot of the autoconfig patches that were floating around which makes life easier.\nWhat cvxopt needs:\n* suitesparseconfig\n   *amd\n     *umfpack\n  *colamd\n     *cholmod\n\nIndentation is for dependency. That's without optional or more complicated configuration - a minimal setup (although options using blas/lapack could be enabled without extra burden). All the above in mimimum configuration is LGPL 2.1. In non-mimimum configuration some switch to GPL-2.",
    "created_at": "2017-02-14T09:52:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307531",
    "user": "@kiwifb"
}
```

I don't know about debian and other but we split `suitesparse` in components in Gentoo. I would be shocked if the other didn't do the same. It looks like upstream integrated a lot of the autoconfig patches that were floating around which makes life easier.
What cvxopt needs:
* suitesparseconfig
   *amd
     *umfpack
  *colamd
     *cholmod

Indentation is for dependency. That's without optional or more complicated configuration - a minimal setup (although options using blas/lapack could be enabled without extra burden). All the above in mimimum configuration is LGPL 2.1. In non-mimimum configuration some switch to GPL-2.



---

archive/issue_comments_307532.json:
```json
{
    "body": "From `setup.py` - this can all be overridden, but it horrifies me\n\n```\n# Guess SUITESPARSE_LIB_DIR and SUITESPARSE_INC_DIR\nif platform.platform().startswith(\"Darwin\"):\n    # macOS\n    SUITESPARSE_LIB_DIR = '/usr/local/lib'\n    SUITESPARSE_INC_DIR = '/usr/local/include'\nelse: \n    # default: Ubuntu/Debian\n    SUITESPARSE_LIB_DIR = \"/usr/lib/x86_64-linux-gnu\"\n    SUITESPARSE_INC_DIR = \"/usr/include/suitesparse\"\n```\n\nThe only line that is valid is the default include directory for debian. The rest is accessible by default without defining anything.\nBasically it destroys stuff that would work out of the box without any values. This is relevant in that it means we will have to override things manually when it could work out of the box if left alone. That's not just `suitesparse`. gsl, glpk...\nOf course there are limitations of distutils that complicate things (an empty `includedir` statement generate a `-I` in the compilation line instead of nothing at all, the compiler then gets confused. The best default is probably '.' if you have to put something).",
    "created_at": "2017-02-15T00:28:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307532",
    "user": "@kiwifb"
}
```

From `setup.py` - this can all be overridden, but it horrifies me

```
# Guess SUITESPARSE_LIB_DIR and SUITESPARSE_INC_DIR
if platform.platform().startswith("Darwin"):
    # macOS
    SUITESPARSE_LIB_DIR = '/usr/local/lib'
    SUITESPARSE_INC_DIR = '/usr/local/include'
else: 
    # default: Ubuntu/Debian
    SUITESPARSE_LIB_DIR = "/usr/lib/x86_64-linux-gnu"
    SUITESPARSE_INC_DIR = "/usr/include/suitesparse"
```

The only line that is valid is the default include directory for debian. The rest is accessible by default without defining anything.
Basically it destroys stuff that would work out of the box without any values. This is relevant in that it means we will have to override things manually when it could work out of the box if left alone. That's not just `suitesparse`. gsl, glpk...
Of course there are limitations of distutils that complicate things (an empty `includedir` statement generate a `-I` in the compilation line instead of nothing at all, the compiler then gets confused. The best default is probably '.' if you have to put something).



---

archive/issue_comments_307533.json:
```json
{
    "body": "Good news, `cvxopt-1.1.9` is in gentoo now and no doctests were harmed by the upgrade in sage-on-gentoo. The bad news is that writing the spkgs for this is not high on my TODO list.",
    "created_at": "2017-03-04T20:24:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307533",
    "user": "@kiwifb"
}
```

Good news, `cvxopt-1.1.9` is in gentoo now and no doctests were harmed by the upgrade in sage-on-gentoo. The bad news is that writing the spkgs for this is not high on my TODO list.



---

archive/issue_comments_307534.json:
```json
{
    "body": "Sage-on-Gentoo just upgraded to cvxopt 1.2.1.\n\nSee https://github.com/cschwan/sage-on-gentoo/issues/524",
    "created_at": "2018-10-18T05:08:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307534",
    "user": "@slel"
}
```

Sage-on-Gentoo just upgraded to cvxopt 1.2.1.

See https://github.com/cschwan/sage-on-gentoo/issues/524



---

archive/issue_comments_307535.json:
```json
{
    "body": "Changing keywords from \"\" to \"upgrade, cvxopt\".",
    "created_at": "2018-10-18T05:08:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307535",
    "user": "@slel"
}
```

Changing keywords from "" to "upgrade, cvxopt".



---

archive/issue_comments_307536.json:
```json
{
    "body": "It would be great if Gentoo's suite-sparse can be lifted to become a Sage package.\n\nFor starters I should get sage-on-gentoo running on my Gentoo laptop.\nHow do I start with it?",
    "created_at": "2018-10-18T10:08:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307536",
    "user": "@dimpase"
}
```

It would be great if Gentoo's suite-sparse can be lifted to become a Sage package.

For starters I should get sage-on-gentoo running on my Gentoo laptop.
How do I start with it?



---

archive/issue_comments_307537.json:
```json
{
    "body": "Replying to [comment:6 dimpase]:\n> It would be great if Gentoo's suite-sparse can be lifted to become a Sage package.\n> \n> For starters I should get sage-on-gentoo running on my Gentoo laptop.\n> How do I start with it?\n\nWell we are a bit old school but the instructions of the README at https://github.com/cschwan/sage-on-gentoo are still working. One day I'll update them to something a little bit more modern. Note that you also need the science overlay. I won't finish sage 8.4 tongiht I am afraid. Too much to do, it will be ready in 12 hours.",
    "created_at": "2018-10-18T10:40:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307537",
    "user": "@kiwifb"
}
```

Replying to [comment:6 dimpase]:
> It would be great if Gentoo's suite-sparse can be lifted to become a Sage package.
> 
> For starters I should get sage-on-gentoo running on my Gentoo laptop.
> How do I start with it?

Well we are a bit old school but the instructions of the README at https://github.com/cschwan/sage-on-gentoo are still working. One day I'll update them to something a little bit more modern. Note that you also need the science overlay. I won't finish sage 8.4 tongiht I am afraid. Too much to do, it will be ready in 12 hours.



---

archive/issue_comments_307538.json:
```json
{
    "body": "Note: cvxopt 1.2.2 was released a few days ago.",
    "created_at": "2018-10-23T10:11:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307538",
    "user": "@Konrad127123"
}
```

Note: cvxopt 1.2.2 was released a few days ago.



---

archive/issue_comments_307539.json:
```json
{
    "body": "Updating ticket description following the release of cvxopt 1.2.2.",
    "created_at": "2018-10-23T16:08:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307539",
    "user": "@slel"
}
```

Updating ticket description following the release of cvxopt 1.2.2.



---

archive/issue_comments_307540.json:
```json
{
    "body": "Replying to [comment:7 fbissey]:\n\n> Well we are a bit old school but the instructions of the README at https://github.com/cschwan/sage-on-gentoo are still working. \n\nA somewhat cryptic error:\n\n```\n!!! The ebuild selected to satisfy \"sage\" has unmet requirements.\n- sci-mathematics/sage-8.4::sage-on-gentoo USE=\"X doc-html-bin -bliss -debug -doc-html -doc-pdf -doc-pdf-bin -jmol -latex -modular_decomposition -sagenb -testsuite\" ABI_X86=\"(64)\" L10N=\"-ca -de -en -es -fr -hu -it -ja -pt -ru -tr\" PYTHON_TARGETS=\"python2_7 python3_6\"\n\n  The following REQUIRED_USE flag constraints are unsatisfied:\n    doc-html-bin? ( l10n_en )\n\n  The above constraints are a subset of the following complete expression:\n    doc-html? ( l10n_en sagenb ) doc-pdf? ( sagenb ) testsuite? ( any-of ( doc-html doc-html-bin ) ) doc-html-bin? ( !doc-html !doc-pdf l10n_en ) doc-pdf-bin? ( !doc-html !doc-pdf l10n_en ) any-of ( python_targets_python2_7 python_targets_python3_6 )\n```\n\n\nno idea what's wrong. Changing `doc-html-bin` to `-doc-html-bin` allows the build to go forward.",
    "created_at": "2018-10-27T08:41:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307540",
    "user": "@dimpase"
}
```

Replying to [comment:7 fbissey]:

> Well we are a bit old school but the instructions of the README at https://github.com/cschwan/sage-on-gentoo are still working. 

A somewhat cryptic error:

```
!!! The ebuild selected to satisfy "sage" has unmet requirements.
- sci-mathematics/sage-8.4::sage-on-gentoo USE="X doc-html-bin -bliss -debug -doc-html -doc-pdf -doc-pdf-bin -jmol -latex -modular_decomposition -sagenb -testsuite" ABI_X86="(64)" L10N="-ca -de -en -es -fr -hu -it -ja -pt -ru -tr" PYTHON_TARGETS="python2_7 python3_6"

  The following REQUIRED_USE flag constraints are unsatisfied:
    doc-html-bin? ( l10n_en )

  The above constraints are a subset of the following complete expression:
    doc-html? ( l10n_en sagenb ) doc-pdf? ( sagenb ) testsuite? ( any-of ( doc-html doc-html-bin ) ) doc-html-bin? ( !doc-html !doc-pdf l10n_en ) doc-pdf-bin? ( !doc-html !doc-pdf l10n_en ) any-of ( python_targets_python2_7 python_targets_python3_6 )
```


no idea what's wrong. Changing `doc-html-bin` to `-doc-html-bin` allows the build to go forward.



---

archive/issue_comments_307541.json:
```json
{
    "body": "That's part of the possible useflags. Basically I allow you to choose which language you want to build but because the english version is the only complete one, if you elect to have documentation, the english one is compulsory. Put \n\n```\nL10N=\"en\"\n```\n\nin `make.conf` and you'll get pre-built english documentation installed.",
    "created_at": "2018-10-27T08:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307541",
    "user": "@kiwifb"
}
```

That's part of the possible useflags. Basically I allow you to choose which language you want to build but because the english version is the only complete one, if you elect to have documentation, the english one is compulsory. Put 

```
L10N="en"
```

in `make.conf` and you'll get pre-built english documentation installed.



---

archive/issue_comments_307542.json:
```json
{
    "body": "I am going to make an attempt at a \"reduced\" suitesparse spkg. Reduced because I will not make default packages (which aren't used by anything else) that use cmake. Note that suitesparse will move to cmake for the whole thing in the near future.\n\nThe fun bit is that suitesparse is effectively a small mini distribution itself (but most of the upstreams are now totally absorbed by the project). It doesn't currently work very nicely with building phases unless we break down the various components. It does install directly on the file system and because it is like a mini distribution, trying to stop it will break the build system (where are my libraries and my include files).\n\nOnce it is completely cmake-ified it may actually behave better in that respect.",
    "created_at": "2018-11-01T22:57:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307542",
    "user": "@kiwifb"
}
```

I am going to make an attempt at a "reduced" suitesparse spkg. Reduced because I will not make default packages (which aren't used by anything else) that use cmake. Note that suitesparse will move to cmake for the whole thing in the near future.

The fun bit is that suitesparse is effectively a small mini distribution itself (but most of the upstreams are now totally absorbed by the project). It doesn't currently work very nicely with building phases unless we break down the various components. It does install directly on the file system and because it is like a mini distribution, trying to stop it will break the build system (where are my libraries and my include files).

Once it is completely cmake-ified it may actually behave better in that respect.



---

archive/issue_comments_307543.json:
```json
{
    "body": "`SPKG.txt` for suitesparse needs a bit of polish but this is a good start for anyone who wants to tests this. This is open for reviews even though I am expecting a bit more work needs to be done.\n----\nNew commits:",
    "created_at": "2018-11-02T08:40:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307543",
    "user": "@kiwifb"
}
```

`SPKG.txt` for suitesparse needs a bit of polish but this is a good start for anyone who wants to tests this. This is open for reviews even though I am expecting a bit more work needs to be done.
----
New commits:



---

archive/issue_comments_307544.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-11-02T08:40:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307544",
    "user": "@kiwifb"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_307545.json:
```json
{
    "body": "I'm getting an `Invalid checksum` error for `cvxopt-1.2.2.tar.gz`.\n\n`cvxopt/checksums.ini` says:\n\n```\ntarball=cvxopt-VERSION.tar.gz\nsha1=725ce85fe122cd0fcda9d1b1a45ae43adf6fea2c\nmd5=ef9ab5f939380e9488e57b113103d96a\ncksum=4099798435\n```\n\nbut I get:\n\n```\n$ sha1sum ../../upstream/cvxopt-1.2.2.tar.gz \n43113a138e5e8f3ba42dc53ccb8c3c7501d5576b  ../../upstream/cvxopt-1.2.2.tar.gz\n$ md5sum ../../upstream/cvxopt-1.2.2.tar.gz \nfc2546fdba2faa6c4996e9b40fce5269  ../../upstream/cvxopt-1.2.2.tar.gz\n$ cksum ../../upstream/cvxopt-1.2.2.tar.gz\n3288957477 1877253 ../../upstream/cvxopt-1.2.2.tar.gz\n```\n",
    "created_at": "2018-11-02T11:02:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307545",
    "user": "@Konrad127123"
}
```

I'm getting an `Invalid checksum` error for `cvxopt-1.2.2.tar.gz`.

`cvxopt/checksums.ini` says:

```
tarball=cvxopt-VERSION.tar.gz
sha1=725ce85fe122cd0fcda9d1b1a45ae43adf6fea2c
md5=ef9ab5f939380e9488e57b113103d96a
cksum=4099798435
```

but I get:

```
$ sha1sum ../../upstream/cvxopt-1.2.2.tar.gz 
43113a138e5e8f3ba42dc53ccb8c3c7501d5576b  ../../upstream/cvxopt-1.2.2.tar.gz
$ md5sum ../../upstream/cvxopt-1.2.2.tar.gz 
fc2546fdba2faa6c4996e9b40fce5269  ../../upstream/cvxopt-1.2.2.tar.gz
$ cksum ../../upstream/cvxopt-1.2.2.tar.gz
3288957477 1877253 ../../upstream/cvxopt-1.2.2.tar.gz
```




---

archive/issue_comments_307546.json:
```json
{
    "body": "My bad I used the wrong tarball (github instead of pypi) when creating the checksum. I'll fix it shortly.",
    "created_at": "2018-11-02T18:42:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307546",
    "user": "@kiwifb"
}
```

My bad I used the wrong tarball (github instead of pypi) when creating the checksum. I'll fix it shortly.



---

archive/issue_comments_307547.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-02T18:45:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307547",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_307548.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-02T22:34:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307548",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_307549.json:
```json
{
    "body": "I would be OK for things to ship as they are now but I am open to suggestions. An alternative is to split `SuiteSparse` into components but that's more work.",
    "created_at": "2018-11-02T22:36:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307549",
    "user": "@kiwifb"
}
```

I would be OK for things to ship as they are now but I am open to suggestions. An alternative is to split `SuiteSparse` into components but that's more work.



---

archive/issue_comments_307550.json:
```json
{
    "body": "Building with `SAGE_CHECK=\"yes\"` still fails when running headless (#24657).",
    "created_at": "2018-11-07T12:05:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307550",
    "user": "@Konrad127123"
}
```

Building with `SAGE_CHECK="yes"` still fails when running headless (#24657).



---

archive/issue_comments_307551.json:
```json
{
    "body": "I see, I was not aware of this issue. I see that matplotlib is involved, probably in the same way some doctest could be failing on debian. That will require some code inspection.",
    "created_at": "2018-11-07T18:58:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307551",
    "user": "@kiwifb"
}
```

I see, I was not aware of this issue. I see that matplotlib is involved, probably in the same way some doctest could be failing on debian. That will require some code inspection.



---

archive/issue_comments_307552.json:
```json
{
    "body": "Without openmp, or with openmp installed in /usr/local/, I get\nI get \n\n```\n[suitesparse-5.3.0] /usr/bin/ld: error: unable to find library -lomp\n[suitesparse-5.3.0] cc: error: linker command failed with exit code 1 (use -v to see invocation)\n```\n\nIs openmp a pre-req?\n\nOne way or another, the installation ought to be smarter as far as the location of openmp is concerned.",
    "created_at": "2018-11-27T22:34:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307552",
    "user": "@dimpase"
}
```

Without openmp, or with openmp installed in /usr/local/, I get
I get 

```
[suitesparse-5.3.0] /usr/bin/ld: error: unable to find library -lomp
[suitesparse-5.3.0] cc: error: linker command failed with exit code 1 (use -v to see invocation)
```

Is openmp a pre-req?

One way or another, the installation ought to be smarter as far as the location of openmp is concerned.



---

archive/issue_comments_307553.json:
```json
{
    "body": "Yes it should be smarter. Now can you give me more info? Is this OS X? which sub-package of suitesparse? In short a longer log please.",
    "created_at": "2018-11-27T22:37:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307553",
    "user": "@kiwifb"
}
```

Yes it should be smarter. Now can you give me more info? Is this OS X? which sub-package of suitesparse? In short a longer log please.



---

archive/issue_comments_307554.json:
```json
{
    "body": "This is FreeBSD 12.0. With openmp installed (in /usr/local, which is \"standard\" location on such a system), everything works (passes relevant Sage tests too) if I export `LDFLAGS=\"$LDFLAGS -L/usr/local/lib\"` before installation. If LDFLAGS are not passed, it breaks at CHOLMOD as follows:\n\n```\n...\n[suitesparse-5.3.0] a - cholmod_l_nesdis.o\n[suitesparse-5.3.0] a - cholmod_l_camd.o\n[suitesparse-5.3.0] cc -L/usr/home/dimpase/Sage/sagemath/local/lib -Wl,-rpath,/usr/home/dimpase/Sage/sagemath/local/lib  -L/usr/home/dimpase/Sage/sagemath/local/lib -L/usr/home/dimpase/Sage/sagemath/local/lib -L/usr/home/dimpase/Sage/sagemath/local/lib -shared -Wl,-soname -Wl,libcholmod.so.3 -Wl,--no-undefined -fopenmp cholmod_aat.o cholmod_add.o cholmod_band.o cholmod_change_factor.o cholmod_common.o cholmod_complex.o cholmod_copy.o cholmod_dense.o cholmod_error.o cholmod_factor.o cholmod_memory.o cholmod_sparse.o cholmod_transpose.o cholmod_triplet.o cholmod_version.o cholmod_check.o cholmod_read.o cholmod_write.o cholmod_amd.o cholmod_analyze.o cholmod_colamd.o cholmod_etree.o cholmod_factorize.o cholmod_postorder.o cholmod_rcond.o cholmod_resymbol.o cholmod_rowcolcounts.o cholmod_rowfac.o cholmod_solve.o cholmod_spsolve.o cholmod_drop.o cholmod_horzcat.o cholmod_norm.o cholmod_scale.o cholmod_sdmult.o cholmod_ssmult.o cholmod_submatrix.o cholmod_vertcat.o cholmod_symmetry.o cholmod_rowadd.o cholmod_rowdel.o cholmod_updown.o cholmod_super_numeric.o cholmod_super_solve.o cholmod_super_symbolic.o cholmod_ccolamd.o cholmod_csymamd.o cholmod_metis.o cholmod_nesdis.o cholmod_camd.o cholmod_l_aat.o cholmod_l_add.o cholmod_l_band.o cholmod_l_change_factor.o cholmod_l_common.o cholmod_l_complex.o cholmod_l_copy.o cholmod_l_dense.o cholmod_l_error.o cholmod_l_factor.o cholmod_l_memory.o cholmod_l_sparse.o cholmod_l_transpose.o cholmod_l_triplet.o cholmod_l_version.o cholmod_l_check.o cholmod_l_read.o cholmod_l_write.o cholmod_l_amd.o cholmod_l_analyze.o cholmod_l_colamd.o cholmod_l_etree.o cholmod_l_factorize.o cholmod_l_postorder.o cholmod_l_rcond.o cholmod_l_resymbol.o cholmod_l_rowcolcounts.o cholmod_l_rowfac.o cholmod_l_solve.o cholmod_l_spsolve.o cholmod_l_drop.o cholmod_l_horzcat.o cholmod_l_norm.o cholmod_l_scale.o cholmod_l_sdmult.o cholmod_l_ssmult.o cholmod_l_submatrix.o cholmod_l_vertcat.o cholmod_l_symmetry.o cholmod_l_rowadd.o cholmod_l_rowdel.o cholmod_l_updown.o cholmod_l_super_numeric.o cholmod_l_super_solve.o cholmod_l_super_symbolic.o cholmod_l_ccolamd.o cholmod_l_csymamd.o cholmod_l_metis.o cholmod_l_nesdis.o cholmod_l_camd.o -o /usr/home/dimpase/Sage/sagemath/local/lib/libcholmod.so.3.0.12 -lm -lamd -lcolamd -lsuitesparseconfig -lccolamd -lcamd -lopenblas  -lopenblas \n[suitesparse-5.3.0] ranlib libcholmod.a\n[suitesparse-5.3.0] /usr/bin/ld: error: unable to find library -lomp\n[suitesparse-5.3.0] cc: error: linker command failed with exit code 1 (use -v to see invocation)\n[suitesparse-5.3.0] gmake[4]: *** [Makefile:544: /usr/home/dimpase/Sage/sagemath/local/lib/libcholmod.so.3.0.12] Error 1\n[suitesparse-5.3.0] gmake[4]: Leaving directory '/usr/home/dimpase/Sage/sagemath/local/var/tmp/sage/build/suitesparse-5.3.0/src/CHOLMOD/Lib'\n```\n\n\nAnd with openmp not installed, it also breaks at CHOLMOD, although the output is differently ordered, somehow.\n\n```\n...\n[suitesparse-5.3.0] a - cholmod_l_nesdis.o\n[suitesparse-5.3.0] a - cholmod_l_camd.o\n[suitesparse-5.3.0] ranlib libcholmod.a\n[suitesparse-5.3.0] /usr/bin/ld: error: unable to find library -lomp\n[suitesparse-5.3.0] cc: error: linker command failed with exit code 1 (use -v to see invocation)\n[suitesparse-5.3.0] gmake[4]: *** [Makefile:544: /usr/home/dimpase/Sage/sagemath/local/lib/libcholmod.so.3.0.12] Error 1\n[suitesparse-5.3.0] gmake[4]: Leaving directory '/usr/home/dimpase/Sage/sagemath/local/var/tmp/sage/build/suitesparse-5.3.0/src/CHOLMOD/Lib'\n```\n",
    "created_at": "2018-11-27T22:47:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307554",
    "user": "@dimpase"
}
```

This is FreeBSD 12.0. With openmp installed (in /usr/local, which is "standard" location on such a system), everything works (passes relevant Sage tests too) if I export `LDFLAGS="$LDFLAGS -L/usr/local/lib"` before installation. If LDFLAGS are not passed, it breaks at CHOLMOD as follows:

```
...
[suitesparse-5.3.0] a - cholmod_l_nesdis.o
[suitesparse-5.3.0] a - cholmod_l_camd.o
[suitesparse-5.3.0] cc -L/usr/home/dimpase/Sage/sagemath/local/lib -Wl,-rpath,/usr/home/dimpase/Sage/sagemath/local/lib  -L/usr/home/dimpase/Sage/sagemath/local/lib -L/usr/home/dimpase/Sage/sagemath/local/lib -L/usr/home/dimpase/Sage/sagemath/local/lib -shared -Wl,-soname -Wl,libcholmod.so.3 -Wl,--no-undefined -fopenmp cholmod_aat.o cholmod_add.o cholmod_band.o cholmod_change_factor.o cholmod_common.o cholmod_complex.o cholmod_copy.o cholmod_dense.o cholmod_error.o cholmod_factor.o cholmod_memory.o cholmod_sparse.o cholmod_transpose.o cholmod_triplet.o cholmod_version.o cholmod_check.o cholmod_read.o cholmod_write.o cholmod_amd.o cholmod_analyze.o cholmod_colamd.o cholmod_etree.o cholmod_factorize.o cholmod_postorder.o cholmod_rcond.o cholmod_resymbol.o cholmod_rowcolcounts.o cholmod_rowfac.o cholmod_solve.o cholmod_spsolve.o cholmod_drop.o cholmod_horzcat.o cholmod_norm.o cholmod_scale.o cholmod_sdmult.o cholmod_ssmult.o cholmod_submatrix.o cholmod_vertcat.o cholmod_symmetry.o cholmod_rowadd.o cholmod_rowdel.o cholmod_updown.o cholmod_super_numeric.o cholmod_super_solve.o cholmod_super_symbolic.o cholmod_ccolamd.o cholmod_csymamd.o cholmod_metis.o cholmod_nesdis.o cholmod_camd.o cholmod_l_aat.o cholmod_l_add.o cholmod_l_band.o cholmod_l_change_factor.o cholmod_l_common.o cholmod_l_complex.o cholmod_l_copy.o cholmod_l_dense.o cholmod_l_error.o cholmod_l_factor.o cholmod_l_memory.o cholmod_l_sparse.o cholmod_l_transpose.o cholmod_l_triplet.o cholmod_l_version.o cholmod_l_check.o cholmod_l_read.o cholmod_l_write.o cholmod_l_amd.o cholmod_l_analyze.o cholmod_l_colamd.o cholmod_l_etree.o cholmod_l_factorize.o cholmod_l_postorder.o cholmod_l_rcond.o cholmod_l_resymbol.o cholmod_l_rowcolcounts.o cholmod_l_rowfac.o cholmod_l_solve.o cholmod_l_spsolve.o cholmod_l_drop.o cholmod_l_horzcat.o cholmod_l_norm.o cholmod_l_scale.o cholmod_l_sdmult.o cholmod_l_ssmult.o cholmod_l_submatrix.o cholmod_l_vertcat.o cholmod_l_symmetry.o cholmod_l_rowadd.o cholmod_l_rowdel.o cholmod_l_updown.o cholmod_l_super_numeric.o cholmod_l_super_solve.o cholmod_l_super_symbolic.o cholmod_l_ccolamd.o cholmod_l_csymamd.o cholmod_l_metis.o cholmod_l_nesdis.o cholmod_l_camd.o -o /usr/home/dimpase/Sage/sagemath/local/lib/libcholmod.so.3.0.12 -lm -lamd -lcolamd -lsuitesparseconfig -lccolamd -lcamd -lopenblas  -lopenblas 
[suitesparse-5.3.0] ranlib libcholmod.a
[suitesparse-5.3.0] /usr/bin/ld: error: unable to find library -lomp
[suitesparse-5.3.0] cc: error: linker command failed with exit code 1 (use -v to see invocation)
[suitesparse-5.3.0] gmake[4]: *** [Makefile:544: /usr/home/dimpase/Sage/sagemath/local/lib/libcholmod.so.3.0.12] Error 1
[suitesparse-5.3.0] gmake[4]: Leaving directory '/usr/home/dimpase/Sage/sagemath/local/var/tmp/sage/build/suitesparse-5.3.0/src/CHOLMOD/Lib'
```


And with openmp not installed, it also breaks at CHOLMOD, although the output is differently ordered, somehow.

```
...
[suitesparse-5.3.0] a - cholmod_l_nesdis.o
[suitesparse-5.3.0] a - cholmod_l_camd.o
[suitesparse-5.3.0] ranlib libcholmod.a
[suitesparse-5.3.0] /usr/bin/ld: error: unable to find library -lomp
[suitesparse-5.3.0] cc: error: linker command failed with exit code 1 (use -v to see invocation)
[suitesparse-5.3.0] gmake[4]: *** [Makefile:544: /usr/home/dimpase/Sage/sagemath/local/lib/libcholmod.so.3.0.12] Error 1
[suitesparse-5.3.0] gmake[4]: Leaving directory '/usr/home/dimpase/Sage/sagemath/local/var/tmp/sage/build/suitesparse-5.3.0/src/CHOLMOD/Lib'
```




---

archive/issue_comments_307555.json:
```json
{
    "body": "Yes it is unusual. And very strange. There is some control for openmp in the main makefile I think so it has to be turned off there (or autodetected properly there). But not finding stuff in `/usr/local/lib` is highly unusual - and it appears this is not your compiler's fault but ld's fault. Is it GNU ld, some kind of BSD ld or llvm's ld?",
    "created_at": "2018-11-27T22:56:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307555",
    "user": "@kiwifb"
}
```

Yes it is unusual. And very strange. There is some control for openmp in the main makefile I think so it has to be turned off there (or autodetected properly there). But not finding stuff in `/usr/local/lib` is highly unusual - and it appears this is not your compiler's fault but ld's fault. Is it GNU ld, some kind of BSD ld or llvm's ld?



---

archive/issue_comments_307556.json:
```json
{
    "body": "Is there urgency to have this in 8.5? I have been thinking that I have a longer time frame I may want to try splitting suitesparse into just the components needed for cvxopt.",
    "created_at": "2018-11-27T22:57:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307556",
    "user": "@kiwifb"
}
```

Is there urgency to have this in 8.5? I have been thinking that I have a longer time frame I may want to try splitting suitesparse into just the components needed for cvxopt.



---

archive/issue_comments_307557.json:
```json
{
    "body": "PS. I hear that openmp support on OSX is an especially brutal form of hell, so it has got to be tested there too.",
    "created_at": "2018-11-27T22:57:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307557",
    "user": "@dimpase"
}
```

PS. I hear that openmp support on OSX is an especially brutal form of hell, so it has got to be tested there too.



---

archive/issue_comments_307558.json:
```json
{
    "body": "Replying to [comment:26 dimpase]:\n> PS. I hear that openmp support on OSX is an especially brutal form of hell, so it has got to be tested there too.\n\nIf I remember correctly it is just turned off as soon as darwin is detected.",
    "created_at": "2018-11-27T22:58:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307558",
    "user": "@kiwifb"
}
```

Replying to [comment:26 dimpase]:
> PS. I hear that openmp support on OSX is an especially brutal form of hell, so it has got to be tested there too.

If I remember correctly it is just turned off as soon as darwin is detected.



---

archive/issue_comments_307559.json:
```json
{
    "body": "For one, if openmp is not installed then `-fopenmp` should not even be mentioned in the calls, but it does get mentioned.",
    "created_at": "2018-11-27T22:59:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307559",
    "user": "@dimpase"
}
```

For one, if openmp is not installed then `-fopenmp` should not even be mentioned in the calls, but it does get mentioned.



---

archive/issue_comments_307560.json:
```json
{
    "body": "We unfortunately deal with a meta build driven by a master makefile. No configuration is done apart possibly some flags passed to make.",
    "created_at": "2018-11-27T23:01:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307560",
    "user": "@kiwifb"
}
```

We unfortunately deal with a meta build driven by a master makefile. No configuration is done apart possibly some flags passed to make.



---

archive/issue_comments_307561.json:
```json
{
    "body": "The good stuff to look at configuration and what they do `SuiteSparse_config/SuiteSparse_config.mk` and to see what happen with the flags you want `make ${my_flags} config` I actually run it at the beginning of the build so it is logged. Setting `CFOPENMP=\"\"` should kill openmp.",
    "created_at": "2018-11-27T23:08:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307561",
    "user": "@kiwifb"
}
```

The good stuff to look at configuration and what they do `SuiteSparse_config/SuiteSparse_config.mk` and to see what happen with the flags you want `make ${my_flags} config` I actually run it at the beginning of the build so it is logged. Setting `CFOPENMP=""` should kill openmp.



---

archive/issue_comments_307562.json:
```json
{
    "body": "I'd rather see a way to use system's SuiteSparse (as in #26286) rather than spending time on cutting custom tarballs...",
    "created_at": "2018-11-27T23:14:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307562",
    "user": "@dimpase"
}
```

I'd rather see a way to use system's SuiteSparse (as in #26286) rather than spending time on cutting custom tarballs...



---

archive/issue_comments_307563.json:
```json
{
    "body": "A lot of system split suitesparse so we would have to check the components individually. In any case I would not use spkg-src to make little tarballs. I would deal with it the same way gfortran and gcc are dealt with but on a bigger scale.",
    "created_at": "2018-11-27T23:16:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307563",
    "user": "@kiwifb"
}
```

A lot of system split suitesparse so we would have to check the components individually. In any case I would not use spkg-src to make little tarballs. I would deal with it the same way gfortran and gcc are dealt with but on a bigger scale.



---

archive/issue_comments_307564.json:
```json
{
    "body": "Replying to [comment:24 fbissey]:\n> Yes it is unusual. And very strange. There is some control for openmp in the main makefile I think so it has to be turned off there (or autodetected properly there). But not finding stuff in `/usr/local/lib` is highly unusual - and it appears this is not your compiler's fault but ld's fault. Is it GNU ld, some kind of BSD ld or llvm's ld?\n\n\n```\n$ ld -v\nLLD 6.0.1 (FreeBSD 335540-1200005) (compatible with GNU linkers)\n```\n",
    "created_at": "2018-11-27T23:17:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307564",
    "user": "@dimpase"
}
```

Replying to [comment:24 fbissey]:
> Yes it is unusual. And very strange. There is some control for openmp in the main makefile I think so it has to be turned off there (or autodetected properly there). But not finding stuff in `/usr/local/lib` is highly unusual - and it appears this is not your compiler's fault but ld's fault. Is it GNU ld, some kind of BSD ld or llvm's ld?


```
$ ld -v
LLD 6.0.1 (FreeBSD 335540-1200005) (compatible with GNU linkers)
```




---

archive/issue_comments_307565.json:
```json
{
    "body": "I believe this is llvm's `ld` then.",
    "created_at": "2018-11-27T23:20:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307565",
    "user": "@kiwifb"
}
```

I believe this is llvm's `ld` then.



---

archive/issue_comments_307566.json:
```json
{
    "body": "Replying to [comment:34 fbissey]:\n> I believe this is llvm's `ld` then.\n\nyep. If it is called directly, it does not know where to look for libraries, so one much pass \n`-L/lib -L/usr/lib -L` etc to it.",
    "created_at": "2018-11-27T23:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307566",
    "user": "@dimpase"
}
```

Replying to [comment:34 fbissey]:
> I believe this is llvm's `ld` then.

yep. If it is called directly, it does not know where to look for libraries, so one much pass 
`-L/lib -L/usr/lib -L` etc to it.



---

archive/issue_comments_307567.json:
```json
{
    "body": "Replying to [comment:35 dimpase]:\n> Replying to [comment:34 fbissey]:\n> > I believe this is llvm's `ld` then.\n> \n> yep. If it is called directly, it does not know where to look for libraries, so one much pass \n> `-L/lib -L/usr/lib -L` etc to it.\n\nDefinitely not called directly (I checked) the compiler is called to do the linking so `-fopenmp` should set all the flags properly. I am calling that a bug in linking driver of the compiler.",
    "created_at": "2018-11-27T23:43:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307567",
    "user": "@kiwifb"
}
```

Replying to [comment:35 dimpase]:
> Replying to [comment:34 fbissey]:
> > I believe this is llvm's `ld` then.
> 
> yep. If it is called directly, it does not know where to look for libraries, so one much pass 
> `-L/lib -L/usr/lib -L` etc to it.

Definitely not called directly (I checked) the compiler is called to do the linking so `-fopenmp` should set all the flags properly. I am calling that a bug in linking driver of the compiler.



---

archive/issue_comments_307568.json:
```json
{
    "body": "Replying to [comment:36 fbissey]:\n> Replying to [comment:35 dimpase]:\n> > Replying to [comment:34 fbissey]:\n> > > I believe this is llvm's `ld` then.\n> > \n> > yep. If it is called directly, it does not know where to look for libraries, so one much pass \n> > `-L/lib -L/usr/lib -L` etc to it.\n> \n> Definitely not called directly (I checked) the compiler is called to do the linking so `-fopenmp` should set all the flags properly. I am calling that a bug in linking driver of the compiler.\n\nI think I agree. It's ludicrous that LDFLAGS need to be set for openMP to work.\nAnd it appears to be well-known: https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=222858",
    "created_at": "2018-11-28T09:42:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307568",
    "user": "@dimpase"
}
```

Replying to [comment:36 fbissey]:
> Replying to [comment:35 dimpase]:
> > Replying to [comment:34 fbissey]:
> > > I believe this is llvm's `ld` then.
> > 
> > yep. If it is called directly, it does not know where to look for libraries, so one much pass 
> > `-L/lib -L/usr/lib -L` etc to it.
> 
> Definitely not called directly (I checked) the compiler is called to do the linking so `-fopenmp` should set all the flags properly. I am calling that a bug in linking driver of the compiler.

I think I agree. It's ludicrous that LDFLAGS need to be set for openMP to work.
And it appears to be well-known: https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=222858



---

archive/issue_comments_307569.json:
```json
{
    "body": "Basically the `-fopenmp` switch doesn't work. Well this is half assed, it should either work or not work, but not partially work. Obviously it still add `-lomp` to the linker call.",
    "created_at": "2018-11-28T09:48:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307569",
    "user": "@kiwifb"
}
```

Basically the `-fopenmp` switch doesn't work. Well this is half assed, it should either work or not work, but not partially work. Obviously it still add `-lomp` to the linker call.



---

archive/issue_comments_307570.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-11-28T09:54:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307570",
    "user": "@dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_307571.json:
```json
{
    "body": "Replying to [comment:32 fbissey]:\n> A lot of system split suitesparse so we would have to check the components individually. In any case I would not use spkg-src to make little tarballs. I would deal with it the same way gfortran and gcc are dealt with but on a bigger scale.\n\nChecking components would be needed anyway, as it's installed as a bunch of separate libraries, whether they come from one blob or many.\n\nAnyhow, send this one to the bots!",
    "created_at": "2018-11-28T09:54:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307571",
    "user": "@dimpase"
}
```

Replying to [comment:32 fbissey]:
> A lot of system split suitesparse so we would have to check the components individually. In any case I would not use spkg-src to make little tarballs. I would deal with it the same way gfortran and gcc are dealt with but on a bigger scale.

Checking components would be needed anyway, as it's installed as a bunch of separate libraries, whether they come from one blob or many.

Anyhow, send this one to the bots!



---

archive/issue_comments_307572.json:
```json
{
    "body": "The separation would make it either to separate build and install. It would allow the \"uninstall\" work from Erik to work. Not all the libraries would be installed either.",
    "created_at": "2018-11-28T09:58:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307572",
    "user": "@kiwifb"
}
```

The separation would make it either to separate build and install. It would allow the "uninstall" work from Erik to work. Not all the libraries would be installed either.



---

archive/issue_comments_307573.json:
```json
{
    "body": "Fails on Cygwin\n\n```\n[suitesparse-5.3.0] ranlib libamd.a\n[suitesparse-5.3.0] gcc -L/home/Admin/sage-buildbot-worker/sage_git/build/local/lib -Wl,-rpath,/home/Admin/sage-buildbot-worker/sage_git/build/local/lib  -L/home/Admin/sage-buildbot-worker/sage_git/build/local/lib -L/home/Admin/sage-buildbot-worker/sage_git/build/local/lib -L/home/Admin/sage-buildbot-worker/sage_git/build/local/lib -shared -Wl,-soname -Wl,libamd.so.2 -Wl,--no-undefined amd_i_aat.o amd_i_1.o amd_i_2.o amd_i_dump.o amd_i_postorder.o amd_i_defaults.o amd_i_post_tree.o amd_i_order.o amd_i_control.o amd_i_info.o amd_i_valid.o amd_i_preprocess.o amd_l_aat.o amd_l_1.o amd_l_2.o amd_l_dump.o amd_l_postorder.o amd_l_defaults.o amd_l_post_tree.o amd_l_order.o amd_l_control.o amd_l_info.o amd_l_valid.o amd_l_preprocess.o -o /home/Admin/sage-buildbot-worker/sage_git/build/local/lib/libamd.so.2.4.6 -lm -lsuitesparseconfig\n[sagelib-8.5.beta5] running build_ext\n[suitesparse-5.3.0] /usr/lib/gcc/x86_64-pc-cygwin/7.3.0/../../../../x86_64-pc-cygwin/bin/ld: cannot find -lsuitesparseconfig\n[suitesparse-5.3.0] collect2: error: ld returned 1 exit status\n[suitesparse-5.3.0] make[6]: *** [Makefile:90: /home/Admin/sage-buildbot-worker/sage_git/build/local/lib/libamd.so.2.4.6] Error 1\n[suitesparse-5.3.0] make[6]: Target 'install' not remade because of errors.\n```\n",
    "created_at": "2018-11-30T23:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307573",
    "user": "@vbraun"
}
```

Fails on Cygwin

```
[suitesparse-5.3.0] ranlib libamd.a
[suitesparse-5.3.0] gcc -L/home/Admin/sage-buildbot-worker/sage_git/build/local/lib -Wl,-rpath,/home/Admin/sage-buildbot-worker/sage_git/build/local/lib  -L/home/Admin/sage-buildbot-worker/sage_git/build/local/lib -L/home/Admin/sage-buildbot-worker/sage_git/build/local/lib -L/home/Admin/sage-buildbot-worker/sage_git/build/local/lib -shared -Wl,-soname -Wl,libamd.so.2 -Wl,--no-undefined amd_i_aat.o amd_i_1.o amd_i_2.o amd_i_dump.o amd_i_postorder.o amd_i_defaults.o amd_i_post_tree.o amd_i_order.o amd_i_control.o amd_i_info.o amd_i_valid.o amd_i_preprocess.o amd_l_aat.o amd_l_1.o amd_l_2.o amd_l_dump.o amd_l_postorder.o amd_l_defaults.o amd_l_post_tree.o amd_l_order.o amd_l_control.o amd_l_info.o amd_l_valid.o amd_l_preprocess.o -o /home/Admin/sage-buildbot-worker/sage_git/build/local/lib/libamd.so.2.4.6 -lm -lsuitesparseconfig
[sagelib-8.5.beta5] running build_ext
[suitesparse-5.3.0] /usr/lib/gcc/x86_64-pc-cygwin/7.3.0/../../../../x86_64-pc-cygwin/bin/ld: cannot find -lsuitesparseconfig
[suitesparse-5.3.0] collect2: error: ld returned 1 exit status
[suitesparse-5.3.0] make[6]: *** [Makefile:90: /home/Admin/sage-buildbot-worker/sage_git/build/local/lib/libamd.so.2.4.6] Error 1
[suitesparse-5.3.0] make[6]: Target 'install' not remade because of errors.
```




---

archive/issue_comments_307574.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-11-30T23:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307574",
    "user": "@vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_307575.json:
```json
{
    "body": "Hardly shocking. The build system being what it is. I think properly splitting the sub-package will help with that error. But it will take some time to do properly.",
    "created_at": "2018-12-01T00:29:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307575",
    "user": "@kiwifb"
}
```

Hardly shocking. The build system being what it is. I think properly splitting the sub-package will help with that error. But it will take some time to do properly.



---

archive/issue_comments_307576.json:
```json
{
    "body": "I didn't know the Cygwin buildbot was even working.  Last I checked on it it was having problems with hanging on the doc build.  I meant to look into it before vacation and then it just slipped off my radar.  I'll look into it though.",
    "created_at": "2019-01-15T17:41:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307576",
    "user": "@embray"
}
```

I didn't know the Cygwin buildbot was even working.  Last I checked on it it was having problems with hanging on the doc build.  I meant to look into it before vacation and then it just slipped off my radar.  I'll look into it though.



---

archive/issue_comments_307577.json:
```json
{
    "body": "Set assignee to @embray.",
    "created_at": "2019-01-15T18:06:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307577",
    "user": "@embray"
}
```

Set assignee to @embray.



---

archive/issue_comments_307578.json:
```json
{
    "body": "In the course of fixing this, I request that the testsuite be fixed, too. Newer versions of `cvxopt` use `nose`, which is a standard Sage package, so testing should be easy to implement. (The current versions have a more ad hoc system which is currently broken, and so is being removed at #28730.)",
    "created_at": "2019-11-14T00:35:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307578",
    "user": "@jhpalmieri"
}
```

In the course of fixing this, I request that the testsuite be fixed, too. Newer versions of `cvxopt` use `nose`, which is a standard Sage package, so testing should be easy to implement. (The current versions have a more ad hoc system which is currently broken, and so is being removed at #28730.)



---

archive/issue_comments_307579.json:
```json
{
    "body": "I'll be trying to blow new life in this ticket soon. I may use a split suitesparse based on my gentoo work.",
    "created_at": "2019-11-14T00:36:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307579",
    "user": "@kiwifb"
}
```

I'll be trying to blow new life in this ticket soon. I may use a split suitesparse based on my gentoo work.



---

archive/issue_comments_307580.json:
```json
{
    "body": "cvxopt is meanwhile version 1.2.3",
    "created_at": "2019-11-14T11:17:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307580",
    "user": "@dimpase"
}
```

cvxopt is meanwhile version 1.2.3



---

archive/issue_comments_307581.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-11-20T00:14:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307581",
    "user": "@kiwifb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_307582.json:
```json
{
    "body": "Basic bump to latest versions without any splitting of suitesparse. In the event of a split with need the following components\n* suitesparseconfig\n* amd\n* colamd\n* cholmod\n* umfpack\n\nThe order is indicative or the compilation order [OK amd and colamd do not depend on each other].\n\nThis doesn't include a new `spkg-check`. I want to defer that to a positive review of this part on cygwin at least.\n----\nNew commits:",
    "created_at": "2019-11-20T00:14:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307582",
    "user": "@kiwifb"
}
```

Basic bump to latest versions without any splitting of suitesparse. In the event of a split with need the following components
* suitesparseconfig
* amd
* colamd
* cholmod
* umfpack

The order is indicative or the compilation order [OK amd and colamd do not depend on each other].

This doesn't include a new `spkg-check`. I want to defer that to a positive review of this part on cygwin at least.
----
New commits:



---

archive/issue_comments_307583.json:
```json
{
    "body": "I think we should proceed with it without splitting the suitesparse. Well, 55Mb, so what. If anyone likes to make it smaller, they should volunteer...",
    "created_at": "2019-11-20T11:03:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307583",
    "user": "@dimpase"
}
```

I think we should proceed with it without splitting the suitesparse. Well, 55Mb, so what. If anyone likes to make it smaller, they should volunteer...



---

archive/issue_comments_307584.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-11-21T21:27:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307584",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_307585.json:
```json
{
    "body": "Added `spkg-check` after testing that it is working. Shamelessly copied it from the `networkx` one with appropriate adjustments.",
    "created_at": "2019-11-21T21:29:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307585",
    "user": "@kiwifb"
}
```

Added `spkg-check` after testing that it is working. Shamelessly copied it from the `networkx` one with appropriate adjustments.



---

archive/issue_comments_307586.json:
```json
{
    "body": "Replying to [comment:49 dimpase]:\n> I think we should proceed with it without splitting the suitesparse. Well, 55Mb, so what. If anyone likes to make it smaller, they should volunteer...\n\nI think that the full suitesparse requires cmake, and I'd rather not have to make `cmake` a standard package.",
    "created_at": "2019-11-21T23:09:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307586",
    "user": "@jhpalmieri"
}
```

Replying to [comment:49 dimpase]:
> I think we should proceed with it without splitting the suitesparse. Well, 55Mb, so what. If anyone likes to make it smaller, they should volunteer...

I think that the full suitesparse requires cmake, and I'd rather not have to make `cmake` a standard package.



---

archive/issue_comments_307587.json:
```json
{
    "body": "Replying to [comment:52 jhpalmieri]:\n> Replying to [comment:49 dimpase]:\n> > I think we should proceed with it without splitting the suitesparse. Well, 55Mb, so what. If anyone likes to make it smaller, they should volunteer...\n> \n> I think that the full suitesparse requires cmake, and I'd rather not have to make `cmake` a standard package.\n\nI specifically disabled the bits requiring cmake. The packages requiring cmake are not used by any other of the packages. It somewhat feels like someone is packaging some pet packages along the more widely used stuff.",
    "created_at": "2019-11-21T23:13:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307587",
    "user": "@kiwifb"
}
```

Replying to [comment:52 jhpalmieri]:
> Replying to [comment:49 dimpase]:
> > I think we should proceed with it without splitting the suitesparse. Well, 55Mb, so what. If anyone likes to make it smaller, they should volunteer...
> 
> I think that the full suitesparse requires cmake, and I'd rather not have to make `cmake` a standard package.

I specifically disabled the bits requiring cmake. The packages requiring cmake are not used by any other of the packages. It somewhat feels like someone is packaging some pet packages along the more widely used stuff.



---

archive/issue_comments_307588.json:
```json
{
    "body": "Yes, it's fine to include the full suitesparse, as long as we don't build the full suitesparse.",
    "created_at": "2019-11-21T23:29:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307588",
    "user": "@jhpalmieri"
}
```

Yes, it's fine to include the full suitesparse, as long as we don't build the full suitesparse.



---

archive/issue_comments_307589.json:
```json
{
    "body": "I guess I could go \"redux\" and only install what we need. Note that some bits of suitesparse are also bundled (as in vendored) in `glpk`. And because `glpk` is autotooled, removing the bundled bits would require patching configure and generating a sage specific tarball.",
    "created_at": "2019-11-21T23:33:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307589",
    "user": "@kiwifb"
}
```

I guess I could go "redux" and only install what we need. Note that some bits of suitesparse are also bundled (as in vendored) in `glpk`. And because `glpk` is autotooled, removing the bundled bits would require patching configure and generating a sage specific tarball.



---

archive/issue_comments_307590.json:
```json
{
    "body": "And now I remember we already unvendor zlib from glpk. May as well unvendor `amd` and `colamd` in a later ticket if we ship suitesparse (even in redux form since those are also needed by cvxopt).",
    "created_at": "2019-11-21T23:39:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307590",
    "user": "@kiwifb"
}
```

And now I remember we already unvendor zlib from glpk. May as well unvendor `amd` and `colamd` in a later ticket if we ship suitesparse (even in redux form since those are also needed by cvxopt).



---

archive/issue_comments_307591.json:
```json
{
    "body": "By the way, with OS X 10.14.6, the `cvxopt` test suite passes, and Sage passes its tests.",
    "created_at": "2019-11-21T23:52:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307591",
    "user": "@jhpalmieri"
}
```

By the way, with OS X 10.14.6, the `cvxopt` test suite passes, and Sage passes its tests.



---

archive/issue_comments_307592.json:
```json
{
    "body": "Any volunteer to positive review this, or is there anything you wish me to change?",
    "created_at": "2019-11-25T21:20:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307592",
    "user": "@kiwifb"
}
```

Any volunteer to positive review this, or is there anything you wish me to change?



---

archive/issue_comments_307593.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-11-25T21:24:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307593",
    "user": "@dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_307594.json:
```json
{
    "body": "ok. not tested on cygwin, but it should not stop it (I think cvxopt is well tested on windows)",
    "created_at": "2019-11-25T21:24:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307594",
    "user": "@dimpase"
}
```

ok. not tested on cygwin, but it should not stop it (I think cvxopt is well tested on windows)



---

archive/issue_comments_307595.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-11-28T21:53:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307595",
    "user": "@vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_307596.json:
```json
{
    "body": "Replying to [comment:59 dimpase]:\n> ok. not tested on cygwin, but it should not stop it (I think cvxopt is well tested on windows)\n\nIt should have--if you needed me to I would have done it, but I don't have time to check every issue so you need to ping me directly if it seems I'm not responding.",
    "created_at": "2019-12-02T11:58:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22143",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22143#issuecomment-307596",
    "user": "@embray"
}
```

Replying to [comment:59 dimpase]:
> ok. not tested on cygwin, but it should not stop it (I think cvxopt is well tested on windows)

It should have--if you needed me to I would have done it, but I don't have time to check every issue so you need to ping me directly if it seems I'm not responding.
