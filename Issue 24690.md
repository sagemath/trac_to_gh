# Issue 24690: Upgrade arb to 2.13.0

archive/issues_024690.json:
```json
{
    "body": "CC:  @mezzarobba @fredrik-johansson @kiwifb\n\nUpstream at\n\n    https://github.com/fredrik-johansson/arb/archive/2.13.0.tar.gz\n\n(to be renamed `arb-2.13.0.tar.gz`)\n\nIssue created by migration from https://trac.sagemath.org/ticket/24927\n\n",
    "created_at": "2018-03-08T09:00:58Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "Upgrade arb to 2.13.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24690",
    "user": "https://github.com/videlec"
}
```
CC:  @mezzarobba @fredrik-johansson @kiwifb

Upstream at

    https://github.com/fredrik-johansson/arb/archive/2.13.0.tar.gz

(to be renamed `arb-2.13.0.tar.gz`)

Issue created by migration from https://trac.sagemath.org/ticket/24927





---

archive/issue_comments_346166.json:
```json
{
    "body": "Among the changed behavior some of them are weird (and perhaps not desirable)\n\n```\n**********************************************************************\nFile \"complex_arb.pyx\", line 2287, in sage.rings.complex_arb.ComplexBall.log\nFailed example:\n    CBF('inf').log()\nExpected:\n    nan + nan*I\nGot:\n    [+/- inf]\n**********************************************************************\nFile \"complex_arb.pyx\", line 2395, in sage.rings.complex_arb.ComplexBall.tan\nFailed example:\n    CBF(pi/2).tan()\nExpected:\n    [+/- inf]\nGot:\n    nan\n**********************************************************************\nFile \"complex_arb.pyx\", line 2412, in sage.rings.complex_arb.ComplexBall.cot\nFailed example:\n    CBF(pi).cot()\nExpected:\n    [+/- inf]\nGot:\n    nan\n**********************************************************************\nFile \"real_arb.pyx\", line 3124, in sage.rings.real_arb.RealBall.tan\nFailed example:\n    RBF(pi/2).tan()\nExpected:\n    [+/- inf]\nGot:\n    nan\n**********************************************************************\nFile \"real_arb.pyx\", line 3141, in sage.rings.real_arb.RealBall.cot\nFailed example:\n    RBF(pi).cot()\nExpected:\n    [+/- inf]\nGot:\n    nan\n**********************************************************************\nFile \"real_arb.pyx\", line 3252, in sage.rings.real_arb.RealBall.coth\nFailed example:\n    RBF(0).coth()\nExpected:\n    [+/- inf]\nGot:\n    nan\n```\n\n\nI also noted some small regressions in enclosures (ignoring the ones that get better)\n\n```\n**********************************************************************\nFile \"complex_arb.pyx\", line 2798, in sage.rings.complex_arb.ComplexBall.hypergeometric\nFailed example:\n    CBF(2+3*I).hypergeometric([1/4,1/3],[1/2])\nExpected:\n    [0.7871684267473 +/- 7.34e-14] + [0.2749254173721 +/- 9.23e-14]*I\nGot:\n    [0.7871684267473 +/- 7.38e-14] + [0.2749254173721 +/- 9.22e-14]*I\n**********************************************************************\nFile \"complex_arb.pyx\", line 2800, in sage.rings.complex_arb.ComplexBall.hypergeometric\nFailed example:\n    CBF(2+3*I).hypergeometric([1/4,1/3],[1/2],regularized=True)\nExpected:\n    [0.4441122268685 +/- 3.96e-14] + [0.1551100567338 +/- 5.75e-14]*I\nGot:\n    [0.4441122268685 +/- 3.98e-14] + [0.1551100567338 +/- 5.77e-14]*I\n**********************************************************************\nFile \"complex_arb.pyx\", line 3648, in sage.rings.complex_arb.ComplexBall.legendre_P\nFailed example:\n    CBF(1/2).legendre_P(5)\nExpected:\n    [0.08984375000000000 +/- 4.5...e-18]\nGot:\n    [0.0898437500000000 +/- 7.29e-17]\n**********************************************************************\nFile \"complex_arb.pyx\", line 3686, in sage.rings.complex_arb.ComplexBall.legendre_Q\nFailed example:\n    CBF(-10).legendre_Q(5, 325/100)\nExpected:\n    [-83825154.36008 +/- 4.94e-6] + [-34721515.80396 +/- 5.40e-6]*I\nGot:\n    [-83825154.36008 +/- 5.02e-6] + [-34721515.80396 +/- 5.42e-6]*I\n```\n",
    "created_at": "2018-03-08T11:09:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346166",
    "user": "https://github.com/videlec"
}
```

Among the changed behavior some of them are weird (and perhaps not desirable)

```
**********************************************************************
File "complex_arb.pyx", line 2287, in sage.rings.complex_arb.ComplexBall.log
Failed example:
    CBF('inf').log()
Expected:
    nan + nan*I
Got:
    [+/- inf]
**********************************************************************
File "complex_arb.pyx", line 2395, in sage.rings.complex_arb.ComplexBall.tan
Failed example:
    CBF(pi/2).tan()
Expected:
    [+/- inf]
Got:
    nan
**********************************************************************
File "complex_arb.pyx", line 2412, in sage.rings.complex_arb.ComplexBall.cot
Failed example:
    CBF(pi).cot()
Expected:
    [+/- inf]
Got:
    nan
**********************************************************************
File "real_arb.pyx", line 3124, in sage.rings.real_arb.RealBall.tan
Failed example:
    RBF(pi/2).tan()
Expected:
    [+/- inf]
Got:
    nan
**********************************************************************
File "real_arb.pyx", line 3141, in sage.rings.real_arb.RealBall.cot
Failed example:
    RBF(pi).cot()
Expected:
    [+/- inf]
Got:
    nan
**********************************************************************
File "real_arb.pyx", line 3252, in sage.rings.real_arb.RealBall.coth
Failed example:
    RBF(0).coth()
Expected:
    [+/- inf]
Got:
    nan
```


I also noted some small regressions in enclosures (ignoring the ones that get better)

```
**********************************************************************
File "complex_arb.pyx", line 2798, in sage.rings.complex_arb.ComplexBall.hypergeometric
Failed example:
    CBF(2+3*I).hypergeometric([1/4,1/3],[1/2])
Expected:
    [0.7871684267473 +/- 7.34e-14] + [0.2749254173721 +/- 9.23e-14]*I
Got:
    [0.7871684267473 +/- 7.38e-14] + [0.2749254173721 +/- 9.22e-14]*I
**********************************************************************
File "complex_arb.pyx", line 2800, in sage.rings.complex_arb.ComplexBall.hypergeometric
Failed example:
    CBF(2+3*I).hypergeometric([1/4,1/3],[1/2],regularized=True)
Expected:
    [0.4441122268685 +/- 3.96e-14] + [0.1551100567338 +/- 5.75e-14]*I
Got:
    [0.4441122268685 +/- 3.98e-14] + [0.1551100567338 +/- 5.77e-14]*I
**********************************************************************
File "complex_arb.pyx", line 3648, in sage.rings.complex_arb.ComplexBall.legendre_P
Failed example:
    CBF(1/2).legendre_P(5)
Expected:
    [0.08984375000000000 +/- 4.5...e-18]
Got:
    [0.0898437500000000 +/- 7.29e-17]
**********************************************************************
File "complex_arb.pyx", line 3686, in sage.rings.complex_arb.ComplexBall.legendre_Q
Failed example:
    CBF(-10).legendre_Q(5, 325/100)
Expected:
    [-83825154.36008 +/- 4.94e-6] + [-34721515.80396 +/- 5.40e-6]*I
Got:
    [-83825154.36008 +/- 5.02e-6] + [-34721515.80396 +/- 5.42e-6]*I
```




---

archive/issue_comments_346167.json:
```json
{
    "body": "It may be better to wait for the existing arb-related tickets to be merged, in case the upgrade causes doctest failures there...",
    "created_at": "2018-03-08T11:11:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346167",
    "user": "https://github.com/mezzarobba"
}
```

It may be better to wait for the existing arb-related tickets to be merged, in case the upgrade causes doctest failures there...



---

archive/issue_comments_346168.json:
```json
{
    "body": "And this is annoying\n\n```\nsage: RBF([-infinity,infinity])\nnan\n```\n",
    "created_at": "2018-03-08T11:11:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346168",
    "user": "https://github.com/videlec"
}
```

And this is annoying

```
sage: RBF([-infinity,infinity])
nan
```




---

archive/issue_comments_346169.json:
```json
{
    "body": "Replying to [comment:5 mmezzarobba]:\n> It may be better to wait for the existing arb-related tickets to be merged, in case the upgrade causes doctest failures there...\n\nCould you add them as dependencies?",
    "created_at": "2018-03-08T11:14:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346169",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:5 mmezzarobba]:
> It may be better to wait for the existing arb-related tickets to be merged, in case the upgrade causes doctest failures there...

Could you add them as dependencies?



---

archive/issue_comments_346170.json:
```json
{
    "body": "Replying to [comment:7 vdelecroix]:\n> Replying to [comment:5 mmezzarobba]:\n> > It may be better to wait for the existing arb-related tickets to be merged, in case the upgrade causes doctest failures there...\n> \n> Could you add them as dependencies?\n\nYes, but I also wouldn't want to block this ticket if nobody is interested in reviewing the other ones. In any case, the tickets I have in mind are #24314, #24816, #24717, #24626.",
    "created_at": "2018-03-08T11:38:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346170",
    "user": "https://github.com/mezzarobba"
}
```

Replying to [comment:7 vdelecroix]:
> Replying to [comment:5 mmezzarobba]:
> > It may be better to wait for the existing arb-related tickets to be merged, in case the upgrade causes doctest failures there...
> 
> Could you add them as dependencies?

Yes, but I also wouldn't want to block this ticket if nobody is interested in reviewing the other ones. In any case, the tickets I have in mind are #24314, #24816, #24717, #24626.



---

archive/issue_comments_346171.json:
```json
{
    "body": "Coming late to the party, pynac-0.7.17 (#24838) depends on this because a fix is included.",
    "created_at": "2018-04-30T13:24:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346171",
    "user": "https://github.com/rwst"
}
```

Coming late to the party, pynac-0.7.17 (#24838) depends on this because a fix is included.



---

archive/issue_comments_346172.json:
```json
{
    "body": "Why is #24575 a dependency? That seems to have nothing to do with arb.",
    "created_at": "2018-05-01T19:33:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346172",
    "user": "https://github.com/jdemeyer"
}
```

Why is #24575 a dependency? That seems to have nothing to do with arb.



---

archive/issue_comments_346173.json:
```json
{
    "body": "Replying to [comment:11 jdemeyer]:\n> Why is #24575 a dependency? That seems to have nothing to do with arb.\n\nSomehow it does. The Makefile of arb is making use of `LD_LIBRARY_PATH` and #24575 aimed to change that...",
    "created_at": "2018-05-02T04:44:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346173",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:11 jdemeyer]:
> Why is #24575 a dependency? That seems to have nothing to do with arb.

Somehow it does. The Makefile of arb is making use of `LD_LIBRARY_PATH` and #24575 aimed to change that...



---

archive/issue_events_062570.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-05-02T10:43:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24690#event-62570"
}
```



---

archive/issue_comments_346174.json:
```json
{
    "body": "Dependencies are merged now. Anyone working on this?",
    "created_at": "2018-05-29T07:39:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346174",
    "user": "https://github.com/rwst"
}
```

Dependencies are merged now. Anyone working on this?



---

archive/issue_comments_346175.json:
```json
{
    "body": "\n```\nsage -t --warn-long 52.8 src/sage/rings/complex_arb.pyx  # 35 doctests failed\nsage -t --warn-long 52.8 src/sage/rings/real_arb.pyx  # 10 doctests failed\nsage -t --warn-long 52.8 src/sage/rings/polynomial/polynomial_complex_arb.pyx  # 2 doctests failed\n```\n\nPlease someone go ahead. I can't work on this until end of June.\n----\nNew commits:",
    "created_at": "2018-05-29T07:54:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346175",
    "user": "https://github.com/rwst"
}
```


```
sage -t --warn-long 52.8 src/sage/rings/complex_arb.pyx  # 35 doctests failed
sage -t --warn-long 52.8 src/sage/rings/real_arb.pyx  # 10 doctests failed
sage -t --warn-long 52.8 src/sage/rings/polynomial/polynomial_complex_arb.pyx  # 2 doctests failed
```

Please someone go ahead. I can't work on this until end of June.
----
New commits:



---

archive/issue_comments_346176.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-06-11T19:50:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346176",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_346177.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-11T20:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346177",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_346178.json:
```json
{
    "body": "One of the remaining doctest failures come from the following.\n\nThere is a regression, before:\n\n```\nsage: sin(1/RBF(0))*0\n0\n```\n\nafter:\n\n```\nsage: sin(1/RBF(0))*0\nnan\n```\n",
    "created_at": "2018-06-11T20:23:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346178",
    "user": "https://github.com/fchapoton"
}
```

One of the remaining doctest failures come from the following.

There is a regression, before:

```
sage: sin(1/RBF(0))*0
0
```

after:

```
sage: sin(1/RBF(0))*0
nan
```




---

archive/issue_comments_346179.json:
```json
{
    "body": "Replying to [comment:19 chapoton]:\n> {{{\n> sage: sin(1/RBF(0))*0\n> nan\n> }}}\n\nThat's because of\n\n```\nsage: 1/RBF(0)\nnan\n```\n\nwhich was infinite before.",
    "created_at": "2018-06-12T05:26:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346179",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:19 chapoton]:
> {{{
> sage: sin(1/RBF(0))*0
> nan
> }}}

That's because of

```
sage: 1/RBF(0)
nan
```

which was infinite before.



---

archive/issue_comments_346180.json:
```json
{
    "body": "Indeed. But what is the semantic of \"nan\" ? Should we expect `sin(nan)` to be `[+/- 1]` ?",
    "created_at": "2018-06-12T07:31:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346180",
    "user": "https://github.com/fchapoton"
}
```

Indeed. But what is the semantic of "nan" ? Should we expect `sin(nan)` to be `[+/- 1]` ?



---

archive/issue_comments_346181.json:
```json
{
    "body": "Replying to [comment:21 chapoton]:\n> Indeed. But what is the semantic of \"nan\" ?\n\nhttp://arblib.org/arb.html\n\n> Should we expect `sin(nan)` to be `[+/- 1]` ?\n\nNo. And I think that's more or less the point of the change: sin(1/x) \u2208 [-1,1] for all real x close to zero, but returning a finite ball could give the impression that sin(1/x) is analytic at zero (since, for complex balls, finite result \u21d2 analytic).\n\nIn any case, the resulting enclosure is correct (if coarser than before), and if upstream decided to make that change, I think we should follow along.",
    "created_at": "2018-06-12T08:02:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346181",
    "user": "https://github.com/mezzarobba"
}
```

Replying to [comment:21 chapoton]:
> Indeed. But what is the semantic of "nan" ?

http://arblib.org/arb.html

> Should we expect `sin(nan)` to be `[+/- 1]` ?

No. And I think that's more or less the point of the change: sin(1/x) ∈ [-1,1] for all real x close to zero, but returning a finite ball could give the impression that sin(1/x) is analytic at zero (since, for complex balls, finite result ⇒ analytic).

In any case, the resulting enclosure is correct (if coarser than before), and if upstream decided to make that change, I think we should follow along.



---

archive/issue_comments_346182.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-12T19:40:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346182",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_346183.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-12T19:54:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346183",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_346184.json:
```json
{
    "body": "I may have made some controversial changes.. please tell me.",
    "created_at": "2018-06-12T19:54:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346184",
    "user": "https://github.com/fchapoton"
}
```

I may have made some controversial changes.. please tell me.



---

archive/issue_comments_346185.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2018-06-12T19:54:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346185",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_346186.json:
```json
{
    "body": "Replying to [comment:21 chapoton]:\n> Indeed. But what is the semantic of \"nan\" ? Should we expect `sin(nan)` to be `[+/- 1]` ?\n\nFWIW, `nan`/`NaN` always leads to collapse of the expression tree.",
    "created_at": "2018-06-13T07:02:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346186",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:21 chapoton]:
> Indeed. But what is the semantic of "nan" ? Should we expect `sin(nan)` to be `[+/- 1]` ?

FWIW, `nan`/`NaN` always leads to collapse of the expression tree.



---

archive/issue_comments_346187.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-14T13:10:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346187",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_346188.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-14T13:33:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346188",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_346189.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2018-06-14T13:44:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346189",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_346190.json:
```json
{
    "body": "Replying to [comment:6 vdelecroix]:\n> And this is annoying\n> {{{\n> sage: RBF([-infinity,infinity])\n> nan\n> }}}\n\nI don't think this is a new issue, but I took the occasion to fix it.",
    "created_at": "2018-06-14T13:44:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346190",
    "user": "https://github.com/mezzarobba"
}
```

Replying to [comment:6 vdelecroix]:
> And this is annoying
> {{{
> sage: RBF([-infinity,infinity])
> nan
> }}}

I don't think this is a new issue, but I took the occasion to fix it.



---

archive/issue_comments_346191.json:
```json
{
    "body": "`make ptestlong` gives me two failures:\n\n```\nFile \"src/sage/functions/other.py\", line 1418, in sage.functions.other.Function_factorial._eval_\nFailed example:\n    factorial(RBF(2)**64)\nExpected:\n    [+/- 2.30e+347382171305201370464]\nGot:\n    [+/- 2.30e+347382171326740403407]\n\nFile \"src/sage/matrix/matrix_complex_ball_dense.pyx\", line 637, in sage.matrix.matrix_complex_ball_dense.Matrix_complex_ball_dense.charpoly\nFailed example:\n    mat.charpoly(algorithm=\"hessenberg\")\nExpected:\n    x^5 + ([-1.8 +/- 0.0445])*x^4 + ([0.3 +/- 0.0833])*x^3\n    + ([+/- 0.0164])*x^2 + ([+/- 6.01e-4])*x + [+/- 6.97e-6]\nGot:\n    x^5 + ([-1.8 +/- 0.0445])*x^4 + ([0.3 +/- 0.0828])*x^3 + ([+/- 0.0163])*x^2 + ([+/- 5.95e-4])*x + [+/- 6.83e-6]\n```\n\n\nIn the first one, using Stirling's formula confirms the regression:\n\n```\nsage: (log(sqrt(2*pi*2^64),10) + log(2^64/e,10)*2^64).n()\n3.47382171305201e20\n```\n",
    "created_at": "2018-06-15T06:40:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346191",
    "user": "https://github.com/rwst"
}
```

`make ptestlong` gives me two failures:

```
File "src/sage/functions/other.py", line 1418, in sage.functions.other.Function_factorial._eval_
Failed example:
    factorial(RBF(2)**64)
Expected:
    [+/- 2.30e+347382171305201370464]
Got:
    [+/- 2.30e+347382171326740403407]

File "src/sage/matrix/matrix_complex_ball_dense.pyx", line 637, in sage.matrix.matrix_complex_ball_dense.Matrix_complex_ball_dense.charpoly
Failed example:
    mat.charpoly(algorithm="hessenberg")
Expected:
    x^5 + ([-1.8 +/- 0.0445])*x^4 + ([0.3 +/- 0.0833])*x^3
    + ([+/- 0.0164])*x^2 + ([+/- 6.01e-4])*x + [+/- 6.97e-6]
Got:
    x^5 + ([-1.8 +/- 0.0445])*x^4 + ([0.3 +/- 0.0828])*x^3 + ([+/- 0.0163])*x^2 + ([+/- 5.95e-4])*x + [+/- 6.83e-6]
```


In the first one, using Stirling's formula confirms the regression:

```
sage: (log(sqrt(2*pi*2^64),10) + log(2^64/e,10)*2^64).n()
3.47382171305201e20
```




---

archive/issue_comments_346192.json:
```json
{
    "body": "If you mark the first test above \"known bug\", and fix the second then it's positive review from me.",
    "created_at": "2018-06-15T13:19:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346192",
    "user": "https://github.com/rwst"
}
```

If you mark the first test above "known bug", and fix the second then it's positive review from me.



---

archive/issue_comments_346193.json:
```json
{
    "body": "Replying to [comment:31 rws]:\n> If you mark the first test above \"known bug\", and fix the second then it's positive review from me.\n\nIt is not a bug, even if the enclosure is a bit less tight as it used to... I think we should just change the expected output.",
    "created_at": "2018-06-16T08:56:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346193",
    "user": "https://github.com/mezzarobba"
}
```

Replying to [comment:31 rws]:
> If you mark the first test above "known bug", and fix the second then it's positive review from me.

It is not a bug, even if the enclosure is a bit less tight as it used to... I think we should just change the expected output.



---

archive/issue_comments_346194.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-16T09:29:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346194",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_346195.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-16T09:31:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346195",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_346196.json:
```json
{
    "body": "Replying to [comment:32 mmezzarobba]:\n> Replying to [comment:31 rws]:\n> > If you mark the first test above \"known bug\", and fix the second then it's positive review from me.\n> \n> It is not a bug, even if the enclosure is a bit less tight as it used to... I think we should just change the expected output.\n\nok, I just did that",
    "created_at": "2018-06-16T09:31:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346196",
    "user": "https://github.com/fchapoton"
}
```

Replying to [comment:32 mmezzarobba]:
> Replying to [comment:31 rws]:
> > If you mark the first test above "known bug", and fix the second then it's positive review from me.
> 
> It is not a bug, even if the enclosure is a bit less tight as it used to... I think we should just change the expected output.

ok, I just did that



---

archive/issue_comments_346197.json:
```json
{
    "body": "Thanks.",
    "created_at": "2018-06-16T12:53:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346197",
    "user": "https://github.com/rwst"
}
```

Thanks.



---

archive/issue_comments_346198.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-06-16T12:53:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346198",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_062571.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-06-19T22:11:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24690#event-62571"
}
```



---

archive/issue_comments_346199.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-06-19T22:11:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24690",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24690#issuecomment-346199",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
