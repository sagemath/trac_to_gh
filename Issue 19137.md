# Issue 19137: LaTeX display broken in Jupyter output cells

Issue created by migration from Trac.

Original creator: egourgoulhon

Original creation time: 2015-10-08 11:34:10

Keywords: jupyter, latex

The LaTeX display of output cells in the Jupyter notebook, which was working in Sage 6.8, is broken in Sage 6.9rc3: the LaTeX code is shown instead of the formula:


```
./sage -n jupyter
```




```
In[1]: %display latex
In[2]: sin(x^2)
Out[2]: \newcommand{\Bold}[1]{\mathbf{#1}}\sin\left(x^{2}\right)
```




---

Comment by jdemeyer created at 2015-10-08 11:40:03

Since I'm in Jupyter mood anyway, I'm having a look.


---

Comment by egourgoulhon created at 2015-10-08 11:47:03

Very good. Tell me if I can help at some point.


---

Comment by jdemeyer created at 2015-10-08 12:29:33

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2015-10-08 12:29:33

New commits:


---

Comment by egourgoulhon created at 2015-10-08 13:25:43

Thanks for the fix !
Seems good to me: LaTeX display is OK now and all doctests in src/sage/repl/ipython_kernel are passed.
A remark though: `sage -coverage src/sage/repl/ipython_kernel` reports some missing documentation.


---

Comment by egourgoulhon created at 2015-10-08 13:25:43

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2015-10-08 13:29:07

Does this imply also a positive review for the dependency #19371?


---

Comment by egourgoulhon created at 2015-10-08 13:46:44

Replying to [comment:7 jdemeyer]:
> Does this imply also a positive review for the dependency #19371?
Yes, but I said there, it would be nice if somebody else gives a second look at it.


---

Comment by jdemeyer created at 2015-10-09 15:47:32

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2015-10-09 17:46:30

I am going to make this independent of #19371.


---

Comment by vbraun created at 2015-10-09 21:40:30

Resolution: fixed


---

Comment by vbraun created at 2015-10-09 21:41:56

Resolution changed from fixed to 


---

Comment by vbraun created at 2015-10-09 21:41:56

Changing status from closed to new.


---

Comment by vbraun created at 2015-10-09 21:48:04

Is this still a blocker? I would like to push the next release out some time soon...


---

Comment by git created at 2015-10-10 06:53:03

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2015-10-10 06:53:54

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2015-10-10 07:47:20

Replying to [comment:13 vbraun]:
> Is this still a blocker? I would like to push the next release out some time soon...
I personally don't care so much. The unrebased branch here seems to work but somebody needs to review it.


---

Comment by egourgoulhon created at 2015-10-10 09:56:22

Replying to [comment:16 jdemeyer]:
> Replying to [comment:13 vbraun]:
> > Is this still a blocker? I would like to push the next release out some time soon...
> I personally don't care so much. The unrebased branch here seems to work but somebody needs to review it.

I am on it (the recompilation of the cython part triggered by make takes time) and shall report asap.


---

Comment by vbraun created at 2015-10-10 11:04:16

I think its better to use jupyter's builtin configuration mechanism instead of digging into the jupyter internals, here is an alternative fix.

----
New commits:


---

Comment by jdemeyer created at 2015-10-10 11:19:12

It indeed looks like a better strategy.

By the way, a git question: is there a simple way to do `git trac pull <ticket>` and completely overwrite any existing branch on my side? I just want _your_ branch, not a merge of my and your branch. I usually do something like

```
$ git checkout 6.9.rc3   # or any other commit/branch
$ git branch -D t/19374/latex_display_broken_in_jupyter_output_cells
$ git trac checkout 19374
```

but it would be nice to be able to do this in a simpler way.


---

Comment by vbraun created at 2015-10-10 11:32:58

The normal `git pull` will never throw away your local branch, `git trac pull` just mirrors that.

If you want to reuse the existing local branch you can fetch+reset instead of delete+checkout:

```
git trac fetch 19374
git reset --hard FETCH_HEAD
```

just like how you would use git directly.


---

Comment by jdemeyer created at 2015-10-10 11:36:09

Better use a relative path: absolute paths don't work with Jupyterhub (see also #19373)

If somebody can review my commit, you can set this ticket to positive_review.
----
New commits:


---

Comment by vbraun created at 2015-10-10 12:36:52

Thanks!


---

Comment by vbraun created at 2015-10-10 12:36:52

Changing status from needs_review to positive_review.


---

Comment by egourgoulhon created at 2015-10-10 13:04:05

I confirm that the latest commit works. Thanks to both of you for this fix!


---

Comment by vbraun created at 2015-10-10 13:13:03

Resolution: fixed


---

Comment by jdemeyer created at 2015-10-11 10:01:25

Replying to [comment:22 vbraun]:
> If you want to reuse the existing local branch you can fetch+reset instead of delete+checkout:
> {{{
> git trac fetch 19374
> git reset --hard FETCH_HEAD
> }}}
> just like how you would use git directly.

Thanks! I didn't know the command `git reset --hard <something>` but it looks very useful indeed.
