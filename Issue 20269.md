# Issue 20269: dual variables handling in SDP solver(s)

archive/issues_020269.json:
```json
{
    "body": "CC:  srobik @mkoeppe @kiwifb\n\nAt present only primal variables are made available in `SemidefiniteProgram()`, although the dual variables are typically also provided by backends. This ticket added access to dual (and slack) variables.\n\nIssue created by migration from https://trac.sagemath.org/ticket/20506\n\n",
    "created_at": "2016-04-27T08:09:54Z",
    "labels": [
        "component: numerical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "dual variables handling in SDP solver(s)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20269",
    "user": "https://github.com/dimpase"
}
```
CC:  srobik @mkoeppe @kiwifb

At present only primal variables are made available in `SemidefiniteProgram()`, although the dual variables are typically also provided by backends. This ticket added access to dual (and slack) variables.

Issue created by migration from https://trac.sagemath.org/ticket/20506





---

archive/issue_comments_278935.json:
```json
{
    "body": "the dependence on #19072 may be ignored for all practical purposes.",
    "created_at": "2016-04-27T08:12:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278935",
    "user": "https://github.com/dimpase"
}
```

the dependence on #19072 may be ignored for all practical purposes.



---

archive/issue_comments_278936.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-04-27T08:12:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278936",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_278937.json:
```json
{
    "body": "I'm a bit puzzled why you would want doctests for the particular floating point noise that you get from this version of the solver. Seems like extra work every time the package is upgraded?",
    "created_at": "2016-04-27T08:27:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278937",
    "user": "https://github.com/mkoeppe"
}
```

I'm a bit puzzled why you would want doctests for the particular floating point noise that you get from this version of the solver. Seems like extra work every time the package is upgraded?



---

archive/issue_comments_278938.json:
```json
{
    "body": "Replying to [comment:2 mkoeppe]:\n> I'm a bit puzzled why you would want doctests for the particular floating point noise that you get from this version of the solver. Seems like extra work every time the package is upgraded?\n\nI tried to round things using '...' etc as much as possible. I can in principle go \nfurther with replacing things like\n\n```\n    sage: (p.slack(0)*p.dual_variable(0)).trace()\n    1.71...e-07\n```\n\nby\n\n```\n    sage: 0.0e0 <= (p.slack(0)*p.dual_variable(0)).trace() < 1.75e-07\n    True\n```\n\n\nEventually we should think how to adapt your testing framework to SDP.",
    "created_at": "2016-04-27T08:51:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278938",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:2 mkoeppe]:
> I'm a bit puzzled why you would want doctests for the particular floating point noise that you get from this version of the solver. Seems like extra work every time the package is upgraded?

I tried to round things using '...' etc as much as possible. I can in principle go 
further with replacing things like

```
    sage: (p.slack(0)*p.dual_variable(0)).trace()
    1.71...e-07
```

by

```
    sage: 0.0e0 <= (p.slack(0)*p.dual_variable(0)).trace() < 1.75e-07
    True
```


Eventually we should think how to adapt your testing framework to SDP.



---

archive/issue_comments_278939.json:
```json
{
    "body": "How about \n\n```\nsage: (p.slack(0)*p.dual_variable(0)).trace()  # tol 1e-6\n0\n```\n",
    "created_at": "2016-04-27T19:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278939",
    "user": "https://github.com/mkoeppe"
}
```

How about 

```
sage: (p.slack(0)*p.dual_variable(0)).trace()  # tol 1e-6
0
```




---

archive/issue_comments_278940.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-28T00:54:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278940",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_278941.json:
```json
{
    "body": "Replying to [comment:4 mkoeppe]:\n> How about \n> {{{\n> sage: (p.slack(0)*p.dual_variable(0)).trace()  # tol 1e-6\n> 0\n> }}}\n\ngood idea, fixed!",
    "created_at": "2016-04-28T00:55:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278941",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:4 mkoeppe]:
> How about 
> {{{
> sage: (p.slack(0)*p.dual_variable(0)).trace()  # tol 1e-6
> 0
> }}}

good idea, fixed!



---

archive/issue_comments_278942.json:
```json
{
    "body": "There are more places in the file that could use the #tol.\nAnd perhaps there should be an example in which the slack is not 0.",
    "created_at": "2016-04-28T01:07:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278942",
    "user": "https://github.com/mkoeppe"
}
```

There are more places in the file that could use the #tol.
And perhaps there should be an example in which the slack is not 0.



---

archive/issue_comments_278943.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-28T06:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278943",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_278944.json:
```json
{
    "body": "Replying to [comment:7 mkoeppe]:\n> There are more places in the file that could use the #tol.\nI did add it all over the place, in fact.\n\n> And perhaps there should be an example in which the slack is not 0.\nOK, see the last commit.",
    "created_at": "2016-04-28T06:46:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278944",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:7 mkoeppe]:
> There are more places in the file that could use the #tol.
I did add it all over the place, in fact.

> And perhaps there should be an example in which the slack is not 0.
OK, see the last commit.



---

archive/issue_comments_278945.json:
```json
{
    "body": "I mean these ones in cvxopt_sdp_backend.\n\n```\n    cpdef dual_variable(self, int i, sparse=False):\n[...]\n            sage: p.add_constraint(b1*x[0] + b2*x[1] <= b3)\n            sage: p.solve()\n            -2.9999999...\n            sage: B=p.get_backend()\n            sage: x=p.get_values(x).values()\n            sage: -(a3*B.dual_variable(0)).trace()-(b3*B.dual_variable(1)).trace()\n            -3.0000000...\n```\n",
    "created_at": "2016-04-28T06:54:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278945",
    "user": "https://github.com/mkoeppe"
}
```

I mean these ones in cvxopt_sdp_backend.

```
    cpdef dual_variable(self, int i, sparse=False):
[...]
            sage: p.add_constraint(b1*x[0] + b2*x[1] <= b3)
            sage: p.solve()
            -2.9999999...
            sage: B=p.get_backend()
            sage: x=p.get_values(x).values()
            sage: -(a3*B.dual_variable(0)).trace()-(b3*B.dual_variable(1)).trace()
            -3.0000000...
```




---

archive/issue_comments_278946.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-28T08:05:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278946",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_278947.json:
```json
{
    "body": "The patchbot complains about decreased coverage; probably `_get_answer`",
    "created_at": "2016-04-28T17:56:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278947",
    "user": "https://github.com/mkoeppe"
}
```

The patchbot complains about decreased coverage; probably `_get_answer`



---

archive/issue_comments_278948.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-28T18:23:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278948",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_278949.json:
```json
{
    "body": "Replying to [comment:12 mkoeppe]:\n> The patchbot complains about decreased coverage; probably `_get_answer`\nthanks; hopefully fixed now.",
    "created_at": "2016-04-28T18:25:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278949",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:12 mkoeppe]:
> The patchbot complains about decreased coverage; probably `_get_answer`
thanks; hopefully fixed now.



---

archive/issue_comments_278950.json:
```json
{
    "body": "Looking good.",
    "created_at": "2016-04-29T05:39:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278950",
    "user": "https://github.com/mkoeppe"
}
```

Looking good.



---

archive/issue_comments_278951.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-04-29T05:39:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278951",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_278952.json:
```json
{
    "body": "\n```\nsage -t --long src/sage/numerical/sdp.pyx\n**********************************************************************\nFile \"src/sage/numerical/sdp.pyx\", line 73, in sage.numerical.sdp\nFailed example:\n    opt = p.solve()\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.numerical.sdp[15]>\", line 1, in <module>\n        opt = p.solve()\n      File \"sage/numerical/sdp.pyx\", line 946, in sage.numerical.sdp.SemidefiniteProgram.solve (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/numerical/sdp.c:7984)\n        self._backend.solve()\n      File \"sage/numerical/backends/cvxopt_sdp_backend.pyx\", line 424, in sage.numerical.backends.cvxopt_sdp_backend.CVXOPTSDPBackend.solve (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/numerical/backends/cvxopt_sdp_backend.c:5326)\n        raise SDPSolverException(\"CVXOPT: Terminated early due to numerical difficulties or because the maximum number of iterations was reached.\")\n    SDPSolverException: CVXOPT: Terminated early due to numerical difficulties or because the maximum number of iterations was reached.\n**********************************************************************\nFile \"src/sage/numerical/sdp.pyx\", line 78, in sage.numerical.sdp\nFailed example:\n    print 'Objective Value:', round(opt,3)\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.numerical.sdp[16]>\", line 1, in <module>\n        print 'Objective Value:', round(opt,Integer(3))\n    NameError: name 'opt' is not defined\n**********************************************************************\nFile \"src/sage/numerical/sdp.pyx\", line 97, in sage.numerical.sdp\nFailed example:\n    p.dual_variable(1)\nExpected:\n    [ 85545.1... -85545.1...]\n    [-85545.1...  85545.1...]\nGot:\n     [ 88653817081280.4 -88653817022970.2]\n    [-88653817022970.2  88653816964660.0]\n**********************************************************************\nFile \"src/sage/numerical/sdp.pyx\", line 103, in sage.numerical.sdp\nFailed example:\n    opt-((p.dual_variable(0)*a3).trace()+(p.dual_variable(1)*b3).trace())  # tol 8e-08\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.numerical.sdp[20]>\", line 1, in <module>\n        opt-((p.dual_variable(Integer(0))*a3).trace()+(p.dual_variable(Integer(1))*b3).trace())  # tol 8e-08\n    NameError: name 'opt' is not defined\n**********************************************************************\nFile \"src/sage/numerical/sdp.pyx\", line 110, in sage.numerical.sdp\nFailed example:\n    (p.slack(0)*p.dual_variable(0)).trace()       # tol 2e-07\nExpected:\n    0.0\nGot:\n    0.0003622770309448242\nTolerance exceeded:\n    0.0 vs 0.0003622770309448242, tolerance 4e-04 > 2e-07\n**********************************************************************\n1 item had failures:\n   5 of  41 in sage.numerical.sdp\n    [283 tests, 5 failures, 0.67 s]\n```\n",
    "created_at": "2016-04-29T20:16:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278952",
    "user": "https://github.com/vbraun"
}
```


```
sage -t --long src/sage/numerical/sdp.pyx
**********************************************************************
File "src/sage/numerical/sdp.pyx", line 73, in sage.numerical.sdp
Failed example:
    opt = p.solve()
Exception raised:
    Traceback (most recent call last):
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.numerical.sdp[15]>", line 1, in <module>
        opt = p.solve()
      File "sage/numerical/sdp.pyx", line 946, in sage.numerical.sdp.SemidefiniteProgram.solve (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/numerical/sdp.c:7984)
        self._backend.solve()
      File "sage/numerical/backends/cvxopt_sdp_backend.pyx", line 424, in sage.numerical.backends.cvxopt_sdp_backend.CVXOPTSDPBackend.solve (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/numerical/backends/cvxopt_sdp_backend.c:5326)
        raise SDPSolverException("CVXOPT: Terminated early due to numerical difficulties or because the maximum number of iterations was reached.")
    SDPSolverException: CVXOPT: Terminated early due to numerical difficulties or because the maximum number of iterations was reached.
**********************************************************************
File "src/sage/numerical/sdp.pyx", line 78, in sage.numerical.sdp
Failed example:
    print 'Objective Value:', round(opt,3)
Exception raised:
    Traceback (most recent call last):
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.numerical.sdp[16]>", line 1, in <module>
        print 'Objective Value:', round(opt,Integer(3))
    NameError: name 'opt' is not defined
**********************************************************************
File "src/sage/numerical/sdp.pyx", line 97, in sage.numerical.sdp
Failed example:
    p.dual_variable(1)
Expected:
    [ 85545.1... -85545.1...]
    [-85545.1...  85545.1...]
Got:
     [ 88653817081280.4 -88653817022970.2]
    [-88653817022970.2  88653816964660.0]
**********************************************************************
File "src/sage/numerical/sdp.pyx", line 103, in sage.numerical.sdp
Failed example:
    opt-((p.dual_variable(0)*a3).trace()+(p.dual_variable(1)*b3).trace())  # tol 8e-08
Exception raised:
    Traceback (most recent call last):
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.numerical.sdp[20]>", line 1, in <module>
        opt-((p.dual_variable(Integer(0))*a3).trace()+(p.dual_variable(Integer(1))*b3).trace())  # tol 8e-08
    NameError: name 'opt' is not defined
**********************************************************************
File "src/sage/numerical/sdp.pyx", line 110, in sage.numerical.sdp
Failed example:
    (p.slack(0)*p.dual_variable(0)).trace()       # tol 2e-07
Expected:
    0.0
Got:
    0.0003622770309448242
Tolerance exceeded:
    0.0 vs 0.0003622770309448242, tolerance 4e-04 > 2e-07
**********************************************************************
1 item had failures:
   5 of  41 in sage.numerical.sdp
    [283 tests, 5 failures, 0.67 s]
```




---

archive/issue_comments_278953.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-04-29T20:16:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278953",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_278954.json:
```json
{
    "body": "hmm, why do these tests fail on Gentoo, and on Gentoo only? Do these patchbots have some sort of strange configuration of numerics?",
    "created_at": "2016-04-29T20:40:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278954",
    "user": "https://github.com/dimpase"
}
```

hmm, why do these tests fail on Gentoo, and on Gentoo only? Do these patchbots have some sort of strange configuration of numerics?



---

archive/issue_comments_278955.json:
```json
{
    "body": "I bet it is another instance of [floating point (xeon/gentoo only?) weirdness with cvxopt ('sage' vs 'sage --python' difference)](https://groups.google.com/d/msg/sage-devel/SaBzeZBAjEQ/98VQSjS1CgAJ)",
    "created_at": "2016-04-29T21:09:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278955",
    "user": "https://github.com/dimpase"
}
```

I bet it is another instance of [floating point (xeon/gentoo only?) weirdness with cvxopt ('sage' vs 'sage --python' difference)](https://groups.google.com/d/msg/sage-devel/SaBzeZBAjEQ/98VQSjS1CgAJ)



---

archive/issue_comments_278956.json:
```json
{
    "body": "I don't really have a clue but I can test this in sage-on-gentoo for kicks.",
    "created_at": "2016-04-30T04:29:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278956",
    "user": "https://github.com/kiwifb"
}
```

I don't really have a clue but I can test this in sage-on-gentoo for kicks.



---

archive/issue_comments_278957.json:
```json
{
    "body": "run this as ./sage <xx.sage",
    "created_at": "2016-04-30T22:52:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278957",
    "user": "https://github.com/dimpase"
}
```

run this as ./sage <xx.sage



---

archive/issue_comments_278958.json:
```json
{
    "body": "Attachment [xx.sage](tarball://root/attachments/some-uuid/ticket20506/xx.sage) by @dimpase created at 2016-04-30 23:01:47\n\nReplying to [comment:19 fbissey]:\n> I don't really have a clue but I can test this in sage-on-gentoo for kicks.\n\nCould you please run (on the a recent beta - the ticket branch is not needed)\nthe attached file, and post the output?\n(Basically, there should not be any `ZeroDivisionError: float division by zero`)",
    "created_at": "2016-04-30T23:01:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278958",
    "user": "https://github.com/dimpase"
}
```

Attachment [xx.sage](tarball://root/attachments/some-uuid/ticket20506/xx.sage) by @dimpase created at 2016-04-30 23:01:47

Replying to [comment:19 fbissey]:
> I don't really have a clue but I can test this in sage-on-gentoo for kicks.

Could you please run (on the a recent beta - the ticket branch is not needed)
the attached file, and post the output?
(Basically, there should not be any `ZeroDivisionError: float division by zero`)



---

archive/issue_comments_278959.json:
```json
{
    "body": "7.2.beta6+ (I am on Volker's branch sometime yesterday), not very promising\n\n```\nfbissey@QCD-nzi3 ~ $ sage\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 7.2.beta6, Release Date: 2016-04-28               \u2502\n\u2502 Type \"notebook()\" for the browser-based notebook interface.        \u2502\n\u2502 Type \"help()\" for help.                                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\nsage: from cvxopt import matrix as mat, solvers\nsage: c = mat([-1.,1.])\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-2-14ab25c781f3> in <module>()\n----> 1 c = mat([-RealNumber('1.'),RealNumber('1.')])\n\nTypeError: invalid type in list\n```\n",
    "created_at": "2016-05-01T02:26:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278959",
    "user": "https://github.com/kiwifb"
}
```

7.2.beta6+ (I am on Volker's branch sometime yesterday), not very promising

```
fbissey@QCD-nzi3 ~ $ sage
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 7.2.beta6, Release Date: 2016-04-28               │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: from cvxopt import matrix as mat, solvers
sage: c = mat([-1.,1.])
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-2-14ab25c781f3> in <module>()
----> 1 c = mat([-RealNumber('1.'),RealNumber('1.')])

TypeError: invalid type in list
```




---

archive/issue_comments_278960.json:
```json
{
    "body": "Replying to [comment:21 fbissey]:\n> 7.2.beta6+ (I am on Volker's branch sometime yesterday), not very promising\n\nyou missed the 1st line: `preparser(False)`\n\n(probably cause you tried `sage xx.sage` rather than `sage <xx.sage`)\n\n> {{{\n> fbissey`@`QCD-nzi3 ~ $ sage\n> \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n> \u2502 [SageMath](SageMath) version 7.2.beta6, Release Date: 2016-04-28               \u2502\n> \u2502 Type \"notebook()\" for the browser-based notebook interface.        \u2502\n> \u2502 Type \"help()\" for help.                                            \u2502\n> \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n> \u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n> \u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n> \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\n> sage: from cvxopt import matrix as mat, solvers\n> sage: c = mat([-1.,1.])\n> ---------------------------------------------------------------------------\n> TypeError                                 Traceback (most recent call last)\n> <ipython-input-2-14ab25c781f3> in <module>()\n> ----> 1 c = mat([-RealNumber('1.'),RealNumber('1.')])\n> \n> TypeError: invalid type in list\n> }}}",
    "created_at": "2016-05-01T07:24:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278960",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:21 fbissey]:
> 7.2.beta6+ (I am on Volker's branch sometime yesterday), not very promising

you missed the 1st line: `preparser(False)`

(probably cause you tried `sage xx.sage` rather than `sage <xx.sage`)

> {{{
> fbissey`@`QCD-nzi3 ~ $ sage
> ┌────────────────────────────────────────────────────────────────────┐
> │ [SageMath](SageMath) version 7.2.beta6, Release Date: 2016-04-28               │
> │ Type "notebook()" for the browser-based notebook interface.        │
> │ Type "help()" for help.                                            │
> └────────────────────────────────────────────────────────────────────┘
> ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
> ┃ Warning: this is a prerelease version, and it may be unstable.     ┃
> ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
> sage: from cvxopt import matrix as mat, solvers
> sage: c = mat([-1.,1.])
> ---------------------------------------------------------------------------
> TypeError                                 Traceback (most recent call last)
> <ipython-input-2-14ab25c781f3> in <module>()
> ----> 1 c = mat([-RealNumber('1.'),RealNumber('1.')])
> 
> TypeError: invalid type in list
> }}}



---

archive/issue_comments_278961.json:
```json
{
    "body": "That explains!\n\n```\nfbissey@QCD-nzi3 ~ $ sage < xx.sage \n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 7.2.beta6, Release Date: 2016-04-28               \u2502\n\u2502 Type \"notebook()\" for the browser-based notebook interface.        \u2502\n\u2502 Type \"help()\" for help.                                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\nsage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage:      pcost       dcost       gap    pres   dres   k/t\n 0: -1.2413e+00 -2.7310e+01  2e+01  3e-01  1e+01  1e+00\n 1: -1.4977e+00 -3.1971e+00  6e-01  2e-02  9e-01  2e-01\n 2: -1.2729e+00 -2.1411e+00  6e-01  1e-02  5e-01  2e-01\n 3: -1.1436e+00 -1.2534e+00  8e-02  1e-03  6e-02  2e-02\n 4: -1.1034e+00 -1.2438e+00  3e-01  2e-03  8e-02  4e-02\n 5: -1.0500e+00 -1.0609e+00  2e-02  1e-04  7e-03  4e-03\n 6: -1.0338e+00 -1.0407e+00  4e-02  1e-04  6e-03  7e-03\n 7: -1.0201e+00 -1.0209e+00  8e-03  2e-05  1e-03  1e-03\n 8: -1.0176e+00 -1.0176e+00  4e-02  4e-05  2e-03  4e-03\n 9: -1.0071e+00 -1.0069e+00  3e-03  3e-06  1e-04  5e-04\n10: -1.0042e+00 -1.0038e+00  4e-03  2e-06  8e-05  6e-04\n11: -1.0027e+00 -1.0026e+00  1e-03  4e-07  2e-05  2e-04\n12: -1.0028e+00 -1.0022e+00  8e-03  1e-06  5e-05  7e-04\n13: -1.0009e+00 -1.0009e+00  6e-04  8e-08  4e-06  7e-05\n14: -1.0005e+00 -1.0004e+00  3e-04  2e-08  1e-06  5e-05\n15: -1.0003e+00 -1.0002e+00  8e-04  2e-08  1e-06  1e-04\n16: -1.0000e+00 -1.0000e+00  9e-05  2e-09  1e-07  1e-05\n17: -9.9992e-01 -9.9990e-01  2e-04  2e-09  8e-08  2e-05\n18: -9.9986e-01 -9.9986e-01  2e-05  2e-10  1e-08  4e-06\n19: -9.9985e-01 -9.9984e-01  8e-05  3e-10  1e-08  9e-06\n20: -9.9982e-01 -9.9982e-01  9e-06  3e-11  1e-09  1e-06\n21: -9.9982e-01 -9.9981e-01  3e-05  3e-11  2e-09  3e-06\n22: -9.9981e-01 -9.9981e-01  3e-06  4e-12  2e-10  5e-07\n23: -9.9981e-01 -9.9981e-01  1e-05  7e-11  1e-10  1e-06\n24: -9.9980e-01 -9.9980e-01  1e-06  7e-12  5e-10  2e-07\n25: -9.9980e-01 -9.9980e-01  3e-06  2e-08  1e-09  4e-07\n26: -9.9980e-01 -9.9980e-01  4e-07  3e-09  5e-11  6e-08\nOptimal solution found.\nsage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: ---------------------------------------------------------------------------\nSDPSolverException                        Traceback (most recent call last)\n<ipython-input-25-de8ebd622e01> in <module>()\n----> 1 p.solve() # boom - division by 0\n\n/usr/lib64/python2.7/site-packages/sage/numerical/sdp.pyx in sage.numerical.sdp.SemidefiniteProgram.solve (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/numerical/sdp.c:7919)()\n    902             3.0\n    903         \"\"\"\n--> 904         self._backend.solve()\n    905         return self._backend.get_objective_value()\n    906 \n\n/usr/lib64/python2.7/site-packages/sage/numerical/backends/cvxopt_sdp_backend.pyx in sage.numerical.backends.cvxopt_sdp_backend.CVXOPTSDPBackend.solve (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/numerical/backends/cvxopt_sdp_backend.c:5165)()\n    418             pass\n    419         elif self.answer['status'] == 'primal infeasible':\n--> 420             raise SDPSolverException(\"CVXOPT: primal infeasible\")\n    421         elif self.answer['status'] == 'dual infeasible':\n    422             raise SDPSolverException(\"CVXOPT: dual infeasible\")\n\nSDPSolverException: CVXOPT: primal infeasible\nsage: sage: sage: Exiting Sage (CPU time 0m0.60s, Wall time 0m2.40s).\n```\n\nThis is sage-on-gentoo. Does `SDP` needs a particular dependency enabled in CVXOPT that I could have missed?",
    "created_at": "2016-05-01T07:47:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278961",
    "user": "https://github.com/kiwifb"
}
```

That explains!

```
fbissey@QCD-nzi3 ~ $ sage < xx.sage 
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 7.2.beta6, Release Date: 2016-04-28               │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage:      pcost       dcost       gap    pres   dres   k/t
 0: -1.2413e+00 -2.7310e+01  2e+01  3e-01  1e+01  1e+00
 1: -1.4977e+00 -3.1971e+00  6e-01  2e-02  9e-01  2e-01
 2: -1.2729e+00 -2.1411e+00  6e-01  1e-02  5e-01  2e-01
 3: -1.1436e+00 -1.2534e+00  8e-02  1e-03  6e-02  2e-02
 4: -1.1034e+00 -1.2438e+00  3e-01  2e-03  8e-02  4e-02
 5: -1.0500e+00 -1.0609e+00  2e-02  1e-04  7e-03  4e-03
 6: -1.0338e+00 -1.0407e+00  4e-02  1e-04  6e-03  7e-03
 7: -1.0201e+00 -1.0209e+00  8e-03  2e-05  1e-03  1e-03
 8: -1.0176e+00 -1.0176e+00  4e-02  4e-05  2e-03  4e-03
 9: -1.0071e+00 -1.0069e+00  3e-03  3e-06  1e-04  5e-04
10: -1.0042e+00 -1.0038e+00  4e-03  2e-06  8e-05  6e-04
11: -1.0027e+00 -1.0026e+00  1e-03  4e-07  2e-05  2e-04
12: -1.0028e+00 -1.0022e+00  8e-03  1e-06  5e-05  7e-04
13: -1.0009e+00 -1.0009e+00  6e-04  8e-08  4e-06  7e-05
14: -1.0005e+00 -1.0004e+00  3e-04  2e-08  1e-06  5e-05
15: -1.0003e+00 -1.0002e+00  8e-04  2e-08  1e-06  1e-04
16: -1.0000e+00 -1.0000e+00  9e-05  2e-09  1e-07  1e-05
17: -9.9992e-01 -9.9990e-01  2e-04  2e-09  8e-08  2e-05
18: -9.9986e-01 -9.9986e-01  2e-05  2e-10  1e-08  4e-06
19: -9.9985e-01 -9.9984e-01  8e-05  3e-10  1e-08  9e-06
20: -9.9982e-01 -9.9982e-01  9e-06  3e-11  1e-09  1e-06
21: -9.9982e-01 -9.9981e-01  3e-05  3e-11  2e-09  3e-06
22: -9.9981e-01 -9.9981e-01  3e-06  4e-12  2e-10  5e-07
23: -9.9981e-01 -9.9981e-01  1e-05  7e-11  1e-10  1e-06
24: -9.9980e-01 -9.9980e-01  1e-06  7e-12  5e-10  2e-07
25: -9.9980e-01 -9.9980e-01  3e-06  2e-08  1e-09  4e-07
26: -9.9980e-01 -9.9980e-01  4e-07  3e-09  5e-11  6e-08
Optimal solution found.
sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: ---------------------------------------------------------------------------
SDPSolverException                        Traceback (most recent call last)
<ipython-input-25-de8ebd622e01> in <module>()
----> 1 p.solve() # boom - division by 0

/usr/lib64/python2.7/site-packages/sage/numerical/sdp.pyx in sage.numerical.sdp.SemidefiniteProgram.solve (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/numerical/sdp.c:7919)()
    902             3.0
    903         """
--> 904         self._backend.solve()
    905         return self._backend.get_objective_value()
    906 

/usr/lib64/python2.7/site-packages/sage/numerical/backends/cvxopt_sdp_backend.pyx in sage.numerical.backends.cvxopt_sdp_backend.CVXOPTSDPBackend.solve (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/numerical/backends/cvxopt_sdp_backend.c:5165)()
    418             pass
    419         elif self.answer['status'] == 'primal infeasible':
--> 420             raise SDPSolverException("CVXOPT: primal infeasible")
    421         elif self.answer['status'] == 'dual infeasible':
    422             raise SDPSolverException("CVXOPT: dual infeasible")

SDPSolverException: CVXOPT: primal infeasible
sage: sage: sage: Exiting Sage (CPU time 0m0.60s, Wall time 0m2.40s).
```

This is sage-on-gentoo. Does `SDP` needs a particular dependency enabled in CVXOPT that I could have missed?



---

archive/issue_comments_278962.json:
```json
{
    "body": "OK, I just found that the problem is not Gentoo-only, it is CPU-related (Xeon only?)\n(is QCD-nzi3 Xeon, too?)\n\nReproducible on \n\n```\nIntel(R) Xeon(R) CPU  X5660  @ 2.80GHz (UGent, Gentoo)\nIntel(R) Xeon(R) CPU @ 2.30GHz         (SMC, Ubuntu)\n```\n\n\nWill now see if this is Atlas-related  (by trying \"dumb\" Atlas).\n\nBut the bug is very unpleasant; in the attached script the result of running`sol = solvers.sdp(c, Gs=G, hs=h)` changes after unrelated (although in the same code-path) lines 13-27.",
    "created_at": "2016-05-01T07:54:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278962",
    "user": "https://github.com/dimpase"
}
```

OK, I just found that the problem is not Gentoo-only, it is CPU-related (Xeon only?)
(is QCD-nzi3 Xeon, too?)

Reproducible on 

```
Intel(R) Xeon(R) CPU  X5660  @ 2.80GHz (UGent, Gentoo)
Intel(R) Xeon(R) CPU @ 2.30GHz         (SMC, Ubuntu)
```


Will now see if this is Atlas-related  (by trying "dumb" Atlas).

But the bug is very unpleasant; in the attached script the result of running`sol = solvers.sdp(c, Gs=G, hs=h)` changes after unrelated (although in the same code-path) lines 13-27.



---

archive/issue_comments_278963.json:
```json
{
    "body": "Not an actual Xeon but I am not completely sure\n\n```\nprocessor\t: 11\nvendor_id\t: GenuineIntel\ncpu family\t: 6\nmodel\t\t: 44\nmodel name\t: Intel(R) Core(TM) i7 CPU         970  @ 3.20GHz\nstepping\t: 2\nmicrocode\t: 0xc\ncpu MHz\t\t: 3238.432\ncache size\t: 12288 KB\n```\n\nAlso, sage-on-gentoo above uses openblas...",
    "created_at": "2016-05-01T08:03:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278963",
    "user": "https://github.com/kiwifb"
}
```

Not an actual Xeon but I am not completely sure

```
processor	: 11
vendor_id	: GenuineIntel
cpu family	: 6
model		: 44
model name	: Intel(R) Core(TM) i7 CPU         970  @ 3.20GHz
stepping	: 2
microcode	: 0xc
cpu MHz		: 3238.432
cache size	: 12288 KB
```

Also, sage-on-gentoo above uses openblas...



---

archive/issue_comments_278964.json:
```json
{
    "body": "On `Intel(R) Core(TM) i7-4510U CPU `@` 2.00GHz (laptop, Ubuntu)` as well as on `Intel(R) Core(TM) i7-4770 CPU `@` 3.40GHz (desktop, Fedora-23)` the script works.",
    "created_at": "2016-05-01T08:11:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278964",
    "user": "https://github.com/dimpase"
}
```

On `Intel(R) Core(TM) i7-4510U CPU `@` 2.00GHz (laptop, Ubuntu)` as well as on `Intel(R) Core(TM) i7-4770 CPU `@` 3.40GHz (desktop, Fedora-23)` the script works.



---

archive/issue_comments_278965.json:
```json
{
    "body": "I will build a vanilla 7.2.beta6 and see what happens.",
    "created_at": "2016-05-01T08:16:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278965",
    "user": "https://github.com/kiwifb"
}
```

I will build a vanilla 7.2.beta6 and see what happens.



---

archive/issue_comments_278966.json:
```json
{
    "body": "the failure with xx.sage attachment is also reproducible on OSX (Core2Duo CPU), although it's slightly different (the 2nd and 3rd calls to the solver return \"infeasible\" rather than bail out with zero division).\n\nSo this looks like an genuine bug in CVXOPT interface, or in CVXOPT itself, or both. Somehow it seems to retain too much state. I wish we had an OSX patchbot...",
    "created_at": "2016-05-01T09:39:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278966",
    "user": "https://github.com/dimpase"
}
```

the failure with xx.sage attachment is also reproducible on OSX (Core2Duo CPU), although it's slightly different (the 2nd and 3rd calls to the solver return "infeasible" rather than bail out with zero division).

So this looks like an genuine bug in CVXOPT interface, or in CVXOPT itself, or both. Somehow it seems to retain too much state. I wish we had an OSX patchbot...



---

archive/issue_comments_278967.json:
```json
{
    "body": "For info, vanilla sage same machine\n\n```\nfbissey@QCD-nzi3 ~/sandbox/git-fork/sage $ ./sage < ~/xx.sage \n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 7.2.beta6, Release Date: 2016-04-28               \u2502\n\u2502 Type \"notebook()\" for the browser-based notebook interface.        \u2502\n\u2502 Type \"help()\" for help.                                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\nsage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage:      pcost       dcost       gap    pres   dres   k/t\n 0: -1.2413e+00 -2.7310e+01  2e+01  3e-01  1e+01  1e+00\n 1: -1.4977e+00 -3.1971e+00  6e-01  2e-02  9e-01  2e-01\n 2: -1.2729e+00 -2.1411e+00  6e-01  1e-02  5e-01  2e-01\n 3: -1.1436e+00 -1.2534e+00  8e-02  1e-03  6e-02  2e-02\n 4: -1.1034e+00 -1.2438e+00  3e-01  2e-03  8e-02  4e-02\n 5: -1.0500e+00 -1.0609e+00  2e-02  1e-04  7e-03  4e-03\n 6: -1.0338e+00 -1.0407e+00  4e-02  1e-04  6e-03  7e-03\n 7: -1.0201e+00 -1.0209e+00  8e-03  2e-05  1e-03  1e-03\n 8: -1.0176e+00 -1.0176e+00  4e-02  4e-05  2e-03  4e-03\n 9: -1.0071e+00 -1.0069e+00  3e-03  3e-06  1e-04  5e-04\n10: -1.0042e+00 -1.0038e+00  4e-03  2e-06  8e-05  6e-04\n11: -1.0027e+00 -1.0026e+00  1e-03  4e-07  2e-05  2e-04\n12: -1.0028e+00 -1.0022e+00  8e-03  1e-06  5e-05  7e-04\n13: -1.0009e+00 -1.0009e+00  6e-04  8e-08  4e-06  7e-05\n14: -1.0005e+00 -1.0004e+00  3e-04  2e-08  1e-06  5e-05\n15: -1.0003e+00 -1.0002e+00  8e-04  2e-08  1e-06  1e-04\n16: -1.0000e+00 -1.0000e+00  9e-05  2e-09  1e-07  1e-05\n17: -9.9992e-01 -9.9990e-01  2e-04  2e-09  8e-08  2e-05\n18: -9.9986e-01 -9.9986e-01  2e-05  2e-10  1e-08  4e-06\n19: -9.9985e-01 -9.9984e-01  8e-05  3e-10  1e-08  9e-06\n20: -9.9982e-01 -9.9982e-01  9e-06  3e-11  1e-09  1e-06\n21: -9.9982e-01 -9.9981e-01  3e-05  3e-11  1e-09  3e-06\n22: -9.9981e-01 -9.9981e-01  3e-06  4e-12  2e-10  5e-07\n23: -9.9981e-01 -9.9981e-01  1e-05  4e-10  1e-10  1e-06\n24: -9.9980e-01 -9.9980e-01  1e-06  4e-11  2e-10  2e-07\n25: -9.9980e-01 -9.9980e-01  3e-06  2e-08  2e-10  4e-07\n26: -9.9980e-01 -9.9980e-01  4e-07  2e-09  1e-09  6e-08\nOptimal solution found.\nsage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: ---------------------------------------------------------------------------\nZeroDivisionError                         Traceback (most recent call last)\n<ipython-input-25-de8ebd622e01> in <module>()\n----> 1 p.solve() # boom - division by 0\n\n/home/fbissey/sandbox/git-fork/sage/src/sage/numerical/sdp.pyx in sage.numerical.sdp.SemidefiniteProgram.solve (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/numerical/sdp.c:7916)()\n    902             3.0\n    903         \"\"\"\n--> 904         self._backend.solve()\n    905         return self._backend.get_objective_value()\n    906 \n\n/home/fbissey/sandbox/git-fork/sage/src/sage/numerical/backends/cvxopt_sdp_backend.pyx in sage.numerical.backends.cvxopt_sdp_backend.CVXOPTSDPBackend.solve (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/numerical/backends/cvxopt_sdp_backend.c:5103)()\n    412             solvers.options[k] = v\n    413 \n--> 414         self.answer = solvers.sdp(c,Gs=G_matrix,hs=h_matrix)\n    415 \n    416         #possible outcomes\n\n/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/cvxopt/coneprog.py in sdp(c, Gl, hl, Gs, hs, A, b, solver, primalstart, dualstart, options, **kwargs)\n   4110         ds = None\n   4111 \n-> 4112     sol = conelp(c, G, h, dims, A = A, b = b, primalstart = ps, dualstart = ds, options = options)\n   4113     if sol['s'] is None:\n   4114         sol['sl'] = None\n\n/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/cvxopt/coneprog.py in conelp(c, G, h, dims, A, b, primalstart, dualstart, kktsolver, xnewcopy, xdot, xaxpy, xscal, ynewcopy, ydot, yaxpy, yscal, **kwargs)\n   1393         # Update lambda and scaling.\n   1394 \n-> 1395         misc.update_scaling(W, lmbda, ds, dz)\n   1396 \n   1397         # For kappa, tau block:\n\n/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/cvxopt/misc.py in update_scaling(W, lmbda, s, z)\n    626         # r := r*lambda^{-1/2}; rti := rti*lambda^{-1/2}\n    627         for i in range(m):\n--> 628             a = 1.0 / math.sqrt(lmbda[ind+i])\n    629             blas.scal(a, r, offset = m*i, n = m)\n    630             blas.scal(a, rti, offset = m*i, n = m)\n\nZeroDivisionError: float division by zero\nsage: sage: ---------------------------------------------------------------------------\nZeroDivisionError                         Traceback (most recent call last)\n<ipython-input-26-9348eec359de> in <module>()\n----> 1 sol = solvers.sdp(c, Gs=G, hs=h) # boom - division by 0\n\n/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/cvxopt/coneprog.py in sdp(c, Gl, hl, Gs, hs, A, b, solver, primalstart, dualstart, options, **kwargs)\n   4110         ds = None\n   4111 \n-> 4112     sol = conelp(c, G, h, dims, A = A, b = b, primalstart = ps, dualstart = ds, options = options)\n   4113     if sol['s'] is None:\n   4114         sol['sl'] = None\n\n/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/cvxopt/coneprog.py in conelp(c, G, h, dims, A, b, primalstart, dualstart, kktsolver, xnewcopy, xdot, xaxpy, xscal, ynewcopy, ydot, yaxpy, yscal, **kwargs)\n   1393         # Update lambda and scaling.\n   1394 \n-> 1395         misc.update_scaling(W, lmbda, ds, dz)\n   1396 \n   1397         # For kappa, tau block:\n\n/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/cvxopt/misc.py in update_scaling(W, lmbda, s, z)\n    626         # r := r*lambda^{-1/2}; rti := rti*lambda^{-1/2}\n    627         for i in range(m):\n--> 628             a = 1.0 / math.sqrt(lmbda[ind+i])\n    629             blas.scal(a, r, offset = m*i, n = m)\n    630             blas.scal(a, rti, offset = m*i, n = m)\n\nZeroDivisionError: float division by zero\nsage: Exiting Sage (CPU time 0m0.73s, Wall time 0m3.58s).\n```\n\nIf you think the problem is upstream, they are quite responsive in chasing issue.",
    "created_at": "2016-05-01T10:08:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278967",
    "user": "https://github.com/kiwifb"
}
```

For info, vanilla sage same machine

```
fbissey@QCD-nzi3 ~/sandbox/git-fork/sage $ ./sage < ~/xx.sage 
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 7.2.beta6, Release Date: 2016-04-28               │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage:      pcost       dcost       gap    pres   dres   k/t
 0: -1.2413e+00 -2.7310e+01  2e+01  3e-01  1e+01  1e+00
 1: -1.4977e+00 -3.1971e+00  6e-01  2e-02  9e-01  2e-01
 2: -1.2729e+00 -2.1411e+00  6e-01  1e-02  5e-01  2e-01
 3: -1.1436e+00 -1.2534e+00  8e-02  1e-03  6e-02  2e-02
 4: -1.1034e+00 -1.2438e+00  3e-01  2e-03  8e-02  4e-02
 5: -1.0500e+00 -1.0609e+00  2e-02  1e-04  7e-03  4e-03
 6: -1.0338e+00 -1.0407e+00  4e-02  1e-04  6e-03  7e-03
 7: -1.0201e+00 -1.0209e+00  8e-03  2e-05  1e-03  1e-03
 8: -1.0176e+00 -1.0176e+00  4e-02  4e-05  2e-03  4e-03
 9: -1.0071e+00 -1.0069e+00  3e-03  3e-06  1e-04  5e-04
10: -1.0042e+00 -1.0038e+00  4e-03  2e-06  8e-05  6e-04
11: -1.0027e+00 -1.0026e+00  1e-03  4e-07  2e-05  2e-04
12: -1.0028e+00 -1.0022e+00  8e-03  1e-06  5e-05  7e-04
13: -1.0009e+00 -1.0009e+00  6e-04  8e-08  4e-06  7e-05
14: -1.0005e+00 -1.0004e+00  3e-04  2e-08  1e-06  5e-05
15: -1.0003e+00 -1.0002e+00  8e-04  2e-08  1e-06  1e-04
16: -1.0000e+00 -1.0000e+00  9e-05  2e-09  1e-07  1e-05
17: -9.9992e-01 -9.9990e-01  2e-04  2e-09  8e-08  2e-05
18: -9.9986e-01 -9.9986e-01  2e-05  2e-10  1e-08  4e-06
19: -9.9985e-01 -9.9984e-01  8e-05  3e-10  1e-08  9e-06
20: -9.9982e-01 -9.9982e-01  9e-06  3e-11  1e-09  1e-06
21: -9.9982e-01 -9.9981e-01  3e-05  3e-11  1e-09  3e-06
22: -9.9981e-01 -9.9981e-01  3e-06  4e-12  2e-10  5e-07
23: -9.9981e-01 -9.9981e-01  1e-05  4e-10  1e-10  1e-06
24: -9.9980e-01 -9.9980e-01  1e-06  4e-11  2e-10  2e-07
25: -9.9980e-01 -9.9980e-01  3e-06  2e-08  2e-10  4e-07
26: -9.9980e-01 -9.9980e-01  4e-07  2e-09  1e-09  6e-08
Optimal solution found.
sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: sage: ---------------------------------------------------------------------------
ZeroDivisionError                         Traceback (most recent call last)
<ipython-input-25-de8ebd622e01> in <module>()
----> 1 p.solve() # boom - division by 0

/home/fbissey/sandbox/git-fork/sage/src/sage/numerical/sdp.pyx in sage.numerical.sdp.SemidefiniteProgram.solve (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/numerical/sdp.c:7916)()
    902             3.0
    903         """
--> 904         self._backend.solve()
    905         return self._backend.get_objective_value()
    906 

/home/fbissey/sandbox/git-fork/sage/src/sage/numerical/backends/cvxopt_sdp_backend.pyx in sage.numerical.backends.cvxopt_sdp_backend.CVXOPTSDPBackend.solve (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/numerical/backends/cvxopt_sdp_backend.c:5103)()
    412             solvers.options[k] = v
    413 
--> 414         self.answer = solvers.sdp(c,Gs=G_matrix,hs=h_matrix)
    415 
    416         #possible outcomes

/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/cvxopt/coneprog.py in sdp(c, Gl, hl, Gs, hs, A, b, solver, primalstart, dualstart, options, **kwargs)
   4110         ds = None
   4111 
-> 4112     sol = conelp(c, G, h, dims, A = A, b = b, primalstart = ps, dualstart = ds, options = options)
   4113     if sol['s'] is None:
   4114         sol['sl'] = None

/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/cvxopt/coneprog.py in conelp(c, G, h, dims, A, b, primalstart, dualstart, kktsolver, xnewcopy, xdot, xaxpy, xscal, ynewcopy, ydot, yaxpy, yscal, **kwargs)
   1393         # Update lambda and scaling.
   1394 
-> 1395         misc.update_scaling(W, lmbda, ds, dz)
   1396 
   1397         # For kappa, tau block:

/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/cvxopt/misc.py in update_scaling(W, lmbda, s, z)
    626         # r := r*lambda^{-1/2}; rti := rti*lambda^{-1/2}
    627         for i in range(m):
--> 628             a = 1.0 / math.sqrt(lmbda[ind+i])
    629             blas.scal(a, r, offset = m*i, n = m)
    630             blas.scal(a, rti, offset = m*i, n = m)

ZeroDivisionError: float division by zero
sage: sage: ---------------------------------------------------------------------------
ZeroDivisionError                         Traceback (most recent call last)
<ipython-input-26-9348eec359de> in <module>()
----> 1 sol = solvers.sdp(c, Gs=G, hs=h) # boom - division by 0

/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/cvxopt/coneprog.py in sdp(c, Gl, hl, Gs, hs, A, b, solver, primalstart, dualstart, options, **kwargs)
   4110         ds = None
   4111 
-> 4112     sol = conelp(c, G, h, dims, A = A, b = b, primalstart = ps, dualstart = ds, options = options)
   4113     if sol['s'] is None:
   4114         sol['sl'] = None

/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/cvxopt/coneprog.py in conelp(c, G, h, dims, A, b, primalstart, dualstart, kktsolver, xnewcopy, xdot, xaxpy, xscal, ynewcopy, ydot, yaxpy, yscal, **kwargs)
   1393         # Update lambda and scaling.
   1394 
-> 1395         misc.update_scaling(W, lmbda, ds, dz)
   1396 
   1397         # For kappa, tau block:

/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/cvxopt/misc.py in update_scaling(W, lmbda, s, z)
    626         # r := r*lambda^{-1/2}; rti := rti*lambda^{-1/2}
    627         for i in range(m):
--> 628             a = 1.0 / math.sqrt(lmbda[ind+i])
    629             blas.scal(a, r, offset = m*i, n = m)
    630             blas.scal(a, rti, offset = m*i, n = m)

ZeroDivisionError: float division by zero
sage: Exiting Sage (CPU time 0m0.73s, Wall time 0m3.58s).
```

If you think the problem is upstream, they are quite responsive in chasing issue.



---

archive/issue_comments_278968.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-01T11:48:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278968",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_278969.json:
```json
{
    "body": "Replying to [comment:28 dimpase]:\n> the failure with xx.sage attachment is also reproducible on OSX (Core2Duo CPU), although it's slightly different (the 2nd and 3rd calls to the solver return \"infeasible\" rather than bail out with zero division).\n\nOSX is fixed by the latest commit. But it does not fix the Gentoo Xeon case...\n\nDoes it fix sage-on-gentoo with openblas case?",
    "created_at": "2016-05-01T11:53:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278969",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:28 dimpase]:
> the failure with xx.sage attachment is also reproducible on OSX (Core2Duo CPU), although it's slightly different (the 2nd and 3rd calls to the solver return "infeasible" rather than bail out with zero division).

OSX is fixed by the latest commit. But it does not fix the Gentoo Xeon case...

Does it fix sage-on-gentoo with openblas case?



---

archive/issue_comments_278970.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-01T14:41:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278970",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_278971.json:
```json
{
    "body": "I will need to put that in a patch and rebuild since it is `.pyx` in the case of sage-on-gentoo that means rebuilding the whole library and the doc (but not the dependencies). I'll put both commits.",
    "created_at": "2016-05-01T22:35:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278971",
    "user": "https://github.com/kiwifb"
}
```

I will need to put that in a patch and rebuild since it is `.pyx` in the case of sage-on-gentoo that means rebuilding the whole library and the doc (but not the dependencies). I'll put both commits.



---

archive/issue_comments_278972.json:
```json
{
    "body": "No changes for sage-on-gentoo when including the last two commits (and only those not the rest of the branch).",
    "created_at": "2016-05-02T01:38:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278972",
    "user": "https://github.com/kiwifb"
}
```

No changes for sage-on-gentoo when including the last two commits (and only those not the rest of the branch).



---

archive/issue_comments_278973.json:
```json
{
    "body": "No impact on vanilla sage on the same machine.",
    "created_at": "2016-05-02T01:47:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278973",
    "user": "https://github.com/kiwifb"
}
```

No impact on vanilla sage on the same machine.



---

archive/issue_comments_278974.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-02T14:25:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278974",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_278975.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-02T14:43:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278975",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_278976.json:
```json
{
    "body": "I removed the \"unstable\" example. Now sage4 bot (and the rest) should be happy.\nIt will go on another ticket.",
    "created_at": "2016-05-02T14:47:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278976",
    "user": "https://github.com/dimpase"
}
```

I removed the "unstable" example. Now sage4 bot (and the rest) should be happy.
It will go on another ticket.



---

archive/issue_comments_278977.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-05-02T14:47:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278977",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_278978.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-05-03T05:18:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278978",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_278979.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-05-04T17:10:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278979",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_019249.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-05-04T17:10:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20269#event-19249"
}
```



---

archive/issue_comments_278980.json:
```json
{
    "body": "Replying to [comment:36 git]:\n> ||[02157ad](http://git.sagemath.org/sage.git/commit/?id=02157ad1595da1981abba8f01af816864e421ef2)||`removing numerically unstable test - will be on another ticket`||\n\nthis is traced down to wrongly set `refinement` parameter in `numerical/backends/cvxopt_sdp_backend.py` \n\n\n```\ndiff --git a/src/sage/numerical/backends/cvxopt_sdp_backend.pyx b/src/sage/numerical/backends/cvxopt_sdp_backend.pyx\nindex 6c24173..b65d4bc 100644\n--- a/src/sage/numerical/backends/cvxopt_sdp_backend.pyx\n+++ b/src/sage/numerical/backends/cvxopt_sdp_backend.pyx\n@@ -63,7 +63,7 @@ cdef class CVXOPTSDPBackend(GenericSDPBackend):\n                       \"abstol\":1e-7,\n                       \"reltol\":1e-6,\n                       \"feastol\":1e-7,\n-                      \"refinement\":0 }\n+                      \"refinement\":1 }\n         self.answer = {}\n         if maximization:\n             self.set_sense(+1)\n```\n\nWill be fixed on #21778",
    "created_at": "2016-10-27T21:28:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20269",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20269#issuecomment-278980",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:36 git]:
> ||[02157ad](http://git.sagemath.org/sage.git/commit/?id=02157ad1595da1981abba8f01af816864e421ef2)||`removing numerically unstable test - will be on another ticket`||

this is traced down to wrongly set `refinement` parameter in `numerical/backends/cvxopt_sdp_backend.py` 


```
diff --git a/src/sage/numerical/backends/cvxopt_sdp_backend.pyx b/src/sage/numerical/backends/cvxopt_sdp_backend.pyx
index 6c24173..b65d4bc 100644
--- a/src/sage/numerical/backends/cvxopt_sdp_backend.pyx
+++ b/src/sage/numerical/backends/cvxopt_sdp_backend.pyx
@@ -63,7 +63,7 @@ cdef class CVXOPTSDPBackend(GenericSDPBackend):
                       "abstol":1e-7,
                       "reltol":1e-6,
                       "feastol":1e-7,
-                      "refinement":0 }
+                      "refinement":1 }
         self.answer = {}
         if maximization:
             self.set_sense(+1)
```

Will be fixed on #21778
