# Issue 10510: improve jordan_form over univariate rational expressions

Issue created by migration from https://trac.sagemath.org/ticket/10563

Original creator: zimmerma

Original creation time: 2011-01-06 20:56:09

Assignee: jason, was

This was reported by Alexandre Casamayou:

```
sage: R = FractionField(PolynomialRing(RationalField(),'a'))
sage: A = matrix(R,[[1,a],[a,1]])
sage: A.jordan_form()
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)

/localdisk/tmp/c157/<ipython console> in <module>()

/usr/local/sage/local/lib/python2.6/site-packages/sage/matrix/matrix2.so in sage.matrix.matrix2.Matrix.jordan_form (sage/matrix/matrix2.c:32527)()

/usr/local/sage/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.roots (sage/rings/polynomial/polynomial_element.c:31227)()

/usr/local/sage/local/lib/python2.6/site-packages/sage/rings/ring.so in sage.rings.ring.Ring.is_finite (sage/rings/ring.c:5810)()

NotImplementedError: 
```



---

Comment by rbeezer created at 2011-01-11 23:48:12

It seems the fraction field does not know if it is finite or infinite.  Maybe something else is in the way of getting Jordan form, but this looks like the first obstacle.


```
sage: T.<a>=QQ[]
sage: R=FractionField(T)
sage: A = matrix(R,[[1,a],[a,1]])
                           
sage: A.charpoly().roots()
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)

/home/sage/sage-4.6.1.rc1/devel/sage-main/<ipython console> in <module>()

/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.roots (sage/rings/polynomial/polynomial_element.c:31227)()

/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/rings/ring.so in sage.rings.ring.Ring.is_finite (sage/rings/ring.c:5810)()

NotImplementedError: 

sage: R.is_finite()
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)

/home/sage/sage-4.6.1.rc1/devel/sage-main/<ipython console> in <module>()

/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/rings/ring.so in sage.rings.ring.Ring.is_finite (sage/rings/ring.c:5810)()

NotImplementedError: 
```



---

Comment by rbeezer created at 2011-01-11 23:59:32

Even with a quick-hacked `.is_finite()` method, this still fails.  Getting eigenvalues over an exact ring requires factoring or root-finding, neither of which seems to be implemented over this fraction field.  The following uses the same matrix `A` as above, but with the finiteness check added in:


```
sage: A.jordan_form()
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)

/home/sage/sage-4.6.1.rc1/devel/sage-main/<ipython console> in <module>()

/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/matrix/matrix2.so in sage.matrix.matrix2.Matrix.jordan_form (sage/matrix/matrix2.c:32626)()

/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.roots (sage/rings/polynomial/polynomial_element.c:31330)()

NotImplementedError: root finding for this polynomial not implemented

sage: A.eigenvalues()
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)

/home/sage/sage-4.6.1.rc1/devel/sage-main/<ipython console> in <module>()

/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/matrix/matrix2.so in sage.matrix.matrix2.Matrix.eigenvalues (sage/matrix/matrix2.c:22130)()

/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/matrix/matrix2.so in sage.matrix.matrix2.Matrix.fcp (sage/matrix/matrix2.c:10516)()

/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.factor (sage/rings/polynomial/polynomial_element.c:23007)()

NotImplementedError: 
```



---

Comment by chapoton created at 2021-09-06 11:54:16

This works now (sage 9.5.b0):

```
sage: R = FractionField(PolynomialRing(RationalField(),'a'))                    
sage: a = R.gen()                                                                 
sage: A = matrix(R,[[1,a],[a,1]])                                               
sage: A.jordan_form()                                                           
[ a + 1|     0]
[------+------]
[     0|-a + 1]
```



---

Comment by zimmerma created at 2021-09-07 14:00:17

Changing status from new to needs_review.


---

Comment by zimmerma created at 2021-09-07 14:00:17

great! I propose to resolve as "fixed".


---

Comment by lorenz created at 2021-09-08 01:55:50

Actually, here's a branch with a doctest.


---

Comment by zimmerma created at 2021-09-08 08:48:38


```
zimmerma@biscotte:/localdisk/zimmerma/sage$ ./sage -t -p 64 --all
...
sage -t --warn-long 55.5 --random-seed=0 src/sage/modules/free_module_integer.py  # 5 doctests failed
sage -t --warn-long 55.5 --random-seed=0 src/doc/en/prep/Calculus.rst  # 1 doctest failed
----------------------------------------------------------------------
Total time for all tests: 300.1 seconds
    cpu time: 9034.7 seconds
    cumulative wall time: 13560.8 seconds
Pytest is not installed, skip checking tests that rely on it.
```



---

Comment by chapoton created at 2021-09-08 13:48:59

ok, green bot


---

Comment by chapoton created at 2021-09-08 13:48:59

Changing status from needs_review to positive_review.


---

Comment by zimmerma created at 2021-09-08 13:53:25

what about the "Lint failing" box? Should we ignore it?


---

Comment by chapoton created at 2021-09-08 14:55:23

Well, all 3 linters now fail on vanilla sage. Next beta release may have one linter passing.

Somebody (?) should work on having the 2 other linters also green. One of them is rather hopeless, imho.


---

Comment by vbraun created at 2021-09-19 09:57:59

Resolution: fixed
