# Issue 10510: improve jordan_form over univariate rational expressions

archive/issues_010510.json:
```json
{
    "body": "Assignee: jason, was\n\nThis was reported by Alexandre Casamayou:\n\n```\nsage: R = FractionField(PolynomialRing(RationalField(),'a'))\nsage: A = matrix(R,[[1,a],[a,1]])\nsage: A.jordan_form()\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n\n/localdisk/tmp/c157/<ipython console> in <module>()\n\n/usr/local/sage/local/lib/python2.6/site-packages/sage/matrix/matrix2.so in sage.matrix.matrix2.Matrix.jordan_form (sage/matrix/matrix2.c:32527)()\n\n/usr/local/sage/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.roots (sage/rings/polynomial/polynomial_element.c:31227)()\n\n/usr/local/sage/local/lib/python2.6/site-packages/sage/rings/ring.so in sage.rings.ring.Ring.is_finite (sage/rings/ring.c:5810)()\n\nNotImplementedError: \n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/10563\n\n",
    "created_at": "2011-01-06T20:56:09Z",
    "labels": [
        "component: linear algebra",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "improve jordan_form over univariate rational expressions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10510",
    "user": "https://github.com/zimmermann6"
}
```
Assignee: jason, was

This was reported by Alexandre Casamayou:

```
sage: R = FractionField(PolynomialRing(RationalField(),'a'))
sage: A = matrix(R,[[1,a],[a,1]])
sage: A.jordan_form()
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)

/localdisk/tmp/c157/<ipython console> in <module>()

/usr/local/sage/local/lib/python2.6/site-packages/sage/matrix/matrix2.so in sage.matrix.matrix2.Matrix.jordan_form (sage/matrix/matrix2.c:32527)()

/usr/local/sage/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.roots (sage/rings/polynomial/polynomial_element.c:31227)()

/usr/local/sage/local/lib/python2.6/site-packages/sage/rings/ring.so in sage.rings.ring.Ring.is_finite (sage/rings/ring.c:5810)()

NotImplementedError: 
```


Issue created by migration from https://trac.sagemath.org/ticket/10563





---

archive/issue_comments_109484.json:
```json
{
    "body": "It seems the fraction field does not know if it is finite or infinite.  Maybe something else is in the way of getting Jordan form, but this looks like the first obstacle.\n\n\n```\nsage: T.<a>=QQ[]\nsage: R=FractionField(T)\nsage: A = matrix(R,[[1,a],[a,1]])\n                           \nsage: A.charpoly().roots()\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n\n/home/sage/sage-4.6.1.rc1/devel/sage-main/<ipython console> in <module>()\n\n/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.roots (sage/rings/polynomial/polynomial_element.c:31227)()\n\n/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/rings/ring.so in sage.rings.ring.Ring.is_finite (sage/rings/ring.c:5810)()\n\nNotImplementedError: \n\nsage: R.is_finite()\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n\n/home/sage/sage-4.6.1.rc1/devel/sage-main/<ipython console> in <module>()\n\n/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/rings/ring.so in sage.rings.ring.Ring.is_finite (sage/rings/ring.c:5810)()\n\nNotImplementedError: \n```\n",
    "created_at": "2011-01-11T23:48:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10510",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10510#issuecomment-109484",
    "user": "https://github.com/rbeezer"
}
```

It seems the fraction field does not know if it is finite or infinite.  Maybe something else is in the way of getting Jordan form, but this looks like the first obstacle.


```
sage: T.<a>=QQ[]
sage: R=FractionField(T)
sage: A = matrix(R,[[1,a],[a,1]])
                           
sage: A.charpoly().roots()
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)

/home/sage/sage-4.6.1.rc1/devel/sage-main/<ipython console> in <module>()

/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.roots (sage/rings/polynomial/polynomial_element.c:31227)()

/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/rings/ring.so in sage.rings.ring.Ring.is_finite (sage/rings/ring.c:5810)()

NotImplementedError: 

sage: R.is_finite()
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)

/home/sage/sage-4.6.1.rc1/devel/sage-main/<ipython console> in <module>()

/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/rings/ring.so in sage.rings.ring.Ring.is_finite (sage/rings/ring.c:5810)()

NotImplementedError: 
```




---

archive/issue_comments_109485.json:
```json
{
    "body": "Even with a quick-hacked `.is_finite()` method, this still fails.  Getting eigenvalues over an exact ring requires factoring or root-finding, neither of which seems to be implemented over this fraction field.  The following uses the same matrix `A` as above, but with the finiteness check added in:\n\n\n```\nsage: A.jordan_form()\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n\n/home/sage/sage-4.6.1.rc1/devel/sage-main/<ipython console> in <module>()\n\n/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/matrix/matrix2.so in sage.matrix.matrix2.Matrix.jordan_form (sage/matrix/matrix2.c:32626)()\n\n/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.roots (sage/rings/polynomial/polynomial_element.c:31330)()\n\nNotImplementedError: root finding for this polynomial not implemented\n\nsage: A.eigenvalues()\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n\n/home/sage/sage-4.6.1.rc1/devel/sage-main/<ipython console> in <module>()\n\n/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/matrix/matrix2.so in sage.matrix.matrix2.Matrix.eigenvalues (sage/matrix/matrix2.c:22130)()\n\n/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/matrix/matrix2.so in sage.matrix.matrix2.Matrix.fcp (sage/matrix/matrix2.c:10516)()\n\n/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.factor (sage/rings/polynomial/polynomial_element.c:23007)()\n\nNotImplementedError: \n```\n",
    "created_at": "2011-01-11T23:59:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10510",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10510#issuecomment-109485",
    "user": "https://github.com/rbeezer"
}
```

Even with a quick-hacked `.is_finite()` method, this still fails.  Getting eigenvalues over an exact ring requires factoring or root-finding, neither of which seems to be implemented over this fraction field.  The following uses the same matrix `A` as above, but with the finiteness check added in:


```
sage: A.jordan_form()
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)

/home/sage/sage-4.6.1.rc1/devel/sage-main/<ipython console> in <module>()

/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/matrix/matrix2.so in sage.matrix.matrix2.Matrix.jordan_form (sage/matrix/matrix2.c:32626)()

/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.roots (sage/rings/polynomial/polynomial_element.c:31330)()

NotImplementedError: root finding for this polynomial not implemented

sage: A.eigenvalues()
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)

/home/sage/sage-4.6.1.rc1/devel/sage-main/<ipython console> in <module>()

/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/matrix/matrix2.so in sage.matrix.matrix2.Matrix.eigenvalues (sage/matrix/matrix2.c:22130)()

/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/matrix/matrix2.so in sage.matrix.matrix2.Matrix.fcp (sage/matrix/matrix2.c:10516)()

/sage/sage-4.6.1.rc1/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_element.so in sage.rings.polynomial.polynomial_element.Polynomial.factor (sage/rings/polynomial/polynomial_element.c:23007)()

NotImplementedError: 
```




---

archive/issue_comments_109486.json:
```json
{
    "body": "This works now (sage 9.5.b0):\n\n```\nsage: R = FractionField(PolynomialRing(RationalField(),'a'))                    \nsage: a = R.gen()                                                                 \nsage: A = matrix(R,[[1,a],[a,1]])                                               \nsage: A.jordan_form()                                                           \n[ a + 1|     0]\n[------+------]\n[     0|-a + 1]\n```\n",
    "created_at": "2021-09-06T11:54:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10510",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10510#issuecomment-109486",
    "user": "https://github.com/fchapoton"
}
```

This works now (sage 9.5.b0):

```
sage: R = FractionField(PolynomialRing(RationalField(),'a'))                    
sage: a = R.gen()                                                                 
sage: A = matrix(R,[[1,a],[a,1]])                                               
sage: A.jordan_form()                                                           
[ a + 1|     0]
[------+------]
[     0|-a + 1]
```




---

archive/issue_comments_109487.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-09-07T14:00:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10510",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10510#issuecomment-109487",
    "user": "https://github.com/zimmermann6"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_109488.json:
```json
{
    "body": "great! I propose to resolve as \"fixed\".",
    "created_at": "2021-09-07T14:00:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10510",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10510#issuecomment-109488",
    "user": "https://github.com/zimmermann6"
}
```

great! I propose to resolve as "fixed".



---

archive/issue_comments_109489.json:
```json
{
    "body": "Actually, here's a branch with a doctest.",
    "created_at": "2021-09-08T01:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10510",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10510#issuecomment-109489",
    "user": "https://github.com/yyyyx4"
}
```

Actually, here's a branch with a doctest.



---

archive/issue_comments_109490.json:
```json
{
    "body": "\n```\nzimmerma@biscotte:/localdisk/zimmerma/sage$ ./sage -t -p 64 --all\n...\nsage -t --warn-long 55.5 --random-seed=0 src/sage/modules/free_module_integer.py  # 5 doctests failed\nsage -t --warn-long 55.5 --random-seed=0 src/doc/en/prep/Calculus.rst  # 1 doctest failed\n----------------------------------------------------------------------\nTotal time for all tests: 300.1 seconds\n    cpu time: 9034.7 seconds\n    cumulative wall time: 13560.8 seconds\nPytest is not installed, skip checking tests that rely on it.\n```\n",
    "created_at": "2021-09-08T08:48:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10510",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10510#issuecomment-109490",
    "user": "https://github.com/zimmermann6"
}
```


```
zimmerma@biscotte:/localdisk/zimmerma/sage$ ./sage -t -p 64 --all
...
sage -t --warn-long 55.5 --random-seed=0 src/sage/modules/free_module_integer.py  # 5 doctests failed
sage -t --warn-long 55.5 --random-seed=0 src/doc/en/prep/Calculus.rst  # 1 doctest failed
----------------------------------------------------------------------
Total time for all tests: 300.1 seconds
    cpu time: 9034.7 seconds
    cumulative wall time: 13560.8 seconds
Pytest is not installed, skip checking tests that rely on it.
```




---

archive/issue_comments_109491.json:
```json
{
    "body": "ok, green bot",
    "created_at": "2021-09-08T13:48:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10510",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10510#issuecomment-109491",
    "user": "https://github.com/fchapoton"
}
```

ok, green bot



---

archive/issue_comments_109492.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-09-08T13:48:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10510",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10510#issuecomment-109492",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_109493.json:
```json
{
    "body": "what about the \"Lint failing\" box? Should we ignore it?",
    "created_at": "2021-09-08T13:53:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10510",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10510#issuecomment-109493",
    "user": "https://github.com/zimmermann6"
}
```

what about the "Lint failing" box? Should we ignore it?



---

archive/issue_comments_109494.json:
```json
{
    "body": "Well, all 3 linters now fail on vanilla sage. Next beta release may have one linter passing.\n\nSomebody (?) should work on having the 2 other linters also green. One of them is rather hopeless, imho.",
    "created_at": "2021-09-08T14:55:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10510",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10510#issuecomment-109494",
    "user": "https://github.com/fchapoton"
}
```

Well, all 3 linters now fail on vanilla sage. Next beta release may have one linter passing.

Somebody (?) should work on having the 2 other linters also green. One of them is rather hopeless, imho.



---

archive/issue_comments_109495.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-09-19T09:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10510",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10510#issuecomment-109495",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_010637.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2021-09-19T09:57:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10510",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10510#event-10637"
}
```
