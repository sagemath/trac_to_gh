# Issue 12146: **kwds in the Graph constructor is confusing

Issue created by migration from Trac.

Original creator: brunellus

Original creation time: 2012-01-17 23:08:55

Assignee: jason, ncohen, rlm

CC:  brunellus

The possibility of using any argument in the Graph constructor without an error is very confusing, see #10441 for some example. Is the universal **kwds argument necessary?


---

Comment by brunellus created at 2012-01-18 18:40:57

As you can see in this patch, there were three wrong (quietly disfunctional) calls in the sage library itself.

I'll think if there is something I can do with BipartiteGraph constructor. It's quite messy.


---

Attachment


---

Attachment


---

Comment by brunellus created at 2012-01-20 11:29:32

OK, this should be it. In the bipartite case I left *args and **kwds in the constructor, but they are only used to construct a Graph now, so this should be safe.


---

Comment by brunellus created at 2012-01-20 11:29:32

Changing status from new to needs_review.


---

Comment by ncohen created at 2012-01-28 13:33:38

Wow, veeeeeeery good idea !!!

Several remarks :

    * in BipartiteGraph : could you explicit in the description of the ``check`` flag what "changing the graph to be bipartite" means ? The documentation later says "However, if one specifies check=False, the offending edges are simply deleted (along with those vertices not appearing in either list)" but it is easy to miss.

    * Your test 

```
if len(partition[0]) > 0 or len(partition[1]) > 0: 
```

      Can be replaced by

```
if partition[0] or partition[1]: 
```

      Python is funny sometimes `:-p`
    * Why did you replace 

```
#. An arbitrary graph (finds a bipartition). 
#. A graph and a bipartition. 
```

      By

```
#. An arbitrary graph. 
```

      ? `O_o`
    * The line "- all remaining arguments are passed to the ``Graph`` constructor" would fit well inside of a ".. NOTE::" field.

    * What about making what "``convert_empty_dict_labels_to_None``" does more explicit ? Something saying "you don't have to care as long as you do not deal with NetworkX". For instance : "This arguments sets the default edge labels used by NetworkX (empty dictionaries) to be replaced by ``None``, the default Sage edge label. It is set to ``True`` by default.

Nathann


---

Comment by ncohen created at 2012-01-28 13:33:38

Changing status from needs_review to needs_work.


---

Comment by brunellus created at 2012-01-28 14:11:22

Thanks!

Replying to [comment:3 ncohen]:
>     * Why did you replace 
> {{{
> #. An arbitrary graph (finds a bipartition). 
> #. A graph and a bipartition. 
> }}}
>       By
> {{{
> #. An arbitrary graph. 
> }}}
>       ? `O_o`

Well, the _data_ argument doesn't hold any information about partition. "A graph and a bipartion" seems like someone could write BipartiteGraph(data=(Graph(...), [...]))

Lukáš.


---

Comment by ncohen created at 2012-01-28 18:06:27

Changing status from needs_work to positive_review.


---

Attachment

After another review and looooooong tests on Sage, this patch can go ! `:-)`

Nathann


---

Comment by jdemeyer created at 2012-01-30 10:07:34

I get doctest failures:

```
sage -t  -force_lib devel/sage/sage/geometry/triangulation/point_configuration.py
**********************************************************************
File "/mnt/usb1/scratch/jdemeyer/merger/sage-5.0.beta2/devel/sage-main/sage/geometry/triangulation/point_configuration.py", line 1620:
    sage: pyramid.restricted_automorphism_group()
Expected:
    Permutation Group with generators [(3,5), (2,3)(4,5), (2,4)]
Got:
    Permutation Group with generators [(4,5), (3,4), (2,3), (1,2)]
**********************************************************************
File "/mnt/usb1/scratch/jdemeyer/merger/sage-5.0.beta2/devel/sage-main/sage/geometry/triangulation/point_configuration.py", line 1622:
    sage: DihedralGroup(4).is_isomorphic(_)
Expected:
    True
Got:
    False
**********************************************************************
File "/mnt/usb1/scratch/jdemeyer/merger/sage-5.0.beta2/devel/sage-main/sage/geometry/triangulation/point_configuration.py", line 1630:
    sage: square.restricted_automorphism_group()
Expected:
    Permutation Group with generators [(3,5)]
Got:
    Permutation Group with generators [(4,5), (3,4), (2,3), (1,2)]
**********************************************************************
File "/mnt/usb1/scratch/jdemeyer/merger/sage-5.0.beta2/devel/sage-main/sage/geometry/triangulation/point_configuration.py", line 1632:
    sage: DihedralGroup(1).is_isomorphic(_)
Expected:
    True
Got:
    False
**********************************************************************
```

and similar errors in `devel/sage/sage/geometry/polyhedra.py`.


---

Comment by jdemeyer created at 2012-01-30 10:07:34

Changing status from positive_review to needs_work.


---

Comment by ncohen created at 2012-01-30 10:15:20

My God. It thought it was because I had intalled GAP recently on my machine... There there are exceptions which are not read correctly.. I'll take care of that `O_o`

Nathann


---

Comment by ncohen created at 2012-01-30 11:44:24

Changing status from needs_work to needs_review.


---

Comment by ncohen created at 2012-01-30 11:44:24

Well....

So.

In his patch Lukasz replaced the arguments to Graph that were in the files by what they *intended*. For instance, he replaced dense=True by sparse=False, which makes sense. The thing is that the "dense" value was not read by the Graph backend, and as a result writing Graph(dense=True) actually created a sparse Graph.
He replaced the values by what was meant, but what was executed was actually different.
So I replaced the code, in this second patch, by what was actually run.

All this tells us is that there's something very wrong with the Dense graph backends. That's urgent to fix but does not mean computations went wrong before, precisely because the dense backend is almost never used.

This patch "solves the problem". And I created ticket #12387 for the dense backend problem.

Nathann


---

Attachment


---

Comment by brunellus created at 2012-02-06 11:41:47

Thanks! All tests pass now.


---

Comment by brunellus created at 2012-02-06 11:41:47

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-02-14 14:21:17

Resolution: fixed
