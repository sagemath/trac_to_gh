# Issue 14802: sage python library and automake

archive/issues_014802.json:
```json
{
    "body": "CC:  jondo\n\nI have chosen to implement the distribution independent build system with autotools. It turns out that two changes considerably simplify issues.\n\n- change the suffix for .pyx files that are intended to be compiled to c++ code. automake derives the build rules from this suffix, not from meta information.\n- don't use `lib[a-z]*.pyx` as the filenames for cython code. libtool will confuse the resulting plugins with shared libraries.\n\nThese changes are pretty small and can be tested/reviewed/merged independently.\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/15039\n\n",
    "created_at": "2013-08-12T15:34:29Z",
    "labels": [
        "build",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "sage python library and automake",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14802",
    "user": "felixs"
}
```
CC:  jondo

I have chosen to implement the distribution independent build system with autotools. It turns out that two changes considerably simplify issues.

- change the suffix for .pyx files that are intended to be compiled to c++ code. automake derives the build rules from this suffix, not from meta information.
- don't use `lib[a-z]*.pyx` as the filenames for cython code. libtool will confuse the resulting plugins with shared libraries.

These changes are pretty small and can be tested/reviewed/merged independently.



Issue created by migration from https://trac.sagemath.org/ticket/15039





---

archive/issue_comments_188794.json:
```json
{
    "body": "Unfortunately, cython needs to be patched to not unnecessarily break setup.py.",
    "created_at": "2013-08-23T21:34:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14802#issuecomment-188794",
    "user": "felixs"
}
```

Unfortunately, cython needs to be patched to not unnecessarily break setup.py.



---

archive/issue_comments_188795.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-08-23T21:34:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14802#issuecomment-188795",
    "user": "felixs"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_188796.json:
```json
{
    "body": "This obviously needs to be discussed with Cython upstream... The following thread seems relevant but doesn't end in a conclusion, and I don't know the current status there. IMHO we shouldn't modify Cython in a way that upstream won't ever merge. \n\nhttp://thread.gmane.org/gmane.comp.python.cython.devel/14955/focus=14964\n----\nNew commits:",
    "created_at": "2013-12-05T17:18:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14802#issuecomment-188796",
    "user": "vbraun"
}
```

This obviously needs to be discussed with Cython upstream... The following thread seems relevant but doesn't end in a conclusion, and I don't know the current status there. IMHO we shouldn't modify Cython in a way that upstream won't ever merge. 

http://thread.gmane.org/gmane.comp.python.cython.devel/14955/focus=14964
----
New commits:



---

archive/issue_comments_188797.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2013-12-05T17:18:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14802#issuecomment-188797",
    "user": "vbraun"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_188798.json:
```json
{
    "body": "Replying to [comment:3 vbraun]:\n> http://thread.gmane.org/gmane.comp.python.cython.devel/14955/focus=14964\nthis thread is relevant, but it's mostly about cython bug 655 (=writing out dependencies for builds involving cython).\n\nthis ticket patches cython (4 lines) to fix a different issue. commit `@`74c837c makes `cythonize` work on files with arbitrary extensions. and thus work after appending x to files containing cython code meant to be translated to c++. for sage, this patch is meant to facilitate a transition from distutils to a (make based) build system. it's simply allowing them to coexist (and is not required after a transition).\n\ni expect that cython developers will merge this patch (or some variant), if they see flexibility as improvement (e.g. like Robert has merged the patch that unhardwires the debugger output path, https://github.com/cython/cython/pull/247). alternatives may exist of course, i didn't find them...",
    "created_at": "2013-12-05T23:48:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14802#issuecomment-188798",
    "user": "felixs"
}
```

Replying to [comment:3 vbraun]:
> http://thread.gmane.org/gmane.comp.python.cython.devel/14955/focus=14964
this thread is relevant, but it's mostly about cython bug 655 (=writing out dependencies for builds involving cython).

this ticket patches cython (4 lines) to fix a different issue. commit `@`74c837c makes `cythonize` work on files with arbitrary extensions. and thus work after appending x to files containing cython code meant to be translated to c++. for sage, this patch is meant to facilitate a transition from distutils to a (make based) build system. it's simply allowing them to coexist (and is not required after a transition).

i expect that cython developers will merge this patch (or some variant), if they see flexibility as improvement (e.g. like Robert has merged the patch that unhardwires the debugger output path, https://github.com/cython/cython/pull/247). alternatives may exist of course, i didn't find them...



---

archive/issue_comments_188799.json:
```json
{
    "body": "I think it's clear that there no plans at all to start using automake for the Sage library. Even if automake has its advantages, as far as I know every single Python project uses `distutils` or some variant.",
    "created_at": "2017-09-05T13:03:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14802#issuecomment-188799",
    "user": "jdemeyer"
}
```

I think it's clear that there no plans at all to start using automake for the Sage library. Even if automake has its advantages, as far as I know every single Python project uses `distutils` or some variant.



---

archive/issue_comments_188800.json:
```json
{
    "body": "Changing status from needs_info to positive_review.",
    "created_at": "2017-09-05T13:03:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14802#issuecomment-188800",
    "user": "jdemeyer"
}
```

Changing status from needs_info to positive_review.



---

archive/issue_comments_188801.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2017-12-12T08:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14802",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14802#issuecomment-188801",
    "user": "embray"
}
```

Resolution: wontfix
