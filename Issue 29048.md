# Issue 29048: avoid getting into pyenv trap

archive/issues_029048.json:
```json
{
    "body": "CC:  @embray @mkoeppe @slel @tobiasdiez @jhpalmieri\n\nwe had seen at least one [report](https://groups.google.com/d/msg/sage-devel/-cGmntUHXqE/Pw02KLksCgAJ) where [pyenv](https://github.com/pyenv/pyenv) broke the build, as pyenv'd Python prepends stuff like `/usr/bin` into `PATH`. \n\nIt might be a good idea to check this at configure time.\n\nIssue created by migration from https://trac.sagemath.org/ticket/29285\n\n",
    "created_at": "2020-03-06T14:53:42Z",
    "labels": [
        "component: build: configure"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "avoid getting into pyenv trap",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29048",
    "user": "https://github.com/dimpase"
}
```
CC:  @embray @mkoeppe @slel @tobiasdiez @jhpalmieri

we had seen at least one [report](https://groups.google.com/d/msg/sage-devel/-cGmntUHXqE/Pw02KLksCgAJ) where [pyenv](https://github.com/pyenv/pyenv) broke the build, as pyenv'd Python prepends stuff like `/usr/bin` into `PATH`. 

It might be a good idea to check this at configure time.

Issue created by migration from https://trac.sagemath.org/ticket/29285





---

archive/issue_comments_410649.json:
```json
{
    "body": "Who's doing something with pyenv?\n\nI don't think we need to provide work-arounds for every conceivable user environment misconfiguration.",
    "created_at": "2020-03-06T14:55:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410649",
    "user": "https://github.com/embray"
}
```

Who's doing something with pyenv?

I don't think we need to provide work-arounds for every conceivable user environment misconfiguration.



---

archive/issue_comments_410650.json:
```json
{
    "body": "Replying to [comment:1 embray]:\n> Who's doing something with pyenv?\n\nhttps://dblp.org/pers/k/Kruppa:Alexander.html\n\n> I don't think we need to provide work-arounds for every conceivable user environment misconfiguration.",
    "created_at": "2020-03-06T15:01:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410650",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:1 embray]:
> Who's doing something with pyenv?

https://dblp.org/pers/k/Kruppa:Alexander.html

> I don't think we need to provide work-arounds for every conceivable user environment misconfiguration.



---

archive/issue_comments_410651.json:
```json
{
    "body": "Pyenv creates major issues with packages sometimes, I can imagine what Sagemath might be going about. My easiest fix would be symlinking the two paths together which allows communication, between your bin and other paths, it did work for me when I was trying simple builds, of course now I use Sagemath as an application separately.\n\nPyenv is popular with MacOs users, so this will definitely need a fix",
    "created_at": "2020-03-20T17:44:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410651",
    "user": "https://github.com/Shlokatadistance"
}
```

Pyenv creates major issues with packages sometimes, I can imagine what Sagemath might be going about. My easiest fix would be symlinking the two paths together which allows communication, between your bin and other paths, it did work for me when I was trying simple builds, of course now I use Sagemath as an application separately.

Pyenv is popular with MacOs users, so this will definitely need a fix



---

archive/issue_comments_410652.json:
```json
{
    "body": "In fact, the breaking of the path isn't something restricted to Sage, it existed with pip too, where pip was not able to define the paths correctly for the packages to go in",
    "created_at": "2020-03-21T20:19:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410652",
    "user": "https://github.com/Shlokatadistance"
}
```

In fact, the breaking of the path isn't something restricted to Sage, it existed with pip too, where pip was not able to define the paths correctly for the packages to go in



---

archive/issue_comments_410653.json:
```json
{
    "body": "Replying to [comment:1 embray]:\n> Who's doing something with pyenv?\n\nI do. Because I tried installing a standalone cygdb on Arch Linux for 3 days and only succeeded when I used pyenv, because I wanted two different python versions on my machine: A normal one and one compiled with --with-pydebug. Achieving this without pyenv is very hard (on Arch Linux).\n> \n> I don't think we need to provide work-arounds for every conceivable user environment misconfiguration.\n\nIf it is too hard or not possible to make sagemath work with pyenv that is ok. But there should be  a good error message, because no one looks at the message:\n\n```\nImportError: /home/volker/.pyenv/versions/3.8.1-debug/lib/python3.8/lib-dynload/math.cpython-38d-x86_64-linux-gnu.so: undefined symbol: PyFloat_Type\n/tmp/tmppfahgne0:19: Error in sourced command file:\nError while executing Python code.\n/home/volker/Sync/git/sage/src/bin/sage-gdb-commands:1: Error in sourced command file:\n```\nAnd thinks: \"Ok, it looks like I need to uninstall pyenv.\" An error message similar to this:\n\"It looks like you installed pyenv. Sagemath is incompatible with pyenv. Please uninstall pyenv.\"\ncan save someone hours of work. If mkoeppe hadn't added me to the Cc, I would be going through the source code of sagemath right now to find the error. That would have costed me multiple days.\n\nIn General, I think it is really important that misconfigurations result in nice error messages.\n\nNote: My issue can be found here: #29461",
    "created_at": "2020-04-04T17:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410653",
    "user": "https://github.com/Volker-Weissmann"
}
```

Replying to [comment:1 embray]:
> Who's doing something with pyenv?

I do. Because I tried installing a standalone cygdb on Arch Linux for 3 days and only succeeded when I used pyenv, because I wanted two different python versions on my machine: A normal one and one compiled with --with-pydebug. Achieving this without pyenv is very hard (on Arch Linux).
> 
> I don't think we need to provide work-arounds for every conceivable user environment misconfiguration.

If it is too hard or not possible to make sagemath work with pyenv that is ok. But there should be  a good error message, because no one looks at the message:

```
ImportError: /home/volker/.pyenv/versions/3.8.1-debug/lib/python3.8/lib-dynload/math.cpython-38d-x86_64-linux-gnu.so: undefined symbol: PyFloat_Type
/tmp/tmppfahgne0:19: Error in sourced command file:
Error while executing Python code.
/home/volker/Sync/git/sage/src/bin/sage-gdb-commands:1: Error in sourced command file:
```
And thinks: "Ok, it looks like I need to uninstall pyenv." An error message similar to this:
"It looks like you installed pyenv. Sagemath is incompatible with pyenv. Please uninstall pyenv."
can save someone hours of work. If mkoeppe hadn't added me to the Cc, I would be going through the source code of sagemath right now to find the error. That would have costed me multiple days.

In General, I think it is really important that misconfigurations result in nice error messages.

Note: My issue can be found here: #29461



---

archive/issue_events_074492.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T06:20:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29048#event-74492"
}
```



---

archive/issue_events_074493.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29048#event-74493"
}
```



---

archive/issue_events_074494.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29048#event-74494"
}
```



---

archive/issue_comments_410654.json:
```json
{
    "body": "I'm checking this with the up to date pyenv, and it seems that the issue with the PATH is no longer. Currently building latest beta with python 3.9-dev from pyenv on Debian stable, will report the results.",
    "created_at": "2021-01-06T12:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410654",
    "user": "https://github.com/dimpase"
}
```

I'm checking this with the up to date pyenv, and it seems that the issue with the PATH is no longer. Currently building latest beta with python 3.9-dev from pyenv on Debian stable, will report the results.



---

archive/issue_comments_410655.json:
```json
{
    "body": "I was able to successfully install Sage using python 3.9 from pyenv (installed following\nhttps://github.com/pyenv/pyenv#basic-github-checkout) on Debian 10.\n\nPerhaps one should check this on Homebrew, but it seems it's OK.",
    "created_at": "2021-01-06T22:23:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410655",
    "user": "https://github.com/dimpase"
}
```

I was able to successfully install Sage using python 3.9 from pyenv (installed following
https://github.com/pyenv/pyenv#basic-github-checkout) on Debian 10.

Perhaps one should check this on Homebrew, but it seems it's OK.



---

archive/issue_events_074495.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-01-06T22:23:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29048#event-74495"
}
```



---

archive/issue_events_074496.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-01-06T22:23:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29048#event-74496"
}
```



---

archive/issue_comments_410656.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-01-06T22:23:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410656",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_410657.json:
```json
{
    "body": "Can be fixed as worksforme, that is.",
    "created_at": "2021-01-06T22:27:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410657",
    "user": "https://github.com/dimpase"
}
```

Can be fixed as worksforme, that is.



---

archive/issue_comments_410658.json:
```json
{
    "body": "Let us close this if nobody objects.",
    "created_at": "2021-08-19T22:36:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410658",
    "user": "https://github.com/slel"
}
```

Let us close this if nobody objects.



---

archive/issue_comments_410659.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-08-19T22:36:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410659",
    "user": "https://github.com/slel"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_410660.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2021-08-26T02:08:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410660",
    "user": "https://github.com/mkoeppe"
}
```

Resolution: invalid



---

archive/issue_events_074497.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-26T02:08:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29048#event-74497"
}
```



---

archive/issue_comments_410661.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2021-10-24T17:28:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410661",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from closed to new.



---

archive/issue_events_074498.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-24T17:28:54Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29048#event-74498"
}
```



---

archive/issue_comments_410662.json:
```json
{
    "body": "Resolution changed from invalid to ",
    "created_at": "2021-10-24T17:28:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410662",
    "user": "https://github.com/mkoeppe"
}
```

Resolution changed from invalid to 



---

archive/issue_comments_410663.json:
```json
{
    "body": "New issues with pyenv reported in #32749.",
    "created_at": "2021-10-24T17:28:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410663",
    "user": "https://github.com/mkoeppe"
}
```

New issues with pyenv reported in #32749.



---

archive/issue_events_074499.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-24T17:28:54Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29048#event-74499"
}
```



---

archive/issue_events_074500.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-24T17:28:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29048#event-74500"
}
```



---

archive/issue_events_074501.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:11:26Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29048#event-74501"
}
```



---

archive/issue_events_074502.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:11:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29048#event-74502"
}
```



---

archive/issue_comments_410664.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2022-01-01T23:50:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410664",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from major to critical.



---

archive/issue_events_074503.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-01T23:50:46Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29048#event-74503"
}
```



---

archive/issue_events_074504.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-01T23:50:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29048#event-74504"
}
```



---

archive/issue_comments_410665.json:
```json
{
    "body": "Test on macOS with `pyenv` from homebrew:\n\n```\n$ brew install pyenv\n$ pyenv install 3.7.8\n$ eval \"$(pyenv init --path)\"\n$ echo $PATH\n/Users/mkoeppe/.pyenv/shims:/Users/mkoeppe/miniconda3/condabin:/Users/mkoeppe/bin:/usr/local/bin:/Users/mkoeppe/google-cloud-sdk/bin:/Users/mkoeppe/perl5/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Library/TeX/texbin:/opt/X11/bin\n$ pyenv global 3.7.8\n$ ./configure --enable-download-from-upstream-url --with-python=python3\n```\n(`--with-python=python3` is needed here because otherwise we reject it as misconfigured - see #32531#comment:3)\n\npip's self-installation gets tricked into installing in the wrong place:\n\n```\n[pip-21.3.1] Using pip 21.3.1 from /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/var/lib/sage/venv-python3.7/var/tmp/sage/build/pip-21.3.1/src/src/pip (python 3.7)\n[pip-21.3.1] Looking in links: /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/var/lib/sage/venv-python3.7/var/lib/sage/wheels\n[pip-21.3.1] Processing /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/var/lib/sage/venv-python3.7/var/tmp/sage/build/pip-21.3.1/inst/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/var/lib/sage/venv-python3.7/var/lib/sage/wheels/pip-21.3.1-py3-none-any.whl\n[pip-21.3.1] Installing collected packages: pip\n[pip-21.3.1]   changing mode of /Users/mkoeppe/.pyenv/versions/3.7.8/bin/pip to 755\n[pip-21.3.1]   changing mode of /Users/mkoeppe/.pyenv/versions/3.7.8/bin/pip3 to 755\n[pip-21.3.1]   changing mode of /Users/mkoeppe/.pyenv/versions/3.7.8/bin/pip3.7 to 755\n[pip-21.3.1] Successfully installed pip-21.3.1\n[pip-21.3.1] \n```",
    "created_at": "2022-01-02T01:00:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410665",
    "user": "https://github.com/mkoeppe"
}
```

Test on macOS with `pyenv` from homebrew:

```
$ brew install pyenv
$ pyenv install 3.7.8
$ eval "$(pyenv init --path)"
$ echo $PATH
/Users/mkoeppe/.pyenv/shims:/Users/mkoeppe/miniconda3/condabin:/Users/mkoeppe/bin:/usr/local/bin:/Users/mkoeppe/google-cloud-sdk/bin:/Users/mkoeppe/perl5/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Library/TeX/texbin:/opt/X11/bin
$ pyenv global 3.7.8
$ ./configure --enable-download-from-upstream-url --with-python=python3
```
(`--with-python=python3` is needed here because otherwise we reject it as misconfigured - see #32531#comment:3)

pip's self-installation gets tricked into installing in the wrong place:

```
[pip-21.3.1] Using pip 21.3.1 from /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/var/lib/sage/venv-python3.7/var/tmp/sage/build/pip-21.3.1/src/src/pip (python 3.7)
[pip-21.3.1] Looking in links: /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/var/lib/sage/venv-python3.7/var/lib/sage/wheels
[pip-21.3.1] Processing /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/var/lib/sage/venv-python3.7/var/tmp/sage/build/pip-21.3.1/inst/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/var/lib/sage/venv-python3.7/var/lib/sage/wheels/pip-21.3.1-py3-none-any.whl
[pip-21.3.1] Installing collected packages: pip
[pip-21.3.1]   changing mode of /Users/mkoeppe/.pyenv/versions/3.7.8/bin/pip to 755
[pip-21.3.1]   changing mode of /Users/mkoeppe/.pyenv/versions/3.7.8/bin/pip3 to 755
[pip-21.3.1]   changing mode of /Users/mkoeppe/.pyenv/versions/3.7.8/bin/pip3.7 to 755
[pip-21.3.1] Successfully installed pip-21.3.1
[pip-21.3.1] 
```



---

archive/issue_comments_410666.json:
```json
{
    "body": "`sage-pip-install -> sage-flock -> sage-bootstrap-python -> $HOME/.pyenv/shims -> $HOME/.pyenv/versions/3.7.8/bin/python3`; the `python3` shim manipulates PATH. \n\n```\n(sage-buildsh) mkoeppe@egret:pip-21.3.1$ python3 -c 'import os; print(os.environ[\"PATH\"])'\n/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/bin:/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/libexec/ccache:/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/build/bin:/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/var/lib/sage/venv-python3.7/bin:/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/bin:/Users/mkoeppe/.pyenv/shims:/Users/mkoeppe/miniconda3/condabin:/Users/mkoeppe/bin:/usr/local/bin:/Users/mkoeppe/google-cloud-sdk/bin:/Users/mkoeppe/perl5/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Library/TeX/texbin:/opt/X11/bin\n(sage-buildsh) mkoeppe@egret:pip-21.3.1$ sage-bootstrap-python -c 'import os; print(os.environ[\"PATH\"])'\n/Users/mkoeppe/.pyenv/versions/3.7.8/bin:/usr/local/Cellar/pyenv/2.2.3/libexec:/usr/local/Cellar/pyenv/2.2.3/plugins/python-build/bin:/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/bin:/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/libexec/ccache:/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/build/bin:/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/var/lib/sage/venv-python3.7/bin:/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/bin:/Users/mkoeppe/.pyenv/shims:/Users/mkoeppe/miniconda3/condabin:/Users/mkoeppe/bin:/usr/local/bin:/Users/mkoeppe/google-cloud-sdk/bin:/Users/mkoeppe/perl5/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Library/TeX/texbin:/opt/X11/bin\n```",
    "created_at": "2022-01-02T01:38:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410666",
    "user": "https://github.com/mkoeppe"
}
```

`sage-pip-install -> sage-flock -> sage-bootstrap-python -> $HOME/.pyenv/shims -> $HOME/.pyenv/versions/3.7.8/bin/python3`; the `python3` shim manipulates PATH. 

```
(sage-buildsh) mkoeppe@egret:pip-21.3.1$ python3 -c 'import os; print(os.environ["PATH"])'
/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/bin:/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/libexec/ccache:/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/build/bin:/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/var/lib/sage/venv-python3.7/bin:/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/bin:/Users/mkoeppe/.pyenv/shims:/Users/mkoeppe/miniconda3/condabin:/Users/mkoeppe/bin:/usr/local/bin:/Users/mkoeppe/google-cloud-sdk/bin:/Users/mkoeppe/perl5/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Library/TeX/texbin:/opt/X11/bin
(sage-buildsh) mkoeppe@egret:pip-21.3.1$ sage-bootstrap-python -c 'import os; print(os.environ["PATH"])'
/Users/mkoeppe/.pyenv/versions/3.7.8/bin:/usr/local/Cellar/pyenv/2.2.3/libexec:/usr/local/Cellar/pyenv/2.2.3/plugins/python-build/bin:/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/bin:/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/libexec/ccache:/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/build/bin:/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/var/lib/sage/venv-python3.7/bin:/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/bin:/Users/mkoeppe/.pyenv/shims:/Users/mkoeppe/miniconda3/condabin:/Users/mkoeppe/bin:/usr/local/bin:/Users/mkoeppe/google-cloud-sdk/bin:/Users/mkoeppe/perl5/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Library/TeX/texbin:/opt/X11/bin
```



---

archive/issue_comments_410667.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-01-02T01:59:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410667",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_410668.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-01-02T01:59:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410668",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_comments_410669.json:
```json
{
    "body": "Let's get this into 9.5 please",
    "created_at": "2022-01-02T18:38:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410669",
    "user": "https://github.com/mkoeppe"
}
```

Let's get this into 9.5 please



---

archive/issue_comments_410670.json:
```json
{
    "body": "Works for me on OS X with homebrew's pyenv: without this branch, sage-bootstrap runs the \"wrong\" python3, while with this branch, it runs the right python3.",
    "created_at": "2022-01-04T00:24:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410670",
    "user": "https://github.com/jhpalmieri"
}
```

Works for me on OS X with homebrew's pyenv: without this branch, sage-bootstrap runs the "wrong" python3, while with this branch, it runs the right python3.



---

archive/issue_comments_410671.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-01-04T00:24:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410671",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_410672.json:
```json
{
    "body": "Thank you!",
    "created_at": "2022-01-04T00:52:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410672",
    "user": "https://github.com/mkoeppe"
}
```

Thank you!



---

archive/issue_comments_410673.json:
```json
{
    "body": "Changing priority from critical to blocker.",
    "created_at": "2022-01-17T21:12:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410673",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from critical to blocker.



---

archive/issue_comments_410674.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-01-18T22:01:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29048#issuecomment-410674",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_074505.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-01-18T22:01:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29048",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29048#event-74505"
}
```
