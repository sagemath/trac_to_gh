# Issue 25622: Package uninstallation should happen before upgrading packages

Issue created by migration from https://trac.sagemath.org/ticket/25859

Original creator: embray

Original creation time: 2018-07-13 15:34:24

I thought I did make this change in an earlier ticket, but maybe that ticket hasn't been merged yet, and now I can't find reference to it.

For "old-style" package installations that don't have a file manifest, it doesn't make sense to run `sage-spkg-uninstall` _after_ running its `spkg-install`, since that can have the effect of _removing_ files from `$SAGE_LOCAL` that were just installed.

It also makes sense to uninstall first even for "new-style" packages, since some packages don't build correctly unless the previous version of that package is removed first (e.g. Python).  See the commit message for more details.


---

Comment by embray created at 2018-07-13 15:40:08

Changing status from new to needs_review.


---

Comment by embray created at 2018-07-13 15:40:08

Confirmed that this fixes the issue reported in #25856, and likely similar issues.


---

Comment by vbraun created at 2018-07-13 18:29:20

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-07-14 19:23:51

Resolution: fixed
