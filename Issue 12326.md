# Issue 12326: Return Integer from GeneralDiscreteDistribution

archive/issues_012326.json:
```json
{
    "body": "Assignee: amhou\n\nKeywords: GeneralDiscreteDistribution import\n\n1. The output of GeneralDiscreteDistribution is not a Sage number per se and hence has no `parent` attribute.\n\n2. The import of sage.rings.real_double seems unnecessary in the file `devel/sage/sage/gsl/probability_distribution.pyx` since all the calls to RDF are made explicitly as `sage.rings.real_double.RDF` in the entire file.\n\nAttaching a patch to fix both the above issues. The patch passes all doctests in `devel/sage/sage/gsl`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/12498\n\n",
    "created_at": "2012-02-11T16:49:09Z",
    "labels": [
        "component: statistics",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.10",
    "title": "Return Integer from GeneralDiscreteDistribution",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12326",
    "user": "https://github.com/ppurka"
}
```
Assignee: amhou

Keywords: GeneralDiscreteDistribution import

1. The output of GeneralDiscreteDistribution is not a Sage number per se and hence has no `parent` attribute.

2. The import of sage.rings.real_double seems unnecessary in the file `devel/sage/sage/gsl/probability_distribution.pyx` since all the calls to RDF are made explicitly as `sage.rings.real_double.RDF` in the entire file.

Attaching a patch to fix both the above issues. The patch passes all doctests in `devel/sage/sage/gsl`.

Issue created by migration from https://trac.sagemath.org/ticket/12498





---

archive/issue_comments_144897.json:
```json
{
    "body": "All tests pass except for cmdline.py. I checked this test on an unmodified sage-4.8 and it fails exactly similarly on the unmodified sage. The directory `sage-4.8.good` is the unmodified sage below, while the directory `sage-4.8` contains these modifications along with #11080\n\n```\n...stallations/sage-4.8.good> ./sage -t  --long -force_lib devel/sage/sage/tests/cmdline.py\nsage -t --long -force_lib \"devel/sage/sage/tests/cmdline.py\"\n**********************************************************************\nFile \"/home/punarbasu/Installations/sage-4.8.good/devel/sage/sage/tests/cmdline.py\", line 95:\n    sage: out.find(version()) >= 0\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"/home/punarbasu/Installations/sage-4.8.good/devel/sage/sage/tests/cmdline.py\", line 103:\n    sage: out.find(version()) >= 0\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"/home/punarbasu/Installations/sage-4.8.good/devel/sage/sage/tests/cmdline.py\", line 175:\n    sage: out.find(version()) >= 0\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n1 items had failures:\n   3 of 160 in __main__.example_1\n***Test Failed*** 3 failures.\nFor whitespace errors, see the file /home/punarbasu/.sage//tmp/cmdline_21847.py\n\t [67.8 s]\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n\tsage -t --long -force_lib \"devel/sage/sage/tests/cmdline.py\"\nTotal time for all tests: 68.0 seconds\n...ions/sage-4.8.good [128] > ../sage-4.8\n~/Installations/sage-4.8> \n~/Installations/sage-4.8> ./sage -t  --long -force_lib devel/sage/sage/tests/cmdline.py\nsage -t --long -force_lib \"devel/sage/sage/tests/cmdline.py\"\n**********************************************************************\nFile \"/home/punarbasu/Installations/sage-4.8/devel/sage/sage/tests/cmdline.py\", line 95:\n    sage: out.find(version()) >= 0\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"/home/punarbasu/Installations/sage-4.8/devel/sage/sage/tests/cmdline.py\", line 103:\n    sage: out.find(version()) >= 0\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"/home/punarbasu/Installations/sage-4.8/devel/sage/sage/tests/cmdline.py\", line 175:\n    sage: out.find(version()) >= 0\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n1 items had failures:\n   3 of 160 in __main__.example_1\n***Test Failed*** 3 failures.\nFor whitespace errors, see the file /home/punarbasu/.sage//tmp/cmdline_22200.py\n\t [18.9 s]\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n\tsage -t --long -force_lib \"devel/sage/sage/tests/cmdline.py\"\nTotal time for all tests: 18.9 seconds\n```\n",
    "created_at": "2012-02-12T00:27:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12326#issuecomment-144897",
    "user": "https://github.com/ppurka"
}
```

All tests pass except for cmdline.py. I checked this test on an unmodified sage-4.8 and it fails exactly similarly on the unmodified sage. The directory `sage-4.8.good` is the unmodified sage below, while the directory `sage-4.8` contains these modifications along with #11080

```
...stallations/sage-4.8.good> ./sage -t  --long -force_lib devel/sage/sage/tests/cmdline.py
sage -t --long -force_lib "devel/sage/sage/tests/cmdline.py"
**********************************************************************
File "/home/punarbasu/Installations/sage-4.8.good/devel/sage/sage/tests/cmdline.py", line 95:
    sage: out.find(version()) >= 0
Expected:
    True
Got:
    False
**********************************************************************
File "/home/punarbasu/Installations/sage-4.8.good/devel/sage/sage/tests/cmdline.py", line 103:
    sage: out.find(version()) >= 0
Expected:
    True
Got:
    False
**********************************************************************
File "/home/punarbasu/Installations/sage-4.8.good/devel/sage/sage/tests/cmdline.py", line 175:
    sage: out.find(version()) >= 0
Expected:
    True
Got:
    False
**********************************************************************
1 items had failures:
   3 of 160 in __main__.example_1
***Test Failed*** 3 failures.
For whitespace errors, see the file /home/punarbasu/.sage//tmp/cmdline_21847.py
	 [67.8 s]
 
----------------------------------------------------------------------
The following tests failed:


	sage -t --long -force_lib "devel/sage/sage/tests/cmdline.py"
Total time for all tests: 68.0 seconds
...ions/sage-4.8.good [128] > ../sage-4.8
~/Installations/sage-4.8> 
~/Installations/sage-4.8> ./sage -t  --long -force_lib devel/sage/sage/tests/cmdline.py
sage -t --long -force_lib "devel/sage/sage/tests/cmdline.py"
**********************************************************************
File "/home/punarbasu/Installations/sage-4.8/devel/sage/sage/tests/cmdline.py", line 95:
    sage: out.find(version()) >= 0
Expected:
    True
Got:
    False
**********************************************************************
File "/home/punarbasu/Installations/sage-4.8/devel/sage/sage/tests/cmdline.py", line 103:
    sage: out.find(version()) >= 0
Expected:
    True
Got:
    False
**********************************************************************
File "/home/punarbasu/Installations/sage-4.8/devel/sage/sage/tests/cmdline.py", line 175:
    sage: out.find(version()) >= 0
Expected:
    True
Got:
    False
**********************************************************************
1 items had failures:
   3 of 160 in __main__.example_1
***Test Failed*** 3 failures.
For whitespace errors, see the file /home/punarbasu/.sage//tmp/cmdline_22200.py
	 [18.9 s]
 
----------------------------------------------------------------------
The following tests failed:


	sage -t --long -force_lib "devel/sage/sage/tests/cmdline.py"
Total time for all tests: 18.9 seconds
```




---

archive/issue_comments_144898.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-02-12T00:27:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12326#issuecomment-144898",
    "user": "https://github.com/ppurka"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_144899.json:
```json
{
    "body": "This doctest failure might be related to #12420.",
    "created_at": "2012-02-12T00:33:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12326#issuecomment-144899",
    "user": "https://github.com/ppurka"
}
```

This doctest failure might be related to #12420.



---

archive/issue_comments_144900.json:
```json
{
    "body": "Haven't tried to break this, but I don't see how having it being an Integer as opposed to int would lead to anything *breaking*.  Does `gsl_ran_discrete` always return ints?\n\nThe patch *does* need a better commit message.",
    "created_at": "2012-02-12T03:29:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12326#issuecomment-144900",
    "user": "https://github.com/kcrisman"
}
```

Haven't tried to break this, but I don't see how having it being an Integer as opposed to int would lead to anything *breaking*.  Does `gsl_ran_discrete` always return ints?

The patch *does* need a better commit message.



---

archive/issue_comments_144901.json:
```json
{
    "body": "Replying to [comment:4 kcrisman]:\n> Haven't tried to break this, but I don't see how having it being an Integer as opposed to int would lead to anything *breaking*.  Does `gsl_ran_discrete` always return ints?\n> \n\nYes. I believe `gsl_ran_discrete` always return ints. I ran into a problem with this because in one of my programs I was expecting that since I am always calling Sage commands, I will always get objects which are Sage objects and not python objects. At one point I was testing for the `parent()` of the number and it failed because `get_random_element()` was returning ints.\n\nAdditionally, I think it should be Integer also for consistency. For example the other probability distributions return RDF instead of floats.\n\n> The patch *does* need a better commit message.\n\nIt didn't have a commit message! Apparently, I forgot to put one. Updated the patch now.",
    "created_at": "2012-02-12T10:43:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12326#issuecomment-144901",
    "user": "https://github.com/ppurka"
}
```

Replying to [comment:4 kcrisman]:
> Haven't tried to break this, but I don't see how having it being an Integer as opposed to int would lead to anything *breaking*.  Does `gsl_ran_discrete` always return ints?
> 

Yes. I believe `gsl_ran_discrete` always return ints. I ran into a problem with this because in one of my programs I was expecting that since I am always calling Sage commands, I will always get objects which are Sage objects and not python objects. At one point I was testing for the `parent()` of the number and it failed because `get_random_element()` was returning ints.

Additionally, I think it should be Integer also for consistency. For example the other probability distributions return RDF instead of floats.

> The patch *does* need a better commit message.

It didn't have a commit message! Apparently, I forgot to put one. Updated the patch now.



---

archive/issue_comments_144902.json:
```json
{
    "body": "This doesn't apply to the current beta, presumably due to a conflict with #9770 (merged in 5.0.beta9).",
    "created_at": "2012-03-25T15:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12326#issuecomment-144902",
    "user": "https://github.com/loefflerd"
}
```

This doesn't apply to the current beta, presumably due to a conflict with #9770 (merged in 5.0.beta9).



---

archive/issue_comments_144903.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-03-25T15:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12326#issuecomment-144903",
    "user": "https://github.com/loefflerd"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_144904.json:
```json
{
    "body": "Rebased to sage-5.0beta10.",
    "created_at": "2012-03-26T09:35:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12326#issuecomment-144904",
    "user": "https://github.com/ppurka"
}
```

Rebased to sage-5.0beta10.



---

archive/issue_comments_144905.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-03-26T09:35:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12326#issuecomment-144905",
    "user": "https://github.com/ppurka"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_144906.json:
```json
{
    "body": "Works for me against 5.1.beta0.  Commit message seems a little unusual (maybe a bit long)?",
    "created_at": "2012-05-25T18:57:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12326#issuecomment-144906",
    "user": "https://trac.sagemath.org/admin/accounts/users/dsm"
}
```

Works for me against 5.1.beta0.  Commit message seems a little unusual (maybe a bit long)?



---

archive/issue_comments_144907.json:
```json
{
    "body": "Replying to [comment:8 dsm]:\n> Works for me against 5.1.beta0.  Commit message seems a little unusual (maybe a bit long)?  \nIs that good or bad? :)",
    "created_at": "2012-05-25T19:07:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12326#issuecomment-144907",
    "user": "https://github.com/ppurka"
}
```

Replying to [comment:8 dsm]:
> Works for me against 5.1.beta0.  Commit message seems a little unusual (maybe a bit long)?  
Is that good or bad? :)



---

archive/issue_comments_144908.json:
```json
{
    "body": "Please fill in your real name as Author.",
    "created_at": "2012-07-27T20:41:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12326#issuecomment-144908",
    "user": "https://github.com/jdemeyer"
}
```

Please fill in your real name as Author.



---

archive/issue_comments_144909.json:
```json
{
    "body": "You should add (in the doc) a test to check that the output is indeed in ZZ",
    "created_at": "2013-04-03T19:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12326#issuecomment-144909",
    "user": "https://github.com/fchapoton"
}
```

You should add (in the doc) a test to check that the output is indeed in ZZ



---

archive/issue_comments_144910.json:
```json
{
    "body": "Attachment [trac_12498-return-Integer-from-GeneralDiscreteDistribution.2.patch](tarball://root/attachments/some-uuid/ticket12498/trac_12498-return-Integer-from-GeneralDiscreteDistribution.2.patch) by @ppurka created at 2013-04-09 11:17:42\n\nRebased patch to sage-5.0beta10",
    "created_at": "2013-04-09T11:17:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12326#issuecomment-144910",
    "user": "https://github.com/ppurka"
}
```

Attachment [trac_12498-return-Integer-from-GeneralDiscreteDistribution.2.patch](tarball://root/attachments/some-uuid/ticket12498/trac_12498-return-Integer-from-GeneralDiscreteDistribution.2.patch) by @ppurka created at 2013-04-09 11:17:42

Rebased patch to sage-5.0beta10



---

archive/issue_comments_144911.json:
```json
{
    "body": "Updated the patch with an example to check that the output is in `ZZ`.\n\nPatchbot apply trac_12498-return-Integer-from-GeneralDiscreteDistribution.2.patch",
    "created_at": "2013-04-09T11:18:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12326#issuecomment-144911",
    "user": "https://github.com/ppurka"
}
```

Updated the patch with an example to check that the output is in `ZZ`.

Patchbot apply trac_12498-return-Integer-from-GeneralDiscreteDistribution.2.patch



---

archive/issue_comments_144912.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-04-27T06:46:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12326#issuecomment-144912",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_144913.json:
```json
{
    "body": "ok, looks good.",
    "created_at": "2013-04-27T06:46:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12326#issuecomment-144913",
    "user": "https://github.com/fchapoton"
}
```

ok, looks good.



---

archive/issue_comments_144914.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-04-30T09:38:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12326#issuecomment-144914",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_033658.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-30T09:38:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/12326",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12326#event-33658"
}
```
