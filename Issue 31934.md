# Issue 31934: Matrix: Add generic SVD method using sympy

Issue created by migration from https://trac.sagemath.org/ticket/32171

Original creator: mkoeppe

Original creation time: 2021-07-09 22:09:02

CC:  @honglizhaobob

(from #31992)

#31942 added `_sympy_` methods for matrices and vectors.

Based on this, we can now implement various matrix methods using Sympy.

In this ticket, we add SVD (singular value decomposition) https://docs.sympy.org/latest/modules/matrices/matrices.html

This provides exact and symbolic SVD. Sage currently only has one implementation, for RDF, using `scipy.linalg`.


---

Comment by mkoeppe created at 2021-07-09 22:49:29

This would go into `src/sage/matrix/matrix2.pyx`


---

Comment by @mwageringel created at 2021-07-18 14:36:30

I think the documentation should make very clear that in 99% of the cases, it is better to use scipy and work over `RDF`/`CDF` if one expects a numerical result, rather than using sympy with `RR`. The sympy implementation gets very slow for larger matrices.

Also, even though sympy seems to support singular value decompositions up to precision 83 (or at least does not raise an error), the result is not really much more accurate compared to `RDF`. In fact, the result has 53-bit precision as well.


```
sage: a = matrix.random(RealField(83), 10)
sage: b = a._sympy_().as_mutable()
sage: U,S,V = b.singular_value_decomposition()
sage: u,s,v = a.change_ring(RDF).SVD()
sage: (U * S * V.H - b).norm('fro'), (u * s * v.H - a).norm('frob')
(1.73609121130844744221236e-15, 5.9963160390748384e-15)
sage: S[0,0]._prec
53
```

----
New commits:


---

Comment by mkoeppe created at 2021-07-18 17:31:10

That's a great point, thanks for looking into this. The main use case for using sympy here should be symbolic SVD.
