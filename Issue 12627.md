# Issue 12627: Fix PolyBoRi's dependencies in `module_list.py`

Issue created by migration from https://trac.sagemath.org/ticket/12799

Original creator: AlexanderDreyer

Original creation time: 2012-04-03 14:14:41

Assignee: AlexanderDreyer

CC:  leif

Actually only the pbori module needs to get rebuilt; while touching $SAGE_LOCAL/include/polybori.h doesn't help, touching $SAGE_LOCAL/include/polybori/* does (afterwards running ./sage -b).
The better alternative is to fix the dependency list in `module_list.py`

### Current patch
 * *Patch*


---

Attachment

Patch for the sage library (devel/sage)


---

Comment by AlexanderDreyer created at 2012-04-03 14:16:34

Changing status from new to needs_review.


---

Comment by leif created at 2012-04-03 20:40:44

As mentioned on #12655, I'd rather make the extension module depend on just `$SAGE_INC/polybori.h` and/or its libraries, `$SAGE_LOCAL/lib/{polybori,polybori_groebner}.so`, and `touch` the former from `spkg-install` at least in case you don't add the libraries.

AFAIK Cython is smart enough to notice when (at least _directly_) included headers are newer, but this doesn't help if their timestamps are preserved during PolyBoRi's installation.

Adding _all of_ PolyBoRi's headers _explicitly_ seems a bit overkill to me.

[Also note that we have both `$SAGE_INC/polybori.h` and `$SAGE_INC/polybori/polybori.h`, which are not the same files.]


---

Comment by AlexanderDreyer created at 2012-04-03 20:52:38

Replying to [comment:2 leif]:
> As mentioned on #12655, I'd rather make the extension module depend on just `$SAGE_INC/polybori.h` and/or its libraries, `$SAGE_LOCAL/lib/{polybori,polybori_groebner}.so`, and `touch` the former from `spkg-install` at least in case you don't add the libraries.
The timestamp of `include/polybori/config.h` also varies, this would also help here.

> AFAIK Cython is smart enough to notice when (at least _directly_) included headers are newer, but this doesn't help if their timestamps are preserved during PolyBoRi's installation.
> 
> Adding _all of_ PolyBoRi's headers _explicitly_ seems a bit overkill to me.
> 
> [Also note that we have both `$SAGE_INC/polybori.h` and `$SAGE_INC/polybori/polybori.h`, which are not the same files.]
The first header is just for convenience.


---

Comment by leif created at 2012-04-03 20:58:38

Replying to [comment:3 AlexanderDreyer]:
> The timestamp of `include/polybori/config.h` also varies, this would also help here.

Then I'd add just that... (cross-posting)


---

Comment by AlexanderDreyer created at 2012-04-03 21:13:35

Replying to [comment:4 leif]:
> Replying to [comment:3 AlexanderDreyer]:
> > The timestamp of `include/polybori/config.h` also varies, this would also help here.
> 
> Then I'd add just that... (cross-posting)
Ok, let's try this one:
[attachment:polybori_depends.2.patch]


---

Attachment

Patch for the sage library (devel/sage)


---

Comment by leif created at 2012-04-03 21:57:57

Replying to [comment:5 AlexanderDreyer]:
> Ok, let's try this one:
> [attachment:polybori_depends.2.patch]

Looks better.


---

Comment by leif created at 2012-04-03 22:46:05

Changing status from needs_review to positive_review.


---

Comment by leif created at 2012-04-03 22:46:05

Changing component from algebra to build.


---

Comment by leif created at 2012-04-03 22:46:05

Applies to Sage 5.0.beta11 with three lines offset, but I don't mind.


---

Attachment

patch rebased to sage-5.0 beta11


---

Comment by AlexanderDreyer created at 2012-04-04 07:44:03

Replying to [comment:8 leif]:
> Applies to Sage 5.0.beta11 with three lines offset, but I don't mind.
Thanks! I rebased the patch accordingly.


---

Comment by jdemeyer created at 2012-04-04 08:52:59

Replying to [comment:8 leif]:
> Applies to Sage 5.0.beta11 with three lines offset, but I don't mind.

I consider an offset in a patch to be totally harmless; fuzz 1 should be rebased but I can usually live with; fuzz 2 must be rebased.


---

Comment by leif created at 2012-04-04 19:30:37

Replying to [comment:10 jdemeyer]:
> Replying to [comment:8 leif]:
> > Applies to Sage 5.0.beta11 with three lines offset, but I don't mind.
> 
> I consider an offset in a patch to be totally harmless; fuzz 1 should be rebased but I can usually live with; fuzz 2 must be rebased.

Yes, I should perhaps have said that... ;-)


---

Comment by jdemeyer created at 2012-04-07 15:09:47

Resolution: fixed
