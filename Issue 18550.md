# Issue 18550: Bug with matrice products over Symbolic Ring with modular integers

archive/issues_018550.json:
```json
{
    "body": "CC:  @kcrisman @slel\n\nAs reported on [this ask question](http://ask.sagemath.org/question/27196/multiplying-matrices-with-different-parents/)\n\n\n```\nsage: sage: var('A,B,C,D')\n(A, B, C, D)\nsage: S = matrix(SR,2,[[1+3*A,3*B],[3*C,1+3*D]])\nsage: R = Zmod(9)\nsage: g = matrix(R,2,[[2,1],[2,6]])\nsage: gi = matrix(R,2,[[6,8],[7,2]])\nsage: g*S*gi\n[        6*B + 3*D + 1 3*A + 3*B + 6*C + 6*D]\n[            0*A + 0*D         3*A + 0*D + 1]\n```\n\n\nWhile we have (look at the second line):\n\n\n```\nsage: R.<A,B,C,D> = PolynomialRing(Zmod(9),4)\nsage: g = matrix(R,2,[[2,1],[2,6]])\nsage: gi = matrix(R,2,[[6,8],[7,2]])\nsage: S = matrix(R,2,[[1+3*A,3*B],[3*C,1+3*D]])\nsage: g*S*gi\n[        6*B + 3*D + 1 3*A + 3*B + 6*C + 6*D]\n[                  6*B         3*A + 3*B + 1]\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/18787\n\n",
    "created_at": "2015-06-25T11:07:30Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Bug with matrice products over Symbolic Ring with modular integers",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18550",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```
CC:  @kcrisman @slel

As reported on [this ask question](http://ask.sagemath.org/question/27196/multiplying-matrices-with-different-parents/)


```
sage: sage: var('A,B,C,D')
(A, B, C, D)
sage: S = matrix(SR,2,[[1+3*A,3*B],[3*C,1+3*D]])
sage: R = Zmod(9)
sage: g = matrix(R,2,[[2,1],[2,6]])
sage: gi = matrix(R,2,[[6,8],[7,2]])
sage: g*S*gi
[        6*B + 3*D + 1 3*A + 3*B + 6*C + 6*D]
[            0*A + 0*D         3*A + 0*D + 1]
```


While we have (look at the second line):


```
sage: R.<A,B,C,D> = PolynomialRing(Zmod(9),4)
sage: g = matrix(R,2,[[2,1],[2,6]])
sage: gi = matrix(R,2,[[6,8],[7,2]])
sage: S = matrix(R,2,[[1+3*A,3*B],[3*C,1+3*D]])
sage: g*S*gi
[        6*B + 3*D + 1 3*A + 3*B + 6*C + 6*D]
[                  6*B         3*A + 3*B + 1]
```


Issue created by migration from https://trac.sagemath.org/ticket/18787





---

archive/issue_comments_251997.json:
```json
{
    "body": "Thanks for isolating the problem.",
    "created_at": "2015-06-25T12:23:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-251997",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Thanks for isolating the problem.



---

archive/issue_comments_251998.json:
```json
{
    "body": "Thanks very much to both for reporting and simplifying this.",
    "created_at": "2015-06-25T13:20:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-251998",
    "user": "https://github.com/kcrisman"
}
```

Thanks very much to both for reporting and simplifying this.



---

archive/issue_comments_251999.json:
```json
{
    "body": "A different issue, but it might be related:\n\n```\nsage: F=sum((i+1)*x^i for i in [0..20])\nsage: G=sum(Zmod(7)(i+1)*x^i for i in [0..20])\nsage: F*Zmod(7)(1) - G\nx^19 + 2*x^18 + 0*x^13 + 0*x^6\nsage: G*Zmod(7)(1) - G\n0\n```\n\nso there seems to be something fishy with symbolic multiplication involving integers and elements of Z/n in general. It's not just a zero-divisor problem.\n\nIt's not just powers either:\n\n```\nsage: V=[SR.var(\"x%s\"%i) for i in [0..20]]\nsage: F=sum((i+1)*V[i] for i in [0..20])\nsage: G=sum(Zmod(7)(i+1)*V[i] for i in [0..20])\nsage: sage: F*Zmod(7)(1)-G\n-x0 + 0*x13 + 6*x14 + 0*x20 + 3*x3 + 0*x6\nsage: F-G \n14*x13 + 21*x20 + 7*x6\n```\n\nThe last one is correct, since the terms with x6, x20 and x13 are really missing from G. This illustrates why mixing characteristics in SR is always going to be a mess (even if non-zero characteristic works properly otherwise).",
    "created_at": "2015-06-25T18:53:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-251999",
    "user": "https://github.com/nbruin"
}
```

A different issue, but it might be related:

```
sage: F=sum((i+1)*x^i for i in [0..20])
sage: G=sum(Zmod(7)(i+1)*x^i for i in [0..20])
sage: F*Zmod(7)(1) - G
x^19 + 2*x^18 + 0*x^13 + 0*x^6
sage: G*Zmod(7)(1) - G
0
```

so there seems to be something fishy with symbolic multiplication involving integers and elements of Z/n in general. It's not just a zero-divisor problem.

It's not just powers either:

```
sage: V=[SR.var("x%s"%i) for i in [0..20]]
sage: F=sum((i+1)*V[i] for i in [0..20])
sage: G=sum(Zmod(7)(i+1)*V[i] for i in [0..20])
sage: sage: F*Zmod(7)(1)-G
-x0 + 0*x13 + 6*x14 + 0*x20 + 3*x3 + 0*x6
sage: F-G 
14*x13 + 21*x20 + 7*x6
```

The last one is correct, since the terms with x6, x20 and x13 are really missing from G. This illustrates why mixing characteristics in SR is always going to be a mess (even if non-zero characteristic works properly otherwise).



---

archive/issue_comments_252000.json:
```json
{
    "body": "It seems to be a pynac/ginac issue, right ? So what should we do on our side ? Add a stopgap during conversion/coercion Zmod(n) -> SR ?",
    "created_at": "2015-06-25T20:03:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252000",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

It seems to be a pynac/ginac issue, right ? So what should we do on our side ? Add a stopgap during conversion/coercion Zmod(n) -> SR ?



---

archive/issue_comments_252001.json:
```json
{
    "body": "(Or even just disallow it?)",
    "created_at": "2015-06-25T20:24:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252001",
    "user": "https://github.com/kcrisman"
}
```

(Or even just disallow it?)



---

archive/issue_comments_252002.json:
```json
{
    "body": "This is working in pynac-0.4.1 (but not 0.3.9.1).\n\nEDIT: I meant the original case.",
    "created_at": "2015-06-26T06:30:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252002",
    "user": "https://github.com/rwst"
}
```

This is working in pynac-0.4.1 (but not 0.3.9.1).

EDIT: I meant the original case.



---

archive/issue_comments_252003.json:
```json
{
    "body": "Replying to [comment:6 nbruin]:\n> It's not just powers either:\n> {{{\n> sage: V=[SR.var(\"x%s\"%i) for i in [0..20]]\n> sage: F=sum((i+1)*V[i] for i in [0..20])\n> sage: G=sum(Zmod(7)(i+1)*V[i] for i in [0..20])\n> sage: sage: F*Zmod(7)(1)-G\n> -x0 + 0*x13 + 6*x14 + 0*x20 + 3*x3 + 0*x6\n> sage: F-G \n> 14*x13 + 21*x20 + 7*x6\n> }}}\nThis is different in 0.4.1:\n\n```\nsage: sage: sage: F*Zmod(7)(1)-G\n-x0 + 0*x13 + 0*x20 + 4*x9\nsage: F-G\n14*x13 + 21*x20 + 7*x6\nsage: F\nx0 + 2*x1 + 11*x10 + 12*x11 + 13*x12 + 14*x13 + 15*x14 + 16*x15 + 17*x16 + 18*x17 + 19*x18 + 20*x19 + 3*x2 + 21*x20 + 4*x3 + 5*x4 + 6*x5 + 7*x6 + 8*x7 + 9*x8 + 10*x9\nsage: G\nx0 + 2*x1 + 4*x10 + 5*x11 + 6*x12 + x14 + 2*x15 + 3*x16 + 4*x17 + 5*x18 + 6*x19 + 3*x2 + 4*x3 + 5*x4 + 6*x5 + x7 + 2*x8 + 3*x9\n```\n\nEDIT: Added `F`,`G`.",
    "created_at": "2015-06-26T06:35:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252003",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:6 nbruin]:
> It's not just powers either:
> {{{
> sage: V=[SR.var("x%s"%i) for i in [0..20]]
> sage: F=sum((i+1)*V[i] for i in [0..20])
> sage: G=sum(Zmod(7)(i+1)*V[i] for i in [0..20])
> sage: sage: F*Zmod(7)(1)-G
> -x0 + 0*x13 + 6*x14 + 0*x20 + 3*x3 + 0*x6
> sage: F-G 
> 14*x13 + 21*x20 + 7*x6
> }}}
This is different in 0.4.1:

```
sage: sage: sage: F*Zmod(7)(1)-G
-x0 + 0*x13 + 0*x20 + 4*x9
sage: F-G
14*x13 + 21*x20 + 7*x6
sage: F
x0 + 2*x1 + 11*x10 + 12*x11 + 13*x12 + 14*x13 + 15*x14 + 16*x15 + 17*x16 + 18*x17 + 19*x18 + 20*x19 + 3*x2 + 21*x20 + 4*x3 + 5*x4 + 6*x5 + 7*x6 + 8*x7 + 9*x8 + 10*x9
sage: G
x0 + 2*x1 + 4*x10 + 5*x11 + 6*x12 + x14 + 2*x15 + 3*x16 + 4*x17 + 5*x18 + 6*x19 + 3*x2 + 4*x3 + 5*x4 + 6*x5 + x7 + 2*x8 + 3*x9
```

EDIT: Added `F`,`G`.



---

archive/issue_comments_252004.json:
```json
{
    "body": "Correction: this is not pynac-0.4.1 but pynac master. Narrowing down the reponsible change...",
    "created_at": "2015-06-26T07:01:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252004",
    "user": "https://github.com/rwst"
}
```

Correction: this is not pynac-0.4.1 but pynac master. Narrowing down the reponsible change...



---

archive/issue_comments_252005.json:
```json
{
    "body": "The following patch works for these two examples, just to point at the direction further completion is needed:\n\n```\ndiff --git a/ginac/expairseq.cpp b/ginac/expairseq.cpp\nindex 2abb7b7..acef09b 100644\n--- a/ginac/expairseq.cpp\n+++ b/ginac/expairseq.cpp\n@@ -1207,16 +1207,17 @@ void expairseq::combine_same_terms_sorted_seq()\n \t// must_copy will be set to true the first time some combination is \n \t// possible from then on the sequence has changed and must be compacted\n \tbool must_copy = false;\n+        numeric itin1_c = ex_to<numeric>(itin1->coeff);\n \twhile (itin2!=last) {\n \t\tif (itin1->rest.compare(itin2->rest)==0 &&\n \t\t\t\tunlikely(!is_a<infinity>(itin1->rest))) {\n-\t\t\titin1->coeff = ex_to<numeric>(itin1->coeff).\n+\t\t\titin1->coeff = itin1_c.\n \t\t\t               add_dyn(ex_to<numeric>(itin2->coeff));\n \t\t\tif (expair_needs_further_processing(itin1))\n \t\t\t\tneeds_further_processing = true;\n \t\t\tmust_copy = true;\n \t\t} else {\n-\t\t\tif (!ex_to<numeric>(itin1->coeff).is_zero()) {\n+\t\t\tif (not itin1_c.is_zero() or itin1_c.is_parent_pos_char()) {\n \t\t\t\tif (must_copy)\n \t\t\t\t\t*itout = *itin1;\n \t\t\t\t++itout;\n@@ -1225,7 +1226,7 @@ void expairseq::combine_same_terms_sorted_seq()\n \t\t}\n \t\t++itin2;\n \t}\n-\tif (!ex_to<numeric>(itin1->coeff).is_zero()) {\n+\tif (not itin1_c.is_zero() or itin1_c.is_parent_pos_char()) {\n \t\tif (must_copy)\n \t\t\t*itout = *itin1;\n \t\t++itout;\n```\n\nThe relevant ticket would be https://github.com/pynac/pynac/issues/77.",
    "created_at": "2015-06-26T15:12:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252005",
    "user": "https://github.com/rwst"
}
```

The following patch works for these two examples, just to point at the direction further completion is needed:

```
diff --git a/ginac/expairseq.cpp b/ginac/expairseq.cpp
index 2abb7b7..acef09b 100644
--- a/ginac/expairseq.cpp
+++ b/ginac/expairseq.cpp
@@ -1207,16 +1207,17 @@ void expairseq::combine_same_terms_sorted_seq()
 	// must_copy will be set to true the first time some combination is 
 	// possible from then on the sequence has changed and must be compacted
 	bool must_copy = false;
+        numeric itin1_c = ex_to<numeric>(itin1->coeff);
 	while (itin2!=last) {
 		if (itin1->rest.compare(itin2->rest)==0 &&
 				unlikely(!is_a<infinity>(itin1->rest))) {
-			itin1->coeff = ex_to<numeric>(itin1->coeff).
+			itin1->coeff = itin1_c.
 			               add_dyn(ex_to<numeric>(itin2->coeff));
 			if (expair_needs_further_processing(itin1))
 				needs_further_processing = true;
 			must_copy = true;
 		} else {
-			if (!ex_to<numeric>(itin1->coeff).is_zero()) {
+			if (not itin1_c.is_zero() or itin1_c.is_parent_pos_char()) {
 				if (must_copy)
 					*itout = *itin1;
 				++itout;
@@ -1225,7 +1226,7 @@ void expairseq::combine_same_terms_sorted_seq()
 		}
 		++itin2;
 	}
-	if (!ex_to<numeric>(itin1->coeff).is_zero()) {
+	if (not itin1_c.is_zero() or itin1_c.is_parent_pos_char()) {
 		if (must_copy)
 			*itout = *itin1;
 		++itout;
```

The relevant ticket would be https://github.com/pynac/pynac/issues/77.



---

archive/issue_comments_252006.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-07-16T06:00:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252006",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_252007.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-07-16T06:00:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252007",
    "user": "https://github.com/rwst"
}
```

New commits:



---

archive/issue_comments_252008.json:
```json
{
    "body": "With Sage-6.8.rc0:\n\n```\n**********************************************************************\nFile \"src/sage/symbolic/expression.pyx\", line 2821, in sage.symbolic.expression.Expression._add_\nFailed example:\n    (A + 3*B)*Zmod(9)(6)\nExpected:\n    6*A\nGot:\n    0* + 6*A\n**********************************************************************\nFile \"src/sage/symbolic/expression.pyx\", line 2823, in sage.symbolic.expression.Expression._add_\nFailed example:\n    (3*A + 3*B)*Zmod(9)(6)\nExpected:\n    0\nGot:\n    0*\n**********************************************************************\nFile \"src/sage/symbolic/expression.pyx\", line 2825, in sage.symbolic.expression.Expression._add_\nFailed example:\n    (3*A + 3*B)*Zmod(9)(6)*A\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.symbolic.expression.Expression._add_[24]>\", line 1, in <module>\n        (Integer(3)*A + Integer(3)*B)*Zmod(Integer(9))(Integer(6))*A\n      File \"sage/structure/element.pyx\", line 1849, in sage.structure.element.RingElement.__mul__ (build/cythonized/sage/structure/element.c:16581)\n        return (<RingElement>left)._mul_(<RingElement>right)\n      File \"sage/symbolic/expression.pyx\", line 3148, in sage.symbolic.expression.Expression._mul_ (build/cythonized/sage/symbolic/expression.cpp:19837)\n        x = gmul(left._gobj, _right._gobj)\n    OverflowError: numeric::div(): division by zero\n**********************************************************************\n```\n",
    "created_at": "2015-07-16T13:14:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252008",
    "user": "https://github.com/jdemeyer"
}
```

With Sage-6.8.rc0:

```
**********************************************************************
File "src/sage/symbolic/expression.pyx", line 2821, in sage.symbolic.expression.Expression._add_
Failed example:
    (A + 3*B)*Zmod(9)(6)
Expected:
    6*A
Got:
    0* + 6*A
**********************************************************************
File "src/sage/symbolic/expression.pyx", line 2823, in sage.symbolic.expression.Expression._add_
Failed example:
    (3*A + 3*B)*Zmod(9)(6)
Expected:
    0
Got:
    0*
**********************************************************************
File "src/sage/symbolic/expression.pyx", line 2825, in sage.symbolic.expression.Expression._add_
Failed example:
    (3*A + 3*B)*Zmod(9)(6)*A
Exception raised:
    Traceback (most recent call last):
      File "/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.symbolic.expression.Expression._add_[24]>", line 1, in <module>
        (Integer(3)*A + Integer(3)*B)*Zmod(Integer(9))(Integer(6))*A
      File "sage/structure/element.pyx", line 1849, in sage.structure.element.RingElement.__mul__ (build/cythonized/sage/structure/element.c:16581)
        return (<RingElement>left)._mul_(<RingElement>right)
      File "sage/symbolic/expression.pyx", line 3148, in sage.symbolic.expression.Expression._mul_ (build/cythonized/sage/symbolic/expression.cpp:19837)
        x = gmul(left._gobj, _right._gobj)
    OverflowError: numeric::div(): division by zero
**********************************************************************
```




---

archive/issue_comments_252009.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-07-16T13:14:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252009",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_252010.json:
```json
{
    "body": "Also a detail: it's better style to use\n\n```\nsage: x = foo\n```\n\ninstead of\n\n```\nsage: x=foo\n```\n",
    "created_at": "2015-07-16T13:16:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252010",
    "user": "https://github.com/jdemeyer"
}
```

Also a detail: it's better style to use

```
sage: x = foo
```

instead of

```
sage: x=foo
```




---

archive/issue_comments_252011.json:
```json
{
    "body": "Seems the backport from Pynac-0.4.2 missed something. When will C++11 be mandatory in Sage?",
    "created_at": "2015-07-16T13:27:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252011",
    "user": "https://github.com/rwst"
}
```

Seems the backport from Pynac-0.4.2 missed something. When will C++11 be mandatory in Sage?



---

archive/issue_comments_252012.json:
```json
{
    "body": "Replying to [comment:19 rws]:\n> When will C++11 be mandatory in Sage?\nI think I already mentioned this: I recommend you write to sage-devel with this request.",
    "created_at": "2015-07-16T13:31:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252012",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:19 rws]:
> When will C++11 be mandatory in Sage?
I think I already mentioned this: I recommend you write to sage-devel with this request.



---

archive/issue_comments_252013.json:
```json
{
    "body": "Let me add that the hard part will be to define the precise subset of C++11 that you need.\n\nIt's easy to require that the C++ compiler supports the `-std=c++0x` or `-std=c++11` option, but I don't know if that is sufficient.",
    "created_at": "2015-07-16T13:33:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252013",
    "user": "https://github.com/jdemeyer"
}
```

Let me add that the hard part will be to define the precise subset of C++11 that you need.

It's easy to require that the C++ compiler supports the `-std=c++0x` or `-std=c++11` option, but I don't know if that is sufficient.



---

archive/issue_comments_252014.json:
```json
{
    "body": "Replying to [comment:21 jdemeyer]:\n> Let me add that the hard part will be to define the precise subset of C++11 that you need.\nWhy? We have already committed to gcc-4.6 in our conversation. For the other system without gcc there will have to be an Xcode version that has equivalent functionality. These two versions will be made the minimum. No other definition necessary.",
    "created_at": "2015-07-16T14:23:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252014",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:21 jdemeyer]:
> Let me add that the hard part will be to define the precise subset of C++11 that you need.
Why? We have already committed to gcc-4.6 in our conversation. For the other system without gcc there will have to be an Xcode version that has equivalent functionality. These two versions will be made the minimum. No other definition necessary.



---

archive/issue_comments_252015.json:
```json
{
    "body": "Replying to [comment:22 rws]:\n> We have already committed to gcc-4.6 in our conversation\nReally? I understood that you were not sure if GCC 4.6 was in fact sufficient. But if you are, that's fine for me.\n\nNote that, for various reasons, we actually do not support GCC 4.6 in Sage, which would make GCC 4.7 the minimum.\n\nIf you're willing to go ahead with this, you should:\n1. write to `sage-devel` explaining why you want C++11 support and that this means requiring GCC 4.7.\n2. create a ticket for requiring C++11 and GCC 4.7 in Sage.\n3. create a ticket for upgrading Pynac to the version and make it depend on the ticket in 2.",
    "created_at": "2015-07-16T14:44:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252015",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:22 rws]:
> We have already committed to gcc-4.6 in our conversation
Really? I understood that you were not sure if GCC 4.6 was in fact sufficient. But if you are, that's fine for me.

Note that, for various reasons, we actually do not support GCC 4.6 in Sage, which would make GCC 4.7 the minimum.

If you're willing to go ahead with this, you should:
1. write to `sage-devel` explaining why you want C++11 support and that this means requiring GCC 4.7.
2. create a ticket for requiring C++11 and GCC 4.7 in Sage.
3. create a ticket for upgrading Pynac to the version and make it depend on the ticket in 2.



---

archive/issue_events_052546.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-07-30T13:58:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "milestone": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18550#event-52546"
}
```



---

archive/issue_comments_252016.json:
```json
{
    "body": "Replying to [comment:17 jdemeyer]:\n> With Sage-6.8.rc0:\n> {{{\n> Got:\n>     0* + 6*A\n> Got:\n>     0*\n> }}}\nFound it. The backport was indeed incomplete. Fix in pynac-0.3.9.3.",
    "created_at": "2015-07-30T13:58:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252016",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:17 jdemeyer]:
> With Sage-6.8.rc0:
> {{{
> Got:
>     0* + 6*A
> Got:
>     0*
> }}}
Found it. The backport was indeed incomplete. Fix in pynac-0.3.9.3.



---

archive/issue_comments_252017.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-08-02T09:26:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252017",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_052547.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-08-20T13:46:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "milestone": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18550#event-52547"
}
```



---

archive/issue_events_052548.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-08-20T13:46:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18550#event-52548"
}
```



---

archive/issue_comments_252018.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2015-09-19T03:43:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252018",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_252019.json:
```json
{
    "body": "Why is it in sage-pending?\n\nWhat about the following (inspired from [comment:6 comment:6]\n\n```\nsage: f(x) = Zmod(7)(3) * x**2 + Zmod(9)(3) * x**3\nsage: f(1)\n** BOOM **\n```\n\nwhile\n\n```\nsage: f(x) = Zmod(7)(1) * x**2 + Zmod(9)(1) * x**3\nsage: f(1)\n2\n```\n\n\nVincent",
    "created_at": "2015-09-19T03:43:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252019",
    "user": "https://github.com/videlec"
}
```

Why is it in sage-pending?

What about the following (inspired from [comment:6 comment:6]

```
sage: f(x) = Zmod(7)(3) * x**2 + Zmod(9)(3) * x**3
sage: f(1)
** BOOM **
```

while

```
sage: f(x) = Zmod(7)(1) * x**2 + Zmod(9)(1) * x**3
sage: f(1)
2
```


Vincent



---

archive/issue_comments_252020.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2015-09-19T06:18:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252020",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_252021.json:
```json
{
    "body": "Replying to [comment:27 vdelecroix]:\n> Why is it in sage-pending?\nI didn't want patchbot on it.",
    "created_at": "2015-09-19T06:18:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252021",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:27 vdelecroix]:
> Why is it in sage-pending?
I didn't want patchbot on it.



---

archive/issue_events_052549.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-09-19T06:18:48Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18550#event-52549"
}
```



---

archive/issue_events_052550.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-09-19T06:18:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "milestone": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18550#event-52550"
}
```



---

archive/issue_comments_252022.json:
```json
{
    "body": "Replying to [comment:27 vdelecroix]:\n> What about the following (inspired from [comment:6 comment:6]\n> {{{\n> sage: f(x) = Zmod(7)(3) * x**2 + Zmod(9)(3) * x**3\n> sage: f(1)\n> ** BOOM **\n> }}}\n> while\n> {{{\n> sage: f(x) = Zmod(7)(1) * x**2 + Zmod(9)(1) * x**3\n> sage: f(1)\n> 2\n> }}}\n\nThis both now gives a `TypeError` in pynac master, equivalently to `GF(7)(1) + GF(9)(1)` and `GF(7)(3) + GF(9)(3)`.\n\nThe ticket should doctest this as soon as pynac is upgraded to 0.6.4",
    "created_at": "2016-03-07T07:54:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252022",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:27 vdelecroix]:
> What about the following (inspired from [comment:6 comment:6]
> {{{
> sage: f(x) = Zmod(7)(3) * x**2 + Zmod(9)(3) * x**3
> sage: f(1)
> ** BOOM **
> }}}
> while
> {{{
> sage: f(x) = Zmod(7)(1) * x**2 + Zmod(9)(1) * x**3
> sage: f(1)
> 2
> }}}

This both now gives a `TypeError` in pynac master, equivalently to `GF(7)(1) + GF(9)(1)` and `GF(7)(3) + GF(9)(3)`.

The ticket should doctest this as soon as pynac is upgraded to 0.6.4



---

archive/issue_comments_252023.json:
```json
{
    "body": "I believe this is resolved in #21391.",
    "created_at": "2017-01-16T07:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252023",
    "user": "https://github.com/rwst"
}
```

I believe this is resolved in #21391.



---

archive/issue_comments_252024.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-01-16T07:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252024",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_052551.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-01-16T07:14:22Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "milestone": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18550#event-52551"
}
```



---

archive/issue_events_052552.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-01-16T07:14:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18550#event-52552"
}
```



---

archive/issue_events_052553.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/tmonteil",
    "created_at": "2017-03-06T22:37:04Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18550#event-52553"
}
```



---

archive/issue_events_052554.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/tmonteil",
    "created_at": "2017-03-06T22:37:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "milestone": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18550#event-52554"
}
```



---

archive/issue_comments_252025.json:
```json
{
    "body": "Replying to [comment:31 rws]:\n> I believe this is resolved in #21391.\n\nIt seems inteed to works better now. But why not adding the tests discussed on the current ticket as you did previously ?",
    "created_at": "2017-03-06T22:37:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252025",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Replying to [comment:31 rws]:
> I believe this is resolved in #21391.

It seems inteed to works better now. But why not adding the tests discussed on the current ticket as you did previously ?



---

archive/issue_comments_252026.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2017-03-06T22:37:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252026",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_252027.json:
```json
{
    "body": "Made dependent on #21391 to prevent merge conflicts.\n----\nNew commits:",
    "created_at": "2017-03-07T14:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252027",
    "user": "https://github.com/rwst"
}
```

Made dependent on #21391 to prevent merge conflicts.
----
New commits:



---

archive/issue_comments_252028.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2017-03-07T14:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252028",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_252029.json:
```json
{
    "body": "Do the people on this ticket agree that #24072 solves this ticket as is claimed there?",
    "created_at": "2017-10-25T10:27:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252029",
    "user": "https://github.com/koffie"
}
```

Do the people on this ticket agree that #24072 solves this ticket as is claimed there?



---

archive/issue_events_052555.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-10-25T12:44:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "milestone": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18550#event-52555"
}
```



---

archive/issue_events_052556.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-10-25T12:44:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18550#event-52556"
}
```



---

archive/issue_comments_252030.json:
```json
{
    "body": "Agree.",
    "created_at": "2017-10-25T12:44:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252030",
    "user": "https://github.com/rwst"
}
```

Agree.



---

archive/issue_comments_252031.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-25T22:40:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252031",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_052557.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-12T08:23:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18550#event-52557"
}
```



---

archive/issue_comments_252032.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2017-12-12T08:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18550",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18550#issuecomment-252032",
    "user": "https://github.com/embray"
}
```

Resolution: wontfix
