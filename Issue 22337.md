# Issue 22337: Add .change_ring() method for polyhedra

archive/issues_022337.json:
```json
{
    "body": "CC:  @mkoeppe @jplab\n\nKeywords: days84, polytope\n\nPolyhedra can be defined in different rings, and this method allows to transform between rings (compare to the similar feature for matrices).\n\nIssue created by migration from https://trac.sagemath.org/ticket/22574\n\n",
    "created_at": "2017-03-10T15:18:54Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "Add .change_ring() method for polyhedra",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22337",
    "user": "https://github.com/mforets"
}
```
CC:  @mkoeppe @jplab

Keywords: days84, polytope

Polyhedra can be defined in different rings, and this method allows to transform between rings (compare to the similar feature for matrices).

Issue created by migration from https://trac.sagemath.org/ticket/22574





---

archive/issue_comments_310162.json:
```json
{
    "body": "There is currently:\n\n\n```\n\nsage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ);  P\nA 2-dimensional polyhedron in ZZ^2 defined as the convex hull of 2 vertices and 1 ray\nsage: P_QQ = P.base_extend(QQ); P_QQ\nA 2-dimensional polyhedron in QQ^2 defined as the convex hull of 2 vertices and 1 ray\n\n```\n\n\nCould there be a boolean parameter such as `inplace` (similar as in graphs and simplicial complexes...) to determine if one should create a new object or just change the base ring?\n\nI am wondering how much changing the base ring changes the internals of the polyhedron object. Would many things break? We can try and see...",
    "created_at": "2017-03-15T15:35:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22337",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22337#issuecomment-310162",
    "user": "https://github.com/jplab"
}
```

There is currently:


```

sage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ);  P
A 2-dimensional polyhedron in ZZ^2 defined as the convex hull of 2 vertices and 1 ray
sage: P_QQ = P.base_extend(QQ); P_QQ
A 2-dimensional polyhedron in QQ^2 defined as the convex hull of 2 vertices and 1 ray

```


Could there be a boolean parameter such as `inplace` (similar as in graphs and simplicial complexes...) to determine if one should create a new object or just change the base ring?

I am wondering how much changing the base ring changes the internals of the polyhedron object. Would many things break? We can try and see...



---

archive/issue_comments_310163.json:
```json
{
    "body": "I think there is no value in trying to implement `inplace` -- the various base rings are handled by different classes after all. Moreover, right now polyhedra are immutable - and it would be strange to be able to mutate the base ring but nothing else.",
    "created_at": "2017-03-15T19:19:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22337",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22337#issuecomment-310163",
    "user": "https://github.com/mkoeppe"
}
```

I think there is no value in trying to implement `inplace` -- the various base rings are handled by different classes after all. Moreover, right now polyhedra are immutable - and it would be strange to be able to mutate the base ring but nothing else.



---

archive/issue_comments_310164.json:
```json
{
    "body": "Replying to [comment:2 mkoeppe]:\n> I think there is no value in trying to implement `inplace` -- the various base rings are handled by different classes after all. Moreover, right now polyhedra are immutable - and it would be strange to be able to mutate the base ring but nothing else.\n\nAgreed.\n\nFurther, I don't really like the fact that hidden in `base_extend` is the possibility to change the backend, which as a matter of fact doesn't work. This is not user-friendly to say the least. I would therefore also deprecate the keyword completely and point to a `.change_backend()` method (see #22575). I guess that such a method will take care to handle the modifications of base ring if need be...",
    "created_at": "2017-03-15T19:44:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22337",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22337#issuecomment-310164",
    "user": "https://github.com/jplab"
}
```

Replying to [comment:2 mkoeppe]:
> I think there is no value in trying to implement `inplace` -- the various base rings are handled by different classes after all. Moreover, right now polyhedra are immutable - and it would be strange to be able to mutate the base ring but nothing else.

Agreed.

Further, I don't really like the fact that hidden in `base_extend` is the possibility to change the backend, which as a matter of fact doesn't work. This is not user-friendly to say the least. I would therefore also deprecate the keyword completely and point to a `.change_backend()` method (see #22575). I guess that such a method will take care to handle the modifications of base ring if need be...



---

archive/issue_comments_310165.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-02-15T11:43:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22337",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22337#issuecomment-310165",
    "user": "https://github.com/LaisRast"
}
```

New commits:



---

archive/issue_comments_310166.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-02-15T15:26:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22337",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22337#issuecomment-310166",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_310167.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-02-15T15:26:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22337",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22337#issuecomment-310167",
    "user": "https://github.com/LaisRast"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_310168.json:
```json
{
    "body": "Hi,\n\nHere are a couple of things I saw:\n\n- Adapt the convention for the input, see for example `vertex_facet_graph`:\n\n```diff\n+        - ``backend`` -- the new backend, see\n+            :func:`~sage.geometry.polyhedron.constructor.Polyhedron`.\n+            If ``None`` (the default), use the same defaulting behavior\n+            as described there; it is not attempted to keep the same\n+            backend.\n```\n\n- It would be good to have more examples with all the potential pairings.\n\n- Further, it would be nice to handle the potential error in the function when coercing from `QQ` to `ZZ` and return a message like: 'Can not change the ring to `ZZ`: a coordinate is rational'. And these examples should be added after the examples that do work.",
    "created_at": "2019-02-22T10:51:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22337",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22337#issuecomment-310168",
    "user": "https://github.com/jplab"
}
```

Hi,

Here are a couple of things I saw:

- Adapt the convention for the input, see for example `vertex_facet_graph`:

```diff
+        - ``backend`` -- the new backend, see
+            :func:`~sage.geometry.polyhedron.constructor.Polyhedron`.
+            If ``None`` (the default), use the same defaulting behavior
+            as described there; it is not attempted to keep the same
+            backend.
```

- It would be good to have more examples with all the potential pairings.

- Further, it would be nice to handle the potential error in the function when coercing from `QQ` to `ZZ` and return a message like: 'Can not change the ring to `ZZ`: a coordinate is rational'. And these examples should be added after the examples that do work.



---

archive/issue_comments_310169.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-02-22T10:51:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22337",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22337#issuecomment-310169",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_310170.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-01T10:37:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22337",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22337#issuecomment-310170",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_310171.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-03-01T10:39:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22337",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22337#issuecomment-310171",
    "user": "https://github.com/LaisRast"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_310172.json:
```json
{
    "body": "This looks good to me.",
    "created_at": "2019-03-13T09:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22337",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22337#issuecomment-310172",
    "user": "https://github.com/jplab"
}
```

This looks good to me.



---

archive/issue_comments_310173.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-03-13T09:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22337",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22337#issuecomment-310173",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_310174.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-03-14T18:14:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22337",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22337#issuecomment-310174",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_021034.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2019-03-14T18:14:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22337",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22337#event-21034"
}
```
