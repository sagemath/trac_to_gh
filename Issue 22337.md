# Issue 22337: Add .change_ring() method for polyhedra

Issue created by migration from https://trac.sagemath.org/ticket/22574

Original creator: mforets

Original creation time: 2017-03-10 15:18:54

CC:  mkoeppe jipilab

Keywords: days84, polytope

Polyhedra can be defined in different rings, and this method allows to transform between rings (compare to the similar feature for matrices).


---

Comment by jipilab created at 2017-03-15 15:35:28

There is currently:


```

sage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ);  P
A 2-dimensional polyhedron in ZZ^2 defined as the convex hull of 2 vertices and 1 ray
sage: P_QQ = P.base_extend(QQ); P_QQ
A 2-dimensional polyhedron in QQ^2 defined as the convex hull of 2 vertices and 1 ray

```


Could there be a boolean parameter such as `inplace` (similar as in graphs and simplicial complexes...) to determine if one should create a new object or just change the base ring?

I am wondering how much changing the base ring changes the internals of the polyhedron object. Would many things break? We can try and see...


---

Comment by mkoeppe created at 2017-03-15 19:19:29

I think there is no value in trying to implement `inplace` -- the various base rings are handled by different classes after all. Moreover, right now polyhedra are immutable - and it would be strange to be able to mutate the base ring but nothing else.


---

Comment by jipilab created at 2017-03-15 19:44:11

Replying to [comment:2 mkoeppe]:
> I think there is no value in trying to implement `inplace` -- the various base rings are handled by different classes after all. Moreover, right now polyhedra are immutable - and it would be strange to be able to mutate the base ring but nothing else.

Agreed.

Further, I don't really like the fact that hidden in `base_extend` is the possibility to change the backend, which as a matter of fact doesn't work. This is not user-friendly to say the least. I would therefore also deprecate the keyword completely and point to a `.change_backend()` method (see #22575). I guess that such a method will take care to handle the modifications of base ring if need be...


---

Comment by @LaisRast created at 2019-02-15 11:43:42

New commits:


---

Comment by git created at 2019-02-15 15:26:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @LaisRast created at 2019-02-15 15:26:59

Changing status from new to needs_review.


---

Comment by jipilab created at 2019-02-22 10:51:48

Hi,

Here are a couple of things I saw:

 - Adapt the convention for the input, see for example `vertex_facet_graph`:

```diff
+        - ``backend`` -- the new backend, see
+            :func:`~sage.geometry.polyhedron.constructor.Polyhedron`.
+            If ``None`` (the default), use the same defaulting behavior
+            as described there; it is not attempted to keep the same
+            backend.
```

 - It would be good to have more examples with all the potential pairings.

 - Further, it would be nice to handle the potential error in the function when coercing from `QQ` to `ZZ` and return a message like: 'Can not change the ring to `ZZ`: a coordinate is rational'. And these examples should be added after the examples that do work.


---

Comment by jipilab created at 2019-02-22 10:51:48

Changing status from needs_review to needs_work.


---

Comment by git created at 2019-03-01 10:37:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @LaisRast created at 2019-03-01 10:39:28

Changing status from needs_work to needs_review.


---

Comment by jipilab created at 2019-03-13 09:36:31

This looks good to me.


---

Comment by jipilab created at 2019-03-13 09:36:31

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-03-14 18:14:01

Resolution: fixed
