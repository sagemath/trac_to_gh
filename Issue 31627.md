# Issue 31627: Improved input output for backend polymake

archive/issues_031627.json:
```json
{
    "body": "CC:  @mkoeppe\n\nKeywords: polymake, input, output\n\nFrom #26368.\n\nThe interface to polymake seems to have a significant delay. For input, we can avoid it, as polymake accepts nested lists of integers, rationals, floats.\n\nFor output we can avoid it, as at least for matrices and vectors, we can just parse the representation string.\n\nBefore:\n\n\n```\nsage: %time P = polytopes.hypercube(8, backend='polymake')                                                                                                                                                                                                                                                                                                                 \nCPU times: user 4.54 s, sys: 260 ms, total: 4.8 s\nWall time: 4.81 s\nsage: %time P = polytopes.hypercube(8, backend='polymake')                                                                                                                                                                                                                                                                                                                 \nCPU times: user 3.08 s, sys: 236 ms, total: 3.31 s\nWall time: 3.31 s\nsage: %time P1 = loads(dumps(P))                                                                                                                                                                                                                                                                                                                                           \nCPU times: user 805 ms, sys: 48 ms, total: 853 ms\nWall time: 853 ms\nsage: %time P = polytopes.dodecahedron(backend='polymake')                                                                                                                                                                                                                                                                                                                 \nCPU times: user 763 ms, sys: 48.2 ms, total: 811 ms\nWall time: 811 ms\nsage: %time P = polytopes.dodecahedron(backend='polymake')                                                                                                                                                                                                                                                                                                                 \nCPU times: user 661 ms, sys: 31.7 ms, total: 692 ms\nWall time: 692 ms\nsage: %time P1 = loads(dumps(P))                                                                                                                                                                                                                                                                                                                                           \nCPU times: user 62.9 ms, sys: 0 ns, total: 62.9 ms\nWall time: 62.6 ms\nsage: %time P = polytopes.dodecahedron(backend='polymake', exact=False)                                                                                                                                                                                                                                                                                                    \nCPU times: user 408 ms, sys: 19.6 ms, total: 428 ms\nWall time: 427 ms\n```\n\n\n\nAfter:\n\n\n```\nsage: %time P = polytopes.hypercube(8, backend='polymake')                                                                                                                                                                                                                                                                                                                 \nCPU times: user 1.48 s, sys: 67.7 ms, total: 1.55 s\nWall time: 1.55 s\nsage: %time P = polytopes.hypercube(8, backend='polymake')                                                                                                                                                                                                                                                                                                                 \nCPU times: user 70.6 ms, sys: 50 \u00b5s, total: 70.7 ms\nWall time: 70.3 ms\nsage: %time P1 = loads(dumps(P))                                                                                                                                                                                                                                                                                                                                           \nCPU times: user 17.5 ms, sys: 0 ns, total: 17.5 ms\nWall time: 17.3 ms\nsage: %time P = polytopes.dodecahedron(backend='polymake')                                                                                                                                                                                                                                                                                                                 \nCPU times: user 223 ms, sys: 8 ms, total: 231 ms\nWall time: 231 ms\nsage: %time P = polytopes.dodecahedron(backend='polymake')                                                                                                                                                                                                                                                                                                                 \nCPU times: user 128 ms, sys: 12 ms, total: 140 ms\nWall time: 139 ms\nsage: %time P1 = loads(dumps(P))  # slight slow down                                                                                                                                                                                                                                                                                                                                           \nCPU times: user 60.9 ms, sys: 4.04 ms, total: 64.9 ms\nWall time: 64.6 ms\nsage: %time P = polytopes.dodecahedron(backend='polymake', exact=False)                                                                                                                                                                                                                                                                                                    \nCPU times: user 54 ms, sys: 0 ns, total: 54 ms\nWall time: 53.5 ms\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/31864\n\n",
    "created_at": "2021-05-27T07:32:27Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Improved input output for backend polymake",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31627",
    "user": "https://github.com/kliem"
}
```
CC:  @mkoeppe

Keywords: polymake, input, output

From #26368.

The interface to polymake seems to have a significant delay. For input, we can avoid it, as polymake accepts nested lists of integers, rationals, floats.

For output we can avoid it, as at least for matrices and vectors, we can just parse the representation string.

Before:


```
sage: %time P = polytopes.hypercube(8, backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 4.54 s, sys: 260 ms, total: 4.8 s
Wall time: 4.81 s
sage: %time P = polytopes.hypercube(8, backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 3.08 s, sys: 236 ms, total: 3.31 s
Wall time: 3.31 s
sage: %time P1 = loads(dumps(P))                                                                                                                                                                                                                                                                                                                                           
CPU times: user 805 ms, sys: 48 ms, total: 853 ms
Wall time: 853 ms
sage: %time P = polytopes.dodecahedron(backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 763 ms, sys: 48.2 ms, total: 811 ms
Wall time: 811 ms
sage: %time P = polytopes.dodecahedron(backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 661 ms, sys: 31.7 ms, total: 692 ms
Wall time: 692 ms
sage: %time P1 = loads(dumps(P))                                                                                                                                                                                                                                                                                                                                           
CPU times: user 62.9 ms, sys: 0 ns, total: 62.9 ms
Wall time: 62.6 ms
sage: %time P = polytopes.dodecahedron(backend='polymake', exact=False)                                                                                                                                                                                                                                                                                                    
CPU times: user 408 ms, sys: 19.6 ms, total: 428 ms
Wall time: 427 ms
```



After:


```
sage: %time P = polytopes.hypercube(8, backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 1.48 s, sys: 67.7 ms, total: 1.55 s
Wall time: 1.55 s
sage: %time P = polytopes.hypercube(8, backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 70.6 ms, sys: 50 µs, total: 70.7 ms
Wall time: 70.3 ms
sage: %time P1 = loads(dumps(P))                                                                                                                                                                                                                                                                                                                                           
CPU times: user 17.5 ms, sys: 0 ns, total: 17.5 ms
Wall time: 17.3 ms
sage: %time P = polytopes.dodecahedron(backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 223 ms, sys: 8 ms, total: 231 ms
Wall time: 231 ms
sage: %time P = polytopes.dodecahedron(backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 128 ms, sys: 12 ms, total: 140 ms
Wall time: 139 ms
sage: %time P1 = loads(dumps(P))  # slight slow down                                                                                                                                                                                                                                                                                                                                           
CPU times: user 60.9 ms, sys: 4.04 ms, total: 64.9 ms
Wall time: 64.6 ms
sage: %time P = polytopes.dodecahedron(backend='polymake', exact=False)                                                                                                                                                                                                                                                                                                    
CPU times: user 54 ms, sys: 0 ns, total: 54 ms
Wall time: 53.5 ms
```


Issue created by migration from https://trac.sagemath.org/ticket/31864





---

archive/issue_comments_451198.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-05-27T07:32:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31627#issuecomment-451198",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_451199.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-27T12:00:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31627#issuecomment-451199",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_451200.json:
```json
{
    "body": "I think it would be better to call `NumberFieldElement_quadratic._polymake_init_` instead of duplicating it",
    "created_at": "2021-05-27T16:39:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31627#issuecomment-451200",
    "user": "https://github.com/mkoeppe"
}
```

I think it would be better to call `NumberFieldElement_quadratic._polymake_init_` instead of duplicating it



---

archive/issue_comments_451201.json:
```json
{
    "body": "Good point.",
    "created_at": "2021-05-27T18:11:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31627#issuecomment-451201",
    "user": "https://github.com/kliem"
}
```

Good point.



---

archive/issue_comments_451202.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-05-27T18:17:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31627#issuecomment-451202",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_451203.json:
```json
{
    "body": "Is #31866 a dependency now?",
    "created_at": "2021-05-27T18:22:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31627#issuecomment-451203",
    "user": "https://github.com/mkoeppe"
}
```

Is #31866 a dependency now?



---

archive/issue_comments_451204.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-05-27T18:24:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31627#issuecomment-451204",
    "user": "https://github.com/kliem"
}
```

New commits:



---

archive/issue_comments_451205.json:
```json
{
    "body": "Replying to [comment:7 mkoeppe]:\n> Is #31866 a dependency now?\n\nNo, of course not. I am starting to pull in stuff into wrong branches...",
    "created_at": "2021-05-27T18:26:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31627#issuecomment-451205",
    "user": "https://github.com/kliem"
}
```

Replying to [comment:7 mkoeppe]:
> Is #31866 a dependency now?

No, of course not. I am starting to pull in stuff into wrong branches...



---

archive/issue_comments_451206.json:
```json
{
    "body": "This is a very nice improvement.",
    "created_at": "2021-05-27T18:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31627#issuecomment-451206",
    "user": "https://github.com/mkoeppe"
}
```

This is a very nice improvement.



---

archive/issue_comments_451207.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-05-27T18:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31627#issuecomment-451207",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_451208.json:
```json
{
    "body": "Thank you. Sometimes it is surprising what the bottle neck of a calculation is.",
    "created_at": "2021-05-27T18:41:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31627#issuecomment-451208",
    "user": "https://github.com/kliem"
}
```

Thank you. Sometimes it is surprising what the bottle neck of a calculation is.



---

archive/issue_comments_451209.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2021-07-19T00:20:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31627#issuecomment-451209",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from major to critical.



---

archive/issue_events_028837.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-07-23T20:11:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31627",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31627#event-28837"
}
```



---

archive/issue_comments_451210.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-07-23T20:11:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31627",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31627#issuecomment-451210",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
