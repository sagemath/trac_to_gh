# Issue 31627: Improved input output for backend polymake

Issue created by migration from https://trac.sagemath.org/ticket/31864

Original creator: @kliem

Original creation time: 2021-05-27 07:32:27

CC:  mkoeppe

Keywords: polymake, input, output

From #26368.

The interface to polymake seems to have a significant delay. For input, we can avoid it, as polymake accepts nested lists of integers, rationals, floats.

For output we can avoid it, as at least for matrices and vectors, we can just parse the representation string.

Before:


```
sage: %time P = polytopes.hypercube(8, backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 4.54 s, sys: 260 ms, total: 4.8 s
Wall time: 4.81 s
sage: %time P = polytopes.hypercube(8, backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 3.08 s, sys: 236 ms, total: 3.31 s
Wall time: 3.31 s
sage: %time P1 = loads(dumps(P))                                                                                                                                                                                                                                                                                                                                           
CPU times: user 805 ms, sys: 48 ms, total: 853 ms
Wall time: 853 ms
sage: %time P = polytopes.dodecahedron(backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 763 ms, sys: 48.2 ms, total: 811 ms
Wall time: 811 ms
sage: %time P = polytopes.dodecahedron(backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 661 ms, sys: 31.7 ms, total: 692 ms
Wall time: 692 ms
sage: %time P1 = loads(dumps(P))                                                                                                                                                                                                                                                                                                                                           
CPU times: user 62.9 ms, sys: 0 ns, total: 62.9 ms
Wall time: 62.6 ms
sage: %time P = polytopes.dodecahedron(backend='polymake', exact=False)                                                                                                                                                                                                                                                                                                    
CPU times: user 408 ms, sys: 19.6 ms, total: 428 ms
Wall time: 427 ms
```



After:


```
sage: %time P = polytopes.hypercube(8, backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 1.48 s, sys: 67.7 ms, total: 1.55 s
Wall time: 1.55 s
sage: %time P = polytopes.hypercube(8, backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 70.6 ms, sys: 50 Âµs, total: 70.7 ms
Wall time: 70.3 ms
sage: %time P1 = loads(dumps(P))                                                                                                                                                                                                                                                                                                                                           
CPU times: user 17.5 ms, sys: 0 ns, total: 17.5 ms
Wall time: 17.3 ms
sage: %time P = polytopes.dodecahedron(backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 223 ms, sys: 8 ms, total: 231 ms
Wall time: 231 ms
sage: %time P = polytopes.dodecahedron(backend='polymake')                                                                                                                                                                                                                                                                                                                 
CPU times: user 128 ms, sys: 12 ms, total: 140 ms
Wall time: 139 ms
sage: %time P1 = loads(dumps(P))  # slight slow down                                                                                                                                                                                                                                                                                                                                           
CPU times: user 60.9 ms, sys: 4.04 ms, total: 64.9 ms
Wall time: 64.6 ms
sage: %time P = polytopes.dodecahedron(backend='polymake', exact=False)                                                                                                                                                                                                                                                                                                    
CPU times: user 54 ms, sys: 0 ns, total: 54 ms
Wall time: 53.5 ms
```



---

Comment by @kliem created at 2021-05-27 07:32:35

Changing status from new to needs_review.


---

Comment by git created at 2021-05-27 12:00:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-05-27 16:39:37

I think it would be better to call `NumberFieldElement_quadratic._polymake_init_` instead of duplicating it


---

Comment by @kliem created at 2021-05-27 18:11:44

Good point.


---

Comment by git created at 2021-05-27 18:17:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-05-27 18:22:51

Is #31866 a dependency now?


---

Comment by @kliem created at 2021-05-27 18:24:19

New commits:


---

Comment by @kliem created at 2021-05-27 18:26:12

Replying to [comment:7 mkoeppe]:
> Is #31866 a dependency now?

No, of course not. I am starting to pull in stuff into wrong branches...


---

Comment by mkoeppe created at 2021-05-27 18:38:18

This is a very nice improvement.


---

Comment by mkoeppe created at 2021-05-27 18:38:18

Changing status from needs_review to positive_review.


---

Comment by @kliem created at 2021-05-27 18:41:21

Thank you. Sometimes it is surprising what the bottle neck of a calculation is.


---

Comment by mkoeppe created at 2021-07-19 00:20:38

Changing priority from major to critical.


---

Comment by vbraun created at 2021-07-23 20:11:47

Resolution: fixed
