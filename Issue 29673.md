# Issue 29673: sage.rings.finite_rings.element_givaro: Remove dependency on NTL

archive/issues_029673.json:
```json
{
    "body": "CC:  @kiwifb @fchapoton @videlec @ClementPernet\n\nAll dependencies on NTL seem to have been removed from this Cython module already. \n\nIn this ticket, we remove `ntl` from the list of includes and libraries to link.\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/29910\n\n",
    "created_at": "2020-06-20T03:47:19Z",
    "labels": [
        "component: finite rings",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "sage.rings.finite_rings.element_givaro: Remove dependency on NTL",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29673",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @kiwifb @fchapoton @videlec @ClementPernet

All dependencies on NTL seem to have been removed from this Cython module already. 

In this ticket, we remove `ntl` from the list of includes and libraries to link.


Issue created by migration from https://trac.sagemath.org/ticket/29910





---

archive/issue_comments_420927.json:
```json
{
    "body": "The branch consists of 1 commit on top of #29786\n\n---\nNew commits:",
    "created_at": "2020-06-20T03:53:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-420927",
    "user": "https://github.com/mkoeppe"
}
```

The branch consists of 1 commit on top of #29786

---
New commits:



---

archive/issue_comments_420928.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-06-20T03:54:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-420928",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_420929.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-06-20T03:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-420929",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_420930.json:
```json
{
    "body": "Sounds fair to me. In gentoo we apply `--as-needed` at linking time to remove libraries not directly used. \n\n```\n readelf -d /usr/lib/python3.7/site-packages/sage/rings/finite_rings/element_givaro.cpython-37m-x86_64-linux-gnu.so \n\nDynamic section at offset 0x4db78 contains 30 entries:\n  Tag        Type                         Name/Value\n 0x0000000000000001 (NEEDED)             Shared library: [libgivaro.so.9]\n 0x0000000000000001 (NEEDED)             Shared library: [libpari-gmp.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libgmp.so.10]\n 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libpython3.7m.so.1.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]\n 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]\n 0x000000000000000c (INIT)               0xd000\n```\nno `libntl` in there, not even in `ldd -r` of the same object\n\n```\nldd -r /usr/lib/python3.7/site-packages/sage/rings/finite_rings/element_givaro.cpython-37m-x86_64-linux-gnu.so \n\tlinux-vdso.so.1 (0x00007ffe86f86000)\n\tlibgivaro.so.9 => /usr/lib64/libgivaro.so.9 (0x00007f6c5ff7e000)\n\tlibpari-gmp.so.6 => /usr/lib64/libpari-gmp.so.6 (0x00007f6c5f711000)\n\tlibgmp.so.10 => /usr/lib64/libgmp.so.10 (0x00007f6c5f698000)\n\tlibstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/10.1.0/libstdc++.so.6 (0x00007f6c5f42d000)\n\tlibpython3.7m.so.1.0 => /usr/lib64/libpython3.7m.so.1.0 (0x00007f6c5f12c000)\n\tlibgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/10.1.0/libgcc_s.so.1 (0x00007f6c5f112000)\n\tlibc.so.6 => /lib64/libc.so.6 (0x00007f6c5ef57000)\n\tlibgmpxx.so.4 => /usr/lib64/libgmpxx.so.4 (0x00007f6c5ef4e000)\n\tlibm.so.6 => /lib64/libm.so.6 (0x00007f6c5ee18000)\n\tlibdl.so.2 => /lib64/libdl.so.2 (0x00007f6c5ee13000)\n\t/lib64/ld-linux-x86-64.so.2 (0x00007f6c6006f000)\n\tlibpthread.so.0 => /lib64/libpthread.so.0 (0x00007f6c5edf3000)\n\tlibutil.so.1 => /lib64/libutil.so.1 (0x00007f6c5edee000)\n```\n\nThe commit looks good to me.",
    "created_at": "2020-06-20T03:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-420930",
    "user": "https://github.com/kiwifb"
}
```

Sounds fair to me. In gentoo we apply `--as-needed` at linking time to remove libraries not directly used. 

```
 readelf -d /usr/lib/python3.7/site-packages/sage/rings/finite_rings/element_givaro.cpython-37m-x86_64-linux-gnu.so 

Dynamic section at offset 0x4db78 contains 30 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libgivaro.so.9]
 0x0000000000000001 (NEEDED)             Shared library: [libpari-gmp.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libgmp.so.10]
 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libpython3.7m.so.1.0]
 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000c (INIT)               0xd000
```
no `libntl` in there, not even in `ldd -r` of the same object

```
ldd -r /usr/lib/python3.7/site-packages/sage/rings/finite_rings/element_givaro.cpython-37m-x86_64-linux-gnu.so 
	linux-vdso.so.1 (0x00007ffe86f86000)
	libgivaro.so.9 => /usr/lib64/libgivaro.so.9 (0x00007f6c5ff7e000)
	libpari-gmp.so.6 => /usr/lib64/libpari-gmp.so.6 (0x00007f6c5f711000)
	libgmp.so.10 => /usr/lib64/libgmp.so.10 (0x00007f6c5f698000)
	libstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/10.1.0/libstdc++.so.6 (0x00007f6c5f42d000)
	libpython3.7m.so.1.0 => /usr/lib64/libpython3.7m.so.1.0 (0x00007f6c5f12c000)
	libgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/10.1.0/libgcc_s.so.1 (0x00007f6c5f112000)
	libc.so.6 => /lib64/libc.so.6 (0x00007f6c5ef57000)
	libgmpxx.so.4 => /usr/lib64/libgmpxx.so.4 (0x00007f6c5ef4e000)
	libm.so.6 => /lib64/libm.so.6 (0x00007f6c5ee18000)
	libdl.so.2 => /lib64/libdl.so.2 (0x00007f6c5ee13000)
	/lib64/ld-linux-x86-64.so.2 (0x00007f6c6006f000)
	libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f6c5edf3000)
	libutil.so.1 => /lib64/libutil.so.1 (0x00007f6c5edee000)
```

The commit looks good to me.



---

archive/issue_comments_420931.json:
```json
{
    "body": "Thanks!",
    "created_at": "2020-06-20T04:30:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-420931",
    "user": "https://github.com/mkoeppe"
}
```

Thanks!



---

archive/issue_events_076688.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-08T19:32:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29673#event-76688"
}
```



---

archive/issue_comments_420932.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-08T19:32:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29673",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29673#issuecomment-420932",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
