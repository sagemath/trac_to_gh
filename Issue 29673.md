# Issue 29673: sage.rings.finite_rings.element_givaro: Remove dependency on NTL

Issue created by migration from https://trac.sagemath.org/ticket/29910

Original creator: mkoeppe

Original creation time: 2020-06-20 03:47:19

CC:  fbissey chapoton vdelecroix cpernet

All dependencies on NTL seem to have been removed from this Cython module already. 

In this ticket, we remove `ntl` from the list of includes and libraries to link.



---

Comment by mkoeppe created at 2020-06-20 03:53:15

The branch consists of 1 commit on top of #29786
----
New commits:


---

Comment by mkoeppe created at 2020-06-20 03:54:07

Changing status from new to needs_review.


---

Comment by fbissey created at 2020-06-20 03:55:50

Changing status from needs_review to positive_review.


---

Comment by fbissey created at 2020-06-20 03:55:50

Sounds fair to me. In gentoo we apply `--as-needed` at linking time to remove libraries not directly used. 

```
 readelf -d /usr/lib/python3.7/site-packages/sage/rings/finite_rings/element_givaro.cpython-37m-x86_64-linux-gnu.so 

Dynamic section at offset 0x4db78 contains 30 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libgivaro.so.9]
 0x0000000000000001 (NEEDED)             Shared library: [libpari-gmp.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libgmp.so.10]
 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libpython3.7m.so.1.0]
 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000c (INIT)               0xd000
```

no `libntl` in there, not even in `ldd -r` of the same object

```
ldd -r /usr/lib/python3.7/site-packages/sage/rings/finite_rings/element_givaro.cpython-37m-x86_64-linux-gnu.so 
	linux-vdso.so.1 (0x00007ffe86f86000)
	libgivaro.so.9 => /usr/lib64/libgivaro.so.9 (0x00007f6c5ff7e000)
	libpari-gmp.so.6 => /usr/lib64/libpari-gmp.so.6 (0x00007f6c5f711000)
	libgmp.so.10 => /usr/lib64/libgmp.so.10 (0x00007f6c5f698000)
	libstdc++.so.6 => /usr/lib/gcc/x86_64-pc-linux-gnu/10.1.0/libstdc++.so.6 (0x00007f6c5f42d000)
	libpython3.7m.so.1.0 => /usr/lib64/libpython3.7m.so.1.0 (0x00007f6c5f12c000)
	libgcc_s.so.1 => /usr/lib/gcc/x86_64-pc-linux-gnu/10.1.0/libgcc_s.so.1 (0x00007f6c5f112000)
	libc.so.6 => /lib64/libc.so.6 (0x00007f6c5ef57000)
	libgmpxx.so.4 => /usr/lib64/libgmpxx.so.4 (0x00007f6c5ef4e000)
	libm.so.6 => /lib64/libm.so.6 (0x00007f6c5ee18000)
	libdl.so.2 => /lib64/libdl.so.2 (0x00007f6c5ee13000)
	/lib64/ld-linux-x86-64.so.2 (0x00007f6c6006f000)
	libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f6c5edf3000)
	libutil.so.1 => /lib64/libutil.so.1 (0x00007f6c5edee000)
```


The commit looks good to me.


---

Comment by mkoeppe created at 2020-06-20 04:30:29

Thanks!


---

Comment by vbraun created at 2020-07-08 19:32:18

Resolution: fixed
