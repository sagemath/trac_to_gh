# Issue 14373: Bug in the case S_4 in Galois representations of elliptic curves

Issue created by migration from Trac.

Original creator: wuthrich

Original creation time: 2013-05-14 08:52:58

Assignee: tbd

Keywords: galois representations, elliptic curves

John Cremona noted that


```
sage: EllipticCurve('50700u1').galois_representation().image_type(13)
```


produces


```
AssertionError: bug in image_type.
```



---

Comment by wuthrich created at 2013-05-14 08:57:45

Changing component from PLEASE CHANGE to elliptic curves.


---

Comment by wuthrich created at 2013-05-14 08:57:45

Changing assignee from tbd to cremona.


---

Attachment


---

Comment by wuthrich created at 2013-05-14 09:06:04

Changing status from new to needs_review.


---

Comment by chapoton created at 2013-05-17 20:22:54

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2013-05-17 20:22:54

I have uploaded an add-on patch which  
- puts the raise statements into python3 syntax
- adds the links to the trac tickets

But there is a problem with your patch: one doctest is failing, there is no curve called '50700u1', even after installing the extended Cremona database.


---

Comment by cremona created at 2013-05-18 10:21:50

Replying to [comment:4 chapoton]:
> I have uploaded an add-on patch which  
> - puts the raise statements into python3 syntax
> - adds the links to the trac tickets
> 
> But there is a problem with your patch: one doctest is failing, there is no curve called '50700u1', even after installing the extended Cremona database.

?? Yes there is!  However, in order for this test to be usable without the optional database I suggest replacing it with

```
EllipticCurve([0,1,0,-4788,109188]).galois_representation().image_type(13)
```

(I have inserted the a-invariants of 50700u1).


---

Comment by chapoton created at 2013-05-18 10:35:01

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2013-05-18 10:35:01

ok, I have done that.

Otherwise, one would have to make the test optional.


---

Attachment


---

Comment by wuthrich created at 2013-05-20 13:58:46

Thanks for the patch. Can you give a positive review for the combination ?


---

Comment by chapoton created at 2013-05-23 18:26:43

Sorry, but I am not able to check the math. If you are sure of the math, you can put a positive review in my name.


---

Comment by cremona created at 2013-05-23 18:34:42

Chris, can you give us (here) a quick note about the new el5 assignment from roots of a quadratic instead of whatever it was before?

Also, we need to put instructions in the descriptions about applying both patches in sequence.


---

Comment by wuthrich created at 2013-05-23 20:11:16

Yes, I am sure this improves this function.

The function `_ex_set(p)` at the start of the file lists the elements in PGL_2(F_p) that may appear in an exceptional subgroup A_n or S_n. Or rather it lists what `trace^2/det` evaluates on them. (This is taken from Serre's paper). In particular the elements of order 5 are the roots of `(X**2 - 3*X+1)`, which we add at the end to the list.

Now later this is used in the function `image_type`. Unfortunately, I took the last two elements, when in fact for some `p` there is are no such elements of order 5. As a consequence, the example that John found all possibilities for what the subgroup could be were eliminated. Hence the answer "bug". Now it gives the correct answer.

So the maths did not change, just a silly bug was eliminated.


---

Comment by chapoton created at 2013-05-24 07:08:30

ok, then positive review.


---

Comment by chapoton created at 2013-05-24 07:08:30

Changing status from needs_review to positive_review.


---

Comment by cremona created at 2013-05-24 09:46:34

Replying to [comment:12 chapoton]:
> ok, then positive review.

Seconded -- thanks for the explanation.   I think it is better to have that written on this ticket, though I know I could have worked that out for myself, if it had not been the week of exam marking for me...


---

Comment by jdemeyer created at 2013-05-29 06:51:35

Resolution: fixed


---

Comment by cremona created at 2013-06-17 08:49:01

Too late for this ticket, but unfortunately a typo causes this:

```
EllipticCurve([0, 0, 0, -1129345880,-86028258620304]).galois_representation().image_type(11)
```

gives

```
NameError: global name 'nonsplit_str' is not defined
```

because the identifier non_split_str is referred to wrongly on lines 1054 and 1108 in gal_reps.py.  I have another patch which I will put onto a new ticket: #14752.
