# Issue 15614: fix unhandled segfault in Coin backend

Issue created by migration from Trac.

Original creator: dimpase

Original creation time: 2014-02-23 15:47:33

Coin does not properly initialise variables before solving,
leading to get_variables() segfaulting if it is called before
solving. The fix is to check that the pointer returned is not
NULL.


---

Comment by ppurka created at 2014-02-23 16:00:25

Changing component from PLEASE CHANGE to linear programming.


---

Comment by ppurka created at 2014-02-23 16:00:25

Following code should fix it

```diff
diff --git a/src/sage/numerical/backends/coin_backend.pyx b/src/sage/numerical/backends/coin_backend.pyx
index 4083c79..96e47d3 100644
--- a/src/sage/numerical/backends/coin_backend.pyx
+++ b/src/sage/numerical/backends/coin_backend.pyx
`@``@` -826,7 +826,10 `@``@` cdef class CoinBackend(GenericBackend):
 
         cdef double * solution
         solution = <double*> self.model.solver().getColSolution()
-        return solution[variable]
+        if solution:
+            return solution[variable]
+        else:
+            return []
 
     cpdef int ncols(self):
         r"""
```



---

Comment by dimpase created at 2014-02-23 16:21:47

Changing status from new to needs_review.


---

Comment by dimpase created at 2014-02-23 16:21:47

New commits:


---

Comment by ppurka created at 2014-02-23 16:33:02

Perhaps we should return `None` instead of 0.0?


---

Comment by dimpase created at 2014-02-23 16:45:13

Replying to [comment:4 ppurka]:
> Perhaps we should return `None` instead of 0.0?

other backends return 0, and IMHO it's nice to have this consistent...


---

Comment by ppurka created at 2014-02-24 06:39:17

Why don't you directly do a `return 0.0`?


---

Comment by dimpase created at 2014-02-24 08:14:57

Replying to [comment:6 ppurka]:
> Why don't you directly do a `return 0.0`?

I would like to control the type of returned value in Cython. I guess 0.0 might be float
rather than double. I suppose making it return the same type always is a good idea, allowing
for faster compiled code.


---

Comment by ppurka created at 2014-02-24 08:29:35

Oh, I see. It could be float by default.

Then it looks good to me.


---

Comment by ppurka created at 2014-02-24 08:29:35

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-02-27 21:28:48

Resolution: fixed
