# Issue 23528: Connected filtered Hopf algebras have a default antipode

Issue created by migration from https://trac.sagemath.org/ticket/23765

Original creator: tscrim

Original creation time: 2017-08-31 14:47:23

CC:  sage-combinat darij chapoton

Keywords: Hopf algebras

We move it up from the connected graded Hopf algebras.


---

Comment by tscrim created at 2017-08-31 14:48:04

Changing status from new to needs_review.


---

Comment by git created at 2017-08-31 14:48:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-08-31 14:50:53

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by darij created at 2017-08-31 16:09:51

What do you require of the basis? If the basis is just required to play well with the filtration, then `counit_on_basis` is wrong since any basis element of any degree might have a nonzero counit.

EDIT: Similarly, `antipode_on_basis` also assumes that any nontrivial basis element has zero counit (in this case, it's fine). This shouldn't be hard to fix.


---

Comment by tscrim created at 2017-08-31 17:13:18

Each basis element should be contained in a homogeneous degree component (i.e. A<sub>i</sub> - A,,i - 1,,). Other than that, I don't think there is any requirements.


---

Comment by darij created at 2017-09-01 11:45:09

I can't ssh to UMN now, and I have uninstalled my virtualbox from this laptop already (planning to get a new one when I'm back to Minneapolis). Meanwhile, can you please do the following?

1. Remove the `counit_on_basis` method. Or, if you feel like making things more interesting, keep it in, but only if a keyword argument `augmented_basis` has been set to `True` when instantiating the class. ("Augmented basis" means that the basis has the property that only the element 1 has nonzero counit.)

2. In `antipode_on_basis`, replace

```
+                return -x__S_Id(self.monomial(index).coproduct()
+                                - tensor([self.monomial(index), self.one()])
+                               )
```

by

```
+                smi = self.monomial(index)
+                return -x__S_Id(smi.coproduct()
+                                - tensor([smi, self.one()])
+                               ) + smi.counit()
```


3. Bonus: Those weird non-graded bases of Sym corresponding to the symplectic(?) groups should now properly work without hacks...


---

Comment by tscrim created at 2017-09-01 14:51:09

Replying to [comment:6 darij]:
> I can't ssh to UMN now, and I have uninstalled my virtualbox from this laptop already (planning to get a new one when I'm back to Minneapolis). Meanwhile, can you please do the following?

Sure, I will push the changes.

> 1. Remove the `counit_on_basis` method. Or, if you feel like making things more interesting, keep it in, but only if a keyword argument `augmented_basis` has been set to `True` when instantiating the class. ("Augmented basis" means that the basis has the property that only the element 1 has nonzero counit.)

Question before I do that: This would not be correct in general in the graded case as well, right?


---

Comment by darij created at 2017-09-01 14:54:32

Oops, I've just realized that a graded basis of a connected graded module as we define it is *automatically* augmented. So the stuff you removed from the Graded().Category() class should probably go back.

BUT a graded module can have a filtered basis that is not graded and not augmented. (Stable dual Grothendieck polynomials for Sym are an example of a filtered basis that is not graded, but augmented. One of your symplectic bases, I think, is neither.) I am wondering whether we have the tools for this. Ideally, it should be in the category

```
HopfAlgebras().Filtered().Connected().WithBasis()
```

and in the category

```
HopfAlgebras().Graded().Connected()
```

but NOT in the category

```
HopfAlgebras().Graded().Connected().WithBasis()
```

I never understood the category framework well enough to tell if this works natively.


---

Comment by git created at 2017-09-01 15:18:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-09-01 15:23:05

Done all related to this ticket.

If you do

```
HopfAlgebras(QQ).Graded().WithBasis()
```

you are saying the Hopf algebra is graded, but your basis does not necessarily respect that grading, in contrast with

```
HopfAlgebras(QQ).WithBasis().Graded()
```

where you are specifying the basis is graded. You can see the difference here:

```
sage: HopfAlgebras(QQ).Graded().WithBasis()
Join of Category of hopf algebras with basis over Rational Field and Category of graded algebras over Rational Field
sage: type(HopfAlgebras(QQ).Graded().WithBasis())
<class 'sage.categories.category.JoinCategory_with_category'>
sage: HopfAlgebras(QQ).WithBasis().Graded()
Category of graded hopf algebras with basis over Rational Field
sage: type(HopfAlgebras(QQ).WithBasis().Graded())
<class 'sage.categories.graded_hopf_algebras_with_basis.GradedHopfAlgebrasWithBasis_with_category'>
```

However, the Sym issue is a separate ticket IMO.


---

Comment by git created at 2017-09-02 15:23:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-09-16 14:43:24

*ping*


---

Comment by git created at 2017-09-16 15:01:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2017-09-16 15:03:13

Just got my Sage running again yesterday, now compiling some months worth of updates; so this will take a while. Should be done today though.

Quick question: Why is `HopfAlgebrasWithBasis` not a parent category of this? Would this lead to the incorrect conclusion that `FilteredHopfAlgebrasWithBasis == HopfAlgebras.Filtered.WithBasis`?


---

Comment by git created at 2017-09-16 15:15:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-09-16 15:18:08

Replying to [comment:14 darij]:
> Just got my Sage running again yesterday, now compiling some months worth of updates; so this will take a while. Should be done today though.

Yay.

> Quick question: Why is `HopfAlgebrasWithBasis` not a parent category of this? Would this lead to the incorrect conclusion that `FilteredHopfAlgebrasWithBasis == HopfAlgebras.Filtered.WithBasis`?

I don't understand. We have this:

```
sage: from sage.categories.filtered_hopf_algebras_with_basis import FilteredHopfAlgebrasWithBasis
sage: FilteredHopfAlgebrasWithBasis(QQ).super_categories()
[Category of hopf algebras with basis over Rational Field,
 Category of filtered algebras with basis over Rational Field]
```


I also removed your requirements as this is a subcategory of `FilteredModulesWithBasis`, so it has to respect them.


---

Comment by darij created at 2017-09-16 15:29:26

Oh, I should learn reading.

I wouldn't get rid of the requirements, though. Maybe replace them by something like this:

```
    A filtered Hopf algebra with basis over a commutative ring `R`
    is a filtered Hopf algebra over `R` endowed with the structure
    of a filtered module with basis (with the same underlying
    filtered-module structure).
    A filtered Hopf algebra over `R` means a Hopf algebra equipped
    with a module filtration such that all structure maps of the
    Hopf algebra respect the filtration. See
    :class:`~sage.categories.filtered_modules_with_basis.FilteredModulesWithBasis`
    for the notion of a filtered module.
```

(Something similar is done in `filtered_algebras_with_basis.py`.)


---

Comment by git created at 2017-09-16 16:21:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-09-16 16:24:36

I can live with that (although it feels a little verbose and superfluous).


---

Comment by git created at 2017-09-16 18:15:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2017-09-16 18:16:15

Yeah, that was an awkward formulation. Let me know if the new one is better. Positive_review if you are OK with my changes.

Sorry for how long this took!

(Rationale for my other changes: Theoretically, a basis of a connected graded Hopf algebra might contain, say, -1 instead of 1. Thus, the claim that the counit of $i$ is "1 & \hbox{if $i$ is the unique element of degree $0$}" is false. Also, the recursive formula for S(x) in the graded case was not true for degree 0, so I replaced "in general" by "when `|x| > 0`".)


---

Comment by tscrim created at 2017-09-16 18:27:21

I know this is basically bikeshedding, but I do not want the word "requirement" to appear. It feels too much like exposing implementation details (or maybe instructions to [future] authors) to the casual user. So could you revert this part:

```diff
-    for the notion of a filtered module.
+    for the meaning of the latter requirement).
```

(with adding the `)` of course). You can set a positive review on my behalf when done.

Thank you for doing the review.


---

Comment by git created at 2017-09-16 18:43:43

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2017-09-16 18:44:05

Changing status from needs_review to positive_review.


---

Comment by darij created at 2017-09-16 18:44:05

Perfect! (I've added "with basis", though, as I had forgotten it.)


---

Comment by vbraun created at 2017-09-20 22:26:38

Resolution: fixed
