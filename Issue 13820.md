# Issue 13820: More IPython 0.13 fixes

archive/issues_013820.json:
```json
{
    "body": "Assignee: tbd\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/14024\n\n",
    "created_at": "2013-01-28T11:12:05Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.7",
    "title": "More IPython 0.13 fixes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13820",
    "user": "https://github.com/vbraun"
}
```
Assignee: tbd



Issue created by migration from https://trac.sagemath.org/ticket/14024





---

archive/issue_comments_171555.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2013-01-28T11:16:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13820#issuecomment-171555",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_171556.json:
```json
{
    "body": "Another problem happens with upgrading.  On `rosemary` (RHEL 5.6 x86_64), the scripts in `local/bin` aren't properly installed.  In particular `local/bin/ipython` isn't copied and the pre-upgrade `local/bin/ipython` doesn't work.  Full log: [http://build.sagemath.org/sage/builders/UGA%20rosemary%20%28RHEL%205.6%20x86_64%29%20up%26nbsp%3B4.5.2/builds/53/steps/shell_7/logs/ipython](http://build.sagemath.org/sage/builders/UGA%20rosemary%20%28RHEL%205.6%20x86_64%29%20up%26nbsp%3B4.5.2/builds/53/steps/shell_7/logs/ipython)\n\nBut note this part:\n\n```\nrunning install_scripts\ncopying build/scripts-2.7/iplogger -> /home/buildbot/build/sage/rosemary-1/rosemary_upgrade_4.5.2/build/sage-5.7.beta1/local/bin\n```\n\nwhich normally looks like\n\n```\nrunning install_scripts\ncopying build/scripts-2.7/ipengine -> /release/buildbot/sage/sage-1/sage_upgrade_4.8/build/sage-5.7.beta1/local/bin\ncopying build/scripts-2.7/ipcontroller -> /release/buildbot/sage/sage-1/sage_upgrade_4.8/build/sage-5.7.beta1/local/bin\ncopying build/scripts-2.7/ipcluster -> /release/buildbot/sage/sage-1/sage_upgrade_4.8/build/sage-5.7.beta1/local/bin\ncopying build/scripts-2.7/iplogger -> /release/buildbot/sage/sage-1/sage_upgrade_4.8/build/sage-5.7.beta1/local/bin\ncopying build/scripts-2.7/ipython -> /release/buildbot/sage/sage-1/sage_upgrade_4.8/build/sage-5.7.beta1/local/bin\ncopying build/scripts-2.7/pycolor -> /release/buildbot/sage/sage-1/sage_upgrade_4.8/build/sage-5.7.beta1/local/bin\ncopying build/scripts-2.7/irunner -> /release/buildbot/sage/sage-1/sage_upgrade_4.8/build/sage-5.7.beta1/local/bin\ncopying build/scripts-2.7/iptest -> /release/buildbot/sage/sage-1/sage_upgrade_4.8/build/sage-5.7.beta1/local/bin\n```\n\n\nEDIT: I initially though this was because of #14026 but thinking further, it was probably #14027.",
    "created_at": "2013-01-28T11:43:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13820#issuecomment-171556",
    "user": "https://github.com/jdemeyer"
}
```

Another problem happens with upgrading.  On `rosemary` (RHEL 5.6 x86_64), the scripts in `local/bin` aren't properly installed.  In particular `local/bin/ipython` isn't copied and the pre-upgrade `local/bin/ipython` doesn't work.  Full log: [http://build.sagemath.org/sage/builders/UGA%20rosemary%20%28RHEL%205.6%20x86_64%29%20up%26nbsp%3B4.5.2/builds/53/steps/shell_7/logs/ipython](http://build.sagemath.org/sage/builders/UGA%20rosemary%20%28RHEL%205.6%20x86_64%29%20up%26nbsp%3B4.5.2/builds/53/steps/shell_7/logs/ipython)

But note this part:

```
running install_scripts
copying build/scripts-2.7/iplogger -> /home/buildbot/build/sage/rosemary-1/rosemary_upgrade_4.5.2/build/sage-5.7.beta1/local/bin
```

which normally looks like

```
running install_scripts
copying build/scripts-2.7/ipengine -> /release/buildbot/sage/sage-1/sage_upgrade_4.8/build/sage-5.7.beta1/local/bin
copying build/scripts-2.7/ipcontroller -> /release/buildbot/sage/sage-1/sage_upgrade_4.8/build/sage-5.7.beta1/local/bin
copying build/scripts-2.7/ipcluster -> /release/buildbot/sage/sage-1/sage_upgrade_4.8/build/sage-5.7.beta1/local/bin
copying build/scripts-2.7/iplogger -> /release/buildbot/sage/sage-1/sage_upgrade_4.8/build/sage-5.7.beta1/local/bin
copying build/scripts-2.7/ipython -> /release/buildbot/sage/sage-1/sage_upgrade_4.8/build/sage-5.7.beta1/local/bin
copying build/scripts-2.7/pycolor -> /release/buildbot/sage/sage-1/sage_upgrade_4.8/build/sage-5.7.beta1/local/bin
copying build/scripts-2.7/irunner -> /release/buildbot/sage/sage-1/sage_upgrade_4.8/build/sage-5.7.beta1/local/bin
copying build/scripts-2.7/iptest -> /release/buildbot/sage/sage-1/sage_upgrade_4.8/build/sage-5.7.beta1/local/bin
```


EDIT: I initially though this was because of #14026 but thinking further, it was probably #14027.



---

archive/issue_comments_171557.json:
```json
{
    "body": "Attachment [trac_14024_branches.patch](tarball://root/attachments/some-uuid/ticket14024/trac_14024_branches.patch) by @vbraun created at 2013-01-28 15:17:05\n\nInitial patch",
    "created_at": "2013-01-28T15:17:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13820#issuecomment-171557",
    "user": "https://github.com/vbraun"
}
```

Attachment [trac_14024_branches.patch](tarball://root/attachments/some-uuid/ticket14024/trac_14024_branches.patch) by @vbraun created at 2013-01-28 15:17:05

Initial patch



---

archive/issue_comments_171558.json:
```json
{
    "body": "The \"you are on branch X\" message was implementing a third bannering system besides sage-banner and IPython banner, and I removed all of it. We can think about putting it back in after we switch to git.\n\nApply trac_14024_branches.patch",
    "created_at": "2013-01-28T15:20:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13820#issuecomment-171558",
    "user": "https://github.com/vbraun"
}
```

The "you are on branch X" message was implementing a third bannering system besides sage-banner and IPython banner, and I removed all of it. We can think about putting it back in after we switch to git.

Apply trac_14024_branches.patch



---

archive/issue_comments_171559.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-01-28T17:45:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13820#issuecomment-171559",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_171560.json:
```json
{
    "body": "Ideally Sage itself should function even if all version control data is stripped from the installation. After we switch to git this might actually become feasible. \"You are on branch X\" is a nice thing to have, but it should fail gracefully. I like this patch though because the \"branches\" referred to by this message are not even used by anyone except the patchbot anymore.\n\nJust testing that the patchbot succeeds in testing sage-0 on arando before I give this positive review.",
    "created_at": "2013-01-28T20:57:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13820#issuecomment-171560",
    "user": "https://github.com/kini"
}
```

Ideally Sage itself should function even if all version control data is stripped from the installation. After we switch to git this might actually become feasible. "You are on branch X" is a nice thing to have, but it should fail gracefully. I like this patch though because the "branches" referred to by this message are not even used by anyone except the patchbot anymore.

Just testing that the patchbot succeeds in testing sage-0 on arando before I give this positive review.



---

archive/issue_comments_171561.json:
```json
{
    "body": "Works fine.",
    "created_at": "2013-01-28T21:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13820#issuecomment-171561",
    "user": "https://github.com/kini"
}
```

Works fine.



---

archive/issue_comments_171562.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-01-28T21:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13820#issuecomment-171562",
    "user": "https://github.com/kini"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_039445.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-30T07:36:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13820",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13820#event-39445"
}
```



---

archive/issue_comments_171563.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-01-30T07:36:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13820#issuecomment-171563",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
