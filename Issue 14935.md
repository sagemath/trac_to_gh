# Issue 14935: update 4ti2 to version 1.6

archive/issues_014935.json:
```json
{
    "body": "CC:  novoselt mmarco dperkinson mhampton\n\nKeywords: 4ti2\n\nversion 1.6 is [released](http://4ti2.de).\n\nThe updated [spkg http://boxen.math.washington.edu/home/dima/packages/4ti2-1.6.spkg]\n\nIssue created by migration from https://trac.sagemath.org/ticket/15172\n\n",
    "created_at": "2013-09-07T13:25:11Z",
    "labels": [
        "packages: optional",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.13",
    "title": "update 4ti2 to version 1.6",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14935",
    "user": "dimpase"
}
```
CC:  novoselt mmarco dperkinson mhampton

Keywords: 4ti2

version 1.6 is [released](http://4ti2.de).

The updated [spkg http://boxen.math.washington.edu/home/dima/packages/4ti2-1.6.spkg]

Issue created by migration from https://trac.sagemath.org/ticket/15172





---

archive/issue_comments_190754.json:
```json
{
    "body": "at the moment there is one test failure, which only occurs from `sage -t` run, but I can't reproduce it interactively:\n\n```\n$ ../../sage -t --optional='sage,4ti2' sage/interfaces/four_ti_2.py\nRunning doctests with ID 2013-09-07-09-09-54-b455bb50.\nDoctesting 1 file.\nsage -t sage/interfaces/four_ti_2.py\n**********************************************************************\nFile \"sage/interfaces/four_ti_2.py\", line 284, in sage.interfaces.four_ti_2.FourTi2.call\nFailed example:\n    four_ti_2.read_matrix(\"test_file.gro\") # optional - 4ti2\nExpected:\n    [-5  0  2]\n    [-5  3  0]\nGot:\n    []\n**********************************************************************\n1 item had failures:\n   1 of   5 in sage.interfaces.four_ti_2.FourTi2.call\n    [50 tests, 1 failure, 0.55 s]\n----------------------------------------------------------------------\nsage -t sage/interfaces/four_ti_2.py  # 1 doctest failed\n```\n",
    "created_at": "2013-09-07T13:31:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14935#issuecomment-190754",
    "user": "dimpase"
}
```

at the moment there is one test failure, which only occurs from `sage -t` run, but I can't reproduce it interactively:

```
$ ../../sage -t --optional='sage,4ti2' sage/interfaces/four_ti_2.py
Running doctests with ID 2013-09-07-09-09-54-b455bb50.
Doctesting 1 file.
sage -t sage/interfaces/four_ti_2.py
**********************************************************************
File "sage/interfaces/four_ti_2.py", line 284, in sage.interfaces.four_ti_2.FourTi2.call
Failed example:
    four_ti_2.read_matrix("test_file.gro") # optional - 4ti2
Expected:
    [-5  0  2]
    [-5  3  0]
Got:
    []
**********************************************************************
1 item had failures:
   1 of   5 in sage.interfaces.four_ti_2.FourTi2.call
    [50 tests, 1 failure, 0.55 s]
----------------------------------------------------------------------
sage -t sage/interfaces/four_ti_2.py  # 1 doctest failed
```




---

archive/issue_comments_190755.json:
```json
{
    "body": "Changing type from defect to enhancement.",
    "created_at": "2013-09-07T13:31:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14935#issuecomment-190755",
    "user": "dimpase"
}
```

Changing type from defect to enhancement.



---

archive/issue_comments_190756.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2013-09-07T13:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14935#issuecomment-190756",
    "user": "dimpase"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_190757.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2013-09-07T13:35:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14935#issuecomment-190757",
    "user": "dimpase"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_190758.json:
```json
{
    "body": "Why add `# optional - 4ti2` where it was not needed before?",
    "created_at": "2013-09-07T14:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14935#issuecomment-190758",
    "user": "jdemeyer"
}
```

Why add `# optional - 4ti2` where it was not needed before?



---

archive/issue_comments_190759.json:
```json
{
    "body": "The following\n\n```\n        cwd = os.getcwd() # Save working directory in order to restore it.\n        os.chdir(self.directory())\n\n        subprocess.call(cmd, shell=True)\n\n        os.chdir(cwd) # Restore previous working directory.\n```\n\nshould be replaced by\n\n```\n        subprocess.call(cmd, shell=True, cwd=self.directory())\n```\n",
    "created_at": "2013-09-07T14:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14935#issuecomment-190759",
    "user": "jdemeyer"
}
```

The following

```
        cwd = os.getcwd() # Save working directory in order to restore it.
        os.chdir(self.directory())

        subprocess.call(cmd, shell=True)

        os.chdir(cwd) # Restore previous working directory.
```

should be replaced by

```
        subprocess.call(cmd, shell=True, cwd=self.directory())
```




---

archive/issue_comments_190760.json:
```json
{
    "body": "As I understand in the patch \"-q\" is for quiet mode, but why there is a need to silence stderr explicitly? Shouldn't commands output no errors if used correctly?",
    "created_at": "2013-09-07T15:33:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14935#issuecomment-190760",
    "user": "novoselt"
}
```

As I understand in the patch "-q" is for quiet mode, but why there is a need to silence stderr explicitly? Shouldn't commands output no errors if used correctly?



---

archive/issue_comments_190761.json:
```json
{
    "body": "Replying to [comment:6 novoselt]:\n> As I understand in the patch \"-q\" is for quiet mode, but why there is a need to silence stderr explicitly? Shouldn't commands output no errors if used correctly?\n\nthere is no '-q' switch for `ppi`, for some reason. So its stderr output needs to be silenced.",
    "created_at": "2013-09-07T17:18:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14935#issuecomment-190761",
    "user": "dimpase"
}
```

Replying to [comment:6 novoselt]:
> As I understand in the patch "-q" is for quiet mode, but why there is a need to silence stderr explicitly? Shouldn't commands output no errors if used correctly?

there is no '-q' switch for `ppi`, for some reason. So its stderr output needs to be silenced.



---

archive/issue_comments_190762.json:
```json
{
    "body": "Replying to [comment:5 jdemeyer]:\n\nDo you mean it's an equivalent way to do the same thing?\n\nOK, I'll change this. Meanwhile I just uploaded patch which fixes the issue that was stopping me here; it's actually due to filename semantics changed. Now `groebner bla.foo` appends the suffix `gro` to `bla.foo`, rather than replacing the suffix.",
    "created_at": "2013-09-07T17:23:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14935#issuecomment-190762",
    "user": "dimpase"
}
```

Replying to [comment:5 jdemeyer]:

Do you mean it's an equivalent way to do the same thing?

OK, I'll change this. Meanwhile I just uploaded patch which fixes the issue that was stopping me here; it's actually due to filename semantics changed. Now `groebner bla.foo` appends the suffix `gro` to `bla.foo`, rather than replacing the suffix.



---

archive/issue_comments_190763.json:
```json
{
    "body": "Attachment [42.patch](tarball://root/attachments/some-uuid/ticket15172/42.patch) by dimpase created at 2013-09-07 17:45:20\n\nupdated patch",
    "created_at": "2013-09-07T17:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14935#issuecomment-190763",
    "user": "dimpase"
}
```

Attachment [42.patch](tarball://root/attachments/some-uuid/ticket15172/42.patch) by dimpase created at 2013-09-07 17:45:20

updated patch



---

archive/issue_comments_190764.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-09-07T17:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14935#issuecomment-190764",
    "user": "dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_190765.json:
```json
{
    "body": "OK, it looks as if I fixed everything.",
    "created_at": "2013-09-07T17:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14935#issuecomment-190765",
    "user": "dimpase"
}
```

OK, it looks as if I fixed everything.



---

archive/issue_comments_190766.json:
```json
{
    "body": "There are quite a few changes in the `4ti2`-dependent part of `sandpile.py`, due to a change in output format of zslove, which prints matrix dimensions on one row now, and changed order in its output. Also, I needed to take care of deprecated `vertex_set` in `SimplicialComplex`.",
    "created_at": "2013-09-07T17:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14935#issuecomment-190766",
    "user": "dimpase"
}
```

There are quite a few changes in the `4ti2`-dependent part of `sandpile.py`, due to a change in output format of zslove, which prints matrix dimensions on one row now, and changed order in its output. Also, I needed to take care of deprecated `vertex_set` in `SimplicialComplex`.



---

archive/issue_comments_190767.json:
```json
{
    "body": "Replying to [comment:8 dimpase]:\n> Replying to [comment:5 jdemeyer]:\n> \n> Do you mean it's an equivalent way to do the same thing?\nEssentially yes. Instead of changing directory globally and then changing it back, we simply change directory for the executed command.",
    "created_at": "2013-09-07T22:14:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14935#issuecomment-190767",
    "user": "jdemeyer"
}
```

Replying to [comment:8 dimpase]:
> Replying to [comment:5 jdemeyer]:
> 
> Do you mean it's an equivalent way to do the same thing?
Essentially yes. Instead of changing directory globally and then changing it back, we simply change directory for the executed command.



---

archive/issue_comments_190768.json:
```json
{
    "body": "I've made a small change in spkg-install. Now everything, not only executables, is installed, so  that one can link against 4ti2's libraries.",
    "created_at": "2013-09-09T02:12:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14935#issuecomment-190768",
    "user": "dimpase"
}
```

I've made a small change in spkg-install. Now everything, not only executables, is installed, so  that one can link against 4ti2's libraries.



---

archive/issue_comments_190769.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-10-06T17:06:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14935#issuecomment-190769",
    "user": "vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_190770.json:
```json
{
    "body": "Looks good to me.",
    "created_at": "2013-10-06T17:06:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14935#issuecomment-190770",
    "user": "vbraun"
}
```

Looks good to me.



---

archive/issue_comments_190771.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-10-12T17:06:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14935",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14935#issuecomment-190771",
    "user": "jdemeyer"
}
```

Resolution: fixed
