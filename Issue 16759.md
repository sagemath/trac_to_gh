# Issue 16759: IPython notebook with Sage Extensions

archive/issues_016759.json:
```json
{
    "body": "CC:  @jondo @videlec\n\nMake the IPython html-based notebook work just like the sage command line.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16996\n\n",
    "created_at": "2014-09-16T23:14:50Z",
    "labels": [
        "component: interfaces"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "IPython notebook with Sage Extensions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16759",
    "user": "https://github.com/vbraun"
}
```
CC:  @jondo @videlec

Make the IPython html-based notebook work just like the sage command line.

Issue created by migration from https://trac.sagemath.org/ticket/16996





---

archive/issue_comments_221241.json:
```json
{
    "body": "The first commit containts the anything-text-mode integration. Graphics still launches in a separate graphics viewer process.\n----\nNew commits:",
    "created_at": "2014-09-16T23:16:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221241",
    "user": "https://github.com/vbraun"
}
```

The first commit containts the anything-text-mode integration. Graphics still launches in a separate graphics viewer process.
----
New commits:



---

archive/issue_comments_221242.json:
```json
{
    "body": "Picture at https://plus.google.com/113188225509686176367/posts/MCdWKxYyryH",
    "created_at": "2014-09-16T23:25:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221242",
    "user": "https://github.com/vbraun"
}
```

Picture at https://plus.google.com/113188225509686176367/posts/MCdWKxYyryH



---

archive/issue_comments_221243.json:
```json
{
    "body": "Aww, but *sage -ipynb* seems so cute.  After all, it's the Ipython notebook, not the Notebook Ipython.  Maybe both?",
    "created_at": "2014-09-19T02:37:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221243",
    "user": "https://github.com/kcrisman"
}
```

Aww, but *sage -ipynb* seems so cute.  After all, it's the Ipython notebook, not the Notebook Ipython.  Maybe both?



---

archive/issue_comments_221244.json:
```json
{
    "body": "Its cute. I also wanted to call the Parent object that owns the Singular ring \"Frodo\". Sometimes, you have to resist being cute ;-)\n\nSince there is bound to be more than one notebook, I think its best to go with `sage --notebook-foo` or `--notebook=foo`. With just `sage --notebook` being some suitable default.",
    "created_at": "2014-09-19T13:05:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221244",
    "user": "https://github.com/vbraun"
}
```

Its cute. I also wanted to call the Parent object that owns the Singular ring "Frodo". Sometimes, you have to resist being cute ;-)

Since there is bound to be more than one notebook, I think its best to go with `sage --notebook-foo` or `--notebook=foo`. With just `sage --notebook` being some suitable default.



---

archive/issue_comments_221245.json:
```json
{
    "body": "Such as `sage --notebook-cloud`, for example.\n\nWell, it might still be good to make it more easily discoverable with an alias or something, just because of the English syntax order.",
    "created_at": "2014-09-19T13:13:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221245",
    "user": "https://github.com/kcrisman"
}
```

Such as `sage --notebook-cloud`, for example.

Well, it might still be good to make it more easily discoverable with an alias or something, just because of the English syntax order.



---

archive/issue_comments_221246.json:
```json
{
    "body": "Also, you can lanuch the plain IPython notebook with `sage -ipython notebook`. The commandline switch for the Sage-enhanced IPython notebook should have more than one character difference ;-)",
    "created_at": "2014-09-20T16:08:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221246",
    "user": "https://github.com/vbraun"
}
```

Also, you can lanuch the plain IPython notebook with `sage -ipython notebook`. The commandline switch for the Sage-enhanced IPython notebook should have more than one character difference ;-)



---

archive/issue_comments_221247.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2014-09-20T17:19:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221247",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_221248.json:
```json
{
    "body": "2d graphics works, 3d graphics will be displayed as 2d render. IMHO this is good enough for a first stab at it.\n\nI've extended the magic `_graphics_()` method hook that we already had in Sage so that you can specify a list of file formats that are acceptable as output. The `_graphics_()` hook then can pick the best choice amongst these possibilities. This works fine for the problem of finding a suitable graphics file format.\n\nThe same idea should be extended to text/html/latex output as well. The user specifies which formats he wants (or his frontend can display), and Sage then picks the best representation. I'll work on refactoring the `_graphics_()` hook into a more general solution (probably called `_repr_rich()`) on a followup ticket. Once we have this it would be easy to make html/tex output work in a configurable way.",
    "created_at": "2014-09-20T17:26:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221248",
    "user": "https://github.com/vbraun"
}
```

2d graphics works, 3d graphics will be displayed as 2d render. IMHO this is good enough for a first stab at it.

I've extended the magic `_graphics_()` method hook that we already had in Sage so that you can specify a list of file formats that are acceptable as output. The `_graphics_()` hook then can pick the best choice amongst these possibilities. This works fine for the problem of finding a suitable graphics file format.

The same idea should be extended to text/html/latex output as well. The user specifies which formats he wants (or his frontend can display), and Sage then picks the best representation. I'll work on refactoring the `_graphics_()` hook into a more general solution (probably called `_repr_rich()`) on a followup ticket. Once we have this it would be easy to make html/tex output work in a configurable way.



---

archive/issue_comments_221249.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-09-20T17:26:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221249",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_221250.json:
```json
{
    "body": "Replying to [comment:11 vbraun]:\n> 2d graphics works, 3d graphics will be displayed as 2d render. IMHO this is good enough for a first stab at it.\n> \n> I've extended the magic `_graphics_()` method hook that we already had in Sage so that you can specify a list of file formats that are acceptable as output. The `_graphics_()` hook then can pick the best choice amongst these possibilities. This works fine for the problem of finding a suitable graphics file format.\n> \n> The same idea should be extended to text/html/latex output as well. The user specifies which formats he wants (or his frontend can display), and Sage then picks the best representation. I'll work on refactoring the `_graphics_()` hook into a more general solution (probably called `_repr_rich()`) on a followup ticket. Once we have this it would be easy to make html/tex output work in a configurable way.\n\nI'm glad you're working on this, since I've been meaning to do something like this for Sage for a long time, since it is needed for `SageMathCloud`.   Unfortunately, I'm concerned that this approach will cause me more trouble than help, at least for me.  With `SageMathCloud` I have to customize all of the outputs you mention above, and I think the above approach (and what you've implemented in this patch), does not provide a way for me to do it.  I would have to directly edit the source code of Sage, which I don't want to do (since it breaks people's custom installs).    Right now, SMC monkey patches *all* of the show methods, except for 3d graphics, which can't be monkey patched, due to being in Cython.    The idea that \"show\" can be implemented by saving to a file format, then calling some other function is insufficient, since in some cases one wants to query an object in various ways as part of show.  What is really needed is a hook so that users can *replace* the show method altogether at runtime if they want. \n\nSo if you can do all of the above, but *also* provide a hook for replacing every show method by one of the user's choosing, especially supporting 3d graphics which can't be monkey patched, then I'm on board.",
    "created_at": "2014-09-29T17:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221250",
    "user": "https://github.com/williamstein"
}
```

Replying to [comment:11 vbraun]:
> 2d graphics works, 3d graphics will be displayed as 2d render. IMHO this is good enough for a first stab at it.
> 
> I've extended the magic `_graphics_()` method hook that we already had in Sage so that you can specify a list of file formats that are acceptable as output. The `_graphics_()` hook then can pick the best choice amongst these possibilities. This works fine for the problem of finding a suitable graphics file format.
> 
> The same idea should be extended to text/html/latex output as well. The user specifies which formats he wants (or his frontend can display), and Sage then picks the best representation. I'll work on refactoring the `_graphics_()` hook into a more general solution (probably called `_repr_rich()`) on a followup ticket. Once we have this it would be easy to make html/tex output work in a configurable way.

I'm glad you're working on this, since I've been meaning to do something like this for Sage for a long time, since it is needed for `SageMathCloud`.   Unfortunately, I'm concerned that this approach will cause me more trouble than help, at least for me.  With `SageMathCloud` I have to customize all of the outputs you mention above, and I think the above approach (and what you've implemented in this patch), does not provide a way for me to do it.  I would have to directly edit the source code of Sage, which I don't want to do (since it breaks people's custom installs).    Right now, SMC monkey patches *all* of the show methods, except for 3d graphics, which can't be monkey patched, due to being in Cython.    The idea that "show" can be implemented by saving to a file format, then calling some other function is insufficient, since in some cases one wants to query an object in various ways as part of show.  What is really needed is a hook so that users can *replace* the show method altogether at runtime if they want. 

So if you can do all of the above, but *also* provide a hook for replacing every show method by one of the user's choosing, especially supporting 3d graphics which can't be monkey patched, then I'm on board.



---

archive/issue_comments_221251.json:
```json
{
    "body": "Monkey patching stuff left and right isn't going to be maintainable in the long run anyways, so sooner or later you'll have to implement a proper solution. And that means a compute kernel starting with a custom displayhook or piggy-backing on the Sage-IPython ZMQ kernel. I can't see the SMC code so I can't really help with that, but I do intend to write the necessary framework to make implementing the displayhook easy. And powerful enough to include graphics, latex, and html output if desired.",
    "created_at": "2014-09-29T19:45:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221251",
    "user": "https://github.com/vbraun"
}
```

Monkey patching stuff left and right isn't going to be maintainable in the long run anyways, so sooner or later you'll have to implement a proper solution. And that means a compute kernel starting with a custom displayhook or piggy-backing on the Sage-IPython ZMQ kernel. I can't see the SMC code so I can't really help with that, but I do intend to write the necessary framework to make implementing the displayhook easy. And powerful enough to include graphics, latex, and html output if desired.



---

archive/issue_comments_221252.json:
```json
{
    "body": "Replying to [comment:13 vbraun]:\n> Monkey patching stuff left and right isn't going to be maintainable in the long run anyways,\n>  so sooner or later you'll have to implement a proper solution. \n\nIt's actually been very easy to maintain for almost two years now, since Sage's 2d and 3d graphics, etc., are all VERY stable code for the last 3 years.  However, I don't like doing it.  Amusingly, what you're doing now is the first situation that could make it harder.\n\n> And that means a compute kernel starting with a custom displayhook or piggy-backing on the Sage-IPython ZMQ kernel. I can't see the SMC code so I can't really help with that, \n\nAll relevant Python code is BSD or GPL'd licensed.    The latest versions are always the Python files in ~/.sagemathcloud in any SageMathCloud project.  If you want me to post a snapshot somewhere else I can. \n\nSageMathCloud makes absolutely no use of ZMQ or IPython.   However, it uses a custom displayhook.\n\n> but I do intend to write the necessary framework to make implementing the displayhook easy. And powerful enough to include graphics, latex, and html output if desired.\n\nCool -- that's exactly what I want -- I way to make the necessary framework for implementing the displayhook easy, instead of just replacing show methods.\n\nAnyway, I'm thrilled you're working on this, and I hope you'll keep SMC in mind for your design, so that I can rewrite my code to use your framework instead of monkey patching.",
    "created_at": "2014-09-29T20:27:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221252",
    "user": "https://github.com/williamstein"
}
```

Replying to [comment:13 vbraun]:
> Monkey patching stuff left and right isn't going to be maintainable in the long run anyways,
>  so sooner or later you'll have to implement a proper solution. 

It's actually been very easy to maintain for almost two years now, since Sage's 2d and 3d graphics, etc., are all VERY stable code for the last 3 years.  However, I don't like doing it.  Amusingly, what you're doing now is the first situation that could make it harder.

> And that means a compute kernel starting with a custom displayhook or piggy-backing on the Sage-IPython ZMQ kernel. I can't see the SMC code so I can't really help with that, 

All relevant Python code is BSD or GPL'd licensed.    The latest versions are always the Python files in ~/.sagemathcloud in any SageMathCloud project.  If you want me to post a snapshot somewhere else I can. 

SageMathCloud makes absolutely no use of ZMQ or IPython.   However, it uses a custom displayhook.

> but I do intend to write the necessary framework to make implementing the displayhook easy. And powerful enough to include graphics, latex, and html output if desired.

Cool -- that's exactly what I want -- I way to make the necessary framework for implementing the displayhook easy, instead of just replacing show methods.

Anyway, I'm thrilled you're working on this, and I hope you'll keep SMC in mind for your design, so that I can rewrite my code to use your framework instead of monkey patching.



---

archive/issue_comments_221253.json:
```json
{
    "body": "1. [needs work] The `sage -ipython notebook` works OK for me. But the command `sage -notebook-ipy` is broken. There is a tab that opens in the browser but it stays empty. In the command line, it says templates `tree.html` and `error.html` and maybe others are missing :\n\n\n```\n$ sage -notebook-ipy\n2014-09-30 23:29:19.288 [SageNotebookApp] Using existing profile dir: u'/Users/slabbe/.sage/ipython-2.2.0/profile_default'\n2014-09-30 23:29:19.302 [SageNotebookApp] Using MathJax from CDN: https://cdn.mathjax.org/mathjax/latest/MathJax.js\n2014-09-30 23:29:19.345 [SageNotebookApp] Serving notebooks from local directory: /Users/slabbe/.sage/notebooks_ipy\n2014-09-30 23:29:19.345 [SageNotebookApp] 0 active kernels \n2014-09-30 23:29:19.345 [SageNotebookApp] The IPython Notebook is running at: http://localhost:8888/\n2014-09-30 23:29:19.345 [SageNotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).\n2014-09-30 23:29:20.051 [tornado.application] ERROR | Uncaught exception GET /tree (::1)\nHTTPRequest(protocol='http', host='localhost:8888', method='GET', uri='/tree', version='HTTP/1.1', remote_ip='::1', headers={'Connection': 'keep-alive', 'Accept-Language': 'fr-ca,fr;q=0.8,fr-fr;q=0.6,en-us;q=0.4,en;q=0.2', 'Accept-Encoding': 'gzip, deflate', 'If-None-Match': '\"5a5567e3b37b9ccb8e61737610c32e684f6090d4\"', 'Host': 'localhost:8888', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.5; rv:16.0) Gecko/20100101 Firefox/16.0'})\nTraceback (most recent call last):\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/tornado-3.1.1-py2.7.egg/tornado/web.py\", line 1141, in _when_complete\n    callback()\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/tornado-3.1.1-py2.7.egg/tornado/web.py\", line 1162, in _execute_method\n    self._when_complete(method(*self.path_args, **self.path_kwargs),\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/tornado-3.1.1-py2.7.egg/tornado/web.py\", line 2297, in wrapper\n    return method(self, *args, **kwargs)\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/IPython/html/tree/handlers.py\", line 77, in get\n    breadcrumbs=breadcrumbs\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/IPython/html/base/handlers.py\", line 221, in render_template\n    template = self.get_template(name)\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/IPython/html/base/handlers.py\", line 217, in get_template\n    return self.settings['jinja2_env'].get_template(name)\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Jinja2-2.5.5-py2.7.egg/jinja2/environment.py\", line 716, in get_template\n    return self._load_template(name, self.make_globals(globals))\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Jinja2-2.5.5-py2.7.egg/jinja2/environment.py\", line 690, in _load_template\n    template = self.loader.load(self, name, globals)\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Jinja2-2.5.5-py2.7.egg/jinja2/loaders.py\", line 115, in load\n    source, filename, uptodate = self.get_source(environment, name)\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Jinja2-2.5.5-py2.7.egg/jinja2/loaders.py\", line 180, in get_source\n    raise TemplateNotFound(template)\nTemplateNotFound: tree.html\n2014-09-30 23:29:20.060 [tornado.application] ERROR | Uncaught exception in write_error\nTraceback (most recent call last):\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/tornado-3.1.1-py2.7.egg/tornado/web.py\", line 794, in send_error\n    self.write_error(status_code, **kwargs)\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/tornado-3.1.1-py2.7.egg/tornado/web.py\", line 827, in write_error\n    self.finish(self.get_error_html(status_code, **kwargs))\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/IPython/html/base/handlers.py\", line 277, in get_error_html\n    html = self.render_template('error.html', **ns)\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/IPython/html/base/handlers.py\", line 221, in render_template\n    template = self.get_template(name)\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/IPython/html/base/handlers.py\", line 217, in get_template\n    return self.settings['jinja2_env'].get_template(name)\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Jinja2-2.5.5-py2.7.egg/jinja2/environment.py\", line 716, in get_template\n    return self._load_template(name, self.make_globals(globals))\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Jinja2-2.5.5-py2.7.egg/jinja2/environment.py\", line 690, in _load_template\n    template = self.loader.load(self, name, globals)\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Jinja2-2.5.5-py2.7.egg/jinja2/loaders.py\", line 115, in load\n    source, filename, uptodate = self.get_source(environment, name)\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Jinja2-2.5.5-py2.7.egg/jinja2/loaders.py\", line 180, in get_source\n    raise TemplateNotFound(template)\nTemplateNotFound: error.html\n2014-09-30 23:29:20.063 [tornado.access] ERROR | {\n  \"Accept-Language\": \"fr-ca,fr;q=0.8,fr-fr;q=0.6,en-us;q=0.4,en;q=0.2\", \n  \"Accept-Encoding\": \"gzip, deflate\", \n  \"Connection\": \"keep-alive\", \n  \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\", \n  \"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.5; rv:16.0) Gecko/20100101 Firefox/16.0\", \n  \"Host\": \"localhost:8888\", \n  \"If-None-Match\": \"\\\"5a5567e3b37b9ccb8e61737610c32e684f6090d4\\\"\"\n}\n2014-09-30 23:29:20.064 [tornado.access] ERROR | 500 GET /tree (::1) 16.67ms referer=None\n\n```\n\n\n2. [needs info] When using the `sage -ipython notebook` which works for me. The Download as > rst throws me the following error:\n\n\n```\n500 : Internal Server Error\nThe error was: nbconvert failed: template file \"rst\" could not be found\n```\n\n\n3. [suggestion]\u00a0I do like `sage -ipynb`. I do not like `sage -notebook-ipy` because the part `ipy` is not natural. I feel I will need to check the doc of `sage -advanced` each time to confirm the name of the command. If you want the prefix `notebook`, I would rather suggest :\n\n```\nsage -notebook-ipython\n```\n",
    "created_at": "2014-09-30T21:37:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221253",
    "user": "https://github.com/seblabbe"
}
```

1. [needs work] The `sage -ipython notebook` works OK for me. But the command `sage -notebook-ipy` is broken. There is a tab that opens in the browser but it stays empty. In the command line, it says templates `tree.html` and `error.html` and maybe others are missing :


```
$ sage -notebook-ipy
2014-09-30 23:29:19.288 [SageNotebookApp] Using existing profile dir: u'/Users/slabbe/.sage/ipython-2.2.0/profile_default'
2014-09-30 23:29:19.302 [SageNotebookApp] Using MathJax from CDN: https://cdn.mathjax.org/mathjax/latest/MathJax.js
2014-09-30 23:29:19.345 [SageNotebookApp] Serving notebooks from local directory: /Users/slabbe/.sage/notebooks_ipy
2014-09-30 23:29:19.345 [SageNotebookApp] 0 active kernels 
2014-09-30 23:29:19.345 [SageNotebookApp] The IPython Notebook is running at: http://localhost:8888/
2014-09-30 23:29:19.345 [SageNotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
2014-09-30 23:29:20.051 [tornado.application] ERROR | Uncaught exception GET /tree (::1)
HTTPRequest(protocol='http', host='localhost:8888', method='GET', uri='/tree', version='HTTP/1.1', remote_ip='::1', headers={'Connection': 'keep-alive', 'Accept-Language': 'fr-ca,fr;q=0.8,fr-fr;q=0.6,en-us;q=0.4,en;q=0.2', 'Accept-Encoding': 'gzip, deflate', 'If-None-Match': '"5a5567e3b37b9ccb8e61737610c32e684f6090d4"', 'Host': 'localhost:8888', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.5; rv:16.0) Gecko/20100101 Firefox/16.0'})
Traceback (most recent call last):
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/tornado-3.1.1-py2.7.egg/tornado/web.py", line 1141, in _when_complete
    callback()
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/tornado-3.1.1-py2.7.egg/tornado/web.py", line 1162, in _execute_method
    self._when_complete(method(*self.path_args, **self.path_kwargs),
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/tornado-3.1.1-py2.7.egg/tornado/web.py", line 2297, in wrapper
    return method(self, *args, **kwargs)
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/IPython/html/tree/handlers.py", line 77, in get
    breadcrumbs=breadcrumbs
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/IPython/html/base/handlers.py", line 221, in render_template
    template = self.get_template(name)
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/IPython/html/base/handlers.py", line 217, in get_template
    return self.settings['jinja2_env'].get_template(name)
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Jinja2-2.5.5-py2.7.egg/jinja2/environment.py", line 716, in get_template
    return self._load_template(name, self.make_globals(globals))
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Jinja2-2.5.5-py2.7.egg/jinja2/environment.py", line 690, in _load_template
    template = self.loader.load(self, name, globals)
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Jinja2-2.5.5-py2.7.egg/jinja2/loaders.py", line 115, in load
    source, filename, uptodate = self.get_source(environment, name)
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Jinja2-2.5.5-py2.7.egg/jinja2/loaders.py", line 180, in get_source
    raise TemplateNotFound(template)
TemplateNotFound: tree.html
2014-09-30 23:29:20.060 [tornado.application] ERROR | Uncaught exception in write_error
Traceback (most recent call last):
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/tornado-3.1.1-py2.7.egg/tornado/web.py", line 794, in send_error
    self.write_error(status_code, **kwargs)
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/tornado-3.1.1-py2.7.egg/tornado/web.py", line 827, in write_error
    self.finish(self.get_error_html(status_code, **kwargs))
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/IPython/html/base/handlers.py", line 277, in get_error_html
    html = self.render_template('error.html', **ns)
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/IPython/html/base/handlers.py", line 221, in render_template
    template = self.get_template(name)
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/IPython/html/base/handlers.py", line 217, in get_template
    return self.settings['jinja2_env'].get_template(name)
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Jinja2-2.5.5-py2.7.egg/jinja2/environment.py", line 716, in get_template
    return self._load_template(name, self.make_globals(globals))
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Jinja2-2.5.5-py2.7.egg/jinja2/environment.py", line 690, in _load_template
    template = self.loader.load(self, name, globals)
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Jinja2-2.5.5-py2.7.egg/jinja2/loaders.py", line 115, in load
    source, filename, uptodate = self.get_source(environment, name)
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Jinja2-2.5.5-py2.7.egg/jinja2/loaders.py", line 180, in get_source
    raise TemplateNotFound(template)
TemplateNotFound: error.html
2014-09-30 23:29:20.063 [tornado.access] ERROR | {
  "Accept-Language": "fr-ca,fr;q=0.8,fr-fr;q=0.6,en-us;q=0.4,en;q=0.2", 
  "Accept-Encoding": "gzip, deflate", 
  "Connection": "keep-alive", 
  "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8", 
  "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.5; rv:16.0) Gecko/20100101 Firefox/16.0", 
  "Host": "localhost:8888", 
  "If-None-Match": "\"5a5567e3b37b9ccb8e61737610c32e684f6090d4\""
}
2014-09-30 23:29:20.064 [tornado.access] ERROR | 500 GET /tree (::1) 16.67ms referer=None

```


2. [needs info] When using the `sage -ipython notebook` which works for me. The Download as > rst throws me the following error:


```
500 : Internal Server Error
The error was: nbconvert failed: template file "rst" could not be found
```


3. [suggestion] I do like `sage -ipynb`. I do not like `sage -notebook-ipy` because the part `ipy` is not natural. I feel I will need to check the doc of `sage -advanced` each time to confirm the name of the command. If you want the prefix `notebook`, I would rather suggest :

```
sage -notebook-ipython
```




---

archive/issue_comments_221254.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-09-30T21:37:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221254",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_221255.json:
```json
{
    "body": "You need to run \"make\" to install the templates",
    "created_at": "2014-09-30T22:18:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221255",
    "user": "https://github.com/vbraun"
}
```

You need to run "make" to install the templates



---

archive/issue_comments_221256.json:
```json
{
    "body": "You are right. Running \"make\" fixed the problem. I can now open it and continue the review.\n\nI do not know what goes in this ticket and what doesn't. For instance, as of now I believe the description of the ticket as been fulfilled (\"IPython html-based notebook work just like the sage command line\", \"make zeromq and pyzmq standard packages\"). And it could get a positive review.\n\nBut it would be nice if output like images would appear in the notebook as it is suggested in the screeshot. Also, I have some problems viewing the documentation. More precisely,\n\n\n1. Graphics shows just below the cell which is great: `plot(x^2,0,10)` but using `plot(x^2,0,10).show()` opens in an outside window. Is this a bug, or intended?\n\n2. Animate opens in a outside window as well:\n\n\n```\nsage: t = var('t')\nsage: a = animate((cos(c*pi*t) for c in sxrange(1,2,.2)))\nsage: a.show()\n```\n\n\n3. 3d Graphics objects plots shows also below the cell as a Tachyon image and running `.show` opens in a outside window.\n\n4. I saw you added some links in the Help Menu. Unfortunately, I get `404: Not Found` on the six links where one of them is `http://localhost:8888/static/a_tour_of_sage/index.html`.",
    "created_at": "2014-10-01T08:06:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221256",
    "user": "https://github.com/seblabbe"
}
```

You are right. Running "make" fixed the problem. I can now open it and continue the review.

I do not know what goes in this ticket and what doesn't. For instance, as of now I believe the description of the ticket as been fulfilled ("IPython html-based notebook work just like the sage command line", "make zeromq and pyzmq standard packages"). And it could get a positive review.

But it would be nice if output like images would appear in the notebook as it is suggested in the screeshot. Also, I have some problems viewing the documentation. More precisely,


1. Graphics shows just below the cell which is great: `plot(x^2,0,10)` but using `plot(x^2,0,10).show()` opens in an outside window. Is this a bug, or intended?

2. Animate opens in a outside window as well:


```
sage: t = var('t')
sage: a = animate((cos(c*pi*t) for c in sxrange(1,2,.2)))
sage: a.show()
```


3. 3d Graphics objects plots shows also below the cell as a Tachyon image and running `.show` opens in a outside window.

4. I saw you added some links in the Help Menu. Unfortunately, I get `404: Not Found` on the six links where one of them is `http://localhost:8888/static/a_tour_of_sage/index.html`.



---

archive/issue_comments_221257.json:
```json
{
    "body": "At least for now, it is intentional that show() opens external programs. For example that is currently the only way to see jmol 3d.\n\nIn the long run I think show() should just be removed. Really, it only serves two purposes: easier forkbombing `while True: sphere().show()` and functions that show plots while not playing nice with the rest of the graphics infrastructure. The only difference between `def f(): return plot()` and `def f(): plot().show()` is that the latter can't be combined/superimposed with other plots, a user can't change axis options, you can't reasonably call it in your own code, ...\n\nThe other reason is that there is no \"stdout for graphics\", so to my knowledge the IPython notebook doesn't have a separate output channel for graphics either. Other than returning an image via the displayhook, that is.\n\nOf course the old notebook is entangled with the show() methods, e.g. 3d plots show() is a whole mess of spaghetti code. Fun fact: you can't save a jmol script to a file, you can only generate it on-the-fly inside show(). So my plan would be first to implement `_rich_repr_()` and then transition other code over.",
    "created_at": "2014-10-01T12:01:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221257",
    "user": "https://github.com/vbraun"
}
```

At least for now, it is intentional that show() opens external programs. For example that is currently the only way to see jmol 3d.

In the long run I think show() should just be removed. Really, it only serves two purposes: easier forkbombing `while True: sphere().show()` and functions that show plots while not playing nice with the rest of the graphics infrastructure. The only difference between `def f(): return plot()` and `def f(): plot().show()` is that the latter can't be combined/superimposed with other plots, a user can't change axis options, you can't reasonably call it in your own code, ...

The other reason is that there is no "stdout for graphics", so to my knowledge the IPython notebook doesn't have a separate output channel for graphics either. Other than returning an image via the displayhook, that is.

Of course the old notebook is entangled with the show() methods, e.g. 3d plots show() is a whole mess of spaghetti code. Fun fact: you can't save a jmol script to a file, you can only generate it on-the-fly inside show(). So my plan would be first to implement `_rich_repr_()` and then transition other code over.



---

archive/issue_comments_221258.json:
```json
{
    "body": "PS: For the documentation to work you need to build it: \"make doc\"",
    "created_at": "2014-10-01T12:09:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221258",
    "user": "https://github.com/vbraun"
}
```

PS: For the documentation to work you need to build it: "make doc"



---

archive/issue_comments_221259.json:
```json
{
    "body": "I guess there is `IPython.display` to display graphics outside of the display hook, will look into that.",
    "created_at": "2014-10-01T12:20:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221259",
    "user": "https://github.com/vbraun"
}
```

I guess there is `IPython.display` to display graphics outside of the display hook, will look into that.



---

archive/issue_comments_221260.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-03T13:16:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221260",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_221261.json:
```json
{
    "body": "The command line option is now `--notebook=ipython` or `--notebook=sagenb` (default). This is more consistent / extensible than `--notebook-ipython`. \n\nAlso, switch the notebook argument handling to Python argparse.",
    "created_at": "2014-10-03T13:18:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221261",
    "user": "https://github.com/vbraun"
}
```

The command line option is now `--notebook=ipython` or `--notebook=sagenb` (default). This is more consistent / extensible than `--notebook-ipython`. 

Also, switch the notebook argument handling to Python argparse.



---

archive/issue_comments_221262.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-10-03T22:36:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221262",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_221263.json:
```json
{
    "body": "Is there a way to render output cells using Mathjax in the ipython notebook? Basically an equivalent for the \"Typeset\" toggle button in the sagenb or `typeset_mode()` in smc. If not, should there be? It seems important to maintain parity in notebooks for some things like formatted expressions.",
    "created_at": "2014-10-04T22:53:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221263",
    "user": "https://trac.sagemath.org/admin/accounts/users/ssinglet"
}
```

Is there a way to render output cells using Mathjax in the ipython notebook? Basically an equivalent for the "Typeset" toggle button in the sagenb or `typeset_mode()` in smc. If not, should there be? It seems important to maintain parity in notebooks for some things like formatted expressions.



---

archive/issue_comments_221264.json:
```json
{
    "body": "Unexpected behavior: 'bang' shell commands send output to terminal rather than ipython notebook output cell. Eg: \n`In [2]: !pwd`\nhas no output cell, but it's echoed to STDOUT. Is this intentional?",
    "created_at": "2014-10-04T23:06:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221264",
    "user": "https://trac.sagemath.org/admin/accounts/users/ssinglet"
}
```

Unexpected behavior: 'bang' shell commands send output to terminal rather than ipython notebook output cell. Eg: 
`In [2]: !pwd`
has no output cell, but it's echoed to STDOUT. Is this intentional?



---

archive/issue_comments_221265.json:
```json
{
    "body": "[Sorry if I'm violating sage-trac etiquette; is it preferable to add several comments, each with a single topic/question, or keep several things together in a single comment? Also, my comments could be considered feature requests or enhancements and therefore inappropriate after a review is requested. Please let me know...]\n\nI've been using `%load sage` in the standard ipython notebook for some time and have several existing .ipynb notebooks. Currently, it seems these must be moved to the ~/.sage/notebooks_ipy directory (or maybe a tmp directory if `--nodotsage` is given). I think this should either be documented or (preferably) `sage --notebook=ipython` should include .ipynb files found in the working directory at runtime (similar to the standard ipython notebook localhost:8888/tree).\n\nEDIT: Actually the directory is documented in the startup message.",
    "created_at": "2014-10-05T00:52:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221265",
    "user": "https://trac.sagemath.org/admin/accounts/users/ssinglet"
}
```

[Sorry if I'm violating sage-trac etiquette; is it preferable to add several comments, each with a single topic/question, or keep several things together in a single comment? Also, my comments could be considered feature requests or enhancements and therefore inappropriate after a review is requested. Please let me know...]

I've been using `%load sage` in the standard ipython notebook for some time and have several existing .ipynb notebooks. Currently, it seems these must be moved to the ~/.sage/notebooks_ipy directory (or maybe a tmp directory if `--nodotsage` is given). I think this should either be documented or (preferably) `sage --notebook=ipython` should include .ipynb files found in the working directory at runtime (similar to the standard ipython notebook localhost:8888/tree).

EDIT: Actually the directory is documented in the startup message.



---

archive/issue_comments_221266.json:
```json
{
    "body": "* Typeset output will be in the next iteration.\n* The standard IPython notebook command line options work, so you can run \n  {{{\n  ./sage --notebook=ipython --notebook-dir=~/MyNotebooks\n  }}} \n  if you want a different one.",
    "created_at": "2014-10-05T15:41:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221266",
    "user": "https://github.com/vbraun"
}
```

* Typeset output will be in the next iteration.
* The standard IPython notebook command line options work, so you can run 
  {{{
  ./sage --notebook=ipython --notebook-dir=~/MyNotebooks
  }}} 
  if you want a different one.



---

archive/issue_comments_221267.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-05T18:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221267",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_221268.json:
```json
{
    "body": "Bang specials (`!ls`) work now.",
    "created_at": "2014-10-05T18:54:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221268",
    "user": "https://github.com/vbraun"
}
```

Bang specials (`!ls`) work now.



---

archive/issue_comments_221269.json:
```json
{
    "body": "Hi,\nI've just tried it (building it by \"make\" after a merge of the ticket branch into Sage 6.4-beta4). It works very nicely! Just missing the MathJax typeset output, but I understand this is for the next step. In my opinion (but I am not a IPython notebook expert), it should get a positive review.",
    "created_at": "2014-10-07T08:59:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221269",
    "user": "https://github.com/egourgoulhon"
}
```

Hi,
I've just tried it (building it by "make" after a merge of the ticket branch into Sage 6.4-beta4). It works very nicely! Just missing the MathJax typeset output, but I understand this is for the next step. In my opinion (but I am not a IPython notebook expert), it should get a positive review.



---

archive/issue_comments_221270.json:
```json
{
    "body": "The buildbot says the following tests fails:\n\n\n```\nsage -t src/sage/crypto/mq/sr.py  # 5 doctests failed\nsage -t src/sage/modular/modform/numerical.py  # 2 doctests failed\nsage -t src/sage/repl/notebook_ipython.py  # 9 doctests failed\nsage -t src/sage/rings/polynomial/multi_polynomial_sequence.py  # 9 doctests failed\nsage -t src/sage/rings/polynomial/pbori.pyx  # Killed due to segmentation fault\nsage -t src/sage/rings/polynomial/polynomial_element.pyx  # 2 doctests failed\nsage -t src/sage/rings/real_double.pyx  # 2 doctests failed\n```\n\n\nI tested the same files on my machine and I get:\n\n\n```\nsage -t src/sage/crypto/mq/sr.py  # Killed due to bus error\nsage -t src/sage/repl/notebook_ipython.py  # 1 doctest failed\nsage -t src/sage/rings/polynomial/multi_polynomial_sequence.py  # 9 doctests failed\nsage -t src/sage/rings/polynomial/pbori.pyx  # Killed due to bus error\nsage -t src/sage/rings/polynomial/polynomial_element.pyx  # 6 doctests failed\nsage -t src/sage/rings/real_double.pyx  # 2 doctests failed\n```\n\n\nFull log is available here: http://boxen.math.washington.edu/home/slabbe/trac_16996.log\n\nNote: the link is broken. I don't know why. I scp the file on my account on the server `sage.math.washington.edu` as before. What is the url of it then?",
    "created_at": "2014-10-07T18:33:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221270",
    "user": "https://github.com/seblabbe"
}
```

The buildbot says the following tests fails:


```
sage -t src/sage/crypto/mq/sr.py  # 5 doctests failed
sage -t src/sage/modular/modform/numerical.py  # 2 doctests failed
sage -t src/sage/repl/notebook_ipython.py  # 9 doctests failed
sage -t src/sage/rings/polynomial/multi_polynomial_sequence.py  # 9 doctests failed
sage -t src/sage/rings/polynomial/pbori.pyx  # Killed due to segmentation fault
sage -t src/sage/rings/polynomial/polynomial_element.pyx  # 2 doctests failed
sage -t src/sage/rings/real_double.pyx  # 2 doctests failed
```


I tested the same files on my machine and I get:


```
sage -t src/sage/crypto/mq/sr.py  # Killed due to bus error
sage -t src/sage/repl/notebook_ipython.py  # 1 doctest failed
sage -t src/sage/rings/polynomial/multi_polynomial_sequence.py  # 9 doctests failed
sage -t src/sage/rings/polynomial/pbori.pyx  # Killed due to bus error
sage -t src/sage/rings/polynomial/polynomial_element.pyx  # 6 doctests failed
sage -t src/sage/rings/real_double.pyx  # 2 doctests failed
```


Full log is available here: http://boxen.math.washington.edu/home/slabbe/trac_16996.log

Note: the link is broken. I don't know why. I scp the file on my account on the server `sage.math.washington.edu` as before. What is the url of it then?



---

archive/issue_comments_221271.json:
```json
{
    "body": "Replying to [comment:33 slabbe]:\n\nHi S\u00e9bastien,\n\nOn my machine, with branch u/vbraun/sage_ipynb merged into sage 6.4 beta4, all the above tests passed. Which version of Sage are you using ?",
    "created_at": "2014-10-07T19:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221271",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:33 slabbe]:

Hi Sébastien,

On my machine, with branch u/vbraun/sage_ipynb merged into sage 6.4 beta4, all the above tests passed. Which version of Sage are you using ?



---

archive/issue_comments_221272.json:
```json
{
    "body": "We don't serve all home directories any more. Contact William if you want yours to be whitelisted.",
    "created_at": "2014-10-07T19:29:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221272",
    "user": "https://github.com/vbraun"
}
```

We don't serve all home directories any more. Contact William if you want yours to be whitelisted.



---

archive/issue_comments_221273.json:
```json
{
    "body": "PS: The branch doesn't include the `SAGE_UPGRADING` fix so you probably have to `make distclean && make` to compile it correctly.",
    "created_at": "2014-10-07T19:30:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221273",
    "user": "https://github.com/vbraun"
}
```

PS: The branch doesn't include the `SAGE_UPGRADING` fix so you probably have to `make distclean && make` to compile it correctly.



---

archive/issue_comments_221274.json:
```json
{
    "body": "- The example in `cmdline2argspec` is kind of ridiculous. I would just delete it.\n- Should the usage string produced by `sage --notebook -h` actually say what the default notebook is? I think so: the default should be clearly documented without reading the source code.\n- It seems odd that `sage --notebook --notebook sagenb` is valid syntax, but I don't really care.\n- Do we need to deprecate the \"insecure\" notebook? Again, I don't really care, but I thought I would ask.\n\nI don't know enough about the graphics/plotting interface to know if the changes here are sensible. Anyone else? My only impression is that the `graphics_file` module should have more documentation: I don't know at a glance why or how to use it. The doctest coverage for that file is bad, also. Everything else looks okay, although I haven't looked in great detail at all of it.",
    "created_at": "2014-10-07T21:39:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221274",
    "user": "https://github.com/jhpalmieri"
}
```

- The example in `cmdline2argspec` is kind of ridiculous. I would just delete it.
- Should the usage string produced by `sage --notebook -h` actually say what the default notebook is? I think so: the default should be clearly documented without reading the source code.
- It seems odd that `sage --notebook --notebook sagenb` is valid syntax, but I don't really care.
- Do we need to deprecate the "insecure" notebook? Again, I don't really care, but I thought I would ask.

I don't know enough about the graphics/plotting interface to know if the changes here are sensible. Anyone else? My only impression is that the `graphics_file` module should have more documentation: I don't know at a glance why or how to use it. The doctest coverage for that file is bad, also. Everything else looks okay, although I haven't looked in great detail at all of it.



---

archive/issue_comments_221275.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-07T22:00:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221275",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_221276.json:
```json
{
    "body": "* Removed the example, that was from when I was trying to doctest it (turns out `src/bin` scripts are not doctested, but thats another issue)\n* Added the default to the help string.\n* `ls --color=never --color=always` is valid as well. This is how argparse operates.\n* Nothing changed with the insecure notebook, I just consolidated all launcher scripts into one. That doesn't change the fact that `sage -notebook` and `sage -inotebook` launch the same thing, `secure=False` is the default.\n* The `graphics_file` needs to be refactored to support more than just raster graphics anyways (see discussion), so I didn't document it all. In any case its a displayhook internal.",
    "created_at": "2014-10-07T22:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221276",
    "user": "https://github.com/vbraun"
}
```

* Removed the example, that was from when I was trying to doctest it (turns out `src/bin` scripts are not doctested, but thats another issue)
* Added the default to the help string.
* `ls --color=never --color=always` is valid as well. This is how argparse operates.
* Nothing changed with the insecure notebook, I just consolidated all launcher scripts into one. That doesn't change the fact that `sage -notebook` and `sage -inotebook` launch the same thing, `secure=False` is the default.
* The `graphics_file` needs to be refactored to support more than just raster graphics anyways (see discussion), so I didn't document it all. In any case its a displayhook internal.



---

archive/issue_comments_221277.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-07T22:09:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221277",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_221278.json:
```json
{
    "body": "I've added a `(deprecated)` to the inotebook option, hopefully we can get rid of it in the future.",
    "created_at": "2014-10-07T22:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221278",
    "user": "https://github.com/vbraun"
}
```

I've added a `(deprecated)` to the inotebook option, hopefully we can get rid of it in the future.



---

archive/issue_comments_221279.json:
```json
{
    "body": "Replying to [comment:39 vbraun]:\n> * Added the default to the help string.\n\nCan the default (sagenb vs ipython) be changed by the user? If yes, how?",
    "created_at": "2014-10-08T06:48:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221279",
    "user": "https://github.com/seblabbe"
}
```

Replying to [comment:39 vbraun]:
> * Added the default to the help string.

Can the default (sagenb vs ipython) be changed by the user? If yes, how?



---

archive/issue_comments_221280.json:
```json
{
    "body": "It seems there is a space missing in the usage line :`sage-notebook` instead of `sage -notebook`.\n\n\n```\n$ sage -notebook -h\nusage: sage-notebook [-h] [--log LOG] [--notebook [NOTEBOOK]]\n```\n\n\n\n```\n$ sage -docbuild -h\nUsage: sage -docbuild [OPTIONS] DOCUMENT (FORMAT | COMMAND)\n```\n\n\nI also wonder why `-n` is not listed first on the line (compare with `sage -docbuild -h`):\n\n\n```\n  --notebook [NOTEBOOK], -n [NOTEBOOK], -notebook [NOTEBOOK]\n```\n\n\nTo me it is an important feature that `sage -ipython notebook` directly lands in the present working directory. And I will be disappointed if `sage -notebook=ipython` does not. What is the opinion of other users about this?\n\nI am sory to say this, but to me if we default to `--notebook-dir=DOT_SAGE/notebooks_ipython` we follow stupidly a bad design choice of the previous notebook.\n\n> The standard IPython notebook command line options work\n\nIn any case, should we document in `sage -notebook -h` that the long list of options of `sage -ipython notebook -h` can be used?",
    "created_at": "2014-10-08T07:34:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221280",
    "user": "https://github.com/seblabbe"
}
```

It seems there is a space missing in the usage line :`sage-notebook` instead of `sage -notebook`.


```
$ sage -notebook -h
usage: sage-notebook [-h] [--log LOG] [--notebook [NOTEBOOK]]
```



```
$ sage -docbuild -h
Usage: sage -docbuild [OPTIONS] DOCUMENT (FORMAT | COMMAND)
```


I also wonder why `-n` is not listed first on the line (compare with `sage -docbuild -h`):


```
  --notebook [NOTEBOOK], -n [NOTEBOOK], -notebook [NOTEBOOK]
```


To me it is an important feature that `sage -ipython notebook` directly lands in the present working directory. And I will be disappointed if `sage -notebook=ipython` does not. What is the opinion of other users about this?

I am sory to say this, but to me if we default to `--notebook-dir=DOT_SAGE/notebooks_ipython` we follow stupidly a bad design choice of the previous notebook.

> The standard IPython notebook command line options work

In any case, should we document in `sage -notebook -h` that the long list of options of `sage -ipython notebook -h` can be used?



---

archive/issue_comments_221281.json:
```json
{
    "body": "If `DOT_SAGE/notebooks_ipython` dir exists, `sage -t src/sage/repl/notebook_ipython.py` returns `All tests passed!`. But if the dir does not exist, then one test is failing:\n\n\n```\nsage -t src/sage/repl/notebook_ipython.py  # 1 doctest failed   \n**********************************************************************                     \nFile \"src/sage/repl/notebook_ipython.py\", line 63, in sage.repl.notebook_ipython.SageNotebookApp.load_config_file\nFailed example:\n    app.load_config_file()    # random output                                                           \nException raised:\n    Traceback (most recent call last):\n    ...\n    TraitError: No such notebook dir: u'/Users/slabbe/.sage/notebooks_ipython' \n```\n",
    "created_at": "2014-10-08T07:48:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221281",
    "user": "https://github.com/seblabbe"
}
```

If `DOT_SAGE/notebooks_ipython` dir exists, `sage -t src/sage/repl/notebook_ipython.py` returns `All tests passed!`. But if the dir does not exist, then one test is failing:


```
sage -t src/sage/repl/notebook_ipython.py  # 1 doctest failed   
**********************************************************************                     
File "src/sage/repl/notebook_ipython.py", line 63, in sage.repl.notebook_ipython.SageNotebookApp.load_config_file
Failed example:
    app.load_config_file()    # random output                                                           
Exception raised:
    Traceback (most recent call last):
    ...
    TraitError: No such notebook dir: u'/Users/slabbe/.sage/notebooks_ipython' 
```




---

archive/issue_comments_221282.json:
```json
{
    "body": "The default can't be changed without editing the source. You can always make an alias if its too much effort to type out.\n\nThe notebook launch script is `sage-notebook`, so this is the name that appears in the `usage:` help. We could override it but IMHO that would be even more confusing. Can't really be fixed without #21.",
    "created_at": "2014-10-08T11:48:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221282",
    "user": "https://github.com/vbraun"
}
```

The default can't be changed without editing the source. You can always make an alias if its too much effort to type out.

The notebook launch script is `sage-notebook`, so this is the name that appears in the `usage:` help. We could override it but IMHO that would be even more confusing. Can't really be fixed without #21.



---

archive/issue_comments_221283.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-08T12:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221283",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_221284.json:
```json
{
    "body": "* The order of `--notebook [NOTEBOOK], -n [NOTEBOOK]` is fixed in sage-notebook and I prefer it that way (most descriptive first).\n\n* I also think its unproductive to start a discussion about whether or not we should start in a particular directory. This is what the old notebook does, if you don't like it then open a ticket or post on sage-devel. I don't really care either way, but the behavior has to match.\n\n* I fixed the doctest error when you never ran the ipython notebook before.",
    "created_at": "2014-10-08T12:52:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221284",
    "user": "https://github.com/vbraun"
}
```

* The order of `--notebook [NOTEBOOK], -n [NOTEBOOK]` is fixed in sage-notebook and I prefer it that way (most descriptive first).

* I also think its unproductive to start a discussion about whether or not we should start in a particular directory. This is what the old notebook does, if you don't like it then open a ticket or post on sage-devel. I don't really care either way, but the behavior has to match.

* I fixed the doctest error when you never ran the ipython notebook before.



---

archive/issue_comments_221285.json:
```json
{
    "body": "> * I also think its unproductive to start a discussion about whether or not we should start in a particular directory.\n\nOk I agree. This should be discussed on sage-devel.\n\nI agree with John Palmieri about the doctest coverage in the `graphics_file` class. I think it should be 100% doctested and should not be too long to do so. Other than that, to me the ticket can get a positive review. (Note: I will not have much internet time in the next few days.)",
    "created_at": "2014-10-08T22:08:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221285",
    "user": "https://github.com/seblabbe"
}
```

> * I also think its unproductive to start a discussion about whether or not we should start in a particular directory.

Ok I agree. This should be discussed on sage-devel.

I agree with John Palmieri about the doctest coverage in the `graphics_file` class. I think it should be 100% doctested and should not be too long to do so. Other than that, to me the ticket can get a positive review. (Note: I will not have much internet time in the next few days.)



---

archive/issue_comments_221286.json:
```json
{
    "body": "I said already that the `graphics_file` module needs to be rewritten to also allow for other forms of rich output. I'm not going to document it and then erase it in the next ticket.",
    "created_at": "2014-10-08T22:21:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221286",
    "user": "https://github.com/vbraun"
}
```

I said already that the `graphics_file` module needs to be rewritten to also allow for other forms of rich output. I'm not going to document it and then erase it in the next ticket.



---

archive/issue_comments_221287.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-12T15:13:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221287",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_221288.json:
```json
{
    "body": "I give this a positive review.\n\nUnfinished discussions (reported later) concerns:\n\n- the default directory for sage -notebook=ipython to be discussed on sage-devel\n- A new ticket should be created for the `graphics_file` module to be rewritten",
    "created_at": "2014-10-13T13:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221288",
    "user": "https://github.com/seblabbe"
}
```

I give this a positive review.

Unfinished discussions (reported later) concerns:

- the default directory for sage -notebook=ipython to be discussed on sage-devel
- A new ticket should be created for the `graphics_file` module to be rewritten



---

archive/issue_comments_221289.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-13T13:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221289",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_221290.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-10-14T10:41:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221290",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_221291.json:
```json
{
    "body": "> Unfinished discussions (reported later) concerns:\n> \n>  - the default directory for sage -notebook=ipython to be discussed on sage-devel\n\nThis is now #17203.\n\nVolker I am sure you can fix #17203 much quicklier than me since you put your hands in those files recently. Will you have time to work on #17203 in the next days?\n\nS\u00e9bastien",
    "created_at": "2014-10-23T14:16:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221291",
    "user": "https://github.com/seblabbe"
}
```

> Unfinished discussions (reported later) concerns:
> 
>  - the default directory for sage -notebook=ipython to be discussed on sage-devel

This is now #17203.

Volker I am sure you can fix #17203 much quicklier than me since you put your hands in those files recently. Will you have time to work on #17203 in the next days?

Sébastien



---

archive/issue_comments_221292.json:
```json
{
    "body": "See https://groups.google.com/d/msg/sage-release/xgmJ3nAcUOY/d9-MZLTyowYJ for some regressions/incompatible changes in the syntax for command line launch of sagenb, presumably introduced in this ticket.",
    "created_at": "2014-11-03T13:35:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221292",
    "user": "https://github.com/kcrisman"
}
```

See https://groups.google.com/d/msg/sage-release/xgmJ3nAcUOY/d9-MZLTyowYJ for some regressions/incompatible changes in the syntax for command line launch of sagenb, presumably introduced in this ticket.



---

archive/issue_comments_221293.json:
```json
{
    "body": "Replying to [comment:55 kcrisman]:\n> some regressions/incompatible changes in the syntax for command line launch of sagenb, presumably introduced in this ticket.\n\nShould that be considered as a blocker ?\n\nSee also #17281 for another (easy) follow up ticket.",
    "created_at": "2014-11-03T15:45:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221293",
    "user": "https://github.com/seblabbe"
}
```

Replying to [comment:55 kcrisman]:
> some regressions/incompatible changes in the syntax for command line launch of sagenb, presumably introduced in this ticket.

Should that be considered as a blocker ?

See also #17281 for another (easy) follow up ticket.



---

archive/issue_comments_221294.json:
```json
{
    "body": "this ticket is closed. Followup is #17280",
    "created_at": "2014-11-03T15:58:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16759#issuecomment-221294",
    "user": "https://github.com/vbraun"
}
```

this ticket is closed. Followup is #17280
