# Issue 25265: py3: implement __hash__ method in ContinuousMap

Issue created by migration from Trac.

Original creator: egourgoulhon

Original creation time: 2018-06-03 20:13:14

CC:  tscrim embray chapoton

Keywords: python3, topological manifold

`ContinuousMap` defines its own `__eq__` method, while inheritating from `Morphism.__hash__`. Now, as pointed out in #24551, Python3 breaks the inheritance of `__hash__` when `__eq__` is redefined. This ticket fixes this by implementing `ContinousMap.__hash__`. Moreover, contrary to `Morphism.__hash__`, the new method does not rely on `repr()` and guarantees that two continous maps that compare equal have the same hash.

Note that there is a proposal at #25393 to remove `Morphism.__hash__`. 

`ContinousMap` (more precisely the derived class `DiffMap`) needs to be hashable because `DiffMap` objects serve as keys in the dictionary of vector field modules on a manifold, a module of vector fields on a differentiable manifold being essentially defined by a differentiable map (with the important special case of the identity map; see [here](http://doc.sagemath.org/html/en/reference/manifolds/sage/manifolds/differentiable/vectorfield_module.html) for details).



---

Comment by egourgoulhon created at 2018-06-03 20:14:22

New commits:


---

Comment by egourgoulhon created at 2018-06-03 20:16:43

Changing status from new to needs_review.


---

Comment by chapoton created at 2018-06-04 06:52:25

does seem to be a very rough hash... But it will do the job for the moment


---

Comment by chapoton created at 2018-06-04 06:52:25

Changing status from needs_review to positive_review.


---

Comment by egourgoulhon created at 2018-06-04 08:36:31

Replying to [comment:3 chapoton]:
> does seem to be a very rough hash... But it will do the job for the moment

Yes it's pretty rough, but there should be no loss of efficiency, since continuous maps are only used as keys in the dictionary `DifferentiableManifold._vector_field_modules`, which is of very small size; most of the time, it has a single element (the continuous map being then merely the identity map).


---

Comment by vbraun created at 2018-06-06 19:53:33

Resolution: fixed
