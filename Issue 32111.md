# Issue 32111: Missing Weil polynomials when leading coefficients are specified

Issue created by migration from https://trac.sagemath.org/ticket/32348

Original creator: kedlaya

Original creation time: 2021-08-09 00:33:42

CC:  edgarcosta

Keywords: Weil polynomials

Something seems to be off when I specify too many leading coefficients:

```
sage: from sage.rings.polynomial.weil.weil_polynomials import WeilPolynomials as WP
sage: P.<x> = QQ[]
sage: list(WP(10,2,lead=[1,-3,5,-5,5]))
[x^10 - 3*x^9 + 5*x^8 - 5*x^7 + 5*x^6 - 5*x^5 + 10*x^4 - 20*x^3 + 40*x^2 - 48*x + 32,
 x^10 - 3*x^9 + 5*x^8 - 5*x^7 + 5*x^6 - 6*x^5 + 10*x^4 - 20*x^3 + 40*x^2 - 48*x + 32,
 x^10 - 3*x^9 + 5*x^8 - 5*x^7 + 5*x^6 - 7*x^5 + 10*x^4 - 20*x^3 + 40*x^2 - 48*x + 32]
sage: list(WP(10,2,lead=[1,-3,5,-5,5,-5]))                                                                                                                                             
[]
sage: list(WP(10,2,lead=[1,-3,5,-5,5,-6]))
[]
```



---

Comment by kedlaya created at 2021-08-09 17:31:56

Changing status from new to needs_review.


---

Comment by kedlaya created at 2021-08-09 17:31:56

This turns out to be an easy fix, see attached. TL;DR: the integer that goes with a FLINT polynomial is the length (degree + 1), not the degree.
----
New commits:


---

Comment by edgarcosta created at 2021-08-09 18:13:54

LGTM.

I can't imagine patch bot failing on this, but we should wait.


---

Comment by edgarcosta created at 2021-08-11 20:26:13

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2021-09-04 13:51:41


```
**********************************************************************
File "src/sage/algebras/orlik_solomon.py", line 535, in sage.algebras.orlik_solomon.OrlikSolomonInvariantAlgebra
Failed example:
    [OSH.lift(b) for b in OSH.basis()]
Expected:
    [OS{}, OS{1} + OS{2} + OS{3}, OS{4} + OS{5} + OS{6}]
Got:
    [OS{}, OS{4} + OS{5} + OS{6}, OS{1} + OS{2} + OS{3}]
**********************************************************************
```



---

Comment by vbraun created at 2021-09-04 13:51:41

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2021-09-04 14:01:16

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2021-09-04 14:01:16

sorry wrong ticket number!


---

Comment by vbraun created at 2021-09-05 21:38:23

Resolution: fixed
