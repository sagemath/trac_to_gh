# Issue 10134: eulerian_circuit() of Graph can't handle multiple edges

Issue created by migration from https://trac.sagemath.org/ticket/10135

Original creator: mvngu

Original creation time: 2010-10-16 13:39:05

Assignee: jason, ncohen, rlm

CC:  brunellus jason

This is reported in [sage-support](http://groups.google.com/group/sage-support/browse_thread/thread/cb8454790b70a20c).


---

Comment by brunellus created at 2011-12-02 21:30:29

I see that the function is based on Fleury's algorithm. Would it be plausible if I rewrite it using asymptotically faster Hierholzer's algorithm?


---

Comment by brunellus created at 2011-12-02 21:33:40

plausible -> meaningful :-)


---

Comment by jason created at 2011-12-03 21:28:08

If you've got a better way to do it, go for it!


---

Attachment


---

Comment by brunellus created at 2011-12-06 23:50:21

The patch I just sent strives for three advancements in eulerian_circuit():

* It should close this ticket. :-)

* It should run in O(|E|) time.

* It should find eulerian circualiton in disconnected cases like


```
Graph({0: [], 1: [2], 2: [3], 3: [1], 4: []})
```


where previous one failed. This is similar to the trac #12108. Notice, that you need to apply the patch I sent to that ticket before testing this code -- if you don't, one of the tests fails because is_eulerian() doesn't work correctly.

During testing I was surprised by way Sage handles multiple loops:


```
sage: g=Graph({0: [0, 0]})
sage: g.degree(0)
4
sage: g.delete_edge(g.edge_iterator(0).next())
sage: g.degree(0)
0
```


I think that Sage should either reject multiple loops at the beginning (merge them to one, for example), or handle them as separate. This is surprising behavior. What do you think?


---

Comment by brunellus created at 2011-12-06 23:50:21

Changing status from new to needs_review.


---

Comment by brunellus created at 2011-12-11 15:45:29

I started #12135 for the mentioned multiple loops problem.


---

Comment by brunellus created at 2012-01-19 05:20:30

Some additional changes to this code were introduced in #12325. I guess it would be efficient to review both tickets together.


---

Comment by ncohen created at 2012-01-26 13:30:53

Helloooooo !!

This one's good to go, too ! The reverse() function is actually slower than the copy(), but it makes much more sense to solve this problem directly by modifying the backends than by changing this method. Thank you for this patch ! `:-)`

Nathann


---

Comment by ncohen created at 2012-01-26 13:30:53

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-02-02 12:52:17

Resolution: fixed
