# Issue 14087: Orbits of tuples and sets

archive/issues_014087.json:
```json
{
    "body": "Assignee: joyner\n\nCC:  @dimpase\n\nA small patch to let us compute the orbits of sets and tuples by exposing it from GAP.\n\nNathann\n\nIssue created by migration from https://trac.sagemath.org/ticket/14291\n\n",
    "created_at": "2013-03-17T11:24:28Z",
    "labels": [
        "component: group theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.10",
    "title": "Orbits of tuples and sets",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14087",
    "user": "https://github.com/nathanncohen"
}
```
Assignee: joyner

CC:  @dimpase

A small patch to let us compute the orbits of sets and tuples by exposing it from GAP.

Nathann

Issue created by migration from https://trac.sagemath.org/ticket/14291





---

archive/issue_comments_176175.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-03-17T11:26:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176175",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_176176.json:
```json
{
    "body": "There is a small problem with cached functions right now... `-_-`\n\nNathann",
    "created_at": "2013-03-17T11:26:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176176",
    "user": "https://github.com/nathanncohen"
}
```

There is a small problem with cached functions right now... `-_-`

Nathann



---

archive/issue_comments_176177.json:
```json
{
    "body": "this looks weird:\n\n```\ndef orbit(self, point, onsets = False, ontuples = False): \n```\n\nWhat about \n\n```\ndef orbit(self, point, action = \"onpoints\"): \n```\n\n(or `\"OnPoints\"` ?) which is the default, \nand then sort out the cases `action = \"onsets\"`, etc. ?",
    "created_at": "2013-03-17T12:44:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176177",
    "user": "https://github.com/dimpase"
}
```

this looks weird:

```
def orbit(self, point, onsets = False, ontuples = False): 
```

What about 

```
def orbit(self, point, action = "onpoints"): 
```

(or `"OnPoints"` ?) which is the default, 
and then sort out the cases `action = "onsets"`, etc. ?



---

archive/issue_comments_176178.json:
```json
{
    "body": "Totally right...\n\nJust updated it ! And the function only takes tuples as arguments now. I so hate it when design decisions have to be changed for technical issues `-_-`.\n\nNathann",
    "created_at": "2013-03-17T13:04:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176178",
    "user": "https://github.com/nathanncohen"
}
```

Totally right...

Just updated it ! And the function only takes tuples as arguments now. I so hate it when design decisions have to be changed for technical issues `-_-`.

Nathann



---

archive/issue_comments_176179.json:
```json
{
    "body": "Attachment [trac_14291.patch](tarball://root/attachments/some-uuid/ticket14291/trac_14291.patch) by @nathanncohen created at 2013-03-17 13:04:28",
    "created_at": "2013-03-17T13:04:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176179",
    "user": "https://github.com/nathanncohen"
}
```

Attachment [trac_14291.patch](tarball://root/attachments/some-uuid/ticket14291/trac_14291.patch) by @nathanncohen created at 2013-03-17 13:04:28



---

archive/issue_comments_176180.json:
```json
{
    "body": "There are more useful permutation group actions, see http://www.gap-system.org/Manuals/doc/ref/chap41.html\n\nNamely, `OnPairs, OnSetsSets, OnSetsDisjointSets, OnSetsTuples, OnTuplesSets, OnTuplesTuples` all should work just fine.\n\nOne has to canonize the representative to start with, for some of them, [see here](http://www.gap-system.org/Manuals/doc/ref/chap41.html#X82181CA07A5B2056). E.g.\n\n```\nOrbit(SymmetricGroup(5),Set([[2,4],[1,3]]),OnSetsSets);\n```\n\nis OK, but\n\n```\nOrbit(SymmetricGroup(5),[[2,4],[1,3]],OnSetsSets);\n```\n\ngives an error.\n\nLess sure about `OnIndeterminates`.\n\nThere is also a support for user-defined actions, but this would mean either specifying a piece of GAP code, or providing a callback, which seems to be too crazy to implement.",
    "created_at": "2013-03-19T06:00:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176180",
    "user": "https://github.com/dimpase"
}
```

There are more useful permutation group actions, see http://www.gap-system.org/Manuals/doc/ref/chap41.html

Namely, `OnPairs, OnSetsSets, OnSetsDisjointSets, OnSetsTuples, OnTuplesSets, OnTuplesTuples` all should work just fine.

One has to canonize the representative to start with, for some of them, [see here](http://www.gap-system.org/Manuals/doc/ref/chap41.html#X82181CA07A5B2056). E.g.

```
Orbit(SymmetricGroup(5),Set([[2,4],[1,3]]),OnSetsSets);
```

is OK, but

```
Orbit(SymmetricGroup(5),[[2,4],[1,3]],OnSetsSets);
```

gives an error.

Less sure about `OnIndeterminates`.

There is also a support for user-defined actions, but this would mean either specifying a piece of GAP code, or providing a callback, which seems to be too crazy to implement.



---

archive/issue_comments_176181.json:
```json
{
    "body": "Helloooooooo !!\n\n> There are more useful permutation group actions, see http://www.gap-system.org/Manuals/doc/ref/chap41.html\n\nYepyep, I saw them but I really only need `OnTuples` and `OnSets` myself, and as I do not really see how I could use the others I do not think that it would be wise to expose them myself. Soooo unless you want to write that additional patch yourslf, ... `:-)`\n\nNathann",
    "created_at": "2013-03-19T09:45:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176181",
    "user": "https://github.com/nathanncohen"
}
```

Helloooooooo !!

> There are more useful permutation group actions, see http://www.gap-system.org/Manuals/doc/ref/chap41.html

Yepyep, I saw them but I really only need `OnTuples` and `OnSets` myself, and as I do not really see how I could use the others I do not think that it would be wise to expose them myself. Soooo unless you want to write that additional patch yourslf, ... `:-)`

Nathann



---

archive/issue_comments_176182.json:
```json
{
    "body": "Replying to [comment:5 ncohen]:\n> Helloooooooo !!\n> \n> > There are more useful permutation group actions, see http://www.gap-system.org/Manuals/doc/ref/chap41.html\n> \n> Yepyep, I saw them but I really only need `OnTuples` and `OnSets` myself, and as I do not really see how I could use the others I do not think that it would be wise to expose them myself. Soooo unless you want to write that additional patch yourslf, ... `:-)`\n\nOK, needs your review now `:-P`",
    "created_at": "2013-03-19T16:05:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176182",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:5 ncohen]:
> Helloooooooo !!
> 
> > There are more useful permutation group actions, see http://www.gap-system.org/Manuals/doc/ref/chap41.html
> 
> Yepyep, I saw them but I really only need `OnTuples` and `OnSets` myself, and as I do not really see how I could use the others I do not think that it would be wise to expose them myself. Soooo unless you want to write that additional patch yourslf, ... `:-)`

OK, needs your review now `:-P`



---

archive/issue_comments_176183.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-03-19T16:09:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176183",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_176184.json:
```json
{
    "body": "> OK, needs your review now `:-P`\n\nCool `:-P`\n\nWell, for a start `sage -coverage` will not like the documentation of `supported_actions` at all. Why do you want to create a function just to list them ? Why don't you just include in the methods, or make it a variable in the module ? (anyway you still have to split cases in `orbits` in order to know what to return).\n\nWould it be possible to add a link toward GAP's documentation where all those actions are defined ?\n\nNathann",
    "created_at": "2013-03-19T16:09:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176184",
    "user": "https://github.com/nathanncohen"
}
```

> OK, needs your review now `:-P`

Cool `:-P`

Well, for a start `sage -coverage` will not like the documentation of `supported_actions` at all. Why do you want to create a function just to list them ? Why don't you just include in the methods, or make it a variable in the module ? (anyway you still have to split cases in `orbits` in order to know what to return).

Would it be possible to add a link toward GAP's documentation where all those actions are defined ?

Nathann



---

archive/issue_comments_176185.json:
```json
{
    "body": "Attachment [14291_reviewer.patch](tarball://root/attachments/some-uuid/ticket14291/14291_reviewer.patch) by @dimpase created at 2013-03-19 17:07:09\n\nReplying to [comment:8 ncohen]:\n> > OK, needs your review now `:-P`\n> \n> Cool `:-P`\n> \n> Well, for a start `sage -coverage` will not like the documentation of `supported_actions` at all. Why do you want to create a function just to list them ? Why don't you just include in the methods, or make it a variable in the module ? (anyway you still have to split cases in `orbits` in order to know what to return).\n\nmade it a variable...\n\n> \n> Would it be possible to add a link toward GAP's documentation where all those actions are defined ?\n\nadded...",
    "created_at": "2013-03-19T17:07:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176185",
    "user": "https://github.com/dimpase"
}
```

Attachment [14291_reviewer.patch](tarball://root/attachments/some-uuid/ticket14291/14291_reviewer.patch) by @dimpase created at 2013-03-19 17:07:09

Replying to [comment:8 ncohen]:
> > OK, needs your review now `:-P`
> 
> Cool `:-P`
> 
> Well, for a start `sage -coverage` will not like the documentation of `supported_actions` at all. Why do you want to create a function just to list them ? Why don't you just include in the methods, or make it a variable in the module ? (anyway you still have to split cases in `orbits` in order to know what to return).

made it a variable...

> 
> Would it be possible to add a link toward GAP's documentation where all those actions are defined ?

added...



---

archive/issue_comments_176186.json:
```json
{
    "body": "Attachment [trac_14291-rev2.patch](tarball://root/attachments/some-uuid/ticket14291/trac_14291-rev2.patch) by @nathanncohen created at 2013-03-19 22:22:26",
    "created_at": "2013-03-19T22:22:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176186",
    "user": "https://github.com/nathanncohen"
}
```

Attachment [trac_14291-rev2.patch](tarball://root/attachments/some-uuid/ticket14291/trac_14291-rev2.patch) by @nathanncohen created at 2013-03-19 22:22:26



---

archive/issue_comments_176187.json:
```json
{
    "body": "Some small modifications to the documentation. Besides this :\n\n1) What would you think of making `supported_actions` a variable of the module itself ? And what of making it a hidden variable ?\n\n2) What would you think of sorting the input when it represents a set ?.. GAP's error message when it is fed with an unsorted list is not that clear : \n\n```\nError, OnSets: <set> must be a set (not a list (plain,cyc,nsort,imm))\n```\n\n\nI will do that if you agree with it.\n\nNathann",
    "created_at": "2013-03-19T22:38:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176187",
    "user": "https://github.com/nathanncohen"
}
```

Some small modifications to the documentation. Besides this :

1) What would you think of making `supported_actions` a variable of the module itself ? And what of making it a hidden variable ?

2) What would you think of sorting the input when it represents a set ?.. GAP's error message when it is fed with an unsorted list is not that clear : 

```
Error, OnSets: <set> must be a set (not a list (plain,cyc,nsort,imm))
```


I will do that if you agree with it.

Nathann



---

archive/issue_comments_176188.json:
```json
{
    "body": "Replying to [comment:10 ncohen]:\n> Some small modifications to the documentation. Besides this :\n> \n> 1) What would you think of making `supported_actions` a variable of the module itself ? And what of making it a hidden variable ?\n\nThe current setup allows it to be extended by the user. One can install via `gap.eval()` a GAP function, say, `\"OnBlah\"`, and then  use it. You can't do this with a module variable.\n\n> \n> 2) What would you think of sorting the input when it represents a set ?.. GAP's error message when it is fed with an unsorted list is not that clear : \n> {{{\n> Error, OnSets: <set> must be a set (not a list (plain,cyc,nsort,imm))\n> }}}\n> \n> I will do that if you agree with it.\n\nsure this can be done as you prefer. However, there is a more serious issue with `self.action`:\n\n```\nsage: G = PermutationGroup([ [('c','d')], [('a','c')] ])\nsage: xx=G.orbit(('a','c'),\"OnPairs\")\nsage: G.action(xx,\"OnPairs\")\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n<ipython-input-4-540be1338037> in <module>()\n----> 1 G.action(xx,\"OnPairs\")\n...\n```\n\nIndeed, `_domain_to_gap[x] ` needs to be applied onto such orbits. I am thinking that one should have recursive function version of\n`_domain_to_gap[x] `  and of `_domain_from_gap[x] ` to deal with things like sets, sets of sets, etc in one go rather\nthan  call them explicitly. \n\nOne can also (or instead) attach such a pair of functions to each action in `supported_actions` to do this rewriting.",
    "created_at": "2013-03-19T23:48:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176188",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:10 ncohen]:
> Some small modifications to the documentation. Besides this :
> 
> 1) What would you think of making `supported_actions` a variable of the module itself ? And what of making it a hidden variable ?

The current setup allows it to be extended by the user. One can install via `gap.eval()` a GAP function, say, `"OnBlah"`, and then  use it. You can't do this with a module variable.

> 
> 2) What would you think of sorting the input when it represents a set ?.. GAP's error message when it is fed with an unsorted list is not that clear : 
> {{{
> Error, OnSets: <set> must be a set (not a list (plain,cyc,nsort,imm))
> }}}
> 
> I will do that if you agree with it.

sure this can be done as you prefer. However, there is a more serious issue with `self.action`:

```
sage: G = PermutationGroup([ [('c','d')], [('a','c')] ])
sage: xx=G.orbit(('a','c'),"OnPairs")
sage: G.action(xx,"OnPairs")
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
<ipython-input-4-540be1338037> in <module>()
----> 1 G.action(xx,"OnPairs")
...
```

Indeed, `_domain_to_gap[x] ` needs to be applied onto such orbits. I am thinking that one should have recursive function version of
`_domain_to_gap[x] `  and of `_domain_from_gap[x] ` to deal with things like sets, sets of sets, etc in one go rather
than  call them explicitly. 

One can also (or instead) attach such a pair of functions to each action in `supported_actions` to do this rewriting.



---

archive/issue_comments_176189.json:
```json
{
    "body": "> The current setup allows it to be extended by the user. One can install via `gap.eval()` a GAP function, say, `\"OnBlah\"`, and then  use it. You can't do this with a module variable.\n\nWell, if a action is being used that is not already in the source code, then there is no way for Sage to guess how to translate the result before returning it, is there ?\n\nOtherwise we could just get rid of this list, cross our fingers when GAP is fed with something we ha not thought of, as it would raise an Exception in the worst case ?..\n\n> sure this can be done as you prefer. However, there is a more serious issue with `self.action`:\n\nArg. Right `:-/`\n\n> Indeed, `_domain_to_gap[x] ` needs to be applied onto such orbits. I am thinking that one should have recursive function version of\n> `_domain_to_gap[x] `  and of `_domain_from_gap[x] ` to deal with things like sets, sets of sets, etc in one go rather\n> than  call them explicitly. \n> \n> One can also (or instead) attach such a pair of functions to each action in `supported_actions` to do this rewriting.\n\nHmmmm... I don't like it very much to be honest... In these situations I think that a bit of code duplication is better than a weird generic way to handle it.\n\nNathann",
    "created_at": "2013-03-20T09:26:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176189",
    "user": "https://github.com/nathanncohen"
}
```

> The current setup allows it to be extended by the user. One can install via `gap.eval()` a GAP function, say, `"OnBlah"`, and then  use it. You can't do this with a module variable.

Well, if a action is being used that is not already in the source code, then there is no way for Sage to guess how to translate the result before returning it, is there ?

Otherwise we could just get rid of this list, cross our fingers when GAP is fed with something we ha not thought of, as it would raise an Exception in the worst case ?..

> sure this can be done as you prefer. However, there is a more serious issue with `self.action`:

Arg. Right `:-/`

> Indeed, `_domain_to_gap[x] ` needs to be applied onto such orbits. I am thinking that one should have recursive function version of
> `_domain_to_gap[x] `  and of `_domain_from_gap[x] ` to deal with things like sets, sets of sets, etc in one go rather
> than  call them explicitly. 
> 
> One can also (or instead) attach such a pair of functions to each action in `supported_actions` to do this rewriting.

Hmmmm... I don't like it very much to be honest... In these situations I think that a bit of code duplication is better than a weird generic way to handle it.

Nathann



---

archive/issue_comments_176190.json:
```json
{
    "body": "I just added a new patch (to be applied on top of the rest) that solves these issues. Please have a look if you like it. (It still needs to be cleaned a bit, and more tests ought to be added). It doesn't use the `supported_actions` list.",
    "created_at": "2013-03-20T16:43:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176190",
    "user": "https://github.com/dimpase"
}
```

I just added a new patch (to be applied on top of the rest) that solves these issues. Please have a look if you like it. (It still needs to be cleaned a bit, and more tests ought to be added). It doesn't use the `supported_actions` list.



---

archive/issue_comments_176191.json:
```json
{
    "body": "HMmmmmmmmmm `:-/`\n\nI'm sorry to say this because I like that code, but I just fixed doctests in homology/simplicial_complex where an automorphism group is defined over the elements of a simplicial complex... And I am afraid that you will find both 'a', 'b', and ['a','b'] as elements of the domain `:-/`\n\nNathann",
    "created_at": "2013-03-20T17:46:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176191",
    "user": "https://github.com/nathanncohen"
}
```

HMmmmmmmmmm `:-/`

I'm sorry to say this because I like that code, but I just fixed doctests in homology/simplicial_complex where an automorphism group is defined over the elements of a simplicial complex... And I am afraid that you will find both 'a', 'b', and ['a','b'] as elements of the domain `:-/`

Nathann



---

archive/issue_comments_176192.json:
```json
{
    "body": "Replying to [comment:14 ncohen]:\n> HMmmmmmmmmm `:-/`\n> \n> I'm sorry to say this because I like that code, but I just fixed doctests in homology/simplicial_complex where an automorphism group is defined over the elements of a simplicial complex... And I am afraid that you will find both 'a', 'b', and ['a','b'] as elements of the domain `:-/`\n\nWell, this is trivial to fix, just swap the actions in `try/except` blocks in `dom_to_gap` internal functions.\n\n\nBy the way, why would one keep several actions in case of simplicial complexes, on letters and on pairs, etc? This is akin to keeping actions on vertices and edges in case of automorphisms of (simple) graphs, right? Was that a poor design in the first place?\nBesides, this seems to be inefficient to keep permutations in dictionaries.\n \n> \n> Nathann",
    "created_at": "2013-03-21T00:51:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176192",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:14 ncohen]:
> HMmmmmmmmmm `:-/`
> 
> I'm sorry to say this because I like that code, but I just fixed doctests in homology/simplicial_complex where an automorphism group is defined over the elements of a simplicial complex... And I am afraid that you will find both 'a', 'b', and ['a','b'] as elements of the domain `:-/`

Well, this is trivial to fix, just swap the actions in `try/except` blocks in `dom_to_gap` internal functions.


By the way, why would one keep several actions in case of simplicial complexes, on letters and on pairs, etc? This is akin to keeping actions on vertices and edges in case of automorphisms of (simple) graphs, right? Was that a poor design in the first place?
Besides, this seems to be inefficient to keep permutations in dictionaries.
 
> 
> Nathann



---

archive/issue_comments_176193.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-03-21T02:34:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176193",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_176194.json:
```json
{
    "body": "Attachment [ducktype_design.patch](tarball://root/attachments/some-uuid/ticket14291/ducktype_design.patch) by @dimpase created at 2013-03-21 02:34:49\n\nOK, updated as I mentioned in my previous comment, with more examples added.",
    "created_at": "2013-03-21T02:34:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176194",
    "user": "https://github.com/dimpase"
}
```

Attachment [ducktype_design.patch](tarball://root/attachments/some-uuid/ticket14291/ducktype_design.patch) by @dimpase created at 2013-03-21 02:34:49

OK, updated as I mentioned in my previous comment, with more examples added.



---

archive/issue_comments_176195.json:
```json
{
    "body": "Helloooooooooooooo !!!\n\nWell, this does not solve the problem either Dima. In case of doubt between an element (a,b,c) and the list of elements (a,b,c) it will return the ELEMENT (a,b,c), but it it computes the orbit of a which happens to be (a,b,c) then returning an ELEMENT (a,b,c) instead of the list (a,b,c) is a mistake too `:-/`\n\nNathann",
    "created_at": "2013-03-21T07:44:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176195",
    "user": "https://github.com/nathanncohen"
}
```

Helloooooooooooooo !!!

Well, this does not solve the problem either Dima. In case of doubt between an element (a,b,c) and the list of elements (a,b,c) it will return the ELEMENT (a,b,c), but it it computes the orbit of a which happens to be (a,b,c) then returning an ELEMENT (a,b,c) instead of the list (a,b,c) is a mistake too `:-/`

Nathann



---

archive/issue_comments_176196.json:
```json
{
    "body": "Replying to [comment:17 ncohen]:\n> Helloooooooooooooo !!!\n> \n> Well, this does not solve the problem either Dima. In case of doubt between an element (a,b,c) and the list of elements (a,b,c) it will return the ELEMENT (a,b,c), but it it computes the orbit of a which happens to be (a,b,c) then returning an ELEMENT (a,b,c) instead of the list (a,b,c) is a mistake too `:-/`\n> \n\nThis does not seem to present a problem, as the action of the group is the same (trivial).\n\nBut the real problem is with tuples vs sets. E.g. if your domain has tuples, it will not be possible to compute the action on subsets.\n\nCan't you typify the domain elements somehow, so that they are recognised as atoms without this kind of problem? (Or mangle them by some other means...)",
    "created_at": "2013-03-21T08:51:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176196",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:17 ncohen]:
> Helloooooooooooooo !!!
> 
> Well, this does not solve the problem either Dima. In case of doubt between an element (a,b,c) and the list of elements (a,b,c) it will return the ELEMENT (a,b,c), but it it computes the orbit of a which happens to be (a,b,c) then returning an ELEMENT (a,b,c) instead of the list (a,b,c) is a mistake too `:-/`
> 

This does not seem to present a problem, as the action of the group is the same (trivial).

But the real problem is with tuples vs sets. E.g. if your domain has tuples, it will not be possible to compute the action on subsets.

Can't you typify the domain elements somehow, so that they are recognised as atoms without this kind of problem? (Or mangle them by some other means...)



---

archive/issue_comments_176197.json:
```json
{
    "body": "> Can't you typify the domain elements somehow, so that they are recognised as atoms without this kind of problem? (Or mangle them by some other means...)\n\nHmmmmmmmmm.... I have no idea how, an I would hate to have to use the Parent/Element stuff to do that `:-P`\n\nWell, I guess the best is to do as you first did and to split according to the value of `action`.\n\nBy the way, I noticed in the code source of `Graph.is_edge_transitive` a trick we could use there :\n\n\n```\n\"OrbitLength(\"+str(A._gap_())+\",Set(\" + str(e) + \"),OnSets);\"\n```\n\n\nIf we wrap the lists with a Set, then GAP itself reorders them and there is nothing to fear when giving sets at Sage level `:-)`\n\nNathann",
    "created_at": "2013-03-21T08:58:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176197",
    "user": "https://github.com/nathanncohen"
}
```

> Can't you typify the domain elements somehow, so that they are recognised as atoms without this kind of problem? (Or mangle them by some other means...)

Hmmmmmmmmm.... I have no idea how, an I would hate to have to use the Parent/Element stuff to do that `:-P`

Well, I guess the best is to do as you first did and to split according to the value of `action`.

By the way, I noticed in the code source of `Graph.is_edge_transitive` a trick we could use there :


```
"OrbitLength("+str(A._gap_())+",Set(" + str(e) + "),OnSets);"
```


If we wrap the lists with a Set, then GAP itself reorders them and there is nothing to fear when giving sets at Sage level `:-)`

Nathann



---

archive/issue_comments_176198.json:
```json
{
    "body": "Replying to [comment:19 ncohen]:\n> > Can't you typify the domain elements somehow, so that they are recognised as atoms without this kind of problem? (Or mangle them by some other means...)\n> \n> Hmmmmmmmmm.... I have no idea how, an I would hate to have to use the Parent/Element stuff to do that `:-P`\n> \n> Well, I guess the best is to do as you first did and to split according to the value of `action`.\nthis is too ugly, uglier than using a class, or whatever. Actually, I think it is simply wrong to let groups act on some totally unstructured arbitrary sh*t, and this is exactly what happens right now with allowing arbitrary domain elements, for which any relation to the original domain is lost.\n\nSay, if the domain of a group is {1,2,3,4,{1,2},{2,3}}, the very notion of the orbit of {1,2}  is becoming ambiguous, as in a sane world {1,2} is a subset of {1,2,3,4}, and not a random label.\n\nDima",
    "created_at": "2013-03-21T10:42:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176198",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:19 ncohen]:
> > Can't you typify the domain elements somehow, so that they are recognised as atoms without this kind of problem? (Or mangle them by some other means...)
> 
> Hmmmmmmmmm.... I have no idea how, an I would hate to have to use the Parent/Element stuff to do that `:-P`
> 
> Well, I guess the best is to do as you first did and to split according to the value of `action`.
this is too ugly, uglier than using a class, or whatever. Actually, I think it is simply wrong to let groups act on some totally unstructured arbitrary sh*t, and this is exactly what happens right now with allowing arbitrary domain elements, for which any relation to the original domain is lost.

Say, if the domain of a group is {1,2,3,4,{1,2},{2,3}}, the very notion of the orbit of {1,2}  is becoming ambiguous, as in a sane world {1,2} is a subset of {1,2,3,4}, and not a random label.

Dima



---

archive/issue_comments_176199.json:
```json
{
    "body": "Yoooooooooooo !\n\n> this is too ugly, uglier than using a class, or whatever. Actually, I think it is simply wrong to let groups act on some totally unstructured arbitrary sh*t, and this is exactly what happens right now with allowing arbitrary domain elements, for which any relation to the original domain is lost.\n\nAhahaha. Deal. Do I remove all support for labels on edges and vertices from graphs ? I am sooooooooooo eager to `:-P`\n\n> Say, if the domain of a group is {1,2,3,4,{1,2},{2,3}}, the very notion of the orbit of {1,2}  is becoming ambiguous, as in a sane world {1,2} is a subset of {1,2,3,4}, and not a random label.\n\nWell, in Sage however it is not ambiguous : \n\n```\ng.orbit(Set([1,2]),action=\"OnPoints\")\ng.orbit(Set([1,2]),action=\"OnSets\")\n```\n\n\nNathann",
    "created_at": "2013-03-21T10:44:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176199",
    "user": "https://github.com/nathanncohen"
}
```

Yoooooooooooo !

> this is too ugly, uglier than using a class, or whatever. Actually, I think it is simply wrong to let groups act on some totally unstructured arbitrary sh*t, and this is exactly what happens right now with allowing arbitrary domain elements, for which any relation to the original domain is lost.

Ahahaha. Deal. Do I remove all support for labels on edges and vertices from graphs ? I am sooooooooooo eager to `:-P`

> Say, if the domain of a group is {1,2,3,4,{1,2},{2,3}}, the very notion of the orbit of {1,2}  is becoming ambiguous, as in a sane world {1,2} is a subset of {1,2,3,4}, and not a random label.

Well, in Sage however it is not ambiguous : 

```
g.orbit(Set([1,2]),action="OnPoints")
g.orbit(Set([1,2]),action="OnSets")
```


Nathann



---

archive/issue_comments_176200.json:
```json
{
    "body": "Replying to [comment:21 ncohen]:\n> Yoooooooooooo !\n> \n> > this is too ugly, uglier than using a class, or whatever. Actually, I think it is simply wrong to let groups act on some totally unstructured arbitrary sh*t, and this is exactly what happens right now with allowing arbitrary domain elements, for which any relation to the original domain is lost.\n> \n> Ahahaha. Deal. Do I remove all support for labels on edges and vertices from graphs ? I am sooooooooooo eager to `:-P`\nI don't think this is relevant. Here we have an example of a group acting on triples, and this is a kind of \"primitive\" action, all the other actions originate from it.\n\nAnyhow, there is a hack which might fix all our sorrows: namely, add an extra level of () to the \"most primitive\" elements of the\ndomain. I.e. if instead of {1,2,3,4,{1,2},{2,3}} there was a domain `{{1},{2},{3},{4},{1,2},{2,3}}` then the ambiguity does not arise, for {1,2} and `{{1},{2}}` are different things now.\n\nDima\n\n> \n> > Say, if the domain of a group is {1,2,3,4,{1,2},{2,3}}, the very notion of the orbit of {1,2}  is becoming ambiguous, as in a sane world {1,2} is a subset of {1,2,3,4}, and not a random label.\n> \n> Well, in Sage however it is not ambiguous : \n> {{{\n> g.orbit(Set([1,2]),action=\"OnPoints\")\n> g.orbit(Set([1,2]),action=\"OnSets\")\n> }}}\n> \n> Nathann",
    "created_at": "2013-03-21T12:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176200",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:21 ncohen]:
> Yoooooooooooo !
> 
> > this is too ugly, uglier than using a class, or whatever. Actually, I think it is simply wrong to let groups act on some totally unstructured arbitrary sh*t, and this is exactly what happens right now with allowing arbitrary domain elements, for which any relation to the original domain is lost.
> 
> Ahahaha. Deal. Do I remove all support for labels on edges and vertices from graphs ? I am sooooooooooo eager to `:-P`
I don't think this is relevant. Here we have an example of a group acting on triples, and this is a kind of "primitive" action, all the other actions originate from it.

Anyhow, there is a hack which might fix all our sorrows: namely, add an extra level of () to the "most primitive" elements of the
domain. I.e. if instead of {1,2,3,4,{1,2},{2,3}} there was a domain `{{1},{2},{3},{4},{1,2},{2,3}}` then the ambiguity does not arise, for {1,2} and `{{1},{2}}` are different things now.

Dima

> 
> > Say, if the domain of a group is {1,2,3,4,{1,2},{2,3}}, the very notion of the orbit of {1,2}  is becoming ambiguous, as in a sane world {1,2} is a subset of {1,2,3,4}, and not a random label.
> 
> Well, in Sage however it is not ambiguous : 
> {{{
> g.orbit(Set([1,2]),action="OnPoints")
> g.orbit(Set([1,2]),action="OnSets")
> }}}
> 
> Nathann



---

archive/issue_comments_176201.json:
```json
{
    "body": "> I don't think this is relevant. Here we have an example of a group acting on triples, and this is a kind of \"primitive\" action, all the other actions originate from it.\n> \n> Anyhow, there is a hack which might fix all our sorrows: namely, add an extra level of () to the \"most primitive\" elements of the\n> domain. I.e. if instead of {1,2,3,4,{1,2},{2,3}} there was a domain `{{1},{2},{3},{4},{1,2},{2,3}}` then the ambiguity does not arise, for {1,2} and `{{1},{2}}` are different things now.\n\nCome on Dima. Let's just rewrite the method as it was previously... If the action is on points we know what to do, if it is on something else we also know what to do, case by case.\n\nIt's not worth adding another layer just for that ...\n\nNathann",
    "created_at": "2013-03-21T13:12:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176201",
    "user": "https://github.com/nathanncohen"
}
```

> I don't think this is relevant. Here we have an example of a group acting on triples, and this is a kind of "primitive" action, all the other actions originate from it.
> 
> Anyhow, there is a hack which might fix all our sorrows: namely, add an extra level of () to the "most primitive" elements of the
> domain. I.e. if instead of {1,2,3,4,{1,2},{2,3}} there was a domain `{{1},{2},{3},{4},{1,2},{2,3}}` then the ambiguity does not arise, for {1,2} and `{{1},{2}}` are different things now.

Come on Dima. Let's just rewrite the method as it was previously... If the action is on points we know what to do, if it is on something else we also know what to do, case by case.

It's not worth adding another layer just for that ...

Nathann



---

archive/issue_comments_176202.json:
```json
{
    "body": "Replying to [comment:23 ncohen]:\n> > I don't think this is relevant. Here we have an example of a group acting on triples, and this is a kind of \"primitive\" action, all the other actions originate from it.\n> > \n> > Anyhow, there is a hack which might fix all our sorrows: namely, add an extra level of () to the \"most primitive\" elements of the\n> > domain. I.e. if instead of {1,2,3,4,{1,2},{2,3}} there was a domain `{{1},{2},{3},{4},{1,2},{2,3}}` then the ambiguity does not arise, for {1,2} and `{{1},{2}}` are different things now.\n> \n> Come on Dima. Let's just rewrite the method as it was previously... If the action is on points we know what to do, if it is on something else we also know what to do, case by case.\n> \n> It's not worth adding another layer just for that ...\n\nit's for the general sanity of the setup. Let me post on sage-devel asking opinions, as I do think that this is a fundamental semantic problem of the design.\n\nNeedless to say, if I am declared insane there, then I would happily review whatever patch you would be willing to put here :)\n\nDima\n\n> \n> Nathann",
    "created_at": "2013-03-21T13:49:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176202",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:23 ncohen]:
> > I don't think this is relevant. Here we have an example of a group acting on triples, and this is a kind of "primitive" action, all the other actions originate from it.
> > 
> > Anyhow, there is a hack which might fix all our sorrows: namely, add an extra level of () to the "most primitive" elements of the
> > domain. I.e. if instead of {1,2,3,4,{1,2},{2,3}} there was a domain `{{1},{2},{3},{4},{1,2},{2,3}}` then the ambiguity does not arise, for {1,2} and `{{1},{2}}` are different things now.
> 
> Come on Dima. Let's just rewrite the method as it was previously... If the action is on points we know what to do, if it is on something else we also know what to do, case by case.
> 
> It's not worth adding another layer just for that ...

it's for the general sanity of the setup. Let me post on sage-devel asking opinions, as I do think that this is a fundamental semantic problem of the design.

Needless to say, if I am declared insane there, then I would happily review whatever patch you would be willing to put here :)

Dima

> 
> Nathann



---

archive/issue_comments_176203.json:
```json
{
    "body": "> Needless to say, if I am declared insane there, then I would happily review whatever patch you would be willing to put here :)\n\nIt is very kind of you but my patch for this ticket has been written for a while already. It has been delayed because you wanted to add more than I needed `:-P`\n\nNathann",
    "created_at": "2013-03-21T13:52:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176203",
    "user": "https://github.com/nathanncohen"
}
```

> Needless to say, if I am declared insane there, then I would happily review whatever patch you would be willing to put here :)

It is very kind of you but my patch for this ticket has been written for a while already. It has been delayed because you wanted to add more than I needed `:-P`

Nathann



---

archive/issue_comments_176204.json:
```json
{
    "body": "Replying to [comment:25 ncohen]:\n> > Needless to say, if I am declared insane there, then I would happily review whatever patch you would be willing to put here :)\n> \n> It is very kind of you but my patch for this ticket has been written for a while already. It has been delayed because you wanted to add more than I needed `:-P`\n\nThe curiosity of the reviewer is sacred, don't you think so? :-)\n\nBesides, it's easy to backport the patch here directly into the smallgraphs patch it came from, and put this ticket on hold.\n\nDima\n\n\n> \n> Nathann",
    "created_at": "2013-03-21T14:32:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176204",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:25 ncohen]:
> > Needless to say, if I am declared insane there, then I would happily review whatever patch you would be willing to put here :)
> 
> It is very kind of you but my patch for this ticket has been written for a while already. It has been delayed because you wanted to add more than I needed `:-P`

The curiosity of the reviewer is sacred, don't you think so? :-)

Besides, it's easy to backport the patch here directly into the smallgraphs patch it came from, and put this ticket on hold.

Dima


> 
> Nathann



---

archive/issue_comments_176205.json:
```json
{
    "body": "> The curiosity of the reviewer is sacred, don't you think so? :-)\n\nIt is.\n\n> Besides, it's easy to backport the patch here directly into the smallgraphs patch it came from, and put this ticket on hold.\n\nOh, you are worried about #14283 ? I really don't need it, I write this kind of patches when I spent too much time thinking and cannot do anything useful anymore with my head. So I try to build a graph. But if it is not merged in the next ten months I do not mind at all. It is written somewhere, it is reviewed, my part has been done `:-)`\n\nBut still, I would love this patch to be available in Sage. And #14319 even more `:-)`\n\nNathann",
    "created_at": "2013-03-21T14:36:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176205",
    "user": "https://github.com/nathanncohen"
}
```

> The curiosity of the reviewer is sacred, don't you think so? :-)

It is.

> Besides, it's easy to backport the patch here directly into the smallgraphs patch it came from, and put this ticket on hold.

Oh, you are worried about #14283 ? I really don't need it, I write this kind of patches when I spent too much time thinking and cannot do anything useful anymore with my head. So I try to build a graph. But if it is not merged in the next ten months I do not mind at all. It is written somewhere, it is reviewed, my part has been done `:-)`

But still, I would love this patch to be available in Sage. And #14319 even more `:-)`

Nathann



---

archive/issue_comments_176206.json:
```json
{
    "body": "1. ``@`cached_method` must not return lists, but only immutable things\n   {{{\nsage: S3.orbit(3)\n[3, 1, 2]\nsage: type(_)\nlist\n}}}\n   Just return a tuple.\n\n2. It would be nice if orbit were smarter about the action type and make the output a set/tuple if necessary. For example, desirable behaviour would be\n   {{{\nsage: S3.orbit(3)       # in domain, use OnPoints\n(1, 2, 3)\nsage: S3.orbit((1,2))   # not in domain, a tuple, use OnTuples\n((1, 2), (2, 3), (2, 1), (3, 1), (1, 3), (3, 2))\nsage: S3.orbit({1,2})   # not in domain, a set, use OnSets\n({1, 2}, {2, 3}, {1, 3})\n}}}",
    "created_at": "2013-03-22T08:52:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176206",
    "user": "https://github.com/vbraun"
}
```

1. ``@`cached_method` must not return lists, but only immutable things
   {{{
sage: S3.orbit(3)
[3, 1, 2]
sage: type(_)
list
}}}
   Just return a tuple.

2. It would be nice if orbit were smarter about the action type and make the output a set/tuple if necessary. For example, desirable behaviour would be
   {{{
sage: S3.orbit(3)       # in domain, use OnPoints
(1, 2, 3)
sage: S3.orbit((1,2))   # not in domain, a tuple, use OnTuples
((1, 2), (2, 3), (2, 1), (3, 1), (1, 3), (3, 2))
sage: S3.orbit({1,2})   # not in domain, a set, use OnSets
({1, 2}, {2, 3}, {1, 3})
}}}



---

archive/issue_comments_176207.json:
```json
{
    "body": "Replying to [comment:28 vbraun]:\n> 1. ``@`cached_method` must not return lists, but only immutable things\nOK, this should be easy.\n\n> 2. It would be nice if orbit were smarter about the action type and make the output a set/tuple if necessary. \nsure, this is also easy with the design I advocate (duck-typing). Given that the other ticket author is not happy with it, there are options (in no particular order):\n\n1. I proceed with my design, and include a workaround that does the rewriting of the domain (\"boxing\" things up), before doing the orbit and action computation. (Which is not very efficient, as it essentially involves recreating group domain and its GAP counterparts)\n\n   2.  We convince the other author that I am right, and drop the workaround.\n\n   3. Somebody (not me) designs a G-set type/class framework to handle the issue.\n\n   4. You convince me that I am wrong, and it's perfectly kosher to have domains like plain tuples (1,2,{1,2},...), and creating intransitive actions is more work than just appending permutations.",
    "created_at": "2013-03-22T13:26:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176207",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:28 vbraun]:
> 1. ``@`cached_method` must not return lists, but only immutable things
OK, this should be easy.

> 2. It would be nice if orbit were smarter about the action type and make the output a set/tuple if necessary. 
sure, this is also easy with the design I advocate (duck-typing). Given that the other ticket author is not happy with it, there are options (in no particular order):

1. I proceed with my design, and include a workaround that does the rewriting of the domain ("boxing" things up), before doing the orbit and action computation. (Which is not very efficient, as it essentially involves recreating group domain and its GAP counterparts)

   2.  We convince the other author that I am right, and drop the workaround.

   3. Somebody (not me) designs a G-set type/class framework to handle the issue.

   4. You convince me that I am wrong, and it's perfectly kosher to have domains like plain tuples (1,2,{1,2},...), and creating intransitive actions is more work than just appending permutations.



---

archive/issue_comments_176208.json:
```json
{
    "body": ">    2.  We convince the other author that I am right, and drop the workaround.\n\nCome on Dima, you do understand that on some instances your patch could return bad answers, do you ?\n\nWhat's the problem with gessing the \"depth\" of input/output according to the value of `action` ?\n\nNathann",
    "created_at": "2013-03-22T13:37:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176208",
    "user": "https://github.com/nathanncohen"
}
```

>    2.  We convince the other author that I am right, and drop the workaround.

Come on Dima, you do understand that on some instances your patch could return bad answers, do you ?

What's the problem with gessing the "depth" of input/output according to the value of `action` ?

Nathann



---

archive/issue_comments_176209.json:
```json
{
    "body": "Replying to [comment:30 ncohen]:\n> >    2.  We convince the other author that I am right, and drop the workaround.\n> \n> Come on Dima, you do understand that on some instances your patch could return bad answers, do you ?\n\nOn wrong instances, yes. On instances like (1,2,{1,2},...), which make no sense, because they lead to horrible bugs. Here is how.\n\nTake, say, directed 3-cycle, and label its vertices, in the cyclic order, 1, 2, (1,2). So you get G=Z_3, the automorphism group of this digraph, acting on the domain V=(1,2,(1,2)).  Next, ask for the orbit of the **arc** (1,2) of the digraph under G. OK, fine, it is A=((1,2),(2,(1,2)),((1,2),1). Now, note that the intersection of V and A equals {(1,2)}. The intersection of two distinct orbits of a group is not empty...\n\nWould \u00c9variste Galois raise from his grave and chase the designer of this? :\u2013)\n\n**Edit.** Or implement the action on tuples of tuples, and ask for the orbit of ((1,2),(1,2)).\n\n\n> \n> What's the problem with gessing the \"depth\" of input/output according to the value of `action` ?\n\nthis won't fix the bug above.\n\nDima\n\n> \n> Nathann",
    "created_at": "2013-03-22T14:21:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176209",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:30 ncohen]:
> >    2.  We convince the other author that I am right, and drop the workaround.
> 
> Come on Dima, you do understand that on some instances your patch could return bad answers, do you ?

On wrong instances, yes. On instances like (1,2,{1,2},...), which make no sense, because they lead to horrible bugs. Here is how.

Take, say, directed 3-cycle, and label its vertices, in the cyclic order, 1, 2, (1,2). So you get G=Z_3, the automorphism group of this digraph, acting on the domain V=(1,2,(1,2)).  Next, ask for the orbit of the **arc** (1,2) of the digraph under G. OK, fine, it is A=((1,2),(2,(1,2)),((1,2),1). Now, note that the intersection of V and A equals {(1,2)}. The intersection of two distinct orbits of a group is not empty...

Would Évariste Galois raise from his grave and chase the designer of this? :–)

**Edit.** Or implement the action on tuples of tuples, and ask for the orbit of ((1,2),(1,2)).


> 
> What's the problem with gessing the "depth" of input/output according to the value of `action` ?

this won't fix the bug above.

Dima

> 
> Nathann



---

archive/issue_comments_176210.json:
```json
{
    "body": "> Take, say, directed 3-cycle, and label its vertices, in the cyclic order, 1, 2, (1,2). So you get G=Z_3, the automorphism group of this digraph, acting on the domain V=(1,2,(1,2)).  Next, ask for the orbit of the **arc** (1,2) of the digraph under G. OK, fine, it is A=((1,2),(2,(1,2)),((1,2),1). Now, note that the intersection of V and A equals {(1,2)}. The intersection of two distinct orbits of a group is not empty...\n\nAhahaahah. Yeah, it looks like you need to guess somewhere that the element (1,2) is not equal to the set containing the two elements 1 and 2 `:-)`\n\n> Would \u00c9variste Galois raise from his grave and chase the designer of this? :\u2013)\n\nIf he does I will help !\n\n> > What's the problem with gessing the \"depth\" of input/output according to the value of `action` ?\n> \n> this won't fix the bug above.\n\nThat's true. But the two problems are totally unrelated, though ! In the current state of things, guessing the value of action as Volker said and translating input/output according to what is what we can do best. Then you will have to hand your beloved groups over to the combinat guys who will make a hell out of it, and I hope that everything I need from groups will be written before they make this impossible to use with their parent/element framework.\n\nNathann",
    "created_at": "2013-03-22T14:39:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176210",
    "user": "https://github.com/nathanncohen"
}
```

> Take, say, directed 3-cycle, and label its vertices, in the cyclic order, 1, 2, (1,2). So you get G=Z_3, the automorphism group of this digraph, acting on the domain V=(1,2,(1,2)).  Next, ask for the orbit of the **arc** (1,2) of the digraph under G. OK, fine, it is A=((1,2),(2,(1,2)),((1,2),1). Now, note that the intersection of V and A equals {(1,2)}. The intersection of two distinct orbits of a group is not empty...

Ahahaahah. Yeah, it looks like you need to guess somewhere that the element (1,2) is not equal to the set containing the two elements 1 and 2 `:-)`

> Would Évariste Galois raise from his grave and chase the designer of this? :–)

If he does I will help !

> > What's the problem with gessing the "depth" of input/output according to the value of `action` ?
> 
> this won't fix the bug above.

That's true. But the two problems are totally unrelated, though ! In the current state of things, guessing the value of action as Volker said and translating input/output according to what is what we can do best. Then you will have to hand your beloved groups over to the combinat guys who will make a hell out of it, and I hope that everything I need from groups will be written before they make this impossible to use with their parent/element framework.

Nathann



---

archive/issue_comments_176211.json:
```json
{
    "body": "Replying to [comment:32 ncohen]:\n[...]\n> \n> Ahahaahah. Yeah, it looks like you need to guess somewhere that the element (1,2) is not equal to the set containing the two elements 1 and 2 `:-)`\n\neasy, as I said: just replace domain elements 1 and  2 by (1) and (2), and everything all of a sudden works. The alternative is to give yourself over to the category theory and practice...\n\n> \n> > Would \u00c9variste Galois raise from his grave and chase the designer of this? :\u2013)\n> \n> If he does I will help !\nI won't bet on this, for he might get hold of more powerful weapon than he used during that unfortunate duel, you know :\u2013)\n\n> \n> > > What's the problem with gessing the \"depth\" of input/output according to the value of `action` ?\n> > \n> > this won't fix the bug above.\n> \n> That's true. But the two problems are totally unrelated, though ! \n\nof course they are related, as the code in question works fine on the sane inputs, and there is nothing to fix then.",
    "created_at": "2013-03-22T14:54:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176211",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:32 ncohen]:
[...]
> 
> Ahahaahah. Yeah, it looks like you need to guess somewhere that the element (1,2) is not equal to the set containing the two elements 1 and 2 `:-)`

easy, as I said: just replace domain elements 1 and  2 by (1) and (2), and everything all of a sudden works. The alternative is to give yourself over to the category theory and practice...

> 
> > Would Évariste Galois raise from his grave and chase the designer of this? :–)
> 
> If he does I will help !
I won't bet on this, for he might get hold of more powerful weapon than he used during that unfortunate duel, you know :–)

> 
> > > What's the problem with gessing the "depth" of input/output according to the value of `action` ?
> > 
> > this won't fix the bug above.
> 
> That's true. But the two problems are totally unrelated, though ! 

of course they are related, as the code in question works fine on the sane inputs, and there is nothing to fix then.



---

archive/issue_comments_176212.json:
```json
{
    "body": "> easy, as I said: just replace domain elements 1 and  2 by (1) and (2), and everything all of a sudden works. The alternative is to give yourself over to the category theory and practice...\n\nYeah but it's the same problem then. My vertices are not the elements of the automorphism group. That's a problem.\n\nNathann",
    "created_at": "2013-03-22T15:05:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176212",
    "user": "https://github.com/nathanncohen"
}
```

> easy, as I said: just replace domain elements 1 and  2 by (1) and (2), and everything all of a sudden works. The alternative is to give yourself over to the category theory and practice...

Yeah but it's the same problem then. My vertices are not the elements of the automorphism group. That's a problem.

Nathann



---

archive/issue_comments_176213.json:
```json
{
    "body": "Replying to [comment:34 ncohen]:\n> > easy, as I said: just replace domain elements 1 and  2 by (1) and (2), and everything all of a sudden works. The alternative is to give yourself over to the category theory and practice...\n> \n> Yeah but it's the same problem then. My vertices are not the elements of the automorphism group. That's a problem.\n\nsorry, I don't understand. I never suggested labeling anything by group elements.\n\n> \n> Nathann",
    "created_at": "2013-03-22T15:11:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176213",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:34 ncohen]:
> > easy, as I said: just replace domain elements 1 and  2 by (1) and (2), and everything all of a sudden works. The alternative is to give yourself over to the category theory and practice...
> 
> Yeah but it's the same problem then. My vertices are not the elements of the automorphism group. That's a problem.

sorry, I don't understand. I never suggested labeling anything by group elements.

> 
> Nathann



---

archive/issue_comments_176214.json:
```json
{
    "body": "You can also solve your problem above by saying that the intersection of an orbit of a vertex and the orbit of an edge is empty. And you can guess that because you computed the first with `action=\"OnPoints\"` and the second with `action=\"OnSets\"`.\n\nNathann",
    "created_at": "2013-03-22T15:12:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176214",
    "user": "https://github.com/nathanncohen"
}
```

You can also solve your problem above by saying that the intersection of an orbit of a vertex and the orbit of an edge is empty. And you can guess that because you computed the first with `action="OnPoints"` and the second with `action="OnSets"`.

Nathann



---

archive/issue_comments_176215.json:
```json
{
    "body": "> sorry, I don't understand. I never suggested labeling anything by group elements.\n\nThen how do you apply your problem to this patch ? How do we solve this ? I claim that there is nothing wrong going on for as long as there is an \"action\" argument somewhere which defines how output and input are to be interpreted.\n\nNathann",
    "created_at": "2013-03-22T15:15:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176215",
    "user": "https://github.com/nathanncohen"
}
```

> sorry, I don't understand. I never suggested labeling anything by group elements.

Then how do you apply your problem to this patch ? How do we solve this ? I claim that there is nothing wrong going on for as long as there is an "action" argument somewhere which defines how output and input are to be interpreted.

Nathann



---

archive/issue_comments_176216.json:
```json
{
    "body": "Here's a new patch for what this ticket initially addressed, after the looooooong discussion on sage-devel [1]. #14283 and (more importantly) #14319 depend on this ticket !\n\nNathann\n\n[1] https://groups.google.com/d/topic/sage-devel/LRZULwy5KYI/discussion",
    "created_at": "2013-03-26T14:46:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176216",
    "user": "https://github.com/nathanncohen"
}
```

Here's a new patch for what this ticket initially addressed, after the looooooong discussion on sage-devel [1]. #14283 and (more importantly) #14319 depend on this ticket !

Nathann

[1] https://groups.google.com/d/topic/sage-devel/LRZULwy5KYI/discussion



---

archive/issue_comments_176217.json:
```json
{
    "body": "Apply trac_14291-v2.patch",
    "created_at": "2013-03-26T14:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176217",
    "user": "https://github.com/nathanncohen"
}
```

Apply trac_14291-v2.patch



---

archive/issue_comments_176218.json:
```json
{
    "body": "Attachment [trac_14291-v2.patch](tarball://root/attachments/some-uuid/ticket14291/trac_14291-v2.patch) by @nathanncohen created at 2013-04-01 23:07:31",
    "created_at": "2013-04-01T23:07:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176218",
    "user": "https://github.com/nathanncohen"
}
```

Attachment [trac_14291-v2.patch](tarball://root/attachments/some-uuid/ticket14291/trac_14291-v2.patch) by @nathanncohen created at 2013-04-01 23:07:31



---

archive/issue_comments_176219.json:
```json
{
    "body": "Can we make `orbit` return a tuple intstead of a list? As I mentioned before, ``@`cached_method`s must not return mutable containers.",
    "created_at": "2013-04-11T10:56:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176219",
    "user": "https://github.com/vbraun"
}
```

Can we make `orbit` return a tuple intstead of a list? As I mentioned before, ``@`cached_method`s must not return mutable containers.



---

archive/issue_comments_176220.json:
```json
{
    "body": "I've cleaned up some stuff and beautified the output containers (as we talked about before):\n\n```\nsage: S3 = groups.permutation.Symmetric(3) \nsage: S3.orbit((1,2), action = \"OnSets\") \n({1, 2}, {2, 3}, {1, 3}) \nsage: S3.orbit((1,2), action = \"OnTuples\") \n((1, 2), (2, 3), (2, 1), (3, 1), (1, 3), (3, 2)) \n```\n\nI'm fine with everything else, so if you agree with the reviewer patch feel free to set it to positive review.\n\nFor the patchbot:\nApply trac_14291-v2.patch, trac_14291_reviewer.patch",
    "created_at": "2013-04-11T13:02:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176220",
    "user": "https://github.com/vbraun"
}
```

I've cleaned up some stuff and beautified the output containers (as we talked about before):

```
sage: S3 = groups.permutation.Symmetric(3) 
sage: S3.orbit((1,2), action = "OnSets") 
({1, 2}, {2, 3}, {1, 3}) 
sage: S3.orbit((1,2), action = "OnTuples") 
((1, 2), (2, 3), (2, 1), (3, 1), (1, 3), (3, 2)) 
```

I'm fine with everything else, so if you agree with the reviewer patch feel free to set it to positive review.

For the patchbot:
Apply trac_14291-v2.patch, trac_14291_reviewer.patch



---

archive/issue_comments_176221.json:
```json
{
    "body": "Helloooooooooooooooo !!!\n\nThere is a \"permutatino\" somewhere. Could you also replace `x = sorted(x)` with ``x.sort()` ?\n\nThis being said, your patch does not apply on my version of Sage... But I still use beta1, perhaps that's the reason why.\n\nNathann",
    "created_at": "2013-04-11T13:12:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176221",
    "user": "https://github.com/nathanncohen"
}
```

Helloooooooooooooooo !!!

There is a "permutatino" somewhere. Could you also replace `x = sorted(x)` with ``x.sort()` ?

This being said, your patch does not apply on my version of Sage... But I still use beta1, perhaps that's the reason why.

Nathann



---

archive/issue_comments_176222.json:
```json
{
    "body": "Attachment [trac_14291_reviewer.2.patch](tarball://root/attachments/some-uuid/ticket14291/trac_14291_reviewer.2.patch) by @vbraun created at 2013-04-11 18:22:57\n\nUpdated patch",
    "created_at": "2013-04-11T18:22:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176222",
    "user": "https://github.com/vbraun"
}
```

Attachment [trac_14291_reviewer.2.patch](tarball://root/attachments/some-uuid/ticket14291/trac_14291_reviewer.2.patch) by @vbraun created at 2013-04-11 18:22:57

Updated patch



---

archive/issue_comments_176223.json:
```json
{
    "body": "Ok, fixed. Applies cleanly on sage-5.9.beta5.",
    "created_at": "2013-04-11T18:23:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176223",
    "user": "https://github.com/vbraun"
}
```

Ok, fixed. Applies cleanly on sage-5.9.beta5.



---

archive/issue_comments_176224.json:
```json
{
    "body": "Ok all doctests pass on sage-5.9.beta5.\n\nPatchbot:\nApply trac_14291-v2.patch, trac_14291_reviewer.patch",
    "created_at": "2013-04-11T19:35:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176224",
    "user": "https://github.com/vbraun"
}
```

Ok all doctests pass on sage-5.9.beta5.

Patchbot:
Apply trac_14291-v2.patch, trac_14291_reviewer.patch



---

archive/issue_comments_176225.json:
```json
{
    "body": "> Ok all doctests pass on sage-5.9.beta5.\n\nDoesn't apply on my beta5 `:-/`\n\nDo you have anything else applied ?\n\nNathann",
    "created_at": "2013-04-11T21:38:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176225",
    "user": "https://github.com/nathanncohen"
}
```

> Ok all doctests pass on sage-5.9.beta5.

Doesn't apply on my beta5 `:-/`

Do you have anything else applied ?

Nathann



---

archive/issue_comments_176226.json:
```json
{
    "body": "Ok was based on an older version of your patch (we can't switch to git fast enough ;-)\n\nWorks now.",
    "created_at": "2013-04-11T21:54:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176226",
    "user": "https://github.com/vbraun"
}
```

Ok was based on an older version of your patch (we can't switch to git fast enough ;-)

Works now.



---

archive/issue_comments_176227.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-04-11T21:59:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176227",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_176228.json:
```json
{
    "body": "Well, then... `:-)`\n\nNathann",
    "created_at": "2013-04-11T21:59:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176228",
    "user": "https://github.com/nathanncohen"
}
```

Well, then... `:-)`

Nathann



---

archive/issue_comments_176229.json:
```json
{
    "body": "I'm glad to hear that it's done, and sorry for dropping silent on this - too many deadlines lately.\n\nDima",
    "created_at": "2013-04-12T06:54:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176229",
    "user": "https://github.com/dimpase"
}
```

I'm glad to hear that it's done, and sorry for dropping silent on this - too many deadlines lately.

Dima



---

archive/issue_comments_176230.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-04-12T09:09:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176230",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_176231.json:
```json
{
    "body": "The documentation doesn't build properly:\n\n```\ndochtml.log:[groups   ] /mazur/release/merger/sage-5.10.beta0/local/lib/python2.7/site-packages/sage/groups/perm_gps/permgroup.py:docstring of sage.groups.perm_gps.permgroup.PermutationGroup_generic.orbit:12: ERROR: Unknown target name: \"http://www.gap-system.org/manuals/doc/ref/chap41.html\".\n```\n",
    "created_at": "2013-04-12T09:09:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176231",
    "user": "https://github.com/jdemeyer"
}
```

The documentation doesn't build properly:

```
dochtml.log:[groups   ] /mazur/release/merger/sage-5.10.beta0/local/lib/python2.7/site-packages/sage/groups/perm_gps/permgroup.py:docstring of sage.groups.perm_gps.permgroup.PermutationGroup_generic.orbit:12: ERROR: Unknown target name: "http://www.gap-system.org/manuals/doc/ref/chap41.html".
```




---

archive/issue_comments_176232.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2013-04-12T10:21:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176232",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_176233.json:
```json
{
    "body": "I've replaced the link (which is not stable as the GAP chapter numbers can change) with a reference to our `gap.help('Group Actions')` command.",
    "created_at": "2013-04-12T10:21:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176233",
    "user": "https://github.com/vbraun"
}
```

I've replaced the link (which is not stable as the GAP chapter numbers can change) with a reference to our `gap.help('Group Actions')` command.



---

archive/issue_comments_176234.json:
```json
{
    "body": "Attachment [trac_14291_reviewer.patch](tarball://root/attachments/some-uuid/ticket14291/trac_14291_reviewer.patch) by @vbraun created at 2013-04-12 10:24:26\n\nUpdated patch",
    "created_at": "2013-04-12T10:24:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176234",
    "user": "https://github.com/vbraun"
}
```

Attachment [trac_14291_reviewer.patch](tarball://root/attachments/some-uuid/ticket14291/trac_14291_reviewer.patch) by @vbraun created at 2013-04-12 10:24:26

Updated patch



---

archive/issue_comments_176235.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-04-15T08:43:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176235",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_176236.json:
```json
{
    "body": "Cooooooooool `:-D`\n\nNathann",
    "created_at": "2013-04-15T08:50:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176236",
    "user": "https://github.com/nathanncohen"
}
```

Cooooooooool `:-D`

Nathann



---

archive/issue_comments_176237.json:
```json
{
    "body": "Shouldn't `\"OnSets\"` return sorted things? See e.g. the related issue on #14283.",
    "created_at": "2013-04-27T05:34:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14087",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14087#issuecomment-176237",
    "user": "https://github.com/dimpase"
}
```

Shouldn't `"OnSets"` return sorted things? See e.g. the related issue on #14283.
