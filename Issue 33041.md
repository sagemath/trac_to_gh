# Issue 33041: Adapt Macaulay2 interface doctests to Macaulay2 1.19

archive/issues_033041.json:
```json
{
    "body": "CC:  @sheerluck slelievre\n\nWe adapt the Macaulay2 interface doctests\nto Macaulay2 1.19.\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/33278\n\n",
    "created_at": "2022-02-02T20:59:51Z",
    "labels": [
        "interfaces: optional",
        "major",
        "enhancement"
    ],
    "title": "Adapt Macaulay2 interface doctests to Macaulay2 1.19",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33041",
    "user": "@sheerluck"
}
```
CC:  @sheerluck slelievre

We adapt the Macaulay2 interface doctests
to Macaulay2 1.19.


Issue created by migration from https://trac.sagemath.org/ticket/33278





---

archive/issue_comments_471150.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-02-02T21:00:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33041#issuecomment-471150",
    "user": "slelievre"
}
```

New commits:



---

archive/issue_comments_471151.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-02-02T21:00:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33041#issuecomment-471151",
    "user": "slelievre"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_471152.json:
```json
{
    "body": "Changing keywords from \"\" to \"Macaulay2\".",
    "created_at": "2022-02-02T21:00:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33041#issuecomment-471152",
    "user": "slelievre"
}
```

Changing keywords from "" to "Macaulay2".



---

archive/issue_comments_471153.json:
```json
{
    "body": "I am still on Macaulay2 1.18, but also see the following failure. Is it present on your version as well?\n\n\n```\nsage -t --long --warn-long 68.6 --random-seed=245635289622745159370984825397477042598 src/sage/rings/ideal.py\n**********************************************************************\nFile \"src/sage/rings/ideal.py\", line 1185, in sage.rings.ideal.Ideal_generic._macaulay2_init_\nFailed example:\n    macaulay2(ideal(QQ(5)))                   # optional - macaulay2\nExpected:\n    ideal 1\nGot:\n    doctest:warning\n    ...\n    :\n    UserWarning: Constructing an ideal in Rational Field, which is a field. Did you intend to take numerators first? This warning can be muted by passing the base ring to Ideal() explicitly.\n    ideal 1\n```\n",
    "created_at": "2022-02-03T08:04:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33041#issuecomment-471153",
    "user": "@mwageringel"
}
```

I am still on Macaulay2 1.18, but also see the following failure. Is it present on your version as well?


```
sage -t --long --warn-long 68.6 --random-seed=245635289622745159370984825397477042598 src/sage/rings/ideal.py
**********************************************************************
File "src/sage/rings/ideal.py", line 1185, in sage.rings.ideal.Ideal_generic._macaulay2_init_
Failed example:
    macaulay2(ideal(QQ(5)))                   # optional - macaulay2
Expected:
    ideal 1
Got:
    doctest:warning
    ...
    :
    UserWarning: Constructing an ideal in Rational Field, which is a field. Did you intend to take numerators first? This warning can be muted by passing the base ring to Ideal() explicitly.
    ideal 1
```




---

archive/issue_comments_471154.json:
```json
{
    "body": "Replying to [comment:2 gh-mwageringel]:\n>Is it present on your version as well?\nyes\n\n```\n      File \"<doctest sage.rings.ideal.Ideal_generic._macaulay2_init_[10]>\", line 1, in <module>\n        macaulay2(ideal(QQ(Integer(5))))                   # optional - macaulay2\n      File \"/usr/lib/python3.10/site-packages/sage/rings/ideal.py\", line 197, in Ideal\n        warnings.warn(f'Constructing an ideal in {R}, which is a field.'\n      File \"/usr/lib/python3.10/warnings.py\", line 109, in _showwarnmsg\n        sw(msg.message, msg.category, msg.filename, msg.lineno,\n    :\n    UserWarning: Constructing an ideal in Rational Field, which is a field. Did you intend to take numerators first? This warning can be muted by passing the base ring to Ideal() explicitly.\n    ideal 1\n**********************************************************************\n1 item had failures:\n   1 of  17 in sage.rings.ideal.Ideal_generic._macaulay2_init_\n    0 tests not run because we ran out of time\n    [373 tests, 1 failure, 2.79 s]\n```\n",
    "created_at": "2022-02-03T09:15:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33041#issuecomment-471154",
    "user": "@sheerluck"
}
```

Replying to [comment:2 gh-mwageringel]:
>Is it present on your version as well?
yes

```
      File "<doctest sage.rings.ideal.Ideal_generic._macaulay2_init_[10]>", line 1, in <module>
        macaulay2(ideal(QQ(Integer(5))))                   # optional - macaulay2
      File "/usr/lib/python3.10/site-packages/sage/rings/ideal.py", line 197, in Ideal
        warnings.warn(f'Constructing an ideal in {R}, which is a field.'
      File "/usr/lib/python3.10/warnings.py", line 109, in _showwarnmsg
        sw(msg.message, msg.category, msg.filename, msg.lineno,
    :
    UserWarning: Constructing an ideal in Rational Field, which is a field. Did you intend to take numerators first? This warning can be muted by passing the base ring to Ideal() explicitly.
    ideal 1
**********************************************************************
1 item had failures:
   1 of  17 in sage.rings.ideal.Ideal_generic._macaulay2_init_
    0 tests not run because we ran out of time
    [373 tests, 1 failure, 2.79 s]
```




---

archive/issue_comments_471155.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-05T13:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33041#issuecomment-471155",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_471156.json:
```json
{
    "body": "Thank you for the doctest fixes. I have resolved the problem in `ideal.py` \u2013 the warning comes from Sage and was introduced by #32320, so can be ignored in this doctest.\n\nMoreover, I have altered two tests in the interface to make them compatible with both 1.18 and 1.19. Then I can enable these tests on the patchbot again.\n\nIf you agree with these changes, we can set this ticket to positive.",
    "created_at": "2022-02-05T13:35:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33041#issuecomment-471156",
    "user": "@mwageringel"
}
```

Thank you for the doctest fixes. I have resolved the problem in `ideal.py` â€“ the warning comes from Sage and was introduced by #32320, so can be ignored in this doctest.

Moreover, I have altered two tests in the interface to make them compatible with both 1.18 and 1.19. Then I can enable these tests on the patchbot again.

If you agree with these changes, we can set this ticket to positive.



---

archive/issue_comments_471157.json:
```json
{
    "body": "\n```\nsage -t --long --random-seed=19 interfaces/macaulay2.py\n    2 not tested tests not run\n    0 tests not run because we ran out of time\n    [296 tests, 19.94 s]\n----------------------------------------------------------------------\nAll tests passed!\n\nsage -t --long --random-seed=19 rings/ideal.py\n    0 tests not run because we ran out of time\n    [374 tests, 3.02 s]\n----------------------------------------------------------------------\nAll tests passed!\n```\n\nThank you, tests are compatible with both 1.18 and 1.19.",
    "created_at": "2022-02-05T15:17:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33041#issuecomment-471157",
    "user": "@sheerluck"
}
```


```
sage -t --long --random-seed=19 interfaces/macaulay2.py
    2 not tested tests not run
    0 tests not run because we ran out of time
    [296 tests, 19.94 s]
----------------------------------------------------------------------
All tests passed!

sage -t --long --random-seed=19 rings/ideal.py
    0 tests not run because we ran out of time
    [374 tests, 3.02 s]
----------------------------------------------------------------------
All tests passed!
```

Thank you, tests are compatible with both 1.18 and 1.19.



---

archive/issue_comments_471158.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-02-05T15:17:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33041#issuecomment-471158",
    "user": "@sheerluck"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_471159.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-02-16T23:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33041#issuecomment-471159",
    "user": "vbraun"
}
```

Resolution: fixed
