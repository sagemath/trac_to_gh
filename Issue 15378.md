# Issue 15378: Put ATLAS archdef tarballs into patches/ARCHS

archive/issues_015378.json:
```json
{
    "body": "CC:  @vbraun @dimpase\n\nKeywords: atlas spkg archdef\n\nNot sure why but it seems the tarballs we shipped did not make the git transition.\n\nIssue created by migration from https://trac.sagemath.org/ticket/15615\n\n",
    "created_at": "2014-01-01T17:23:20Z",
    "labels": [
        "packages: standard",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "Put ATLAS archdef tarballs into patches/ARCHS",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15378",
    "user": "jpflori"
}
```
CC:  @vbraun @dimpase

Keywords: atlas spkg archdef

Not sure why but it seems the tarballs we shipped did not make the git transition.

Issue created by migration from https://trac.sagemath.org/ticket/15615





---

archive/issue_comments_198363.json:
```json
{
    "body": "Ive take the opportunity to add an ARM archdef tarball as provided at http://math-atlas.sourceforge.net/errata.html#armhardfp\n----\nNew commits:",
    "created_at": "2014-01-01T17:30:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198363",
    "user": "jpflori"
}
```

Ive take the opportunity to add an ARM archdef tarball as provided at http://math-atlas.sourceforge.net/errata.html#armhardfp
----
New commits:



---

archive/issue_comments_198364.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-01-01T17:30:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198364",
    "user": "jpflori"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_198365.json:
```json
{
    "body": "Changing keywords from \"atlas spkg archdef\" to \"atlas spkg archdef cygwin\".",
    "created_at": "2014-01-02T20:54:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198365",
    "user": "jpflori"
}
```

Changing keywords from "atlas spkg archdef" to "atlas spkg archdef cygwin".



---

archive/issue_comments_198366.json:
```json
{
    "body": "The ATLAS-lib issue is surely my bad as it is already wrong in the sage 5.13 tarball...\nThis make ATLAS not so useful on Cygwin, whence the severity change.",
    "created_at": "2014-01-02T20:54:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198366",
    "user": "jpflori"
}
```

The ATLAS-lib issue is surely my bad as it is already wrong in the sage 5.13 tarball...
This make ATLAS not so useful on Cygwin, whence the severity change.



---

archive/issue_comments_198367.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2014-01-02T20:54:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198367",
    "user": "jpflori"
}
```

Changing priority from major to critical.



---

archive/issue_comments_198368.json:
```json
{
    "body": "Since we have to make our own ATLAS tarball anyways to embed lapack, I would be in favor of putting the archdef tarballs in there as well. Even though they are small, they are still binary stuff that we should keep out of the repo if possible.",
    "created_at": "2014-01-03T06:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198368",
    "user": "@vbraun"
}
```

Since we have to make our own ATLAS tarball anyways to embed lapack, I would be in favor of putting the archdef tarballs in there as well. Even though they are small, they are still binary stuff that we should keep out of the repo if possible.



---

archive/issue_comments_198369.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-01-03T12:36:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198369",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_198370.json:
```json
{
    "body": "Replying to [comment:3 vbraun]:\n> Since we have to make our own ATLAS tarball anyways to embed lapack, I would be in favor of putting the archdef tarballs in there as well. Even though they are small, they are still binary stuff that we should keep out of the repo if possible.\nYes, we also have to generate the autotools project an d put it in.\nI'm not so found of not tracking and putting the archdefs tarballs into the ATLAS tarball as there is no easy way to generate them as for the autotools project, or getting them somewhere upstream as for the lapack tarball.",
    "created_at": "2014-01-03T12:40:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198370",
    "user": "jpflori"
}
```

Replying to [comment:3 vbraun]:
> Since we have to make our own ATLAS tarball anyways to embed lapack, I would be in favor of putting the archdef tarballs in there as well. Even though they are small, they are still binary stuff that we should keep out of the repo if possible.
Yes, we also have to generate the autotools project an d put it in.
I'm not so found of not tracking and putting the archdefs tarballs into the ATLAS tarball as there is no easy way to generate them as for the autotools project, or getting them somewhere upstream as for the lapack tarball.



---

archive/issue_comments_198371.json:
```json
{
    "body": "Putting them into our git repo doesn't make it easier to obtain the archdefs either, it jut puts binary crap into our repo. If anything, it makes it worse for non-Sage users to get the archdefs.",
    "created_at": "2014-01-04T01:43:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198371",
    "user": "@vbraun"
}
```

Putting them into our git repo doesn't make it easier to obtain the archdefs either, it jut puts binary crap into our repo. If anything, it makes it worse for non-Sage users to get the archdefs.



---

archive/issue_comments_198372.json:
```json
{
    "body": "Ok, so let's just put them somewhere on sagemath...",
    "created_at": "2014-01-04T02:04:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198372",
    "user": "jpflori"
}
```

Ok, so let's just put them somewhere on sagemath...



---

archive/issue_comments_198373.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-01-04T15:17:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198373",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_198374.json:
```json
{
    "body": "Ok, now the archef tarballs are within the \"upstream\" tarball.\nI've taken the opportunity to add a Solaris archdef tarball.\nI've slightly reworked the atlas related scripts.\nPlease review.",
    "created_at": "2014-01-04T15:21:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198374",
    "user": "jpflori"
}
```

Ok, now the archef tarballs are within the "upstream" tarball.
I've taken the opportunity to add a Solaris archdef tarball.
I've slightly reworked the atlas related scripts.
Please review.



---

archive/issue_comments_198375.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-01-04T18:23:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198375",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_198376.json:
```json
{
    "body": "I've put the current archdefs at http://boxen.math.washington.edu/home/jpflori/archdefs/",
    "created_at": "2014-01-04T18:24:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198376",
    "user": "jpflori"
}
```

I've put the current archdefs at http://boxen.math.washington.edu/home/jpflori/archdefs/



---

archive/issue_comments_198377.json:
```json
{
    "body": "This fails to build on Cygwin64 when SAGE_FAT_BINARY is set, and is easy to fix: just don't force isa extensions as the win64 abi is not the same as the amd64 one and asm code cannot be assembled...",
    "created_at": "2014-01-14T10:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198377",
    "user": "jpflori"
}
```

This fails to build on Cygwin64 when SAGE_FAT_BINARY is set, and is easy to fix: just don't force isa extensions as the win64 abi is not the same as the amd64 one and asm code cannot be assembled...



---

archive/issue_comments_198378.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-01-14T14:58:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198378",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_198379.json:
```json
{
    "body": "Changing the tarball without the version (excluding the patchlevel) is not supported ATM, I think. We cache files in the upstream/ dir as `package-versionwithoutpatchlevel.tar.gz`, so this ticket would break builds for everybody who has the old tarball cached.\n\nEither combine with an upstream version bump or wait until the build system can handle this case.\n\nApart from that, positive review ;-)",
    "created_at": "2014-01-20T16:15:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198379",
    "user": "@vbraun"
}
```

Changing the tarball without the version (excluding the patchlevel) is not supported ATM, I think. We cache files in the upstream/ dir as `package-versionwithoutpatchlevel.tar.gz`, so this ticket would break builds for everybody who has the old tarball cached.

Either combine with an upstream version bump or wait until the build system can handle this case.

Apart from that, positive review ;-)



---

archive/issue_comments_198380.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-01-28T17:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198380",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_198381.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-01-28T17:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198381",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_198382.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-02-01T19:39:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15378",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15378#issuecomment-198382",
    "user": "@vbraun"
}
```

Resolution: fixed
