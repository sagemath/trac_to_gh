# Issue 33272: Bug in lcm method of symbolic expressions

Issue created by migration from https://trac.sagemath.org/ticket/33509

Original creator: egourgoulhon

Original creation time: 2022-03-16 12:45:00

Keywords: lcm

In Sage 9.6.beta5, we have:

```
sage: x, y = var('x y')
sage: a, b, c = x^2 - y^2, x^2 + 2*x*y + y^2, x^3 + y^3
sage: LCM([a, b, c]).simplify_rational()  # correct answer
x^5 - x^3*y^2 + x^2*y^3 - y^5
sage: LCM([a, c, b]).simplify_rational()  # wrong answer!
x^4 - x^3*y + x*y^3 - y^4
```

This bug has been pointed out in https://ask.sagemath.org/question/61522/lcm-of-3-polynomials
This bug is due to

```
sage: a.lcm(b).lcm(c).simplify_rational()
x^5 - x^3*y^2 + x^2*y^3 - y^5
sage: a.lcm(c).lcm(b).simplify_rational()
x^4 - x^3*y + x*y^3 - y^4
```

and can be traced back to

```
sage: s = a.lcm(c)
sage: s
(x^3 + y^3)*(x^2 - y^2)/(x + y)
sage: s.gcd(b) 
(x + y)^2
sage: s.simplify_rational().gcd(b)
x + y
```

A fix could be changing line 8097 of `srcâˆ•sage/symbolic/expression.pyx` as follows:

```diff
- return 0 if sb.is_trivial_zero() else sb / self.gcd(b)
+ return 0 if sb.is_trivial_zero() else sb / self.simplify_rational().gcd(b)
```

