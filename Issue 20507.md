# Issue 20507: Polynomial encoder for GRS codes fails if  variable name is not x

Issue created by migration from Trac.

Original creator: dlucas

Original creation time: 2016-06-01 08:29:44

CC:  jsrn jlavauzelle panda314

The following:


```
sage: F = GF(11)
sage: Fy.<y> = F[]
sage: n, k = 10 , 5
sage: C = codes.GeneralizedReedSolomonCode(F.list()[:n], k)
sage: E = C.encoder("EvaluationPolynomial")
sage: p = y^2 + 3*y + 10
sage: c = E.encode(p);

<BOOM>
```


fails because the polynomial to encode has to be in `'x'` with the actual implementation.

This ticket fixes it, by allowing the user to specify a variable name when creating the encoder.


---

Comment by dlucas created at 2016-06-01 08:36:23

I fixed the bug, this is now open for review.

Best,

David
----
New commits:


---

Comment by dlucas created at 2016-06-01 08:36:23

Changing status from new to needs_review.


---

Comment by jsrn created at 2016-06-01 09:33:33

I was wondering whether it would make more sense to have an option to give the polynomial ring? But I'm not sure it would. For `ReedMullerCodes` (which are in the making), one could argue that it *does* make sense (since we otherwise need many names), and in this case, it would be consistent that `ReedSolomonCode` follows the same pattern.

One could also, for usability, make a method `polynomial_ring()` on the encoder which is an alias of `message_space()`.


---

Comment by dlucas created at 2016-06-01 11:22:28

Yes, I think it's important to be consistent between similar modules.
I'll change this so it now asks for a polynomial ring and not the variable.
I'll also add a method `polynomial_ring()`.


---

Comment by git created at 2016-06-01 11:47:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2016-06-01 11:49:53

I did what we talked about, and added related input checks and `TESTS` block.
This method `polynomial_ring` feels like code duplication with `message_space`, but it makes sense to provide it, so even if it's not über-clean, I can live with that.

David


---

Comment by jsrn created at 2016-06-01 12:50:35

Replying to [comment:6 dlucas]:
> I did what we talked about, and added related input checks and `TESTS` block.

Cool. You also need a check that `polynomial_ring.base_ring()` is the field of the code.

> This method `polynomial_ring` feels like code duplication with `message_space`, but it makes sense to provide it, so even if it's not über-clean, I can live with that.

Yes, that's why I suggested making it an "alias of `message_space`". But now you've made a full function anyway. However, can you add in the doc-string that this is the same as the message space?


---

Comment by git created at 2016-06-01 13:07:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2016-06-01 13:08:08

Done.

I also removed `polynomial_ring` as a full function and made it an alias of `message_space` as you suggested. 
I think it's indeed better.


---

Comment by jsrn created at 2016-06-14 07:13:39

This looks good. I approve of the changes. However, I can't currently compile Sage on my machine, so I can't really test the patch :-S


---

Comment by git created at 2016-06-29 09:22:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2016-06-29 09:23:15

I updated this ticket to latest beta, and fixed a bug (`polynomial_ring.base_field()` was used instead of `polynomial_ring.base_ring()`).

This is still open for review.

David


---

Comment by danielaugot created at 2016-08-25 08:47:59

Hi David

This new feature is not examplified when typing `codes.encoders.GRSEvaluationPolynomialEncoder?`


I suggest there should be an example with 'y' or 'my_variable' in the EXAMPLE section of the docstring. 

That could be quickly done by migrating part of the existing code in the TEST section to the EXAMPLE section.

Daniel


---

Comment by jlavauzelle created at 2016-09-05 14:15:34

Hi,

I merged to the latest beta (7.4.beta3) and made the fix according to Daniel's comment. I also approve the changes.

Need someone for a definitive review (I guess).

Julien


---

Comment by jsrn created at 2016-09-05 14:40:57

Changing status from needs_review to needs_work.


---

Comment by jsrn created at 2016-09-05 14:40:57

The polynomial ring has to go into `__eq__`.
----
New commits:


---

Comment by git created at 2016-09-05 14:53:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jlavauzelle created at 2016-09-05 14:55:10

Hi Johan,

That's true, sorry. Fixed.

Julien


---

Comment by jlavauzelle created at 2016-09-05 14:55:33

Changing status from needs_work to needs_review.


---

Comment by jsrn created at 2016-09-05 15:04:45

Changing status from needs_review to positive_review.


---

Comment by jsrn created at 2016-09-05 15:04:45

Changing keywords from "" to "sd75".


---

Comment by vbraun created at 2016-09-08 19:46:09

Resolution: fixed
