# Issue 34291: Installation guide: Improve section on prerequisites/recommendations

archive/issues_034291.json:
```json
{
    "body": "CC:  @tobiasdiez egourgoulhon martinpepin dimpase jhpalmieri\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/34528\n\n",
    "created_at": "2022-09-13T19:24:05Z",
    "labels": [
        "documentation",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Installation guide: Improve section on prerequisites/recommendations",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34291",
    "user": "mkoeppe"
}
```
CC:  @tobiasdiez egourgoulhon martinpepin dimpase jhpalmieri



Issue created by migration from https://trac.sagemath.org/ticket/34528





---

archive/issue_comments_486333.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2022-09-14T22:43:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486333",
    "user": "mkoeppe"
}
```

Last 10 new commits:



---

archive/issue_comments_486334.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-15T00:23:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486334",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_486335.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-16T23:59:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486335",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_486336.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-17T00:51:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486336",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_486337.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-17T01:16:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486337",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_486338.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-17T02:38:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486338",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_486339.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-09-17T02:39:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486339",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_486340.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-17T03:17:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486340",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_486341.json:
```json
{
    "body": "It looks pretty good to me, although I haven't gone through every detail, in part because there are various dependencies which either need review or maybe don't exist yet? (Does anything need to be done for #32074, which is a dependency for #34266?)",
    "created_at": "2022-09-19T20:45:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486341",
    "user": "jhpalmieri"
}
```

It looks pretty good to me, although I haven't gone through every detail, in part because there are various dependencies which either need review or maybe don't exist yet? (Does anything need to be done for #32074, which is a dependency for #34266?)



---

archive/issue_comments_486342.json:
```json
{
    "body": "I only made #32074 a dependency so that #34266 does not get accidentally merged into Sage 9.7. I'll remove the dependency as soon as 9.7 is out.",
    "created_at": "2022-09-19T20:51:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486342",
    "user": "mkoeppe"
}
```

I only made #32074 a dependency so that #34266 does not get accidentally merged into Sage 9.7. I'll remove the dependency as soon as 9.7 is out.



---

archive/issue_comments_486343.json:
```json
{
    "body": "And the dependency on #34266 is just because that ticket is updating the documentation regarding GCC requirements, so it's merged here to avoid merge conflicts later.",
    "created_at": "2022-09-19T20:53:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486343",
    "user": "mkoeppe"
}
```

And the dependency on #34266 is just because that ticket is updating the documentation regarding GCC requirements, so it's merged here to avoid merge conflicts later.



---

archive/issue_comments_486344.json:
```json
{
    "body": "Here are a few small edits. Should something about Apple's M1/M2 be added to the `gcc` SPKG.rst file, or is it good enough to have the information just for `gfortran`?\n----\nNew commits:",
    "created_at": "2022-09-19T22:27:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486344",
    "user": "jhpalmieri"
}
```

Here are a few small edits. Should something about Apple's M1/M2 be added to the `gcc` SPKG.rst file, or is it good enough to have the information just for `gfortran`?
----
New commits:



---

archive/issue_comments_486345.json:
```json
{
    "body": "We can say, \"do not attempt to use the `gcc` package on macOS\".",
    "created_at": "2022-09-19T22:29:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486345",
    "user": "mkoeppe"
}
```

We can say, "do not attempt to use the `gcc` package on macOS".



---

archive/issue_comments_486346.json:
```json
{
    "body": "How about just pasting in the paragraph from `gfortran`:\n\n```diff\ndiff --git a/build/pkgs/gcc/SPKG.rst b/build/pkgs/gcc/SPKG.rst\nindex 87a056f83d..4c4cc260d2 100644\n--- a/build/pkgs/gcc/SPKG.rst\n+++ b/build/pkgs/gcc/SPKG.rst\n@@ -42,6 +42,13 @@ you need a recent version of Xcode.\n (Installing the\n ``gfortran`` SPKG becomes a no-op in this case.)\n \n+Building Sage from source on Apple Silicon (M1/M2) requires the use of\n+\u200bthe `Homebrew package manager <https://brew.sh>`_ (recommended) or\n+conda-forge, which package versions of GCC 12.x (including\n+``gfortran``) with the necessary changes for this platform.  These\n+changes are not in a released upstream version of GCC, and hence\n+the ``gcc`` SPKG is not suitable for the M1/M2.\n+\n License\n -------\n \n```\n\n\n(but with `gcc` at the end instead of `gfortran`)",
    "created_at": "2022-09-19T22:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486346",
    "user": "jhpalmieri"
}
```

How about just pasting in the paragraph from `gfortran`:

```diff
diff --git a/build/pkgs/gcc/SPKG.rst b/build/pkgs/gcc/SPKG.rst
index 87a056f83d..4c4cc260d2 100644
--- a/build/pkgs/gcc/SPKG.rst
+++ b/build/pkgs/gcc/SPKG.rst
@@ -42,6 +42,13 @@ you need a recent version of Xcode.
 (Installing the
 ``gfortran`` SPKG becomes a no-op in this case.)
 
+Building Sage from source on Apple Silicon (M1/M2) requires the use of
+​the `Homebrew package manager <https://brew.sh>`_ (recommended) or
+conda-forge, which package versions of GCC 12.x (including
+``gfortran``) with the necessary changes for this platform.  These
+changes are not in a released upstream version of GCC, and hence
+the ``gcc`` SPKG is not suitable for the M1/M2.
+
 License
 -------
 
```


(but with `gcc` at the end instead of `gfortran`)



---

archive/issue_comments_486347.json:
```json
{
    "body": "\n```\nIf you wish to do Sage development, we recommend that you additionally install the following:\n\nsudo apt-get install  autoconf automake git gpgconf libtool openssh openssh-client pkg-config\n```\n\n\nIs this not misleading now? If I'm not mistaken without e.g. autoconf or automake even the bootstrap command will fail. So these tools are a hard requirement and not a recommendation, right?",
    "created_at": "2022-09-21T07:17:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486347",
    "user": "@tobiasdiez"
}
```


```
If you wish to do Sage development, we recommend that you additionally install the following:

sudo apt-get install  autoconf automake git gpgconf libtool openssh openssh-client pkg-config
```


Is this not misleading now? If I'm not mistaken without e.g. autoconf or automake even the bootstrap command will fail. So these tools are a hard requirement and not a recommendation, right?



---

archive/issue_comments_486348.json:
```json
{
    "body": "My understanding is that you only need to use the bootstrap command if you are testing new packages. If you are working solely within the Sage library, you shouldn't need it.",
    "created_at": "2022-09-21T15:48:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486348",
    "user": "jhpalmieri"
}
```

My understanding is that you only need to use the bootstrap command if you are testing new packages. If you are working solely within the Sage library, you shouldn't need it.



---

archive/issue_comments_486349.json:
```json
{
    "body": "That's right.",
    "created_at": "2022-09-21T16:06:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486349",
    "user": "mkoeppe"
}
```

That's right.



---

archive/issue_comments_486350.json:
```json
{
    "body": "But in the manual we actually do say that it is a hard requirement:\n\n```\n+Sage developers will also need the `system packages required for\n+bootstrapping <../reference/spkg/_bootstrap>`_; they cannot be\n+installed by Sage.\n```\n\nThis sentence appears in the section explaining the prerequisites.",
    "created_at": "2022-09-21T16:08:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486350",
    "user": "mkoeppe"
}
```

But in the manual we actually do say that it is a hard requirement:

```
+Sage developers will also need the `system packages required for
+bootstrapping <../reference/spkg/_bootstrap>`_; they cannot be
+installed by Sage.
```

This sentence appears in the section explaining the prerequisites.



---

archive/issue_comments_486351.json:
```json
{
    "body": "We used to explain in a more fine-grained way when `_bootstrap` is needed, but it turned out to be not clear enough, which led to frustration. We simplified the explanation in #33851.",
    "created_at": "2022-09-21T16:12:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486351",
    "user": "mkoeppe"
}
```

We used to explain in a more fine-grained way when `_bootstrap` is needed, but it turned out to be not clear enough, which led to frustration. We simplified the explanation in #33851.



---

archive/issue_comments_486352.json:
```json
{
    "body": "Replying to [comment:23 Tobias Diez]:\n> So these tools are a hard requirement and not a recommendation, right?\n\nI think you missed the paragraph leading to the section with these long generated command-lines:\n\n```\n+The following sections provide the commands to install a large\n+recommended set of packages on various systems, which will minimize\n+the time it takes to build Sage. This is intended as a convenient\n+shortcut, but of course you can choose to take a more fine-grained\n+approach.\n```\n",
    "created_at": "2022-09-21T16:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486352",
    "user": "mkoeppe"
}
```

Replying to [comment:23 Tobias Diez]:
> So these tools are a hard requirement and not a recommendation, right?

I think you missed the paragraph leading to the section with these long generated command-lines:

```
+The following sections provide the commands to install a large
+recommended set of packages on various systems, which will minimize
+the time it takes to build Sage. This is intended as a convenient
+shortcut, but of course you can choose to take a more fine-grained
+approach.
```




---

archive/issue_comments_486353.json:
```json
{
    "body": "Assuming that the tests go well in #33816, we can remove the paragraph about m1/m2 from the `gfortran` SPKG.rst, but I think we should still include something for `gcc` since that seems to be broken (and also not needed).",
    "created_at": "2022-09-21T17:34:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486353",
    "user": "jhpalmieri"
}
```

Assuming that the tests go well in #33816, we can remove the paragraph about m1/m2 from the `gfortran` SPKG.rst, but I think we should still include something for `gcc` since that seems to be broken (and also not needed).



---

archive/issue_comments_486354.json:
```json
{
    "body": "For `gcc`, I think we can copy in https://trac.sagemath.org/wiki/ReleaseTours/sage-9.7#SupportforsystemGCColderthan6.3dropped:",
    "created_at": "2022-09-21T17:37:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486354",
    "user": "mkoeppe"
}
```

For `gcc`, I think we can copy in https://trac.sagemath.org/wiki/ReleaseTours/sage-9.7#SupportforsystemGCColderthan6.3dropped:



---

archive/issue_comments_486355.json:
```json
{
    "body": "I was thinking of this change:\n\n```diff\ndiff --git a/build/pkgs/gcc/SPKG.rst b/build/pkgs/gcc/SPKG.rst\nindex 87a056f83d..cc6c8153a8 100644\n--- a/build/pkgs/gcc/SPKG.rst\n+++ b/build/pkgs/gcc/SPKG.rst\n@@ -42,6 +42,11 @@ you need a recent version of Xcode.\n (Installing the\n ``gfortran`` SPKG becomes a no-op in this case.)\n \n+Building Sage from source on Apple Silicon (M1/M2) requires the use of\n+Apple's Command Line Tools, and those tools include a suitable\n+compiler. Sage's ``gcc`` SPKG is not suitable for M1/M2; building it\n+will likely fail.\n+\n License\n -------\n \ndiff --git a/build/pkgs/gfortran/SPKG.rst b/build/pkgs/gfortran/SPKG.rst\nindex b6ba9b9bb4..9559b98456 100644\n--- a/build/pkgs/gfortran/SPKG.rst\n+++ b/build/pkgs/gfortran/SPKG.rst\n@@ -20,13 +20,6 @@ need to run::\n \n     $ ./configure CC=clang CXX=clang++ FC=flang\n \n-Building Sage from source on Apple Silicon (M1/M2) requires the use of\n-\u200bthe `Homebrew package manager <https://brew.sh>`_ (recommended) or\n-conda-forge, which package versions of GCC 12.x (including\n-``gfortran``) with the necessary changes for this platform.  These\n-changes are not in a released upstream version of GCC, and hence\n-the ``gfortran`` SPKG is not suitable for the M1/M2.\n-\n License\n -------\n \n```\n",
    "created_at": "2022-09-21T17:41:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486355",
    "user": "jhpalmieri"
}
```

I was thinking of this change:

```diff
diff --git a/build/pkgs/gcc/SPKG.rst b/build/pkgs/gcc/SPKG.rst
index 87a056f83d..cc6c8153a8 100644
--- a/build/pkgs/gcc/SPKG.rst
+++ b/build/pkgs/gcc/SPKG.rst
@@ -42,6 +42,11 @@ you need a recent version of Xcode.
 (Installing the
 ``gfortran`` SPKG becomes a no-op in this case.)
 
+Building Sage from source on Apple Silicon (M1/M2) requires the use of
+Apple's Command Line Tools, and those tools include a suitable
+compiler. Sage's ``gcc`` SPKG is not suitable for M1/M2; building it
+will likely fail.
+
 License
 -------
 
diff --git a/build/pkgs/gfortran/SPKG.rst b/build/pkgs/gfortran/SPKG.rst
index b6ba9b9bb4..9559b98456 100644
--- a/build/pkgs/gfortran/SPKG.rst
+++ b/build/pkgs/gfortran/SPKG.rst
@@ -20,13 +20,6 @@ need to run::
 
     $ ./configure CC=clang CXX=clang++ FC=flang
 
-Building Sage from source on Apple Silicon (M1/M2) requires the use of
-​the `Homebrew package manager <https://brew.sh>`_ (recommended) or
-conda-forge, which package versions of GCC 12.x (including
-``gfortran``) with the necessary changes for this platform.  These
-changes are not in a released upstream version of GCC, and hence
-the ``gfortran`` SPKG is not suitable for the M1/M2.
-
 License
 -------
 
```




---

archive/issue_comments_486356.json:
```json
{
    "body": "Please go ahead and push it to the ticket. We can make #33816 a dependency.",
    "created_at": "2022-09-21T17:43:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486356",
    "user": "mkoeppe"
}
```

Please go ahead and push it to the ticket. We can make #33816 a dependency.



---

archive/issue_comments_486357.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-21T17:47:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486357",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_486358.json:
```json
{
    "body": "Replying to [comment:24 John Palmieri]:\n> My understanding is that you only need to use the bootstrap command if you are testing new packages. If you are working solely within the Sage library, you shouldn't need it.\n\nThanks for the clarification. I was always under the impression that bootstrap was needed after a git clone, good to know that this is no longer the case.",
    "created_at": "2022-09-21T23:21:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486358",
    "user": "@tobiasdiez"
}
```

Replying to [comment:24 John Palmieri]:
> My understanding is that you only need to use the bootstrap command if you are testing new packages. If you are working solely within the Sage library, you shouldn't need it.

Thanks for the clarification. I was always under the impression that bootstrap was needed after a git clone, good to know that this is no longer the case.



---

archive/issue_comments_486359.json:
```json
{
    "body": "Replying to [comment:30 Matthias K\u00f6ppe]:\n> For `gcc`, I think we can copy in https://trac.sagemath.org/wiki/ReleaseTours/sage-9.7#SupportforsystemGCColderthan6.3dropped\n\nDone, plus some details from #32074\n----\nNew commits:",
    "created_at": "2022-09-22T00:08:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486359",
    "user": "mkoeppe"
}
```

Replying to [comment:30 Matthias Köppe]:
> For `gcc`, I think we can copy in https://trac.sagemath.org/wiki/ReleaseTours/sage-9.7#SupportforsystemGCColderthan6.3dropped

Done, plus some details from #32074
----
New commits:



---

archive/issue_comments_486360.json:
```json
{
    "body": "The links don't work for me without this change.\n----\nNew commits:",
    "created_at": "2022-09-23T19:36:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486360",
    "user": "jhpalmieri"
}
```

The links don't work for me without this change.
----
New commits:



---

archive/issue_comments_486361.json:
```json
{
    "body": "I'm happy with Matthias' contributions; positive review from me.",
    "created_at": "2022-09-23T19:38:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486361",
    "user": "jhpalmieri"
}
```

I'm happy with Matthias' contributions; positive review from me.



---

archive/issue_comments_486362.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-23T19:40:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486362",
    "user": "mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_486363.json:
```json
{
    "body": "Thanks!",
    "created_at": "2022-09-23T19:40:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486363",
    "user": "mkoeppe"
}
```

Thanks!



---

archive/issue_comments_486364.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-09-27T22:27:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34291",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34291#issuecomment-486364",
    "user": "vbraun"
}
```

Resolution: fixed
