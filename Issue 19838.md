# Issue 19838: rising_factorial should accept Python integers

archive/issues_019838.json:
```json
{
    "body": "See the bug reported at\nhttp://ask.sagemath.org/question/32565/error-in-rising_factorial/\n\n```\nsage: [rising_factorial(n,n) for n in range(6)]\nAttributeError: 'int' object has no attribute 'parent'\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/20075\n\n",
    "created_at": "2016-02-17T09:48:58Z",
    "labels": [
        "basic arithmetic",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.1",
    "title": "rising_factorial should accept Python integers",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19838",
    "user": "egourgoulhon"
}
```
See the bug reported at
http://ask.sagemath.org/question/32565/error-in-rising_factorial/

```
sage: [rising_factorial(n,n) for n in range(6)]
AttributeError: 'int' object has no attribute 'parent'
```


Issue created by migration from https://trac.sagemath.org/ticket/20075





---

archive/issue_comments_272619.json:
```json
{
    "body": "Changing keywords from \"\" to \"factorial\".",
    "created_at": "2016-02-17T09:54:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272619",
    "user": "egourgoulhon"
}
```

Changing keywords from "" to "factorial".



---

archive/issue_comments_272620.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-02-17T09:54:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272620",
    "user": "egourgoulhon"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_272621.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-02-17T09:54:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272621",
    "user": "egourgoulhon"
}
```

New commits:



---

archive/issue_comments_272622.json:
```json
{
    "body": "Since there is a belief that the input could be a `long`, I think you should also check against that as well.",
    "created_at": "2016-02-17T14:50:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272622",
    "user": "tscrim"
}
```

Since there is a belief that the input could be a `long`, I think you should also check against that as well.



---

archive/issue_comments_272623.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-17T15:13:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272623",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_272624.json:
```json
{
    "body": "Replying to [comment:2 tscrim]:\n> Since there is a belief that the input could be a `long`, I think you should also check against that as well.\nDone in the above commit. Btw, I've also modified `falling_factorial` for consistency.",
    "created_at": "2016-02-17T15:15:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272624",
    "user": "egourgoulhon"
}
```

Replying to [comment:2 tscrim]:
> Since there is a belief that the input could be a `long`, I think you should also check against that as well.
Done in the above commit. Btw, I've also modified `falling_factorial` for consistency.



---

archive/issue_comments_272625.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-02-17T15:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272625",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_272626.json:
```json
{
    "body": "You would better use `sage.structure.coerce.py_scalar_to_element`. For example you forgot about numpy integers. You can simply add the line `x = py_scalar_to_element(x)` at the begining.",
    "created_at": "2016-02-17T15:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272626",
    "user": "vdelecroix"
}
```

You would better use `sage.structure.coerce.py_scalar_to_element`. For example you forgot about numpy integers. You can simply add the line `x = py_scalar_to_element(x)` at the begining.



---

archive/issue_comments_272627.json:
```json
{
    "body": "And since `int,long` are changed to `Integer` there is no need to check for these types in the second pass.",
    "created_at": "2016-02-17T15:57:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272627",
    "user": "vdelecroix"
}
```

And since `int,long` are changed to `Integer` there is no need to check for these types in the second pass.



---

archive/issue_comments_272628.json:
```json
{
    "body": "Replying to [comment:6 vdelecroix]:\n> And since `int,long` are changed to `Integer` there is no need to check for these types in the second pass.\n\nThe first check is `x` and the second is `a`.",
    "created_at": "2016-02-17T16:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272628",
    "user": "tscrim"
}
```

Replying to [comment:6 vdelecroix]:
> And since `int,long` are changed to `Integer` there is no need to check for these types in the second pass.

The first check is `x` and the second is `a`.



---

archive/issue_comments_272629.json:
```json
{
    "body": "Replying to [comment:6 vdelecroix]:\n> And since `int,long` are changed to `Integer` there is no need to check for these types in the second pass.\nWhat do you mean? In the code of these functions, there is no second pass for `x` (the other checks regard `a`, not `x`).",
    "created_at": "2016-02-17T16:06:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272629",
    "user": "egourgoulhon"
}
```

Replying to [comment:6 vdelecroix]:
> And since `int,long` are changed to `Integer` there is no need to check for these types in the second pass.
What do you mean? In the code of these functions, there is no second pass for `x` (the other checks regard `a`, not `x`).



---

archive/issue_comments_272630.json:
```json
{
    "body": "yep. I read too fast. Sorry for that.\n\nBut [comment:5] can be applied to both `x` and `a` (and hence the code will also work with numpy integers).",
    "created_at": "2016-02-17T16:10:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272630",
    "user": "vdelecroix"
}
```

yep. I read too fast. Sorry for that.

But [comment:5] can be applied to both `x` and `a` (and hence the code will also work with numpy integers).



---

archive/issue_comments_272631.json:
```json
{
    "body": "Replying to [comment:9 vdelecroix]:\n> yep. I read too fast. Sorry for that.\n> \n> But [comment:5] can be applied to both `x` and `a` (and hence the code will also work with numpy integers).\nIn the current code, there is no need to force `a` to be a Sage element, for only `x.parent()` is invoked. So I would apply `py_scalar_to_element` only to `x`. Do you agree?",
    "created_at": "2016-02-17T16:24:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272631",
    "user": "egourgoulhon"
}
```

Replying to [comment:9 vdelecroix]:
> yep. I read too fast. Sorry for that.
> 
> But [comment:5] can be applied to both `x` and `a` (and hence the code will also work with numpy integers).
In the current code, there is no need to force `a` to be a Sage element, for only `x.parent()` is invoked. So I would apply `py_scalar_to_element` only to `x`. Do you agree?



---

archive/issue_comments_272632.json:
```json
{
    "body": "Replying to [comment:10 egourgoulhon]:\n> In the current code, there is no need to force `a` to be a Sage element, for only `x.parent()` is invoked. So I would apply `py_scalar_to_element` only to `x`. Do you agree?\n\nPS: in particular, the current code already works with `a` being a numpy integer (I've just checked it).",
    "created_at": "2016-02-17T16:28:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272632",
    "user": "egourgoulhon"
}
```

Replying to [comment:10 egourgoulhon]:
> In the current code, there is no need to force `a` to be a Sage element, for only `x.parent()` is invoked. So I would apply `py_scalar_to_element` only to `x`. Do you agree?

PS: in particular, the current code already works with `a` being a numpy integer (I've just checked it).



---

archive/issue_comments_272633.json:
```json
{
    "body": "Replying to [comment:11 egourgoulhon]:\n> Replying to [comment:10 egourgoulhon]:\n> > In the current code, there is no need to force `a` to be a Sage element, for only `x.parent()` is invoked. So I would apply `py_scalar_to_element` only to `x`. Do you agree?\n> \n> PS: in particular, the current code already works with `a` being a numpy integer (I've just checked it).  \n\nAre you sure? What kind of numpy integers did you try?\n\n```\nsage: import numpy\nsage: a = numpy.int8(10)\nsage: b = numpy.int(5)\nsage: isinstance(a, int)\nFalse\nsage: isinstance(b, int)\nTrue\n```\n",
    "created_at": "2016-02-17T17:12:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272633",
    "user": "vdelecroix"
}
```

Replying to [comment:11 egourgoulhon]:
> Replying to [comment:10 egourgoulhon]:
> > In the current code, there is no need to force `a` to be a Sage element, for only `x.parent()` is invoked. So I would apply `py_scalar_to_element` only to `x`. Do you agree?
> 
> PS: in particular, the current code already works with `a` being a numpy integer (I've just checked it).  

Are you sure? What kind of numpy integers did you try?

```
sage: import numpy
sage: a = numpy.int8(10)
sage: b = numpy.int(5)
sage: isinstance(a, int)
False
sage: isinstance(b, int)
True
```




---

archive/issue_comments_272634.json:
```json
{
    "body": "Replying to [comment:12 vdelecroix]:\n> Are you sure? What kind of numpy integers did you try?\n> {{{\n> sage: import numpy\n> sage: a = numpy.int8(10)\n> sage: b = numpy.int(5)\n> sage: isinstance(a, int)\n> False\n> sage: isinstance(b, int)\n> True\n> }}}\n\nBoth work:\n\n```\nsage: import numpy\nsage: a = numpy.int8(4)\nsage: rising_factorial(3, a)\n360\nsage: a = numpy.int(4)\nsage: rising_factorial(3, a)\n360\n```\n",
    "created_at": "2016-02-17T17:27:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272634",
    "user": "egourgoulhon"
}
```

Replying to [comment:12 vdelecroix]:
> Are you sure? What kind of numpy integers did you try?
> {{{
> sage: import numpy
> sage: a = numpy.int8(10)
> sage: b = numpy.int(5)
> sage: isinstance(a, int)
> False
> sage: isinstance(b, int)
> True
> }}}

Both work:

```
sage: import numpy
sage: a = numpy.int8(4)
sage: rising_factorial(3, a)
360
sage: a = numpy.int(4)
sage: rising_factorial(3, a)
360
```




---

archive/issue_comments_272635.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-17T17:31:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272635",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_272636.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-02-17T17:32:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272636",
    "user": "egourgoulhon"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_272637.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-03-09T18:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272637",
    "user": "vdelecroix"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_272638.json:
```json
{
    "body": "Sorry for the long delay...",
    "created_at": "2016-03-09T18:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272638",
    "user": "vdelecroix"
}
```

Sorry for the long delay...



---

archive/issue_comments_272639.json:
```json
{
    "body": "Replying to [comment:16 vdelecroix]:\n> Sorry for the long delay...\nNo problem. Thank you Vincent !",
    "created_at": "2016-03-09T20:46:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272639",
    "user": "egourgoulhon"
}
```

Replying to [comment:16 vdelecroix]:
> Sorry for the long delay...
No problem. Thank you Vincent !



---

archive/issue_comments_272640.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-03-10T13:40:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19838#issuecomment-272640",
    "user": "vbraun"
}
```

Resolution: fixed
