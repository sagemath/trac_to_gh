# Issue 19838: rising_factorial should accept Python integers

Issue created by migration from Trac.

Original creator: egourgoulhon

Original creation time: 2016-02-17 09:48:58

See the bug reported at
http://ask.sagemath.org/question/32565/error-in-rising_factorial/

```
sage: [rising_factorial(n,n) for n in range(6)]
AttributeError: 'int' object has no attribute 'parent'
```



---

Comment by egourgoulhon created at 2016-02-17 09:54:04

Changing keywords from "" to "factorial".


---

Comment by egourgoulhon created at 2016-02-17 09:54:04

Changing status from new to needs_review.


---

Comment by egourgoulhon created at 2016-02-17 09:54:04

New commits:


---

Comment by tscrim created at 2016-02-17 14:50:24

Since there is a belief that the input could be a `long`, I think you should also check against that as well.


---

Comment by git created at 2016-02-17 15:13:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by egourgoulhon created at 2016-02-17 15:15:47

Replying to [comment:2 tscrim]:
> Since there is a belief that the input could be a `long`, I think you should also check against that as well.
Done in the above commit. Btw, I've also modified `falling_factorial` for consistency.


---

Comment by vdelecroix created at 2016-02-17 15:57:10

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2016-02-17 15:57:10

You would better use `sage.structure.coerce.py_scalar_to_element`. For example you forgot about numpy integers. You can simply add the line `x = py_scalar_to_element(x)` at the begining.


---

Comment by vdelecroix created at 2016-02-17 15:57:41

And since `int,long` are changed to `Integer` there is no need to check for these types in the second pass.


---

Comment by tscrim created at 2016-02-17 16:05:36

Replying to [comment:6 vdelecroix]:
> And since `int,long` are changed to `Integer` there is no need to check for these types in the second pass.

The first check is `x` and the second is `a`.


---

Comment by egourgoulhon created at 2016-02-17 16:06:22

Replying to [comment:6 vdelecroix]:
> And since `int,long` are changed to `Integer` there is no need to check for these types in the second pass.
What do you mean? In the code of these functions, there is no second pass for `x` (the other checks regard `a`, not `x`).


---

Comment by vdelecroix created at 2016-02-17 16:10:13

yep. I read too fast. Sorry for that.

But [comment:5] can be applied to both `x` and `a` (and hence the code will also work with numpy integers).


---

Comment by egourgoulhon created at 2016-02-17 16:24:36

Replying to [comment:9 vdelecroix]:
> yep. I read too fast. Sorry for that.
> 
> But [comment:5] can be applied to both `x` and `a` (and hence the code will also work with numpy integers).
In the current code, there is no need to force `a` to be a Sage element, for only `x.parent()` is invoked. So I would apply `py_scalar_to_element` only to `x`. Do you agree?


---

Comment by egourgoulhon created at 2016-02-17 16:28:08

Replying to [comment:10 egourgoulhon]:
> In the current code, there is no need to force `a` to be a Sage element, for only `x.parent()` is invoked. So I would apply `py_scalar_to_element` only to `x`. Do you agree?

PS: in particular, the current code already works with `a` being a numpy integer (I've just checked it).


---

Comment by vdelecroix created at 2016-02-17 17:12:03

Replying to [comment:11 egourgoulhon]:
> Replying to [comment:10 egourgoulhon]:
> > In the current code, there is no need to force `a` to be a Sage element, for only `x.parent()` is invoked. So I would apply `py_scalar_to_element` only to `x`. Do you agree?
> 
> PS: in particular, the current code already works with `a` being a numpy integer (I've just checked it).  

Are you sure? What kind of numpy integers did you try?

```
sage: import numpy
sage: a = numpy.int8(10)
sage: b = numpy.int(5)
sage: isinstance(a, int)
False
sage: isinstance(b, int)
True
```



---

Comment by egourgoulhon created at 2016-02-17 17:27:56

Replying to [comment:12 vdelecroix]:
> Are you sure? What kind of numpy integers did you try?
> {{{
> sage: import numpy
> sage: a = numpy.int8(10)
> sage: b = numpy.int(5)
> sage: isinstance(a, int)
> False
> sage: isinstance(b, int)
> True
> }}}

Both work:

```
sage: import numpy
sage: a = numpy.int8(4)
sage: rising_factorial(3, a)
360
sage: a = numpy.int(4)
sage: rising_factorial(3, a)
360
```



---

Comment by git created at 2016-02-17 17:31:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by egourgoulhon created at 2016-02-17 17:32:07

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2016-03-09 18:58:28

Changing status from needs_review to positive_review.


---

Comment by vdelecroix created at 2016-03-09 18:58:28

Sorry for the long delay...


---

Comment by egourgoulhon created at 2016-03-09 20:46:34

Replying to [comment:16 vdelecroix]:
> Sorry for the long delay...
No problem. Thank you Vincent !


---

Comment by vbraun created at 2016-03-10 13:40:12

Resolution: fixed
