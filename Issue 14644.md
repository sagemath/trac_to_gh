# Issue 14644: Inconsistencies with FreeAlgebra

archive/issues_014644.json:
```json
{
    "body": "Assignee: @aghitza\n\nCC:  @nthiery\n\nThis ticket is \"inspired\" by [this ask.sagemath question](http://ask.sagemath.org/question/2760/products-in-a-free-algebra).\n\n1. First, there should be an easy way to get the variables out of an expression in FreeAlgebra. Compare with the output of polynomial ring.\n\n```\nsage: F.<x,y>=FreeAlgebra(ZZ)  \nsage: g=4+3*x^7*y^10*x^13\nsage: g.variables()            # <------------   Need this\nsage: h=g._FreeAlgebraElement__monomial_coefficients # This is what we need to do currently\nsage: h.items()[1][0]._element_list     # and do more post processing on the output.\n[(0, 7), (1, 10), (0, 13)]\n\n# Compare with polynomial ring\nsage: F.<x,y> = PolynomialRing(ZZ)\nsage: g=4+3*x^7*y^10*x^13\nsage: g.variables()\n(x, y)\nsage: g=4+3*x^7\nsage: g.variables()\n(x,)\n```\n2. The element `x<sup>7*y</sup>10*x^13` does not belong to the `FreeAlgebra` class once it is extracted from the expression. It belongs to `FreeMonoid`. I think the parent of it should be the same even after we extract it.\n\n```\nsage: F.<x,y>=FreeAlgebra(ZZ)  \nsage: g=4+3*x^7*y^10*x^13\nsage: h=g._FreeAlgebraElement__monomial_coefficients\nsage: h\n{1: 4, x^7*y^10*x^13: 3}\nsage: hh = h.items()[1][0]; hh\nx^7*y^10*x^13\nsage: hh.parent()\nFree monoid on 2 generators (x, y)\n```\n\nIssue created by migration from https://trac.sagemath.org/ticket/14848\n\n",
    "created_at": "2013-07-02T06:17:08Z",
    "labels": [
        "component: algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "Inconsistencies with FreeAlgebra",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14644",
    "user": "https://github.com/ppurka"
}
```
Assignee: @aghitza

CC:  @nthiery

This ticket is "inspired" by [this ask.sagemath question](http://ask.sagemath.org/question/2760/products-in-a-free-algebra).

1. First, there should be an easy way to get the variables out of an expression in FreeAlgebra. Compare with the output of polynomial ring.

```
sage: F.<x,y>=FreeAlgebra(ZZ)  
sage: g=4+3*x^7*y^10*x^13
sage: g.variables()            # <------------   Need this
sage: h=g._FreeAlgebraElement__monomial_coefficients # This is what we need to do currently
sage: h.items()[1][0]._element_list     # and do more post processing on the output.
[(0, 7), (1, 10), (0, 13)]

# Compare with polynomial ring
sage: F.<x,y> = PolynomialRing(ZZ)
sage: g=4+3*x^7*y^10*x^13
sage: g.variables()
(x, y)
sage: g=4+3*x^7
sage: g.variables()
(x,)
```
2. The element `x<sup>7*y</sup>10*x^13` does not belong to the `FreeAlgebra` class once it is extracted from the expression. It belongs to `FreeMonoid`. I think the parent of it should be the same even after we extract it.

```
sage: F.<x,y>=FreeAlgebra(ZZ)  
sage: g=4+3*x^7*y^10*x^13
sage: h=g._FreeAlgebraElement__monomial_coefficients
sage: h
{1: 4, x^7*y^10*x^13: 3}
sage: hh = h.items()[1][0]; hh
x^7*y^10*x^13
sage: hh.parent()
Free monoid on 2 generators (x, y)
```

Issue created by migration from https://trac.sagemath.org/ticket/14848





---

archive/issue_comments_186158.json:
```json
{
    "body": "In regards to my question on ask.sagemath, what I would have really liked was if elements supported indexing. So for example, g[0] should return 4. g[1] should return 3*x<sup>7*y</sup>10*x^13 and then g[1][0] should return 3 i guess, g[1][1] should return x^7 and so on. After that, it would be nice to have a way to iterate over 4+3*x<sup>7*y</sup>10*x^13. Maybe we would need len() for that? Has there ever been any talk about implementing something like this?",
    "created_at": "2013-07-02T12:18:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186158",
    "user": "https://trac.sagemath.org/admin/accounts/users/broken_symlink"
}
```

In regards to my question on ask.sagemath, what I would have really liked was if elements supported indexing. So for example, g[0] should return 4. g[1] should return 3*x<sup>7*y</sup>10*x^13 and then g[1][0] should return 3 i guess, g[1][1] should return x^7 and so on. After that, it would be nice to have a way to iterate over 4+3*x<sup>7*y</sup>10*x^13. Maybe we would need len() for that? Has there ever been any talk about implementing something like this?



---

archive/issue_comments_186159.json:
```json
{
    "body": "I think this kind of indexing has never been discussed or implemented. There could be several reasons, one of the foremost being that the order in which you enter the expression is not preserved.\n\n```\nsage: F.<x,y>=FreeAlgebra(ZZ)\nsage: g = x^5 * y^4 + 3\nsage: g\n3 + x^5*y^4\n```",
    "created_at": "2013-07-02T12:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186159",
    "user": "https://github.com/ppurka"
}
```

I think this kind of indexing has never been discussed or implemented. There could be several reasons, one of the foremost being that the order in which you enter the expression is not preserved.

```
sage: F.<x,y>=FreeAlgebra(ZZ)
sage: g = x^5 * y^4 + 3
sage: g
3 + x^5*y^4
```



---

archive/issue_comments_186160.json:
```json
{
    "body": "elements support iteration, but not indexing, which is appropriate because as ppurka said there is no real ordering on the expressions.\n\n```\nsage: F.<x,y> = FreeAlgebra(ZZ)\nsage: g = x^5 * y^4 + 3\nsage: for m in g:\n....:     print m\n....: \n(3, 1)\n(1, x^5*y^4)\nsage: list(g)\n[(3, 1), (1, x^5*y^4)]\n```\n\nall works fine.",
    "created_at": "2013-09-06T20:50:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186160",
    "user": "https://github.com/samclearman"
}
```

elements support iteration, but not indexing, which is appropriate because as ppurka said there is no real ordering on the expressions.

```
sage: F.<x,y> = FreeAlgebra(ZZ)
sage: g = x^5 * y^4 + 3
sage: for m in g:
....:     print m
....: 
(3, 1)
(1, x^5*y^4)
sage: list(g)
[(3, 1), (1, x^5*y^4)]
```

all works fine.



---

archive/issue_comments_186161.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-10-12T07:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186161",
    "user": "https://github.com/ppurka"
}
```

Changing status from new to needs_review.



---

archive/issue_events_042664.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-10-12T07:55:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14644#event-42664"
}
```



---

archive/issue_comments_186162.json:
```json
{
    "body": "Marking as invalid.",
    "created_at": "2013-10-12T07:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186162",
    "user": "https://github.com/ppurka"
}
```

Marking as invalid.



---

archive/issue_events_042665.json:
```json
{
    "actor": "https://github.com/ppurka",
    "created_at": "2013-10-12T07:56:45Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14644#event-42665"
}
```



---

archive/issue_comments_186163.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-10-12T07:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186163",
    "user": "https://github.com/ppurka"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_186164.json:
```json
{
    "body": "Oh. Sorry. I forgot that the original questions were very different from the discussion that ensued.",
    "created_at": "2013-10-12T07:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186164",
    "user": "https://github.com/ppurka"
}
```

Oh. Sorry. I forgot that the original questions were very different from the discussion that ensued.



---

archive/issue_comments_186165.json:
```json
{
    "body": "Regarding point 1: Accessing underscore methods is bound to make your life hard: the underscore marks that these are methods/attributes for internal use. The interface is via iteration and using that one can easily accomplish the task:\n\n```\nsage: tuple({n[0] for m in g for n in m[1]})\n(y, x)\n```\n(i.e., iterate over the terms making up the algebra element, extract the monomial and iterate over that to extract the variables that occur in them).\n\nWhether this needs to be wrapped in a method: The operation isn't very natural: The parent will naturally tell you which variables CAN occur in in algebra elements. Are the ones that don't have all those variables really so special that there needs to be a method to query about that?\n\nFor polynomials, the same argument holds, but there it was probably added because some beginners will tend to think of polynomials in terms of SR, where the variables occurring is really a property of the expression and not really of SR.\n\nConcerning point 2: The nested operation above shows why it's natural to return monomials NOT as elements of the algebra: iterating over an algebra element gives the pairs, iterating over a monomial gives variable-exponent pairs. The separation actually provides easier access to the underlying data.\n\nFor normal polynomial rings this is probably avoided for efficiency reasons, but you quickly notice that it's a little inconvenient: you end up testing quite a bit whether given polynomials are actually monomials, where doing this via a type check would often in principle be quite doable.",
    "created_at": "2013-10-12T15:16:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186165",
    "user": "https://github.com/nbruin"
}
```

Regarding point 1: Accessing underscore methods is bound to make your life hard: the underscore marks that these are methods/attributes for internal use. The interface is via iteration and using that one can easily accomplish the task:

```
sage: tuple({n[0] for m in g for n in m[1]})
(y, x)
```
(i.e., iterate over the terms making up the algebra element, extract the monomial and iterate over that to extract the variables that occur in them).

Whether this needs to be wrapped in a method: The operation isn't very natural: The parent will naturally tell you which variables CAN occur in in algebra elements. Are the ones that don't have all those variables really so special that there needs to be a method to query about that?

For polynomials, the same argument holds, but there it was probably added because some beginners will tend to think of polynomials in terms of SR, where the variables occurring is really a property of the expression and not really of SR.

Concerning point 2: The nested operation above shows why it's natural to return monomials NOT as elements of the algebra: iterating over an algebra element gives the pairs, iterating over a monomial gives variable-exponent pairs. The separation actually provides easier access to the underlying data.

For normal polynomial rings this is probably avoided for efficiency reasons, but you quickly notice that it's a little inconvenient: you end up testing quite a bit whether given polynomials are actually monomials, where doing this via a type check would often in principle be quite doable.



---

archive/issue_comments_186166.json:
```json
{
    "body": "1. The iteration operation was not clear to me at all, and it definitely not possible for beginner to figure it out. By a beginner, I don't mean a beginner to programming - more like a beginner to Sage, or this specific implementation in Sage. I don't find this kind of iteration documented anywhere, even for polynomial rings - maybe it is hidden somewhere. Secondly, the parent `FreeAlgebra` does have `variable_name` and `variable_names` methods. Both are undocumented. The first one, for some weird reason, returns only the first variable as a string. The second one returns all the variables as strings. This is quite useless for programming purposes. It is *maybe* ok for interactive use, where one can look at this output and then decide to run the `F.inject_variables()` once one is sure it won't clobber existing variables.\n\n2. Checking for monomials can be easily done using the list comprehension you provided. Or, even better for efficiency reasons - a `for` loop with an `enumerate` that returns `False` as soon as it encounters a second tuple.\n\n```python\ndef is_monomial(self):\n    for i,_ in enumerate(self):\n        if i == 1:\n             return False\n    return True\n```",
    "created_at": "2013-10-13T08:15:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186166",
    "user": "https://github.com/ppurka"
}
```

1. The iteration operation was not clear to me at all, and it definitely not possible for beginner to figure it out. By a beginner, I don't mean a beginner to programming - more like a beginner to Sage, or this specific implementation in Sage. I don't find this kind of iteration documented anywhere, even for polynomial rings - maybe it is hidden somewhere. Secondly, the parent `FreeAlgebra` does have `variable_name` and `variable_names` methods. Both are undocumented. The first one, for some weird reason, returns only the first variable as a string. The second one returns all the variables as strings. This is quite useless for programming purposes. It is *maybe* ok for interactive use, where one can look at this output and then decide to run the `F.inject_variables()` once one is sure it won't clobber existing variables.

2. Checking for monomials can be easily done using the list comprehension you provided. Or, even better for efficiency reasons - a `for` loop with an `enumerate` that returns `False` as soon as it encounters a second tuple.

```python
def is_monomial(self):
    for i,_ in enumerate(self):
        if i == 1:
             return False
    return True
```



---

archive/issue_comments_186167.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-04-02T01:22:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186167",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_186168.json:
```json
{
    "body": "I've made `FreeAlgebra` inherit from `CombinatorialFreeModule`; it was close enough to it to begin with and is something Nicolas and I have wanted to do. I've had to hack together a combination of `CombinatorialFreeModuleElement` and `AlgebraElement` to pass a doctest in `matrix0.pyx` where `FreeAlgebra` is used as a base ring (this inspired #15947). So iterating through an element of `FreeAlgera` gives `index,coeff` now (finally consistency! this had bugged me a few times). I've also added a `variables` method as I don't think it does much harm to have it and `support` returns the monomials that occur.\n\nRegarding point 2, you can now use the `monomial_coefficients()` to iterate over pairs (monomial in free algebra, coefficient)] (well...TBH actually it's a `dict`, so you need an additional `items()`). Also I agree with Nils' opinion.\n\n---\nNew commits:",
    "created_at": "2014-04-02T01:22:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186168",
    "user": "https://github.com/tscrim"
}
```

I've made `FreeAlgebra` inherit from `CombinatorialFreeModule`; it was close enough to it to begin with and is something Nicolas and I have wanted to do. I've had to hack together a combination of `CombinatorialFreeModuleElement` and `AlgebraElement` to pass a doctest in `matrix0.pyx` where `FreeAlgebra` is used as a base ring (this inspired #15947). So iterating through an element of `FreeAlgera` gives `index,coeff` now (finally consistency! this had bugged me a few times). I've also added a `variables` method as I don't think it does much harm to have it and `support` returns the monomials that occur.

Regarding point 2, you can now use the `monomial_coefficients()` to iterate over pairs (monomial in free algebra, coefficient)] (well...TBH actually it's a `dict`, so you need an additional `items()`). Also I agree with Nils' opinion.

---
New commits:



---

archive/issue_events_042666.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-04-02T01:22:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14644#event-42666"
}
```



---

archive/issue_comments_186169.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-02T01:26:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186169",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_186170.json:
```json
{
    "body": "Replying to [comment:8 tscrim]:\n> I've made `FreeAlgebra` inherit from `CombinatorialFreeModule`; it was close enough to it to begin with and is something Nicolas and I have wanted to do.\n\n\nYeah!\n\n> I've had to hack together a combination of `CombinatorialFreeModuleElement` and `AlgebraElement` to pass a doctest in `matrix0.pyx` where `FreeAlgebra` is used as a base ring (this inspired #15947).\n\n\nAny chance to get rid of the use of AlgebraElement there altogether?\n\nCheers,\n                      Nicolas",
    "created_at": "2014-04-02T20:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186170",
    "user": "https://github.com/nthiery"
}
```

Replying to [comment:8 tscrim]:
> I've made `FreeAlgebra` inherit from `CombinatorialFreeModule`; it was close enough to it to begin with and is something Nicolas and I have wanted to do.


Yeah!

> I've had to hack together a combination of `CombinatorialFreeModuleElement` and `AlgebraElement` to pass a doctest in `matrix0.pyx` where `FreeAlgebra` is used as a base ring (this inspired #15947).


Any chance to get rid of the use of AlgebraElement there altogether?

Cheers,
                      Nicolas



---

archive/issue_comments_186171.json:
```json
{
    "body": "Replying to [comment:10 nthiery]:\n> Any chance to get rid of the use of AlgebraElement there altogether?\n\n\nAlas, no. We'd have to do something with `_rmul_` and `_lmul_` of the matrices without introducing a speed regression, which IDK what the best way to do it will be. The alternative would be to remove/change those failing doctests. I've posted an idea I've just had to #15947.",
    "created_at": "2014-04-02T20:21:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186171",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:10 nthiery]:
> Any chance to get rid of the use of AlgebraElement there altogether?


Alas, no. We'd have to do something with `_rmul_` and `_lmul_` of the matrices without introducing a speed regression, which IDK what the best way to do it will be. The alternative would be to remove/change those failing doctests. I've posted an idea I've just had to #15947.



---

archive/issue_comments_186172.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-15T02:16:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186172",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_186173.json:
```json
{
    "body": "I got one error in doctests:\n\n```\nsage -t --long src/sage/algebras/algebra.py\n**********************************************************************\nFile \"src/sage/algebras/algebra.py\", line 29, in sage.algebras.algebra.is_Algebra\nFailed example:\n    is_Algebra(R)\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n```\n\nPoint 1. in description is fixed, but I guess it is harder to fix point 2. So, other than this doctest, the patch looks OK to me.",
    "created_at": "2014-04-15T13:03:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186173",
    "user": "https://github.com/ppurka"
}
```

I got one error in doctests:

```
sage -t --long src/sage/algebras/algebra.py
**********************************************************************
File "src/sage/algebras/algebra.py", line 29, in sage.algebras.algebra.is_Algebra
Failed example:
    is_Algebra(R)
Expected:
    True
Got:
    False
**********************************************************************
```

Point 1. in description is fixed, but I guess it is harder to fix point 2. So, other than this doctest, the patch looks OK to me.



---

archive/issue_comments_186174.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-04-15T13:03:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186174",
    "user": "https://github.com/ppurka"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_186175.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-15T15:46:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186175",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_186176.json:
```json
{
    "body": "Fixed (and also some doctests in `categories/rings.py` that I found).",
    "created_at": "2014-04-15T15:47:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186176",
    "user": "https://github.com/tscrim"
}
```

Fixed (and also some doctests in `categories/rings.py` that I found).



---

archive/issue_comments_186177.json:
```json
{
    "body": "I am surprised. I have two questions\n\n1. Why does this patch affect `categories/rings.py`?\n2. Can you be more specific with `Exception`? In which case did you run into the `Exception`? `AttributeError`? Can you include it in a doctest?",
    "created_at": "2014-04-16T09:03:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186177",
    "user": "https://github.com/ppurka"
}
```

I am surprised. I have two questions

1. Why does this patch affect `categories/rings.py`?
2. Can you be more specific with `Exception`? In which case did you run into the `Exception`? `AttributeError`? Can you include it in a doctest?



---

archive/issue_comments_186178.json:
```json
{
    "body": "Replying to [comment:16 ppurka]:\n> I am surprised. I have two questions\n> \n> 1. Why does this patch affect `categories/rings.py`?\n\n\nIt's just a doctest and it's because I swapped the order when iterating over the objects (i.e., it became index, coefficient whereas before it was coefficient, index).\n\n> 2. Can you be more specific with `Exception`? In which case did you run into the `Exception`? `AttributeError`? Can you include it in a doctest?\n\n\nThere's a doctest in `categories/commutative_ring_ideals.py` which tries to pass off (incorrectly) `Partitions(4)` as a commutative ring, but the `is_Algebra` fails with a `TypeError`. However, it could also fail with other errors and I didn't want the `is_Algebra` to error out for similar reasoning to a `__contains__()` check. We can add additional doctests to `is_Algebra` but I think we're already covered by other parts of the library.",
    "created_at": "2014-04-16T13:56:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186178",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:16 ppurka]:
> I am surprised. I have two questions
> 
> 1. Why does this patch affect `categories/rings.py`?


It's just a doctest and it's because I swapped the order when iterating over the objects (i.e., it became index, coefficient whereas before it was coefficient, index).

> 2. Can you be more specific with `Exception`? In which case did you run into the `Exception`? `AttributeError`? Can you include it in a doctest?


There's a doctest in `categories/commutative_ring_ideals.py` which tries to pass off (incorrectly) `Partitions(4)` as a commutative ring, but the `is_Algebra` fails with a `TypeError`. However, it could also fail with other errors and I didn't want the `is_Algebra` to error out for similar reasoning to a `__contains__()` check. We can add additional doctests to `is_Algebra` but I think we're already covered by other parts of the library.



---

archive/issue_comments_186179.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-04-16T13:56:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186179",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_186180.json:
```json
{
    "body": "Ok. Then. Setting it to positive review.",
    "created_at": "2014-04-18T03:33:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186180",
    "user": "https://github.com/ppurka"
}
```

Ok. Then. Setting it to positive review.



---

archive/issue_comments_186181.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-04-18T03:33:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186181",
    "user": "https://github.com/ppurka"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_186182.json:
```json
{
    "body": "Thank you for doing the review.",
    "created_at": "2014-04-18T03:36:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186182",
    "user": "https://github.com/tscrim"
}
```

Thank you for doing the review.



---

archive/issue_comments_186183.json:
```json
{
    "body": "Lots of doctests failures",
    "created_at": "2014-04-20T12:24:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186183",
    "user": "https://github.com/vbraun"
}
```

Lots of doctests failures



---

archive/issue_comments_186184.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-04-20T12:24:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186184",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_186185.json:
```json
{
    "body": "Can you list which files?",
    "created_at": "2014-04-20T12:35:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186185",
    "user": "https://github.com/tscrim"
}
```

Can you list which files?



---

archive/issue_comments_186186.json:
```json
{
    "body": "Sorry, too late. But there was enough breakage that you should run the whole testsuite.",
    "created_at": "2014-04-20T13:24:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186186",
    "user": "https://github.com/vbraun"
}
```

Sorry, too late. But there was enough breakage that you should run the whole testsuite.



---

archive/issue_comments_186187.json:
```json
{
    "body": "This is mostly for my records. Here's the list I got that were \"bad\" errors:\n\n```\nsage -t rings/quotient_ring.py  # 8 doctests failed\nsage -t rings/ring.pyx  # 3 doctests failed\nsage -t structure/sage_object.pyx  # 1 doctest failed\nsage -t structure/factorization.py  # 1 doctest failed\n```\nThe pickling one is going to be the most fun to deal with.\n\nThese were from dictionary orderings (likely from hash values):\n\n```\nsage -t libs/singular/groebner_strategy.pyx  # 2 doctests failed\nsage -t rings/polynomial/plural.pyx  # 5 doctests failed\nsage -t rings/polynomial/multi_polynomial_ideal.py  # 13 doctests failed\n```\n\nOne I don't think is related:\n\n```\nsage -t doctest/test.py  # 1 doctest failed\n```\nThese seem to be maxima related (i.e. local to my setup so I'm going to ignore them):\n\n```\nsage -t tests/french_book/integration_doctest.py  # 1 doctest failed\nsage -t calculus/desolvers.py  # 8 doctests failed\nsage -t /home/travis/sage/src/doc/en/prep/Quickstarts/Differential-Equations.rst  # 2 doctests failed\nsage -t /home/travis/sage/src/doc/en/constructions/calculus.rst  # 4 doctests failed\n```",
    "created_at": "2014-04-20T14:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186187",
    "user": "https://github.com/tscrim"
}
```

This is mostly for my records. Here's the list I got that were "bad" errors:

```
sage -t rings/quotient_ring.py  # 8 doctests failed
sage -t rings/ring.pyx  # 3 doctests failed
sage -t structure/sage_object.pyx  # 1 doctest failed
sage -t structure/factorization.py  # 1 doctest failed
```
The pickling one is going to be the most fun to deal with.

These were from dictionary orderings (likely from hash values):

```
sage -t libs/singular/groebner_strategy.pyx  # 2 doctests failed
sage -t rings/polynomial/plural.pyx  # 5 doctests failed
sage -t rings/polynomial/multi_polynomial_ideal.py  # 13 doctests failed
```

One I don't think is related:

```
sage -t doctest/test.py  # 1 doctest failed
```
These seem to be maxima related (i.e. local to my setup so I'm going to ignore them):

```
sage -t tests/french_book/integration_doctest.py  # 1 doctest failed
sage -t calculus/desolvers.py  # 8 doctests failed
sage -t /home/travis/sage/src/doc/en/prep/Quickstarts/Differential-Equations.rst  # 2 doctests failed
sage -t /home/travis/sage/src/doc/en/constructions/calculus.rst  # 4 doctests failed
```



---

archive/issue_comments_186188.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-22T16:11:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186188",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_186189.json:
```json
{
    "body": "Volker, double-check that I got them all please.",
    "created_at": "2014-04-22T16:12:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186189",
    "user": "https://github.com/tscrim"
}
```

Volker, double-check that I got them all please.



---

archive/issue_comments_186190.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-04-22T16:12:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186190",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_042667.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-04-22T22:02:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14644#event-42667"
}
```



---

archive/issue_comments_186191.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-04-22T22:02:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14644",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14644#issuecomment-186191",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
