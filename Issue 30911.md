# Issue 30911: MR51: Allow Matplotlib to use system qhull >= 7.2.0

archive/issues_030911.json:
```json
{
    "body": "CC:  slelievre\n\nzlscherr ([`@`zlscherr](https://gitlab.com/zlscherr)) opened a merge request at https://gitlab.com/sagemath/sage/-/merge_requests/51:\n----\n\n```markdown\nMy system has qhull 8.0.0 installed.  Because Matplotlib\ndoesn't know about my system qhull it builds its own version.\nThis can cause runtime issues with Matplotlib trying to call\nthe wrong qhull library.  For example, this fixes the error that\n\n./sage -tp 8 --long --warn-long 31.1 --random-seed=0 src/sage/plot/plot3d/list_plot3d.py\n\nproduces\n\nQH6249 qh_lib_check: Incorrect qhull library called.  Size of qhT for caller is 2896, but for library is 2792.\nQH6256 qh_lib_check: Cannot continue.  Library 'qhull 7.2.0 (2015.2 2016/01/18)' uses a static qhT (e.g., libqhull.so)\n\nif the system has qhull 8.0.0 installed.\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/31148\n\n",
    "created_at": "2021-01-02T05:37:26Z",
    "labels": [
        "PLEASE CHANGE",
        "major",
        "PLEASE CHANGE"
    ],
    "title": "MR51: Allow Matplotlib to use system qhull >= 7.2.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30911",
    "user": "galois"
}
```
CC:  slelievre

zlscherr ([`@`zlscherr](https://gitlab.com/zlscherr)) opened a merge request at https://gitlab.com/sagemath/sage/-/merge_requests/51:
----

```markdown
My system has qhull 8.0.0 installed.  Because Matplotlib
doesn't know about my system qhull it builds its own version.
This can cause runtime issues with Matplotlib trying to call
the wrong qhull library.  For example, this fixes the error that

./sage -tp 8 --long --warn-long 31.1 --random-seed=0 src/sage/plot/plot3d/list_plot3d.py

produces

QH6249 qh_lib_check: Incorrect qhull library called.  Size of qhT for caller is 2896, but for library is 2792.
QH6256 qh_lib_check: Cannot continue.  Library 'qhull 7.2.0 (2015.2 2016/01/18)' uses a static qhT (e.g., libqhull.so)

if the system has qhull 8.0.0 installed.
```


Issue created by migration from https://trac.sagemath.org/ticket/31148





---

archive/issue_comments_441693.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2021-01-02T05:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30911#issuecomment-441693",
    "user": "@zlscherr"
}
```

Changing priority from major to minor.



---

archive/issue_comments_441694.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to build.",
    "created_at": "2021-01-02T05:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30911#issuecomment-441694",
    "user": "@zlscherr"
}
```

Changing component from PLEASE CHANGE to build.



---

archive/issue_comments_441695.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2021-01-02T05:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30911#issuecomment-441695",
    "user": "@zlscherr"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_441696.json:
```json
{
    "body": "lgtm",
    "created_at": "2021-01-02T10:05:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30911#issuecomment-441696",
    "user": "dimpase"
}
```

lgtm



---

archive/issue_comments_441697.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-01-02T10:05:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30911#issuecomment-441697",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_441698.json:
```json
{
    "body": "Full name in Author field please.",
    "created_at": "2021-01-02T14:44:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30911#issuecomment-441698",
    "user": "slelievre"
}
```

Full name in Author field please.



---

archive/issue_comments_441699.json:
```json
{
    "body": "Thanks!",
    "created_at": "2021-01-02T15:28:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30911#issuecomment-441699",
    "user": "slelievre"
}
```

Thanks!



---

archive/issue_comments_441700.json:
```json
{
    "body": "The cffi upgrade that is on the ticket should be mentioned in the ticket description",
    "created_at": "2021-01-02T18:11:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30911#issuecomment-441700",
    "user": "mkoeppe"
}
```

The cffi upgrade that is on the ticket should be mentioned in the ticket description



---

archive/issue_comments_441701.json:
```json
{
    "body": "Oops, that's my fault since I'm still learning about contributing.  That was leftover from the last ticket I submitted as I had merged it into my local develop branch.  Is there an easy way to separate those or should I just submit a new ticket? Sorry about that.",
    "created_at": "2021-01-02T18:14:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30911#issuecomment-441701",
    "user": "@zlscherr"
}
```

Oops, that's my fault since I'm still learning about contributing.  That was leftover from the last ticket I submitted as I had merged it into my local develop branch.  Is there an easy way to separate those or should I just submit a new ticket? Sorry about that.



---

archive/issue_comments_441702.json:
```json
{
    "body": "As the branch is on top of the one of #31128, it's OK to just add that ticket as a dependency. I have just done that.\n\n(Best practice, however, would be to have independent branches for independent tickets.)",
    "created_at": "2021-01-02T18:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30911#issuecomment-441702",
    "user": "mkoeppe"
}
```

As the branch is on top of the one of #31128, it's OK to just add that ticket as a dependency. I have just done that.

(Best practice, however, would be to have independent branches for independent tickets.)



---

archive/issue_comments_441703.json:
```json
{
    "body": "Thanks.\n\nAlso, what is best practice for package dependencies? Matplotlib depends on numpy which depends on pkgconfig, which I use in this ticket.  Does that mean I should explicitly add pkgconfig to Matplotlib's dependency file?",
    "created_at": "2021-01-02T21:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30911#issuecomment-441703",
    "user": "@zlscherr"
}
```

Thanks.

Also, what is best practice for package dependencies? Matplotlib depends on numpy which depends on pkgconfig, which I use in this ticket.  Does that mean I should explicitly add pkgconfig to Matplotlib's dependency file?



---

archive/issue_comments_441704.json:
```json
{
    "body": "It would be clearer to add it explicitly; \nbut it is correct as is because we currently do not use any system Python packages - and hence the indirect dependencies are guaranteed to be present.",
    "created_at": "2021-01-02T22:31:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30911#issuecomment-441704",
    "user": "mkoeppe"
}
```

It would be clearer to add it explicitly; 
but it is correct as is because we currently do not use any system Python packages - and hence the indirect dependencies are guaranteed to be present.



---

archive/issue_comments_441705.json:
```json
{
    "body": "I just opened #31165 to deal with system-wide qhull.\n\nWe should also update our qhull.",
    "created_at": "2021-01-02T23:26:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30911#issuecomment-441705",
    "user": "dimpase"
}
```

I just opened #31165 to deal with system-wide qhull.

We should also update our qhull.



---

archive/issue_comments_441706.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-01-31T20:52:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30911",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30911#issuecomment-441706",
    "user": "vbraun"
}
```

Resolution: fixed
