# Issue 14924: Parent/Element relation for ChainComplex/Chain

Issue created by migration from https://trac.sagemath.org/ticket/15161

Original creator: vbraun

Original creation time: 2013-09-05 17:03:39

CC:  jhpalmieri tscrim

Nothing in `sage.homology` makes use of the Parent/Element framework. But it would be nice to be able to work with chains and use normal syntax for addition and multiplication by scalars. The aim of this ticket is to adapt chain complexes. The analogous project for cell complexes will be left for a future ticket.


---

Comment by git created at 2013-09-05 21:43:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2013-09-07 21:22:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vbraun created at 2013-09-07 21:27:08

comment:2 is a minor screwup of the scripts, only the first commit should have been listed...

In any case, all tests pass for me and I did what I wanted to do on this ticket. Ready for review...


---

Comment by vbraun created at 2013-09-07 21:27:08

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2013-09-08 03:38:27

I don't understand the example `C.an_element()` in the ticket description: all of the differentials are zero, so the various listed elements can't be mapping to each other. I would expect that an element would be an element of a single `C^i`, or possibly an element of the direct sum of all of the `C^i`'s, and I would prefer the first choice.


---

Comment by vbraun created at 2013-09-08 10:52:29

Here, element = chain, i.e. an element of the direct sum of the `C_i`. That is the most general notion of element, so it is the one that ought to be implemented. The arrows in the ascii art are there to visualize the relative position in the complex. And they are `\to` and not `\mapsto` arrows... Do you have a better ascii art representation in mind?

Since it is useful to see the coordinate expression of a chain that is supported only in a single degree (e.g. homology generators) they are printed differently: 

```
sage: D = ChainComplex({0: matrix(ZZ, 2, 2, [1,0,0,2])})
sage: D()
Trivial chain
sage: D({0:[2, 3]})
Chain(0:(2, 3))
sage: D({0:[2, 3], 1:[4, 5]})
Chain with 2 nonzero terms over Integer Ring
sage: z = D({1:[0,1]})
sage: z.is_boundary()
False
sage: (2*z).is_boundary()
True
```



---

Comment by git created at 2013-09-08 11:40:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jhpalmieri created at 2013-10-07 05:25:37

I've been busy with various departmental duties for the past month, but I'd like to start reviewing this soon. I don't know how to review git tickets, though, and the directions I've found seem to be contradictory (if I download Sage from git and type `make`, it fails because the top-level Makefile refers to spkg/pipestatus, while everything has been moved from `spkg` to `build`. If I switch branches to `build_system`, then it builds but `./sage --dev ...` doesn't work).

Furthermore, I don't know how to look at the relevant changes easily. Do I really need to look at half a dozen different changesets, or is there a unified view somewhere? On this ticket, the "branch" field doesn't seem to be active, but on a ticket like #15202, if I click on "Commits" I get a pretty diagram, and then from there if I click on "View changes", I get "504 Gateway Time-out.  The server didn't respond in time." I guess I'm supposed to click on the branch name instead?


---

Comment by git created at 2013-10-07 11:41:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vbraun created at 2013-10-07 11:43:18

Starting this week, using git should be relatively simple. If you download the current master from github (say) then installation should just work. See http://trac.sagemath.org/wiki/QuickStartSageGit

The developer scripts should also work as in http://sagemath.github.io/git-developer-guide/walk_through.html:

```
sage -dev checkout --ticket 15161
```

gets you the source code. Then make/test as usual. To see all source code changes relative to the master branch, use

```
sage -dev diff --base master
```


 * I just merged in the current master so this ticket contains the dev scripts, too.

 * The changeset browser in trac still needs some love...


---

Comment by jhpalmieri created at 2013-10-07 21:39:44

On a quick reading of chain_complex.py:

- Do you want to add your name to the `AUTHORS` list at the top of chain_complex.py?
- In the docstring for `ChainComplex_class`, change ``base_ring`` to ```base_ring```
- In the docstring for `differential`, the spaces aren't lined up right in the indented part for `dim`. Same thing happens several other places. I guess I ought to be able to fix issues like this and then push them to a branch of my own. Meanwhile, I've attached a patch file with the changes.
- In `betti`, well, first, I hope we are moving toward using CHomP as much as possible for homology computations. Given this, if we have a chain complex over a finite field, it may be faster to CHomP to compute its homology (hence its Betti numbers) than to use Sage to compute its homology over `Q` (which is a little strange anyway, if the chain complex is over a finite field). So the beginning part of the code might use the complex's base ring by default, if it's a field, rather than using `QQ` by default.
- I wonder if we should deprecate the method `torsion_list`. Maybe this is more appropriate for a Sage worksheet than Sage source code; what do you think?

I'll keep working on this.


---

Attachment

fixes white space and other small issues in some docstrings


---

Comment by jhpalmieri created at 2013-10-08 22:26:29

In cell_complex.py, just about everything looks good, except for one misformatted docstring (plus the missing word "as"):

```diff
diff --git a/src/sage/homology/cell_complex.py b/src/sage/homology/cell_complex.py
index d736837..02d53fa 100644
--- a/src/sage/homology/cell_complex.py
+++ b/src/sage/homology/cell_complex.py
@@ -20,7 +20,8 @@ by developers producing new classes, not casual users.
     the :meth:`~GenericCellComplex.homology` method get passed on to
     the :meth:`~GenericCellComplex.chain_complex` method and also to
     the constructor for chain complexes in
-    :class:`sage.homology.chain_complex.ChainComplex_class <ChainComplex>`, as well its
+    :class:`ChainComplex <sage.homology.chain_complex.ChainComplex_class>`,
+    as well as its
     associated
     :meth:`~sage.homology.chain_complex.ChainComplex_class.homology` method.
     This means that those keywords should have consistent meaning in
```


Also, the newly created files (`matrix_utils.py` and `homology_group.py`) should be added to the reference manual.


---

Comment by tscrim created at 2013-12-01 04:18:49

Hey Volker and John,

I've worked in all of John's documentation changes and made a few of my own (plus rebased to the latest version of Sage). I don't think we should deprecate `torsion_list()` as it's not doing any harm and someone might find (or be finding) it useful. If you're happy with my changes, then I think we can set this to positive review.

Best,

Travis
----
New commits:


---

Comment by git created at 2013-12-01 06:03:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jhpalmieri created at 2013-12-01 06:20:32

I'd also like this change:

```diff
diff --git a/src/doc/en/reference/homology/index.rst b/src/doc/en/reference/homology/index
index 82c2f33..147cd8c 100644
--- a/src/doc/en/reference/homology/index.rst
+++ b/src/doc/en/reference/homology/index.rst
@@ -21,6 +21,8 @@ cell complexes.
    sage/homology/delta_complex
    sage/homology/cubical_complex
    sage/homology/cell_complex
+   sage/homology/homology_group
+   sage/homology/matrix_utils
    sage/interfaces/chomp
 
 .. include:: ../footer.txt
```



---

Comment by git created at 2013-12-02 16:12:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2013-12-02 16:14:07

Ack, I completely forgot about that. Done.


---

Comment by jhpalmieri created at 2013-12-04 19:16:24

Everything looks good to me.


---

Comment by jhpalmieri created at 2013-12-04 19:16:24

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2013-12-05 02:24:56

I don't think what I did warrants author credits (especially since most of what I changes was in John's review patch `:)` ).


---

Comment by vbraun created at 2013-12-21 12:15:58

Resolution: fixed


---

Comment by jhpalmieri created at 2014-01-24 22:27:02

See #15730 for a follow-up.
