# Issue 14851: Valuation of zero Laurent series

Issue created by migration from Trac.

Original creator: caruso

Original creation time: 2013-08-23 15:28:23

CC:  robertwb

Keywords: valuation Laurent series

Currently, Sage believes that the valuation of the zero Laurent series is zero (although it is infinite):


```
sage: R.<x> = LaurentSeriesRing(QQ)
sage: zero = R(0)
sage: zero.valuation()
0
```


The attached patch fixes this bug.


---

Comment by caruso created at 2013-08-23 15:37:26

Changing status from new to needs_review.


---

Comment by chapoton created at 2013-08-23 19:10:16

you have wrongly removed the :: after the EXAMPLES in valuation for Laurent series


---

Comment by caruso created at 2013-08-23 20:25:59

Sorry. Patch revised.


---

Comment by tscrim created at 2013-08-25 19:26:38

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2013-08-25 19:26:38

Looks good to me.


---

Comment by jdemeyer created at 2013-08-26 10:22:53

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2013-08-26 10:22:53

There are various doctest failures:

```
----------------------------------------------------------------------
sage -t devel/sage/sage/schemes/elliptic_curves/ell_curve_isogeny.py  # 1 doctest failed
sage -t devel/sage/sage/schemes/elliptic_curves/monsky_washnitzer.py  # 13 doctests failed
sage -t devel/sage/sage/schemes/hyperelliptic_curves/hyperelliptic_padic_field.py  # 8 doctests failed
----------------------------------------------------------------------
```



---

Comment by caruso created at 2013-08-26 21:21:24

It seems to be fixed with the latest version of the patch.

Nevertheless, it would be nice if somebody knowing `sage.schemes.elliptic_curves` and `sage.schemes.hyperelliptic_curves` better than me could double check.


---

Comment by caruso created at 2013-08-26 21:24:36

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2013-08-28 02:10:26

As a disclaimer, I don't really know anything about schemes, but since we're just modifying the code to handle this corner case, I think the changes are all okay except in `monsky_washnitzer.py`. In this file, before this patch it would be `k == 0 - y_offset == -y_offset` when `a = 0`, so maybe setting `k = 0` is okay and I'm just paranoid because I can't answer, but I'd rather not change what the previous code would have done.


---

Attachment

Ok. I was thinking that `a.valuation() == Infinity` implies `y_offset == 0` but I'm also not completely sure. So let's do as you propose.


---

Comment by tscrim created at 2013-08-28 16:59:43

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2013-08-28 16:59:43

Looks good to me now. Thanks.

PS - You are probably right about it (in fact, I think you are, but I really can't say that with enough certainty), but I'm paranoid here.


---

Comment by jdemeyer created at 2013-09-02 10:21:13

Resolution: fixed
