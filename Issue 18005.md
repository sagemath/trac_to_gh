# Issue 18005: Added algorithm computing special resolvents

archive/issues_018005.json:
```json
{
    "body": "CC:  @mezzarobba @gagern\n\nWe implemented the algorithm for computing the composed sum and\n  the composed product of univariate polynomials, presented in\n\nA. Bostan, P. Flajolet, B. Salvy and E. Schost,\n   \"Fast Computation of special resultants\",\n   Journal of Symbolic Computation 41 (2006), 1-29\n\n  The composed sum algorithm is faster than using resolvents;\n  using it one of the  bottleneck in computing minimal polynomials\n  is removed.\n\n  The composed product is comparable to using resolvents; they are\n  usually both fast.\n\nIssue created by migration from https://trac.sagemath.org/ticket/18242\n\n",
    "created_at": "2015-04-17T18:32:52Z",
    "labels": [
        "component: number fields"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.1",
    "title": "Added algorithm computing special resolvents",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18005",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```
CC:  @mezzarobba @gagern

We implemented the algorithm for computing the composed sum and
  the composed product of univariate polynomials, presented in

A. Bostan, P. Flajolet, B. Salvy and E. Schost,
   "Fast Computation of special resultants",
   Journal of Symbolic Computation 41 (2006), 1-29

  The composed sum algorithm is faster than using resolvents;
  using it one of the  bottleneck in computing minimal polynomials
  is removed.

  The composed product is comparable to using resolvents; they are
  usually both fast.

Issue created by migration from https://trac.sagemath.org/ticket/18242





---

archive/issue_comments_241922.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-04-18T18:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18005#issuecomment-241922",
    "user": "https://github.com/mezzarobba"
}
```

New commits:



---

archive/issue_comments_241923.json:
```json
{
    "body": "Changing keywords from \"\" to \"qqbar resultant exactify minpoly\".",
    "created_at": "2015-04-20T10:51:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18005#issuecomment-241923",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

Changing keywords from "" to "qqbar resultant exactify minpoly".



---

archive/issue_comments_241924.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-25T11:06:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18005#issuecomment-241924",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_241925.json:
```json
{
    "body": "What does the following test from `\u200b584f444` is doing in `sage.rings.qqbar`!?\n\n```\nsage: from sage.calculus.calculus import minpoly\nsage: x = SR.var('x')\nsage: ex = solve(x^4 + x + 1 == 0, x)[0].rhs()\nsage: minpoly(ex, algorithm='algebraic')\nx^4 + x + 1\n```\n\nWhy isn't it in `sage.calculus.calculus`?",
    "created_at": "2015-04-29T17:35:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18005#issuecomment-241925",
    "user": "https://github.com/videlec"
}
```

What does the following test from `â€‹584f444` is doing in `sage.rings.qqbar`!?

```
sage: from sage.calculus.calculus import minpoly
sage: x = SR.var('x')
sage: ex = solve(x^4 + x + 1 == 0, x)[0].rhs()
sage: minpoly(ex, algorithm='algebraic')
x^4 + x + 1
```

Why isn't it in `sage.calculus.calculus`?



---

archive/issue_comments_241926.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-01T10:47:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18005#issuecomment-241926",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_241927.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-02T08:55:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18005#issuecomment-241927",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_241928.json:
```json
{
    "body": "Hello,\n\nThis ticket is still in state \"new\" but here are some remarks.\n\nI would make this ticket independent of #17886 and ignore completely the potential application to `QQbar` (considering it in another ticket). It would be more flexible that way.\n\nYou implemented functions but I guess some of them would better be methods over polynomials (that is methods of `polynomial.polynomial_element.Polynomial`). For example, the `hadamard_product` or even the `composed_sum`. So move them. For `_hadamard_exp` it is only well defined in zero characteristic, so I am not sure what is the most appropriate; what do you think?\n\nDid you do some serious benchmark to see which methods is faster depending on `p1` and `p2`? I guess it might aslo depends on the sparseness of the polynomials, the size of the coefficients.\n\n1. `newton_sum`\n\n   - I would rather add the power series ring object `R` as an argument. Building a ring is always costly.\n\n   - In\n\n```\np2 = R(QQ(1)/p1)\n```\n\n  You would better do\n\n```\np2 = ~R(p1)\n```\n\n  you would avoid computing `1/p1` in the fraction field.\n\n- It would be faster to return `p3.truncate()` or `res.truncate()` instead of adding a truncation argument\n\n- the argument name `typ` is horrible. Be more explicit about what it is. \"a related expression\" is not an explanation of the output!\n\n2. In `hadamard_product` there is no need to build the list of coefficients. You can access the coefficients of a polynomial `p` through `p[i]`. So just do\n\n```\ndef hadamard_product(p1, p2):\n    R = p1.parent()\n    return R([p1[i]*p2[i] for i in range(min(p1.degree(), p2.degree())+1)])\n```\n\n   (I recall that this function must move as a method of univariate polynomials)\n\n3. `composed_product`\n\n   - you duplicated the code for `BFSS`... moreover if the argument `algorithm` is neither `\"resultant\"` nor `\"BFSS\"` an error should be raised.\n\n   - I guess that the resultant method works in any characteristic?\n\nSided note: the Bostan-Flajolet-Salvy-Schost deals with any characteristic. So it would be interesting to have a more general implementation.\n\nVincent",
    "created_at": "2015-05-02T10:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18005#issuecomment-241928",
    "user": "https://github.com/videlec"
}
```

Hello,

This ticket is still in state "new" but here are some remarks.

I would make this ticket independent of #17886 and ignore completely the potential application to `QQbar` (considering it in another ticket). It would be more flexible that way.

You implemented functions but I guess some of them would better be methods over polynomials (that is methods of `polynomial.polynomial_element.Polynomial`). For example, the `hadamard_product` or even the `composed_sum`. So move them. For `_hadamard_exp` it is only well defined in zero characteristic, so I am not sure what is the most appropriate; what do you think?

Did you do some serious benchmark to see which methods is faster depending on `p1` and `p2`? I guess it might aslo depends on the sparseness of the polynomials, the size of the coefficients.

1. `newton_sum`

   - I would rather add the power series ring object `R` as an argument. Building a ring is always costly.

   - In

```
p2 = R(QQ(1)/p1)
```

  You would better do

```
p2 = ~R(p1)
```

  you would avoid computing `1/p1` in the fraction field.

- It would be faster to return `p3.truncate()` or `res.truncate()` instead of adding a truncation argument

- the argument name `typ` is horrible. Be more explicit about what it is. "a related expression" is not an explanation of the output!

2. In `hadamard_product` there is no need to build the list of coefficients. You can access the coefficients of a polynomial `p` through `p[i]`. So just do

```
def hadamard_product(p1, p2):
    R = p1.parent()
    return R([p1[i]*p2[i] for i in range(min(p1.degree(), p2.degree())+1)])
```

   (I recall that this function must move as a method of univariate polynomials)

3. `composed_product`

   - you duplicated the code for `BFSS`... moreover if the argument `algorithm` is neither `"resultant"` nor `"BFSS"` an error should be raised.

   - I guess that the resultant method works in any characteristic?

Sided note: the Bostan-Flajolet-Salvy-Schost deals with any characteristic. So it would be interesting to have a more general implementation.

Vincent



---

archive/issue_comments_241929.json:
```json
{
    "body": "Note: I opened #18333 as a \"task ticket\" for the global cleaning of `QQbar`. Any comments, suggestions and reviews of tickets mentioned there are welcome!",
    "created_at": "2015-05-02T10:12:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18005#issuecomment-241929",
    "user": "https://github.com/videlec"
}
```

Note: I opened #18333 as a "task ticket" for the global cleaning of `QQbar`. Any comments, suggestions and reviews of tickets mentioned there are welcome!



---

archive/issue_comments_241930.json:
```json
{
    "body": "Hello Vincent,\nI opened #18356 implementing `composed_sum` and `composed_product` in `polynomial_element.pyx`,\ntaking into account most of your comments.\n\n\"hadamard_exp\" appears as a method raising an exception if the polynomial is not on rationals.\n\nI suspect that `newton_sum` method is not efficient, and it might be somewhere else in\nSage. As long as it is called by `composed_sum`, the time spent in `newton_sum` is negligible.\n\nThere is a small benchmark test, confirming the fact that the \"BFSS\" algorithm is asymptotically faster.\n\nI do not plan to look at the \"BFSS\" algorithm in any characteristics.\n\nI do not think I will open another ticket before #18356 is merged, because I do not know how to\nmanage tickets depending on other tickets, or how to add the dependence on both #17886 and #18356.",
    "created_at": "2015-05-03T18:42:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18005#issuecomment-241930",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

Hello Vincent,
I opened #18356 implementing `composed_sum` and `composed_product` in `polynomial_element.pyx`,
taking into account most of your comments.

"hadamard_exp" appears as a method raising an exception if the polynomial is not on rationals.

I suspect that `newton_sum` method is not efficient, and it might be somewhere else in
Sage. As long as it is called by `composed_sum`, the time spent in `newton_sum` is negligible.

There is a small benchmark test, confirming the fact that the "BFSS" algorithm is asymptotically faster.

I do not plan to look at the "BFSS" algorithm in any characteristics.

I do not think I will open another ticket before #18356 is merged, because I do not know how to
manage tickets depending on other tickets, or how to add the dependence on both #17886 and #18356.



---

archive/issue_comments_241931.json:
```json
{
    "body": "Hi Mario,\n\nReplying to [comment:13 pernici]:\n> Hello Vincent,\n> I opened #18356 implementing `composed_sum` and `composed_product` in `polynomial_element.pyx`,\n> taking into account most of your comments.\n\nWhat is the intersection between this ticket and #18356? I think from now it is better to discuss on #18356 right?\n\n> I do not plan to look at the \"BFSS\" algorithm in any characteristics.\n\nThis is fine. Just add a `NOTE` somewhere like\n\n```\n.. NOTE::\n\n    The BFSS algorithm could be implemented in any characteristic but it currently only works in characteristic zero (see paper XYZ).\n```\n\n \n> I do not think I will open another ticket before #18356 is merged, because I do not know how to\n> manage tickets depending on other tickets, or how to add the dependence on both #17886 and #18356.\n\nTickets depending on other tickets have two flavour:\n- from the trac point of view, this is just logical order (you just have to fill the dependency field in the ticket description)\n- from the git point of view, if X depends on Y, it means that the branch of Y is based on top of X\n\nYou are free to rebase git branch on other git branches. Or change the git branch on some ticket to some other branch.\n\nVincent",
    "created_at": "2015-05-03T18:53:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18005#issuecomment-241931",
    "user": "https://github.com/videlec"
}
```

Hi Mario,

Replying to [comment:13 pernici]:
> Hello Vincent,
> I opened #18356 implementing `composed_sum` and `composed_product` in `polynomial_element.pyx`,
> taking into account most of your comments.

What is the intersection between this ticket and #18356? I think from now it is better to discuss on #18356 right?

> I do not plan to look at the "BFSS" algorithm in any characteristics.

This is fine. Just add a `NOTE` somewhere like

```
.. NOTE::

    The BFSS algorithm could be implemented in any characteristic but it currently only works in characteristic zero (see paper XYZ).
```

 
> I do not think I will open another ticket before #18356 is merged, because I do not know how to
> manage tickets depending on other tickets, or how to add the dependence on both #17886 and #18356.

Tickets depending on other tickets have two flavour:
- from the trac point of view, this is just logical order (you just have to fill the dependency field in the ticket description)
- from the git point of view, if X depends on Y, it means that the branch of Y is based on top of X

You are free to rebase git branch on other git branches. Or change the git branch on some ticket to some other branch.

Vincent



---

archive/issue_comments_241932.json:
```json
{
    "body": "Replying to [comment:14 vdelecroix]: \n> > I do not plan to look at the \"BFSS\" algorithm in any characteristics.\n> \n> This is fine. Just add a `NOTE` somewhere like\n\nHa nice. It is already there!",
    "created_at": "2015-05-03T19:02:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18005#issuecomment-241932",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:14 vdelecroix]: 
> > I do not plan to look at the "BFSS" algorithm in any characteristics.
> 
> This is fine. Just add a `NOTE` somewhere like

Ha nice. It is already there!



---

archive/issue_comments_241933.json:
```json
{
    "body": "To me, it would make more sense to use directly `composed_op` in #17886 and close this ticket as duplicate.",
    "created_at": "2016-01-18T19:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18005#issuecomment-241933",
    "user": "https://github.com/videlec"
}
```

To me, it would make more sense to use directly `composed_op` in #17886 and close this ticket as duplicate.



---

archive/issue_events_051536.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-18T19:58:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18005",
    "milestone": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18005#event-51536"
}
```
