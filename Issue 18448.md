# Issue 18448: Add basis status functions get_col_stat, get_row_stat to GLPK backend

Issue created by migration from Trac.

Original creator: mkoeppe

Original creation time: 2015-06-11 21:57:32

CC:  ncohen yzh

Keywords: LP, glpk

Expose the GLPK functions get_col_stat, get_row_stat in Sage's GLPKBackend class.

These functions are essential for any serious linear programming.
For example, if one wants to extract the exact rational basic solution from the dictionary, one needs the information returned by these functions.



---

Comment by ncohen created at 2015-06-11 22:42:16

I am curious to know how you would use it in Sage, but you will not have any problem exposing them. That's easy Cython.


---

Comment by mkoeppe created at 2015-06-11 23:50:28

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2015-06-11 23:50:28

New commits:


---

Comment by ncohen created at 2015-06-12 07:36:58

Your code needs documentation and doctests. You can mimic what is done on the other functions of the same file, and will find some documentation here:

http://doc.sagemath.org/html/en/developer/coding_basics.html#documentation-strings

Nathann


---

Comment by ncohen created at 2015-06-12 07:37:03

Changing status from needs_review to needs_work.


---

Comment by git created at 2015-06-12 17:25:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2015-06-12 17:33:46

Doctests have been added; please review


---

Comment by mkoeppe created at 2015-06-12 17:33:46

Changing status from needs_work to needs_review.


---

Comment by ncohen created at 2015-06-12 18:17:51

Could you protect against reading out-of-bounds constraints? Right now it crashes Sage. Could you also add a doctest for that?

Nathann


---

Comment by mkoeppe created at 2015-06-13 02:03:10

I am not sure if this ticket is the right place to introduce bounds checking for these functions.
Other GLPK backend functions don't do that either (below is an example) -- after all, GLPK does check the bounds; it only chooses to terminate the process with abort()....

Does this rather need to be handled with sig_on() / sig_off() somehow?


```
sage: lp.add_linear_constraint(zip([0, 1, 2], [8, 6, 1]), None, 48)
sage: lp.add_linear_constraint(zip([0, 1, 2], [4, 2, 1.5]), None, 20)
sage: lp.add_linear_constraint(zip([0, 1, 2], [2, 1.5, 0.5]), None, 8)
sage: lp.set_objective([60, 30, 20])
sage: import sage.numerical.backends.glpk_backend as backend
sage: lp.solver_parameter(backend.glp_simplex_or_intopt, backend.glp_simplex_only)
sage: lp.solve()
sage: lp.get_variable_value(-1)
glp_get_col_prim: j = 0; column number out of range
Error detected in file glpapi06.c at line 739
------------------------------------------------------------------------
Unhandled SIGABRT: An abort() occurred in Sage.
This probably occurred because a *compiled* component of Sage has a bug
in it and is not properly wrapped with sig_on(), sig_off().
Sage will now terminate.
------------------------------------------------------------------------
```



---

Comment by ncohen created at 2015-06-13 07:20:18

> I am not sure if this ticket is the right place to introduce bounds checking for these functions.

If you are ready to pay for a Python function call, you may as well avoid segfaults.

> Other GLPK backend functions don't do that either (below is an example)

Oh. Right. Well, that's because we hardly ever use this function by giving it integers, I'd say. We always give it symbolic LP variable, for which it is not a problem. You can fix both here if you like, but you should at least make the one you introduce check for this.

> Does this rather need to be handled with sig_on() / sig_off() somehow?

No, `sig_on/sig_off` is only meant to handle `KeyboardInterrupt`. 

Nathann


---

Comment by git created at 2015-06-13 10:10:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2015-06-13 10:14:40

Looks good! The patchbot complains that there are 'tab' characters in `glpk_backend.pxd`, however.


---

Comment by git created at 2015-06-13 10:31:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2015-06-13 10:32:51

Gooooooood to go!

Nathann

P.S.: Please fill the "Author" field with your full name


---

Comment by ncohen created at 2015-06-13 10:32:51

Changing status from needs_review to positive_review.


---

Comment by yzh created at 2015-06-13 10:42:02

Thanks!


---

Comment by vbraun created at 2015-06-14 19:54:39

Resolution: fixed
