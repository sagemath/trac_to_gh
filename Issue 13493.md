# Issue 13493: Improvements and corrections to QuotientRingElement

archive/issues_013493.json:
```json
{
    "body": "Assignee: malb\n\nThe class `QuotientRingElement`, which implements the operations an element of the quotient `R/I` of a ring `R` by an ideal `I`, suffers from several problems and limitations. Most of these were uncovered while working on #13670 and #13675.\n\n* While `QuotientRingElement` aims to be generic, it contains code dedicated to the case where `R` is a multivariate polynomial ring. In particular, the implementation of division first checks if `R` supports the computation of Groebner bases. This is not the proper way to go ; a special class should be created, following the approach taken for univariate polynomial quotient rings (`PolynomialQuotientRing`, `PolynomialQuotientRingElement`). We should create `MPolynomialQuotientRing` and `MPolynomialQuotientRingElement`, and host multivariate-polynomial-specific code here.\n\n* The `is_unit()` function does almost nothing (it checks if its argument is a unit in `R`). In the case of (multivariate) polynomial rings, an actual test can be implemented.\n\n* The class lacks an `is_regular()` methods (that detects zero divisors).\n\n* In the case of (multivariate) polynomial rings, `is_regular()` can be implemented.\n\n* The interest of `is_regular()` is that division by `x` should only be allowed if `x` is regular.\n\n* The present implementation of division has problems. It contains multivariate-polynomial-specific code, which is bad.     Furthermore, it allows division by zero-divisors, even tough the result is not defined :\n  {{{\n  sage: R.<x,y> = QQ[]\n  sage: S = R.quotient_ring(R.ideal(x^2, y))\n  sage: S(2*x)/S(x)\n  S(2)\n  sage: S(2) * S(x) == S(2*x)  # indeed, division works correctly....\n  True\n  sage: S(2+x) * S(x) == S(2*x) # but several \"quotients\" are possible, because ``S(x)`` is a zero-divisor   \n  }}}\n\n  In contrast, univariate polynomial rings behave more rigorously:\n  {{{\n  sage: P.<x> = QQ[]\n  sage: S = P.quotient_ring(x^2)\n  sage: S(2*x)/S(x)\n  ZeroDivisionError: element xbar of quotient polynomial ring not invertible\n  }}}\n\n* This raises the question of how we want division to proceed:\n   * ignore the problem? (current status, no overhead)\n   * test for regularity before dividing (mathematically better, may be **much** slower)\n\n* Clarifying all this would then open the possibility to have, for example, special code to deal with ideals given by a regular chain instead of a Groebner basis\n\nIssue created by migration from https://trac.sagemath.org/ticket/13697\n\n",
    "created_at": "2012-11-10T16:44:59Z",
    "labels": [
        "commutative algebra",
        "minor",
        "enhancement"
    ],
    "title": "Improvements and corrections to QuotientRingElement",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13493",
    "user": "Bouillaguet"
}
```
Assignee: malb

The class `QuotientRingElement`, which implements the operations an element of the quotient `R/I` of a ring `R` by an ideal `I`, suffers from several problems and limitations. Most of these were uncovered while working on #13670 and #13675.

* While `QuotientRingElement` aims to be generic, it contains code dedicated to the case where `R` is a multivariate polynomial ring. In particular, the implementation of division first checks if `R` supports the computation of Groebner bases. This is not the proper way to go ; a special class should be created, following the approach taken for univariate polynomial quotient rings (`PolynomialQuotientRing`, `PolynomialQuotientRingElement`). We should create `MPolynomialQuotientRing` and `MPolynomialQuotientRingElement`, and host multivariate-polynomial-specific code here.

* The `is_unit()` function does almost nothing (it checks if its argument is a unit in `R`). In the case of (multivariate) polynomial rings, an actual test can be implemented.

* The class lacks an `is_regular()` methods (that detects zero divisors).

* In the case of (multivariate) polynomial rings, `is_regular()` can be implemented.

* The interest of `is_regular()` is that division by `x` should only be allowed if `x` is regular.

* The present implementation of division has problems. It contains multivariate-polynomial-specific code, which is bad.     Furthermore, it allows division by zero-divisors, even tough the result is not defined :
  {{{
  sage: R.<x,y> = QQ[]
  sage: S = R.quotient_ring(R.ideal(x^2, y))
  sage: S(2*x)/S(x)
  S(2)
  sage: S(2) * S(x) == S(2*x)  # indeed, division works correctly....
  True
  sage: S(2+x) * S(x) == S(2*x) # but several "quotients" are possible, because ``S(x)`` is a zero-divisor   
  }}}

  In contrast, univariate polynomial rings behave more rigorously:
  {{{
  sage: P.<x> = QQ[]
  sage: S = P.quotient_ring(x^2)
  sage: S(2*x)/S(x)
  ZeroDivisionError: element xbar of quotient polynomial ring not invertible
  }}}

* This raises the question of how we want division to proceed:
   * ignore the problem? (current status, no overhead)
   * test for regularity before dividing (mathematically better, may be **much** slower)

* Clarifying all this would then open the possibility to have, for example, special code to deal with ideals given by a regular chain instead of a Groebner basis

Issue created by migration from https://trac.sagemath.org/ticket/13697





---

archive/issue_comments_166423.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-02-11T10:10:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13493#issuecomment-166423",
    "user": "Bouillaguet"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_166424.json:
```json
{
    "body": "Attachment",
    "created_at": "2013-02-11T10:10:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13493#issuecomment-166424",
    "user": "Bouillaguet"
}
```

Attachment



---

archive/issue_comments_166425.json:
```json
{
    "body": "I'll rebase this patch and try to review it.",
    "created_at": "2013-03-04T23:46:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13493#issuecomment-166425",
    "user": "saraedum"
}
```

I'll rebase this patch and try to review it.



---

archive/issue_comments_166426.json:
```json
{
    "body": "Attachment\n\nrebase of Bouillaguet's patch",
    "created_at": "2013-03-11T18:03:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13493#issuecomment-166426",
    "user": "saraedum"
}
```

Attachment

rebase of Bouillaguet's patch



---

archive/issue_comments_166427.json:
```json
{
    "body": "apply trac_13697.patch",
    "created_at": "2013-03-11T18:04:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13493#issuecomment-166427",
    "user": "saraedum"
}
```

apply trac_13697.patch



---

archive/issue_comments_166428.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2013-09-12T15:07:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13493#issuecomment-166428",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_166429.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2013-09-12T15:09:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13493#issuecomment-166429",
    "user": "saraedum"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_166430.json:
```json
{
    "body": "Your patch does not address all the questions in the Ticket summary. How do you want to proceed with this? Should we split this and move the issues to new tickets?",
    "created_at": "2013-09-12T15:09:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13493#issuecomment-166430",
    "user": "saraedum"
}
```

Your patch does not address all the questions in the Ticket summary. How do you want to proceed with this? Should we split this and move the issues to new tickets?



---

archive/issue_comments_166431.json:
```json
{
    "body": "I ran into the following:\n\n```\nsage: R.<x,y>=QQ[]\nsage: Q.<xx,yy>=R.quotient(x^2-y^3)\nsage: xx/yy\n...\nArithmeticError: Division failed. The numerator is not a multiple of the denominator.\n```\n\nIt would be nice if in this situation, the quotient ring could check if it is a domain, and if so, return `xx/yy` as an element of the fraction field.",
    "created_at": "2014-04-12T11:20:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13493#issuecomment-166431",
    "user": "pbruin"
}
```

I ran into the following:

```
sage: R.<x,y>=QQ[]
sage: Q.<xx,yy>=R.quotient(x^2-y^3)
sage: xx/yy
...
ArithmeticError: Division failed. The numerator is not a multiple of the denominator.
```

It would be nice if in this situation, the quotient ring could check if it is a domain, and if so, return `xx/yy` as an element of the fraction field.



---

archive/issue_comments_166432.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-05T23:40:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13493#issuecomment-166432",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_166433.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd86.5\".",
    "created_at": "2017-06-06T03:32:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13493#issuecomment-166433",
    "user": "saraedum"
}
```

Changing keywords from "" to "sd86.5".
