# Issue 24843: code for Cartesian factorization of posets

archive/issues_024843.json:
```json
{
    "body": "CC:  jmantysalo\n\nas a very useful tool to have\n\nIssue created by migration from https://trac.sagemath.org/ticket/25080\n\n",
    "created_at": "2018-04-02T15:34:36Z",
    "labels": [
        "combinatorics",
        "major",
        "enhancement"
    ],
    "title": "code for Cartesian factorization of posets",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24843",
    "user": "chapoton"
}
```
CC:  jmantysalo

as a very useful tool to have

Issue created by migration from https://trac.sagemath.org/ticket/25080





---

archive/issue_comments_348923.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-04-02T15:35:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348923",
    "user": "chapoton"
}
```

New commits:



---

archive/issue_comments_348924.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-04-02T15:35:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348924",
    "user": "chapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_348925.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-02T16:01:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348925",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_348926.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-04-02T17:58:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348926",
    "user": "jmantysalo"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_348927.json:
```json
{
    "body": "Fails with disconnected posets, see `posets.AntichainPoset(4).factorize()`. Works with the empty poset, but a test for the corner case would be nice.\n\nMaybe this is the best name for this function; however, what will be the name for the converse of ordinal product?\n\nI think that a factor of a lattice is always a lattice. Or is it? Got to think about this later.\n\nE: Also, a test where the underlying undirected graph can be factorized, but the poset can not, would be nice.",
    "created_at": "2018-04-02T17:58:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348927",
    "user": "jmantysalo"
}
```

Fails with disconnected posets, see `posets.AntichainPoset(4).factorize()`. Works with the empty poset, but a test for the corner case would be nice.

Maybe this is the best name for this function; however, what will be the name for the converse of ordinal product?

I think that a factor of a lattice is always a lattice. Or is it? Got to think about this later.

E: Also, a test where the underlying undirected graph can be factorized, but the poset can not, would be nice.



---

archive/issue_comments_348928.json:
```json
{
    "body": "Wrong indentation in the reference, i.e. may break Sphinx.",
    "created_at": "2018-04-02T18:04:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348928",
    "user": "jmantysalo"
}
```

Wrong indentation in the reference, i.e. may break Sphinx.



---

archive/issue_comments_348929.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-02T19:00:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348929",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_348930.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-02T19:20:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348930",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_348931.json:
```json
{
    "body": "Thanks for the comments, Jori.\n\nFor the name, my favorite choice would be just \"factor\". Other possibilies are \"factor_cartesian\" and \"factor_ordinal\" ; or maybe \"cartesian_factor\" and \"ordinal_factor\".\n\nFor the lattice property, I think this holds for the factors, and the same for MeetSemiLattice, etc. But I do not feel any need for that.",
    "created_at": "2018-04-02T19:45:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348931",
    "user": "chapoton"
}
```

Thanks for the comments, Jori.

For the name, my favorite choice would be just "factor". Other possibilies are "factor_cartesian" and "factor_ordinal" ; or maybe "cartesian_factor" and "ordinal_factor".

For the lattice property, I think this holds for the factors, and the same for MeetSemiLattice, etc. But I do not feel any need for that.



---

archive/issue_comments_348932.json:
```json
{
    "body": "See http://www.phy.olemiss.edu/~luca/Topics/p/poset_types.html: \"Prime poset: One such that all its autonomous subsets are trivial.\" Is this the same concept with different words? If not, should that be mentioned in `OUTPUT` section?\n\nMaybe \"factor\" or \"factorize\" is good, as also plain \"product\" means the Cartesian product.\n\nIs it really a `ValueError` to run this with unconnected posets? IMO it should be seen as a missing implementation, as an unconnected poset can be a Cartesian product of two posets.",
    "created_at": "2018-04-03T04:19:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348932",
    "user": "jmantysalo"
}
```

See http://www.phy.olemiss.edu/~luca/Topics/p/poset_types.html: "Prime poset: One such that all its autonomous subsets are trivial." Is this the same concept with different words? If not, should that be mentioned in `OUTPUT` section?

Maybe "factor" or "factorize" is good, as also plain "product" means the Cartesian product.

Is it really a `ValueError` to run this with unconnected posets? IMO it should be seen as a missing implementation, as an unconnected poset can be a Cartesian product of two posets.



---

archive/issue_comments_348933.json:
```json
{
    "body": "Error in seealso-link, cartesian_product() should be product().\n\nAlso there is now two seealso-blocks in product(), and it seems a little strange.",
    "created_at": "2018-04-03T06:00:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348933",
    "user": "jmantysalo"
}
```

Error in seealso-link, cartesian_product() should be product().

Also there is now two seealso-blocks in product(), and it seems a little strange.



---

archive/issue_comments_348934.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-03T06:29:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348934",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_348935.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-04-03T06:31:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348935",
    "user": "chapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_348936.json:
```json
{
    "body": "All done.\n\nThere remains, maybe, the question of using `LatticePoset` for the factors when handling products of lattices.",
    "created_at": "2018-04-03T06:31:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348936",
    "user": "chapoton"
}
```

All done.

There remains, maybe, the question of using `LatticePoset` for the factors when handling products of lattices.



---

archive/issue_comments_348937.json:
```json
{
    "body": "Thanks. Now, to the code. When is `if A1 != B1:` evaluated as true? I guess you have implemented an algorithm to factor general digraph, and for poset you don't need all of that.",
    "created_at": "2018-04-03T06:36:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348937",
    "user": "jmantysalo"
}
```

Thanks. Now, to the code. When is `if A1 != B1:` evaluated as true? I guess you have implemented an algorithm to factor general digraph, and for poset you don't need all of that.



---

archive/issue_comments_348938.json:
```json
{
    "body": "The idea is to check that every little square is a commutative square. There are certainly better ways than what I did quickly. The `A1 != B1` test is meant to check that parallel arrows in one square go the same way.\n\nThe algorithm would possibly work for simple digraphs with no 2-cycles. Given this restricted domain, I think it is best to keep it here for the moment.",
    "created_at": "2018-04-03T07:01:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348938",
    "user": "chapoton"
}
```

The idea is to check that every little square is a commutative square. There are certainly better ways than what I did quickly. The `A1 != B1` test is meant to check that parallel arrows in one square go the same way.

The algorithm would possibly work for simple digraphs with no 2-cycles. Given this restricted domain, I think it is best to keep it here for the moment.



---

archive/issue_comments_348939.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-04-03T07:42:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348939",
    "user": "jmantysalo"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_348940.json:
```json
{
    "body": "OK, I'll mark this as positive review. (Change milestone when 8.3 is available.)\n\nI don't see how there could be parallel arrows when the graph is the Hasse diagram of some poset. However, almost all the time is spent in factoring undirected graph, so this makes no real difference.\n\nOutput type for lattices can be changed later.\n\nThere are some shortcuts that could be used: for example the numbers of minimal elements must not be a prime. Also the number of edges in the Hasse diagram can show that a poset can't be a Cartesian product etc. However, all this can also be added later.",
    "created_at": "2018-04-03T07:42:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348940",
    "user": "jmantysalo"
}
```

OK, I'll mark this as positive review. (Change milestone when 8.3 is available.)

I don't see how there could be parallel arrows when the graph is the Hasse diagram of some poset. However, almost all the time is spent in factoring undirected graph, so this makes no real difference.

Output type for lattices can be changed later.

There are some shortcuts that could be used: for example the numbers of minimal elements must not be a prime. Also the number of edges in the Hasse diagram can show that a poset can't be a Cartesian product etc. However, all this can also be added later.



---

archive/issue_comments_348941.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-12T11:46:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24843#issuecomment-348941",
    "user": "vbraun"
}
```

Resolution: fixed
