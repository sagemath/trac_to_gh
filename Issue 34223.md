# Issue 34223: Fix tests with ipywidgets 8

archive/issues_034223.json:
```json
{
    "body": "CC:  @mkoeppe @kiwifb @tornaria @collares @vbraun @egourgoulhon\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/34460\n\n",
    "created_at": "2022-08-30T18:44:44Z",
    "labels": [
        "PLEASE CHANGE",
        "major"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Fix tests with ipywidgets 8",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34223",
    "user": "@antonio-rojas"
}
```
CC:  @mkoeppe @kiwifb @tornaria @collares @vbraun @egourgoulhon



Issue created by migration from https://trac.sagemath.org/ticket/34460





---

archive/issue_comments_485445.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-08-30T18:51:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485445",
    "user": "@antonio-rojas"
}
```

New commits:



---

archive/issue_comments_485446.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-08-30T18:51:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485446",
    "user": "@antonio-rojas"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_485447.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2022-08-30T18:51:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485447",
    "user": "@antonio-rojas"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_485448.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to packages: standard.",
    "created_at": "2022-08-30T18:51:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485448",
    "user": "@antonio-rojas"
}
```

Changing component from PLEASE CHANGE to packages: standard.



---

archive/issue_comments_485449.json:
```json
{
    "body": "Not 100% sure this is related, but after upgrading jupyter-widgets and related packages I am seeing 21 failing tests in `src/sage/interacts/test_jupyter.rst`. They all have control sequences/escape characters such as:\n\n\n```\nsage -t --long --random-seed=250623221176838603645666806457165844244 /nix/store/39k0iiwx3wi7jikqnzbqh7hrrlpivm78-sage-src-9.7/src/sage/interacts/test_jupyter.rst\n**********************************************************************\nFile \"/nix/store/39k0iiwx3wi7jikqnzbqh7hrrlpivm78-sage-src-9.7/src/sage/interacts/test_jupyter.rst\", line 180, in sage.interacts.test_jupyter\nFailed example:\n    test(interacts.calculus.bisection_method)\nExpected:\n    Interactive function <function bisection_method at ...> with 5 widgets\n      title: HTMLText(value='<h2>Bisection method</h2>')\n      f: EvalText(value='x^2-2', description='f(x)', layout=Layout(max_width='81em'))\n      interval: IntRangeSlider(value=(0, 4), description='range', max=5, min=-5)\n      d: IntSlider(value=3, description='$10^{-d}$ precision', max=8, min=1)\n      maxn: IntSlider(value=10, description='max iterations', max=50)\n    \\(\\text{Precision }h = 10^{-d}=10^{-3}=0.00100\\)\n    \\({c = }1.4140625\\)\n    \\({f(c) = }-0.00042724609375\\)\n    \\(9 \\text{ iterations}\\)\nGot:\n    <CSI-2K>^M<CSI-2K>^M\\(\\text{Precision }h = 10^{-d}=10^{-3}=0.00100\\)\n    \\({c = }1.4140625\\)\n    \\({f(c) = }-0.00042724609375\\)\n    \\(9 \\text{ iterations}\\)\n    Interactive function <function bisection_method at 0x7fff88569630> with 5 widgets\n      title: HTMLText(value='<h2>Bisection method</h2>')\n      f: EvalText(value='x^2-2', description='f(x)', layout=Layout(max_width='81em'))\n      interval: IntRangeSlider(value=(0, 4), description='range', max=5, min=-5)\n      d: IntSlider(value=3, description='$10^{-d}$ precision', max=8, min=1)\n      maxn: IntSlider(value=10, description='max iterations', max=50)\n    \\(\\text{Precision }h = 10^{-d}=10^{-3}=0.00100\\)\n    \\({c = }1.4140625\\)\n    \\({f(c) = }-0.00042724609375\\)\n    \\(9 \\text{ iterations}\\)\n**********************************************************************\nFile \"/nix/store/39k0iiwx3wi7jikqnzbqh7hrrlpivm78-sage-src-9.7/src/sage/interacts/test_jupyter.rst\", line 192, in sage.interacts.test_jupyter\nFailed example:\n    test(interacts.calculus.riemann_sum)\nExpected:\n    Manual interactive function <function riemann_sum at ...> with 9 widgets\n      title: HTMLText(value='<h2>Riemann integral with random sampling</h2>')\n      f: EvalText(value='x^2+1', description='$f(x)=$', layout=Layout(max_width='41em'))\n      n: IntSlider(value=5, description='# divisions', max=30, min=1)\n      hr1: HTMLText(value='<hr>')\n      interval_input: ToggleButtons(description='Integration interval', options=('from slider', 'from keyboard'), value='from slider')\n      interval_s: IntRangeSlider(value=(0, 2), description='slider: ', max=10, min=-5)\n      interval_g: Grid(value=[[0, 2]], children=(Label(value='keyboard: '), VBox(children=(EvalText(value='0', layout=Layout(max_width='5em')),)), VBox(children=(EvalText(value='2', layout=Layout(max_width='5em')),))))\n      hr2: HTMLText(value='<hr>')\n      list_table: Checkbox(value=False, description='List table')\n    <small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=...\\)\n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} +\n    1\\,\\mathrm{d}x=4.666666666666668\\)\nGot:\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=4.127671780067391\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=4.684039567609587\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=4.477886877874835\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=5.613881858984628\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=6.228858742666399\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=4.598306339045656\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=4.45910993544406\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=5.285792626236389\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=5.348125253390601\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=5.376388761226274\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=3.823901934033623\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=5.424469987768077\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=6.089305916730408\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=4.340945220537433\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=3.98349497390619\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=4.803422027740802\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=4.42705500648823\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=6.256746951601706\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=6.051441325477226\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=3.8867582141357317\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=5.553517548071945\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=4.313714559213407\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n    Manual interactive function <function riemann_sum at 0x7fff8856b880> with 9 widgets\n      title: HTMLText(value='<h2>Riemann integral with random sampling</h2>')\n      f: EvalText(value='x^2+1', description='$f(x)=$', layout=Layout(max_width='41em'))\n      n: IntSlider(value=5, description='# divisions', max=30, min=1)\n      hr1: HTMLText(value='<hr>')\n      interval_input: ToggleButtons(description='Integration interval', options=('from slider', 'from keyboard'), value='from slider')\n      interval_s: IntRangeSlider(value=(0, 2), description='slider: ', max=10, min=-5)\n      interval_g: Grid(value=[[0, 2]], children=(Label(value='keyboard: '), VBox(children=(EvalText(value='0', layout=Layout(max_width='5em')),)), VBox(children=(EvalText(value='2', layout=Layout(max_width='5em')),))))\n      hr2: HTMLText(value='<hr>')\n      list_table: Checkbox(value=False, description='List table')\n    <small>Adjust your data and click Update button. Click repeatedly for another random values.</small>\n    Riemann sum: \\(\\displaystyle\\sum_{i=1}^{5} f(\\eta_i)(x_i-x_{i-1})=4.530774274990167\\) \n    Exact value of the integral \\(\\displaystyle\\int_{0}^{2}x^{2} + 1\\,\\mathrm{d}x=4.666666666666668\\)\n```\n\nLooks like some code is not testing if the terminal is capable of processing those escape sequences.",
    "created_at": "2022-09-22T19:34:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485449",
    "user": "@collares"
}
```

Not 100% sure this is related, but after upgrading jupyter-widgets and related packages I am seeing 21 failing tests in `src/sage/interacts/test_jupyter.rst`. They all have control sequences/escape characters such as:


```
sage -t --long --random-seed=250623221176838603645666806457165844244 /nix/store/39k0iiwx3wi7jikqnzbqh7hrrlpivm78-sage-src-9.7/src/sage/interacts/test_jupyter.rst
**********************************************************************
File "/nix/store/39k0iiwx3wi7jikqnzbqh7hrrlpivm78-sage-src-9.7/src/sage/interacts/test_jupyter.rst", line 180, in sage.interacts.test_jupyter
Failed example:
    test(interacts.calculus.bisection_method)
Expected:
    Interactive function <function bisection_method at ...> with 5 widgets
      title: HTMLText(value='<h2>Bisection method</h2>')
      f: EvalText(value='x^2-2', description='f(x)', layout=Layout(max_width='81em'))
      interval: IntRangeSlider(value=(0, 4), description='range', max=5, min=-5)
      d: IntSlider(value=3, description='$10^{-d}$ precision', max=8, min=1)
      maxn: IntSlider(value=10, description='max iterations', max=50)
    \(\text{Precision }h = 10^{-d}=10^{-3}=0.00100\)
    \({c = }1.4140625\)
    \({f(c) = }-0.00042724609375\)
    \(9 \text{ iterations}\)
Got:
    <CSI-2K>^M<CSI-2K>^M\(\text{Precision }h = 10^{-d}=10^{-3}=0.00100\)
    \({c = }1.4140625\)
    \({f(c) = }-0.00042724609375\)
    \(9 \text{ iterations}\)
    Interactive function <function bisection_method at 0x7fff88569630> with 5 widgets
      title: HTMLText(value='<h2>Bisection method</h2>')
      f: EvalText(value='x^2-2', description='f(x)', layout=Layout(max_width='81em'))
      interval: IntRangeSlider(value=(0, 4), description='range', max=5, min=-5)
      d: IntSlider(value=3, description='$10^{-d}$ precision', max=8, min=1)
      maxn: IntSlider(value=10, description='max iterations', max=50)
    \(\text{Precision }h = 10^{-d}=10^{-3}=0.00100\)
    \({c = }1.4140625\)
    \({f(c) = }-0.00042724609375\)
    \(9 \text{ iterations}\)
**********************************************************************
File "/nix/store/39k0iiwx3wi7jikqnzbqh7hrrlpivm78-sage-src-9.7/src/sage/interacts/test_jupyter.rst", line 192, in sage.interacts.test_jupyter
Failed example:
    test(interacts.calculus.riemann_sum)
Expected:
    Manual interactive function <function riemann_sum at ...> with 9 widgets
      title: HTMLText(value='<h2>Riemann integral with random sampling</h2>')
      f: EvalText(value='x^2+1', description='$f(x)=$', layout=Layout(max_width='41em'))
      n: IntSlider(value=5, description='# divisions', max=30, min=1)
      hr1: HTMLText(value='<hr>')
      interval_input: ToggleButtons(description='Integration interval', options=('from slider', 'from keyboard'), value='from slider')
      interval_s: IntRangeSlider(value=(0, 2), description='slider: ', max=10, min=-5)
      interval_g: Grid(value=[[0, 2]], children=(Label(value='keyboard: '), VBox(children=(EvalText(value='0', layout=Layout(max_width='5em')),)), VBox(children=(EvalText(value='2', layout=Layout(max_width='5em')),))))
      hr2: HTMLText(value='<hr>')
      list_table: Checkbox(value=False, description='List table')
    <small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=...\)
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} +
    1\,\mathrm{d}x=4.666666666666668\)
Got:
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=4.127671780067391\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=4.684039567609587\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=4.477886877874835\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=5.613881858984628\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=6.228858742666399\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=4.598306339045656\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=4.45910993544406\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=5.285792626236389\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=5.348125253390601\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=5.376388761226274\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=3.823901934033623\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=5.424469987768077\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=6.089305916730408\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=4.340945220537433\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=3.98349497390619\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=4.803422027740802\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=4.42705500648823\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=6.256746951601706\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=6.051441325477226\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=3.8867582141357317\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=5.553517548071945\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    <CSI-2K>^M<CSI-2K>^M<small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=4.313714559213407\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
    Manual interactive function <function riemann_sum at 0x7fff8856b880> with 9 widgets
      title: HTMLText(value='<h2>Riemann integral with random sampling</h2>')
      f: EvalText(value='x^2+1', description='$f(x)=$', layout=Layout(max_width='41em'))
      n: IntSlider(value=5, description='# divisions', max=30, min=1)
      hr1: HTMLText(value='<hr>')
      interval_input: ToggleButtons(description='Integration interval', options=('from slider', 'from keyboard'), value='from slider')
      interval_s: IntRangeSlider(value=(0, 2), description='slider: ', max=10, min=-5)
      interval_g: Grid(value=[[0, 2]], children=(Label(value='keyboard: '), VBox(children=(EvalText(value='0', layout=Layout(max_width='5em')),)), VBox(children=(EvalText(value='2', layout=Layout(max_width='5em')),))))
      hr2: HTMLText(value='<hr>')
      list_table: Checkbox(value=False, description='List table')
    <small>Adjust your data and click Update button. Click repeatedly for another random values.</small>
    Riemann sum: \(\displaystyle\sum_{i=1}^{5} f(\eta_i)(x_i-x_{i-1})=4.530774274990167\) 
    Exact value of the integral \(\displaystyle\int_{0}^{2}x^{2} + 1\,\mathrm{d}x=4.666666666666668\)
```

Looks like some code is not testing if the terminal is capable of processing those escape sequences.



---

archive/issue_comments_485450.json:
```json
{
    "body": "On ipywidgets 7, replacing `on_displayed` by `on_widget_constructed` causes test failures. Removing the `on_displayed` lines altogether, however, passes tests (I haven't checked the actual interactive widgets, though):\n\n```diff\ndiff --git a/src/sage/combinat/cluster_algebra_quiver/interact.py b/src/sage/combinat/cluster_algebra_quiver/interact.py\nindex 1c88e613b4..f74039213c 100644\n--- a/src/sage/combinat/cluster_algebra_quiver/interact.py\n+++ b/src/sage/combinat/cluster_algebra_quiver/interact.py\n@@ -107,8 +107,6 @@ def cluster_interact(self, fig_size=1, circular=True, kind='seed'):\n     show_lastmutation.observe(refresh, 'value')\n     which_plot.observe(refresh, 'value')\n \n-    mut_buttons.on_widget_constructed(refresh)\n-\n     if kind == 'seed':\n         top = widgets.HBox([show_seq, show_vars])\n     else:\ndiff --git a/src/sage/repl/ipython_kernel/interact.py b/src/sage/repl/ipython_kernel/interact.py\nindex 4f96a212ab..23699601a3 100644\n--- a/src/sage/repl/ipython_kernel/interact.py\n+++ b/src/sage/repl/ipython_kernel/interact.py\n@@ -124,10 +124,7 @@ class sage_interactive(interactive):\n \n         self.__signature = sig.replace(parameters=params.values())\n         super().__init__(f, options, **kwds)\n-        if self.manual:\n-            # In Sage, manual interacts are always run once\n-            self.on_widget_constructed(self.update)\n-        else:\n+        if not self.manual:\n             # In automatic mode, clicking on a ToggleButtons button\n             # should also run the interact\n             for widget in self.kwargs_widgets:\n```\n\n\nCalling `self.update()` instead of deleting the second `on_widget_constructed` prints an extra line and causes test failures on ipywidgets 7 (calling `refresh(None)` manually does not cause test failures, but it would be a bit asymmetrical to do so).\n\nOn ipywidgets 8, the 20 occurrences of \"Interactive function\" in `src/sage/interacts/test_jupyter.rst` need to be replaced by \"...Interactive function\", similar to other changes made in this branch. With this replacement and the above patch, there is a single test failure caused by a doctest warning appearing in the wrong order:\n\n\n```\nFailed example:\n    test(interacts.statistics.coin)\nExpected:\n    ...Interactive function <function coin at ...> with 2 widgets\n      n: IntSlider(value=1000, description='Number of Tosses', max=10000, min=2, step=100)\n      interval: IntRangeSlider(value=(0, 0), description='Plotting range (y)', max=1)\n    doctest:...: UserWarning: Attempting to set identical bottom == top == 0.0 results in singular transformations; automatically expanding.\nGot:\ndoctest:warning\n[...]\n    :\n    UserWarning: Attempting to set identical bottom == top == 0.0 results in singular transformations; automatically expanding.\n    Interactive function <function coin at 0x7fff8872f250> with 2 widgets\n      n: IntSlider(value=1000, description='Number of Tosses', max=10000, min=2, step=100)\n      interval: IntRangeSlider(value=(0, 0), description='Plotting range (y)', max=1)\n```\n\n\n(`[...]` indicates lines I deleted for brevity).",
    "created_at": "2022-09-24T03:41:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485450",
    "user": "@collares"
}
```

On ipywidgets 7, replacing `on_displayed` by `on_widget_constructed` causes test failures. Removing the `on_displayed` lines altogether, however, passes tests (I haven't checked the actual interactive widgets, though):

```diff
diff --git a/src/sage/combinat/cluster_algebra_quiver/interact.py b/src/sage/combinat/cluster_algebra_quiver/interact.py
index 1c88e613b4..f74039213c 100644
--- a/src/sage/combinat/cluster_algebra_quiver/interact.py
+++ b/src/sage/combinat/cluster_algebra_quiver/interact.py
@@ -107,8 +107,6 @@ def cluster_interact(self, fig_size=1, circular=True, kind='seed'):
     show_lastmutation.observe(refresh, 'value')
     which_plot.observe(refresh, 'value')
 
-    mut_buttons.on_widget_constructed(refresh)
-
     if kind == 'seed':
         top = widgets.HBox([show_seq, show_vars])
     else:
diff --git a/src/sage/repl/ipython_kernel/interact.py b/src/sage/repl/ipython_kernel/interact.py
index 4f96a212ab..23699601a3 100644
--- a/src/sage/repl/ipython_kernel/interact.py
+++ b/src/sage/repl/ipython_kernel/interact.py
@@ -124,10 +124,7 @@ class sage_interactive(interactive):
 
         self.__signature = sig.replace(parameters=params.values())
         super().__init__(f, options, **kwds)
-        if self.manual:
-            # In Sage, manual interacts are always run once
-            self.on_widget_constructed(self.update)
-        else:
+        if not self.manual:
             # In automatic mode, clicking on a ToggleButtons button
             # should also run the interact
             for widget in self.kwargs_widgets:
```


Calling `self.update()` instead of deleting the second `on_widget_constructed` prints an extra line and causes test failures on ipywidgets 7 (calling `refresh(None)` manually does not cause test failures, but it would be a bit asymmetrical to do so).

On ipywidgets 8, the 20 occurrences of "Interactive function" in `src/sage/interacts/test_jupyter.rst` need to be replaced by "...Interactive function", similar to other changes made in this branch. With this replacement and the above patch, there is a single test failure caused by a doctest warning appearing in the wrong order:


```
Failed example:
    test(interacts.statistics.coin)
Expected:
    ...Interactive function <function coin at ...> with 2 widgets
      n: IntSlider(value=1000, description='Number of Tosses', max=10000, min=2, step=100)
      interval: IntRangeSlider(value=(0, 0), description='Plotting range (y)', max=1)
    doctest:...: UserWarning: Attempting to set identical bottom == top == 0.0 results in singular transformations; automatically expanding.
Got:
doctest:warning
[...]
    :
    UserWarning: Attempting to set identical bottom == top == 0.0 results in singular transformations; automatically expanding.
    Interactive function <function coin at 0x7fff8872f250> with 2 widgets
      n: IntSlider(value=1000, description='Number of Tosses', max=10000, min=2, step=100)
      interval: IntRangeSlider(value=(0, 0), description='Plotting range (y)', max=1)
```


(`[...]` indicates lines I deleted for brevity).



---

archive/issue_comments_485451.json:
```json
{
    "body": "Replying to [comment:5 Mauricio Collares]:\n> On ipywidgets 7, replacing `on_displayed` by `on_widget_constructed` causes test failures.\n\nSince this ticket missed 9.7 and is now aimed at 9.8, I think we can just turn it into an actual upgrate ticket and not worry about ipywidgets 7 compatibility.\n\n\n> Removing the `on_displayed` lines altogether, however, passes tests (I haven't checked the actual interactive widgets, though):\n\nI did test the widget, and removing `on_displayed` made the graph not be populated on load, until you click one of the buttons.\n\n> On ipywidgets 8, the 20 occurrences of \"Interactive function\" in `src/sage/interacts/test_jupyter.rst` need to be replaced by \"...Interactive function\", similar to other changes made in this branch.\n\nThanks, I only test the installed bits so that explains why I missed those.\n\n> With this replacement and the above patch, there is a single test failure caused by a doctest warning appearing in the wrong order:\n\nWhere is the `doctest:...` line in the expected output coming from? It's neither in the current code nor in this branch.",
    "created_at": "2022-09-24T08:02:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485451",
    "user": "@antonio-rojas"
}
```

Replying to [comment:5 Mauricio Collares]:
> On ipywidgets 7, replacing `on_displayed` by `on_widget_constructed` causes test failures.

Since this ticket missed 9.7 and is now aimed at 9.8, I think we can just turn it into an actual upgrate ticket and not worry about ipywidgets 7 compatibility.


> Removing the `on_displayed` lines altogether, however, passes tests (I haven't checked the actual interactive widgets, though):

I did test the widget, and removing `on_displayed` made the graph not be populated on load, until you click one of the buttons.

> On ipywidgets 8, the 20 occurrences of "Interactive function" in `src/sage/interacts/test_jupyter.rst` need to be replaced by "...Interactive function", similar to other changes made in this branch.

Thanks, I only test the installed bits so that explains why I missed those.

> With this replacement and the above patch, there is a single test failure caused by a doctest warning appearing in the wrong order:

Where is the `doctest:...` line in the expected output coming from? It's neither in the current code nor in this branch.



---

archive/issue_comments_485452.json:
```json
{
    "body": "Replying to [comment:6 Antonio Rojas]:\n> Where is the `doctest:...` line in the expected output coming from? It's neither in the current code nor in this branch.\n\nNevermind, I was looking at the wrong file",
    "created_at": "2022-09-24T08:20:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485452",
    "user": "@antonio-rojas"
}
```

Replying to [comment:6 Antonio Rojas]:
> Where is the `doctest:...` line in the expected output coming from? It's neither in the current code nor in this branch.

Nevermind, I was looking at the wrong file



---

archive/issue_comments_485453.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-24T20:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485453",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485454.json:
```json
{
    "body": "Thank you for the update! I can confirm that tests now pass with ipywidgets 8.",
    "created_at": "2022-09-25T01:42:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485454",
    "user": "@collares"
}
```

Thank you for the update! I can confirm that tests now pass with ipywidgets 8.



---

archive/issue_comments_485455.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-25T04:15:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485455",
    "user": "@kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_485456.json:
```json
{
    "body": "Works for me too.",
    "created_at": "2022-09-25T04:15:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485456",
    "user": "@kiwifb"
}
```

Works for me too.



---

archive/issue_comments_485457.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2022-09-25T06:38:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485457",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_485458.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2022-09-25T06:38:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485458",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_485459.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-25T07:00:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485459",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485460.json:
```json
{
    "body": "What's the deal with `jupyterlab_widgets`? It should be updated too, but I don't see any version information in `build/pkgs/jupyterlab_widgets`",
    "created_at": "2022-09-25T07:02:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485460",
    "user": "@antonio-rojas"
}
```

What's the deal with `jupyterlab_widgets`? It should be updated too, but I don't see any version information in `build/pkgs/jupyterlab_widgets`



---

archive/issue_comments_485461.json:
```json
{
    "body": "Currently `jupyterlab_widgets` is a pip package https://doc.sagemath.org/html/en/developer/packaging.html#package-source-types; version constraints would be in requirements.txt, but we have not set any. So it's just taking the most current version from PyPI.",
    "created_at": "2022-09-25T16:00:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485461",
    "user": "@mkoeppe"
}
```

Currently `jupyterlab_widgets` is a pip package https://doc.sagemath.org/html/en/developer/packaging.html#package-source-types; version constraints would be in requirements.txt, but we have not set any. So it's just taking the most current version from PyPI.



---

archive/issue_comments_485462.json:
```json
{
    "body": "Latest changes in `build/pkgs` need review",
    "created_at": "2022-09-29T19:34:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485462",
    "user": "@antonio-rojas"
}
```

Latest changes in `build/pkgs` need review



---

archive/issue_comments_485463.json:
```json
{
    "body": "Yes, I hadn't looked at the building side of it. After inspection it looks alright to me.",
    "created_at": "2022-09-29T19:54:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485463",
    "user": "@kiwifb"
}
```

Yes, I hadn't looked at the building side of it. After inspection it looks alright to me.



---

archive/issue_comments_485464.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-29T19:54:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485464",
    "user": "@kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_485465.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-10-09T18:36:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485465",
    "user": "@mkoeppe"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_485466.json:
```json
{
    "body": "With this ticket, I am getting docbuild failures:\n\n```\n  [sagemath_doc_html-none]   pkg_resources.DistributionNotFound: The 'jupyterlab-widgets~=3.0' distribution was not found and is required by ipywidgets\n  [sagemath_doc_html-none]   Traceback (most recent call last):\n  [sagemath_doc_html-none]     File \"/sage/local/var/lib/sage/venv-python3.10/bin/sage-venv-config\", line 4, in <module>\n  [sagemath_doc_html-none]       __import__('pkg_resources').require('sagemath-standard==9.8b1')\n```\n\nhttps://github.com/mkoeppe/sage/actions/runs/3209136265/jobs/5250533818",
    "created_at": "2022-10-09T18:36:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485466",
    "user": "@mkoeppe"
}
```

With this ticket, I am getting docbuild failures:

```
  [sagemath_doc_html-none]   pkg_resources.DistributionNotFound: The 'jupyterlab-widgets~=3.0' distribution was not found and is required by ipywidgets
  [sagemath_doc_html-none]   Traceback (most recent call last):
  [sagemath_doc_html-none]     File "/sage/local/var/lib/sage/venv-python3.10/bin/sage-venv-config", line 4, in <module>
  [sagemath_doc_html-none]       __import__('pkg_resources').require('sagemath-standard==9.8b1')
```

https://github.com/mkoeppe/sage/actions/runs/3209136265/jobs/5250533818



---

archive/issue_comments_485467.json:
```json
{
    "body": "I think we need to make `jupyterlab_widgets` a standard package. This can now be a \"wheel\" package (#34450)",
    "created_at": "2022-10-09T19:09:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485467",
    "user": "@mkoeppe"
}
```

I think we need to make `jupyterlab_widgets` a standard package. This can now be a "wheel" package (#34450)



---

archive/issue_comments_485468.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-10-09T19:18:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485468",
    "user": "@mkoeppe"
}
```

New commits:



---

archive/issue_comments_485469.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-09T19:21:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485469",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485470.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-10-09T19:22:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485470",
    "user": "@mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_485471.json:
```json
{
    "body": "Let's get this in please",
    "created_at": "2022-10-18T02:09:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485471",
    "user": "@mkoeppe"
}
```

Let's get this in please



---

archive/issue_comments_485472.json:
```json
{
    "body": "LGTM. In particular, I've tested it atop of Sage 9.8.beta2 with this notebook:\n\nhttps://github.com/egourgoulhon/SageMathTest/blob/master/Notebooks/test_display.ipynb\n\nboth with Jupyter notebook and with Jupyterlab. \nI've installed Jupyterlab after merging the ticket branch via simply\n\n```\nsage -i jupyterlab\n```\n\nI thus confirm that, thanks to this ticket, there is no need to run `sage -i jupyterlab_widgets`.\n\nNB: to run `%matplotlib widget` (cf. cell 20 of the above notebook), I had to install manually `ipympl` via `sage -pip install ipympl`.",
    "created_at": "2022-10-18T20:36:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485472",
    "user": "@egourgoulhon"
}
```

LGTM. In particular, I've tested it atop of Sage 9.8.beta2 with this notebook:

https://github.com/egourgoulhon/SageMathTest/blob/master/Notebooks/test_display.ipynb

both with Jupyter notebook and with Jupyterlab. 
I've installed Jupyterlab after merging the ticket branch via simply

```
sage -i jupyterlab
```

I thus confirm that, thanks to this ticket, there is no need to run `sage -i jupyterlab_widgets`.

NB: to run `%matplotlib widget` (cf. cell 20 of the above notebook), I had to install manually `ipympl` via `sage -pip install ipympl`.



---

archive/issue_comments_485473.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-10-18T20:36:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485473",
    "user": "@egourgoulhon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_485474.json:
```json
{
    "body": "Thanks!",
    "created_at": "2022-10-18T22:23:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485474",
    "user": "@mkoeppe"
}
```

Thanks!



---

archive/issue_comments_485475.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-10-23T20:49:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34223",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34223#issuecomment-485475",
    "user": "@vbraun"
}
```

Resolution: fixed
