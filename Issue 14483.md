# Issue 14483: Extra readline commands not working

Issue created by migration from https://trac.sagemath.org/ticket/14687

Original creator: klee

Original creation time: 2013-06-05 01:59:21

Assignee: was

CC:  dimpase

After #12719, the extra readline commands do not work in Sage even though the IPython configuration file is updated according to a new format.


---

Attachment

To scripts repository


---

Comment by klee created at 2013-06-05 04:56:26

Changing type from PLEASE CHANGE to defect.


---

Comment by klee created at 2013-06-05 04:58:36

Changing status from new to needs_review.


---

Comment by dimpase created at 2013-06-06 05:14:05

I am trying to follow the instructions on #12503 (as I removed my `~/.sage/` at some point lately), but it does not seem to work (using Sage 5.9 on OSX 10.6.8).

Hitting `control-o` results in cursor moving forward in the line few spaces, similar to TAB. (after I do `stty discard undef` before starting Sage).


`history-search-forward-and-save` does not work at all.

Same with Sage 5.10.rc0 on Linux.


---

Comment by dimpase created at 2013-06-06 05:33:41

Replying to [comment:5 dimpase]:
> I am trying to follow the instructions on #12503 (as I removed my `~/.sage/` at some point lately), but it does not seem to work (using Sage 5.9 on OSX 10.6.8).
> 
> Hitting `control-o` results in cursor moving forward in the line few spaces, similar to TAB. (after I do `stty discard undef` before starting Sage).
> 
> 
> `history-search-forward-and-save` does not work at all.
> 

Oops, I am stupid. Now I see that the instructions on enabling this have changed!

Will report shortly.


---

Comment by dimpase created at 2013-06-06 05:50:56

Please be more specific in your patch about `ipython_config.py`?
Currently you just say 


```
IPython configuration file  ``ipython_config.py``
```


Is it still supposed to be in `$DOT_SAGE/ipython/` ?

I do not have a file so named there. On OSX 10.6.8 system the only `.py` files are 

```
$ ls -l ~/.sage/ipython/*.py
-rw-r--r--  1 dima  staff  2361 Nov 24  2012 /Users/dima/.sage/ipython/ipy_profile_sh.py
-rw-r--r--  1 dima  staff   836 Nov 24  2012 /Users/dima/.sage/ipython/ipy_user_conf.py
```


And a very similar picture on Linux.


---

Comment by dimpase created at 2013-06-06 05:51:10

Changing status from needs_review to needs_work.


---

Comment by klee created at 2013-06-06 08:56:58

The specific location for the IPython configuration file is

```
.sage/ipython-0.12/profile_sage/ipython_config.py
```

and you need to create the configuration file if it is absent. 

I was reluctant to be this specific about the location since it seems to me that the directory name "ipython-0.12" is doomed to change someday, and the exact location, I think, should be documented elsewhere.


---

Comment by dimpase created at 2013-06-06 17:51:41

Replying to [comment:9 klee]:
> The specific location for the IPython configuration file is
> {{{
> .sage/ipython-0.12/profile_sage/ipython_config.py
> }}}
> and you need to create the configuration file if it is absent. 
> 
> I was reluctant to be this specific about the location since it seems to me that the directory name "ipython-0.12" is doomed to change someday, and the exact location, I think, should be documented elsewhere. 

Well, replace lines 26-27 of your patch of `readline_extra_commands.pyx` with the following.

```
 To bind these commands with keys, insert the relevant lines into the IPython config file 
 ``$DOT_SAGE/ipython-<version_number>/profile_sage/ipython_config.py``.  
Note that ``$DOT_SAGE`` is ``$HOME/.sage`` by default. At the time of this patch, 
in Sage 5.11, ``<version_number>`` is 0.12. For example, 
```

 
After this, I'll be happy to give it positive review (it actually works just fine).

Feel free to open a ticket on documenting the location of `ipython_config.py` properly.


---

Comment by klee created at 2013-06-07 00:51:24

Replying to [comment:10 dimpase]:
> Well, replace lines 26-27 of your patch of `readline_extra_commands.pyx` with the following.
> {{{
>  To bind these commands with keys, insert the relevant lines into the IPython config file 
>  ``$DOT_SAGE/ipython-<version_number>/profile_sage/ipython_config.py``.  
> Note that ``$DOT_SAGE`` is ``$HOME/.sage`` by default. At the time of this patch, 
> in Sage 5.11, ``<version_number>`` is 0.12. For example, 
> }}}

The directory name is fixed as "ipython-0.12". On a discussion about the name, "ipython-0.12-or-later" was suggested, but the final name was settled to as it is now. My opinion is that the name was ill-chosen, as it confuses users, at least you and me. :-) Anyway, currently it is officially "ipython-0.12".

So I will update the patch just now accepting the official location.


---

Comment by klee created at 2013-06-07 00:52:50

Changing status from needs_work to needs_review.


---

Comment by klee created at 2013-06-07 01:04:21

To sage library


---

Comment by dimpase created at 2013-06-07 06:30:14

Changing status from needs_review to positive_review.


---

Attachment


---

Comment by jdemeyer created at 2013-06-10 08:42:38

Resolution: fixed


---

Comment by dimpase created at 2013-06-17 11:06:52

it looks as if `ipython_config.py` is removed each time Sage is updated.
This is not good. There should be some other location for persistent settings like this one...
