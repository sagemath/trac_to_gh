# Issue 29881: Handle SAGE_CHECK_PACKAGES in build/make/Makefile.in, not sage-spkg

Issue created by migration from https://trac.sagemath.org/ticket/30118

Original creator: mkoeppe

Original creation time: 2020-07-12 00:29:37

CC:  jhpalmieri mjo @kliem fbissey

#29766 and #29497 introduce build dependencies for packages that are only active when `SAGE_CHECK` is not `no`.

But whether a package needs its check-dependencies depends on both `SAGE_CHECK_PACKAGES` and `SAGE_CHECK`.

In this ticket, we move the handling of `SAGE_CHECK_PACKAGES` from `sage-spkg` to the Makefile.


---

Comment by mkoeppe created at 2020-07-12 04:59:28

New commits:


---

Comment by mkoeppe created at 2020-07-12 05:03:23

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2020-07-12 19:06:37

Changing priority from major to critical.


---

Comment by mkoeppe created at 2020-07-12 19:06:37

Marking it as critical as it is needed for CI testing of blocker package upgrade ticket #29766


---

Comment by git created at 2020-07-16 20:01:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-07-16 20:02:00

Merged current beta, needs review


---

Comment by dimpase created at 2020-07-17 06:25:08

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2020-07-17 06:25:08

looks good as refactoring.
We'll see how the conditional deps work on follow-up tickets, I suppose


---

Comment by mkoeppe created at 2020-07-17 06:25:59

Thanks!


---

Comment by mkoeppe created at 2020-07-17 06:26:22

Yes, I'm already using this in various test runs.


---

Comment by vbraun created at 2020-07-25 22:51:28

Resolution: fixed
