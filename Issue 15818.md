# Issue 15818: Implement Jordan algebras

archive/issues_015818.json:
```json
{
    "body": "Assignee: tscrim\n\nKeywords: jordan algebra\n\nSo we have a non-associative algebra to play with (and they are connected with Lie algebras).\n\nIf by some chance #10963 gets merged before this, we should change the category to their non-associative variety.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16055\n\n",
    "created_at": "2014-04-03T19:57:18Z",
    "labels": [
        "algebra",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Implement Jordan algebras",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15818",
    "user": "tscrim"
}
```
Assignee: tscrim

Keywords: jordan algebra

So we have a non-associative algebra to play with (and they are connected with Lie algebras).

If by some chance #10963 gets merged before this, we should change the category to their non-associative variety.

Issue created by migration from https://trac.sagemath.org/ticket/16055





---

archive/issue_comments_205241.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-04-03T19:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205241",
    "user": "tscrim"
}
```

New commits:



---

archive/issue_comments_205242.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-04-03T19:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205242",
    "user": "tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_205243.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-03T21:30:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205243",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_205244.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-17T22:29:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205244",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_205245.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-14T01:45:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205245",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_205246.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-14T18:13:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205246",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_205247.json:
```json
{
    "body": "Thank you! Just to make sure, `_lmul_` only gets called when you multiply with a scalar?\n\nEDIT: Also, I don't see the `(x^m y) x^n = x^m (y x^n)` identity in McCrimmon...",
    "created_at": "2015-02-16T16:51:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205247",
    "user": "darij"
}
```

Thank you! Just to make sure, `_lmul_` only gets called when you multiply with a scalar?

EDIT: Also, I don't see the `(x^m y) x^n = x^m (y x^n)` identity in McCrimmon...



---

archive/issue_comments_205248.json:
```json
{
    "body": "Replying to [comment:9 darij]:\n> Thank you! Just to make sure, `_lmul_` only gets called when you multiply with a scalar?'s \n\nCorrect. If it's an element of the Jordan algebra, then regular `_mul_` gets called.\n\n> EDIT: Also, I don't see the `(x^m y) x^n = x^m (y x^n)` identity in McCrimmon...\n\nIt's not. I cited Jacobson (as I believe it's in there but I don't have the book right now to check [tonight I will]), but it's on the wikipedia page (which I didn't want to explicitly cite).",
    "created_at": "2015-02-16T18:57:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205248",
    "user": "tscrim"
}
```

Replying to [comment:9 darij]:
> Thank you! Just to make sure, `_lmul_` only gets called when you multiply with a scalar?'s 

Correct. If it's an element of the Jordan algebra, then regular `_mul_` gets called.

> EDIT: Also, I don't see the `(x^m y) x^n = x^m (y x^n)` identity in McCrimmon...

It's not. I cited Jacobson (as I believe it's in there but I don't have the book right now to check [tonight I will]), but it's on the wikipedia page (which I didn't want to explicitly cite).



---

archive/issue_comments_205249.json:
```json
{
    "body": "Found it: equality (11) in\n\n```\nA. A. Albert, *A Structure Theory for Jordan Algebras*,\nAnnals of Mathematics, Second Series, Vol. 48, No. 3\n(Jul., 1947), pp. 546--567.\n```\n\nI'll put this into the doc later.",
    "created_at": "2015-02-17T21:31:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205249",
    "user": "darij"
}
```

Found it: equality (11) in

```
A. A. Albert, *A Structure Theory for Jordan Algebras*,
Annals of Mathematics, Second Series, Vol. 48, No. 3
(Jul., 1947), pp. 546--567.
```

I'll put this into the doc later.



---

archive/issue_comments_205250.json:
```json
{
    "body": "It's not in Jacobson; I'm glad you found an explicit reference.",
    "created_at": "2015-02-17T21:59:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205250",
    "user": "tscrim"
}
```

It's not in Jacobson; I'm glad you found an explicit reference.



---

archive/issue_comments_205251.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-17T22:00:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205251",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_205252.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-17T22:01:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205252",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_205253.json:
```json
{
    "body": "Here's why the `~` is safer than `/`:\n\n```\nsage: R.<q,t> = LaurentPolynomialRing(QQ)\nsage: 1 / R(2)\n1/2\nsage: _.parent()\nFraction Field of Multivariate Polynomial Ring in q, t over Rational Field\nsage: ~R(2)\n1/2\nsage: _.parent()\nMultivariate Laurent Polynomial Ring in q, t over Rational Field\n```\n\nAlthough this might be fixed by #17740. However I think instead of `QQ`, we could just convert to (the fraction field of) the base ring. I'll test and make changes.\n\nI'm happy with setting `algebras_generators = basis`, and subclassing does not respect aliases (this has given me many headaches, but it makes sense from the python perspective). I'll do this on my next commit.",
    "created_at": "2015-02-17T22:52:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205253",
    "user": "tscrim"
}
```

Here's why the `~` is safer than `/`:

```
sage: R.<q,t> = LaurentPolynomialRing(QQ)
sage: 1 / R(2)
1/2
sage: _.parent()
Fraction Field of Multivariate Polynomial Ring in q, t over Rational Field
sage: ~R(2)
1/2
sage: _.parent()
Multivariate Laurent Polynomial Ring in q, t over Rational Field
```

Although this might be fixed by #17740. However I think instead of `QQ`, we could just convert to (the fraction field of) the base ring. I'll test and make changes.

I'm happy with setting `algebras_generators = basis`, and subclassing does not respect aliases (this has given me many headaches, but it makes sense from the python perspective). I'll do this on my next commit.



---

archive/issue_comments_205254.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-17T23:07:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205254",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_205255.json:
```json
{
    "body": "Thanks for the explanations. I was worried that subclassing wouldn't completely ignore aliases in case of `@`cached_function usage. But experiments suggest that there is no problem with that.\n\n\n```\n            sage: J(2, (-2, 3)) # known bug - defaults to the base ring morphism #16054\n            2 + (-2, 3)\n            sage: J(-1, 1, 0) # known bug - defaults to the base ring morphism #16054\n            -1 + (1, 0)\n```\n\nBut these work!",
    "created_at": "2015-02-18T00:54:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205255",
    "user": "darij"
}
```

Thanks for the explanations. I was worried that subclassing wouldn't completely ignore aliases in case of `@`cached_function usage. But experiments suggest that there is no problem with that.


```
            sage: J(2, (-2, 3)) # known bug - defaults to the base ring morphism #16054
            2 + (-2, 3)
            sage: J(-1, 1, 0) # known bug - defaults to the base ring morphism #16054
            -1 + (1, 0)
```

But these work!



---

archive/issue_comments_205256.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-18T01:44:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205256",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_205257.json:
```json
{
    "body": "I'm glad you tested that. That used to not work, but now since there is no coercion map from the base ring (when I first wrote it, there was one), it doesn't go through the coercion path noted in #16054.",
    "created_at": "2015-02-18T01:51:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205257",
    "user": "tscrim"
}
```

I'm glad you tested that. That used to not work, but now since there is no coercion map from the base ring (when I first wrote it, there was one), it doesn't go through the coercion path noted in #16054.



---

archive/issue_comments_205258.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-18T02:50:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205258",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_205259.json:
```json
{
    "body": "Replying to [comment:19 tscrim]:\n> I'm glad you tested that. That used to not work, but now since there is no coercion map from the base ring (when I first wrote it, there was one), it doesn't go through the coercion path noted in #16054.\n\nDoes this mean that this will break again when the base ring coercion is reintroduced?\n\nAlso, I've finished reviewing this, but there is a TODO in the latest commit.",
    "created_at": "2015-02-18T02:52:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205259",
    "user": "darij"
}
```

Replying to [comment:19 tscrim]:
> I'm glad you tested that. That used to not work, but now since there is no coercion map from the base ring (when I first wrote it, there was one), it doesn't go through the coercion path noted in #16054.

Does this mean that this will break again when the base ring coercion is reintroduced?

Also, I've finished reviewing this, but there is a TODO in the latest commit.



---

archive/issue_comments_205260.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-18T03:24:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205260",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_205261.json:
```json
{
    "body": "Replying to [comment:21 darij]:\n> Does this mean that this will break again when the base ring coercion is reintroduced?\n\nThis isn't a coercion for non-commutative base rings. The commutativity of the associative algebra actually suppresses the non-associativity of the Jordan algebra since\n\n```\n(xy + yx)/2 = xy = yx\n(yz + zy)/2 = yz = zy\n(xyz + zyx)/2 = xyz = yxz = ... = zyx\n```\n\nPerhaps we could add extra checks for the base ring being commutative and adding such a coercion if there is a need, but for now I think we have the conversion and left/right actions.\n\n> Also, I've finished reviewing this, but there is a TODO in the latest commit.\n\nFixed; sign error. So can I consider this as a positive review?",
    "created_at": "2015-02-18T03:39:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205261",
    "user": "tscrim"
}
```

Replying to [comment:21 darij]:
> Does this mean that this will break again when the base ring coercion is reintroduced?

This isn't a coercion for non-commutative base rings. The commutativity of the associative algebra actually suppresses the non-associativity of the Jordan algebra since

```
(xy + yx)/2 = xy = yx
(yz + zy)/2 = yz = zy
(xyz + zyx)/2 = xyz = yxz = ... = zyx
```

Perhaps we could add extra checks for the base ring being commutative and adding such a coercion if there is a need, but for now I think we have the conversion and left/right actions.

> Also, I've finished reviewing this, but there is a TODO in the latest commit.

Fixed; sign error. So can I consider this as a positive review?



---

archive/issue_comments_205262.json:
```json
{
    "body": "Uhm, the base ring is assumed to be commutative, right? Are you talking about a coercion from the base ring, or from the algebra which serves as a ground set? Which of these would break the element constructor?\n\nAnd yes, this is a positive review, apart from this little issue.",
    "created_at": "2015-02-18T03:43:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205262",
    "user": "darij"
}
```

Uhm, the base ring is assumed to be commutative, right? Are you talking about a coercion from the base ring, or from the algebra which serves as a ground set? Which of these would break the element constructor?

And yes, this is a positive review, apart from this little issue.



---

archive/issue_comments_205263.json:
```json
{
    "body": "Right, we are... The issue is when we have a coercion from the base ring, the first input gets checked to see if there is a coercion, and if there is, then it passes all arguments via that coercion (ignoring that the combination of elements should give a different coercion/conversion). So I could one of the two:\n\n- leave it as it is,\n- add a custom coercion from the base ring and put back the known bug tag.\n\nWhich is your preference?",
    "created_at": "2015-02-18T04:05:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205263",
    "user": "tscrim"
}
```

Right, we are... The issue is when we have a coercion from the base ring, the first input gets checked to see if there is a coercion, and if there is, then it passes all arguments via that coercion (ignoring that the combination of elements should give a different coercion/conversion). So I could one of the two:

- leave it as it is,
- add a custom coercion from the base ring and put back the known bug tag.

Which is your preference?



---

archive/issue_comments_205264.json:
```json
{
    "body": "I'd leave it as it is -- it does make sense that a map from an associative into a non-associative ring is only a conversion. Can you add in a comment on this?",
    "created_at": "2015-02-18T04:12:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205264",
    "user": "darij"
}
```

I'd leave it as it is -- it does make sense that a map from an associative into a non-associative ring is only a conversion. Can you add in a comment on this?



---

archive/issue_comments_205265.json:
```json
{
    "body": "On that those doctests will break if there is a coercion?",
    "created_at": "2015-02-18T04:13:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205265",
    "user": "tscrim"
}
```

On that those doctests will break if there is a coercion?



---

archive/issue_comments_205266.json:
```json
{
    "body": "Well, you currently have this line:\n\n```\n+ # Remove the preceding line once :trac:`16492` is fixed\n```\n\nYou should say that #16492 is not the only obstruction to the coercion.\n\nOnce done, this is positive_review! I'd make the change myself, but that would add yet another merge commit.",
    "created_at": "2015-02-18T04:16:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205266",
    "user": "darij"
}
```

Well, you currently have this line:

```
+ # Remove the preceding line once :trac:`16492` is fixed
```

You should say that #16492 is not the only obstruction to the coercion.

Once done, this is positive_review! I'd make the change myself, but that would add yet another merge commit.



---

archive/issue_comments_205267.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-18T04:21:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205267",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_205268.json:
```json
{
    "body": "Done. Thanks for doing the review Darij!",
    "created_at": "2015-02-18T04:22:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205268",
    "user": "tscrim"
}
```

Done. Thanks for doing the review Darij!



---

archive/issue_comments_205269.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-02-18T04:22:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205269",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_205270.json:
```json
{
    "body": "No problem -- this is probably the easiest of your Lie-algebra tickets.",
    "created_at": "2015-02-18T04:34:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205270",
    "user": "darij"
}
```

No problem -- this is probably the easiest of your Lie-algebra tickets.



---

archive/issue_comments_205271.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-02-18T23:22:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15818",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15818#issuecomment-205271",
    "user": "vbraun"
}
```

Resolution: fixed
