# Issue 33534: SSLContext needs an argument

archive/issues_033534.json:
```json
{
    "body": "CC:  @tscrim @slel @kliem @kwankyu\n\nwith python 3.10, one sees a deprecation\n\n```\nsage: oeis([5,21,84,330])\n.../sage/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/databases/oeis.py:203: DeprecationWarning: ssl.SSLContext() without protocol argument is deprecated.\n  f = urlopen(url, context=SSLContext())\n.../sage/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/databases/oeis.py:203: DeprecationWarning: ssl.PROTOCOL_TLS is deprecated\n  f = urlopen(url, context=SSLContext())\n0: A002054: Binomial coefficient C(2n+1, n-1).\n1: A289797: p-INVERT of the triangular numbers (A000217), where p(S) = 1 - S - S^2.\n2: A284911: Number of partitions of n^2 that are the sum of n not necessarily distinct partitions of n into distinct parts.\n```\n\nIssue created by migration from https://trac.sagemath.org/ticket/33771\n\n",
    "closed_at": "2022-05-22T16:32:10Z",
    "created_at": "2022-04-29T14:46:08Z",
    "labels": [
        "component: interfaces",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "SSLContext needs an argument",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33534",
    "user": "https://github.com/fchapoton"
}
```
CC:  @tscrim @slel @kliem @kwankyu

with python 3.10, one sees a deprecation

```
sage: oeis([5,21,84,330])
.../sage/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/databases/oeis.py:203: DeprecationWarning: ssl.SSLContext() without protocol argument is deprecated.
  f = urlopen(url, context=SSLContext())
.../sage/local/var/lib/sage/venv-python3.10/lib/python3.10/site-packages/sage/databases/oeis.py:203: DeprecationWarning: ssl.PROTOCOL_TLS is deprecated
  f = urlopen(url, context=SSLContext())
0: A002054: Binomial coefficient C(2n+1, n-1).
1: A289797: p-INVERT of the triangular numbers (A000217), where p(S) = 1 - S - S^2.
2: A284911: Number of partitions of n^2 that are the sum of n not necessarily distinct partitions of n into distinct parts.
```

Issue created by migration from https://trac.sagemath.org/ticket/33771





---

archive/issue_comments_476816.json:
```json
{
    "body": "and\n\n```\ngit grep -c \"SSLContext()\" src/sage\nsrc/sage/arith/misc.py:1\nsrc/sage/combinat/designs/covering_design.py:1\nsrc/sage/databases/oeis.py:1\nsrc/sage/features/internet.py:1\nsrc/sage/graphs/isgci.py:1\nsrc/sage/interfaces/mathematica.py:1\nsrc/sage/misc/messaging.py:1\nsrc/sage/misc/package.py:1\nsrc/sage/misc/remote_file.py:1\n```",
    "created_at": "2022-04-29T14:47:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33534#issuecomment-476816",
    "user": "https://github.com/fchapoton"
}
```

and

```
git grep -c "SSLContext()" src/sage
src/sage/arith/misc.py:1
src/sage/combinat/designs/covering_design.py:1
src/sage/databases/oeis.py:1
src/sage/features/internet.py:1
src/sage/graphs/isgci.py:1
src/sage/interfaces/mathematica.py:1
src/sage/misc/messaging.py:1
src/sage/misc/package.py:1
src/sage/misc/remote_file.py:1
```



---

archive/issue_comments_476817.json:
```json
{
    "body": "apparently\n\nadding internet to --optional= shows that all context=SSLContext() \u200bshould be replaced with context=ssl.create_default_context()",
    "created_at": "2022-04-29T14:48:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33534#issuecomment-476817",
    "user": "https://github.com/fchapoton"
}
```

apparently

adding internet to --optional= shows that all context=SSLContext() ​should be replaced with context=ssl.create_default_context()



---

archive/issue_comments_476818.json:
```json
{
    "body": "Attachment [33771.patch](tarball://root/attachments/some-uuid/ticket33771/33771.patch) by @sheerluck created at 2022-04-29 22:06:36",
    "created_at": "2022-04-29T22:06:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33534#issuecomment-476818",
    "user": "https://github.com/sheerluck"
}
```

Attachment [33771.patch](tarball://root/attachments/some-uuid/ticket33771/33771.patch) by @sheerluck created at 2022-04-29 22:06:36



---

archive/issue_comments_476819.json:
```json
{
    "body": "I tested 33771.patch\u200b only on python-3.10.4",
    "created_at": "2022-04-29T22:16:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33534#issuecomment-476819",
    "user": "https://github.com/sheerluck"
}
```

I tested 33771.patch​ only on python-3.10.4



---

archive/issue_comments_476820.json:
```json
{
    "body": "thanks\n\nare you sure that this does not work in previous Python versions ?\n\nplease make a branch",
    "created_at": "2022-04-30T06:11:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33534#issuecomment-476820",
    "user": "https://github.com/fchapoton"
}
```

thanks

are you sure that this does not work in previous Python versions ?

please make a branch



---

archive/issue_comments_476821.json:
```json
{
    "body": "```\nfrom ssl import create_default_context\n```\n\nworks at least in Python 3.8.10\n\nand also in python 3.5.2",
    "created_at": "2022-04-30T06:12:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33534#issuecomment-476821",
    "user": "https://github.com/fchapoton"
}
```

```
from ssl import create_default_context
```

works at least in Python 3.8.10

and also in python 3.5.2



---

archive/issue_comments_476822.json:
```json
{
    "body": "```diff\ndiff --git a/src/sage/arith/misc.py b/src/sage/arith/misc.py\nindex 9966d0b857..7e78b8a449 100644\n--- a/src/sage/arith/misc.py\n+++ b/src/sage/arith/misc.py\n@@ -2033,7 +2033,7 @@ def xkcd(n=\"\"):\n     import contextlib\n     import json\n     from sage.misc.html import html\n-    from ssl import SSLContext\n+    from ssl import create_default_context as SSLContext\n \n     from urllib.request import urlopen\n     from urllib.error import HTTPError, URLError\ndiff --git a/src/sage/combinat/designs/covering_design.py b/src/sage/combinat/designs/covering_design.py\nindex a1959604a1..f6f6a6097c 100644\n--- a/src/sage/combinat/designs/covering_design.py\n+++ b/src/sage/combinat/designs/covering_design.py\n@@ -46,7 +46,7 @@ Classes and methods\n # ****************************************************************************\n \n from urllib.request import urlopen\n-from ssl import SSLContext\n+from ssl import create_default_context as SSLContext\n \n from sage.misc.sage_eval import sage_eval\n from sage.structure.sage_object import SageObject\ndiff --git a/src/sage/databases/oeis.py b/src/sage/databases/oeis.py\nindex 00cbb30e6d..a551b3f102 100644\n--- a/src/sage/databases/oeis.py\n+++ b/src/sage/databases/oeis.py\n@@ -160,7 +160,7 @@ Classes and methods\n # ****************************************************************************\n from urllib.request import urlopen\n from urllib.parse import urlencode\n-from ssl import SSLContext\n+from ssl import create_default_context as SSLContext\n \n from sage.structure.sage_object import SageObject\n from sage.structure.unique_representation import UniqueRepresentation\ndiff --git a/src/sage/features/internet.py b/src/sage/features/internet.py\nindex 5c6a077bcb..85b087cf18 100644\n--- a/src/sage/features/internet.py\n+++ b/src/sage/features/internet.py\n@@ -40,7 +40,7 @@ class Internet(Feature):\n         \"\"\"\n         import urllib.error\n         from urllib.request import Request, urlopen\n-        from ssl import SSLContext\n+        from ssl import create_default_context as SSLContext\n \n         req = Request(\"https://www.sagemath.org\", headers={\"User-Agent\": \"sage-doctest\"})\n         try:\ndiff --git a/src/sage/graphs/isgci.py b/src/sage/graphs/isgci.py\nindex 99f90f7617..f97a070a5b 100644\n--- a/src/sage/graphs/isgci.py\n+++ b/src/sage/graphs/isgci.py\n@@ -400,7 +400,7 @@ from sage.env import GRAPHS_DATA_DIR\n import os\n import zipfile\n from urllib.request import urlopen\n-from ssl import SSLContext\n+from ssl import create_default_context as SSLContext\n \n \n #*****************************************************************************\ndiff --git a/src/sage/interfaces/mathematica.py b/src/sage/interfaces/mathematica.py\nindex 83c90418c4..6620d40c80 100644\n--- a/src/sage/interfaces/mathematica.py\n+++ b/src/sage/interfaces/mathematica.py\n@@ -1140,7 +1140,7 @@ def request_wolfram_alpha(input, verbose=False):\n     from urllib.request import Request, build_opener, HTTPCookieProcessor, HTTPSHandler\n     import json\n     from http.cookiejar import CookieJar\n-    from ssl import SSLContext\n+    from ssl import create_default_context as SSLContext\n \n     # we need cookies for this...\n     cj = CookieJar()\ndiff --git a/src/sage/misc/messaging.py b/src/sage/misc/messaging.py\nindex 1a4b248cf2..cf0ad289c8 100644\n--- a/src/sage/misc/messaging.py\n+++ b/src/sage/misc/messaging.py\n@@ -14,7 +14,7 @@ AUTHORS:\n \n import http.client as httplib\n from urllib.parse import urlencode\n-from ssl import SSLContext\n+from ssl import create_default_context as SSLContext\n \n pushover_defaults = {\"token\": \"Eql67F14ohOZJ0AtEBJJU7FiLAk8wK\"}\n \ndiff --git a/src/sage/misc/package.py b/src/sage/misc/package.py\nindex 1ca56fbd5c..30b17c97be 100644\n--- a/src/sage/misc/package.py\n+++ b/src/sage/misc/package.py\n@@ -51,7 +51,7 @@ import sys\n from pathlib import Path\n from urllib.request import urlopen\n from urllib.error import URLError\n-from ssl import SSLContext\n+from ssl import create_default_context as SSLContext\n \n DEFAULT_PYPI = 'https://pypi.org/pypi'\n \ndiff --git a/src/sage/misc/remote_file.py b/src/sage/misc/remote_file.py\nindex 092640cc9e..479480831b 100644\n--- a/src/sage/misc/remote_file.py\n+++ b/src/sage/misc/remote_file.py\n@@ -3,7 +3,7 @@\n \n import os\n from urllib.request import Request, urlopen\n-from ssl import SSLContext\n+from ssl import create_default_context as SSLContext\n \n \n def get_remote_file(filename, verbose=True):\n-- \n2.35.1\n\n\n```",
    "created_at": "2022-04-30T08:14:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33534#issuecomment-476822",
    "user": "https://github.com/sheerluck"
}
```

```diff
diff --git a/src/sage/arith/misc.py b/src/sage/arith/misc.py
index 9966d0b857..7e78b8a449 100644
--- a/src/sage/arith/misc.py
+++ b/src/sage/arith/misc.py
@@ -2033,7 +2033,7 @@ def xkcd(n=""):
     import contextlib
     import json
     from sage.misc.html import html
-    from ssl import SSLContext
+    from ssl import create_default_context as SSLContext
 
     from urllib.request import urlopen
     from urllib.error import HTTPError, URLError
diff --git a/src/sage/combinat/designs/covering_design.py b/src/sage/combinat/designs/covering_design.py
index a1959604a1..f6f6a6097c 100644
--- a/src/sage/combinat/designs/covering_design.py
+++ b/src/sage/combinat/designs/covering_design.py
@@ -46,7 +46,7 @@ Classes and methods
 # ****************************************************************************
 
 from urllib.request import urlopen
-from ssl import SSLContext
+from ssl import create_default_context as SSLContext
 
 from sage.misc.sage_eval import sage_eval
 from sage.structure.sage_object import SageObject
diff --git a/src/sage/databases/oeis.py b/src/sage/databases/oeis.py
index 00cbb30e6d..a551b3f102 100644
--- a/src/sage/databases/oeis.py
+++ b/src/sage/databases/oeis.py
@@ -160,7 +160,7 @@ Classes and methods
 # ****************************************************************************
 from urllib.request import urlopen
 from urllib.parse import urlencode
-from ssl import SSLContext
+from ssl import create_default_context as SSLContext
 
 from sage.structure.sage_object import SageObject
 from sage.structure.unique_representation import UniqueRepresentation
diff --git a/src/sage/features/internet.py b/src/sage/features/internet.py
index 5c6a077bcb..85b087cf18 100644
--- a/src/sage/features/internet.py
+++ b/src/sage/features/internet.py
@@ -40,7 +40,7 @@ class Internet(Feature):
         """
         import urllib.error
         from urllib.request import Request, urlopen
-        from ssl import SSLContext
+        from ssl import create_default_context as SSLContext
 
         req = Request("https://www.sagemath.org", headers={"User-Agent": "sage-doctest"})
         try:
diff --git a/src/sage/graphs/isgci.py b/src/sage/graphs/isgci.py
index 99f90f7617..f97a070a5b 100644
--- a/src/sage/graphs/isgci.py
+++ b/src/sage/graphs/isgci.py
@@ -400,7 +400,7 @@ from sage.env import GRAPHS_DATA_DIR
 import os
 import zipfile
 from urllib.request import urlopen
-from ssl import SSLContext
+from ssl import create_default_context as SSLContext
 
 
 #*****************************************************************************
diff --git a/src/sage/interfaces/mathematica.py b/src/sage/interfaces/mathematica.py
index 83c90418c4..6620d40c80 100644
--- a/src/sage/interfaces/mathematica.py
+++ b/src/sage/interfaces/mathematica.py
@@ -1140,7 +1140,7 @@ def request_wolfram_alpha(input, verbose=False):
     from urllib.request import Request, build_opener, HTTPCookieProcessor, HTTPSHandler
     import json
     from http.cookiejar import CookieJar
-    from ssl import SSLContext
+    from ssl import create_default_context as SSLContext
 
     # we need cookies for this...
     cj = CookieJar()
diff --git a/src/sage/misc/messaging.py b/src/sage/misc/messaging.py
index 1a4b248cf2..cf0ad289c8 100644
--- a/src/sage/misc/messaging.py
+++ b/src/sage/misc/messaging.py
@@ -14,7 +14,7 @@ AUTHORS:
 
 import http.client as httplib
 from urllib.parse import urlencode
-from ssl import SSLContext
+from ssl import create_default_context as SSLContext
 
 pushover_defaults = {"token": "Eql67F14ohOZJ0AtEBJJU7FiLAk8wK"}
 
diff --git a/src/sage/misc/package.py b/src/sage/misc/package.py
index 1ca56fbd5c..30b17c97be 100644
--- a/src/sage/misc/package.py
+++ b/src/sage/misc/package.py
@@ -51,7 +51,7 @@ import sys
 from pathlib import Path
 from urllib.request import urlopen
 from urllib.error import URLError
-from ssl import SSLContext
+from ssl import create_default_context as SSLContext
 
 DEFAULT_PYPI = 'https://pypi.org/pypi'
 
diff --git a/src/sage/misc/remote_file.py b/src/sage/misc/remote_file.py
index 092640cc9e..479480831b 100644
--- a/src/sage/misc/remote_file.py
+++ b/src/sage/misc/remote_file.py
@@ -3,7 +3,7 @@
 
 import os
 from urllib.request import Request, urlopen
-from ssl import SSLContext
+from ssl import create_default_context as SSLContext
 
 
 def get_remote_file(filename, verbose=True):
-- 
2.35.1


```



---

archive/issue_comments_476823.json:
```json
{
    "body": "yes, looks better. Does it work ?",
    "created_at": "2022-04-30T08:52:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33534#issuecomment-476823",
    "user": "https://github.com/fchapoton"
}
```

yes, looks better. Does it work ?



---

archive/issue_comments_476824.json:
```json
{
    "body": "for python-3.10.4 -- yes :)",
    "created_at": "2022-04-30T08:57:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33534#issuecomment-476824",
    "user": "https://github.com/sheerluck"
}
```

for python-3.10.4 -- yes :)



---

archive/issue_comments_476825.json:
```json
{
    "body": "You shouldn't give a name of the ssl library for another object of the same library, this will be very confusing. I would suggest to just import create_default_context as is.",
    "created_at": "2022-04-30T13:20:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33534#issuecomment-476825",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

You shouldn't give a name of the ssl library for another object of the same library, this will be very confusing. I would suggest to just import create_default_context as is.



---

archive/issue_comments_476826.json:
```json
{
    "body": "Replying to [comment:11 tmonteil]:\n> You shouldn't give a name of the ssl library for another object of the same library, this will be very confusing. I would suggest to just import create_default_context as is.\n\n\nHow about this then:\n\n```diff\ndiff --git a/src/sage/arith/misc.py b/src/sage/arith/misc.py\nindex 9966d0b857..abfb4ce047 100644\n--- a/src/sage/arith/misc.py\n+++ b/src/sage/arith/misc.py\n@@ -2033,7 +2033,7 @@ def xkcd(n=\"\"):\n     import contextlib\n     import json\n     from sage.misc.html import html\n-    from ssl import SSLContext\n+    import ssl\n \n     from urllib.request import urlopen\n     from urllib.error import HTTPError, URLError\n@@ -2046,7 +2046,8 @@ def xkcd(n=\"\"):\n         url = \"https://xkcd.com/{}/info.0.json\".format(n)\n \n     try:\n-        with contextlib.closing(urlopen(url, context=SSLContext())) as f:\n+        default_ctx = ssl.create_default_context()\n+        with contextlib.closing(urlopen(url, context=default_ctx)) as f:\n             data = f.read()\n     except HTTPError as error:\n         if error.getcode() == 400:  # this error occurs when asking for a non valid comic number\ndiff --git a/src/sage/combinat/designs/covering_design.py b/src/sage/combinat/designs/covering_design.py\nindex a1959604a1..5eeb07e7e2 100644\n--- a/src/sage/combinat/designs/covering_design.py\n+++ b/src/sage/combinat/designs/covering_design.py\n@@ -46,7 +46,7 @@ Classes and methods\n # ****************************************************************************\n \n from urllib.request import urlopen\n-from ssl import SSLContext\n+import ssl\n \n from sage.misc.sage_eval import sage_eval\n from sage.structure.sage_object import SageObject\n@@ -529,7 +529,8 @@ def best_known_covering_design_www(v, k, t, verbose=False):\n     if verbose:\n         print(\"Looking up the bounds at %s\" % url)\n \n-    f = urlopen(url, context=SSLContext())\n+    default_ctx = ssl.create_default_context()\n+    f = urlopen(url, context=default_ctx)\n     try:\n         s = bytes_to_str(f.read())\n     finally:\ndiff --git a/src/sage/databases/oeis.py b/src/sage/databases/oeis.py\nindex 00cbb30e6d..13e82707ee 100644\n--- a/src/sage/databases/oeis.py\n+++ b/src/sage/databases/oeis.py\n@@ -160,7 +160,6 @@ Classes and methods\n # ****************************************************************************\n from urllib.request import urlopen\n from urllib.parse import urlencode\n-from ssl import SSLContext\n \n from sage.structure.sage_object import SageObject\n from sage.structure.unique_representation import UniqueRepresentation\n@@ -176,6 +175,7 @@ from sage.repl.preparse import preparse\n \n from collections import defaultdict\n import re\n+import ssl\n \n oeis_url = 'https://oeis.org/'\n \n@@ -200,7 +200,8 @@ def _fetch(url):\n     \"\"\"\n     try:\n         verbose(\"Fetching URL %s ...\" % url, caller_name='OEIS')\n-        f = urlopen(url, context=SSLContext())\n+        default_ctx = ssl.create_default_context()\n+        f = urlopen(url, context=default_ctx)\n         result = f.read()\n         f.close()\n         return bytes_to_str(result)\ndiff --git a/src/sage/features/internet.py b/src/sage/features/internet.py\nindex 5c6a077bcb..794edc11f3 100644\n--- a/src/sage/features/internet.py\n+++ b/src/sage/features/internet.py\n@@ -38,13 +38,14 @@ class Internet(Feature):\n             sage: Internet()._is_present()  # random, optional - internet\n             FeatureTestResult('internet', True)\n         \"\"\"\n+        import ssl\n         import urllib.error\n         from urllib.request import Request, urlopen\n-        from ssl import SSLContext\n \n         req = Request(\"https://www.sagemath.org\", headers={\"User-Agent\": \"sage-doctest\"})\n         try:\n-            urlopen(req, timeout=1, context=SSLContext())\n+            default_ctx = ssl.create_default_context()\n+            urlopen(req, timeout=1, context=default_ctx)\n             return FeatureTestResult(self, True)\n         except urllib.error.URLError:\n             return FeatureTestResult(self, False)\ndiff --git a/src/sage/graphs/isgci.py b/src/sage/graphs/isgci.py\nindex 99f90f7617..e9705cf488 100644\n--- a/src/sage/graphs/isgci.py\n+++ b/src/sage/graphs/isgci.py\n@@ -398,9 +398,9 @@ from sage.misc.unknown import Unknown\n from sage.env import GRAPHS_DATA_DIR\n \n import os\n+import ssl\n import zipfile\n from urllib.request import urlopen\n-from ssl import SSLContext\n \n \n #*****************************************************************************\n@@ -828,7 +828,8 @@ class GraphClasses(UniqueRepresentation):\n             sage: graph_classes._download_db() # Not tested -- requires internet\n         \"\"\"\n         from sage.misc.misc import SAGE_TMP\n-        u = urlopen('https://www.graphclasses.org/data.zip', context=SSLContext())\n+        default_ctx = ssl.create_default_context()\n+        u = urlopen('https://www.graphclasses.org/data.zip', context=default_ctx)\n         localFile = open(os.path.join(SAGE_TMP, 'isgci.zip'), 'w')\n         localFile.write(u.read())\n         localFile.close()\ndiff --git a/src/sage/interfaces/mathematica.py b/src/sage/interfaces/mathematica.py\nindex 83c90418c4..e77366c49a 100644\n--- a/src/sage/interfaces/mathematica.py\n+++ b/src/sage/interfaces/mathematica.py\n@@ -1136,15 +1136,16 @@ def request_wolfram_alpha(input, verbose=False):\n          'timing',\n          'version']\n     \"\"\"\n+    from http.cookiejar import CookieJar\n     from urllib.parse import urlencode\n     from urllib.request import Request, build_opener, HTTPCookieProcessor, HTTPSHandler\n     import json\n-    from http.cookiejar import CookieJar\n-    from ssl import SSLContext\n+    import ssl\n \n     # we need cookies for this...\n     cj = CookieJar()\n-    opener = build_opener(HTTPCookieProcessor(cj), HTTPSHandler(context=SSLContext()))\n+    default_ctx = ssl.create_default_context()\n+    opener = build_opener(HTTPCookieProcessor(cj), HTTPSHandler(context=default_ctx))\n     # build initial query for code\n     req = Request(\"https://www.wolframalpha.com/input/api/v1/code\")\n     resp = opener.open(req)\ndiff --git a/src/sage/misc/messaging.py b/src/sage/misc/messaging.py\nindex 1a4b248cf2..eda7087416 100644\n--- a/src/sage/misc/messaging.py\n+++ b/src/sage/misc/messaging.py\n@@ -12,9 +12,10 @@ AUTHORS:\n - Martin Albrecht (2012) - initial implementation\n \"\"\"\n \n+import ssl\n import http.client as httplib\n from urllib.parse import urlencode\n-from ssl import SSLContext\n+\n \n pushover_defaults = {\"token\": \"Eql67F14ohOZJ0AtEBJJU7FiLAk8wK\"}\n \n@@ -77,7 +78,8 @@ def pushover(message, **kwds):\n     request.update(pushover_defaults)\n     request.update(kwds)\n \n-    conn = httplib.HTTPSConnection(\"api.pushover.net:443\", context=SSLContext())\n+    default_ctx = ssl.create_default_context()\n+    conn = httplib.HTTPSConnection(\"api.pushover.net:443\", context=default_ctx)\n     conn.request(\"POST\", \"/1/messages.json\",\n                  urlencode(request),\n                  {\"Content-type\": \"application/x-www-form-urlencoded\"})\ndiff --git a/src/sage/misc/package.py b/src/sage/misc/package.py\nindex 1ca56fbd5c..a2f1dcd938 100644\n--- a/src/sage/misc/package.py\n+++ b/src/sage/misc/package.py\n@@ -47,11 +47,11 @@ import sage.env\n import json\n import os\n import subprocess\n+import ssl\n import sys\n from pathlib import Path\n from urllib.request import urlopen\n from urllib.error import URLError\n-from ssl import SSLContext\n \n DEFAULT_PYPI = 'https://pypi.org/pypi'\n \n@@ -110,7 +110,8 @@ def pip_remote_version(pkg, pypi_url=DEFAULT_PYPI, ignore_URLError=False):\n     url = '{pypi_url}/{pkg}/json'.format(pypi_url=pypi_url, pkg=pkg)\n \n     try:\n-        f = urlopen(url, context=SSLContext())\n+        default_ctx = ssl.create_default_context()\n+        f = urlopen(url, context=default_ctx)\n         text = f.read()\n         f.close()\n     except URLError:\ndiff --git a/src/sage/misc/remote_file.py b/src/sage/misc/remote_file.py\nindex 092640cc9e..296974ba5c 100644\n--- a/src/sage/misc/remote_file.py\n+++ b/src/sage/misc/remote_file.py\n@@ -2,8 +2,8 @@\n \n \n import os\n+import ssl\n from urllib.request import Request, urlopen\n-from ssl import SSLContext\n \n \n def get_remote_file(filename, verbose=True):\n@@ -43,7 +43,8 @@ def get_remote_file(filename, verbose=True):\n     if verbose:\n         print(\"Loading started\")\n \n-    content = urlopen(req, timeout=1, context=SSLContext())\n+    default_ctx = ssl.create_default_context()\n+    content = urlopen(req, timeout=1, context=default_ctx)\n     with open(temp_name, 'wb') as f:\n         f.write(content.read())\n \n```",
    "created_at": "2022-04-30T14:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33534#issuecomment-476826",
    "user": "https://github.com/sheerluck"
}
```

Replying to [comment:11 tmonteil]:
> You shouldn't give a name of the ssl library for another object of the same library, this will be very confusing. I would suggest to just import create_default_context as is.


How about this then:

```diff
diff --git a/src/sage/arith/misc.py b/src/sage/arith/misc.py
index 9966d0b857..abfb4ce047 100644
--- a/src/sage/arith/misc.py
+++ b/src/sage/arith/misc.py
@@ -2033,7 +2033,7 @@ def xkcd(n=""):
     import contextlib
     import json
     from sage.misc.html import html
-    from ssl import SSLContext
+    import ssl
 
     from urllib.request import urlopen
     from urllib.error import HTTPError, URLError
@@ -2046,7 +2046,8 @@ def xkcd(n=""):
         url = "https://xkcd.com/{}/info.0.json".format(n)
 
     try:
-        with contextlib.closing(urlopen(url, context=SSLContext())) as f:
+        default_ctx = ssl.create_default_context()
+        with contextlib.closing(urlopen(url, context=default_ctx)) as f:
             data = f.read()
     except HTTPError as error:
         if error.getcode() == 400:  # this error occurs when asking for a non valid comic number
diff --git a/src/sage/combinat/designs/covering_design.py b/src/sage/combinat/designs/covering_design.py
index a1959604a1..5eeb07e7e2 100644
--- a/src/sage/combinat/designs/covering_design.py
+++ b/src/sage/combinat/designs/covering_design.py
@@ -46,7 +46,7 @@ Classes and methods
 # ****************************************************************************
 
 from urllib.request import urlopen
-from ssl import SSLContext
+import ssl
 
 from sage.misc.sage_eval import sage_eval
 from sage.structure.sage_object import SageObject
@@ -529,7 +529,8 @@ def best_known_covering_design_www(v, k, t, verbose=False):
     if verbose:
         print("Looking up the bounds at %s" % url)
 
-    f = urlopen(url, context=SSLContext())
+    default_ctx = ssl.create_default_context()
+    f = urlopen(url, context=default_ctx)
     try:
         s = bytes_to_str(f.read())
     finally:
diff --git a/src/sage/databases/oeis.py b/src/sage/databases/oeis.py
index 00cbb30e6d..13e82707ee 100644
--- a/src/sage/databases/oeis.py
+++ b/src/sage/databases/oeis.py
@@ -160,7 +160,6 @@ Classes and methods
 # ****************************************************************************
 from urllib.request import urlopen
 from urllib.parse import urlencode
-from ssl import SSLContext
 
 from sage.structure.sage_object import SageObject
 from sage.structure.unique_representation import UniqueRepresentation
@@ -176,6 +175,7 @@ from sage.repl.preparse import preparse
 
 from collections import defaultdict
 import re
+import ssl
 
 oeis_url = 'https://oeis.org/'
 
@@ -200,7 +200,8 @@ def _fetch(url):
     """
     try:
         verbose("Fetching URL %s ..." % url, caller_name='OEIS')
-        f = urlopen(url, context=SSLContext())
+        default_ctx = ssl.create_default_context()
+        f = urlopen(url, context=default_ctx)
         result = f.read()
         f.close()
         return bytes_to_str(result)
diff --git a/src/sage/features/internet.py b/src/sage/features/internet.py
index 5c6a077bcb..794edc11f3 100644
--- a/src/sage/features/internet.py
+++ b/src/sage/features/internet.py
@@ -38,13 +38,14 @@ class Internet(Feature):
             sage: Internet()._is_present()  # random, optional - internet
             FeatureTestResult('internet', True)
         """
+        import ssl
         import urllib.error
         from urllib.request import Request, urlopen
-        from ssl import SSLContext
 
         req = Request("https://www.sagemath.org", headers={"User-Agent": "sage-doctest"})
         try:
-            urlopen(req, timeout=1, context=SSLContext())
+            default_ctx = ssl.create_default_context()
+            urlopen(req, timeout=1, context=default_ctx)
             return FeatureTestResult(self, True)
         except urllib.error.URLError:
             return FeatureTestResult(self, False)
diff --git a/src/sage/graphs/isgci.py b/src/sage/graphs/isgci.py
index 99f90f7617..e9705cf488 100644
--- a/src/sage/graphs/isgci.py
+++ b/src/sage/graphs/isgci.py
@@ -398,9 +398,9 @@ from sage.misc.unknown import Unknown
 from sage.env import GRAPHS_DATA_DIR
 
 import os
+import ssl
 import zipfile
 from urllib.request import urlopen
-from ssl import SSLContext
 
 
 #*****************************************************************************
@@ -828,7 +828,8 @@ class GraphClasses(UniqueRepresentation):
             sage: graph_classes._download_db() # Not tested -- requires internet
         """
         from sage.misc.misc import SAGE_TMP
-        u = urlopen('https://www.graphclasses.org/data.zip', context=SSLContext())
+        default_ctx = ssl.create_default_context()
+        u = urlopen('https://www.graphclasses.org/data.zip', context=default_ctx)
         localFile = open(os.path.join(SAGE_TMP, 'isgci.zip'), 'w')
         localFile.write(u.read())
         localFile.close()
diff --git a/src/sage/interfaces/mathematica.py b/src/sage/interfaces/mathematica.py
index 83c90418c4..e77366c49a 100644
--- a/src/sage/interfaces/mathematica.py
+++ b/src/sage/interfaces/mathematica.py
@@ -1136,15 +1136,16 @@ def request_wolfram_alpha(input, verbose=False):
          'timing',
          'version']
     """
+    from http.cookiejar import CookieJar
     from urllib.parse import urlencode
     from urllib.request import Request, build_opener, HTTPCookieProcessor, HTTPSHandler
     import json
-    from http.cookiejar import CookieJar
-    from ssl import SSLContext
+    import ssl
 
     # we need cookies for this...
     cj = CookieJar()
-    opener = build_opener(HTTPCookieProcessor(cj), HTTPSHandler(context=SSLContext()))
+    default_ctx = ssl.create_default_context()
+    opener = build_opener(HTTPCookieProcessor(cj), HTTPSHandler(context=default_ctx))
     # build initial query for code
     req = Request("https://www.wolframalpha.com/input/api/v1/code")
     resp = opener.open(req)
diff --git a/src/sage/misc/messaging.py b/src/sage/misc/messaging.py
index 1a4b248cf2..eda7087416 100644
--- a/src/sage/misc/messaging.py
+++ b/src/sage/misc/messaging.py
@@ -12,9 +12,10 @@ AUTHORS:
 - Martin Albrecht (2012) - initial implementation
 """
 
+import ssl
 import http.client as httplib
 from urllib.parse import urlencode
-from ssl import SSLContext
+
 
 pushover_defaults = {"token": "Eql67F14ohOZJ0AtEBJJU7FiLAk8wK"}
 
@@ -77,7 +78,8 @@ def pushover(message, **kwds):
     request.update(pushover_defaults)
     request.update(kwds)
 
-    conn = httplib.HTTPSConnection("api.pushover.net:443", context=SSLContext())
+    default_ctx = ssl.create_default_context()
+    conn = httplib.HTTPSConnection("api.pushover.net:443", context=default_ctx)
     conn.request("POST", "/1/messages.json",
                  urlencode(request),
                  {"Content-type": "application/x-www-form-urlencoded"})
diff --git a/src/sage/misc/package.py b/src/sage/misc/package.py
index 1ca56fbd5c..a2f1dcd938 100644
--- a/src/sage/misc/package.py
+++ b/src/sage/misc/package.py
@@ -47,11 +47,11 @@ import sage.env
 import json
 import os
 import subprocess
+import ssl
 import sys
 from pathlib import Path
 from urllib.request import urlopen
 from urllib.error import URLError
-from ssl import SSLContext
 
 DEFAULT_PYPI = 'https://pypi.org/pypi'
 
@@ -110,7 +110,8 @@ def pip_remote_version(pkg, pypi_url=DEFAULT_PYPI, ignore_URLError=False):
     url = '{pypi_url}/{pkg}/json'.format(pypi_url=pypi_url, pkg=pkg)
 
     try:
-        f = urlopen(url, context=SSLContext())
+        default_ctx = ssl.create_default_context()
+        f = urlopen(url, context=default_ctx)
         text = f.read()
         f.close()
     except URLError:
diff --git a/src/sage/misc/remote_file.py b/src/sage/misc/remote_file.py
index 092640cc9e..296974ba5c 100644
--- a/src/sage/misc/remote_file.py
+++ b/src/sage/misc/remote_file.py
@@ -2,8 +2,8 @@
 
 
 import os
+import ssl
 from urllib.request import Request, urlopen
-from ssl import SSLContext
 
 
 def get_remote_file(filename, verbose=True):
@@ -43,7 +43,8 @@ def get_remote_file(filename, verbose=True):
     if verbose:
         print("Loading started")
 
-    content = urlopen(req, timeout=1, context=SSLContext())
+    default_ctx = ssl.create_default_context()
+    content = urlopen(req, timeout=1, context=default_ctx)
     with open(temp_name, 'wb') as f:
         f.write(content.read())
 
```



---

archive/issue_comments_476827.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-05-05T18:47:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33534#issuecomment-476827",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_476828.json:
```json
{
    "body": "here is a branch, please review\n\n---\nNew commits:",
    "created_at": "2022-05-05T18:47:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33534#issuecomment-476828",
    "user": "https://github.com/fchapoton"
}
```

here is a branch, please review

---
New commits:



---

archive/issue_comments_476829.json:
```json
{
    "body": "simple one, I think",
    "created_at": "2022-05-07T07:38:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33534#issuecomment-476829",
    "user": "https://github.com/fchapoton"
}
```

simple one, I think



---

archive/issue_comments_476830.json:
```json
{
    "body": "Looks good to me, let us wait for the patchbots to confirm.",
    "created_at": "2022-05-07T14:07:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33534#issuecomment-476830",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Looks good to me, let us wait for the patchbots to confirm.



---

archive/issue_comments_476831.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-05-07T17:42:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33534#issuecomment-476831",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_476832.json:
```json
{
    "body": "Since patchbots are not running internet doctests by default, i ran them by hand.",
    "created_at": "2022-05-07T17:42:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33534#issuecomment-476832",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Since patchbots are not running internet doctests by default, i ran them by hand.



---

archive/issue_events_088733.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-05-22T16:32:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33534#event-88733"
}
```



---

archive/issue_comments_476833.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-05-22T16:32:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33534#issuecomment-476833",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
