# Issue 13045: Expand the Dedekind eta function more efficiently

Issue created by migration from https://trac.sagemath.org/ticket/13217

Original creator: arminstraub

Original creation time: 2012-07-09 17:18:10

Assignee: craigcitro

Currently, the Dedekind eta function is expanded by multiplying out its defining truncated product.  With the attached patch, Euler's identity is used instead for a significant increase in speed.

Before:

```
sage: %timeit qexp_eta(ZZ[['q']],10)
625 loops, best of 3: 1.41 ms per loop
sage: %timeit qexp_eta(ZZ[['q']],100)
25 loops, best of 3: 21.4 ms per loop
sage: %timeit qexp_eta(ZZ[['q']],1000)
5 loops, best of 3: 937 ms per loop
```


After:

```
sage: %timeit qexp_eta(ZZ[['q']],10)
625 loops, best of 3: 155 µs per loop
sage: %timeit qexp_eta(ZZ[['q']],100)
625 loops, best of 3: 221 µs per loop
sage: %timeit qexp_eta(ZZ[['q']],1000)
625 loops, best of 3: 873 µs per loop
```



---

Comment by arminstraub created at 2012-07-09 17:43:45

Changing status from new to needs_review.


---

Comment by chapoton created at 2012-07-10 08:36:48

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2012-07-10 08:36:48

* Maybe you could use

assert prec>0, "prec must be a positive integer"

instead of the ValueError that you have written

* You have to change the "n" into "prec" also in the OUTPUT block

* Maybe you could remove the comment "we pass this as an argument as .." in the INPUT block, which does not seem to be very useful.


---

Attachment

replaces previous patch


---

Comment by arminstraub created at 2012-07-10 09:15:06

Changing status from needs_work to needs_review.


---

Comment by arminstraub created at 2012-07-10 09:15:06

Thank you for the comments!
They are worked into the newly attached patch.


---

Comment by arminstraub created at 2012-07-10 11:10:07

patchbot: apply trac_13217_qexp_eta_2.patch


---

Comment by chapoton created at 2012-07-10 11:43:45

ok, the patch looks good to me and the bot is happy. Positive review !


---

Comment by chapoton created at 2012-07-10 11:43:45

Changing keywords from "" to "Dedekind eta function".


---

Comment by chapoton created at 2012-07-10 11:43:45

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-07-13 11:44:43

Resolution: fixed
