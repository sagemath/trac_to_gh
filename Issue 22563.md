# Issue 22563: Cygwin patches for libfplll 5.1.0 / fpylll 0.2.4dev

archive/issues_022563.json:
```json
{
    "body": "Assignee: @embray\n\nKeywords: windows cygwin fplll fpylll\n\nTwo issues with fplll on Cygwin:\n\n1) Build blocker detailed at https://github.com/fplll/fplll/pull/243\n\n2) Minor fixes needed for `make check` to pass on Cygwin: https://github.com/fplll/fplll/pull/242\n\n3) Build blocker for fpylll, due to a few missed cases regarding long double support: https://github.com/fplll/fpylll/pull/64\n\nIssue created by migration from https://trac.sagemath.org/ticket/22800\n\n",
    "closed_at": "2017-04-23T12:57:55Z",
    "created_at": "2017-04-13T08:26:49Z",
    "labels": [
        "component: porting: cygwin",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Cygwin patches for libfplll 5.1.0 / fpylll 0.2.4dev",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22563",
    "user": "https://github.com/embray"
}
```
Assignee: @embray

Keywords: windows cygwin fplll fpylll

Two issues with fplll on Cygwin:

1) Build blocker detailed at https://github.com/fplll/fplll/pull/243

2) Minor fixes needed for `make check` to pass on Cygwin: https://github.com/fplll/fplll/pull/242

3) Build blocker for fpylll, due to a few missed cases regarding long double support: https://github.com/fplll/fpylll/pull/64

Issue created by migration from https://trac.sagemath.org/ticket/22800





---

archive/issue_comments_314189.json:
```json
{
    "body": "Changing keywords from \"\" to \"windows cygwin fplll\".",
    "created_at": "2017-04-13T08:27:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314189",
    "user": "https://github.com/embray"
}
```

Changing keywords from "" to "windows cygwin fplll".



---

archive/issue_comments_314190.json:
```json
{
    "body": "Set assignee to @embray.",
    "created_at": "2017-04-13T08:27:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314190",
    "user": "https://github.com/embray"
}
```

Set assignee to @embray.



---

archive/issue_comments_314191.json:
```json
{
    "body": "Changing keywords from \"windows cygwin fplll\" to \"windows cygwin fplll fpylll\".",
    "created_at": "2017-04-13T09:29:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314191",
    "user": "https://github.com/embray"
}
```

Changing keywords from "windows cygwin fplll" to "windows cygwin fplll fpylll".



---

archive/issue_comments_314192.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-04-13T10:51:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314192",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_314193.json:
```json
{
    "body": "Attached patches to fix the fplll and fpylll builds on Cygwin.\n\n---\nNew commits:",
    "created_at": "2017-04-13T10:51:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314193",
    "user": "https://github.com/embray"
}
```

Attached patches to fix the fplll and fpylll builds on Cygwin.

---
New commits:



---

archive/issue_comments_314194.json:
```json
{
    "body": "Since all patches are accepted upstream, I am willing to set this to a positive review. However, I am unable to build this (both Cygwin 32 and 64):\n\n```\n/home/Travis/sage/local/var/tmp/sage/build/libfplll-5.1.0.p0/src/missing: line 81: aclocal-1.14: command not found\n```\nAlthough I suspect this is an issue with my setup. Any thoughts?",
    "created_at": "2017-04-13T18:04:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314194",
    "user": "https://github.com/tscrim"
}
```

Since all patches are accepted upstream, I am willing to set this to a positive review. However, I am unable to build this (both Cygwin 32 and 64):

```
/home/Travis/sage/local/var/tmp/sage/build/libfplll-5.1.0.p0/src/missing: line 81: aclocal-1.14: command not found
```
Although I suspect this is an issue with my setup. Any thoughts?



---

archive/issue_comments_314195.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-04-14T08:49:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314195",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_314196.json:
```json
{
    "body": "No, I think that might be a real issue--I've made this mistake before.  My patch modifies `configure` before `configure.ac`, so then it thinks my `configure.ac` is newer than my `configure` and tries to re-run autoconf.  If you don't have the right autoconf installed then you'll get this error.  Thanks for testing that.",
    "created_at": "2017-04-14T08:49:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314196",
    "user": "https://github.com/embray"
}
```

No, I think that might be a real issue--I've made this mistake before.  My patch modifies `configure` before `configure.ac`, so then it thinks my `configure.ac` is newer than my `configure` and tries to re-run autoconf.  If you don't have the right autoconf installed then you'll get this error.  Thanks for testing that.



---

archive/issue_comments_314197.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-14T08:52:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314197",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_314198.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-04-14T08:53:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314198",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_314199.json:
```json
{
    "body": "Now the patch shouldn't cause autoconf to be invoked.",
    "created_at": "2017-04-14T08:53:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314199",
    "user": "https://github.com/embray"
}
```

Now the patch shouldn't cause autoconf to be invoked.



---

archive/issue_comments_314200.json:
```json
{
    "body": "Still doesn't work. I also have a large offset in my configure patching:\n\n```\n[libfplll-5.1.0.p0] Applying ../patches/disable-recursive-enum.patch\n[libfplll-5.1.0.p0] patching file configure.ac\n[libfplll-5.1.0.p0] patching file configure\n[libfplll-5.1.0.p0] Hunk #1 succeeded at 774 (offset -2 lines).\n[libfplll-5.1.0.p0] Hunk #2 succeeded at 1418 (offset -3 lines).\n[libfplll-5.1.0.p0] Hunk #3 succeeded at 17628 (offset -595 lines).\n```\nHere is the last part of the log:\n\n```\n[libfplll-5.1.0.p0] checking that generated files are newer than configure... done\n[libfplll-5.1.0.p0] configure: creating ./config.status\n[libfplll-5.1.0.p0] config.status: creating Makefile\n[libfplll-5.1.0.p0] config.status: creating fplll/Makefile\n[libfplll-5.1.0.p0] config.status: creating tests/Makefile\n[libfplll-5.1.0.p0] config.status: creating fplll.pc\n[libfplll-5.1.0.p0] config.status: creating config.h\n[libfplll-5.1.0.p0] config.status: creating fplll/fplll_config.h\n[libfplll-5.1.0.p0] config.status: executing depfiles commands\n[libfplll-5.1.0.p0] config.status: executing libtool commands\n[libfplll-5.1.0.p0] Now building fplll...\n[libfplll-5.1.0.p0] make[2]: Entering directory '/home/Travis/sage/local/var/tmp/sage/build/libfplll-5.1.0.p0/src'\n[libfplll-5.1.0.p0] CDPATH=\"${ZSH_VERSION+.}:\" && cd . && /bin/sh /home/Travis/sage/local/var/tmp/sage/build/libfplll-5.1.0.p0/src/missing aclocal-1.14 -I m4\n[libfplll-5.1.0.p0] /home/Travis/sage/local/var/tmp/sage/build/libfplll-5.1.0.p0/src/missing: line 81: aclocal-1.14: command not found\n[libfplll-5.1.0.p0] WARNING: 'aclocal-1.14' is missing on your system.\n[libfplll-5.1.0.p0]          You should only need it if you modified 'acinclude.m4' or\n[libfplll-5.1.0.p0]          'configure.ac' or m4 files included by 'configure.ac'.\n[libfplll-5.1.0.p0]          The 'aclocal' program is part of the GNU Automake package:\n[libfplll-5.1.0.p0]          <http://www.gnu.org/software/automake>\n[libfplll-5.1.0.p0]          It also requires GNU Autoconf, GNU m4 and Perl in order to run:\n[libfplll-5.1.0.p0]          <http://www.gnu.org/software/autoconf>\n[libfplll-5.1.0.p0]          <http://www.gnu.org/software/m4/>\n[libfplll-5.1.0.p0]          <http://www.perl.org/>\n[libfplll-5.1.0.p0] make[2]: *** [Makefile:398: aclocal.m4] Error 127\n```",
    "created_at": "2017-04-14T14:41:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314200",
    "user": "https://github.com/tscrim"
}
```

Still doesn't work. I also have a large offset in my configure patching:

```
[libfplll-5.1.0.p0] Applying ../patches/disable-recursive-enum.patch
[libfplll-5.1.0.p0] patching file configure.ac
[libfplll-5.1.0.p0] patching file configure
[libfplll-5.1.0.p0] Hunk #1 succeeded at 774 (offset -2 lines).
[libfplll-5.1.0.p0] Hunk #2 succeeded at 1418 (offset -3 lines).
[libfplll-5.1.0.p0] Hunk #3 succeeded at 17628 (offset -595 lines).
```
Here is the last part of the log:

```
[libfplll-5.1.0.p0] checking that generated files are newer than configure... done
[libfplll-5.1.0.p0] configure: creating ./config.status
[libfplll-5.1.0.p0] config.status: creating Makefile
[libfplll-5.1.0.p0] config.status: creating fplll/Makefile
[libfplll-5.1.0.p0] config.status: creating tests/Makefile
[libfplll-5.1.0.p0] config.status: creating fplll.pc
[libfplll-5.1.0.p0] config.status: creating config.h
[libfplll-5.1.0.p0] config.status: creating fplll/fplll_config.h
[libfplll-5.1.0.p0] config.status: executing depfiles commands
[libfplll-5.1.0.p0] config.status: executing libtool commands
[libfplll-5.1.0.p0] Now building fplll...
[libfplll-5.1.0.p0] make[2]: Entering directory '/home/Travis/sage/local/var/tmp/sage/build/libfplll-5.1.0.p0/src'
[libfplll-5.1.0.p0] CDPATH="${ZSH_VERSION+.}:" && cd . && /bin/sh /home/Travis/sage/local/var/tmp/sage/build/libfplll-5.1.0.p0/src/missing aclocal-1.14 -I m4
[libfplll-5.1.0.p0] /home/Travis/sage/local/var/tmp/sage/build/libfplll-5.1.0.p0/src/missing: line 81: aclocal-1.14: command not found
[libfplll-5.1.0.p0] WARNING: 'aclocal-1.14' is missing on your system.
[libfplll-5.1.0.p0]          You should only need it if you modified 'acinclude.m4' or
[libfplll-5.1.0.p0]          'configure.ac' or m4 files included by 'configure.ac'.
[libfplll-5.1.0.p0]          The 'aclocal' program is part of the GNU Automake package:
[libfplll-5.1.0.p0]          <http://www.gnu.org/software/automake>
[libfplll-5.1.0.p0]          It also requires GNU Autoconf, GNU m4 and Perl in order to run:
[libfplll-5.1.0.p0]          <http://www.gnu.org/software/autoconf>
[libfplll-5.1.0.p0]          <http://www.gnu.org/software/m4/>
[libfplll-5.1.0.p0]          <http://www.perl.org/>
[libfplll-5.1.0.p0] make[2]: *** [Makefile:398: aclocal.m4] Error 127
```



---

archive/issue_comments_314201.json:
```json
{
    "body": "The offsets aren't a big deal--I think it's just because of different versions of autoconf used to generate the original file versus the patch.\n\nThe fact that it's still not working for you could come down to granularity of mtimes still being too low such that the files look like they were modified simultaneously.  Maybe this should just include the patch to configure and not to configure.ac, or at the very least touch configure before running it.",
    "created_at": "2017-04-19T09:40:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314201",
    "user": "https://github.com/embray"
}
```

The offsets aren't a big deal--I think it's just because of different versions of autoconf used to generate the original file versus the patch.

The fact that it's still not working for you could come down to granularity of mtimes still being too low such that the files look like they were modified simultaneously.  Maybe this should just include the patch to configure and not to configure.ac, or at the very least touch configure before running it.



---

archive/issue_comments_314202.json:
```json
{
    "body": "That said, I'm looking around and there are other patches in sage that patch configure.ac/configure.in before configure, so you should either have the same problem with those (try ecm, for example) or there's something else going on.",
    "created_at": "2017-04-19T09:49:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314202",
    "user": "https://github.com/embray"
}
```

That said, I'm looking around and there are other patches in sage that patch configure.ac/configure.in before configure, so you should either have the same problem with those (try ecm, for example) or there's something else going on.



---

archive/issue_comments_314203.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-19T09:58:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314203",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_314204.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-19T18:53:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314204",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_314205.json:
```json
{
    "body": "I didn't have any trouble with ecm (I just rebuilt it). This now builds with the latest branch. Thanks.",
    "created_at": "2017-04-19T18:53:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314205",
    "user": "https://github.com/tscrim"
}
```

I didn't have any trouble with ecm (I just rebuilt it). This now builds with the latest branch. Thanks.



---

archive/issue_comments_314206.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2017-04-21T12:23:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314206",
    "user": "https://github.com/embray"
}
```

Changing priority from major to blocker.



---

archive/issue_events_059294.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-04-23T12:57:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22563#event-59294"
}
```



---

archive/issue_comments_314207.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-04-23T12:57:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314207",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_314208.json:
```json
{
    "body": "Meanwhile, there are new releases of these packages: #24042",
    "created_at": "2017-10-14T10:22:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314208",
    "user": "https://github.com/jdemeyer"
}
```

Meanwhile, there are new releases of these packages: #24042



---

archive/issue_comments_314209.json:
```json
{
    "body": "Replying to [comment:15 jdemeyer]:\n> Meanwhile, there are new releases of these packages: #24042\n\n\nI assume that means these patches can be removed? :)",
    "created_at": "2017-10-16T13:20:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22563",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22563#issuecomment-314209",
    "user": "https://github.com/embray"
}
```

Replying to [comment:15 jdemeyer]:
> Meanwhile, there are new releases of these packages: #24042


I assume that means these patches can be removed? :)
