# Issue 22563: Cygwin patches for libfplll 5.1.0

Issue created by migration from Trac.

Original creator: embray

Original creation time: 2017-04-13 08:26:49

Two issues with fplll on Cygwin:

1) Build blocker detailed at https://github.com/fplll/fplll/pull/243

2) Minor fixes needed for `make check` to pass on Cygwin: https://github.com/fplll/fplll/pull/242

There might also be an issue with fpylll that I will piggyback on this ticket once confirmed.


---

Comment by embray created at 2017-04-13 08:27:01

Changing keywords from "" to "windows cygwin fplll".


---

Comment by embray created at 2017-04-13 08:27:01

Set assignee to embray.


---

Comment by embray created at 2017-04-13 09:29:07

Changing keywords from "windows cygwin fplll" to "windows cygwin fplll fpylll".


---

Comment by embray created at 2017-04-13 10:51:08

Changing status from new to needs_review.


---

Comment by embray created at 2017-04-13 10:51:08

Attached patches to fix the fplll and fpylll builds on Cygwin.
----
New commits:


---

Comment by tscrim created at 2017-04-13 18:04:04

Since all patches are accepted upstream, I am willing to set this to a positive review. However, I am unable to build this (both Cygwin 32 and 64):

```
/home/Travis/sage/local/var/tmp/sage/build/libfplll-5.1.0.p0/src/missing: line 81: aclocal-1.14: command not found
```

Although I suspect this is an issue with my setup. Any thoughts?


---

Comment by embray created at 2017-04-14 08:49:51

Changing status from needs_review to needs_work.


---

Comment by embray created at 2017-04-14 08:49:51

No, I think that might be a real issue--I've made this mistake before.  My patch modifies `configure` before `configure.ac`, so then it thinks my `configure.ac` is newer than my `configure` and tries to re-run autoconf.  If you don't have the right autoconf installed then you'll get this error.  Thanks for testing that.


---

Comment by git created at 2017-04-14 08:52:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by embray created at 2017-04-14 08:53:10

Changing status from needs_work to needs_review.


---

Comment by embray created at 2017-04-14 08:53:10

Now the patch shouldn't cause autoconf to be invoked.


---

Comment by tscrim created at 2017-04-14 14:41:38

Still doesn't work. I also have a large offset in my configure patching:

```
[libfplll-5.1.0.p0] Applying ../patches/disable-recursive-enum.patch
[libfplll-5.1.0.p0] patching file configure.ac
[libfplll-5.1.0.p0] patching file configure
[libfplll-5.1.0.p0] Hunk #1 succeeded at 774 (offset -2 lines).
[libfplll-5.1.0.p0] Hunk #2 succeeded at 1418 (offset -3 lines).
[libfplll-5.1.0.p0] Hunk #3 succeeded at 17628 (offset -595 lines).
```

Here is the last part of the log:

```
[libfplll-5.1.0.p0] checking that generated files are newer than configure... done
[libfplll-5.1.0.p0] configure: creating ./config.status
[libfplll-5.1.0.p0] config.status: creating Makefile
[libfplll-5.1.0.p0] config.status: creating fplll/Makefile
[libfplll-5.1.0.p0] config.status: creating tests/Makefile
[libfplll-5.1.0.p0] config.status: creating fplll.pc
[libfplll-5.1.0.p0] config.status: creating config.h
[libfplll-5.1.0.p0] config.status: creating fplll/fplll_config.h
[libfplll-5.1.0.p0] config.status: executing depfiles commands
[libfplll-5.1.0.p0] config.status: executing libtool commands
[libfplll-5.1.0.p0] Now building fplll...
[libfplll-5.1.0.p0] make[2]: Entering directory '/home/Travis/sage/local/var/tmp/sage/build/libfplll-5.1.0.p0/src'
[libfplll-5.1.0.p0] CDPATH="${ZSH_VERSION+.}:" && cd . && /bin/sh /home/Travis/sage/local/var/tmp/sage/build/libfplll-5.1.0.p0/src/missing aclocal-1.14 -I m4
[libfplll-5.1.0.p0] /home/Travis/sage/local/var/tmp/sage/build/libfplll-5.1.0.p0/src/missing: line 81: aclocal-1.14: command not found
[libfplll-5.1.0.p0] WARNING: 'aclocal-1.14' is missing on your system.
[libfplll-5.1.0.p0]          You should only need it if you modified 'acinclude.m4' or
[libfplll-5.1.0.p0]          'configure.ac' or m4 files included by 'configure.ac'.
[libfplll-5.1.0.p0]          The 'aclocal' program is part of the GNU Automake package:
[libfplll-5.1.0.p0]          <http://www.gnu.org/software/automake>
[libfplll-5.1.0.p0]          It also requires GNU Autoconf, GNU m4 and Perl in order to run:
[libfplll-5.1.0.p0]          <http://www.gnu.org/software/autoconf>
[libfplll-5.1.0.p0]          <http://www.gnu.org/software/m4/>
[libfplll-5.1.0.p0]          <http://www.perl.org/>
[libfplll-5.1.0.p0] make[2]: *** [Makefile:398: aclocal.m4] Error 127
```



---

Comment by embray created at 2017-04-19 09:40:44

The offsets aren't a big deal--I think it's just because of different versions of autoconf used to generate the original file versus the patch.

The fact that it's still not working for you could come down to granularity of mtimes still being too low such that the files look like they were modified simultaneously.  Maybe this should just include the patch to configure and not to configure.ac, or at the very least touch configure before running it.


---

Comment by embray created at 2017-04-19 09:49:12

That said, I'm looking around and there are other patches in sage that patch configure.ac/configure.in before configure, so you should either have the same problem with those (try ecm, for example) or there's something else going on.


---

Comment by git created at 2017-04-19 09:58:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-04-19 18:53:28

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2017-04-19 18:53:28

I didn't have any trouble with ecm (I just rebuilt it). This now builds with the latest branch. Thanks.


---

Comment by embray created at 2017-04-21 12:23:02

Changing priority from major to blocker.


---

Comment by vbraun created at 2017-04-23 12:57:55

Resolution: fixed


---

Comment by jdemeyer created at 2017-10-14 10:22:16

Meanwhile, there are new releases of these packages: #24042


---

Comment by embray created at 2017-10-16 13:20:33

Replying to [comment:15 jdemeyer]:
> Meanwhile, there are new releases of these packages: #24042

I assume that means these patches can be removed? :)
