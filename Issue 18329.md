# Issue 18329: Warning when installing new-style experimental packages

Issue created by migration from https://trac.sagemath.org/ticket/18566

Original creator: ncohen

Original creation time: 2015-06-01 10:56:22

CC:  vbraun jdemeyer

With #18563, which changes the status of several optional new-style packages to 'experimental', we now need to display a warning when these scripts are installed.

Nathann


---

Comment by ncohen created at 2015-06-01 10:56:39

Changing status from new to needs_review.


---

Comment by git created at 2015-06-01 10:57:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2015-06-02 07:20:24

I would change

```
if [ `cat "$PKG_SCRIPTS/type"` == "experimental" ]
```

to

```
if [ x`cat "$PKG_SCRIPTS/type"` = xexperimental ]
```

which has less chances of trouble (in case of a missing/empty `type` file for example).


---

Comment by jdemeyer created at 2015-06-02 07:20:24

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2015-06-02 07:23:03

Instead of

```
echo # The following message appears twice in this file
```

couldn't you just make a function `warn_experimental()` which displays that message?


---

Comment by git created at 2015-06-02 08:44:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2015-06-02 08:45:59

> I would change
> {{{
> if [ `cat "$PKG_SCRIPTS/type"` == "experimental" ]
> }}}
> to
> {{{
> if [ x`cat "$PKG_SCRIPTS/type"` = xexperimental ]
> }}}

Nice. I did not know that corner-case, not that workaround. Done.


---

Comment by jdemeyer created at 2015-06-02 08:46:47

`=` instead of `==` in shell scripts (in POSIX, only `=` is supported, `bash` happens to support `==` also)


---

Comment by ncohen created at 2015-06-02 08:49:55

Yo !
> Instead of
> {{{
> echo # The following message appears twice in this file
> }}}
> couldn't you just make a function `warn_experimental()` which displays that message?

I first did, then decided against it for the following reason: there is one message for experimental packages (appears twice) and one message for archived packages (appears once). As for old-style packages the two messages follow each other, it seemed weird to have one called from a function and another one given explicitly. Plus It would have meant that the new functions would have to be defined in the middle of unrelated code, somewhere else.

So well, I found it cleaner this way.

Nathann


---

Comment by git created at 2015-06-02 08:50:24

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by ncohen created at 2015-06-02 08:51:00

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2015-06-05 21:24:30

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2015-06-05 21:24:30

Please rebase to sage-6.8.beta3


---

Comment by git created at 2015-06-06 07:15:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2015-06-06 07:17:49

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2015-06-06 08:10:47

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-06-06 20:51:35

Resolution: fixed
