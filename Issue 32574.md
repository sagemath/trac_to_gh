# Issue 32574: some changes in quaternion algebras

Issue created by migration from https://trac.sagemath.org/ticket/32811

Original creator: chapoton

Original creation time: 2021-11-01 17:35:30

CC:  tscrim slelievre @kliem

a bunch of pep8 fixes

also trying not to use ParentWithGens, but only Parent


---

Comment by chapoton created at 2021-11-01 17:36:00

Changing status from new to needs_review.


---

Comment by chapoton created at 2021-11-01 17:36:00

New commits:


---

Comment by chapoton created at 2021-11-01 19:57:08

double green, so please review


---

Comment by @kliem created at 2021-11-02 08:03:59

Why use `Parent` instead of `ParentWithGens`?

I'm actually wondering why we call some low level init instead of just relying on `Algebra.__init__`?


---

Comment by chapoton created at 2021-11-02 09:16:21

see `src/sage/structure/parent_old.pyx` and `src/sage/structure/parent_base.pyx`

In brief, `ParentWithGens` is part of the "old-coercion-framework", which is still used a lot, in particular in number fields and commutative rings. This is supposed to be deprecated, but removing that is a daunting task.


---

Comment by @kliem created at 2021-11-02 10:38:58

But wouldn't this be resolved by using `Algebra` as well? Eventually `Algebra` needs a new base, doesn't it?


---

Comment by chapoton created at 2021-11-02 14:21:16

I think one should prefer to use "Parent" and set the appropriate category, rather than using something else than Parent, like Algebra or Ring. But I may be wrong, as nothing is very clear.


---

Comment by @kliem created at 2021-11-03 17:10:22

I see. However what is confusing me is that we are still inheriting from `Algebra`:


```
class QuaternionAlgebra_abstract(Algebra):
```


If this is correct, we should initialize `Algebra`. If this is not correct, we should just straight inherit from `Parent`.


---

Comment by chapoton created at 2021-11-22 08:05:55

Changing status from needs_review to needs_work.


---

Comment by git created at 2021-11-24 08:04:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-11-24 19:55:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2021-11-24 19:58:21

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2021-11-24 19:58:21

Hopefully, this looks better now.

Quaternion rings subclass `Algebra`, and use `Algebra.__init__`

Quaternion orders subclass `Parent` and use `Parent.__init__ `


---

Comment by chapoton created at 2021-11-25 07:38:41

and the lights are green, so please review


---

Comment by @kliem created at 2021-11-25 09:23:12

Note that the following still works:


```
sage: from sage.algebras.algebra import is_Algebra
sage: Q = QuaternionAlgebra(-1,-7).maximal_order()
sage: is_Algebra(Q)
```



---

Comment by @kliem created at 2021-11-25 09:23:45

Changing status from needs_review to positive_review.


---

Comment by slelievre created at 2021-11-25 11:51:24

Changing keywords from "" to "pep8, ParentWithGens, Parent".


---

Comment by slelievre created at 2021-11-27 11:19:50

See also #32245 and #32264 about quaternion algebras,
and more generally

- https://trac.sagemath.org/query?order=id&desc=1&status=!closed&summary=~quaternion


---

Comment by vbraun created at 2021-12-19 11:47:29

Resolution: fixed
