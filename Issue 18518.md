# Issue 18518: Add elementary and infinity crystals to Thematic Tutorial on crystals

Issue created by migration from https://trac.sagemath.org/ticket/18755

Original creator: bsalisbury1

Original creation time: 2015-06-21 16:44:14

CC:  aschilling bump tscrim

Keywords: crystals, thematic tutorial

Added tutorials on elementary crystals and infinity crystals to the Thematic Tutorial entitled Lie Methods and Related Combinatorics in Sage.


---

Comment by bsalisbury1 created at 2015-06-21 16:45:22

I've uploaded a first draft... comments?
----
New commits:


---

Comment by tscrim created at 2015-06-21 17:13:25

On a quick look-over, what you currently have looks good (one typo `an hyperbolic`). However I would add how the elementary crystals are useful in relation to `B(\infty)`, specifically the path model.


---

Comment by aschilling created at 2015-06-21 22:15:10

Hi Ben,

Could you please also post a link to the compiled documentation (since this is a tutorial). Then it would be easier to comment.

Thanks!

Anne


---

Comment by bsalisbury1 created at 2015-06-21 22:41:25

Hi,

Thanks, Anne and Travis, for reading this ticket already!

----

Replying to [comment:3 tscrim]:
> On a quick look-over, what you currently have looks good (one typo `an hyperbolic`). 

Since grade school, I had been under the impression that you always use "an" before a word that starts with "h", since the "h" is supposed to be silent.  However, I did some reading about it, and I now agree that it should be "a hyperbolic" rather than "an hyperbolic".  Thanks for catching that!

----

Replying to [comment:4 aschilling]:
> Could you please also post a link to the compiled documentation (since this is a tutorial). Then it would be easier to comment.

I've posted a temporary link here:  http://people.cst.cmich.edu/salis1bt/sage/lie.html.  I'll continue to maintain this page as the ticket is updated, but I will take it down once (if?) the ticket receives a positive review.

-------

One problem I noticed already (and don't know how to immediately fix) is that the `Next topic` links are not working as expected.  For example, while on the `Affine Highest Weight Crystals` page, the `Next topic` listed is `Iwahori Hecke Algebras`, but it should be `Elementary Crystals`.  I've already added the new sections the TOC, so I'm not sure what I'm missing.  Any suggestions are greatly appreciated!

Best,
Ben


---

Comment by bump created at 2015-06-22 18:45:55

[Kashiwara1995] can also be used as a reference for T_lambda. (Example 7.3.) Also for the B_i.

In some cases left tensoring with T_lambda is different from right tensoring with T_lambda. For example left tensoring B_i with T_lambda is the same as right tensoring with T_{s_i lambda}.

There is potential for confusion since Sage's convention for tensoring is the opposite of Kashiwara's. Kashiwara usually considers B tensor T_lambda if he just wants to shift the dimension. So I guess we do the reverse, which is what you do in the tutorial. The issue comes up again with R_lambda. It might be worth mentioning something about this issue.

The patch should add Ben Salisbury as an author.


---

Comment by bsalisbury1 created at 2015-06-22 19:52:05

Hi Dan,

Thanks for reading the updates!  The changes you suggested have been made, but maybe I've gone a little overkill in how many times the reader has been reminded about the tensor product convention.  Do you think a warning at the top of the page would be better than the way it is now?

Best,
Ben


---

Comment by git created at 2015-06-22 19:52:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bump created at 2015-06-22 20:20:29

Replying to [comment:7 bsalisbury1]:


> Thanks for reading the updates!  The changes you suggested have been made, but maybe I've gone a little overkill in how many times the reader has been reminded about the tensor product convention.  Do you think a warning at the top of the page would be better than the way it is now?

My feeling is the overkill is OK.


---

Comment by aschilling created at 2015-06-22 21:17:59

> One problem I noticed already (and don't know how to immediately fix) is that the `Next topic` links are not working as expected.  For example, while on the `Affine Highest Weight Crystals` page, the `Next topic` listed is `Iwahori Hecke Algebras`, but it should be `Elementary Crystals`.  I've already added the new sections the TOC, so I'm not sure what I'm missing.  Any suggestions are greatly appreciated!

Have you tried make doc-clean and then make doc again? It might be remembering the old links.

Anne


---

Comment by aschilling created at 2015-06-22 21:18:54

Hi Ben,

It looks pretty good! One small comment I have is to add Sage examples for the C crystals perhaps (there are currently none).

Best,

Anne


---

Comment by git created at 2015-06-22 21:53:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bsalisbury1 created at 2015-06-22 21:54:47

Hi Anne,

An example has been added now to the C crystal section.  Hopefully this example will give some good motivation for using the R crystal.  Also, `make doc-clean` solved the link problem.  Thanks!

Best,
Ben


---

Comment by bsalisbury1 created at 2015-06-22 21:54:47

Changing status from new to needs_review.


---

Comment by aschilling created at 2015-06-22 22:02:12

Hi Ben,

I get quite a few doc test failures with the current branch

```
sage -t elementary_crystals.rst
**********************************************************************
File "elementary_crystals.rst", line 42, in doc.en.thematic_tutorials.lie.elementary_crystals
Failed example:
    for x in B:
    print x.weight() + T[0].weight()
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 856, in compile_and_execute
        compiled = compiler(example)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 494, in <lambda>
        example.source, filename, "single", compileflags, 1)
      File "<doctest doc.en.thematic_tutorials.lie.elementary_crystals[4]>", line 2
        print x.weight() + T[Integer(0)].weight()
            ^
    IndentationError: expected an indented block
**********************************************************************
File "elementary_crystals.rst", line 96, in doc.en.thematic_tutorials.lie.elementary_crystals
Failed example:
    b = BB(C[0],T[0])
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest doc.en.thematic_tutorials.lie.elementary_crystals[5]>", line 1, in <module>
        b = BB(C[Integer(0)],T[Integer(0)])
    NameError: name 'BB' is not defined
**********************************************************************
File "elementary_crystals.rst", line 97, in doc.en.thematic_tutorials.lie.elementary_crystals
Failed example:
    for i in B.index_set(): print b.epsilon(i)
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest doc.en.thematic_tutorials.lie.elementary_crystals[6]>", line 1, in <module>
        for i in B.index_set(): print b.epsilon(i)
    NameError: name 'b' is not defined
**********************************************************************
File "elementary_crystals.rst", line 100, in doc.en.thematic_tutorials.lie.elementary_crystals
Failed example:
    for i in B.index_set(): print b.phi(i)
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest doc.en.thematic_tutorials.lie.elementary_crystals[7]>", line 1, in <module>
        for i in B.index_set(): print b.phi(i)
    NameError: name 'b' is not defined
**********************************************************************
File "elementary_crystals.rst", line 103, in doc.en.thematic_tutorials.lie.elementary_crystals
Failed example:
    for i in B.index_set(): print b.f(i)
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest doc.en.thematic_tutorials.lie.elementary_crystals[8]>", line 1, in <module>
        for i in B.index_set(): print b.f(i)
    NameError: name 'b' is not defined
**********************************************************************
File "elementary_crystals.rst", line 106, in doc.en.thematic_tutorials.lie.elementary_crystals
Failed example:
    for i in B.index_set(): print b.e(i)
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest doc.en.thematic_tutorials.lie.elementary_crystals[9]>", line 1, in <module>
        for i in B.index_set(): print b.e(i)
    NameError: name 'b' is not defined
```


Anne


---

Comment by tscrim created at 2015-06-22 22:30:01

You also don't need the print statements, but if you want to include them, you should make it Python 3 compatible by `print(x)` (just add the [trivial wrt Python 2.x] parenthesis).


---

Comment by bsalisbury1 created at 2015-06-22 23:14:23

Ahhh!  I'm sorry about that.  For some reason, I didn't realize tutorials were doctested.  In retrospect, that wasn't too bright.  Sorry for wasting your time!

In the course of doctesting, I'm noticing some unexpected results.  Some examples I could compute before upgrading to `beta5` are now failing (including the example from the R crystal section of the tutorial).  I'll keep at it and let everyone know when it is fixed.  In the meantime, I'll post the other changes.  In particular, the `infinity_crystals.rst` file is passing its tests.

Best,
Ben


---

Comment by bsalisbury1 created at 2015-06-22 23:14:23

Changing status from needs_review to needs_work.


---

Comment by git created at 2015-06-22 23:14:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-06-23 00:10:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bsalisbury1 created at 2015-06-23 00:12:22

Changing status from needs_work to needs_review.


---

Comment by bsalisbury1 created at 2015-06-23 00:12:22

Now I think it's ready to go!


```
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 10.9 seconds
    cpu time: 37.1 seconds
    cumulative wall time: 46.2 seconds
```



---

Comment by git created at 2015-06-23 00:18:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-06-23 00:38:05

Positive review from me. Dan and Anne, any objections?


---

Comment by aschilling created at 2015-06-23 02:32:01

Replying to [comment:21 tscrim]:
> Positive review from me. Dan and Anne, any objections?

Unfortunately, I still get doctest failures

```
sage -t infinity_crystals.rst
**********************************************************************
File "infinity_crystals.rst", line 98, in doc.en.thematic_tutorials.lie.infinity_crystals
Failed example:
    Psi = Brho.crystal_morphism({brho : binf})
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest doc.en.thematic_tutorials.lie.infinity_crystals[4]>", line 1, in <module>
        Psi = Brho.crystal_morphism({brho : binf})
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/crystals.py", line 623, in crystal_morphism
        automorphism, virtualization, scaling_factors, check)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/crystals.py", line 2290, in __call__
        generators, check)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/highest_weight_crystals.py", line 570, in __init__
        gens, check)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/crystals.py", line 1792, in __init__
        self._check()
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/crystals.py", line 1845, in _check
        raise ValueError("invalid crystal morphism: weights do not match")
    ValueError: invalid crystal morphism: weights do not match
**********************************************************************
File "infinity_crystals.rst", line 99, in doc.en.thematic_tutorials.lie.infinity_crystals
Failed example:
    BG = B.digraph(subset=[Psi(x) for x in Brho])
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest doc.en.thematic_tutorials.lie.infinity_crystals[5]>", line 1, in <module>
        BG = B.digraph(subset=[Psi(x) for x in Brho])
    NameError: name 'Psi' is not defined
**********************************************************************
1 item had failures:
   2 of  91 in doc.en.thematic_tutorials.lie.infinity_crystals
    [75 tests, 2 failures, 0.49 s]
```



---

Comment by tscrim created at 2015-06-23 02:51:02

I think you have #15463 merged in. However there is a mismatch in the weights as one has weight `\rho` and the other has weight `0` which should be fixed.


---

Comment by aschilling created at 2015-06-23 02:55:31

Replying to [comment:23 tscrim]:
> I think you have #15463 merged in. However there is a mismatch in the weights as one has weight `\rho` and the other has weight `0` which should be fixed.

In this case, the relevant tickets should be mentioned as dependencies.


---

Comment by tscrim created at 2015-06-23 05:07:48

Replying to [comment:24 aschilling]:
> Replying to [comment:23 tscrim]:
> > I think you have #15463 merged in. However there is a mismatch in the weights as one has weight `\rho` and the other has weight `0` which should be fixed.
> 
> In this case, the relevant tickets should be mentioned as dependencies.

It's not included in this branch. I think you forgot to recompile after you were looking at #15463.


---

Comment by aschilling created at 2015-06-23 06:10:05

Replying to [comment:25 tscrim]:
> Replying to [comment:24 aschilling]:
> > Replying to [comment:23 tscrim]:
> > > I think you have #15463 merged in. However there is a mismatch in the weights as one has weight `\rho` and the other has weight `0` which should be fixed.
> > 
> > In this case, the relevant tickets should be mentioned as dependencies.
> 
> It's not included in this branch. I think you forgot to recompile after you were looking at #15463.

Oops, yes, all tests pass for me now!


---

Comment by aschilling created at 2015-06-23 18:16:58

Hi Ben,

I found one more typo `Rμ−λ\otimesB(λ)` in the R-crystal section. I think there is a space missing between \otimes and B. Other than that, it looks good to me.

Do you agree with Travis' comment that the weight `\rho` versus weight 0 problem should be fixed in the example?

Dan, any further comments?

Best,

Anne


---

Comment by git created at 2015-06-23 22:45:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bsalisbury1 created at 2015-06-23 22:46:44

Replying to [comment:27 aschilling]:
> I found one more typo `Rμ−λ\otimesB(λ)` in the R-crystal section. I think there is a space missing between \otimes and B. Other than that, it looks good to me.
> 
> Do you agree with Travis' comment that the weight `\rho` versus weight 0 problem should be fixed in the example?

Both of these issues are now fixed.

Best,
Ben


---

Comment by tscrim created at 2015-06-24 15:05:23

Dan, do you have any more comments?


---

Comment by aschilling created at 2015-06-25 05:18:50

Ok, it looks good to me now!


---

Comment by aschilling created at 2015-06-25 05:19:05

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-06-25 19:47:47

Resolution: fixed
