# Issue 11057: Rational maps attached to elliptic curve isogeny are incorrect

Issue created by migration from Trac.

Original creator: johanbosman

Original creation time: 2011-04-21 07:12:27

Assignee: cremona

Keywords: elliptic curves, isogeny


```
sage: E = EllipticCurve([1,2,3,4,5])
sage: Eshort = E.short_weierstrass_model()
sage: phi = E.isogeny(E(0), Eshort)
sage: phiX, phiY = phi.rational_maps()
sage: phi(E(1,2))
(63 : 864 : 1)
sage: phiX(1,2), phiY(1,2)
(63, 7560)
```



---

Comment by cremona created at 2011-04-21 08:55:46

Maybe the case of degree 1 isogenies has not been tested properly.

You can use E.isomorphism_to(Eshort) instead in this case.  The Weierstrass isomorphisms were implemented long before isogenies, and have a completely different type (though obviously one should be able to create a degree 1 isogeny from an isomorphism, and vice versa).


---

Comment by johanbosman created at 2011-04-21 09:03:33

Hi John,

The only reason why I used a degree 1 isogeny in the example was to keep the example simple; it goes wrong in more general cases as well.

But I've already found in the code where it goes wrong.  I will upload a patch shortly.

Johan


---

Comment by cremona created at 2011-04-21 09:06:23

Replying to [comment:2 johanbosman]:
> Hi John,
> 
> The only reason why I used a degree 1 isogeny in the example was to keep the example simple; it goes wrong in more general cases as well.
> 
> But I've already found in the code where it goes wrong.  I will upload a patch shortly.
> 

Excellent!

I think there was a similar bug recently reported for isogenies -- could you look for that to see if your patch corrects that too?  I don't remember the number.

> Johan


---

Comment by johanbosman created at 2011-04-21 09:24:38

Do you mean #10888?  That bug is unrelated to this one. ;).


---

Comment by johanbosman created at 2011-04-21 09:43:23

Changing status from new to needs_review.


---

Attachment


---

Comment by johanbosman created at 2011-04-21 10:14:09

Comment: the only difference between the two patches is the compulsory "Trac" line.


---

Comment by cremona created at 2011-04-21 10:32:19

Replying to [comment:4 johanbosman]:
> Do you mean #10888?  That bug is unrelated to this one. ;).

Too  bad.

I have no time now but will review at some point, unless someone else gets there first.


---

Comment by cremona created at 2011-04-22 15:04:33

Changing status from needs_review to positive_review.


---

Comment by cremona created at 2011-04-22 15:04:33

The patch looks good to me, applies to 4.7.alpha5, and all tests in elliptic_curves pass.


---

Comment by jdemeyer created at 2011-05-04 06:51:10

Resolution: fixed
