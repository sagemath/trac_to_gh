# Issue 11677: ppl.pyx test takes a very long time contrary to what is claimed

archive/issues_011677.json:
```json
{
    "body": "Assignee: @williamstein\n\nCC:  @vbraun @nexttime\n\nFrom the file `sage/libs/ppl.pyx` starting at line 112:\n\n```\nThe computation finishes without noticeable delay on my desktop\n(timeit measures it to be 35msec). Cddlib needs about 3 minutes on the\nsame hardware::\n\n    sage: basis = range(0,6)\n    sage: x = [ Variable(i) for i in basis ]\n    sage: gs = [ tuple(coeff) for coeff in permutations(basis) ]\n    sage: Polyhedron(vertices=gs)   # long time\n    A 5-dimensional polyhedron in QQ^6 defined as the convex hull of 720 vertices.\n```\n\nContrary to the claim that this takes milliseconds, it actually takes minutes.  This regularly causes timeouts when testing Sage on Skynet.\n\nOn sage.math.washington.edu, sage-4.7.2.alpha0:\n\n```\nsage: from sage.libs.ppl import Variable, Generator_System, point, C_Polyhedron\nsage: basis = range(0,6)\nsage: x = [ Variable(i) for i in basis ]\nsage: gs = [ tuple(coeff) for coeff in permutations(basis) ]\nsage: time Polyhedron(vertices=gs)\nA 5-dimensional polyhedron in QQ^6 defined as the convex hull of 720 vertices.\n\nTime: CPU 0.14 s, Wall: 218.94 s\n```\n\nIssue created by migration from https://trac.sagemath.org/ticket/11849\n\n",
    "created_at": "2011-09-26T09:15:39Z",
    "labels": [
        "component: interfaces",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7.2",
    "title": "ppl.pyx test takes a very long time contrary to what is claimed",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11677",
    "user": "https://github.com/jdemeyer"
}
```
Assignee: @williamstein

CC:  @vbraun @nexttime

From the file `sage/libs/ppl.pyx` starting at line 112:

```
The computation finishes without noticeable delay on my desktop
(timeit measures it to be 35msec). Cddlib needs about 3 minutes on the
same hardware::

    sage: basis = range(0,6)
    sage: x = [ Variable(i) for i in basis ]
    sage: gs = [ tuple(coeff) for coeff in permutations(basis) ]
    sage: Polyhedron(vertices=gs)   # long time
    A 5-dimensional polyhedron in QQ^6 defined as the convex hull of 720 vertices.
```

Contrary to the claim that this takes milliseconds, it actually takes minutes.  This regularly causes timeouts when testing Sage on Skynet.

On sage.math.washington.edu, sage-4.7.2.alpha0:

```
sage: from sage.libs.ppl import Variable, Generator_System, point, C_Polyhedron
sage: basis = range(0,6)
sage: x = [ Variable(i) for i in basis ]
sage: gs = [ tuple(coeff) for coeff in permutations(basis) ]
sage: time Polyhedron(vertices=gs)
A 5-dimensional polyhedron in QQ^6 defined as the convex hull of 720 vertices.

Time: CPU 0.14 s, Wall: 218.94 s
```

Issue created by migration from https://trac.sagemath.org/ticket/11849





---

archive/issue_comments_131831.json:
```json
{
    "body": "Changing keywords from \"\" to \"Parma Polyhedra Library\".",
    "created_at": "2011-09-26T09:24:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11677#issuecomment-131831",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "" to "Parma Polyhedra Library".



---

archive/issue_comments_131832.json:
```json
{
    "body": "You are looking at the wrong code. The \n\n```\nsage: Polyhedron(vertices=gs)   # long time\n```\ncall takes a very long time, as stated. The PPL computation is a few lines above, and completes within miliseconds:\n\n```\nsage: C_Polyhedron(gs)\n```\nWe could turn the `Polyhedron()` call into a shorter `# long time` example. \n\nAlso, I have some patches on trac to switch `Polyhedron` to PPL, as well.",
    "created_at": "2011-09-26T09:54:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11677#issuecomment-131832",
    "user": "https://github.com/vbraun"
}
```

You are looking at the wrong code. The 

```
sage: Polyhedron(vertices=gs)   # long time
```
call takes a very long time, as stated. The PPL computation is a few lines above, and completes within miliseconds:

```
sage: C_Polyhedron(gs)
```
We could turn the `Polyhedron()` call into a shorter `# long time` example. 

Also, I have some patches on trac to switch `Polyhedron` to PPL, as well.



---

archive/issue_comments_131833.json:
```json
{
    "body": "Replying to [comment:2 vbraun]:\n> sage: C_Polyhedron(gs)\n> }}}\n> We could turn the `Polyhedron()` call into a shorter `# long time` example.\n\nYes, please do that.  I think you should aim for something taking at most 10 seconds or so on `sage.math`.\n\nAlso, I would rephrase the paragraph starting from line 112 as\n\n```\nThe above computation (using PPL) finishes without noticeable delay (timeit measures it to be 5ms on sage.math). Below we do the same computation with cddlib, which needs about 10 seconds on the same hardware::\n\n    sage: basis = range(0,6)\n    sage: x = [ Variable(i) for i in basis ]\n    sage: gs = [ tuple(coeff) for coeff in permutations(basis) ]\n    sage: Polyhedron(vertices=gs)   # long time (10s on sage.math, 2011)\n    A 5-dimensional polyhedron in QQ^6 defined as the convex hull of 720 vertices.\n```",
    "created_at": "2011-09-26T13:44:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11677#issuecomment-131833",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:2 vbraun]:
> sage: C_Polyhedron(gs)
> }}}
> We could turn the `Polyhedron()` call into a shorter `# long time` example.

Yes, please do that.  I think you should aim for something taking at most 10 seconds or so on `sage.math`.

Also, I would rephrase the paragraph starting from line 112 as

```
The above computation (using PPL) finishes without noticeable delay (timeit measures it to be 5ms on sage.math). Below we do the same computation with cddlib, which needs about 10 seconds on the same hardware::

    sage: basis = range(0,6)
    sage: x = [ Variable(i) for i in basis ]
    sage: gs = [ tuple(coeff) for coeff in permutations(basis) ]
    sage: Polyhedron(vertices=gs)   # long time (10s on sage.math, 2011)
    A 5-dimensional polyhedron in QQ^6 defined as the convex hull of 720 vertices.
```



---

archive/issue_comments_131834.json:
```json
{
    "body": "Initial patch",
    "created_at": "2011-09-26T21:15:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11677#issuecomment-131834",
    "user": "https://github.com/vbraun"
}
```

Initial patch



---

archive/issue_comments_131835.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-09-26T21:17:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11677#issuecomment-131835",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_131836.json:
```json
{
    "body": "Attachment [trac_11849_shorter_long_ppl_test.patch](tarball://root/attachments/some-uuid/ticket11849/trac_11849_shorter_long_ppl_test.patch) by @vbraun created at 2011-09-26 21:17:46\n\nThe attached patch switches to an computationally easier doctest problem. Now it should complete in < 5.",
    "created_at": "2011-09-26T21:17:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11677#issuecomment-131836",
    "user": "https://github.com/vbraun"
}
```

Attachment [trac_11849_shorter_long_ppl_test.patch](tarball://root/attachments/some-uuid/ticket11849/trac_11849_shorter_long_ppl_test.patch) by @vbraun created at 2011-09-26 21:17:46

The attached patch switches to an computationally easier doctest problem. Now it should complete in < 5.



---

archive/issue_comments_131837.json:
```json
{
    "body": "positive_review modulo the reviewer patch.",
    "created_at": "2011-09-27T07:15:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11677#issuecomment-131837",
    "user": "https://github.com/jdemeyer"
}
```

positive_review modulo the reviewer patch.



---

archive/issue_comments_131838.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-09-27T07:15:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11677#issuecomment-131838",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_131839.json:
```json
{
    "body": "Great, thanks!",
    "created_at": "2011-09-27T08:14:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11677#issuecomment-131839",
    "user": "https://github.com/vbraun"
}
```

Great, thanks!



---

archive/issue_events_031243.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-27T17:39:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11677",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11677#event-31243"
}
```



---

archive/issue_comments_131840.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-09-27T17:39:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11677#issuecomment-131840",
    "user": "https://github.com/nexttime"
}
```

Resolution: fixed



---

archive/issue_comments_131841.json:
```json
{
    "body": "Changing keywords from \"Parma Polyhedra Library\" to \"sd34 Parma Polyhedra Library\".",
    "created_at": "2011-09-29T15:39:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11677#issuecomment-131841",
    "user": "https://github.com/vbraun"
}
```

Changing keywords from "Parma Polyhedra Library" to "sd34 Parma Polyhedra Library".



---

archive/issue_comments_131842.json:
```json
{
    "body": "Attachment [11849_reviewer.patch](tarball://root/attachments/some-uuid/ticket11849/11849_reviewer.patch) by @jdemeyer created at 2011-10-04 08:00:49",
    "created_at": "2011-10-04T08:00:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11677#issuecomment-131842",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [11849_reviewer.patch](tarball://root/attachments/some-uuid/ticket11849/11849_reviewer.patch) by @jdemeyer created at 2011-10-04 08:00:49



---

archive/issue_comments_131843.json:
```json
{
    "body": "Fixed commit message of my reviewer patch.",
    "created_at": "2011-10-04T08:01:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11677#issuecomment-131843",
    "user": "https://github.com/jdemeyer"
}
```

Fixed commit message of my reviewer patch.
