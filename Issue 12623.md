# Issue 12623: Invalid simplification from Expression.simplify_trig()

Issue created by migration from Trac.

Original creator: mjo

Original creation time: 2012-04-02 17:25:08

Assignee: burcin

CC:  kcrisman

Same issue as #12794 from the looks of it. Maybe this is just a particular nasty function?


---

Attachment

A .sage file exhibiting the problem


---

Comment by kcrisman created at 2013-06-16 00:51:14

I'm inclined to believe it's a pretty nasty function.  Given that the simplifications in both cases appear to be the same (and that `G.expand()` gives a different, but still correct, thing without numerical issues), I think the problem is just that you lose too much accuracy.  See my comment on #12794.


---

Comment by kcrisman created at 2013-06-16 00:56:03

shows solution


---

Attachment

Thanks for pointing out #12795, which got me trying this out again... Pretty sure this is invalid.

```
sage: G = F(u=b)
sage: H = G.simplify_trig()
sage: R = RealField(1000)
sage: L = [(j,H(R(j))) for j in srange(-1,.2,.001)]
sage: M = [(a,R(b)) for a,b in L] # should have done this in one step, but oh well
sage: points(M)+plot(G,(x,-1,.2),color='red')
```

yields the following bee-yoo-tiful picture that every student of mathematics should have the chance to understand - why you don't just plug and chug:

![](better.png)


---

Comment by mjo created at 2015-12-04 01:19:16

You are right about these, I should have closed them earlier. The problem is with plot() using floats. The result of `simplify_rational()` is still accurate.


---

Comment by mjo created at 2015-12-04 01:19:16

Changing status from new to needs_review.


---

Comment by mjo created at 2015-12-04 01:19:52

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-12-04 22:13:33

Resolution: invalid
