# Issue 21084: Cleanup in sparse modules

Issue created by migration from https://trac.sagemath.org/ticket/21321

Original creator: Bouillaguet

Original creation time: 2016-08-23 18:03:23

CC:  cpernet

This ticket removes all the `.pxi` files in `sage/modules`, and replaces them by proper `.pxd/pyx` files.

It adds no new functionnality.


---

Comment by cpernet created at 2016-08-23 22:39:23

New commits:


---

Comment by cpernet created at 2016-08-23 22:39:23

Changing keywords from "" to "sd75".


---

Comment by git created at 2016-08-23 22:43:17

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by Bouillaguet created at 2016-08-24 08:58:48

Changing status from new to needs_review.


---

Comment by Bouillaguet created at 2016-08-24 08:58:48

Changing priority from minor to major.


---

Comment by git created at 2016-08-24 15:36:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2016-08-25 18:44:36

I might review this.


---

Comment by jdemeyer created at 2016-08-25 18:46:30

One thing: you have a very complicated git history here. Can you squash it to just 1 commit?


---

Comment by jdemeyer created at 2016-08-25 18:49:12

cysignals stuff should only be in .pyx files.


---

Comment by jdemeyer created at 2016-08-25 18:49:12

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2016-08-25 19:08:07

More generally, .pxd files should only cimport/include what they really need.


---

Comment by jdemeyer created at 2016-08-25 19:17:46

Did you check for conflicts with #17635?


---

Comment by git created at 2016-08-25 19:58:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by Bouillaguet created at 2016-08-25 20:00:24

Thanks for your time, Jeroen. I fixed the extra imports in .pxd files, and sqashed all that into a single commit. Up for review again.


---

Comment by Bouillaguet created at 2016-08-25 20:00:24

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2016-08-26 08:23:42

Replying to [comment:13 Bouillaguet]:
> and sqashed all that into a single commit.

I think you did something wrong, since I see two unrelated commits. In any case, you should rebase on top of sage-7.4.beta*2* now.


---

Comment by jdemeyer created at 2016-08-26 08:23:42

Changing status from needs_review to needs_work.


---

Comment by cpernet created at 2016-08-26 09:08:06

Replying to [comment:11 jdemeyer]:
> Did you check for conflicts with #17635?

This ticket merges cleanly with 17635 and the testsuite passes on my box.


---

Comment by jdemeyer created at 2016-08-26 09:16:18

Since you're moving files anyway, could you move `src/sage/modules/binary_search` to `src/sage/data_structures/binary_search`. That code has nothing to do with modules.


---

Comment by git created at 2016-08-26 20:58:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-08-27 13:35:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by Bouillaguet created at 2016-08-27 13:38:25

Changing status from needs_work to needs_review.


---

Comment by Bouillaguet created at 2016-08-27 13:38:25

Jeroen, the ticket is ready for review (again).


---

Comment by jdemeyer created at 2016-08-27 13:47:44

Did you run full doctests with this latest patch?


---

Comment by Bouillaguet created at 2016-08-27 13:48:53

No. I'm counting on the patchbot...


---

Comment by jdemeyer created at 2016-08-27 20:30:18

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2016-08-27 20:30:18

Tests are good.


---

Comment by vbraun created at 2016-08-29 16:56:18

Resolution: fixed
