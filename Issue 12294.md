# Issue 12294: test whether a polynomial is cyclotomic

Issue created by migration from Trac.

Original creator: sstarosta

Original creation time: 2012-02-07 19:43:28

Assignee: sstarosta

CC:  vdelecroix alexghitza

Keywords: Cernay2012

Given a polynomial with integer coefficients, test if it is cyclotomic or not:


```
sage: P.<x> = ZZ[x]
sage: (x-1).is_cyclotomic()
True
sage: (x^2+1).is_cyclotomic()
True
sage: (x^3-x+1).is_cyclotomic()
False
```



---

Comment by sstarosta created at 2012-02-08 12:27:47

Changing status from new to needs_review.


---

Comment by hivert created at 2012-02-11 11:56:19

Hi Stepan,

I had a quick look at you patch. I have two comment:
 - There is a proper syntax for reference and algorithm please see: http://www.sagemath.org/doc/developer/conventions.html#docstring-markup-with-rest-and-sphinx. I don't have the time to fix it myself.
 - More important, I think your code should go in a file which is not dependent on a particular implementation of polynomial. I think sage/rings/polynomial/polynomial_element.pyx is a good place. You'll find there methods such as (`squarefree_decomposition, is_square`). Maybe putting a function in `cyclotomic.pyx` and a frontend method in `polynomial_element`, that is having all cyclotomic algorithm in the same place, is a better solution.

Thanks for this nice work !

Florent


---

Comment by sstarosta created at 2012-02-21 20:13:40

Replying to [comment:2 hivert]:

Hi Florent,

thank you for the feedback! I made some improvements.


>  - There is a proper syntax for reference and algorithm

I tried to make some changes according to the documentation.

>  - More important, I think your code should go in a file which is not dependent on a particular implementation of polynomial.

I moved the code to sage/rings/polynomial/polynomial_element.pyx for the moment.


---

Comment by davidloeffler created at 2012-04-05 11:49:17

This will do some strange things if the base ring is a finite field. For instance it will say that the mod p reduction of the nth cyclotomic polynomial is cyclotomic for some values of p, and non-cyclotomic for others (because it will depend whether the reduction mod p is irreducible or not). 

Moreover, if the base ring is a characteristic 0 ring bigger than ZZ, you will get some strange behaviour in case 3 because you call "f1.factor()" and the factorization over ` self.base_ring() ` won't generally be the same as over ZZ; indeed you might even get errors at this point if the base ring is one where Sage doesn't know how to factor polynomials.

I suggest you change the type-check

```python
try:
    self.change_ring(ZZ)
except TypeError:
    return False
```

to something a bit more cautious like

```python
if self.base_ring().characteristic() != 0:
    return False
if self.base_ring() != ZZ:
    try:
        f = self.change_ring(ZZ)
        return f.is_cyclotomic()
    except TypeError,ValueError:
        return False
```

(or raise a ValueError, if you prefer). Then you can continue with your algorithm in the confidence that the base ring is ZZ.


---

Comment by jdemeyer created at 2012-07-27 20:41:09

Please fill in your real name as Author.


---

Comment by sstarosta created at 2012-08-16 10:27:32

Replying to [comment:5 davidloeffler]:

> I suggest you change the type-check to something a bit more cautious

Thanks a lot! I had doubts about this part. I did what you suggested.


Replying to [comment:6 jdemeyer]:

> Please fill in your real name as Author.

Done.


---

Attachment

tested on sage 5.3.beta1


---

Comment by chapoton created at 2013-03-13 13:11:11

A few changes made in the review patch:

* the reference is no longer given by a number like [1], but by [BD89]

* added a link to the cited article as follows 
`:doi:`10.1007/3-540-51084-2_22``

* when the characteristic is not zero, raise an error

```
raise NotImplementedError("not implemented in non-zero characteristic")
```


* the odd and even construction are now done in two lines

```
po_odd = sum(coefs[i]*(gen**((i-1)/2)) for i in xrange(1,len(coefs),2))
po_even = sum(coefs[i]*(gen**(i/2)) for i in xrange(0,len(coefs),2))
```



---

Comment by chapoton created at 2013-03-13 13:12:57

Once the bot has given a green light, and if you are happy with the review patch, you can give a positive review


---

Comment by tscrim created at 2013-04-04 12:19:00

Hey Frederic,

Bot has essentially given a green light and the review patch looks good to me except for one minor thing on line 5969, I would prefer it to be:

```
Return ``True`` if ``self`` is a cyclotomic polynomial.
```

Sorry to nitpick.

Thanks,

Travis


---

Attachment

revised patch, with line 5969 changed


---

Comment by tscrim created at 2013-04-04 14:59:40

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2013-04-04 14:59:40

Thanks Frederic.


---

Comment by jdemeyer created at 2013-04-06 14:50:24

Resolution: fixed
