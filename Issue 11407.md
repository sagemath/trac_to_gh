# Issue 11407: Free module equality, comparisons

Issue created by migration from https://trac.sagemath.org/ticket/11579

Original creator: rbeezer

Original creation time: 2011-07-06 16:39:28

Assignee: jason, was

CC:  fwclarke

On #11553, mmarco gives an example that can be distilled to:


```
sage: R = PolynomialRing(QQ, 'a')
sage: x = vector(R, [1, 0])
sage: y = vector(R, [0, 1])
sage: z = vector(R, [0,-1])
sage: A = (R^2).span([x, y])
sage: B = (R^2).span([x, z])
sage: A == B
False
sage: A.is_submodule(B)
True
sage: B.is_submodule(A)
True
```


Root cause looks like an assumption that echelon form (Hermite form) over PIDs is unique, which may be insurmountable in general.


```
sage: S = matrix([x, y])
sage: S._echelon_form_PID()[1]
[1 0]
[0 1]
sage: T = matrix([x, z])
sage: T._echelon_form_PID()[1]
[ 1  0]
[ 0 -1]
```


This also affects the ordering of free modules via the `__cmp__` method.


---

Comment by rbeezer created at 2011-07-06 16:45:20

One suggestion for a fix:

(a) make comparisons raise a NotImplementedError for rings that are not fields and not ZZ - though I have not checked to see how important an ordering on free modules is.

(b) use a pair of calls to `.is_submodule()` to test equality.

I don't plan to pursue this one much further, but could review a fix.


---

Comment by sbrandhorst created at 2017-10-06 12:21:17

Be aware of #23978 Rich comparison for Modules


---

Comment by sbrandhorst created at 2018-02-19 07:30:57


```
sage: sage: R = PolynomialRing(QQ, 'a')
....: sage: x = vector(R, [1, 0])
....: sage: y = vector(R, [0, 1])
....: sage: z = vector(R, [0,-1])
....: sage: A = (R^2).span([x, y])
....: sage: B = (R^2).span([x, z])
....: sage: A == B
....: 
True
sage: A.is_submodule(B)
True
sage: B.is_submodule(A)
True
```

Looks fixed to me.
Close?


---

Comment by sbrandhorst created at 2018-02-19 07:31:20

Changing status from new to needs_review.


---

Comment by chapoton created at 2018-04-07 15:50:26

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2018-04-07 15:50:26

let us close


---

Comment by vdelecroix created at 2018-05-18 17:16:26

closing positively reviewed duplicates


---

Comment by vdelecroix created at 2018-05-18 17:16:26

Resolution: wontfix
