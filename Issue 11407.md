# Issue 11407: Free module equality, comparisons

archive/issues_011407.json:
```json
{
    "body": "Assignee: jason, was\n\nCC:  fwclarke\n\nOn #11553, mmarco gives an example that can be distilled to:\n\n```\nsage: R = PolynomialRing(QQ, 'a')\nsage: x = vector(R, [1, 0])\nsage: y = vector(R, [0, 1])\nsage: z = vector(R, [0,-1])\nsage: A = (R^2).span([x, y])\nsage: B = (R^2).span([x, z])\nsage: A == B\nFalse\nsage: A.is_submodule(B)\nTrue\nsage: B.is_submodule(A)\nTrue\n```\n\nRoot cause looks like an assumption that echelon form (Hermite form) over PIDs is unique, which may be insurmountable in general.\n\n```\nsage: S = matrix([x, y])\nsage: S._echelon_form_PID()[1]\n[1 0]\n[0 1]\nsage: T = matrix([x, z])\nsage: T._echelon_form_PID()[1]\n[ 1  0]\n[ 0 -1]\n```\n\nThis also affects the ordering of free modules via the `__cmp__` method.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11579\n\n",
    "created_at": "2011-07-06T16:39:28Z",
    "labels": [
        "component: linear algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Free module equality, comparisons",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11407",
    "user": "https://github.com/rbeezer"
}
```
Assignee: jason, was

CC:  fwclarke

On #11553, mmarco gives an example that can be distilled to:

```
sage: R = PolynomialRing(QQ, 'a')
sage: x = vector(R, [1, 0])
sage: y = vector(R, [0, 1])
sage: z = vector(R, [0,-1])
sage: A = (R^2).span([x, y])
sage: B = (R^2).span([x, z])
sage: A == B
False
sage: A.is_submodule(B)
True
sage: B.is_submodule(A)
True
```

Root cause looks like an assumption that echelon form (Hermite form) over PIDs is unique, which may be insurmountable in general.

```
sage: S = matrix([x, y])
sage: S._echelon_form_PID()[1]
[1 0]
[0 1]
sage: T = matrix([x, z])
sage: T._echelon_form_PID()[1]
[ 1  0]
[ 0 -1]
```

This also affects the ordering of free modules via the `__cmp__` method.

Issue created by migration from https://trac.sagemath.org/ticket/11579





---

archive/issue_comments_126732.json:
```json
{
    "body": "One suggestion for a fix:\n\n(a) make comparisons raise a NotImplementedError for rings that are not fields and not ZZ - though I have not checked to see how important an ordering on free modules is.\n\n(b) use a pair of calls to `.is_submodule()` to test equality.\n\nI don't plan to pursue this one much further, but could review a fix.",
    "created_at": "2011-07-06T16:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11407#issuecomment-126732",
    "user": "https://github.com/rbeezer"
}
```

One suggestion for a fix:

(a) make comparisons raise a NotImplementedError for rings that are not fields and not ZZ - though I have not checked to see how important an ordering on free modules is.

(b) use a pair of calls to `.is_submodule()` to test equality.

I don't plan to pursue this one much further, but could review a fix.



---

archive/issue_events_030368.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11407#event-30368"
}
```



---

archive/issue_events_030369.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11407#event-30369"
}
```



---

archive/issue_events_030370.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11407#event-30370"
}
```



---

archive/issue_events_030371.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11407#event-30371"
}
```



---

archive/issue_events_030372.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11407#event-30372"
}
```



---

archive/issue_events_030373.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11407#event-30373"
}
```



---

archive/issue_events_030374.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11407#event-30374"
}
```



---

archive/issue_comments_126733.json:
```json
{
    "body": "Be aware of #23978 Rich comparison for Modules",
    "created_at": "2017-10-06T12:21:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11407#issuecomment-126733",
    "user": "https://github.com/simonbrandhorst"
}
```

Be aware of #23978 Rich comparison for Modules



---

archive/issue_comments_126734.json:
```json
{
    "body": "```\nsage: sage: R = PolynomialRing(QQ, 'a')\n....: sage: x = vector(R, [1, 0])\n....: sage: y = vector(R, [0, 1])\n....: sage: z = vector(R, [0,-1])\n....: sage: A = (R^2).span([x, y])\n....: sage: B = (R^2).span([x, z])\n....: sage: A == B\n....: \nTrue\nsage: A.is_submodule(B)\nTrue\nsage: B.is_submodule(A)\nTrue\n```\nLooks fixed to me.\nClose?",
    "created_at": "2018-02-19T07:30:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11407#issuecomment-126734",
    "user": "https://github.com/simonbrandhorst"
}
```

```
sage: sage: R = PolynomialRing(QQ, 'a')
....: sage: x = vector(R, [1, 0])
....: sage: y = vector(R, [0, 1])
....: sage: z = vector(R, [0,-1])
....: sage: A = (R^2).span([x, y])
....: sage: B = (R^2).span([x, z])
....: sage: A == B
....: 
True
sage: A.is_submodule(B)
True
sage: B.is_submodule(A)
True
```
Looks fixed to me.
Close?



---

archive/issue_comments_126735.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-02-19T07:31:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11407#issuecomment-126735",
    "user": "https://github.com/simonbrandhorst"
}
```

Changing status from new to needs_review.



---

archive/issue_events_030375.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2018-03-20T11:00:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11407#event-30375"
}
```



---

archive/issue_events_030376.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2018-03-20T11:00:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11407#event-30376"
}
```



---

archive/issue_comments_126736.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-04-07T15:50:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11407#issuecomment-126736",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_126737.json:
```json
{
    "body": "let us close",
    "created_at": "2018-04-07T15:50:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11407#issuecomment-126737",
    "user": "https://github.com/fchapoton"
}
```

let us close



---

archive/issue_events_030377.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-04-07T15:50:26Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11407#event-30377"
}
```



---

archive/issue_events_030378.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-04-07T15:50:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11407#event-30378"
}
```



---

archive/issue_comments_126738.json:
```json
{
    "body": "closing positively reviewed duplicates",
    "created_at": "2018-05-18T17:16:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11407#issuecomment-126738",
    "user": "https://github.com/videlec"
}
```

closing positively reviewed duplicates



---

archive/issue_comments_126739.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2018-05-18T17:16:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11407#issuecomment-126739",
    "user": "https://github.com/videlec"
}
```

Resolution: wontfix



---

archive/issue_events_030379.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-05-18T17:16:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11407",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11407#event-30379"
}
```
