# Issue 20811: Graph plotting: vertex colors

Issue created by migration from https://trac.sagemath.org/ticket/21048

Original creator: jmantysalo

Original creation time: 2016-07-18 11:41:15

CC:  paulmasson krcisman tscrim

This is a first part of #13827.

Currently setting a color for one vertex will change default pink to blue in other vertices. This patch will correct it. Also we make it possible to set a default color with `vertex_color` and have some vertices colored differently with `vertex_colors`. To test try for example


```
sage: g=graphs.PetersenGraph()
sage: g.show()
sage: g.show(vertex_color='green')
sage: g.show(vertex_colors={'red': [0,1], 'blue': [3,4]})
sage: g.show(vertex_color='green', vertex_colors={'red': [0,1], 'blue': [3,4]})
sage: g.show(vertex_colors='green')
```




---

Comment by jmantysalo created at 2016-07-18 11:44:36

On a way to more customizable graph plotting.
----
New commits:


---

Comment by jmantysalo created at 2016-07-18 11:44:36

Changing status from new to needs_review.


---

Comment by paulmasson created at 2016-07-19 03:34:30

Doctests pass. Documentation builds. Example runs as expected.

It looks like you took out some default rainbow coloring in the code. Since this is a part of Sage I'm unlikely to use much, I would like to understand the impact this will have on other users. While it's certainly better to have more control over the coloring, how many people are likely to complain if the rainbow coloring is gone?


---

Comment by jmantysalo created at 2016-07-19 06:48:41

Replying to [comment:3 paulmasson]:

> It looks like you took out some default rainbow coloring in the code.

I was not able to run that part of code. It seems to refer `partition`-option. However, currently


```
g = graphs.PetersenGraph()
g.show(partition=[[1,2],[3,4]])
```


have same problem of changing default color for non-listed vertices. With this patch they will stay pink, and also you can say


```
g.show(partition=[[1,2],[3,4]], vertex_color='gray')
```



---

Comment by jmantysalo created at 2016-07-19 07:13:41

Sidenote, there was also a plain error in documentation: "If a vertex is not listed, it looks invisible on the resulting plot (it does not get drawn)." was not true, and is not after this patch.


---

Comment by paulmasson created at 2016-07-19 19:49:50

The current code doesn't appear to have a default color. Nonlisted vertices are given a random color, not a default color. This ticket modifies that behavior.

If that is a good idea then I'm fine with it, but I would rather have some additional input. Nathann Cohen wrote the original coloring code in 2009, so I'd like to hear from him or interested others on this change.


---

Comment by jmantysalo created at 2016-07-20 01:06:01

Replying to [comment:6 paulmasson]:
> The current code doesn't appear to have a default color. Nonlisted vertices are given a random color, not a default color.

Kind of, but always same color. Setting a color of one vertex to blue or green make others red, setting a color to red make others light blue etc.

> If that is a good idea then I'm fine with it, but I would rather have some additional input. Nathann Cohen wrote the original coloring code in 2009, so I'd like to hear from him or interested others on this change.

Me too, but Nathann faded from developers some time ago. `:=(` See for example https://groups.google.com/forum/#!topic/sage-devel/-Z5kXJv6ZQA


---

Comment by paulmasson created at 2016-07-20 01:59:20

Jori, I started reading sage-devel some time after that thread, so thanks for sharing. I've seen some other comments since then about the same topic but didn't realize it was such an issue. I've removed him from this ticket.

I'd like to wait a couple days to see if Karl-Dieter or Travis want to chime in. If we don't hear from them soon then I'll set positive review. I certainly don't want to deter an active developer!


---

Comment by tscrim created at 2016-07-20 03:02:25

I don't have a real preference for this because I never really use it. If you want additional input, you're probably best posting to sage-devel.


---

Comment by paulmasson created at 2016-07-21 21:27:21

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-07-22 18:16:53

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2016-07-22 18:16:53


```
sage -t --long src/sage/combinat/words/finite_word.py
**********************************************************************
File "src/sage/combinat/words/finite_word.py", line 116, in sage.combinat.words.finite_word
Failed example:
    st.show(word_labels=True)
Expected nothing
Got:
    doctest:270: DeprecationWarning: Use of vertex_colors=<string> is deprecated, use vertex_color=<string> and/or vertex_colors=<dict>.
    See http://trac.sagemath.org/21048 for details.
**********************************************************************
1 item had failures:
   1 of  56 in sage.combinat.words.finite_word
    [1244 tests, 1 failure, 11.63 s]
sage -t --long src/sage/combinat/words/suffix_trees.py
**********************************************************************
File "src/sage/combinat/words/suffix_trees.py", line 867, in sage.combinat.words.suffix_trees.ImplicitSuffixTree.?
Failed example:
    ImplicitSuffixTree(Word('cacao')).plot(word_labels=True)
Expected:
    Graphics object consisting of 23 graphics primitives
Got:
    doctest:270: DeprecationWarning: Use of vertex_colors=<string> is deprecated, use vertex_color=<string> and/or vertex_colors=<dict>.
    See http://trac.sagemath.org/21048 for details.
    Graphics object consisting of 23 graphics primitives
**********************************************************************
1 item had failures:
   1 of   7 in sage.combinat.words.suffix_trees.ImplicitSuffixTree.?
    [245 tests, 1 failure, 3.03 s]
```



---

Comment by git created at 2016-07-23 08:05:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2016-07-23 08:08:21

Changing status from needs_work to needs_review.


---

Comment by jmantysalo created at 2016-07-23 08:08:21

Badly corrected, but at least works. I guess words- and posets-directories should be checked when graph plotting is ready.


---

Comment by paulmasson created at 2016-07-23 20:20:00

`vertex_colors` is defined as a dicitionary in `suffix_trees.py` as it should be, so the changes you made aren't the best. The problem is the misspelling `veretex_colors` on line 885. Please revert the changes you just made and correct that spelling. I've already tested this and it solves both doctest failures.


---

Comment by git created at 2016-07-24 06:14:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-07-24 06:26:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2016-07-24 06:39:37

I was blind.


---

Comment by paulmasson created at 2016-07-24 19:56:47

Changing status from needs_review to positive_review.


---

Comment by paulmasson created at 2016-07-24 19:56:47

All doctests pass in `combinat/words` and `combinat/posets`


---

Comment by vbraun created at 2016-07-25 20:13:16

Resolution: fixed
