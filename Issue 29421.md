# Issue 29421: Update to BRiAl 1.2.8

archive/issues_029421.json:
```json
{
    "body": "CC:  @antonio-rojas @kiwifb @orlitzky\n\nBRiAl 1.2.8 fixes some Python 3 issues present in the current version in Sage.\n\nIssue created by migration from https://trac.sagemath.org/ticket/29658\n\n",
    "created_at": "2020-05-07T01:52:26Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Update to BRiAl 1.2.8",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29421",
    "user": "https://github.com/jhpalmieri"
}
```
CC:  @antonio-rojas @kiwifb @orlitzky

BRiAl 1.2.8 fixes some Python 3 issues present in the current version in Sage.

Issue created by migration from https://trac.sagemath.org/ticket/29658





---

archive/issue_comments_416932.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-05-07T01:54:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29421#issuecomment-416932",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_416933.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-05-07T01:54:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29421#issuecomment-416933",
    "user": "https://github.com/jhpalmieri"
}
```

New commits:



---

archive/issue_comments_416934.json:
```json
{
    "body": "It is a trivial bump, and I should know, I am one the one doing the releases.",
    "created_at": "2020-05-07T01:57:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29421#issuecomment-416934",
    "user": "https://github.com/kiwifb"
}
```

It is a trivial bump, and I should know, I am one the one doing the releases.



---

archive/issue_comments_416935.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-05-07T01:57:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29421#issuecomment-416935",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_416936.json:
```json
{
    "body": "Thanks. Maybe you should be the author and I should be the reviewer. ;)",
    "created_at": "2020-05-07T01:59:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29421#issuecomment-416936",
    "user": "https://github.com/jhpalmieri"
}
```

Thanks. Maybe you should be the author and I should be the reviewer. ;)



---

archive/issue_comments_416937.json:
```json
{
    "body": "Shouldn't sage_brial be updated at the same time?",
    "created_at": "2020-05-07T02:18:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29421#issuecomment-416937",
    "user": "https://github.com/mkoeppe"
}
```

Shouldn't sage_brial be updated at the same time?



---

archive/issue_comments_416938.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2020-05-07T02:19:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29421#issuecomment-416938",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_416939.json:
```json
{
    "body": "We share the tarball so yes. Plus John explicitly mention python stuff, that's in sage_brial. I should pay more attention to the fact that the package has been split in vanilla sage too.",
    "created_at": "2020-05-07T02:22:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29421#issuecomment-416939",
    "user": "https://github.com/kiwifb"
}
```

We share the tarball so yes. Plus John explicitly mention python stuff, that's in sage_brial. I should pay more attention to the fact that the package has been split in vanilla sage too.



---

archive/issue_comments_416940.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-05-07T03:15:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29421#issuecomment-416940",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_416941.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2020-05-07T03:17:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29421#issuecomment-416941",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_416942.json:
```json
{
    "body": "Okay, this updates sage_brial also.",
    "created_at": "2020-05-07T03:17:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29421#issuecomment-416942",
    "user": "https://github.com/jhpalmieri"
}
```

Okay, this updates sage_brial also.



---

archive/issue_comments_416943.json:
```json
{
    "body": "By the way, to update sage_brial, I updated the version number in `package_version.txt` and ran `sage --package fix-checksum`, and was told\n\n```\nUpdating checksum of brial-1.2.8.tar.bz2\n```\n\nShould it use the package name instead of the tarball name, or perhaps both? I find it a little misleading.",
    "created_at": "2020-05-07T03:19:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29421#issuecomment-416943",
    "user": "https://github.com/jhpalmieri"
}
```

By the way, to update sage_brial, I updated the version number in `package_version.txt` and ran `sage --package fix-checksum`, and was told

```
Updating checksum of brial-1.2.8.tar.bz2
```

Should it use the package name instead of the tarball name, or perhaps both? I find it a little misleading.



---

archive/issue_comments_416944.json:
```json
{
    "body": "Replying to [comment:10 jhpalmieri]:\n> By the way, to update sage_brial, I updated the version number in `package_version.txt` and ran `sage --package fix-checksum`, and was told\n> {{{\n> Updating checksum of brial-1.2.8.tar.bz2\n> }}}\n> Should it use the package name instead of the tarball name, or perhaps both? I find it a little misleading.\n\nWell, it is updating what it sees in `checksum.ini` which is `brial` in this case. If we want say the \"package name\" corresponding to the tarball that's some extra code for `fix-checksum`.\n\nAnd I am not touching sage's own packaging system anymore.",
    "created_at": "2020-05-07T03:23:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29421#issuecomment-416944",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:10 jhpalmieri]:
> By the way, to update sage_brial, I updated the version number in `package_version.txt` and ran `sage --package fix-checksum`, and was told
> {{{
> Updating checksum of brial-1.2.8.tar.bz2
> }}}
> Should it use the package name instead of the tarball name, or perhaps both? I find it a little misleading.

Well, it is updating what it sees in `checksum.ini` which is `brial` in this case. If we want say the "package name" corresponding to the tarball that's some extra code for `fix-checksum`.

And I am not touching sage's own packaging system anymore.



---

archive/issue_comments_416945.json:
```json
{
    "body": "I propose (for another ticket):\n\n```diff\ndiff --git a/build/sage_bootstrap/app.py b/build/sage_bootstrap/app.py\nindex 45818546a1..6405527e4d 100644\n--- a/build/sage_bootstrap/app.py\n+++ b/build/sage_bootstrap/app.py\n@@ -134,13 +134,13 @@ class Application(object):\n         \"\"\"\n         for pkg in Package.all():\n             if not os.path.exists(pkg.tarball.upstream_fqn):\n-                log.debug('Ignoring {0} because tarball is not cached'.format(pkg.tarball_filename))\n+                log.debug('Ignoring {0} because tarball is not cached'.format(pkg.name))\n                 continue\n             if pkg.tarball.checksum_verifies():\n-                log.debug('Checksum of {0} unchanged'.format(pkg.tarball_filename))\n+                log.debug('Checksum of {0} unchanged'.format(pkg.name))\n                 continue\n             update = ChecksumUpdater(pkg.name)\n-            print('Updating checksum of {0}'.format(pkg.tarball_filename))\n+            print('Updating checksum of {0} (tarball {1})'.format(pkg.name, pkg.tarball_filename))\n             update.fix_checksum()\n \n     def fix_checksum(self, package_name):\n@@ -154,9 +154,9 @@ class Application(object):\n         update = ChecksumUpdater(package_name)\n         pkg = update.package\n         if pkg.tarball.checksum_verifies():\n-            print('Checksum of {0} unchanged'.format(pkg.tarball_filename))\n+            print('Checksum of {0} unchanged'.format(package_name))\n         else:\n-            print('Updating checksum of {0}'.format(pkg.tarball_filename))\n+            print('Updating checksum of {0} (tarball {1})'.format(package_name, pkg.tarball_filename))\n             update.fix_checksum()\n         \n     def create(self, package_name, version, tarball, pkg_type, upstream_url):\n```\n",
    "created_at": "2020-05-07T03:23:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29421#issuecomment-416945",
    "user": "https://github.com/jhpalmieri"
}
```

I propose (for another ticket):

```diff
diff --git a/build/sage_bootstrap/app.py b/build/sage_bootstrap/app.py
index 45818546a1..6405527e4d 100644
--- a/build/sage_bootstrap/app.py
+++ b/build/sage_bootstrap/app.py
@@ -134,13 +134,13 @@ class Application(object):
         """
         for pkg in Package.all():
             if not os.path.exists(pkg.tarball.upstream_fqn):
-                log.debug('Ignoring {0} because tarball is not cached'.format(pkg.tarball_filename))
+                log.debug('Ignoring {0} because tarball is not cached'.format(pkg.name))
                 continue
             if pkg.tarball.checksum_verifies():
-                log.debug('Checksum of {0} unchanged'.format(pkg.tarball_filename))
+                log.debug('Checksum of {0} unchanged'.format(pkg.name))
                 continue
             update = ChecksumUpdater(pkg.name)
-            print('Updating checksum of {0}'.format(pkg.tarball_filename))
+            print('Updating checksum of {0} (tarball {1})'.format(pkg.name, pkg.tarball_filename))
             update.fix_checksum()
 
     def fix_checksum(self, package_name):
@@ -154,9 +154,9 @@ class Application(object):
         update = ChecksumUpdater(package_name)
         pkg = update.package
         if pkg.tarball.checksum_verifies():
-            print('Checksum of {0} unchanged'.format(pkg.tarball_filename))
+            print('Checksum of {0} unchanged'.format(package_name))
         else:
-            print('Updating checksum of {0}'.format(pkg.tarball_filename))
+            print('Updating checksum of {0} (tarball {1})'.format(package_name, pkg.tarball_filename))
             update.fix_checksum()
         
     def create(self, package_name, version, tarball, pkg_type, upstream_url):
```




---

archive/issue_comments_416946.json:
```json
{
    "body": "Sample output:\n\n```\n% ./sage --package fix-checksum sage_brial\nUpdating checksum of sage_brial (tarball brial-1.2.8.tar.bz2)\n% ./sage --package fix-checksum sage_brial\nChecksum of sage_brial unchanged\n```\n",
    "created_at": "2020-05-07T03:24:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29421#issuecomment-416946",
    "user": "https://github.com/jhpalmieri"
}
```

Sample output:

```
% ./sage --package fix-checksum sage_brial
Updating checksum of sage_brial (tarball brial-1.2.8.tar.bz2)
% ./sage --package fix-checksum sage_brial
Checksum of sage_brial unchanged
```




---

archive/issue_comments_416947.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-05-07T03:25:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29421#issuecomment-416947",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_416948.json:
```json
{
    "body": "Otherwise, I cannot see anything else holding this ticket. Feel free to say I am wrong.",
    "created_at": "2020-05-07T03:25:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29421#issuecomment-416948",
    "user": "https://github.com/kiwifb"
}
```

Otherwise, I cannot see anything else holding this ticket. Feel free to say I am wrong.



---

archive/issue_events_075829.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-06-03T22:32:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29421#event-75829"
}
```



---

archive/issue_comments_416949.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-06-03T22:32:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29421#issuecomment-416949",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
