# Issue 32759: ./configure --disable-doc

archive/issues_032522.json:
```json
{
    "body": "This switch will disable the docbuild and avoid installing its many dependencies (sphinx...).\n\nIn contrast to other packages, `pplpy`'s docbuild is enabled unless explicitly disabled by setting `SAGE_SPKG_INSTALL_DOCS=no`. We move it to a separate package `pplpy_doc` and make it a dependency of `sagemath_doc_html`.\n\nSplit out from #31396.\n\nWe also add `argon2_cffi` and `nbclient` to the packages disabled upon `--disable-notebook`.\n\n\nDepends on #29039\n\n**CC:**  @tobiasdiez @dimpase @jhpalmieri tmonteil\n\n**Branch/Commit:** [43221d0e3dca1c33687d5073e1f1d7a446eed976](https://github.com/sagemath/sagetrac-mirror/commit/43221d0e3dca1c33687d5073e1f1d7a446eed976)\n\n**Reviewer:** John Palmieri, Matthias Koeppe\n\n**Author:** Matthias Koeppe, John Palmieri\n\nIssue created by migration from https://trac.sagemath.org/ticket/32759\n\n",
    "closed_at": "2022-01-09T10:47:16Z",
    "created_at": "2021-10-24T22:45:48Z",
    "labels": [
        "component: build: configure",
        "blocker",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "title": "./configure --disable-doc",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/32759",
    "user": "https://github.com/mkoeppe"
}
```
This switch will disable the docbuild and avoid installing its many dependencies (sphinx...).

In contrast to other packages, `pplpy`'s docbuild is enabled unless explicitly disabled by setting `SAGE_SPKG_INSTALL_DOCS=no`. We move it to a separate package `pplpy_doc` and make it a dependency of `sagemath_doc_html`.

Split out from #31396.

We also add `argon2_cffi` and `nbclient` to the packages disabled upon `--disable-notebook`.


Depends on #29039

**CC:**  @tobiasdiez @dimpase @jhpalmieri tmonteil

**Branch/Commit:** [43221d0e3dca1c33687d5073e1f1d7a446eed976](https://github.com/sagemath/sagetrac-mirror/commit/43221d0e3dca1c33687d5073e1f1d7a446eed976)

**Reviewer:** John Palmieri, Matthias Koeppe

**Author:** Matthias Koeppe, John Palmieri

Issue created by migration from https://trac.sagemath.org/ticket/32759





---

archive/issue_comments_531355.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/__configure___disable_doc](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/__configure___disable_doc)",
    "created_at": "2021-10-24T23:08:58Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531355",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/__configure___disable_doc](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/__configure___disable_doc)



---

archive/issue_comments_531356.json:
```json
{
    "body": "**Commit:** [18b4055a0f5fce7a4c027f4db859b4faa522d432](https://github.com/sagemath/sagetrac-mirror/commit/18b4055a0f5fce7a4c027f4db859b4faa522d432)",
    "created_at": "2021-10-25T00:28:34Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531356",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [18b4055a0f5fce7a4c027f4db859b4faa522d432](https://github.com/sagemath/sagetrac-mirror/commit/18b4055a0f5fce7a4c027f4db859b4faa522d432)



---

archive/issue_comments_531357.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/97b9fcf4ca074fc8135ff49780bd55667675a638\">97b9fcf</a></td><td><code>configure.ac (--disable-doc): Disable also 'requests' and its dependencies, and direct sphinx dependencies</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/18b4055a0f5fce7a4c027f4db859b4faa522d432\">18b4055</a></td><td><code>build/pkgs/pplpy/dependencies: Depend on sphinx only if SAGE_SPKG_INSTALL_DOCS!=no</code></td></tr></table>\n",
    "created_at": "2021-10-25T00:28:34Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531357",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/97b9fcf4ca074fc8135ff49780bd55667675a638">97b9fcf</a></td><td><code>configure.ac (--disable-doc): Disable also 'requests' and its dependencies, and direct sphinx dependencies</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/18b4055a0f5fce7a4c027f4db859b4faa522d432">18b4055</a></td><td><code>build/pkgs/pplpy/dependencies: Depend on sphinx only if SAGE_SPKG_INSTALL_DOCS!=no</code></td></tr></table>




---

archive/issue_comments_531358.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,7 @@\n This switch will disable the docbuild and installation of its many dependencies (sphinx...)\n+\n+In contrast to other packages, `ppl`'s docbuild is enabled unless explicitly disabled by setting `SAGE_SPKG_INSTALL_DOCS=no`.\n+We conditionalize the dependency of `ppl` on this and also on `sphinx` being in the list of installed packages.\n \n Split out from #31396.\n \n``````\n",
    "created_at": "2021-10-25T01:39:37Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531358",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,7 @@
 This switch will disable the docbuild and installation of its many dependencies (sphinx...)
+
+In contrast to other packages, `ppl`'s docbuild is enabled unless explicitly disabled by setting `SAGE_SPKG_INSTALL_DOCS=no`.
+We conditionalize the dependency of `ppl` on this and also on `sphinx` being in the list of installed packages.
 
 Split out from #31396.
 
``````




---

archive/issue_comments_531359.json:
```json
{
    "body": "**Changing commit** from \"[18b4055a0f5fce7a4c027f4db859b4faa522d432](https://github.com/sagemath/sagetrac-mirror/commit/18b4055a0f5fce7a4c027f4db859b4faa522d432)\" to \"[dfd23fbd45fd4cbb9307925256819dc7cbdb350f](https://github.com/sagemath/sagetrac-mirror/commit/dfd23fbd45fd4cbb9307925256819dc7cbdb350f)\".",
    "created_at": "2021-10-25T01:56:00Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531359",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[18b4055a0f5fce7a4c027f4db859b4faa522d432](https://github.com/sagemath/sagetrac-mirror/commit/18b4055a0f5fce7a4c027f4db859b4faa522d432)" to "[dfd23fbd45fd4cbb9307925256819dc7cbdb350f](https://github.com/sagemath/sagetrac-mirror/commit/dfd23fbd45fd4cbb9307925256819dc7cbdb350f)".



---

archive/issue_comments_531360.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dfd23fbd45fd4cbb9307925256819dc7cbdb350f\">dfd23fb</a></td><td><code>build/pkgs/pplpy/dependencies: Fix up SAGE_SPKG_INSTALL_DOCS logic</code></td></tr></table>\n",
    "created_at": "2021-10-25T01:56:00Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531360",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dfd23fbd45fd4cbb9307925256819dc7cbdb350f">dfd23fb</a></td><td><code>build/pkgs/pplpy/dependencies: Fix up SAGE_SPKG_INSTALL_DOCS logic</code></td></tr></table>




---

archive/issue_comments_531361.json:
```json
{
    "body": "**Author:** Matthias Koeppe",
    "created_at": "2021-10-25T01:56:47Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531361",
    "user": "https://github.com/mkoeppe"
}
```

**Author:** Matthias Koeppe



---

archive/issue_events_293968.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-25T01:56:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293968"
}
```



---

archive/issue_comments_531362.json:
```json
{
    "body": "**Changing commit** from \"[dfd23fbd45fd4cbb9307925256819dc7cbdb350f](https://github.com/sagemath/sagetrac-mirror/commit/dfd23fbd45fd4cbb9307925256819dc7cbdb350f)\" to \"[7307c7515f6d001a46fd709b4a09c1e0e5a03d93](https://github.com/sagemath/sagetrac-mirror/commit/7307c7515f6d001a46fd709b4a09c1e0e5a03d93)\".",
    "created_at": "2021-10-25T02:37:41Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531362",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[dfd23fbd45fd4cbb9307925256819dc7cbdb350f](https://github.com/sagemath/sagetrac-mirror/commit/dfd23fbd45fd4cbb9307925256819dc7cbdb350f)" to "[7307c7515f6d001a46fd709b4a09c1e0e5a03d93](https://github.com/sagemath/sagetrac-mirror/commit/7307c7515f6d001a46fd709b4a09c1e0e5a03d93)".



---

archive/issue_comments_531363.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7307c7515f6d001a46fd709b4a09c1e0e5a03d93\">7307c75</a></td><td><code>configure.ac (--disabled-notebook): Also disable nbclient</code></td></tr></table>\n",
    "created_at": "2021-10-25T02:37:41Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531363",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7307c7515f6d001a46fd709b4a09c1e0e5a03d93">7307c75</a></td><td><code>configure.ac (--disabled-notebook): Also disable nbclient</code></td></tr></table>




---

archive/issue_comments_531364.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,3 +5,5 @@\n \n Split out from #31396.\n \n+We also add another package to those that are disabled upon `--disable-notebook`.\n+\n``````\n",
    "created_at": "2021-10-25T02:38:26Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531364",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,3 +5,5 @@
 
 Split out from #31396.
 
+We also add another package to those that are disabled upon `--disable-notebook`.
+
``````




---

archive/issue_comments_531365.json:
```json
{
    "body": "<a id='comment:9'></a>\nIf `--disable-doc` is given, then should `doc` be removed from the `all-start` target, so that `make` doesn't try to build the docs?",
    "created_at": "2021-10-29T23:18:18Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531365",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>
If `--disable-doc` is given, then should `doc` be removed from the `all-start` target, so that `make` doesn't try to build the docs?



---

archive/issue_comments_531366.json:
```json
{
    "body": "<a id='comment:10'></a>\nAlso, after I used `./configure --disable-doc`, packages like `alabaster` and `sphinxcontrib-...` were built anyway.",
    "created_at": "2021-10-29T23:27:13Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531366",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:10'></a>
Also, after I used `./configure --disable-doc`, packages like `alabaster` and `sphinxcontrib-...` were built anyway.



---

archive/issue_comments_531367.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [jhpalmieri](#comment%3A9):\n> If `--disable-doc` is given, then should `doc` be removed from the `all-start` target, so that `make` doesn't try to build the docs?\n\n\nYes, that's a good idea.",
    "created_at": "2021-10-29T23:27:56Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531367",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
Replying to [jhpalmieri](#comment%3A9):
> If `--disable-doc` is given, then should `doc` be removed from the `all-start` target, so that `make` doesn't try to build the docs?


Yes, that's a good idea.



---

archive/issue_comments_531368.json:
```json
{
    "body": "<a id='comment:12'></a>\n`config.log` says (for example)\n\n```\nconfigure:45112: result: sphinx-4.2.0:                                standard, but disabled using configure option\n```\nbut maybe the problem is that I ran `make` instead of `make build`?",
    "created_at": "2021-10-29T23:31:02Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531368",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:12'></a>
`config.log` says (for example)

```
configure:45112: result: sphinx-4.2.0:                                standard, but disabled using configure option
```
but maybe the problem is that I ran `make` instead of `make build`?



---

archive/issue_comments_531369.json:
```json
{
    "body": "<a id='comment:13'></a>\nYes, probably the `all-start` target pulled in the doc dependencies.",
    "created_at": "2021-10-29T23:50:14Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531369",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>
Yes, probably the `all-start` target pulled in the doc dependencies.



---

archive/issue_comments_531370.json:
```json
{
    "body": "**Changing commit** from \"[7307c7515f6d001a46fd709b4a09c1e0e5a03d93](https://github.com/sagemath/sagetrac-mirror/commit/7307c7515f6d001a46fd709b4a09c1e0e5a03d93)\" to \"[128de23f9262ed5bd417fba5310d7c11e4a362c1](https://github.com/sagemath/sagetrac-mirror/commit/128de23f9262ed5bd417fba5310d7c11e4a362c1)\".",
    "created_at": "2021-11-09T01:28:29Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531370",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7307c7515f6d001a46fd709b4a09c1e0e5a03d93](https://github.com/sagemath/sagetrac-mirror/commit/7307c7515f6d001a46fd709b4a09c1e0e5a03d93)" to "[128de23f9262ed5bd417fba5310d7c11e4a362c1](https://github.com/sagemath/sagetrac-mirror/commit/128de23f9262ed5bd417fba5310d7c11e4a362c1)".



---

archive/issue_comments_531371.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d13b8aef2200f2101dd02f8becb69a094d938767\">d13b8ae</a></td><td><code>configure.ac (--disable-doc): Disable also 'requests' and its dependencies, and direct sphinx dependencies</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4121cb07b4d787c551e6a7811cb17893cd03fe0c\">4121cb0</a></td><td><code>build/pkgs/pplpy/dependencies: Depend on sphinx only if SAGE_SPKG_INSTALL_DOCS!=no</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ca1189e228794cbcd4e2ae3b52278ef935dc86e\">8ca1189</a></td><td><code>build/pkgs/pplpy/dependencies: Fix up SAGE_SPKG_INSTALL_DOCS logic</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ccf6fb548e817105e8f70de3e76d5860e1ed6f5f\">ccf6fb5</a></td><td><code>configure.ac (--disabled-notebook): Also disable nbclient</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8e26780afcbe40662f27b96b7dbd563843d08452\">8e26780</a></td><td><code>build/pkgs/sagemath_doc_{html,pdf}: New; delegate to them from targets doc-html etc.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eeb8777b0c31bbf15f0d97171c3eccce119cffac\">eeb8777</a></td><td><code>m4/sage_spkg_collect.m4: Determine install tree for python3 via new trees.txt mechanism</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c8e19a07dd6039be28f17e67e9fd2e693f14a52b\">c8e19a0</a></td><td><code>fixup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5a4424b3fa0c546bc05aef5320429749f1b143e9\">5a4424b</a></td><td><code>build/make/Makefile.in (all-sage): Do not include packages installed in SAGE_DOCS</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/67714b849044f1391a3f6e8ab8dfd27ead133177\">67714b8</a></td><td><code>Merge #31356</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/128de23f9262ed5bd417fba5310d7c11e4a362c1\">128de23</a></td><td><code>configure.ac (--disable-doc): Disable the actual docbuild on 'make'</code></td></tr></table>\n",
    "created_at": "2021-11-09T01:28:29Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531371",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d13b8aef2200f2101dd02f8becb69a094d938767">d13b8ae</a></td><td><code>configure.ac (--disable-doc): Disable also 'requests' and its dependencies, and direct sphinx dependencies</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4121cb07b4d787c551e6a7811cb17893cd03fe0c">4121cb0</a></td><td><code>build/pkgs/pplpy/dependencies: Depend on sphinx only if SAGE_SPKG_INSTALL_DOCS!=no</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ca1189e228794cbcd4e2ae3b52278ef935dc86e">8ca1189</a></td><td><code>build/pkgs/pplpy/dependencies: Fix up SAGE_SPKG_INSTALL_DOCS logic</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ccf6fb548e817105e8f70de3e76d5860e1ed6f5f">ccf6fb5</a></td><td><code>configure.ac (--disabled-notebook): Also disable nbclient</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8e26780afcbe40662f27b96b7dbd563843d08452">8e26780</a></td><td><code>build/pkgs/sagemath_doc_{html,pdf}: New; delegate to them from targets doc-html etc.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eeb8777b0c31bbf15f0d97171c3eccce119cffac">eeb8777</a></td><td><code>m4/sage_spkg_collect.m4: Determine install tree for python3 via new trees.txt mechanism</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c8e19a07dd6039be28f17e67e9fd2e693f14a52b">c8e19a0</a></td><td><code>fixup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5a4424b3fa0c546bc05aef5320429749f1b143e9">5a4424b</a></td><td><code>build/make/Makefile.in (all-sage): Do not include packages installed in SAGE_DOCS</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/67714b849044f1391a3f6e8ab8dfd27ead133177">67714b8</a></td><td><code>Merge #31356</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/128de23f9262ed5bd417fba5310d7c11e4a362c1">128de23</a></td><td><code>configure.ac (--disable-doc): Disable the actual docbuild on 'make'</code></td></tr></table>




---

archive/issue_comments_531372.json:
```json
{
    "body": "**Dependencies:** #31356",
    "created_at": "2021-11-09T01:28:55Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531372",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #31356



---

archive/issue_comments_531373.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [mkoeppe](#comment%3A11):\n> Replying to [jhpalmieri](#comment%3A9):\n> > If `--disable-doc` is given, then should `doc` be removed from the `all-start` target, so that `make` doesn't try to build the docs?\n\n> \n> Yes, that's a good idea.\n\n\nThis is implemented now, via #31356",
    "created_at": "2021-11-09T01:29:30Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531373",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>
Replying to [mkoeppe](#comment%3A11):
> Replying to [jhpalmieri](#comment%3A9):
> > If `--disable-doc` is given, then should `doc` be removed from the `all-start` target, so that `make` doesn't try to build the docs?

> 
> Yes, that's a good idea.


This is implemented now, via #31356



---

archive/issue_comments_531374.json:
```json
{
    "body": "**Changing commit** from \"[128de23f9262ed5bd417fba5310d7c11e4a362c1](https://github.com/sagemath/sagetrac-mirror/commit/128de23f9262ed5bd417fba5310d7c11e4a362c1)\" to \"[8a7027ac2067fba77fad02db3377e60df494a0b5](https://github.com/sagemath/sagetrac-mirror/commit/8a7027ac2067fba77fad02db3377e60df494a0b5)\".",
    "created_at": "2021-11-10T22:54:23Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531374",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[128de23f9262ed5bd417fba5310d7c11e4a362c1](https://github.com/sagemath/sagetrac-mirror/commit/128de23f9262ed5bd417fba5310d7c11e4a362c1)" to "[8a7027ac2067fba77fad02db3377e60df494a0b5](https://github.com/sagemath/sagetrac-mirror/commit/8a7027ac2067fba77fad02db3377e60df494a0b5)".



---

archive/issue_comments_531375.json:
```json
{
    "body": "<a id='comment:17'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eb65e034bad3ec82b19c90211ca5bf70533e8fe5\">eb65e03</a></td><td><code>build/pkgs/sagemath_doc_*/dependencies: Add sage_docbuild</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7989d8767056d68def98ee22116fbd24d7187d2f\">7989d87</a></td><td><code>src/doc/Makefile: Handle errors from './sage --docbuild --all-documents'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d64fb763d3f58e05954d576464a5c66cc1f5307f\">d64fb76</a></td><td><code>build/make/Makefile.in: Undo reintroduction of SAGE_SKIP_PLOT_DIRECTIVE, SAGE_DOC_MATHJAX settings</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6afc0d5535530f9f71538821ec07a7cb95d44d19\">6afc0d5</a></td><td><code>build/pkgs/sagemath_doc_html/spkg-install: Move handling of SAGE_DOC_JSMATH environment variable here from src/bin/sage-env</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b2cf40c2a9b023c2449dbf4186aeb369f604390a\">b2cf40c</a></td><td><code>build/make/Makefile.in: Undo reintroduction of SAGE_SKIP_PLOT_DIRECTIVE, SAGE_DOC_MATHJAX settings (fixup)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37a03bd94e1716af2926c30eddbaf6d38303f869\">37a03bd</a></td><td><code>src/doc/en/developer/packaging.rst: Fix up section label</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc89a6657450c0e10c8322615f1fced0f8ebb984\">fc89a66</a></td><td><code>build/pkgs/sagemath_doc_pdf/spkg-install: Set SAGE_DOC_MATHJAX as a workaround</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd298c4b7a6f845335b862f6dc2f8e18753937e7\">fd298c4</a></td><td><code>build/pkgs/sagemath_doc_pdf/dependencies: Depend on sagemath_doc_html</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b0593ea23446372b929104343b7ba44d95fb47a2\">b0593ea</a></td><td><code>Merge #31356</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a7027ac2067fba77fad02db3377e60df494a0b5\">8a7027a</a></td><td><code>configure.ac (--disable-doc): Disable the actual docbuild on 'make'</code></td></tr></table>\n",
    "created_at": "2021-11-10T22:54:23Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531375",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eb65e034bad3ec82b19c90211ca5bf70533e8fe5">eb65e03</a></td><td><code>build/pkgs/sagemath_doc_*/dependencies: Add sage_docbuild</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7989d8767056d68def98ee22116fbd24d7187d2f">7989d87</a></td><td><code>src/doc/Makefile: Handle errors from './sage --docbuild --all-documents'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d64fb763d3f58e05954d576464a5c66cc1f5307f">d64fb76</a></td><td><code>build/make/Makefile.in: Undo reintroduction of SAGE_SKIP_PLOT_DIRECTIVE, SAGE_DOC_MATHJAX settings</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6afc0d5535530f9f71538821ec07a7cb95d44d19">6afc0d5</a></td><td><code>build/pkgs/sagemath_doc_html/spkg-install: Move handling of SAGE_DOC_JSMATH environment variable here from src/bin/sage-env</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b2cf40c2a9b023c2449dbf4186aeb369f604390a">b2cf40c</a></td><td><code>build/make/Makefile.in: Undo reintroduction of SAGE_SKIP_PLOT_DIRECTIVE, SAGE_DOC_MATHJAX settings (fixup)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37a03bd94e1716af2926c30eddbaf6d38303f869">37a03bd</a></td><td><code>src/doc/en/developer/packaging.rst: Fix up section label</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc89a6657450c0e10c8322615f1fced0f8ebb984">fc89a66</a></td><td><code>build/pkgs/sagemath_doc_pdf/spkg-install: Set SAGE_DOC_MATHJAX as a workaround</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd298c4b7a6f845335b862f6dc2f8e18753937e7">fd298c4</a></td><td><code>build/pkgs/sagemath_doc_pdf/dependencies: Depend on sagemath_doc_html</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b0593ea23446372b929104343b7ba44d95fb47a2">b0593ea</a></td><td><code>Merge #31356</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a7027ac2067fba77fad02db3377e60df494a0b5">8a7027a</a></td><td><code>configure.ac (--disable-doc): Disable the actual docbuild on 'make'</code></td></tr></table>




---

archive/issue_comments_531376.json:
```json
{
    "body": "<a id='comment:18'></a>\nRebased on top of updated #31356",
    "created_at": "2021-11-10T22:54:39Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531376",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>
Rebased on top of updated #31356



---

archive/issue_comments_531377.json:
```json
{
    "body": "<a id='comment:19'></a>\nShould we expect doctests to pass with `./configure --disable-doc`? I get\n\n```\nsrc/sage/misc/sagedoc.py  # 8 doctests failed\nsrc/sage_docbuild/utils.py  # 5 doctests failed\nsrc/sage_docbuild/__init__.py  # 38 doctests failed\nsrc/sage_docbuild/sphinxbuild.py  # 13 doctests failed\nsrc/sage/docs/conf.py  # 1 doctest failed\n```\nwhich is not surprising, but should they be tagged so that they are only tested when `sagemath_doc_html` is built?",
    "created_at": "2021-11-11T04:04:31Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531377",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'></a>
Should we expect doctests to pass with `./configure --disable-doc`? I get

```
src/sage/misc/sagedoc.py  # 8 doctests failed
src/sage_docbuild/utils.py  # 5 doctests failed
src/sage_docbuild/__init__.py  # 38 doctests failed
src/sage_docbuild/sphinxbuild.py  # 13 doctests failed
src/sage/docs/conf.py  # 1 doctest failed
```
which is not surprising, but should they be tagged so that they are only tested when `sagemath_doc_html` is built?



---

archive/issue_comments_531378.json:
```json
{
    "body": "<a id='comment:20'></a>\n`git grep 'dochtml'` shows that we already seem to have an optional tag for this kind of thing.\n\nWe should probably replace it by `# optional - sagemath_doc_html` and add the missing ones for the failing doctests.",
    "created_at": "2021-11-11T04:12:20Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531378",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>
`git grep 'dochtml'` shows that we already seem to have an optional tag for this kind of thing.

We should probably replace it by `# optional - sagemath_doc_html` and add the missing ones for the failing doctests.



---

archive/issue_comments_531379.json:
```json
{
    "body": "<a id='comment:21'></a>\nRight, and then in the top-level `Makefile`, this line needs to be changed:\n\n```\nTESTALL_FLAGS = --optional=sage,dochtml,optional,external,build\n```\nand maybe the last line in this block from `src/sage/doctest/control.py`:\n\n```\n            if have_git:\n                self.files.append(opj(SAGE_SRC, 'sage_setup'))\n                self.files.append(opj(SAGE_SRC, 'sage_docbuild'))\n```\nPerhaps define `have_docs` appropriately and have a separate `if have_docs` block. Either that or tag everything in `sage_docbuild`.",
    "created_at": "2021-11-11T04:20:26Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531379",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:21'></a>
Right, and then in the top-level `Makefile`, this line needs to be changed:

```
TESTALL_FLAGS = --optional=sage,dochtml,optional,external,build
```
and maybe the last line in this block from `src/sage/doctest/control.py`:

```
            if have_git:
                self.files.append(opj(SAGE_SRC, 'sage_setup'))
                self.files.append(opj(SAGE_SRC, 'sage_docbuild'))
```
Perhaps define `have_docs` appropriately and have a separate `if have_docs` block. Either that or tag everything in `sage_docbuild`.



---

archive/issue_comments_531380.json:
```json
{
    "body": "<a id='comment:22'></a>\nSomething like this?\n\n```diff\ndiff --git a/src/sage/doctest/control.py b/src/sage/doctest/control.py\nindex 858d8cb567..8dbb693e22 100644\n--- a/src/sage/doctest/control.py\n+++ b/src/sage/doctest/control.py\n@@ -727,13 +727,14 @@ class DocTestController(SageObject):\n             Doctesting ...\n         \"\"\"\n         opj = os.path.join\n-        from sage.env import SAGE_SRC, SAGE_DOC_SRC, SAGE_ROOT, SAGE_ROOT_GIT\n+        from sage.env import SAGE_SRC, SAGE_DOC_SRC, SAGE_DOC, SAGE_ROOT, SAGE_ROOT_GIT\n         # SAGE_ROOT_GIT can be None on distributions which typically\n         # only have the SAGE_LOCAL install tree but not SAGE_ROOT\n         if SAGE_ROOT_GIT is not None:\n             have_git = os.path.isdir(SAGE_ROOT_GIT)\n         else:\n             have_git = False\n+        have_docs = os.path.isdir(opj(SAGE_DOC, 'html', 'en', 'tutorial'))\n \n         def all_files():\n             self.files.append(opj(SAGE_SRC, 'sage'))\n@@ -742,7 +743,8 @@ class DocTestController(SageObject):\n             # don't make sense to run outside a build environment\n             if have_git:\n                 self.files.append(opj(SAGE_SRC, 'sage_setup'))\n-                self.files.append(opj(SAGE_SRC, 'sage_docbuild'))\n+                if have_docs:\n+                    self.files.append(opj(SAGE_SRC, 'sage_docbuild'))\n             self.files.append(SAGE_DOC_SRC)\n \n         if self.options.all or (self.options.new and not have_git):\n```",
    "created_at": "2021-11-11T04:29:41Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531380",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:22'></a>
Something like this?

```diff
diff --git a/src/sage/doctest/control.py b/src/sage/doctest/control.py
index 858d8cb567..8dbb693e22 100644
--- a/src/sage/doctest/control.py
+++ b/src/sage/doctest/control.py
@@ -727,13 +727,14 @@ class DocTestController(SageObject):
             Doctesting ...
         """
         opj = os.path.join
-        from sage.env import SAGE_SRC, SAGE_DOC_SRC, SAGE_ROOT, SAGE_ROOT_GIT
+        from sage.env import SAGE_SRC, SAGE_DOC_SRC, SAGE_DOC, SAGE_ROOT, SAGE_ROOT_GIT
         # SAGE_ROOT_GIT can be None on distributions which typically
         # only have the SAGE_LOCAL install tree but not SAGE_ROOT
         if SAGE_ROOT_GIT is not None:
             have_git = os.path.isdir(SAGE_ROOT_GIT)
         else:
             have_git = False
+        have_docs = os.path.isdir(opj(SAGE_DOC, 'html', 'en', 'tutorial'))
 
         def all_files():
             self.files.append(opj(SAGE_SRC, 'sage'))
@@ -742,7 +743,8 @@ class DocTestController(SageObject):
             # don't make sense to run outside a build environment
             if have_git:
                 self.files.append(opj(SAGE_SRC, 'sage_setup'))
-                self.files.append(opj(SAGE_SRC, 'sage_docbuild'))
+                if have_docs:
+                    self.files.append(opj(SAGE_SRC, 'sage_docbuild'))
             self.files.append(SAGE_DOC_SRC)
 
         if self.options.all or (self.options.new and not have_git):
```



---

archive/issue_comments_531381.json:
```json
{
    "body": "<a id='comment:23'></a>\nI think it would make more sense to just test whether `opj(SAGE_SRC, 'sage_docbuild')` exists.\n\nSame for `sage_setup`.\n\nI think we can get rid of the `have_git` logic",
    "created_at": "2021-11-11T04:36:57Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531381",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>
I think it would make more sense to just test whether `opj(SAGE_SRC, 'sage_docbuild')` exists.

Same for `sage_setup`.

I think we can get rid of the `have_git` logic



---

archive/issue_comments_531382.json:
```json
{
    "body": "<a id='comment:24'></a>\nBy the way, with `make distclean && ./configure --disable-doc && make build`, the various sphinx packages are still being built.",
    "created_at": "2021-11-11T04:46:37Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531382",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:24'></a>
By the way, with `make distclean && ./configure --disable-doc && make build`, the various sphinx packages are still being built.



---

archive/issue_comments_531383.json:
```json
{
    "body": "**Changing commit** from \"[8a7027ac2067fba77fad02db3377e60df494a0b5](https://github.com/sagemath/sagetrac-mirror/commit/8a7027ac2067fba77fad02db3377e60df494a0b5)\" to \"[b6167ca1afe1302a8bacabe321069022d28f863e](https://github.com/sagemath/sagetrac-mirror/commit/b6167ca1afe1302a8bacabe321069022d28f863e)\".",
    "created_at": "2021-11-11T05:12:00Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531383",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[8a7027ac2067fba77fad02db3377e60df494a0b5](https://github.com/sagemath/sagetrac-mirror/commit/8a7027ac2067fba77fad02db3377e60df494a0b5)" to "[b6167ca1afe1302a8bacabe321069022d28f863e](https://github.com/sagemath/sagetrac-mirror/commit/b6167ca1afe1302a8bacabe321069022d28f863e)".



---

archive/issue_comments_531384.json:
```json
{
    "body": "<a id='comment:25'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d962fa23cf3bb4bc0dc6a858e42b8dc4779725f\">5d962fa</a></td><td><code>configure.ac (--disable-notebook): Also disable argon2_cffi</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/da2f1cc3b4cbc402c4d6d147efea9072c95cbb71\">da2f1cc</a></td><td><code>configure.ac (--disable-doc): New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4f0fee0b812312f869f29ce4e005281eb261b25e\">4f0fee0</a></td><td><code>configure.ac (--disable-doc): Disable also 'requests' and its dependencies, and direct sphinx dependencies</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/92d06dc837e1c1e6c85343ac35673dfef95842fd\">92d06dc</a></td><td><code>build/pkgs/pplpy/dependencies: Depend on sphinx only if SAGE_SPKG_INSTALL_DOCS!=no</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3b1f1056e3680584724e0ddb1c20967c780d2b10\">3b1f105</a></td><td><code>build/pkgs/pplpy/dependencies: Fix up SAGE_SPKG_INSTALL_DOCS logic</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/64273d100c175024bd94dead89d90560d88ade6d\">64273d1</a></td><td><code>configure.ac (--disabled-notebook): Also disable nbclient</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b6167ca1afe1302a8bacabe321069022d28f863e\">b6167ca</a></td><td><code>configure.ac (--disable-doc): Disable the actual docbuild on 'make'</code></td></tr></table>\n",
    "created_at": "2021-11-11T05:12:00Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531384",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d962fa23cf3bb4bc0dc6a858e42b8dc4779725f">5d962fa</a></td><td><code>configure.ac (--disable-notebook): Also disable argon2_cffi</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/da2f1cc3b4cbc402c4d6d147efea9072c95cbb71">da2f1cc</a></td><td><code>configure.ac (--disable-doc): New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4f0fee0b812312f869f29ce4e005281eb261b25e">4f0fee0</a></td><td><code>configure.ac (--disable-doc): Disable also 'requests' and its dependencies, and direct sphinx dependencies</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/92d06dc837e1c1e6c85343ac35673dfef95842fd">92d06dc</a></td><td><code>build/pkgs/pplpy/dependencies: Depend on sphinx only if SAGE_SPKG_INSTALL_DOCS!=no</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3b1f1056e3680584724e0ddb1c20967c780d2b10">3b1f105</a></td><td><code>build/pkgs/pplpy/dependencies: Fix up SAGE_SPKG_INSTALL_DOCS logic</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/64273d100c175024bd94dead89d90560d88ade6d">64273d1</a></td><td><code>configure.ac (--disabled-notebook): Also disable nbclient</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b6167ca1afe1302a8bacabe321069022d28f863e">b6167ca</a></td><td><code>configure.ac (--disable-doc): Disable the actual docbuild on 'make'</code></td></tr></table>




---

archive/issue_comments_531385.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [mkoeppe](#comment%3A18):\n> Rebased on top of updated #31356\n\n\n... I had lost most of the commits in this rebase.\n\nFixed.",
    "created_at": "2021-11-11T05:12:39Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531385",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>
Replying to [mkoeppe](#comment%3A18):
> Rebased on top of updated #31356


... I had lost most of the commits in this rebase.

Fixed.



---

archive/issue_comments_531386.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [mkoeppe](#comment%3A23):\n> I think it would make more sense to just test whether `opj(SAGE_SRC, 'sage_docbuild')` exists.\n> \n> Same for `sage_setup`.\n> \n> I think we can get rid of the `have_git` logic\n\n\nEither that or test whether we can import `sage_docbuild`. I think the directory will exist (in a source distribution) regardless, but we don't want to test if we haven't at least built `sage_docbuild`. That seems cleaner than tagging everything in those files `optional - sage_docbuild`.",
    "created_at": "2021-11-11T05:18:01Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531386",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:27'></a>
Replying to [mkoeppe](#comment%3A23):
> I think it would make more sense to just test whether `opj(SAGE_SRC, 'sage_docbuild')` exists.
> 
> Same for `sage_setup`.
> 
> I think we can get rid of the `have_git` logic


Either that or test whether we can import `sage_docbuild`. I think the directory will exist (in a source distribution) regardless, but we don't want to test if we haven't at least built `sage_docbuild`. That seems cleaner than tagging everything in those files `optional - sage_docbuild`.



---

archive/issue_comments_531387.json:
```json
{
    "body": "<a id='comment:28'></a>\nI think the doctesting logic is that the source tree (in SAGE_ROOT/src) is preferred over installed sources, which are only used for falling back (for example for use in downstream packaging). But I agree, when falling back to installed sources, then importing `sage_docbuild` and using its `__path__` is the right solution",
    "created_at": "2021-11-11T05:21:58Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531387",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:28'></a>
I think the doctesting logic is that the source tree (in SAGE_ROOT/src) is preferred over installed sources, which are only used for falling back (for example for use in downstream packaging). But I agree, when falling back to installed sources, then importing `sage_docbuild` and using its `__path__` is the right solution



---

archive/issue_comments_531388.json:
```json
{
    "body": "<a id='comment:29'></a>\nMy point is that the typical doctest in `sage_docbuild/*` starts with `from sage_docbuild import ...`, so we shouldn't bother to test (as part of `make testall` etc.) if we can't import `sage_docbuild`. So I suggest something like:\n\n```diff\ndiff --git a/src/sage/doctest/control.py b/src/sage/doctest/control.py\nindex 858d8cb567..2bf0a4beb4 100644\n--- a/src/sage/doctest/control.py\n+++ b/src/sage/doctest/control.py\n@@ -740,9 +740,13 @@ class DocTestController(SageObject):\n             # Don't run these tests when not in the git repository; they are\n             # of interest for building sage, but not for runtime behavior and\n             # don't make sense to run outside a build environment\n-            if have_git:\n+            if os.path.isdir(opj(SAGE_SRC, 'sage_setup')):\n                 self.files.append(opj(SAGE_SRC, 'sage_setup'))\n+            try:\n+                import sage_docbuild\n                 self.files.append(opj(SAGE_SRC, 'sage_docbuild'))\n+            except ImportError:\n+                pass\n             self.files.append(SAGE_DOC_SRC)\n \n         if self.options.all or (self.options.new and not have_git):\n```",
    "created_at": "2021-11-11T05:24:57Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531388",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:29'></a>
My point is that the typical doctest in `sage_docbuild/*` starts with `from sage_docbuild import ...`, so we shouldn't bother to test (as part of `make testall` etc.) if we can't import `sage_docbuild`. So I suggest something like:

```diff
diff --git a/src/sage/doctest/control.py b/src/sage/doctest/control.py
index 858d8cb567..2bf0a4beb4 100644
--- a/src/sage/doctest/control.py
+++ b/src/sage/doctest/control.py
@@ -740,9 +740,13 @@ class DocTestController(SageObject):
             # Don't run these tests when not in the git repository; they are
             # of interest for building sage, but not for runtime behavior and
             # don't make sense to run outside a build environment
-            if have_git:
+            if os.path.isdir(opj(SAGE_SRC, 'sage_setup')):
                 self.files.append(opj(SAGE_SRC, 'sage_setup'))
+            try:
+                import sage_docbuild
                 self.files.append(opj(SAGE_SRC, 'sage_docbuild'))
+            except ImportError:
+                pass
             self.files.append(SAGE_DOC_SRC)
 
         if self.options.all or (self.options.new and not have_git):
```



---

archive/issue_comments_531389.json:
```json
{
    "body": "<a id='comment:30'></a>\nAh ok, I agree. Same for `sage_setup` then, I think",
    "created_at": "2021-11-11T05:26:25Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531389",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:30'></a>
Ah ok, I agree. Same for `sage_setup` then, I think



---

archive/issue_comments_531390.json:
```json
{
    "body": "<a id='comment:31'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/35561817d6458ff7591b837d14ffc55a284943c1\">3556181</a></td><td><code>git grep -l '#.*optional.*dochtml' | xargs sed -i.bak 's/# optional - dochtml/# optional - sagemath_doc_html/'</code></td></tr></table>\n",
    "created_at": "2021-11-11T05:28:50Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531390",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/35561817d6458ff7591b837d14ffc55a284943c1">3556181</a></td><td><code>git grep -l '#.*optional.*dochtml' | xargs sed -i.bak 's/# optional - dochtml/# optional - sagemath_doc_html/'</code></td></tr></table>




---

archive/issue_comments_531391.json:
```json
{
    "body": "**Changing commit** from \"[b6167ca1afe1302a8bacabe321069022d28f863e](https://github.com/sagemath/sagetrac-mirror/commit/b6167ca1afe1302a8bacabe321069022d28f863e)\" to \"[35561817d6458ff7591b837d14ffc55a284943c1](https://github.com/sagemath/sagetrac-mirror/commit/35561817d6458ff7591b837d14ffc55a284943c1)\".",
    "created_at": "2021-11-11T05:28:50Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531391",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b6167ca1afe1302a8bacabe321069022d28f863e](https://github.com/sagemath/sagetrac-mirror/commit/b6167ca1afe1302a8bacabe321069022d28f863e)" to "[35561817d6458ff7591b837d14ffc55a284943c1](https://github.com/sagemath/sagetrac-mirror/commit/35561817d6458ff7591b837d14ffc55a284943c1)".



---

archive/issue_comments_531392.json:
```json
{
    "body": "<a id='comment:32'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4c11aab09acfc41e2bbdcbcd38c85efd673ce59a\">4c11aab</a></td><td><code>sed -i.bak 's/dochtml/sagemath_doc_html/' Makefile src/bin/sage-runtests src/doc/en/developer/doctesting.rst</code></td></tr></table>\n",
    "created_at": "2021-11-11T05:35:30Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531392",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4c11aab09acfc41e2bbdcbcd38c85efd673ce59a">4c11aab</a></td><td><code>sed -i.bak 's/dochtml/sagemath_doc_html/' Makefile src/bin/sage-runtests src/doc/en/developer/doctesting.rst</code></td></tr></table>




---

archive/issue_comments_531393.json:
```json
{
    "body": "**Changing commit** from \"[35561817d6458ff7591b837d14ffc55a284943c1](https://github.com/sagemath/sagetrac-mirror/commit/35561817d6458ff7591b837d14ffc55a284943c1)\" to \"[4c11aab09acfc41e2bbdcbcd38c85efd673ce59a](https://github.com/sagemath/sagetrac-mirror/commit/4c11aab09acfc41e2bbdcbcd38c85efd673ce59a)\".",
    "created_at": "2021-11-11T05:35:30Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531393",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[35561817d6458ff7591b837d14ffc55a284943c1](https://github.com/sagemath/sagetrac-mirror/commit/35561817d6458ff7591b837d14ffc55a284943c1)" to "[4c11aab09acfc41e2bbdcbcd38c85efd673ce59a](https://github.com/sagemath/sagetrac-mirror/commit/4c11aab09acfc41e2bbdcbcd38c85efd673ce59a)".



---

archive/issue_comments_531394.json:
```json
{
    "body": "<a id='comment:33'></a>\nIs it possible that `SAGE_DOC_SRC` might be missing? We could do this:\n\n```diff\ndiff --git a/src/sage/doctest/control.py b/src/sage/doctest/control.py\nindex 858d8cb567..86dbd24d1a 100644\n--- a/src/sage/doctest/control.py\n+++ b/src/sage/doctest/control.py\n@@ -737,13 +737,22 @@ class DocTestController(SageObject):\n \n         def all_files():\n             self.files.append(opj(SAGE_SRC, 'sage'))\n-            # Don't run these tests when not in the git repository; they are\n-            # of interest for building sage, but not for runtime behavior and\n-            # don't make sense to run outside a build environment\n-            if have_git:\n+            # Only test sage_setup and sage_docbuild if the relevant\n+            # imports work. They may not work if not in a build\n+            # environment or if the documentation build has been\n+            # disabled.\n+            try:\n+                import sage_setup\n                 self.files.append(opj(SAGE_SRC, 'sage_setup'))\n+            except ImportError:\n+                pass\n+            try:\n+                import sage_docbuild\n                 self.files.append(opj(SAGE_SRC, 'sage_docbuild'))\n-            self.files.append(SAGE_DOC_SRC)\n+            except ImportError:\n+                pass\n+            if os.path.isdir(SAGE_DOC_SRC):\n+                self.files.append(SAGE_DOC_SRC)\n \n         if self.options.all or (self.options.new and not have_git):\n             self.log(\"Doctesting entire Sage library.\")\n```\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4c11aab09acfc41e2bbdcbcd38c85efd673ce59a\">4c11aab</a></td><td><code>sed -i.bak 's/dochtml/sagemath_doc_html/' Makefile src/bin/sage-runtests src/doc/en/developer/doctesting.rst</code></td></tr></table>\n",
    "created_at": "2021-11-11T05:35:54Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531394",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:33'></a>
Is it possible that `SAGE_DOC_SRC` might be missing? We could do this:

```diff
diff --git a/src/sage/doctest/control.py b/src/sage/doctest/control.py
index 858d8cb567..86dbd24d1a 100644
--- a/src/sage/doctest/control.py
+++ b/src/sage/doctest/control.py
@@ -737,13 +737,22 @@ class DocTestController(SageObject):
 
         def all_files():
             self.files.append(opj(SAGE_SRC, 'sage'))
-            # Don't run these tests when not in the git repository; they are
-            # of interest for building sage, but not for runtime behavior and
-            # don't make sense to run outside a build environment
-            if have_git:
+            # Only test sage_setup and sage_docbuild if the relevant
+            # imports work. They may not work if not in a build
+            # environment or if the documentation build has been
+            # disabled.
+            try:
+                import sage_setup
                 self.files.append(opj(SAGE_SRC, 'sage_setup'))
+            except ImportError:
+                pass
+            try:
+                import sage_docbuild
                 self.files.append(opj(SAGE_SRC, 'sage_docbuild'))
-            self.files.append(SAGE_DOC_SRC)
+            except ImportError:
+                pass
+            if os.path.isdir(SAGE_DOC_SRC):
+                self.files.append(SAGE_DOC_SRC)
 
         if self.options.all or (self.options.new and not have_git):
             self.log("Doctesting entire Sage library.")
```

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4c11aab09acfc41e2bbdcbcd38c85efd673ce59a">4c11aab</a></td><td><code>sed -i.bak 's/dochtml/sagemath_doc_html/' Makefile src/bin/sage-runtests src/doc/en/developer/doctesting.rst</code></td></tr></table>




---

archive/issue_comments_531395.json:
```json
{
    "body": "<a id='comment:34'></a>\nCan we autodetect `sagemath_doc_html` as an optional tag to add for testing?",
    "created_at": "2021-11-11T05:37:22Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531395",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:34'></a>
Can we autodetect `sagemath_doc_html` as an optional tag to add for testing?



---

archive/issue_comments_531396.json:
```json
{
    "body": "<a id='comment:35'></a>\nYes, I think it should be autodetected already because `sagemath_doc_html` is just an installed package",
    "created_at": "2021-11-11T05:40:31Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531396",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:35'></a>
Yes, I think it should be autodetected already because `sagemath_doc_html` is just an installed package



---

archive/issue_comments_531397.json:
```json
{
    "body": "<a id='comment:36'></a>\nReplying to [jhpalmieri](#comment%3A33):\n> Is it possible that `SAGE_DOC_SRC` might be missing?\n\nYes, I think so, for example in downstream packaging of sage",
    "created_at": "2021-11-11T05:41:22Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531397",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:36'></a>
Replying to [jhpalmieri](#comment%3A33):
> Is it possible that `SAGE_DOC_SRC` might be missing?

Yes, I think so, for example in downstream packaging of sage



---

archive/issue_comments_531398.json:
```json
{
    "body": "<a id='comment:37'></a>\nReplying to [mkoeppe](#comment%3A35):\n> Yes, I think it should be autodetected already because `sagemath_doc_html` is just an installed package\n\n\nDoes that mean we shouldn't manually add it to `TESTALL_FLAGS` and let it happen automatically?",
    "created_at": "2021-11-11T05:42:11Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531398",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:37'></a>
Replying to [mkoeppe](#comment%3A35):
> Yes, I think it should be autodetected already because `sagemath_doc_html` is just an installed package


Does that mean we shouldn't manually add it to `TESTALL_FLAGS` and let it happen automatically?



---

archive/issue_comments_531399.json:
```json
{
    "body": "<a id='comment:38'></a>\nYes, that's a good point",
    "created_at": "2021-11-11T05:52:06Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531399",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:38'></a>
Yes, that's a good point



---

archive/issue_comments_531400.json:
```json
{
    "body": "<a id='comment:39'></a>\nNot sure how to implement `TESTALL_NODOC_FLAGS` then \n\n```\nTESTALL_FLAGS = --optional=sage,sagemath_doc_html,optional,external,build\nTESTALL_NODOC_FLAGS = --optional=sage,optional,external,build\n```",
    "created_at": "2021-11-11T05:53:54Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531400",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:39'></a>
Not sure how to implement `TESTALL_NODOC_FLAGS` then 

```
TESTALL_FLAGS = --optional=sage,sagemath_doc_html,optional,external,build
TESTALL_NODOC_FLAGS = --optional=sage,optional,external,build
```



---

archive/issue_comments_531401.json:
```json
{
    "body": "<a id='comment:40'></a>\n(introduced in #31084)",
    "created_at": "2021-11-11T05:54:50Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531401",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:40'></a>
(introduced in #31084)



---

archive/issue_comments_531402.json:
```json
{
    "body": "<a id='comment:41'></a>\nDeprecate the `nodoc` targets and tell people to use `./configure --disable-doc` instead?\n\nOr leave it with the two `FLAGS` being identical? Running `make ptest-nodoc` runs `make build` and so shouldn't build `sagemath_doc_html`, so it shouldn't run tests with that flag, while `make ptest` runs `make` and so will build `sagemath_doc_html`.",
    "created_at": "2021-11-11T06:05:31Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531402",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:41'></a>
Deprecate the `nodoc` targets and tell people to use `./configure --disable-doc` instead?

Or leave it with the two `FLAGS` being identical? Running `make ptest-nodoc` runs `make build` and so shouldn't build `sagemath_doc_html`, so it shouldn't run tests with that flag, while `make ptest` runs `make` and so will build `sagemath_doc_html`.



---

archive/issue_comments_531403.json:
```json
{
    "body": "<a id='comment:42'></a>\nThanks for the analysis, I like the 2nd option",
    "created_at": "2021-11-11T06:12:28Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531403",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:42'></a>
Thanks for the analysis, I like the 2nd option



---

archive/issue_comments_531404.json:
```json
{
    "body": "<a id='comment:43'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/afa2f80e03b7c691a7db915007d43677f468f295\">afa2f80</a></td><td><code>Makefile: Get rid of TESTALL_NODOC_FLAGS</code></td></tr></table>\n",
    "created_at": "2021-11-11T06:14:19Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531404",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/afa2f80e03b7c691a7db915007d43677f468f295">afa2f80</a></td><td><code>Makefile: Get rid of TESTALL_NODOC_FLAGS</code></td></tr></table>




---

archive/issue_comments_531405.json:
```json
{
    "body": "**Changing commit** from \"[4c11aab09acfc41e2bbdcbcd38c85efd673ce59a](https://github.com/sagemath/sagetrac-mirror/commit/4c11aab09acfc41e2bbdcbcd38c85efd673ce59a)\" to \"[afa2f80e03b7c691a7db915007d43677f468f295](https://github.com/sagemath/sagetrac-mirror/commit/afa2f80e03b7c691a7db915007d43677f468f295)\".",
    "created_at": "2021-11-11T06:14:19Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531405",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[4c11aab09acfc41e2bbdcbcd38c85efd673ce59a](https://github.com/sagemath/sagetrac-mirror/commit/4c11aab09acfc41e2bbdcbcd38c85efd673ce59a)" to "[afa2f80e03b7c691a7db915007d43677f468f295](https://github.com/sagemath/sagetrac-mirror/commit/afa2f80e03b7c691a7db915007d43677f468f295)".



---

archive/issue_comments_531406.json:
```json
{
    "body": "<a id='comment:44'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/28cf7759c47a166f27c978f89d17750d69c196a4\">28cf775</a></td><td><code>src/bin/sage-runtests (_get_optional_defaults): No need to include sagemath_doc_html here</code></td></tr></table>\n",
    "created_at": "2021-11-11T06:16:35Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531406",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:44'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/28cf7759c47a166f27c978f89d17750d69c196a4">28cf775</a></td><td><code>src/bin/sage-runtests (_get_optional_defaults): No need to include sagemath_doc_html here</code></td></tr></table>




---

archive/issue_comments_531407.json:
```json
{
    "body": "**Changing commit** from \"[afa2f80e03b7c691a7db915007d43677f468f295](https://github.com/sagemath/sagetrac-mirror/commit/afa2f80e03b7c691a7db915007d43677f468f295)\" to \"[28cf7759c47a166f27c978f89d17750d69c196a4](https://github.com/sagemath/sagetrac-mirror/commit/28cf7759c47a166f27c978f89d17750d69c196a4)\".",
    "created_at": "2021-11-11T06:16:35Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531407",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[afa2f80e03b7c691a7db915007d43677f468f295](https://github.com/sagemath/sagetrac-mirror/commit/afa2f80e03b7c691a7db915007d43677f468f295)" to "[28cf7759c47a166f27c978f89d17750d69c196a4](https://github.com/sagemath/sagetrac-mirror/commit/28cf7759c47a166f27c978f89d17750d69c196a4)".



---

archive/issue_comments_531408.json:
```json
{
    "body": "<a id='comment:45'></a>\nCould you push the change from [comment:33](#comment%3A33) to the ticket please?",
    "created_at": "2021-11-11T06:17:29Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531408",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:45'></a>
Could you push the change from [comment:33](#comment%3A33) to the ticket please?



---

archive/issue_comments_531409.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/__configure___disable_doc](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/__configure___disable_doc)\" to \"[u/jhpalmieri/__configure___disable_doc](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/__configure___disable_doc)\".",
    "created_at": "2021-11-11T17:19:45Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531409",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing branch** from "[u/mkoeppe/__configure___disable_doc](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/__configure___disable_doc)" to "[u/jhpalmieri/__configure___disable_doc](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/__configure___disable_doc)".



---

archive/issue_comments_531410.json:
```json
{
    "body": "<a id='comment:47'></a>\nReplying to [jhpalmieri](#comment%3A19):\n> Should we expect doctests to pass with `./configure --disable-doc`? I get\n> \n> ```\n> src/sage/misc/sagedoc.py  # 8 doctests failed [...]\n> ```\n\n\nNot sure what to do with these ones. What's happening here is that `sage.misc.sagedoc.detex` has a run-time dependency on Sphinx.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/10de6fd5fc65a1d52d0b08e89d0a9bd2dcb06e77\">10de6fd</a></td><td><code>trac 32759: doctest sage_setup and sage_docbuild conditionally</code></td></tr></table>\n",
    "created_at": "2021-11-11T18:01:08Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531410",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:47'></a>
Replying to [jhpalmieri](#comment%3A19):
> Should we expect doctests to pass with `./configure --disable-doc`? I get
> 
> ```
> src/sage/misc/sagedoc.py  # 8 doctests failed [...]
> ```


Not sure what to do with these ones. What's happening here is that `sage.misc.sagedoc.detex` has a run-time dependency on Sphinx.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/10de6fd5fc65a1d52d0b08e89d0a9bd2dcb06e77">10de6fd</a></td><td><code>trac 32759: doctest sage_setup and sage_docbuild conditionally</code></td></tr></table>




---

archive/issue_comments_531411.json:
```json
{
    "body": "**Changing commit** from \"[28cf7759c47a166f27c978f89d17750d69c196a4](https://github.com/sagemath/sagetrac-mirror/commit/28cf7759c47a166f27c978f89d17750d69c196a4)\" to \"[10de6fd5fc65a1d52d0b08e89d0a9bd2dcb06e77](https://github.com/sagemath/sagetrac-mirror/commit/10de6fd5fc65a1d52d0b08e89d0a9bd2dcb06e77)\".",
    "created_at": "2021-11-11T18:01:08Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531411",
    "user": "https://github.com/mkoeppe"
}
```

**Changing commit** from "[28cf7759c47a166f27c978f89d17750d69c196a4](https://github.com/sagemath/sagetrac-mirror/commit/28cf7759c47a166f27c978f89d17750d69c196a4)" to "[10de6fd5fc65a1d52d0b08e89d0a9bd2dcb06e77](https://github.com/sagemath/sagetrac-mirror/commit/10de6fd5fc65a1d52d0b08e89d0a9bd2dcb06e77)".



---

archive/issue_comments_531412.json:
```json
{
    "body": "**Changing branch** from \"[u/jhpalmieri/__configure___disable_doc](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/__configure___disable_doc)\" to \"[u/mkoeppe/__configure___disable_doc](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/__configure___disable_doc)\".",
    "created_at": "2021-11-11T18:15:40Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531412",
    "user": "https://github.com/mkoeppe"
}
```

**Changing branch** from "[u/jhpalmieri/__configure___disable_doc](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/__configure___disable_doc)" to "[u/mkoeppe/__configure___disable_doc](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/__configure___disable_doc)".



---

archive/issue_comments_531413.json:
```json
{
    "body": "**Changing commit** from \"[10de6fd5fc65a1d52d0b08e89d0a9bd2dcb06e77](https://github.com/sagemath/sagetrac-mirror/commit/10de6fd5fc65a1d52d0b08e89d0a9bd2dcb06e77)\" to \"[4213f8abd992732bcba950ddbbe35e2fcaeda592](https://github.com/sagemath/sagetrac-mirror/commit/4213f8abd992732bcba950ddbbe35e2fcaeda592)\".",
    "created_at": "2021-11-11T18:21:03Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531413",
    "user": "https://github.com/mkoeppe"
}
```

**Changing commit** from "[10de6fd5fc65a1d52d0b08e89d0a9bd2dcb06e77](https://github.com/sagemath/sagetrac-mirror/commit/10de6fd5fc65a1d52d0b08e89d0a9bd2dcb06e77)" to "[4213f8abd992732bcba950ddbbe35e2fcaeda592](https://github.com/sagemath/sagetrac-mirror/commit/4213f8abd992732bcba950ddbbe35e2fcaeda592)".



---

archive/issue_comments_531414.json:
```json
{
    "body": "<a id='comment:49'></a>\nReplying to [mkoeppe](#comment%3A35):\n> Yes, I think it should be autodetected already because `sagemath_doc_html` is just an installed package\n\nActually, at the moment this is not true because `sage.doctest.control` only looks at the optional packages.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4213f8abd992732bcba950ddbbe35e2fcaeda592\">4213f8a</a></td><td><code>sage.misc.sagedoc: Do not fail if sphinx cannot be imported</code></td></tr></table>\n",
    "created_at": "2021-11-11T18:21:03Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531414",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:49'></a>
Replying to [mkoeppe](#comment%3A35):
> Yes, I think it should be autodetected already because `sagemath_doc_html` is just an installed package

Actually, at the moment this is not true because `sage.doctest.control` only looks at the optional packages.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4213f8abd992732bcba950ddbbe35e2fcaeda592">4213f8a</a></td><td><code>sage.misc.sagedoc: Do not fail if sphinx cannot be imported</code></td></tr></table>




---

archive/issue_comments_531415.json:
```json
{
    "body": "<a id='comment:50'></a>\nWhat mechanism adds `sage.geometry.polyhedron` and `sage_spkg` to the list of tags?",
    "created_at": "2021-11-11T19:47:44Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531415",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:50'></a>
What mechanism adds `sage.geometry.polyhedron` and `sage_spkg` to the list of tags?



---

archive/issue_comments_531416.json:
```json
{
    "body": "**Changing commit** from \"[4213f8abd992732bcba950ddbbe35e2fcaeda592](https://github.com/sagemath/sagetrac-mirror/commit/4213f8abd992732bcba950ddbbe35e2fcaeda592)\" to \"[80513e3dafaadb8b1c69b965a73f078153ada135](https://github.com/sagemath/sagetrac-mirror/commit/80513e3dafaadb8b1c69b965a73f078153ada135)\".",
    "created_at": "2021-11-11T20:40:58Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531416",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[4213f8abd992732bcba950ddbbe35e2fcaeda592](https://github.com/sagemath/sagetrac-mirror/commit/4213f8abd992732bcba950ddbbe35e2fcaeda592)" to "[80513e3dafaadb8b1c69b965a73f078153ada135](https://github.com/sagemath/sagetrac-mirror/commit/80513e3dafaadb8b1c69b965a73f078153ada135)".



---

archive/issue_comments_531417.json:
```json
{
    "body": "<a id='comment:51'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b142e3491447b66394b136cd649eede03c43305d\">b142e34</a></td><td><code>sage.features.sphinx: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/80513e3dafaadb8b1c69b965a73f078153ada135\">80513e3</a></td><td><code>src/sage/doctest/control.py: Add test for Sphinx feature</code></td></tr></table>\n",
    "created_at": "2021-11-11T20:40:58Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531417",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:51'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b142e3491447b66394b136cd649eede03c43305d">b142e34</a></td><td><code>sage.features.sphinx: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/80513e3dafaadb8b1c69b965a73f078153ada135">80513e3</a></td><td><code>src/sage/doctest/control.py: Add test for Sphinx feature</code></td></tr></table>




---

archive/issue_comments_531418.json:
```json
{
    "body": "<a id='comment:52'></a>\nIt's happening in the lines of code in the middle of which I have just inserted a test for `sphinx`",
    "created_at": "2021-11-11T20:41:37Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531418",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:52'></a>
It's happening in the lines of code in the middle of which I have just inserted a test for `sphinx`



---

archive/issue_comments_531419.json:
```json
{
    "body": "<a id='comment:53'></a>\nIn #32174 I am hoping to unify all that",
    "created_at": "2021-11-11T20:42:23Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531419",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:53'></a>
In #32174 I am hoping to unify all that



---

archive/issue_comments_531420.json:
```json
{
    "body": "<a id='comment:54'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7d26e21630769acbeba4ba6b8207a8d6af4c98e5\">7d26e21</a></td><td><code>sage.features.sagemath.sagemath_doc_html: New</code></td></tr></table>\n",
    "created_at": "2021-11-11T20:51:21Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531420",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:54'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7d26e21630769acbeba4ba6b8207a8d6af4c98e5">7d26e21</a></td><td><code>sage.features.sagemath.sagemath_doc_html: New</code></td></tr></table>




---

archive/issue_comments_531421.json:
```json
{
    "body": "**Changing commit** from \"[80513e3dafaadb8b1c69b965a73f078153ada135](https://github.com/sagemath/sagetrac-mirror/commit/80513e3dafaadb8b1c69b965a73f078153ada135)\" to \"[7d26e21630769acbeba4ba6b8207a8d6af4c98e5](https://github.com/sagemath/sagetrac-mirror/commit/7d26e21630769acbeba4ba6b8207a8d6af4c98e5)\".",
    "created_at": "2021-11-11T20:51:21Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531421",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[80513e3dafaadb8b1c69b965a73f078153ada135](https://github.com/sagemath/sagetrac-mirror/commit/80513e3dafaadb8b1c69b965a73f078153ada135)" to "[7d26e21630769acbeba4ba6b8207a8d6af4c98e5](https://github.com/sagemath/sagetrac-mirror/commit/7d26e21630769acbeba4ba6b8207a8d6af4c98e5)".



---

archive/issue_comments_531422.json:
```json
{
    "body": "<a id='comment:55'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bb1626ae21a4dcdf286ec50595350b677104cff1\">bb1626a</a></td><td><code>sage.features.sagemath.sagemath_doc_html: Fixup</code></td></tr></table>\n",
    "created_at": "2021-11-11T20:54:59Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531422",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:55'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bb1626ae21a4dcdf286ec50595350b677104cff1">bb1626a</a></td><td><code>sage.features.sagemath.sagemath_doc_html: Fixup</code></td></tr></table>




---

archive/issue_comments_531423.json:
```json
{
    "body": "**Changing commit** from \"[7d26e21630769acbeba4ba6b8207a8d6af4c98e5](https://github.com/sagemath/sagetrac-mirror/commit/7d26e21630769acbeba4ba6b8207a8d6af4c98e5)\" to \"[bb1626ae21a4dcdf286ec50595350b677104cff1](https://github.com/sagemath/sagetrac-mirror/commit/bb1626ae21a4dcdf286ec50595350b677104cff1)\".",
    "created_at": "2021-11-11T20:54:59Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531423",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7d26e21630769acbeba4ba6b8207a8d6af4c98e5](https://github.com/sagemath/sagetrac-mirror/commit/7d26e21630769acbeba4ba6b8207a8d6af4c98e5)" to "[bb1626ae21a4dcdf286ec50595350b677104cff1](https://github.com/sagemath/sagetrac-mirror/commit/bb1626ae21a4dcdf286ec50595350b677104cff1)".



---

archive/issue_comments_531424.json:
```json
{
    "body": "<a id='comment:56'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a24c3bd8209ade6a2385105aebaad4cc282415f3\">a24c3bd</a></td><td><code>src/sage/misc/sagedoc.py: Mark some doctests # optional - sphinx</code></td></tr></table>\n",
    "created_at": "2021-11-11T21:17:10Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531424",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:56'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a24c3bd8209ade6a2385105aebaad4cc282415f3">a24c3bd</a></td><td><code>src/sage/misc/sagedoc.py: Mark some doctests # optional - sphinx</code></td></tr></table>




---

archive/issue_comments_531425.json:
```json
{
    "body": "**Changing commit** from \"[bb1626ae21a4dcdf286ec50595350b677104cff1](https://github.com/sagemath/sagetrac-mirror/commit/bb1626ae21a4dcdf286ec50595350b677104cff1)\" to \"[a24c3bd8209ade6a2385105aebaad4cc282415f3](https://github.com/sagemath/sagetrac-mirror/commit/a24c3bd8209ade6a2385105aebaad4cc282415f3)\".",
    "created_at": "2021-11-11T21:17:10Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531425",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[bb1626ae21a4dcdf286ec50595350b677104cff1](https://github.com/sagemath/sagetrac-mirror/commit/bb1626ae21a4dcdf286ec50595350b677104cff1)" to "[a24c3bd8209ade6a2385105aebaad4cc282415f3](https://github.com/sagemath/sagetrac-mirror/commit/a24c3bd8209ade6a2385105aebaad4cc282415f3)".



---

archive/issue_comments_531426.json:
```json
{
    "body": "<a id='comment:57'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e9770b0dce5d3f42e45f263cdb0be5cc15bcb3b\">3e9770b</a></td><td><code>sage.features.StaticFile: Accept directories too</code></td></tr></table>\n",
    "created_at": "2021-11-11T21:24:26Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531426",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:57'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e9770b0dce5d3f42e45f263cdb0be5cc15bcb3b">3e9770b</a></td><td><code>sage.features.StaticFile: Accept directories too</code></td></tr></table>




---

archive/issue_comments_531427.json:
```json
{
    "body": "**Changing commit** from \"[a24c3bd8209ade6a2385105aebaad4cc282415f3](https://github.com/sagemath/sagetrac-mirror/commit/a24c3bd8209ade6a2385105aebaad4cc282415f3)\" to \"[3e9770b0dce5d3f42e45f263cdb0be5cc15bcb3b](https://github.com/sagemath/sagetrac-mirror/commit/3e9770b0dce5d3f42e45f263cdb0be5cc15bcb3b)\".",
    "created_at": "2021-11-11T21:24:26Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531427",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a24c3bd8209ade6a2385105aebaad4cc282415f3](https://github.com/sagemath/sagetrac-mirror/commit/a24c3bd8209ade6a2385105aebaad4cc282415f3)" to "[3e9770b0dce5d3f42e45f263cdb0be5cc15bcb3b](https://github.com/sagemath/sagetrac-mirror/commit/3e9770b0dce5d3f42e45f263cdb0be5cc15bcb3b)".



---

archive/issue_comments_531428.json:
```json
{
    "body": "**Changing author** from \"Matthias Koeppe\" to \"Matthias Koeppe, John Palmieri\".",
    "created_at": "2021-11-11T21:28:41Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531428",
    "user": "https://github.com/mkoeppe"
}
```

**Changing author** from "Matthias Koeppe" to "Matthias Koeppe, John Palmieri".



---

archive/issue_comments_531429.json:
```json
{
    "body": "<a id='comment:59'></a>\nBy the way, this fails:\n\n```\nmake distclean\n./configure --disable-doc\nmake\nmake doc-html\n```\nI think the error boils down to\n\n```\n[reference] intersphinx inventory '/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/local/share/doc/pplpy/objects.inv' not fetchable due to <class 'FileNotFoundError'>: [Errno 2] No such file or directory: '/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/local/share/doc/pplpy/objects.inv'\n```\nThe problem is that `pplpy` doesn't build its documentation the first time, and then it doesn't get rebuilt when `make doc-html` is run. I don't know how to fix this.",
    "created_at": "2021-11-11T21:58:16Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531429",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:59'></a>
By the way, this fails:

```
make distclean
./configure --disable-doc
make
make doc-html
```
I think the error boils down to

```
[reference] intersphinx inventory '/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/local/share/doc/pplpy/objects.inv' not fetchable due to <class 'FileNotFoundError'>: [Errno 2] No such file or directory: '/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta5/local/share/doc/pplpy/objects.inv'
```
The problem is that `pplpy` doesn't build its documentation the first time, and then it doesn't get rebuilt when `make doc-html` is run. I don't know how to fix this.



---

archive/issue_comments_531430.json:
```json
{
    "body": "<a id='comment:60'></a>\nWith `make distclean && ./configure && make ptestlong`, I get two doctest failures:\n\n```\nFile \"src/sage/all.py\", line 31, in sage.all\nFailed example:\n    [inspect.getmodule(f).__name__ for f in frames if is_not_allowed(f)]\nExpected:\n    []\nGot:\n    ['pytz', 'importlib.resources']\n```\nand\n\n```\nFile \"src/sage/misc/sagedoc.py\", line 31, in sage.misc.sagedoc\nFailed example:\n    \"sphinx\" in sys.modules\nExpected:\n    False\nGot:\n    True\n```",
    "created_at": "2021-11-11T22:50:28Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531430",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:60'></a>
With `make distclean && ./configure && make ptestlong`, I get two doctest failures:

```
File "src/sage/all.py", line 31, in sage.all
Failed example:
    [inspect.getmodule(f).__name__ for f in frames if is_not_allowed(f)]
Expected:
    []
Got:
    ['pytz', 'importlib.resources']
```
and

```
File "src/sage/misc/sagedoc.py", line 31, in sage.misc.sagedoc
Failed example:
    "sphinx" in sys.modules
Expected:
    False
Got:
    True
```



---

archive/issue_comments_531431.json:
```json
{
    "body": "<a id='comment:61'></a>\nReplying to [jhpalmieri](#comment%3A59):\n> The problem is that `pplpy` doesn't build its documentation the first time, and then it doesn't get rebuilt when `make doc-html` is run. I don't know how to fix this.\n\n\nWe can introduce a separate package `pplpy_doc`, something that would actually also make sense for the upstream Python package.",
    "created_at": "2021-11-11T23:14:16Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531431",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:61'></a>
Replying to [jhpalmieri](#comment%3A59):
> The problem is that `pplpy` doesn't build its documentation the first time, and then it doesn't get rebuilt when `make doc-html` is run. I don't know how to fix this.


We can introduce a separate package `pplpy_doc`, something that would actually also make sense for the upstream Python package.



---

archive/issue_comments_531432.json:
```json
{
    "body": "<a id='comment:62'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e4a729091eb2f99d934ec9b319b840a888c283e1\">e4a7290</a></td><td><code>build/pkgs/pplpy_doc: Split pplpy docbuild out as a separate package</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ee4e50abd062e7259d47dea982d1cc306825c5cd\">ee4e50a</a></td><td><code>build/pkgs/sagemath_doc_html/dependencies: Add pplpy_doc</code></td></tr></table>\n",
    "created_at": "2021-11-11T23:37:03Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531432",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:62'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e4a729091eb2f99d934ec9b319b840a888c283e1">e4a7290</a></td><td><code>build/pkgs/pplpy_doc: Split pplpy docbuild out as a separate package</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ee4e50abd062e7259d47dea982d1cc306825c5cd">ee4e50a</a></td><td><code>build/pkgs/sagemath_doc_html/dependencies: Add pplpy_doc</code></td></tr></table>




---

archive/issue_comments_531433.json:
```json
{
    "body": "**Changing commit** from \"[3e9770b0dce5d3f42e45f263cdb0be5cc15bcb3b](https://github.com/sagemath/sagetrac-mirror/commit/3e9770b0dce5d3f42e45f263cdb0be5cc15bcb3b)\" to \"[ee4e50abd062e7259d47dea982d1cc306825c5cd](https://github.com/sagemath/sagetrac-mirror/commit/ee4e50abd062e7259d47dea982d1cc306825c5cd)\".",
    "created_at": "2021-11-11T23:37:03Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531433",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[3e9770b0dce5d3f42e45f263cdb0be5cc15bcb3b](https://github.com/sagemath/sagetrac-mirror/commit/3e9770b0dce5d3f42e45f263cdb0be5cc15bcb3b)" to "[ee4e50abd062e7259d47dea982d1cc306825c5cd](https://github.com/sagemath/sagetrac-mirror/commit/ee4e50abd062e7259d47dea982d1cc306825c5cd)".



---

archive/issue_comments_531434.json:
```json
{
    "body": "**Changing dependencies** from \"#31356\" to \"#31356, #32745\".",
    "created_at": "2021-11-12T00:11:42Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531434",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#31356" to "#31356, #32745".



---

archive/issue_comments_531435.json:
```json
{
    "body": "**Changing commit** from \"[ee4e50abd062e7259d47dea982d1cc306825c5cd](https://github.com/sagemath/sagetrac-mirror/commit/ee4e50abd062e7259d47dea982d1cc306825c5cd)\" to \"[810f26fd57168ba4174466037b75df8aa17b3107](https://github.com/sagemath/sagetrac-mirror/commit/810f26fd57168ba4174466037b75df8aa17b3107)\".",
    "created_at": "2021-11-12T00:12:40Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531435",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ee4e50abd062e7259d47dea982d1cc306825c5cd](https://github.com/sagemath/sagetrac-mirror/commit/ee4e50abd062e7259d47dea982d1cc306825c5cd)" to "[810f26fd57168ba4174466037b75df8aa17b3107](https://github.com/sagemath/sagetrac-mirror/commit/810f26fd57168ba4174466037b75df8aa17b3107)".



---

archive/issue_comments_531436.json:
```json
{
    "body": "<a id='comment:64'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f681abb442a578c5fa5686a337fc5adf5ae2485d\">f681abb</a></td><td><code>build/bin/sage-spkg: Also source sage-src-env-config so that SAGE_VENV is available</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7438449576052a809cfa460d7d21ee9338fcaef0\">7438449</a></td><td><code>src/bin/sage-env: Do not skip the script if SAGE_ENV_SOURCED was set but SAGE_VENV has changed</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b07c8e3a33d235e1fd2879e2e6808a1ced1bcd4a\">b07c8e3</a></td><td><code>build/bin/sage-spkg: Remove workaround of setting of PATH in the generated package scripts</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4af9a2432fd37e72248167802f890ef344d224fd\">4af9a24</a></td><td><code>Merge #32745</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/810f26fd57168ba4174466037b75df8aa17b3107\">810f26f</a></td><td><code>src/sage/misc/sagedoc.py: Test that sphinx is not imported in a fresh Sage copy</code></td></tr></table>\n",
    "created_at": "2021-11-12T00:12:40Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531436",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:64'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f681abb442a578c5fa5686a337fc5adf5ae2485d">f681abb</a></td><td><code>build/bin/sage-spkg: Also source sage-src-env-config so that SAGE_VENV is available</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7438449576052a809cfa460d7d21ee9338fcaef0">7438449</a></td><td><code>src/bin/sage-env: Do not skip the script if SAGE_ENV_SOURCED was set but SAGE_VENV has changed</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b07c8e3a33d235e1fd2879e2e6808a1ced1bcd4a">b07c8e3</a></td><td><code>build/bin/sage-spkg: Remove workaround of setting of PATH in the generated package scripts</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4af9a2432fd37e72248167802f890ef344d224fd">4af9a24</a></td><td><code>Merge #32745</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/810f26fd57168ba4174466037b75df8aa17b3107">810f26f</a></td><td><code>src/sage/misc/sagedoc.py: Test that sphinx is not imported in a fresh Sage copy</code></td></tr></table>




---

archive/issue_comments_531437.json:
```json
{
    "body": "**Changing commit** from \"[810f26fd57168ba4174466037b75df8aa17b3107](https://github.com/sagemath/sagetrac-mirror/commit/810f26fd57168ba4174466037b75df8aa17b3107)\" to \"[d280c9c52b2816d23bb77703929cdefa115c0a33](https://github.com/sagemath/sagetrac-mirror/commit/d280c9c52b2816d23bb77703929cdefa115c0a33)\".",
    "created_at": "2021-11-12T00:31:28Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531437",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[810f26fd57168ba4174466037b75df8aa17b3107](https://github.com/sagemath/sagetrac-mirror/commit/810f26fd57168ba4174466037b75df8aa17b3107)" to "[d280c9c52b2816d23bb77703929cdefa115c0a33](https://github.com/sagemath/sagetrac-mirror/commit/d280c9c52b2816d23bb77703929cdefa115c0a33)".



---

archive/issue_comments_531438.json:
```json
{
    "body": "<a id='comment:65'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f75d33f3dae372048920a95bbf4e2dddb467a8a4\">f75d33f</a></td><td><code>Trac #32836: don't let libSingular clobber the user's PATH.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d280c9c52b2816d23bb77703929cdefa115c0a33\">d280c9c</a></td><td><code>Merge #32836</code></td></tr></table>\n",
    "created_at": "2021-11-12T00:31:28Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531438",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:65'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f75d33f3dae372048920a95bbf4e2dddb467a8a4">f75d33f</a></td><td><code>Trac #32836: don't let libSingular clobber the user's PATH.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d280c9c52b2816d23bb77703929cdefa115c0a33">d280c9c</a></td><td><code>Merge #32836</code></td></tr></table>




---

archive/issue_comments_531439.json:
```json
{
    "body": "**Changing dependencies** from \"#31356, #32745\" to \"#31356, #32745, #32836\".",
    "created_at": "2021-11-12T00:31:46Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531439",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#31356, #32745" to "#31356, #32745, #32836".



---

archive/issue_comments_531440.json:
```json
{
    "body": "**Changing commit** from \"[d280c9c52b2816d23bb77703929cdefa115c0a33](https://github.com/sagemath/sagetrac-mirror/commit/d280c9c52b2816d23bb77703929cdefa115c0a33)\" to \"[7960b9077bb482160095160ed9fa788181547ac3](https://github.com/sagemath/sagetrac-mirror/commit/7960b9077bb482160095160ed9fa788181547ac3)\".",
    "created_at": "2021-11-12T00:34:43Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531440",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d280c9c52b2816d23bb77703929cdefa115c0a33](https://github.com/sagemath/sagetrac-mirror/commit/d280c9c52b2816d23bb77703929cdefa115c0a33)" to "[7960b9077bb482160095160ed9fa788181547ac3](https://github.com/sagemath/sagetrac-mirror/commit/7960b9077bb482160095160ed9fa788181547ac3)".



---

archive/issue_comments_531441.json:
```json
{
    "body": "<a id='comment:67'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7960b9077bb482160095160ed9fa788181547ac3\">7960b90</a></td><td><code>src/sage/all.py: Update doctest</code></td></tr></table>\n",
    "created_at": "2021-11-12T00:34:43Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531441",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:67'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7960b9077bb482160095160ed9fa788181547ac3">7960b90</a></td><td><code>src/sage/all.py: Update doctest</code></td></tr></table>




---

archive/issue_comments_531442.json:
```json
{
    "body": "<a id='comment:68'></a>\nReplying to [jhpalmieri](#comment%3A60):\n> With `make distclean && ./configure && make ptestlong`, I get two doctest failures:\n> \n> ```\n> File \"src/sage/all.py\", line 31, in sage.all\n> Failed example:\n>     [inspect.getmodule(f).__name__ for f in frames if is_not_allowed(f)]\n> Expected:\n>     []\n> Got:\n>     ['pytz', 'importlib.resources']\n> ```\n\n\nI've updated this doctest for the stuff that is pulled in by the doctest framework via Sphinx.\n\n> and\n> \n> ```\n> File \"src/sage/misc/sagedoc.py\", line 31, in sage.misc.sagedoc\n> Failed example:\n>     \"sphinx\" in sys.modules\n> Expected:\n>     False\n> Got:\n>     True\n> ```\n\n\nFixed by starting a fresh interpreter for this test. Had to pull in 2 tickets that fixed issues with recursive invocation of sage",
    "created_at": "2021-11-12T00:38:55Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531442",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:68'></a>
Replying to [jhpalmieri](#comment%3A60):
> With `make distclean && ./configure && make ptestlong`, I get two doctest failures:
> 
> ```
> File "src/sage/all.py", line 31, in sage.all
> Failed example:
>     [inspect.getmodule(f).__name__ for f in frames if is_not_allowed(f)]
> Expected:
>     []
> Got:
>     ['pytz', 'importlib.resources']
> ```


I've updated this doctest for the stuff that is pulled in by the doctest framework via Sphinx.

> and
> 
> ```
> File "src/sage/misc/sagedoc.py", line 31, in sage.misc.sagedoc
> Failed example:
>     "sphinx" in sys.modules
> Expected:
>     False
> Got:
>     True
> ```


Fixed by starting a fresh interpreter for this test. Had to pull in 2 tickets that fixed issues with recursive invocation of sage



---

archive/issue_comments_531443.json:
```json
{
    "body": "<a id='comment:69'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/687e5ba730d96e97d9b6fa435c66d83f8d42f14e\">687e5ba</a></td><td><code>src/sage/features/sagemath.py: Add doctests</code></td></tr></table>\n",
    "created_at": "2021-11-12T03:08:27Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531443",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:69'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/687e5ba730d96e97d9b6fa435c66d83f8d42f14e">687e5ba</a></td><td><code>src/sage/features/sagemath.py: Add doctests</code></td></tr></table>




---

archive/issue_comments_531444.json:
```json
{
    "body": "**Changing commit** from \"[7960b9077bb482160095160ed9fa788181547ac3](https://github.com/sagemath/sagetrac-mirror/commit/7960b9077bb482160095160ed9fa788181547ac3)\" to \"[687e5ba730d96e97d9b6fa435c66d83f8d42f14e](https://github.com/sagemath/sagetrac-mirror/commit/687e5ba730d96e97d9b6fa435c66d83f8d42f14e)\".",
    "created_at": "2021-11-12T03:08:27Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531444",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7960b9077bb482160095160ed9fa788181547ac3](https://github.com/sagemath/sagetrac-mirror/commit/7960b9077bb482160095160ed9fa788181547ac3)" to "[687e5ba730d96e97d9b6fa435c66d83f8d42f14e](https://github.com/sagemath/sagetrac-mirror/commit/687e5ba730d96e97d9b6fa435c66d83f8d42f14e)".



---

archive/issue_comments_531445.json:
```json
{
    "body": "<a id='comment:70'></a>\nWith `--disable-doc`, `make doc-html` goes through but ends with\n\n```\ntouch: /var/lib/sage/installed/sagemath_doc_html-none: No such file or directory\nmake[2]: *** [sagemath_doc_html-SAGE_DOCS-no-deps] Error 1\n```",
    "created_at": "2021-11-12T03:39:41Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531445",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:70'></a>
With `--disable-doc`, `make doc-html` goes through but ends with

```
touch: /var/lib/sage/installed/sagemath_doc_html-none: No such file or directory
make[2]: *** [sagemath_doc_html-SAGE_DOCS-no-deps] Error 1
```



---

archive/issue_events_293969.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-11-12T04:49:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293969"
}
```



---

archive/issue_events_293970.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-11-12T04:49:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293970"
}
```



---

archive/issue_comments_531446.json:
```json
{
    "body": "<a id='comment:72'></a>\nFor reasons I don't understand, my computer is now refusing to build the plots in the documentation \u2014\u00a0it keeps hanging in `references/plotting`. After fighting with this for a while, I've given in and am resuming testing using `export SAGE_DOCBUILD_OPTS=' --no-plot'`.\n\n(Not related to this ticket: this happens with the `develop` branch, too.)",
    "created_at": "2021-11-12T18:47:44Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531446",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:72'></a>
For reasons I don't understand, my computer is now refusing to build the plots in the documentation — it keeps hanging in `references/plotting`. After fighting with this for a while, I've given in and am resuming testing using `export SAGE_DOCBUILD_OPTS=' --no-plot'`.

(Not related to this ticket: this happens with the `develop` branch, too.)



---

archive/issue_comments_531447.json:
```json
{
    "body": "<a id='comment:73'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40a97601f4649f853252236268f7affb10d537b0\">40a9760</a></td><td><code>build/make/Makefile.in: Raise an error if installation into disabled installation tree is attempted</code></td></tr></table>\n",
    "created_at": "2021-11-12T18:49:03Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531447",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:73'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40a97601f4649f853252236268f7affb10d537b0">40a9760</a></td><td><code>build/make/Makefile.in: Raise an error if installation into disabled installation tree is attempted</code></td></tr></table>




---

archive/issue_comments_531448.json:
```json
{
    "body": "**Changing commit** from \"[687e5ba730d96e97d9b6fa435c66d83f8d42f14e](https://github.com/sagemath/sagetrac-mirror/commit/687e5ba730d96e97d9b6fa435c66d83f8d42f14e)\" to \"[40a97601f4649f853252236268f7affb10d537b0](https://github.com/sagemath/sagetrac-mirror/commit/40a97601f4649f853252236268f7affb10d537b0)\".",
    "created_at": "2021-11-12T18:49:03Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531448",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[687e5ba730d96e97d9b6fa435c66d83f8d42f14e](https://github.com/sagemath/sagetrac-mirror/commit/687e5ba730d96e97d9b6fa435c66d83f8d42f14e)" to "[40a97601f4649f853252236268f7affb10d537b0](https://github.com/sagemath/sagetrac-mirror/commit/40a97601f4649f853252236268f7affb10d537b0)".



---

archive/issue_comments_531449.json:
```json
{
    "body": "<a id='comment:74'></a>\nReplying to [mkoeppe](#comment%3A70):\n> With `--disable-doc`, `make doc-html` goes through but ends with\n> \n> ```\n> touch: /var/lib/sage/installed/sagemath_doc_html-none: No such file or directory\n> make[2]: *** [sagemath_doc_html-SAGE_DOCS-no-deps] Error 1\n> ```\n\n\nFixed now by explicitly raising a clear error.\n\nDo we want `make doc`, `make doc-html` to work when `--disable-doc` has been configured?",
    "created_at": "2021-11-12T18:50:24Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531449",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:74'></a>
Replying to [mkoeppe](#comment%3A70):
> With `--disable-doc`, `make doc-html` goes through but ends with
> 
> ```
> touch: /var/lib/sage/installed/sagemath_doc_html-none: No such file or directory
> make[2]: *** [sagemath_doc_html-SAGE_DOCS-no-deps] Error 1
> ```


Fixed now by explicitly raising a clear error.

Do we want `make doc`, `make doc-html` to work when `--disable-doc` has been configured?



---

archive/issue_comments_531450.json:
```json
{
    "body": "<a id='comment:75'></a>\nReplying to [mkoeppe](#comment%3A74):\n> Do we want `make doc`, `make doc-html` to work when `--disable-doc` has been configured?\n\n\nGood question, I don't know. Should the following work? Does it work?\n\n```\nmake distclean\n./configure --disable-doc\nmake\n./configure --enable-doc # without make distclean or similar\nmake doc-html\n```",
    "created_at": "2021-11-12T19:12:29Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531450",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:75'></a>
Replying to [mkoeppe](#comment%3A74):
> Do we want `make doc`, `make doc-html` to work when `--disable-doc` has been configured?


Good question, I don't know. Should the following work? Does it work?

```
make distclean
./configure --disable-doc
make
./configure --enable-doc # without make distclean or similar
make doc-html
```



---

archive/issue_comments_531451.json:
```json
{
    "body": "<a id='comment:76'></a>\nReplying to [jhpalmieri](#comment%3A75):\n> Replying to [mkoeppe](#comment%3A74):\n> > Do we want `make doc`, `make doc-html` to work when `--disable-doc` has been configured?\n\n> \n> Good question, I don't know.\n\n\nI think I would be happy if it didn't work but if there were a clear error message.\n\n```\n% make doc\n...\nError: Sage build configured with --disable-doc, so building the documentation will not work. To fix this, ...\n```",
    "created_at": "2021-11-12T19:24:33Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531451",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:76'></a>
Replying to [jhpalmieri](#comment%3A75):
> Replying to [mkoeppe](#comment%3A74):
> > Do we want `make doc`, `make doc-html` to work when `--disable-doc` has been configured?

> 
> Good question, I don't know.


I think I would be happy if it didn't work but if there were a clear error message.

```
% make doc
...
Error: Sage build configured with --disable-doc, so building the documentation will not work. To fix this, ...
```



---

archive/issue_comments_531452.json:
```json
{
    "body": "<a id='comment:77'></a>\nReplying to [jhpalmieri](#comment%3A75):\n> Should the following work? Does it work?\n> \n> ```\n> make distclean\n> ./configure --disable-doc\n> make\n> ./configure --enable-doc # without make distclean or similar\n> make doc-html\n> ```\n\n\nYes, I think this works",
    "created_at": "2021-11-12T19:58:56Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531452",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:77'></a>
Replying to [jhpalmieri](#comment%3A75):
> Should the following work? Does it work?
> 
> ```
> make distclean
> ./configure --disable-doc
> make
> ./configure --enable-doc # without make distclean or similar
> make doc-html
> ```


Yes, I think this works



---

archive/issue_comments_531453.json:
```json
{
    "body": "<a id='comment:78'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51f300290d9f648dfc4a4b64c710901c7c564a7b\">51f3002</a></td><td><code>build/make/Makefile.in: Better error message when docbuild is attempted but configure --disable-doc has been used</code></td></tr></table>\n",
    "created_at": "2021-11-12T20:11:47Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531453",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:78'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51f300290d9f648dfc4a4b64c710901c7c564a7b">51f3002</a></td><td><code>build/make/Makefile.in: Better error message when docbuild is attempted but configure --disable-doc has been used</code></td></tr></table>




---

archive/issue_comments_531454.json:
```json
{
    "body": "**Changing commit** from \"[40a97601f4649f853252236268f7affb10d537b0](https://github.com/sagemath/sagetrac-mirror/commit/40a97601f4649f853252236268f7affb10d537b0)\" to \"[51f300290d9f648dfc4a4b64c710901c7c564a7b](https://github.com/sagemath/sagetrac-mirror/commit/51f300290d9f648dfc4a4b64c710901c7c564a7b)\".",
    "created_at": "2021-11-12T20:11:47Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531454",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[40a97601f4649f853252236268f7affb10d537b0](https://github.com/sagemath/sagetrac-mirror/commit/40a97601f4649f853252236268f7affb10d537b0)" to "[51f300290d9f648dfc4a4b64c710901c7c564a7b](https://github.com/sagemath/sagetrac-mirror/commit/51f300290d9f648dfc4a4b64c710901c7c564a7b)".



---

archive/issue_events_293971.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-11-12T20:12:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293971"
}
```



---

archive/issue_events_293972.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-11-12T20:12:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293972"
}
```



---

archive/issue_comments_531455.json:
```json
{
    "body": "**Changing commit** from \"[51f300290d9f648dfc4a4b64c710901c7c564a7b](https://github.com/sagemath/sagetrac-mirror/commit/51f300290d9f648dfc4a4b64c710901c7c564a7b)\" to \"[b9da16194f49cefa76b81041f001588350c68558](https://github.com/sagemath/sagetrac-mirror/commit/b9da16194f49cefa76b81041f001588350c68558)\".",
    "created_at": "2021-11-12T23:22:23Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531455",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[51f300290d9f648dfc4a4b64c710901c7c564a7b](https://github.com/sagemath/sagetrac-mirror/commit/51f300290d9f648dfc4a4b64c710901c7c564a7b)" to "[b9da16194f49cefa76b81041f001588350c68558](https://github.com/sagemath/sagetrac-mirror/commit/b9da16194f49cefa76b81041f001588350c68558)".



---

archive/issue_comments_531456.json:
```json
{
    "body": "<a id='comment:80'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b9da16194f49cefa76b81041f001588350c68558\">b9da161</a></td><td><code>Merge tag '9.5.beta6' into t/32759/__configure___disable_doc</code></td></tr></table>\n",
    "created_at": "2021-11-12T23:22:23Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531456",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:80'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b9da16194f49cefa76b81041f001588350c68558">b9da161</a></td><td><code>Merge tag '9.5.beta6' into t/32759/__configure___disable_doc</code></td></tr></table>




---

archive/issue_comments_531457.json:
```json
{
    "body": "<a id='comment:81'></a>\nWith `./configure --disable-docs && make`, I'm getting\n\n```\n[pplpy-0.8.6] Finished installing pplpy-0.8.6\nmake --no-print-directory pplpy_doc-SAGE_DOCS-no-deps\nError: The installation tree SAGE_DOCS has been disabled\nThis Sage build is configured with configure --disable-doc, so building the documentation will not work.\nmake[4]: *** [pplpy_doc-SAGE_DOCS-no-deps] Error 1\nmake[3]: *** [/var/lib/sage/installed/pplpy_doc-0.8.6] Error 2\nmake[3]: *** Waiting for unfinished jobs....\n```\nThis even happens after I made this change:\n\n```diff\ndiff --git a/configure.ac b/configure.ac\nindex cec63aa918..fab7171839 100644\n--- a/configure.ac\n+++ b/configure.ac\n@@ -475,7 +475,7 @@ AC_ARG_ENABLE([doc],\n   AS_HELP_STRING([--disable-doc],\n                  [disable build of the Sage documentation and packages depending on it]), [\n     dnl Disable packages needed for docbuilding\n-    for pkg in sage_docbuild alabaster babel snowballstemmer idna urllib3 certifi charset_normalizer requests imagesize sphinx sphinxcontrib_devhelp sphinxcontrib_jsmath sphinxcontrib_serializinghtml sphinxcontrib_applehelp sphinxcontrib_htmlhelp sphinxcontrib_qthelp sphinxcontrib_websupport; do\n+    for pkg in sage_docbuild alabaster babel snowballstemmer idna urllib3 certifi charset_normalizer requests imagesize sphinx sphinxcontrib_devhelp sphinxcontrib_jsmath sphinxcontrib_serializinghtml sphinxcontrib_applehelp sphinxcontrib_htmlhelp sphinxcontrib_qthelp sphinxcontrib_websupport pplpy_doc; do\n       AS_VAR_SET([SAGE_ENABLE_$pkg], [$enableval])\n     done\n     dnl Disable the docbuild by disabling the install tree for documentation\n```",
    "created_at": "2021-11-13T00:03:02Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531457",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:81'></a>
With `./configure --disable-docs && make`, I'm getting

```
[pplpy-0.8.6] Finished installing pplpy-0.8.6
make --no-print-directory pplpy_doc-SAGE_DOCS-no-deps
Error: The installation tree SAGE_DOCS has been disabled
This Sage build is configured with configure --disable-doc, so building the documentation will not work.
make[4]: *** [pplpy_doc-SAGE_DOCS-no-deps] Error 1
make[3]: *** [/var/lib/sage/installed/pplpy_doc-0.8.6] Error 2
make[3]: *** Waiting for unfinished jobs....
```
This even happens after I made this change:

```diff
diff --git a/configure.ac b/configure.ac
index cec63aa918..fab7171839 100644
--- a/configure.ac
+++ b/configure.ac
@@ -475,7 +475,7 @@ AC_ARG_ENABLE([doc],
   AS_HELP_STRING([--disable-doc],
                  [disable build of the Sage documentation and packages depending on it]), [
     dnl Disable packages needed for docbuilding
-    for pkg in sage_docbuild alabaster babel snowballstemmer idna urllib3 certifi charset_normalizer requests imagesize sphinx sphinxcontrib_devhelp sphinxcontrib_jsmath sphinxcontrib_serializinghtml sphinxcontrib_applehelp sphinxcontrib_htmlhelp sphinxcontrib_qthelp sphinxcontrib_websupport; do
+    for pkg in sage_docbuild alabaster babel snowballstemmer idna urllib3 certifi charset_normalizer requests imagesize sphinx sphinxcontrib_devhelp sphinxcontrib_jsmath sphinxcontrib_serializinghtml sphinxcontrib_applehelp sphinxcontrib_htmlhelp sphinxcontrib_qthelp sphinxcontrib_websupport pplpy_doc; do
       AS_VAR_SET([SAGE_ENABLE_$pkg], [$enableval])
     done
     dnl Disable the docbuild by disabling the install tree for documentation
```



---

archive/issue_comments_531458.json:
```json
{
    "body": "<a id='comment:82'></a>\nIt seems to be okay now. Maybe I need to run `./bootstrap` or something similar (although the old `config.log` said that it wasn't building `pplpy_doc`.)",
    "created_at": "2021-11-13T00:44:40Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531458",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:82'></a>
It seems to be okay now. Maybe I need to run `./bootstrap` or something similar (although the old `config.log` said that it wasn't building `pplpy_doc`.)



---

archive/issue_comments_531459.json:
```json
{
    "body": "<a id='comment:83'></a>\nYes, it sounds like `bootstrap` wasn't run.",
    "created_at": "2021-11-13T00:45:50Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531459",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:83'></a>
Yes, it sounds like `bootstrap` wasn't run.



---

archive/issue_comments_531460.json:
```json
{
    "body": "<a id='comment:84'></a>\n**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d626aa8517395d30f9db813246a1204856398bfd\">d626aa8</a></td><td><code>build/pkgs/pplpy/dependencies: Depend on sphinx only if SAGE_SPKG_INSTALL_DOCS!=no</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/82ce5390f94475b3941c69524280fb5a36fa7052\">82ce539</a></td><td><code>configure.ac: If --disable-notebook and --disable-sagelib, do not build zeromq etc.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/02505ca6d353e44253f8e461055fe1f2ca6bb995\">02505ca</a></td><td><code>pkgs/sage-conf_pypi/MANIFEST.in: Update from #31396</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aeca1a03015f27b74c6641cb7bbcdd9c5e82bf16\">aeca1a0</a></td><td><code>Makefile (pypi-sdists): Add sage_setup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cd3dce9e076ba81febc4e8f838e1b5ca03b12459\">cd3dce9</a></td><td><code>pkgs/sage-conf_pypi/setup.py: Update directory of configured sage_conf.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c695921c3cee61a32a8d7ec9443bb4e315eb481b\">c695921</a></td><td><code>pkgs/sage-conf/sage_conf.py.in (SAGE_SPKG_WHEELS): Update so it works if SAGE_VENV != SAGE_LOCAL</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cebcda3fa7e1ae0ecd0e7cbf1a0aba15bed1a010\">cebcda3</a></td><td><code>Merge tag '9.5.beta4' into t/29039/pip_installable_package_sage_bootstrap</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0026892c983828c7925626d2bc9165967f0bebe5\">0026892</a></td><td><code>Merge tag '9.5.beta5' into t/29039/pip_installable_package_sage_bootstrap</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b5cf9f6bbf64dfa27fe434f6b82f4776abcfe3c2\">b5cf9f6</a></td><td><code>Merge #29039</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/04df2b704edb7a6e2a3988d815e654f781cba87d\">04df2b7</a></td><td><code>build/make/Makefile.in (all-start): Use all-sage-docs, not doc</code></td></tr></table>\n",
    "created_at": "2021-11-13T01:17:04Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531460",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:84'></a>
**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d626aa8517395d30f9db813246a1204856398bfd">d626aa8</a></td><td><code>build/pkgs/pplpy/dependencies: Depend on sphinx only if SAGE_SPKG_INSTALL_DOCS!=no</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/82ce5390f94475b3941c69524280fb5a36fa7052">82ce539</a></td><td><code>configure.ac: If --disable-notebook and --disable-sagelib, do not build zeromq etc.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/02505ca6d353e44253f8e461055fe1f2ca6bb995">02505ca</a></td><td><code>pkgs/sage-conf_pypi/MANIFEST.in: Update from #31396</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aeca1a03015f27b74c6641cb7bbcdd9c5e82bf16">aeca1a0</a></td><td><code>Makefile (pypi-sdists): Add sage_setup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cd3dce9e076ba81febc4e8f838e1b5ca03b12459">cd3dce9</a></td><td><code>pkgs/sage-conf_pypi/setup.py: Update directory of configured sage_conf.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c695921c3cee61a32a8d7ec9443bb4e315eb481b">c695921</a></td><td><code>pkgs/sage-conf/sage_conf.py.in (SAGE_SPKG_WHEELS): Update so it works if SAGE_VENV != SAGE_LOCAL</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cebcda3fa7e1ae0ecd0e7cbf1a0aba15bed1a010">cebcda3</a></td><td><code>Merge tag '9.5.beta4' into t/29039/pip_installable_package_sage_bootstrap</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0026892c983828c7925626d2bc9165967f0bebe5">0026892</a></td><td><code>Merge tag '9.5.beta5' into t/29039/pip_installable_package_sage_bootstrap</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b5cf9f6bbf64dfa27fe434f6b82f4776abcfe3c2">b5cf9f6</a></td><td><code>Merge #29039</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/04df2b704edb7a6e2a3988d815e654f781cba87d">04df2b7</a></td><td><code>build/make/Makefile.in (all-start): Use all-sage-docs, not doc</code></td></tr></table>




---

archive/issue_comments_531461.json:
```json
{
    "body": "**Changing commit** from \"[b9da16194f49cefa76b81041f001588350c68558](https://github.com/sagemath/sagetrac-mirror/commit/b9da16194f49cefa76b81041f001588350c68558)\" to \"[04df2b704edb7a6e2a3988d815e654f781cba87d](https://github.com/sagemath/sagetrac-mirror/commit/04df2b704edb7a6e2a3988d815e654f781cba87d)\".",
    "created_at": "2021-11-13T01:17:04Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531461",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b9da16194f49cefa76b81041f001588350c68558](https://github.com/sagemath/sagetrac-mirror/commit/b9da16194f49cefa76b81041f001588350c68558)" to "[04df2b704edb7a6e2a3988d815e654f781cba87d](https://github.com/sagemath/sagetrac-mirror/commit/04df2b704edb7a6e2a3988d815e654f781cba87d)".



---

archive/issue_comments_531462.json:
```json
{
    "body": "**Changing dependencies** from \"#31356, #32745, #32836\" to \"#31356, #32745, #32836, #29039\".",
    "created_at": "2021-11-13T01:17:43Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531462",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#31356, #32745, #32836" to "#31356, #32745, #32836, #29039".



---

archive/issue_comments_531463.json:
```json
{
    "body": "<a id='comment:85'></a>\nMerged #29039 to resolve a merge conflict",
    "created_at": "2021-11-13T01:17:43Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531463",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:85'></a>
Merged #29039 to resolve a merge conflict



---

archive/issue_comments_531464.json:
```json
{
    "body": "<a id='comment:86'></a>\nPossibly the last commit also fixed [comment:81](#comment%3A81)",
    "created_at": "2021-11-13T01:26:47Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531464",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:86'></a>
Possibly the last commit also fixed [comment:81](#comment%3A81)



---

archive/issue_comments_531465.json:
```json
{
    "body": "<a id='comment:87'></a>\nEverything builds for me, but my computer continues to misbehave, so I am not getting meaningful output on doctests. This is with OS X Monterey, and I have merged #32852. Many doctests involving plotting are timing out, so I get lots of doctest failures, and I don't know why. I tried a few sample plots interactively and they work.",
    "created_at": "2021-11-13T16:36:53Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531465",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:87'></a>
Everything builds for me, but my computer continues to misbehave, so I am not getting meaningful output on doctests. This is with OS X Monterey, and I have merged #32852. Many doctests involving plotting are timing out, so I get lots of doctest failures, and I don't know why. I tried a few sample plots interactively and they work.



---

archive/issue_comments_531466.json:
```json
{
    "body": "<a id='comment:88'></a>\nRunning some tests with `EXTRA_CONFIGURE_ARGS=\"--disable-doc\" tox -e docker-ubuntu-focal-standard`.\n\nBuild went through but I am getting these failures on `make ptestlong`:\n\n```\nsage -t --long --random-seed=28205743117922504880455715083835945768 src/doc/en/tutorial/conf.py\n    ModuleNotFoundError in doctesting framework\n**********************************************************************\nTraceback (most recent call last):\n  File \"/sage/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/doctest/forker.py\", line 2465, in __call__\n    doctests, extras = self._run(runner, options, results)\n  File \"/sage/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/doctest/forker.py\", line 2513, in _run\n    doctests, extras = self.source.create_doctests(sage_namespace)\n  File \"/sage/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/doctest/sources.py\", line 733, in create_doctests\n    load(filename, namespace) # errors raised here will be caught in DocTestTask\n  File \"/sage/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/repl/load.py\", line 252, in load\n    exec(code, globals)\n  File \"./conf.py\", line 12, in <module>\n  File \"/sage/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/docs/conf.py\", line 3, in <module>\n    import sphinx\nModuleNotFoundError: No module named 'sphinx'\n\nFile \"src/doc/en/thematic_tutorials/sandpile.rst\", line 1457, in doc.en.thematic_tutorials.sandpile\nFailed example:\n    Sandpile.help()\n[formatting details]\n```",
    "created_at": "2021-11-13T19:47:07Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531466",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:88'></a>
Running some tests with `EXTRA_CONFIGURE_ARGS="--disable-doc" tox -e docker-ubuntu-focal-standard`.

Build went through but I am getting these failures on `make ptestlong`:

```
sage -t --long --random-seed=28205743117922504880455715083835945768 src/doc/en/tutorial/conf.py
    ModuleNotFoundError in doctesting framework
**********************************************************************
Traceback (most recent call last):
  File "/sage/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/doctest/forker.py", line 2465, in __call__
    doctests, extras = self._run(runner, options, results)
  File "/sage/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/doctest/forker.py", line 2513, in _run
    doctests, extras = self.source.create_doctests(sage_namespace)
  File "/sage/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/doctest/sources.py", line 733, in create_doctests
    load(filename, namespace) # errors raised here will be caught in DocTestTask
  File "/sage/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/repl/load.py", line 252, in load
    exec(code, globals)
  File "./conf.py", line 12, in <module>
  File "/sage/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/docs/conf.py", line 3, in <module>
    import sphinx
ModuleNotFoundError: No module named 'sphinx'

File "src/doc/en/thematic_tutorials/sandpile.rst", line 1457, in doc.en.thematic_tutorials.sandpile
Failed example:
    Sandpile.help()
[formatting details]
```



---

archive/issue_comments_531467.json:
```json
{
    "body": "**Changing commit** from \"[04df2b704edb7a6e2a3988d815e654f781cba87d](https://github.com/sagemath/sagetrac-mirror/commit/04df2b704edb7a6e2a3988d815e654f781cba87d)\" to \"[7e980b114700189c70a1e5c1dbb1f76d5e8b10b1](https://github.com/sagemath/sagetrac-mirror/commit/7e980b114700189c70a1e5c1dbb1f76d5e8b10b1)\".",
    "created_at": "2021-11-13T20:02:58Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531467",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[04df2b704edb7a6e2a3988d815e654f781cba87d](https://github.com/sagemath/sagetrac-mirror/commit/04df2b704edb7a6e2a3988d815e654f781cba87d)" to "[7e980b114700189c70a1e5c1dbb1f76d5e8b10b1](https://github.com/sagemath/sagetrac-mirror/commit/7e980b114700189c70a1e5c1dbb1f76d5e8b10b1)".



---

archive/issue_comments_531468.json:
```json
{
    "body": "<a id='comment:89'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7e980b114700189c70a1e5c1dbb1f76d5e8b10b1\">7e980b1</a></td><td><code>src/doc: Mark conf.py files # nodoctest</code></td></tr></table>\n",
    "created_at": "2021-11-13T20:02:58Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531468",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:89'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7e980b114700189c70a1e5c1dbb1f76d5e8b10b1">7e980b1</a></td><td><code>src/doc: Mark conf.py files # nodoctest</code></td></tr></table>




---

archive/issue_comments_531469.json:
```json
{
    "body": "<a id='comment:90'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4fd9a832cc9f6ba15374bb1212a57337db53238d\">4fd9a83</a></td><td><code>src/doc/en/thematic_tutorials/sandpile.rst: Do not include the full output of Sandpile.help() in the doctest</code></td></tr></table>\n",
    "created_at": "2021-11-13T20:08:09Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531469",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:90'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4fd9a832cc9f6ba15374bb1212a57337db53238d">4fd9a83</a></td><td><code>src/doc/en/thematic_tutorials/sandpile.rst: Do not include the full output of Sandpile.help() in the doctest</code></td></tr></table>




---

archive/issue_comments_531470.json:
```json
{
    "body": "**Changing commit** from \"[7e980b114700189c70a1e5c1dbb1f76d5e8b10b1](https://github.com/sagemath/sagetrac-mirror/commit/7e980b114700189c70a1e5c1dbb1f76d5e8b10b1)\" to \"[4fd9a832cc9f6ba15374bb1212a57337db53238d](https://github.com/sagemath/sagetrac-mirror/commit/4fd9a832cc9f6ba15374bb1212a57337db53238d)\".",
    "created_at": "2021-11-13T20:08:09Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531470",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7e980b114700189c70a1e5c1dbb1f76d5e8b10b1](https://github.com/sagemath/sagetrac-mirror/commit/7e980b114700189c70a1e5c1dbb1f76d5e8b10b1)" to "[4fd9a832cc9f6ba15374bb1212a57337db53238d](https://github.com/sagemath/sagetrac-mirror/commit/4fd9a832cc9f6ba15374bb1212a57337db53238d)".



---

archive/issue_comments_531471.json:
```json
{
    "body": "<a id='comment:91'></a>\nA few more failures\n\n```\nsage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/databases/findstat.py  # 94 doctests failed\nsage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/doctest/test.py  # 7 doctests failed\nsage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/doctest/sources.py  # 1 doctest failed\nsage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/misc/bindable_class.py  # 2 doctests failed\nsage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/misc/sagedoc.py  # 1 doctest failed\nsage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/misc/sphinxify.py  # 7 doctests failed\nsage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/misc/sageinspect.py  # 1 doctest failed\nsage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/repl/ipython_tests.py  # 2 doctests failed\nsage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/sandpiles/sandpile.py  # 1 doctest failed\nsage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/tests/lazy_imports.py  # 1 doctest failed\n```",
    "created_at": "2021-11-13T22:57:23Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531471",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:91'></a>
A few more failures

```
sage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/databases/findstat.py  # 94 doctests failed
sage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/doctest/test.py  # 7 doctests failed
sage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/doctest/sources.py  # 1 doctest failed
sage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/misc/bindable_class.py  # 2 doctests failed
sage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/misc/sagedoc.py  # 1 doctest failed
sage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/misc/sphinxify.py  # 7 doctests failed
sage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/misc/sageinspect.py  # 1 doctest failed
sage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/repl/ipython_tests.py  # 2 doctests failed
sage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/sandpiles/sandpile.py  # 1 doctest failed
sage -t --long --random-seed=184472493071993940636041244744568712523 src/sage/tests/lazy_imports.py  # 1 doctest failed
```



---

archive/issue_comments_531472.json:
```json
{
    "body": "<a id='comment:92'></a>\nThe `findstat` failures are:\n\n```\n      File \"/sage/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/databases/findstat.py\", line 240, in <module>\n        import requests\n    ModuleNotFoundError: No module named 'requests'\n```",
    "created_at": "2021-11-13T22:59:50Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531472",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:92'></a>
The `findstat` failures are:

```
      File "/sage/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/databases/findstat.py", line 240, in <module>
        import requests
    ModuleNotFoundError: No module named 'requests'
```



---

archive/issue_comments_531473.json:
```json
{
    "body": "<a id='comment:93'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b0e161217f9af609e1fbdf0e21c890a22154aff2\">b0e1612</a></td><td><code>src/setup.cfg.m4, src/requirements.txt.m4, build/pkgs/sagelib/dependencies: Add requests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f6ba517420e776451fd8a273a03c115c29cdc83e\">f6ba517</a></td><td><code>configure.ac (--disable-doc): Do not disable requests and its dependencies, needed for sage.databases.findstat</code></td></tr></table>\n",
    "created_at": "2021-11-13T23:08:09Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531473",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:93'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b0e161217f9af609e1fbdf0e21c890a22154aff2">b0e1612</a></td><td><code>src/setup.cfg.m4, src/requirements.txt.m4, build/pkgs/sagelib/dependencies: Add requests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f6ba517420e776451fd8a273a03c115c29cdc83e">f6ba517</a></td><td><code>configure.ac (--disable-doc): Do not disable requests and its dependencies, needed for sage.databases.findstat</code></td></tr></table>




---

archive/issue_comments_531474.json:
```json
{
    "body": "**Changing commit** from \"[4fd9a832cc9f6ba15374bb1212a57337db53238d](https://github.com/sagemath/sagetrac-mirror/commit/4fd9a832cc9f6ba15374bb1212a57337db53238d)\" to \"[f6ba517420e776451fd8a273a03c115c29cdc83e](https://github.com/sagemath/sagetrac-mirror/commit/f6ba517420e776451fd8a273a03c115c29cdc83e)\".",
    "created_at": "2021-11-13T23:08:09Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531474",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[4fd9a832cc9f6ba15374bb1212a57337db53238d](https://github.com/sagemath/sagetrac-mirror/commit/4fd9a832cc9f6ba15374bb1212a57337db53238d)" to "[f6ba517420e776451fd8a273a03c115c29cdc83e](https://github.com/sagemath/sagetrac-mirror/commit/f6ba517420e776451fd8a273a03c115c29cdc83e)".



---

archive/issue_comments_531475.json:
```json
{
    "body": "<a id='comment:94'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/be64b2551bc387870859565de7fef9bf9bb0b465\">be64b25</a></td><td><code>src/sage/sandpiles/sandpile.py: Make doctest pass even if sphinx formatting is not available</code></td></tr></table>\n",
    "created_at": "2021-11-13T23:14:39Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531475",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:94'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/be64b2551bc387870859565de7fef9bf9bb0b465">be64b25</a></td><td><code>src/sage/sandpiles/sandpile.py: Make doctest pass even if sphinx formatting is not available</code></td></tr></table>




---

archive/issue_comments_531476.json:
```json
{
    "body": "**Changing commit** from \"[f6ba517420e776451fd8a273a03c115c29cdc83e](https://github.com/sagemath/sagetrac-mirror/commit/f6ba517420e776451fd8a273a03c115c29cdc83e)\" to \"[be64b2551bc387870859565de7fef9bf9bb0b465](https://github.com/sagemath/sagetrac-mirror/commit/be64b2551bc387870859565de7fef9bf9bb0b465)\".",
    "created_at": "2021-11-13T23:14:39Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531476",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[f6ba517420e776451fd8a273a03c115c29cdc83e](https://github.com/sagemath/sagetrac-mirror/commit/f6ba517420e776451fd8a273a03c115c29cdc83e)" to "[be64b2551bc387870859565de7fef9bf9bb0b465](https://github.com/sagemath/sagetrac-mirror/commit/be64b2551bc387870859565de7fef9bf9bb0b465)".



---

archive/issue_comments_531477.json:
```json
{
    "body": "<a id='comment:95'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e4cb681d2acdbb2be95ee00ea82a97990c88cffd\">e4cb681</a></td><td><code>src/sage/misc/sagedoc.py: Fix doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/be532a2ea74892a93e0a713531c84680da31ca9c\">be532a2</a></td><td><code>src/sage/misc/sphinxify.py: Use module-level # sage.doctest: optional - sphinx</code></td></tr></table>\n",
    "created_at": "2021-11-13T23:19:33Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531477",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:95'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e4cb681d2acdbb2be95ee00ea82a97990c88cffd">e4cb681</a></td><td><code>src/sage/misc/sagedoc.py: Fix doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/be532a2ea74892a93e0a713531c84680da31ca9c">be532a2</a></td><td><code>src/sage/misc/sphinxify.py: Use module-level # sage.doctest: optional - sphinx</code></td></tr></table>




---

archive/issue_comments_531478.json:
```json
{
    "body": "**Changing commit** from \"[be64b2551bc387870859565de7fef9bf9bb0b465](https://github.com/sagemath/sagetrac-mirror/commit/be64b2551bc387870859565de7fef9bf9bb0b465)\" to \"[be532a2ea74892a93e0a713531c84680da31ca9c](https://github.com/sagemath/sagetrac-mirror/commit/be532a2ea74892a93e0a713531c84680da31ca9c)\".",
    "created_at": "2021-11-13T23:19:33Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531478",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[be64b2551bc387870859565de7fef9bf9bb0b465](https://github.com/sagemath/sagetrac-mirror/commit/be64b2551bc387870859565de7fef9bf9bb0b465)" to "[be532a2ea74892a93e0a713531c84680da31ca9c](https://github.com/sagemath/sagetrac-mirror/commit/be532a2ea74892a93e0a713531c84680da31ca9c)".



---

archive/issue_comments_531479.json:
```json
{
    "body": "**Changing commit** from \"[be532a2ea74892a93e0a713531c84680da31ca9c](https://github.com/sagemath/sagetrac-mirror/commit/be532a2ea74892a93e0a713531c84680da31ca9c)\" to \"[6f8f8e05093d599ec50fcfacae067acbfe13ecff](https://github.com/sagemath/sagetrac-mirror/commit/6f8f8e05093d599ec50fcfacae067acbfe13ecff)\".",
    "created_at": "2021-11-13T23:34:49Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531479",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[be532a2ea74892a93e0a713531c84680da31ca9c](https://github.com/sagemath/sagetrac-mirror/commit/be532a2ea74892a93e0a713531c84680da31ca9c)" to "[6f8f8e05093d599ec50fcfacae067acbfe13ecff](https://github.com/sagemath/sagetrac-mirror/commit/6f8f8e05093d599ec50fcfacae067acbfe13ecff)".



---

archive/issue_comments_531480.json:
```json
{
    "body": "<a id='comment:96'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/86db7579d0b57a2981473b310163b5e38672e681\">86db757</a></td><td><code>src/sage/misc/bindable_class.py: In doctests, strip output of sage_getdoc</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0df932da537bb3424ae994dd05c9a1ea53256f0f\">0df932d</a></td><td><code>src/sage/misc/sageinspect.py: Make doctest pass even if sphinx formatting is not available</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f8f8e05093d599ec50fcfacae067acbfe13ecff\">6f8f8e0</a></td><td><code>src/sage/repl/ipython_tests.py: Make doctest pass even if sphinx formatting is not available</code></td></tr></table>\n",
    "created_at": "2021-11-13T23:34:49Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531480",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:96'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/86db7579d0b57a2981473b310163b5e38672e681">86db757</a></td><td><code>src/sage/misc/bindable_class.py: In doctests, strip output of sage_getdoc</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0df932da537bb3424ae994dd05c9a1ea53256f0f">0df932d</a></td><td><code>src/sage/misc/sageinspect.py: Make doctest pass even if sphinx formatting is not available</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f8f8e05093d599ec50fcfacae067acbfe13ecff">6f8f8e0</a></td><td><code>src/sage/repl/ipython_tests.py: Make doctest pass even if sphinx formatting is not available</code></td></tr></table>




---

archive/issue_comments_531481.json:
```json
{
    "body": "<a id='comment:97'></a>\nOn an Ubuntu virtual machine, I'm getting doctest failures (with `./configure --disable-doc`) because the `alabaster` package is not installed:\n\n```\nFile \"src/sage/misc/package.py\", line 388, in sage.misc.package.installed_packages\nFailed example:\n    sorted(installed_packages().keys())  # optional - build\nExpected:\n    [...'alabaster', ...'sage_conf', ...]\nGot:\n    ['appnope',\n     'arb',\n     'argcomplete',\n     'argon2_cffi',\n     'attrs',\n     'backcall',\n     'bleach',\n     'cddlib',\n     'certifi',\n     'cffi',\n     'charset_normalizer',\n     'combinatorial_designs',\n     'conway_polynomials',\n     'cvxopt',\n     'cycler',\n     'cypari',\n     'cysignals',\n     'cython',\n     'dateutil',\n     'debugpy',\n     'decorator',\n     'defusedxml',\n     'docutils',\n     'ecl',\n     'eclib',\n     'elliptic_curves',\n     'entrypoints',\n     'flint',\n     'flit_core',\n     'fplll',\n     'fpylll',\n     'gap',\n     'gengetopt',\n     'giac',\n     'gmpy2',\n     'graphs',\n     'html5lib',\n     'idna',\n     'importlib_metadata',\n     'importlib_resources',\n     'ipykernel',\n     'ipython',\n     'ipython_genutils',\n     'ipywidgets',\n     'jedi',\n     'jinja2',\n     'jmol',\n     'jsonschema',\n     'jupyter_client',\n     'jupyter_core',\n     'jupyter_jsmol',\n     'jupyterlab_pygments',\n     'kiwisolver',\n     'lcalc',\n     'linbox',\n     'markupsafe',\n     'mathjax',\n     'matplotlib',\n     'matplotlib_inline',\n     'maxima',\n     'memory_allocator',\n     'mistune',\n     'mpmath',\n     'nbclient',\n     'nbconvert',\n     'nbformat',\n     'nest_asyncio',\n     'networkx',\n     'notebook',\n     'numpy',\n     'packaging',\n     'pandocfilters',\n     'pari',\n     'pari_galdata',\n     'pari_seadata_small',\n     'parso',\n     'pexpect',\n     'pickleshare',\n     'pillow',\n     'pip',\n     'pkgconfig',\n     'pluggy',\n     'polytopes_db',\n     'pplpy',\n     'prometheus_client',\n     'prompt_toolkit',\n     'ptyprocess',\n     'py',\n     'pybind11',\n     'pycparser',\n     'pycygwin',\n     'pygments',\n     'pyparsing',\n     'pyrsistent',\n     'pytz',\n     'pyzmq',\n     'ratpoints',\n     'requests',\n     'rpy2',\n     'sage_conf',\n     'sage_setup',\n     'sagelib',\n     'sagenb_export',\n     'sagetex',\n     'scipy',\n     'send2trash',\n     'setuptools',\n     'setuptools_scm',\n     'setuptools_wheel',\n     'simplegeneric',\n     'singular',\n     'six',\n     'sympy',\n     'terminado',\n     'testpath',\n     'thebe',\n     'threejs',\n     'tomli',\n     'tornado',\n     'traitlets',\n     'typing_extensions',\n     'tzlocal',\n     'urllib3',\n     'vcversioner',\n     'wcwidth',\n     'webencodings',\n     'wheel',\n     'widgetsnbextension',\n     'zipp']\n**********************************************************************\nFile \"src/sage/misc/package.py\", line 390, in sage.misc.package.installed_packages\nFailed example:\n    installed_packages()['alabaster']  # optional - build, random\nException raised:\n    Traceback (most recent call last):\n      File \"/home/john/Sage/sage-9.5.beta5/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/john/Sage/sage-9.5.beta5/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.misc.package.installed_packages[1]>\", line 1, in <module>\n        installed_packages()['alabaster']  # optional - build, random\n    KeyError: 'alabaster'\n*********************************************************************\n```",
    "created_at": "2021-11-14T03:00:04Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531481",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:97'></a>
On an Ubuntu virtual machine, I'm getting doctest failures (with `./configure --disable-doc`) because the `alabaster` package is not installed:

```
File "src/sage/misc/package.py", line 388, in sage.misc.package.installed_packages
Failed example:
    sorted(installed_packages().keys())  # optional - build
Expected:
    [...'alabaster', ...'sage_conf', ...]
Got:
    ['appnope',
     'arb',
     'argcomplete',
     'argon2_cffi',
     'attrs',
     'backcall',
     'bleach',
     'cddlib',
     'certifi',
     'cffi',
     'charset_normalizer',
     'combinatorial_designs',
     'conway_polynomials',
     'cvxopt',
     'cycler',
     'cypari',
     'cysignals',
     'cython',
     'dateutil',
     'debugpy',
     'decorator',
     'defusedxml',
     'docutils',
     'ecl',
     'eclib',
     'elliptic_curves',
     'entrypoints',
     'flint',
     'flit_core',
     'fplll',
     'fpylll',
     'gap',
     'gengetopt',
     'giac',
     'gmpy2',
     'graphs',
     'html5lib',
     'idna',
     'importlib_metadata',
     'importlib_resources',
     'ipykernel',
     'ipython',
     'ipython_genutils',
     'ipywidgets',
     'jedi',
     'jinja2',
     'jmol',
     'jsonschema',
     'jupyter_client',
     'jupyter_core',
     'jupyter_jsmol',
     'jupyterlab_pygments',
     'kiwisolver',
     'lcalc',
     'linbox',
     'markupsafe',
     'mathjax',
     'matplotlib',
     'matplotlib_inline',
     'maxima',
     'memory_allocator',
     'mistune',
     'mpmath',
     'nbclient',
     'nbconvert',
     'nbformat',
     'nest_asyncio',
     'networkx',
     'notebook',
     'numpy',
     'packaging',
     'pandocfilters',
     'pari',
     'pari_galdata',
     'pari_seadata_small',
     'parso',
     'pexpect',
     'pickleshare',
     'pillow',
     'pip',
     'pkgconfig',
     'pluggy',
     'polytopes_db',
     'pplpy',
     'prometheus_client',
     'prompt_toolkit',
     'ptyprocess',
     'py',
     'pybind11',
     'pycparser',
     'pycygwin',
     'pygments',
     'pyparsing',
     'pyrsistent',
     'pytz',
     'pyzmq',
     'ratpoints',
     'requests',
     'rpy2',
     'sage_conf',
     'sage_setup',
     'sagelib',
     'sagenb_export',
     'sagetex',
     'scipy',
     'send2trash',
     'setuptools',
     'setuptools_scm',
     'setuptools_wheel',
     'simplegeneric',
     'singular',
     'six',
     'sympy',
     'terminado',
     'testpath',
     'thebe',
     'threejs',
     'tomli',
     'tornado',
     'traitlets',
     'typing_extensions',
     'tzlocal',
     'urllib3',
     'vcversioner',
     'wcwidth',
     'webencodings',
     'wheel',
     'widgetsnbextension',
     'zipp']
**********************************************************************
File "src/sage/misc/package.py", line 390, in sage.misc.package.installed_packages
Failed example:
    installed_packages()['alabaster']  # optional - build, random
Exception raised:
    Traceback (most recent call last):
      File "/home/john/Sage/sage-9.5.beta5/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/john/Sage/sage-9.5.beta5/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.package.installed_packages[1]>", line 1, in <module>
        installed_packages()['alabaster']  # optional - build, random
    KeyError: 'alabaster'
*********************************************************************
```



---

archive/issue_comments_531482.json:
```json
{
    "body": "<a id='comment:98'></a>\nAlso, and maybe this is just how it will have to be, if I use `./configure --disable-doc` and then `make` and then `make doc`, it installs `sphinx` and various other packages, prints a good error message when trying to install `pplpy_doc`, but of continues to install whatever it's in the middle of, so the error message gets buried.",
    "created_at": "2021-11-14T03:03:10Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531482",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:98'></a>
Also, and maybe this is just how it will have to be, if I use `./configure --disable-doc` and then `make` and then `make doc`, it installs `sphinx` and various other packages, prints a good error message when trying to install `pplpy_doc`, but of continues to install whatever it's in the middle of, so the error message gets buried.



---

archive/issue_comments_531483.json:
```json
{
    "body": "<a id='comment:99'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/180744645a429facd31a3400de228af174760f4c\">1807446</a></td><td><code>src/sage/misc/package.py: Use gmpy2 instead of alabaster as example in doctest</code></td></tr></table>\n",
    "created_at": "2021-11-14T03:14:10Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531483",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:99'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/180744645a429facd31a3400de228af174760f4c">1807446</a></td><td><code>src/sage/misc/package.py: Use gmpy2 instead of alabaster as example in doctest</code></td></tr></table>




---

archive/issue_comments_531484.json:
```json
{
    "body": "**Changing commit** from \"[6f8f8e05093d599ec50fcfacae067acbfe13ecff](https://github.com/sagemath/sagetrac-mirror/commit/6f8f8e05093d599ec50fcfacae067acbfe13ecff)\" to \"[180744645a429facd31a3400de228af174760f4c](https://github.com/sagemath/sagetrac-mirror/commit/180744645a429facd31a3400de228af174760f4c)\".",
    "created_at": "2021-11-14T03:14:10Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531484",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6f8f8e05093d599ec50fcfacae067acbfe13ecff](https://github.com/sagemath/sagetrac-mirror/commit/6f8f8e05093d599ec50fcfacae067acbfe13ecff)" to "[180744645a429facd31a3400de228af174760f4c](https://github.com/sagemath/sagetrac-mirror/commit/180744645a429facd31a3400de228af174760f4c)".



---

archive/issue_comments_531485.json:
```json
{
    "body": "<a id='comment:100'></a>\nReplying to [jhpalmieri](#comment%3A98):\n> Also, and maybe this is just how it will have to be, if I use `./configure --disable-doc` and then `make` and then `make doc`, it installs `sphinx` and various other packages, prints a good error message when trying to install `pplpy_doc`, but of continues to install whatever it's in the middle of, so the error message gets buried.\n\n\nI think it would be too complicated to check for disable-doc earlier",
    "created_at": "2021-11-14T03:18:07Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531485",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:100'></a>
Replying to [jhpalmieri](#comment%3A98):
> Also, and maybe this is just how it will have to be, if I use `./configure --disable-doc` and then `make` and then `make doc`, it installs `sphinx` and various other packages, prints a good error message when trying to install `pplpy_doc`, but of continues to install whatever it's in the middle of, so the error message gets buried.


I think it would be too complicated to check for disable-doc earlier



---

archive/issue_comments_531486.json:
```json
{
    "body": "<a id='comment:101'></a>\nReplying to [jhpalmieri](#comment%3A97):\n> On an Ubuntu virtual machine, I'm getting doctest failures (with `./configure --disable-doc`) because the `alabaster` package is not installed\n\n\nThis was also the last failure on my test with macOS, fixed in 1807446 above.",
    "created_at": "2021-11-14T18:57:52Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531486",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:101'></a>
Replying to [jhpalmieri](#comment%3A97):
> On an Ubuntu virtual machine, I'm getting doctest failures (with `./configure --disable-doc`) because the `alabaster` package is not installed


This was also the last failure on my test with macOS, fixed in 1807446 above.



---

archive/issue_comments_531487.json:
```json
{
    "body": "**Changing commit** from \"[180744645a429facd31a3400de228af174760f4c](https://github.com/sagemath/sagetrac-mirror/commit/180744645a429facd31a3400de228af174760f4c)\" to \"[f4aaa81007d7a9882d495784ce2635c5c989eed6](https://github.com/sagemath/sagetrac-mirror/commit/f4aaa81007d7a9882d495784ce2635c5c989eed6)\".",
    "created_at": "2021-11-14T19:06:39Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531487",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[180744645a429facd31a3400de228af174760f4c](https://github.com/sagemath/sagetrac-mirror/commit/180744645a429facd31a3400de228af174760f4c)" to "[f4aaa81007d7a9882d495784ce2635c5c989eed6](https://github.com/sagemath/sagetrac-mirror/commit/f4aaa81007d7a9882d495784ce2635c5c989eed6)".



---

archive/issue_comments_531488.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f4aaa81007d7a9882d495784ce2635c5c989eed6\">f4aaa81</a></td><td><code>README.md, build/make/install: Update - documentation no longer has special log file location</code></td></tr></table>\n",
    "created_at": "2021-11-14T19:06:39Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531488",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f4aaa81007d7a9882d495784ce2635c5c989eed6">f4aaa81</a></td><td><code>README.md, build/make/install: Update - documentation no longer has special log file location</code></td></tr></table>




---

archive/issue_comments_531489.json:
```json
{
    "body": "<a id='comment:3'></a>\n`make doc` now builds both html and pdf, whereas before it just built html. How many people will this surprise?",
    "created_at": "2021-11-15T03:37:38Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531489",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:3'></a>
`make doc` now builds both html and pdf, whereas before it just built html. How many people will this surprise?



---

archive/issue_comments_531490.json:
```json
{
    "body": "**Changing commit** from \"[f4aaa81007d7a9882d495784ce2635c5c989eed6](https://github.com/sagemath/sagetrac-mirror/commit/f4aaa81007d7a9882d495784ce2635c5c989eed6)\" to \"[651c986a80923ac973c69b1ab7c2b6dada468181](https://github.com/sagemath/sagetrac-mirror/commit/651c986a80923ac973c69b1ab7c2b6dada468181)\".",
    "created_at": "2021-11-15T03:54:04Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531490",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[f4aaa81007d7a9882d495784ce2635c5c989eed6](https://github.com/sagemath/sagetrac-mirror/commit/f4aaa81007d7a9882d495784ce2635c5c989eed6)" to "[651c986a80923ac973c69b1ab7c2b6dada468181](https://github.com/sagemath/sagetrac-mirror/commit/651c986a80923ac973c69b1ab7c2b6dada468181)".



---

archive/issue_comments_531491.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/651c986a80923ac973c69b1ab7c2b6dada468181\">651c986</a></td><td><code>build/make/Makefile.in (doc): Revert to just doc-html (not both doc-html and doc-pdf)</code></td></tr></table>\n",
    "created_at": "2021-11-15T03:54:04Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531491",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/651c986a80923ac973c69b1ab7c2b6dada468181">651c986</a></td><td><code>build/make/Makefile.in (doc): Revert to just doc-html (not both doc-html and doc-pdf)</code></td></tr></table>




---

archive/issue_comments_531492.json:
```json
{
    "body": "<a id='comment:5'></a>\nThanks for catching this; an unnecessary change",
    "created_at": "2021-11-15T03:55:09Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531492",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
Thanks for catching this; an unnecessary change



---

archive/issue_comments_531493.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,7 +1,6 @@\n This switch will disable the docbuild and installation of its many dependencies (sphinx...)\n \n-In contrast to other packages, `ppl`'s docbuild is enabled unless explicitly disabled by setting `SAGE_SPKG_INSTALL_DOCS=no`.\n-We conditionalize the dependency of `ppl` on this and also on `sphinx` being in the list of installed packages.\n+In contrast to other packages, `pplpy`'s docbuild is enabled unless explicitly disabled by setting `SAGE_SPKG_INSTALL_DOCS=no`. We move it to a separate package `pplpy_doc` and make it a dependency of `sagemath_doc_html`.\n \n Split out from #31396.\n \n``````\n",
    "created_at": "2021-11-15T04:28:28Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531493",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,7 +1,6 @@
 This switch will disable the docbuild and installation of its many dependencies (sphinx...)
 
-In contrast to other packages, `ppl`'s docbuild is enabled unless explicitly disabled by setting `SAGE_SPKG_INSTALL_DOCS=no`.
-We conditionalize the dependency of `ppl` on this and also on `sphinx` being in the list of installed packages.
+In contrast to other packages, `pplpy`'s docbuild is enabled unless explicitly disabled by setting `SAGE_SPKG_INSTALL_DOCS=no`. We move it to a separate package `pplpy_doc` and make it a dependency of `sagemath_doc_html`.
 
 Split out from #31396.
 
``````




---

archive/issue_comments_531494.json:
```json
{
    "body": "<a id='comment:7'></a>\nThis part obviously works, but let me see if I understand the syntax:\n\n```\n$(1)-$(4)-no-deps:\n\t+@if [ -z '$$($(4))' ]; then \\\n\t    echo \"Error: The installation tree $(4) has been disabled\" 2>&1; \\\n\t    echo \"$$($(4)_DISABLED_MESSAGE)\" 2>&1; \\\n\t    exit 1; \\\n```\nIs the following right? In the case of this ticket, `$(4)` is `SAGE_DOCS`, and then `$$($(4))` evaluates the Makefile variable `SAGE_DOCS`, which will be empty if docs have been disabled.",
    "created_at": "2021-11-16T04:00:29Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531494",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
This part obviously works, but let me see if I understand the syntax:

```
$(1)-$(4)-no-deps:
	+@if [ -z '$$($(4))' ]; then \
	    echo "Error: The installation tree $(4) has been disabled" 2>&1; \
	    echo "$$($(4)_DISABLED_MESSAGE)" 2>&1; \
	    exit 1; \
```
Is the following right? In the case of this ticket, `$(4)` is `SAGE_DOCS`, and then `$$($(4))` evaluates the Makefile variable `SAGE_DOCS`, which will be empty if docs have been disabled.



---

archive/issue_comments_531495.json:
```json
{
    "body": "<a id='comment:8'></a>\nThat's right.",
    "created_at": "2021-11-16T04:40:31Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531495",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
That's right.



---

archive/issue_comments_531496.json:
```json
{
    "body": "<a id='comment:9'></a>\nOkay, let's merge it.",
    "created_at": "2021-11-16T05:15:40Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531496",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>
Okay, let's merge it.



---

archive/issue_comments_531497.json:
```json
{
    "body": "**Reviewer:** John Palmieri, Matthias Koeppe",
    "created_at": "2021-11-16T05:15:40Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531497",
    "user": "https://github.com/jhpalmieri"
}
```

**Reviewer:** John Palmieri, Matthias Koeppe



---

archive/issue_events_293973.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2021-11-16T05:15:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293973"
}
```



---

archive/issue_events_293974.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2021-11-16T05:15:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293974"
}
```



---

archive/issue_comments_531498.json:
```json
{
    "body": "<a id='comment:0'></a>\nThank you!",
    "created_at": "2021-11-16T05:18:26Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531498",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:0'></a>
Thank you!



---

archive/issue_comments_531499.json:
```json
{
    "body": "**Changing commit** from \"[651c986a80923ac973c69b1ab7c2b6dada468181](https://github.com/sagemath/sagetrac-mirror/commit/651c986a80923ac973c69b1ab7c2b6dada468181)\" to \"[edaa3e621a85485d7a5536aa2e476d4ec9b3635c](https://github.com/sagemath/sagetrac-mirror/commit/edaa3e621a85485d7a5536aa2e476d4ec9b3635c)\".",
    "created_at": "2021-12-12T17:56:48Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531499",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[651c986a80923ac973c69b1ab7c2b6dada468181](https://github.com/sagemath/sagetrac-mirror/commit/651c986a80923ac973c69b1ab7c2b6dada468181)" to "[edaa3e621a85485d7a5536aa2e476d4ec9b3635c](https://github.com/sagemath/sagetrac-mirror/commit/edaa3e621a85485d7a5536aa2e476d4ec9b3635c)".



---

archive/issue_comments_531500.json:
```json
{
    "body": "<a id='comment:1'></a>\n**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/edaa3e621a85485d7a5536aa2e476d4ec9b3635c\">edaa3e6</a></td><td><code>Merge tag '9.5.beta8' into t/32759/__configure___disable_doc</code></td></tr></table>\n",
    "created_at": "2021-12-12T17:56:48Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531500",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>
**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/edaa3e621a85485d7a5536aa2e476d4ec9b3635c">edaa3e6</a></td><td><code>Merge tag '9.5.beta8' into t/32759/__configure___disable_doc</code></td></tr></table>




---

archive/issue_events_293975.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2021-12-12T17:56:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293975"
}
```



---

archive/issue_events_293976.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2021-12-12T17:56:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293976"
}
```



---

archive/issue_events_293977.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-12T17:57:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293977"
}
```



---

archive/issue_events_293978.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-12T17:57:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293978"
}
```



---

archive/issue_comments_531501.json:
```json
{
    "body": "**Changing dependencies** from \"#31356, #32745, #32836, #29039\" to \"#29039\".",
    "created_at": "2021-12-12T17:57:11Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531501",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#31356, #32745, #32836, #29039" to "#29039".



---

archive/issue_comments_531502.json:
```json
{
    "body": "**Changing commit** from \"[edaa3e621a85485d7a5536aa2e476d4ec9b3635c](https://github.com/sagemath/sagetrac-mirror/commit/edaa3e621a85485d7a5536aa2e476d4ec9b3635c)\" to \"[2dd7cf5bb2166cd25cb87ff48e46c722ecb841fa](https://github.com/sagemath/sagetrac-mirror/commit/2dd7cf5bb2166cd25cb87ff48e46c722ecb841fa)\".",
    "created_at": "2021-12-23T21:22:00Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531502",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[edaa3e621a85485d7a5536aa2e476d4ec9b3635c](https://github.com/sagemath/sagetrac-mirror/commit/edaa3e621a85485d7a5536aa2e476d4ec9b3635c)" to "[2dd7cf5bb2166cd25cb87ff48e46c722ecb841fa](https://github.com/sagemath/sagetrac-mirror/commit/2dd7cf5bb2166cd25cb87ff48e46c722ecb841fa)".



---

archive/issue_events_293979.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2021-12-23T21:22:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293979"
}
```



---

archive/issue_events_293980.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2021-12-23T21:22:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293980"
}
```



---

archive/issue_comments_531503.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2a4a32384133408ef05edb4f40b9d363697d3087\">2a4a323</a></td><td><code>Merge tag '9.5.beta7' into t/29039/pip_installable_package_sage_bootstrap</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a7fa5aa6eaa9af232a0fffb53cd023c30bfc17f2\">a7fa5aa</a></td><td><code>Merge #29039</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2dd7cf5bb2166cd25cb87ff48e46c722ecb841fa\">2dd7cf5</a></td><td><code>Merge tag '9.5.beta9' into t/32759/__configure___disable_doc</code></td></tr></table>\n",
    "created_at": "2021-12-23T21:22:00Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531503",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2a4a32384133408ef05edb4f40b9d363697d3087">2a4a323</a></td><td><code>Merge tag '9.5.beta7' into t/29039/pip_installable_package_sage_bootstrap</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a7fa5aa6eaa9af232a0fffb53cd023c30bfc17f2">a7fa5aa</a></td><td><code>Merge #29039</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2dd7cf5bb2166cd25cb87ff48e46c722ecb841fa">2dd7cf5</a></td><td><code>Merge tag '9.5.beta9' into t/32759/__configure___disable_doc</code></td></tr></table>




---

archive/issue_comments_531504.json:
```json
{
    "body": "<a id='comment:4'></a>\nMerged latest beta to resolve merge conflicts.",
    "created_at": "2021-12-23T21:22:30Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531504",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>
Merged latest beta to resolve merge conflicts.



---

archive/issue_events_293981.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2021-12-23T23:15:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293981"
}
```



---

archive/issue_events_293982.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2021-12-23T23:15:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293982"
}
```



---

archive/issue_comments_531505.json:
```json
{
    "body": "<a id='comment:6'></a>\nThanks!",
    "created_at": "2021-12-24T00:07:02Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531505",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>
Thanks!



---

archive/issue_comments_531506.json:
```json
{
    "body": "<a id='comment:7'></a>\nThere seems to be a merge gone wrong in `src/sage/doctest/control.py`.",
    "created_at": "2021-12-26T23:42:35Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531506",
    "user": "https://github.com/tornaria"
}
```

<a id='comment:7'></a>
There seems to be a merge gone wrong in `src/sage/doctest/control.py`.



---

archive/issue_events_293983.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-26T23:43:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293983"
}
```



---

archive/issue_events_293984.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-26T23:43:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293984"
}
```



---

archive/issue_comments_531507.json:
```json
{
    "body": "**Changing commit** from \"[2dd7cf5bb2166cd25cb87ff48e46c722ecb841fa](https://github.com/sagemath/sagetrac-mirror/commit/2dd7cf5bb2166cd25cb87ff48e46c722ecb841fa)\" to \"[2e0b91d13779f3797d8a93cd0e8f805ef3717ebc](https://github.com/sagemath/sagetrac-mirror/commit/2e0b91d13779f3797d8a93cd0e8f805ef3717ebc)\".",
    "created_at": "2021-12-26T23:52:46Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531507",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[2dd7cf5bb2166cd25cb87ff48e46c722ecb841fa](https://github.com/sagemath/sagetrac-mirror/commit/2dd7cf5bb2166cd25cb87ff48e46c722ecb841fa)" to "[2e0b91d13779f3797d8a93cd0e8f805ef3717ebc](https://github.com/sagemath/sagetrac-mirror/commit/2e0b91d13779f3797d8a93cd0e8f805ef3717ebc)".



---

archive/issue_comments_531508.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2e0b91d13779f3797d8a93cd0e8f805ef3717ebc\">2e0b91d</a></td><td><code>src/sage/doctest/control.py: Fix up merge</code></td></tr></table>\n",
    "created_at": "2021-12-26T23:52:46Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531508",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2e0b91d13779f3797d8a93cd0e8f805ef3717ebc">2e0b91d</a></td><td><code>src/sage/doctest/control.py: Fix up merge</code></td></tr></table>




---

archive/issue_events_293985.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-26T23:53:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293985"
}
```



---

archive/issue_events_293986.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-26T23:53:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293986"
}
```



---

archive/issue_events_293987.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-29T19:33:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293987"
}
```



---

archive/issue_events_293988.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-29T19:33:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293988"
}
```



---

archive/issue_comments_531509.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,8 +1,8 @@\n-This switch will disable the docbuild and installation of its many dependencies (sphinx...)\n+This switch will disable the docbuild and avoid installing its many dependencies (sphinx...).\n \n In contrast to other packages, `pplpy`'s docbuild is enabled unless explicitly disabled by setting `SAGE_SPKG_INSTALL_DOCS=no`. We move it to a separate package `pplpy_doc` and make it a dependency of `sagemath_doc_html`.\n \n Split out from #31396.\n \n-We also add another package to those that are disabled upon `--disable-notebook`.\n+We also add `argon2_cffi` and `nbclient` to the packages disabled upon `--disable-notebook`.\n \n``````\n",
    "created_at": "2021-12-30T01:25:25Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531509",
    "user": "https://github.com/slel"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,8 +1,8 @@
-This switch will disable the docbuild and installation of its many dependencies (sphinx...)
+This switch will disable the docbuild and avoid installing its many dependencies (sphinx...).
 
 In contrast to other packages, `pplpy`'s docbuild is enabled unless explicitly disabled by setting `SAGE_SPKG_INSTALL_DOCS=no`. We move it to a separate package `pplpy_doc` and make it a dependency of `sagemath_doc_html`.
 
 Split out from #31396.
 
-We also add another package to those that are disabled upon `--disable-notebook`.
+We also add `argon2_cffi` and `nbclient` to the packages disabled upon `--disable-notebook`.
 
``````




---

archive/issue_events_293989.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-12-31T10:30:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "blocker",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293989"
}
```



---

archive/issue_comments_531510.json:
```json
{
    "body": "<a id='comment:3'></a>\nthis fixes pdf building in the latest beta, hence blocker",
    "created_at": "2021-12-31T10:30:17Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531510",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>
this fixes pdf building in the latest beta, hence blocker



---

archive/issue_events_293990.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-01-01T20:15:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293990"
}
```



---

archive/issue_events_293991.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-01-01T20:15:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293991"
}
```



---

archive/issue_comments_531511.json:
```json
{
    "body": "<a id='comment:4'></a>\nStill broken for me\n\n```\n$ make doc-clean\n$ make doc-pdf\n[...]\n[sagemath_doc_pdf-none] LaTeX2e <2020-10-01> patch level 4\n[sagemath_doc_pdf-none] L3 programming layer <2021-05-07>\n[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/latex/oberdiek/hypcap.sty))))\n[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/latex/titlesec/titlesec.sty [91\n[sagemath_doc_pdf-none] (./sphinxlatexnumfig.sty (./sphinxmanual.cls])\n[sagemath_doc_pdf-none] (./sphinxmessages.sty\n[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/generic/babel/babel.sty) (./sphinxlatexlists.sty)\n[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/latex/amsfonts/umsb.fd)\n[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/generic/babel/babel.def\n[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/latex/jknapltx/ursfs.fd))) (./sphinxpackagefootnote.sty\n[sagemath_doc_pdf-none] \n[sagemath_doc_pdf-none] (./sphinxlatexstyletext.sty\n[sagemath_doc_pdf-none] Document Class: sphinxmanual 2019/12/01 v2.3.0 Document class (Sphinx manual)\n[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/latex/base/report.cls))\n[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/latex/jknapltx/mathrsfs.sty) (./sphinxlatexobjects.sty\n[sagemath_doc_pdf-none] Document Class: report 2020/04/10 v1.4m Standard LaTeX document class\n[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/latex/base/size10.clo\n[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/generic/babel/txtbabel.def) [1 (./sphinxlatexindbibtoc.sty){/usr/share/texli\n[sagemath_doc_pdf-none] ve/texmf-var/fonts/map/pdftex/updmap/pdftex.map)))\n[sagemath_doc_pdf-none] \n[sagemath_doc_pdf-none] LaTeX Warning: File `{../../../../../local/share/doc/sage/doctrees/en/reference\n[sagemath_doc_pdf-none] /plot_directive/sage/combinat/crystals/mv_polytopes-1}.pdf' not found on input \n[sagemath_doc_pdf-none] line 47273.\n[sagemath_doc_pdf-none] \n[sagemath_doc_pdf-none] \n[sagemath_doc_pdf-none] LaTeX Warning: File `{../../../../../local/share/doc/sage/doctrees/en/reference\n[sagemath_doc_pdf-none] /plot_directive/sage/combinat/crystals/mv_polytopes-1}.pdf' not found on input \n[sagemath_doc_pdf-none] line 47273.\n[sagemath_doc_pdf-none] \n[sagemath_doc_pdf-none] \n[sagemath_doc_pdf-none] ! Package pdftex.def Error: File `../../../../../local/share/doc/sage/doctrees/\n[sagemath_doc_pdf-none] en/reference/plot_directive/sage/combinat/crystals/mv_polytopes-1.pdf' not foun\n[sagemath_doc_pdf-none] d: using draft setting.\n[sagemath_doc_pdf-none] \n[sagemath_doc_pdf-none] See the pdftex.def package documentation for explanation.\n[sagemath_doc_pdf-none] Type  H <return>  for immediate help.\n[sagemath_doc_pdf-none]  ...                                              \n[sagemath_doc_pdf-none]                                                   \n[sagemath_doc_pdf-none] l.47273 .../combinat/crystals/mv_polytopes-1}.pdf}\n[sagemath_doc_pdf-none]                                                   \n[sagemath_doc_pdf-none] ? Latexmk: Index file 'constructions.idx' was written\n[sagemath_doc_pdf-none] \n[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/latex/base/makeidx.sty))))\n[sagemath_doc_pdf-none] ! Emergency stop.\n```\nAlso this runs in `/home/release/Sage/local/share/doc/sage/latex/en/reference/combinat` and `../../../../../local/share/doc/sage/doctrees/en/reference/plot_directive/sage/combinat/crystals/mv_polytopes-1` is missing `../../..`, how can that ever work?",
    "created_at": "2022-01-01T20:15:52Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531511",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:4'></a>
Still broken for me

```
$ make doc-clean
$ make doc-pdf
[...]
[sagemath_doc_pdf-none] LaTeX2e <2020-10-01> patch level 4
[sagemath_doc_pdf-none] L3 programming layer <2021-05-07>
[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/latex/oberdiek/hypcap.sty))))
[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/latex/titlesec/titlesec.sty [91
[sagemath_doc_pdf-none] (./sphinxlatexnumfig.sty (./sphinxmanual.cls])
[sagemath_doc_pdf-none] (./sphinxmessages.sty
[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/generic/babel/babel.sty) (./sphinxlatexlists.sty)
[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/latex/amsfonts/umsb.fd)
[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/generic/babel/babel.def
[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/latex/jknapltx/ursfs.fd))) (./sphinxpackagefootnote.sty
[sagemath_doc_pdf-none] 
[sagemath_doc_pdf-none] (./sphinxlatexstyletext.sty
[sagemath_doc_pdf-none] Document Class: sphinxmanual 2019/12/01 v2.3.0 Document class (Sphinx manual)
[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/latex/base/report.cls))
[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/latex/jknapltx/mathrsfs.sty) (./sphinxlatexobjects.sty
[sagemath_doc_pdf-none] Document Class: report 2020/04/10 v1.4m Standard LaTeX document class
[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/latex/base/size10.clo
[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/generic/babel/txtbabel.def) [1 (./sphinxlatexindbibtoc.sty){/usr/share/texli
[sagemath_doc_pdf-none] ve/texmf-var/fonts/map/pdftex/updmap/pdftex.map)))
[sagemath_doc_pdf-none] 
[sagemath_doc_pdf-none] LaTeX Warning: File `{../../../../../local/share/doc/sage/doctrees/en/reference
[sagemath_doc_pdf-none] /plot_directive/sage/combinat/crystals/mv_polytopes-1}.pdf' not found on input 
[sagemath_doc_pdf-none] line 47273.
[sagemath_doc_pdf-none] 
[sagemath_doc_pdf-none] 
[sagemath_doc_pdf-none] LaTeX Warning: File `{../../../../../local/share/doc/sage/doctrees/en/reference
[sagemath_doc_pdf-none] /plot_directive/sage/combinat/crystals/mv_polytopes-1}.pdf' not found on input 
[sagemath_doc_pdf-none] line 47273.
[sagemath_doc_pdf-none] 
[sagemath_doc_pdf-none] 
[sagemath_doc_pdf-none] ! Package pdftex.def Error: File `../../../../../local/share/doc/sage/doctrees/
[sagemath_doc_pdf-none] en/reference/plot_directive/sage/combinat/crystals/mv_polytopes-1.pdf' not foun
[sagemath_doc_pdf-none] d: using draft setting.
[sagemath_doc_pdf-none] 
[sagemath_doc_pdf-none] See the pdftex.def package documentation for explanation.
[sagemath_doc_pdf-none] Type  H <return>  for immediate help.
[sagemath_doc_pdf-none]  ...                                              
[sagemath_doc_pdf-none]                                                   
[sagemath_doc_pdf-none] l.47273 .../combinat/crystals/mv_polytopes-1}.pdf}
[sagemath_doc_pdf-none]                                                   
[sagemath_doc_pdf-none] ? Latexmk: Index file 'constructions.idx' was written
[sagemath_doc_pdf-none] 
[sagemath_doc_pdf-none] (/usr/share/texlive/texmf-dist/tex/latex/base/makeidx.sty))))
[sagemath_doc_pdf-none] ! Emergency stop.
```
Also this runs in `/home/release/Sage/local/share/doc/sage/latex/en/reference/combinat` and `../../../../../local/share/doc/sage/doctrees/en/reference/plot_directive/sage/combinat/crystals/mv_polytopes-1` is missing `../../..`, how can that ever work?



---

archive/issue_comments_531512.json:
```json
{
    "body": "<a id='comment:5'></a>\nHow is this `needs_work` for this ticket if it's already broken in 9.5.beta9?",
    "created_at": "2022-01-01T20:20:26Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531512",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
How is this `needs_work` for this ticket if it's already broken in 9.5.beta9?



---

archive/issue_events_293992.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-01T20:46:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293992"
}
```



---

archive/issue_events_293993.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-01T20:46:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293993"
}
```



---

archive/issue_comments_531513.json:
```json
{
    "body": "<a id='comment:7'></a>\nNote that since #29310, you need to use `make doc-uninstall` to get rid of the stuff in `local/share/doc/sage`.",
    "created_at": "2022-01-01T21:11:12Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531513",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
Note that since #29310, you need to use `make doc-uninstall` to get rid of the stuff in `local/share/doc/sage`.



---

archive/issue_comments_531514.json:
```json
{
    "body": "<a id='comment:8'></a>\nSo `make doc-clean` doesn't clean any more? We tell people (in the console output, among other places, to run that if they are having trouble with incremental doc builds.\n\nThis ticket was supposed to fix #33076 but apparently didn't (or, possibly, the ...-clean targets are totally broken). Are incremental builds still supported?",
    "created_at": "2022-01-01T23:21:01Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531514",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:8'></a>
So `make doc-clean` doesn't clean any more? We tell people (in the console output, among other places, to run that if they are having trouble with incremental doc builds.

This ticket was supposed to fix #33076 but apparently didn't (or, possibly, the ...-clean targets are totally broken). Are incremental builds still supported?



---

archive/issue_comments_531515.json:
```json
{
    "body": "<a id='comment:129'></a>\nReplying to [vbraun](#comment%3A128):\n> This ticket was supposed to fix #33076 but apparently didn't \n\n\nI don't think anyone has been able to reproduce the failure that you reported in #33076.",
    "created_at": "2022-01-01T23:37:01Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531515",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:129'></a>
Replying to [vbraun](#comment%3A128):
> This ticket was supposed to fix #33076 but apparently didn't 


I don't think anyone has been able to reproduce the failure that you reported in #33076.



---

archive/issue_comments_531516.json:
```json
{
    "body": "<a id='comment:130'></a>\nReplying to [vbraun](#comment%3A128):\n> So `make doc-clean` doesn't clean any more? \n\n\nWasn't me, but I think it was intended as a step in the direction of fixing the \"clean\" vs. \"uninstall\" confusion in the Sage build system. More in #21775 and #29097.",
    "created_at": "2022-01-01T23:39:18Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531516",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:130'></a>
Replying to [vbraun](#comment%3A128):
> So `make doc-clean` doesn't clean any more? 


Wasn't me, but I think it was intended as a step in the direction of fixing the "clean" vs. "uninstall" confusion in the Sage build system. More in #21775 and #29097.



---

archive/issue_comments_531517.json:
```json
{
    "body": "<a id='comment:131'></a>\nReplying to [vbraun](#comment%3A128):\n> So `make doc-clean` doesn't clean any more? We tell people (in the console output, among other places, to run that if they are having trouble with incremental doc builds.\n\n\nThat's a good point: see #33104.",
    "created_at": "2022-01-01T23:48:43Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531517",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:131'></a>
Replying to [vbraun](#comment%3A128):
> So `make doc-clean` doesn't clean any more? We tell people (in the console output, among other places, to run that if they are having trouble with incremental doc builds.


That's a good point: see #33104.



---

archive/issue_comments_531518.json:
```json
{
    "body": "<a id='comment:132'></a>\nReplying to [vbraun](#comment%3A128):\n> So `make doc-clean` doesn't clean any more? We tell people (in the console output, among other places, to run that if they are having trouble with incremental doc builds.\n\n\nAfter #29310, `make doc-clean` removes the autogenerated stuff in `src/doc/en/reference`, and `make doc-uninstall` removes the built documentation.",
    "created_at": "2022-01-01T23:56:08Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531518",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:132'></a>
Replying to [vbraun](#comment%3A128):
> So `make doc-clean` doesn't clean any more? We tell people (in the console output, among other places, to run that if they are having trouble with incremental doc builds.


After #29310, `make doc-clean` removes the autogenerated stuff in `src/doc/en/reference`, and `make doc-uninstall` removes the built documentation.



---

archive/issue_comments_531519.json:
```json
{
    "body": "<a id='comment:3'></a>\nSee also ticket:29097#comment:9.",
    "created_at": "2022-01-01T23:57:16Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531519",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:3'></a>
See also ticket:29097#comment:9.



---

archive/issue_comments_531520.json:
```json
{
    "body": "<a id='comment:4'></a>\nOf course a bit of weirdness there is that the inventories / pickles are both input and output for the docbuild.",
    "created_at": "2022-01-01T23:58:31Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531520",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>
Of course a bit of weirdness there is that the inventories / pickles are both input and output for the docbuild.



---

archive/issue_comments_531521.json:
```json
{
    "body": "<a id='comment:5'></a>\nI did a full rebuild after `git clean -f -d -x` and pdf docs still don't build, same failure.",
    "created_at": "2022-01-02T00:52:49Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531521",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:5'></a>
I did a full rebuild after `git clean -f -d -x` and pdf docs still don't build, same failure.



---

archive/issue_comments_531522.json:
```json
{
    "body": "<a id='comment:136'></a>\nReplying to [vbraun](#comment%3A135):\n> I did a full rebuild after `git clean -f -d -x` and pdf docs still don't build, same failure.\n\n\nWhat OS etc are you running this on? Any manually tweaked TeX stuff?",
    "created_at": "2022-01-02T09:19:13Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531522",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:136'></a>
Replying to [vbraun](#comment%3A135):
> I did a full rebuild after `git clean -f -d -x` and pdf docs still don't build, same failure.


What OS etc are you running this on? Any manually tweaked TeX stuff?



---

archive/issue_comments_531523.json:
```json
{
    "body": "<a id='comment:7'></a>\nI'm running Fedora 35, standard OS-wide latex installation. Also the path is wrong inside the TeX file, so the issue is already there before TeX runs.",
    "created_at": "2022-01-02T11:47:08Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531523",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:7'></a>
I'm running Fedora 35, standard OS-wide latex installation. Also the path is wrong inside the TeX file, so the issue is already there before TeX runs.



---

archive/issue_events_293994.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-01-02T17:20:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293994"
}
```



---

archive/issue_events_293995.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-01-02T17:20:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293995"
}
```



---

archive/issue_comments_531524.json:
```json
{
    "body": "<a id='comment:8'></a>\nTests fail",
    "created_at": "2022-01-02T17:20:54Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531524",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:8'></a>
Tests fail



---

archive/issue_events_293996.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-02T22:10:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293996"
}
```



---

archive/issue_events_293997.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-02T22:10:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293997"
}
```



---

archive/issue_comments_531525.json:
```json
{
    "body": "<a id='comment:9'></a>\nWhich ones.",
    "created_at": "2022-01-02T22:10:32Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531525",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>
Which ones.



---

archive/issue_comments_531526.json:
```json
{
    "body": "<a id='comment:0'></a>\n**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/43221d0e3dca1c33687d5073e1f1d7a446eed976\">43221d0</a></td><td><code>src/sage/features/sagemath.py: Fix doctest output</code></td></tr></table>\n",
    "created_at": "2022-01-02T22:59:39Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531526",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>
**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/43221d0e3dca1c33687d5073e1f1d7a446eed976">43221d0</a></td><td><code>src/sage/features/sagemath.py: Fix doctest output</code></td></tr></table>




---

archive/issue_events_293998.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2022-01-02T22:59:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293998"
}
```



---

archive/issue_events_293999.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2022-01-02T22:59:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-293999"
}
```



---

archive/issue_comments_531527.json:
```json
{
    "body": "**Changing commit** from \"[2e0b91d13779f3797d8a93cd0e8f805ef3717ebc](https://github.com/sagemath/sagetrac-mirror/commit/2e0b91d13779f3797d8a93cd0e8f805ef3717ebc)\" to \"[43221d0e3dca1c33687d5073e1f1d7a446eed976](https://github.com/sagemath/sagetrac-mirror/commit/43221d0e3dca1c33687d5073e1f1d7a446eed976)\".",
    "created_at": "2022-01-02T22:59:39Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531527",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[2e0b91d13779f3797d8a93cd0e8f805ef3717ebc](https://github.com/sagemath/sagetrac-mirror/commit/2e0b91d13779f3797d8a93cd0e8f805ef3717ebc)" to "[43221d0e3dca1c33687d5073e1f1d7a446eed976](https://github.com/sagemath/sagetrac-mirror/commit/43221d0e3dca1c33687d5073e1f1d7a446eed976)".



---

archive/issue_events_294000.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-02T23:01:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-294000"
}
```



---

archive/issue_events_294001.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-02T23:01:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-294001"
}
```



---

archive/issue_events_294002.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-01-09T10:47:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-294002"
}
```



---

archive/issue_events_294003.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-01-09T10:47:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32759#event-294003"
}
```



---

archive/issue_comments_531528.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/__configure___disable_doc](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/__configure___disable_doc)\" to \"[43221d0e3dca1c33687d5073e1f1d7a446eed976](https://github.com/sagemath/sagetrac-mirror/commit/43221d0e3dca1c33687d5073e1f1d7a446eed976)\".",
    "created_at": "2022-01-09T10:47:16Z",
    "issue": "https://github.com/sagemath/sage/issues/32759",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32759#issuecomment-531528",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mkoeppe/__configure___disable_doc](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/__configure___disable_doc)" to "[43221d0e3dca1c33687d5073e1f1d7a446eed976](https://github.com/sagemath/sagetrac-mirror/commit/43221d0e3dca1c33687d5073e1f1d7a446eed976)".
