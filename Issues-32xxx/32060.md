# Issue 32060: configure: Change defaults to --with-system-gcc=force, defer error exits after system package info is shown

archive/issues_031823.json:
```json
{
    "body": "This will make it an error if no suitable system `gcc` is found.\n\nIt can be overridden by the user by `--without-system-gcc`. Our `gcc` stands out from other SPKGs because building it often fails, for example because suitable binutils are lacking.  \n\n(from https://groups.google.com/g/sage-devel/c/cSsAsPuVnxg/m/fDBOSaYZBgAJ)\n\n\nCurrently, `force` leads to immediate exit, without printing the system package advice. We also change this.  This is a useful improvement in its own right.\n\n\nDiscussion of other packages to which the same logic should be applied is beyond the scope of the present ticket.\n\n\n\nCC:  @dimpase @seblabbe @slel @kliem @orlitzky @vbraun\n\nReviewer: Dima Pasechnik\n\nAuthor: Matthias Koeppe\n\nBranch: 19efe2125c0903a52011390850122651ceccb6d6\n\nCommit: 19efe2125c0903a52011390850122651ceccb6d6\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/32060\n\n",
    "closed_at": "2021-09-25T23:18:13Z",
    "created_at": "2021-06-25T16:34:29Z",
    "labels": [
        "component: build: configure"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "configure: Change defaults to --with-system-gcc=force, defer error exits after system package info is shown",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32060",
    "user": "https://github.com/mkoeppe"
}
```
This will make it an error if no suitable system `gcc` is found.

It can be overridden by the user by `--without-system-gcc`. Our `gcc` stands out from other SPKGs because building it often fails, for example because suitable binutils are lacking.  

(from https://groups.google.com/g/sage-devel/c/cSsAsPuVnxg/m/fDBOSaYZBgAJ)


Currently, `force` leads to immediate exit, without printing the system package advice. We also change this.  This is a useful improvement in its own right.


Discussion of other packages to which the same logic should be applied is beyond the scope of the present ticket.



CC:  @dimpase @seblabbe @slel @kliem @orlitzky @vbraun

Reviewer: Dima Pasechnik

Author: Matthias Koeppe

Branch: 19efe2125c0903a52011390850122651ceccb6d6

Commit: 19efe2125c0903a52011390850122651ceccb6d6

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/32060





---

archive/issue_comments_454244.json:
```json
{
    "body": "<a id='comment:2'></a>#30863 has a related proposal.",
    "created_at": "2021-06-25T18:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454244",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>#30863 has a related proposal.



---

archive/issue_comments_454245.json:
```json
{
    "body": "<a id='comment:4'></a>Here's a beginning. `./bootstrap && ./configure --with-system-libsemigroups=force --with-system-pari_galpol=force` on homebrew (which does not have these packages) now leads to:\n\n```\nconfigure:\n\n    notice: the following SPKGs did not find equivalent system packages:\n\n          _recommended coxeter3 gp2c igraph libsemigroups pari_elldata pari_galpol pari_nftables pari_seadata perl_cpan_polymake_prereq perl_mongodb\n        \n[...irrelevant system package advice...]\n\nconfigure: error: \n\n    Given --with-system-libsemigroups=force, but no system package could be used.\n    That's an error.  Please install the indicated package to continue.\n    (To override this error, use ./configure --without-system-libsemigroups)\n    Given --with-system-pari_galpol=force, but no system package could be used.\n    That's an error.  Please install the indicated package to continue.\n    (To override this error, use ./configure --without-system-pari_galpol)\n```\n\nFeel free to make refinements to the wording by pushing to this ticket...\n\n---\nNew commits:",
    "created_at": "2021-06-26T02:08:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454245",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>Here's a beginning. `./bootstrap && ./configure --with-system-libsemigroups=force --with-system-pari_galpol=force` on homebrew (which does not have these packages) now leads to:

```
configure:

    notice: the following SPKGs did not find equivalent system packages:

          _recommended coxeter3 gp2c igraph libsemigroups pari_elldata pari_galpol pari_nftables pari_seadata perl_cpan_polymake_prereq perl_mongodb
        
[...irrelevant system package advice...]

configure: error: 

    Given --with-system-libsemigroups=force, but no system package could be used.
    That's an error.  Please install the indicated package to continue.
    (To override this error, use ./configure --without-system-libsemigroups)
    Given --with-system-pari_galpol=force, but no system package could be used.
    That's an error.  Please install the indicated package to continue.
    (To override this error, use ./configure --without-system-pari_galpol)
```

Feel free to make refinements to the wording by pushing to this ticket...

---
New commits:



---

archive/issue_comments_454246.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-06-26T02:13:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454246",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_454247.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-06-26T02:28:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454247",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_454248.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-06-26T02:28:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454248",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_454249.json:
```json
{
    "body": "<a id='comment:9'></a>The discussion that led to the ticket has ended, but the ticket with the solution still needs review.",
    "created_at": "2021-06-28T16:46:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454249",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>The discussion that led to the ticket has ended, but the ticket with the solution still needs review.



---

archive/issue_comments_454250.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-06-29T06:38:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454250",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_454251.json:
```json
{
    "body": "<a id='comment:10'></a>Need to override these changed defaults in tox.ini, or all `-minimal` builds will fail",
    "created_at": "2021-06-29T06:38:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454251",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>Need to override these changed defaults in tox.ini, or all `-minimal` builds will fail



---

archive/issue_comments_454252.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-06-29T07:13:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454252",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_454253.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-06-29T07:14:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454253",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_454254.json:
```json
{
    "body": "<a id='comment:13'></a>Still needs review",
    "created_at": "2021-07-26T17:48:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454254",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>Still needs review



---

archive/issue_events_084846.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32060#event-84846"
}
```



---

archive/issue_comments_454255.json:
```json
{
    "body": "<a id='comment:15'></a>Let's get this in please.",
    "created_at": "2021-09-15T00:53:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454255",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>Let's get this in please.



---

archive/issue_comments_454256.json:
```json
{
    "body": "<a id='comment:16'></a>Why `--with-system-python3=force`? I can understand gcc, since building gcc can take a long time and maybe can be a little finicky, but why Python?",
    "created_at": "2021-09-15T16:11:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454256",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:16'></a>Why `--with-system-python3=force`? I can understand gcc, since building gcc can take a long time and maybe can be a little finicky, but why Python?



---

archive/issue_comments_454257.json:
```json
{
    "body": "<a id='comment:17'></a>I don't have a strong preference on the default for `python3`. I can undo this change",
    "created_at": "2021-09-15T16:20:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454257",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>I don't have a strong preference on the default for `python3`. I can undo this change



---

archive/issue_comments_454258.json:
```json
{
    "body": "<a id='comment:18'></a>I don't think I have a strong preference either, I was asking for the reason behind the proposed change.",
    "created_at": "2021-09-15T16:48:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454258",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:18'></a>I don't think I have a strong preference either, I was asking for the reason behind the proposed change.



---

archive/issue_comments_454259.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-09-15T17:36:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454259",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_454260.json:
```json
{
    "body": "<a id='comment:20'></a>Let's do the more limited change.",
    "created_at": "2021-09-15T17:36:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454260",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>Let's do the more limited change.



---

archive/issue_comments_454261.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:18 jhpalmieri]:\n> I don't think I have a strong preference either, I was asking for the reason behind the proposed change.\n\n\nthe proposal was to minimize unnecessary tricky package building on a typical system.\nTypically Python3.7 or newer is available.",
    "created_at": "2021-09-16T08:59:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454261",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:23'></a>Replying to [comment:18 jhpalmieri]:
> I don't think I have a strong preference either, I was asking for the reason behind the proposed change.


the proposal was to minimize unnecessary tricky package building on a typical system.
Typically Python3.7 or newer is available.



---

archive/issue_comments_454262.json:
```json
{
    "body": "<a id='comment:24'></a>Is the tricky part (for building Python) making sure that ssl is available?",
    "created_at": "2021-09-16T15:58:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454262",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:24'></a>Is the tricky part (for building Python) making sure that ssl is available?



---

archive/issue_comments_454263.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [comment:24 jhpalmieri]:\n> Is the tricky part (for building Python) making sure that ssl is available?\n\nthat's one of tricky parts for sure, in particular on macOS.",
    "created_at": "2021-09-16T16:32:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454263",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:25'></a>Replying to [comment:24 jhpalmieri]:
> Is the tricky part (for building Python) making sure that ssl is available?

that's one of tricky parts for sure, in particular on macOS.



---

archive/issue_comments_454264.json:
```json
{
    "body": "<a id='comment:26'></a>No, the ssl problems are all gone since we made the openssl package (3.0) standard.\n\nI don't think there are build problems with python3 on any of our platforms -- with the exception of builds on top of conda on Linux (which is currently broken in multiple ways)\n\nI think the point was just that some (new) users are surprised that we build our own python. But in contrast to the gcc build, which rarely works at all, building python3 is very robust. So I don't think this warrants the change of defaults.",
    "created_at": "2021-09-16T16:32:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454264",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>No, the ssl problems are all gone since we made the openssl package (3.0) standard.

I don't think there are build problems with python3 on any of our platforms -- with the exception of builds on top of conda on Linux (which is currently broken in multiple ways)

I think the point was just that some (new) users are surprised that we build our own python. But in contrast to the gcc build, which rarely works at all, building python3 is very robust. So I don't think this warrants the change of defaults.



---

archive/issue_comments_454265.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:26 mkoeppe]:\n> No, the ssl problems are all gone since we made the openssl package (3.0) standard.\n> \n> I don't think there are build problems with python3 on any of our platforms -- with the exception of builds on top of conda on Linux (which is currently broken in multiple ways)\n> \n> I think the point was just that some (new) users are surprised that we build our own python. But in contrast to the gcc build, which rarely works at all, building python3 is very robust. So I don't think this warrants the change of defaults.\n> \n\n\nWhat's the point of building Python, and other packages which are just a click away, such as GMP? To accelerate global warming?",
    "created_at": "2021-09-16T17:11:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454265",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:27'></a>Replying to [comment:26 mkoeppe]:
> No, the ssl problems are all gone since we made the openssl package (3.0) standard.
> 
> I don't think there are build problems with python3 on any of our platforms -- with the exception of builds on top of conda on Linux (which is currently broken in multiple ways)
> 
> I think the point was just that some (new) users are surprised that we build our own python. But in contrast to the gcc build, which rarely works at all, building python3 is very robust. So I don't think this warrants the change of defaults.
> 


What's the point of building Python, and other packages which are just a click away, such as GMP? To accelerate global warming?



---

archive/issue_comments_454266.json:
```json
{
    "body": "<a id='comment:28'></a>Replying to [comment:27 dimpase]:\n> \n> What's the point of building Python, and other packages which are just a click away, such as GMP? To accelerate global warming?\n\n\nIt also ensures that downloading the source release wastes a few hundred megabytes of bandwidth and then disk space.\n\nWe should eliminate the gcc and python SPKGs entirely. They serve no purpose at all, and require constant maintenance, support, and physical resources. In the rare case where gcc or python3 are not available from a package manager or binary download, using conda or nix is preferable to using the sage spkg.",
    "created_at": "2021-09-16T17:30:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454266",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:28'></a>Replying to [comment:27 dimpase]:
> 
> What's the point of building Python, and other packages which are just a click away, such as GMP? To accelerate global warming?


It also ensures that downloading the source release wastes a few hundred megabytes of bandwidth and then disk space.

We should eliminate the gcc and python SPKGs entirely. They serve no purpose at all, and require constant maintenance, support, and physical resources. In the rare case where gcc or python3 are not available from a package manager or binary download, using conda or nix is preferable to using the sage spkg.



---

archive/issue_comments_454267.json:
```json
{
    "body": "<a id='comment:29'></a>Let's kindly not use this technical ticket to rehash this fruitless discussion.",
    "created_at": "2021-09-16T17:43:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454267",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>Let's kindly not use this technical ticket to rehash this fruitless discussion.



---

archive/issue_comments_454268.json:
```json
{
    "body": "<a id='comment:30'></a>Needs review.",
    "created_at": "2021-09-16T17:43:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454268",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:30'></a>Needs review.



---

archive/issue_comments_454269.json:
```json
{
    "body": "<a id='comment:31'></a>Well, someone asked \"what's the point?\" The benefits of deleting the SPKGs are clear. The benefits of changing them to \"force\" by default are less clear, since we will still be responsible for shipping and maintaining SPKGs that will never get used. (Using `--without-system-gcc` is always a mistake, and likewise for python3.)\n\nNevertheless, setting them to \"force\" can be seen as step towards removal, so I'm not against it. I just don't think it solves the issue that prompted the mailing list thread -- that we are involved in this mess in the first place. All of the core packages that are available everywhere and are well-supported (for multiple versions) in sage should be relegated to _prereq or _bootstrap.",
    "created_at": "2021-09-16T18:26:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454269",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:31'></a>Well, someone asked "what's the point?" The benefits of deleting the SPKGs are clear. The benefits of changing them to "force" by default are less clear, since we will still be responsible for shipping and maintaining SPKGs that will never get used. (Using `--without-system-gcc` is always a mistake, and likewise for python3.)

Nevertheless, setting them to "force" can be seen as step towards removal, so I'm not against it. I just don't think it solves the issue that prompted the mailing list thread -- that we are involved in this mess in the first place. All of the core packages that are available everywhere and are well-supported (for multiple versions) in sage should be relegated to _prereq or _bootstrap.



---

archive/issue_comments_454270.json:
```json
{
    "body": "<a id='comment:32'></a>Replying to [comment:29 mkoeppe]:\n> Let's kindly not use this technical ticket to rehash this fruitless discussion. \n\n\ntechnically there is no need to keep gcc and python3 packages in Sage.",
    "created_at": "2021-09-16T19:41:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454270",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:32'></a>Replying to [comment:29 mkoeppe]:
> Let's kindly not use this technical ticket to rehash this fruitless discussion. 


technically there is no need to keep gcc and python3 packages in Sage.



---

archive/issue_comments_454271.json:
```json
{
    "body": "<a id='comment:33'></a>that's just, like, your opinion, man",
    "created_at": "2021-09-16T19:42:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454271",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'></a>that's just, like, your opinion, man



---

archive/issue_comments_454272.json:
```json
{
    "body": "<a id='comment:34'></a>First, the help string in `./configure` still says that \"yes\" is the default for `--with-system-gcc`. Second, if I don't have `gcc` at all, then `./configure` stops before it prints the message, saying\n\n```\nconfigure: error: no acceptable C compiler found in $PATH\nSee `config.log' for more details\n```\nThird, should this also test for `gfortran`, or should we continue to build that without complaining? It would be nice on a platform like OS X to just quit with an error if `gfortran` is missing *and* the user is using homebrew, because there is no excuse, but maybe install it if there is no obvious package management system in place. That may be beyond the scope of this ticket.\n\nThe Sage philosophy used to be: treat developers and users as the same, and basically assume everyone was building from scratch. Have we moved enough away from this now that we can treat developers (by which I just mean people who compile Sage themselves) differently?",
    "created_at": "2021-09-16T21:18:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454272",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:34'></a>First, the help string in `./configure` still says that "yes" is the default for `--with-system-gcc`. Second, if I don't have `gcc` at all, then `./configure` stops before it prints the message, saying

```
configure: error: no acceptable C compiler found in $PATH
See `config.log' for more details
```
Third, should this also test for `gfortran`, or should we continue to build that without complaining? It would be nice on a platform like OS X to just quit with an error if `gfortran` is missing *and* the user is using homebrew, because there is no excuse, but maybe install it if there is no obvious package management system in place. That may be beyond the scope of this ticket.

The Sage philosophy used to be: treat developers and users as the same, and basically assume everyone was building from scratch. Have we moved enough away from this now that we can treat developers (by which I just mean people who compile Sage themselves) differently?



---

archive/issue_comments_454273.json:
```json
{
    "body": "<a id='comment:35'></a>Replying to [comment:34 jhpalmieri]:\n> if I don't have `gcc` at all, then `./configure` stops before it prints the message, saying\n> \n> ```\n> configure: error: no acceptable C compiler found in $PATH\n> See `config.log' for more details\n> ```\n\n\nIt's hard to avoid error exits from standard autoconf macros. Ticket #29531 sketches a solution, but it's tricky, and I consider it out of scope.",
    "created_at": "2021-09-16T21:24:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454273",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:35'></a>Replying to [comment:34 jhpalmieri]:
> if I don't have `gcc` at all, then `./configure` stops before it prints the message, saying
> 
> ```
> configure: error: no acceptable C compiler found in $PATH
> See `config.log' for more details
> ```


It's hard to avoid error exits from standard autoconf macros. Ticket #29531 sketches a solution, but it's tricky, and I consider it out of scope.



---

archive/issue_comments_454274.json:
```json
{
    "body": "<a id='comment:36'></a>```\n> should this also test for `gfortran`\n```\nNo, I don't think so because building `gfortran` is robust when a suitable `gcc` is present. We know this because we test it on GH Actions: All the `-minimal` configuration do not have system `gfortran`.",
    "created_at": "2021-09-16T21:26:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454274",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:36'></a>```
> should this also test for `gfortran`
```
No, I don't think so because building `gfortran` is robust when a suitable `gcc` is present. We know this because we test it on GH Actions: All the `-minimal` configuration do not have system `gfortran`.



---

archive/issue_comments_454275.json:
```json
{
    "body": "<a id='comment:37'></a>That makes it hard (at least for me) to test. The changes make sense, but I'm not that familiar with `m4` syntax. To see it in action, I guess I need a system with a `gcc` but one that's broken (too old for example).\n\nIf someone else can review, that would be great. If you think it's right to do the same with Python3, please open another ticket.",
    "created_at": "2021-09-16T21:30:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454275",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:37'></a>That makes it hard (at least for me) to test. The changes make sense, but I'm not that familiar with `m4` syntax. To see it in action, I guess I need a system with a `gcc` but one that's broken (too old for example).

If someone else can review, that would be great. If you think it's right to do the same with Python3, please open another ticket.



---

archive/issue_comments_454276.json:
```json
{
    "body": "<a id='comment:40'></a>Replying to [comment:33 mkoeppe]:\n> that's just, like, your opinion, man\n\n\nthat's, like, the reviewer's job, no?",
    "created_at": "2021-09-16T22:37:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454276",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:40'></a>Replying to [comment:33 mkoeppe]:
> that's just, like, your opinion, man


that's, like, the reviewer's job, no?



---

archive/issue_comments_454277.json:
```json
{
    "body": "<a id='comment:41'></a>It's out of scope for this ticket, so, no.",
    "created_at": "2021-09-16T22:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454277",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:41'></a>It's out of scope for this ticket, so, no.



---

archive/issue_comments_454278.json:
```json
{
    "body": "<a id='comment:42'></a>Replying to [comment:34 jhpalmieri]:\n> First, the help string in `./configure` still says that \"yes\" is the default for `--with-system-gcc`. Second, if I don't have `gcc` at all, then `./configure` stops before it prints the message, saying\n> \n> ```\n> configure: error: no acceptable C compiler found in $PATH\n> See `config.log' for more details\n> ```\n> Third, should this also test for `gfortran`, or should we continue to build that without complaining? It would be nice on a platform like OS X to just quit with an error if `gfortran` is missing *and* the user is using homebrew, because there is no excuse, but maybe install it if there is no obvious package management system in place. That may be beyond the scope of this ticket.\n\n\n\nthere are standalone distributions of gfortran for macOS by the gfortran maintainer of the Homebrew package.\nTo me this offers a way to entirety remove gcc and gfortran spkgs from Sage.\n\nhttps://github.com/fxcoudert/gfortran-for-macOS\n\n\n> \n> The Sage philosophy used to be: treat developers and users as the same, and basically assume everyone was building from scratch. Have we moved enough away from this now that we can treat developers (by which I just mean people who compile Sage themselves) differently?\n\n\nit is hard to tell, but I guess the majority of users is using prebuilt Sage.",
    "created_at": "2021-09-16T23:04:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454278",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:42'></a>Replying to [comment:34 jhpalmieri]:
> First, the help string in `./configure` still says that "yes" is the default for `--with-system-gcc`. Second, if I don't have `gcc` at all, then `./configure` stops before it prints the message, saying
> 
> ```
> configure: error: no acceptable C compiler found in $PATH
> See `config.log' for more details
> ```
> Third, should this also test for `gfortran`, or should we continue to build that without complaining? It would be nice on a platform like OS X to just quit with an error if `gfortran` is missing *and* the user is using homebrew, because there is no excuse, but maybe install it if there is no obvious package management system in place. That may be beyond the scope of this ticket.



there are standalone distributions of gfortran for macOS by the gfortran maintainer of the Homebrew package.
To me this offers a way to entirety remove gcc and gfortran spkgs from Sage.

https://github.com/fxcoudert/gfortran-for-macOS


> 
> The Sage philosophy used to be: treat developers and users as the same, and basically assume everyone was building from scratch. Have we moved enough away from this now that we can treat developers (by which I just mean people who compile Sage themselves) differently?


it is hard to tell, but I guess the majority of users is using prebuilt Sage.



---

archive/issue_comments_454279.json:
```json
{
    "body": "<a id='comment:43'></a>I've put a broken `gcc` ahead of everything in my PATH, and tried `./configure`\n\nIs this how the error regarding missing gcc should look like?\n\n```\nchecking for gcc... gcc\nchecking whether the C compiler works... no\nconfigure: error: in `/mnt/opt/Sage/sage-dev':\nconfigure: error: C compiler cannot create executables\nSee `config.log' for more details\n```\n\nand there is nothing beyond that in `config.log`, no `more details`, really, except `configure: exit 77` as the last line.",
    "created_at": "2021-09-17T10:25:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454279",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:43'></a>I've put a broken `gcc` ahead of everything in my PATH, and tried `./configure`

Is this how the error regarding missing gcc should look like?

```
checking for gcc... gcc
checking whether the C compiler works... no
configure: error: in `/mnt/opt/Sage/sage-dev':
configure: error: C compiler cannot create executables
See `config.log' for more details
```

and there is nothing beyond that in `config.log`, no `more details`, really, except `configure: exit 77` as the last line.



---

archive/issue_comments_454280.json:
```json
{
    "body": "<a id='comment:44'></a>the trick in the previous comment does not work for python3, as `./configure` still manages to divine\n`/usr/bin/python3` somehow.",
    "created_at": "2021-09-17T10:37:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454280",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:44'></a>the trick in the previous comment does not work for python3, as `./configure` still manages to divine
`/usr/bin/python3` somehow.



---

archive/issue_comments_454281.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-09-17T10:46:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454281",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_454282.json:
```json
{
    "body": "<a id='comment:45'></a>anyhow, this looks good enough.",
    "created_at": "2021-09-17T10:46:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454282",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:45'></a>anyhow, this looks good enough.



---

archive/issue_comments_454283.json:
```json
{
    "body": "<a id='comment:46'></a>Replying to [comment:43 dimpase]:\n> I've put a broken `gcc` ahead of everything in my PATH, and tried `./configure`\n> \n> Is this how the error regarding missing gcc should look like?\n> \n> ```\n> checking for gcc... gcc\n> checking whether the C compiler works... no\n> configure: error: in `/mnt/opt/Sage/sage-dev':\n> configure: error: C compiler cannot create executables\n> See `config.log' for more details\n> ```\n> \n> and there is nothing beyond that in `config.log`, no `more details`, really, except `configure: exit 77` as the last line.\n\n\nNo, see comment:35. This ticket is not about early exits caused by standard autoconf macros. It is about our spkg-configure which uses more specific tests regarding the compiler.\n\nIf you want to test this properly, use a working but out-of-version-range compiler such as gcc 4.4 or 12.dev.",
    "created_at": "2021-09-17T16:38:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454283",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:46'></a>Replying to [comment:43 dimpase]:
> I've put a broken `gcc` ahead of everything in my PATH, and tried `./configure`
> 
> Is this how the error regarding missing gcc should look like?
> 
> ```
> checking for gcc... gcc
> checking whether the C compiler works... no
> configure: error: in `/mnt/opt/Sage/sage-dev':
> configure: error: C compiler cannot create executables
> See `config.log' for more details
> ```
> 
> and there is nothing beyond that in `config.log`, no `more details`, really, except `configure: exit 77` as the last line.


No, see comment:35. This ticket is not about early exits caused by standard autoconf macros. It is about our spkg-configure which uses more specific tests regarding the compiler.

If you want to test this properly, use a working but out-of-version-range compiler such as gcc 4.4 or 12.dev.



---

archive/issue_comments_454284.json:
```json
{
    "body": "<a id='comment:47'></a>Replying to [comment:45 dimpase]:\n> looks good enough.\n\n\nThanks. If nothing else, the deferred error exits are valuable.",
    "created_at": "2021-09-17T16:39:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454284",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:47'></a>Replying to [comment:45 dimpase]:
> looks good enough.


Thanks. If nothing else, the deferred error exits are valuable.



---

archive/issue_comments_454285.json:
```json
{
    "body": "<a id='comment:48'></a>I have opened #32532 to remove gcc and gfortran spkgs.",
    "created_at": "2021-09-18T14:13:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454285",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:48'></a>I have opened #32532 to remove gcc and gfortran spkgs.



---

archive/issue_comments_454286.json:
```json
{
    "body": "<a id='comment:49'></a>Thanks. Good to have a central place for this recurring topic.",
    "created_at": "2021-09-18T16:15:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454286",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:49'></a>Thanks. Good to have a central place for this recurring topic.



---

archive/issue_comments_454287.json:
```json
{
    "body": "<a id='comment:50'></a>Replying to [comment:34 jhpalmieri]:\n> the help string in `./configure` still says that \"yes\" is the default for `--with-system-gcc`. \n\n\nLet's fix this in #32533 - one of several possible improvements for `./configure --help`",
    "created_at": "2021-09-18T18:05:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454287",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:50'></a>Replying to [comment:34 jhpalmieri]:
> the help string in `./configure` still says that "yes" is the default for `--with-system-gcc`. 


Let's fix this in #32533 - one of several possible improvements for `./configure --help`



---

archive/issue_comments_454288.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-09-25T23:18:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32060#issuecomment-454288",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_084847.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-09-25T23:18:13Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32060",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32060#event-84847"
}
```
