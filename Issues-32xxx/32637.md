# Issue 32637: Add sage.geometry.abc; remove uses of is_Polyhedron, is_LatticePolytope, is_Cone outside of sage.geometry

archive/issues_032400.json:
```json
{
    "body": "\n```\n$ git grep 'def is_[A-Z]' src/sage/geometry/\nsrc/sage/geometry/cone.py:def is_Cone(x):\nsrc/sage/geometry/fan.py:def is_Fan(x):\nsrc/sage/geometry/lattice_polytope.py:def is_LatticePolytope(x):\nsrc/sage/geometry/lattice_polytope.py:def is_NefPartition(x):\nsrc/sage/geometry/point_collection.pyx:def is_PointCollection(x):\nsrc/sage/geometry/polyhedron/base.py:def is_Polyhedron(X):\nsrc/sage/geometry/toric_lattice.py:def is_ToricLattice(x):\nsrc/sage/geometry/toric_lattice.py:def is_ToricLatticeQuotient(x):\nsrc/sage/geometry/toric_lattice_element.pyx:def is_ToricLatticeElement(x):\n```\n\nIn this ticket, we add ABCs `LatticePolytope`, `ConvexRationalPolyhedralCone`, `Polyhedron`.\n\n\nA small number of uses outside of `sage.geometry` will need updating. `$ git grep 'geometry.*import.*is_[A-Z]' src/sage/`\n\n(Part of meta-ticket #32414)\n\n\n**CC:**  @kliem @orlitzky @egourgoulhon\n\n**Branch/Commit:** [44540f589820374bcc50227accc4a8756036d3fb](https://github.com/sagemath/sagetrac-mirror/commit/44540f589820374bcc50227accc4a8756036d3fb)\n\n**Reviewer:** Michael Orlitzky\n\n**Author:** Matthias Koeppe\n\n**Dependencies:** #32614, #32649\n\nIssue created by migration from https://trac.sagemath.org/ticket/32637\n\n",
    "closed_at": "2021-10-20T23:00:52Z",
    "created_at": "2021-10-05T17:52:48Z",
    "labels": [
        "component: refactoring",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "title": "Add sage.geometry.abc; remove uses of is_Polyhedron, is_LatticePolytope, is_Cone outside of sage.geometry",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/32637",
    "user": "https://github.com/mkoeppe"
}
```

```
$ git grep 'def is_[A-Z]' src/sage/geometry/
src/sage/geometry/cone.py:def is_Cone(x):
src/sage/geometry/fan.py:def is_Fan(x):
src/sage/geometry/lattice_polytope.py:def is_LatticePolytope(x):
src/sage/geometry/lattice_polytope.py:def is_NefPartition(x):
src/sage/geometry/point_collection.pyx:def is_PointCollection(x):
src/sage/geometry/polyhedron/base.py:def is_Polyhedron(X):
src/sage/geometry/toric_lattice.py:def is_ToricLattice(x):
src/sage/geometry/toric_lattice.py:def is_ToricLatticeQuotient(x):
src/sage/geometry/toric_lattice_element.pyx:def is_ToricLatticeElement(x):
```

In this ticket, we add ABCs `LatticePolytope`, `ConvexRationalPolyhedralCone`, `Polyhedron`.


A small number of uses outside of `sage.geometry` will need updating. `$ git grep 'geometry.*import.*is_[A-Z]' src/sage/`

(Part of meta-ticket #32414)


**CC:**  @kliem @orlitzky @egourgoulhon

**Branch/Commit:** [44540f589820374bcc50227accc4a8756036d3fb](https://github.com/sagemath/sagetrac-mirror/commit/44540f589820374bcc50227accc4a8756036d3fb)

**Reviewer:** Michael Orlitzky

**Author:** Matthias Koeppe

**Dependencies:** #32614, #32649

Issue created by migration from https://trac.sagemath.org/ticket/32637





---

archive/issue_events_292983.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-17T21:12:00Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "rename": {
        "from": "Add sage.geometry.abc; deprecate is_Polyhedron, is_LatticePolytope, is_Cone, ...",
        "to": "Add sage.geometry.abc; remove uses of is_Polyhedron, is_LatticePolytope, is_Cone outside of sage.geometry"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32637#event-292983"
}
```



---

archive/issue_comments_529056.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/add_sage_geometry_abc__deprecate_is_polyhedron__is_latticepolytope__is_cone_____](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/add_sage_geometry_abc__deprecate_is_polyhedron__is_latticepolytope__is_cone_____)",
    "created_at": "2021-10-17T21:16:03Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529056",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/add_sage_geometry_abc__deprecate_is_polyhedron__is_latticepolytope__is_cone_____](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/add_sage_geometry_abc__deprecate_is_polyhedron__is_latticepolytope__is_cone_____)



---

archive/issue_comments_529057.json:
```json
{
    "body": "**Author:** Matthias Koeppe",
    "created_at": "2021-10-17T21:17:30Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529057",
    "user": "https://github.com/mkoeppe"
}
```

**Author:** Matthias Koeppe



---

archive/issue_events_292984.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-17T21:17:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32637#event-292984"
}
```



---

archive/issue_comments_529058.json:
```json
{
    "body": "<a id='comment:3'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/502546b177c9a1bb11752e08f713c93ac6de69bb\">502546b</a></td><td><code>src/sage/geometry/abc.pyx: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/79a8ba4787ddab5a7318499aeba1888ed48959c4\">79a8ba4</a></td><td><code>sage.schemes.toric: Remove use of is_Cone</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6e32262a21842d4b1f979ce84801516f00a5025d\">6e32262</a></td><td><code>src/sage/matrix/matrix2.pyx: Remove use of is_Cone</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/19aee74596989e1f51fd857b0e0471beecedd7b3\">19aee74</a></td><td><code>src/sage/groups/affine_gps/group_element.py: Remove use of is_Polyhedron</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/87ad226d6babe026e330894f1eba99aadefbafd3\">87ad226</a></td><td><code>src/sage/manifolds/subsets/pullback.py: Remove use of is_Polyhedron</code></td></tr></table>\n",
    "created_at": "2021-10-17T21:17:30Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529058",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/502546b177c9a1bb11752e08f713c93ac6de69bb">502546b</a></td><td><code>src/sage/geometry/abc.pyx: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/79a8ba4787ddab5a7318499aeba1888ed48959c4">79a8ba4</a></td><td><code>sage.schemes.toric: Remove use of is_Cone</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6e32262a21842d4b1f979ce84801516f00a5025d">6e32262</a></td><td><code>src/sage/matrix/matrix2.pyx: Remove use of is_Cone</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/19aee74596989e1f51fd857b0e0471beecedd7b3">19aee74</a></td><td><code>src/sage/groups/affine_gps/group_element.py: Remove use of is_Polyhedron</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/87ad226d6babe026e330894f1eba99aadefbafd3">87ad226</a></td><td><code>src/sage/manifolds/subsets/pullback.py: Remove use of is_Polyhedron</code></td></tr></table>




---

archive/issue_comments_529059.json:
```json
{
    "body": "**Commit:** [87ad226d6babe026e330894f1eba99aadefbafd3](https://github.com/sagemath/sagetrac-mirror/commit/87ad226d6babe026e330894f1eba99aadefbafd3)",
    "created_at": "2021-10-17T21:17:30Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529059",
    "user": "https://github.com/mkoeppe"
}
```

**Commit:** [87ad226d6babe026e330894f1eba99aadefbafd3](https://github.com/sagemath/sagetrac-mirror/commit/87ad226d6babe026e330894f1eba99aadefbafd3)



---

archive/issue_comments_529060.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -12,6 +12,9 @@\n src/sage/geometry/toric_lattice_element.pyx:def is_ToricLatticeElement(x):\n ```\n \n+In this ticket, we add ABCs `LatticePolytope`, `ConvexRationalPolyhedralCone`, `Polyhedron`.\n+\n+\n A small number of uses outside of `sage.geometry` will need updating. `$ git grep 'geometry.*import.*is_[A-Z]' src/sage/`\n \n (Part of meta-ticket #32414)\n``````\n",
    "created_at": "2021-10-17T21:23:42Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529060",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -12,6 +12,9 @@
 src/sage/geometry/toric_lattice_element.pyx:def is_ToricLatticeElement(x):
 ```
 
+In this ticket, we add ABCs `LatticePolytope`, `ConvexRationalPolyhedralCone`, `Polyhedron`.
+
+
 A small number of uses outside of `sage.geometry` will need updating. `$ git grep 'geometry.*import.*is_[A-Z]' src/sage/`
 
 (Part of meta-ticket #32414)
``````




---

archive/issue_comments_529061.json:
```json
{
    "body": "<a id='comment:5'></a>\nI worry that we're changing `is_Foo()` to mean \"does this object provide the interface defined by `abc.Foo`?\" But then `abc.Foo` doesn't declare any methods, properties, or data.\n\nOn the other hand, you don't want to put the implementation into the base class, because the whole point is to avoid importing the implementations to perform a typecheck. Nor does it make much sense to blindly add a million `@abstractmethod def foo(...): pass` lines to each ABC. I guess in lieu of an alternative, it has to be OK.\n\nI wonder if something ridiculous like this wouldn't also work as an interim hack:\n\n```\nsage: def is_Polyhedron(C):\n....:     return \"Polyhedron_base\" in [c.__name__ for c in C.__class__.__mro__]\n```\n\nYou can also check the (string) module name with `c.__module__` to avoid name clashes. But chances are, it's slower at runtime.",
    "created_at": "2021-10-18T00:35:31Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529061",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:5'></a>
I worry that we're changing `is_Foo()` to mean "does this object provide the interface defined by `abc.Foo`?" But then `abc.Foo` doesn't declare any methods, properties, or data.

On the other hand, you don't want to put the implementation into the base class, because the whole point is to avoid importing the implementations to perform a typecheck. Nor does it make much sense to blindly add a million `@abstractmethod def foo(...): pass` lines to each ABC. I guess in lieu of an alternative, it has to be OK.

I wonder if something ridiculous like this wouldn't also work as an interim hack:

```
sage: def is_Polyhedron(C):
....:     return "Polyhedron_base" in [c.__name__ for c in C.__class__.__mro__]
```

You can also check the (string) module name with `c.__module__` to avoid name clashes. But chances are, it's slower at runtime.



---

archive/issue_comments_529062.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [mjo](#comment%3A5):\n> I worry that we're changing `is_Foo()` to mean \"does this object provide the interface defined by `abc.Foo`?\" But then `abc.Foo` doesn't declare any methods, properties, or data.\n\n\nAs explained in #32414, \"each of the new abstract base classes is intended to have a unique direct implementation subclass. Attempting to define new hierarchies of abstract base classes is beyond the scope of this ticket. Also, the new classes do not define any methods.\".",
    "created_at": "2021-10-18T00:37:18Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529062",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>
Replying to [mjo](#comment%3A5):
> I worry that we're changing `is_Foo()` to mean "does this object provide the interface defined by `abc.Foo`?" But then `abc.Foo` doesn't declare any methods, properties, or data.


As explained in #32414, "each of the new abstract base classes is intended to have a unique direct implementation subclass. Attempting to define new hierarchies of abstract base classes is beyond the scope of this ticket. Also, the new classes do not define any methods.".



---

archive/issue_comments_529063.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [mjo](#comment%3A5):\n> I wonder if something ridiculous like this wouldn't also work as an interim hack:\n> \n> ```\n> sage: def is_Polyhedron(C):\n> ....:     return \"Polyhedron_base\" in [c.__name__ for c in C.__class__.__mro__]\n> ```\n\nYeah, I'm not interested in a solution that looks like this",
    "created_at": "2021-10-18T00:42:00Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529063",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
Replying to [mjo](#comment%3A5):
> I wonder if something ridiculous like this wouldn't also work as an interim hack:
> 
> ```
> sage: def is_Polyhedron(C):
> ....:     return "Polyhedron_base" in [c.__name__ for c in C.__class__.__mro__]
> ```

Yeah, I'm not interested in a solution that looks like this



---

archive/issue_comments_529064.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [mkoeppe](#comment%3A6):\n> \n> As explained in #32414, \"each of the new abstract base classes is intended to have a unique direct implementation subclass. Attempting to define new hierarchies of abstract base classes is beyond the scope of this ticket. Also, the new classes do not define any methods.\".\n\n\nI saw that, but unless you plan to live forever and spend most of it monitoring trac, there's no technical means to enforce that restriction.",
    "created_at": "2021-10-18T00:46:18Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529064",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:8'></a>
Replying to [mkoeppe](#comment%3A6):
> 
> As explained in #32414, "each of the new abstract base classes is intended to have a unique direct implementation subclass. Attempting to define new hierarchies of abstract base classes is beyond the scope of this ticket. Also, the new classes do not define any methods.".


I saw that, but unless you plan to live forever and spend most of it monitoring trac, there's no technical means to enforce that restriction.



---

archive/issue_comments_529065.json:
```json
{
    "body": "<a id='comment:9'></a>\nSounds like someone wants to write a decorator for these types of classes",
    "created_at": "2021-10-18T00:50:00Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529065",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>
Sounds like someone wants to write a decorator for these types of classes



---

archive/issue_comments_529066.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b9839a860bc2c3c3e56077f129f560a5cfdd89b\">8b9839a</a></td><td><code>src/sage/manifolds/subsets/pullback.py: Remove more uses of is_Polyhedron</code></td></tr></table>\n",
    "created_at": "2021-10-18T00:51:57Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529066",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b9839a860bc2c3c3e56077f129f560a5cfdd89b">8b9839a</a></td><td><code>src/sage/manifolds/subsets/pullback.py: Remove more uses of is_Polyhedron</code></td></tr></table>




---

archive/issue_comments_529067.json:
```json
{
    "body": "**Changing commit** from \"[87ad226d6babe026e330894f1eba99aadefbafd3](https://github.com/sagemath/sagetrac-mirror/commit/87ad226d6babe026e330894f1eba99aadefbafd3)\" to \"[8b9839a860bc2c3c3e56077f129f560a5cfdd89b](https://github.com/sagemath/sagetrac-mirror/commit/8b9839a860bc2c3c3e56077f129f560a5cfdd89b)\".",
    "created_at": "2021-10-18T00:51:57Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529067",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[87ad226d6babe026e330894f1eba99aadefbafd3](https://github.com/sagemath/sagetrac-mirror/commit/87ad226d6babe026e330894f1eba99aadefbafd3)" to "[8b9839a860bc2c3c3e56077f129f560a5cfdd89b](https://github.com/sagemath/sagetrac-mirror/commit/8b9839a860bc2c3c3e56077f129f560a5cfdd89b)".



---

archive/issue_comments_529068.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [mkoeppe](#comment%3A9):\n> Sounds like someone wants to write a decorator for these types of classes\n\n\nI don't know how to do it with a decorator, but I think a metaclass can ensure that a given class is only subclassed once. As an added bonus, the metaclass can explain why these exist and how they should be used (i.e. that they aren't really abstract base classes).\n\nThis example fails (as intended) the second time we subclass:\n\n```python\nclass TypeCheckWrapper(type):\n    _subclasses = 0\n\n    def __init__(cls, name, bases, clsdict):\n        if len(cls.mro()) > 2:\n            TypeCheckWrapper._subclasses += 1\n            if TypeCheckWrapper._subclasses > 1:\n                raise TypeError(\"TypeCheckWrapper with multiple subclasses\")\n        super(TypeCheckWrapper, cls).__init__(name, bases, clsdict)\n\nclass Polyhedron(metaclass=TypeCheckWrapper):\n    pass\n\nprint(\"Defined base class Polyhedron\")\n\nclass Cone(Polyhedron):\n    pass\n\nprint(\"Defined class Cone(Polyhedron)\")\n\nclass Polytope(Polyhedron):\n    pass\n\nprint(\"Defined class Polytope(Polyhedron)\")\n```",
    "created_at": "2021-10-18T01:32:49Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529068",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:11'></a>
Replying to [mkoeppe](#comment%3A9):
> Sounds like someone wants to write a decorator for these types of classes


I don't know how to do it with a decorator, but I think a metaclass can ensure that a given class is only subclassed once. As an added bonus, the metaclass can explain why these exist and how they should be used (i.e. that they aren't really abstract base classes).

This example fails (as intended) the second time we subclass:

```python
class TypeCheckWrapper(type):
    _subclasses = 0

    def __init__(cls, name, bases, clsdict):
        if len(cls.mro()) > 2:
            TypeCheckWrapper._subclasses += 1
            if TypeCheckWrapper._subclasses > 1:
                raise TypeError("TypeCheckWrapper with multiple subclasses")
        super(TypeCheckWrapper, cls).__init__(name, bases, clsdict)

class Polyhedron(metaclass=TypeCheckWrapper):
    pass

print("Defined base class Polyhedron")

class Cone(Polyhedron):
    pass

print("Defined class Cone(Polyhedron)")

class Polytope(Polyhedron):
    pass

print("Defined class Polytope(Polyhedron)")
```



---

archive/issue_comments_529069.json:
```json
{
    "body": "<a id='comment:12'></a>\nI think this discussion should go to a separate ticket. Note also that some of the ABCs added in other tickets of #32414 are actually extension classes, and using a metaclass there is probably tricky.",
    "created_at": "2021-10-18T01:38:11Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529069",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>
I think this discussion should go to a separate ticket. Note also that some of the ABCs added in other tickets of #32414 are actually extension classes, and using a metaclass there is probably tricky.



---

archive/issue_comments_529070.json:
```json
{
    "body": "<a id='comment:13'></a>\nA simple solution could be to just add a doctest for the MRO length. We enforce pretty much everything else with doctests as well.",
    "created_at": "2021-10-18T02:04:26Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529070",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>
A simple solution could be to just add a doctest for the MRO length. We enforce pretty much everything else with doctests as well.



---

archive/issue_comments_529071.json:
```json
{
    "body": "<a id='comment:14'></a>\n\n```\n    TESTS::\n\n        sage: import sage.geometry.abc\n        sage: len(sage.geometry.abc.Polyhedron.__subclasses__()) <= 1\n        True\n```",
    "created_at": "2021-10-18T02:32:07Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529071",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>

```
    TESTS::

        sage: import sage.geometry.abc
        sage: len(sage.geometry.abc.Polyhedron.__subclasses__()) <= 1
        True
```



---

archive/issue_comments_529072.json:
```json
{
    "body": "**Dependencies:** #32614",
    "created_at": "2021-10-18T02:41:46Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529072",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #32614



---

archive/issue_comments_529073.json:
```json
{
    "body": "**Changing commit** from \"[8b9839a860bc2c3c3e56077f129f560a5cfdd89b](https://github.com/sagemath/sagetrac-mirror/commit/8b9839a860bc2c3c3e56077f129f560a5cfdd89b)\" to \"[ceff8dcbdcc36d3b5232f48b650abe3538adc5e2](https://github.com/sagemath/sagetrac-mirror/commit/ceff8dcbdcc36d3b5232f48b650abe3538adc5e2)\".",
    "created_at": "2021-10-18T02:51:57Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529073",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[8b9839a860bc2c3c3e56077f129f560a5cfdd89b](https://github.com/sagemath/sagetrac-mirror/commit/8b9839a860bc2c3c3e56077f129f560a5cfdd89b)" to "[ceff8dcbdcc36d3b5232f48b650abe3538adc5e2](https://github.com/sagemath/sagetrac-mirror/commit/ceff8dcbdcc36d3b5232f48b650abe3538adc5e2)".



---

archive/issue_comments_529074.json:
```json
{
    "body": "<a id='comment:16'></a>\n**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/14fd1e54a13b1df7f81858019b31fb92cdf36007\">14fd1e5</a></td><td><code>src/doc/en/developer/coding_basics.rst: Update discussion of feature tags</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/27c53ac6450f789246b1df895bc26950a0cceb65\">27c53ac</a></td><td><code>src/sage/features/sagemath.py: Add 'sage.plot'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/180e31d5d512e18a5cb50cf03c4bdc757f353dc1\">180e31d</a></td><td><code>Merge #30887</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/10e8d6395e1c829b6a28750d3035de95862230b8\">10e8d63</a></td><td><code>sage.features.sagemath: Use JoinFeature when tag is different from the actually tested module</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/654d09ca4c22f4888d8e511789e57a7627043492\">654d09c</a></td><td><code>sage.features.sagemath: Change sage_optional_tags to sage_features</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f63a7d0171ba5f753d1755e0aff3fd00e373590c\">f63a7d0</a></td><td><code>src/sage/features/: Move features depending on optional packages to separate files</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4558791ccdef49ec5045072fabf2c8d9358f066f\">4558791</a></td><td><code>Merge tag '9.5.beta3' into t/32614/features_and_optional_tags_for_sage_subset_distributions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f68e5112bf4136708d47cef3547b694f9b88f69a\">f68e511</a></td><td><code>Merge #32614</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/18aa26ff345f8eeb78d63256599839dae0ba50a4\">18aa26f</a></td><td><code>src/sage/features/sagemath.py: Add sage.geometry.polyhedron</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ceff8dcbdcc36d3b5232f48b650abe3538adc5e2\">ceff8dc</a></td><td><code>src/sage/geometry/abc.pyx: Add doctests</code></td></tr></table>\n",
    "created_at": "2021-10-18T02:51:57Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529074",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/14fd1e54a13b1df7f81858019b31fb92cdf36007">14fd1e5</a></td><td><code>src/doc/en/developer/coding_basics.rst: Update discussion of feature tags</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/27c53ac6450f789246b1df895bc26950a0cceb65">27c53ac</a></td><td><code>src/sage/features/sagemath.py: Add 'sage.plot'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/180e31d5d512e18a5cb50cf03c4bdc757f353dc1">180e31d</a></td><td><code>Merge #30887</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/10e8d6395e1c829b6a28750d3035de95862230b8">10e8d63</a></td><td><code>sage.features.sagemath: Use JoinFeature when tag is different from the actually tested module</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/654d09ca4c22f4888d8e511789e57a7627043492">654d09c</a></td><td><code>sage.features.sagemath: Change sage_optional_tags to sage_features</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f63a7d0171ba5f753d1755e0aff3fd00e373590c">f63a7d0</a></td><td><code>src/sage/features/: Move features depending on optional packages to separate files</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4558791ccdef49ec5045072fabf2c8d9358f066f">4558791</a></td><td><code>Merge tag '9.5.beta3' into t/32614/features_and_optional_tags_for_sage_subset_distributions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f68e5112bf4136708d47cef3547b694f9b88f69a">f68e511</a></td><td><code>Merge #32614</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/18aa26ff345f8eeb78d63256599839dae0ba50a4">18aa26f</a></td><td><code>src/sage/features/sagemath.py: Add sage.geometry.polyhedron</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ceff8dcbdcc36d3b5232f48b650abe3538adc5e2">ceff8dc</a></td><td><code>src/sage/geometry/abc.pyx: Add doctests</code></td></tr></table>




---

archive/issue_comments_529075.json:
```json
{
    "body": "<a id='comment:17'></a>\nHow's this?",
    "created_at": "2021-10-18T02:52:08Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529075",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>
How's this?



---

archive/issue_comments_529076.json:
```json
{
    "body": "**Changing commit** from \"[ceff8dcbdcc36d3b5232f48b650abe3538adc5e2](https://github.com/sagemath/sagetrac-mirror/commit/ceff8dcbdcc36d3b5232f48b650abe3538adc5e2)\" to \"[94715701941f5eff63ff6eec4b7f1e36003efd6c](https://github.com/sagemath/sagetrac-mirror/commit/94715701941f5eff63ff6eec4b7f1e36003efd6c)\".",
    "created_at": "2021-10-18T03:31:49Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529076",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ceff8dcbdcc36d3b5232f48b650abe3538adc5e2](https://github.com/sagemath/sagetrac-mirror/commit/ceff8dcbdcc36d3b5232f48b650abe3538adc5e2)" to "[94715701941f5eff63ff6eec4b7f1e36003efd6c](https://github.com/sagemath/sagetrac-mirror/commit/94715701941f5eff63ff6eec4b7f1e36003efd6c)".



---

archive/issue_comments_529077.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/94715701941f5eff63ff6eec4b7f1e36003efd6c\">9471570</a></td><td><code>src/sage/geometry/abc.pyx: Add doctests</code></td></tr></table>\n",
    "created_at": "2021-10-18T03:31:49Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529077",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/94715701941f5eff63ff6eec4b7f1e36003efd6c">9471570</a></td><td><code>src/sage/geometry/abc.pyx: Add doctests</code></td></tr></table>




---

archive/issue_comments_529078.json:
```json
{
    "body": "**Changing dependencies** from \"#32614\" to \"#32614, #32649\".",
    "created_at": "2021-10-18T03:35:09Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529078",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#32614" to "#32614, #32649".



---

archive/issue_comments_529079.json:
```json
{
    "body": "**Changing commit** from \"[94715701941f5eff63ff6eec4b7f1e36003efd6c](https://github.com/sagemath/sagetrac-mirror/commit/94715701941f5eff63ff6eec4b7f1e36003efd6c)\" to \"[44540f589820374bcc50227accc4a8756036d3fb](https://github.com/sagemath/sagetrac-mirror/commit/44540f589820374bcc50227accc4a8756036d3fb)\".",
    "created_at": "2021-10-18T03:37:38Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529079",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[94715701941f5eff63ff6eec4b7f1e36003efd6c](https://github.com/sagemath/sagetrac-mirror/commit/94715701941f5eff63ff6eec4b7f1e36003efd6c)" to "[44540f589820374bcc50227accc4a8756036d3fb](https://github.com/sagemath/sagetrac-mirror/commit/44540f589820374bcc50227accc4a8756036d3fb)".



---

archive/issue_comments_529080.json:
```json
{
    "body": "<a id='comment:20'></a>\n**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/935850282818a526ad8c1e8f07bcf2f9f08efed1\">9358502</a></td><td><code>Merge #32614</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6457ee93e17d32327bb03394e4da3993165f3043\">6457ee9</a></td><td><code>src/sage/features/mip_backends.py: Fixup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eeaa722ec5cc8c6456bbe0e48359c903144da5bc\">eeaa722</a></td><td><code>Merge #32614</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c872d69fe936caa1b002585d8a769a4120823f45\">c872d69</a></td><td><code>Add description to features</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/08248a17ab2eea2b2ca843b06ee83947deda88e3\">08248a1</a></td><td><code>Fix for doctest failures</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/759c88b08ed38cea181f6cf568cab5054f536bdb\">759c88b</a></td><td><code>sage.doctest, sage.control: Remove unused imports</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/15729dcf018e6059c1ff127438b076aa35fe872c\">15729dc</a></td><td><code>src/sage/features/mcqd.py: Add doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1d02bd06da66b6e8b5f5b28121dcc8d0cf4b209c\">1d02bd0</a></td><td><code>More doctests for coverage</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/58572e1cb08aae18015a06851b20bcee4b409754\">58572e1</a></td><td><code>Merge #32649</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/44540f589820374bcc50227accc4a8756036d3fb\">44540f5</a></td><td><code>src/sage/features/sagemath.py: Add doctests</code></td></tr></table>\n",
    "created_at": "2021-10-18T03:37:38Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529080",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/935850282818a526ad8c1e8f07bcf2f9f08efed1">9358502</a></td><td><code>Merge #32614</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6457ee93e17d32327bb03394e4da3993165f3043">6457ee9</a></td><td><code>src/sage/features/mip_backends.py: Fixup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eeaa722ec5cc8c6456bbe0e48359c903144da5bc">eeaa722</a></td><td><code>Merge #32614</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c872d69fe936caa1b002585d8a769a4120823f45">c872d69</a></td><td><code>Add description to features</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/08248a17ab2eea2b2ca843b06ee83947deda88e3">08248a1</a></td><td><code>Fix for doctest failures</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/759c88b08ed38cea181f6cf568cab5054f536bdb">759c88b</a></td><td><code>sage.doctest, sage.control: Remove unused imports</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/15729dcf018e6059c1ff127438b076aa35fe872c">15729dc</a></td><td><code>src/sage/features/mcqd.py: Add doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1d02bd06da66b6e8b5f5b28121dcc8d0cf4b209c">1d02bd0</a></td><td><code>More doctests for coverage</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/58572e1cb08aae18015a06851b20bcee4b409754">58572e1</a></td><td><code>Merge #32649</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/44540f589820374bcc50227accc4a8756036d3fb">44540f5</a></td><td><code>src/sage/features/sagemath.py: Add doctests</code></td></tr></table>




---

archive/issue_events_292985.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-10-19T02:09:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32637#event-292985"
}
```



---

archive/issue_events_292986.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-10-19T02:09:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32637#event-292986"
}
```



---

archive/issue_comments_529081.json:
```json
{
    "body": "<a id='comment:21'></a>\nWe actually have a module (`sage.cpython.cython_metaclass`)  that hacks metaclasses into cython using undocumented internals. What could possibly go wrong?\n\nUsing doctests is good enough.",
    "created_at": "2021-10-19T02:09:40Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529081",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:21'></a>
We actually have a module (`sage.cpython.cython_metaclass`)  that hacks metaclasses into cython using undocumented internals. What could possibly go wrong?

Using doctests is good enough.



---

archive/issue_comments_529082.json:
```json
{
    "body": "**Reviewer:** Michael Orlitzky",
    "created_at": "2021-10-19T02:09:40Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529082",
    "user": "https://github.com/orlitzky"
}
```

**Reviewer:** Michael Orlitzky



---

archive/issue_comments_529083.json:
```json
{
    "body": "<a id='comment:22'></a>\nThanks!",
    "created_at": "2021-10-19T02:22:16Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529083",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'></a>
Thanks!



---

archive/issue_comments_529084.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/add_sage_geometry_abc__deprecate_is_polyhedron__is_latticepolytope__is_cone_____](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/add_sage_geometry_abc__deprecate_is_polyhedron__is_latticepolytope__is_cone_____)\" to \"[44540f589820374bcc50227accc4a8756036d3fb](https://github.com/sagemath/sagetrac-mirror/commit/44540f589820374bcc50227accc4a8756036d3fb)\".",
    "created_at": "2021-10-20T23:00:52Z",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32637#issuecomment-529084",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mkoeppe/add_sage_geometry_abc__deprecate_is_polyhedron__is_latticepolytope__is_cone_____](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/add_sage_geometry_abc__deprecate_is_polyhedron__is_latticepolytope__is_cone_____)" to "[44540f589820374bcc50227accc4a8756036d3fb](https://github.com/sagemath/sagetrac-mirror/commit/44540f589820374bcc50227accc4a8756036d3fb)".



---

archive/issue_events_292987.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-20T23:00:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32637#event-292987"
}
```



---

archive/issue_events_292988.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-20T23:00:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32637",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32637#event-292988"
}
```
