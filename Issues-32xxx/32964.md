# Issue 32964: very slow doctest in functions.orthogonal_polys

archive/issues_032727.json:
```json
{
    "body": "\n```\n$ sage -t --warn-long 10.0 --random-seed=80495217684824677825915603387163671014 src/sage/functions/orthogonal_polys.py\n**********************************************************************\nFile \"src/sage/functions/orthogonal_polys.py\", line 2084, in sage.functions.orthogonal_polys.Func_ultraspherical\nWarning, slow doctest:\n    for N in range(100):\n        n = ZZ.random_element(5, 5001)\n        a = QQ.random_element().abs() + 5\n        assert ((n+1)*ultraspherical(n+1,a,x) - 2*x*(n+a)*ultraspherical(n,a,x) + (n+2*a-1)*ultraspherical(n-1,a,x)).expand().is_zero()\nTest ran for 261.17 s\n    [400 tests, 273.87 s]\n```\n\nSince the test is randomized, we don't need to repeat it a hundred times. Coverage is provided more by the number of testers. And we shouldn't use `assert()` in EXAMPLES...\n\n\n**Branch/Commit:** [9b2f042147b4d25c5d7e1776bfb4b5c76db9d97b](https://github.com/sagemath/sagetrac-mirror/commit/9b2f042147b4d25c5d7e1776bfb4b5c76db9d97b)\n\n**Reviewer:** Fr\u00e9d\u00e9ric Chapoton\n\n**Author:** Michael Orlitzky\n\nIssue created by migration from https://trac.sagemath.org/ticket/32964\n\n",
    "closed_at": "2021-12-23T20:25:25Z",
    "created_at": "2021-12-04T01:49:42Z",
    "labels": [
        "component: misc",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "very slow doctest in functions.orthogonal_polys",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32964",
    "user": "https://github.com/orlitzky"
}
```

```
$ sage -t --warn-long 10.0 --random-seed=80495217684824677825915603387163671014 src/sage/functions/orthogonal_polys.py
**********************************************************************
File "src/sage/functions/orthogonal_polys.py", line 2084, in sage.functions.orthogonal_polys.Func_ultraspherical
Warning, slow doctest:
    for N in range(100):
        n = ZZ.random_element(5, 5001)
        a = QQ.random_element().abs() + 5
        assert ((n+1)*ultraspherical(n+1,a,x) - 2*x*(n+a)*ultraspherical(n,a,x) + (n+2*a-1)*ultraspherical(n-1,a,x)).expand().is_zero()
Test ran for 261.17 s
    [400 tests, 273.87 s]
```

Since the test is randomized, we don't need to repeat it a hundred times. Coverage is provided more by the number of testers. And we shouldn't use `assert()` in EXAMPLES...


**Branch/Commit:** [9b2f042147b4d25c5d7e1776bfb4b5c76db9d97b](https://github.com/sagemath/sagetrac-mirror/commit/9b2f042147b4d25c5d7e1776bfb4b5c76db9d97b)

**Reviewer:** Frédéric Chapoton

**Author:** Michael Orlitzky

Issue created by migration from https://trac.sagemath.org/ticket/32964





---

archive/issue_comments_628191.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2021-12-04T02:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32964#issuecomment-628191",
    "user": "https://github.com/orlitzky"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_628192.json:
```json
{
    "body": "**Commit:** [9b2f042147b4d25c5d7e1776bfb4b5c76db9d97b](https://github.com/sagemath/sagetrac-mirror/commit/9b2f042147b4d25c5d7e1776bfb4b5c76db9d97b)",
    "created_at": "2021-12-04T02:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32964#issuecomment-628192",
    "user": "https://github.com/orlitzky"
}
```

**Commit:** [9b2f042147b4d25c5d7e1776bfb4b5c76db9d97b](https://github.com/sagemath/sagetrac-mirror/commit/9b2f042147b4d25c5d7e1776bfb4b5c76db9d97b)



---

archive/issue_comments_628193.json:
```json
{
    "body": "**Branch:** [u/mjo/ticket/32964](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/32964)",
    "created_at": "2021-12-04T02:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32964#issuecomment-628193",
    "user": "https://github.com/orlitzky"
}
```

**Branch:** [u/mjo/ticket/32964](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/32964)



---

archive/issue_comments_628194.json:
```json
{
    "body": "**Author:** Michael Orlitzky",
    "created_at": "2021-12-04T02:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32964#issuecomment-628194",
    "user": "https://github.com/orlitzky"
}
```

**Author:** Michael Orlitzky



---

archive/issue_comments_628195.json:
```json
{
    "body": "<a id='comment:2'></a>\nok, thanks",
    "created_at": "2021-12-04T07:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32964#issuecomment-628195",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>
ok, thanks



---

archive/issue_comments_628196.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2021-12-04T07:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32964#issuecomment-628196",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_628197.json:
```json
{
    "body": "**Reviewer:** Fr\u00e9d\u00e9ric Chapoton",
    "created_at": "2021-12-04T07:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32964#issuecomment-628197",
    "user": "https://github.com/fchapoton"
}
```

**Reviewer:** Frédéric Chapoton



---

archive/issue_comments_628198.json:
```json
{
    "body": "<a id='comment:3'></a>\n+1\n\nI was getting occasional timeouts on i686 on this file. See https://github.com/void-linux/void-packages/pull/34030#issuecomment-976455781.\n\nI will add your patch to my (WIP) sagemath package for void, thanks.",
    "created_at": "2021-12-05T20:34:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32964#issuecomment-628198",
    "user": "https://github.com/tornaria"
}
```

<a id='comment:3'></a>
+1

I was getting occasional timeouts on i686 on this file. See https://github.com/void-linux/void-packages/pull/34030#issuecomment-976455781.

I will add your patch to my (WIP) sagemath package for void, thanks.



---

archive/issue_comments_628199.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [tornaria](#comment%3A3):\n> +1\n> \n> I was getting occasional timeouts on i686 on this file.\n\n\nI'm also planning to raise the default (non `--long`) timeout in #32973, until `make ptest` passes on my desktop. It would be better to speed things up, but this is a lot easier.",
    "created_at": "2021-12-05T20:42:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32964#issuecomment-628199",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:4'></a>
Replying to [tornaria](#comment%3A3):
> +1
> 
> I was getting occasional timeouts on i686 on this file.


I'm also planning to raise the default (non `--long`) timeout in #32973, until `make ptest` passes on my desktop. It would be better to speed things up, but this is a lot easier.



---

archive/issue_events_097678.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-12-23T20:25:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32964",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32964#event-97678"
}
```



---

archive/issue_comments_628200.json:
```json
{
    "body": "**Changing branch** from \"[u/mjo/ticket/32964](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/32964)\" to \"[9b2f042147b4d25c5d7e1776bfb4b5c76db9d97b](https://github.com/sagemath/sagetrac-mirror/commit/9b2f042147b4d25c5d7e1776bfb4b5c76db9d97b)\".",
    "created_at": "2021-12-23T20:25:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32964#issuecomment-628200",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mjo/ticket/32964](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/32964)" to "[9b2f042147b4d25c5d7e1776bfb4b5c76db9d97b](https://github.com/sagemath/sagetrac-mirror/commit/9b2f042147b4d25c5d7e1776bfb4b5c76db9d97b)".
