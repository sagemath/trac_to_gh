# Issue 32047: Implement Elser Numbers and Nucleus Complexes

archive/issues_031810.json:
```json
{
    "body": "Create a module that computes\n\n(1) the kth Elser number of a graph G\n\n(2) the nucleus complex of a graph G for every subset of the vertices\n\n(3) Betti numbers of these complexes\n\nFor definitions of these objects, see: https://doi.org/10.1016/j.jcta.2020.105364\n\nAs a side-effect of these computations, also define functions of possible general interest\n\n(4) is_vertex_cover determines if L is a vertex cover of G (returns a boolean)\n\n~~(5) all connected subgraphs of a graph G~~\nbased on a suggestion from dcoudert, item 5 has been moved to its own ticket, see Ticket #32136\n\nCC:  @darijgr @kliem\n\nAuthor: Galen Dorpalen-Barry\n\nBranch: u/gh-galen-dorp/elser-numbers\n\nStatus: needs_work\n\nDependencies: 32136\n\nCommit: 859bcffa3f0f3523bdfb874c2cbb1ff6edad9ce2\n\nIssue created by migration from https://trac.sagemath.org/ticket/32047\n\n",
    "created_at": "2021-06-23T18:58:16Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Implement Elser Numbers and Nucleus Complexes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32047",
    "user": "https://github.com/galen-dorp"
}
```
Create a module that computes

(1) the kth Elser number of a graph G

(2) the nucleus complex of a graph G for every subset of the vertices

(3) Betti numbers of these complexes

For definitions of these objects, see: https://doi.org/10.1016/j.jcta.2020.105364

As a side-effect of these computations, also define functions of possible general interest

(4) is_vertex_cover determines if L is a vertex cover of G (returns a boolean)

~~(5) all connected subgraphs of a graph G~~
based on a suggestion from dcoudert, item 5 has been moved to its own ticket, see Ticket #32136

CC:  @darijgr @kliem

Author: Galen Dorpalen-Barry

Branch: u/gh-galen-dorp/elser-numbers

Status: needs_work

Dependencies: 32136

Commit: 859bcffa3f0f3523bdfb874c2cbb1ff6edad9ce2

Issue created by migration from https://trac.sagemath.org/ticket/32047





---

archive/issue_comments_638104.json:
```json
{
    "body": "<a id='comment:1'></a>\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n|                                                                                                                                           |                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|\n|[e8d054e](https://github.com/sagemath/sagetrac-mirror/commit/e8d054e45a3d4bd87b8754a8be8ca0c41be8d05d)|`changed some formatting in elser numbers file`|\n|[00948cb](https://github.com/sagemath/sagetrac-mirror/commit/00948cb52ac5d3807b0e9592d4e646b860500d04)|`added the elser-numbers.py file to the all.py file`|\n|[666abe9](https://github.com/sagemath/sagetrac-mirror/commit/666abe9da866e3ee3fc33bf5566b69d28124dbf5)|`modified the way the elser file was added into all.py`|\n|[56d57c1](https://github.com/sagemath/sagetrac-mirror/commit/56d57c1364a31fc861b34655b16464098376be3a)|`Removed the chain complex stuff, all doc tests passed.`|\n|[908edc8](https://github.com/sagemath/sagetrac-mirror/commit/908edc81241fbb0d726422f7d41fac17866b682a)|`Added nucleus_complex method, all doc tests passed`|\n|[ae2f536](https://github.com/sagemath/sagetrac-mirror/commit/ae2f536a065abb247dcd4306f1bfe5c7e168cf83)|`Added all_nucleus_complexes. All doc tests pass.`|\n|[6ad6754](https://github.com/sagemath/sagetrac-mirror/commit/6ad67540eae936d7cca9dce37694a44aa630ff2a)|`Added the Betti number computations, all tests passed`|\n|[c2a517f](https://github.com/sagemath/sagetrac-mirror/commit/c2a517f7388671e7aac2de8a18ad9d138de4461f)|`Improved documentation`|\n|[9a1d189](https://github.com/sagemath/sagetrac-mirror/commit/9a1d18920cd8aa5142ebf67f0cc927adf74ce780)|`added references to the long references file and linked them to elser_numbers`|\n|[859bcff](https://github.com/sagemath/sagetrac-mirror/commit/859bcffa3f0f3523bdfb874c2cbb1ff6edad9ce2)|`added documentation for the general interest functions`|",
    "created_at": "2021-06-23T19:03:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32047#issuecomment-638104",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>
Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
|                                                                                                                                           |                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|
|[e8d054e](https://github.com/sagemath/sagetrac-mirror/commit/e8d054e45a3d4bd87b8754a8be8ca0c41be8d05d)|`changed some formatting in elser numbers file`|
|[00948cb](https://github.com/sagemath/sagetrac-mirror/commit/00948cb52ac5d3807b0e9592d4e646b860500d04)|`added the elser-numbers.py file to the all.py file`|
|[666abe9](https://github.com/sagemath/sagetrac-mirror/commit/666abe9da866e3ee3fc33bf5566b69d28124dbf5)|`modified the way the elser file was added into all.py`|
|[56d57c1](https://github.com/sagemath/sagetrac-mirror/commit/56d57c1364a31fc861b34655b16464098376be3a)|`Removed the chain complex stuff, all doc tests passed.`|
|[908edc8](https://github.com/sagemath/sagetrac-mirror/commit/908edc81241fbb0d726422f7d41fac17866b682a)|`Added nucleus_complex method, all doc tests passed`|
|[ae2f536](https://github.com/sagemath/sagetrac-mirror/commit/ae2f536a065abb247dcd4306f1bfe5c7e168cf83)|`Added all_nucleus_complexes. All doc tests pass.`|
|[6ad6754](https://github.com/sagemath/sagetrac-mirror/commit/6ad67540eae936d7cca9dce37694a44aa630ff2a)|`Added the Betti number computations, all tests passed`|
|[c2a517f](https://github.com/sagemath/sagetrac-mirror/commit/c2a517f7388671e7aac2de8a18ad9d138de4461f)|`Improved documentation`|
|[9a1d189](https://github.com/sagemath/sagetrac-mirror/commit/9a1d18920cd8aa5142ebf67f0cc927adf74ce780)|`added references to the long references file and linked them to elser_numbers`|
|[859bcff](https://github.com/sagemath/sagetrac-mirror/commit/859bcffa3f0f3523bdfb874c2cbb1ff6edad9ce2)|`added documentation for the general interest functions`|



---

archive/issue_comments_638105.json:
```json
{
    "body": "Changing commit from \"\" to \"859bcffa3f0f3523bdfb874c2cbb1ff6edad9ce2\"",
    "created_at": "2021-06-23T19:03:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32047#issuecomment-638105",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "859bcffa3f0f3523bdfb874c2cbb1ff6edad9ce2"



---

archive/issue_comments_638106.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-06-23T19:27:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32047#issuecomment-638106",
    "user": "https://github.com/galen-dorp"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_638107.json:
```json
{
    "body": "<a id='comment:3'></a>\nSome remarks.\n\nYour method `connected_subgraphs_of` suffer several problems.\n- It has a strange name : I would simplify to `connected_subgraphs`.\n- More importantly, there is an undesirable collision with `connected_subgraph_iterator` where a connected subgraph means a subset of vertices on which the induced graph is connected.\n- I would rather implement an iterator rather than returning a list (this is quite standard that Python functions tend to return iterators rather than lists)\n- Finally, such function could be optimized a lot using backtracking\n\nAlso in `nuclei_by_size`, why do you sort them by size? The size is easily recovered with `len(G)` (which is much faster than `len(G.vertices())`). If you just implement `nuclei` then the dictionary can be reconstructed in two lines\n\n```\nsage: G = # whatever\nsage: by_size = {i: [] for i in range(len(G))}\nsage: for N in G.nuclei(): by_size[len(N)].append(n)\n```\nAlso, if I am not mistaken, to make your sum you don't need that dictionary as the Elser number is\n\n```\nreturn (-1)**(len(G)+1) * sum((-1)**len(N) * len(N)**k for N in G.nuclei())\n```",
    "created_at": "2021-06-23T20:02:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32047#issuecomment-638107",
    "user": "https://github.com/videlec"
}
```

<a id='comment:3'></a>
Some remarks.

Your method `connected_subgraphs_of` suffer several problems.
- It has a strange name : I would simplify to `connected_subgraphs`.
- More importantly, there is an undesirable collision with `connected_subgraph_iterator` where a connected subgraph means a subset of vertices on which the induced graph is connected.
- I would rather implement an iterator rather than returning a list (this is quite standard that Python functions tend to return iterators rather than lists)
- Finally, such function could be optimized a lot using backtracking

Also in `nuclei_by_size`, why do you sort them by size? The size is easily recovered with `len(G)` (which is much faster than `len(G.vertices())`). If you just implement `nuclei` then the dictionary can be reconstructed in two lines

```
sage: G = # whatever
sage: by_size = {i: [] for i in range(len(G))}
sage: for N in G.nuclei(): by_size[len(N)].append(n)
```
Also, if I am not mistaken, to make your sum you don't need that dictionary as the Elser number is

```
return (-1)**(len(G)+1) * sum((-1)**len(N) * len(N)**k for N in G.nuclei())
```



---

archive/issue_comments_638108.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-06-30T16:23:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32047#issuecomment-638108",
    "user": "https://github.com/galen-dorp"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_638109.json:
```json
{
    "body": "<a id='comment:5'></a>\nThanks for the comments! I changed the status to \"needs work\" so I can work on those changes!",
    "created_at": "2021-06-30T16:23:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32047#issuecomment-638109",
    "user": "https://github.com/galen-dorp"
}
```

<a id='comment:5'></a>
Thanks for the comments! I changed the status to "needs work" so I can work on those changes!



---

archive/issue_comments_638110.json:
```json
{
    "body": "<a id='comment:6'></a>\nActually, the connected subgraph part deserves a separate ticket. It's a significant amount of work and it's easier to review / correct / improve smaller tickets.\n\nThe difference with `connected_subgraph_iterator` is that you want all connected subgraphs and not only the induced connected subgraphs. So an option could be to add parameter `induced` to `connected_subgraph_iterator`, and then to switch to the appropriate method.\nAnd it's true that `connected_subgraph_iterator` could be renamed `connected_subgraphs`.",
    "created_at": "2021-06-30T16:48:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32047#issuecomment-638110",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:6'></a>
Actually, the connected subgraph part deserves a separate ticket. It's a significant amount of work and it's easier to review / correct / improve smaller tickets.

The difference with `connected_subgraph_iterator` is that you want all connected subgraphs and not only the induced connected subgraphs. So an option could be to add parameter `induced` to `connected_subgraph_iterator`, and then to switch to the appropriate method.
And it's true that `connected_subgraph_iterator` could be renamed `connected_subgraphs`.



---

archive/issue_comments_638111.json:
```json
{
    "body": "<a id='comment:7'></a>\nI had a look at the paper and the code and I'm really worried about the efficiency of the proposed method. You need a more efficient way to enumerate nuclei (connected subgraphs of G such that V(G) is a vertex cover of G). The current brute force approach is ok for graphs with up to 10-12 nodes.\n\n```\nsage: G = graphs.Grid2dGraph(3, 4)                                                                                                                 \nsage: %time G.elser_number(5)                                                                                                                      \nCPU times: user 5.59 s, sys: 127 ms, total: 5.72 s\nWall time: 5.86 s\n18264450\nsage: G = graphs.CompleteGraph(7)                                                                                                                  \nsage: %time G.elser_number(5)                                                                                                                      \nCPU times: user 1min 56s, sys: 8.87 s, total: 2min 5s\nWall time: 2min 6s\n5569200\n```\nIs the brute force approach the only way to compute this value ?",
    "created_at": "2021-07-03T11:03:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32047#issuecomment-638111",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:7'></a>
I had a look at the paper and the code and I'm really worried about the efficiency of the proposed method. You need a more efficient way to enumerate nuclei (connected subgraphs of G such that V(G) is a vertex cover of G). The current brute force approach is ok for graphs with up to 10-12 nodes.

```
sage: G = graphs.Grid2dGraph(3, 4)                                                                                                                 
sage: %time G.elser_number(5)                                                                                                                      
CPU times: user 5.59 s, sys: 127 ms, total: 5.72 s
Wall time: 5.86 s
18264450
sage: G = graphs.CompleteGraph(7)                                                                                                                  
sage: %time G.elser_number(5)                                                                                                                      
CPU times: user 1min 56s, sys: 8.87 s, total: 2min 5s
Wall time: 2min 6s
5569200
```
Is the brute force approach the only way to compute this value ?



---

archive/issue_comments_638112.json:
```json
{
    "body": "<a id='comment:8'></a>\nThanks dcoudert for the comments! I'll separate the tickets and will work on your suggestion for adding an `induced` parameter to the existing `connected_subgraph_iterator`.\n\nAs for the timing issues, there are some small things that can be changed, but I'm not sure how much it will change the timing for arbitrary graphs. Given that, I'll hold off those changes for once everything else is working.",
    "created_at": "2021-07-05T14:44:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32047#issuecomment-638112",
    "user": "https://github.com/galen-dorp"
}
```

<a id='comment:8'></a>
Thanks dcoudert for the comments! I'll separate the tickets and will work on your suggestion for adding an `induced` parameter to the existing `connected_subgraph_iterator`.

As for the timing issues, there are some small things that can be changed, but I'm not sure how much it will change the timing for arbitrary graphs. Given that, I'll hold off those changes for once everything else is working.



---

archive/issue_comments_638113.json:
```json
{
    "body": "Changing dependencies from \"\" to \"32136\"",
    "created_at": "2021-07-05T15:33:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32047#issuecomment-638113",
    "user": "https://github.com/galen-dorp"
}
```

Changing dependencies from "" to "32136"



---

archive/issue_comments_638114.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,4 +12,5 @@\n \n (4) is_vertex_cover determines if L is a vertex cover of G (returns a boolean)\n \n-(5) all connected subgraphs of a graph G\n+~~(5) all connected subgraphs of a graph G~~\n+based on a suggestion from dcoudert, item 5 has been moved to its own ticket, see Ticket #32136\n``````\n",
    "created_at": "2021-07-05T15:33:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32047#issuecomment-638114",
    "user": "https://github.com/galen-dorp"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,4 +12,5 @@
 
 (4) is_vertex_cover determines if L is a vertex cover of G (returns a boolean)
 
-(5) all connected subgraphs of a graph G
+~~(5) all connected subgraphs of a graph G~~
+based on a suggestion from dcoudert, item 5 has been moved to its own ticket, see Ticket #32136
``````




---

archive/issue_comments_638115.json:
```json
{
    "body": "<a id='comment:10'></a>\nSetting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32047#issuecomment-638115",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>
Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_events_095405.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32047#event-95405"
}
```



---

archive/issue_events_095406.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32047#event-95406"
}
```



---

archive/issue_events_095407.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32047#event-95407"
}
```



---

archive/issue_events_095408.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32047#event-95408"
}
```



---

archive/issue_events_095409.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32047#event-95409"
}
```



---

archive/issue_events_095410.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32047#event-95410"
}
```



---

archive/issue_events_095411.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32047",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32047#event-95411"
}
```
