# Issue 32105: Update scipy 1.7.x; add pythran package (scipy prerequisite)

archive/issues_031868.json:
```json
{
    "body": "\nhttps://docs.scipy.org/doc/scipy/release.1.7.1.html\n\n\nscipy has a new build requirement: pythran https://github.com/scipy/scipy/blob/master/pyproject.toml\n\n```\n[build-system]\nrequires = [\n    \"wheel\",\n    \"setuptools\",\n    \"Cython>=0.29.18\",\n    \"pybind11>=2.4.3\",\n    \"pythran>=0.9.11\",\n```\n\n\n\nDepends on #32488\n\n**CC:**  @kiwifb @antonio-rojas @dimpase @kliem\n\n**Branch/Commit:** [6f5b6f70e2dd8a08ca2311573ed36ba8d1d1393c](https://github.com/sagemath/sagetrac-mirror/commit/6f5b6f70e2dd8a08ca2311573ed36ba8d1d1393c)\n\n**Reviewer:** Fran\u00e7ois Bissey, Dima Pasechnik, Matthias Koeppe\n\n**Author:** Matthias Koeppe, Jonathan Kliem\n\nIssue created by migration from https://trac.sagemath.org/ticket/32105\n\n",
    "closed_at": "2021-12-05T11:15:37Z",
    "created_at": "2021-07-03T06:27:08Z",
    "labels": [
        "component: packages: standard",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "title": "Update scipy 1.7.x; add pythran package (scipy prerequisite)",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/32105",
    "user": "https://github.com/mkoeppe"
}
```

https://docs.scipy.org/doc/scipy/release.1.7.1.html


scipy has a new build requirement: pythran https://github.com/scipy/scipy/blob/master/pyproject.toml

```
[build-system]
requires = [
    "wheel",
    "setuptools",
    "Cython>=0.29.18",
    "pybind11>=2.4.3",
    "pythran>=0.9.11",
```



Depends on #32488

**CC:**  @kiwifb @antonio-rojas @dimpase @kliem

**Branch/Commit:** [6f5b6f70e2dd8a08ca2311573ed36ba8d1d1393c](https://github.com/sagemath/sagetrac-mirror/commit/6f5b6f70e2dd8a08ca2311573ed36ba8d1d1393c)

**Reviewer:** François Bissey, Dima Pasechnik, Matthias Koeppe

**Author:** Matthias Koeppe, Jonathan Kliem

Issue created by migration from https://trac.sagemath.org/ticket/32105





---

archive/issue_events_288484.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288484"
}
```



---

archive/issue_events_288485.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288485"
}
```



---

archive/issue_comments_519901.json:
```json
{
    "body": "<a id='comment:2'></a>\nNumPy 1.21.1 was released.\n\n- https://github.com/numpy/numpy/releases/tag/v1.21.1\n\n> The NumPy 1.21.1 is a maintenance release that fixes bugs\n> discovered after the 1.21.0 release and updates OpenBLAS\n> to v0.3.17 to deal with problems on arm64.\n\n>\n> The Python versions supported for this release are 3.7-3.9.\n> The 1.21.x series is compatible with development Python 3.10.\n> Python 3.10 will be officially supported after it is released.\n>\n> \u26a0\ufe0f There are unresolved problems compiling NumPy 1.20.0\n> with gcc-11.1.\n>\n>- Optimization level -O3 results in many incorrect\n>  warnings when running the tests.\n>- On some hardware NumPy will hang in an infinite loop.",
    "created_at": "2021-07-19T23:45:50Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519901",
    "user": "https://github.com/slel"
}
```

<a id='comment:2'></a>
NumPy 1.21.1 was released.

- https://github.com/numpy/numpy/releases/tag/v1.21.1

> The NumPy 1.21.1 is a maintenance release that fixes bugs
> discovered after the 1.21.0 release and updates OpenBLAS
> to v0.3.17 to deal with problems on arm64.

>
> The Python versions supported for this release are 3.7-3.9.
> The 1.21.x series is compatible with development Python 3.10.
> Python 3.10 will be officially supported after it is released.
>
> ⚠️ There are unresolved problems compiling NumPy 1.20.0
> with gcc-11.1.
>
>- Optimization level -O3 results in many incorrect
>  warnings when running the tests.
>- On some hardware NumPy will hang in an infinite loop.



---

archive/issue_comments_519902.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n https://github.com/numpy/numpy/releases\n \n-https://docs.scipy.org/doc/scipy/reference/release.1.7.0.html\n+https://docs.scipy.org/doc/scipy/release.1.7.1.html\n \n``````\n",
    "created_at": "2021-08-12T01:09:56Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519902",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
 https://github.com/numpy/numpy/releases
 
-https://docs.scipy.org/doc/scipy/reference/release.1.7.0.html
+https://docs.scipy.org/doc/scipy/release.1.7.1.html
 
``````




---

archive/issue_comments_519903.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,3 +2,15 @@\n \n https://docs.scipy.org/doc/scipy/release.1.7.1.html\n \n+\n+scipy has a new build requirement: pythran https://github.com/scipy/scipy/blob/master/pyproject.toml\n+\n+```\n+[build-system]\n+requires = [\n+    \"wheel\",\n+    \"setuptools\",\n+    \"Cython>=0.29.18\",\n+    \"pybind11>=2.4.3\",\n+    \"pythran>=0.9.11\",\n+```\n``````\n",
    "created_at": "2021-08-12T02:07:42Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519903",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,3 +2,15 @@
 
 https://docs.scipy.org/doc/scipy/release.1.7.1.html
 
+
+scipy has a new build requirement: pythran https://github.com/scipy/scipy/blob/master/pyproject.toml
+
+```
+[build-system]
+requires = [
+    "wheel",
+    "setuptools",
+    "Cython>=0.29.18",
+    "pybind11>=2.4.3",
+    "pythran>=0.9.11",
+```
``````




---

archive/issue_comments_519904.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -14,3 +14,10 @@\n     \"pybind11>=2.4.3\",\n     \"pythran>=0.9.11\",\n ```\n+\n+Unfortunately pythran uses outdated packaging practices.\n+- https://github.com/serge-sans-paille/pythran/issues/1871\n+... which out of the box would require us to add another standard package `pytest-runner`.\n+\n+\n+\n``````\n",
    "created_at": "2021-08-12T02:23:18Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519904",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -14,3 +14,10 @@
     "pybind11>=2.4.3",
     "pythran>=0.9.11",
 ```
+
+Unfortunately pythran uses outdated packaging practices.
+- https://github.com/serge-sans-paille/pythran/issues/1871
+... which out of the box would require us to add another standard package `pytest-runner`.
+
+
+
``````




---

archive/issue_events_288486.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-12T02:23:18Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "rename": {
        "from": "numpy 1.21.x, scipy 1.7.x",
        "to": "Update numpy 1.21.x, scipy 1.7.x; add pythran package (scipy prerequisite)"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288486"
}
```



---

archive/issue_comments_519905.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/numpy_1_21_x__scipy_1_7_x](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/numpy_1_21_x__scipy_1_7_x)",
    "created_at": "2021-08-12T02:28:38Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519905",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/numpy_1_21_x__scipy_1_7_x](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/numpy_1_21_x__scipy_1_7_x)



---

archive/issue_comments_519906.json:
```json
{
    "body": "**Commit:** [461d65ff820f64060b6d25c0704900a255e54263](https://github.com/sagemath/sagetrac-mirror/commit/461d65ff820f64060b6d25c0704900a255e54263)",
    "created_at": "2021-08-12T02:29:17Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519906",
    "user": "https://github.com/mkoeppe"
}
```

**Commit:** [461d65ff820f64060b6d25c0704900a255e54263](https://github.com/sagemath/sagetrac-mirror/commit/461d65ff820f64060b6d25c0704900a255e54263)



---

archive/issue_comments_519907.json:
```json
{
    "body": "<a id='comment:7'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39acb9d43cff2cdc7a1b7456eb7e8850f9cca148\">39acb9d</a></td><td><code>build/pkgs/numpy: Update to 1.21.1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8cb5e083c638fbcd866d3434b0ff5c8005b4ab2b\">8cb5e08</a></td><td><code>build/pkgs/pythran: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/461d65ff820f64060b6d25c0704900a255e54263\">461d65f</a></td><td><code>build/pkgs/scipy: Update to 1.7.1</code></td></tr></table>\n",
    "created_at": "2021-08-12T02:29:17Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519907",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39acb9d43cff2cdc7a1b7456eb7e8850f9cca148">39acb9d</a></td><td><code>build/pkgs/numpy: Update to 1.21.1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8cb5e083c638fbcd866d3434b0ff5c8005b4ab2b">8cb5e08</a></td><td><code>build/pkgs/pythran: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/461d65ff820f64060b6d25c0704900a255e54263">461d65f</a></td><td><code>build/pkgs/scipy: Update to 1.7.1</code></td></tr></table>




---

archive/issue_comments_519908.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -19,5 +19,7 @@\n - https://github.com/serge-sans-paille/pythran/issues/1871\n ... which out of the box would require us to add another standard package `pytest-runner`.\n \n+Fixed in upstream PR https://github.com/serge-sans-paille/pythran/pull/1877\n \n \n+\n``````\n",
    "created_at": "2021-08-14T23:32:17Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519908",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -19,5 +19,7 @@
 - https://github.com/serge-sans-paille/pythran/issues/1871
 ... which out of the box would require us to add another standard package `pytest-runner`.
 
+Fixed in upstream PR https://github.com/serge-sans-paille/pythran/pull/1877
 
 
+
``````




---

archive/issue_comments_519909.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b5d301d5125c399350532daaf70ad0da7dbe54a8\">b5d301d</a></td><td><code>build/pkgs/pythran/patches/1877.patch: New</code></td></tr></table>\n",
    "created_at": "2021-08-14T23:39:03Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519909",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b5d301d5125c399350532daaf70ad0da7dbe54a8">b5d301d</a></td><td><code>build/pkgs/pythran/patches/1877.patch: New</code></td></tr></table>




---

archive/issue_comments_519910.json:
```json
{
    "body": "**Changing commit** from \"[461d65ff820f64060b6d25c0704900a255e54263](https://github.com/sagemath/sagetrac-mirror/commit/461d65ff820f64060b6d25c0704900a255e54263)\" to \"[b5d301d5125c399350532daaf70ad0da7dbe54a8](https://github.com/sagemath/sagetrac-mirror/commit/b5d301d5125c399350532daaf70ad0da7dbe54a8)\".",
    "created_at": "2021-08-14T23:39:03Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519910",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[461d65ff820f64060b6d25c0704900a255e54263](https://github.com/sagemath/sagetrac-mirror/commit/461d65ff820f64060b6d25c0704900a255e54263)" to "[b5d301d5125c399350532daaf70ad0da7dbe54a8](https://github.com/sagemath/sagetrac-mirror/commit/b5d301d5125c399350532daaf70ad0da7dbe54a8)".



---

archive/issue_comments_519911.json:
```json
{
    "body": "**Author:** Matthias Koeppe",
    "created_at": "2021-08-15T03:26:21Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519911",
    "user": "https://github.com/mkoeppe"
}
```

**Author:** Matthias Koeppe



---

archive/issue_comments_519912.json:
```json
{
    "body": "**Changing commit** from \"[b5d301d5125c399350532daaf70ad0da7dbe54a8](https://github.com/sagemath/sagetrac-mirror/commit/b5d301d5125c399350532daaf70ad0da7dbe54a8)\" to \"[e183ac0919430b9de386b3546dd57500718c5174](https://github.com/sagemath/sagetrac-mirror/commit/e183ac0919430b9de386b3546dd57500718c5174)\".",
    "created_at": "2021-08-25T18:41:14Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519912",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b5d301d5125c399350532daaf70ad0da7dbe54a8](https://github.com/sagemath/sagetrac-mirror/commit/b5d301d5125c399350532daaf70ad0da7dbe54a8)" to "[e183ac0919430b9de386b3546dd57500718c5174](https://github.com/sagemath/sagetrac-mirror/commit/e183ac0919430b9de386b3546dd57500718c5174)".



---

archive/issue_comments_519913.json:
```json
{
    "body": "<a id='comment:11'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bca7fb26a0f1c67be2e1a102b809c5a98d138eff\">bca7fb2</a></td><td><code>build/pkgs/numpy: Update to 1.21.1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/565255e5872f00d91eccdeb973e0d29253eed464\">565255e</a></td><td><code>build/pkgs/pythran: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/05805681de4793c50f08d979c5766ca3fe4386c3\">0580568</a></td><td><code>build/pkgs/scipy: Update to 1.7.1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5880de845c871288e78f2047485af18e71848b91\">5880de8</a></td><td><code>build/pkgs/pythran/patches/1877.patch: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e183ac0919430b9de386b3546dd57500718c5174\">e183ac0</a></td><td><code>build/pkgs/numpy: Update to 1.21.2</code></td></tr></table>\n",
    "created_at": "2021-08-25T18:41:14Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519913",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bca7fb26a0f1c67be2e1a102b809c5a98d138eff">bca7fb2</a></td><td><code>build/pkgs/numpy: Update to 1.21.1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/565255e5872f00d91eccdeb973e0d29253eed464">565255e</a></td><td><code>build/pkgs/pythran: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/05805681de4793c50f08d979c5766ca3fe4386c3">0580568</a></td><td><code>build/pkgs/scipy: Update to 1.7.1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5880de845c871288e78f2047485af18e71848b91">5880de8</a></td><td><code>build/pkgs/pythran/patches/1877.patch: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e183ac0919430b9de386b3546dd57500718c5174">e183ac0</a></td><td><code>build/pkgs/numpy: Update to 1.21.2</code></td></tr></table>




---

archive/issue_comments_519914.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n https://github.com/numpy/numpy/releases\n+\n+\"The Python versions supported for this release are 3.7-3.9. The 1.21.x\n+series is compatible with Python 3.10.0rc1 and Python 3.10 will be\n+officially supported after it is released.\"\n \n https://docs.scipy.org/doc/scipy/release.1.7.1.html\n \n``````\n",
    "created_at": "2021-08-25T18:43:53Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519914",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,8 @@
 https://github.com/numpy/numpy/releases
+
+"The Python versions supported for this release are 3.7-3.9. The 1.21.x
+series is compatible with Python 3.10.0rc1 and Python 3.10 will be
+officially supported after it is released."
 
 https://docs.scipy.org/doc/scipy/release.1.7.1.html
 
``````




---

archive/issue_events_288487.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-25T21:48:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288487"
}
```



---

archive/issue_events_288488.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2021-08-25T21:54:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288488"
}
```



---

archive/issue_events_288489.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2021-08-25T21:54:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288489"
}
```



---

archive/issue_comments_519915.json:
```json
{
    "body": "**Reviewer:** Fran\u00e7ois Bissey",
    "created_at": "2021-08-25T21:54:35Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519915",
    "user": "https://github.com/kiwifb"
}
```

**Reviewer:** François Bissey



---

archive/issue_comments_519916.json:
```json
{
    "body": "<a id='comment:14'></a>\nLGTM",
    "created_at": "2021-08-25T21:54:35Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519916",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:14'></a>
LGTM



---

archive/issue_comments_519917.json:
```json
{
    "body": "<a id='comment:15'></a>\n\n```\n[scipy-1.7.1]       FOUND:\n[scipy-1.7.1]         libraries = ['openblas', 'openblas']\n[scipy-1.7.1]         library_dirs = ['/usr/lib64']\n[scipy-1.7.1]         language = f77\n[scipy-1.7.1]         define_macros = [('NO_ATLAS_INFO', 1)]\n[scipy-1.7.1]         include_dirs = ['/usr/local/include', '/home/release/Sage/local/include']\n[scipy-1.7.1] \n[scipy-1.7.1]     Traceback (most recent call last):\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/pip/_vendor/pep517/in_process/_in_process.py\", line 280, in <module>\n[scipy-1.7.1]         main()\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/pip/_vendor/pep517/in_process/_in_process.py\", line 263, in main\n[scipy-1.7.1]         json_out['return_val'] = hook(**hook_input['kwargs'])\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/pip/_vendor/pep517/in_process/_in_process.py\", line 133, in prepare_metadata_for_build_wheel\n[scipy-1.7.1]         return hook(metadata_directory, config_settings)\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/setuptools/build_meta.py\", line 166, in prepare_metadata_for_build_wheel\n[scipy-1.7.1]         self.run_setup()\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/setuptools/build_meta.py\", line 258, in run_setup\n[scipy-1.7.1]         super(_BuildMetaLegacyBackend,\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/setuptools/build_meta.py\", line 150, in run_setup\n[scipy-1.7.1]         exec(compile(code, __file__, 'exec'), locals())\n[scipy-1.7.1]       File \"setup.py\", line 629, in <module>\n[scipy-1.7.1]         setup_package()\n[scipy-1.7.1]       File \"setup.py\", line 625, in setup_package\n[scipy-1.7.1]         setup(**metadata)\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/numpy/distutils/core.py\", line 135, in setup\n[scipy-1.7.1]         config = configuration()\n[scipy-1.7.1]       File \"setup.py\", line 536, in configuration\n[scipy-1.7.1]         config.add_subpackage('scipy')\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/numpy/distutils/misc_util.py\", line 1016, in add_subpackage\n[scipy-1.7.1]         config_list = self.get_subpackage(subpackage_name, subpackage_path,\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/numpy/distutils/misc_util.py\", line 982, in get_subpackage\n[scipy-1.7.1]         config = self._get_configuration_from_setup_py(\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/numpy/distutils/misc_util.py\", line 924, in _get_configuration_from_setup_py\n[scipy-1.7.1]         config = setup_module.configuration(*args)\n[scipy-1.7.1]       File \"scipy/setup.py\", line 12, in configuration\n[scipy-1.7.1]         config.add_subpackage('interpolate')\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/numpy/distutils/misc_util.py\", line 1016, in add_subpackage\n[scipy-1.7.1]         config_list = self.get_subpackage(subpackage_name, subpackage_path,\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/numpy/distutils/misc_util.py\", line 982, in get_subpackage\n[scipy-1.7.1]         config = self._get_configuration_from_setup_py(\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/numpy/distutils/misc_util.py\", line 924, in _get_configuration_from_setup_py\n[scipy-1.7.1]         config = setup_module.configuration(*args)\n[scipy-1.7.1]       File \"scipy/interpolate/setup.py\", line 58, in configuration\n[scipy-1.7.1]         from pythran.dist import PythranExtension\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/pythran/__init__.py\", line 41, in <module>\n[scipy-1.7.1]         from pythran.toolchain import (generate_cxx, compile_cxxfile, compile_cxxcode,\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/pythran/toolchain.py\", line 6, in <module>\n[scipy-1.7.1]         from pythran.backend import Cxx, Python\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/pythran/backend.py\", line 7, in <module>\n[scipy-1.7.1]         from pythran.analyses import LocalNodeDeclarations, GlobalDeclarations, Scope\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/pythran/analyses/__init__.py\", line 12, in <module>\n[scipy-1.7.1]         from .aliases import Aliases, StrictAliases\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/pythran/analyses/aliases.py\", line 3, in <module>\n[scipy-1.7.1]         from pythran.analyses.global_declarations import GlobalDeclarations\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/pythran/analyses/global_declarations.py\", line 3, in <module>\n[scipy-1.7.1]         from pythran.passmanager import ModuleAnalysis\n[scipy-1.7.1]       File \"/home/release/Sage/local/lib64/python3.9/site-packages/pythran/passmanager.py\", line 14, in <module>\n[scipy-1.7.1]         import gast as ast\n[scipy-1.7.1]     ModuleNotFoundError: No module named 'gast'\n[scipy-1.7.1]     Preparing wheel metadata: finished with status 'error'\n[scipy-1.7.1] WARNING: Discarding file:///home/release/Sage/local/var/tmp/sage/build/scipy-1.7.1/src. Command errored out with exit status 1: /home/release/Sage/local/bin/python3 /home/release/Sage/local/lib64/python3.9/site-packages/pip/_vendor/pep517/in_process/_in_process.py prepare_metadata_for_build_wheel /tmp/tmpne_r946f Check the logs for full command output.\n[scipy-1.7.1] ERROR: Command errored out with exit status 1: /home/release/Sage/local/bin/python3 /home/release/Sage/local/lib64/python3.9/site-packages/pip/_vendor/pep517/in_process/_in_process.py prepare_metadata_for_build_wheel /tmp/tmpne_r946f Check the logs for full command output.\n```",
    "created_at": "2021-08-29T12:42:51Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519917",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:15'></a>

```
[scipy-1.7.1]       FOUND:
[scipy-1.7.1]         libraries = ['openblas', 'openblas']
[scipy-1.7.1]         library_dirs = ['/usr/lib64']
[scipy-1.7.1]         language = f77
[scipy-1.7.1]         define_macros = [('NO_ATLAS_INFO', 1)]
[scipy-1.7.1]         include_dirs = ['/usr/local/include', '/home/release/Sage/local/include']
[scipy-1.7.1] 
[scipy-1.7.1]     Traceback (most recent call last):
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/pip/_vendor/pep517/in_process/_in_process.py", line 280, in <module>
[scipy-1.7.1]         main()
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/pip/_vendor/pep517/in_process/_in_process.py", line 263, in main
[scipy-1.7.1]         json_out['return_val'] = hook(**hook_input['kwargs'])
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/pip/_vendor/pep517/in_process/_in_process.py", line 133, in prepare_metadata_for_build_wheel
[scipy-1.7.1]         return hook(metadata_directory, config_settings)
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/setuptools/build_meta.py", line 166, in prepare_metadata_for_build_wheel
[scipy-1.7.1]         self.run_setup()
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/setuptools/build_meta.py", line 258, in run_setup
[scipy-1.7.1]         super(_BuildMetaLegacyBackend,
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/setuptools/build_meta.py", line 150, in run_setup
[scipy-1.7.1]         exec(compile(code, __file__, 'exec'), locals())
[scipy-1.7.1]       File "setup.py", line 629, in <module>
[scipy-1.7.1]         setup_package()
[scipy-1.7.1]       File "setup.py", line 625, in setup_package
[scipy-1.7.1]         setup(**metadata)
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/numpy/distutils/core.py", line 135, in setup
[scipy-1.7.1]         config = configuration()
[scipy-1.7.1]       File "setup.py", line 536, in configuration
[scipy-1.7.1]         config.add_subpackage('scipy')
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/numpy/distutils/misc_util.py", line 1016, in add_subpackage
[scipy-1.7.1]         config_list = self.get_subpackage(subpackage_name, subpackage_path,
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/numpy/distutils/misc_util.py", line 982, in get_subpackage
[scipy-1.7.1]         config = self._get_configuration_from_setup_py(
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/numpy/distutils/misc_util.py", line 924, in _get_configuration_from_setup_py
[scipy-1.7.1]         config = setup_module.configuration(*args)
[scipy-1.7.1]       File "scipy/setup.py", line 12, in configuration
[scipy-1.7.1]         config.add_subpackage('interpolate')
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/numpy/distutils/misc_util.py", line 1016, in add_subpackage
[scipy-1.7.1]         config_list = self.get_subpackage(subpackage_name, subpackage_path,
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/numpy/distutils/misc_util.py", line 982, in get_subpackage
[scipy-1.7.1]         config = self._get_configuration_from_setup_py(
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/numpy/distutils/misc_util.py", line 924, in _get_configuration_from_setup_py
[scipy-1.7.1]         config = setup_module.configuration(*args)
[scipy-1.7.1]       File "scipy/interpolate/setup.py", line 58, in configuration
[scipy-1.7.1]         from pythran.dist import PythranExtension
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/pythran/__init__.py", line 41, in <module>
[scipy-1.7.1]         from pythran.toolchain import (generate_cxx, compile_cxxfile, compile_cxxcode,
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/pythran/toolchain.py", line 6, in <module>
[scipy-1.7.1]         from pythran.backend import Cxx, Python
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/pythran/backend.py", line 7, in <module>
[scipy-1.7.1]         from pythran.analyses import LocalNodeDeclarations, GlobalDeclarations, Scope
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/pythran/analyses/__init__.py", line 12, in <module>
[scipy-1.7.1]         from .aliases import Aliases, StrictAliases
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/pythran/analyses/aliases.py", line 3, in <module>
[scipy-1.7.1]         from pythran.analyses.global_declarations import GlobalDeclarations
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/pythran/analyses/global_declarations.py", line 3, in <module>
[scipy-1.7.1]         from pythran.passmanager import ModuleAnalysis
[scipy-1.7.1]       File "/home/release/Sage/local/lib64/python3.9/site-packages/pythran/passmanager.py", line 14, in <module>
[scipy-1.7.1]         import gast as ast
[scipy-1.7.1]     ModuleNotFoundError: No module named 'gast'
[scipy-1.7.1]     Preparing wheel metadata: finished with status 'error'
[scipy-1.7.1] WARNING: Discarding file:///home/release/Sage/local/var/tmp/sage/build/scipy-1.7.1/src. Command errored out with exit status 1: /home/release/Sage/local/bin/python3 /home/release/Sage/local/lib64/python3.9/site-packages/pip/_vendor/pep517/in_process/_in_process.py prepare_metadata_for_build_wheel /tmp/tmpne_r946f Check the logs for full command output.
[scipy-1.7.1] ERROR: Command errored out with exit status 1: /home/release/Sage/local/bin/python3 /home/release/Sage/local/lib64/python3.9/site-packages/pip/_vendor/pep517/in_process/_in_process.py prepare_metadata_for_build_wheel /tmp/tmpne_r946f Check the logs for full command output.
```



---

archive/issue_events_288490.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-08-29T12:42:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288490"
}
```



---

archive/issue_events_288491.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-08-29T12:42:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288491"
}
```



---

archive/issue_comments_519918.json:
```json
{
    "body": "<a id='comment:16'></a>\nIndeed, from https://github.com/serge-sans-paille/pythran/blob/0.9.12.post1/requirements.txt:\n\n```\nply>=3.4\ngast~=0.5.0\nnumpy\nbeniget~=0.4.0\n```",
    "created_at": "2021-08-29T19:29:27Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519918",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>
Indeed, from https://github.com/serge-sans-paille/pythran/blob/0.9.12.post1/requirements.txt:

```
ply>=3.4
gast~=0.5.0
numpy
beniget~=0.4.0
```



---

archive/issue_comments_519919.json:
```json
{
    "body": "<a id='comment:17'></a>\nhttps://github.com/serge-sans-paille/gast is basically a backport package for Python 3's `ast`. I tried to patch it out in https://github.com/mkoeppe/pythran/pull/3, but that did not work, apparently because of https://github.com/serge-sans-paille/gast#ast-changes",
    "created_at": "2021-08-30T01:02:28Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519919",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>
https://github.com/serge-sans-paille/gast is basically a backport package for Python 3's `ast`. I tried to patch it out in https://github.com/mkoeppe/pythran/pull/3, but that did not work, apparently because of https://github.com/serge-sans-paille/gast#ast-changes



---

archive/issue_comments_519920.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,8 +1,3 @@\n-https://github.com/numpy/numpy/releases\n-\n-\"The Python versions supported for this release are 3.7-3.9. The 1.21.x\n-series is compatible with Python 3.10.0rc1 and Python 3.10 will be\n-officially supported after it is released.\"\n \n https://docs.scipy.org/doc/scipy/release.1.7.1.html\n \n``````\n",
    "created_at": "2021-09-07T22:20:50Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519920",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,8 +1,3 @@
-https://github.com/numpy/numpy/releases
-
-"The Python versions supported for this release are 3.7-3.9. The 1.21.x
-series is compatible with Python 3.10.0rc1 and Python 3.10 will be
-officially supported after it is released."
 
 https://docs.scipy.org/doc/scipy/release.1.7.1.html
 
``````




---

archive/issue_comments_519921.json:
```json
{
    "body": "<a id='comment:18'></a>\nI'm splitting out the easier numpy update to #32488.",
    "created_at": "2021-09-07T22:20:50Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519921",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>
I'm splitting out the easier numpy update to #32488.



---

archive/issue_comments_519922.json:
```json
{
    "body": "**Dependencies:** #32488",
    "created_at": "2021-09-07T22:20:50Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519922",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #32488



---

archive/issue_events_288492.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-07T22:20:50Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "rename": {
        "from": "Update numpy 1.21.x, scipy 1.7.x; add pythran package (scipy prerequisite)",
        "to": "Update scipy 1.7.x; add pythran package (scipy prerequisite)"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288492"
}
```



---

archive/issue_comments_519923.json:
```json
{
    "body": "**Changing commit** from \"[e183ac0919430b9de386b3546dd57500718c5174](https://github.com/sagemath/sagetrac-mirror/commit/e183ac0919430b9de386b3546dd57500718c5174)\" to \"[68d9d0d712e86a61ee6c1b5bedb1166c04a57d95](https://github.com/sagemath/sagetrac-mirror/commit/68d9d0d712e86a61ee6c1b5bedb1166c04a57d95)\".",
    "created_at": "2021-09-18T04:58:35Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519923",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e183ac0919430b9de386b3546dd57500718c5174](https://github.com/sagemath/sagetrac-mirror/commit/e183ac0919430b9de386b3546dd57500718c5174)" to "[68d9d0d712e86a61ee6c1b5bedb1166c04a57d95](https://github.com/sagemath/sagetrac-mirror/commit/68d9d0d712e86a61ee6c1b5bedb1166c04a57d95)".



---

archive/issue_comments_519924.json:
```json
{
    "body": "<a id='comment:19'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f1beea0d2a791e7a06dd41113f8529c245f13daa\">f1beea0</a></td><td><code>Merge tag '9.5.beta1' into t/32105/numpy_1_21_x__scipy_1_7_x</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6cca6441766094ed7849cdd1f0dd658c6be6c049\">6cca644</a></td><td><code>build/pkgs/pythran: Update to 0.10.0</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b68e6d435aa8b99be66dc758b48189c2275fc779\">b68e6d4</a></td><td><code>build/pkgs/{beniget,gast,ply}: New (pythran deps)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2533d2b87ec18ef7949e7920e6ee6baa83b2f5fa\">2533d2b</a></td><td><code>build/pkgs/pythran/patches/1877.patch: Remove</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68d9d0d712e86a61ee6c1b5bedb1166c04a57d95\">68d9d0d</a></td><td><code>build/pkgs/pythran/dependencies: Add numpy</code></td></tr></table>\n",
    "created_at": "2021-09-18T04:58:35Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519924",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f1beea0d2a791e7a06dd41113f8529c245f13daa">f1beea0</a></td><td><code>Merge tag '9.5.beta1' into t/32105/numpy_1_21_x__scipy_1_7_x</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6cca6441766094ed7849cdd1f0dd658c6be6c049">6cca644</a></td><td><code>build/pkgs/pythran: Update to 0.10.0</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b68e6d435aa8b99be66dc758b48189c2275fc779">b68e6d4</a></td><td><code>build/pkgs/{beniget,gast,ply}: New (pythran deps)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2533d2b87ec18ef7949e7920e6ee6baa83b2f5fa">2533d2b</a></td><td><code>build/pkgs/pythran/patches/1877.patch: Remove</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68d9d0d712e86a61ee6c1b5bedb1166c04a57d95">68d9d0d</a></td><td><code>build/pkgs/pythran/dependencies: Add numpy</code></td></tr></table>




---

archive/issue_events_288493.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-18T04:59:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288493"
}
```



---

archive/issue_events_288494.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-18T04:59:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288494"
}
```



---

archive/issue_comments_519925.json:
```json
{
    "body": "<a id='comment:21'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b26a0d797b1249036cc964dc67445aaa278763c8\">b26a0d7</a></td><td><code>build/pkgs/beniget/dependencies: Add gast</code></td></tr></table>\n",
    "created_at": "2021-09-18T05:18:55Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519925",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b26a0d797b1249036cc964dc67445aaa278763c8">b26a0d7</a></td><td><code>build/pkgs/beniget/dependencies: Add gast</code></td></tr></table>




---

archive/issue_comments_519926.json:
```json
{
    "body": "**Changing commit** from \"[68d9d0d712e86a61ee6c1b5bedb1166c04a57d95](https://github.com/sagemath/sagetrac-mirror/commit/68d9d0d712e86a61ee6c1b5bedb1166c04a57d95)\" to \"[b26a0d797b1249036cc964dc67445aaa278763c8](https://github.com/sagemath/sagetrac-mirror/commit/b26a0d797b1249036cc964dc67445aaa278763c8)\".",
    "created_at": "2021-09-18T05:18:55Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519926",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[68d9d0d712e86a61ee6c1b5bedb1166c04a57d95](https://github.com/sagemath/sagetrac-mirror/commit/68d9d0d712e86a61ee6c1b5bedb1166c04a57d95)" to "[b26a0d797b1249036cc964dc67445aaa278763c8](https://github.com/sagemath/sagetrac-mirror/commit/b26a0d797b1249036cc964dc67445aaa278763c8)".



---

archive/issue_comments_519927.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -14,11 +14,4 @@\n     \"pythran>=0.9.11\",\n ```\n \n-Unfortunately pythran uses outdated packaging practices.\n-- https://github.com/serge-sans-paille/pythran/issues/1871\n-... which out of the box would require us to add another standard package `pytest-runner`.\n \n-Fixed in upstream PR https://github.com/serge-sans-paille/pythran/pull/1877\n-\n-\n-\n``````\n",
    "created_at": "2021-09-18T05:31:14Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519927",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -14,11 +14,4 @@
     "pythran>=0.9.11",
 ```
 
-Unfortunately pythran uses outdated packaging practices.
-- https://github.com/serge-sans-paille/pythran/issues/1871
-... which out of the box would require us to add another standard package `pytest-runner`.
 
-Fixed in upstream PR https://github.com/serge-sans-paille/pythran/pull/1877
-
-
-
``````




---

archive/issue_comments_519928.json:
```json
{
    "body": "<a id='comment:24'></a>\nlgtm - perhaps, merge the current beta in, and run tests on GH Actions?",
    "created_at": "2021-11-02T20:07:24Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519928",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:24'></a>
lgtm - perhaps, merge the current beta in, and run tests on GH Actions?



---

archive/issue_comments_519929.json:
```json
{
    "body": "<a id='comment:25'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9d6b0dbcecd8ffde410481cf6bfb91ec1a712dd6\">9d6b0db</a></td><td><code>Merge tag '9.5.beta5' into t/32105/numpy_1_21_x__scipy_1_7_x</code></td></tr></table>\n",
    "created_at": "2021-11-02T20:24:43Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519929",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9d6b0dbcecd8ffde410481cf6bfb91ec1a712dd6">9d6b0db</a></td><td><code>Merge tag '9.5.beta5' into t/32105/numpy_1_21_x__scipy_1_7_x</code></td></tr></table>




---

archive/issue_comments_519930.json:
```json
{
    "body": "**Changing commit** from \"[b26a0d797b1249036cc964dc67445aaa278763c8](https://github.com/sagemath/sagetrac-mirror/commit/b26a0d797b1249036cc964dc67445aaa278763c8)\" to \"[9d6b0dbcecd8ffde410481cf6bfb91ec1a712dd6](https://github.com/sagemath/sagetrac-mirror/commit/9d6b0dbcecd8ffde410481cf6bfb91ec1a712dd6)\".",
    "created_at": "2021-11-02T20:24:43Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519930",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b26a0d797b1249036cc964dc67445aaa278763c8](https://github.com/sagemath/sagetrac-mirror/commit/b26a0d797b1249036cc964dc67445aaa278763c8)" to "[9d6b0dbcecd8ffde410481cf6bfb91ec1a712dd6](https://github.com/sagemath/sagetrac-mirror/commit/9d6b0dbcecd8ffde410481cf6bfb91ec1a712dd6)".



---

archive/issue_comments_519931.json:
```json
{
    "body": "**Changing reviewer** from \"Fran\u00e7ois Bissey\" to \"Fran\u00e7ois Bissey,\".",
    "created_at": "2021-11-02T20:37:17Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519931",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "François Bissey" to "François Bissey,".



---

archive/issue_comments_519932.json:
```json
{
    "body": "<a id='comment:26'></a>\nRunning the CI tests on top of Volker's current branch, which includes critical build fixes such as #32746",
    "created_at": "2021-11-02T20:37:17Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519932",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>
Running the CI tests on top of Volker's current branch, which includes critical build fixes such as #32746



---

archive/issue_comments_519933.json:
```json
{
    "body": "**Changing reviewer** from \"Fran\u00e7ois Bissey,\" to \"Fran\u00e7ois Bissey, https://github.com/mkoeppe/sage/actions/runs/1414055141, https://github.com/mkoeppe/sage/actions/runs/1414055146\".",
    "created_at": "2021-11-02T20:38:02Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519933",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "François Bissey," to "François Bissey, https://github.com/mkoeppe/sage/actions/runs/1414055141, https://github.com/mkoeppe/sage/actions/runs/1414055146".



---

archive/issue_comments_519934.json:
```json
{
    "body": "<a id='comment:28'></a>\nlooks OK, modulo unrelated errors, and the usual Cygwin blues",
    "created_at": "2021-11-05T13:15:27Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519934",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:28'></a>
looks OK, modulo unrelated errors, and the usual Cygwin blues



---

archive/issue_comments_519935.json:
```json
{
    "body": "**Changing reviewer** from \"Fran\u00e7ois Bissey, https://github.com/mkoeppe/sage/actions/runs/1414055141, https://github.com/mkoeppe/sage/actions/runs/1414055146\" to \"Fran\u00e7ois Bissey, Dima Pasechnik\".",
    "created_at": "2021-11-05T13:15:27Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519935",
    "user": "https://github.com/dimpase"
}
```

**Changing reviewer** from "François Bissey, https://github.com/mkoeppe/sage/actions/runs/1414055141, https://github.com/mkoeppe/sage/actions/runs/1414055146" to "François Bissey, Dima Pasechnik".



---

archive/issue_events_288495.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-05T13:15:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288495"
}
```



---

archive/issue_events_288496.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-05T13:15:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288496"
}
```



---

archive/issue_comments_519936.json:
```json
{
    "body": "<a id='comment:29'></a>\nThanks.",
    "created_at": "2021-11-05T17:25:20Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519936",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>
Thanks.



---

archive/issue_comments_519937.json:
```json
{
    "body": "<a id='comment:30'></a>\nAfter a make distclean (and not just an incremental build, and not just make clean) test fail with\n\n```\nsage -t --warn-long 59.1 --random-seed=32710823712882651180286903013949123952 src/sage/ext/memory_allocator.pxd  # 2 doctests failed\nsage -t --warn-long 59.1 --random-seed=32710823712882651180286903013949123952 src/sage/ext/memory_allocator.pyx  # 1 doctest failed\n```",
    "created_at": "2021-11-11T00:04:21Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519937",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:30'></a>
After a make distclean (and not just an incremental build, and not just make clean) test fail with

```
sage -t --warn-long 59.1 --random-seed=32710823712882651180286903013949123952 src/sage/ext/memory_allocator.pxd  # 2 doctests failed
sage -t --warn-long 59.1 --random-seed=32710823712882651180286903013949123952 src/sage/ext/memory_allocator.pyx  # 1 doctest failed
```



---

archive/issue_events_288497.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-11T00:04:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288497"
}
```



---

archive/issue_events_288498.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-11T00:04:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288498"
}
```



---

archive/issue_comments_519938.json:
```json
{
    "body": "**Changing commit** from \"[9d6b0dbcecd8ffde410481cf6bfb91ec1a712dd6](https://github.com/sagemath/sagetrac-mirror/commit/9d6b0dbcecd8ffde410481cf6bfb91ec1a712dd6)\" to \"[21463e203b72fbd8074cb7586b18e7fa699f5e29](https://github.com/sagemath/sagetrac-mirror/commit/21463e203b72fbd8074cb7586b18e7fa699f5e29)\".",
    "created_at": "2021-11-15T04:03:20Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519938",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9d6b0dbcecd8ffde410481cf6bfb91ec1a712dd6](https://github.com/sagemath/sagetrac-mirror/commit/9d6b0dbcecd8ffde410481cf6bfb91ec1a712dd6)" to "[21463e203b72fbd8074cb7586b18e7fa699f5e29](https://github.com/sagemath/sagetrac-mirror/commit/21463e203b72fbd8074cb7586b18e7fa699f5e29)".



---

archive/issue_comments_519939.json:
```json
{
    "body": "<a id='comment:32'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7072bd69aca0cd5d88b9381fbc03a9d3bb84a878\">7072bd6</a></td><td><code>build/pkgs/scipy: Update to 1.7.2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9e167c8cc238173bd6dff0fd3bf4c34741d89a83\">9e167c8</a></td><td><code>build/pkgs/pybind11: Update to 2.8.1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/21463e203b72fbd8074cb7586b18e7fa699f5e29\">21463e2</a></td><td><code>Merge tag '9.5.beta6' into t/32105/numpy_1_21_x__scipy_1_7_x</code></td></tr></table>\n",
    "created_at": "2021-11-15T04:03:20Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519939",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7072bd69aca0cd5d88b9381fbc03a9d3bb84a878">7072bd6</a></td><td><code>build/pkgs/scipy: Update to 1.7.2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9e167c8cc238173bd6dff0fd3bf4c34741d89a83">9e167c8</a></td><td><code>build/pkgs/pybind11: Update to 2.8.1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/21463e203b72fbd8074cb7586b18e7fa699f5e29">21463e2</a></td><td><code>Merge tag '9.5.beta6' into t/32105/numpy_1_21_x__scipy_1_7_x</code></td></tr></table>




---

archive/issue_comments_519940.json:
```json
{
    "body": "<a id='comment:33'></a>\nIn the meantime new versions have come out",
    "created_at": "2021-11-15T04:03:40Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519940",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'></a>
In the meantime new versions have come out



---

archive/issue_comments_519941.json:
```json
{
    "body": "**Changing commit** from \"[21463e203b72fbd8074cb7586b18e7fa699f5e29](https://github.com/sagemath/sagetrac-mirror/commit/21463e203b72fbd8074cb7586b18e7fa699f5e29)\" to \"[581f874949a6fa1921c4be58c78a0c69918d72f1](https://github.com/sagemath/sagetrac-mirror/commit/581f874949a6fa1921c4be58c78a0c69918d72f1)\".",
    "created_at": "2021-11-15T04:45:44Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519941",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[21463e203b72fbd8074cb7586b18e7fa699f5e29](https://github.com/sagemath/sagetrac-mirror/commit/21463e203b72fbd8074cb7586b18e7fa699f5e29)" to "[581f874949a6fa1921c4be58c78a0c69918d72f1](https://github.com/sagemath/sagetrac-mirror/commit/581f874949a6fa1921c4be58c78a0c69918d72f1)".



---

archive/issue_comments_519942.json:
```json
{
    "body": "<a id='comment:34'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/581f874949a6fa1921c4be58c78a0c69918d72f1\">581f874</a></td><td><code>build/pkgs/pybind11/patches/3270.patch: Remove</code></td></tr></table>\n",
    "created_at": "2021-11-15T04:45:44Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519942",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/581f874949a6fa1921c4be58c78a0c69918d72f1">581f874</a></td><td><code>build/pkgs/pybind11/patches/3270.patch: Remove</code></td></tr></table>




---

archive/issue_comments_519943.json:
```json
{
    "body": "<a id='comment:35'></a>\nReplying to [vbraun](#comment%3A30):\n> After a make distclean (and not just an incremental build, and not just make clean) test fail with\n> \n> ```\n> sage -t --warn-long 59.1 --random-seed=32710823712882651180286903013949123952 src/sage/ext/memory_allocator.pxd  # 2 doctests failed\n> sage -t --warn-long 59.1 --random-seed=32710823712882651180286903013949123952 src/sage/ext/memory_allocator.pyx  # 1 doctest failed\n> ```\n\nI can reproduce those failures and they are trivial:\n\n```\nsage -t --warn-long 59.1 --random-seed=32710823712882651180286903013949123952 src/sage/ext/memory_allocator.pxd\n**********************************************************************\nFile \"src/sage/ext/memory_allocator.pxd\", line 88, in sage.ext.memory_allocator.MemoryAllocator.?\nFailed example:\n    cython('''\n    from sage.ext.memory_allocator cimport MemoryAllocator\n    cdef MemoryAllocator mem = MemoryAllocator()\n    cdef void* ptr\n    for i in range(12):\n        ptr = mem.aligned_calloc(2**i, i, 2**i)\n        assert <size_t> ptr == (<size_t> ptr) & ~(2**i-1)\n    ''')\nExpected nothing\nGot:\n    doctest:warning\n      File \"/srv/public/kliem/sage/src/bin/sage-runtests\", line 151, in <module>\n        err = DC.run()\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/control.py\", line 1257, in run\n        self.run_doctests()\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/control.py\", line 959, in run_doctests\n        self.dispatcher.dispatch()\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1996, in dispatch\n        self.parallel_dispatch()\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1891, in parallel_dispatch\n        w.start()  # This might take some time\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 2163, in start\n        super(DocTestWorker, self).start()\n      File \"/usr/lib/python3.7/multiprocessing/process.py\", line 112, in start\n        self._popen = self._Popen(self)\n      File \"/usr/lib/python3.7/multiprocessing/context.py\", line 223, in _Popen\n        return _default_context.get_context().Process._Popen(process_obj)\n      File \"/usr/lib/python3.7/multiprocessing/context.py\", line 277, in _Popen\n        return Popen(process_obj)\n      File \"/usr/lib/python3.7/multiprocessing/popen_fork.py\", line 20, in __init__\n        self._launch(process_obj)\n      File \"/usr/lib/python3.7/multiprocessing/popen_fork.py\", line 74, in _launch\n        code = process_obj._bootstrap()\n      File \"/usr/lib/python3.7/multiprocessing/process.py\", line 297, in _bootstrap\n        self.run()\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 2135, in run\n        task(self.options, self.outtmpfile, msgpipe, self.result_queue)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 2465, in __call__\n        doctests, extras = self._run(runner, options, results)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 2517, in _run\n        result = runner.run(test)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 861, in run\n        return self._run(test, compileflags, out)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.ext.memory_allocator.MemoryAllocator.?[0]>\", line 8, in <module>\n        ''')\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/cython.py\", line 661, in cython_compile\n        return cython_import_all(tmpfile, get_globals(), **kwds)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/cython.py\", line 551, in cython_import_all\n        m = cython_import(filename, **kwds)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/cython.py\", line 531, in cython_import\n        return builtins.__import__(name)\n      File \"<frozen importlib._bootstrap>\", line 983, in _find_and_load\n      File \"<frozen importlib._bootstrap>\", line 967, in _find_and_load_unlocked\n      File \"<frozen importlib._bootstrap>\", line 677, in _load_unlocked\n      File \"<frozen importlib._bootstrap_external>\", line 1050, in exec_module\n      File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/superseded.py\", line 99, in deprecation\n        warning(trac_number, message, DeprecationWarning, stacklevel)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/superseded.py\", line 180, in warning\n        warn(message, warning_class, stacklevel)\n      File \"/usr/lib/python3.7/warnings.py\", line 110, in _showwarnmsg\n        msg.file, msg.line)\n    :\n    DeprecationWarning: this class is deprecated; use the class from the python package `memory_allocator`\n    See https://trac.sagemath.org/31591 for details.\n**********************************************************************\nFile \"src/sage/ext/memory_allocator.pxd\", line 119, in sage.ext.memory_allocator.MemoryAllocator.?\nFailed example:\n    cython('''\n    from sage.ext.memory_allocator cimport MemoryAllocator\n    cdef MemoryAllocator mem = MemoryAllocator()\n    cdef void* ptr\n    for i in range(12):\n        ptr = mem.aligned_allocarray(2**i, i, 2**i)\n        assert <size_t> ptr == (<size_t> ptr) & ~(2**i-1)\n    ''')\nExpected nothing\nGot:\n    doctest:warning\n      File \"/srv/public/kliem/sage/src/bin/sage-runtests\", line 151, in <module>\n        err = DC.run()\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/control.py\", line 1257, in run\n        self.run_doctests()\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/control.py\", line 959, in run_doctests\n        self.dispatcher.dispatch()\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1996, in dispatch\n        self.parallel_dispatch()\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1891, in parallel_dispatch\n        w.start()  # This might take some time\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 2163, in start\n        super(DocTestWorker, self).start()\n      File \"/usr/lib/python3.7/multiprocessing/process.py\", line 112, in start\n        self._popen = self._Popen(self)\n      File \"/usr/lib/python3.7/multiprocessing/context.py\", line 223, in _Popen\n        return _default_context.get_context().Process._Popen(process_obj)\n      File \"/usr/lib/python3.7/multiprocessing/context.py\", line 277, in _Popen\n        return Popen(process_obj)\n      File \"/usr/lib/python3.7/multiprocessing/popen_fork.py\", line 20, in __init__\n        self._launch(process_obj)\n      File \"/usr/lib/python3.7/multiprocessing/popen_fork.py\", line 74, in _launch\n        code = process_obj._bootstrap()\n      File \"/usr/lib/python3.7/multiprocessing/process.py\", line 297, in _bootstrap\n        self.run()\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 2135, in run\n        task(self.options, self.outtmpfile, msgpipe, self.result_queue)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 2465, in __call__\n        doctests, extras = self._run(runner, options, results)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 2517, in _run\n        result = runner.run(test)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 861, in run\n        return self._run(test, compileflags, out)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.ext.memory_allocator.MemoryAllocator.?[0]>\", line 8, in <module>\n        ''')\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/cython.py\", line 661, in cython_compile\n        return cython_import_all(tmpfile, get_globals(), **kwds)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/cython.py\", line 551, in cython_import_all\n        m = cython_import(filename, **kwds)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/cython.py\", line 531, in cython_import\n        return builtins.__import__(name)\n      File \"<frozen importlib._bootstrap>\", line 983, in _find_and_load\n      File \"<frozen importlib._bootstrap>\", line 967, in _find_and_load_unlocked\n      File \"<frozen importlib._bootstrap>\", line 677, in _load_unlocked\n      File \"<frozen importlib._bootstrap_external>\", line 1050, in exec_module\n      File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/superseded.py\", line 99, in deprecation\n        warning(trac_number, message, DeprecationWarning, stacklevel)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/superseded.py\", line 180, in warning\n        warn(message, warning_class, stacklevel)\n      File \"/usr/lib/python3.7/warnings.py\", line 110, in _showwarnmsg\n        msg.file, msg.line)\n    :\n    DeprecationWarning: this class is deprecated; use the class from the python package `memory_allocator`\n    See https://trac.sagemath.org/31591 for details.\n**********************************************************************\n1 item had failures:\n   2 of   6 in sage.ext.memory_allocator.MemoryAllocator.?\n    [3 tests, 2 failures, 1.77 s]\n----------------------------------------------------------------------\nsage -t --warn-long 59.1 --random-seed=32710823712882651180286903013949123952 src/sage/ext/memory_allocator.pxd  # 2 doctests failed\n```\n\n```\nsage -t --warn-long 59.1 --random-seed=32710823712882651180286903013949123952 src/sage/ext/memory_allocator.pyx\n**********************************************************************\nFile \"src/sage/ext/memory_allocator.pyx\", line 34, in sage.ext.memory_allocator.MemoryAllocator.__cinit__\nFailed example:\n    cython(\n    '''\n    from sage.ext.memory_allocator cimport MemoryAllocator\n    cdef MemoryAllocator mem = MemoryAllocator.__new__(MemoryAllocator)\n    mem.malloc(10000)\n    print(mem.n)\n    print(mem.size)\n    ''')\nExpected:\n    1\n    16\nGot:\n    doctest:warning\n      File \"/srv/public/kliem/sage/src/bin/sage-runtests\", line 151, in <module>\n        err = DC.run()\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/control.py\", line 1257, in run\n        self.run_doctests()\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/control.py\", line 959, in run_doctests\n        self.dispatcher.dispatch()\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1996, in dispatch\n        self.parallel_dispatch()\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1891, in parallel_dispatch\n        w.start()  # This might take some time\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 2163, in start\n        super(DocTestWorker, self).start()\n      File \"/usr/lib/python3.7/multiprocessing/process.py\", line 112, in start\n        self._popen = self._Popen(self)\n      File \"/usr/lib/python3.7/multiprocessing/context.py\", line 223, in _Popen\n        return _default_context.get_context().Process._Popen(process_obj)\n      File \"/usr/lib/python3.7/multiprocessing/context.py\", line 277, in _Popen\n        return Popen(process_obj)\n      File \"/usr/lib/python3.7/multiprocessing/popen_fork.py\", line 20, in __init__\n        self._launch(process_obj)\n      File \"/usr/lib/python3.7/multiprocessing/popen_fork.py\", line 74, in _launch\n        code = process_obj._bootstrap()\n      File \"/usr/lib/python3.7/multiprocessing/process.py\", line 297, in _bootstrap\n        self.run()\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 2135, in run\n        task(self.options, self.outtmpfile, msgpipe, self.result_queue)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 2465, in __call__\n        doctests, extras = self._run(runner, options, results)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 2517, in _run\n        result = runner.run(test)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 861, in run\n        return self._run(test, compileflags, out)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.ext.memory_allocator.MemoryAllocator.__cinit__[0]>\", line 8, in <module>\n        ''')\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/cython.py\", line 661, in cython_compile\n        return cython_import_all(tmpfile, get_globals(), **kwds)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/cython.py\", line 551, in cython_import_all\n        m = cython_import(filename, **kwds)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/cython.py\", line 531, in cython_import\n        return builtins.__import__(name)\n      File \"<frozen importlib._bootstrap>\", line 983, in _find_and_load\n      File \"<frozen importlib._bootstrap>\", line 967, in _find_and_load_unlocked\n      File \"<frozen importlib._bootstrap>\", line 677, in _load_unlocked\n      File \"<frozen importlib._bootstrap_external>\", line 1050, in exec_module\n      File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/superseded.py\", line 99, in deprecation\n        warning(trac_number, message, DeprecationWarning, stacklevel)\n      File \"/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/superseded.py\", line 180, in warning\n        warn(message, warning_class, stacklevel)\n      File \"/usr/lib/python3.7/warnings.py\", line 110, in _showwarnmsg\n        msg.file, msg.line)\n    :\n    DeprecationWarning: this class is deprecated; use the class from the python package `memory_allocator`\n    See https://trac.sagemath.org/31591 for details.\n    1\n    16\n**********************************************************************\n1 item had failures:\n   1 of   2 in sage.ext.memory_allocator.MemoryAllocator.__cinit__\n    [8 tests, 1 failure, 1.76 s]\n----------------------------------------------------------------------\nsage -t --warn-long 59.1 --random-seed=32710823712882651180286903013949123952 src/sage/ext/memory_allocator.pyx  # 1 doctest failed\n```\n\nDoesn't require a distclean in my case. I have no idea why this is happening now and how to determine when deprecation messages are raised and when not.\n\nFor some reason it changed now.",
    "created_at": "2021-11-15T07:25:56Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519943",
    "user": "https://github.com/kliem"
}
```

<a id='comment:35'></a>
Replying to [vbraun](#comment%3A30):
> After a make distclean (and not just an incremental build, and not just make clean) test fail with
> 
> ```
> sage -t --warn-long 59.1 --random-seed=32710823712882651180286903013949123952 src/sage/ext/memory_allocator.pxd  # 2 doctests failed
> sage -t --warn-long 59.1 --random-seed=32710823712882651180286903013949123952 src/sage/ext/memory_allocator.pyx  # 1 doctest failed
> ```

I can reproduce those failures and they are trivial:

```
sage -t --warn-long 59.1 --random-seed=32710823712882651180286903013949123952 src/sage/ext/memory_allocator.pxd
**********************************************************************
File "src/sage/ext/memory_allocator.pxd", line 88, in sage.ext.memory_allocator.MemoryAllocator.?
Failed example:
    cython('''
    from sage.ext.memory_allocator cimport MemoryAllocator
    cdef MemoryAllocator mem = MemoryAllocator()
    cdef void* ptr
    for i in range(12):
        ptr = mem.aligned_calloc(2**i, i, 2**i)
        assert <size_t> ptr == (<size_t> ptr) & ~(2**i-1)
    ''')
Expected nothing
Got:
    doctest:warning
      File "/srv/public/kliem/sage/src/bin/sage-runtests", line 151, in <module>
        err = DC.run()
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/control.py", line 1257, in run
        self.run_doctests()
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/control.py", line 959, in run_doctests
        self.dispatcher.dispatch()
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1996, in dispatch
        self.parallel_dispatch()
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1891, in parallel_dispatch
        w.start()  # This might take some time
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2163, in start
        super(DocTestWorker, self).start()
      File "/usr/lib/python3.7/multiprocessing/process.py", line 112, in start
        self._popen = self._Popen(self)
      File "/usr/lib/python3.7/multiprocessing/context.py", line 223, in _Popen
        return _default_context.get_context().Process._Popen(process_obj)
      File "/usr/lib/python3.7/multiprocessing/context.py", line 277, in _Popen
        return Popen(process_obj)
      File "/usr/lib/python3.7/multiprocessing/popen_fork.py", line 20, in __init__
        self._launch(process_obj)
      File "/usr/lib/python3.7/multiprocessing/popen_fork.py", line 74, in _launch
        code = process_obj._bootstrap()
      File "/usr/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
        self.run()
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2135, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2465, in __call__
        doctests, extras = self._run(runner, options, results)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2517, in _run
        result = runner.run(test)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 861, in run
        return self._run(test, compileflags, out)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.ext.memory_allocator.MemoryAllocator.?[0]>", line 8, in <module>
        ''')
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/cython.py", line 661, in cython_compile
        return cython_import_all(tmpfile, get_globals(), **kwds)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/cython.py", line 551, in cython_import_all
        m = cython_import(filename, **kwds)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/cython.py", line 531, in cython_import
        return builtins.__import__(name)
      File "<frozen importlib._bootstrap>", line 983, in _find_and_load
      File "<frozen importlib._bootstrap>", line 967, in _find_and_load_unlocked
      File "<frozen importlib._bootstrap>", line 677, in _load_unlocked
      File "<frozen importlib._bootstrap_external>", line 1050, in exec_module
      File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/superseded.py", line 99, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/superseded.py", line 180, in warning
        warn(message, warning_class, stacklevel)
      File "/usr/lib/python3.7/warnings.py", line 110, in _showwarnmsg
        msg.file, msg.line)
    :
    DeprecationWarning: this class is deprecated; use the class from the python package `memory_allocator`
    See https://trac.sagemath.org/31591 for details.
**********************************************************************
File "src/sage/ext/memory_allocator.pxd", line 119, in sage.ext.memory_allocator.MemoryAllocator.?
Failed example:
    cython('''
    from sage.ext.memory_allocator cimport MemoryAllocator
    cdef MemoryAllocator mem = MemoryAllocator()
    cdef void* ptr
    for i in range(12):
        ptr = mem.aligned_allocarray(2**i, i, 2**i)
        assert <size_t> ptr == (<size_t> ptr) & ~(2**i-1)
    ''')
Expected nothing
Got:
    doctest:warning
      File "/srv/public/kliem/sage/src/bin/sage-runtests", line 151, in <module>
        err = DC.run()
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/control.py", line 1257, in run
        self.run_doctests()
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/control.py", line 959, in run_doctests
        self.dispatcher.dispatch()
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1996, in dispatch
        self.parallel_dispatch()
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1891, in parallel_dispatch
        w.start()  # This might take some time
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2163, in start
        super(DocTestWorker, self).start()
      File "/usr/lib/python3.7/multiprocessing/process.py", line 112, in start
        self._popen = self._Popen(self)
      File "/usr/lib/python3.7/multiprocessing/context.py", line 223, in _Popen
        return _default_context.get_context().Process._Popen(process_obj)
      File "/usr/lib/python3.7/multiprocessing/context.py", line 277, in _Popen
        return Popen(process_obj)
      File "/usr/lib/python3.7/multiprocessing/popen_fork.py", line 20, in __init__
        self._launch(process_obj)
      File "/usr/lib/python3.7/multiprocessing/popen_fork.py", line 74, in _launch
        code = process_obj._bootstrap()
      File "/usr/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
        self.run()
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2135, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2465, in __call__
        doctests, extras = self._run(runner, options, results)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2517, in _run
        result = runner.run(test)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 861, in run
        return self._run(test, compileflags, out)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.ext.memory_allocator.MemoryAllocator.?[0]>", line 8, in <module>
        ''')
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/cython.py", line 661, in cython_compile
        return cython_import_all(tmpfile, get_globals(), **kwds)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/cython.py", line 551, in cython_import_all
        m = cython_import(filename, **kwds)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/cython.py", line 531, in cython_import
        return builtins.__import__(name)
      File "<frozen importlib._bootstrap>", line 983, in _find_and_load
      File "<frozen importlib._bootstrap>", line 967, in _find_and_load_unlocked
      File "<frozen importlib._bootstrap>", line 677, in _load_unlocked
      File "<frozen importlib._bootstrap_external>", line 1050, in exec_module
      File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/superseded.py", line 99, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/superseded.py", line 180, in warning
        warn(message, warning_class, stacklevel)
      File "/usr/lib/python3.7/warnings.py", line 110, in _showwarnmsg
        msg.file, msg.line)
    :
    DeprecationWarning: this class is deprecated; use the class from the python package `memory_allocator`
    See https://trac.sagemath.org/31591 for details.
**********************************************************************
1 item had failures:
   2 of   6 in sage.ext.memory_allocator.MemoryAllocator.?
    [3 tests, 2 failures, 1.77 s]
----------------------------------------------------------------------
sage -t --warn-long 59.1 --random-seed=32710823712882651180286903013949123952 src/sage/ext/memory_allocator.pxd  # 2 doctests failed
```

```
sage -t --warn-long 59.1 --random-seed=32710823712882651180286903013949123952 src/sage/ext/memory_allocator.pyx
**********************************************************************
File "src/sage/ext/memory_allocator.pyx", line 34, in sage.ext.memory_allocator.MemoryAllocator.__cinit__
Failed example:
    cython(
    '''
    from sage.ext.memory_allocator cimport MemoryAllocator
    cdef MemoryAllocator mem = MemoryAllocator.__new__(MemoryAllocator)
    mem.malloc(10000)
    print(mem.n)
    print(mem.size)
    ''')
Expected:
    1
    16
Got:
    doctest:warning
      File "/srv/public/kliem/sage/src/bin/sage-runtests", line 151, in <module>
        err = DC.run()
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/control.py", line 1257, in run
        self.run_doctests()
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/control.py", line 959, in run_doctests
        self.dispatcher.dispatch()
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1996, in dispatch
        self.parallel_dispatch()
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1891, in parallel_dispatch
        w.start()  # This might take some time
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2163, in start
        super(DocTestWorker, self).start()
      File "/usr/lib/python3.7/multiprocessing/process.py", line 112, in start
        self._popen = self._Popen(self)
      File "/usr/lib/python3.7/multiprocessing/context.py", line 223, in _Popen
        return _default_context.get_context().Process._Popen(process_obj)
      File "/usr/lib/python3.7/multiprocessing/context.py", line 277, in _Popen
        return Popen(process_obj)
      File "/usr/lib/python3.7/multiprocessing/popen_fork.py", line 20, in __init__
        self._launch(process_obj)
      File "/usr/lib/python3.7/multiprocessing/popen_fork.py", line 74, in _launch
        code = process_obj._bootstrap()
      File "/usr/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
        self.run()
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2135, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2465, in __call__
        doctests, extras = self._run(runner, options, results)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2517, in _run
        result = runner.run(test)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 861, in run
        return self._run(test, compileflags, out)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.ext.memory_allocator.MemoryAllocator.__cinit__[0]>", line 8, in <module>
        ''')
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/cython.py", line 661, in cython_compile
        return cython_import_all(tmpfile, get_globals(), **kwds)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/cython.py", line 551, in cython_import_all
        m = cython_import(filename, **kwds)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/cython.py", line 531, in cython_import
        return builtins.__import__(name)
      File "<frozen importlib._bootstrap>", line 983, in _find_and_load
      File "<frozen importlib._bootstrap>", line 967, in _find_and_load_unlocked
      File "<frozen importlib._bootstrap>", line 677, in _load_unlocked
      File "<frozen importlib._bootstrap_external>", line 1050, in exec_module
      File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/superseded.py", line 99, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/misc/superseded.py", line 180, in warning
        warn(message, warning_class, stacklevel)
      File "/usr/lib/python3.7/warnings.py", line 110, in _showwarnmsg
        msg.file, msg.line)
    :
    DeprecationWarning: this class is deprecated; use the class from the python package `memory_allocator`
    See https://trac.sagemath.org/31591 for details.
    1
    16
**********************************************************************
1 item had failures:
   1 of   2 in sage.ext.memory_allocator.MemoryAllocator.__cinit__
    [8 tests, 1 failure, 1.76 s]
----------------------------------------------------------------------
sage -t --warn-long 59.1 --random-seed=32710823712882651180286903013949123952 src/sage/ext/memory_allocator.pyx  # 1 doctest failed
```

Doesn't require a distclean in my case. I have no idea why this is happening now and how to determine when deprecation messages are raised and when not.

For some reason it changed now.



---

archive/issue_events_288499.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-11-15T07:47:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288499"
}
```



---

archive/issue_events_288500.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-11-15T07:47:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288500"
}
```



---

archive/issue_comments_519944.json:
```json
{
    "body": "<a id='comment:36'></a>\nThis has nothing to do with the current ticket. Something change in the new develop:\n\nOn debian buster I get (not on ubuntu bionic):\n\n```\nsage -t --random-seed=217031171464721311270444360210868711734 src/sage/ext/memory_allocator.pxd  # 2 doctests failed\nsage -t --random-seed=217031171464721311270444360210868711734 src/sage/ext/memory_allocator.pyx  # 1 doctest failed\n```",
    "created_at": "2021-11-15T07:47:47Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519944",
    "user": "https://github.com/kliem"
}
```

<a id='comment:36'></a>
This has nothing to do with the current ticket. Something change in the new develop:

On debian buster I get (not on ubuntu bionic):

```
sage -t --random-seed=217031171464721311270444360210868711734 src/sage/ext/memory_allocator.pxd  # 2 doctests failed
sage -t --random-seed=217031171464721311270444360210868711734 src/sage/ext/memory_allocator.pyx  # 1 doctest failed
```



---

archive/issue_comments_519945.json:
```json
{
    "body": "<a id='comment:37'></a>\nSorry about the mess. It has something to do with the ticket. When running on `make distclean` on develop, the error goes away again. I'm not sure exactly what packages caused this.",
    "created_at": "2021-11-15T10:51:12Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519945",
    "user": "https://github.com/kliem"
}
```

<a id='comment:37'></a>
Sorry about the mess. It has something to do with the ticket. When running on `make distclean` on develop, the error goes away again. I'm not sure exactly what packages caused this.



---

archive/issue_events_288501.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-11-15T10:51:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288501"
}
```



---

archive/issue_events_288502.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-11-15T10:51:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288502"
}
```



---

archive/issue_comments_519946.json:
```json
{
    "body": "**Changing commit** from \"[581f874949a6fa1921c4be58c78a0c69918d72f1](https://github.com/sagemath/sagetrac-mirror/commit/581f874949a6fa1921c4be58c78a0c69918d72f1)\" to \"[6f5b6f70e2dd8a08ca2311573ed36ba8d1d1393c](https://github.com/sagemath/sagetrac-mirror/commit/6f5b6f70e2dd8a08ca2311573ed36ba8d1d1393c)\".",
    "created_at": "2021-11-15T14:02:30Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519946",
    "user": "https://github.com/kliem"
}
```

**Changing commit** from "[581f874949a6fa1921c4be58c78a0c69918d72f1](https://github.com/sagemath/sagetrac-mirror/commit/581f874949a6fa1921c4be58c78a0c69918d72f1)" to "[6f5b6f70e2dd8a08ca2311573ed36ba8d1d1393c](https://github.com/sagemath/sagetrac-mirror/commit/6f5b6f70e2dd8a08ca2311573ed36ba8d1d1393c)".



---

archive/issue_comments_519947.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/numpy_1_21_x__scipy_1_7_x](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/numpy_1_21_x__scipy_1_7_x)\" to \"[u/gh-kliem/numpy_1_21_x__scipy_1_7_x](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/numpy_1_21_x__scipy_1_7_x)\".",
    "created_at": "2021-11-15T14:02:30Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519947",
    "user": "https://github.com/kliem"
}
```

**Changing branch** from "[u/mkoeppe/numpy_1_21_x__scipy_1_7_x](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/numpy_1_21_x__scipy_1_7_x)" to "[u/gh-kliem/numpy_1_21_x__scipy_1_7_x](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/numpy_1_21_x__scipy_1_7_x)".



---

archive/issue_events_288503.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-11-15T14:02:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288503"
}
```



---

archive/issue_events_288504.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-11-15T14:02:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288504"
}
```



---

archive/issue_comments_519948.json:
```json
{
    "body": "<a id='comment:38'></a>\nDon't ask me why those deprecation warnings are somewhat random. They are given in each case, but sometimes they are given again and sometimes not and for some strange reason the current branch changed that.\n\nI pushed a patch that works on top of develop and on this ticket.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f5b6f70e2dd8a08ca2311573ed36ba8d1d1393c\">6f5b6f7</a></td><td><code>work around unstable deprecation warnings in ext/memory_allocator</code></td></tr></table>\n",
    "created_at": "2021-11-15T14:02:30Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519948",
    "user": "https://github.com/kliem"
}
```

<a id='comment:38'></a>
Don't ask me why those deprecation warnings are somewhat random. They are given in each case, but sometimes they are given again and sometimes not and for some strange reason the current branch changed that.

I pushed a patch that works on top of develop and on this ticket.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f5b6f70e2dd8a08ca2311573ed36ba8d1d1393c">6f5b6f7</a></td><td><code>work around unstable deprecation warnings in ext/memory_allocator</code></td></tr></table>




---

archive/issue_comments_519949.json:
```json
{
    "body": "**Changing author** from \"Matthias Koeppe\" to \"Matthias Koeppe, Jonathan Kliem\".",
    "created_at": "2021-11-15T14:02:30Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519949",
    "user": "https://github.com/kliem"
}
```

**Changing author** from "Matthias Koeppe" to "Matthias Koeppe, Jonathan Kliem".



---

archive/issue_comments_519950.json:
```json
{
    "body": "<a id='comment:39'></a>\nTry if using `deprecation_cython` instead of `deprecation` helps",
    "created_at": "2021-11-15T17:32:39Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519950",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:39'></a>
Try if using `deprecation_cython` instead of `deprecation` helps



---

archive/issue_comments_519951.json:
```json
{
    "body": "<a id='comment:40'></a>\nNot really. It only changes the stacklevel. Then there are two failures each in the files, one of which is also on develop. So it remains that we must have a workaround for the other 3 cases.",
    "created_at": "2021-11-15T19:09:32Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519951",
    "user": "https://github.com/kliem"
}
```

<a id='comment:40'></a>
Not really. It only changes the stacklevel. Then there are two failures each in the files, one of which is also on develop. So it remains that we must have a workaround for the other 3 cases.



---

archive/issue_comments_519952.json:
```json
{
    "body": "<a id='comment:41'></a>\nLGTM, thanks.",
    "created_at": "2021-11-16T18:27:39Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519952",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:41'></a>
LGTM, thanks.



---

archive/issue_comments_519953.json:
```json
{
    "body": "**Changing reviewer** from \"Fran\u00e7ois Bissey, Dima Pasechnik\" to \"Fran\u00e7ois Bissey, Dima Pasechnik, Matthias Koeppe\".",
    "created_at": "2021-11-16T18:27:39Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519953",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "François Bissey, Dima Pasechnik" to "François Bissey, Dima Pasechnik, Matthias Koeppe".



---

archive/issue_events_288505.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-11-16T18:27:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288505"
}
```



---

archive/issue_events_288506.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-11-16T18:27:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288506"
}
```



---

archive/issue_comments_519954.json:
```json
{
    "body": "<a id='comment:42'></a>\nI missed that last commit. I guess I am quite busy elsewhere. I would have treated all those like the second block\n\n```\nsage: foo()  # random  # might raise deprecation warning\nsage: foo()\n```\nI have noticed this very failure in sage-on-gentoo for the last couple of weeks wondering where it was coming from. I was tempted to add the deprecation warning to the output when I noticed that some earlier tests already had it.\nhttps://github.com/sagemath/sage/blob/develop/src/sage/ext/memory_allocator.pxd#L67\nhttps://github.com/sagemath/sage/blob/develop/src/sage/ext/memory_allocator.pyx#L27\n\nSo, it followed the pattern of one warning per session and somehow we are not having one session anymore.\n\nI think the current branch will work because this is the \"new stable\", rather than being unstable. If I am wrong and it is unstable, we can expect failures on some systems because a warning was displayed that wasn't expected.",
    "created_at": "2021-11-16T18:56:45Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519954",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:42'></a>
I missed that last commit. I guess I am quite busy elsewhere. I would have treated all those like the second block

```
sage: foo()  # random  # might raise deprecation warning
sage: foo()
```
I have noticed this very failure in sage-on-gentoo for the last couple of weeks wondering where it was coming from. I was tempted to add the deprecation warning to the output when I noticed that some earlier tests already had it.
https://github.com/sagemath/sage/blob/develop/src/sage/ext/memory_allocator.pxd#L67
https://github.com/sagemath/sage/blob/develop/src/sage/ext/memory_allocator.pyx#L27

So, it followed the pattern of one warning per session and somehow we are not having one session anymore.

I think the current branch will work because this is the "new stable", rather than being unstable. If I am wrong and it is unstable, we can expect failures on some systems because a warning was displayed that wasn't expected.



---

archive/issue_comments_519955.json:
```json
{
    "body": "<a id='comment:43'></a>\nBugfix release SciPy 1.7.3 was just released,\nwith fixes for Apple M1 processors.\n\n- https://mail.python.org/archives/list/python-announce-list@python.org/thread/GDFAHAADIZEGQS6ZK4ITROE3GUJBTABJ/",
    "created_at": "2021-11-24T22:01:23Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519955",
    "user": "https://github.com/slel"
}
```

<a id='comment:43'></a>
Bugfix release SciPy 1.7.3 was just released,
with fixes for Apple M1 processors.

- https://mail.python.org/archives/list/python-announce-list@python.org/thread/GDFAHAADIZEGQS6ZK4ITROE3GUJBTABJ/



---

archive/issue_comments_519956.json:
```json
{
    "body": "<a id='comment:44'></a>\nCurrent branch is in Volker's merging branch, so it will need to be in a follow up unless Volker finds a reason to reject it. From my perspective in sage-on-gentoo the current branch is all good.",
    "created_at": "2021-11-24T22:04:48Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519956",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:44'></a>
Current branch is in Volker's merging branch, so it will need to be in a follow up unless Volker finds a reason to reject it. From my perspective in sage-on-gentoo the current branch is all good.



---

archive/issue_events_288507.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-12-05T11:15:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288507"
}
```



---

archive/issue_events_288508.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "6101ac674967947f74dd60ec5b4494f401694acc",
    "created_at": "2021-12-05T11:15:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32105#event-288508"
}
```



---

archive/issue_comments_519957.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-kliem/numpy_1_21_x__scipy_1_7_x](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/numpy_1_21_x__scipy_1_7_x)\" to \"[6f5b6f70e2dd8a08ca2311573ed36ba8d1d1393c](https://github.com/sagemath/sagetrac-mirror/commit/6f5b6f70e2dd8a08ca2311573ed36ba8d1d1393c)\".",
    "created_at": "2021-12-05T11:15:37Z",
    "issue": "https://github.com/sagemath/sage/issues/32105",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32105#issuecomment-519957",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/gh-kliem/numpy_1_21_x__scipy_1_7_x](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/numpy_1_21_x__scipy_1_7_x)" to "[6f5b6f70e2dd8a08ca2311573ed36ba8d1d1393c](https://github.com/sagemath/sagetrac-mirror/commit/6f5b6f70e2dd8a08ca2311573ed36ba8d1d1393c)".
