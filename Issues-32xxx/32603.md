# Issue 32603: Update symengine, symengine_py to 0.8.1; drop dependency on nose

archive/issues_032366.json:
```json
{
    "assignees": [],
    "body": "Update symengine, symengine_py to 0.8.1; drop dependency on nose\n\nUpstream report for Sage objects: https://github.com/symengine/symengine.py/pull/373\n\n\n**CC:**  @isuruf tmonteil\n\n**Branch/Commit:** [6dd3e5bc36d46fb8482163dde0f7dec1c9fefa6c](https://github.com/sagemath/sagetrac-mirror/commit/6dd3e5bc36d46fb8482163dde0f7dec1c9fefa6c)\n\n**Upstream:** Fixed upstream, but not in a stable release.\n\n**Reviewer:** Thierry Monteil, Matthias Koeppe\n\n**Author:** Matthias Koeppe, Isuru Fernando\n\nIssue created by migration from https://trac.sagemath.org/ticket/32603\n\n",
    "closed_at": "2021-10-13T22:50:32Z",
    "created_at": "2021-09-30T22:53:13Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20optional",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Update symengine, symengine_py to 0.8.1; drop dependency on nose",
    "type": "issue",
    "updated_at": "2021-10-13T22:50:32Z",
    "url": "https://github.com/sagemath/sage/issues/32603",
    "user": "https://github.com/mkoeppe"
}
```
Update symengine, symengine_py to 0.8.1; drop dependency on nose

Upstream report for Sage objects: https://github.com/symengine/symengine.py/pull/373


**CC:**  @isuruf tmonteil

**Branch/Commit:** [6dd3e5bc36d46fb8482163dde0f7dec1c9fefa6c](https://github.com/sagemath/sagetrac-mirror/commit/6dd3e5bc36d46fb8482163dde0f7dec1c9fefa6c)

**Upstream:** Fixed upstream, but not in a stable release.

**Reviewer:** Thierry Monteil, Matthias Koeppe

**Author:** Matthias Koeppe, Isuru Fernando

Issue created by migration from https://trac.sagemath.org/ticket/32603





---

archive/issue_events_395624.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-30T22:53:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395624"
}
```



---

archive/issue_events_395625.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-30T22:53:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20optional",
    "label_color": "08517b",
    "label_name": "component: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395625"
}
```



---

archive/issue_events_395626.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-30T22:53:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395626"
}
```



---

archive/issue_comments_528556.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/update_symengine__symengine_py__drop_dependency_on_nose](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/update_symengine__symengine_py__drop_dependency_on_nose)",
    "created_at": "2021-10-01T01:07:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528556",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/update_symengine__symengine_py__drop_dependency_on_nose](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/update_symengine__symengine_py__drop_dependency_on_nose)



---

archive/issue_comments_528557.json:
```json
{
    "body": "**Author:** Matthias Koeppe",
    "created_at": "2021-10-01T01:13:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528557",
    "user": "https://github.com/mkoeppe"
}
```

**Author:** Matthias Koeppe



---

archive/issue_comments_528558.json:
```json
{
    "body": "**Commit:** [f929448e8e1effe764fc557c78706aefd72cf0f7](https://github.com/sagemath/sagetrac-mirror/commit/f929448e8e1effe764fc557c78706aefd72cf0f7)",
    "created_at": "2021-10-01T01:13:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528558",
    "user": "https://github.com/mkoeppe"
}
```

**Commit:** [f929448e8e1effe764fc557c78706aefd72cf0f7](https://github.com/sagemath/sagetrac-mirror/commit/f929448e8e1effe764fc557c78706aefd72cf0f7)



---

archive/issue_comments_528559.json:
```json
{
    "body": "<a id='comment:2'>**Comment 2:**</a>\nThe pytest does not go through for me, but it's possible that my installation is messed up\n\n```\n[symengine_py-0.8.1] Running the test suite for symengine_py-0.8.1...\n[symengine_py-0.8.1] ============================= test session starts ==============================\n[symengine_py-0.8.1] platform darwin -- Python 3.9.7, pytest-6.2.5, py-1.10.0, pluggy-1.0.0 -- /Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-3.9/bin/python3\n[symengine_py-0.8.1] cachedir: .pytest_cache\n[symengine_py-0.8.1] rootdir: /Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-3.9/var/tmp/sage/build/symengine_py-0.8.1/src\n[symengine_py-0.8.1] collecting ... collected 0 items / 23 errors\n[symengine_py-0.8.1] \n[symengine_py-0.8.1] ==================================== ERRORS ====================================\n[symengine_py-0.8.1] ________________ ERROR collecting symengine/tests/test_arit.py _________________\n[symengine_py-0.8.1] ImportError while importing test module '/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-3.9/var/tmp/sage/build/symengine_py-0.8.1/src/symengine/tests/test_arit.py'.\n[symengine_py-0.8.1] Hint: make sure your test modules/packages have valid Python names.\n[symengine_py-0.8.1] Traceback:\n[symengine_py-0.8.1] /usr/local/Cellar/python@3.9/3.9.7/Frameworks/Python.framework/Versions/3.9/lib/python3.9/importlib/__init__.py:127: in import_module\n[symengine_py-0.8.1]     return _bootstrap._gcd_import(name[level:], package, level)\n[symengine_py-0.8.1] symengine/__init__.py:12: in <module>\n[symengine_py-0.8.1]     import symengine.lib.symengine_wrapper as wrapper\n[symengine_py-0.8.1] E   ModuleNotFoundError: No module named 'symengine.lib.symengine_wrapper'\n[symengine_py-0.8.1] _________________ ERROR collecting symengine/tests/test_cse.py _________________\n```\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b3fcbd895c490dc48e8b0d33c3d11811881e3461\">b3fcbd8</a></td><td><code>build/pkgs/symengine[_py]: Update to 0.8.1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c4faa5fe075435c45a2e2456a687bb442acd009c\">c4faa5f</a></td><td><code>build/pkgs/symengine/patches/1749.patch: Remove</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f929448e8e1effe764fc557c78706aefd72cf0f7\">f929448</a></td><td><code>build/pkgs/symengine_py: Switch from nose to pytest</code></td></tr></table>\n",
    "created_at": "2021-10-01T01:13:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528559",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'>**Comment 2:**</a>
The pytest does not go through for me, but it's possible that my installation is messed up

```
[symengine_py-0.8.1] Running the test suite for symengine_py-0.8.1...
[symengine_py-0.8.1] ============================= test session starts ==============================
[symengine_py-0.8.1] platform darwin -- Python 3.9.7, pytest-6.2.5, py-1.10.0, pluggy-1.0.0 -- /Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-3.9/bin/python3
[symengine_py-0.8.1] cachedir: .pytest_cache
[symengine_py-0.8.1] rootdir: /Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-3.9/var/tmp/sage/build/symengine_py-0.8.1/src
[symengine_py-0.8.1] collecting ... collected 0 items / 23 errors
[symengine_py-0.8.1] 
[symengine_py-0.8.1] ==================================== ERRORS ====================================
[symengine_py-0.8.1] ________________ ERROR collecting symengine/tests/test_arit.py _________________
[symengine_py-0.8.1] ImportError while importing test module '/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-3.9/var/tmp/sage/build/symengine_py-0.8.1/src/symengine/tests/test_arit.py'.
[symengine_py-0.8.1] Hint: make sure your test modules/packages have valid Python names.
[symengine_py-0.8.1] Traceback:
[symengine_py-0.8.1] /usr/local/Cellar/python@3.9/3.9.7/Frameworks/Python.framework/Versions/3.9/lib/python3.9/importlib/__init__.py:127: in import_module
[symengine_py-0.8.1]     return _bootstrap._gcd_import(name[level:], package, level)
[symengine_py-0.8.1] symengine/__init__.py:12: in <module>
[symengine_py-0.8.1]     import symengine.lib.symengine_wrapper as wrapper
[symengine_py-0.8.1] E   ModuleNotFoundError: No module named 'symengine.lib.symengine_wrapper'
[symengine_py-0.8.1] _________________ ERROR collecting symengine/tests/test_cse.py _________________
```

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b3fcbd895c490dc48e8b0d33c3d11811881e3461">b3fcbd8</a></td><td><code>build/pkgs/symengine[_py]: Update to 0.8.1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c4faa5fe075435c45a2e2456a687bb442acd009c">c4faa5f</a></td><td><code>build/pkgs/symengine/patches/1749.patch: Remove</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f929448e8e1effe764fc557c78706aefd72cf0f7">f929448</a></td><td><code>build/pkgs/symengine_py: Switch from nose to pytest</code></td></tr></table>




---

archive/issue_events_395627.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-01T01:13:38Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "rename": {
        "from": "Update symengine, symengine_py; drop dependency on nose",
        "to": "Update symengine, symengine_py to 0.8.1; drop dependency on nose"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395627"
}
```



---

archive/issue_comments_528560.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\nI can reproduce the error.",
    "created_at": "2021-10-01T10:20:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528560",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<a id='comment:4'>**Comment 4:**</a>
I can reproduce the error.



---

archive/issue_comments_528561.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc0e37c7e30db6bc11f6c88f2941ac1529549908\">fc0e37c</a></td><td><code>fix symengine_py tests</code></td></tr></table>\n",
    "created_at": "2021-10-01T17:33:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528561",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:5'>**Comment 5:**</a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc0e37c7e30db6bc11f6c88f2941ac1529549908">fc0e37c</a></td><td><code>fix symengine_py tests</code></td></tr></table>




---

archive/issue_comments_528562.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/update_symengine__symengine_py__drop_dependency_on_nose](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/update_symengine__symengine_py__drop_dependency_on_nose)\" to \"[u/isuruf/update_symengine__symengine_py__drop_dependency_on_nose](https://github.com/sagemath/sagetrac-mirror/tree/u/isuruf/update_symengine__symengine_py__drop_dependency_on_nose)\".",
    "created_at": "2021-10-01T17:33:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528562",
    "user": "https://github.com/isuruf"
}
```

**Changing branch** from "[u/mkoeppe/update_symengine__symengine_py__drop_dependency_on_nose](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/update_symengine__symengine_py__drop_dependency_on_nose)" to "[u/isuruf/update_symengine__symengine_py__drop_dependency_on_nose](https://github.com/sagemath/sagetrac-mirror/tree/u/isuruf/update_symengine__symengine_py__drop_dependency_on_nose)".



---

archive/issue_comments_528563.json:
```json
{
    "body": "**Changing author** from \"Matthias Koeppe\" to \"Matthias Koeppe, Isuru Fernando\".",
    "created_at": "2021-10-01T17:33:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528563",
    "user": "https://github.com/isuruf"
}
```

**Changing author** from "Matthias Koeppe" to "Matthias Koeppe, Isuru Fernando".



---

archive/issue_events_395628.json:
```json
{
    "actor": "https://github.com/isuruf",
    "created_at": "2021-10-01T17:33:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395628"
}
```



---

archive/issue_comments_528564.json:
```json
{
    "body": "**Changing commit** from \"[f929448e8e1effe764fc557c78706aefd72cf0f7](https://github.com/sagemath/sagetrac-mirror/commit/f929448e8e1effe764fc557c78706aefd72cf0f7)\" to \"[fc0e37c7e30db6bc11f6c88f2941ac1529549908](https://github.com/sagemath/sagetrac-mirror/commit/fc0e37c7e30db6bc11f6c88f2941ac1529549908)\".",
    "created_at": "2021-10-01T17:33:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528564",
    "user": "https://github.com/isuruf"
}
```

**Changing commit** from "[f929448e8e1effe764fc557c78706aefd72cf0f7](https://github.com/sagemath/sagetrac-mirror/commit/f929448e8e1effe764fc557c78706aefd72cf0f7)" to "[fc0e37c7e30db6bc11f6c88f2941ac1529549908](https://github.com/sagemath/sagetrac-mirror/commit/fc0e37c7e30db6bc11f6c88f2941ac1529549908)".



---

archive/issue_comments_528565.json:
```json
{
    "body": "**Reviewer:** Thierry Monteil",
    "created_at": "2021-10-01T19:13:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528565",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

**Reviewer:** Thierry Monteil



---

archive/issue_comments_528566.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nIt does not work for me, see the attached log.",
    "created_at": "2021-10-01T19:13:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528566",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<a id='comment:6'>**Comment 6:**</a>
It does not work for me, see the attached log.



---

archive/issue_events_395629.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2021-10-01T19:13:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395629"
}
```



---

archive/issue_events_395630.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2021-10-01T19:13:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395630"
}
```



---

archive/issue_comments_528567.json:
```json
{
    "body": "**Attachment:** [symengine_py-0.8.1.log](https://github.com/sagemath/sage/files/ticket32603/symengine_py-0.8.1.log)",
    "created_at": "2021-10-01T19:13:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528567",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

**Attachment:** [symengine_py-0.8.1.log](https://github.com/sagemath/sage/files/ticket32603/symengine_py-0.8.1.log)



---

archive/issue_comments_528568.json:
```json
{
    "body": "**Changing commit** from \"[fc0e37c7e30db6bc11f6c88f2941ac1529549908](https://github.com/sagemath/sagetrac-mirror/commit/fc0e37c7e30db6bc11f6c88f2941ac1529549908)\" to \"[1b2bdbb5c295085f08fe4350ea417f20c8d23d4f](https://github.com/sagemath/sagetrac-mirror/commit/1b2bdbb5c295085f08fe4350ea417f20c8d23d4f)\".",
    "created_at": "2021-10-02T02:30:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528568",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[fc0e37c7e30db6bc11f6c88f2941ac1529549908](https://github.com/sagemath/sagetrac-mirror/commit/fc0e37c7e30db6bc11f6c88f2941ac1529549908)" to "[1b2bdbb5c295085f08fe4350ea417f20c8d23d4f](https://github.com/sagemath/sagetrac-mirror/commit/1b2bdbb5c295085f08fe4350ea417f20c8d23d4f)".



---

archive/issue_comments_528569.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1b2bdbb5c295085f08fe4350ea417f20c8d23d4f\">1b2bdbb</a></td><td><code>Fix getting string representation of sage objects</code></td></tr></table>\n",
    "created_at": "2021-10-02T02:30:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528569",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:7'>**Comment 7:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1b2bdbb5c295085f08fe4350ea417f20c8d23d4f">1b2bdbb</a></td><td><code>Fix getting string representation of sage objects</code></td></tr></table>




---

archive/issue_events_395631.json:
```json
{
    "actor": "https://github.com/isuruf",
    "created_at": "2021-10-02T02:36:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395631"
}
```



---

archive/issue_events_395632.json:
```json
{
    "actor": "https://github.com/isuruf",
    "created_at": "2021-10-02T02:36:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395632"
}
```



---

archive/issue_comments_528570.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,4 @@\n+Update symengine, symengine_py to 0.8.1; drop dependency on nose\n \n+Upstream report for Sage objects: https://github.com/symengine/symengine.py/pull/373\n+\n``````\n",
    "created_at": "2021-10-02T11:51:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528570",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,4 @@
+Update symengine, symengine_py to 0.8.1; drop dependency on nose
 
+Upstream report for Sage objects: https://github.com/symengine/symengine.py/pull/373
+
``````




---

archive/issue_events_395633.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2021-10-02T11:51:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395633"
}
```



---

archive/issue_events_395634.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2021-10-02T11:51:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395634"
}
```



---

archive/issue_comments_528571.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nStill some problem, see the attached log.",
    "created_at": "2021-10-02T11:51:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528571",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<a id='comment:9'>**Comment 9:**</a>
Still some problem, see the attached log.



---

archive/issue_comments_528572.json:
```json
{
    "body": "**Upstream:** Reported upstream. No feedback yet.",
    "created_at": "2021-10-02T11:52:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528572",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

**Upstream:** Reported upstream. No feedback yet.



---

archive/issue_comments_528573.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\n**Attachment:** [symengine_py-0.8.1.2.log](https://github.com/sagemath/sage/files/ticket32603/symengine_py-0.8.1.2.log)",
    "created_at": "2021-10-02T11:52:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528573",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<a id='comment:10'>**Comment 10:**</a>
**Attachment:** [symengine_py-0.8.1.2.log](https://github.com/sagemath/sage/files/ticket32603/symengine_py-0.8.1.2.log)



---

archive/issue_comments_528574.json:
```json
{
    "body": "**Changing commit** from \"[1b2bdbb5c295085f08fe4350ea417f20c8d23d4f](https://github.com/sagemath/sagetrac-mirror/commit/1b2bdbb5c295085f08fe4350ea417f20c8d23d4f)\" to \"[6dd3e5bc36d46fb8482163dde0f7dec1c9fefa6c](https://github.com/sagemath/sagetrac-mirror/commit/6dd3e5bc36d46fb8482163dde0f7dec1c9fefa6c)\".",
    "created_at": "2021-10-02T13:54:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528574",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[1b2bdbb5c295085f08fe4350ea417f20c8d23d4f](https://github.com/sagemath/sagetrac-mirror/commit/1b2bdbb5c295085f08fe4350ea417f20c8d23d4f)" to "[6dd3e5bc36d46fb8482163dde0f7dec1c9fefa6c](https://github.com/sagemath/sagetrac-mirror/commit/6dd3e5bc36d46fb8482163dde0f7dec1c9fefa6c)".



---

archive/issue_comments_528575.json:
```json
{
    "body": "<a id='comment:11'>**Comment 11:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6dd3e5bc36d46fb8482163dde0f7dec1c9fefa6c\">6dd3e5b</a></td><td><code>update version for a rebuild</code></td></tr></table>\n",
    "created_at": "2021-10-02T13:54:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528575",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:11'>**Comment 11:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6dd3e5bc36d46fb8482163dde0f7dec1c9fefa6c">6dd3e5b</a></td><td><code>update version for a rebuild</code></td></tr></table>




---

archive/issue_comments_528576.json:
```json
{
    "body": "<a id='comment:12'>**Comment 12:**</a>\nI think the issue was that symengine_py was not rebuilt. I've bumped the version to trigger a rebuild",
    "created_at": "2021-10-02T13:54:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528576",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:12'>**Comment 12:**</a>
I think the issue was that symengine_py was not rebuilt. I've bumped the version to trigger a rebuild



---

archive/issue_events_395635.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-02T15:43:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395635"
}
```



---

archive/issue_events_395636.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-02T15:43:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395636"
}
```



---

archive/issue_events_395637.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2021-10-02T17:15:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395637"
}
```



---

archive/issue_events_395638.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2021-10-02T17:15:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395638"
}
```



---

archive/issue_comments_528577.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\nThe issue persists. The reason is that the doctest look at files in `$SAGE_ROOT/local/lib/python3.9/site-packages/symengine/tests/` but when Sage tests a spkg, it only installs the spkg AFTER the test succeeds. So, if you install the spkg first and then install/test the spkg, currently what is tested is the previous installation.\n\nSo, changing package version may not fix the issue. In `spkg-check.in`, we should ask the testing framework to test files in `$SAGE_ROOT/local/var/tmp/sage/build/symengine_py-0.8.1/src/symengine/tests` not in `$SAGE_ROOT/local/lib/python3.9/site-packages/symengine/tests/`\n\nBy the way, looking at `symengine.py-0.8.1/bin/test_travis.sh` (in the tarball), it seems that tests from `pytest` and tests from `test_python.py` are not the same (both are run one after the other), so we should perhaps test both.",
    "created_at": "2021-10-02T17:15:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528577",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<a id='comment:14'>**Comment 14:**</a>
The issue persists. The reason is that the doctest look at files in `$SAGE_ROOT/local/lib/python3.9/site-packages/symengine/tests/` but when Sage tests a spkg, it only installs the spkg AFTER the test succeeds. So, if you install the spkg first and then install/test the spkg, currently what is tested is the previous installation.

So, changing package version may not fix the issue. In `spkg-check.in`, we should ask the testing framework to test files in `$SAGE_ROOT/local/var/tmp/sage/build/symengine_py-0.8.1/src/symengine/tests` not in `$SAGE_ROOT/local/lib/python3.9/site-packages/symengine/tests/`

By the way, looking at `symengine.py-0.8.1/bin/test_travis.sh` (in the tarball), it seems that tests from `pytest` and tests from `test_python.py` are not the same (both are run one after the other), so we should perhaps test both.



---

archive/issue_comments_528578.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\n> By the way, looking at symengine.py-0.8.1/bin/test_travis.sh (in the tarball), it seems that tests from pytest and tests from test_python.py are not the same (both are run one after the other), so we should perhaps test both. \n\nNot really. They check that the tests run fine on inplace builds and on installed symengine.\nSince sage is not doing inplace builds, it doesn't matter.\n\nThanks for the info. I'll try to fix this.",
    "created_at": "2021-10-02T17:18:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528578",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:15'>**Comment 15:**</a>
> By the way, looking at symengine.py-0.8.1/bin/test_travis.sh (in the tarball), it seems that tests from pytest and tests from test_python.py are not the same (both are run one after the other), so we should perhaps test both. 

Not really. They check that the tests run fine on inplace builds and on installed symengine.
Since sage is not doing inplace builds, it doesn't matter.

Thanks for the info. I'll try to fix this.



---

archive/issue_comments_528579.json:
```json
{
    "body": "<a id='comment:16'>**Comment 16:**</a>\n> The reason is that the doctest look at files in $SAGE_ROOT/local/lib/python3.9/site-packages/symengine/tests/ but when Sage tests a spkg, it only installs the spkg AFTER the test succeeds. So, if you install the spkg first and then install/test the spkg, currently what is tested is the previous installation.\n\nAt this point where is symengine_py installed to?",
    "created_at": "2021-10-02T17:33:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528579",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:16'>**Comment 16:**</a>
> The reason is that the doctest look at files in $SAGE_ROOT/local/lib/python3.9/site-packages/symengine/tests/ but when Sage tests a spkg, it only installs the spkg AFTER the test succeeds. So, if you install the spkg first and then install/test the spkg, currently what is tested is the previous installation.

At this point where is symengine_py installed to?



---

archive/issue_comments_528580.json:
```json
{
    "body": "<a id='comment:17'>**Comment 17:**</a>\nReplying to [tmonteil](#comment%3A14):\n> The reason is that the doctest look at files in `$SAGE_ROOT/local/lib/python3.9/site-packages/symengine/tests/` but when Sage tests a spkg, it only installs the spkg AFTER the test succeeds. So, if you install the spkg first and then install/test the spkg, currently what is tested is the previous installation.\n\nThat's not true. Take a look at `build/bin/sage-spkg`: `spkg-check` is run after the staged installation has been copied to the final installation directory.",
    "created_at": "2021-10-02T18:17:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528580",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'>**Comment 17:**</a>
Replying to [tmonteil](#comment%3A14):
> The reason is that the doctest look at files in `$SAGE_ROOT/local/lib/python3.9/site-packages/symengine/tests/` but when Sage tests a spkg, it only installs the spkg AFTER the test succeeds. So, if you install the spkg first and then install/test the spkg, currently what is tested is the previous installation.

That's not true. Take a look at `build/bin/sage-spkg`: `spkg-check` is run after the staged installation has been copied to the final installation directory.



---

archive/issue_comments_528581.json:
```json
{
    "body": "<a id='comment:18'>**Comment 18:**</a>\n(Also note that since #32361, Python packages are not actually staged using `SAGE_DESTDIR` any more. We just build and then install a wheel. This happens before running `spkg-check`.)",
    "created_at": "2021-10-02T18:29:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528581",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'>**Comment 18:**</a>
(Also note that since #32361, Python packages are not actually staged using `SAGE_DESTDIR` any more. We just build and then install a wheel. This happens before running `spkg-check`.)



---

archive/issue_comments_528582.json:
```json
{
    "body": "<a id='comment:19'>**Comment 19:**</a>\nI'm confused as to how the issue mentioned by `@`tmonteil happens then.",
    "created_at": "2021-10-03T18:25:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528582",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:19'>**Comment 19:**</a>
I'm confused as to how the issue mentioned by `@`tmonteil happens then.



---

archive/issue_comments_528583.json:
```json
{
    "body": "**Changing upstream** from \"Reported upstream. No feedback yet.\" to \"Fixed upstream, but not in a stable release.\".",
    "created_at": "2021-10-03T18:26:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528583",
    "user": "https://github.com/isuruf"
}
```

**Changing upstream** from "Reported upstream. No feedback yet." to "Fixed upstream, but not in a stable release.".



---

archive/issue_comments_528584.json:
```json
{
    "body": "<a id='comment:21'>**Comment 21:**</a>\nIn #32595 I am currently running portability testing on GH Actions, including this ticket. We'll see if these tests can reproduce the issue.",
    "created_at": "2021-10-03T18:28:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528584",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'>**Comment 21:**</a>
In #32595 I am currently running portability testing on GH Actions, including this ticket. We'll see if these tests can reproduce the issue.



---

archive/issue_comments_528585.json:
```json
{
    "body": "<a id='comment:22'>**Comment 22:**</a>\nThis has run successfully on https://github.com/mkoeppe/sage/actions/runs/1298853742; so I am setting this to positive review",
    "created_at": "2021-10-04T19:49:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528585",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'>**Comment 22:**</a>
This has run successfully on https://github.com/mkoeppe/sage/actions/runs/1298853742; so I am setting this to positive review



---

archive/issue_events_395639.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-04T19:49:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395639"
}
```



---

archive/issue_events_395640.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-04T19:49:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395640"
}
```



---

archive/issue_comments_528586.json:
```json
{
    "body": "**Changing reviewer** from \"Thierry Monteil\" to \"Thierry Monteil, Matthias Koeppe\".",
    "created_at": "2021-10-04T19:49:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528586",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "Thierry Monteil" to "Thierry Monteil, Matthias Koeppe".



---

archive/issue_comments_528587.json:
```json
{
    "body": "**Changing branch** from \"[u/isuruf/update_symengine__symengine_py__drop_dependency_on_nose](https://github.com/sagemath/sagetrac-mirror/tree/u/isuruf/update_symengine__symengine_py__drop_dependency_on_nose)\" to \"[6dd3e5bc36d46fb8482163dde0f7dec1c9fefa6c](https://github.com/sagemath/sagetrac-mirror/commit/6dd3e5bc36d46fb8482163dde0f7dec1c9fefa6c)\".",
    "created_at": "2021-10-13T22:50:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32603#issuecomment-528587",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/isuruf/update_symengine__symengine_py__drop_dependency_on_nose](https://github.com/sagemath/sagetrac-mirror/tree/u/isuruf/update_symengine__symengine_py__drop_dependency_on_nose)" to "[6dd3e5bc36d46fb8482163dde0f7dec1c9fefa6c](https://github.com/sagemath/sagetrac-mirror/commit/6dd3e5bc36d46fb8482163dde0f7dec1c9fefa6c)".



---

archive/issue_events_395641.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-13T22:50:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395641"
}
```



---

archive/issue_events_395642.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "4947945c3861801f7ce9dd0a53b35ea922903922",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-10-13T22:50:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32603",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32603#event-395642"
}
```
