# Issue 32328: Adding post_critical_set

archive/issues_032091.json:
```json
{
    "assignees": [],
    "body": "This ticket aims to add a method to calculate the orbit of all the critical points for post-critically finite dynamical systems.\n\n**CC:**  @bhutz\n\n**Keywords:** gsoc2021\n\n**Branch/Commit:** [2e320b59aa963bd76d3e03f484fbb4aa235c890f](https://github.com/sagemath/sagetrac-mirror/commit/2e320b59aa963bd76d3e03f484fbb4aa235c890f)\n\n**Reviewer:** Ben Hutz\n\n**Author:** Alexander Galarraga\n\nIssue created by migration from https://trac.sagemath.org/ticket/32328\n\n",
    "closed_at": "2021-10-19T20:30:45Z",
    "created_at": "2021-08-02T23:44:57Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20dynamics",
        "https://github.com/sagemath/sage/labels/minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Adding post_critical_set",
    "type": "issue",
    "updated_at": "2021-10-19T20:30:45Z",
    "url": "https://github.com/sagemath/sage/issues/32328",
    "user": "https://github.com/EnderWannabe"
}
```
This ticket aims to add a method to calculate the orbit of all the critical points for post-critically finite dynamical systems.

**CC:**  @bhutz

**Keywords:** gsoc2021

**Branch/Commit:** [2e320b59aa963bd76d3e03f484fbb4aa235c890f](https://github.com/sagemath/sagetrac-mirror/commit/2e320b59aa963bd76d3e03f484fbb4aa235c890f)

**Reviewer:** Ben Hutz

**Author:** Alexander Galarraga

Issue created by migration from https://trac.sagemath.org/ticket/32328





---

archive/issue_events_392671.json:
```json
{
    "actor": "https://github.com/EnderWannabe",
    "created_at": "2021-08-02T23:44:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32328#event-392671"
}
```



---

archive/issue_events_392672.json:
```json
{
    "actor": "https://github.com/EnderWannabe",
    "created_at": "2021-08-02T23:44:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20dynamics",
    "label_color": "08517b",
    "label_name": "component: dynamics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32328#event-392672"
}
```



---

archive/issue_events_392673.json:
```json
{
    "actor": "https://github.com/EnderWannabe",
    "created_at": "2021-08-02T23:44:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "label": "https://github.com/sagemath/sage/labels/minor",
    "label_color": "ff0000",
    "label_name": "minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32328#event-392673"
}
```



---

archive/issue_events_392674.json:
```json
{
    "actor": "https://github.com/EnderWannabe",
    "created_at": "2021-08-02T23:44:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32328#event-392674"
}
```



---

archive/issue_comments_523623.json:
```json
{
    "body": "**Branch:** [u/gh-EnderWannabe/post_critical_set](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-EnderWannabe/post_critical_set)",
    "created_at": "2021-08-02T23:45:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32328#issuecomment-523623",
    "user": "https://github.com/EnderWannabe"
}
```

**Branch:** [u/gh-EnderWannabe/post_critical_set](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-EnderWannabe/post_critical_set)



---

archive/issue_comments_523624.json:
```json
{
    "body": "**Commit:** [13de775ac290b351d1f5dfb934a45833a1c05ed1](https://github.com/sagemath/sagetrac-mirror/commit/13de775ac290b351d1f5dfb934a45833a1c05ed1)",
    "created_at": "2021-08-02T23:45:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32328#issuecomment-523624",
    "user": "https://github.com/EnderWannabe"
}
```

**Commit:** [13de775ac290b351d1f5dfb934a45833a1c05ed1](https://github.com/sagemath/sagetrac-mirror/commit/13de775ac290b351d1f5dfb934a45833a1c05ed1)



---

archive/issue_events_392675.json:
```json
{
    "actor": "https://github.com/EnderWannabe",
    "created_at": "2021-08-02T23:45:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32328#event-392675"
}
```



---

archive/issue_comments_523625.json:
```json
{
    "body": "<a id='comment:2'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/13de775ac290b351d1f5dfb934a45833a1c05ed1\">13de775</a></td><td><code>32328: initial commit</code></td></tr></table>\n",
    "created_at": "2021-08-02T23:45:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32328#issuecomment-523625",
    "user": "https://github.com/EnderWannabe"
}
```

<a id='comment:2'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/13de775ac290b351d1f5dfb934a45833a1c05ed1">13de775</a></td><td><code>32328: initial commit</code></td></tr></table>




---

archive/issue_events_392676.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2021-08-03T14:23:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32328#event-392676"
}
```



---

archive/issue_events_392677.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2021-08-03T14:23:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32328#event-392677"
}
```



---

archive/issue_comments_523626.json:
```json
{
    "body": "**Reviewer:** Ben Hutz",
    "created_at": "2021-08-03T14:23:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32328#issuecomment-523626",
    "user": "https://github.com/bhutz"
}
```

**Reviewer:** Ben Hutz



---

archive/issue_comments_523627.json:
```json
{
    "body": "<a id='comment:3'></a>\nSome things to work on here:\n\n- need check=True parameter to not do the pcf check since it is time consuming. You claim to raise an error if not pcf, but you do not actually do the check right now\n\n\n- add to the documentation the definition of postcritical set: The postcritical set is union of points which are in the forward orbits of the critical points. In other words, the set of points `Q` so that `f^n(P) = Q` for some positive integer `n` and critical point `P`, where `f` is this mapping.\n\n- Should say that you extend to the 'field_of_definition_critical()' field.\n\n\n- OUTPUT rather that OUTPUTS\n\n- OUTPUT: The set of postcritical points.\n\n- only have examples over QQ. Should add a number field and a finite field example\n\n- ('must not be a dynamical system on a subscheme') -> ('must be a dynamical system on projective space') since that is what you check\n\n- postcritical set does not include the critical point unless it is peridoic (i.e., occurs as a forward image)\n\n\n- Failing example\n\n```\nK.<v>=QuadraticField(2)\nP.<x,y>=ProjectiveSpace(K,1)\nf=DynamicalSystem([x^2+(-2)*y^2,y^2])\nm=matrix(K,2,2,[v,1,0,1])\ng=f.conjugate(m)\ng.post_critical_set()\n```\n\n- we're likely to run into the same sorting issue on doctest output here that we've seen in some other functions lately.",
    "created_at": "2021-08-03T14:23:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32328#issuecomment-523627",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:3'></a>
Some things to work on here:

- need check=True parameter to not do the pcf check since it is time consuming. You claim to raise an error if not pcf, but you do not actually do the check right now


- add to the documentation the definition of postcritical set: The postcritical set is union of points which are in the forward orbits of the critical points. In other words, the set of points `Q` so that `f^n(P) = Q` for some positive integer `n` and critical point `P`, where `f` is this mapping.

- Should say that you extend to the 'field_of_definition_critical()' field.


- OUTPUT rather that OUTPUTS

- OUTPUT: The set of postcritical points.

- only have examples over QQ. Should add a number field and a finite field example

- ('must not be a dynamical system on a subscheme') -> ('must be a dynamical system on projective space') since that is what you check

- postcritical set does not include the critical point unless it is peridoic (i.e., occurs as a forward image)


- Failing example

```
K.<v>=QuadraticField(2)
P.<x,y>=ProjectiveSpace(K,1)
f=DynamicalSystem([x^2+(-2)*y^2,y^2])
m=matrix(K,2,2,[v,1,0,1])
g=f.conjugate(m)
g.post_critical_set()
```

- we're likely to run into the same sorting issue on doctest output here that we've seen in some other functions lately.



---

archive/issue_comments_523628.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2e320b59aa963bd76d3e03f484fbb4aa235c890f\">2e320b5</a></td><td><code>32328: added examples and fixed errors</code></td></tr></table>\n",
    "created_at": "2021-08-03T16:47:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32328#issuecomment-523628",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2e320b59aa963bd76d3e03f484fbb4aa235c890f">2e320b5</a></td><td><code>32328: added examples and fixed errors</code></td></tr></table>




---

archive/issue_comments_523629.json:
```json
{
    "body": "**Changing commit** from \"[13de775ac290b351d1f5dfb934a45833a1c05ed1](https://github.com/sagemath/sagetrac-mirror/commit/13de775ac290b351d1f5dfb934a45833a1c05ed1)\" to \"[2e320b59aa963bd76d3e03f484fbb4aa235c890f](https://github.com/sagemath/sagetrac-mirror/commit/2e320b59aa963bd76d3e03f484fbb4aa235c890f)\".",
    "created_at": "2021-08-03T16:47:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32328#issuecomment-523629",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[13de775ac290b351d1f5dfb934a45833a1c05ed1](https://github.com/sagemath/sagetrac-mirror/commit/13de775ac290b351d1f5dfb934a45833a1c05ed1)" to "[2e320b59aa963bd76d3e03f484fbb4aa235c890f](https://github.com/sagemath/sagetrac-mirror/commit/2e320b59aa963bd76d3e03f484fbb4aa235c890f)".



---

archive/issue_comments_523630.json:
```json
{
    "body": "<a id='comment:5'></a>\nFixed that example and added as a test. Also, I changed all instances of \"post critical\" to \"postcritical\".",
    "created_at": "2021-08-03T16:51:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32328#issuecomment-523630",
    "user": "https://github.com/EnderWannabe"
}
```

<a id='comment:5'></a>
Fixed that example and added as a test. Also, I changed all instances of "post critical" to "postcritical".



---

archive/issue_events_392678.json:
```json
{
    "actor": "https://github.com/EnderWannabe",
    "created_at": "2021-08-03T17:02:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32328#event-392678"
}
```



---

archive/issue_events_392679.json:
```json
{
    "actor": "https://github.com/EnderWannabe",
    "created_at": "2021-08-03T17:02:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32328#event-392679"
}
```



---

archive/issue_events_392680.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-10T17:30:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32328#event-392680"
}
```



---

archive/issue_events_392681.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-10T17:30:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32328#event-392681"
}
```



---

archive/issue_comments_523631.json:
```json
{
    "body": "<a id='comment:8'></a>\nThis looks fine to me. Any idea why the patchbot is getting a `blocks` failure? It doesn't look like those lines are even part of this function, but it does look like it ran after your last set of changes. I built the docs without issue just to check.",
    "created_at": "2021-08-13T17:15:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32328#issuecomment-523631",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:8'></a>
This looks fine to me. Any idea why the patchbot is getting a `blocks` failure? It doesn't look like those lines are even part of this function, but it does look like it ran after your last set of changes. I built the docs without issue just to check.



---

archive/issue_comments_523632.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [@bhutz](#comment%3A8):\n> Any idea why the patchbot is getting a `blocks` failure?\n\nNo idea. The tests run on 8/3 were run on the same commit and passed. I feel like I've seen failures in `blocks` before, but I don't remember where...",
    "created_at": "2021-08-13T17:29:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32328#issuecomment-523632",
    "user": "https://github.com/EnderWannabe"
}
```

<a id='comment:9'></a>
Replying to [@bhutz](#comment%3A8):
> Any idea why the patchbot is getting a `blocks` failure?

No idea. The tests run on 8/3 were run on the same commit and passed. I feel like I've seen failures in `blocks` before, but I don't remember where...



---

archive/issue_events_392682.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2021-08-17T18:17:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32328#event-392682"
}
```



---

archive/issue_events_392683.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2021-08-17T18:17:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32328#event-392683"
}
```



---

archive/issue_comments_523633.json:
```json
{
    "body": "<a id='comment:10'></a>\nwell, we had another pass and another failure. Looks like all the failures are on the same patchbot machine, so it looks like it is an issue with that machine. I'll mark this positive.",
    "created_at": "2021-08-17T18:17:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32328#issuecomment-523633",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:10'></a>
well, we had another pass and another failure. Looks like all the failures are on the same patchbot machine, so it looks like it is an issue with that machine. I'll mark this positive.



---

archive/issue_comments_523634.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-EnderWannabe/post_critical_set](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-EnderWannabe/post_critical_set)\" to \"[2e320b59aa963bd76d3e03f484fbb4aa235c890f](https://github.com/sagemath/sagetrac-mirror/commit/2e320b59aa963bd76d3e03f484fbb4aa235c890f)\".",
    "created_at": "2021-10-19T20:30:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32328#issuecomment-523634",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/gh-EnderWannabe/post_critical_set](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-EnderWannabe/post_critical_set)" to "[2e320b59aa963bd76d3e03f484fbb4aa235c890f](https://github.com/sagemath/sagetrac-mirror/commit/2e320b59aa963bd76d3e03f484fbb4aa235c890f)".



---

archive/issue_events_392684.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-19T20:30:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32328#event-392684"
}
```



---

archive/issue_events_392685.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "ab2c01cf283ebea2085f8b3d545fc6bb0f265819",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-10-19T20:30:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32328",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32328#event-392685"
}
```
