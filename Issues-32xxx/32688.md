# Issue 32688: Matrix_dense API functions set_unsafe_si vs. set_unsafe_int

archive/issues_032451.json:
```json
{
    "assignees": [],
    "body": "`src/sage/matrix/matrix_dense.pxd`\ndefines the general API\n`cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value)`\n\nbut `src/sage/matrix/matrix_integer_dense.pyx` does not implement it; instead, it implements \n`cdef void set_unsafe_si(self, Py_ssize_t i, Py_ssize_t j, long value)`\n\nThis should be unified.\nLikewise probably with `get`.\n\n`set_unsafe_si` is used in \nsrc/sage/geometry/polyhedron/combinatorial_polyhedron/base.pyx\n\n\n\n\n\nCC:  @kliem @tscrim\n\nBranch/Commit: **[`5ce470e`](https://github.com/sagemath/sagetrac-mirror/commit/5ce470ef7e6fee094d0f8f8222950a16056f2b60)**\n\nReviewer: **Matthias Koeppe, Travis Scrimshaw**\n\nAuthor: **Jonathan Kliem**\n\nComponent: **linear algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/32688_\n\n",
    "closed_at": "2022-02-27T22:00:39Z",
    "created_at": "2021-10-14T00:38:21Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Matrix_dense API functions set_unsafe_si vs. set_unsafe_int",
    "type": "issue",
    "updated_at": "2022-02-27T22:00:39Z",
    "url": "https://github.com/sagemath/sage/issues/32688",
    "user": "https://github.com/mkoeppe"
}
```
`src/sage/matrix/matrix_dense.pxd`
defines the general API
`cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value)`

but `src/sage/matrix/matrix_integer_dense.pyx` does not implement it; instead, it implements 
`cdef void set_unsafe_si(self, Py_ssize_t i, Py_ssize_t j, long value)`

This should be unified.
Likewise probably with `get`.

`set_unsafe_si` is used in 
src/sage/geometry/polyhedron/combinatorial_polyhedron/base.pyx





CC:  @kliem @tscrim

Branch/Commit: **[`5ce470e`](https://github.com/sagemath/sagetrac-mirror/commit/5ce470ef7e6fee094d0f8f8222950a16056f2b60)**

Reviewer: **Matthias Koeppe, Travis Scrimshaw**

Author: **Jonathan Kliem**

Component: **linear algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/32688_





---

archive/issue_events_450287.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-14T00:38:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32688#event-450287"
}
```



---

archive/issue_events_450288.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-14T00:38:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "c: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32688#event-450288"
}
```



---

archive/issue_events_450289.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-14T00:38:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32688#event-450289"
}
```



---

archive/issue_events_450290.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-14T00:38:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32688#event-450290"
}
```



---

archive/issue_comments_527467.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\n\n```\n$ git grep \"et_unsafe_\"\nsrc/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            A.set_unsafe_mpz(n-i-1,3,tmp)\nsrc/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            A.set_unsafe_mpz(n-i-1,2,tmp)\nsrc/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            A.set_unsafe_mpz(n-i-1,1,tmp)\nsrc/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            A.set_unsafe_mpz(n-i-1,0,tmp)\nsrc/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            A.set_unsafe_mpz(i,0,tmp)\nsrc/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            A.set_unsafe_mpz(i,1,tmp)\nsrc/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            A.set_unsafe_mpz(i,2,tmp)\nsrc/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            A.set_unsafe_mpz(i,3,tmp)\nsrc/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            H.get_unsafe_mpz(i,3,tmp)\nsrc/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            H.get_unsafe_mpz(i,2,tmp)\nsrc/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            H.get_unsafe_mpz(i,1,tmp)\nsrc/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            H.get_unsafe_mpz(i,0,tmp)\nsrc/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            H.get_unsafe_mpz(i,0,tmp)\nsrc/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            H.get_unsafe_mpz(i,1,tmp)\nsrc/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            H.get_unsafe_mpz(i,2,tmp)\nsrc/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            H.get_unsafe_mpz(i,3,tmp)\nsrc/sage/geometry/polyhedron/combinatorial_polyhedron/base.pyx:                    incidence_matrix.set_unsafe_si(0, i, 1)\nsrc/sage/geometry/polyhedron/combinatorial_polyhedron/base.pyx:                    incidence_matrix.set_unsafe_si(Vindex, Hindex, 1)\nsrc/sage/geometry/polyhedron/combinatorial_polyhedron/base.pyx:                incidence_matrix.set_unsafe_si(Vindex, Hindex, 1)\nsrc/sage/geometry/polyhedron/combinatorial_polyhedron/list_of_faces.pyx:                M.set_unsafe_si(i, j, 1)\nsrc/sage/matrix/change_ring.pyx:            M.set_unsafe_double(i,j,A.get_unsafe_double(i,j))\nsrc/sage/matrix/matrix_dense.pxd:    cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value)\nsrc/sage/matrix/matrix_dense.pyx:    cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value):\nsrc/sage/matrix/matrix_gfpn_dense.pxd:    cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value)\nsrc/sage/matrix/matrix_gfpn_dense.pxd:    cdef inline int get_unsafe_int(self, Py_ssize_t i, Py_ssize_t j)\nsrc/sage/matrix/matrix_gfpn_dense.pyx:    cdef inline int get_unsafe_int(self, Py_ssize_t i, Py_ssize_t j):\nsrc/sage/matrix/matrix_gfpn_dense.pyx:    cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value):\nsrc/sage/matrix/matrix_integer_dense.pxd:    cdef void set_unsafe_mpz(self, Py_ssize_t i, Py_ssize_t j, const mpz_t value)\nsrc/sage/matrix/matrix_integer_dense.pxd:    cdef void set_unsafe_si(self, Py_ssize_t i, Py_ssize_t j, long value)\nsrc/sage/matrix/matrix_integer_dense.pxd:    cdef void set_unsafe_double(self, Py_ssize_t i, Py_ssize_t j, double value)\nsrc/sage/matrix/matrix_integer_dense.pxd:    cdef inline void get_unsafe_mpz(self, Py_ssize_t i, Py_ssize_t j, mpz_t value)\nsrc/sage/matrix/matrix_integer_dense.pxd:    cdef inline double get_unsafe_double(self, Py_ssize_t i, Py_ssize_t j)\nsrc/sage/matrix/matrix_integer_dense.pyx:        self.set_unsafe_mpz(i, j, (<Integer>x).value)\nsrc/sage/matrix/matrix_integer_dense.pyx:    cdef void set_unsafe_mpz(self, Py_ssize_t i, Py_ssize_t j, const mpz_t value):\nsrc/sage/matrix/matrix_integer_dense.pyx:    cdef void set_unsafe_si(self, Py_ssize_t i, Py_ssize_t j, long value):\nsrc/sage/matrix/matrix_integer_dense.pyx:    cdef void set_unsafe_double(self, Py_ssize_t i, Py_ssize_t j, double value):\nsrc/sage/matrix/matrix_integer_dense.pyx:        self.get_unsafe_mpz(i, j, z.value)\nsrc/sage/matrix/matrix_integer_dense.pyx:    cdef inline void get_unsafe_mpz(self, Py_ssize_t i, Py_ssize_t j, mpz_t value):\nsrc/sage/matrix/matrix_integer_dense.pyx:    cdef inline double get_unsafe_double(self, Py_ssize_t i, Py_ssize_t j):\nsrc/sage/matrix/matrix_integer_dense.pyx:                self.get_unsafe_mpz(i,j,tmp)\nsrc/sage/matrix/matrix_integer_dense.pyx:                        self.set_unsafe_mpz(i,j,tmp)\nsrc/sage/matrix/matrix_integer_dense.pyx:                        self.set_unsafe_mpz(i,k,tmp)\nsrc/sage/matrix/matrix_integer_dense.pyx:                            self.set_unsafe_mpz(i,j,tmp)\nsrc/sage/matrix/matrix_integer_dense.pyx:                            self.set_unsafe_mpz(i,k,tmp)\nsrc/sage/matrix/matrix_integer_dense.pyx:                res.set_unsafe_si(i,j,res_l[k])\nsrc/sage/matrix/matrix_integer_dense.pyx:                self.get_unsafe_mpz(i,j,tmp)\nsrc/sage/matrix/matrix_integer_dense.pyx:            M.set_unsafe_mpz(i,j,tmp[j])\nsrc/sage/matrix/matrix_mod2_dense.pxd:    cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value)\nsrc/sage/matrix/matrix_mod2_dense.pyx:    cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value):\nsrc/sage/matrix/matrix_modn_dense_double.pyx:    cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value):\nsrc/sage/matrix/matrix_modn_dense_float.pyx:    cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value):\nsrc/sage/matrix/matrix_modn_dense_template.pxi:                L.set_unsafe_double(i, j, A_row[j])\nsrc/sage/matrix/matrix_modn_dense_template_header.pxi:    cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value)\nsrc/sage/matrix/matrix_modn_sparse.pyx:                ans.set_unsafe_int(i, j, s)\nsrc/sage/matrix/matrix_real_double_dense.pxd:    cdef set_unsafe_double(self, Py_ssize_t i, Py_ssize_t j, double value)\nsrc/sage/matrix/matrix_real_double_dense.pxd:    cdef double get_unsafe_double(self, Py_ssize_t i, Py_ssize_t j)\nsrc/sage/matrix/matrix_real_double_dense.pyx:    cdef set_unsafe_double(self, Py_ssize_t i, Py_ssize_t j, double value):\nsrc/sage/matrix/matrix_real_double_dense.pyx:    cdef double get_unsafe_double(self, Py_ssize_t i, Py_ssize_t j):\nsrc/sage/matrix/misc.pyx:            A.get_unsafe_mpz(i, j, a)\nsrc/sage/matrix/misc.pyx:                A.get_unsafe_mpz(i, j, tmp)\nsrc/sage/rings/polynomial/real_roots.pyx:        m.get_unsafe_mpz(k,a,tmp)\n```\n\nOverall this is hardly being used. I would probably go by the scheme `set_unsafe_<type>`.\nAs `si` is not a type, I prefer `set_unsafe_int`, `set_unsafe_long`, `set_unsafe_double`.",
    "created_at": "2021-10-14T09:35:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527467",
    "user": "https://github.com/kliem"
}
```

<div id="comment:1" align="right">comment:1</div>


```
$ git grep "et_unsafe_"
src/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            A.set_unsafe_mpz(n-i-1,3,tmp)
src/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            A.set_unsafe_mpz(n-i-1,2,tmp)
src/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            A.set_unsafe_mpz(n-i-1,1,tmp)
src/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            A.set_unsafe_mpz(n-i-1,0,tmp)
src/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            A.set_unsafe_mpz(i,0,tmp)
src/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            A.set_unsafe_mpz(i,1,tmp)
src/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            A.set_unsafe_mpz(i,2,tmp)
src/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            A.set_unsafe_mpz(i,3,tmp)
src/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            H.get_unsafe_mpz(i,3,tmp)
src/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            H.get_unsafe_mpz(i,2,tmp)
src/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            H.get_unsafe_mpz(i,1,tmp)
src/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            H.get_unsafe_mpz(i,0,tmp)
src/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            H.get_unsafe_mpz(i,0,tmp)
src/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            H.get_unsafe_mpz(i,1,tmp)
src/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            H.get_unsafe_mpz(i,2,tmp)
src/sage/algebras/quatalg/quaternion_algebra_cython.pyx:            H.get_unsafe_mpz(i,3,tmp)
src/sage/geometry/polyhedron/combinatorial_polyhedron/base.pyx:                    incidence_matrix.set_unsafe_si(0, i, 1)
src/sage/geometry/polyhedron/combinatorial_polyhedron/base.pyx:                    incidence_matrix.set_unsafe_si(Vindex, Hindex, 1)
src/sage/geometry/polyhedron/combinatorial_polyhedron/base.pyx:                incidence_matrix.set_unsafe_si(Vindex, Hindex, 1)
src/sage/geometry/polyhedron/combinatorial_polyhedron/list_of_faces.pyx:                M.set_unsafe_si(i, j, 1)
src/sage/matrix/change_ring.pyx:            M.set_unsafe_double(i,j,A.get_unsafe_double(i,j))
src/sage/matrix/matrix_dense.pxd:    cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value)
src/sage/matrix/matrix_dense.pyx:    cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value):
src/sage/matrix/matrix_gfpn_dense.pxd:    cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value)
src/sage/matrix/matrix_gfpn_dense.pxd:    cdef inline int get_unsafe_int(self, Py_ssize_t i, Py_ssize_t j)
src/sage/matrix/matrix_gfpn_dense.pyx:    cdef inline int get_unsafe_int(self, Py_ssize_t i, Py_ssize_t j):
src/sage/matrix/matrix_gfpn_dense.pyx:    cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value):
src/sage/matrix/matrix_integer_dense.pxd:    cdef void set_unsafe_mpz(self, Py_ssize_t i, Py_ssize_t j, const mpz_t value)
src/sage/matrix/matrix_integer_dense.pxd:    cdef void set_unsafe_si(self, Py_ssize_t i, Py_ssize_t j, long value)
src/sage/matrix/matrix_integer_dense.pxd:    cdef void set_unsafe_double(self, Py_ssize_t i, Py_ssize_t j, double value)
src/sage/matrix/matrix_integer_dense.pxd:    cdef inline void get_unsafe_mpz(self, Py_ssize_t i, Py_ssize_t j, mpz_t value)
src/sage/matrix/matrix_integer_dense.pxd:    cdef inline double get_unsafe_double(self, Py_ssize_t i, Py_ssize_t j)
src/sage/matrix/matrix_integer_dense.pyx:        self.set_unsafe_mpz(i, j, (<Integer>x).value)
src/sage/matrix/matrix_integer_dense.pyx:    cdef void set_unsafe_mpz(self, Py_ssize_t i, Py_ssize_t j, const mpz_t value):
src/sage/matrix/matrix_integer_dense.pyx:    cdef void set_unsafe_si(self, Py_ssize_t i, Py_ssize_t j, long value):
src/sage/matrix/matrix_integer_dense.pyx:    cdef void set_unsafe_double(self, Py_ssize_t i, Py_ssize_t j, double value):
src/sage/matrix/matrix_integer_dense.pyx:        self.get_unsafe_mpz(i, j, z.value)
src/sage/matrix/matrix_integer_dense.pyx:    cdef inline void get_unsafe_mpz(self, Py_ssize_t i, Py_ssize_t j, mpz_t value):
src/sage/matrix/matrix_integer_dense.pyx:    cdef inline double get_unsafe_double(self, Py_ssize_t i, Py_ssize_t j):
src/sage/matrix/matrix_integer_dense.pyx:                self.get_unsafe_mpz(i,j,tmp)
src/sage/matrix/matrix_integer_dense.pyx:                        self.set_unsafe_mpz(i,j,tmp)
src/sage/matrix/matrix_integer_dense.pyx:                        self.set_unsafe_mpz(i,k,tmp)
src/sage/matrix/matrix_integer_dense.pyx:                            self.set_unsafe_mpz(i,j,tmp)
src/sage/matrix/matrix_integer_dense.pyx:                            self.set_unsafe_mpz(i,k,tmp)
src/sage/matrix/matrix_integer_dense.pyx:                res.set_unsafe_si(i,j,res_l[k])
src/sage/matrix/matrix_integer_dense.pyx:                self.get_unsafe_mpz(i,j,tmp)
src/sage/matrix/matrix_integer_dense.pyx:            M.set_unsafe_mpz(i,j,tmp[j])
src/sage/matrix/matrix_mod2_dense.pxd:    cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value)
src/sage/matrix/matrix_mod2_dense.pyx:    cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value):
src/sage/matrix/matrix_modn_dense_double.pyx:    cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value):
src/sage/matrix/matrix_modn_dense_float.pyx:    cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value):
src/sage/matrix/matrix_modn_dense_template.pxi:                L.set_unsafe_double(i, j, A_row[j])
src/sage/matrix/matrix_modn_dense_template_header.pxi:    cdef set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value)
src/sage/matrix/matrix_modn_sparse.pyx:                ans.set_unsafe_int(i, j, s)
src/sage/matrix/matrix_real_double_dense.pxd:    cdef set_unsafe_double(self, Py_ssize_t i, Py_ssize_t j, double value)
src/sage/matrix/matrix_real_double_dense.pxd:    cdef double get_unsafe_double(self, Py_ssize_t i, Py_ssize_t j)
src/sage/matrix/matrix_real_double_dense.pyx:    cdef set_unsafe_double(self, Py_ssize_t i, Py_ssize_t j, double value):
src/sage/matrix/matrix_real_double_dense.pyx:    cdef double get_unsafe_double(self, Py_ssize_t i, Py_ssize_t j):
src/sage/matrix/misc.pyx:            A.get_unsafe_mpz(i, j, a)
src/sage/matrix/misc.pyx:                A.get_unsafe_mpz(i, j, tmp)
src/sage/rings/polynomial/real_roots.pyx:        m.get_unsafe_mpz(k,a,tmp)
```

Overall this is hardly being used. I would probably go by the scheme `set_unsafe_<type>`.
As `si` is not a type, I prefer `set_unsafe_int`, `set_unsafe_long`, `set_unsafe_double`.



---

archive/issue_comments_527468.json:
```json
{
    "body": "Author: **Jonathan Kliem**",
    "created_at": "2021-10-14T09:54:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527468",
    "user": "https://github.com/kliem"
}
```

Author: **Jonathan Kliem**



---

archive/issue_comments_527469.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7db923eba8e39a66672c58be42ecc727043c6581\"><code>7db923e</code></a></td><td><code>compute vertex adjacency matrix from edges</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/21a6c945088d0b4467e2a02d0028743f2ca402c2\"><code>21a6c94</code></a></td><td><code>remove code duplications</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2cd253c1b7d2b6cb6b8ca0254087565652b9d723\"><code>2cd253c</code></a></td><td><code>more specific import</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f0f72c558d6955ade7ef482b13c54cc491943e1\"><code>0f0f72c</code></a></td><td><code>Merge branch 'public/32666' of git://trac.sagemath.org/sage into public/32688</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bc3ba655f6da4c0fe2aa9a9f7f7112afd7134b93\"><code>bc3ba65</code></a></td><td><code>get_unsafe_si -> get_unsafe_long</code></td></tr></table>\n",
    "created_at": "2021-10-14T09:54:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527469",
    "user": "https://github.com/kliem"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7db923eba8e39a66672c58be42ecc727043c6581"><code>7db923e</code></a></td><td><code>compute vertex adjacency matrix from edges</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/21a6c945088d0b4467e2a02d0028743f2ca402c2"><code>21a6c94</code></a></td><td><code>remove code duplications</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2cd253c1b7d2b6cb6b8ca0254087565652b9d723"><code>2cd253c</code></a></td><td><code>more specific import</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f0f72c558d6955ade7ef482b13c54cc491943e1"><code>0f0f72c</code></a></td><td><code>Merge branch 'public/32666' of git://trac.sagemath.org/sage into public/32688</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bc3ba655f6da4c0fe2aa9a9f7f7112afd7134b93"><code>bc3ba65</code></a></td><td><code>get_unsafe_si -> get_unsafe_long</code></td></tr></table>




---

archive/issue_events_450291.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-10-14T09:54:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32688#event-450291"
}
```



---

archive/issue_comments_527470.json:
```json
{
    "body": "Commit: **[`bc3ba65`](https://github.com/sagemath/sagetrac-mirror/commit/bc3ba655f6da4c0fe2aa9a9f7f7112afd7134b93)**",
    "created_at": "2021-10-14T09:54:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527470",
    "user": "https://github.com/kliem"
}
```

Commit: **[`bc3ba65`](https://github.com/sagemath/sagetrac-mirror/commit/bc3ba655f6da4c0fe2aa9a9f7f7112afd7134b93)**



---

archive/issue_comments_527471.json:
```json
{
    "body": "Branch: **[public/32688](https://github.com/sagemath/sagetrac-mirror/tree/public/32688)**",
    "created_at": "2021-10-14T09:54:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527471",
    "user": "https://github.com/kliem"
}
```

Branch: **[public/32688](https://github.com/sagemath/sagetrac-mirror/tree/public/32688)**



---

archive/issue_comments_527472.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThere are two problems with the general API:\n\n- It takes in `int` instead of a `long`.\n- It is not declared `void`, which means that there is an error check after each call.\n\nHowever, I can't claim that I have a use case for either one in `CombinatorialPolyhedron`. So we could remove `set_unsafe_long` and `get_unsafe_long` for `set_unsafe_int` and `get_unsafe_int` altogether, if you think this is better.",
    "created_at": "2021-10-14T10:10:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527472",
    "user": "https://github.com/kliem"
}
```

<div id="comment:3" align="right">comment:3</div>

There are two problems with the general API:

- It takes in `int` instead of a `long`.
- It is not declared `void`, which means that there is an error check after each call.

However, I can't claim that I have a use case for either one in `CombinatorialPolyhedron`. So we could remove `set_unsafe_long` and `get_unsafe_long` for `set_unsafe_int` and `get_unsafe_int` altogether, if you think this is better.



---

archive/issue_comments_527473.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nYes, I think getting rid of `set_unsafe_si` (= `set_unsafe_long`) would be best.\n\nBut I think this needs deprecation (in the docstring) because it has been there since 2014\n\nIs changing `set_unsafe_int` to declare void a problem?",
    "created_at": "2021-10-14T19:13:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527473",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

Yes, I think getting rid of `set_unsafe_si` (= `set_unsafe_long`) would be best.

But I think this needs deprecation (in the docstring) because it has been there since 2014

Is changing `set_unsafe_int` to declare void a problem?



---

archive/issue_comments_527474.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\n`void` doesn't catch error at all. What makes sense is a declaration like\n\n`cdef int set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value) except -1`.",
    "created_at": "2021-10-25T13:23:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527474",
    "user": "https://github.com/kliem"
}
```

<div id="comment:5" align="right">comment:5</div>

`void` doesn't catch error at all. What makes sense is a declaration like

`cdef int set_unsafe_int(self, Py_ssize_t i, Py_ssize_t j, int value) except -1`.



---

archive/issue_comments_527475.json:
```json
{
    "body": "Changed commit from **[`bc3ba65`](https://github.com/sagemath/sagetrac-mirror/commit/bc3ba655f6da4c0fe2aa9a9f7f7112afd7134b93)** to **[`1ebf822`](https://github.com/sagemath/sagetrac-mirror/commit/1ebf8226dae5cfaba3c6aee400263aab7e1704ab)**",
    "created_at": "2021-10-25T14:03:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527475",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`bc3ba65`](https://github.com/sagemath/sagetrac-mirror/commit/bc3ba655f6da4c0fe2aa9a9f7f7112afd7134b93)** to **[`1ebf822`](https://github.com/sagemath/sagetrac-mirror/commit/1ebf8226dae5cfaba3c6aee400263aab7e1704ab)**



---

archive/issue_comments_527476.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/77c462e5f54360e780a4dd20050854bc625e7dcc\"><code>77c462e</code></a></td><td><code>Merge branch 'public/32688' of git://trac.sagemath.org/sage into public/32688-reb</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1ebf8226dae5cfaba3c6aee400263aab7e1704ab\"><code>1ebf822</code></a></td><td><code>remove set/get_unsafe_long and mark output of set_unsafe_int as irrelevant</code></td></tr></table>\n",
    "created_at": "2021-10-25T14:03:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527476",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/77c462e5f54360e780a4dd20050854bc625e7dcc"><code>77c462e</code></a></td><td><code>Merge branch 'public/32688' of git://trac.sagemath.org/sage into public/32688-reb</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1ebf8226dae5cfaba3c6aee400263aab7e1704ab"><code>1ebf822</code></a></td><td><code>remove set/get_unsafe_long and mark output of set_unsafe_int as irrelevant</code></td></tr></table>




---

archive/issue_comments_527477.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@mkoeppe](#comment:4):\n> \n> But I think this needs deprecation (in the docstring) because it has been there since 2014\n\nHow would you deprecate a cython function. Either people are going to find out the hard way or nobody is using it anyway.",
    "created_at": "2021-10-25T14:04:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527477",
    "user": "https://github.com/kliem"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@mkoeppe](#comment:4):
> 
> But I think this needs deprecation (in the docstring) because it has been there since 2014

How would you deprecate a cython function. Either people are going to find out the hard way or nobody is using it anyway.



---

archive/issue_comments_527478.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nJust the old-fashioned way: Add a comment to the docstring that says \"don't use\".",
    "created_at": "2021-10-25T15:37:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527478",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

Just the old-fashioned way: Add a comment to the docstring that says "don't use".



---

archive/issue_comments_527479.json:
```json
{
    "body": "Changed commit from **[`1ebf822`](https://github.com/sagemath/sagetrac-mirror/commit/1ebf8226dae5cfaba3c6aee400263aab7e1704ab)** to **[`c308d8f`](https://github.com/sagemath/sagetrac-mirror/commit/c308d8f74a59adc75d3a6544863ae35996cf6ad0)**",
    "created_at": "2021-10-25T16:26:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527479",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1ebf822`](https://github.com/sagemath/sagetrac-mirror/commit/1ebf8226dae5cfaba3c6aee400263aab7e1704ab)** to **[`c308d8f`](https://github.com/sagemath/sagetrac-mirror/commit/c308d8f74a59adc75d3a6544863ae35996cf6ad0)**



---

archive/issue_comments_527480.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c308d8f74a59adc75d3a6544863ae35996cf6ad0\"><code>c308d8f</code></a></td><td><code>leave set_unsafe_si with deprecation note</code></td></tr></table>\n",
    "created_at": "2021-10-25T16:26:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527480",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c308d8f74a59adc75d3a6544863ae35996cf6ad0"><code>c308d8f</code></a></td><td><code>leave set_unsafe_si with deprecation note</code></td></tr></table>




---

archive/issue_comments_527481.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nThere are two test failures (apart from the one in `integer.pyx`):\n\n```\nsage -t --long --random-seed=23747002002644886606785003174022326205 src/sage/modules/free_module_integer.py\n**********************************************************************\nFile \"src/sage/modules/free_module_integer.py\", line 370, in sage.modules.free_module_integer.FreeModule_submodule_with_basis_integer.LLL\nFailed example:\n    new_min <= old_min\nExpected:\n    True\nGot:\n    False\n\nsage -t --long --random-seed=23747002002644886606785003174022326205 src/sage/schemes/toric/sheaf/klyachko.py\n**********************************************************************\nFile \"src/sage/schemes/toric/sheaf/klyachko.py\", line 951, in sage.schemes.toric.sheaf.klyachko.KlyachkoBundle_class.random_deformation\nFailed example:\n    Vtilde.cohomology(dim=True, weight=(0,))\nExpected:\n    (1, 0)\nGot:\n    (0, 0)\n```\nAre these from the changes on the ticket or just from random fuzzing?",
    "created_at": "2021-10-26T06:09:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527481",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:10" align="right">comment:10</div>

There are two test failures (apart from the one in `integer.pyx`):

```
sage -t --long --random-seed=23747002002644886606785003174022326205 src/sage/modules/free_module_integer.py
**********************************************************************
File "src/sage/modules/free_module_integer.py", line 370, in sage.modules.free_module_integer.FreeModule_submodule_with_basis_integer.LLL
Failed example:
    new_min <= old_min
Expected:
    True
Got:
    False

sage -t --long --random-seed=23747002002644886606785003174022326205 src/sage/schemes/toric/sheaf/klyachko.py
**********************************************************************
File "src/sage/schemes/toric/sheaf/klyachko.py", line 951, in sage.schemes.toric.sheaf.klyachko.KlyachkoBundle_class.random_deformation
Failed example:
    Vtilde.cohomology(dim=True, weight=(0,))
Expected:
    (1, 0)
Got:
    (0, 0)
```
Are these from the changes on the ticket or just from random fuzzing?



---

archive/issue_comments_527482.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nLGTM but another look by someone more experienced with Cython would be valuable",
    "created_at": "2021-10-26T06:19:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527482",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

LGTM but another look by someone more experienced with Cython would be valuable



---

archive/issue_comments_527483.json:
```json
{
    "body": "Reviewer: **Matthias Koeppe, ...**",
    "created_at": "2021-10-26T06:19:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527483",
    "user": "https://github.com/mkoeppe"
}
```

Reviewer: **Matthias Koeppe, ...**



---

archive/issue_comments_527484.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@mkoeppe](#comment:10):\n> There are two test failures (apart from the one in `integer.pyx`):\n> \n> ```\n> sage -t --long --random-seed=23747002002644886606785003174022326205 src/sage/modules/free_module_integer.py\n> **********************************************************************\n> File \"src/sage/modules/free_module_integer.py\", line 370, in sage.modules.free_module_integer.FreeModule_submodule_with_basis_integer.LLL\n> Failed example:\n>     new_min <= old_min\n> Expected:\n>     True\n> Got:\n>     False\n> \n> sage -t --long --random-seed=23747002002644886606785003174022326205 src/sage/schemes/toric/sheaf/klyachko.py\n> **********************************************************************\n> File \"src/sage/schemes/toric/sheaf/klyachko.py\", line 951, in sage.schemes.toric.sheaf.klyachko.KlyachkoBundle_class.random_deformation\n> Failed example:\n>     Vtilde.cohomology(dim=True, weight=(0,))\n> Expected:\n>     (1, 0)\n> Got:\n>     (0, 0)\n> ```\n> Are these from the changes on the ticket or just from random fuzzing?\n> \n\nYes, I added them to #32544.",
    "created_at": "2021-10-26T07:43:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527484",
    "user": "https://github.com/kliem"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@mkoeppe](#comment:10):
> There are two test failures (apart from the one in `integer.pyx`):
> 
> ```
> sage -t --long --random-seed=23747002002644886606785003174022326205 src/sage/modules/free_module_integer.py
> **********************************************************************
> File "src/sage/modules/free_module_integer.py", line 370, in sage.modules.free_module_integer.FreeModule_submodule_with_basis_integer.LLL
> Failed example:
>     new_min <= old_min
> Expected:
>     True
> Got:
>     False
> 
> sage -t --long --random-seed=23747002002644886606785003174022326205 src/sage/schemes/toric/sheaf/klyachko.py
> **********************************************************************
> File "src/sage/schemes/toric/sheaf/klyachko.py", line 951, in sage.schemes.toric.sheaf.klyachko.KlyachkoBundle_class.random_deformation
> Failed example:
>     Vtilde.cohomology(dim=True, weight=(0,))
> Expected:
>     (1, 0)
> Got:
>     (0, 0)
> ```
> Are these from the changes on the ticket or just from random fuzzing?
> 

Yes, I added them to #32544.



---

archive/issue_comments_527485.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nWe don't need to deprecate the Cython function since that is definitely internal-use only. Someone has to really be reaching into the internals a bit to use it, so they should be comfortable enough with dealing with the resulting error. They almost certainly won't read the documentation change; so they will have the same issue once we remove it. So, IMO, we should just remove it now.\n\nWhy do we need to allow an error to be raised with the `set_unsafe`? The point of `unsafe` is that it is allowed to crash Sage if it is trying to do something invalid. All of the other implementations follow this AFAIK. Is there some reason you want errors to be handled there?",
    "created_at": "2021-10-26T11:07:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527485",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:13" align="right">comment:13</div>

We don't need to deprecate the Cython function since that is definitely internal-use only. Someone has to really be reaching into the internals a bit to use it, so they should be comfortable enough with dealing with the resulting error. They almost certainly won't read the documentation change; so they will have the same issue once we remove it. So, IMO, we should just remove it now.

Why do we need to allow an error to be raised with the `set_unsafe`? The point of `unsafe` is that it is allowed to crash Sage if it is trying to do something invalid. All of the other implementations follow this AFAIK. Is there some reason you want errors to be handled there?



---

archive/issue_comments_527486.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nSo far `set_unsafe` only assumes the coordinates unsafely, but does coerce the object and catches resulting errors. However, we can change this behavior.",
    "created_at": "2021-10-26T11:11:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527486",
    "user": "https://github.com/kliem"
}
```

<div id="comment:14" align="right">comment:14</div>

So far `set_unsafe` only assumes the coordinates unsafely, but does coerce the object and catches resulting errors. However, we can change this behavior.



---

archive/issue_comments_527487.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThat doesn't seem to be the case for `Matrix_integer_dense`. The `set_unsafe` immediately calls `set_unsafe_mpz`, which is a `void`, after a (unprotected) cast.\n\nWhere is it doing the coercion? From looking at the code, the only place it could possibly be doing this is in `Matrix_integer_dense._hnf_modn`. I would say it is the job of that function (or more generally, any function calling the `set_unsafe_int`) to ensure the input is valid. Can you be more specific about what fails if we don't allow the error to propagate?",
    "created_at": "2021-10-26T11:33:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527487",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:15" align="right">comment:15</div>

That doesn't seem to be the case for `Matrix_integer_dense`. The `set_unsafe` immediately calls `set_unsafe_mpz`, which is a `void`, after a (unprotected) cast.

Where is it doing the coercion? From looking at the code, the only place it could possibly be doing this is in `Matrix_integer_dense._hnf_modn`. I would say it is the job of that function (or more generally, any function calling the `set_unsafe_int`) to ensure the input is valid. Can you be more specific about what fails if we don't allow the error to propagate?



---

archive/issue_comments_527488.json:
```json
{
    "body": "Changed dependencies from **#32666** to none",
    "created_at": "2021-12-09T03:12:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527488",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#32666** to none



---

archive/issue_events_450292.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T20:21:36Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32688#event-450292"
}
```



---

archive/issue_events_450293.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T20:21:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32688#event-450293"
}
```



---

archive/issue_events_450294.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-19T18:29:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32688#event-450294"
}
```



---

archive/issue_events_450295.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-19T18:29:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32688#event-450295"
}
```



---

archive/issue_comments_527489.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@tscrim](#comment:15):\n> That doesn't seem to be the case for `Matrix_integer_dense`. The `set_unsafe` immediately calls `set_unsafe_mpz`, which is a `void`, after a (unprotected) cast.\n> \n> Where is it doing the coercion? From looking at the code, the only place it could possibly be doing this is in `Matrix_integer_dense._hnf_modn`. I would say it is the job of that function (or more generally, any function calling the `set_unsafe_int`) to ensure the input is valid. Can you be more specific about what fails if we don't allow the error to propagate?\n\nSorry for the late reply.\n\nHere it is doing some coercion:\n\n```\nsage: matrix(RDF,3,range(9))\n[0.0 1.0 2.0]\n[3.0 4.0 5.0]\n[6.0 7.0 8.0]\nsage: A = matrix(RDF,3,range(9))\nsage: cython('''\n....: from sage.matrix.matrix_double_dense cimport Matrix_double_dense\n....: def foo(Matrix_double_dense A, i, j, object x):\n....:     A.set_unsafe(i, j, x)\n....: ''')\nsage: foo(A, 0, 0, 'a')\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-14-4a46d43f4024> in <module>\n----> 1 foo(A, Integer(0), Integer(0), 'a')\n\n~/.sage/temp/kliem-ThinkPad-L570/4973/spyx/_home_jonathan__sage_temp_kliem_ThinkPad_L570_4973_tmp_mfpt1cva_pyx/_home_jonathan__sage_temp_kliem_ThinkPad_L570_4973_tmp_mfpt1cva_pyx_0.pyx in _home_jonathan__sage_temp_kliem_ThinkPad_L570_4973_tmp_mfpt1cva_pyx_0.foo()\n      2 from sage.matrix.matrix_double_dense cimport Matrix_double_dense\n      3 def foo(Matrix_double_dense A, i, j, object x):\n----> 4     A.set_unsafe(i, j, x)\n\n~/Applications/sage/local/lib/python3.8/site-packages/sage/matrix/matrix_double_dense.pyx in sage.matrix.matrix_double_dense.Matrix_double_dense.set_unsafe (build/cythonized/sage/matrix/matrix_double_dense.c:4311)()\n    239         status = cnumpy.PyArray_SETITEM(self._matrix_numpy,\n    240                         cnumpy.PyArray_GETPTR2(self._matrix_numpy, i, j),\n--> 241                         self._python_dtype(value))\n    242         #TODO: Throw an error if status == -1\n    243 \n\nValueError: could not convert string to float: 'a'\n```\n\nOtherwise `set_unsafe_si` does do coercion by the signature:\n\n```\nsage: A = matrix(ZZ,3,range(9))\nsage: cython('''\n....: from sage.matrix.matrix_integer_dense cimport Matrix_integer_dense\n....: def foo(Matrix_integer_dense A, i, j, object x):\n....:     A.set_unsafe_si(i, j, x)\n....: ''')\nsage: foo(A, 0, 0, '2')\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-13-b9ea546bfc8b> in <module>\n----> 1 foo(A, Integer(0), Integer(0), '2')\n\n~/.sage/temp/kliem-ThinkPad-L570/5379/spyx/_home_jonathan__sage_temp_kliem_ThinkPad_L570_5379_tmp_3b6fet_r_pyx/_home_jonathan__sage_temp_kliem_ThinkPad_L570_5379_tmp_3b6fet_r_pyx_0.pyx in _home_jonathan__sage_temp_kliem_ThinkPad_L570_5379_tmp_3b6fet_r_pyx_0.foo()\n      2 from sage.matrix.matrix_integer_dense cimport Matrix_integer_dense\n      3 def foo(Matrix_integer_dense A, i, j, object x):\n----> 4     A.set_unsafe_si(i, j, x)\n\nTypeError: an integer is required\n```",
    "created_at": "2022-02-19T19:19:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527489",
    "user": "https://github.com/kliem"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@tscrim](#comment:15):
> That doesn't seem to be the case for `Matrix_integer_dense`. The `set_unsafe` immediately calls `set_unsafe_mpz`, which is a `void`, after a (unprotected) cast.
> 
> Where is it doing the coercion? From looking at the code, the only place it could possibly be doing this is in `Matrix_integer_dense._hnf_modn`. I would say it is the job of that function (or more generally, any function calling the `set_unsafe_int`) to ensure the input is valid. Can you be more specific about what fails if we don't allow the error to propagate?

Sorry for the late reply.

Here it is doing some coercion:

```
sage: matrix(RDF,3,range(9))
[0.0 1.0 2.0]
[3.0 4.0 5.0]
[6.0 7.0 8.0]
sage: A = matrix(RDF,3,range(9))
sage: cython('''
....: from sage.matrix.matrix_double_dense cimport Matrix_double_dense
....: def foo(Matrix_double_dense A, i, j, object x):
....:     A.set_unsafe(i, j, x)
....: ''')
sage: foo(A, 0, 0, 'a')
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-14-4a46d43f4024> in <module>
----> 1 foo(A, Integer(0), Integer(0), 'a')

~/.sage/temp/kliem-ThinkPad-L570/4973/spyx/_home_jonathan__sage_temp_kliem_ThinkPad_L570_4973_tmp_mfpt1cva_pyx/_home_jonathan__sage_temp_kliem_ThinkPad_L570_4973_tmp_mfpt1cva_pyx_0.pyx in _home_jonathan__sage_temp_kliem_ThinkPad_L570_4973_tmp_mfpt1cva_pyx_0.foo()
      2 from sage.matrix.matrix_double_dense cimport Matrix_double_dense
      3 def foo(Matrix_double_dense A, i, j, object x):
----> 4     A.set_unsafe(i, j, x)

~/Applications/sage/local/lib/python3.8/site-packages/sage/matrix/matrix_double_dense.pyx in sage.matrix.matrix_double_dense.Matrix_double_dense.set_unsafe (build/cythonized/sage/matrix/matrix_double_dense.c:4311)()
    239         status = cnumpy.PyArray_SETITEM(self._matrix_numpy,
    240                         cnumpy.PyArray_GETPTR2(self._matrix_numpy, i, j),
--> 241                         self._python_dtype(value))
    242         #TODO: Throw an error if status == -1
    243 

ValueError: could not convert string to float: 'a'
```

Otherwise `set_unsafe_si` does do coercion by the signature:

```
sage: A = matrix(ZZ,3,range(9))
sage: cython('''
....: from sage.matrix.matrix_integer_dense cimport Matrix_integer_dense
....: def foo(Matrix_integer_dense A, i, j, object x):
....:     A.set_unsafe_si(i, j, x)
....: ''')
sage: foo(A, 0, 0, '2')
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-13-b9ea546bfc8b> in <module>
----> 1 foo(A, Integer(0), Integer(0), '2')

~/.sage/temp/kliem-ThinkPad-L570/5379/spyx/_home_jonathan__sage_temp_kliem_ThinkPad_L570_5379_tmp_3b6fet_r_pyx/_home_jonathan__sage_temp_kliem_ThinkPad_L570_5379_tmp_3b6fet_r_pyx_0.pyx in _home_jonathan__sage_temp_kliem_ThinkPad_L570_5379_tmp_3b6fet_r_pyx_0.foo()
      2 from sage.matrix.matrix_integer_dense cimport Matrix_integer_dense
      3 def foo(Matrix_integer_dense A, i, j, object x):
----> 4     A.set_unsafe_si(i, j, x)

TypeError: an integer is required
```



---

archive/issue_comments_527490.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nActually, I'm mistaken. Apparently this typechicking by cython is done before actually calling this function:\n\n```\nsage: cython('''\n....: cdef void foo(int a):\n....:     pass\n....:     \n....: def foo2(object a):\n....:     foo(a)\n....: ''')\nsage: foo2('2')\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-4-0205a4bb239b> in <module>\n----> 1 foo2('2')\n\n~/.sage/temp/kliem-ThinkPad-L570/5777/spyx/_home_jonathan__sage_temp_kliem_ThinkPad_L570_5777_tmp_8jwi5wrg_pyx/_home_jonathan__sage_temp_kliem_ThinkPad_L570_5777_tmp_8jwi5wrg_pyx_0.pyx in _home_jonathan__sage_temp_kliem_ThinkPad_L570_5777_tmp_8jwi5wrg_pyx_0.foo2()\n      4 \n      5 def foo2(object a):\n----> 6     foo(a)\n\nTypeError: an integer is required\n```",
    "created_at": "2022-02-19T19:24:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527490",
    "user": "https://github.com/kliem"
}
```

<div id="comment:20" align="right">comment:20</div>

Actually, I'm mistaken. Apparently this typechicking by cython is done before actually calling this function:

```
sage: cython('''
....: cdef void foo(int a):
....:     pass
....:     
....: def foo2(object a):
....:     foo(a)
....: ''')
sage: foo2('2')
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-4-0205a4bb239b> in <module>
----> 1 foo2('2')

~/.sage/temp/kliem-ThinkPad-L570/5777/spyx/_home_jonathan__sage_temp_kliem_ThinkPad_L570_5777_tmp_8jwi5wrg_pyx/_home_jonathan__sage_temp_kliem_ThinkPad_L570_5777_tmp_8jwi5wrg_pyx_0.pyx in _home_jonathan__sage_temp_kliem_ThinkPad_L570_5777_tmp_8jwi5wrg_pyx_0.foo2()
      4 
      5 def foo2(object a):
----> 6     foo(a)

TypeError: an integer is required
```



---

archive/issue_comments_527491.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI still don't think it is necessary to do any error handling for the `unsafe` methods, and I would like to be consistent with the `unsafe` methods.\n\nCan we also just remove the `_si` methods since these should no longer be used? If you aren't going to remove them, then they should emit a deprecation. (But as I said above, IMO it is not necessary to deprecate them.)",
    "created_at": "2022-02-20T04:47:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527491",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:21" align="right">comment:21</div>

I still don't think it is necessary to do any error handling for the `unsafe` methods, and I would like to be consistent with the `unsafe` methods.

Can we also just remove the `_si` methods since these should no longer be used? If you aren't going to remove them, then they should emit a deprecation. (But as I said above, IMO it is not necessary to deprecate them.)



---

archive/issue_comments_527492.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@tscrim](#comment:21):\n> I still don't think it is necessary to do any error handling for the `unsafe` methods, and I would like to be consistent with the `unsafe` methods.\n\nAs mentioned above, the methods `set_unsafe_si` and `set_unsafe_int` already have error handling by the signature. So, the `except -1` can safely go.\n\n> \n> Can we also just remove the `_si` methods since these should no longer be used? If you aren't going to remove them, then they should emit a deprecation. (But as I said above, IMO it is not necessary to deprecate them.)\n\nI agree, deprecation for cython functions doesn't really work.",
    "created_at": "2022-02-20T13:19:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527492",
    "user": "https://github.com/kliem"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@tscrim](#comment:21):
> I still don't think it is necessary to do any error handling for the `unsafe` methods, and I would like to be consistent with the `unsafe` methods.

As mentioned above, the methods `set_unsafe_si` and `set_unsafe_int` already have error handling by the signature. So, the `except -1` can safely go.

> 
> Can we also just remove the `_si` methods since these should no longer be used? If you aren't going to remove them, then they should emit a deprecation. (But as I said above, IMO it is not necessary to deprecate them.)

I agree, deprecation for cython functions doesn't really work.



---

archive/issue_comments_527493.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7a4bcc62822da367529504a9e4aa77d501baf641\"><code>7a4bcc6</code></a></td><td><code>Merge branch 'public/32688' of git://trac.sagemath.org/sage into public/32688-reb</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e8447329a7d92f3092e79b83a1f88ab09065700c\"><code>e844732</code></a></td><td><code>remove set_unsafe_si</code></td></tr></table>\n",
    "created_at": "2022-02-20T16:03:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527493",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7a4bcc62822da367529504a9e4aa77d501baf641"><code>7a4bcc6</code></a></td><td><code>Merge branch 'public/32688' of git://trac.sagemath.org/sage into public/32688-reb</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e8447329a7d92f3092e79b83a1f88ab09065700c"><code>e844732</code></a></td><td><code>remove set_unsafe_si</code></td></tr></table>




---

archive/issue_comments_527494.json:
```json
{
    "body": "Changed commit from **[`c308d8f`](https://github.com/sagemath/sagetrac-mirror/commit/c308d8f74a59adc75d3a6544863ae35996cf6ad0)** to **[`e844732`](https://github.com/sagemath/sagetrac-mirror/commit/e8447329a7d92f3092e79b83a1f88ab09065700c)**",
    "created_at": "2022-02-20T16:03:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527494",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c308d8f`](https://github.com/sagemath/sagetrac-mirror/commit/c308d8f74a59adc75d3a6544863ae35996cf6ad0)** to **[`e844732`](https://github.com/sagemath/sagetrac-mirror/commit/e8447329a7d92f3092e79b83a1f88ab09065700c)**



---

archive/issue_comments_527495.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nActually, `set_unsafe_int` defaults for `Matrix_dense` to just call `set_unsafe`.\n\nThis might raise an error, e.g. if it's not implemented.",
    "created_at": "2022-02-20T16:07:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527495",
    "user": "https://github.com/kliem"
}
```

<div id="comment:24" align="right">comment:24</div>

Actually, `set_unsafe_int` defaults for `Matrix_dense` to just call `set_unsafe`.

This might raise an error, e.g. if it's not implemented.



---

archive/issue_events_450296.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2022-02-21T06:11:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32688#event-450296"
}
```



---

archive/issue_events_450297.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2022-02-21T06:11:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32688#event-450297"
}
```



---

archive/issue_comments_527496.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\n\n```\n+    cdef inline int get_unsafe_int(self, Py_ssize_t i, Py_ssize_t j):\n+        \"\"\"\n+        Return (j, i) entry of self as a new Integer.\n```\n\nWhy (j, i)?",
    "created_at": "2022-02-21T06:39:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527496",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:26" align="right">comment:26</div>


```
+    cdef inline int get_unsafe_int(self, Py_ssize_t i, Py_ssize_t j):
+        """
+        Return (j, i) entry of self as a new Integer.
```

Why (j, i)?



---

archive/issue_comments_527497.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nBecause its a typo I copy-pasted.",
    "created_at": "2022-02-21T06:40:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527497",
    "user": "https://github.com/kliem"
}
```

<div id="comment:27" align="right">comment:27</div>

Because its a typo I copy-pasted.



---

archive/issue_comments_527498.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aebf69dfd55ae0a0883d946f209aa2ade3955275\"><code>aebf69d</code></a></td><td><code>fix typo</code></td></tr></table>\n",
    "created_at": "2022-02-21T06:44:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527498",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aebf69dfd55ae0a0883d946f209aa2ade3955275"><code>aebf69d</code></a></td><td><code>fix typo</code></td></tr></table>




---

archive/issue_comments_527499.json:
```json
{
    "body": "Changed commit from **[`e844732`](https://github.com/sagemath/sagetrac-mirror/commit/e8447329a7d92f3092e79b83a1f88ab09065700c)** to **[`aebf69d`](https://github.com/sagemath/sagetrac-mirror/commit/aebf69dfd55ae0a0883d946f209aa2ade3955275)**",
    "created_at": "2022-02-21T06:44:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527499",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e844732`](https://github.com/sagemath/sagetrac-mirror/commit/e8447329a7d92f3092e79b83a1f88ab09065700c)** to **[`aebf69d`](https://github.com/sagemath/sagetrac-mirror/commit/aebf69dfd55ae0a0883d946f209aa2ade3955275)**



---

archive/issue_comments_527500.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@kliem](#comment:22):\n> Replying to [@tscrim](#comment:21):\n> > I still don't think it is necessary to do any error handling for the `unsafe` methods, and I would like to be consistent with the `unsafe` methods.\n\n> \n> As mentioned above, the methods `set_unsafe_si` and `set_unsafe_int` already have error handling by the signature. So, the `except -1` can safely go.\n\nThey are the only methods to not return a `void` (necessitated by the `except -1`), which you added.\n\nReplying to [@kliem](#comment:24):\n> This might raise an error, e.g. if it's not implemented. \n\nIt is allowed to crash as it is a promise that method is implemented and being an `unsafe` method.\n\nI still think we shouldn't introduce this inconsistency and keep it a `void` with no `except -1`.",
    "created_at": "2022-02-22T05:47:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527500",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@kliem](#comment:22):
> Replying to [@tscrim](#comment:21):
> > I still don't think it is necessary to do any error handling for the `unsafe` methods, and I would like to be consistent with the `unsafe` methods.

> 
> As mentioned above, the methods `set_unsafe_si` and `set_unsafe_int` already have error handling by the signature. So, the `except -1` can safely go.

They are the only methods to not return a `void` (necessitated by the `except -1`), which you added.

Replying to [@kliem](#comment:24):
> This might raise an error, e.g. if it's not implemented. 

It is allowed to crash as it is a promise that method is implemented and being an `unsafe` method.

I still think we shouldn't introduce this inconsistency and keep it a `void` with no `except -1`.



---

archive/issue_comments_527501.json:
```json
{
    "body": "<div id=\"comment:30\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5ce470ef7e6fee094d0f8f8222950a16056f2b60\"><code>5ce470e</code></a></td><td><code>do not handle error for `set_unsafe_int` as requested by reviewer</code></td></tr></table>\n",
    "created_at": "2022-02-22T14:24:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527501",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:30"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5ce470ef7e6fee094d0f8f8222950a16056f2b60"><code>5ce470e</code></a></td><td><code>do not handle error for `set_unsafe_int` as requested by reviewer</code></td></tr></table>




---

archive/issue_comments_527502.json:
```json
{
    "body": "Changed commit from **[`aebf69d`](https://github.com/sagemath/sagetrac-mirror/commit/aebf69dfd55ae0a0883d946f209aa2ade3955275)** to **[`5ce470e`](https://github.com/sagemath/sagetrac-mirror/commit/5ce470ef7e6fee094d0f8f8222950a16056f2b60)**",
    "created_at": "2022-02-22T14:24:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527502",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`aebf69d`](https://github.com/sagemath/sagetrac-mirror/commit/aebf69dfd55ae0a0883d946f209aa2ade3955275)** to **[`5ce470e`](https://github.com/sagemath/sagetrac-mirror/commit/5ce470ef7e6fee094d0f8f8222950a16056f2b60)**



---

archive/issue_comments_527503.json:
```json
{
    "body": "Changed reviewer from **Matthias Koeppe, ...** to **Matthias Koeppe, Travis Scrimshaw**",
    "created_at": "2022-02-27T00:36:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527503",
    "user": "https://github.com/tscrim"
}
```

Changed reviewer from **Matthias Koeppe, ...** to **Matthias Koeppe, Travis Scrimshaw**



---

archive/issue_events_450298.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-02-27T00:36:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32688#event-450298"
}
```



---

archive/issue_events_450299.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-02-27T00:36:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32688#event-450299"
}
```



---

archive/issue_comments_527504.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nThank you. Bot is (morally) green. I am setting this to a positive review.",
    "created_at": "2022-02-27T00:36:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527504",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:31" align="right">comment:31</div>

Thank you. Bot is (morally) green. I am setting this to a positive review.



---

archive/issue_events_450300.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-02-27T22:00:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32688#event-450300"
}
```



---

archive/issue_events_450301.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "f2ed106a91473bccfa0a957a149989f9f0b28d8b",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-02-27T22:00:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32688#event-450301"
}
```



---

archive/issue_comments_527505.json:
```json
{
    "body": "Changed branch from **[public/32688](https://github.com/sagemath/sagetrac-mirror/tree/public/32688)** to **[`5ce470e`](https://github.com/sagemath/sagetrac-mirror/commit/5ce470ef7e6fee094d0f8f8222950a16056f2b60)**",
    "created_at": "2022-02-27T22:00:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32688",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32688#issuecomment-527505",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/32688](https://github.com/sagemath/sagetrac-mirror/tree/public/32688)** to **[`5ce470e`](https://github.com/sagemath/sagetrac-mirror/commit/5ce470ef7e6fee094d0f8f8222950a16056f2b60)**
