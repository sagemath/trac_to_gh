# Issue 32389: Add half-angle transformations

archive/issues_032152.json:
```json
{
    "body": "In some circumstances (e.g. integration),\nit may be useful to rewrite\n\n- expressions in sin(x), cos(x), etc.\n  as expressions in tan(x/2),\n- expressions in sinh(x), cosh(x), etc.\n  as expressions in tanh(x/2)\n\nThis ticket implements a method\nfor this transformation.\n\nCC:  @slel\n\nReviewer: Samuel Leli\u00e8vre, Emmanuel Charpentier\n\nAuthor: Emmanuel Charpentier, Samuel Leli\u00e8vre\n\nBranch: u/slelievre/32389\n\nCommit: a60e101f5ff5cd08baa787e29b3b3e02d3e1cc6f\n\nIssue created by migration from https://trac.sagemath.org/ticket/32389\n\n",
    "created_at": "2021-08-17T14:32:16Z",
    "labels": [
        "component: symbolics",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Add half-angle transformations",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32389",
    "user": "https://github.com/EmmanuelCharpentier"
}
```
In some circumstances (e.g. integration),
it may be useful to rewrite

- expressions in sin(x), cos(x), etc.
  as expressions in tan(x/2),
- expressions in sinh(x), cosh(x), etc.
  as expressions in tanh(x/2)

This ticket implements a method
for this transformation.

CC:  @slel

Reviewer: Samuel Lelièvre, Emmanuel Charpentier

Author: Emmanuel Charpentier, Samuel Lelièvre

Branch: u/slelievre/32389

Commit: a60e101f5ff5cd08baa787e29b3b3e02d3e1cc6f

Issue created by migration from https://trac.sagemath.org/ticket/32389





---

archive/issue_comments_458731.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-17T21:03:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32389#issuecomment-458731",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_458732.json:
```json
{
    "body": "<a id='comment:3'></a>This passes ptestlong without any new failure.\n\n==> `needs_review`, if only to activate patchbots.",
    "created_at": "2021-08-17T21:05:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32389#issuecomment-458732",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:3'></a>This passes ptestlong without any new failure.

==> `needs_review`, if only to activate patchbots.



---

archive/issue_comments_458733.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-08-17T21:05:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32389#issuecomment-458733",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_458734.json:
```json
{
    "body": "<a id='comment:5'></a>`pycode` and `blocks` fail : minor mistakes. `needs_work`",
    "created_at": "2021-08-18T07:04:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32389#issuecomment-458734",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:5'></a>`pycode` and `blocks` fail : minor mistakes. `needs_work`



---

archive/issue_comments_458735.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-08-18T07:04:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32389#issuecomment-458735",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_458736.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-18T07:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32389#issuecomment-458736",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_458737.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-08-18T07:24:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32389#issuecomment-458737",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_458738.json:
```json
{
    "body": "<a id='comment:7'></a>`needs_work` to start the patchbots.",
    "created_at": "2021-08-18T07:24:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32389#issuecomment-458738",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:7'></a>`needs_work` to start the patchbots.



---

archive/issue_comments_458739.json:
```json
{
    "body": "<a id='comment:8'></a>This is a good thing to add.\n\nI rebased on Sage 9.4.rc2 and added a commit with:\n\n- changes from `\\|` to `|` in FriCAS output reverted:\n  they break tests for me\n- some refactoring for readability of code \u200band examples\n  - use `half` for `Integer(1)/Integer(2)`\n    (also makes lines shorter)\n  - less parentheses, brackets and backslashes\n    in the `all(...)` test\n  - make `trig_expand` example more compelling\n    by naming `a` and `b`\n- some reformatting, in particular `::` and\n  \u200b`....:` \u200bfor example and test blocks\n- minor rephrasing, fix spacing and a typo\n\nSet to positive review if you agree with these changes.",
    "created_at": "2021-08-18T15:36:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32389#issuecomment-458739",
    "user": "https://github.com/slel"
}
```

<a id='comment:8'></a>This is a good thing to add.

I rebased on Sage 9.4.rc2 and added a commit with:

- changes from `\|` to `|` in FriCAS output reverted:
  they break tests for me
- some refactoring for readability of code ​and examples
  - use `half` for `Integer(1)/Integer(2)`
    (also makes lines shorter)
  - less parentheses, brackets and backslashes
    in the `all(...)` test
  - make `trig_expand` example more compelling
    by naming `a` and `b`
- some reformatting, in particular `::` and
  ​`....:` ​for example and test blocks
- minor rephrasing, fix spacing and a typo

Set to positive review if you agree with these changes.



---

archive/issue_comments_458740.json:
```json
{
    "body": "<a id='comment:9'></a>New commits:",
    "created_at": "2021-08-18T15:37:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32389#issuecomment-458740",
    "user": "https://github.com/slel"
}
```

<a id='comment:9'></a>New commits:



---

archive/issue_comments_458741.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:8 slelievre]:\n> This is a good thing to add.\n\n\nIndeed... `sympy`'s and `giac` integrators use this often.\n\n> I rebased on Sage 9.4.rc2 and added a commit with:\n> \n> - changes from `\\|` to `|` in FriCAS output reverted:\n>   they break tests for me\n\n\n??? Not for me. Go figure...\n\n> - some refactoring for readability of code \u200band examples\n>   - use `half` for `Integer(1)/Integer(2)`\n>     (also makes lines shorter)\n\n\nSmart. I should have thought of this, I didn't...\n\n>   - less parentheses, brackets and backslashes\n>     in the `all(...)` test\n>   - make `trig_expand` example more compelling\n>     by naming `a` and `b`\n \n> - some reformatting, in particular `::` and\n>  \u200b`....:` \u200bfor example and test blocks\n\n\nI'm still struggling with ResStructuredText (too much markup syntaxes : LaTeX, Markdown, Org, Oxygen, [WikiFormatting](WikiFormatting) and now this...). Thanks a lot !\n\n> - minor rephrasing, fix spacing and a typo\n> \n> Set to positive review if you agree with these changes.\n\n\nThanks ! I do.\n\nBTW : you should be co-author, but I'm almost sure that Trac will balk at the same name in `Author` and `Reviewer` fields.\n\nIn the same spirit (probably more useful), you may be interested in my attempt to #10038 (demoivre/exponentialize).",
    "created_at": "2021-08-18T16:01:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32389#issuecomment-458741",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:10'></a>Replying to [comment:8 slelievre]:
> This is a good thing to add.


Indeed... `sympy`'s and `giac` integrators use this often.

> I rebased on Sage 9.4.rc2 and added a commit with:
> 
> - changes from `\|` to `|` in FriCAS output reverted:
>   they break tests for me


??? Not for me. Go figure...

> - some refactoring for readability of code ​and examples
>   - use `half` for `Integer(1)/Integer(2)`
>     (also makes lines shorter)


Smart. I should have thought of this, I didn't...

>   - less parentheses, brackets and backslashes
>     in the `all(...)` test
>   - make `trig_expand` example more compelling
>     by naming `a` and `b`
 
> - some reformatting, in particular `::` and
>  ​`....:` ​for example and test blocks


I'm still struggling with ResStructuredText (too much markup syntaxes : LaTeX, Markdown, Org, Oxygen, [WikiFormatting](WikiFormatting) and now this...). Thanks a lot !

> - minor rephrasing, fix spacing and a typo
> 
> Set to positive review if you agree with these changes.


Thanks ! I do.

BTW : you should be co-author, but I'm almost sure that Trac will balk at the same name in `Author` and `Reviewer` fields.

In the same spirit (probably more useful), you may be interested in my attempt to #10038 (demoivre/exponentialize).



---

archive/issue_comments_458742.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-08-18T16:01:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32389#issuecomment-458742",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_458743.json:
```json
{
    "body": "<a id='comment:11'></a>The FriCAS output can be a different ticket.\nMaybe it depends on the version of FriCAS.\n\nTrac won't mind us being co-authors and\nco-reviewers of the ticket. It's frequent.\n\nRegarding #10038, I saw you pushed a branch\nand I'm planning to look at it soon.",
    "created_at": "2021-08-18T17:52:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32389#issuecomment-458743",
    "user": "https://github.com/slel"
}
```

<a id='comment:11'></a>The FriCAS output can be a different ticket.
Maybe it depends on the version of FriCAS.

Trac won't mind us being co-authors and
co-reviewers of the ticket. It's frequent.

Regarding #10038, I saw you pushed a branch
and I'm planning to look at it soon.



---

archive/issue_comments_458744.json:
```json
{
    "body": "<a id='comment:12'></a>The FriCAS output problem might be fixed by #32279\n(see also #32379).",
    "created_at": "2021-08-19T15:27:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32389#issuecomment-458744",
    "user": "https://github.com/slel"
}
```

<a id='comment:12'></a>The FriCAS output problem might be fixed by #32279
(see also #32379).



---

archive/issue_comments_458745.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-10-19T23:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32389#issuecomment-458745",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_458746.json:
```json
{
    "body": "<a id='comment:13'></a>Merge conflict",
    "created_at": "2021-10-19T23:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32389#issuecomment-458746",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:13'></a>Merge conflict



---

archive/issue_events_085940.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32389#event-85940"
}
```



---

archive/issue_events_085941.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32389#event-85941"
}
```



---

archive/issue_events_085942.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32389#event-85942"
}
```



---

archive/issue_events_085943.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32389#event-85943"
}
```



---

archive/issue_events_085944.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32389",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32389#event-85944"
}
```
