# Issue 32859: Wrong display from type() with %display latex

archive/issues_032622.json:
```json
{
    "body": "In Sage 9.4 and 9.5.beta5, the following cell of a Jupyter notebook\n\n```\n%display latex\ntype(x)\n```\nresults in \n\n```\n\\[\\newcommand{\\Bold}[1]{\\mathbf{#1}}\\verb||\\]\n```\ninstead of \n\n```\n<\ud835\ude8c\ud835\ude95\ud835\ude8a\ud835\ude9c\ud835\ude9c'\ud835\ude9c\ud835\ude8a\ud835\ude90\ud835\ude8e.\ud835\ude9c\ud835\udea2\ud835\ude96\ud835\ude8b\ud835\ude98\ud835\ude95\ud835\ude92\ud835\ude8c.\ud835\ude8e\ud835\udea1\ud835\ude99\ud835\ude9b\ud835\ude8e\ud835\ude9c\ud835\ude9c\ud835\ude92\ud835\ude98\ud835\ude97.\ud835\ude74\ud835\udea1\ud835\ude99\ud835\ude9b\ud835\ude8e\ud835\ude9c\ud835\ude9c\ud835\ude92\ud835\ude98\ud835\ude97'>\n```\nEverything is OK with Sage <= 9.3. \n\nDepends on #32208\n\n**CC:**  @kwankyu\n\n**Keywords:** jupyter display latex\n\n**Branch:** [e9dc5764ed64f34f42ebca1d3849e4927f7d0a96](https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96)\n\n**Reviewer:** Eric Gourgoulhon\n\n**Author:** Kwankyu Lee\n\nIssue created by migration from https://trac.sagemath.org/ticket/32859\n\n",
    "closed_at": "2021-11-18T23:38:08Z",
    "created_at": "2021-11-12T12:23:06Z",
    "labels": [
        "component: notebook",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "title": "Wrong display from type() with %display latex",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/32859",
    "user": "https://github.com/egourgoulhon"
}
```
In Sage 9.4 and 9.5.beta5, the following cell of a Jupyter notebook

```
%display latex
type(x)
```
results in 

```
\[\newcommand{\Bold}[1]{\mathbf{#1}}\verb||\]
```
instead of 

```
<ðšŒðš•ðšŠðšœðšœ'ðšœðšŠðšðšŽ.ðšœðš¢ðš–ðš‹ðš˜ðš•ðš’ðšŒ.ðšŽðš¡ðš™ðš›ðšŽðšœðšœðš’ðš˜ðš—.ð™´ðš¡ðš™ðš›ðšŽðšœðšœðš’ðš˜ðš—'>
```
Everything is OK with Sage <= 9.3. 

Depends on #32208

**CC:**  @kwankyu

**Keywords:** jupyter display latex

**Branch:** [e9dc5764ed64f34f42ebca1d3849e4927f7d0a96](https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96)

**Reviewer:** Eric Gourgoulhon

**Author:** Kwankyu Lee

Issue created by migration from https://trac.sagemath.org/ticket/32859





---

archive/issue_comments_533064.json:
```json
{
    "body": "**Author:** Kwankyu Lee",
    "created_at": "2021-11-12T14:34:50Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533064",
    "user": "https://github.com/kwankyu"
}
```

**Author:** Kwankyu Lee



---

archive/issue_comments_533065.json:
```json
{
    "body": "**Branch:** [u/klee/32859](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/32859)",
    "created_at": "2021-11-12T14:34:50Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533065",
    "user": "https://github.com/kwankyu"
}
```

**Branch:** [u/klee/32859](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/32859)



---

archive/issue_comments_533066.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4d021ab87a4a44b2928a25d4d33721018985f62f\">4d021ab</a></td><td><code>Convert < to &lt; and back</code></td></tr></table>\n",
    "created_at": "2021-11-12T14:35:09Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533066",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4d021ab87a4a44b2928a25d4d33721018985f62f">4d021ab</a></td><td><code>Convert < to &lt; and back</code></td></tr></table>




---

archive/issue_comments_533067.json:
```json
{
    "body": "**Commit:** [4d021ab87a4a44b2928a25d4d33721018985f62f](https://github.com/sagemath/sagetrac-mirror/commit/4d021ab87a4a44b2928a25d4d33721018985f62f)",
    "created_at": "2021-11-12T14:35:09Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533067",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [4d021ab87a4a44b2928a25d4d33721018985f62f](https://github.com/sagemath/sagetrac-mirror/commit/4d021ab87a4a44b2928a25d4d33721018985f62f)



---

archive/issue_events_294760.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2021-11-12T14:35:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-294760"
}
```



---

archive/issue_comments_533068.json:
```json
{
    "body": "<a id='comment:5'></a>\nThe fix for this ticket is this part:\n\n```diff\n--- a/src/sage/misc/html.py\n+++ b/src/sage/misc/html.py\n@@ -351,15 +351,16 @@ class MathJax:\n             [_Latex_prefs._option['macros']] +\n             parts\n         )\n+        mathjax_string = latex_string.replace('<', '&lt;')\n         if mode == 'display':\n             html = r'<html>\\[{0}\\]</html>'\n         elif mode == 'inline':\n             html = r'<html>\\({0}\\)</html>'\n         elif mode == 'plain':\n-            return latex_string\n+            return mathjax_string\n         else:\n             raise ValueError(\"mode must be either 'display', 'inline', or 'plain'\")\n-        return MathJaxExpr(html.format(latex_string))\n+        return MathJaxExpr(html.format(mathjax_string))\n \n \n class HTMLFragmentFactory(SageObject):\ndiff --git a/src/sage/repl/rich_output/output_browser.py b/src/sage/repl/rich_output/output_browser.py\nindex 2746e3dff8..3d7cda599a 100644\n--- a/src/sage/repl/rich_output/output_browser.py\n+++ b/src/sage/repl/rich_output/output_browser.py\n@@ -40,10 +40,12 @@ class OutputHtml(OutputBase):\n         # pdf export of a notebook\n         m = latex_re.match(html)\n         if m:\n+            mathjax_string = m.group('latex')\n+            latex_string = mathjax_string.replace('&lt;', '<')\n             if m.group('mathstart') == r'\\[' and m.group('mathend') == r'\\]':\n-                self.latex = OutputBuffer('$$' + m.group('latex') + '$$')\n+                self.latex = OutputBuffer('$$' + latex_string + '$$')\n             else:\n-                self.latex = OutputBuffer('$' + m.group('latex') + '$')\n+                self.latex = OutputBuffer('$' + latex_string + '$')\n```",
    "created_at": "2021-11-12T14:36:57Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533068",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:5'></a>
The fix for this ticket is this part:

```diff
--- a/src/sage/misc/html.py
+++ b/src/sage/misc/html.py
@@ -351,15 +351,16 @@ class MathJax:
             [_Latex_prefs._option['macros']] +
             parts
         )
+        mathjax_string = latex_string.replace('<', '&lt;')
         if mode == 'display':
             html = r'<html>\[{0}\]</html>'
         elif mode == 'inline':
             html = r'<html>\({0}\)</html>'
         elif mode == 'plain':
-            return latex_string
+            return mathjax_string
         else:
             raise ValueError("mode must be either 'display', 'inline', or 'plain'")
-        return MathJaxExpr(html.format(latex_string))
+        return MathJaxExpr(html.format(mathjax_string))
 
 
 class HTMLFragmentFactory(SageObject):
diff --git a/src/sage/repl/rich_output/output_browser.py b/src/sage/repl/rich_output/output_browser.py
index 2746e3dff8..3d7cda599a 100644
--- a/src/sage/repl/rich_output/output_browser.py
+++ b/src/sage/repl/rich_output/output_browser.py
@@ -40,10 +40,12 @@ class OutputHtml(OutputBase):
         # pdf export of a notebook
         m = latex_re.match(html)
         if m:
+            mathjax_string = m.group('latex')
+            latex_string = mathjax_string.replace('&lt;', '<')
             if m.group('mathstart') == r'\[' and m.group('mathend') == r'\]':
-                self.latex = OutputBuffer('$$' + m.group('latex') + '$$')
+                self.latex = OutputBuffer('$$' + latex_string + '$$')
             else:
-                self.latex = OutputBuffer('$' + m.group('latex') + '$')
+                self.latex = OutputBuffer('$' + latex_string + '$')
```



---

archive/issue_comments_533069.json:
```json
{
    "body": "<a id='comment:6'></a>\nBut I merged the branch of #32208 to the present branch, in order to also fix pdf export problem of the example\n\n```\n%display latex\ntype(x)\n```\nof this ticket.",
    "created_at": "2021-11-12T14:39:29Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533069",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:6'></a>
But I merged the branch of #32208 to the present branch, in order to also fix pdf export problem of the example

```
%display latex
type(x)
```
of this ticket.



---

archive/issue_comments_533070.json:
```json
{
    "body": "<a id='comment:7'></a>\nAs always, please watch for any unexpected side effects in display and printing...",
    "created_at": "2021-11-12T14:42:22Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533070",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:7'></a>
As always, please watch for any unexpected side effects in display and printing...



---

archive/issue_comments_533071.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba099ec02228f44a7923a81f27aaad760e948fff\">ba099ec</a></td><td><code>Fix doctests</code></td></tr></table>\n",
    "created_at": "2021-11-12T14:54:49Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533071",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba099ec02228f44a7923a81f27aaad760e948fff">ba099ec</a></td><td><code>Fix doctests</code></td></tr></table>




---

archive/issue_comments_533072.json:
```json
{
    "body": "**Changing commit** from \"[4d021ab87a4a44b2928a25d4d33721018985f62f](https://github.com/sagemath/sagetrac-mirror/commit/4d021ab87a4a44b2928a25d4d33721018985f62f)\" to \"[ba099ec02228f44a7923a81f27aaad760e948fff](https://github.com/sagemath/sagetrac-mirror/commit/ba099ec02228f44a7923a81f27aaad760e948fff)\".",
    "created_at": "2021-11-12T14:54:49Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533072",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[4d021ab87a4a44b2928a25d4d33721018985f62f](https://github.com/sagemath/sagetrac-mirror/commit/4d021ab87a4a44b2928a25d4d33721018985f62f)" to "[ba099ec02228f44a7923a81f27aaad760e948fff](https://github.com/sagemath/sagetrac-mirror/commit/ba099ec02228f44a7923a81f27aaad760e948fff)".



---

archive/issue_comments_533073.json:
```json
{
    "body": "<a id='comment:9'></a>\nThank you very much for the prompt fix! I am setting #32208 as a dependency because of [comment:6](#comment%3A6) and I am going to test both tickets.",
    "created_at": "2021-11-13T10:32:33Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533073",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:9'></a>
Thank you very much for the prompt fix! I am setting #32208 as a dependency because of [comment:6](#comment%3A6) and I am going to test both tickets.



---

archive/issue_comments_533074.json:
```json
{
    "body": "**Dependencies:** #32208",
    "created_at": "2021-11-13T10:32:33Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533074",
    "user": "https://github.com/egourgoulhon"
}
```

**Dependencies:** #32208



---

archive/issue_events_294761.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-11-13T10:32:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "critical",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-294761"
}
```



---

archive/issue_events_294762.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-11-13T13:38:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-294762"
}
```



---

archive/issue_events_294763.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-11-13T13:38:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-294763"
}
```



---

archive/issue_comments_533075.json:
```json
{
    "body": "<a id='comment:10'></a>\nAs for #32208, I've tested the fix with these notebooks: [test_display_latex](https://nbviewer.org/github/egourgoulhon/SageMathTest/blob/master/Notebooks/test_display_latex.ipynb), [SM_Kerr_surfaces](https://nbviewer.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_Kerr_surfaces.ipynb) and [SM_spheres_S2](https://nbviewer.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_sphere_S2.ipynb). Everything seems OK. Thank you very much.",
    "created_at": "2021-11-13T13:38:12Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533075",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:10'></a>
As for #32208, I've tested the fix with these notebooks: [test_display_latex](https://nbviewer.org/github/egourgoulhon/SageMathTest/blob/master/Notebooks/test_display_latex.ipynb), [SM_Kerr_surfaces](https://nbviewer.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_Kerr_surfaces.ipynb) and [SM_spheres_S2](https://nbviewer.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_sphere_S2.ipynb). Everything seems OK. Thank you very much.



---

archive/issue_comments_533076.json:
```json
{
    "body": "**Reviewer:** Eric Gourgoulhon",
    "created_at": "2021-11-13T13:38:12Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533076",
    "user": "https://github.com/egourgoulhon"
}
```

**Reviewer:** Eric Gourgoulhon



---

archive/issue_comments_533077.json:
```json
{
    "body": "<a id='comment:11'></a>\nThank you.",
    "created_at": "2021-11-13T23:23:18Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533077",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:11'></a>
Thank you.



---

archive/issue_comments_533078.json:
```json
{
    "body": "<a id='comment:12'></a>\nThis is an off-topic, but your notebooks show latex expressions flush left. As far as I know, latex expressions are displayed centered by default. I don't know how you did it. Anyway, I think latex expressions should be shown flush left by default. What do you think?",
    "created_at": "2021-11-13T23:53:48Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533078",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:12'></a>
This is an off-topic, but your notebooks show latex expressions flush left. As far as I know, latex expressions are displayed centered by default. I don't know how you did it. Anyway, I think latex expressions should be shown flush left by default. What do you think?



---

archive/issue_comments_533079.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [klee](#comment%3A12):\n> This is an off-topic, but your notebooks show latex expressions flush left. As far as I know, latex expressions are displayed centered by default. I don't know how you did it. \n\n\nI did nothing special. Latex expressions have always been flushed left on my notebooks since the introduction of Jupyter in Sage. Are they centered on your computer? The only thing I've noticed is that when run on CoCalc, the very same notebook has latex expression centered, see e.g. this [example](https://cocalc.com/share/public_paths/6850015be0320058cadba1ce63e7a3eedf4eef89).\n>Anyway, I think latex expressions should be shown flush left by default. What do you think?\n\nI don't have any strong opinion on that, but I agree with you: flush left is usually what we have in published articles.",
    "created_at": "2021-11-14T08:52:33Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533079",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:13'></a>
Replying to [klee](#comment%3A12):
> This is an off-topic, but your notebooks show latex expressions flush left. As far as I know, latex expressions are displayed centered by default. I don't know how you did it. 


I did nothing special. Latex expressions have always been flushed left on my notebooks since the introduction of Jupyter in Sage. Are they centered on your computer? The only thing I've noticed is that when run on CoCalc, the very same notebook has latex expression centered, see e.g. this [example](https://cocalc.com/share/public_paths/6850015be0320058cadba1ce63e7a3eedf4eef89).
>Anyway, I think latex expressions should be shown flush left by default. What do you think?

I don't have any strong opinion on that, but I agree with you: flush left is usually what we have in published articles.



---

archive/issue_comments_533080.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [egourgoulhon](#comment%3A13):\n> I did nothing special. Latex expressions have always been flushed left on my notebooks since the introduction of Jupyter in Sage. Are they centered on your computer? \n\n\nYes. It is mysterious to me since I know that latex expressions are centered because they are enclosed by `\\[...\\]`.\n\n> >Anyway, I think latex expressions should be shown flush left by default. What do you think?\n\n> I don't have any strong opinion on that, but I agree with you: flush left is usually what we have in published articles.\n\nOkay. Thank you.",
    "created_at": "2021-11-14T10:14:18Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533080",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:14'></a>
Replying to [egourgoulhon](#comment%3A13):
> I did nothing special. Latex expressions have always been flushed left on my notebooks since the introduction of Jupyter in Sage. Are they centered on your computer? 


Yes. It is mysterious to me since I know that latex expressions are centered because they are enclosed by `\[...\]`.

> >Anyway, I think latex expressions should be shown flush left by default. What do you think?

> I don't have any strong opinion on that, but I agree with you: flush left is usually what we have in published articles.

Okay. Thank you.



---

archive/issue_comments_533081.json:
```json
{
    "body": "<a id='comment:15'></a>\nMerge conflict",
    "created_at": "2021-11-14T17:09:25Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533081",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:15'></a>
Merge conflict



---

archive/issue_events_294764.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-14T17:09:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-294764"
}
```



---

archive/issue_events_294765.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-14T17:09:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-294765"
}
```



---

archive/issue_comments_533082.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [klee](#comment%3A14):\n> Replying to [egourgoulhon](#comment%3A13):\n> > I did nothing special. Latex expressions have always been flushed left on my notebooks since the introduction of Jupyter in Sage. Are they centered on your computer? \n\n> \n> Yes. It is mysterious to me since I know that latex expressions are centered because they are enclosed by `\\[...\\]`.\n  \nThis is strange indeed... Maybe it's a matter of OS? What is yours? Mine is Ubuntu 20.04. I've always had flushed left expressions on all the computers I've used (all running various versions of Ubuntu). It could also be related to the locale (fr_FR in my case). The centered rendering on CoCalc does not surprise me further because their Jupyter is somehow customized.",
    "created_at": "2021-11-14T20:35:08Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533082",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:16'></a>
Replying to [klee](#comment%3A14):
> Replying to [egourgoulhon](#comment%3A13):
> > I did nothing special. Latex expressions have always been flushed left on my notebooks since the introduction of Jupyter in Sage. Are they centered on your computer? 

> 
> Yes. It is mysterious to me since I know that latex expressions are centered because they are enclosed by `\[...\]`.
  
This is strange indeed... Maybe it's a matter of OS? What is yours? Mine is Ubuntu 20.04. I've always had flushed left expressions on all the computers I've used (all running various versions of Ubuntu). It could also be related to the locale (fr_FR in my case). The centered rendering on CoCalc does not surprise me further because their Jupyter is somehow customized.



---

archive/issue_comments_533083.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [vbraun](#comment%3A15):\n> Merge conflict\n\nI guess we have to wait for 9.5.beta7 to solve that one.",
    "created_at": "2021-11-14T20:36:23Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533083",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:17'></a>
Replying to [vbraun](#comment%3A15):
> Merge conflict

I guess we have to wait for 9.5.beta7 to solve that one.



---

archive/issue_comments_533084.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7a5b112c93d9431968d85a9c38bb0e63efc5e2e8\">7a5b112</a></td><td><code>Merge branch 'develop' into wrong-display-trac32859</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b0bbc1e887c05fe2c8b05089cdf15fe21c0156a0\">b0bbc1e</a></td><td><code>Remove unnecessary spacer code</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/656a8d3c6f9088e1c126a5b69b630a2c70bbe890\">656a8d3</a></td><td><code>Fix doctest failures</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96\">e9dc576</a></td><td><code>Merge branch 'mathjax-trac32208' into wrong-display-trac32859</code></td></tr></table>\n",
    "created_at": "2021-11-15T01:06:18Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533084",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7a5b112c93d9431968d85a9c38bb0e63efc5e2e8">7a5b112</a></td><td><code>Merge branch 'develop' into wrong-display-trac32859</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b0bbc1e887c05fe2c8b05089cdf15fe21c0156a0">b0bbc1e</a></td><td><code>Remove unnecessary spacer code</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/656a8d3c6f9088e1c126a5b69b630a2c70bbe890">656a8d3</a></td><td><code>Fix doctest failures</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96">e9dc576</a></td><td><code>Merge branch 'mathjax-trac32208' into wrong-display-trac32859</code></td></tr></table>




---

archive/issue_comments_533085.json:
```json
{
    "body": "**Changing commit** from \"[ba099ec02228f44a7923a81f27aaad760e948fff](https://github.com/sagemath/sagetrac-mirror/commit/ba099ec02228f44a7923a81f27aaad760e948fff)\" to \"[e9dc5764ed64f34f42ebca1d3849e4927f7d0a96](https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96)\".",
    "created_at": "2021-11-15T01:06:18Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533085",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ba099ec02228f44a7923a81f27aaad760e948fff](https://github.com/sagemath/sagetrac-mirror/commit/ba099ec02228f44a7923a81f27aaad760e948fff)" to "[e9dc5764ed64f34f42ebca1d3849e4927f7d0a96](https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96)".



---

archive/issue_comments_533086.json:
```json
{
    "body": "<a id='comment:19'></a>\nResolved merge conflict",
    "created_at": "2021-11-15T01:07:09Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533086",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:19'></a>
Resolved merge conflict



---

archive/issue_events_294766.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2021-11-15T01:07:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-294766"
}
```



---

archive/issue_events_294767.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2021-11-15T01:07:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-294767"
}
```



---

archive/issue_comments_533087.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [egourgoulhon](#comment%3A16):\n> This is strange indeed... Maybe it's a matter of OS? What is yours? Mine is Ubuntu 20.04.\n\n\nMine is Mac OS. \n\n> I've always had flushed left expressions on all the computers I've used (all running various versions of Ubuntu). It could also be related to the locale (fr_FR in my case). \n\n\nPossibly. I don't know. If you open the notebook in editor (by right-clicking it), then you can see the raw data. Mine shows\n\n```\n    {\n     \"data\": {\n      \"text/html\": [\n       \"<html>\\\\[\\\\newcommand{\\\\Bold}[1]{\\\\mathbf{#1}}\\\\verb|&lt;class|\\\\verb| |\\\\verb|'sage.symbolic.expression.Expression'>|\\\\]</html>\"\n      ],\n      \"text/latex\": [\n       \"$$\\\\newcommand{\\\\Bold}[1]{\\\\mathbf{#1}}\\\\verb|<class|\\\\verb| |\\\\verb|'sage.symbolic.expression.Expression'>|$$\"\n      ],\n      \"text/plain\": [\n       \"<class 'sage.symbolic.expression.Expression'>\"\n      ]\n     }\n```\nfor `type(x)` cell. You see `\\\\[` and `$$`. How about yours?",
    "created_at": "2021-11-15T01:15:12Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533087",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:20'></a>
Replying to [egourgoulhon](#comment%3A16):
> This is strange indeed... Maybe it's a matter of OS? What is yours? Mine is Ubuntu 20.04.


Mine is Mac OS. 

> I've always had flushed left expressions on all the computers I've used (all running various versions of Ubuntu). It could also be related to the locale (fr_FR in my case). 


Possibly. I don't know. If you open the notebook in editor (by right-clicking it), then you can see the raw data. Mine shows

```
    {
     "data": {
      "text/html": [
       "<html>\\[\\newcommand{\\Bold}[1]{\\mathbf{#1}}\\verb|&lt;class|\\verb| |\\verb|'sage.symbolic.expression.Expression'>|\\]</html>"
      ],
      "text/latex": [
       "$$\\newcommand{\\Bold}[1]{\\mathbf{#1}}\\verb|<class|\\verb| |\\verb|'sage.symbolic.expression.Expression'>|$$"
      ],
      "text/plain": [
       "<class 'sage.symbolic.expression.Expression'>"
      ]
     }
```
for `type(x)` cell. You see `\\[` and `$$`. How about yours?



---

archive/issue_comments_533088.json:
```json
{
    "body": "<a id='comment:21'></a>\nI directly checked your notebooks. They are the same, the same `\\\\[` and `$$`.",
    "created_at": "2021-11-15T01:22:12Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533088",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:21'></a>
I directly checked your notebooks. They are the same, the same `\\[` and `$$`.



---

archive/issue_comments_533089.json:
```json
{
    "body": "<a id='comment:22'></a>\nI downloaded your notebook to open it in my jupyterlab. Now latex expressions are centered. In nbviewer, they are rendered by mathjax 2.7.1. My jupyterlab uses mathjax 2.7.9. It might be a bug of mathjax 2.7.1...",
    "created_at": "2021-11-15T01:37:35Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533089",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:22'></a>
I downloaded your notebook to open it in my jupyterlab. Now latex expressions are centered. In nbviewer, they are rendered by mathjax 2.7.1. My jupyterlab uses mathjax 2.7.9. It might be a bug of mathjax 2.7.1...



---

archive/issue_comments_533090.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [klee](#comment%3A22):\n> I downloaded your notebook to open it in my jupyterlab. Now latex expressions are centered. In nbviewer, they are rendered by mathjax 2.7.1. My jupyterlab uses mathjax 2.7.9. It might be a bug of mathjax 2.7.1... \n\n\nMy Jupyter notebook uses Mathjax 2.7.9 as well. However, if I right-click on a displayed expression to open the Mathjax contextual menu and choose `Math Settings -> Math Redender`, I see that `HTML-CSS` is selected; if I select `MathML` instead, I get a warning:\n\n```\nYour browser's native MathML does not implement all the features used by MathJax, \nso some expressions may not render properly.\n```\nbut then all the formulas in the notebook become centered! Moreover, the Rubik's cube is then correctly displayed. \n\nThe above is for Firefox (my default browser). If I do the same thing with Chrome (where initially all LaTeX expressions are left-flushed as well), I got the same warning when switching from `HTML-CSS` to `MathML`, but then, instead of LaTeX rendering, the literal code is displayed,\ne.g. \n\n```\n\\newcommand{\\Bold}[1]{\\mathbf{#1}}\\sin\\left(x^{2}\\right)\n```\nfor the first formula.",
    "created_at": "2021-11-15T08:35:03Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533090",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:23'></a>
Replying to [klee](#comment%3A22):
> I downloaded your notebook to open it in my jupyterlab. Now latex expressions are centered. In nbviewer, they are rendered by mathjax 2.7.1. My jupyterlab uses mathjax 2.7.9. It might be a bug of mathjax 2.7.1... 


My Jupyter notebook uses Mathjax 2.7.9 as well. However, if I right-click on a displayed expression to open the Mathjax contextual menu and choose `Math Settings -> Math Redender`, I see that `HTML-CSS` is selected; if I select `MathML` instead, I get a warning:

```
Your browser's native MathML does not implement all the features used by MathJax, 
so some expressions may not render properly.
```
but then all the formulas in the notebook become centered! Moreover, the Rubik's cube is then correctly displayed. 

The above is for Firefox (my default browser). If I do the same thing with Chrome (where initially all LaTeX expressions are left-flushed as well), I got the same warning when switching from `HTML-CSS` to `MathML`, but then, instead of LaTeX rendering, the literal code is displayed,
e.g. 

```
\newcommand{\Bold}[1]{\mathbf{#1}}\sin\left(x^{2}\right)
```
for the first formula.



---

archive/issue_comments_533091.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [egourgoulhon](#comment%3A23):\n> My Jupyter notebook uses Mathjax 2.7.9 as well. However, if I right-click on a displayed expression to open the Mathjax contextual menu and choose `Math Settings -> Math Redender`, I see that `HTML-CSS` is selected; if I select `MathML` instead, I get a warning:\n> \n> ```\n> Your browser's native MathML does not implement all the features used by MathJax, \n> so some expressions may not render properly.\n> ```\n> but then all the formulas in the notebook become centered! Moreover, the Rubik's cube is then correctly displayed. \n\n\nI experience all the same except that with HTML-CSS renderer, latex expressions are still centered.",
    "created_at": "2021-11-15T08:44:45Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533091",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:24'></a>
Replying to [egourgoulhon](#comment%3A23):
> My Jupyter notebook uses Mathjax 2.7.9 as well. However, if I right-click on a displayed expression to open the Mathjax contextual menu and choose `Math Settings -> Math Redender`, I see that `HTML-CSS` is selected; if I select `MathML` instead, I get a warning:
> 
> ```
> Your browser's native MathML does not implement all the features used by MathJax, 
> so some expressions may not render properly.
> ```
> but then all the formulas in the notebook become centered! Moreover, the Rubik's cube is then correctly displayed. 


I experience all the same except that with HTML-CSS renderer, latex expressions are still centered.



---

archive/issue_comments_533092.json:
```json
{
    "body": "<a id='comment:25'></a>\nWith Firefox on my mac, all the same (centered displays).",
    "created_at": "2021-11-15T08:51:04Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533092",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:25'></a>
With Firefox on my mac, all the same (centered displays).



---

archive/issue_comments_533093.json:
```json
{
    "body": "Jupyter screenshot",
    "created_at": "2021-11-15T08:58:37Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533093",
    "user": "https://github.com/kwankyu"
}
```

Jupyter screenshot



---

archive/attachments_021568.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "Screen Shot 2021-11-15 at 5.55.59 PM.png",
    "asset_url": "tarball://root/attachments/ticket32859/09a649b92333fbe51c39a038ef382731.png",
    "created_at": "2021-11-15T10:20:02Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket32859/09a649b92333fbe51c39a038ef382731.png",
    "user": "https://github.com/egourgoulhon"
}
```



---

archive/issue_comments_533094.json:
```json
{
    "body": "<a id='comment:26'></a>\nAttachment [Screen Shot 2021-11-15 at 5.55.59 PM.png](https://github.com/sagemath/sage/files/ticket32859/09a649b92333fbe51c39a038ef382731.png) by @egourgoulhon created at 2021-11-15 10:20:02\n\nAnother data point: when running Jupyterlab on my computer (via `sage -n jupyterlab`), latex expressions are centered. So there is a difference of behavior between the Jupyter notebook and Jupyterlab.",
    "created_at": "2021-11-15T10:20:02Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533094",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:26'></a>
Attachment [Screen Shot 2021-11-15 at 5.55.59 PM.png](https://github.com/sagemath/sage/files/ticket32859/09a649b92333fbe51c39a038ef382731.png) by @egourgoulhon created at 2021-11-15 10:20:02

Another data point: when running Jupyterlab on my computer (via `sage -n jupyterlab`), latex expressions are centered. So there is a difference of behavior between the Jupyter notebook and Jupyterlab.



---

archive/issue_comments_533095.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [egourgoulhon](#comment%3A26):\n> Another data point: when running Jupyterlab on my computer (via `sage -n jupyterlab`), latex expressions are centered. So there is a difference of behavior between the Jupyter notebook and Jupyterlab.\n\n\nRight. Me too. So it is a difference between jupyter notebook and jupyterlab!",
    "created_at": "2021-11-15T10:47:33Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533095",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:27'></a>
Replying to [egourgoulhon](#comment%3A26):
> Another data point: when running Jupyterlab on my computer (via `sage -n jupyterlab`), latex expressions are centered. So there is a difference of behavior between the Jupyter notebook and Jupyterlab.


Right. Me too. So it is a difference between jupyter notebook and jupyterlab!



---

archive/issue_comments_533096.json:
```json
{
    "body": "<a id='comment:28'></a>\nAnother thing: you might have noticed on Cell [7] of the notebook [test_display_latex](https://nbviewer.org/github/egourgoulhon/SageMathTest/blob/master/Notebooks/test_display_latex.ipynb) that in `%display latex` mode, `matplotlib.pyplot.show()` displays `Figure(432x288)` instead of the actual figure. This issue certainly does not pertain to the current ticket. Is there already a ticket for it?",
    "created_at": "2021-11-15T13:17:46Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533096",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:28'></a>
Another thing: you might have noticed on Cell [7] of the notebook [test_display_latex](https://nbviewer.org/github/egourgoulhon/SageMathTest/blob/master/Notebooks/test_display_latex.ipynb) that in `%display latex` mode, `matplotlib.pyplot.show()` displays `Figure(432x288)` instead of the actual figure. This issue certainly does not pertain to the current ticket. Is there already a ticket for it?



---

archive/issue_comments_533097.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [egourgoulhon](#comment%3A28):\n> Another thing: you might have noticed on Cell [7] of the notebook [test_display_latex](https://nbviewer.org/github/egourgoulhon/SageMathTest/blob/master/Notebooks/test_display_latex.ipynb) that in `%display latex` mode, `matplotlib.pyplot.show()` displays `Figure(432x288)` instead of the actual figure. This issue certainly does not pertain to the current ticket. Is there already a ticket for it?\n\n\n#32882 is the new ticket for it.",
    "created_at": "2021-11-16T04:58:57Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533097",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:29'></a>
Replying to [egourgoulhon](#comment%3A28):
> Another thing: you might have noticed on Cell [7] of the notebook [test_display_latex](https://nbviewer.org/github/egourgoulhon/SageMathTest/blob/master/Notebooks/test_display_latex.ipynb) that in `%display latex` mode, `matplotlib.pyplot.show()` displays `Figure(432x288)` instead of the actual figure. This issue certainly does not pertain to the current ticket. Is there already a ticket for it?


#32882 is the new ticket for it.



---

archive/issue_comments_533098.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [klee](#comment%3A29):\n> \n> #32882 is the new ticket for it.\n> \n\nThank you!",
    "created_at": "2021-11-16T09:05:44Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533098",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:30'></a>
Replying to [klee](#comment%3A29):
> 
> #32882 is the new ticket for it.
> 

Thank you!



---

archive/issue_comments_533099.json:
```json
{
    "body": "**Changing branch** from \"[u/klee/32859](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/32859)\" to \"[e9dc5764ed64f34f42ebca1d3849e4927f7d0a96](https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96)\".",
    "created_at": "2021-11-18T23:38:08Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533099",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/klee/32859](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/32859)" to "[e9dc5764ed64f34f42ebca1d3849e4927f7d0a96](https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96)".



---

archive/issue_events_294768.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-18T23:38:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-294768"
}
```



---

archive/issue_events_294769.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-18T23:38:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-294769"
}
```



---

archive/issue_comments_533100.json:
```json
{
    "body": "<a id='comment:32'></a>\nRegarding the above discussion about centered math formulas, a relevant [ask.sagemath question](https://ask.sagemath.org/question/59775/display-latex-makes-output-centered-in-exported-tex-file/) has been posted recently, complaining about centered outputs in LaTeX exports of Jupyter notebooks.  Apparently `\\begin{math}...\\end{math}` has been replaced by `$$...$$` somewhere between Sage 9.3 and 9.4.",
    "created_at": "2021-11-26T13:19:10Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533100",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:32'></a>
Regarding the above discussion about centered math formulas, a relevant [ask.sagemath question](https://ask.sagemath.org/question/59775/display-latex-makes-output-centered-in-exported-tex-file/) has been posted recently, complaining about centered outputs in LaTeX exports of Jupyter notebooks.  Apparently `\begin{math}...\end{math}` has been replaced by `$$...$$` somewhere between Sage 9.3 and 9.4.



---

archive/issue_comments_533101.json:
```json
{
    "body": "**Changing commit** from \"[e9dc5764ed64f34f42ebca1d3849e4927f7d0a96](https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96)\" to \"\".",
    "created_at": "2021-11-26T13:19:10Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533101",
    "user": "https://github.com/egourgoulhon"
}
```

**Changing commit** from "[e9dc5764ed64f34f42ebca1d3849e4927f7d0a96](https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96)" to "".



---

archive/issue_comments_533102.json:
```json
{
    "body": "<a id='comment:33'></a>\nReplying to [egourgoulhon](#comment%3A32):\n> Regarding the above discussion about centered math formulas, a relevant [ask.sagemath question](https://ask.sagemath.org/question/59775/display-latex-makes-output-centered-in-exported-tex-file/) has been posted recently, complaining about centered outputs in LaTeX exports of Jupyter notebooks.  Apparently `\\begin{math}...\\end{math}` has been replaced by `$$...$$` somewhere between Sage 9.3 and 9.4. \n\n\nI don't know how that happened. But it is likely that the behavior was introduced by one of the tickets that I authored.  \n\nAnyway that \"centered\" behavior is consistent with what we see in the jupyterlab. So the question is what behavior we want.",
    "created_at": "2021-11-26T16:35:41Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533102",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:33'></a>
Replying to [egourgoulhon](#comment%3A32):
> Regarding the above discussion about centered math formulas, a relevant [ask.sagemath question](https://ask.sagemath.org/question/59775/display-latex-makes-output-centered-in-exported-tex-file/) has been posted recently, complaining about centered outputs in LaTeX exports of Jupyter notebooks.  Apparently `\begin{math}...\end{math}` has been replaced by `$$...$$` somewhere between Sage 9.3 and 9.4. 


I don't know how that happened. But it is likely that the behavior was introduced by one of the tickets that I authored.  

Anyway that "centered" behavior is consistent with what we see in the jupyterlab. So the question is what behavior we want.



---

archive/issue_comments_533103.json:
```json
{
    "body": "<a id='comment:34'></a>\nReplying to [klee](#comment%3A33):\n> \n> Anyway that \"centered\" behavior is consistent with what we see in the jupyterlab. So the question is what behavior we want. \n\n\nExactly. As I said before (comment:13), I am kind of neutral on that.",
    "created_at": "2021-11-26T16:55:17Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533103",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:34'></a>
Replying to [klee](#comment%3A33):
> 
> Anyway that "centered" behavior is consistent with what we see in the jupyterlab. So the question is what behavior we want. 


Exactly. As I said before (comment:13), I am kind of neutral on that.



---

archive/issue_comments_533104.json:
```json
{
    "body": "<a id='comment:35'></a>\nReplying to [egourgoulhon](#comment%3A34):\n> Exactly. As I said before (comment:13), I am kind of neutral on that.  \n\n\nI prefer flush left. Well, I think users would be divided. A solution would be to introduce an option to control the behavior.",
    "created_at": "2021-11-26T23:09:45Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533104",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:35'></a>
Replying to [egourgoulhon](#comment%3A34):
> Exactly. As I said before (comment:13), I am kind of neutral on that.  


I prefer flush left. Well, I think users would be divided. A solution would be to introduce an option to control the behavior.



---

archive/issue_comments_533105.json:
```json
{
    "body": "<a id='comment:36'></a>\nReplying to [klee](#comment%3A35):\n> A solution would be to introduce an option to control the behavior.\n\n\nThis is now implemented in #32942. Please review.",
    "created_at": "2021-11-27T13:29:47Z",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-533105",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:36'></a>
Replying to [klee](#comment%3A35):
> A solution would be to introduce an option to control the behavior.


This is now implemented in #32942. Please review.
