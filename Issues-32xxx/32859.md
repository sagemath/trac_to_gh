# Issue 32859: Wrong display from type() with %display latex

archive/issues_032622.json:
```json
{
    "assignees": [],
    "body": "In Sage 9.4 and 9.5.beta5, the following cell of a Jupyter notebook\n\n```\n%display latex\ntype(x)\n```\nresults in \n\n```\n\\[\\newcommand{\\Bold}[1]{\\mathbf{#1}}\\verb||\\]\n```\ninstead of \n\n```\n<\ud835\ude8c\ud835\ude95\ud835\ude8a\ud835\ude9c\ud835\ude9c'\ud835\ude9c\ud835\ude8a\ud835\ude90\ud835\ude8e.\ud835\ude9c\ud835\udea2\ud835\ude96\ud835\ude8b\ud835\ude98\ud835\ude95\ud835\ude92\ud835\ude8c.\ud835\ude8e\ud835\udea1\ud835\ude99\ud835\ude9b\ud835\ude8e\ud835\ude9c\ud835\ude9c\ud835\ude92\ud835\ude98\ud835\ude97.\ud835\ude74\ud835\udea1\ud835\ude99\ud835\ude9b\ud835\ude8e\ud835\ude9c\ud835\ude9c\ud835\ude92\ud835\ude98\ud835\ude97'>\n```\nEverything is OK with Sage <= 9.3. \n\nDepends on #32208\n\nCC:  @kwankyu\n\nComponent: **notebook**\n\nKeywords: **jupyter display latex**\n\nAuthor: **Kwankyu Lee**\n\nBranch: **[`e9dc576`](https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96)**\n\nReviewer: **Eric Gourgoulhon**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/32859_\n\n",
    "closed_at": "2021-11-18T23:38:08Z",
    "created_at": "2021-11-12T12:23:06Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20user%20interface",
        "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Wrong display from type() with %display latex",
    "type": "issue",
    "updated_at": "2021-11-27T13:29:47Z",
    "url": "https://github.com/sagemath/sage/issues/32859",
    "user": "https://github.com/egourgoulhon"
}
```
In Sage 9.4 and 9.5.beta5, the following cell of a Jupyter notebook

```
%display latex
type(x)
```
results in 

```
\[\newcommand{\Bold}[1]{\mathbf{#1}}\verb||\]
```
instead of 

```
<𝚌𝚕𝚊𝚜𝚜'𝚜𝚊𝚐𝚎.𝚜𝚢𝚖𝚋𝚘𝚕𝚒𝚌.𝚎𝚡𝚙𝚛𝚎𝚜𝚜𝚒𝚘𝚗.𝙴𝚡𝚙𝚛𝚎𝚜𝚜𝚒𝚘𝚗'>
```
Everything is OK with Sage <= 9.3. 

Depends on #32208

CC:  @kwankyu

Component: **notebook**

Keywords: **jupyter display latex**

Author: **Kwankyu Lee**

Branch: **[`e9dc576`](https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96)**

Reviewer: **Eric Gourgoulhon**

_Issue created by migration from https://trac.sagemath.org/ticket/32859_





---

archive/issue_events_449088.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-11-12T12:23:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-449088"
}
```



---

archive/issue_events_449089.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-11-12T12:23:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20user%20interface",
    "label_color": "0000b0",
    "label_name": "c: user interface",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-449089"
}
```



---

archive/issue_events_449090.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-11-12T12:23:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-449090"
}
```



---

archive/issue_events_449091.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-11-12T12:23:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-449091"
}
```



---

archive/issue_comments_530315.json:
```json
{
    "body": "Author: **Kwankyu Lee**",
    "created_at": "2021-11-12T14:34:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530315",
    "user": "https://github.com/kwankyu"
}
```

Author: **Kwankyu Lee**



---

archive/issue_comments_530316.json:
```json
{
    "body": "Branch: **[u/klee/32859](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/32859)**",
    "created_at": "2021-11-12T14:34:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530316",
    "user": "https://github.com/kwankyu"
}
```

Branch: **[u/klee/32859](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/32859)**



---

archive/issue_comments_530317.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4d021ab87a4a44b2928a25d4d33721018985f62f\"><code>4d021ab</code></a></td><td><code>Convert < to &lt; and back</code></td></tr></table>\n",
    "created_at": "2021-11-12T14:35:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530317",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4d021ab87a4a44b2928a25d4d33721018985f62f"><code>4d021ab</code></a></td><td><code>Convert < to &lt; and back</code></td></tr></table>




---

archive/issue_comments_530318.json:
```json
{
    "body": "Commit: **[`4d021ab`](https://github.com/sagemath/sagetrac-mirror/commit/4d021ab87a4a44b2928a25d4d33721018985f62f)**",
    "created_at": "2021-11-12T14:35:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530318",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`4d021ab`](https://github.com/sagemath/sagetrac-mirror/commit/4d021ab87a4a44b2928a25d4d33721018985f62f)**



---

archive/issue_events_449092.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2021-11-12T14:35:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-449092"
}
```



---

archive/issue_comments_530319.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nThe fix for this ticket is this part:\n\n```diff\n--- a/src/sage/misc/html.py\n+++ b/src/sage/misc/html.py\n@@ -351,15 +351,16 @@ class MathJax:\n             [_Latex_prefs._option['macros']] +\n             parts\n         )\n+        mathjax_string = latex_string.replace('<', '&lt;')\n         if mode == 'display':\n             html = r'<html>\\[{0}\\]</html>'\n         elif mode == 'inline':\n             html = r'<html>\\({0}\\)</html>'\n         elif mode == 'plain':\n-            return latex_string\n+            return mathjax_string\n         else:\n             raise ValueError(\"mode must be either 'display', 'inline', or 'plain'\")\n-        return MathJaxExpr(html.format(latex_string))\n+        return MathJaxExpr(html.format(mathjax_string))\n \n \n class HTMLFragmentFactory(SageObject):\ndiff --git a/src/sage/repl/rich_output/output_browser.py b/src/sage/repl/rich_output/output_browser.py\nindex 2746e3dff8..3d7cda599a 100644\n--- a/src/sage/repl/rich_output/output_browser.py\n+++ b/src/sage/repl/rich_output/output_browser.py\n@@ -40,10 +40,12 @@ class OutputHtml(OutputBase):\n         # pdf export of a notebook\n         m = latex_re.match(html)\n         if m:\n+            mathjax_string = m.group('latex')\n+            latex_string = mathjax_string.replace('&lt;', '<')\n             if m.group('mathstart') == r'\\[' and m.group('mathend') == r'\\]':\n-                self.latex = OutputBuffer('$$' + m.group('latex') + '$$')\n+                self.latex = OutputBuffer('$$' + latex_string + '$$')\n             else:\n-                self.latex = OutputBuffer('$' + m.group('latex') + '$')\n+                self.latex = OutputBuffer('$' + latex_string + '$')\n```",
    "created_at": "2021-11-12T14:36:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530319",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:5" align="right">comment:5</div>

The fix for this ticket is this part:

```diff
--- a/src/sage/misc/html.py
+++ b/src/sage/misc/html.py
@@ -351,15 +351,16 @@ class MathJax:
             [_Latex_prefs._option['macros']] +
             parts
         )
+        mathjax_string = latex_string.replace('<', '&lt;')
         if mode == 'display':
             html = r'<html>\[{0}\]</html>'
         elif mode == 'inline':
             html = r'<html>\({0}\)</html>'
         elif mode == 'plain':
-            return latex_string
+            return mathjax_string
         else:
             raise ValueError("mode must be either 'display', 'inline', or 'plain'")
-        return MathJaxExpr(html.format(latex_string))
+        return MathJaxExpr(html.format(mathjax_string))
 
 
 class HTMLFragmentFactory(SageObject):
diff --git a/src/sage/repl/rich_output/output_browser.py b/src/sage/repl/rich_output/output_browser.py
index 2746e3dff8..3d7cda599a 100644
--- a/src/sage/repl/rich_output/output_browser.py
+++ b/src/sage/repl/rich_output/output_browser.py
@@ -40,10 +40,12 @@ class OutputHtml(OutputBase):
         # pdf export of a notebook
         m = latex_re.match(html)
         if m:
+            mathjax_string = m.group('latex')
+            latex_string = mathjax_string.replace('&lt;', '<')
             if m.group('mathstart') == r'\[' and m.group('mathend') == r'\]':
-                self.latex = OutputBuffer('$$' + m.group('latex') + '$$')
+                self.latex = OutputBuffer('$$' + latex_string + '$$')
             else:
-                self.latex = OutputBuffer('$' + m.group('latex') + '$')
+                self.latex = OutputBuffer('$' + latex_string + '$')
```



---

archive/issue_comments_530320.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nBut I merged the branch of #32208 to the present branch, in order to also fix pdf export problem of the example\n\n```\n%display latex\ntype(x)\n```\nof this ticket.",
    "created_at": "2021-11-12T14:39:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530320",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:6" align="right">comment:6</div>

But I merged the branch of #32208 to the present branch, in order to also fix pdf export problem of the example

```
%display latex
type(x)
```
of this ticket.



---

archive/issue_comments_530321.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nAs always, please watch for any unexpected side effects in display and printing...",
    "created_at": "2021-11-12T14:42:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530321",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:7" align="right">comment:7</div>

As always, please watch for any unexpected side effects in display and printing...



---

archive/issue_comments_530322.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba099ec02228f44a7923a81f27aaad760e948fff\"><code>ba099ec</code></a></td><td><code>Fix doctests</code></td></tr></table>\n",
    "created_at": "2021-11-12T14:54:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530322",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba099ec02228f44a7923a81f27aaad760e948fff"><code>ba099ec</code></a></td><td><code>Fix doctests</code></td></tr></table>




---

archive/issue_comments_530323.json:
```json
{
    "body": "Changed commit from **[`4d021ab`](https://github.com/sagemath/sagetrac-mirror/commit/4d021ab87a4a44b2928a25d4d33721018985f62f)** to **[`ba099ec`](https://github.com/sagemath/sagetrac-mirror/commit/ba099ec02228f44a7923a81f27aaad760e948fff)**",
    "created_at": "2021-11-12T14:54:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530323",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4d021ab`](https://github.com/sagemath/sagetrac-mirror/commit/4d021ab87a4a44b2928a25d4d33721018985f62f)** to **[`ba099ec`](https://github.com/sagemath/sagetrac-mirror/commit/ba099ec02228f44a7923a81f27aaad760e948fff)**



---

archive/issue_comments_530324.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThank you very much for the prompt fix! I am setting #32208 as a dependency because of [comment:6](#comment%3A6) and I am going to test both tickets.",
    "created_at": "2021-11-13T10:32:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530324",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:9" align="right">comment:9</div>

Thank you very much for the prompt fix! I am setting #32208 as a dependency because of [comment:6](#comment%3A6) and I am going to test both tickets.



---

archive/issue_comments_530325.json:
```json
{
    "body": "Dependencies: **#32208**",
    "created_at": "2021-11-13T10:32:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530325",
    "user": "https://github.com/egourgoulhon"
}
```

Dependencies: **#32208**



---

archive/issue_events_449093.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-11-13T10:32:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-449093"
}
```



---

archive/issue_events_449094.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-11-13T10:32:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
    "label_color": "ff7700",
    "label_name": "p: critical / 2",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-449094"
}
```



---

archive/issue_events_449095.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-11-13T13:38:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-449095"
}
```



---

archive/issue_events_449096.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2021-11-13T13:38:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-449096"
}
```



---

archive/issue_comments_530326.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nAs for #32208, I've tested the fix with these notebooks: [test_display_latex](https://nbviewer.org/github/egourgoulhon/SageMathTest/blob/master/Notebooks/test_display_latex.ipynb), [SM_Kerr_surfaces](https://nbviewer.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_Kerr_surfaces.ipynb) and [SM_spheres_S2](https://nbviewer.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_sphere_S2.ipynb). Everything seems OK. Thank you very much.",
    "created_at": "2021-11-13T13:38:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530326",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:10" align="right">comment:10</div>

As for #32208, I've tested the fix with these notebooks: [test_display_latex](https://nbviewer.org/github/egourgoulhon/SageMathTest/blob/master/Notebooks/test_display_latex.ipynb), [SM_Kerr_surfaces](https://nbviewer.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_Kerr_surfaces.ipynb) and [SM_spheres_S2](https://nbviewer.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_sphere_S2.ipynb). Everything seems OK. Thank you very much.



---

archive/issue_comments_530327.json:
```json
{
    "body": "Reviewer: **Eric Gourgoulhon**",
    "created_at": "2021-11-13T13:38:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530327",
    "user": "https://github.com/egourgoulhon"
}
```

Reviewer: **Eric Gourgoulhon**



---

archive/issue_comments_530328.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThank you.",
    "created_at": "2021-11-13T23:23:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530328",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:11" align="right">comment:11</div>

Thank you.



---

archive/issue_comments_530329.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThis is an off-topic, but your notebooks show latex expressions flush left. As far as I know, latex expressions are displayed centered by default. I don't know how you did it. Anyway, I think latex expressions should be shown flush left by default. What do you think?",
    "created_at": "2021-11-13T23:53:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530329",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:12" align="right">comment:12</div>

This is an off-topic, but your notebooks show latex expressions flush left. As far as I know, latex expressions are displayed centered by default. I don't know how you did it. Anyway, I think latex expressions should be shown flush left by default. What do you think?



---

archive/issue_comments_530330.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@kwankyu](#comment%3A12):\n> This is an off-topic, but your notebooks show latex expressions flush left. As far as I know, latex expressions are displayed centered by default. I don't know how you did it. \n\nI did nothing special. Latex expressions have always been flushed left on my notebooks since the introduction of Jupyter in Sage. Are they centered on your computer? The only thing I've noticed is that when run on CoCalc, the very same notebook has latex expression centered, see e.g. this [example](https://cocalc.com/share/public_paths/6850015be0320058cadba1ce63e7a3eedf4eef89).\n>Anyway, I think latex expressions should be shown flush left by default. What do you think?\n\nI don't have any strong opinion on that, but I agree with you: flush left is usually what we have in published articles.",
    "created_at": "2021-11-14T08:52:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530330",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@kwankyu](#comment%3A12):
> This is an off-topic, but your notebooks show latex expressions flush left. As far as I know, latex expressions are displayed centered by default. I don't know how you did it. 

I did nothing special. Latex expressions have always been flushed left on my notebooks since the introduction of Jupyter in Sage. Are they centered on your computer? The only thing I've noticed is that when run on CoCalc, the very same notebook has latex expression centered, see e.g. this [example](https://cocalc.com/share/public_paths/6850015be0320058cadba1ce63e7a3eedf4eef89).
>Anyway, I think latex expressions should be shown flush left by default. What do you think?

I don't have any strong opinion on that, but I agree with you: flush left is usually what we have in published articles.



---

archive/issue_comments_530331.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@egourgoulhon](#comment%3A13):\n> I did nothing special. Latex expressions have always been flushed left on my notebooks since the introduction of Jupyter in Sage. Are they centered on your computer? \n\nYes. It is mysterious to me since I know that latex expressions are centered because they are enclosed by `\\[...\\]`.\n\n> >Anyway, I think latex expressions should be shown flush left by default. What do you think?\n\n> I don't have any strong opinion on that, but I agree with you: flush left is usually what we have in published articles.\n\nOkay. Thank you.",
    "created_at": "2021-11-14T10:14:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530331",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@egourgoulhon](#comment%3A13):
> I did nothing special. Latex expressions have always been flushed left on my notebooks since the introduction of Jupyter in Sage. Are they centered on your computer? 

Yes. It is mysterious to me since I know that latex expressions are centered because they are enclosed by `\[...\]`.

> >Anyway, I think latex expressions should be shown flush left by default. What do you think?

> I don't have any strong opinion on that, but I agree with you: flush left is usually what we have in published articles.

Okay. Thank you.



---

archive/issue_comments_530332.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nMerge conflict",
    "created_at": "2021-11-14T17:09:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530332",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:15" align="right">comment:15</div>

Merge conflict



---

archive/issue_events_449097.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-14T17:09:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-449097"
}
```



---

archive/issue_events_449098.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-14T17:09:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-449098"
}
```



---

archive/issue_comments_530333.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@kwankyu](#comment%3A14):\n> Replying to [@egourgoulhon](#comment%3A13):\n> > I did nothing special. Latex expressions have always been flushed left on my notebooks since the introduction of Jupyter in Sage. Are they centered on your computer? \n\n> \n> Yes. It is mysterious to me since I know that latex expressions are centered because they are enclosed by `\\[...\\]`.\n\nThis is strange indeed... Maybe it's a matter of OS? What is yours? Mine is Ubuntu 20.04. I've always had flushed left expressions on all the computers I've used (all running various versions of Ubuntu). It could also be related to the locale (fr_FR in my case). The centered rendering on CoCalc does not surprise me further because their Jupyter is somehow customized.",
    "created_at": "2021-11-14T20:35:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530333",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@kwankyu](#comment%3A14):
> Replying to [@egourgoulhon](#comment%3A13):
> > I did nothing special. Latex expressions have always been flushed left on my notebooks since the introduction of Jupyter in Sage. Are they centered on your computer? 

> 
> Yes. It is mysterious to me since I know that latex expressions are centered because they are enclosed by `\[...\]`.

This is strange indeed... Maybe it's a matter of OS? What is yours? Mine is Ubuntu 20.04. I've always had flushed left expressions on all the computers I've used (all running various versions of Ubuntu). It could also be related to the locale (fr_FR in my case). The centered rendering on CoCalc does not surprise me further because their Jupyter is somehow customized.



---

archive/issue_comments_530334.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@vbraun](#comment%3A15):\n> Merge conflict\n\nI guess we have to wait for 9.5.beta7 to solve that one.",
    "created_at": "2021-11-14T20:36:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530334",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@vbraun](#comment%3A15):
> Merge conflict

I guess we have to wait for 9.5.beta7 to solve that one.



---

archive/issue_comments_530335.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7a5b112c93d9431968d85a9c38bb0e63efc5e2e8\"><code>7a5b112</code></a></td><td><code>Merge branch 'develop' into wrong-display-trac32859</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b0bbc1e887c05fe2c8b05089cdf15fe21c0156a0\"><code>b0bbc1e</code></a></td><td><code>Remove unnecessary spacer code</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/656a8d3c6f9088e1c126a5b69b630a2c70bbe890\"><code>656a8d3</code></a></td><td><code>Fix doctest failures</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96\"><code>e9dc576</code></a></td><td><code>Merge branch 'mathjax-trac32208' into wrong-display-trac32859</code></td></tr></table>\n",
    "created_at": "2021-11-15T01:06:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530335",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7a5b112c93d9431968d85a9c38bb0e63efc5e2e8"><code>7a5b112</code></a></td><td><code>Merge branch 'develop' into wrong-display-trac32859</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b0bbc1e887c05fe2c8b05089cdf15fe21c0156a0"><code>b0bbc1e</code></a></td><td><code>Remove unnecessary spacer code</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/656a8d3c6f9088e1c126a5b69b630a2c70bbe890"><code>656a8d3</code></a></td><td><code>Fix doctest failures</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96"><code>e9dc576</code></a></td><td><code>Merge branch 'mathjax-trac32208' into wrong-display-trac32859</code></td></tr></table>




---

archive/issue_comments_530336.json:
```json
{
    "body": "Changed commit from **[`ba099ec`](https://github.com/sagemath/sagetrac-mirror/commit/ba099ec02228f44a7923a81f27aaad760e948fff)** to **[`e9dc576`](https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96)**",
    "created_at": "2021-11-15T01:06:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530336",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ba099ec`](https://github.com/sagemath/sagetrac-mirror/commit/ba099ec02228f44a7923a81f27aaad760e948fff)** to **[`e9dc576`](https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96)**



---

archive/issue_comments_530337.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nResolved merge conflict",
    "created_at": "2021-11-15T01:07:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530337",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:19" align="right">comment:19</div>

Resolved merge conflict



---

archive/issue_events_449099.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2021-11-15T01:07:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-449099"
}
```



---

archive/issue_events_449100.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2021-11-15T01:07:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-449100"
}
```



---

archive/issue_comments_530338.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@egourgoulhon](#comment%3A16):\n> This is strange indeed... Maybe it's a matter of OS? What is yours? Mine is Ubuntu 20.04.\n\nMine is Mac OS. \n\n> I've always had flushed left expressions on all the computers I've used (all running various versions of Ubuntu). It could also be related to the locale (fr_FR in my case). \n\nPossibly. I don't know. If you open the notebook in editor (by right-clicking it), then you can see the raw data. Mine shows\n\n```\n    {\n     \"data\": {\n      \"text/html\": [\n       \"<html>\\\\[\\\\newcommand{\\\\Bold}[1]{\\\\mathbf{#1}}\\\\verb|&lt;class|\\\\verb| |\\\\verb|'sage.symbolic.expression.Expression'>|\\\\]</html>\"\n      ],\n      \"text/latex\": [\n       \"$$\\\\newcommand{\\\\Bold}[1]{\\\\mathbf{#1}}\\\\verb|<class|\\\\verb| |\\\\verb|'sage.symbolic.expression.Expression'>|$$\"\n      ],\n      \"text/plain\": [\n       \"<class 'sage.symbolic.expression.Expression'>\"\n      ]\n     }\n```\nfor `type(x)` cell. You see `\\\\[` and `$$`. How about yours?",
    "created_at": "2021-11-15T01:15:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530338",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@egourgoulhon](#comment%3A16):
> This is strange indeed... Maybe it's a matter of OS? What is yours? Mine is Ubuntu 20.04.

Mine is Mac OS. 

> I've always had flushed left expressions on all the computers I've used (all running various versions of Ubuntu). It could also be related to the locale (fr_FR in my case). 

Possibly. I don't know. If you open the notebook in editor (by right-clicking it), then you can see the raw data. Mine shows

```
    {
     "data": {
      "text/html": [
       "<html>\\[\\newcommand{\\Bold}[1]{\\mathbf{#1}}\\verb|&lt;class|\\verb| |\\verb|'sage.symbolic.expression.Expression'>|\\]</html>"
      ],
      "text/latex": [
       "$$\\newcommand{\\Bold}[1]{\\mathbf{#1}}\\verb|<class|\\verb| |\\verb|'sage.symbolic.expression.Expression'>|$$"
      ],
      "text/plain": [
       "<class 'sage.symbolic.expression.Expression'>"
      ]
     }
```
for `type(x)` cell. You see `\\[` and `$$`. How about yours?



---

archive/issue_comments_530339.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI directly checked your notebooks. They are the same, the same `\\\\[` and `$$`.",
    "created_at": "2021-11-15T01:22:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530339",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:21" align="right">comment:21</div>

I directly checked your notebooks. They are the same, the same `\\[` and `$$`.



---

archive/issue_comments_530340.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI downloaded your notebook to open it in my jupyterlab. Now latex expressions are centered. In nbviewer, they are rendered by mathjax 2.7.1. My jupyterlab uses mathjax 2.7.9. It might be a bug of mathjax 2.7.1...",
    "created_at": "2021-11-15T01:37:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530340",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:22" align="right">comment:22</div>

I downloaded your notebook to open it in my jupyterlab. Now latex expressions are centered. In nbviewer, they are rendered by mathjax 2.7.1. My jupyterlab uses mathjax 2.7.9. It might be a bug of mathjax 2.7.1...



---

archive/issue_comments_530341.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@kwankyu](#comment%3A22):\n> I downloaded your notebook to open it in my jupyterlab. Now latex expressions are centered. In nbviewer, they are rendered by mathjax 2.7.1. My jupyterlab uses mathjax 2.7.9. It might be a bug of mathjax 2.7.1... \n\nMy Jupyter notebook uses Mathjax 2.7.9 as well. However, if I right-click on a displayed expression to open the Mathjax contextual menu and choose `Math Settings -> Math Redender`, I see that `HTML-CSS` is selected; if I select `MathML` instead, I get a warning:\n\n```\nYour browser's native MathML does not implement all the features used by MathJax, \nso some expressions may not render properly.\n```\nbut then all the formulas in the notebook become centered! Moreover, the Rubik's cube is then correctly displayed. \n\nThe above is for Firefox (my default browser). If I do the same thing with Chrome (where initially all LaTeX expressions are left-flushed as well), I got the same warning when switching from `HTML-CSS` to `MathML`, but then, instead of LaTeX rendering, the literal code is displayed,\ne.g. \n\n```\n\\newcommand{\\Bold}[1]{\\mathbf{#1}}\\sin\\left(x^{2}\\right)\n```\nfor the first formula.",
    "created_at": "2021-11-15T08:35:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530341",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@kwankyu](#comment%3A22):
> I downloaded your notebook to open it in my jupyterlab. Now latex expressions are centered. In nbviewer, they are rendered by mathjax 2.7.1. My jupyterlab uses mathjax 2.7.9. It might be a bug of mathjax 2.7.1... 

My Jupyter notebook uses Mathjax 2.7.9 as well. However, if I right-click on a displayed expression to open the Mathjax contextual menu and choose `Math Settings -> Math Redender`, I see that `HTML-CSS` is selected; if I select `MathML` instead, I get a warning:

```
Your browser's native MathML does not implement all the features used by MathJax, 
so some expressions may not render properly.
```
but then all the formulas in the notebook become centered! Moreover, the Rubik's cube is then correctly displayed. 

The above is for Firefox (my default browser). If I do the same thing with Chrome (where initially all LaTeX expressions are left-flushed as well), I got the same warning when switching from `HTML-CSS` to `MathML`, but then, instead of LaTeX rendering, the literal code is displayed,
e.g. 

```
\newcommand{\Bold}[1]{\mathbf{#1}}\sin\left(x^{2}\right)
```
for the first formula.



---

archive/issue_comments_530342.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@egourgoulhon](#comment%3A23):\n> My Jupyter notebook uses Mathjax 2.7.9 as well. However, if I right-click on a displayed expression to open the Mathjax contextual menu and choose `Math Settings -> Math Redender`, I see that `HTML-CSS` is selected; if I select `MathML` instead, I get a warning:\n> \n> ```\n> Your browser's native MathML does not implement all the features used by MathJax, \n> so some expressions may not render properly.\n> ```\n> but then all the formulas in the notebook become centered! Moreover, the Rubik's cube is then correctly displayed. \n\nI experience all the same except that with HTML-CSS renderer, latex expressions are still centered.",
    "created_at": "2021-11-15T08:44:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530342",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@egourgoulhon](#comment%3A23):
> My Jupyter notebook uses Mathjax 2.7.9 as well. However, if I right-click on a displayed expression to open the Mathjax contextual menu and choose `Math Settings -> Math Redender`, I see that `HTML-CSS` is selected; if I select `MathML` instead, I get a warning:
> 
> ```
> Your browser's native MathML does not implement all the features used by MathJax, 
> so some expressions may not render properly.
> ```
> but then all the formulas in the notebook become centered! Moreover, the Rubik's cube is then correctly displayed. 

I experience all the same except that with HTML-CSS renderer, latex expressions are still centered.



---

archive/issue_comments_530343.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nWith Firefox on my mac, all the same (centered displays).",
    "created_at": "2021-11-15T08:51:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530343",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:25" align="right">comment:25</div>

With Firefox on my mac, all the same (centered displays).



---

archive/issue_comments_530344.json:
```json
{
    "body": "Jupyter screenshot",
    "created_at": "2021-11-15T08:58:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530344",
    "user": "https://github.com/kwankyu"
}
```

Jupyter screenshot



---

archive/issue_comments_530345.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nAttachment: **[Screen Shot 2021-11-15 at 5.55.59 PM.png](https://github.com/sagemath/sage/files/ticket32859/09a649b92333fbe51c39a038ef382731.png)**\n\nAnother data point: when running Jupyterlab on my computer (via `sage -n jupyterlab`), latex expressions are centered. So there is a difference of behavior between the Jupyter notebook and Jupyterlab.",
    "created_at": "2021-11-15T10:20:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530345",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:26" align="right">comment:26</div>

Attachment: **[Screen Shot 2021-11-15 at 5.55.59 PM.png](https://github.com/sagemath/sage/files/ticket32859/09a649b92333fbe51c39a038ef382731.png)**

Another data point: when running Jupyterlab on my computer (via `sage -n jupyterlab`), latex expressions are centered. So there is a difference of behavior between the Jupyter notebook and Jupyterlab.



---

archive/issue_comments_530346.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@egourgoulhon](#comment%3A26):\n> Another data point: when running Jupyterlab on my computer (via `sage -n jupyterlab`), latex expressions are centered. So there is a difference of behavior between the Jupyter notebook and Jupyterlab.\n\nRight. Me too. So it is a difference between jupyter notebook and jupyterlab!",
    "created_at": "2021-11-15T10:47:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530346",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@egourgoulhon](#comment%3A26):
> Another data point: when running Jupyterlab on my computer (via `sage -n jupyterlab`), latex expressions are centered. So there is a difference of behavior between the Jupyter notebook and Jupyterlab.

Right. Me too. So it is a difference between jupyter notebook and jupyterlab!



---

archive/issue_comments_530347.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nAnother thing: you might have noticed on Cell [7] of the notebook [test_display_latex](https://nbviewer.org/github/egourgoulhon/SageMathTest/blob/master/Notebooks/test_display_latex.ipynb) that in `%display latex` mode, `matplotlib.pyplot.show()` displays `Figure(432x288)` instead of the actual figure. This issue certainly does not pertain to the current ticket. Is there already a ticket for it?",
    "created_at": "2021-11-15T13:17:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530347",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:28" align="right">comment:28</div>

Another thing: you might have noticed on Cell [7] of the notebook [test_display_latex](https://nbviewer.org/github/egourgoulhon/SageMathTest/blob/master/Notebooks/test_display_latex.ipynb) that in `%display latex` mode, `matplotlib.pyplot.show()` displays `Figure(432x288)` instead of the actual figure. This issue certainly does not pertain to the current ticket. Is there already a ticket for it?



---

archive/issue_comments_530348.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@egourgoulhon](#comment%3A28):\n> Another thing: you might have noticed on Cell [7] of the notebook [test_display_latex](https://nbviewer.org/github/egourgoulhon/SageMathTest/blob/master/Notebooks/test_display_latex.ipynb) that in `%display latex` mode, `matplotlib.pyplot.show()` displays `Figure(432x288)` instead of the actual figure. This issue certainly does not pertain to the current ticket. Is there already a ticket for it?\n\n#32882 is the new ticket for it.",
    "created_at": "2021-11-16T04:58:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530348",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@egourgoulhon](#comment%3A28):
> Another thing: you might have noticed on Cell [7] of the notebook [test_display_latex](https://nbviewer.org/github/egourgoulhon/SageMathTest/blob/master/Notebooks/test_display_latex.ipynb) that in `%display latex` mode, `matplotlib.pyplot.show()` displays `Figure(432x288)` instead of the actual figure. This issue certainly does not pertain to the current ticket. Is there already a ticket for it?

#32882 is the new ticket for it.



---

archive/issue_comments_530349.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@kwankyu](#comment%3A29):\n> \n> #32882 is the new ticket for it.\n> \n\nThank you!",
    "created_at": "2021-11-16T09:05:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530349",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@kwankyu](#comment%3A29):
> 
> #32882 is the new ticket for it.
> 

Thank you!



---

archive/issue_comments_530350.json:
```json
{
    "body": "Changed branch from **[u/klee/32859](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/32859)** to **[`e9dc576`](https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96)**",
    "created_at": "2021-11-18T23:38:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530350",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/klee/32859](https://github.com/sagemath/sagetrac-mirror/tree/u/klee/32859)** to **[`e9dc576`](https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96)**



---

archive/issue_events_449101.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-18T23:38:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-449101"
}
```



---

archive/issue_events_449102.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "8b54c36d5e03f1724a690ca67bf10a5282208326",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-11-18T23:38:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32859#event-449102"
}
```



---

archive/issue_comments_530351.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nRegarding the above discussion about centered math formulas, a relevant [ask.sagemath question](https://ask.sagemath.org/question/59775/display-latex-makes-output-centered-in-exported-tex-file/) has been posted recently, complaining about centered outputs in LaTeX exports of Jupyter notebooks.  Apparently `\\begin{math}...\\end{math}` has been replaced by `$$...$$` somewhere between Sage 9.3 and 9.4.",
    "created_at": "2021-11-26T13:19:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530351",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:32" align="right">comment:32</div>

Regarding the above discussion about centered math formulas, a relevant [ask.sagemath question](https://ask.sagemath.org/question/59775/display-latex-makes-output-centered-in-exported-tex-file/) has been posted recently, complaining about centered outputs in LaTeX exports of Jupyter notebooks.  Apparently `\begin{math}...\end{math}` has been replaced by `$$...$$` somewhere between Sage 9.3 and 9.4.



---

archive/issue_comments_530352.json:
```json
{
    "body": "Changed commit from **[`e9dc576`](https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96)** to none",
    "created_at": "2021-11-26T13:19:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530352",
    "user": "https://github.com/egourgoulhon"
}
```

Changed commit from **[`e9dc576`](https://github.com/sagemath/sagetrac-mirror/commit/e9dc5764ed64f34f42ebca1d3849e4927f7d0a96)** to none



---

archive/issue_comments_530353.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@egourgoulhon](#comment%3A32):\n> Regarding the above discussion about centered math formulas, a relevant [ask.sagemath question](https://ask.sagemath.org/question/59775/display-latex-makes-output-centered-in-exported-tex-file/) has been posted recently, complaining about centered outputs in LaTeX exports of Jupyter notebooks.  Apparently `\\begin{math}...\\end{math}` has been replaced by `$$...$$` somewhere between Sage 9.3 and 9.4. \n\nI don't know how that happened. But it is likely that the behavior was introduced by one of the tickets that I authored.  \n\nAnyway that \"centered\" behavior is consistent with what we see in the jupyterlab. So the question is what behavior we want.",
    "created_at": "2021-11-26T16:35:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530353",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@egourgoulhon](#comment%3A32):
> Regarding the above discussion about centered math formulas, a relevant [ask.sagemath question](https://ask.sagemath.org/question/59775/display-latex-makes-output-centered-in-exported-tex-file/) has been posted recently, complaining about centered outputs in LaTeX exports of Jupyter notebooks.  Apparently `\begin{math}...\end{math}` has been replaced by `$$...$$` somewhere between Sage 9.3 and 9.4. 

I don't know how that happened. But it is likely that the behavior was introduced by one of the tickets that I authored.  

Anyway that "centered" behavior is consistent with what we see in the jupyterlab. So the question is what behavior we want.



---

archive/issue_comments_530354.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@kwankyu](#comment%3A33):\n> \n> Anyway that \"centered\" behavior is consistent with what we see in the jupyterlab. So the question is what behavior we want. \n\nExactly. As I said before (comment:13), I am kind of neutral on that.",
    "created_at": "2021-11-26T16:55:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530354",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@kwankyu](#comment%3A33):
> 
> Anyway that "centered" behavior is consistent with what we see in the jupyterlab. So the question is what behavior we want. 

Exactly. As I said before (comment:13), I am kind of neutral on that.



---

archive/issue_comments_530355.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nReplying to [@egourgoulhon](#comment%3A34):\n> Exactly. As I said before (comment:13), I am kind of neutral on that.  \n\nI prefer flush left. Well, I think users would be divided. A solution would be to introduce an option to control the behavior.",
    "created_at": "2021-11-26T23:09:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530355",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:35" align="right">comment:35</div>

Replying to [@egourgoulhon](#comment%3A34):
> Exactly. As I said before (comment:13), I am kind of neutral on that.  

I prefer flush left. Well, I think users would be divided. A solution would be to introduce an option to control the behavior.



---

archive/issue_comments_530356.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@kwankyu](#comment%3A35):\n> A solution would be to introduce an option to control the behavior.\n\nThis is now implemented in #32942. Please review.",
    "created_at": "2021-11-27T13:29:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32859",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32859#issuecomment-530356",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@kwankyu](#comment%3A35):
> A solution would be to introduce an option to control the behavior.

This is now implemented in #32942. Please review.
