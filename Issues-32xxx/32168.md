# Issue 32168: Fix conversion between spaces of modular forms

archive/issues_031931.json:
```json
{
    "body": "Currently we have the following:\n\n```\nsage: M0 = ModularForms(Gamma0(8), 10)\nsage: M1 = ModularForms(Gamma1(8), 10)\nsage: M1.has_coerce_map_from(M0)\nTrue\nsage: f = M0.0; g = M1.0\nsage: f + g\nTraceback (most recent call last):\n...\nTypeError: unsupported operand parent(s) for +: 'Modular Forms space of dimension 11 for Congruence Subgroup Gamma0(8) of weight 10 over Rational Field' and 'Modular Forms space of dimension 21 for Congruence Subgroup Gamma1(8) of weight 10 over Rational Field'\n```\n\nMoreover:\n\n```\nsage: M1(f)\nTraceback (most recent call last):\n...\nTypeError: entries must be a list of length 21\n```\n\nThe goal of this ticket is to fix these issues. The origin of the present ticket is from #31559.\n\nCC:  @videlec\n\nKeywords: modular forms coercion gsoc2021\n\nBranch/Commit: 2daca4e543da3c025077499abbcf2a7ac6a477b6\n\nReviewer: Vincent Delecroix\n\nAuthor: David Ayotte\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/32168\n\n",
    "closed_at": "2021-07-24T15:28:00Z",
    "created_at": "2021-07-09T14:59:41Z",
    "labels": [
        "component: modular forms",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Fix conversion between spaces of modular forms",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32168",
    "user": "https://github.com/DavidAyotte"
}
```
Currently we have the following:

```
sage: M0 = ModularForms(Gamma0(8), 10)
sage: M1 = ModularForms(Gamma1(8), 10)
sage: M1.has_coerce_map_from(M0)
True
sage: f = M0.0; g = M1.0
sage: f + g
Traceback (most recent call last):
...
TypeError: unsupported operand parent(s) for +: 'Modular Forms space of dimension 11 for Congruence Subgroup Gamma0(8) of weight 10 over Rational Field' and 'Modular Forms space of dimension 21 for Congruence Subgroup Gamma1(8) of weight 10 over Rational Field'
```

Moreover:

```
sage: M1(f)
Traceback (most recent call last):
...
TypeError: entries must be a list of length 21
```

The goal of this ticket is to fix these issues. The origin of the present ticket is from #31559.

CC:  @videlec

Keywords: modular forms coercion gsoc2021

Branch/Commit: 2daca4e543da3c025077499abbcf2a7ac6a477b6

Reviewer: Vincent Delecroix

Author: David Ayotte

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/32168





---

archive/issue_comments_487008.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-09T15:06:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32168#issuecomment-487008",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_487009.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-07-09T15:09:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32168#issuecomment-487009",
    "user": "https://github.com/DavidAyotte"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_487010.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -21,7 +21,7 @@\n TypeError: entries must be a list of length 21\n \\`\\`\\`\n \n-The goal of this ticket is to fix this issue.\n+The goal of this ticket is to fix these issues. The origin of the present ticket is from #31559.\n \n Comment: 1\n \n```\n",
    "created_at": "2021-07-09T15:23:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32168#issuecomment-487010",
    "user": "https://github.com/DavidAyotte"
}
```

Description changed:
```diff
--- 
+++ 
@@ -21,7 +21,7 @@
 TypeError: entries must be a list of length 21
 \`\`\`
 
-The goal of this ticket is to fix this issue.
+The goal of this ticket is to fix these issues. The origin of the present ticket is from #31559.
 
 Comment: 1
 
```




---

archive/issue_comments_487011.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-09T20:58:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32168#issuecomment-487011",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_487012.json:
```json
{
    "body": "<a id='comment:6'></a>You forgot to set the \"Author\" field of the ticket description.",
    "created_at": "2021-07-12T13:44:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32168#issuecomment-487012",
    "user": "https://github.com/videlec"
}
```

<a id='comment:6'></a>You forgot to set the "Author" field of the ticket description.



---

archive/issue_comments_487013.json:
```json
{
    "body": "<a id='comment:8'></a>In `_element_constructor_`, you can safely remove the test\n\n```\nif x.parent() is self:\n    return x\n```\nThe above is taken care of by `Parent.__call__` (which delegates the call to `_element_constructor_` when it is needed).",
    "created_at": "2021-07-12T13:45:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32168#issuecomment-487013",
    "user": "https://github.com/videlec"
}
```

<a id='comment:8'></a>In `_element_constructor_`, you can safely remove the test

```
if x.parent() is self:
    return x
```
The above is taken care of by `Parent.__call__` (which delegates the call to `_element_constructor_` when it is needed).



---

archive/issue_comments_487014.json:
```json
{
    "body": "<a id='comment:9'></a>One these two things are fixed, we can set to positive review.",
    "created_at": "2021-07-12T15:18:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32168#issuecomment-487014",
    "user": "https://github.com/videlec"
}
```

<a id='comment:9'></a>One these two things are fixed, we can set to positive review.



---

archive/issue_comments_487015.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-12T15:20:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32168#issuecomment-487015",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_487016.json:
```json
{
    "body": "<a id='comment:12'></a>I can not reproduce the patchbot failures that seems unrelated.",
    "created_at": "2021-07-14T09:02:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32168#issuecomment-487016",
    "user": "https://github.com/videlec"
}
```

<a id='comment:12'></a>I can not reproduce the patchbot failures that seems unrelated.



---

archive/issue_comments_487017.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-07-14T09:02:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32168#issuecomment-487017",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_085187.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-07-24T15:28:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32168",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32168#event-85187"
}
```



---

archive/issue_comments_487018.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-07-24T15:28:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32168",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32168#issuecomment-487018",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
