# Issue 32367: Replace Lazy Power Series in species directory

archive/issues_032130.json:
```json
{
    "body": "In this ticket we finalize the implementation of lazy series, and replace the old lazy series framework.\n\n\nCC:  @mantepse @tscrim paul zimmermann tmonteil\n\nKeywords: LazyPowerSeries, FormalSeries, gsoc2021\n\nBranch/Commit: [4fc981b458f8d628684decf221618911ace06333](https://github.com/sagemath/sagetrac-mirror/commit/4fc981b458f8d628684decf221618911ace06333)\n\nReviewer: Martin Rubey, Travis Scrimshaw\n\nAuthor: Tejasvi Chebrolu, Martin Rubey, Travis Scrimshaw\n\nDependencies: #34423\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/32367\n\n",
    "closed_at": "2022-10-11T09:14:50Z",
    "created_at": "2021-08-11T16:14:19Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Replace Lazy Power Series in species directory",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32367",
    "user": "https://github.com/tejasvicsr1"
}
```
In this ticket we finalize the implementation of lazy series, and replace the old lazy series framework.


CC:  @mantepse @tscrim paul zimmermann tmonteil

Keywords: LazyPowerSeries, FormalSeries, gsoc2021

Branch/Commit: [4fc981b458f8d628684decf221618911ace06333](https://github.com/sagemath/sagetrac-mirror/commit/4fc981b458f8d628684decf221618911ace06333)

Reviewer: Martin Rubey, Travis Scrimshaw

Author: Tejasvi Chebrolu, Martin Rubey, Travis Scrimshaw

Dependencies: #34423

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/32367





---

archive/issue_comments_644524.json:
```json
{
    "body": "Changing branch from \"\" to \"u/gh-tejasvicsr1/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series\"",
    "created_at": "2021-08-11T18:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644524",
    "user": "https://github.com/tejasvicsr1"
}
```

Changing branch from "" to "u/gh-tejasvicsr1/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series"



---

archive/issue_comments_644525.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n|                                                                                                                                           |                                                                                                                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|\n|[651b372](https://github.com/sagemath/sagetrac-mirror/commit/651b3725402fa4ba485671133be73ec9765c31a9)|`Revert \"Merge branch 'u/gh-tejasvicsr1/special_functions_for_lazy_series' of git://trac.sagemath.org/sage into t/32324/lazy_taylor_series\"`|\n|[7c9a5dd](https://github.com/sagemath/sagetrac-mirror/commit/7c9a5dda12e03ffb2a3b32e4008650190634cebb)|`fix invert`|\n|[51357a0](https://github.com/sagemath/sagetrac-mirror/commit/51357a03296b07460be7b36a03e4f3dd3ebe04c6)|`Small reworkings and fixes. Adding another composition test.`|\n|[7501204](https://github.com/sagemath/sagetrac-mirror/commit/7501204e1bd216361a395824d2bff70acc8962da)|`Adding documentation to the user-facing class level documentation.`|\n|[4723f6b](https://github.com/sagemath/sagetrac-mirror/commit/4723f6bc6002985ae0d0592f45d8c840af8dd200)|`Refactoring we discussed at the meeting today.`|\n|[651c3ed](https://github.com/sagemath/sagetrac-mirror/commit/651c3eddc75238ce607052adac7f2d2950cd6f7c)|`only get coefficient if necessary`|\n|[65e604d](https://github.com/sagemath/sagetrac-mirror/commit/65e604d9b05def80d870e7103b41070c268aff41)|`Merge branch 'u/mantepse/dense_lls-31897' of git://trac.sagemath.org/sage into t/32324/lazy_taylor_series`|\n|[b332728](https://github.com/sagemath/sagetrac-mirror/commit/b3327282df6f49d2367c5703a9b72433f5fe06ce)|`fix and document series reversion`|\n|[6a2391e](https://github.com/sagemath/sagetrac-mirror/commit/6a2391ed602221387f1344a266d6fe5bcc9df83e)|`Merge remote-tracking branch 'trac/u/mantepse/lazy_taylor_series' into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|\n|[0d56b02](https://github.com/sagemath/sagetrac-mirror/commit/0d56b0227713d7a6b26612593b311071a05782b8)|`Merged new Taylor series and deleted new_gs.py`|",
    "created_at": "2021-08-11T20:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644525",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
|                                                                                                                                           |                                                                                                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|
|[651b372](https://github.com/sagemath/sagetrac-mirror/commit/651b3725402fa4ba485671133be73ec9765c31a9)|`Revert "Merge branch 'u/gh-tejasvicsr1/special_functions_for_lazy_series' of git://trac.sagemath.org/sage into t/32324/lazy_taylor_series"`|
|[7c9a5dd](https://github.com/sagemath/sagetrac-mirror/commit/7c9a5dda12e03ffb2a3b32e4008650190634cebb)|`fix invert`|
|[51357a0](https://github.com/sagemath/sagetrac-mirror/commit/51357a03296b07460be7b36a03e4f3dd3ebe04c6)|`Small reworkings and fixes. Adding another composition test.`|
|[7501204](https://github.com/sagemath/sagetrac-mirror/commit/7501204e1bd216361a395824d2bff70acc8962da)|`Adding documentation to the user-facing class level documentation.`|
|[4723f6b](https://github.com/sagemath/sagetrac-mirror/commit/4723f6bc6002985ae0d0592f45d8c840af8dd200)|`Refactoring we discussed at the meeting today.`|
|[651c3ed](https://github.com/sagemath/sagetrac-mirror/commit/651c3eddc75238ce607052adac7f2d2950cd6f7c)|`only get coefficient if necessary`|
|[65e604d](https://github.com/sagemath/sagetrac-mirror/commit/65e604d9b05def80d870e7103b41070c268aff41)|`Merge branch 'u/mantepse/dense_lls-31897' of git://trac.sagemath.org/sage into t/32324/lazy_taylor_series`|
|[b332728](https://github.com/sagemath/sagetrac-mirror/commit/b3327282df6f49d2367c5703a9b72433f5fe06ce)|`fix and document series reversion`|
|[6a2391e](https://github.com/sagemath/sagetrac-mirror/commit/6a2391ed602221387f1344a266d6fe5bcc9df83e)|`Merge remote-tracking branch 'trac/u/mantepse/lazy_taylor_series' into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|
|[0d56b02](https://github.com/sagemath/sagetrac-mirror/commit/0d56b0227713d7a6b26612593b311071a05782b8)|`Merged new Taylor series and deleted new_gs.py`|



---

archive/issue_comments_644526.json:
```json
{
    "body": "Changing commit from \"\" to \"0d56b0227713d7a6b26612593b311071a05782b8\"",
    "created_at": "2021-08-11T20:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644526",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "0d56b0227713d7a6b26612593b311071a05782b8"



---

archive/issue_comments_644527.json:
```json
{
    "body": "Changing keywords from \"LazyPowerSeries, FormalSeries, GSoC21\" to \"LazyPowerSeries, FormalSeries, gsoc2021\".",
    "created_at": "2021-08-12T00:50:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644527",
    "user": "https://github.com/tscrim"
}
```

Changing keywords from "LazyPowerSeries, FormalSeries, GSoC21" to "LazyPowerSeries, FormalSeries, gsoc2021".



---

archive/issue_comments_644528.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#32324\"",
    "created_at": "2021-08-12T00:53:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644528",
    "user": "https://github.com/tscrim"
}
```

Changing dependencies from "" to "#32324"



---

archive/issue_comments_644529.json:
```json
{
    "body": "Changing commit from \"0d56b0227713d7a6b26612593b311071a05782b8\" to \"39993e3ac56e0e26b69dd3a889c2aa8c030558fb\"",
    "created_at": "2021-08-13T18:13:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644529",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0d56b0227713d7a6b26612593b311071a05782b8" to "39993e3ac56e0e26b69dd3a889c2aa8c030558fb"



---

archive/issue_comments_644530.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n|[39993e3](https://github.com/sagemath/sagetrac-mirror/commit/39993e3ac56e0e26b69dd3a889c2aa8c030558fb)|`Fixed the initialising issue.`|",
    "created_at": "2021-08-13T18:13:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644530",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|[39993e3](https://github.com/sagemath/sagetrac-mirror/commit/39993e3ac56e0e26b69dd3a889c2aa8c030558fb)|`Fixed the initialising issue.`|



---

archive/issue_comments_644531.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------|\n|[73b9964](https://github.com/sagemath/sagetrac-mirror/commit/73b9964c3499ec8f10e3fb992dd97e8dc476f82d)|`Fixed naming issue.`|\n|[db20680](https://github.com/sagemath/sagetrac-mirror/commit/db206803e6c2847bb01600f1ba63ba9539894408)|`Changed _gs_iterator to callables`|",
    "created_at": "2021-08-16T19:34:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644531",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------|
|[73b9964](https://github.com/sagemath/sagetrac-mirror/commit/73b9964c3499ec8f10e3fb992dd97e8dc476f82d)|`Fixed naming issue.`|
|[db20680](https://github.com/sagemath/sagetrac-mirror/commit/db206803e6c2847bb01600f1ba63ba9539894408)|`Changed _gs_iterator to callables`|



---

archive/issue_comments_644532.json:
```json
{
    "body": "Changing commit from \"39993e3ac56e0e26b69dd3a889c2aa8c030558fb\" to \"db206803e6c2847bb01600f1ba63ba9539894408\"",
    "created_at": "2021-08-16T19:34:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644532",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "39993e3ac56e0e26b69dd3a889c2aa8c030558fb" to "db206803e6c2847bb01600f1ba63ba9539894408"



---

archive/issue_comments_644533.json:
```json
{
    "body": "Changing commit from \"db206803e6c2847bb01600f1ba63ba9539894408\" to \"7d491f6f7deee6cf4755c94442212366a0d96322\"",
    "created_at": "2021-08-17T20:44:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644533",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "db206803e6c2847bb01600f1ba63ba9539894408" to "7d491f6f7deee6cf4755c94442212366a0d96322"



---

archive/issue_comments_644534.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                  |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|\n|[974fa4f](https://github.com/sagemath/sagetrac-mirror/commit/974fa4f1c3a91dd05b677f0f8d363b9b525690d1)|`Changed _list and _term methods.`|\n|[6cfdf8d](https://github.com/sagemath/sagetrac-mirror/commit/6cfdf8dcd38c2e49fc6d04bbb04dbe958009fbb7)|`Created restrict method in the series helper function.`|\n|[eef15d8](https://github.com/sagemath/sagetrac-mirror/commit/eef15d81bb9734c3aaa07b8dc141652b8d9f0b82)|`Changed the name of iterator to callable.`|\n|[7d491f6](https://github.com/sagemath/sagetrac-mirror/commit/7d491f6f7deee6cf4755c94442212366a0d96322)|`Raised a not implemented error for all not corrected methods in the generating_series file.`|",
    "created_at": "2021-08-17T20:44:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644534",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                  |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|
|[974fa4f](https://github.com/sagemath/sagetrac-mirror/commit/974fa4f1c3a91dd05b677f0f8d363b9b525690d1)|`Changed _list and _term methods.`|
|[6cfdf8d](https://github.com/sagemath/sagetrac-mirror/commit/6cfdf8dcd38c2e49fc6d04bbb04dbe958009fbb7)|`Created restrict method in the series helper function.`|
|[eef15d8](https://github.com/sagemath/sagetrac-mirror/commit/eef15d81bb9734c3aaa07b8dc141652b8d9f0b82)|`Changed the name of iterator to callable.`|
|[7d491f6](https://github.com/sagemath/sagetrac-mirror/commit/7d491f6f7deee6cf4755c94442212366a0d96322)|`Raised a not implemented error for all not corrected methods in the generating_series file.`|



---

archive/issue_comments_644535.json:
```json
{
    "body": "Changing branch from \"u/gh-tejasvicsr1/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series\" to \"u/mantepse/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series\"",
    "created_at": "2021-08-18T09:22:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644535",
    "user": "https://github.com/mantepse"
}
```

Changing branch from "u/gh-tejasvicsr1/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series" to "u/mantepse/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series"



---

archive/issue_comments_644536.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n|                                                                                                                                           |                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n|[661c3d4](https://github.com/sagemath/sagetrac-mirror/commit/661c3d4916e78dc6683540cca7624f26322f7d5d)|`backport two fixes from 32324`|\n|[8a7dcd3](https://github.com/sagemath/sagetrac-mirror/commit/8a7dcd3dff5d1db66b0758670290d24009e89ab8)|`fix oversight in shift`|\n|[78b8fff](https://github.com/sagemath/sagetrac-mirror/commit/78b8fff86ca332e3b211816cd9077b3711aabc93)|`Last trivial fix for clean pyflakes.`|\n|[96771f0](https://github.com/sagemath/sagetrac-mirror/commit/96771f07b43644a2c658ee6ff42203159a36a0a8)|`Merge branch 'u/tscrim/dense_lls-31897' of git://trac.sagemath.org/sage into t/32324/lazy_taylor_series`|\n|[86925af](https://github.com/sagemath/sagetrac-mirror/commit/86925af05516a86f4ee30dc15685b752382aeebb)|`initial version of lazy symmetric functions`|\n|[aa8a250](https://github.com/sagemath/sagetrac-mirror/commit/aa8a25078b5c9e7f89e2863e617d9f2782200a12)|`initial and insanely stupid plethysm implementation`|\n|[1a36f59](https://github.com/sagemath/sagetrac-mirror/commit/1a36f592ade820ff533feddbb89c040567f0ec40)|`add (currently failing) doctest for plethysm`|\n|[03198a0](https://github.com/sagemath/sagetrac-mirror/commit/03198a02a7522ff2745fe6dd2e0e1a4a80d0dd1b)|`fix bug in plethysm`|\n|[eb3e88f](https://github.com/sagemath/sagetrac-mirror/commit/eb3e88fe6806d49f6b84f80d96dd6cf35ab1ed25)|`more doctests for composition and plethysm`|\n|[a9084c6](https://github.com/sagemath/sagetrac-mirror/commit/a9084c6d28f3ecbfe544133741415731279df1b6)|`Merge branch 'u/mantepse/lazy_taylor_series' of git://trac.sagemath.org/sage into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|",
    "created_at": "2021-08-18T09:30:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644536",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
|                                                                                                                                           |                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|[661c3d4](https://github.com/sagemath/sagetrac-mirror/commit/661c3d4916e78dc6683540cca7624f26322f7d5d)|`backport two fixes from 32324`|
|[8a7dcd3](https://github.com/sagemath/sagetrac-mirror/commit/8a7dcd3dff5d1db66b0758670290d24009e89ab8)|`fix oversight in shift`|
|[78b8fff](https://github.com/sagemath/sagetrac-mirror/commit/78b8fff86ca332e3b211816cd9077b3711aabc93)|`Last trivial fix for clean pyflakes.`|
|[96771f0](https://github.com/sagemath/sagetrac-mirror/commit/96771f07b43644a2c658ee6ff42203159a36a0a8)|`Merge branch 'u/tscrim/dense_lls-31897' of git://trac.sagemath.org/sage into t/32324/lazy_taylor_series`|
|[86925af](https://github.com/sagemath/sagetrac-mirror/commit/86925af05516a86f4ee30dc15685b752382aeebb)|`initial version of lazy symmetric functions`|
|[aa8a250](https://github.com/sagemath/sagetrac-mirror/commit/aa8a25078b5c9e7f89e2863e617d9f2782200a12)|`initial and insanely stupid plethysm implementation`|
|[1a36f59](https://github.com/sagemath/sagetrac-mirror/commit/1a36f592ade820ff533feddbb89c040567f0ec40)|`add (currently failing) doctest for plethysm`|
|[03198a0](https://github.com/sagemath/sagetrac-mirror/commit/03198a02a7522ff2745fe6dd2e0e1a4a80d0dd1b)|`fix bug in plethysm`|
|[eb3e88f](https://github.com/sagemath/sagetrac-mirror/commit/eb3e88fe6806d49f6b84f80d96dd6cf35ab1ed25)|`more doctests for composition and plethysm`|
|[a9084c6](https://github.com/sagemath/sagetrac-mirror/commit/a9084c6d28f3ecbfe544133741415731279df1b6)|`Merge branch 'u/mantepse/lazy_taylor_series' of git://trac.sagemath.org/sage into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|



---

archive/issue_comments_644537.json:
```json
{
    "body": "Changing commit from \"7d491f6f7deee6cf4755c94442212366a0d96322\" to \"a9084c6d28f3ecbfe544133741415731279df1b6\"",
    "created_at": "2021-08-18T09:30:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644537",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7d491f6f7deee6cf4755c94442212366a0d96322" to "a9084c6d28f3ecbfe544133741415731279df1b6"



---

archive/issue_comments_644538.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[4b76e93](https://github.com/sagemath/sagetrac-mirror/commit/4b76e93596f91a5068a5d2dbba31a65f748dea73)|`switch to power sum by default`|",
    "created_at": "2021-08-18T09:34:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644538",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[4b76e93](https://github.com/sagemath/sagetrac-mirror/commit/4b76e93596f91a5068a5d2dbba31a65f748dea73)|`switch to power sum by default`|



---

archive/issue_comments_644539.json:
```json
{
    "body": "Changing commit from \"a9084c6d28f3ecbfe544133741415731279df1b6\" to \"4b76e93596f91a5068a5d2dbba31a65f748dea73\"",
    "created_at": "2021-08-18T09:34:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644539",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a9084c6d28f3ecbfe544133741415731279df1b6" to "4b76e93596f91a5068a5d2dbba31a65f748dea73"



---

archive/issue_comments_644540.json:
```json
{
    "body": "Changing branch from \"u/mantepse/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series\" to \"u/gh-tejasvicsr1/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series\"",
    "created_at": "2021-08-19T18:15:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644540",
    "user": "https://github.com/tejasvicsr1"
}
```

Changing branch from "u/mantepse/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series" to "u/gh-tejasvicsr1/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series"



---

archive/issue_comments_644541.json:
```json
{
    "body": "Changing commit from \"4b76e93596f91a5068a5d2dbba31a65f748dea73\" to \"48e8e2686f68a911c5a705b91971e0f3d5924113\"",
    "created_at": "2021-08-24T20:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644541",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4b76e93596f91a5068a5d2dbba31a65f748dea73" to "48e8e2686f68a911c5a705b91971e0f3d5924113"



---

archive/issue_comments_644542.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|\n|[48e8e26](https://github.com/sagemath/sagetrac-mirror/commit/48e8e2686f68a911c5a705b91971e0f3d5924113)|`Changed more methods.`|",
    "created_at": "2021-08-24T20:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644542",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|
|[48e8e26](https://github.com/sagemath/sagetrac-mirror/commit/48e8e2686f68a911c5a705b91971e0f3d5924113)|`Changed more methods.`|



---

archive/issue_comments_644543.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|\n|[78a85ae](https://github.com/sagemath/sagetrac-mirror/commit/78a85aeeaeabf44e6a6ebd9c58a486cebf373eca)|`Some more work in generating series.`|",
    "created_at": "2021-08-25T18:47:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644543",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|
|[78a85ae](https://github.com/sagemath/sagetrac-mirror/commit/78a85aeeaeabf44e6a6ebd9c58a486cebf373eca)|`Some more work in generating series.`|



---

archive/issue_comments_644544.json:
```json
{
    "body": "Changing commit from \"48e8e2686f68a911c5a705b91971e0f3d5924113\" to \"78a85aeeaeabf44e6a6ebd9c58a486cebf373eca\"",
    "created_at": "2021-08-25T18:47:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644544",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "48e8e2686f68a911c5a705b91971e0f3d5924113" to "78a85aeeaeabf44e6a6ebd9c58a486cebf373eca"



---

archive/issue_events_096583.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T20:12:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32367#event-96583"
}
```



---

archive/issue_events_096584.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T04:32:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32367#event-96584"
}
```



---

archive/issue_events_096585.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T04:32:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32367#event-96585"
}
```



---

archive/issue_comments_644545.json:
```json
{
    "body": "Changing branch from \"u/gh-tejasvicsr1/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series\" to \"u/mantepse/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series\"",
    "created_at": "2022-08-11T18:16:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644545",
    "user": "https://github.com/mantepse"
}
```

Changing branch from "u/gh-tejasvicsr1/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series" to "u/mantepse/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series"



---

archive/issue_comments_644546.json:
```json
{
    "body": "<a id='comment:17'></a>\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n|                                                                                                                                           |                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------|\n|[e4479ed](https://github.com/sagemath/sagetrac-mirror/commit/e4479ed6b72f2e4391559877abd283eb3633556f)|`fix missing space`|\n|[3da6b3d](https://github.com/sagemath/sagetrac-mirror/commit/3da6b3deb53c37dab9676cf60c9aaff6e9e43e14)|`better docstring`|\n|[8798139](https://github.com/sagemath/sagetrac-mirror/commit/87981391d758ccad3db3e5945ccff74dfb383ad9)|`Adding a slightly more complicated doctest and other small tweaks.`|\n|[75e3f3b](https://github.com/sagemath/sagetrac-mirror/commit/75e3f3b3aa56b9ebc0d9fcd5395ad6dfb9bb430e)|`Merge branch 'public/rings/laurent_quo_rem_bug-34330' into public/rings/lazy_talyor_series-32324`|\n|[c74fd71](https://github.com/sagemath/sagetrac-mirror/commit/c74fd7105cc842367cef01807efce41d3c95b70f)|`improve documentation, move options to abstract base class`|\n|[9d6579b](https://github.com/sagemath/sagetrac-mirror/commit/9d6579ba5e4545140d9d74b3cb9f70f232109872)|`improve documentation, move zero, one, characteristic, etc. to ABC`|\n|[feba6b8](https://github.com/sagemath/sagetrac-mirror/commit/feba6b8997b7d11a11f252b1ee957e68cfdf1bc5)|`Working more on __call__ for LazySymFunc.`|\n|[3f3e0f2](https://github.com/sagemath/sagetrac-mirror/commit/3f3e0f2048c702daa48cde9edea574458abcf8f0)|`Merge branch 'public/rings/lazy_talyor_series-32324' of https://github.com/sagemath/sagetrac-mirror into public/rings/lazy_talyor_series-32324`|\n|[6727228](https://github.com/sagemath/sagetrac-mirror/commit/67272285ace598162cbd1de50fa4f1c9fe74b0dd)|`Merge branch 'public/rings/lazy_talyor_series-32324' of trac.sagemath.org:sage into t/32324/public/rings/lazy_talyor_series-32324`|\n|[d4f2e5c](https://github.com/sagemath/sagetrac-mirror/commit/d4f2e5cc8b49b70138ab1f56fb0062d22c83491c)|`Merge branch 'public/rings/lazy_talyor_series-32324' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|",
    "created_at": "2022-08-11T18:36:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644546",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
|                                                                                                                                           |                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------|
|[e4479ed](https://github.com/sagemath/sagetrac-mirror/commit/e4479ed6b72f2e4391559877abd283eb3633556f)|`fix missing space`|
|[3da6b3d](https://github.com/sagemath/sagetrac-mirror/commit/3da6b3deb53c37dab9676cf60c9aaff6e9e43e14)|`better docstring`|
|[8798139](https://github.com/sagemath/sagetrac-mirror/commit/87981391d758ccad3db3e5945ccff74dfb383ad9)|`Adding a slightly more complicated doctest and other small tweaks.`|
|[75e3f3b](https://github.com/sagemath/sagetrac-mirror/commit/75e3f3b3aa56b9ebc0d9fcd5395ad6dfb9bb430e)|`Merge branch 'public/rings/laurent_quo_rem_bug-34330' into public/rings/lazy_talyor_series-32324`|
|[c74fd71](https://github.com/sagemath/sagetrac-mirror/commit/c74fd7105cc842367cef01807efce41d3c95b70f)|`improve documentation, move options to abstract base class`|
|[9d6579b](https://github.com/sagemath/sagetrac-mirror/commit/9d6579ba5e4545140d9d74b3cb9f70f232109872)|`improve documentation, move zero, one, characteristic, etc. to ABC`|
|[feba6b8](https://github.com/sagemath/sagetrac-mirror/commit/feba6b8997b7d11a11f252b1ee957e68cfdf1bc5)|`Working more on __call__ for LazySymFunc.`|
|[3f3e0f2](https://github.com/sagemath/sagetrac-mirror/commit/3f3e0f2048c702daa48cde9edea574458abcf8f0)|`Merge branch 'public/rings/lazy_talyor_series-32324' of https://github.com/sagemath/sagetrac-mirror into public/rings/lazy_talyor_series-32324`|
|[6727228](https://github.com/sagemath/sagetrac-mirror/commit/67272285ace598162cbd1de50fa4f1c9fe74b0dd)|`Merge branch 'public/rings/lazy_talyor_series-32324' of trac.sagemath.org:sage into t/32324/public/rings/lazy_talyor_series-32324`|
|[d4f2e5c](https://github.com/sagemath/sagetrac-mirror/commit/d4f2e5cc8b49b70138ab1f56fb0062d22c83491c)|`Merge branch 'public/rings/lazy_talyor_series-32324' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|



---

archive/issue_comments_644547.json:
```json
{
    "body": "Changing commit from \"78a85aeeaeabf44e6a6ebd9c58a486cebf373eca\" to \"d4f2e5cc8b49b70138ab1f56fb0062d22c83491c\"",
    "created_at": "2022-08-11T18:36:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644547",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "78a85aeeaeabf44e6a6ebd9c58a486cebf373eca" to "d4f2e5cc8b49b70138ab1f56fb0062d22c83491c"



---

archive/issue_comments_644548.json:
```json
{
    "body": "Changing commit from \"d4f2e5cc8b49b70138ab1f56fb0062d22c83491c\" to \"1b34e62a503050fd50c831d87746f5740a0df92d\"",
    "created_at": "2022-08-12T08:06:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644548",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d4f2e5cc8b49b70138ab1f56fb0062d22c83491c" to "1b34e62a503050fd50c831d87746f5740a0df92d"



---

archive/issue_comments_644549.json:
```json
{
    "body": "<a id='comment:18'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|\n|[028796d](https://github.com/sagemath/sagetrac-mirror/commit/028796d47eedb24a730258ae18e89b95bda24639)|`Fixing numerous issues with __call__ and expanding its functionality. Moving plethysm to a Stream_plethysm.`|\n|[9fb155f](https://github.com/sagemath/sagetrac-mirror/commit/9fb155f4502d54f0ea8dc2b15745804b000d694a)|`Removing unused code from previous version.`|\n|[1b34e62](https://github.com/sagemath/sagetrac-mirror/commit/1b34e62a503050fd50c831d87746f5740a0df92d)|`Merge branch 'public/rings/lazy_talyor_series-32324' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|",
    "created_at": "2022-08-12T08:06:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644549",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|
|[028796d](https://github.com/sagemath/sagetrac-mirror/commit/028796d47eedb24a730258ae18e89b95bda24639)|`Fixing numerous issues with __call__ and expanding its functionality. Moving plethysm to a Stream_plethysm.`|
|[9fb155f](https://github.com/sagemath/sagetrac-mirror/commit/9fb155f4502d54f0ea8dc2b15745804b000d694a)|`Removing unused code from previous version.`|
|[1b34e62](https://github.com/sagemath/sagetrac-mirror/commit/1b34e62a503050fd50c831d87746f5740a0df92d)|`Merge branch 'public/rings/lazy_talyor_series-32324' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|



---

archive/issue_comments_644550.json:
```json
{
    "body": "Changing commit from \"1b34e62a503050fd50c831d87746f5740a0df92d\" to \"5ba18e80f4f99f03393056a33cfeb42b413e9066\"",
    "created_at": "2022-08-16T12:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644550",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1b34e62a503050fd50c831d87746f5740a0df92d" to "5ba18e80f4f99f03393056a33cfeb42b413e9066"



---

archive/issue_comments_644551.json:
```json
{
    "body": "<a id='comment:19'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|\n|[7f9dbb1](https://github.com/sagemath/sagetrac-mirror/commit/7f9dbb186459922ba90b5a9326ebf6b5dcaa1ba8)|`Some last doc fixes and tweaks.`|\n|[4e03fee](https://github.com/sagemath/sagetrac-mirror/commit/4e03fee27f1ebff2741eb57fb0de4d7d80043636)|`remove unused local variable`|\n|[e780472](https://github.com/sagemath/sagetrac-mirror/commit/e78047258774176c6e8271e29c9b5825cc12aa11)|`Addressing the linter complaint.`|\n|[5ba18e8](https://github.com/sagemath/sagetrac-mirror/commit/5ba18e80f4f99f03393056a33cfeb42b413e9066)|`Merge branch 'public/rings/lazy_talyor_series-32324' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|",
    "created_at": "2022-08-16T12:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644551",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
|[7f9dbb1](https://github.com/sagemath/sagetrac-mirror/commit/7f9dbb186459922ba90b5a9326ebf6b5dcaa1ba8)|`Some last doc fixes and tweaks.`|
|[4e03fee](https://github.com/sagemath/sagetrac-mirror/commit/4e03fee27f1ebff2741eb57fb0de4d7d80043636)|`remove unused local variable`|
|[e780472](https://github.com/sagemath/sagetrac-mirror/commit/e78047258774176c6e8271e29c9b5825cc12aa11)|`Addressing the linter complaint.`|
|[5ba18e8](https://github.com/sagemath/sagetrac-mirror/commit/5ba18e80f4f99f03393056a33cfeb42b413e9066)|`Merge branch 'public/rings/lazy_talyor_series-32324' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|



---

archive/issue_comments_644552.json:
```json
{
    "body": "<a id='comment:20'></a>\nIs this ready for review?",
    "created_at": "2022-08-22T07:57:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644552",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:20'></a>
Is this ready for review?



---

archive/issue_comments_644553.json:
```json
{
    "body": "<a id='comment:21'></a>\nNo, not at all, I am working on it.\n\nI am having slight difficulties with plethysm, but I think that I have mostly resolved these by now.",
    "created_at": "2022-08-22T07:59:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644553",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:21'></a>
No, not at all, I am working on it.

I am having slight difficulties with plethysm, but I think that I have mostly resolved these by now.



---

archive/issue_comments_644554.json:
```json
{
    "body": "<a id='comment:22'></a>\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n|                                                                                                                                           |                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|\n|[50ce450](https://github.com/sagemath/sagetrac-mirror/commit/50ce4508add8c080f9af5afe916fe9f5fe903d9d)|`derivative for LazyTaylorSeries`|\n|[10cfc11](https://github.com/sagemath/sagetrac-mirror/commit/10cfc11a7393ccf2d92cd45b9a3ee127056c7363)|`derivative for LazySymmetricFunctions`|\n|[7be0b86](https://github.com/sagemath/sagetrac-mirror/commit/7be0b868dac6612ffd822ee5af1e7c2f69eaedff)|`functorial composition for LazySymmetricFunctions`|\n|[c755d71](https://github.com/sagemath/sagetrac-mirror/commit/c755d7182ad8b0dd1c4a0f298936fa61975fee54)|`implement arithmetic product for LazySymmetricFunction`|\n|[c36796e](https://github.com/sagemath/sagetrac-mirror/commit/c36796e29704a3f3596dd03e62c874881df994ab)|`Merge branch 'u/mantepse/implement_arithmetic_product_of_lazy_symmetric_functions' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|\n|[18429ef](https://github.com/sagemath/sagetrac-mirror/commit/18429ef0890975ccb09d5345823af3c7b97322cf)|`do not use change_ring, because it is brittle, and take care of zero coefficients which are not symmetric functions`|\n|[481d78d](https://github.com/sagemath/sagetrac-mirror/commit/481d78d6625cbc0ab3496f71da7b4ad249a136db)|`Merge branch 'u/mantepse/implement_functorial_composition_of_lazy_symmetric_functiosn' of trac.sagemath.org:sage into t/34423/implement_arithmetic_product_of_lazy_symmetric_functions`|\n|[b469431](https://github.com/sagemath/sagetrac-mirror/commit/b469431783ad64c128a0a6a65164e4747ba3c2a4)|`do not use change_ring, because it is brittle`|\n|[56ee69e](https://github.com/sagemath/sagetrac-mirror/commit/56ee69e9863a1d85c1e61b0687809da423577b8e)|`Merge branch 'u/mantepse/implement_arithmetic_product_of_lazy_symmetric_functions' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|\n|[1e8f69d](https://github.com/sagemath/sagetrac-mirror/commit/1e8f69dfeab7f92a5579fbcb488f6759cedc569f)|`remove LazyPowerSeries and Stream`|",
    "created_at": "2022-08-24T21:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644554",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
|                                                                                                                                           |                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
|[50ce450](https://github.com/sagemath/sagetrac-mirror/commit/50ce4508add8c080f9af5afe916fe9f5fe903d9d)|`derivative for LazyTaylorSeries`|
|[10cfc11](https://github.com/sagemath/sagetrac-mirror/commit/10cfc11a7393ccf2d92cd45b9a3ee127056c7363)|`derivative for LazySymmetricFunctions`|
|[7be0b86](https://github.com/sagemath/sagetrac-mirror/commit/7be0b868dac6612ffd822ee5af1e7c2f69eaedff)|`functorial composition for LazySymmetricFunctions`|
|[c755d71](https://github.com/sagemath/sagetrac-mirror/commit/c755d7182ad8b0dd1c4a0f298936fa61975fee54)|`implement arithmetic product for LazySymmetricFunction`|
|[c36796e](https://github.com/sagemath/sagetrac-mirror/commit/c36796e29704a3f3596dd03e62c874881df994ab)|`Merge branch 'u/mantepse/implement_arithmetic_product_of_lazy_symmetric_functions' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|
|[18429ef](https://github.com/sagemath/sagetrac-mirror/commit/18429ef0890975ccb09d5345823af3c7b97322cf)|`do not use change_ring, because it is brittle, and take care of zero coefficients which are not symmetric functions`|
|[481d78d](https://github.com/sagemath/sagetrac-mirror/commit/481d78d6625cbc0ab3496f71da7b4ad249a136db)|`Merge branch 'u/mantepse/implement_functorial_composition_of_lazy_symmetric_functiosn' of trac.sagemath.org:sage into t/34423/implement_arithmetic_product_of_lazy_symmetric_functions`|
|[b469431](https://github.com/sagemath/sagetrac-mirror/commit/b469431783ad64c128a0a6a65164e4747ba3c2a4)|`do not use change_ring, because it is brittle`|
|[56ee69e](https://github.com/sagemath/sagetrac-mirror/commit/56ee69e9863a1d85c1e61b0687809da423577b8e)|`Merge branch 'u/mantepse/implement_arithmetic_product_of_lazy_symmetric_functions' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|
|[1e8f69d](https://github.com/sagemath/sagetrac-mirror/commit/1e8f69dfeab7f92a5579fbcb488f6759cedc569f)|`remove LazyPowerSeries and Stream`|



---

archive/issue_comments_644555.json:
```json
{
    "body": "Changing commit from \"5ba18e80f4f99f03393056a33cfeb42b413e9066\" to \"1e8f69dfeab7f92a5579fbcb488f6759cedc569f\"",
    "created_at": "2022-08-24T21:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644555",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5ba18e80f4f99f03393056a33cfeb42b413e9066" to "1e8f69dfeab7f92a5579fbcb488f6759cedc569f"



---

archive/issue_comments_644556.json:
```json
{
    "body": "Changing commit from \"1e8f69dfeab7f92a5579fbcb488f6759cedc569f\" to \"d75ac136b99030723109a279f29534d9cbedb726\"",
    "created_at": "2022-09-02T21:01:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644556",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1e8f69dfeab7f92a5579fbcb488f6759cedc569f" to "d75ac136b99030723109a279f29534d9cbedb726"



---

archive/issue_comments_644557.json:
```json
{
    "body": "<a id='comment:23'></a>\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n|                                                                                                                                           |                                                                                                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|\n|[e1e7f0d](https://github.com/sagemath/sagetrac-mirror/commit/e1e7f0d25950620f07c5e566b054cada7e60881a)|`Merge branch 'u/mantepse/implement_derivatives_of_lazy_series' of trac.sagemath.org:sage into t/34473/remove_rings_from_streams`|\n|[6010361](https://github.com/sagemath/sagetrac-mirror/commit/60103619caa275cb7087e425d25afacdba48af9b)|`remove ring argument from Stream_map_coefficient and Stream_function`|\n|[aa15394](https://github.com/sagemath/sagetrac-mirror/commit/aa153940947bbd0962ddf949180c4e7e9bb317f9)|`Merge branch 'u/mantepse/remove_rings_from_streams' of trac.sagemath.org:sage into t/34422/implement_functorial_composition_of_lazy_symmetric_functiosn`|\n|[760372a](https://github.com/sagemath/sagetrac-mirror/commit/760372aea66aa303303462adbe0bc7b4c16e1927)|`address reviewer's comments`|\n|[8ca3624](https://github.com/sagemath/sagetrac-mirror/commit/8ca3624bd3b63fe5e5238e0926e94fce4af81cbe)|`polish functorial composition`|\n|[b2ef1e4](https://github.com/sagemath/sagetrac-mirror/commit/b2ef1e45ff767766effe82c3def803334552d46a)|`allow SymmetricFunctions as arguments of functorial composition`|\n|[83e7dd3](https://github.com/sagemath/sagetrac-mirror/commit/83e7dd3e4a97349a874e4b448a358192ada72b70)|`Merge branch 'u/mantepse/implement_functorial_composition_of_lazy_symmetric_functiosn' of trac.sagemath.org:sage into t/34423/implement_arithmetic_product_of_lazy_symmetric_functions`|\n|[d22f87a](https://github.com/sagemath/sagetrac-mirror/commit/d22f87a7fc6a9072bd40ffeb96ecfbac8ae8756c)|`adapt code after merge`|\n|[f2a3caf](https://github.com/sagemath/sagetrac-mirror/commit/f2a3caf66c90c4c3233e65c525d2e40ccd4923cd)|`reimplement arithmetic_product by using the symmetric function version (which is more robust`|\n|[d75ac13](https://github.com/sagemath/sagetrac-mirror/commit/d75ac136b99030723109a279f29534d9cbedb726)|`Merge branch 'u/mantepse/implement_arithmetic_product_of_lazy_symmetric_functions' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|",
    "created_at": "2022-09-02T21:01:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644557",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
|                                                                                                                                           |                                                                                                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|
|[e1e7f0d](https://github.com/sagemath/sagetrac-mirror/commit/e1e7f0d25950620f07c5e566b054cada7e60881a)|`Merge branch 'u/mantepse/implement_derivatives_of_lazy_series' of trac.sagemath.org:sage into t/34473/remove_rings_from_streams`|
|[6010361](https://github.com/sagemath/sagetrac-mirror/commit/60103619caa275cb7087e425d25afacdba48af9b)|`remove ring argument from Stream_map_coefficient and Stream_function`|
|[aa15394](https://github.com/sagemath/sagetrac-mirror/commit/aa153940947bbd0962ddf949180c4e7e9bb317f9)|`Merge branch 'u/mantepse/remove_rings_from_streams' of trac.sagemath.org:sage into t/34422/implement_functorial_composition_of_lazy_symmetric_functiosn`|
|[760372a](https://github.com/sagemath/sagetrac-mirror/commit/760372aea66aa303303462adbe0bc7b4c16e1927)|`address reviewer's comments`|
|[8ca3624](https://github.com/sagemath/sagetrac-mirror/commit/8ca3624bd3b63fe5e5238e0926e94fce4af81cbe)|`polish functorial composition`|
|[b2ef1e4](https://github.com/sagemath/sagetrac-mirror/commit/b2ef1e45ff767766effe82c3def803334552d46a)|`allow SymmetricFunctions as arguments of functorial composition`|
|[83e7dd3](https://github.com/sagemath/sagetrac-mirror/commit/83e7dd3e4a97349a874e4b448a358192ada72b70)|`Merge branch 'u/mantepse/implement_functorial_composition_of_lazy_symmetric_functiosn' of trac.sagemath.org:sage into t/34423/implement_arithmetic_product_of_lazy_symmetric_functions`|
|[d22f87a](https://github.com/sagemath/sagetrac-mirror/commit/d22f87a7fc6a9072bd40ffeb96ecfbac8ae8756c)|`adapt code after merge`|
|[f2a3caf](https://github.com/sagemath/sagetrac-mirror/commit/f2a3caf66c90c4c3233e65c525d2e40ccd4923cd)|`reimplement arithmetic_product by using the symmetric function version (which is more robust`|
|[d75ac13](https://github.com/sagemath/sagetrac-mirror/commit/d75ac136b99030723109a279f29534d9cbedb726)|`Merge branch 'u/mantepse/implement_arithmetic_product_of_lazy_symmetric_functions' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|



---

archive/issue_comments_644558.json:
```json
{
    "body": "Changing commit from \"d75ac136b99030723109a279f29534d9cbedb726\" to \"293b4392f318a6a6a487dc87fa8c8d64864fbf23\"",
    "created_at": "2022-09-02T21:15:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644558",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d75ac136b99030723109a279f29534d9cbedb726" to "293b4392f318a6a6a487dc87fa8c8d64864fbf23"



---

archive/issue_comments_644559.json:
```json
{
    "body": "<a id='comment:24'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------|\n|[293b439](https://github.com/sagemath/sagetrac-mirror/commit/293b4392f318a6a6a487dc87fa8c8d64864fbf23)|`adapt doctests`|",
    "created_at": "2022-09-02T21:15:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644559",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------|
|[293b439](https://github.com/sagemath/sagetrac-mirror/commit/293b4392f318a6a6a487dc87fa8c8d64864fbf23)|`adapt doctests`|



---

archive/issue_comments_644560.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-09-02T21:17:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644560",
    "user": "https://github.com/mantepse"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_644561.json:
```json
{
    "body": "<a id='comment:25'></a>\nA small step but a giant leap!",
    "created_at": "2022-09-02T21:17:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644561",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:25'></a>
A small step but a giant leap!



---

archive/issue_comments_644562.json:
```json
{
    "body": "Changing dependencies from \"#32324\" to \"#34423\"",
    "created_at": "2022-09-02T21:18:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644562",
    "user": "https://github.com/mantepse"
}
```

Changing dependencies from "#32324" to "#34423"



---

archive/issue_comments_644563.json:
```json
{
    "body": "Changing author from \"Tejasvi Chebrolu\" to \"Tejasvi Chebrolu, Martin Rubey, Travis Scrimshaw\"",
    "created_at": "2022-09-02T21:19:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644563",
    "user": "https://github.com/mantepse"
}
```

Changing author from "Tejasvi Chebrolu" to "Tejasvi Chebrolu, Martin Rubey, Travis Scrimshaw"



---

archive/issue_comments_644564.json:
```json
{
    "body": "<a id='comment:28'></a>\nFrom a first quick look, it seems like there are just a few small things to address:\n\nThese need at least one doctest each:\n\n```\n    def __init__(self, base_ring):\n        super().__init__(base_ring, names=\"z\")\n```\n\nThis can be simplified:\n\n```diff\n-    return CIS(lambda n: _cl_term(n))\n+    return CIS(_cl_term)\n```\n\nWe can also use (the cached)\n\n```diff\n-base_ring(1)\n+base_ring.one()\n```\n\nWe no longer have a `coefficients()` method (a difference between the implementations), right? We should introduce a deprecation message for this method or add it to the lazy series. I am leaning towards adding it to the lazy series as a redirect of `self[:n]`.",
    "created_at": "2022-09-02T23:16:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644564",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:28'></a>
From a first quick look, it seems like there are just a few small things to address:

These need at least one doctest each:

```
    def __init__(self, base_ring):
        super().__init__(base_ring, names="z")
```

This can be simplified:

```diff
-    return CIS(lambda n: _cl_term(n))
+    return CIS(_cl_term)
```

We can also use (the cached)

```diff
-base_ring(1)
+base_ring.one()
```

We no longer have a `coefficients()` method (a difference between the implementations), right? We should introduce a deprecation message for this method or add it to the lazy series. I am leaning towards adding it to the lazy series as a redirect of `self[:n]`.



---

archive/issue_comments_644565.json:
```json
{
    "body": "Changing commit from \"293b4392f318a6a6a487dc87fa8c8d64864fbf23\" to \"89270ebb1e49759628c1db69de93744a0d3b29df\"",
    "created_at": "2022-09-03T08:49:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644565",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "293b4392f318a6a6a487dc87fa8c8d64864fbf23" to "89270ebb1e49759628c1db69de93744a0d3b29df"



---

archive/issue_comments_644566.json:
```json
{
    "body": "<a id='comment:29'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|\n|[8b6a752](https://github.com/sagemath/sagetrac-mirror/commit/8b6a752a3326cd62f3316d6a09a3450166a7e0a5)|`no period at end of input description, break long doctest`|\n|[f88a5c8](https://github.com/sagemath/sagetrac-mirror/commit/f88a5c81a722b5da9ad9b7f7d78cc1f9876d3edb)|`fix arithmetic product with 0 and finite support`|\n|[89270eb](https://github.com/sagemath/sagetrac-mirror/commit/89270ebb1e49759628c1db69de93744a0d3b29df)|`Merge branch 'u/mantepse/implement_arithmetic_product_of_lazy_symmetric_functions' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|",
    "created_at": "2022-09-03T08:49:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644566",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|
|[8b6a752](https://github.com/sagemath/sagetrac-mirror/commit/8b6a752a3326cd62f3316d6a09a3450166a7e0a5)|`no period at end of input description, break long doctest`|
|[f88a5c8](https://github.com/sagemath/sagetrac-mirror/commit/f88a5c81a722b5da9ad9b7f7d78cc1f9876d3edb)|`fix arithmetic product with 0 and finite support`|
|[89270eb](https://github.com/sagemath/sagetrac-mirror/commit/89270ebb1e49759628c1db69de93744a0d3b29df)|`Merge branch 'u/mantepse/implement_arithmetic_product_of_lazy_symmetric_functions' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|



---

archive/issue_comments_644567.json:
```json
{
    "body": "<a id='comment:30'></a>\nThere are several failing doctests and a few hidden bugs elsewhere (found using grep LazyPowerSeries).  Trying to fix.",
    "created_at": "2022-09-03T09:03:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644567",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:30'></a>
There are several failing doctests and a few hidden bugs elsewhere (found using grep LazyPowerSeries).  Trying to fix.



---

archive/issue_comments_644568.json:
```json
{
    "body": "<a id='comment:31'></a>\nThere is at least one place, where we feed the LazyPowerSeriesRing with an infinite iterator, see below.\n\nWhile this is surely easy to change, shouldn't we support this, too?  Actually, I thought we did, but I cannot find it right now.\n\n```\n                # If we're here, we may not be a finite crystal.\n                # In fact, we're probably infinite.\n                from sage.rings.lazy_series_ring import LazyTaylorSeriesRing\n                if q is None:\n                    P = LazyTaylorSeriesRing(ZZ, names='q')\n                else:\n                    P = q.parent()\n                if not isinstance(P, LazyTaylorSeriesRing):\n                    raise TypeError(\"the parent of q must be a lazy power series ring\")\n                ret = P(iter_by_deg(mg))\n                return ret\n```",
    "created_at": "2022-09-03T09:20:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644568",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:31'></a>
There is at least one place, where we feed the LazyPowerSeriesRing with an infinite iterator, see below.

While this is surely easy to change, shouldn't we support this, too?  Actually, I thought we did, but I cannot find it right now.

```
                # If we're here, we may not be a finite crystal.
                # In fact, we're probably infinite.
                from sage.rings.lazy_series_ring import LazyTaylorSeriesRing
                if q is None:
                    P = LazyTaylorSeriesRing(ZZ, names='q')
                else:
                    P = q.parent()
                if not isinstance(P, LazyTaylorSeriesRing):
                    raise TypeError("the parent of q must be a lazy power series ring")
                ret = P(iter_by_deg(mg))
                return ret
```



---

archive/issue_comments_644569.json:
```json
{
    "body": "<a id='comment:32'></a>\nThere is one doctest from a book which we cannot sensibly support anymore, see below.\n\nIn short:\n\n```\n  sage: L.<z> = LazyPowerSeriesRing(QQ)\n  sage: C = L()\n  sage: C._name = 'C'\n  sage: C.define( z + C * C )\n```\nmust become\n\n```\n  sage: L.<z> = LazyPowerSeriesRing(QQ)\n  sage: C = L.undefined(valuation=1)\n  sage: C.define( z + C * C )\n```\nCan I simply change this?  (Note that we do not support this recursive definition with valuation=0 anymore.)\n\n```\nSage example in ./combinat.tex, line 654::\n\n  sage: L.<z> = LazyPowerSeriesRing(QQ)\n\nSage example in ./combinat.tex, line 661::\n\n  sage: C = L()\n  sage: C._name = 'C'\n  sage: C.define( z + C * C )\n\nSage example in ./combinat.tex, line 666::\n\n  sage: [C.coefficient(i) for i in range(11)]\n  [0, 1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862]\n```",
    "created_at": "2022-09-03T09:30:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644569",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:32'></a>
There is one doctest from a book which we cannot sensibly support anymore, see below.

In short:

```
  sage: L.<z> = LazyPowerSeriesRing(QQ)
  sage: C = L()
  sage: C._name = 'C'
  sage: C.define( z + C * C )
```
must become

```
  sage: L.<z> = LazyPowerSeriesRing(QQ)
  sage: C = L.undefined(valuation=1)
  sage: C.define( z + C * C )
```
Can I simply change this?  (Note that we do not support this recursive definition with valuation=0 anymore.)

```
Sage example in ./combinat.tex, line 654::

  sage: L.<z> = LazyPowerSeriesRing(QQ)

Sage example in ./combinat.tex, line 661::

  sage: C = L()
  sage: C._name = 'C'
  sage: C.define( z + C * C )

Sage example in ./combinat.tex, line 666::

  sage: [C.coefficient(i) for i in range(11)]
  [0, 1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862]
```



---

archive/issue_comments_644570.json:
```json
{
    "body": "<a id='comment:33'></a>\nSimilarly, also in `src/sage/tests/books/computational-mathematics-with-sagemath/`, but `polynomes.tex`.\n\nI think we can make `exponential` an alias, but `compute_coefficients` does not really make sense anymore.\n\n```\n  sage: L.<x> = LazyPowerSeriesRing(QQ)\n  sage: lazy_exp = x.exponential(); lazy_exp\n  O(1)\n\nSage example in ./polynomes.tex, line 2039::\n\n  sage: lazy_exp[5]\n  1/120\n  sage: lazy_exp\n  1 + x + 1/2*x^2 + 1/6*x^3 + 1/24*x^4 + 1/120*x^5 + O(x^6)\n\nSage example in ./polynomes.tex, line 2062::\n\n  sage: f = L(1)  # the constant lazy series 1\n  sage: for i in range(5):\n  ....:     f = (x*f).exponential()\n  ....:     f.compute_coefficients(5) # forces the computation\n  ....:     print(f)                  # of the first coefficients\n  1 + x + 1/2*x^2 + 1/6*x^3 + 1/24*x^4 + 1/120*x^5 + O(x^6)\n  1 + x + 3/2*x^2 + 5/3*x^3 + 41/24*x^4 + 49/30*x^5 + O(x^6)\n  1 + x + 3/2*x^2 + 8/3*x^3 + 101/24*x^4 + 63/10*x^5 + O(x^6)\n  1 + x + 3/2*x^2 + 8/3*x^3 + 125/24*x^4 + 49/5*x^5 + O(x^6)\n  1 + x + 3/2*x^2 + 8/3*x^3 + 125/24*x^4 + 54/5*x^5 + O(x^6)\n```\nFinally:\n\n```\nSage example in ./polynomes.tex, line 2105::\n\n  sage: from sage.combinat.species.series import LazyPowerSeries\n  sage: f = LazyPowerSeries(L, name='f')\n  sage: f.define((x*f).exponential())\n  sage: f.coefficients(8)\n  [1, 1, 3/2, 8/3, 125/24, 54/5, 16807/720, 16384/315]\n```\n(`L` is the lazy power series ring here)",
    "created_at": "2022-09-03T09:37:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644570",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:33'></a>
Similarly, also in `src/sage/tests/books/computational-mathematics-with-sagemath/`, but `polynomes.tex`.

I think we can make `exponential` an alias, but `compute_coefficients` does not really make sense anymore.

```
  sage: L.<x> = LazyPowerSeriesRing(QQ)
  sage: lazy_exp = x.exponential(); lazy_exp
  O(1)

Sage example in ./polynomes.tex, line 2039::

  sage: lazy_exp[5]
  1/120
  sage: lazy_exp
  1 + x + 1/2*x^2 + 1/6*x^3 + 1/24*x^4 + 1/120*x^5 + O(x^6)

Sage example in ./polynomes.tex, line 2062::

  sage: f = L(1)  # the constant lazy series 1
  sage: for i in range(5):
  ....:     f = (x*f).exponential()
  ....:     f.compute_coefficients(5) # forces the computation
  ....:     print(f)                  # of the first coefficients
  1 + x + 1/2*x^2 + 1/6*x^3 + 1/24*x^4 + 1/120*x^5 + O(x^6)
  1 + x + 3/2*x^2 + 5/3*x^3 + 41/24*x^4 + 49/30*x^5 + O(x^6)
  1 + x + 3/2*x^2 + 8/3*x^3 + 101/24*x^4 + 63/10*x^5 + O(x^6)
  1 + x + 3/2*x^2 + 8/3*x^3 + 125/24*x^4 + 49/5*x^5 + O(x^6)
  1 + x + 3/2*x^2 + 8/3*x^3 + 125/24*x^4 + 54/5*x^5 + O(x^6)
```
Finally:

```
Sage example in ./polynomes.tex, line 2105::

  sage: from sage.combinat.species.series import LazyPowerSeries
  sage: f = LazyPowerSeries(L, name='f')
  sage: f.define((x*f).exponential())
  sage: f.coefficients(8)
  [1, 1, 3/2, 8/3, 125/24, 54/5, 16807/720, 16384/315]
```
(`L` is the lazy power series ring here)



---

archive/issue_comments_644571.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2022-09-03T09:42:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644571",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_644572.json:
```json
{
    "body": "<a id='comment:35'></a>\nI thought we also supported iterators too, but it is possible that we don\u2019t. I don\u2019t quite have any explicit memory of what we did other than have a discussion about how to handle them. It might have fallen through the cracks.\n\nWe can make these changes. The standard thing to do is to cc the book author(s) to let them know.\n\nI guess we don\u2019t have a good mechanism for finding out what is the smallest valuation for a `define()` series should make sense. I remember us talking about this for Laurent series and not knowing there is a unique solution, much less knowing what lower bound might work. The issue for the power series was we had to try and catch an infinite recursion error (which would be very bad practice because it would hide bugs). I don\u2019t think we talked too much about other solutions. When we have one unknown function, we could take its `_approximate_order` to be a variable, e.g., `n` and take the ceiling of the smallest positive real root of `f(n) - n`, where `f` is the function that we get from the `define()` input `_approximate_order`.\n\nWell, if we don\u2019t want to try anything like this beforehand (or it becomes too much work), then we can simply change the test (and I would say it is better for the user to supply anyways). (That is also a very evil test. `:p`)\n\nI think `exponential()` is a good alias to have. I would add a deprecation for `compute_coefficients()` and remove the line in the above doctest.",
    "created_at": "2022-09-03T11:15:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644572",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:35'></a>
I thought we also supported iterators too, but it is possible that we don’t. I don’t quite have any explicit memory of what we did other than have a discussion about how to handle them. It might have fallen through the cracks.

We can make these changes. The standard thing to do is to cc the book author(s) to let them know.

I guess we don’t have a good mechanism for finding out what is the smallest valuation for a `define()` series should make sense. I remember us talking about this for Laurent series and not knowing there is a unique solution, much less knowing what lower bound might work. The issue for the power series was we had to try and catch an infinite recursion error (which would be very bad practice because it would hide bugs). I don’t think we talked too much about other solutions. When we have one unknown function, we could take its `_approximate_order` to be a variable, e.g., `n` and take the ceiling of the smallest positive real root of `f(n) - n`, where `f` is the function that we get from the `define()` input `_approximate_order`.

Well, if we don’t want to try anything like this beforehand (or it becomes too much work), then we can simply change the test (and I would say it is better for the user to supply anyways). (That is also a very evil test. `:p`)

I think `exponential()` is a good alias to have. I would add a deprecation for `compute_coefficients()` and remove the line in the above doctest.



---

archive/issue_comments_644573.json:
```json
{
    "body": "<a id='comment:36'></a>\nImportant and somewhat urgent question:\n\nSupport for passing generators turns out to be easy, but there is a question of semantics.  If the valuation is specified, should it refer to the first term yielded by the generator, or the first non-zero term yielded by the generator.\n\nBoth is easy to achieve.\n\nBy way of example: do we want\n\n```\nsage: L.<x> = LazyLaurentSeriesRing(QQ); L(iter(NN), valuation=-3)\nx^-3 + 2*x^-2 + 3*x^-1 + 4 + 5*x + 6*x^2 + O(x^3)\n```\nor\n\n```\nsage: L.<x> = LazyLaurentSeriesRing(QQ); L(iter(NN), valuation=-3)\nx^-2 + 2*x^-1 + 3 + 4*x + 5*x^2 + 6*x^3 + O(x^4)\n```\n\nCompare with our current decisions:\n\n```\nsage: L.<x> = LazyLaurentSeriesRing(QQ); L(range(5), valuation=-3)\nx^-3 + 2*x^-2 + 3*x^-1 + 4\nsage: L.<x> = LazyLaurentSeriesRing(QQ); L(lambda n: n+3, valuation=-3)\nx^-2 + 2*x^-1 + 3 + 4*x + 5*x^2 + 6*x^3 + O(x^4)\n```",
    "created_at": "2022-09-04T08:32:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644573",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:36'></a>
Important and somewhat urgent question:

Support for passing generators turns out to be easy, but there is a question of semantics.  If the valuation is specified, should it refer to the first term yielded by the generator, or the first non-zero term yielded by the generator.

Both is easy to achieve.

By way of example: do we want

```
sage: L.<x> = LazyLaurentSeriesRing(QQ); L(iter(NN), valuation=-3)
x^-3 + 2*x^-2 + 3*x^-1 + 4 + 5*x + 6*x^2 + O(x^3)
```
or

```
sage: L.<x> = LazyLaurentSeriesRing(QQ); L(iter(NN), valuation=-3)
x^-2 + 2*x^-1 + 3 + 4*x + 5*x^2 + 6*x^3 + O(x^4)
```

Compare with our current decisions:

```
sage: L.<x> = LazyLaurentSeriesRing(QQ); L(range(5), valuation=-3)
x^-3 + 2*x^-2 + 3*x^-1 + 4
sage: L.<x> = LazyLaurentSeriesRing(QQ); L(lambda n: n+3, valuation=-3)
x^-2 + 2*x^-1 + 3 + 4*x + 5*x^2 + 6*x^3 + O(x^4)
```



---

archive/issue_comments_644574.json:
```json
{
    "body": "<a id='comment:37'></a>\nThe first nonzero term following our statement that passing the `valuation` means the series exactly has that valuation.\n\nWe might want to do something as a safety guard of running forever (say 1000 trials) if someone does something crazy like pass\n\n```\ndef zero():\n    while True: yield 0\n```\n(This might arise more naturally if someone passes something that is not known to be exactly `0` but ends up being `0` and doing some iteration over that.)",
    "created_at": "2022-09-04T09:25:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644574",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:37'></a>
The first nonzero term following our statement that passing the `valuation` means the series exactly has that valuation.

We might want to do something as a safety guard of running forever (say 1000 trials) if someone does something crazy like pass

```
def zero():
    while True: yield 0
```
(This might arise more naturally if someone passes something that is not known to be exactly `0` but ends up being `0` and doing some iteration over that.)



---

archive/issue_comments_644575.json:
```json
{
    "body": "<a id='comment:38'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|\n|[b76d8f4](https://github.com/sagemath/sagetrac-mirror/commit/b76d8f40ac50839297cb25fe23da16c0c0a8c49c)|`allow to define lazy series using iterators, adapt doctest`|",
    "created_at": "2022-09-07T20:37:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644575",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
|[b76d8f4](https://github.com/sagemath/sagetrac-mirror/commit/b76d8f40ac50839297cb25fe23da16c0c0a8c49c)|`allow to define lazy series using iterators, adapt doctest`|



---

archive/issue_comments_644576.json:
```json
{
    "body": "Changing commit from \"89270ebb1e49759628c1db69de93744a0d3b29df\" to \"b76d8f40ac50839297cb25fe23da16c0c0a8c49c\"",
    "created_at": "2022-09-07T20:37:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644576",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "89270ebb1e49759628c1db69de93744a0d3b29df" to "b76d8f40ac50839297cb25fe23da16c0c0a8c49c"



---

archive/issue_comments_644577.json:
```json
{
    "body": "<a id='comment:39'></a>\nThere are a few further minor issues.\n\nI think that for `LazyTaylorSeries`, `LazyDirichletSeries`, `LazySymmetricFunction`, etc. we really don't want\n\n```\nsage: L.<x> = LazyTaylorSeriesRing(QQ)\nsage: (x^2/(1-x)^3)[:5]\n[1, 3, 6]\nsage: L(lambda n: n*(n-1)/2)[:5]\n[0, 0, 1, 3, 6]\n```\nInstead, I think that for these classes we always want to start from degree 0.\nThe current behaviour also breaks some doctests in the species directory.\n\nI am also hesitant to encode a `coefficients` method with behaviour quite different from the other methods with the same name.  In particular, we have\n\n```\n    def coefficients(self):\n        \"\"\"\n        Return the nonzero coefficients of this polynomial in a list.\n        The returned list is decreasingly ordered by the term ordering\n        of ``self.parent()``, i.e. the list of coefficients matches the list\n        of monomials returned by\n        :meth:`sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.monomials`.\n\n        EXAMPLES::\n\n            sage: R.<x,y,z> = PolynomialRing(QQ,3,order='degrevlex')\n            sage: f=23*x^6*y^7 + x^3*y+6*x^7*z\n            sage: f.coefficients()\n            [23, 6, 1]\n            sage: R.<x,y,z> = PolynomialRing(QQ,3,order='lex')\n            sage: f=23*x^6*y^7 + x^3*y+6*x^7*z\n            sage: f.coefficients()\n            [6, 23, 1]\n\n        Test the same stuff with base ring `\\ZZ` -- different implementation::\n\n            sage: R.<x,y,z> = PolynomialRing(ZZ,3,order='degrevlex')\n            sage: f=23*x^6*y^7 + x^3*y+6*x^7*z\n            sage: f.coefficients()\n            [23, 6, 1]\n            sage: R.<x,y,z> = PolynomialRing(ZZ,3,order='lex')\n            sage: f=23*x^6*y^7 + x^3*y+6*x^7*z\n            sage: f.coefficients()\n            [6, 23, 1]\n```\nAs far as I can see, there is a single exception to the behaviour indicated by the doctests above, which is the definition in `multi_power_series_ring_elemnt.py`.\n\nI could imagine returning a `lazy_list` and a list, if the support is known to be finite.  Unfortunately, for the code in species, the default behaviour is `sparse=False`, whereas in all other cases, it is `sparse=True`.\n\nAnother minor issue: for `L.<x> = LazyPowerSeriesRing(QQ)` we had `L([1,2,3])` what would now be `L([1,2], constant = 3)`.  However, I really do not want to replicate this behaviour.",
    "created_at": "2022-09-08T15:34:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644577",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:39'></a>
There are a few further minor issues.

I think that for `LazyTaylorSeries`, `LazyDirichletSeries`, `LazySymmetricFunction`, etc. we really don't want

```
sage: L.<x> = LazyTaylorSeriesRing(QQ)
sage: (x^2/(1-x)^3)[:5]
[1, 3, 6]
sage: L(lambda n: n*(n-1)/2)[:5]
[0, 0, 1, 3, 6]
```
Instead, I think that for these classes we always want to start from degree 0.
The current behaviour also breaks some doctests in the species directory.

I am also hesitant to encode a `coefficients` method with behaviour quite different from the other methods with the same name.  In particular, we have

```
    def coefficients(self):
        """
        Return the nonzero coefficients of this polynomial in a list.
        The returned list is decreasingly ordered by the term ordering
        of ``self.parent()``, i.e. the list of coefficients matches the list
        of monomials returned by
        :meth:`sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.monomials`.

        EXAMPLES::

            sage: R.<x,y,z> = PolynomialRing(QQ,3,order='degrevlex')
            sage: f=23*x^6*y^7 + x^3*y+6*x^7*z
            sage: f.coefficients()
            [23, 6, 1]
            sage: R.<x,y,z> = PolynomialRing(QQ,3,order='lex')
            sage: f=23*x^6*y^7 + x^3*y+6*x^7*z
            sage: f.coefficients()
            [6, 23, 1]

        Test the same stuff with base ring `\ZZ` -- different implementation::

            sage: R.<x,y,z> = PolynomialRing(ZZ,3,order='degrevlex')
            sage: f=23*x^6*y^7 + x^3*y+6*x^7*z
            sage: f.coefficients()
            [23, 6, 1]
            sage: R.<x,y,z> = PolynomialRing(ZZ,3,order='lex')
            sage: f=23*x^6*y^7 + x^3*y+6*x^7*z
            sage: f.coefficients()
            [6, 23, 1]
```
As far as I can see, there is a single exception to the behaviour indicated by the doctests above, which is the definition in `multi_power_series_ring_elemnt.py`.

I could imagine returning a `lazy_list` and a list, if the support is known to be finite.  Unfortunately, for the code in species, the default behaviour is `sparse=False`, whereas in all other cases, it is `sparse=True`.

Another minor issue: for `L.<x> = LazyPowerSeriesRing(QQ)` we had `L([1,2,3])` what would now be `L([1,2], constant = 3)`.  However, I really do not want to replicate this behaviour.



---

archive/issue_comments_644578.json:
```json
{
    "body": "Changing commit from \"b76d8f40ac50839297cb25fe23da16c0c0a8c49c\" to \"4eb4dbd483cbac03078e0d709a8487c4f18ad219\"",
    "created_at": "2022-09-08T20:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644578",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b76d8f40ac50839297cb25fe23da16c0c0a8c49c" to "4eb4dbd483cbac03078e0d709a8487c4f18ad219"



---

archive/issue_comments_644579.json:
```json
{
    "body": "<a id='comment:41'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|\n|[4eb4dbd](https://github.com/sagemath/sagetrac-mirror/commit/4eb4dbd483cbac03078e0d709a8487c4f18ad219)|`fix behaviour of __getitem__ for slices, provide missing doctests, minor simplifications in species directory`|",
    "created_at": "2022-09-08T20:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644579",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
|[4eb4dbd](https://github.com/sagemath/sagetrac-mirror/commit/4eb4dbd483cbac03078e0d709a8487c4f18ad219)|`fix behaviour of __getitem__ for slices, provide missing doctests, minor simplifications in species directory`|



---

archive/issue_comments_644580.json:
```json
{
    "body": "Changing commit from \"4eb4dbd483cbac03078e0d709a8487c4f18ad219\" to \"6f76b00e9f2aa3e39118b8278349f48de0753c05\"",
    "created_at": "2022-09-08T20:21:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644580",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4eb4dbd483cbac03078e0d709a8487c4f18ad219" to "6f76b00e9f2aa3e39118b8278349f48de0753c05"



---

archive/issue_comments_644581.json:
```json
{
    "body": "<a id='comment:42'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|\n|[6f76b00](https://github.com/sagemath/sagetrac-mirror/commit/6f76b00e9f2aa3e39118b8278349f48de0753c05)|`replace LazyTaylorSeriesRing and LazyTaylorSeries with LazyPowerSeriesRing and LazyPowerSeries and add appropriate deprecations`|",
    "created_at": "2022-09-08T20:21:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644581",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:42'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|
|[6f76b00](https://github.com/sagemath/sagetrac-mirror/commit/6f76b00e9f2aa3e39118b8278349f48de0753c05)|`replace LazyTaylorSeriesRing and LazyTaylorSeries with LazyPowerSeriesRing and LazyPowerSeries and add appropriate deprecations`|



---

archive/issue_comments_644582.json:
```json
{
    "body": "<a id='comment:43'></a>\nThis last push could be moved into a separate ticket if absolutely necessary.\n\nApart from that, the only thing missing is a decision about the semantics of the `coefficients` function.",
    "created_at": "2022-09-08T20:22:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644582",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:43'></a>
This last push could be moved into a separate ticket if absolutely necessary.

Apart from that, the only thing missing is a decision about the semantics of the `coefficients` function.



---

archive/issue_comments_644583.json:
```json
{
    "body": "<a id='comment:44'></a>\nReplying to [Martin Rubey](#comment%3A39):\n> I think that for `LazyTaylorSeries`, `LazyDirichletSeries`, `LazySymmetricFunction`, etc. we really don't want\n> \n> ```\n> sage: L.<x> = LazyTaylorSeriesRing(QQ)\n> sage: (x^2/(1-x)^3)[:5]\n> [1, 3, 6]\n> sage: L(lambda n: n*(n-1)/2)[:5]\n> [0, 0, 1, 3, 6]\n> ```\n> Instead, I think that for these classes we always want to start from degree 0.\n> The current behaviour also breaks some doctests in the species directory.\n\n\nI would say that is a bug and should be fixed (which I think is what you\u2019re saying as well).\n\n> I am also hesitant to encode a `coefficients` method with behaviour quite different from the other methods with the same name.  In particular, we have\n> \n> ```\n>     def coefficients(self):\n>         \"\"\"\n>         Return the nonzero coefficients of this polynomial in a list.\n>         The returned list is decreasingly ordered by the term ordering\n>         of ``self.parent()``, i.e. the list of coefficients matches the list\n>         of monomials returned by\n>         :meth:`sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.monomials`.\n> ```\n> As far as I can see, there is a single exception to the behaviour indicated by the doctests above, which is the definition in `multi_power_series_ring_elemnt.py`.\n\n\nI agree with you. It\u2019s not a bug, so we are not justified in simply changing the behavior. Although I feel a general deprecation message every time this is call would be obtrusive (and bad). I am leaning towards just making the backwards incompatible change, documenting how to get the previous behavior `[f[i] for i in range(n)]`, and dealing with the consequences, but it was used all over the examples. I can\u2019t think of a good way out of this other than something convoluted with an extra argument. Thus, we probably just have to make the change and take our medicine.\n\n> I could imagine returning a `lazy_list` and a list, if the support is known to be finite.  Unfortunately, for the code in species, the default behaviour is `sparse=False`, whereas in all other cases, it is `sparse=True`.\n\n\nI don\u2019t think it is so important whether the backend is sparse or dense. I think you\u2019re intuition is correct in returning a `lazy_list` unless the series is known to be finite.\n \n> Another minor issue: for `L.<x> = LazyPowerSeriesRing(QQ)` we had `L([1,2,3])` what would now be `L([1,2], constant = 3)`.  However, I really do not want to replicate this behaviour.\n\n\nEek, that is highly unexpected. Did we think that should be the behavior at some point? I (now?) think we should have list input be the corresponding finite to match what polynomials do.",
    "created_at": "2022-09-08T23:52:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644583",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:44'></a>
Replying to [Martin Rubey](#comment%3A39):
> I think that for `LazyTaylorSeries`, `LazyDirichletSeries`, `LazySymmetricFunction`, etc. we really don't want
> 
> ```
> sage: L.<x> = LazyTaylorSeriesRing(QQ)
> sage: (x^2/(1-x)^3)[:5]
> [1, 3, 6]
> sage: L(lambda n: n*(n-1)/2)[:5]
> [0, 0, 1, 3, 6]
> ```
> Instead, I think that for these classes we always want to start from degree 0.
> The current behaviour also breaks some doctests in the species directory.


I would say that is a bug and should be fixed (which I think is what you’re saying as well).

> I am also hesitant to encode a `coefficients` method with behaviour quite different from the other methods with the same name.  In particular, we have
> 
> ```
>     def coefficients(self):
>         """
>         Return the nonzero coefficients of this polynomial in a list.
>         The returned list is decreasingly ordered by the term ordering
>         of ``self.parent()``, i.e. the list of coefficients matches the list
>         of monomials returned by
>         :meth:`sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.monomials`.
> ```
> As far as I can see, there is a single exception to the behaviour indicated by the doctests above, which is the definition in `multi_power_series_ring_elemnt.py`.


I agree with you. It’s not a bug, so we are not justified in simply changing the behavior. Although I feel a general deprecation message every time this is call would be obtrusive (and bad). I am leaning towards just making the backwards incompatible change, documenting how to get the previous behavior `[f[i] for i in range(n)]`, and dealing with the consequences, but it was used all over the examples. I can’t think of a good way out of this other than something convoluted with an extra argument. Thus, we probably just have to make the change and take our medicine.

> I could imagine returning a `lazy_list` and a list, if the support is known to be finite.  Unfortunately, for the code in species, the default behaviour is `sparse=False`, whereas in all other cases, it is `sparse=True`.


I don’t think it is so important whether the backend is sparse or dense. I think you’re intuition is correct in returning a `lazy_list` unless the series is known to be finite.
 
> Another minor issue: for `L.<x> = LazyPowerSeriesRing(QQ)` we had `L([1,2,3])` what would now be `L([1,2], constant = 3)`.  However, I really do not want to replicate this behaviour.


Eek, that is highly unexpected. Did we think that should be the behavior at some point? I (now?) think we should have list input be the corresponding finite to match what polynomials do.



---

archive/issue_comments_644584.json:
```json
{
    "body": "<a id='comment:45'></a>\nReplying to [Travis Scrimshaw](#comment%3A44):\n> Replying to [Martin Rubey](#comment%3A39):\n> > I think that for `LazyTaylorSeries`, `LazyDirichletSeries`, `LazySymmetricFunction`, etc. we really don't want\n> > \n> > ```\n> > sage: L.<x> = LazyTaylorSeriesRing(QQ)\n> > sage: (x^2/(1-x)^3)[:5]\n> > [1, 3, 6]\n> > sage: L(lambda n: n*(n-1)/2)[:5]\n> > [0, 0, 1, 3, 6]\n> > ```\n> > Instead, I think that for these classes we always want to start from degree 0.\n\n> \n> I would say that is a bug and should be fixed (which I think is what you\u2019re saying as well).\n\n\nYes, that's done already in the commit in[comment:41](#comment%3A41).\n\n> > I am also hesitant to encode a `coefficients` method with behaviour quite different from the other methods with the same name.  In particular, we have\n\n\n[in `multi_polynomia.pyx`]\n\n> > {{{\n> >     def coefficients(self):\n> >         \"\"\"\n> >         Return the nonzero coefficients of this polynomial in a list.\n\n\n> > As far as I can see, there is a single exception to the behaviour indicated by the doctests above, which is the definition in `multi_power_series_ring_elemnt.py`.\n\n> \n> I agree with you. It\u2019s not a bug, so we are not justified in simply changing the behavior. Although I feel a general deprecation message every time this is call would be obtrusive (and bad). I am leaning towards just making the backwards incompatible change, documenting how to get the previous behavior `[f[i] for i in range(n)]`, and dealing with the consequences, but it was used all over the examples. I can\u2019t think of a good way out of this other than something convoluted with an extra argument. Thus, we probably just have to make the change and take our medicine.\n\n\nJust to be clear: making the definition as\n\n```\ndef coefficients(self, n=None, sparse=False):\n```\ni.e., with default behaviour as it is now, but with an option that makes it in line with the other coefficient methods in sage is *not* what we should do?\n\nI must say, if we make the default `sparse=True`, i.e., introduce a backwards incompatible change, then I think we really should provide a deprecation warning.  One might not notice immediately that zeros are missing all of a sudden.\n\nPossibly, to make this decision slightly less important, I could put the definition into the generating functions module only, or, alternatively, only into `LazyPowerSeries`, and raise a `NotImplementedError` for multivariate series.\n\n> > Another minor issue: for `L.<x> = LazyPowerSeriesRing(QQ)` we had `L([1,2,3])` what would now be `L([1,2], constant = 3)`.  However, I really do not want to replicate this behaviour.\n\n> \n> Eek, that is highly unexpected.\n\n\nAs far as I remember we discussed this issue and decided that we cannot do anything sensible about it.  I think I'll put a\n\n```\n.. WARNING::\n\n    The behaviour of ``LazyPowerSeries(l)`` for a list ``l`` with non-zero last element `e` changed with :trac:`32367`.  To obtain the old behaviour, use ``LazyPowerSeries(l, constant=e)``.\n```\ninto the docstring of the (new) LazyPowerSeries.",
    "created_at": "2022-09-09T06:50:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644584",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:45'></a>
Replying to [Travis Scrimshaw](#comment%3A44):
> Replying to [Martin Rubey](#comment%3A39):
> > I think that for `LazyTaylorSeries`, `LazyDirichletSeries`, `LazySymmetricFunction`, etc. we really don't want
> > 
> > ```
> > sage: L.<x> = LazyTaylorSeriesRing(QQ)
> > sage: (x^2/(1-x)^3)[:5]
> > [1, 3, 6]
> > sage: L(lambda n: n*(n-1)/2)[:5]
> > [0, 0, 1, 3, 6]
> > ```
> > Instead, I think that for these classes we always want to start from degree 0.

> 
> I would say that is a bug and should be fixed (which I think is what you’re saying as well).


Yes, that's done already in the commit in[comment:41](#comment%3A41).

> > I am also hesitant to encode a `coefficients` method with behaviour quite different from the other methods with the same name.  In particular, we have


[in `multi_polynomia.pyx`]

> > {{{
> >     def coefficients(self):
> >         """
> >         Return the nonzero coefficients of this polynomial in a list.


> > As far as I can see, there is a single exception to the behaviour indicated by the doctests above, which is the definition in `multi_power_series_ring_elemnt.py`.

> 
> I agree with you. It’s not a bug, so we are not justified in simply changing the behavior. Although I feel a general deprecation message every time this is call would be obtrusive (and bad). I am leaning towards just making the backwards incompatible change, documenting how to get the previous behavior `[f[i] for i in range(n)]`, and dealing with the consequences, but it was used all over the examples. I can’t think of a good way out of this other than something convoluted with an extra argument. Thus, we probably just have to make the change and take our medicine.


Just to be clear: making the definition as

```
def coefficients(self, n=None, sparse=False):
```
i.e., with default behaviour as it is now, but with an option that makes it in line with the other coefficient methods in sage is *not* what we should do?

I must say, if we make the default `sparse=True`, i.e., introduce a backwards incompatible change, then I think we really should provide a deprecation warning.  One might not notice immediately that zeros are missing all of a sudden.

Possibly, to make this decision slightly less important, I could put the definition into the generating functions module only, or, alternatively, only into `LazyPowerSeries`, and raise a `NotImplementedError` for multivariate series.

> > Another minor issue: for `L.<x> = LazyPowerSeriesRing(QQ)` we had `L([1,2,3])` what would now be `L([1,2], constant = 3)`.  However, I really do not want to replicate this behaviour.

> 
> Eek, that is highly unexpected.


As far as I remember we discussed this issue and decided that we cannot do anything sensible about it.  I think I'll put a

```
.. WARNING::

    The behaviour of ``LazyPowerSeries(l)`` for a list ``l`` with non-zero last element `e` changed with :trac:`32367`.  To obtain the old behaviour, use ``LazyPowerSeries(l, constant=e)``.
```
into the docstring of the (new) LazyPowerSeries.



---

archive/issue_comments_644585.json:
```json
{
    "body": "<a id='comment:46'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------|\n|[f5e3f2e](https://github.com/sagemath/sagetrac-mirror/commit/f5e3f2ef6f0c1757881e16c1563833cf119f4a83)|`fix documentation`|",
    "created_at": "2022-09-09T10:46:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644585",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:46'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------|
|[f5e3f2e](https://github.com/sagemath/sagetrac-mirror/commit/f5e3f2ef6f0c1757881e16c1563833cf119f4a83)|`fix documentation`|



---

archive/issue_comments_644586.json:
```json
{
    "body": "Changing commit from \"6f76b00e9f2aa3e39118b8278349f48de0753c05\" to \"f5e3f2ef6f0c1757881e16c1563833cf119f4a83\"",
    "created_at": "2022-09-09T10:46:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644586",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6f76b00e9f2aa3e39118b8278349f48de0753c05" to "f5e3f2ef6f0c1757881e16c1563833cf119f4a83"



---

archive/issue_comments_644587.json:
```json
{
    "body": "<a id='comment:47'></a>\nI added a warning for the new behaviour concerning the specification of the constant.",
    "created_at": "2022-09-09T10:47:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644587",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:47'></a>
I added a warning for the new behaviour concerning the specification of the constant.



---

archive/issue_comments_644588.json:
```json
{
    "body": "Changing commit from \"f5e3f2ef6f0c1757881e16c1563833cf119f4a83\" to \"c5bfba5f8e8d41bc6341b7a490ae56469e2adcae\"",
    "created_at": "2022-09-09T18:27:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644588",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f5e3f2ef6f0c1757881e16c1563833cf119f4a83" to "c5bfba5f8e8d41bc6341b7a490ae56469e2adcae"



---

archive/issue_comments_644589.json:
```json
{
    "body": "<a id='comment:48'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------|\n|[c5bfba5](https://github.com/sagemath/sagetrac-mirror/commit/c5bfba5f8e8d41bc6341b7a490ae56469e2adcae)|`adapt a doctest`|",
    "created_at": "2022-09-09T18:27:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644589",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:48'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------|
|[c5bfba5](https://github.com/sagemath/sagetrac-mirror/commit/c5bfba5f8e8d41bc6341b7a490ae56469e2adcae)|`adapt a doctest`|



---

archive/issue_comments_644590.json:
```json
{
    "body": "<a id='comment:49'></a>\nReplying to [Martin Rubey](#comment%3A45):\n> Replying to [Travis Scrimshaw](#comment%3A44):\n> > Replying to [Martin Rubey](#comment%3A39):\n> > > I am also hesitant to encode a `coefficients` method with behaviour quite different from the other methods with the same name. \n\n> > >\n> > > [snip]\n> > > \n> > > As far as I can see, there is a single exception to the behaviour indicated by the doctests above, which is the definition in `multi_power_series_ring_elemnt.py`.\n\n> > \n> > I agree with you. It\u2019s not a bug, so we are not justified in simply changing the behavior. Although I feel a general deprecation message every time this is call would be obtrusive (and bad). I am leaning towards just making the backwards incompatible change, documenting how to get the previous behavior `[f[i] for i in range(n)]`, and dealing with the consequences, but it was used all over the examples. I can\u2019t think of a good way out of this other than something convoluted with an extra argument. Thus, we probably just have to make the change and take our medicine.\n\n> \n> Just to be clear: making the definition as\n> \n> ```\n> def coefficients(self, n=None, sparse=False):\n> ```\n> i.e., with default behaviour as it is now, but with an option that makes it in line with the other coefficient methods in sage is *not* what we should do?\n\n\nNo, I agree with you that it is what we should do. The problem is how to do this with an effective and unobtrusive deprecation.\n\n> I must say, if we make the default `sparse=True`, i.e., introduce a backwards incompatible change, then I think we really should provide a deprecation warning.  One might not notice immediately that zeros are missing all of a sudden.\n\n\nThen we are introducing a new argument that we then have to add to code, which we will also want to deprecate later. This becomes a hassle on both the developer and user side.\n\nActually, maybe we can just issue a deprecation on the `n` parameter, where we also say this now will return only nonzero coefficients? If people are passing `n`, then they are expecting the old behavior.\n\nGiven the other backwards-incompatible change we are making (the one below), it isn\u2019t much more painful to do a second one at the same time either.\n \n> Possibly, to make this decision slightly less important, I could put the definition into the generating functions module only, or, alternatively, only into `LazyPowerSeries`, and raise a `NotImplementedError` for multivariate series.\n\n\nI think it is better to be consistent about this.\n\n> > > Another minor issue: for `L.<x> = LazyPowerSeriesRing(QQ)` we had `L([1,2,3])` what would now be `L([1,2], constant = 3)`.  However, I really do not want to replicate this behaviour.\n\n> > \n> > Eek, that is highly unexpected.\n\n> \n> As far as I remember we discussed this issue and decided that we cannot do anything sensible about it.  I think I'll put a\n> \n> ```\n> .. WARNING::\n> \n>     The behaviour of ``LazyPowerSeries(l)`` for a list ``l`` with non-zero last element `e` changed with :trac:`32367`.  To obtain the old behaviour, use ``LazyPowerSeries(l, constant=e)``.\n> ```\n> into the docstring of the (new) `LazyPowerSeries`.\n\n\nAh, I misread it initially. This was the behavior of the old `LazyPowerSeries`. Just two little things with this:\n\n- Use `L` instead of `l` since it has a chance to be read as `I` depending on the font (like the one I am using to type this comment in fact).\n- Make sure there is an easy to see example of the new constant behavior is clearly visible (in the class-level ring doc, its `_element_constructor_`, the element class\u2019s class-level doc; the module-level doc if there are examples there).",
    "created_at": "2022-09-09T23:23:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644590",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:49'></a>
Replying to [Martin Rubey](#comment%3A45):
> Replying to [Travis Scrimshaw](#comment%3A44):
> > Replying to [Martin Rubey](#comment%3A39):
> > > I am also hesitant to encode a `coefficients` method with behaviour quite different from the other methods with the same name. 

> > >
> > > [snip]
> > > 
> > > As far as I can see, there is a single exception to the behaviour indicated by the doctests above, which is the definition in `multi_power_series_ring_elemnt.py`.

> > 
> > I agree with you. It’s not a bug, so we are not justified in simply changing the behavior. Although I feel a general deprecation message every time this is call would be obtrusive (and bad). I am leaning towards just making the backwards incompatible change, documenting how to get the previous behavior `[f[i] for i in range(n)]`, and dealing with the consequences, but it was used all over the examples. I can’t think of a good way out of this other than something convoluted with an extra argument. Thus, we probably just have to make the change and take our medicine.

> 
> Just to be clear: making the definition as
> 
> ```
> def coefficients(self, n=None, sparse=False):
> ```
> i.e., with default behaviour as it is now, but with an option that makes it in line with the other coefficient methods in sage is *not* what we should do?


No, I agree with you that it is what we should do. The problem is how to do this with an effective and unobtrusive deprecation.

> I must say, if we make the default `sparse=True`, i.e., introduce a backwards incompatible change, then I think we really should provide a deprecation warning.  One might not notice immediately that zeros are missing all of a sudden.


Then we are introducing a new argument that we then have to add to code, which we will also want to deprecate later. This becomes a hassle on both the developer and user side.

Actually, maybe we can just issue a deprecation on the `n` parameter, where we also say this now will return only nonzero coefficients? If people are passing `n`, then they are expecting the old behavior.

Given the other backwards-incompatible change we are making (the one below), it isn’t much more painful to do a second one at the same time either.
 
> Possibly, to make this decision slightly less important, I could put the definition into the generating functions module only, or, alternatively, only into `LazyPowerSeries`, and raise a `NotImplementedError` for multivariate series.


I think it is better to be consistent about this.

> > > Another minor issue: for `L.<x> = LazyPowerSeriesRing(QQ)` we had `L([1,2,3])` what would now be `L([1,2], constant = 3)`.  However, I really do not want to replicate this behaviour.

> > 
> > Eek, that is highly unexpected.

> 
> As far as I remember we discussed this issue and decided that we cannot do anything sensible about it.  I think I'll put a
> 
> ```
> .. WARNING::
> 
>     The behaviour of ``LazyPowerSeries(l)`` for a list ``l`` with non-zero last element `e` changed with :trac:`32367`.  To obtain the old behaviour, use ``LazyPowerSeries(l, constant=e)``.
> ```
> into the docstring of the (new) `LazyPowerSeries`.


Ah, I misread it initially. This was the behavior of the old `LazyPowerSeries`. Just two little things with this:

- Use `L` instead of `l` since it has a chance to be read as `I` depending on the font (like the one I am using to type this comment in fact).
- Make sure there is an easy to see example of the new constant behavior is clearly visible (in the class-level ring doc, its `_element_constructor_`, the element class’s class-level doc; the module-level doc if there are examples there).



---

archive/issue_comments_644591.json:
```json
{
    "body": "<a id='comment:50'></a>\nReplying to [Travis Scrimshaw](#comment%3A49):\n\n> - Use `L` instead of `l` since it has a chance to be read as `I` depending on the font (like the one I am using to type this comment in fact).\n\n\nOK, I am using `c` now, for 'coefficients', since `L` is used for the parent usually.\n\n> - Make sure there is an easy to see example of the new constant behavior is clearly visible (in the class-level ring doc, its `_element_constructor_`, the element class\u2019s class-level doc; the module-level doc if there are examples there).\n\n\nThere are several such examples, eg. line 1344 and beyond.  Note that this change is not so bad as it may look: almost always, the old input was a list ending with 0, because this is the constant you usually want.",
    "created_at": "2022-09-10T06:19:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644591",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:50'></a>
Replying to [Travis Scrimshaw](#comment%3A49):

> - Use `L` instead of `l` since it has a chance to be read as `I` depending on the font (like the one I am using to type this comment in fact).


OK, I am using `c` now, for 'coefficients', since `L` is used for the parent usually.

> - Make sure there is an easy to see example of the new constant behavior is clearly visible (in the class-level ring doc, its `_element_constructor_`, the element class’s class-level doc; the module-level doc if there are examples there).


There are several such examples, eg. line 1344 and beyond.  Note that this change is not so bad as it may look: almost always, the old input was a list ending with 0, because this is the constant you usually want.



---

archive/issue_comments_644592.json:
```json
{
    "body": "Changing commit from \"c5bfba5f8e8d41bc6341b7a490ae56469e2adcae\" to \"ceecc89392820fbbf07f2ad1b9915ac02ac4d6d4\"",
    "created_at": "2022-09-10T06:20:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644592",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c5bfba5f8e8d41bc6341b7a490ae56469e2adcae" to "ceecc89392820fbbf07f2ad1b9915ac02ac4d6d4"



---

archive/issue_comments_644593.json:
```json
{
    "body": "<a id='comment:51'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------|\n|[ceecc89](https://github.com/sagemath/sagetrac-mirror/commit/ceecc89392820fbbf07f2ad1b9915ac02ac4d6d4)|`don't use l`|",
    "created_at": "2022-09-10T06:20:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644593",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:51'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------|
|[ceecc89](https://github.com/sagemath/sagetrac-mirror/commit/ceecc89392820fbbf07f2ad1b9915ac02ac4d6d4)|`don't use l`|



---

archive/issue_comments_644594.json:
```json
{
    "body": "<a id='comment:52'></a>\nHello, we are supposed to be in maintenance mode today, as announced on sage-devel and trac main page. I think everything is now in order, but please try clicking around..",
    "created_at": "2022-09-10T06:23:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644594",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:52'></a>
Hello, we are supposed to be in maintenance mode today, as announced on sage-devel and trac main page. I think everything is now in order, but please try clicking around..



---

archive/issue_comments_644595.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2022-09-10T06:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644595",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_644596.json:
```json
{
    "body": "<a id='comment:53'></a>\nEverything seems to be okay.",
    "created_at": "2022-09-10T06:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644596",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:53'></a>
Everything seems to be okay.



---

archive/issue_comments_644597.json:
```json
{
    "body": "<a id='comment:54'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|\n|[9629b28](https://github.com/sagemath/sagetrac-mirror/commit/9629b2878b228fb2c5623f4d2b1df60e2c4bb287)|`require the start value for __getitem__ of LazyLaurentSeries`|",
    "created_at": "2022-09-10T06:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644597",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:54'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
|[9629b28](https://github.com/sagemath/sagetrac-mirror/commit/9629b2878b228fb2c5623f4d2b1df60e2c4bb287)|`require the start value for __getitem__ of LazyLaurentSeries`|



---

archive/issue_comments_644598.json:
```json
{
    "body": "Changing commit from \"ceecc89392820fbbf07f2ad1b9915ac02ac4d6d4\" to \"9629b2878b228fb2c5623f4d2b1df60e2c4bb287\"",
    "created_at": "2022-09-10T06:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644598",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ceecc89392820fbbf07f2ad1b9915ac02ac4d6d4" to "9629b2878b228fb2c5623f4d2b1df60e2c4bb287"



---

archive/issue_comments_644599.json:
```json
{
    "body": "<a id='comment:55'></a>\nReplying to [Martin Rubey](#comment%3A50):\n> Replying to [Travis Scrimshaw](#comment%3A49):\n> \n> > - Use `L` instead of `l` since it has a chance to be read as `I` depending on the font (like the one I am using to type this comment in fact).\n \n> \n> OK, I am using `c` now, for 'coefficients', since `L` is used for the parent usually.\n\n\nThank you.\n\n> > - Make sure there is an easy to see example of the new constant behavior is clearly visible (in the class-level ring doc, its `_element_constructor_`, the element class\u2019s class-level doc; the module-level doc if there are examples there).\n \n> \n> There are several such examples, eg. line 1344 and beyond.  Note that this change is not so bad as it may look: almost always, the old input was a list ending with 0, because this is the constant you usually want.\n\n\nThank you. I didn't have time to check when I posted that.\n\nGiven your comments, I think this is now at needs review, correct? Feel free to revert if more is still needed.\n\nActually, I think I am mostly ready to turn this to a positive review if the patchbot comes back green.",
    "created_at": "2022-09-10T06:47:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644599",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:55'></a>
Replying to [Martin Rubey](#comment%3A50):
> Replying to [Travis Scrimshaw](#comment%3A49):
> 
> > - Use `L` instead of `l` since it has a chance to be read as `I` depending on the font (like the one I am using to type this comment in fact).
 
> 
> OK, I am using `c` now, for 'coefficients', since `L` is used for the parent usually.


Thank you.

> > - Make sure there is an easy to see example of the new constant behavior is clearly visible (in the class-level ring doc, its `_element_constructor_`, the element class’s class-level doc; the module-level doc if there are examples there).
 
> 
> There are several such examples, eg. line 1344 and beyond.  Note that this change is not so bad as it may look: almost always, the old input was a list ending with 0, because this is the constant you usually want.


Thank you. I didn't have time to check when I posted that.

Given your comments, I think this is now at needs review, correct? Feel free to revert if more is still needed.

Actually, I think I am mostly ready to turn this to a positive review if the patchbot comes back green.



---

archive/issue_comments_644600.json:
```json
{
    "body": "<a id='comment:56'></a>\nI take that back slightly. I think we should have uniformity with the get item and that `f[:5]` should work for all series because they all have an approximate valuation.",
    "created_at": "2022-09-10T06:50:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644600",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:56'></a>
I take that back slightly. I think we should have uniformity with the get item and that `f[:5]` should work for all series because they all have an approximate valuation.



---

archive/issue_comments_644601.json:
```json
{
    "body": "<a id='comment:57'></a>\nI am now (i.e., within the hour) implementing `coefficients`.  Other than that, it is ready!\n\n(to be honest: !!!!!!!!! with just as many smileys!)\n\nExplanation for the last push: we actually change _aproximate_valuation already in a place, and I think we will want to do that more often, and I certainly do not want that the result of __getitem__ depends on that.",
    "created_at": "2022-09-10T06:51:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644601",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:57'></a>
I am now (i.e., within the hour) implementing `coefficients`.  Other than that, it is ready!

(to be honest: !!!!!!!!! with just as many smileys!)

Explanation for the last push: we actually change _aproximate_valuation already in a place, and I think we will want to do that more often, and I certainly do not want that the result of __getitem__ depends on that.



---

archive/issue_comments_644602.json:
```json
{
    "body": "<a id='comment:58'></a>\nActually, I just discovered something quite disturbing:\n\n```\nsage: L.<x> = PowerSeriesRing(QQ)\nsage: f = x^-5/(1-2*x)\nsage: f[:10]\n<ipython-input-11-f66b5b8a9c22>:1: DeprecationWarning: polynomial slicing with a start index is deprecated, use list() and slice the resulting list instead\nSee http://trac.sagemath.org/18940 for details.\n  f[:Integer(10)]\n32 + 64*x + 128*x^2 + 256*x^3 + 512*x^4 + 1024*x^5 + 2048*x^6 + 4096*x^7 + 8192*x^8 + 16384*x^9 + O(x^15)\n```\n\nI find this rather hard to believe.",
    "created_at": "2022-09-10T07:00:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644602",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:58'></a>
Actually, I just discovered something quite disturbing:

```
sage: L.<x> = PowerSeriesRing(QQ)
sage: f = x^-5/(1-2*x)
sage: f[:10]
<ipython-input-11-f66b5b8a9c22>:1: DeprecationWarning: polynomial slicing with a start index is deprecated, use list() and slice the resulting list instead
See http://trac.sagemath.org/18940 for details.
  f[:Integer(10)]
32 + 64*x + 128*x^2 + 256*x^3 + 512*x^4 + 1024*x^5 + 2048*x^6 + 4096*x^7 + 8192*x^8 + 16384*x^9 + O(x^15)
```

I find this rather hard to believe.



---

archive/issue_comments_644603.json:
```json
{
    "body": "<a id='comment:59'></a>\nReplying to [Martin Rubey](#comment%3A57):\n> Explanation for the last push: we actually change _aproximate_valuation already in a place, and I think we will want to do that more often, and I certainly do not want that the result of `__getitem__` depends on that.\n\n\nI was misremembering what we implemented as I thought it did strip the leading zeros, but this is not the case:\n\n```\nsage: L.<x> = LazyLaurentSeriesRing(QQ)\nsage: f = L(lambda n: 1, valuation=0)\nsage: fp = (f - 1)\nsage: fp[:5]\n[0, 1, 1, 1, 1]\n```\n\nI would say we should start from the approximate order up to the stop and then strip leading zeros (with updating the valuation accordingly). I find the `f[:5]` syntax really nice. It also means we promise you have all nonzero coefficients up to the stop without having to compute the valuation (in particular, this would work for zero series).\n\nThis could be made consistent with `f[a:b]` that does return the leading `0`'s because the input is clearly different (and we would not update the approximate valuation because we are not using it).\n\nThe major point with updating the current behavior is there is no other way to guarantee that we have computed enough using `f[a:b]` to guarantee all coefficients of degree less than `a` are zero because we have not made the approximate valuation part of the API. Otherwise I would want a way to get that so I can guarantee my computations. (Of course, I can but don't want to keep track of this by hand.)",
    "created_at": "2022-09-10T07:40:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644603",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:59'></a>
Replying to [Martin Rubey](#comment%3A57):
> Explanation for the last push: we actually change _aproximate_valuation already in a place, and I think we will want to do that more often, and I certainly do not want that the result of `__getitem__` depends on that.


I was misremembering what we implemented as I thought it did strip the leading zeros, but this is not the case:

```
sage: L.<x> = LazyLaurentSeriesRing(QQ)
sage: f = L(lambda n: 1, valuation=0)
sage: fp = (f - 1)
sage: fp[:5]
[0, 1, 1, 1, 1]
```

I would say we should start from the approximate order up to the stop and then strip leading zeros (with updating the valuation accordingly). I find the `f[:5]` syntax really nice. It also means we promise you have all nonzero coefficients up to the stop without having to compute the valuation (in particular, this would work for zero series).

This could be made consistent with `f[a:b]` that does return the leading `0`'s because the input is clearly different (and we would not update the approximate valuation because we are not using it).

The major point with updating the current behavior is there is no other way to guarantee that we have computed enough using `f[a:b]` to guarantee all coefficients of degree less than `a` are zero because we have not made the approximate valuation part of the API. Otherwise I would want a way to get that so I can guarantee my computations. (Of course, I can but don't want to keep track of this by hand.)



---

archive/issue_comments_644604.json:
```json
{
    "body": "<a id='comment:60'></a>\nReplying to [Martin Rubey](#comment%3A58):\n> Actually, I just discovered something quite disturbing:\n> \n> ```\n> sage: L.<x> = PowerSeriesRing(QQ)\n> sage: f = x^-5/(1-2*x)\n> sage: f[:10]\n> <ipython-input-11-f66b5b8a9c22>:1: DeprecationWarning: polynomial slicing with a start index is deprecated, use list() and slice the resulting list instead\n> See http://trac.sagemath.org/18940 for details.\n>   f[:Integer(10)]\n> 32 + 64*x + 128*x^2 + 256*x^3 + 512*x^4 + 1024*x^5 + 2048*x^6 + 4096*x^7 + 8192*x^8 + 16384*x^9 + O(x^15)\n> ```\n\n>\n> I find this rather hard to believe.\n\n\nThat is disturbing on many different levels for FPS. For polynomials, it probably would be better for them to be done as lists rather than polynomials, but it was somewhat natural there to return a polynomial as we often want to lop off terms. For FPS, I think slicing makes less sense to return a FPS because we are actually interested in a certain range of coefficients. We aren't really manipulating parts of the polynomial.\n\nSince this is deprecated and could be removed now, we are free to implement our own version of slicing.",
    "created_at": "2022-09-10T07:47:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644604",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:60'></a>
Replying to [Martin Rubey](#comment%3A58):
> Actually, I just discovered something quite disturbing:
> 
> ```
> sage: L.<x> = PowerSeriesRing(QQ)
> sage: f = x^-5/(1-2*x)
> sage: f[:10]
> <ipython-input-11-f66b5b8a9c22>:1: DeprecationWarning: polynomial slicing with a start index is deprecated, use list() and slice the resulting list instead
> See http://trac.sagemath.org/18940 for details.
>   f[:Integer(10)]
> 32 + 64*x + 128*x^2 + 256*x^3 + 512*x^4 + 1024*x^5 + 2048*x^6 + 4096*x^7 + 8192*x^8 + 16384*x^9 + O(x^15)
> ```

>
> I find this rather hard to believe.


That is disturbing on many different levels for FPS. For polynomials, it probably would be better for them to be done as lists rather than polynomials, but it was somewhat natural there to return a polynomial as we often want to lop off terms. For FPS, I think slicing makes less sense to return a FPS because we are actually interested in a certain range of coefficients. We aren't really manipulating parts of the polynomial.

Since this is deprecated and could be removed now, we are free to implement our own version of slicing.



---

archive/issue_comments_644605.json:
```json
{
    "body": "<a id='comment:61'></a>\nI am absolutely against starting with `_approximate_order`, since this is not well-defined.\n\nANd I absolutely want a method (I do not care which name it has) which gives me the list or lazy list of all coefficients, beginning with a specified degree.  This is one of the most important use cases for me, for example, I feed this list to oeis, or to the guessing packages, or I plot it.",
    "created_at": "2022-09-10T07:48:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644605",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:61'></a>
I am absolutely against starting with `_approximate_order`, since this is not well-defined.

ANd I absolutely want a method (I do not care which name it has) which gives me the list or lazy list of all coefficients, beginning with a specified degree.  This is one of the most important use cases for me, for example, I feed this list to oeis, or to the guessing packages, or I plot it.



---

archive/issue_comments_644606.json:
```json
{
    "body": "<a id='comment:62'></a>\n(Let me stress again that _approximate_order may change after certain operations, and may depend on the way we construct the series.)",
    "created_at": "2022-09-10T07:53:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644606",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:62'></a>
(Let me stress again that _approximate_order may change after certain operations, and may depend on the way we construct the series.)



---

archive/issue_comments_644607.json:
```json
{
    "body": "<a id='comment:63'></a>\nReplying to [Martin Rubey](#comment%3A61):\n> I am absolutely against starting with `_approximate_order`, since this is not well-defined.\n\n\nWith slicing returning leading zeros, I completely agree that we should not do this. My proposal would be to strip the leading zeros and start at the actual valuation (or return an empty list if the valuation is at least as large as `stop`).\n\n> ANd I absolutely want a method (I do not care which name it has) which gives me the list or lazy list of all coefficients, beginning with a specified degree.  This is one of the most important use cases for me, for example, I feed this list to oeis, or to the guessing packages, or I plot it.\n\n\nBig +1 as well. I am not proposing a change to the slicing `f[start:stop]`, which would still return a list.\n\nBasically, what I would have is a lazy series `f` with:\n\n- approximate valuation `a`\n- actual valuation `v`\n\nbehave as follows:\n\n1. For `f[:stop]`, then get the list of coefficients from `f[a]` to `f[stop-1]` and strip the leading zeros and update the approximate valuation as appropriate.\n2. For `f[start:start]`, return `[f[i] for i in range(start, stop)]`.\n\nAs a concrete example, suppose we have `g` with approximate valuation `-3` but actual valuation `2`. Then doing the following (with a freshly created `g`):\n\n1. `g[:5]` returns `[2, 3, 4]` and sets the approximate valuation to `2`.\n2. `g[-1:5]` returns `[0, 0, 0, 2, 3, 4]`.\n3. `g[:1]` returns `[]` and sets the approximate valuation to `1`.\n\nDoes that clarify what I am proposing? How do you feel about that? I can implement this if you want too.",
    "created_at": "2022-09-10T07:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644607",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:63'></a>
Replying to [Martin Rubey](#comment%3A61):
> I am absolutely against starting with `_approximate_order`, since this is not well-defined.


With slicing returning leading zeros, I completely agree that we should not do this. My proposal would be to strip the leading zeros and start at the actual valuation (or return an empty list if the valuation is at least as large as `stop`).

> ANd I absolutely want a method (I do not care which name it has) which gives me the list or lazy list of all coefficients, beginning with a specified degree.  This is one of the most important use cases for me, for example, I feed this list to oeis, or to the guessing packages, or I plot it.


Big +1 as well. I am not proposing a change to the slicing `f[start:stop]`, which would still return a list.

Basically, what I would have is a lazy series `f` with:

- approximate valuation `a`
- actual valuation `v`

behave as follows:

1. For `f[:stop]`, then get the list of coefficients from `f[a]` to `f[stop-1]` and strip the leading zeros and update the approximate valuation as appropriate.
2. For `f[start:start]`, return `[f[i] for i in range(start, stop)]`.

As a concrete example, suppose we have `g` with approximate valuation `-3` but actual valuation `2`. Then doing the following (with a freshly created `g`):

1. `g[:5]` returns `[2, 3, 4]` and sets the approximate valuation to `2`.
2. `g[-1:5]` returns `[0, 0, 0, 2, 3, 4]`.
3. `g[:1]` returns `[]` and sets the approximate valuation to `1`.

Does that clarify what I am proposing? How do you feel about that? I can implement this if you want too.



---

archive/issue_comments_644608.json:
```json
{
    "body": "<a id='comment:64'></a>\nYes, I think that distinguishing between `start=None` and `start=d` in this way is a good idea.\n\nI'd also propose to propagate this change to all polynomial-like `__getitem__` methods (in a later ticket).\n\nI have roughly half an hour left, which I will invest into the coefficient method.  The tricky part is to get multivariate and graded series right, to be consistent with\n\n```\nsage: P.<x,y> = QQ[]\nsage: f = (x+2*y^3 +3*x*y + 5)\nsage: f.coefficients()\n[2, 3, 1, 5]\n```",
    "created_at": "2022-09-10T08:03:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644608",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:64'></a>
Yes, I think that distinguishing between `start=None` and `start=d` in this way is a good idea.

I'd also propose to propagate this change to all polynomial-like `__getitem__` methods (in a later ticket).

I have roughly half an hour left, which I will invest into the coefficient method.  The tricky part is to get multivariate and graded series right, to be consistent with

```
sage: P.<x,y> = QQ[]
sage: f = (x+2*y^3 +3*x*y + 5)
sage: f.coefficients()
[2, 3, 1, 5]
```



---

archive/issue_comments_644609.json:
```json
{
    "body": "<a id='comment:65'></a>\nHmm...that is a bit tricky. Can you just concatenate the `coefficients()` of each of the components by degree?",
    "created_at": "2022-09-10T08:25:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644609",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:65'></a>
Hmm...that is a bit tricky. Can you just concatenate the `coefficients()` of each of the components by degree?



---

archive/issue_comments_644610.json:
```json
{
    "body": "<a id='comment:66'></a>\nI'm almost there :-)",
    "created_at": "2022-09-10T08:27:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644610",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:66'></a>
I'm almost there :-)



---

archive/issue_comments_644611.json:
```json
{
    "body": "<a id='comment:67'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------|\n|[037f3f7](https://github.com/sagemath/sagetrac-mirror/commit/037f3f7cad9b7bfb955f9cb3d1aaf7a4363c7ccb)|`implement coefficients`|",
    "created_at": "2022-09-10T09:03:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644611",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:67'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------|
|[037f3f7](https://github.com/sagemath/sagetrac-mirror/commit/037f3f7cad9b7bfb955f9cb3d1aaf7a4363c7ccb)|`implement coefficients`|



---

archive/issue_comments_644612.json:
```json
{
    "body": "Changing commit from \"9629b2878b228fb2c5623f4d2b1df60e2c4bb287\" to \"037f3f7cad9b7bfb955f9cb3d1aaf7a4363c7ccb\"",
    "created_at": "2022-09-10T09:03:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644612",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9629b2878b228fb2c5623f4d2b1df60e2c4bb287" to "037f3f7cad9b7bfb955f9cb3d1aaf7a4363c7ccb"



---

archive/issue_comments_644613.json:
```json
{
    "body": "Changing commit from \"037f3f7cad9b7bfb955f9cb3d1aaf7a4363c7ccb\" to \"787197ed609f8291ba23d2c102686b2d8353ec9d\"",
    "created_at": "2022-09-10T14:08:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644613",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "037f3f7cad9b7bfb955f9cb3d1aaf7a4363c7ccb" to "787197ed609f8291ba23d2c102686b2d8353ec9d"



---

archive/issue_comments_644614.json:
```json
{
    "body": "<a id='comment:68'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------|\n|[787197e](https://github.com/sagemath/sagetrac-mirror/commit/787197ed609f8291ba23d2c102686b2d8353ec9d)|`fix some bugs`|",
    "created_at": "2022-09-10T14:08:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644614",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:68'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |               |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|[787197e](https://github.com/sagemath/sagetrac-mirror/commit/787197ed609f8291ba23d2c102686b2d8353ec9d)|`fix some bugs`|



---

archive/issue_comments_644615.json:
```json
{
    "body": "Changing commit from \"787197ed609f8291ba23d2c102686b2d8353ec9d\" to \"8f46e127e30e1f0a3e6d1a6997e806baf7254710\"",
    "created_at": "2022-09-11T17:49:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644615",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "787197ed609f8291ba23d2c102686b2d8353ec9d" to "8f46e127e30e1f0a3e6d1a6997e806baf7254710"



---

archive/issue_comments_644616.json:
```json
{
    "body": "<a id='comment:69'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|\n|[8f46e12](https://github.com/sagemath/sagetrac-mirror/commit/8f46e127e30e1f0a3e6d1a6997e806baf7254710)|`implement new semantics of __getitem__`|",
    "created_at": "2022-09-11T17:49:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644616",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:69'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|
|[8f46e12](https://github.com/sagemath/sagetrac-mirror/commit/8f46e127e30e1f0a3e6d1a6997e806baf7254710)|`implement new semantics of __getitem__`|



---

archive/issue_comments_644617.json:
```json
{
    "body": "<a id='comment:70'></a>\nReady!",
    "created_at": "2022-09-11T17:51:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644617",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:70'></a>
Ready!



---

archive/issue_comments_644618.json:
```json
{
    "body": "<a id='comment:71'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------|\n|[0de1c13](https://github.com/sagemath/sagetrac-mirror/commit/0de1c13a55bc168b6c7a1fc0411a5f81b28dbf88)|`add a warning and an example for the arithmetic product with a constant term`|\n|[8e5de35](https://github.com/sagemath/sagetrac-mirror/commit/8e5de35ee5f302a46f1af008d1e06f62bdf37f7b)|`add missing whitespace in docstring`|\n|[f706c53](https://github.com/sagemath/sagetrac-mirror/commit/f706c53ec1c8d197b845488d763a975b886d1354)|`Merge branch 'u/mantepse/implement_arithmetic_product_of_lazy_symmetric_functions' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|",
    "created_at": "2022-09-11T19:09:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644618",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:71'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------|
|[0de1c13](https://github.com/sagemath/sagetrac-mirror/commit/0de1c13a55bc168b6c7a1fc0411a5f81b28dbf88)|`add a warning and an example for the arithmetic product with a constant term`|
|[8e5de35](https://github.com/sagemath/sagetrac-mirror/commit/8e5de35ee5f302a46f1af008d1e06f62bdf37f7b)|`add missing whitespace in docstring`|
|[f706c53](https://github.com/sagemath/sagetrac-mirror/commit/f706c53ec1c8d197b845488d763a975b886d1354)|`Merge branch 'u/mantepse/implement_arithmetic_product_of_lazy_symmetric_functions' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series`|



---

archive/issue_comments_644619.json:
```json
{
    "body": "Changing commit from \"8f46e127e30e1f0a3e6d1a6997e806baf7254710\" to \"f706c53ec1c8d197b845488d763a975b886d1354\"",
    "created_at": "2022-09-11T19:09:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644619",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8f46e127e30e1f0a3e6d1a6997e806baf7254710" to "f706c53ec1c8d197b845488d763a975b886d1354"



---

archive/issue_comments_644620.json:
```json
{
    "body": "<a id='comment:72'></a>\nThe using you should use the approximate order instead of the actual order is that you do not need to compute it exactly. It should be \u201cup to the (necessarily specified) `stop`\u201d so it will still work for series that do not know they are zero (nor compute more than they need to).\n\nI also think the result of `coefficients()` should all lie in the base ring.\n\nI have a number of other small changes that I will do tomorrow, along with the above two if you don\u2019t disagree.",
    "created_at": "2022-09-12T12:51:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644620",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:72'></a>
The using you should use the approximate order instead of the actual order is that you do not need to compute it exactly. It should be “up to the (necessarily specified) `stop`” so it will still work for series that do not know they are zero (nor compute more than they need to).

I also think the result of `coefficients()` should all lie in the base ring.

I have a number of other small changes that I will do tomorrow, along with the above two if you don’t disagree.



---

archive/issue_comments_644621.json:
```json
{
    "body": "<a id='comment:73'></a>\nRe stop: Oh, yes, I agree!  I overlooked that!\n\nRe base ring: indeed.  (I thought they did.)",
    "created_at": "2022-09-12T13:14:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644621",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:73'></a>
Re stop: Oh, yes, I agree!  I overlooked that!

Re base ring: indeed.  (I thought they did.)



---

archive/issue_comments_644622.json:
```json
{
    "body": "<a id='comment:74'></a>\nThere is a bug in `LazyModuleElement.map_coefficients`: it applies the map to the coefficients of the stream, rather than the coefficients of the series.  It is unfortunate that we call the elements of the stream coefficients, we should call them graded pieces or something like that.",
    "created_at": "2022-09-12T20:34:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644622",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:74'></a>
There is a bug in `LazyModuleElement.map_coefficients`: it applies the map to the coefficients of the stream, rather than the coefficients of the series.  It is unfortunate that we call the elements of the stream coefficients, we should call them graded pieces or something like that.



---

archive/issue_comments_644623.json:
```json
{
    "body": "Changing commit from \"f706c53ec1c8d197b845488d763a975b886d1354\" to \"3410eda2266a4ed0c38dc8ae053bd13194e26d62\"",
    "created_at": "2022-09-12T21:33:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644623",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f706c53ec1c8d197b845488d763a975b886d1354" to "3410eda2266a4ed0c38dc8ae053bd13194e26d62"



---

archive/issue_comments_644624.json:
```json
{
    "body": "<a id='comment:75'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------|\n|[3410eda](https://github.com/sagemath/sagetrac-mirror/commit/3410eda2266a4ed0c38dc8ae053bd13194e26d62)|`fix map_coefficients`|",
    "created_at": "2022-09-12T21:33:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644624",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:75'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------|
|[3410eda](https://github.com/sagemath/sagetrac-mirror/commit/3410eda2266a4ed0c38dc8ae053bd13194e26d62)|`fix map_coefficients`|



---

archive/issue_comments_644625.json:
```json
{
    "body": "Changing commit from \"3410eda2266a4ed0c38dc8ae053bd13194e26d62\" to \"8fc2dd1a5c5de7f393de048c920e1d49be4660ba\"",
    "created_at": "2022-09-12T21:43:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644625",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3410eda2266a4ed0c38dc8ae053bd13194e26d62" to "8fc2dd1a5c5de7f393de048c920e1d49be4660ba"



---

archive/issue_comments_644626.json:
```json
{
    "body": "<a id='comment:76'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[8fc2dd1](https://github.com/sagemath/sagetrac-mirror/commit/8fc2dd1a5c5de7f393de048c920e1d49be4660ba)|`fix doctests because of __getitem__ change`|",
    "created_at": "2022-09-12T21:43:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644626",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:76'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[8fc2dd1](https://github.com/sagemath/sagetrac-mirror/commit/8fc2dd1a5c5de7f393de048c920e1d49be4660ba)|`fix doctests because of __getitem__ change`|



---

archive/issue_comments_644627.json:
```json
{
    "body": "Changing commit from \"8fc2dd1a5c5de7f393de048c920e1d49be4660ba\" to \"2a3389e6ae2c5be15a44f52d4b2fb339e63bc827\"",
    "created_at": "2022-09-12T22:06:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644627",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8fc2dd1a5c5de7f393de048c920e1d49be4660ba" to "2a3389e6ae2c5be15a44f52d4b2fb339e63bc827"



---

archive/issue_comments_644628.json:
```json
{
    "body": "<a id='comment:77'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------|\n|[2a3389e](https://github.com/sagemath/sagetrac-mirror/commit/2a3389e6ae2c5be15a44f52d4b2fb339e63bc827)|`compute no more elements than necessary in __getitem__`|",
    "created_at": "2022-09-12T22:06:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644628",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:77'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------|
|[2a3389e](https://github.com/sagemath/sagetrac-mirror/commit/2a3389e6ae2c5be15a44f52d4b2fb339e63bc827)|`compute no more elements than necessary in __getitem__`|



---

archive/issue_comments_644629.json:
```json
{
    "body": "<a id='comment:78'></a>\nReplying to [Martin Rubey](#comment%3A74):\n> There is a bug in `LazyModuleElement.map_coefficients`: it applies the map to the coefficients of the stream, rather than the coefficients of the series.  It is unfortunate that we call the elements of the stream coefficients, we should call them graded pieces or something like that.\n\n\nGood catch. The fix seems good, although it seems a bit brittle. I will see if I can come up with a better test, but this can work if I can\u2019t.",
    "created_at": "2022-09-13T00:19:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644629",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:78'></a>
Replying to [Martin Rubey](#comment%3A74):
> There is a bug in `LazyModuleElement.map_coefficients`: it applies the map to the coefficients of the stream, rather than the coefficients of the series.  It is unfortunate that we call the elements of the stream coefficients, we should call them graded pieces or something like that.


Good catch. The fix seems good, although it seems a bit brittle. I will see if I can come up with a better test, but this can work if I can’t.



---

archive/issue_comments_644630.json:
```json
{
    "body": "<a id='comment:79'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|\n|[89d9ccc](https://github.com/sagemath/sagetrac-mirror/commit/89d9cccd0e5db988005e3503f86efd7283fea038)|`fix pyflakes warnings`|",
    "created_at": "2022-09-13T10:10:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644630",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:79'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|
|[89d9ccc](https://github.com/sagemath/sagetrac-mirror/commit/89d9cccd0e5db988005e3503f86efd7283fea038)|`fix pyflakes warnings`|



---

archive/issue_comments_644631.json:
```json
{
    "body": "Changing commit from \"2a3389e6ae2c5be15a44f52d4b2fb339e63bc827\" to \"89d9cccd0e5db988005e3503f86efd7283fea038\"",
    "created_at": "2022-09-13T10:10:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644631",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2a3389e6ae2c5be15a44f52d4b2fb339e63bc827" to "89d9cccd0e5db988005e3503f86efd7283fea038"



---

archive/issue_comments_644632.json:
```json
{
    "body": "<a id='comment:80'></a>\nGiventicket: ticket:34470#comment:19#comment:34470, possibly we should do\n\n```diff\ndiff --git a/src/sage/rings/lazy_series_ring.py b/src/sage/rings/lazy_series_ring.py\nindex 98e40a41c8f..5164e19dd2e 100644\n--- a/src/sage/rings/lazy_series_ring.py\n+++ b/src/sage/rings/lazy_series_ring.py\n@@ -1578,7 +1578,7 @@ class LazyCompletionGradedAlgebra(LazySeriesRing):\n         if basis in Algebras.TensorProducts:\n             self._arity = len(basis._sets)\n         else:\n-            if basis not in Algebras.Graded:\n+            if basis not in GradedAlgebrasWithBasis\n                 raise ValueError(\"basis should be a graded algebra\")\n             self._arity = 1\n         category = Algebras(base_ring.category())\n\n```",
    "created_at": "2022-09-13T12:36:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644632",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:80'></a>
Giventicket: ticket:34470#comment:19#comment:34470, possibly we should do

```diff
diff --git a/src/sage/rings/lazy_series_ring.py b/src/sage/rings/lazy_series_ring.py
index 98e40a41c8f..5164e19dd2e 100644
--- a/src/sage/rings/lazy_series_ring.py
+++ b/src/sage/rings/lazy_series_ring.py
@@ -1578,7 +1578,7 @@ class LazyCompletionGradedAlgebra(LazySeriesRing):
         if basis in Algebras.TensorProducts:
             self._arity = len(basis._sets)
         else:
-            if basis not in Algebras.Graded:
+            if basis not in GradedAlgebrasWithBasis
                 raise ValueError("basis should be a graded algebra")
             self._arity = 1
         category = Algebras(base_ring.category())

```



---

archive/issue_comments_644633.json:
```json
{
    "body": "<a id='comment:81'></a>\nIndeed, we should do that. I didn\u2019t realize I did it like this at the time.",
    "created_at": "2022-09-13T12:42:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644633",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:81'></a>
Indeed, we should do that. I didn’t realize I did it like this at the time.



---

archive/issue_comments_644634.json:
```json
{
    "body": "<a id='comment:82'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------|\n|[cf2b0cb](https://github.com/sagemath/sagetrac-mirror/commit/cf2b0cb9456298c279d7270d4c44e208929370e4)|`require a graded basis`|",
    "created_at": "2022-09-13T12:58:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644634",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:82'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------|
|[cf2b0cb](https://github.com/sagemath/sagetrac-mirror/commit/cf2b0cb9456298c279d7270d4c44e208929370e4)|`require a graded basis`|



---

archive/issue_comments_644635.json:
```json
{
    "body": "Changing commit from \"89d9cccd0e5db988005e3503f86efd7283fea038\" to \"cf2b0cb9456298c279d7270d4c44e208929370e4\"",
    "created_at": "2022-09-13T12:58:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644635",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "89d9cccd0e5db988005e3503f86efd7283fea038" to "cf2b0cb9456298c279d7270d4c44e208929370e4"



---

archive/issue_comments_644636.json:
```json
{
    "body": "<a id='comment:83'></a>\nDo you think we are ready? The part of[comment:72](#comment%3A72), concerning coefficients being in the base ring might still be open.\n\nI am guessing that this will not make it into the upcoming release, right?",
    "created_at": "2022-09-13T13:01:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644636",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:83'></a>
Do you think we are ready? The part of[comment:72](#comment%3A72), concerning coefficients being in the base ring might still be open.

I am guessing that this will not make it into the upcoming release, right?



---

archive/issue_comments_644637.json:
```json
{
    "body": "Changing commit from \"cf2b0cb9456298c279d7270d4c44e208929370e4\" to \"3bd9f8c26726786ff40db79486a1cb0b3cd58b00\"",
    "created_at": "2022-09-13T14:57:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644637",
    "user": "https://github.com/tscrim"
}
```

Changing commit from "cf2b0cb9456298c279d7270d4c44e208929370e4" to "3bd9f8c26726786ff40db79486a1cb0b3cd58b00"



---

archive/issue_comments_644638.json:
```json
{
    "body": "<a id='comment:84'></a>\nIndeed, I think this is ready.\n\nMy last commit makes sure the coefficients are in the correct ring, which was not the case before for the test I added.\n\nI did a few other small touch ups that I saw (mainly breaking very long doctest output lines) and marking one test as long.\n\nIf my changes are good, then positive review.\n\nIndeed, this will definitely not be in 9.7 since we are in the rc stages. However, that is probably better so it can get lots of testing during the beta releases.\n\n---\nNew commits:\n|                                                                                                                                          |                                                                                                                                                                                                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n|[c90cb91](https://github.com/sagemath/sagetrac-mirror/commit/c90cb91d9cf2eca5231f3f68b19d304121d3486d)|`Merge branch 'u/mantepse/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series' of https://github.com/sagemath/sagetrac-mirror into u/tscrim/replace_lazy_power_series-32367`|\n|[3bd9f8c](https://github.com/sagemath/sagetrac-mirror/commit/3bd9f8c26726786ff40db79486a1cb0b3cd58b00)|`Fixing coefficients bug and some doc tweaks.`|",
    "created_at": "2022-09-13T14:57:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644638",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:84'></a>
Indeed, I think this is ready.

My last commit makes sure the coefficients are in the correct ring, which was not the case before for the test I added.

I did a few other small touch ups that I saw (mainly breaking very long doctest output lines) and marking one test as long.

If my changes are good, then positive review.

Indeed, this will definitely not be in 9.7 since we are in the rc stages. However, that is probably better so it can get lots of testing during the beta releases.

---
New commits:
|                                                                                                                                          |                                                                                                                                                                                                       |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|[c90cb91](https://github.com/sagemath/sagetrac-mirror/commit/c90cb91d9cf2eca5231f3f68b19d304121d3486d)|`Merge branch 'u/mantepse/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series' of https://github.com/sagemath/sagetrac-mirror into u/tscrim/replace_lazy_power_series-32367`|
|[3bd9f8c](https://github.com/sagemath/sagetrac-mirror/commit/3bd9f8c26726786ff40db79486a1cb0b3cd58b00)|`Fixing coefficients bug and some doc tweaks.`|



---

archive/issue_comments_644639.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Martin Rubey, Travis Scrimshaw\"",
    "created_at": "2022-09-13T14:57:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644639",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Martin Rubey, Travis Scrimshaw"



---

archive/issue_comments_644640.json:
```json
{
    "body": "Changing branch from \"u/mantepse/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series\" to \"u/tscrim/replace_lazy_power_series-32367\"",
    "created_at": "2022-09-13T14:57:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644640",
    "user": "https://github.com/tscrim"
}
```

Changing branch from "u/mantepse/replace_lazy_power_series_in_species_directory_with_the_new_lazy_taylor_series" to "u/tscrim/replace_lazy_power_series-32367"



---

archive/issue_comments_644641.json:
```json
{
    "body": "<a id='comment:85'></a>\nI'm afraid, there is something we did not want:\n\n```\nsage: L.<x> = LazyPowerSeriesRing(GF(2))\nsage: f=L(lambda n: n)\nsage: f._coeff_stream._cache\n{}\nsage: f\nx + x^3 + x^5 + O(x^7)\nsage: f._coeff_stream._cache\n{0: 0, 1: 1, 2: 2, 3: 3, 4: 4, 5: 5, 6: 6}\n```\n\nI am quite sure we wanted that the cache contains the coefficients in the correct ring, no?",
    "created_at": "2022-09-13T15:15:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644641",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:85'></a>
I'm afraid, there is something we did not want:

```
sage: L.<x> = LazyPowerSeriesRing(GF(2))
sage: f=L(lambda n: n)
sage: f._coeff_stream._cache
{}
sage: f
x + x^3 + x^5 + O(x^7)
sage: f._coeff_stream._cache
{0: 0, 1: 1, 2: 2, 3: 3, 4: 4, 5: 5, 6: 6}
```

I am quite sure we wanted that the cache contains the coefficients in the correct ring, no?



---

archive/issue_comments_644642.json:
```json
{
    "body": "<a id='comment:86'></a>\nI think I forgot to adapt the `_element_constructor_` of all rings except for the `LazyTaylorSeriesRing` in https://git.sagemath.org/sage.git/commit/?h=3bd9f8c26726786ff40db79486a1cb0b3cd58b00&id=60103619caa275cb7087e425d25afacdba48af9b\n\nI am guessing that your change to coefficients is masking that.\n\nI have to leave now, I'll try to fix it in the evening.",
    "created_at": "2022-09-13T15:29:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644642",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:86'></a>
I think I forgot to adapt the `_element_constructor_` of all rings except for the `LazyTaylorSeriesRing` in https://git.sagemath.org/sage.git/commit/?h=3bd9f8c26726786ff40db79486a1cb0b3cd58b00&id=60103619caa275cb7087e425d25afacdba48af9b

I am guessing that your change to coefficients is masking that.

I have to leave now, I'll try to fix it in the evening.



---

archive/issue_comments_644643.json:
```json
{
    "body": "Changing branch from \"u/tscrim/replace_lazy_power_series-32367\" to \"u/mantepse/replace_lazy_power_series-32367\"",
    "created_at": "2022-09-13T19:56:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644643",
    "user": "https://github.com/mantepse"
}
```

Changing branch from "u/tscrim/replace_lazy_power_series-32367" to "u/mantepse/replace_lazy_power_series-32367"



---

archive/issue_comments_644644.json:
```json
{
    "body": "<a id='comment:88'></a>\nDone!  I'm happy for the moment.  Can't wait to see this in sage develop!\n\nI'll wait with the other tickets until it is, so that I can see the diff better.\n\n---\nNew commits:\n|                                                                                                                                          |                                                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------|\n|[555d1b0](https://github.com/sagemath/sagetrac-mirror/commit/555d1b07df4f0ba82f23392142037114c03cd0e9)|`fix LazyPowerSeries._element_constructor_ when passed a function`|",
    "created_at": "2022-09-13T19:57:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644644",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:88'></a>
Done!  I'm happy for the moment.  Can't wait to see this in sage develop!

I'll wait with the other tickets until it is, so that I can see the diff better.

---
New commits:
|                                                                                                                                          |                                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------|
|[555d1b0](https://github.com/sagemath/sagetrac-mirror/commit/555d1b07df4f0ba82f23392142037114c03cd0e9)|`fix LazyPowerSeries._element_constructor_ when passed a function`|



---

archive/issue_comments_644645.json:
```json
{
    "body": "Changing commit from \"3bd9f8c26726786ff40db79486a1cb0b3cd58b00\" to \"555d1b07df4f0ba82f23392142037114c03cd0e9\"",
    "created_at": "2022-09-13T19:57:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644645",
    "user": "https://github.com/mantepse"
}
```

Changing commit from "3bd9f8c26726786ff40db79486a1cb0b3cd58b00" to "555d1b07df4f0ba82f23392142037114c03cd0e9"



---

archive/issue_comments_644646.json:
```json
{
    "body": "<a id='comment:89'></a>\nI lean towards not having the cached coefficients to be in the base ring as much as possible so intermediate computations could succeed. I saw I could do the change you did and explicitly did not do this because of potential intermediate computations. Although it would make the behavior independent of the arity, which is good. I don't hold a strong opinion here (right now). So your change is fine with me, and you can also remove the extra mappings to the base ring.\n\nAlso, I forgot to mention I did find a test for checking how the coefficients behave that I think is more robust (at least, with the current implementation):\n\n```diff\n-        if self.base_ring() == self.parent()._internal_poly_ring.base_ring():\n+        if P._internal_poly_ring.base_ring() is not P._laurent_poly_ring:\n```\nWhat I am worried about is you might possibly get a false equality in the first test. I am not 100% certain this could happen (maybe with Dirichlet series and `SR`), but with the changed test, those in the new test are identical if and only if we are using the internal polynomial ring to encode the degree.",
    "created_at": "2022-09-14T03:00:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644646",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:89'></a>
I lean towards not having the cached coefficients to be in the base ring as much as possible so intermediate computations could succeed. I saw I could do the change you did and explicitly did not do this because of potential intermediate computations. Although it would make the behavior independent of the arity, which is good. I don't hold a strong opinion here (right now). So your change is fine with me, and you can also remove the extra mappings to the base ring.

Also, I forgot to mention I did find a test for checking how the coefficients behave that I think is more robust (at least, with the current implementation):

```diff
-        if self.base_ring() == self.parent()._internal_poly_ring.base_ring():
+        if P._internal_poly_ring.base_ring() is not P._laurent_poly_ring:
```
What I am worried about is you might possibly get a false equality in the first test. I am not 100% certain this could happen (maybe with Dirichlet series and `SR`), but with the changed test, those in the new test are identical if and only if we are using the internal polynomial ring to encode the degree.



---

archive/issue_comments_644647.json:
```json
{
    "body": "<a id='comment:90'></a>\nIn all other rings we have in `lazy_series_ring.py` we put the coefficients into the base ring using the element constructor.  This change was done in #34473, where I overlooked the case of power series.  It should also be consistent with the other ways to construct an element, intentionwise.\n\nThere are two reasons I think that this is a good idea:\n\n* the conversion into the base ring may be computationally expensive, especially in the case of symmetric functions.\n\n* if a coefficient happens to be zero in the base ring, but not in the given ring, `Stream_map_coefficients` will apply the function in one case, but not the other.  I think that this could lead to rather obscure bugs.\n\nI believe I removed the extra mappings in my last commit, and I also saw your new test, which is fine with me.",
    "created_at": "2022-09-14T06:43:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644647",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:90'></a>
In all other rings we have in `lazy_series_ring.py` we put the coefficients into the base ring using the element constructor.  This change was done in #34473, where I overlooked the case of power series.  It should also be consistent with the other ways to construct an element, intentionwise.

There are two reasons I think that this is a good idea:

* the conversion into the base ring may be computationally expensive, especially in the case of symmetric functions.

* if a coefficient happens to be zero in the base ring, but not in the given ring, `Stream_map_coefficients` will apply the function in one case, but not the other.  I think that this could lead to rather obscure bugs.

I believe I removed the extra mappings in my last commit, and I also saw your new test, which is fine with me.



---

archive/issue_comments_644648.json:
```json
{
    "body": "Changing commit from \"555d1b07df4f0ba82f23392142037114c03cd0e9\" to \"baea68dbd79e0a0774f2763c12aa776a01a5f0c5\"",
    "created_at": "2022-09-14T06:58:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644648",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "555d1b07df4f0ba82f23392142037114c03cd0e9" to "baea68dbd79e0a0774f2763c12aa776a01a5f0c5"



---

archive/issue_comments_644649.json:
```json
{
    "body": "<a id='comment:91'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                          |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|\n|[baea68d](https://github.com/sagemath/sagetrac-mirror/commit/baea68dbd79e0a0774f2763c12aa776a01a5f0c5)|`pass functions using coefficients to element constructor`|",
    "created_at": "2022-09-14T06:58:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644649",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:91'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                          |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|
|[baea68d](https://github.com/sagemath/sagetrac-mirror/commit/baea68dbd79e0a0774f2763c12aa776a01a5f0c5)|`pass functions using coefficients to element constructor`|



---

archive/issue_comments_644650.json:
```json
{
    "body": "<a id='comment:92'></a>\nSorry, I had to fix another thing.\n\nBut now - ready, set, go!",
    "created_at": "2022-09-14T06:58:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644650",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:92'></a>
Sorry, I had to fix another thing.

But now - ready, set, go!



---

archive/issue_comments_644651.json:
```json
{
    "body": "<a id='comment:93'></a>\nReplying to [Martin Rubey](#comment%3A90):\n> In all other rings we have in `lazy_series_ring.py` we put the coefficients into the base ring using the element constructor.  This change was done in #34473, where I overlooked the case of power series.  It should also be consistent with the other ways to construct an element, intentionwise.\n\n\nI missed this change on my review of #34473. I would have raised it then, but now it might be too late.\n\n> There are two reasons I think that this is a good idea:\n> \n> * the conversion into the base ring may be computationally expensive, especially in the case of symmetric functions.\n\n\nThis seems to be a reason to not do it until the very end.\n\n> * if a coefficient happens to be zero in the base ring, but not in the given ring, `Stream_map_coefficients` will apply the function in one case, but not the other.  I think that this could lead to rather obscure bugs.\n\n\nA good point, but are we guaranteed to not get the same behavior with other streams? I think so, but it is not clear. I am wondering if we want to actually go back to including the ring for `Stream_map_coefficients` to really make sure we have the correct inputs. IIRC, we removed that to uniformly have no stream take a ring as input, but this one appears to be really special.\n\n> I believe I removed the extra mappings in my last commit, and I also saw your new test, which is fine with me.\n\n\nThank you.",
    "created_at": "2022-09-14T06:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644651",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:93'></a>
Replying to [Martin Rubey](#comment%3A90):
> In all other rings we have in `lazy_series_ring.py` we put the coefficients into the base ring using the element constructor.  This change was done in #34473, where I overlooked the case of power series.  It should also be consistent with the other ways to construct an element, intentionwise.


I missed this change on my review of #34473. I would have raised it then, but now it might be too late.

> There are two reasons I think that this is a good idea:
> 
> * the conversion into the base ring may be computationally expensive, especially in the case of symmetric functions.


This seems to be a reason to not do it until the very end.

> * if a coefficient happens to be zero in the base ring, but not in the given ring, `Stream_map_coefficients` will apply the function in one case, but not the other.  I think that this could lead to rather obscure bugs.


A good point, but are we guaranteed to not get the same behavior with other streams? I think so, but it is not clear. I am wondering if we want to actually go back to including the ring for `Stream_map_coefficients` to really make sure we have the correct inputs. IIRC, we removed that to uniformly have no stream take a ring as input, but this one appears to be really special.

> I believe I removed the extra mappings in my last commit, and I also saw your new test, which is fine with me.


Thank you.



---

archive/issue_comments_644652.json:
```json
{
    "body": "<a id='comment:94'></a>\n> > * the conversion into the base ring may be computationally expensive, especially in the case of symmetric functions.\n \n> \n> This seems to be a reason to not do it until the very end.\n\n\nI should have been more precise: if we do the conversion before putting things into the cache, we only do it once, and use it for subsequent computations.  Otherwise, we may do it many times.\n\nOf course, if computations in one base ring turn out to be more efficient than in another one, then it may make sense to do a `change_ring` at the very end.\n\n> A good point, but are we guaranteed to not get the same behavior with other streams? I think so, but it is not clear. I am wondering if we want to actually go back to including the ring for Stream_map_coefficients to really make sure we have the correct inputs. IIRC, we removed that to uniformly have no stream take a ring as input, but this one appears to be really special. \n\n\nIn principle, I like the current setup, but I agree that the burden on developers is quite big. However, I think I'd prefer to do this in a different ticket, after this one is in develop.  I find it already quite hard to see the modifications we make.\n\nOnce this is positive review, I would write a short summary describing what we did for the mailing list.  I think we have done something really awesome!",
    "created_at": "2022-09-14T07:29:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644652",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:94'></a>
> > * the conversion into the base ring may be computationally expensive, especially in the case of symmetric functions.
 
> 
> This seems to be a reason to not do it until the very end.


I should have been more precise: if we do the conversion before putting things into the cache, we only do it once, and use it for subsequent computations.  Otherwise, we may do it many times.

Of course, if computations in one base ring turn out to be more efficient than in another one, then it may make sense to do a `change_ring` at the very end.

> A good point, but are we guaranteed to not get the same behavior with other streams? I think so, but it is not clear. I am wondering if we want to actually go back to including the ring for Stream_map_coefficients to really make sure we have the correct inputs. IIRC, we removed that to uniformly have no stream take a ring as input, but this one appears to be really special. 


In principle, I like the current setup, but I agree that the burden on developers is quite big. However, I think I'd prefer to do this in a different ticket, after this one is in develop.  I find it already quite hard to see the modifications we make.

Once this is positive review, I would write a short summary describing what we did for the mailing list.  I think we have done something really awesome!



---

archive/issue_comments_644653.json:
```json
{
    "body": "<a id='comment:95'></a>\nReplying to [Martin Rubey](#comment%3A94):\n> > > * the conversion into the base ring may be computationally expensive, especially in the case of symmetric functions.\n \n> > \n> > This seems to be a reason to not do it until the very end.\n\n> \n> I should have been more precise: if we do the conversion before putting things into the cache, we only do it once, and use it for subsequent computations.  Otherwise, we may do it many times.\n> \n> Of course, if computations in one base ring turn out to be more efficient than in another one, then it may make sense to do a `change_ring` at the very end.\n\n\nIndeed, this is hard to say. I would prefer to leave it as much as possible in the hands of the user to decide, but this is a fairly technical thing to document.\n\n> > A good point, but are we guaranteed to not get the same behavior with other streams? I think so, but it is not clear. I am wondering if we want to actually go back to including the ring for Stream_map_coefficients to really make sure we have the correct inputs. IIRC, we removed that to uniformly have no stream take a ring as input, but this one appears to be really special. \n\n> \n> In principle, I like the current setup, but I agree that the burden on developers is quite big.\n\n\nA bit of a side effect of being packed with awesomeness. The current setup is sufficient for me. I am just wondering while we wait if it can be made better easily.\n\n> However, I think I'd prefer to do this in a different ticket, after this one is in develop.  I find it already quite hard to see the modifications we make.\n\n\nEasiest way would be to run `git diff` locally between this branch and the dependency.\n\n> Once this is positive review, I would write a short summary describing what we did for the mailing list.  I think we have done something really awesome!\n\n\n+1 I have already put this code to good use with a problem I have been working on.\n\nThere are still a few things to be improved upon, but this seems to be quite fast and very powerful.",
    "created_at": "2022-09-14T07:56:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644653",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:95'></a>
Replying to [Martin Rubey](#comment%3A94):
> > > * the conversion into the base ring may be computationally expensive, especially in the case of symmetric functions.
 
> > 
> > This seems to be a reason to not do it until the very end.

> 
> I should have been more precise: if we do the conversion before putting things into the cache, we only do it once, and use it for subsequent computations.  Otherwise, we may do it many times.
> 
> Of course, if computations in one base ring turn out to be more efficient than in another one, then it may make sense to do a `change_ring` at the very end.


Indeed, this is hard to say. I would prefer to leave it as much as possible in the hands of the user to decide, but this is a fairly technical thing to document.

> > A good point, but are we guaranteed to not get the same behavior with other streams? I think so, but it is not clear. I am wondering if we want to actually go back to including the ring for Stream_map_coefficients to really make sure we have the correct inputs. IIRC, we removed that to uniformly have no stream take a ring as input, but this one appears to be really special. 

> 
> In principle, I like the current setup, but I agree that the burden on developers is quite big.


A bit of a side effect of being packed with awesomeness. The current setup is sufficient for me. I am just wondering while we wait if it can be made better easily.

> However, I think I'd prefer to do this in a different ticket, after this one is in develop.  I find it already quite hard to see the modifications we make.


Easiest way would be to run `git diff` locally between this branch and the dependency.

> Once this is positive review, I would write a short summary describing what we did for the mailing list.  I think we have done something really awesome!


+1 I have already put this code to good use with a problem I have been working on.

There are still a few things to be improved upon, but this seems to be quite fast and very powerful.



---

archive/issue_comments_644654.json:
```json
{
    "body": "<a id='comment:96'></a>\nSo, are you happy for the moment?",
    "created_at": "2022-09-14T09:22:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644654",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:96'></a>
So, are you happy for the moment?



---

archive/issue_comments_644655.json:
```json
{
    "body": "<a id='comment:97'></a>\nIndeed I am.",
    "created_at": "2022-09-14T09:35:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644655",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:97'></a>
Indeed I am.



---

archive/issue_comments_644656.json:
```json
{
    "body": "<a id='comment:98'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|\n|[7745337](https://github.com/sagemath/sagetrac-mirror/commit/7745337b260ad2e37c1c30b04756606e0e775610)|`remove unused variable detected by pyflakes`|",
    "created_at": "2022-09-14T12:53:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644656",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:98'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|
|[7745337](https://github.com/sagemath/sagetrac-mirror/commit/7745337b260ad2e37c1c30b04756606e0e775610)|`remove unused variable detected by pyflakes`|



---

archive/issue_comments_644657.json:
```json
{
    "body": "Changing commit from \"baea68dbd79e0a0774f2763c12aa776a01a5f0c5\" to \"7745337b260ad2e37c1c30b04756606e0e775610\"",
    "created_at": "2022-09-14T12:53:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644657",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "baea68dbd79e0a0774f2763c12aa776a01a5f0c5" to "7745337b260ad2e37c1c30b04756606e0e775610"



---

archive/issue_comments_644658.json:
```json
{
    "body": "Changing commit from \"7745337b260ad2e37c1c30b04756606e0e775610\" to \"cdad494f9eb5f409f987301f4a8fd073c846f1b2\"",
    "created_at": "2022-09-15T07:36:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644658",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7745337b260ad2e37c1c30b04756606e0e775610" to "cdad494f9eb5f409f987301f4a8fd073c846f1b2"



---

archive/issue_comments_644659.json:
```json
{
    "body": "<a id='comment:99'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                  |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[cdad494](https://github.com/sagemath/sagetrac-mirror/commit/cdad494f9eb5f409f987301f4a8fd073c846f1b2)|`do not advertise L(None) in favour of L.define()`|",
    "created_at": "2022-09-15T07:36:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644659",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:99'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                  |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[cdad494](https://github.com/sagemath/sagetrac-mirror/commit/cdad494f9eb5f409f987301f4a8fd073c846f1b2)|`do not advertise L(None) in favour of L.define()`|



---

archive/issue_comments_644660.json:
```json
{
    "body": "<a id='comment:0'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|\n|[e8c7636](https://github.com/sagemath/sagetrac-mirror/commit/e8c76361936e15440a2f27fcd2cccd2c21054ba9)|`advertise passing None to the constructor`|\n|[f541f3d](https://github.com/sagemath/sagetrac-mirror/commit/f541f3d184e8b2468da5c2953383a4979996ec5c)|`add links to relaxed p-adics`|",
    "created_at": "2022-09-15T08:53:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644660",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|
|[e8c7636](https://github.com/sagemath/sagetrac-mirror/commit/e8c76361936e15440a2f27fcd2cccd2c21054ba9)|`advertise passing None to the constructor`|
|[f541f3d](https://github.com/sagemath/sagetrac-mirror/commit/f541f3d184e8b2468da5c2953383a4979996ec5c)|`add links to relaxed p-adics`|



---

archive/issue_comments_644661.json:
```json
{
    "body": "Changing commit from \"cdad494f9eb5f409f987301f4a8fd073c846f1b2\" to \"f541f3d184e8b2468da5c2953383a4979996ec5c\"",
    "created_at": "2022-09-15T08:53:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644661",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "cdad494f9eb5f409f987301f4a8fd073c846f1b2" to "f541f3d184e8b2468da5c2953383a4979996ec5c"



---

archive/issue_events_096586.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "rename": {
        "from": "Replace Lazy Power Series in species directory with the new Lazy Taylor Series",
        "to": "Replace Lazy Power Series in species directory"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32367#event-96586"
}
```



---

archive/issue_comments_644662.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,2 @@\n-Replace the functionalities and add combinatorial meaning for the coefficients in the series\n+In this ticket we finalize the implementation of lazy series, and replace the old lazy series framework.\n+\n``````\n",
    "created_at": "2022-09-15T08:56:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644662",
    "user": "https://github.com/mantepse"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,2 @@
-Replace the functionalities and add combinatorial meaning for the coefficients in the series
+In this ticket we finalize the implementation of lazy series, and replace the old lazy series framework.
+
``````




---

archive/issue_comments_644663.json:
```json
{
    "body": "Changing commit from \"f541f3d184e8b2468da5c2953383a4979996ec5c\" to \"1df62c8481a2bf52542f5e50a6b5d8610a8ac4b9\"",
    "created_at": "2022-09-15T11:56:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644663",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f541f3d184e8b2468da5c2953383a4979996ec5c" to "1df62c8481a2bf52542f5e50a6b5d8610a8ac4b9"



---

archive/issue_comments_644664.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|\n|[1df62c8](https://github.com/sagemath/sagetrac-mirror/commit/1df62c8481a2bf52542f5e50a6b5d8610a8ac4b9)|`fix wrong ring in doctest`|",
    "created_at": "2022-09-15T11:56:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644664",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|
|[1df62c8](https://github.com/sagemath/sagetrac-mirror/commit/1df62c8481a2bf52542f5e50a6b5d8610a8ac4b9)|`fix wrong ring in doctest`|



---

archive/issue_comments_644665.json:
```json
{
    "body": "<a id='comment:3'></a>\nI start to hate doctests.\n\nLet's try again.",
    "created_at": "2022-09-15T12:00:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644665",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:3'></a>
I start to hate doctests.

Let's try again.



---

archive/issue_comments_644666.json:
```json
{
    "body": "<a id='comment:4'></a>\nYES!",
    "created_at": "2022-09-15T14:43:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644666",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:4'></a>
YES!



---

archive/issue_comments_644667.json:
```json
{
    "body": "<a id='comment:5'></a>\nFrom the patchbot, I caught a few errors. I have mostly fixed them as they are trivial, but there is one that requires discussion.\n\nIn particular, changing the base ring to `QQ` leads to not implemented methods because of the change in category. Some of these are noted on #34470.  My proposal is we first add in these methods (possibly on a separate ticket) and the uncontroversial changes from #34470. (I already have a branch that does this. I can handle the merge with the current branch here and my other changes.)\n\nNow we could just sweep this under the rug by skipping the `_test_not_implemented`, but I think it is easier and better to just fix them first.\n\nWhat do you think?",
    "created_at": "2022-09-16T02:26:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644667",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>
From the patchbot, I caught a few errors. I have mostly fixed them as they are trivial, but there is one that requires discussion.

In particular, changing the base ring to `QQ` leads to not implemented methods because of the change in category. Some of these are noted on #34470.  My proposal is we first add in these methods (possibly on a separate ticket) and the uncontroversial changes from #34470. (I already have a branch that does this. I can handle the merge with the current branch here and my other changes.)

Now we could just sweep this under the rug by skipping the `_test_not_implemented`, but I think it is easier and better to just fix them first.

What do you think?



---

archive/issue_comments_644668.json:
```json
{
    "body": "<a id='comment:6'></a>\nI don't quite understand: I see three patchbot runs (one from github and two at https://patchbot.sagemath.org/ticket/32367/), but all three of them say \"all tests passed\".  Also, the pyflakes doesn't mention any non-expected errors.  Where can I find the report you mention?\n\nApart from that: of course, please go ahead!\n\nApart from that: is any of the changes in the branch attached to #34470 controversial?  Here is a diff.  An implementation of `residue_field` is still missing.  More generally, I did not find out how to activate the `_test_not_implemented` gadget.\n\n```diff\ndiff --git a/src/sage/rings/lazy_series.py b/src/sage/rings/lazy_series.py\nindex 4e2f35f2c3b..23992898376 100644\n--- a/src/sage/rings/lazy_series.py\n+++ b/src/sage/rings/lazy_series.py\n@@ -2934,6 +2934,32 @@ class LazyLaurentSeries(LazyCauchyProductSeries):\n         sage: f = 1 / (1 - z - z^2)\n         sage: TestSuite(f).run()\n     \"\"\"\n+    def _im_gens_(self, codomain, im_gens, base_map=None):\n+        \"\"\"\n+        Returns the image of ``self`` under the map that sends the\n+        generators of the parent of ``self`` to the elements of the\n+        tuple ``im_gens``.\n+\n+        EXAMPLES::\n+\n+            sage: Z.<x> = ZZ[]\n+            sage: K.<i> = NumberField(x^2 + 1)\n+            sage: R.<t> = LazyLaurentSeriesRing(K)\n+            sage: f = R(lambda n: i^n, valuation=-2)\n+            sage: f\n+            -t^-2 - i*t^-1 + 1 + i*t - t^2 - i*t^3 + t^4 + O(t^5)\n+            sage: f._im_gens_(R, [t + t^2])\n+            -t^-2 + (-i + 2)*t^-1 + (i - 2) + 4*t + (2*i - 6)*t^2 + (-2*i + 4)*t^3 + (-2*i - 7)*t^4 + O(t^5)\n+\n+            sage: cc = K.hom([-i])\n+            sage: f._im_gens_(R, [t + t^2], base_map=cc)\n+            -t^-2 + (i + 2)*t^-1 + (-i - 2) + 4*t + (-2*i - 6)*t^2 + (2*i + 4)*t^3 + (2*i - 7)*t^4 + O(t^5)\n+\n+        \"\"\"\n+        if base_map is None:\n+            return codomain(self(im_gens[0]))\n+\n+        return codomain(self.map_coefficients(base_map)(im_gens[0]))\n \n     def __call__(self, g, *, check=True):\n         r\"\"\"\n@@ -3844,6 +3870,33 @@ class LazyPowerSeries(LazyCauchyProductSeries):\n         deprecation(32367, \"the method compute_coefficients obsolete and has no effect.\")\n         return\n \n+    def _im_gens_(self, codomain, im_gens, base_map=None):\n+        \"\"\"\n+        Returns the image of ``self`` under the map that sends the\n+        generators of the parent of ``self`` to the elements of the\n+        tuple ``im_gens``.\n+\n+        EXAMPLES::\n+\n+            sage: Z.<x> = QQ[]\n+            sage: R.<q, t> = LazyPowerSeriesRing(Z)\n+            sage: f = 1/(1-q-t)\n+            sage: f\n+            1 + (q+t) + (q^2+2*q*t+t^2) + (q^3+3*q^2*t+3*q*t^2+t^3) + (q^4+4*q^3*t+6*q^2*t^2+4*q*t^3+t^4) + (q^5+5*q^4*t+10*q^3*t^2+10*q^2*t^3+5*q*t^4+t^5) + (q^6+6*q^5*t+15*q^4*t^2+20*q^3*t^3+15*q^2*t^4+6*q*t^5+t^6) + O(q,t)^7\n+            sage: S.<s> = LazyPowerSeriesRing(Z)\n+            sage: f._im_gens_(S, [s, x*s])\n+            1 + ((x+1)*s) + ((x^2+2*x+1)*s^2) + ((x^3+3*x^2+3*x+1)*s^3) + ((x^4+4*x^3+6*x^2+4*x+1)*s^4) + ((x^5+5*x^4+10*x^3+10*x^2+5*x+1)*s^5) + ((x^6+6*x^5+15*x^4+20*x^3+15*x^2+6*x+1)*s^6) + O(s^7)\n+\n+            sage: cc = Z.hom([-x])\n+            sage: f = 1/(1+x*q-t)\n+            sage: f._im_gens_(S, [s, x*s], base_map=cc)\n+            1 + 2*x*s + 4*x^2*s^2 + 8*x^3*s^3 + 16*x^4*s^4 + 32*x^5*s^5 + 64*x^6*s^6 + O(s^7)\n+        \"\"\"\n+        if base_map is None:\n+            return codomain(self(*im_gens))\n+\n+        return codomain(self.map_coefficients(base_map)(*im_gens))\n+\n     def __call__(self, *g, check=True):\n         r\"\"\"\n         Return the composition of ``self`` with ``g``.\ndiff --git a/src/sage/rings/lazy_series_ring.py b/src/sage/rings/lazy_series_ring.py\nindex acaef041566..7b8a001ca1d 100644\n--- a/src/sage/rings/lazy_series_ring.py\n+++ b/src/sage/rings/lazy_series_ring.py\n@@ -1201,6 +1201,27 @@ class LazyPowerSeriesRing(LazySeriesRing):\n \n             sage: L = LazyPowerSeriesRing(ZZ, 't')\n             sage: TestSuite(L).run(skip=['_test_elements', '_test_associativity', '_test_distributivity', '_test_zero'])\n+\n+            sage: L = LazyPowerSeriesRing(ZZ, 's, t')\n+            sage: TestSuite(L).run(skip=['_test_elements', '_test_associativity', '_test_distributivity', '_test_zero'])\n+\n+        Check that :trac:`34470` is fixed::\n+\n+            sage: L.<t> = LazyPowerSeriesRing(QQ)\n+            sage: L in CompleteDiscreteValuationRings\n+            True\n+            sage: L.uniformizer()\n+            t\n+            sage: lcm(1/(1 - t^2) - 1, t)\n+            t^2\n+\n+            sage: L.<t> = LazyPowerSeriesRing(ZZ)\n+            sage: L in PrincipalIdealDomains\n+            False\n+\n+            sage: L = LazyPowerSeriesRing(QQ, 's, t')\n+            sage: L in PrincipalIdealDomains\n+            False\n         \"\"\"\n         from sage.structure.category_object import normalize_names\n         names = normalize_names(-1, names)\n@@ -1213,8 +1234,9 @@ class LazyPowerSeriesRing(LazySeriesRing):\n         else:\n             self._internal_poly_ring = PolynomialRing(self._laurent_poly_ring, \"DUMMY_VARIABLE\")\n         category = Algebras(base_ring.category())\n-        if base_ring in Fields():\n+        if base_ring in Fields() and self._arity == 1:\n             category &= CompleteDiscreteValuationRings()\n+            self.uniformizer = lambda: self.gen()\n         elif base_ring in IntegralDomains():\n             category &= IntegralDomains()\n         elif base_ring in Rings().Commutative():\n@@ -1610,6 +1632,13 @@ class LazyCompletionGradedAlgebra(LazySeriesRing):\n             sage: L = LazySymmetricFunctions(s)\n             sage: TestSuite(L).run(skip=['_test_elements', '_test_associativity', '_test_distributivity', '_test_zero'])\n \n+        Check that :trac:`34470` is fixed::\n+\n+            sage: s = SymmetricFunctions(QQ).s()\n+            sage: L = LazySymmetricFunctions(s)\n+            sage: L in PrincipalIdealDomains\n+            False\n+\n         Check that a basis which is not graded is not enough::\n \n             sage: ht = SymmetricFunctions(ZZ).ht()\n@@ -1627,9 +1656,7 @@ class LazyCompletionGradedAlgebra(LazySeriesRing):\n                 raise ValueError(\"basis should be in GradedAlgebrasWithBasis\")\n             self._arity = 1\n         category = Algebras(base_ring.category())\n-        if base_ring in Fields():\n-            category &= CompleteDiscreteValuationRings()\n-        elif base_ring in IntegralDomains():\n+        if base_ring in IntegralDomains():\n             category &= IntegralDomains()\n         elif base_ring in Rings().Commutative():\n             category = category.Commutative()\n```",
    "created_at": "2022-09-16T07:19:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644668",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:6'></a>
I don't quite understand: I see three patchbot runs (one from github and two at https://patchbot.sagemath.org/ticket/32367/), but all three of them say "all tests passed".  Also, the pyflakes doesn't mention any non-expected errors.  Where can I find the report you mention?

Apart from that: of course, please go ahead!

Apart from that: is any of the changes in the branch attached to #34470 controversial?  Here is a diff.  An implementation of `residue_field` is still missing.  More generally, I did not find out how to activate the `_test_not_implemented` gadget.

```diff
diff --git a/src/sage/rings/lazy_series.py b/src/sage/rings/lazy_series.py
index 4e2f35f2c3b..23992898376 100644
--- a/src/sage/rings/lazy_series.py
+++ b/src/sage/rings/lazy_series.py
@@ -2934,6 +2934,32 @@ class LazyLaurentSeries(LazyCauchyProductSeries):
         sage: f = 1 / (1 - z - z^2)
         sage: TestSuite(f).run()
     """
+    def _im_gens_(self, codomain, im_gens, base_map=None):
+        """
+        Returns the image of ``self`` under the map that sends the
+        generators of the parent of ``self`` to the elements of the
+        tuple ``im_gens``.
+
+        EXAMPLES::
+
+            sage: Z.<x> = ZZ[]
+            sage: K.<i> = NumberField(x^2 + 1)
+            sage: R.<t> = LazyLaurentSeriesRing(K)
+            sage: f = R(lambda n: i^n, valuation=-2)
+            sage: f
+            -t^-2 - i*t^-1 + 1 + i*t - t^2 - i*t^3 + t^4 + O(t^5)
+            sage: f._im_gens_(R, [t + t^2])
+            -t^-2 + (-i + 2)*t^-1 + (i - 2) + 4*t + (2*i - 6)*t^2 + (-2*i + 4)*t^3 + (-2*i - 7)*t^4 + O(t^5)
+
+            sage: cc = K.hom([-i])
+            sage: f._im_gens_(R, [t + t^2], base_map=cc)
+            -t^-2 + (i + 2)*t^-1 + (-i - 2) + 4*t + (-2*i - 6)*t^2 + (2*i + 4)*t^3 + (2*i - 7)*t^4 + O(t^5)
+
+        """
+        if base_map is None:
+            return codomain(self(im_gens[0]))
+
+        return codomain(self.map_coefficients(base_map)(im_gens[0]))
 
     def __call__(self, g, *, check=True):
         r"""
@@ -3844,6 +3870,33 @@ class LazyPowerSeries(LazyCauchyProductSeries):
         deprecation(32367, "the method compute_coefficients obsolete and has no effect.")
         return
 
+    def _im_gens_(self, codomain, im_gens, base_map=None):
+        """
+        Returns the image of ``self`` under the map that sends the
+        generators of the parent of ``self`` to the elements of the
+        tuple ``im_gens``.
+
+        EXAMPLES::
+
+            sage: Z.<x> = QQ[]
+            sage: R.<q, t> = LazyPowerSeriesRing(Z)
+            sage: f = 1/(1-q-t)
+            sage: f
+            1 + (q+t) + (q^2+2*q*t+t^2) + (q^3+3*q^2*t+3*q*t^2+t^3) + (q^4+4*q^3*t+6*q^2*t^2+4*q*t^3+t^4) + (q^5+5*q^4*t+10*q^3*t^2+10*q^2*t^3+5*q*t^4+t^5) + (q^6+6*q^5*t+15*q^4*t^2+20*q^3*t^3+15*q^2*t^4+6*q*t^5+t^6) + O(q,t)^7
+            sage: S.<s> = LazyPowerSeriesRing(Z)
+            sage: f._im_gens_(S, [s, x*s])
+            1 + ((x+1)*s) + ((x^2+2*x+1)*s^2) + ((x^3+3*x^2+3*x+1)*s^3) + ((x^4+4*x^3+6*x^2+4*x+1)*s^4) + ((x^5+5*x^4+10*x^3+10*x^2+5*x+1)*s^5) + ((x^6+6*x^5+15*x^4+20*x^3+15*x^2+6*x+1)*s^6) + O(s^7)
+
+            sage: cc = Z.hom([-x])
+            sage: f = 1/(1+x*q-t)
+            sage: f._im_gens_(S, [s, x*s], base_map=cc)
+            1 + 2*x*s + 4*x^2*s^2 + 8*x^3*s^3 + 16*x^4*s^4 + 32*x^5*s^5 + 64*x^6*s^6 + O(s^7)
+        """
+        if base_map is None:
+            return codomain(self(*im_gens))
+
+        return codomain(self.map_coefficients(base_map)(*im_gens))
+
     def __call__(self, *g, check=True):
         r"""
         Return the composition of ``self`` with ``g``.
diff --git a/src/sage/rings/lazy_series_ring.py b/src/sage/rings/lazy_series_ring.py
index acaef041566..7b8a001ca1d 100644
--- a/src/sage/rings/lazy_series_ring.py
+++ b/src/sage/rings/lazy_series_ring.py
@@ -1201,6 +1201,27 @@ class LazyPowerSeriesRing(LazySeriesRing):
 
             sage: L = LazyPowerSeriesRing(ZZ, 't')
             sage: TestSuite(L).run(skip=['_test_elements', '_test_associativity', '_test_distributivity', '_test_zero'])
+
+            sage: L = LazyPowerSeriesRing(ZZ, 's, t')
+            sage: TestSuite(L).run(skip=['_test_elements', '_test_associativity', '_test_distributivity', '_test_zero'])
+
+        Check that :trac:`34470` is fixed::
+
+            sage: L.<t> = LazyPowerSeriesRing(QQ)
+            sage: L in CompleteDiscreteValuationRings
+            True
+            sage: L.uniformizer()
+            t
+            sage: lcm(1/(1 - t^2) - 1, t)
+            t^2
+
+            sage: L.<t> = LazyPowerSeriesRing(ZZ)
+            sage: L in PrincipalIdealDomains
+            False
+
+            sage: L = LazyPowerSeriesRing(QQ, 's, t')
+            sage: L in PrincipalIdealDomains
+            False
         """
         from sage.structure.category_object import normalize_names
         names = normalize_names(-1, names)
@@ -1213,8 +1234,9 @@ class LazyPowerSeriesRing(LazySeriesRing):
         else:
             self._internal_poly_ring = PolynomialRing(self._laurent_poly_ring, "DUMMY_VARIABLE")
         category = Algebras(base_ring.category())
-        if base_ring in Fields():
+        if base_ring in Fields() and self._arity == 1:
             category &= CompleteDiscreteValuationRings()
+            self.uniformizer = lambda: self.gen()
         elif base_ring in IntegralDomains():
             category &= IntegralDomains()
         elif base_ring in Rings().Commutative():
@@ -1610,6 +1632,13 @@ class LazyCompletionGradedAlgebra(LazySeriesRing):
             sage: L = LazySymmetricFunctions(s)
             sage: TestSuite(L).run(skip=['_test_elements', '_test_associativity', '_test_distributivity', '_test_zero'])
 
+        Check that :trac:`34470` is fixed::
+
+            sage: s = SymmetricFunctions(QQ).s()
+            sage: L = LazySymmetricFunctions(s)
+            sage: L in PrincipalIdealDomains
+            False
+
         Check that a basis which is not graded is not enough::
 
             sage: ht = SymmetricFunctions(ZZ).ht()
@@ -1627,9 +1656,7 @@ class LazyCompletionGradedAlgebra(LazySeriesRing):
                 raise ValueError("basis should be in GradedAlgebrasWithBasis")
             self._arity = 1
         category = Algebras(base_ring.category())
-        if base_ring in Fields():
-            category &= CompleteDiscreteValuationRings()
-        elif base_ring in IntegralDomains():
+        if base_ring in IntegralDomains():
             category &= IntegralDomains()
         elif base_ring in Rings().Commutative():
             category = category.Commutative()
```



---

archive/issue_comments_644669.json:
```json
{
    "body": "<a id='comment:107'></a>\nReplying to [Martin Rubey](#comment%3A106):\n> I don't quite understand: I see three patchbot runs (one from github and two at https://patchbot.sagemath.org/ticket/32367/), but all three of them say \"all tests passed\".  Also, the pyflakes doesn't mention any non-expected errors.  Where can I find the report you mention?\n\n\nIf you look at the coverage, you see that there are missing doctests. `self:` is not `sage:`, so those tests are not getting run. So I changed them to run the `TestSuite` on the corresponding classes, which lead to failures of the form:\n\n```\nsage: L.<z> = LazyLaurentSeriesRing(QQ)\nsage: L._test_not_implemented_methods()\n```\nwhich we were not previously testing in our old code.\n\n> Apart from that: of course, please go ahead!\n\n\nI will merge it into this ticket and push shortly.\n\n> Apart from that: is any of the changes in the branch attached to #34470 controversial?\n\n\nAs I mentioned on #34470, not currently, but there remains the question of putting things in UFD or not. As well as if we want them to be graded (by default) or not.\n\n> Here is a diff.  An implementation of `residue_field` is still missing.  More generally, I did not find out how to activate the `_test_not_implemented` gadget.\n\n\nThank you for the diff.\n\nThe biggest change I made is that `uniformizer` and `residue_field` are always included as public methods on the ring. I want to avoid the monkey patching (which should generally be avoided), which not only hides documentation, there is a a technical difference as well:\n\n```\nsage: class Foo:\n....:     def __init__(self):\n....:         self.bar = lambda: 5\n....:     def baz(self):\n....:         return -5\n....:         \nsage: F = Foo()\nsage: F.bar()\n5\nsage: F.baz()\n-5\nsage: F.bar\n<function Foo.__init__.<locals>.<lambda> at 0x7f9d6bea1630>\nsage: F.baz\n<bound method Foo.baz of <__main__.Foo object at 0x7f9d728a2530>>\n```\nWhile I doubt this is important in practice, it is generally considered bad practice to monkey patch. If you really don't want these methods there, I can implement the appropriate subclasses with the appropriate dispatching using the standard `__classcall_private__` mechanism (like, e.g., `Partitions`).",
    "created_at": "2022-09-16T13:11:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644669",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:107'></a>
Replying to [Martin Rubey](#comment%3A106):
> I don't quite understand: I see three patchbot runs (one from github and two at https://patchbot.sagemath.org/ticket/32367/), but all three of them say "all tests passed".  Also, the pyflakes doesn't mention any non-expected errors.  Where can I find the report you mention?


If you look at the coverage, you see that there are missing doctests. `self:` is not `sage:`, so those tests are not getting run. So I changed them to run the `TestSuite` on the corresponding classes, which lead to failures of the form:

```
sage: L.<z> = LazyLaurentSeriesRing(QQ)
sage: L._test_not_implemented_methods()
```
which we were not previously testing in our old code.

> Apart from that: of course, please go ahead!


I will merge it into this ticket and push shortly.

> Apart from that: is any of the changes in the branch attached to #34470 controversial?


As I mentioned on #34470, not currently, but there remains the question of putting things in UFD or not. As well as if we want them to be graded (by default) or not.

> Here is a diff.  An implementation of `residue_field` is still missing.  More generally, I did not find out how to activate the `_test_not_implemented` gadget.


Thank you for the diff.

The biggest change I made is that `uniformizer` and `residue_field` are always included as public methods on the ring. I want to avoid the monkey patching (which should generally be avoided), which not only hides documentation, there is a a technical difference as well:

```
sage: class Foo:
....:     def __init__(self):
....:         self.bar = lambda: 5
....:     def baz(self):
....:         return -5
....:         
sage: F = Foo()
sage: F.bar()
5
sage: F.baz()
-5
sage: F.bar
<function Foo.__init__.<locals>.<lambda> at 0x7f9d6bea1630>
sage: F.baz
<bound method Foo.baz of <__main__.Foo object at 0x7f9d728a2530>>
```
While I doubt this is important in practice, it is generally considered bad practice to monkey patch. If you really don't want these methods there, I can implement the appropriate subclasses with the appropriate dispatching using the standard `__classcall_private__` mechanism (like, e.g., `Partitions`).



---

archive/issue_comments_644670.json:
```json
{
    "body": "Changing commit from \"1df62c8481a2bf52542f5e50a6b5d8610a8ac4b9\" to \"69d44abf4ce2ec4fb652ec8e39dac42cd044537f\"",
    "created_at": "2022-09-16T13:19:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644670",
    "user": "https://github.com/tscrim"
}
```

Changing commit from "1df62c8481a2bf52542f5e50a6b5d8610a8ac4b9" to "69d44abf4ce2ec4fb652ec8e39dac42cd044537f"



---

archive/issue_comments_644671.json:
```json
{
    "body": "Changing branch from \"u/mantepse/replace_lazy_power_series-32367\" to \"u/tscrim/replace_lazy_power_series-32367\"",
    "created_at": "2022-09-16T13:19:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644671",
    "user": "https://github.com/tscrim"
}
```

Changing branch from "u/mantepse/replace_lazy_power_series-32367" to "u/tscrim/replace_lazy_power_series-32367"



---

archive/issue_comments_644672.json:
```json
{
    "body": "<a id='comment:8'></a>\nNew commits:\n|                                                                                                                                          |                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|\n|[23d951f](https://github.com/sagemath/sagetrac-mirror/commit/23d951f0e9593c03d22744e6a25f8723cd95342e)|`Doing some reviewer changes.`|\n|[6a3559e](https://github.com/sagemath/sagetrac-mirror/commit/6a3559e3ee57380f646703aac27b2f15c9bb6f01)|`Merge branch 'u/mantepse/implement_arithmetic_product_of_lazy_symmetric_functions' of https://github.com/sagemath/sagetrac-mirror into public/lazy_series/dvr_methods-TBA`|\n|[6969549](https://github.com/sagemath/sagetrac-mirror/commit/6969549f284c5d145d77ba6e8061061f4ca856b7)|`Implementing methods for DVF.`|\n|[91244f3](https://github.com/sagemath/sagetrac-mirror/commit/91244f3b0ca025a45096ddff3e4d50218022948d)|`Merge branch 'public/lazy_series/dvr_methods-TBA' into u/tscrim/replace_lazy_power_series-32367`|\n|[0a8b4c6](https://github.com/sagemath/sagetrac-mirror/commit/0a8b4c643a2f9ba6ce96653a2c21da31df62751a)|`implement _im_gens_, part 1`|\n|[380ddc9](https://github.com/sagemath/sagetrac-mirror/commit/380ddc9137af427094d30700f15043b7193af844)|`adapt doctests`|\n|[69d44ab](https://github.com/sagemath/sagetrac-mirror/commit/69d44abf4ce2ec4fb652ec8e39dac42cd044537f)|`Removing old use of LazyTaylorSeriesRing from my changes.`|",
    "created_at": "2022-09-16T13:19:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644672",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>
New commits:
|                                                                                                                                          |                              |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|
|[23d951f](https://github.com/sagemath/sagetrac-mirror/commit/23d951f0e9593c03d22744e6a25f8723cd95342e)|`Doing some reviewer changes.`|
|[6a3559e](https://github.com/sagemath/sagetrac-mirror/commit/6a3559e3ee57380f646703aac27b2f15c9bb6f01)|`Merge branch 'u/mantepse/implement_arithmetic_product_of_lazy_symmetric_functions' of https://github.com/sagemath/sagetrac-mirror into public/lazy_series/dvr_methods-TBA`|
|[6969549](https://github.com/sagemath/sagetrac-mirror/commit/6969549f284c5d145d77ba6e8061061f4ca856b7)|`Implementing methods for DVF.`|
|[91244f3](https://github.com/sagemath/sagetrac-mirror/commit/91244f3b0ca025a45096ddff3e4d50218022948d)|`Merge branch 'public/lazy_series/dvr_methods-TBA' into u/tscrim/replace_lazy_power_series-32367`|
|[0a8b4c6](https://github.com/sagemath/sagetrac-mirror/commit/0a8b4c643a2f9ba6ce96653a2c21da31df62751a)|`implement _im_gens_, part 1`|
|[380ddc9](https://github.com/sagemath/sagetrac-mirror/commit/380ddc9137af427094d30700f15043b7193af844)|`adapt doctests`|
|[69d44ab](https://github.com/sagemath/sagetrac-mirror/commit/69d44abf4ce2ec4fb652ec8e39dac42cd044537f)|`Removing old use of LazyTaylorSeriesRing from my changes.`|



---

archive/issue_comments_644673.json:
```json
{
    "body": "<a id='comment:9'></a>\nOh wow, thank you!  I love self:!",
    "created_at": "2022-09-16T13:22:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644673",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:9'></a>
Oh wow, thank you!  I love self:!



---

archive/issue_comments_644674.json:
```json
{
    "body": "<a id='comment:0'></a>\nBut too much `self:` love is bad. `:P`",
    "created_at": "2022-09-16T13:23:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644674",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:0'></a>
But too much `self:` love is bad. `:P`



---

archive/issue_comments_644675.json:
```json
{
    "body": "<a id='comment:1'></a>\n\n```\nsage: L.<t> = LazyPowerSeriesRing(QQ)\nsage: t/L(1)\nt^2\n```",
    "created_at": "2022-09-16T19:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644675",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:1'></a>

```
sage: L.<t> = LazyPowerSeriesRing(QQ)
sage: t/L(1)
t^2
```



---

archive/issue_comments_644676.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe bug above was easy to fix (I'll do it in #34470, because that's where I noticed it), but the following garbage-in-garbage-out is really hard to detect:\n\n```\nsage: L.<t> = LazyPowerSeriesRing(QQ)\nsage: t*((1+t)/(t-t^2))\n1 + t + t^2 + O(t^3)\nsage: t*(1+t)/(t-t^2)\n1 + 2*t + 2*t^2 + 2*t^3 + O(t^4)\n```",
    "created_at": "2022-09-16T20:24:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644676",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:2'></a>
The bug above was easy to fix (I'll do it in #34470, because that's where I noticed it), but the following garbage-in-garbage-out is really hard to detect:

```
sage: L.<t> = LazyPowerSeriesRing(QQ)
sage: t*((1+t)/(t-t^2))
1 + t + t^2 + O(t^3)
sage: t*(1+t)/(t-t^2)
1 + 2*t + 2*t^2 + 2*t^3 + O(t^4)
```



---

archive/issue_comments_644677.json:
```json
{
    "body": "<a id='comment:3'></a>\nDid we want to error out when doing the division by a positive valuation series? I don\u2019t remember. Although these are integral domains, right (of course, assuming the base ring is)? So we could (and probably should) follow many other things in Sage and go to the formal fraction field and do the computation there, although that possibly needs the `gcd` to be implemented. I am not sure what the best way forward with division. In any case, we should end up with the second answer (and likely consistently in the fraction field).",
    "created_at": "2022-09-16T23:45:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644677",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>
Did we want to error out when doing the division by a positive valuation series? I don’t remember. Although these are integral domains, right (of course, assuming the base ring is)? So we could (and probably should) follow many other things in Sage and go to the formal fraction field and do the computation there, although that possibly needs the `gcd` to be implemented. I am not sure what the best way forward with division. In any case, we should end up with the second answer (and likely consistently in the fraction field).



---

archive/issue_comments_644678.json:
```json
{
    "body": "<a id='comment:4'></a>\nFraction field sounds great.\n\nThe problem i see with error: we can only check once a coefficient is requested. If we check already in div itself, implicit definitions might not work anymore.",
    "created_at": "2022-09-17T06:00:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644678",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:4'></a>
Fraction field sounds great.

The problem i see with error: we can only check once a coefficient is requested. If we check already in div itself, implicit definitions might not work anymore.



---

archive/issue_comments_644679.json:
```json
{
    "body": "<a id='comment:5'></a>\nYea, I don\u2019t see an easy way out of something that has an uninitialized series. Although I was thinking of erroring out whenever the approximate valuation was positive.\n\nWith fraction fields, we run into the problem of if we want to always return something in the fraction field or not. If we do, then we need to teach using more `//` instead of `/`. If we don\u2019t, then we need to check somehow when to give something in the fraction field, which is basically the same problem.\n\nMaybe we could get around this with using the same implementation for the fraction field with just a different parent. This might help with making things work more seamlessly.\n\nFor the short-term, I propose we raise an `NotImplementedError` whenever the denominator is known to have a positive valuation.",
    "created_at": "2022-09-17T10:58:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644679",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>
Yea, I don’t see an easy way out of something that has an uninitialized series. Although I was thinking of erroring out whenever the approximate valuation was positive.

With fraction fields, we run into the problem of if we want to always return something in the fraction field or not. If we do, then we need to teach using more `//` instead of `/`. If we don’t, then we need to check somehow when to give something in the fraction field, which is basically the same problem.

Maybe we could get around this with using the same implementation for the fraction field with just a different parent. This might help with making things work more seamlessly.

For the short-term, I propose we raise an `NotImplementedError` whenever the denominator is known to have a positive valuation.



---

archive/issue_comments_644680.json:
```json
{
    "body": "<a id='comment:6'></a>\nOK, any way you like.  I admit that I like the idea of  `//`.  I remember that in FriCAS it was sometimes buggy to go from the fraction field to the ring, if mathematically possible.",
    "created_at": "2022-09-17T11:54:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644680",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:6'></a>
OK, any way you like.  I admit that I like the idea of  `//`.  I remember that in FriCAS it was sometimes buggy to go from the fraction field to the ring, if mathematically possible.



---

archive/issue_comments_644681.json:
```json
{
    "body": "<a id='comment:7'></a>\nA fraction field shouldn't be too hard to implement, but it shouldn't be something we should hold up this ticket for. I have a good idea for how to do it now. Well, for right now, it is GIGO, so we can leave it be other than explicitly telling the user when giving a positive valuation series (and promising we will implement it via the `NotImplementedError`, as we know those cases are bad). What do you think?",
    "created_at": "2022-09-17T15:02:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644681",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>
A fraction field shouldn't be too hard to implement, but it shouldn't be something we should hold up this ticket for. I have a good idea for how to do it now. Well, for right now, it is GIGO, so we can leave it be other than explicitly telling the user when giving a positive valuation series (and promising we will implement it via the `NotImplementedError`, as we know those cases are bad). What do you think?



---

archive/issue_comments_644682.json:
```json
{
    "body": "<a id='comment:8'></a>\nI keep saying to myself: let me just do this tiny thing, and then I'll stop and continue with my research (one week to go until term starts).\n\nNow it's saturday evening, and I haven't even started what I promised to do...\n\nIt is fun, though.",
    "created_at": "2022-09-17T15:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644682",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:8'></a>
I keep saying to myself: let me just do this tiny thing, and then I'll stop and continue with my research (one week to go until term starts).

Now it's saturday evening, and I haven't even started what I promised to do...

It is fun, though.



---

archive/issue_comments_644683.json:
```json
{
    "body": "<a id='comment:9'></a>\nIt wasn't as easy as I thought to raise an error and be lazy at the same time, but its done.\n\nAgain, I pushed this to #34470.\n\nI used the `TestSuite.run()` a lot to discover bugs, and I found many.  Whenever I thought I finally did it right, the `TestSuite.run()` taught me otherwise.  We should absolutely put more effort into these.",
    "created_at": "2022-09-17T21:17:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644683",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:9'></a>
It wasn't as easy as I thought to raise an error and be lazy at the same time, but its done.

Again, I pushed this to #34470.

I used the `TestSuite.run()` a lot to discover bugs, and I found many.  Whenever I thought I finally did it right, the `TestSuite.run()` taught me otherwise.  We should absolutely put more effort into these.



---

archive/issue_comments_644684.json:
```json
{
    "body": "<a id='comment:0'></a>\nFrom a quick look and what I was thinking, it seems like an overly complicated solution. I was just thinking of putting `if self._stream._approximate_order > 0:` in the inverse/division methods, then in the division/inverse streams, adding a `check` attribute and, e.g., `if check and not self.right[0]:`. I will take a closer look today.\n\nIndeed, that is the idea behind the `TestSuite`, and one of the reasons why I make sure to add it somewhere, typically for the `__init__` doctests.",
    "created_at": "2022-09-17T22:48:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644684",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:0'></a>
From a quick look and what I was thinking, it seems like an overly complicated solution. I was just thinking of putting `if self._stream._approximate_order > 0:` in the inverse/division methods, then in the division/inverse streams, adding a `check` attribute and, e.g., `if check and not self.right[0]:`. I will take a closer look today.

Indeed, that is the idea behind the `TestSuite`, and one of the reasons why I make sure to add it somewhere, typically for the `__init__` doctests.



---

archive/issue_comments_644685.json:
```json
{
    "body": "<a id='comment:1'></a>\nWell, part of the problem was that we were not lazy enough for certain recursive definitions.  For example\n\n```\n            sage: P.<x> = LazyPowerSeriesRing(QQ)\n            sage: f = P.undefined()\n            sage: f.define(1 - ~f*x)\n            sage: f\n            1 - x - x^2 - 2*x^3 - 5*x^4 - 14*x^5 - 42*x^6 + O(x^7)\n\n            sage: D = LazyDirichletSeriesRing(QQ, \"s\")\n            sage: g = D([0, 1])\n            sage: f = D.undefined()\n            sage: f.define(1 + ~f*g)\n            sage: f\n            1 + 1/(2^s) - 1/(4^s) + O(1/(8^s))\n```\ndid not work previously.\n\nAlso, equality testing should be clearer now.  I don't know why we decided to check terms in the range\n\n```\nn = min(self._coeff_stream._approximate_order, other._coeff_stream._approximate_order)\nm = max(self._coeff_stream._approximate_order, other._coeff_stream._approximate_order)\n```\npreviously - it seems to me that this computes coefficients for no good reason.  (it won't hurt, but it won't help either).\n\nOther than that, the diff is not really large.\n\nI believe that giving a name to the true order, if it is known, might be helpful for further improvements, but I did not check.\n\nI also did not check whether we should update `_approximate_order` in `Stream_inexact.__getitem__`.  I would like to first implement more `_test_XXX` methods (in particular for composition and reversion), to get a better picture of performance.",
    "created_at": "2022-09-17T23:07:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644685",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:1'></a>
Well, part of the problem was that we were not lazy enough for certain recursive definitions.  For example

```
            sage: P.<x> = LazyPowerSeriesRing(QQ)
            sage: f = P.undefined()
            sage: f.define(1 - ~f*x)
            sage: f
            1 - x - x^2 - 2*x^3 - 5*x^4 - 14*x^5 - 42*x^6 + O(x^7)

            sage: D = LazyDirichletSeriesRing(QQ, "s")
            sage: g = D([0, 1])
            sage: f = D.undefined()
            sage: f.define(1 + ~f*g)
            sage: f
            1 + 1/(2^s) - 1/(4^s) + O(1/(8^s))
```
did not work previously.

Also, equality testing should be clearer now.  I don't know why we decided to check terms in the range

```
n = min(self._coeff_stream._approximate_order, other._coeff_stream._approximate_order)
m = max(self._coeff_stream._approximate_order, other._coeff_stream._approximate_order)
```
previously - it seems to me that this computes coefficients for no good reason.  (it won't hurt, but it won't help either).

Other than that, the diff is not really large.

I believe that giving a name to the true order, if it is known, might be helpful for further improvements, but I did not check.

I also did not check whether we should update `_approximate_order` in `Stream_inexact.__getitem__`.  I would like to first implement more `_test_XXX` methods (in particular for composition and reversion), to get a better picture of performance.



---

archive/issue_comments_644686.json:
```json
{
    "body": "Changing commit from \"69d44abf4ce2ec4fb652ec8e39dac42cd044537f\" to \"3d5b8cf4c836ceb8813aa6311fe18b1f5fbffc6a\"",
    "created_at": "2022-09-18T11:42:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644686",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "69d44abf4ce2ec4fb652ec8e39dac42cd044537f" to "3d5b8cf4c836ceb8813aa6311fe18b1f5fbffc6a"



---

archive/issue_comments_644687.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n|[3d5b8cf](https://github.com/sagemath/sagetrac-mirror/commit/3d5b8cf4c836ceb8813aa6311fe18b1f5fbffc6a)|`Last little things from the patchbot.`|",
    "created_at": "2022-09-18T11:42:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644687",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
|[3d5b8cf](https://github.com/sagemath/sagetrac-mirror/commit/3d5b8cf4c836ceb8813aa6311fe18b1f5fbffc6a)|`Last little things from the patchbot.`|



---

archive/issue_comments_644688.json:
```json
{
    "body": "<a id='comment:3'></a>\nWell, for now, let's bring this to a positive review and move onto the next ticket (assuming we get a green bot this time because I didn't do anything stupid). I will do stuff there starting from your changes.\n\nI did a few little things from what I saw from the last patchbot report (the other failure seems unrelated). I made species library lazily imported to decrease the startup modules number.",
    "created_at": "2022-09-18T11:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644688",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>
Well, for now, let's bring this to a positive review and move onto the next ticket (assuming we get a green bot this time because I didn't do anything stupid). I will do stuff there starting from your changes.

I did a few little things from what I saw from the last patchbot report (the other failure seems unrelated). I made species library lazily imported to decrease the startup modules number.



---

archive/issue_events_096587.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32367#event-96587"
}
```



---

archive/issue_events_096588.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32367#event-96588"
}
```



---

archive/issue_comments_644689.json:
```json
{
    "body": "<a id='comment:5'></a>\nThe `Returns` in the doctring noticed by the patchbot is fixed in the follow-up ticket #34470.\n\nThe pyflakes warnings about imported but unused modules in `species/library.py`, are, as far as I know, unavoidable.\n\nThe ellipsis in the doctest in `sfa.py` is misinterpreted by the patchbot as a doctest continuation, but is correct, as far as I know.\n\nI am therefore setting this to positive review.",
    "created_at": "2022-09-19T21:41:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644689",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:5'></a>
The `Returns` in the doctring noticed by the patchbot is fixed in the follow-up ticket #34470.

The pyflakes warnings about imported but unused modules in `species/library.py`, are, as far as I know, unavoidable.

The ellipsis in the doctest in `sfa.py` is misinterpreted by the patchbot as a doctest continuation, but is correct, as far as I know.

I am therefore setting this to positive review.



---

archive/issue_comments_644690.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-19T21:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644690",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_644691.json:
```json
{
    "body": "Changing branch from \"u/tscrim/replace_lazy_power_series-32367\" to \"u/mantepse/replace_lazy_power_series-32367\"",
    "created_at": "2022-09-25T22:13:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644691",
    "user": "https://github.com/mantepse"
}
```

Changing branch from "u/tscrim/replace_lazy_power_series-32367" to "u/mantepse/replace_lazy_power_series-32367"



---

archive/issue_comments_644692.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2022-09-26T10:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644692",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_644693.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. Last 10 new commits:\n|                                                                                                                                           |                                                                                                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|\n|[5d76825](https://github.com/sagemath/sagetrac-mirror/commit/5d76825375d69f59f6c4bea7233e5d85da636f88)|`Merge branch 'u/chapoton/34494' of https://github.com/sagemath/sagetrac-mirror into u/tscrim/derivatives_lazy_series-34413`|\n|[97df300](https://github.com/sagemath/sagetrac-mirror/commit/97df3007235d8d654498f7179b96555ec98631a4)|`Updating sf/sfa.py doctest due to #34494.`|\n|[1388b8a](https://github.com/sagemath/sagetrac-mirror/commit/1388b8ab43afcc9b8c7bbef50a9586277580af8e)|`Merge branch 'u/chapoton/34494' of https://github.com/sagemath/sagetrac-mirror into public/rings/lazy_series_revert-34383`|\n|[7bfe5f7](https://github.com/sagemath/sagetrac-mirror/commit/7bfe5f79361e2ecec4b72bb3746714c419e4542f)|`Merge branch 'public/rings/lazy_series_revert-34383' of https://github.com/sagemath/sagetrac-mirror into public/rings/lazy_series_revert-34383`|\n|[2039990](https://github.com/sagemath/sagetrac-mirror/commit/20399901b09f6f7fbc49bc6d9856a5e6a56694c2)|`Updating doctest due to changes from #34494.`|\n|[cdea820](https://github.com/sagemath/sagetrac-mirror/commit/cdea82086b729509648bd306a04346ecead00cb1)|`Merge branch 'public/rings/lazy_series_revert-34383' of https://github.com/sagemath/sagetrac-mirror into u/tscrim/derivatives_lazy_series-34413`|\n|[b7f04ed](https://github.com/sagemath/sagetrac-mirror/commit/b7f04edc591b9cc009d2b663098f95650dde3398)|`Merge branch 'develop' of trac.sagemath.org:sage into t/34413/derivatives_lazy_series-34413`|\n|[2325826](https://github.com/sagemath/sagetrac-mirror/commit/2325826800eff4c209d64fa33c09d5dfa4ce78a3)|`Merge branch 'u/mantepse/derivatives_lazy_series-34413' of trac.sagemath.org:sage into t/34422/implement_functorial_composition_of_lazy_symmetric_functiosn`|\n|[ebcf5c3](https://github.com/sagemath/sagetrac-mirror/commit/ebcf5c3b4cb3d238d8957d06ee96421cca939a4b)|`Merge branch 'u/mantepse/implement_functorial_composition_of_lazy_symmetric_functiosn' of trac.sagemath.org:sage into t/34423/implement_arithmetic_product_of_lazy_symmetric_functions`|\n|[4172688](https://github.com/sagemath/sagetrac-mirror/commit/4172688e381f6b8e617bcd1a7583aec50f346307)|`Merge branch 'u/mantepse/implement_arithmetic_product_of_lazy_symmetric_functions' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series-32367`|",
    "created_at": "2022-09-26T10:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644693",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. Last 10 new commits:
|                                                                                                                                           |                                                                                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|
|[5d76825](https://github.com/sagemath/sagetrac-mirror/commit/5d76825375d69f59f6c4bea7233e5d85da636f88)|`Merge branch 'u/chapoton/34494' of https://github.com/sagemath/sagetrac-mirror into u/tscrim/derivatives_lazy_series-34413`|
|[97df300](https://github.com/sagemath/sagetrac-mirror/commit/97df3007235d8d654498f7179b96555ec98631a4)|`Updating sf/sfa.py doctest due to #34494.`|
|[1388b8a](https://github.com/sagemath/sagetrac-mirror/commit/1388b8ab43afcc9b8c7bbef50a9586277580af8e)|`Merge branch 'u/chapoton/34494' of https://github.com/sagemath/sagetrac-mirror into public/rings/lazy_series_revert-34383`|
|[7bfe5f7](https://github.com/sagemath/sagetrac-mirror/commit/7bfe5f79361e2ecec4b72bb3746714c419e4542f)|`Merge branch 'public/rings/lazy_series_revert-34383' of https://github.com/sagemath/sagetrac-mirror into public/rings/lazy_series_revert-34383`|
|[2039990](https://github.com/sagemath/sagetrac-mirror/commit/20399901b09f6f7fbc49bc6d9856a5e6a56694c2)|`Updating doctest due to changes from #34494.`|
|[cdea820](https://github.com/sagemath/sagetrac-mirror/commit/cdea82086b729509648bd306a04346ecead00cb1)|`Merge branch 'public/rings/lazy_series_revert-34383' of https://github.com/sagemath/sagetrac-mirror into u/tscrim/derivatives_lazy_series-34413`|
|[b7f04ed](https://github.com/sagemath/sagetrac-mirror/commit/b7f04edc591b9cc009d2b663098f95650dde3398)|`Merge branch 'develop' of trac.sagemath.org:sage into t/34413/derivatives_lazy_series-34413`|
|[2325826](https://github.com/sagemath/sagetrac-mirror/commit/2325826800eff4c209d64fa33c09d5dfa4ce78a3)|`Merge branch 'u/mantepse/derivatives_lazy_series-34413' of trac.sagemath.org:sage into t/34422/implement_functorial_composition_of_lazy_symmetric_functiosn`|
|[ebcf5c3](https://github.com/sagemath/sagetrac-mirror/commit/ebcf5c3b4cb3d238d8957d06ee96421cca939a4b)|`Merge branch 'u/mantepse/implement_functorial_composition_of_lazy_symmetric_functiosn' of trac.sagemath.org:sage into t/34423/implement_arithmetic_product_of_lazy_symmetric_functions`|
|[4172688](https://github.com/sagemath/sagetrac-mirror/commit/4172688e381f6b8e617bcd1a7583aec50f346307)|`Merge branch 'u/mantepse/implement_arithmetic_product_of_lazy_symmetric_functions' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series-32367`|



---

archive/issue_comments_644694.json:
```json
{
    "body": "Changing commit from \"3d5b8cf4c836ceb8813aa6311fe18b1f5fbffc6a\" to \"4172688e381f6b8e617bcd1a7583aec50f346307\"",
    "created_at": "2022-09-26T10:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644694",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3d5b8cf4c836ceb8813aa6311fe18b1f5fbffc6a" to "4172688e381f6b8e617bcd1a7583aec50f346307"



---

archive/issue_comments_644695.json:
```json
{
    "body": "<a id='comment:9'></a>\ntrivial (autopmatic) merge, necessary to make the patchbots happy.",
    "created_at": "2022-09-26T10:27:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644695",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:9'></a>
trivial (autopmatic) merge, necessary to make the patchbots happy.



---

archive/issue_comments_644696.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-26T10:27:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644696",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_644697.json:
```json
{
    "body": "<a id='comment:0'></a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n|                                                                                                                                           |                                                                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------|\n|[67dff95](https://github.com/sagemath/sagetrac-mirror/commit/67dff95676c5e40b6311785db4db3e53347b11c5)|`Merge branch 'develop' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series-32367`|\n|[4fc981b](https://github.com/sagemath/sagetrac-mirror/commit/4fc981b458f8d628684decf221618911ace06333)|`fix for pyflakes and blocks`|",
    "created_at": "2022-09-30T13:08:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644697",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
|                                                                                                                                           |                                                                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------|
|[67dff95](https://github.com/sagemath/sagetrac-mirror/commit/67dff95676c5e40b6311785db4db3e53347b11c5)|`Merge branch 'develop' of trac.sagemath.org:sage into t/32367/replace_lazy_power_series-32367`|
|[4fc981b](https://github.com/sagemath/sagetrac-mirror/commit/4fc981b458f8d628684decf221618911ace06333)|`fix for pyflakes and blocks`|



---

archive/issue_comments_644698.json:
```json
{
    "body": "Changing commit from \"4172688e381f6b8e617bcd1a7583aec50f346307\" to \"4fc981b458f8d628684decf221618911ace06333\"",
    "created_at": "2022-09-30T13:08:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644698",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4172688e381f6b8e617bcd1a7583aec50f346307" to "4fc981b458f8d628684decf221618911ace06333"



---

archive/issue_comments_644699.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2022-09-30T13:08:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644699",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_644700.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-30T13:09:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644700",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_644701.json:
```json
{
    "body": "<a id='comment:1'></a>\ntrivial fixes to make patchbot happy.",
    "created_at": "2022-09-30T13:09:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644701",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:1'></a>
trivial fixes to make patchbot happy.



---

archive/issue_comments_644702.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-10-11T09:14:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644702",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_096589.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-10-11T09:14:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32367#event-96589"
}
```



---

archive/issue_comments_644703.json:
```json
{
    "body": "Changing branch from \"u/mantepse/replace_lazy_power_series-32367\" to \"4fc981b458f8d628684decf221618911ace06333\"",
    "created_at": "2022-10-11T09:14:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32367",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32367#issuecomment-644703",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mantepse/replace_lazy_power_series-32367" to "4fc981b458f8d628684decf221618911ace06333"
