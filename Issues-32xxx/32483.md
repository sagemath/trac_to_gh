# Issue 32483: Remove workarounds for packages that use flit_core or poetry_core as build system

archive/issues_032246.json:
```json
{
    "body": "These workarounds were added in #29803.\n\n```\n$ git grep -B 3 'rm.*pyproject'\nbuild/pkgs/entrypoints/spkg-install.in-# Make sure that modern pip uses the generated setup.py\nbuild/pkgs/entrypoints/spkg-install.in-# that is distributed with the PyPI tarball,\nbuild/pkgs/entrypoints/spkg-install.in-# so we do not have to have flit.  Trac #29803.\nbuild/pkgs/entrypoints/spkg-install.in:rm -f pyproject.toml\n--\nbuild/pkgs/pkgconfig/spkg-install.in-# Make sure that modern pip uses the generated setup.py\nbuild/pkgs/pkgconfig/spkg-install.in-# that is distributed with the PyPI tarball,\nbuild/pkgs/pkgconfig/spkg-install.in-# so we do not have to have poetry.  Trac #29803.\nbuild/pkgs/pkgconfig/spkg-install.in:rm -f pyproject.toml\n--\nbuild/pkgs/terminado/spkg-install.in-# Make sure that modern pip uses the generated setup.py\nbuild/pkgs/terminado/spkg-install.in-# that is distributed with the PyPI tarball,\nbuild/pkgs/terminado/spkg-install.in-# so we do not have to have flit.  Trac #29803.\nbuild/pkgs/terminado/spkg-install.in:rm -f pyproject.toml\n--\n```\n\n`flit_core` is added in #31280, `poetry_core` in #33866, so we can make use of these build systems instead of relying on generated setup scripts.\n\n\nBranch/Commit: 1079cd40ceef8e7469434ca906a2ad7a1679dad5\n\nReviewer: John Palmieri\n\nAuthor: Matthias Koeppe\n\nDependencies: #33530, #33789\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/32483\n\n",
    "closed_at": "2022-09-29T21:02:40Z",
    "created_at": "2021-09-06T21:42:35Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Remove workarounds for packages that use flit_core or poetry_core as build system",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32483",
    "user": "https://github.com/mkoeppe"
}
```
These workarounds were added in #29803.

```
$ git grep -B 3 'rm.*pyproject'
build/pkgs/entrypoints/spkg-install.in-# Make sure that modern pip uses the generated setup.py
build/pkgs/entrypoints/spkg-install.in-# that is distributed with the PyPI tarball,
build/pkgs/entrypoints/spkg-install.in-# so we do not have to have flit.  Trac #29803.
build/pkgs/entrypoints/spkg-install.in:rm -f pyproject.toml
--
build/pkgs/pkgconfig/spkg-install.in-# Make sure that modern pip uses the generated setup.py
build/pkgs/pkgconfig/spkg-install.in-# that is distributed with the PyPI tarball,
build/pkgs/pkgconfig/spkg-install.in-# so we do not have to have poetry.  Trac #29803.
build/pkgs/pkgconfig/spkg-install.in:rm -f pyproject.toml
--
build/pkgs/terminado/spkg-install.in-# Make sure that modern pip uses the generated setup.py
build/pkgs/terminado/spkg-install.in-# that is distributed with the PyPI tarball,
build/pkgs/terminado/spkg-install.in-# so we do not have to have flit.  Trac #29803.
build/pkgs/terminado/spkg-install.in:rm -f pyproject.toml
--
```

`flit_core` is added in #31280, `poetry_core` in #33866, so we can make use of these build systems instead of relying on generated setup scripts.


Branch/Commit: 1079cd40ceef8e7469434ca906a2ad7a1679dad5

Reviewer: John Palmieri

Author: Matthias Koeppe

Dependencies: #33530, #33789

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/32483





---

archive/issue_events_086167.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32483",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32483#event-86167"
}
```



---

archive/issue_events_086168.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-05T00:06:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32483",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32483#event-86168"
}
```



---

archive/issue_events_086169.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-03-05T00:06:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32483",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32483#event-86169"
}
```



---

archive/issue_comments_491655.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -15,13 +15,10 @@\n build/pkgs/terminado/spkg-install.in-# so we do not have to have flit.  Trac #29803.\n build/pkgs/terminado/spkg-install.in:rm -f pyproject.toml\n --\n-build/pkgs/testpath/spkg-install.in-# Make sure that modern pip uses the generated setup.py\n-build/pkgs/testpath/spkg-install.in-# that is distributed with the PyPI tarball,\n-build/pkgs/testpath/spkg-install.in-# so we do not have to have flit.  Trac #29803.\n-build/pkgs/testpath/spkg-install.in:rm -f pyproject.toml\n ```\n \n-`flit_core` is added in #31280\n+`flit_core` is added in #31280, `poetry_core` in #33866, so we can make use of these build systems instead of relying on generated setup scripts.\n+\n \n Summary: Add flit_core, poetry_core packages, remove workarounds for packages that uses them\n \n```\n",
    "created_at": "2022-07-04T02:13:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32483",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32483#issuecomment-491655",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -15,13 +15,10 @@
 build/pkgs/terminado/spkg-install.in-# so we do not have to have flit.  Trac #29803.
 build/pkgs/terminado/spkg-install.in:rm -f pyproject.toml
 --
-build/pkgs/testpath/spkg-install.in-# Make sure that modern pip uses the generated setup.py
-build/pkgs/testpath/spkg-install.in-# that is distributed with the PyPI tarball,
-build/pkgs/testpath/spkg-install.in-# so we do not have to have flit.  Trac #29803.
-build/pkgs/testpath/spkg-install.in:rm -f pyproject.toml
 ```
 
-`flit_core` is added in #31280
+`flit_core` is added in #31280, `poetry_core` in #33866, so we can make use of these build systems instead of relying on generated setup scripts.
+
 
 Summary: Add flit_core, poetry_core packages, remove workarounds for packages that uses them
 
```




---

archive/issue_comments_491656.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-07-04T02:25:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32483",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32483#issuecomment-491656",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_491657.json:
```json
{
    "body": "<a id='comment:8'></a>Last 10 new commits:",
    "created_at": "2022-07-04T02:25:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32483",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32483#issuecomment-491657",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>Last 10 new commits:



---

archive/issue_comments_491658.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,25 @@\n+These workarounds were added in #29803.\n+\n+```\n+$ git grep -B 3 'rm.*pyproject'\n+build/pkgs/entrypoints/spkg-install.in-# Make sure that modern pip uses the generated setup.py\n+build/pkgs/entrypoints/spkg-install.in-# that is distributed with the PyPI tarball,\n+build/pkgs/entrypoints/spkg-install.in-# so we do not have to have flit.  Trac #29803.\n+build/pkgs/entrypoints/spkg-install.in:rm -f pyproject.toml\n+--\n+build/pkgs/pkgconfig/spkg-install.in-# Make sure that modern pip uses the generated setup.py\n+build/pkgs/pkgconfig/spkg-install.in-# that is distributed with the PyPI tarball,\n+build/pkgs/pkgconfig/spkg-install.in-# so we do not have to have poetry.  Trac #29803.\n+build/pkgs/pkgconfig/spkg-install.in:rm -f pyproject.toml\n+--\n+build/pkgs/terminado/spkg-install.in-# Make sure that modern pip uses the generated setup.py\n+build/pkgs/terminado/spkg-install.in-# that is distributed with the PyPI tarball,\n+build/pkgs/terminado/spkg-install.in-# so we do not have to have flit.  Trac #29803.\n+build/pkgs/terminado/spkg-install.in:rm -f pyproject.toml\n+--\n+```\n+\n+`flit_core` is added in #31280, `poetry_core` in #33866, so we can make use of these build systems instead of relying on generated setup scripts.\n \n \n Summary: Add flit_core, poetry_core packages, remove workarounds for packages that uses them\n```\n",
    "created_at": "2022-07-04T02:48:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32483",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32483#issuecomment-491658",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,25 @@
+These workarounds were added in #29803.
+
+```
+$ git grep -B 3 'rm.*pyproject'
+build/pkgs/entrypoints/spkg-install.in-# Make sure that modern pip uses the generated setup.py
+build/pkgs/entrypoints/spkg-install.in-# that is distributed with the PyPI tarball,
+build/pkgs/entrypoints/spkg-install.in-# so we do not have to have flit.  Trac #29803.
+build/pkgs/entrypoints/spkg-install.in:rm -f pyproject.toml
+--
+build/pkgs/pkgconfig/spkg-install.in-# Make sure that modern pip uses the generated setup.py
+build/pkgs/pkgconfig/spkg-install.in-# that is distributed with the PyPI tarball,
+build/pkgs/pkgconfig/spkg-install.in-# so we do not have to have poetry.  Trac #29803.
+build/pkgs/pkgconfig/spkg-install.in:rm -f pyproject.toml
+--
+build/pkgs/terminado/spkg-install.in-# Make sure that modern pip uses the generated setup.py
+build/pkgs/terminado/spkg-install.in-# that is distributed with the PyPI tarball,
+build/pkgs/terminado/spkg-install.in-# so we do not have to have flit.  Trac #29803.
+build/pkgs/terminado/spkg-install.in:rm -f pyproject.toml
+--
+```
+
+`flit_core` is added in #31280, `poetry_core` in #33866, so we can make use of these build systems instead of relying on generated setup scripts.
 
 
 Summary: Add flit_core, poetry_core packages, remove workarounds for packages that uses them
```




---

archive/issue_events_086170.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T01:56:05Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32483",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32483#event-86170"
}
```



---

archive/issue_events_086171.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T01:56:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32483",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32483#event-86171"
}
```



---

archive/issue_comments_491659.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-09-24T01:22:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32483",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32483#issuecomment-491659",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_491660.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-09-24T03:01:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32483",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32483#issuecomment-491660",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_491661.json:
```json
{
    "body": "<a id='comment:15'></a>It works, but I'm confused by `terminado`: how did you know to make `hatchling` a dependency? I don't see any reference to `flit` or `hatchling` in the `terminado` tarball \u2014\u00a0`grep flit -R .` comes up empty, for example \u2014\u00a0and it only lists `ptyprocess` and `tornado` as requirements.",
    "created_at": "2022-09-28T19:03:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32483",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32483#issuecomment-491661",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:15'></a>It works, but I'm confused by `terminado`: how did you know to make `hatchling` a dependency? I don't see any reference to `flit` or `hatchling` in the `terminado` tarball — `grep flit -R .` comes up empty, for example — and it only lists `ptyprocess` and `tornado` as requirements.



---

archive/issue_comments_491662.json:
```json
{
    "body": "<a id='comment:16'></a>Never mind, I was looking at the old tarball. I see `hatchling` in the new one.",
    "created_at": "2022-09-28T19:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32483",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32483#issuecomment-491662",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:16'></a>Never mind, I was looking at the old tarball. I see `hatchling` in the new one.



---

archive/issue_comments_491663.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-28T19:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32483",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32483#issuecomment-491663",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_491664.json:
```json
{
    "body": "<a id='comment:17'></a>Thanks! Yes, the build system changed in the update.",
    "created_at": "2022-09-28T19:10:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32483",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32483#issuecomment-491664",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>Thanks! Yes, the build system changed in the update.



---

archive/issue_comments_491665.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-09-29T21:02:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32483",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32483#issuecomment-491665",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_086172.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-09-29T21:02:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32483",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32483#event-86172"
}
```
