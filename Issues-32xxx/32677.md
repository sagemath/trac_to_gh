# Issue 32677: sage.rings.real_double: Move methods using GSL to a separate extension module

archive/issues_032440.json:
```json
{
    "assignees": [],
    "body": "Discussion: https://groups.google.com/g/sage-devel/c/HTN6KoqZVJQ/m/2BzAx5erBAAJ\n\nWe first replace use of some gsl functions like `gsl_isnan` by their C standard library counterparts, as provided by Cython's `libc.math` (\nhttps://github.com/cython/cython/blob/master/Cython/Includes/libc/math.pxd)\n\nLikewise for some uses of these functions in `src/sage/plot/plot3d/implicit_surface.pyx`\n\nWe move the remaining methods that use gsl functions to a new subclass `RealDoubleElement_gsl`, in the new module `sage.rings.real_double_element_gsl`.\n\n`RealDoubleElement` already uses a nonstandard allocator for speed. We adjust it so that it actually creates an instance of `RealDoubleElement_gsl` when the module `sage.rings.real_double_element_gsl` can be imported.\n\n(Making similar changes to `ComplexDoubleElement` is beyond the scope of this ticket.  This is more complicated because `gsl_complex` may be a type separate from the C99 `double complex` type, see https://www.gnu.org/software/gsl/doc/html/complex.html)\n\n\nDepends on #32682\nDepends on #32675\n\nCC:  @dimpase @kiwifb @williamstein @tscrim\n\nBranch/Commit: **[`520da8f`](https://github.com/sagemath/sagetrac-mirror/commit/520da8faa7377214387e5b39cd411945010367fc)**\n\nReviewer: **Fran\u00e7ois Bissey**\n\nAuthor: **Matthias Koeppe**\n\nComponent: **refactoring**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/32677_\n\n",
    "closed_at": "2021-10-31T22:21:10Z",
    "created_at": "2021-10-12T22:47:13Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/refactoring",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "sage.rings.real_double: Move methods using GSL to a separate extension module",
    "type": "issue",
    "updated_at": "2021-10-31T22:21:10Z",
    "url": "https://github.com/sagemath/sage/issues/32677",
    "user": "https://github.com/mkoeppe"
}
```
Discussion: https://groups.google.com/g/sage-devel/c/HTN6KoqZVJQ/m/2BzAx5erBAAJ

We first replace use of some gsl functions like `gsl_isnan` by their C standard library counterparts, as provided by Cython's `libc.math` (
https://github.com/cython/cython/blob/master/Cython/Includes/libc/math.pxd)

Likewise for some uses of these functions in `src/sage/plot/plot3d/implicit_surface.pyx`

We move the remaining methods that use gsl functions to a new subclass `RealDoubleElement_gsl`, in the new module `sage.rings.real_double_element_gsl`.

`RealDoubleElement` already uses a nonstandard allocator for speed. We adjust it so that it actually creates an instance of `RealDoubleElement_gsl` when the module `sage.rings.real_double_element_gsl` can be imported.

(Making similar changes to `ComplexDoubleElement` is beyond the scope of this ticket.  This is more complicated because `gsl_complex` may be a type separate from the C99 `double complex` type, see https://www.gnu.org/software/gsl/doc/html/complex.html)


Depends on #32682
Depends on #32675

CC:  @dimpase @kiwifb @williamstein @tscrim

Branch/Commit: **[`520da8f`](https://github.com/sagemath/sagetrac-mirror/commit/520da8faa7377214387e5b39cd411945010367fc)**

Reviewer: **François Bissey**

Author: **Matthias Koeppe**

Component: **refactoring**

_Issue created by migration from https://trac.sagemath.org/ticket/32677_





---

archive/issue_events_450120.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-12T22:47:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32677#event-450120"
}
```



---

archive/issue_events_450121.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-12T22:47:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "label": "https://github.com/sagemath/sage/labels/refactoring",
    "label_color": "696969",
    "label_name": "refactoring",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32677#event-450121"
}
```



---

archive/issue_events_450122.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-12T22:47:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32677#event-450122"
}
```



---

archive/issue_events_450123.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-12T22:47:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32677#event-450123"
}
```



---

archive/issue_comments_527175.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,4 @@\n Discussion: https://groups.google.com/g/sage-devel/c/HTN6KoqZVJQ/m/2BzAx5erBAAJ\n \n-\n+We first replace use of gsl functions like `gsl_isnan` by their C standard library counterparts, as provided by Cython's `libc.math` (\n+https://github.com/cython/cython/blob/master/Cython/Includes/libc/math.pxd)\n``````\n",
    "created_at": "2021-10-12T23:03:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527175",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,4 @@
 Discussion: https://groups.google.com/g/sage-devel/c/HTN6KoqZVJQ/m/2BzAx5erBAAJ
 
-
+We first replace use of gsl functions like `gsl_isnan` by their C standard library counterparts, as provided by Cython's `libc.math` (
+https://github.com/cython/cython/blob/master/Cython/Includes/libc/math.pxd)
``````




---

archive/issue_comments_527176.json:
```json
{
    "body": "Branch: **[u/mkoeppe/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module)**",
    "created_at": "2021-10-12T23:13:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527176",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module)**



---

archive/issue_comments_527177.json:
```json
{
    "body": "Commit: **[`f04ad5a`](https://github.com/sagemath/sagetrac-mirror/commit/f04ad5a9ea0c81e39ea600999d76343d4747e21e)**",
    "created_at": "2021-10-12T23:13:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527177",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`f04ad5a`](https://github.com/sagemath/sagetrac-mirror/commit/f04ad5a9ea0c81e39ea600999d76343d4747e21e)**



---

archive/issue_comments_527178.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThis simple change already breaks stuff.... what am I doing wrong?\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f04ad5a9ea0c81e39ea600999d76343d4747e21e\"><code>f04ad5a</code></a></td><td><code>src/sage/rings/real_double.pyx: Replace gsl_{isnan,isinf,finite} by libc.math functions</code></td></tr></table>\n",
    "created_at": "2021-10-12T23:13:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527178",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

This simple change already breaks stuff.... what am I doing wrong?

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f04ad5a9ea0c81e39ea600999d76343d4747e21e"><code>f04ad5a</code></a></td><td><code>src/sage/rings/real_double.pyx: Replace gsl_{isnan,isinf,finite} by libc.math functions</code></td></tr></table>




---

archive/issue_comments_527179.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nAre you doing an incremental build? I pointed sage-on-gentoo to your commit and so far it has compiled sage for python3.8 and python3.9 is on its way. I won't know about doc building breakages without being a bit more involved.",
    "created_at": "2021-10-12T23:27:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527179",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:4" align="right">comment:4</div>

Are you doing an incremental build? I pointed sage-on-gentoo to your commit and so far it has compiled sage for python3.8 and python3.9 is on its way. I won't know about doc building breakages without being a bit more involved.



---

archive/issue_comments_527180.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nInstalling \"sagemath-standard\" works here as far as I can tell.",
    "created_at": "2021-10-12T23:39:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527180",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:5" align="right">comment:5</div>

Installing "sagemath-standard" works here as far as I can tell.



---

archive/issue_comments_527181.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nYes, it compiles but doctests fail:\n\n```\nsage -t --random-seed=0 src/sage/rings/infinity.py  # 4 doctests failed\nsage -t --random-seed=0 src/sage/rings/complex_double.pyx  # 4 doctests failed\nsage -t --random-seed=0 src/sage/rings/real_double.pyx  # 10 doctests failed\n```",
    "created_at": "2021-10-12T23:46:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527181",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">comment:6</div>

Yes, it compiles but doctests fail:

```
sage -t --random-seed=0 src/sage/rings/infinity.py  # 4 doctests failed
sage -t --random-seed=0 src/sage/rings/complex_double.pyx  # 4 doctests failed
sage -t --random-seed=0 src/sage/rings/real_double.pyx  # 10 doctests failed
```



---

archive/issue_comments_527182.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n Discussion: https://groups.google.com/g/sage-devel/c/HTN6KoqZVJQ/m/2BzAx5erBAAJ\n \n-We first replace use of gsl functions like `gsl_isnan` by their C standard library counterparts, as provided by Cython's `libc.math` (\n+We first replace use of some gsl functions like `gsl_isnan` by their C standard library counterparts, as provided by Cython's `libc.math` (\n https://github.com/cython/cython/blob/master/Cython/Includes/libc/math.pxd)\n+\n+\n``````\n",
    "created_at": "2021-10-12T23:51:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527182",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
 Discussion: https://groups.google.com/g/sage-devel/c/HTN6KoqZVJQ/m/2BzAx5erBAAJ
 
-We first replace use of gsl functions like `gsl_isnan` by their C standard library counterparts, as provided by Cython's `libc.math` (
+We first replace use of some gsl functions like `gsl_isnan` by their C standard library counterparts, as provided by Cython's `libc.math` (
 https://github.com/cython/cython/blob/master/Cython/Includes/libc/math.pxd)
+
+
``````




---

archive/issue_comments_527183.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI only get those\n\n```\nsage -t --long --random-seed=0 /usr/lib/python3.9/site-packages/sage/rings/complex_double.pyx  # 2 doctests failed\nsage -t --long --random-seed=0 /usr/lib/python3.9/site-packages/sage/rings/real_double.pyx  # 2 doctests failed\n```\nAnd it looks like conversion from boolean to integer issues\n\n```\nfbissey@tarazed ~ $ sage -t --long --random-seed=0 /usr/lib/python3.9/site-packages/sage/rings/complex_double.pyx\ntoo many failed tests, not using stored timings\nRunning doctests with ID 2021-10-13-13-12-48-70eba795.\nUsing --optional=dochtml,pip,sage\nDoctesting 1 file.\nsage -t --long --random-seed=0 /usr/lib/python3.9/site-packages/sage/rings/complex_double.pyx\n**********************************************************************\nFile \"/usr/lib/python3.9/site-packages/sage/rings/complex_double.pyx\", line 1626, in sage.rings.complex_double.ComplexDoubleElement.is_infinity\nFailed example:\n    CDF(1, 2).is_infinity()\nExpected:\n    False\nGot:\n    0\n**********************************************************************\nFile \"/usr/lib/python3.9/site-packages/sage/rings/complex_double.pyx\", line 1628, in sage.rings.complex_double.ComplexDoubleElement.is_infinity\nFailed example:\n    CDF(0, oo).is_infinity()\nExpected:\n    True\nGot:\n    1\n**********************************************************************\n1 item had failures:\n   2 of   3 in sage.rings.complex_double.ComplexDoubleElement.is_infinity\n    [345 tests, 2 failures, 0.18 s]\n----------------------------------------------------------------------\nsage -t --long --random-seed=0 /usr/lib/python3.9/site-packages/sage/rings/complex_double.pyx  # 2 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 0.3 seconds\n    cpu time: 0.2 seconds\n    cumulative wall time: 0.2 seconds\nPytest is not installed, skip checking tests that rely on it.\nfbissey@tarazed ~ $ sage -t --long --random-seed=0 /usr/lib/python3.9/site-packages/sage/rings/real_double.pyx\ntoo many failed tests, not using stored timings\nRunning doctests with ID 2021-10-13-13-13-13-b89854b8.\nUsing --optional=dochtml,pip,sage\nDoctesting 1 file.\nsage -t --long --random-seed=0 /usr/lib/python3.9/site-packages/sage/rings/real_double.pyx\n**********************************************************************\nFile \"/usr/lib/python3.9/site-packages/sage/rings/real_double.pyx\", line 1730, in sage.rings.real_double.RealDoubleElement.is_infinity\nFailed example:\n    (a/b).is_infinity()\nExpected:\n    True\nGot:\n    1\n**********************************************************************\nFile \"/usr/lib/python3.9/site-packages/sage/rings/real_double.pyx\", line 1732, in sage.rings.real_double.RealDoubleElement.is_infinity\nFailed example:\n    (b/a).is_infinity()\nExpected:\n    False\nGot:\n    0\n**********************************************************************\n1 item had failures:\n   2 of   4 in sage.rings.real_double.RealDoubleElement.is_infinity\n    [454 tests, 2 failures, 0.15 s]\n----------------------------------------------------------------------\nsage -t --long --random-seed=0 /usr/lib/python3.9/site-packages/sage/rings/real_double.pyx  # 2 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 0.2 seconds\n    cpu time: 0.1 seconds\n    cumulative wall time: 0.2 seconds\n```",
    "created_at": "2021-10-13T00:15:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527183",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:9" align="right">comment:9</div>

I only get those

```
sage -t --long --random-seed=0 /usr/lib/python3.9/site-packages/sage/rings/complex_double.pyx  # 2 doctests failed
sage -t --long --random-seed=0 /usr/lib/python3.9/site-packages/sage/rings/real_double.pyx  # 2 doctests failed
```
And it looks like conversion from boolean to integer issues

```
fbissey@tarazed ~ $ sage -t --long --random-seed=0 /usr/lib/python3.9/site-packages/sage/rings/complex_double.pyx
too many failed tests, not using stored timings
Running doctests with ID 2021-10-13-13-12-48-70eba795.
Using --optional=dochtml,pip,sage
Doctesting 1 file.
sage -t --long --random-seed=0 /usr/lib/python3.9/site-packages/sage/rings/complex_double.pyx
**********************************************************************
File "/usr/lib/python3.9/site-packages/sage/rings/complex_double.pyx", line 1626, in sage.rings.complex_double.ComplexDoubleElement.is_infinity
Failed example:
    CDF(1, 2).is_infinity()
Expected:
    False
Got:
    0
**********************************************************************
File "/usr/lib/python3.9/site-packages/sage/rings/complex_double.pyx", line 1628, in sage.rings.complex_double.ComplexDoubleElement.is_infinity
Failed example:
    CDF(0, oo).is_infinity()
Expected:
    True
Got:
    1
**********************************************************************
1 item had failures:
   2 of   3 in sage.rings.complex_double.ComplexDoubleElement.is_infinity
    [345 tests, 2 failures, 0.18 s]
----------------------------------------------------------------------
sage -t --long --random-seed=0 /usr/lib/python3.9/site-packages/sage/rings/complex_double.pyx  # 2 doctests failed
----------------------------------------------------------------------
Total time for all tests: 0.3 seconds
    cpu time: 0.2 seconds
    cumulative wall time: 0.2 seconds
Pytest is not installed, skip checking tests that rely on it.
fbissey@tarazed ~ $ sage -t --long --random-seed=0 /usr/lib/python3.9/site-packages/sage/rings/real_double.pyx
too many failed tests, not using stored timings
Running doctests with ID 2021-10-13-13-13-13-b89854b8.
Using --optional=dochtml,pip,sage
Doctesting 1 file.
sage -t --long --random-seed=0 /usr/lib/python3.9/site-packages/sage/rings/real_double.pyx
**********************************************************************
File "/usr/lib/python3.9/site-packages/sage/rings/real_double.pyx", line 1730, in sage.rings.real_double.RealDoubleElement.is_infinity
Failed example:
    (a/b).is_infinity()
Expected:
    True
Got:
    1
**********************************************************************
File "/usr/lib/python3.9/site-packages/sage/rings/real_double.pyx", line 1732, in sage.rings.real_double.RealDoubleElement.is_infinity
Failed example:
    (b/a).is_infinity()
Expected:
    False
Got:
    0
**********************************************************************
1 item had failures:
   2 of   4 in sage.rings.real_double.RealDoubleElement.is_infinity
    [454 tests, 2 failures, 0.15 s]
----------------------------------------------------------------------
sage -t --long --random-seed=0 /usr/lib/python3.9/site-packages/sage/rings/real_double.pyx  # 2 doctests failed
----------------------------------------------------------------------
Total time for all tests: 0.2 seconds
    cpu time: 0.1 seconds
    cumulative wall time: 0.2 seconds
```



---

archive/issue_comments_527184.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3caeb4d6c48f4a17a85dd1c9a9efeef92c3b559\"><code>d3caeb4</code></a></td><td><code>src/sage/rings/real_double.pyx: Fixup: Replace gsl_{isnan,isinf,finite} by libc.math functions</code></td></tr></table>\n",
    "created_at": "2021-10-15T22:06:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527184",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3caeb4d6c48f4a17a85dd1c9a9efeef92c3b559"><code>d3caeb4</code></a></td><td><code>src/sage/rings/real_double.pyx: Fixup: Replace gsl_{isnan,isinf,finite} by libc.math functions</code></td></tr></table>




---

archive/issue_comments_527185.json:
```json
{
    "body": "Changed commit from **[`f04ad5a`](https://github.com/sagemath/sagetrac-mirror/commit/f04ad5a9ea0c81e39ea600999d76343d4747e21e)** to **[`d3caeb4`](https://github.com/sagemath/sagetrac-mirror/commit/d3caeb4d6c48f4a17a85dd1c9a9efeef92c3b559)**",
    "created_at": "2021-10-15T22:06:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527185",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f04ad5a`](https://github.com/sagemath/sagetrac-mirror/commit/f04ad5a9ea0c81e39ea600999d76343d4747e21e)** to **[`d3caeb4`](https://github.com/sagemath/sagetrac-mirror/commit/d3caeb4d6c48f4a17a85dd1c9a9efeef92c3b559)**



---

archive/issue_comments_527186.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,4 +3,6 @@\n We first replace use of some gsl functions like `gsl_isnan` by their C standard library counterparts, as provided by Cython's `libc.math` (\n https://github.com/cython/cython/blob/master/Cython/Includes/libc/math.pxd)\n \n+Likewise for some uses of these functions in `src/sage/plot/plot3d/implicit_surface.pyx`\n \n+\n``````\n",
    "created_at": "2021-10-15T22:46:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527186",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,4 +3,6 @@
 We first replace use of some gsl functions like `gsl_isnan` by their C standard library counterparts, as provided by Cython's `libc.math` (
 https://github.com/cython/cython/blob/master/Cython/Includes/libc/math.pxd)
 
+Likewise for some uses of these functions in `src/sage/plot/plot3d/implicit_surface.pyx`
 
+
``````




---

archive/issue_comments_527187.json:
```json
{
    "body": "Changed commit from **[`d3caeb4`](https://github.com/sagemath/sagetrac-mirror/commit/d3caeb4d6c48f4a17a85dd1c9a9efeef92c3b559)** to **[`31d188f`](https://github.com/sagemath/sagetrac-mirror/commit/31d188f92ac0ee01c81196e7b00095201f794a7a)**",
    "created_at": "2021-10-16T02:51:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527187",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d3caeb4`](https://github.com/sagemath/sagetrac-mirror/commit/d3caeb4d6c48f4a17a85dd1c9a9efeef92c3b559)** to **[`31d188f`](https://github.com/sagemath/sagetrac-mirror/commit/31d188f92ac0ee01c81196e7b00095201f794a7a)**



---

archive/issue_comments_527188.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e340b2c0cffe1dc43d30122f278991682b462689\"><code>e340b2c</code></a></td><td><code>sage.misc.allocator: Add cdef hook_tp_functions_type</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/31d188f92ac0ee01c81196e7b00095201f794a7a\"><code>31d188f</code></a></td><td><code>sage.rings.real_double_element_gsl: Split out from sage.rings.real_double</code></td></tr></table>\n",
    "created_at": "2021-10-16T02:51:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527188",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e340b2c0cffe1dc43d30122f278991682b462689"><code>e340b2c</code></a></td><td><code>sage.misc.allocator: Add cdef hook_tp_functions_type</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/31d188f92ac0ee01c81196e7b00095201f794a7a"><code>31d188f</code></a></td><td><code>sage.rings.real_double_element_gsl: Split out from sage.rings.real_double</code></td></tr></table>




---

archive/issue_comments_527189.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2021-10-16T02:52:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527189",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_527190.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5c29e6c0d39db73c72f06e738a904d506d240f24\"><code>5c29e6c</code></a></td><td><code>src/sage/plot/plot3d/implicit_surface.pyx: Use libc.math.isnan instead of gsl_isnan</code></td></tr></table>\n",
    "created_at": "2021-10-16T02:55:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527190",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5c29e6c0d39db73c72f06e738a904d506d240f24"><code>5c29e6c</code></a></td><td><code>src/sage/plot/plot3d/implicit_surface.pyx: Use libc.math.isnan instead of gsl_isnan</code></td></tr></table>




---

archive/issue_comments_527191.json:
```json
{
    "body": "Changed commit from **[`31d188f`](https://github.com/sagemath/sagetrac-mirror/commit/31d188f92ac0ee01c81196e7b00095201f794a7a)** to **[`5c29e6c`](https://github.com/sagemath/sagetrac-mirror/commit/5c29e6c0d39db73c72f06e738a904d506d240f24)**",
    "created_at": "2021-10-16T02:55:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527191",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`31d188f`](https://github.com/sagemath/sagetrac-mirror/commit/31d188f92ac0ee01c81196e7b00095201f794a7a)** to **[`5c29e6c`](https://github.com/sagemath/sagetrac-mirror/commit/5c29e6c0d39db73c72f06e738a904d506d240f24)**



---

archive/issue_comments_527192.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,4 +5,7 @@\n \n Likewise for some uses of these functions in `src/sage/plot/plot3d/implicit_surface.pyx`\n \n+We move the remaining methods that use gsl functions to a new subclass `RealDoubleElement_gsl`, in the new module `sage.rings.real_double_element_gsl`.\n \n+`RealDoubleElement` already uses a nonstandard allocator for speed. We adjust it so that it actually creates an instance of `RealDoubleElement_gsl` when the module `sage.rings.real_double_element_gsl` can be imported.\n+\n``````\n",
    "created_at": "2021-10-16T02:59:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527192",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,4 +5,7 @@
 
 Likewise for some uses of these functions in `src/sage/plot/plot3d/implicit_surface.pyx`
 
+We move the remaining methods that use gsl functions to a new subclass `RealDoubleElement_gsl`, in the new module `sage.rings.real_double_element_gsl`.
 
+`RealDoubleElement` already uses a nonstandard allocator for speed. We adjust it so that it actually creates an instance of `RealDoubleElement_gsl` when the module `sage.rings.real_double_element_gsl` can be imported.
+
``````




---

archive/issue_events_450124.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-16T02:59:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32677#event-450124"
}
```



---

archive/issue_comments_527193.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,3 +9,5 @@\n \n `RealDoubleElement` already uses a nonstandard allocator for speed. We adjust it so that it actually creates an instance of `RealDoubleElement_gsl` when the module `sage.rings.real_double_element_gsl` can be imported.\n \n+(Making similar changes to `ComplexDoubleElement` is beyond the scope of this ticket.  This is more complicated because `gsl_complex` may be a type separate from the C99 `double complex` type.)\n+\n``````\n",
    "created_at": "2021-10-16T05:38:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527193",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,3 +9,5 @@
 
 `RealDoubleElement` already uses a nonstandard allocator for speed. We adjust it so that it actually creates an instance of `RealDoubleElement_gsl` when the module `sage.rings.real_double_element_gsl` can be imported.
 
+(Making similar changes to `ComplexDoubleElement` is beyond the scope of this ticket.  This is more complicated because `gsl_complex` may be a type separate from the C99 `double complex` type.)
+
``````




---

archive/issue_comments_527194.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,5 +9,5 @@\n \n `RealDoubleElement` already uses a nonstandard allocator for speed. We adjust it so that it actually creates an instance of `RealDoubleElement_gsl` when the module `sage.rings.real_double_element_gsl` can be imported.\n \n-(Making similar changes to `ComplexDoubleElement` is beyond the scope of this ticket.  This is more complicated because `gsl_complex` may be a type separate from the C99 `double complex` type.)\n+(Making similar changes to `ComplexDoubleElement` is beyond the scope of this ticket.  This is more complicated because `gsl_complex` may be a type separate from the C99 `double complex` type, see https://www.gnu.org/software/gsl/doc/html/complex.html)\n \n``````\n",
    "created_at": "2021-10-16T05:38:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527194",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,5 +9,5 @@
 
 `RealDoubleElement` already uses a nonstandard allocator for speed. We adjust it so that it actually creates an instance of `RealDoubleElement_gsl` when the module `sage.rings.real_double_element_gsl` can be imported.
 
-(Making similar changes to `ComplexDoubleElement` is beyond the scope of this ticket.  This is more complicated because `gsl_complex` may be a type separate from the C99 `double complex` type.)
+(Making similar changes to `ComplexDoubleElement` is beyond the scope of this ticket.  This is more complicated because `gsl_complex` may be a type separate from the C99 `double complex` type, see https://www.gnu.org/software/gsl/doc/html/complex.html)
 
``````




---

archive/issue_comments_527195.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\n@kiwifb Are you going to do a full review of this?\n\nFrom the patchbot, we have three trivial failures:\n\n```\nsage -t --long --random-seed=0 src/sage/misc/functional.py\n**********************************************************************\nFile \"src/sage/misc/functional.py\", line 1540, in sage.misc.functional.round\nFailed example:\n    type(q)\nExpected:\n    <type 'sage.rings.real_double.RealDoubleElement'>\nGot:\n    <class 'sage.rings.real_double_element_gsl.RealDoubleElement_gsl'>\n**********************************************************************\n```\n\n```\nsage -t --long --random-seed=0 src/sage/libs/mpmath/utils.pyx\n**********************************************************************\nFile \"src/sage/libs/mpmath/utils.pyx\", line 408, in sage.libs.mpmath.utils.call\nFailed example:\n    type(_)\nExpected:\n    <type 'sage.rings.real_double.RealDoubleElement'>\nGot:\n    <class 'sage.rings.real_double_element_gsl.RealDoubleElement_gsl'>\n**********************************************************************\n```\n\n```\nsage -t --long --random-seed=0 src/sage/symbolic/expression.pyx\n**********************************************************************\nFile \"src/sage/symbolic/expression.pyx\", line 1689, in sage.symbolic.expression.Expression._convert\nFailed example:\n    type(_.pyobject())\nExpected:\n    <type 'sage.rings.real_double.RealDoubleElement'>\nGot:\n    <class 'sage.rings.real_double_element_gsl.RealDoubleElement_gsl'>\n**********************************************************************\n```",
    "created_at": "2021-10-18T04:49:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527195",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:20" align="right">comment:20</div>

@kiwifb Are you going to do a full review of this?

From the patchbot, we have three trivial failures:

```
sage -t --long --random-seed=0 src/sage/misc/functional.py
**********************************************************************
File "src/sage/misc/functional.py", line 1540, in sage.misc.functional.round
Failed example:
    type(q)
Expected:
    <type 'sage.rings.real_double.RealDoubleElement'>
Got:
    <class 'sage.rings.real_double_element_gsl.RealDoubleElement_gsl'>
**********************************************************************
```

```
sage -t --long --random-seed=0 src/sage/libs/mpmath/utils.pyx
**********************************************************************
File "src/sage/libs/mpmath/utils.pyx", line 408, in sage.libs.mpmath.utils.call
Failed example:
    type(_)
Expected:
    <type 'sage.rings.real_double.RealDoubleElement'>
Got:
    <class 'sage.rings.real_double_element_gsl.RealDoubleElement_gsl'>
**********************************************************************
```

```
sage -t --long --random-seed=0 src/sage/symbolic/expression.pyx
**********************************************************************
File "src/sage/symbolic/expression.pyx", line 1689, in sage.symbolic.expression.Expression._convert
Failed example:
    type(_.pyobject())
Expected:
    <type 'sage.rings.real_double.RealDoubleElement'>
Got:
    <class 'sage.rings.real_double_element_gsl.RealDoubleElement_gsl'>
**********************************************************************
```



---

archive/issue_comments_527196.json:
```json
{
    "body": "Dependencies: **#32682, #32675**",
    "created_at": "2021-10-18T05:14:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527196",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#32682, #32675**



---

archive/issue_comments_527197.json:
```json
{
    "body": "Changed commit from **[`5c29e6c`](https://github.com/sagemath/sagetrac-mirror/commit/5c29e6c0d39db73c72f06e738a904d506d240f24)** to **[`3d5bad2`](https://github.com/sagemath/sagetrac-mirror/commit/3d5bad2c26444649725142041afc4499ff3dffbc)**",
    "created_at": "2021-10-18T05:17:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527197",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5c29e6c`](https://github.com/sagemath/sagetrac-mirror/commit/5c29e6c0d39db73c72f06e738a904d506d240f24)** to **[`3d5bad2`](https://github.com/sagemath/sagetrac-mirror/commit/3d5bad2c26444649725142041afc4499ff3dffbc)**



---

archive/issue_comments_527198.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a6c9428a04d5acb20e601cc367539816bcb24dab\"><code>a6c9428</code></a></td><td><code>change <type to <class in doctests of rings,libs,interfaces,matrix,manifolds</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f3f29193aa7755c226ecaf80bb68e02539cf7e8d\"><code>f3f2919</code></a></td><td><code>Merge #32682</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/46cf0677157aef4c208034b339797d39ca846b54\"><code>46cf067</code></a></td><td><code>convert some <type to <class in doctests in src/sage</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/471b52f8221e93d19ceafaf922742dcc6ba5f86f\"><code>471b52f</code></a></td><td><code>fix wrong change</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b3d941b6562eaa1d2ca40b6834522c6aceede2a4\"><code>b3d941b</code></a></td><td><code>Merge #32675</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3d5bad2c26444649725142041afc4499ff3dffbc\"><code>3d5bad2</code></a></td><td><code>Make doctests accept RealDoubleElement and RealDoubleElement_gsl</code></td></tr></table>\n",
    "created_at": "2021-10-18T05:17:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527198",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a6c9428a04d5acb20e601cc367539816bcb24dab"><code>a6c9428</code></a></td><td><code>change <type to <class in doctests of rings,libs,interfaces,matrix,manifolds</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f3f29193aa7755c226ecaf80bb68e02539cf7e8d"><code>f3f2919</code></a></td><td><code>Merge #32682</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/46cf0677157aef4c208034b339797d39ca846b54"><code>46cf067</code></a></td><td><code>convert some <type to <class in doctests in src/sage</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/471b52f8221e93d19ceafaf922742dcc6ba5f86f"><code>471b52f</code></a></td><td><code>fix wrong change</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b3d941b6562eaa1d2ca40b6834522c6aceede2a4"><code>b3d941b</code></a></td><td><code>Merge #32675</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3d5bad2c26444649725142041afc4499ff3dffbc"><code>3d5bad2</code></a></td><td><code>Make doctests accept RealDoubleElement and RealDoubleElement_gsl</code></td></tr></table>




---

archive/issue_comments_527199.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nWas about to do a bit of reviewing. I need to pull the latest changes now.",
    "created_at": "2021-10-18T06:02:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527199",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:23" align="right">comment:23</div>

Was about to do a bit of reviewing. I need to pull the latest changes now.



---

archive/issue_comments_527200.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nI will leave the review to you `:)`.",
    "created_at": "2021-10-18T06:36:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527200",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:24" align="right">comment:24</div>

I will leave the review to you `:)`.



---

archive/issue_comments_527201.json:
```json
{
    "body": "Reviewer: **Fran\u00e7ois Bissey**",
    "created_at": "2021-10-18T07:56:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527201",
    "user": "https://github.com/kiwifb"
}
```

Reviewer: **François Bissey**



---

archive/issue_events_450125.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2021-10-18T07:56:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32677#event-450125"
}
```



---

archive/issue_events_450126.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2021-10-18T07:56:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32677#event-450126"
}
```



---

archive/issue_comments_527202.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nLet's move this on.",
    "created_at": "2021-10-18T07:56:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527202",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:25" align="right">comment:25</div>

Let's move this on.



---

archive/issue_comments_527203.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nThanks!",
    "created_at": "2021-10-18T16:10:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527203",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:26" align="right">comment:26</div>

Thanks!



---

archive/issue_events_450127.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-20T23:00:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32677#event-450127"
}
```



---

archive/issue_events_450128.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-20T23:00:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32677#event-450128"
}
```



---

archive/issue_comments_527204.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module)** to **[`3d5bad2`](https://github.com/sagemath/sagetrac-mirror/commit/3d5bad2c26444649725142041afc4499ff3dffbc)**",
    "created_at": "2021-10-20T23:00:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527204",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module)** to **[`3d5bad2`](https://github.com/sagemath/sagetrac-mirror/commit/3d5bad2c26444649725142041afc4499ff3dffbc)**



---

archive/issue_comments_527205.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nLots of failures of the form\n\n```\nsage -t --long --random-seed=95492849111503266761374143413906402145 src/doc/de/thematische_anleitungen/sage_gymnasium.rst\n**********************************************************************\nFile \"src/doc/de/thematische_anleitungen/sage_gymnasium.rst\", line 667, in doc.de.thematische_anleitungen.sage_gymnasium\nFailed example:\n    plot(f, xmin=-2, xmax=2, ymin=-10, ymax = 10, detect_poles=True)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest doc.de.thematische_anleitungen.sage_gymnasium[1]>\", line 1, in <module>\n        plot(f, xmin=-Integer(2), xmax=Integer(2), ymin=-Integer(10), ymax = Integer(10), detect_poles=True)\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/misc/decorators.py\", line 491, in wrapper\n        return func(*args, **options)\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/plot/plot.py\", line 1957, in plot\n        G = funcs.plot(*args, **original_opts)\n      File \"sage/symbolic/expression.pyx\", line 12775, in sage.symbolic.expression.Expression.plot (build/cythonized/sage/symbolic/expression.cpp:94231)\n        return plot(f, *args, **kwds)\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/misc/decorators.py\", line 491, in wrapper\n        return func(*args, **options)\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/plot/plot.py\", line 1972, in plot\n        G = _plot(funcs, (xmin, xmax), **kwds)\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/plot/plot.py\", line 2419, in _plot\n        alpha = (RDF(dy)/RDF(dx)).arctan()\n      File \"sage/structure/element.pyx\", line 494, in sage.structure.element.Element.__getattr__ (build/cythonized/sage/structure/element.c:4755)\n        return self.getattr_from_category(name)\n      File \"sage/structure/element.pyx\", line 507, in sage.structure.element.Element.getattr_from_category (build/cythonized/sage/structure/element.c:4867)\n        return getattr_from_other_class(self, cls, name)\n      File \"sage/cpython/getattr.pyx\", line 363, in sage.cpython.getattr.getattr_from_other_class (build/cythonized/sage/cpython/getattr.c:2634)\n        raise AttributeError(dummy_error_message)\n    AttributeError: 'sage.rings.real_double.RealDoubleElement' object has no attribute 'arctan'\n**********************************************************************\nFile \"src/doc/de/thematische_anleitungen/sage_gymnasium.rst\", line 674, in doc.de.thematische_anleitungen.sage_gymnasium\nFailed example:\n    plot(f, xmin=-2, xmax=2, ymin=-10, ymax = 10, detect_poles=\"show\")\nException raised:\n    Traceback (most recent call last):\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest doc.de.thematische_anleitungen.sage_gymnasium[1]>\", line 1, in <module>\n        plot(f, xmin=-Integer(2), xmax=Integer(2), ymin=-Integer(10), ymax = Integer(10), detect_poles=\"show\")\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/misc/decorators.py\", line 491, in wrapper\n        return func(*args, **options)\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/plot/plot.py\", line 1957, in plot\n        G = funcs.plot(*args, **original_opts)\n      File \"sage/symbolic/expression.pyx\", line 12775, in sage.symbolic.expression.Expression.plot (build/cythonized/sage/symbolic/expression.cpp:94231)\n        return plot(f, *args, **kwds)\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/misc/decorators.py\", line 491, in wrapper\n        return func(*args, **options)\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/plot/plot.py\", line 1972, in plot\n        G = _plot(funcs, (xmin, xmax), **kwds)\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/plot/plot.py\", line 2419, in _plot\n        alpha = (RDF(dy)/RDF(dx)).arctan()\n      File \"sage/structure/element.pyx\", line 494, in sage.structure.element.Element.__getattr__ (build/cythonized/sage/structure/element.c:4755)\n        return self.getattr_from_category(name)\n      File \"sage/structure/element.pyx\", line 507, in sage.structure.element.Element.getattr_from_category (build/cythonized/sage/structure/element.c:4867)\n        return getattr_from_other_class(self, cls, name)\n      File \"sage/cpython/getattr.pyx\", line 363, in sage.cpython.getattr.getattr_from_other_class (build/cythonized/sage/cpython/getattr.c:2634)\n        raise AttributeError(dummy_error_message)\n    AttributeError: 'sage.rings.real_double.RealDoubleElement' object has no attribute 'arctan'\n**********************************************************************\n1 item had failures:\n   2 of 294 in doc.de.thematische_anleitungen.sage_gymnasium\n    [207 tests, 2 failures, 2.47 s]\n----------------------------------------------------------------------\nsage -t --long --random-seed=95492849111503266761374143413906402145 src/doc/de/thematische_anleitungen/sage_gymnasium.rst  # 2 doctests failed\n----------------------------------------------------------------------\n```\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f04ad5a9ea0c81e39ea600999d76343d4747e21e\"><code>f04ad5a</code></a></td><td><code>src/sage/rings/real_double.pyx: Replace gsl_{isnan,isinf,finite} by libc.math functions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3caeb4d6c48f4a17a85dd1c9a9efeef92c3b559\"><code>d3caeb4</code></a></td><td><code>src/sage/rings/real_double.pyx: Fixup: Replace gsl_{isnan,isinf,finite} by libc.math functions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e340b2c0cffe1dc43d30122f278991682b462689\"><code>e340b2c</code></a></td><td><code>sage.misc.allocator: Add cdef hook_tp_functions_type</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/31d188f92ac0ee01c81196e7b00095201f794a7a\"><code>31d188f</code></a></td><td><code>sage.rings.real_double_element_gsl: Split out from sage.rings.real_double</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5c29e6c0d39db73c72f06e738a904d506d240f24\"><code>5c29e6c</code></a></td><td><code>src/sage/plot/plot3d/implicit_surface.pyx: Use libc.math.isnan instead of gsl_isnan</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f3f29193aa7755c226ecaf80bb68e02539cf7e8d\"><code>f3f2919</code></a></td><td><code>Merge #32682</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b3d941b6562eaa1d2ca40b6834522c6aceede2a4\"><code>b3d941b</code></a></td><td><code>Merge #32675</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3d5bad2c26444649725142041afc4499ff3dffbc\"><code>3d5bad2</code></a></td><td><code>Make doctests accept RealDoubleElement and RealDoubleElement_gsl</code></td></tr></table>\n",
    "created_at": "2021-10-21T22:40:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527205",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:28" align="right">comment:28</div>

Lots of failures of the form

```
sage -t --long --random-seed=95492849111503266761374143413906402145 src/doc/de/thematische_anleitungen/sage_gymnasium.rst
**********************************************************************
File "src/doc/de/thematische_anleitungen/sage_gymnasium.rst", line 667, in doc.de.thematische_anleitungen.sage_gymnasium
Failed example:
    plot(f, xmin=-2, xmax=2, ymin=-10, ymax = 10, detect_poles=True)
Exception raised:
    Traceback (most recent call last):
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest doc.de.thematische_anleitungen.sage_gymnasium[1]>", line 1, in <module>
        plot(f, xmin=-Integer(2), xmax=Integer(2), ymin=-Integer(10), ymax = Integer(10), detect_poles=True)
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/misc/decorators.py", line 491, in wrapper
        return func(*args, **options)
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/plot/plot.py", line 1957, in plot
        G = funcs.plot(*args, **original_opts)
      File "sage/symbolic/expression.pyx", line 12775, in sage.symbolic.expression.Expression.plot (build/cythonized/sage/symbolic/expression.cpp:94231)
        return plot(f, *args, **kwds)
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/misc/decorators.py", line 491, in wrapper
        return func(*args, **options)
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/plot/plot.py", line 1972, in plot
        G = _plot(funcs, (xmin, xmax), **kwds)
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/plot/plot.py", line 2419, in _plot
        alpha = (RDF(dy)/RDF(dx)).arctan()
      File "sage/structure/element.pyx", line 494, in sage.structure.element.Element.__getattr__ (build/cythonized/sage/structure/element.c:4755)
        return self.getattr_from_category(name)
      File "sage/structure/element.pyx", line 507, in sage.structure.element.Element.getattr_from_category (build/cythonized/sage/structure/element.c:4867)
        return getattr_from_other_class(self, cls, name)
      File "sage/cpython/getattr.pyx", line 363, in sage.cpython.getattr.getattr_from_other_class (build/cythonized/sage/cpython/getattr.c:2634)
        raise AttributeError(dummy_error_message)
    AttributeError: 'sage.rings.real_double.RealDoubleElement' object has no attribute 'arctan'
**********************************************************************
File "src/doc/de/thematische_anleitungen/sage_gymnasium.rst", line 674, in doc.de.thematische_anleitungen.sage_gymnasium
Failed example:
    plot(f, xmin=-2, xmax=2, ymin=-10, ymax = 10, detect_poles="show")
Exception raised:
    Traceback (most recent call last):
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest doc.de.thematische_anleitungen.sage_gymnasium[1]>", line 1, in <module>
        plot(f, xmin=-Integer(2), xmax=Integer(2), ymin=-Integer(10), ymax = Integer(10), detect_poles="show")
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/misc/decorators.py", line 491, in wrapper
        return func(*args, **options)
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/plot/plot.py", line 1957, in plot
        G = funcs.plot(*args, **original_opts)
      File "sage/symbolic/expression.pyx", line 12775, in sage.symbolic.expression.Expression.plot (build/cythonized/sage/symbolic/expression.cpp:94231)
        return plot(f, *args, **kwds)
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/misc/decorators.py", line 491, in wrapper
        return func(*args, **options)
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/plot/plot.py", line 1972, in plot
        G = _plot(funcs, (xmin, xmax), **kwds)
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/sage/plot/plot.py", line 2419, in _plot
        alpha = (RDF(dy)/RDF(dx)).arctan()
      File "sage/structure/element.pyx", line 494, in sage.structure.element.Element.__getattr__ (build/cythonized/sage/structure/element.c:4755)
        return self.getattr_from_category(name)
      File "sage/structure/element.pyx", line 507, in sage.structure.element.Element.getattr_from_category (build/cythonized/sage/structure/element.c:4867)
        return getattr_from_other_class(self, cls, name)
      File "sage/cpython/getattr.pyx", line 363, in sage.cpython.getattr.getattr_from_other_class (build/cythonized/sage/cpython/getattr.c:2634)
        raise AttributeError(dummy_error_message)
    AttributeError: 'sage.rings.real_double.RealDoubleElement' object has no attribute 'arctan'
**********************************************************************
1 item had failures:
   2 of 294 in doc.de.thematische_anleitungen.sage_gymnasium
    [207 tests, 2 failures, 2.47 s]
----------------------------------------------------------------------
sage -t --long --random-seed=95492849111503266761374143413906402145 src/doc/de/thematische_anleitungen/sage_gymnasium.rst  # 2 doctests failed
----------------------------------------------------------------------
```

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f04ad5a9ea0c81e39ea600999d76343d4747e21e"><code>f04ad5a</code></a></td><td><code>src/sage/rings/real_double.pyx: Replace gsl_{isnan,isinf,finite} by libc.math functions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3caeb4d6c48f4a17a85dd1c9a9efeef92c3b559"><code>d3caeb4</code></a></td><td><code>src/sage/rings/real_double.pyx: Fixup: Replace gsl_{isnan,isinf,finite} by libc.math functions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e340b2c0cffe1dc43d30122f278991682b462689"><code>e340b2c</code></a></td><td><code>sage.misc.allocator: Add cdef hook_tp_functions_type</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/31d188f92ac0ee01c81196e7b00095201f794a7a"><code>31d188f</code></a></td><td><code>sage.rings.real_double_element_gsl: Split out from sage.rings.real_double</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5c29e6c0d39db73c72f06e738a904d506d240f24"><code>5c29e6c</code></a></td><td><code>src/sage/plot/plot3d/implicit_surface.pyx: Use libc.math.isnan instead of gsl_isnan</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f3f29193aa7755c226ecaf80bb68e02539cf7e8d"><code>f3f2919</code></a></td><td><code>Merge #32682</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b3d941b6562eaa1d2ca40b6834522c6aceede2a4"><code>b3d941b</code></a></td><td><code>Merge #32675</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3d5bad2c26444649725142041afc4499ff3dffbc"><code>3d5bad2</code></a></td><td><code>Make doctests accept RealDoubleElement and RealDoubleElement_gsl</code></td></tr></table>




---

archive/issue_comments_527206.json:
```json
{
    "body": "Changed branch from **[`3d5bad2`](https://github.com/sagemath/sagetrac-mirror/commit/3d5bad2c26444649725142041afc4499ff3dffbc)** to **[u/mkoeppe/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module)**",
    "created_at": "2021-10-21T22:40:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527206",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[`3d5bad2`](https://github.com/sagemath/sagetrac-mirror/commit/3d5bad2c26444649725142041afc4499ff3dffbc)** to **[u/mkoeppe/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module)**



---

archive/issue_comments_527207.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nWith some diagnostics added:\n\n```\ndiff --git a/src/sage/rings/real_double.pyx b/src/sage/rings/real_double.pyx\nindex 79ddbcf279..03f1ea767e 100644\n--- a/src/sage/rings/real_double.pyx\n+++ b/src/sage/rings/real_double.pyx\n@@ -2178,9 +2178,11 @@ from sage.misc.allocator cimport hook_tp_functions, hook_tp_functions_type\n hook_tp_functions(global_dummy_element, <newfunc>(&fast_tp_new), <destructor>(&fast_tp_dealloc), False)\n try:\n     from .real_double_element_gsl import RealDoubleElement_gsl\n-except Exception:\n+except Exception as e:\n+    print(\"Error: {}\".format(e))\n     pass\n else:\n+    print(\"Hooking RealDoubleElement_gsl\")\n     # global_dummy_element is of type RealDoubleElement_gsl,\n     # so hook the base class now.\n     hook_tp_functions_type(RealDoubleElement, <newfunc>(&fast_tp_new), <destructor>(&fast_tp_dealloc), False)\n```\none sees: `Error: cannot import name ComplexField`.",
    "created_at": "2021-10-21T23:10:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527207",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:29" align="right">comment:29</div>

With some diagnostics added:

```
diff --git a/src/sage/rings/real_double.pyx b/src/sage/rings/real_double.pyx
index 79ddbcf279..03f1ea767e 100644
--- a/src/sage/rings/real_double.pyx
+++ b/src/sage/rings/real_double.pyx
@@ -2178,9 +2178,11 @@ from sage.misc.allocator cimport hook_tp_functions, hook_tp_functions_type
 hook_tp_functions(global_dummy_element, <newfunc>(&fast_tp_new), <destructor>(&fast_tp_dealloc), False)
 try:
     from .real_double_element_gsl import RealDoubleElement_gsl
-except Exception:
+except Exception as e:
+    print("Error: {}".format(e))
     pass
 else:
+    print("Hooking RealDoubleElement_gsl")
     # global_dummy_element is of type RealDoubleElement_gsl,
     # so hook the base class now.
     hook_tp_functions_type(RealDoubleElement, <newfunc>(&fast_tp_new), <destructor>(&fast_tp_dealloc), False)
```
one sees: `Error: cannot import name ComplexField`.



---

archive/issue_comments_527208.json:
```json
{
    "body": "<div id=\"comment:30\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6fcaa9b3ab95e2c98b07a7766b14c8094f64f7a2\"><code>6fcaa9b</code></a></td><td><code>Merge tag '9.5.beta4' into t/32677/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/78de558b9d6e852d42c384a3f35b7d47731d8aa5\"><code>78de558</code></a></td><td><code>src/sage/rings/real_double_element_gsl.pyx: Remove module-level import of sage.rings.complex_double to remove cyclic imports</code></td></tr></table>\n",
    "created_at": "2021-10-21T23:13:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527208",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:30"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6fcaa9b3ab95e2c98b07a7766b14c8094f64f7a2"><code>6fcaa9b</code></a></td><td><code>Merge tag '9.5.beta4' into t/32677/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/78de558b9d6e852d42c384a3f35b7d47731d8aa5"><code>78de558</code></a></td><td><code>src/sage/rings/real_double_element_gsl.pyx: Remove module-level import of sage.rings.complex_double to remove cyclic imports</code></td></tr></table>




---

archive/issue_comments_527209.json:
```json
{
    "body": "Changed commit from **[`3d5bad2`](https://github.com/sagemath/sagetrac-mirror/commit/3d5bad2c26444649725142041afc4499ff3dffbc)** to **[`78de558`](https://github.com/sagemath/sagetrac-mirror/commit/78de558b9d6e852d42c384a3f35b7d47731d8aa5)**",
    "created_at": "2021-10-21T23:13:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527209",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3d5bad2`](https://github.com/sagemath/sagetrac-mirror/commit/3d5bad2c26444649725142041afc4499ff3dffbc)** to **[`78de558`](https://github.com/sagemath/sagetrac-mirror/commit/78de558b9d6e852d42c384a3f35b7d47731d8aa5)**



---

archive/issue_events_450129.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-21T23:13:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32677#event-450129"
}
```



---

archive/issue_comments_527210.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nI hadn't seen any of that in a full ptestlong, why did Volker see something and not me?",
    "created_at": "2021-10-22T00:32:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527210",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:32" align="right">comment:32</div>

I hadn't seen any of that in a full ptestlong, why did Volker see something and not me?



---

archive/issue_comments_527211.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nThis failure came from the combination with other changes that 9.5.beta4 has included, which must have made some changes to the import order.",
    "created_at": "2021-10-22T00:37:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527211",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:33" align="right">comment:33</div>

This failure came from the combination with other changes that 9.5.beta4 has included, which must have made some changes to the import order.



---

archive/issue_comments_527212.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nOK, that would make sense. I am having a long week end, if someone want to do a new review before Monday evening (NZT) they are welcome to it.",
    "created_at": "2021-10-22T00:39:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527212",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:34" align="right">comment:34</div>

OK, that would make sense. I am having a long week end, if someone want to do a new review before Monday evening (NZT) they are welcome to it.



---

archive/issue_events_450130.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2021-10-26T08:32:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32677#event-450130"
}
```



---

archive/issue_events_450131.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2021-10-26T08:32:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32677#event-450131"
}
```



---

archive/issue_comments_527213.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nBack to positive review for me.",
    "created_at": "2021-10-26T08:32:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527213",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:35" align="right">comment:35</div>

Back to positive review for me.



---

archive/issue_comments_527214.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nThank you!",
    "created_at": "2021-10-26T18:45:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527214",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:36" align="right">comment:36</div>

Thank you!



---

archive/issue_comments_527215.json:
```json
{
    "body": "Changed commit from **[`78de558`](https://github.com/sagemath/sagetrac-mirror/commit/78de558b9d6e852d42c384a3f35b7d47731d8aa5)** to **[`520da8f`](https://github.com/sagemath/sagetrac-mirror/commit/520da8faa7377214387e5b39cd411945010367fc)**",
    "created_at": "2021-10-28T23:47:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527215",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`78de558`](https://github.com/sagemath/sagetrac-mirror/commit/78de558b9d6e852d42c384a3f35b7d47731d8aa5)** to **[`520da8f`](https://github.com/sagemath/sagetrac-mirror/commit/520da8faa7377214387e5b39cd411945010367fc)**



---

archive/issue_events_450132.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2021-10-28T23:47:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32677#event-450132"
}
```



---

archive/issue_events_450133.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2021-10-28T23:47:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32677#event-450133"
}
```



---

archive/issue_comments_527216.json:
```json
{
    "body": "<div id=\"comment:37\"></div>\n\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/520da8faa7377214387e5b39cd411945010367fc\"><code>520da8f</code></a></td><td><code>Merge tag '9.5.beta5' into t/32677/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module</code></td></tr></table>\n",
    "created_at": "2021-10-28T23:47:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527216",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:37"></div>

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/520da8faa7377214387e5b39cd411945010367fc"><code>520da8f</code></a></td><td><code>Merge tag '9.5.beta5' into t/32677/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module</code></td></tr></table>




---

archive/issue_comments_527217.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\ntrivial merge",
    "created_at": "2021-10-28T23:47:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527217",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:38" align="right">comment:38</div>

trivial merge



---

archive/issue_events_450134.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-28T23:47:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32677#event-450134"
}
```



---

archive/issue_events_450135.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-28T23:47:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32677#event-450135"
}
```



---

archive/issue_comments_527218.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module)** to **[`520da8f`](https://github.com/sagemath/sagetrac-mirror/commit/520da8faa7377214387e5b39cd411945010367fc)**",
    "created_at": "2021-10-31T22:21:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32677#issuecomment-527218",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_rings_real_double__move_methods_using_gsl_to_a_separate_extension_module)** to **[`520da8f`](https://github.com/sagemath/sagetrac-mirror/commit/520da8faa7377214387e5b39cd411945010367fc)**



---

archive/issue_events_450136.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-31T22:21:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32677#event-450136"
}
```



---

archive/issue_events_450137.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "71bf3519399dafff10f7ff1972e89a59f27b2277",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-10-31T22:21:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32677",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32677#event-450137"
}
```
