# Issue 32716: pkgs/sagemath-*/tox.ini: Create environment that uses Sage's python as the basepython, fix sagemath-standard deps

archive/issues_032479.json:
```json
{
    "body": "CC:  @dimpase @kwankyu\n\nNewer versions of `tox` seem to provision python 3.10 when the environment `python` is used, but then our wheels don't necessarily fit.\n\nFor this reason, the examples shown in the developer's manual hardcoded the Python version (`tox -e py39`). \n\nWe now define tox environments `sagepython` in `tox.ini`, which takes Python as `SAGE_VENV/bin/python3` and change the manual to use this environment in examples, such as:\n\n```\n./bootstrap && ./sage -sh -c '(cd pkgs/sagemath-standard && SAGE_NUM_THREADS=16 tox -v -v -v -e sagepython-sagewheels-nopypi)'\n```\n(to be run after `make build`)\n\nIssue created by migration from https://trac.sagemath.org/ticket/32716\n\n",
    "closed_at": "2022-07-10T22:34:59Z",
    "created_at": "2021-10-18T22:08:36Z",
    "labels": [
        "component: refactoring",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "pkgs/sagemath-*/tox.ini: Create environment that uses Sage's python as the basepython, fix sagemath-standard deps",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32716",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @dimpase @kwankyu

Newer versions of `tox` seem to provision python 3.10 when the environment `python` is used, but then our wheels don't necessarily fit.

For this reason, the examples shown in the developer's manual hardcoded the Python version (`tox -e py39`). 

We now define tox environments `sagepython` in `tox.ini`, which takes Python as `SAGE_VENV/bin/python3` and change the manual to use this environment in examples, such as:

```
./bootstrap && ./sage -sh -c '(cd pkgs/sagemath-standard && SAGE_NUM_THREADS=16 tox -v -v -v -e sagepython-sagewheels-nopypi)'
```
(to be run after `make build`)

Issue created by migration from https://trac.sagemath.org/ticket/32716





---

archive/issue_events_086616.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-01-10T00:37:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32716#event-86616"
}
```



---

archive/issue_events_086617.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32716#event-86617"
}
```



---

archive/issue_events_086618.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32716#event-86618"
}
```



---

archive/issue_comments_462757.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-05-07T23:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462757",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_462758.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-05-07T23:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462758",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_comments_462759.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-06-10T11:27:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462759",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_462760.json:
```json
{
    "body": "command in the ticket description fails with\n\n```\nWARNING: Url 'file:///home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/../../../../venv/var/lib/sage/wheels' is ignored: it is neither a file nor a directory.\nERROR: Could not find a version that satisfies the requirement sage-conf==9.7.beta1\nERROR: No matching distribution found for sage-conf==9.7.beta1\nERROR: invocation failed (exit code 1)\nERROR: could not install deps [-rrequirements.txt]; v = InvocationError('/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/bin/python -m pip install -rrequirements.txt', 1)\nsagepython-sagewheels-nopypi finish: getenv /home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi after 0.69 seconds\n...\n```",
    "created_at": "2022-06-10T11:27:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462760",
    "user": "https://github.com/dimpase"
}
```

command in the ticket description fails with

```
WARNING: Url 'file:///home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/../../../../venv/var/lib/sage/wheels' is ignored: it is neither a file nor a directory.
ERROR: Could not find a version that satisfies the requirement sage-conf==9.7.beta1
ERROR: No matching distribution found for sage-conf==9.7.beta1
ERROR: invocation failed (exit code 1)
ERROR: could not install deps [-rrequirements.txt]; v = InvocationError('/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/bin/python -m pip install -rrequirements.txt', 1)
sagepython-sagewheels-nopypi finish: getenv /home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi after 0.69 seconds
...
```



---

archive/issue_comments_462761.json:
```json
{
    "body": "Did you run `make build` as the manual explains?",
    "created_at": "2022-06-10T19:57:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462761",
    "user": "https://github.com/mkoeppe"
}
```

Did you run `make build` as the manual explains?



---

archive/issue_comments_462762.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-06-12T18:47:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462762",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_462763.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-06-13T11:11:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462763",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_462764.json:
```json
{
    "body": "besides `make build`, I also needed to apply\n\n```diff\ndiff --git a/build/pkgs/sage_conf/install-requires.txt b/build/pkgs/sage_conf/install-requires.txt\nindex 83ad7e641fa..3d4ff51d565 100644\n--- a/build/pkgs/sage_conf/install-requires.txt\n+++ b/build/pkgs/sage_conf/install-requires.txt\n@@ -1 +1 @@\n-sage-conf ~= 9.5.b6\n+sage-conf\ndiff --git a/build/pkgs/sage_setup/install-requires.txt b/build/pkgs/sage_setup/install-requires.txt\nindex 01a931f5eb5..9d4666c07f4 100644\n--- a/build/pkgs/sage_setup/install-requires.txt\n+++ b/build/pkgs/sage_setup/install-requires.txt\n@@ -1 +1 @@\n-sage-setup ~= 9.5.b6\n+sage-setup\n```\nthat `9.5.b6` seemed to come from an obsolete workaround anyway.",
    "created_at": "2022-06-13T11:11:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462764",
    "user": "https://github.com/dimpase"
}
```

besides `make build`, I also needed to apply

```diff
diff --git a/build/pkgs/sage_conf/install-requires.txt b/build/pkgs/sage_conf/install-requires.txt
index 83ad7e641fa..3d4ff51d565 100644
--- a/build/pkgs/sage_conf/install-requires.txt
+++ b/build/pkgs/sage_conf/install-requires.txt
@@ -1 +1 @@
-sage-conf ~= 9.5.b6
+sage-conf
diff --git a/build/pkgs/sage_setup/install-requires.txt b/build/pkgs/sage_setup/install-requires.txt
index 01a931f5eb5..9d4666c07f4 100644
--- a/build/pkgs/sage_setup/install-requires.txt
+++ b/build/pkgs/sage_setup/install-requires.txt
@@ -1 +1 @@
-sage-setup ~= 9.5.b6
+sage-setup
```
that `9.5.b6` seemed to come from an obsolete workaround anyway.



---

archive/issue_comments_462765.json:
```json
{
    "body": "And after these changes, it errors out (much later) with\n\n```\nModuleNotFoundError: No module named 'primecountpy'\nERROR: InvocationError for command /home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/bin/python -c 'import sys; \"\" in sys.path and sys.path.remove(\"\"); import sage.all; print(sage.all.__file__)' (exited with code 1)\n```",
    "created_at": "2022-06-13T11:18:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462765",
    "user": "https://github.com/dimpase"
}
```

And after these changes, it errors out (much later) with

```
ModuleNotFoundError: No module named 'primecountpy'
ERROR: InvocationError for command /home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/bin/python -c 'import sys; "" in sys.path and sys.path.remove(""); import sage.all; print(sage.all.__file__)' (exited with code 1)
```



---

archive/issue_comments_462766.json:
```json
{
    "body": "the latter is probably a config error, as the module is there and well:\n\n```\nsage: import primecountpy\nsage: primecountpy.primecount.prime_pi(100)\n25\n```",
    "created_at": "2022-06-13T11:28:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462766",
    "user": "https://github.com/dimpase"
}
```

the latter is probably a config error, as the module is there and well:

```
sage: import primecountpy
sage: primecountpy.primecount.prime_pi(100)
25
```



---

archive/issue_comments_462767.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-17T19:28:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462767",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462768.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-18T00:33:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462768",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462769.json:
```json
{
    "body": "Thanks for testing. Indeed it didn't work with sagemath-standard because I made a mistake in the tox configuration. Fixed now",
    "created_at": "2022-06-18T00:34:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462769",
    "user": "https://github.com/mkoeppe"
}
```

Thanks for testing. Indeed it didn't work with sagemath-standard because I made a mistake in the tox configuration. Fixed now



---

archive/issue_comments_462770.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-06-18T00:34:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462770",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_462771.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-18T00:46:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462771",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462772.json:
```json
{
    "body": "I'm not a big yaml/tompl expert, but why\n\n```\nbasepython = {env:SAGE_VENV}/bin/python3\n``` \n\nis repeated 7 times? Can't it be set once and for all?",
    "created_at": "2022-06-18T07:50:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462772",
    "user": "https://github.com/dimpase"
}
```

I'm not a big yaml/tompl expert, but why

```
basepython = {env:SAGE_VENV}/bin/python3
``` 

is repeated 7 times? Can't it be set once and for all?



---

archive/issue_comments_462773.json:
```json
{
    "body": "The `basepython` variable has useful defaulting behavior: Environment names that include a `pyNM` factor configure `basepython = pythonN.M` etc., see https://tox.wiki/en/latest/config.html#tox-environments\n\nI want to override it only for environments with the `sagepython` factor. Unfortunately I haven't found a more elegant solution than repeating it for the listed environments.",
    "created_at": "2022-06-18T17:28:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462773",
    "user": "https://github.com/mkoeppe"
}
```

The `basepython` variable has useful defaulting behavior: Environment names that include a `pyNM` factor configure `basepython = pythonN.M` etc., see https://tox.wiki/en/latest/config.html#tox-environments

I want to override it only for environments with the `sagepython` factor. Unfortunately I haven't found a more elegant solution than repeating it for the listed environments.



---

archive/issue_comments_462774.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-25T23:42:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462774",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462775.json:
```json
{
    "body": "on Fedora 34:\n\n```\nsage: import sage_conf\nsage: sage_conf.VERSION\n'9.7.beta3'\n```\nbut\n\n```\n...\nSkipping link: wrong project name (not sage-conf): file:///home/scratch/scratch2/dimpase/sage/sagetrac-mirror/local/var/lib/sage/venv-python3.9/var/lib/sage/wheels/sphinxcontrib_serializinghtml-1.1.5-py2.py3-none-any.whl\n  Local files found: /home/scratch/scratch2/dimpase/sage/sagetrac-mirror/local/var/lib/sage/venv-python3.9/var/lib/sage/wheels/sage_conf-9.7b3-py3-none-any.whl\n  Given no hashes to check 0 links for project 'sage-conf': discarding no candidates\n  ERROR: Could not find a version that satisfies the requirement sage-conf~=9.5.b6\n  ERROR: No matching distribution found for sage-conf~=9.5.b6\n  Exception information:\n  Traceback (most recent call last):\n    File \"/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib/python3.9/site-packages/pip/_vendor/resolvelib/resolvers.py\", line 171, in _merge_into_criterion\n \n     crit = self.state.criteria[name]\n  KeyError: 'sage-conf'\n```",
    "created_at": "2022-06-29T10:43:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462775",
    "user": "https://github.com/dimpase"
}
```

on Fedora 34:

```
sage: import sage_conf
sage: sage_conf.VERSION
'9.7.beta3'
```
but

```
...
Skipping link: wrong project name (not sage-conf): file:///home/scratch/scratch2/dimpase/sage/sagetrac-mirror/local/var/lib/sage/venv-python3.9/var/lib/sage/wheels/sphinxcontrib_serializinghtml-1.1.5-py2.py3-none-any.whl
  Local files found: /home/scratch/scratch2/dimpase/sage/sagetrac-mirror/local/var/lib/sage/venv-python3.9/var/lib/sage/wheels/sage_conf-9.7b3-py3-none-any.whl
  Given no hashes to check 0 links for project 'sage-conf': discarding no candidates
  ERROR: Could not find a version that satisfies the requirement sage-conf~=9.5.b6
  ERROR: No matching distribution found for sage-conf~=9.5.b6
  Exception information:
  Traceback (most recent call last):
    File "/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib/python3.9/site-packages/pip/_vendor/resolvelib/resolvers.py", line 171, in _merge_into_criterion
 
     crit = self.state.criteria[name]
  KeyError: 'sage-conf'
```



---

archive/issue_comments_462776.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-06-29T10:43:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462776",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_462777.json:
```json
{
    "body": "it seems that `sage-conf` is not looked up in the right place, i.e. in `venv/`.",
    "created_at": "2022-06-29T10:45:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462777",
    "user": "https://github.com/dimpase"
}
```

it seems that `sage-conf` is not looked up in the right place, i.e. in `venv/`.



---

archive/issue_comments_462778.json:
```json
{
    "body": "Do you happen to use `--enable-editable` in this build?",
    "created_at": "2022-06-29T15:57:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462778",
    "user": "https://github.com/mkoeppe"
}
```

Do you happen to use `--enable-editable` in this build?



---

archive/issue_comments_462779.json:
```json
{
    "body": "Replying to [comment:24 mkoeppe]:\n> Do you happen to use `--enable-editable` in this build?\n\nno",
    "created_at": "2022-06-29T16:30:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462779",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:24 mkoeppe]:
> Do you happen to use `--enable-editable` in this build?

no



---

archive/issue_comments_462780.json:
```json
{
    "body": "OK, I guess I have to make changes to `build/pkgs/sage_conf/install-requires.txt` so it does not reject the wheel",
    "created_at": "2022-06-30T00:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462780",
    "user": "https://github.com/mkoeppe"
}
```

OK, I guess I have to make changes to `build/pkgs/sage_conf/install-requires.txt` so it does not reject the wheel



---

archive/issue_comments_462781.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-30T00:38:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462781",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462782.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-06-30T00:40:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462782",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_462783.json:
```json
{
    "body": "for some reason, in this branch `./configure` was hanging (!) at testing for `giac` version. I did the following obvious change, and it passed\n\n```diff\n--- a/build/pkgs/giac/spkg-configure.m4\n+++ b/build/pkgs/giac/spkg-configure.m4\n@@ -23,5 +23,6 @@ SAGE_SPKG_CONFIGURE([giac], [\n         ], [sage_spkg_install_giac=yes])\n        ], [sage_spkg_install_giac=yes])\n        m4_popdef([GIAC_MIN_VERSION])\n+       m4_popdef([GIAC_MAX_VERSION])\n     ])\n ])\n```",
    "created_at": "2022-06-30T18:11:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462783",
    "user": "https://github.com/dimpase"
}
```

for some reason, in this branch `./configure` was hanging (!) at testing for `giac` version. I did the following obvious change, and it passed

```diff
--- a/build/pkgs/giac/spkg-configure.m4
+++ b/build/pkgs/giac/spkg-configure.m4
@@ -23,5 +23,6 @@ SAGE_SPKG_CONFIGURE([giac], [
         ], [sage_spkg_install_giac=yes])
        ], [sage_spkg_install_giac=yes])
        m4_popdef([GIAC_MIN_VERSION])
+       m4_popdef([GIAC_MAX_VERSION])
     ])
 ])
```



---

archive/issue_comments_462784.json:
```json
{
    "body": "That's very strange",
    "created_at": "2022-06-30T18:13:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462784",
    "user": "https://github.com/mkoeppe"
}
```

That's very strange



---

archive/issue_comments_462785.json:
```json
{
    "body": "Do you want to push this change to the branch here or open a new ticket for it? Either way is fine with me",
    "created_at": "2022-06-30T18:24:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462785",
    "user": "https://github.com/mkoeppe"
}
```

Do you want to push this change to the branch here or open a new ticket for it? Either way is fine with me



---

archive/issue_comments_462786.json:
```json
{
    "body": "now something is not right with `primecountpy` (which works fine with \"normal\" sage, e.g.\n`./sage -tp 16 src/sage/functions/prime_pi.pyx` passes just fine)\n\n```\nsagepython-sagewheels-nopypi finish: envreport  after 0.16 seconds\nsagepython-sagewheels-nopypi installed: DEPRECATION: --find-links option in pip freeze is deprecated. pip 21.2 will remove support for this functionality. You can find discussion regarding this at https://github.com/pypa/pip/issues/9069.,-f file:///home/scratch/scratch2/dimpase/sage/sagetrac-mirror/local/var/lib/sage/venv-python3.9/var/lib/sage/wheels,alabaster==0.7.12,Babel==2.9.1,backcall==0.2.0,certifi==2021.10.8,cffi==1.15.0,charset-normalizer==2.0.4,cvxopt==1.2.7,cycler==0.11.0,cypari2==2.1.2,cysignals==1.11.2,Cython==0.29.30,decorator==5.0.9,docutils==0.17.1,entrypoints==0.3,fonttools==4.28.4,fpylll==0.5.7,gmpy2==2.1.1,idna==3.2,imagesize==1.2.0,importlib-metadata==4.8.2,ipykernel==6.6.0,ipython==7.29.0,ipython-genutils==0.2.0,ipywidgets==7.6.5,jedi==0.18.1,Jinja2==3.1.2,jupyter-client==7.1.0,jupyter-core==4.9.1,kiwisolver==1.3.2,MarkupSafe==2.1.1,matplotlib==3.5.1,matplotlib-inline==0.1.2,memory-allocator==0.1.3,mpmath==1.2.1,nest-asyncio==1.5.4,networkx==2.6.3,numpy==1.21.4,packaging==21.3,parso==0.8.2,pexpect==4.8.0,pickleshare==0.7.5,Pillow==9.0.1,pkgconfig==1.5.5,pplpy==0.8.6,prompt-toolkit==3.0.22,ptyprocess==0.5.1,pycparser==2.21,Pygments==2.10.0,pyparsing==3.0.6,python-dateutil==2.8.2,pytz==2021.3,pyzmq==22.3.0,requests==2.26.0,rpy2==3.3.6,sage-conf==9.7b3,sagemath-standard @ file:///home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/.tmp/package/1/sagemath-standard-9.7b3.zip,scipy==1.7.3,six==1.16.0,snowballstemmer==2.1.0,Sphinx==4.4.0,sphinxcontrib-applehelp==1.0.2,sphinxcontrib-devhelp==1.0.2,sphinxcontrib-htmlhelp==2.0.0,sphinxcontrib-jsmath==1.0.1,sphinxcontrib-qthelp==1.0.3,sphinxcontrib-serializinghtml==1.1.5,sympy==1.10.1,tornado==6.1,traitlets==5.1.1,tzlocal==2.1,urllib3==1.26.6,wcwidth==0.2.5,widgetsnbextension==3.5.2,zipp==3.5.0\n  removing /home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/tmp\nsagepython-sagewheels-nopypi start: run-test-pre \nsagepython-sagewheels-nopypi run-test-pre: PYTHONHASHSEED='632737325'\nsagepython-sagewheels-nopypi finish: run-test-pre  after 0.00 seconds\nsagepython-sagewheels-nopypi start: run-test \nsagepython-sagewheels-nopypi run-test: commands[0] | python -c 'import sys; \"\" in sys.path and sys.path.remove(\"\"); import sage.all; print(sage.all.__file__)'\nsetting PATH=/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/bin:/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/src/bin:/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/build/bin:/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/local/var/lib/sage/venv-python3.9/bin:/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/local/bin:/home/scratch2/dimpase/mambaforge/bin:/users/dimpase/perl5/bin:/users/dimpase/bin:/usr/lib64/qt-3.3/bin:/usr/lib64/ccache:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/auto/users/dimpase/bin\n[3346474] /home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard$ /home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/bin/python -c 'import sys; \"\" in sys.path and sys.path.remove(\"\"); import sage.all; print(sage.all.__file__)'\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\n  File \"/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/all.py\", line 138, in <module>\n    from sage.algebras.all   import *\n  File \"/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/algebras/all.py\", line 21, in <module>\n    import sage.algebras.catalog as algebras\n  File \"/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/algebras/catalog.py\", line 84, in <module>\n    from sage.algebras.clifford_algebra import CliffordAlgebra as Clifford\n  File \"/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/algebras/clifford_algebra.py\", line 35, in <module>\n    from sage.quadratic_forms.quadratic_form import QuadraticForm\n  File \"/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/quadratic_forms/quadratic_form.py\", line 192, in <module>\n    class QuadraticForm(SageObject):\n  File \"/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/quadratic_forms/quadratic_form.py\", line 323, in QuadraticForm\n    from sage.quadratic_forms.quadratic_form__local_field_invariants import \\\n  File \"/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/quadratic_forms/quadratic_form__local_field_invariants.py\", line 30, in <module>\n    from sage.functions.all import sgn\n  File \"/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/functions/all.py\", line 68, in <module>\n    from .prime_pi import legendre_phi, partial_sieve_function, prime_pi\n  File \"sage/functions/prime_pi.pyx\", line 37, in init sage.functions.prime_pi (build/cythonized/sage/functions/prime_pi.c:5947)\n    from primecountpy.primecount import prime_pi as _prime_pi\nModuleNotFoundError: No module named 'primecountpy'\nERROR: InvocationError for command /home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/bin/python -c 'import sys; \"\" in sys.path and sys.path.remove(\"\"); import sage.all; print(sage.all.__file__)' (exited with code 1)\nsagepython-sagewheels-nopypi finish: run-test  after 0.34 seconds\nsagepython-sagewheels-nopypi start: run-test-post \nsagepython-sagewheels-nopypi finish: run-test-post  after 0.00 seconds\n_______________________________________________ summary _______________________________________________\nERROR:   sagepython-sagewheels-nopypi: commands failed\ncleanup /home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/.tmp/package/1/sagemath-standard-9.7b3.zip\n```\n\niirc I saw this earlier...",
    "created_at": "2022-06-30T19:17:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462786",
    "user": "https://github.com/dimpase"
}
```

now something is not right with `primecountpy` (which works fine with "normal" sage, e.g.
`./sage -tp 16 src/sage/functions/prime_pi.pyx` passes just fine)

```
sagepython-sagewheels-nopypi finish: envreport  after 0.16 seconds
sagepython-sagewheels-nopypi installed: DEPRECATION: --find-links option in pip freeze is deprecated. pip 21.2 will remove support for this functionality. You can find discussion regarding this at https://github.com/pypa/pip/issues/9069.,-f file:///home/scratch/scratch2/dimpase/sage/sagetrac-mirror/local/var/lib/sage/venv-python3.9/var/lib/sage/wheels,alabaster==0.7.12,Babel==2.9.1,backcall==0.2.0,certifi==2021.10.8,cffi==1.15.0,charset-normalizer==2.0.4,cvxopt==1.2.7,cycler==0.11.0,cypari2==2.1.2,cysignals==1.11.2,Cython==0.29.30,decorator==5.0.9,docutils==0.17.1,entrypoints==0.3,fonttools==4.28.4,fpylll==0.5.7,gmpy2==2.1.1,idna==3.2,imagesize==1.2.0,importlib-metadata==4.8.2,ipykernel==6.6.0,ipython==7.29.0,ipython-genutils==0.2.0,ipywidgets==7.6.5,jedi==0.18.1,Jinja2==3.1.2,jupyter-client==7.1.0,jupyter-core==4.9.1,kiwisolver==1.3.2,MarkupSafe==2.1.1,matplotlib==3.5.1,matplotlib-inline==0.1.2,memory-allocator==0.1.3,mpmath==1.2.1,nest-asyncio==1.5.4,networkx==2.6.3,numpy==1.21.4,packaging==21.3,parso==0.8.2,pexpect==4.8.0,pickleshare==0.7.5,Pillow==9.0.1,pkgconfig==1.5.5,pplpy==0.8.6,prompt-toolkit==3.0.22,ptyprocess==0.5.1,pycparser==2.21,Pygments==2.10.0,pyparsing==3.0.6,python-dateutil==2.8.2,pytz==2021.3,pyzmq==22.3.0,requests==2.26.0,rpy2==3.3.6,sage-conf==9.7b3,sagemath-standard @ file:///home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/.tmp/package/1/sagemath-standard-9.7b3.zip,scipy==1.7.3,six==1.16.0,snowballstemmer==2.1.0,Sphinx==4.4.0,sphinxcontrib-applehelp==1.0.2,sphinxcontrib-devhelp==1.0.2,sphinxcontrib-htmlhelp==2.0.0,sphinxcontrib-jsmath==1.0.1,sphinxcontrib-qthelp==1.0.3,sphinxcontrib-serializinghtml==1.1.5,sympy==1.10.1,tornado==6.1,traitlets==5.1.1,tzlocal==2.1,urllib3==1.26.6,wcwidth==0.2.5,widgetsnbextension==3.5.2,zipp==3.5.0
  removing /home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/tmp
sagepython-sagewheels-nopypi start: run-test-pre 
sagepython-sagewheels-nopypi run-test-pre: PYTHONHASHSEED='632737325'
sagepython-sagewheels-nopypi finish: run-test-pre  after 0.00 seconds
sagepython-sagewheels-nopypi start: run-test 
sagepython-sagewheels-nopypi run-test: commands[0] | python -c 'import sys; "" in sys.path and sys.path.remove(""); import sage.all; print(sage.all.__file__)'
setting PATH=/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/bin:/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/src/bin:/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/build/bin:/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/local/var/lib/sage/venv-python3.9/bin:/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/local/bin:/home/scratch2/dimpase/mambaforge/bin:/users/dimpase/perl5/bin:/users/dimpase/bin:/usr/lib64/qt-3.3/bin:/usr/lib64/ccache:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/auto/users/dimpase/bin
[3346474] /home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard$ /home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/bin/python -c 'import sys; "" in sys.path and sys.path.remove(""); import sage.all; print(sage.all.__file__)'
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/all.py", line 138, in <module>
    from sage.algebras.all   import *
  File "/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/algebras/all.py", line 21, in <module>
    import sage.algebras.catalog as algebras
  File "/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/algebras/catalog.py", line 84, in <module>
    from sage.algebras.clifford_algebra import CliffordAlgebra as Clifford
  File "/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/algebras/clifford_algebra.py", line 35, in <module>
    from sage.quadratic_forms.quadratic_form import QuadraticForm
  File "/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/quadratic_forms/quadratic_form.py", line 192, in <module>
    class QuadraticForm(SageObject):
  File "/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/quadratic_forms/quadratic_form.py", line 323, in QuadraticForm
    from sage.quadratic_forms.quadratic_form__local_field_invariants import \
  File "/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/quadratic_forms/quadratic_form__local_field_invariants.py", line 30, in <module>
    from sage.functions.all import sgn
  File "/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/functions/all.py", line 68, in <module>
    from .prime_pi import legendre_phi, partial_sieve_function, prime_pi
  File "sage/functions/prime_pi.pyx", line 37, in init sage.functions.prime_pi (build/cythonized/sage/functions/prime_pi.c:5947)
    from primecountpy.primecount import prime_pi as _prime_pi
ModuleNotFoundError: No module named 'primecountpy'
ERROR: InvocationError for command /home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/bin/python -c 'import sys; "" in sys.path and sys.path.remove(""); import sage.all; print(sage.all.__file__)' (exited with code 1)
sagepython-sagewheels-nopypi finish: run-test  after 0.34 seconds
sagepython-sagewheels-nopypi start: run-test-post 
sagepython-sagewheels-nopypi finish: run-test-post  after 0.00 seconds
_______________________________________________ summary _______________________________________________
ERROR:   sagepython-sagewheels-nopypi: commands failed
cleanup /home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/.tmp/package/1/sagemath-standard-9.7b3.zip
```

iirc I saw this earlier...



---

archive/issue_comments_462787.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-06-30T19:27:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462787",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_462788.json:
```json
{
    "body": "Replying to [comment:31 mkoeppe]:\n> Do you want to push this change to the branch here or open a new ticket for it? Either way is fine with me\n\n\nas more changes seem to be needed, perhaps just add it here?",
    "created_at": "2022-06-30T19:27:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462788",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:31 mkoeppe]:
> Do you want to push this change to the branch here or open a new ticket for it? Either way is fine with me


as more changes seem to be needed, perhaps just add it here?



---

archive/issue_comments_462789.json:
```json
{
    "body": "ok",
    "created_at": "2022-06-30T19:29:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462789",
    "user": "https://github.com/mkoeppe"
}
```

ok



---

archive/issue_comments_462790.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-01T00:52:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462790",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462791.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-01T20:27:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462791",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462792.json:
```json
{
    "body": "Replying to [comment:32 dimpase]:\n> now something is not right with `primecountpy`\n\n\nI have added it as a runtime dependency. Strange, I thought I did this a long time ago already",
    "created_at": "2022-07-01T20:28:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462792",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:32 dimpase]:
> now something is not right with `primecountpy`


I have added it as a runtime dependency. Strange, I thought I did this a long time ago already



---

archive/issue_comments_462793.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-07-01T20:28:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462793",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_462794.json:
```json
{
    "body": "now this fails with a similar error for `lrcalc`:\n\n```\nFile \"/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/combinat/sf/schur.py\", line 21, in <module>\n    import sage.libs.lrcalc.lrcalc as lrcalc\n  File \"/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/libs/lrcalc/lrcalc.py\", line 193, in <module>\n    import lrcalc\nModuleNotFoundError: No module named 'lrcalc'\nERROR: InvocationError for command /home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/bin/python -c 'import sys; \"\" in sys.path and sys.path.remove(\"\"); import sage.all; print(sage.all.__file__)' (exited with code 1)\nsagepython-sagewheels-nopypi finish: run-test  after 0.51 seconds\nsagepython-sagewheels-nopypi start: run-test-post \nsagepython-sagewheels-nopypi finish: run-test-post  after 0.00 seconds\n_______________________________________________ summary _______________________________________________\nERROR:   sagepython-sagewheels-nopypi: commands failed\n```",
    "created_at": "2022-07-02T09:21:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462794",
    "user": "https://github.com/dimpase"
}
```

now this fails with a similar error for `lrcalc`:

```
File "/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/combinat/sf/schur.py", line 21, in <module>
    import sage.libs.lrcalc.lrcalc as lrcalc
  File "/home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/lib64/python3.9/site-packages/sage/libs/lrcalc/lrcalc.py", line 193, in <module>
    import lrcalc
ModuleNotFoundError: No module named 'lrcalc'
ERROR: InvocationError for command /home/scratch/scratch2/dimpase/sage/sagetrac-mirror/pkgs/sagemath-standard/.tox/sagepython-sagewheels-nopypi/bin/python -c 'import sys; "" in sys.path and sys.path.remove(""); import sage.all; print(sage.all.__file__)' (exited with code 1)
sagepython-sagewheels-nopypi finish: run-test  after 0.51 seconds
sagepython-sagewheels-nopypi start: run-test-post 
sagepython-sagewheels-nopypi finish: run-test-post  after 0.00 seconds
_______________________________________________ summary _______________________________________________
ERROR:   sagepython-sagewheels-nopypi: commands failed
```



---

archive/issue_comments_462795.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-07-02T09:21:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462795",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_462796.json:
```json
{
    "body": "I'm trying the change for `lrcalc` analogous to the one for `primecountpy`.",
    "created_at": "2022-07-02T09:34:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462796",
    "user": "https://github.com/dimpase"
}
```

I'm trying the change for `lrcalc` analogous to the one for `primecountpy`.



---

archive/issue_comments_462797.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-02T20:48:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462797",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462798.json:
```json
{
    "body": "Replying to [comment:40 dimpase]:\n> I'm trying the change for `lrcalc` analogous to the one for `primecountpy`.\n\n\nIndeed, that was missing too, fixed now.",
    "created_at": "2022-07-02T20:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462798",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:40 dimpase]:
> I'm trying the change for `lrcalc` analogous to the one for `primecountpy`.


Indeed, that was missing too, fixed now.



---

archive/issue_comments_462799.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-07-02T22:03:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462799",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_462800.json:
```json
{
    "body": "Replying to [comment:40 dimpase]:\n> I'm trying the change for `lrcalc` analogous to the one for `primecountpy`.\n\nthat appeared to suffice (but now the branch got updated)",
    "created_at": "2022-07-03T07:24:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462800",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:40 dimpase]:
> I'm trying the change for `lrcalc` analogous to the one for `primecountpy`.

that appeared to suffice (but now the branch got updated)



---

archive/issue_comments_462801.json:
```json
{
    "body": "what I don't like are explicit versions of `sage-conf` and `sage-setup` in `requirements.txt`\n\nObviously there should be an automated way.",
    "created_at": "2022-07-03T07:27:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462801",
    "user": "https://github.com/dimpase"
}
```

what I don't like are explicit versions of `sage-conf` and `sage-setup` in `requirements.txt`

Obviously there should be an automated way.



---

archive/issue_comments_462802.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2022-07-03T08:23:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462802",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_462803.json:
```json
{
    "body": "OK, otherwise it looks good. Perhaps deal with versions mentioned in the last comment on another ticket (unless it can be trivially fixed).",
    "created_at": "2022-07-03T08:23:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462803",
    "user": "https://github.com/dimpase"
}
```

OK, otherwise it looks good. Perhaps deal with versions mentioned in the last comment on another ticket (unless it can be trivially fixed).



---

archive/issue_comments_462804.json:
```json
{
    "body": "Replying to [comment:47 dimpase]:\n> what I don't like are explicit versions of `sage-conf` and `sage-setup` in `requirements.txt`\n> \n> Obviously there should be an automated way.\n\n\n`src/requirements.txt` is already generated from `src/requirements.txt.m4`\n\nIf you mean `build/pkgs/sage_conf/install-requires.txt` and `build/pkgs/sage_setup/install-requires.txt`, yes, that will need a better solution but it's way beyond the scope of this ticket",
    "created_at": "2022-07-03T16:42:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462804",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:47 dimpase]:
> what I don't like are explicit versions of `sage-conf` and `sage-setup` in `requirements.txt`
> 
> Obviously there should be an automated way.


`src/requirements.txt` is already generated from `src/requirements.txt.m4`

If you mean `build/pkgs/sage_conf/install-requires.txt` and `build/pkgs/sage_setup/install-requires.txt`, yes, that will need a better solution but it's way beyond the scope of this ticket



---

archive/issue_comments_462805.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2022-07-03T16:42:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462805",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_462806.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-03T17:29:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462806",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_462807.json:
```json
{
    "body": "OK",
    "created_at": "2022-07-03T17:29:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462807",
    "user": "https://github.com/dimpase"
}
```

OK



---

archive/issue_comments_462808.json:
```json
{
    "body": "Thanks!",
    "created_at": "2022-07-03T17:40:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462808",
    "user": "https://github.com/mkoeppe"
}
```

Thanks!



---

archive/issue_comments_462809.json:
```json
{
    "body": "Merge failure on top of:\n\n662aaf256a Trac #32423: Update numpy to 1.22.x, scipy 1.8.x, networkx 2.8.x\n\nd98aa7304d Trac #29549: bootstrap: Clean up use of gettextize\n\n24b4eeba5e Trac #13321: FreeModule.hom stores its matrix over the wrong ring\n\n93357f31bf Trac #34104: Build & Test workflow: Run apt-get update first\n\n23e4bbe7d5 Trac #34092: Docbuild workflow broken because furo is too new\n\n9440e71d60 Trac #34088: cygwin python3 missing ensurepip\n\n9879ff4e0c Trac #33936: Remove runtime dependency on sage_docbuild introduced in #33763\n\n55d05c97cb Trac #31403: giac: Make cliquer a dependency, libnauty an optional dependency\n\n843eb03e7e Updated [SageMath](SageMath) version to 9.7.beta4\n\n\n\nmerge was not clean: conflicts in pkgs/sagemath-standard/tox.ini",
    "created_at": "2022-07-08T21:13:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462809",
    "user": "https://github.com/vbraun"
}
```

Merge failure on top of:

662aaf256a Trac #32423: Update numpy to 1.22.x, scipy 1.8.x, networkx 2.8.x

d98aa7304d Trac #29549: bootstrap: Clean up use of gettextize

24b4eeba5e Trac #13321: FreeModule.hom stores its matrix over the wrong ring

93357f31bf Trac #34104: Build & Test workflow: Run apt-get update first

23e4bbe7d5 Trac #34092: Docbuild workflow broken because furo is too new

9440e71d60 Trac #34088: cygwin python3 missing ensurepip

9879ff4e0c Trac #33936: Remove runtime dependency on sage_docbuild introduced in #33763

55d05c97cb Trac #31403: giac: Make cliquer a dependency, libnauty an optional dependency

843eb03e7e Updated [SageMath](SageMath) version to 9.7.beta4



merge was not clean: conflicts in pkgs/sagemath-standard/tox.ini



---

archive/issue_comments_462810.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-07-08T21:13:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462810",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_462811.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-08T23:37:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462811",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462812.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2022-07-08T23:37:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462812",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_462813.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-07-10T22:34:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462813",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_086619.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-07-10T22:34:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32716#event-86619"
}
```



---

archive/issue_comments_462814.json:
```json
{
    "body": "Replying to [comment:49 mkoeppe]:\n> Replying to [comment:47 dimpase]:\n> > what I don't like are explicit versions of `sage-conf` and `sage-setup` in `requirements.txt`\n> > \n> > Obviously there should be an automated way.\n\n> \n> `src/requirements.txt` is already generated from `src/requirements.txt.m4`\n> \n> If you mean `build/pkgs/sage_conf/install-requires.txt` and `build/pkgs/sage_setup/install-requires.txt`, yes, that will need a better solution but it's way beyond the scope of this ticket\n\n\nImplemented now in #33817",
    "created_at": "2022-07-27T01:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32716#issuecomment-462814",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:49 mkoeppe]:
> Replying to [comment:47 dimpase]:
> > what I don't like are explicit versions of `sage-conf` and `sage-setup` in `requirements.txt`
> > 
> > Obviously there should be an automated way.

> 
> `src/requirements.txt` is already generated from `src/requirements.txt.m4`
> 
> If you mean `build/pkgs/sage_conf/install-requires.txt` and `build/pkgs/sage_setup/install-requires.txt`, yes, that will need a better solution but it's way beyond the scope of this ticket


Implemented now in #33817
