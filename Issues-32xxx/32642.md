# Issue 32642: enumeration of linear intervals in posets

archive/issues_032405.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nas one useful tool to have\n\nCC:  @tscrim @slel\n\nComponent: **combinatorics**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\nBranch/Commit: **[`f4e0d26`](https://github.com/sagemath/sagetrac-mirror/commit/f4e0d26d4eb193da548044d51badaf349d1860dc)**\n\nReviewer: **Travis Scrimshaw**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/32642_\n\n",
    "closed_at": "2021-10-19T20:31:52Z",
    "created_at": "2021-10-06T07:51:25Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "enumeration of linear intervals in posets",
    "type": "issue",
    "updated_at": "2021-10-19T20:31:52Z",
    "url": "https://github.com/sagemath/sage/issues/32642",
    "user": "https://github.com/fchapoton"
}
```
<div id="comment:0"></div>

as one useful tool to have

CC:  @tscrim @slel

Component: **combinatorics**

Author: **Frédéric Chapoton**

Branch/Commit: **[`f4e0d26`](https://github.com/sagemath/sagetrac-mirror/commit/f4e0d26d4eb193da548044d51badaf349d1860dc)**

Reviewer: **Travis Scrimshaw**

_Issue created by migration from https://trac.sagemath.org/ticket/32642_





---

archive/issue_events_446434.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-10-06T07:51:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32642#event-446434"
}
```



---

archive/issue_events_446435.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-10-06T07:51:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32642#event-446435"
}
```



---

archive/issue_events_446436.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-10-06T07:51:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32642#event-446436"
}
```



---

archive/issue_events_446437.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-10-06T07:51:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32642#event-446437"
}
```



---

archive/issue_comments_526326.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7b33047a8b777f6b22772405040224fefe2017b5\"><code>7b33047</code></a></td><td><code>enumeration of linear intervals in posets</code></td></tr></table>\n",
    "created_at": "2021-10-06T07:51:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32642#issuecomment-526326",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7b33047a8b777f6b22772405040224fefe2017b5"><code>7b33047</code></a></td><td><code>enumeration of linear intervals in posets</code></td></tr></table>




---

archive/issue_comments_526327.json:
```json
{
    "body": "Branch: **[u/chapoton/32642](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/32642)**",
    "created_at": "2021-10-06T07:51:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32642#issuecomment-526327",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/32642](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/32642)**



---

archive/issue_comments_526328.json:
```json
{
    "body": "Commit: **[`7b33047`](https://github.com/sagemath/sagetrac-mirror/commit/7b33047a8b777f6b22772405040224fefe2017b5)**",
    "created_at": "2021-10-06T07:51:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32642#issuecomment-526328",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`7b33047`](https://github.com/sagemath/sagetrac-mirror/commit/7b33047a8b777f6b22772405040224fefe2017b5)**



---

archive/issue_events_446438.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-10-06T07:51:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32642#event-446438"
}
```



---

archive/issue_comments_526329.json:
```json
{
    "body": "Changed commit from **[`7b33047`](https://github.com/sagemath/sagetrac-mirror/commit/7b33047a8b777f6b22772405040224fefe2017b5)** to **[`5a9ca1e`](https://github.com/sagemath/sagetrac-mirror/commit/5a9ca1efca281c47c4345b2007147cb6cd6f93fc)**",
    "created_at": "2021-10-06T07:53:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32642#issuecomment-526329",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7b33047`](https://github.com/sagemath/sagetrac-mirror/commit/7b33047a8b777f6b22772405040224fefe2017b5)** to **[`5a9ca1e`](https://github.com/sagemath/sagetrac-mirror/commit/5a9ca1efca281c47c4345b2007147cb6cd6f93fc)**



---

archive/issue_comments_526330.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5a9ca1efca281c47c4345b2007147cb6cd6f93fc\"><code>5a9ca1e</code></a></td><td><code>enumeration of linear intervals in posets</code></td></tr></table>\n",
    "created_at": "2021-10-06T07:53:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32642#issuecomment-526330",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5a9ca1efca281c47c4345b2007147cb6cd6f93fc"><code>5a9ca1e</code></a></td><td><code>enumeration of linear intervals in posets</code></td></tr></table>




---

archive/issue_comments_526331.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\ngreen bot. Slightly interesting ticket, maybe, for once.",
    "created_at": "2021-10-06T11:52:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32642#issuecomment-526331",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:3" align="right">comment:3</div>

green bot. Slightly interesting ticket, maybe, for once.



---

archive/issue_comments_526332.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nIt seems like you are implementing a na\u00efve version of `all_paths_iterator()` for `is_linear_interval`. I would probably implement it as\n\n```python\ndef is_linear_interval(self, t_min, t_max):\n    # We have the leq matrix, so checking comparisons is fast\n    if self.is_lequal == self._alternate_is_lequal:\n        if not self.is_lequal(t_min, t_max):  # very quick check\n            return False\n        t = t_max\n        while t != t_min:\n            found = False\n            for u in self.neighbor_in_iterator(t):\n                if self.is_lequal(t_min, u):\n                    if not found:\n                        found = True\n                        t = u\n                    else:\n                        return False\n        return True\n    it = self.all_paths_iterator(t_min, t_max)\n    try:\n        next(it)\n    except StopIteration:  # not comparable\n        return False\n    try:\n        next(it)\n    except StopIteration:  # one path\n        return True\n    return False\n```\nI suspect the na\u00efve version you have is faster when the comparisons are fast, but not when we have to check for paths in the Hasse diagram digraph (the default/generic `is_lequal`).",
    "created_at": "2021-10-06T22:57:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32642#issuecomment-526332",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:4" align="right">comment:4</div>

It seems like you are implementing a naïve version of `all_paths_iterator()` for `is_linear_interval`. I would probably implement it as

```python
def is_linear_interval(self, t_min, t_max):
    # We have the leq matrix, so checking comparisons is fast
    if self.is_lequal == self._alternate_is_lequal:
        if not self.is_lequal(t_min, t_max):  # very quick check
            return False
        t = t_max
        while t != t_min:
            found = False
            for u in self.neighbor_in_iterator(t):
                if self.is_lequal(t_min, u):
                    if not found:
                        found = True
                        t = u
                    else:
                        return False
        return True
    it = self.all_paths_iterator(t_min, t_max)
    try:
        next(it)
    except StopIteration:  # not comparable
        return False
    try:
        next(it)
    except StopIteration:  # one path
        return True
    return False
```
I suspect the naïve version you have is faster when the comparisons are fast, but not when we have to check for paths in the Hasse diagram digraph (the default/generic `is_lequal`).



---

archive/issue_comments_526333.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nAlso, do we want to also expose `is_linear_interval` in the frontend?",
    "created_at": "2021-10-06T22:58:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32642#issuecomment-526333",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:5" align="right">comment:5</div>

Also, do we want to also expose `is_linear_interval` in the frontend?



---

archive/issue_comments_526334.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f4e0d26d4eb193da548044d51badaf349d1860dc\"><code>f4e0d26</code></a></td><td><code>is_linear_interval, in frontend, and another algo in backend</code></td></tr></table>\n",
    "created_at": "2021-10-07T07:45:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32642#issuecomment-526334",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f4e0d26d4eb193da548044d51badaf349d1860dc"><code>f4e0d26</code></a></td><td><code>is_linear_interval, in frontend, and another algo in backend</code></td></tr></table>




---

archive/issue_comments_526335.json:
```json
{
    "body": "Changed commit from **[`5a9ca1e`](https://github.com/sagemath/sagetrac-mirror/commit/5a9ca1efca281c47c4345b2007147cb6cd6f93fc)** to **[`f4e0d26`](https://github.com/sagemath/sagetrac-mirror/commit/f4e0d26d4eb193da548044d51badaf349d1860dc)**",
    "created_at": "2021-10-07T07:45:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32642#issuecomment-526335",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5a9ca1e`](https://github.com/sagemath/sagetrac-mirror/commit/5a9ca1efca281c47c4345b2007147cb6cd6f93fc)** to **[`f4e0d26`](https://github.com/sagemath/sagetrac-mirror/commit/f4e0d26d4eb193da548044d51badaf349d1860dc)**



---

archive/issue_comments_526336.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThanks for the suggestions.\n\nI have used the presence of `_leq_storage` as the check for fast comparison, as this is what is used by `_alternate_is_lequal`. Maybe at some point one should always compute this data when creating a poset ?",
    "created_at": "2021-10-07T07:48:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32642#issuecomment-526336",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:7" align="right">comment:7</div>

Thanks for the suggestions.

I have used the presence of `_leq_storage` as the check for fast comparison, as this is what is used by `_alternate_is_lequal`. Maybe at some point one should always compute this data when creating a poset ?



---

archive/issue_comments_526337.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThank you. LGTM.",
    "created_at": "2021-10-07T23:00:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32642#issuecomment-526337",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:8" align="right">comment:8</div>

Thank you. LGTM.



---

archive/issue_events_446439.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-10-07T23:00:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32642#event-446439"
}
```



---

archive/issue_events_446440.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-10-07T23:00:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32642#event-446440"
}
```



---

archive/issue_comments_526338.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2021-10-07T23:00:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32642#issuecomment-526338",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_events_446441.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-19T20:31:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32642#event-446441"
}
```



---

archive/issue_events_446442.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "16097f3904b41cb0855133ca16f5f71cc21fcdb5",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-10-19T20:31:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32642#event-446442"
}
```



---

archive/issue_comments_526339.json:
```json
{
    "body": "Changed branch from **[u/chapoton/32642](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/32642)** to **[`f4e0d26`](https://github.com/sagemath/sagetrac-mirror/commit/f4e0d26d4eb193da548044d51badaf349d1860dc)**",
    "created_at": "2021-10-19T20:31:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32642#issuecomment-526339",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/32642](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/32642)** to **[`f4e0d26`](https://github.com/sagemath/sagetrac-mirror/commit/f4e0d26d4eb193da548044d51badaf349d1860dc)**
