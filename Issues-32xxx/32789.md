# Issue 32789: Fix spkg-configure.m4 for singular

archive/issues_032552.json:
```json
{
    "assignees": [],
    "body": "Follow-up from #29024. This time with testing on more than 1 platform.\n\nOn Debian 11 (a.k.a. bullseye, stable) Singular's libs have different names, and are failing to be picked up: they all are installed in `/usr/lib/x86_64-linux-gnu/` and we have the following: I add Sage's names next to their\n\n```\nDebian                             Sage\n\nlibsingular-factory.so             libfactory.so\nlibsingular-gfan.so                ???\nlibsingular-omalloc.so             libomalloc.so\nlibsingular-polys.so               libpolys.so\nlibsingular-resources.so           libsingular_resources.so\nlibsingular-Singular.so            libSingular.so            \n```\n\nWhile it's not hard to test for `libsingular-Singular.so` in place of `libSingular.so`, it's some more work to use it.\n\nLibrary names may be obtained from `$ pkg-config --libs-only-l singular`, which on Debian produces\n\n```\n-lsingular-Singular -ldl -lsingular-polys -lntl -lgmp -ldl -lsingular-factory -lntl -lgmp -lsingular-omalloc -lsingular-resources\n```\n\n\n\n**CC:**  @dimpase @kiwifb @slel @isuruf @orlitzky @tobiasdiez @tobihan\n\n**Branch/Commit:** [c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2](https://github.com/sagemath/sagetrac-mirror/commit/c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2)\n\n**Upstream:** Reported upstream. No feedback yet.\n\n**Reviewer:** Matthias Koeppe\n\n**Author:** Dima Pasechnik\n\nIssue created by migration from https://trac.sagemath.org/ticket/32789\n\n",
    "closed_at": "2022-02-20T13:27:51Z",
    "created_at": "2021-10-29T02:38:28Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20build%3A%20configure",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Fix spkg-configure.m4 for singular",
    "type": "issue",
    "updated_at": "2022-02-20T13:27:51Z",
    "url": "https://github.com/sagemath/sage/issues/32789",
    "user": "https://github.com/mkoeppe"
}
```
Follow-up from #29024. This time with testing on more than 1 platform.

On Debian 11 (a.k.a. bullseye, stable) Singular's libs have different names, and are failing to be picked up: they all are installed in `/usr/lib/x86_64-linux-gnu/` and we have the following: I add Sage's names next to their

```
Debian                             Sage

libsingular-factory.so             libfactory.so
libsingular-gfan.so                ???
libsingular-omalloc.so             libomalloc.so
libsingular-polys.so               libpolys.so
libsingular-resources.so           libsingular_resources.so
libsingular-Singular.so            libSingular.so            
```

While it's not hard to test for `libsingular-Singular.so` in place of `libSingular.so`, it's some more work to use it.

Library names may be obtained from `$ pkg-config --libs-only-l singular`, which on Debian produces

```
-lsingular-Singular -ldl -lsingular-polys -lntl -lgmp -ldl -lsingular-factory -lntl -lgmp -lsingular-omalloc -lsingular-resources
```



**CC:**  @dimpase @kiwifb @slel @isuruf @orlitzky @tobiasdiez @tobihan

**Branch/Commit:** [c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2](https://github.com/sagemath/sagetrac-mirror/commit/c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2)

**Upstream:** Reported upstream. No feedback yet.

**Reviewer:** Matthias Koeppe

**Author:** Dima Pasechnik

Issue created by migration from https://trac.sagemath.org/ticket/32789





---

archive/issue_comments_532014.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,2 +1,23 @@\n Follow-up from #29024. This time with testing on more than 1 platform.\n \n+On Debian 11 (a.k.a. bullseye, stable) Singular's libs have different names, and are failing to be picked up: they all are installed in `/usr/lib/x86_64-linux-gnu/` and we have the following: I add Sage's names next to their\n+\n+```\n+Debian                             Sage\n+\n+libsingular-factory.so             libfactory.so\n+libsingular-gfan.so                ???\n+libsingular-omalloc.so             libomalloc.so\n+libsingular-polys.so               libpolys.so\n+libsingular-resources.so           libsingular_resources.so\n+libsingular-Singular.so            libSingular.so            \n+```\n+\n+While it's not hard to test for `libsingular-Singular.so` in place of `libSingular.so`, it's some more work to use it.\n+\n+Library names may be obtained from `$ pkg-config --libs-only-l singular`, which on Debian produces\n+\n+```\n+-lsingular-Singular -ldl -lsingular-polys -lntl -lgmp -ldl -lsingular-factory -lntl -lgmp -lsingular-omalloc -lsingular-resources\n+```\n+\n``````\n",
    "created_at": "2021-10-29T12:33:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532014",
    "user": "https://github.com/dimpase"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,2 +1,23 @@
 Follow-up from #29024. This time with testing on more than 1 platform.
 
+On Debian 11 (a.k.a. bullseye, stable) Singular's libs have different names, and are failing to be picked up: they all are installed in `/usr/lib/x86_64-linux-gnu/` and we have the following: I add Sage's names next to their
+
+```
+Debian                             Sage
+
+libsingular-factory.so             libfactory.so
+libsingular-gfan.so                ???
+libsingular-omalloc.so             libomalloc.so
+libsingular-polys.so               libpolys.so
+libsingular-resources.so           libsingular_resources.so
+libsingular-Singular.so            libSingular.so            
+```
+
+While it's not hard to test for `libsingular-Singular.so` in place of `libSingular.so`, it's some more work to use it.
+
+Library names may be obtained from `$ pkg-config --libs-only-l singular`, which on Debian produces
+
+```
+-lsingular-Singular -ldl -lsingular-polys -lntl -lgmp -ldl -lsingular-factory -lntl -lgmp -lsingular-omalloc -lsingular-resources
+```
+
``````




---

archive/issue_comments_532015.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -21,3 +21,15 @@\n -lsingular-Singular -ldl -lsingular-polys -lntl -lgmp -ldl -lsingular-factory -lntl -lgmp -lsingular-omalloc -lsingular-resources\n ```\n \n+\n+Also broken on Cygwin, as reported in https://groups.google.com/g/sage-release/c/FXpakLURP_0/m/La20cB4rBgAJ:\n+\n+```\n+  [sagemath_doc_html-none]     File \"sage/libs/singular/singular.pyx\", line 1555, in init sage.libs.singular.singular (build/cythonized/sage/libs/singular/singular.cpp:15622)\n+  [sagemath_doc_html-none]     File \"sage/libs/singular/singular.pyx\", line 1530, in sage.libs.singular.singular.init_libsingular (build/cythonized/sage/libs/singular/singular.cpp:12925)\n+  [sagemath_doc_html-none]   ImportError: cannot load Singular library from /home/s/sage9n/local/bin/libSingular.dll (b'No such file or directory')\n+  [sagemath_doc_html-none]   Error: './sage --docbuild --all-documents' failed\n+```\n+\n+\n+\n``````\n",
    "created_at": "2021-11-28T03:16:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532015",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -21,3 +21,15 @@
 -lsingular-Singular -ldl -lsingular-polys -lntl -lgmp -ldl -lsingular-factory -lntl -lgmp -lsingular-omalloc -lsingular-resources
 ```
 
+
+Also broken on Cygwin, as reported in https://groups.google.com/g/sage-release/c/FXpakLURP_0/m/La20cB4rBgAJ:
+
+```
+  [sagemath_doc_html-none]     File "sage/libs/singular/singular.pyx", line 1555, in init sage.libs.singular.singular (build/cythonized/sage/libs/singular/singular.cpp:15622)
+  [sagemath_doc_html-none]     File "sage/libs/singular/singular.pyx", line 1530, in sage.libs.singular.singular.init_libsingular (build/cythonized/sage/libs/singular/singular.cpp:12925)
+  [sagemath_doc_html-none]   ImportError: cannot load Singular library from /home/s/sage9n/local/bin/libSingular.dll (b'No such file or directory')
+  [sagemath_doc_html-none]   Error: './sage --docbuild --all-documents' failed
+```
+
+
+
``````




---

archive/issue_events_294223.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-11-28T03:16:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "label": "https://github.com/sagemath/sage/labels/blocker",
    "label_color": "ff0000",
    "label_name": "blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294223"
}
```



---

archive/issue_comments_532016.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -22,7 +22,7 @@\n ```\n \n \n-Also broken on Cygwin, as reported in https://groups.google.com/g/sage-release/c/FXpakLURP_0/m/La20cB4rBgAJ:\n+Also broken on Cygwin (with singular from SPKG, as the cygwin-provided Singular is too old and is correctly rejected), as reported in https://groups.google.com/g/sage-release/c/FXpakLURP_0/m/La20cB4rBgAJ:\n \n ```\n   [sagemath_doc_html-none]     File \"sage/libs/singular/singular.pyx\", line 1555, in init sage.libs.singular.singular (build/cythonized/sage/libs/singular/singular.cpp:15622)\n``````\n",
    "created_at": "2021-11-28T03:18:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532016",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -22,7 +22,7 @@
 ```
 
 
-Also broken on Cygwin, as reported in https://groups.google.com/g/sage-release/c/FXpakLURP_0/m/La20cB4rBgAJ:
+Also broken on Cygwin (with singular from SPKG, as the cygwin-provided Singular is too old and is correctly rejected), as reported in https://groups.google.com/g/sage-release/c/FXpakLURP_0/m/La20cB4rBgAJ:
 
 ```
   [sagemath_doc_html-none]     File "sage/libs/singular/singular.pyx", line 1555, in init sage.libs.singular.singular (build/cythonized/sage/libs/singular/singular.cpp:15622)
``````




---

archive/issue_comments_532017.json:
```json
{
    "body": "<a id='comment:4'></a>\nWe already tried to fix the path to libSingular on cygwin once. Where does it really live?",
    "created_at": "2021-11-28T13:15:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532017",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:4'></a>
We already tried to fix the path to libSingular on cygwin once. Where does it really live?



---

archive/issue_comments_532018.json:
```json
{
    "body": "<a id='comment:5'></a>\nWe have a GH Actions workflow for Cygwin that allows you to download logs and the installation in `SAGE_LOCAL` for inspection, see for example https://github.com/sagemath/sage/actions/runs/1478855916",
    "created_at": "2021-11-28T19:36:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532018",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
We have a GH Actions workflow for Cygwin that allows you to download logs and the installation in `SAGE_LOCAL` for inspection, see for example https://github.com/sagemath/sage/actions/runs/1478855916



---

archive/issue_comments_532019.json:
```json
{
    "body": "<a id='comment:6'></a>\nHappy to run any commands under Cygwin too.",
    "created_at": "2021-11-29T18:59:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532019",
    "user": "https://github.com/slel"
}
```

<a id='comment:6'></a>
Happy to run any commands under Cygwin too.



---

archive/issue_comments_532020.json:
```json
{
    "body": "<a id='comment:7'></a>\nFrom https://github.com/mkoeppe/sage/suites/4487559073/artifacts/119913634:\nThe following DLLs are installed in `SAGE_LOCAL/bin`:\n\n```\ncygfactory-4-2-1.dll\ncygomalloc-0-9-6.dll\ncygpolys-4-2-1.dll\ncygsingular_resources-4-2-1.dll\ncygSingular-4-2-1.dll\n```",
    "created_at": "2021-11-29T19:53:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532020",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
From https://github.com/mkoeppe/sage/suites/4487559073/artifacts/119913634:
The following DLLs are installed in `SAGE_LOCAL/bin`:

```
cygfactory-4-2-1.dll
cygomalloc-0-9-6.dll
cygpolys-4-2-1.dll
cygsingular_resources-4-2-1.dll
cygSingular-4-2-1.dll
```



---

archive/issue_comments_532021.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [@mkoeppe](#comment%3A7):\n> \n> ```\n> cygSingular-4-2-1.dll\n> ```\n\nIs there a symlink from `cygSingular.dll` to that file?",
    "created_at": "2021-11-29T20:03:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532021",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:8'></a>
Replying to [@mkoeppe](#comment%3A7):
> 
> ```
> cygSingular-4-2-1.dll
> ```

Is there a symlink from `cygSingular.dll` to that file?



---

archive/issue_comments_532022.json:
```json
{
    "body": "<a id='comment:9'></a>\nNo",
    "created_at": "2021-11-29T20:05:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532022",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>
No



---

archive/issue_comments_532023.json:
```json
{
    "body": "<a id='comment:10'></a>\nThere is also a file `SAGE_LOCAL/lib/libSingular.dll.a`, which is used by the linker, and probably contains the information about the name of the actual DLL somehow.",
    "created_at": "2021-11-29T20:08:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532023",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>
There is also a file `SAGE_LOCAL/lib/libSingular.dll.a`, which is used by the linker, and probably contains the information about the name of the actual DLL somehow.



---

archive/issue_comments_532024.json:
```json
{
    "body": "<a id='comment:11'></a>\nApparently https://sourceware.org/binutils/docs/binutils/dlltool.html can be used for reading this info.\n\n@slel, could you run `dlltool --identify local/lib/libSingular.dll.a` please?",
    "created_at": "2021-11-29T20:16:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532024",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
Apparently https://sourceware.org/binutils/docs/binutils/dlltool.html can be used for reading this info.

@slel, could you run `dlltool --identify local/lib/libSingular.dll.a` please?



---

archive/issue_comments_532025.json:
```json
{
    "body": "<a id='comment:12'></a>\nThe SPKG won't be installed yet, so we can't read `local/lib/libSingular.dll.a` to obtain the necessary path during `./configure.` For the SPKG, we could hard-code the value as a last resort. Their library versioning scheme also corresponds to `package-version.txt`, but I doubt that's reliable.\n\nDetecting the system copy should be relatively easy in comparison. Unless there's a way to install multiple copies into the system libdir, we can use `find` to pick out what is hopefully the only copy of `cygSingular*.dll` during `./configure`.",
    "created_at": "2021-11-29T20:45:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532025",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:12'></a>
The SPKG won't be installed yet, so we can't read `local/lib/libSingular.dll.a` to obtain the necessary path during `./configure.` For the SPKG, we could hard-code the value as a last resort. Their library versioning scheme also corresponds to `package-version.txt`, but I doubt that's reliable.

Detecting the system copy should be relatively easy in comparison. Unless there's a way to install multiple copies into the system libdir, we can use `find` to pick out what is hopefully the only copy of `cygSingular*.dll` during `./configure`.



---

archive/issue_comments_532026.json:
```json
{
    "body": "<a id='comment:13'></a>\nIt would probably be a good idea to first test whether this whole symbol visibility issue is even a thing on Cygwin.",
    "created_at": "2021-11-29T20:52:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532026",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>
It would probably be a good idea to first test whether this whole symbol visibility issue is even a thing on Cygwin.



---

archive/issue_comments_532027.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/fix_spkg_configure_m4_for_singular](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/fix_spkg_configure_m4_for_singular)",
    "created_at": "2021-11-29T21:04:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532027",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/fix_spkg_configure_m4_for_singular](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/fix_spkg_configure_m4_for_singular)



---

archive/issue_comments_532028.json:
```json
{
    "body": "**Dependencies:** #32944, #32945",
    "created_at": "2021-11-29T21:06:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532028",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #32944, #32945



---

archive/issue_comments_532029.json:
```json
{
    "body": "<a id='comment:15'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/47a6598471e55e4084a211a088ff0d9150a6f558\">47a6598</a></td><td><code>src/sage/libs/singular/singular.pyx: On Cygwin, do not try to make singular library symbols global</code></td></tr></table>\n",
    "created_at": "2021-11-29T21:06:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532029",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/47a6598471e55e4084a211a088ff0d9150a6f558">47a6598</a></td><td><code>src/sage/libs/singular/singular.pyx: On Cygwin, do not try to make singular library symbols global</code></td></tr></table>




---

archive/issue_comments_532030.json:
```json
{
    "body": "**Commit:** [47a6598471e55e4084a211a088ff0d9150a6f558](https://github.com/sagemath/sagetrac-mirror/commit/47a6598471e55e4084a211a088ff0d9150a6f558)",
    "created_at": "2021-11-29T21:06:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532030",
    "user": "https://github.com/mkoeppe"
}
```

**Commit:** [47a6598471e55e4084a211a088ff0d9150a6f558](https://github.com/sagemath/sagetrac-mirror/commit/47a6598471e55e4084a211a088ff0d9150a6f558)



---

archive/issue_comments_532031.json:
```json
{
    "body": "**Changing commit** from \"[47a6598471e55e4084a211a088ff0d9150a6f558](https://github.com/sagemath/sagetrac-mirror/commit/47a6598471e55e4084a211a088ff0d9150a6f558)\" to \"[d14d0af891584e93c478fe71a91ef26f17a08962](https://github.com/sagemath/sagetrac-mirror/commit/d14d0af891584e93c478fe71a91ef26f17a08962)\".",
    "created_at": "2021-11-29T21:06:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532031",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[47a6598471e55e4084a211a088ff0d9150a6f558](https://github.com/sagemath/sagetrac-mirror/commit/47a6598471e55e4084a211a088ff0d9150a6f558)" to "[d14d0af891584e93c478fe71a91ef26f17a08962](https://github.com/sagemath/sagetrac-mirror/commit/d14d0af891584e93c478fe71a91ef26f17a08962)".



---

archive/issue_comments_532032.json:
```json
{
    "body": "<a id='comment:16'></a>\n**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fbb8228e04a410aac7990db34e57fb29fa2103d0\">fbb8228</a></td><td><code>build/bin/sage-build-env: Do not use SETUPTOOLS_USE_DISTUTILS=local on platforms other than homebrew</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d5481d684f43293af9521d1fd51c6e5e2ec4f415\">d5481d6</a></td><td><code>Merge #32944</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/28e4fc6526ee0543cb94ac7481a68cd998281d8b\">28e4fc6</a></td><td><code>build/pkgs/pip/patches: Add upstream PR 10574</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1b6ac2c509583c32bd006353f14203037bf95618\">1b6ac2c</a></td><td><code>build/pkgs/pip/patches/10574.patch: Backport to 21.3.1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3a6fc38811ff3480724d27fc18f890a409592e8\">d3a6fc3</a></td><td><code>build/pkgs/pip: Update to 21.3.1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5b001a2f65b0c052081333f928e729ddfedf0b81\">5b001a2</a></td><td><code>build/bin/sage-dist-helpers: Remove '--use-feature=in-tree-build' (default since pip 21.3)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f1f475998ce77ab6dbaa9d5bd6b683fa7ebfd60e\">f1f4759</a></td><td><code>build/pkgs/distlib: Update to 0.3.3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/760ff0952d4f461e5f3b67ee8c5aceacc287f23e\">760ff09</a></td><td><code>Merge #32751</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f8400f719f46f046cd12a781d6dc16f43e92a100\">f8400f7</a></td><td><code>Merge #32671</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d14d0af891584e93c478fe71a91ef26f17a08962\">d14d0af</a></td><td><code>Merge #32945</code></td></tr></table>\n",
    "created_at": "2021-11-29T21:06:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532032",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:16'></a>
**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fbb8228e04a410aac7990db34e57fb29fa2103d0">fbb8228</a></td><td><code>build/bin/sage-build-env: Do not use SETUPTOOLS_USE_DISTUTILS=local on platforms other than homebrew</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d5481d684f43293af9521d1fd51c6e5e2ec4f415">d5481d6</a></td><td><code>Merge #32944</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/28e4fc6526ee0543cb94ac7481a68cd998281d8b">28e4fc6</a></td><td><code>build/pkgs/pip/patches: Add upstream PR 10574</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1b6ac2c509583c32bd006353f14203037bf95618">1b6ac2c</a></td><td><code>build/pkgs/pip/patches/10574.patch: Backport to 21.3.1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3a6fc38811ff3480724d27fc18f890a409592e8">d3a6fc3</a></td><td><code>build/pkgs/pip: Update to 21.3.1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5b001a2f65b0c052081333f928e729ddfedf0b81">5b001a2</a></td><td><code>build/bin/sage-dist-helpers: Remove '--use-feature=in-tree-build' (default since pip 21.3)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f1f475998ce77ab6dbaa9d5bd6b683fa7ebfd60e">f1f4759</a></td><td><code>build/pkgs/distlib: Update to 0.3.3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/760ff0952d4f461e5f3b67ee8c5aceacc287f23e">760ff09</a></td><td><code>Merge #32751</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f8400f719f46f046cd12a781d6dc16f43e92a100">f8400f7</a></td><td><code>Merge #32671</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d14d0af891584e93c478fe71a91ef26f17a08962">d14d0af</a></td><td><code>Merge #32945</code></td></tr></table>




---

archive/issue_comments_532033.json:
```json
{
    "body": "**Changing commit** from \"[d14d0af891584e93c478fe71a91ef26f17a08962](https://github.com/sagemath/sagetrac-mirror/commit/d14d0af891584e93c478fe71a91ef26f17a08962)\" to \"[377df3553e8be697de6210497d10f39d16bfd7e0](https://github.com/sagemath/sagetrac-mirror/commit/377df3553e8be697de6210497d10f39d16bfd7e0)\".",
    "created_at": "2021-11-29T21:07:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532033",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[d14d0af891584e93c478fe71a91ef26f17a08962](https://github.com/sagemath/sagetrac-mirror/commit/d14d0af891584e93c478fe71a91ef26f17a08962)" to "[377df3553e8be697de6210497d10f39d16bfd7e0](https://github.com/sagemath/sagetrac-mirror/commit/377df3553e8be697de6210497d10f39d16bfd7e0)".



---

archive/issue_comments_532034.json:
```json
{
    "body": "<a id='comment:17'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/377df3553e8be697de6210497d10f39d16bfd7e0\">377df35</a></td><td><code>src/sage/libs/singular/singular.pyx: Fixup</code></td></tr></table>\n",
    "created_at": "2021-11-29T21:07:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532034",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:17'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/377df3553e8be697de6210497d10f39d16bfd7e0">377df35</a></td><td><code>src/sage/libs/singular/singular.pyx: Fixup</code></td></tr></table>




---

archive/issue_comments_532035.json:
```json
{
    "body": "<a id='comment:18'></a>\nI've put this on top of other Cygwin fixes for convenience of testing",
    "created_at": "2021-11-29T21:08:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532035",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>
I've put this on top of other Cygwin fixes for convenience of testing



---

archive/issue_comments_532036.json:
```json
{
    "body": "**Reviewer:** https://github.com/sagemath/sagetrac-mirror/actions/runs/1517921823",
    "created_at": "2021-11-29T21:11:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532036",
    "user": "https://github.com/mkoeppe"
}
```

**Reviewer:** https://github.com/sagemath/sagetrac-mirror/actions/runs/1517921823



---

archive/issue_comments_532037.json:
```json
{
    "body": "<a id='comment:20'></a>\nHm, the test with `CYGWIN_VERSION` does not seem to have worked\nhttps://github.com/sagemath/sagetrac-mirror/runs/4371131888?check_suite_focus=true",
    "created_at": "2021-11-30T21:18:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532037",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>
Hm, the test with `CYGWIN_VERSION` does not seem to have worked
https://github.com/sagemath/sagetrac-mirror/runs/4371131888?check_suite_focus=true



---

archive/issue_comments_532038.json:
```json
{
    "body": "<a id='comment:21'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/33d7d120081feb5a0e199ec46c1003cf4a079824\">33d7d12</a></td><td><code>src/sage/libs/singular/singular.pyx: Use platform.system instead of sage.env.CYGWIN_VERSION</code></td></tr></table>\n",
    "created_at": "2021-11-30T21:55:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532038",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:21'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/33d7d120081feb5a0e199ec46c1003cf4a079824">33d7d12</a></td><td><code>src/sage/libs/singular/singular.pyx: Use platform.system instead of sage.env.CYGWIN_VERSION</code></td></tr></table>




---

archive/issue_comments_532039.json:
```json
{
    "body": "**Changing commit** from \"[377df3553e8be697de6210497d10f39d16bfd7e0](https://github.com/sagemath/sagetrac-mirror/commit/377df3553e8be697de6210497d10f39d16bfd7e0)\" to \"[33d7d120081feb5a0e199ec46c1003cf4a079824](https://github.com/sagemath/sagetrac-mirror/commit/33d7d120081feb5a0e199ec46c1003cf4a079824)\".",
    "created_at": "2021-11-30T21:55:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532039",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[377df3553e8be697de6210497d10f39d16bfd7e0](https://github.com/sagemath/sagetrac-mirror/commit/377df3553e8be697de6210497d10f39d16bfd7e0)" to "[33d7d120081feb5a0e199ec46c1003cf4a079824](https://github.com/sagemath/sagetrac-mirror/commit/33d7d120081feb5a0e199ec46c1003cf4a079824)".



---

archive/issue_comments_532040.json:
```json
{
    "body": "**Changing reviewer** from \"https://github.com/sagemath/sagetrac-mirror/actions/runs/1517921823\" to \"https://github.com/sagemath/sagetrac-mirror/actions/runs/1523079928\".",
    "created_at": "2021-11-30T21:57:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532040",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "https://github.com/sagemath/sagetrac-mirror/actions/runs/1517921823" to "https://github.com/sagemath/sagetrac-mirror/actions/runs/1523079928".



---

archive/issue_comments_532041.json:
```json
{
    "body": "<a id='comment:23'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3d4f91b09d4f1e7b998fe9fb056657ac6e7cbdb9\">3d4f91b</a></td><td><code>src/sage/env.py: Remove unused/defunct variable CYGWIN_VERSION</code></td></tr></table>\n",
    "created_at": "2021-11-30T22:01:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532041",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:23'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3d4f91b09d4f1e7b998fe9fb056657ac6e7cbdb9">3d4f91b</a></td><td><code>src/sage/env.py: Remove unused/defunct variable CYGWIN_VERSION</code></td></tr></table>




---

archive/issue_comments_532042.json:
```json
{
    "body": "**Changing commit** from \"[33d7d120081feb5a0e199ec46c1003cf4a079824](https://github.com/sagemath/sagetrac-mirror/commit/33d7d120081feb5a0e199ec46c1003cf4a079824)\" to \"[3d4f91b09d4f1e7b998fe9fb056657ac6e7cbdb9](https://github.com/sagemath/sagetrac-mirror/commit/3d4f91b09d4f1e7b998fe9fb056657ac6e7cbdb9)\".",
    "created_at": "2021-11-30T22:01:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532042",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[33d7d120081feb5a0e199ec46c1003cf4a079824](https://github.com/sagemath/sagetrac-mirror/commit/33d7d120081feb5a0e199ec46c1003cf4a079824)" to "[3d4f91b09d4f1e7b998fe9fb056657ac6e7cbdb9](https://github.com/sagemath/sagetrac-mirror/commit/3d4f91b09d4f1e7b998fe9fb056657ac6e7cbdb9)".



---

archive/issue_comments_532043.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/fix_spkg_configure_m4_for_singular](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/fix_spkg_configure_m4_for_singular)\" to \"\".",
    "created_at": "2021-12-01T17:50:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532043",
    "user": "https://github.com/mkoeppe"
}
```

**Changing branch** from "[u/mkoeppe/fix_spkg_configure_m4_for_singular](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/fix_spkg_configure_m4_for_singular)" to "".



---

archive/issue_comments_532044.json:
```json
{
    "body": "**Changing commit** from \"[3d4f91b09d4f1e7b998fe9fb056657ac6e7cbdb9](https://github.com/sagemath/sagetrac-mirror/commit/3d4f91b09d4f1e7b998fe9fb056657ac6e7cbdb9)\" to \"\".",
    "created_at": "2021-12-01T17:50:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532044",
    "user": "https://github.com/mkoeppe"
}
```

**Changing commit** from "[3d4f91b09d4f1e7b998fe9fb056657ac6e7cbdb9](https://github.com/sagemath/sagetrac-mirror/commit/3d4f91b09d4f1e7b998fe9fb056657ac6e7cbdb9)" to "".



---

archive/issue_comments_532045.json:
```json
{
    "body": "**Changing reviewer** from \"https://github.com/sagemath/sagetrac-mirror/actions/runs/1523079928\" to \"\".",
    "created_at": "2021-12-01T17:50:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532045",
    "user": "https://github.com/mkoeppe"
}
```

**Changing reviewer** from "https://github.com/sagemath/sagetrac-mirror/actions/runs/1523079928" to "".



---

archive/issue_comments_532046.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -22,14 +22,3 @@\n ```\n \n \n-Also broken on Cygwin (with singular from SPKG, as the cygwin-provided Singular is too old and is correctly rejected), as reported in https://groups.google.com/g/sage-release/c/FXpakLURP_0/m/La20cB4rBgAJ:\n-\n-```\n-  [sagemath_doc_html-none]     File \"sage/libs/singular/singular.pyx\", line 1555, in init sage.libs.singular.singular (build/cythonized/sage/libs/singular/singular.cpp:15622)\n-  [sagemath_doc_html-none]     File \"sage/libs/singular/singular.pyx\", line 1530, in sage.libs.singular.singular.init_libsingular (build/cythonized/sage/libs/singular/singular.cpp:12925)\n-  [sagemath_doc_html-none]   ImportError: cannot load Singular library from /home/s/sage9n/local/bin/libSingular.dll (b'No such file or directory')\n-  [sagemath_doc_html-none]   Error: './sage --docbuild --all-documents' failed\n-```\n-\n-\n-\n``````\n",
    "created_at": "2021-12-01T17:50:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532046",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -22,14 +22,3 @@
 ```
 
 
-Also broken on Cygwin (with singular from SPKG, as the cygwin-provided Singular is too old and is correctly rejected), as reported in https://groups.google.com/g/sage-release/c/FXpakLURP_0/m/La20cB4rBgAJ:
-
-```
-  [sagemath_doc_html-none]     File "sage/libs/singular/singular.pyx", line 1555, in init sage.libs.singular.singular (build/cythonized/sage/libs/singular/singular.cpp:15622)
-  [sagemath_doc_html-none]     File "sage/libs/singular/singular.pyx", line 1530, in sage.libs.singular.singular.init_libsingular (build/cythonized/sage/libs/singular/singular.cpp:12925)
-  [sagemath_doc_html-none]   ImportError: cannot load Singular library from /home/s/sage9n/local/bin/libSingular.dll (b'No such file or directory')
-  [sagemath_doc_html-none]   Error: './sage --docbuild --all-documents' failed
-```
-
-
-
``````




---

archive/issue_comments_532047.json:
```json
{
    "body": "**Changing dependencies** from \"#32944, #32945\" to \"\".",
    "created_at": "2021-12-01T17:50:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532047",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#32944, #32945" to "".



---

archive/issue_events_294224.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-01T17:50:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "label": "https://github.com/sagemath/sage/labels/blocker",
    "label_color": "ff0000",
    "label_name": "blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294224"
}
```



---

archive/issue_events_294225.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-01T17:50:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "label": "https://github.com/sagemath/sage/labels/critical",
    "label_color": "ff0000",
    "label_name": "critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294225"
}
```



---

archive/issue_comments_532048.json:
```json
{
    "body": "<a id='comment:24'></a>\nI've split out the cygwin issue to #32954, ready for review",
    "created_at": "2021-12-01T17:50:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532048",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'></a>
I've split out the cygwin issue to #32954, ready for review



---

archive/issue_comments_532049.json:
```json
{
    "body": "<a id='comment:25'></a>\nCurrently on all `ubuntu` including `-jammy`, singular's dependency `cddlib` is rejected - so there's no urgency here",
    "created_at": "2021-12-23T19:51:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532049",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>
Currently on all `ubuntu` including `-jammy`, singular's dependency `cddlib` is rejected - so there's no urgency here



---

archive/issue_events_294226.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-23T19:51:04Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294226"
}
```



---

archive/issue_events_294227.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-23T19:51:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294227"
}
```



---

archive/issue_events_294228.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-23T19:51:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "label": "https://github.com/sagemath/sage/labels/critical",
    "label_color": "ff0000",
    "label_name": "critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294228"
}
```



---

archive/issue_comments_532050.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [@mkoeppe](#comment%3A25):\n> Currently on all `ubuntu` including `-jammy`, singular's dependency `cddlib` is rejected - so there's no urgency here\n\nI didn't get that. Is there something that needs to be changed in a Debian package?",
    "created_at": "2021-12-24T12:29:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532050",
    "user": "https://github.com/tobihan"
}
```

<a id='comment:26'></a>
Replying to [@mkoeppe](#comment%3A25):
> Currently on all `ubuntu` including `-jammy`, singular's dependency `cddlib` is rejected - so there's no urgency here

I didn't get that. Is there something that needs to be changed in a Debian package?



---

archive/issue_comments_532051.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [@tobihan](#comment%3A26):\n> Replying to [@mkoeppe](#comment%3A25):\n> > Currently on all `ubuntu` including `-jammy`, singular's dependency `cddlib` is rejected - so there's no urgency here\n\n> \n> I didn't get that. Is there something that needs to be changed in a Debian package?\n\nYes, I think Debian's `cddlib` needs upgrading to 0.94m (see https://repology.org/project/cddlib/versions)",
    "created_at": "2021-12-25T19:50:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532051",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>
Replying to [@tobihan](#comment%3A26):
> Replying to [@mkoeppe](#comment%3A25):
> > Currently on all `ubuntu` including `-jammy`, singular's dependency `cddlib` is rejected - so there's no urgency here

> 
> I didn't get that. Is there something that needs to be changed in a Debian package?

Yes, I think Debian's `cddlib` needs upgrading to 0.94m (see https://repology.org/project/cddlib/versions)



---

archive/issue_comments_532052.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [@mkoeppe](#comment%3A27):\n> Yes, I think Debian's `cddlib` needs upgrading to 0.94m (see https://repology.org/project/cddlib/versions)\n\nOk, done.",
    "created_at": "2021-12-29T13:25:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532052",
    "user": "https://github.com/tobihan"
}
```

<a id='comment:28'></a>
Replying to [@mkoeppe](#comment%3A27):
> Yes, I think Debian's `cddlib` needs upgrading to 0.94m (see https://repology.org/project/cddlib/versions)

Ok, done.



---

archive/issue_comments_532053.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [@tobihan](#comment%3A28):\n> Replying to [@mkoeppe](#comment%3A27):\n> > Yes, I think Debian's `cddlib` needs upgrading to 0.94m (see https://repology.org/project/cddlib/versions)\n\n> \n> Ok, done.\n\nGreat. `tox -e docker-ubuntu-jammy-standard -- config.status` now gives:\n\n```\nChecking whether SageMath should install SPKG singular...\nchecking whether any of gmp ntl flint readline mpfr cddlib is installed as or will be installed as SPKG... no\nchecking for Singular... /usr/bin/Singular\nchecking for Singular >= 4.1.1... yes\nchecking if we can dlopen(/usr/lib/x86_64-linux-gnu/libSingular.so)... no\nconfigure: no suitable system package found for SPKG singular\n```\n\nSo it makes sense now to work on the present ticket.",
    "created_at": "2021-12-30T01:26:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532053",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>
Replying to [@tobihan](#comment%3A28):
> Replying to [@mkoeppe](#comment%3A27):
> > Yes, I think Debian's `cddlib` needs upgrading to 0.94m (see https://repology.org/project/cddlib/versions)

> 
> Ok, done.

Great. `tox -e docker-ubuntu-jammy-standard -- config.status` now gives:

```
Checking whether SageMath should install SPKG singular...
checking whether any of gmp ntl flint readline mpfr cddlib is installed as or will be installed as SPKG... no
checking for Singular... /usr/bin/Singular
checking for Singular >= 4.1.1... yes
checking if we can dlopen(/usr/lib/x86_64-linux-gnu/libSingular.so)... no
configure: no suitable system package found for SPKG singular
```

So it makes sense now to work on the present ticket.



---

archive/issue_events_294229.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-01-26T16:35:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "label": "https://github.com/sagemath/sage/labels/critical",
    "label_color": "ff0000",
    "label_name": "critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294229"
}
```



---

archive/issue_comments_532054.json:
```json
{
    "body": "<a id='comment:30'></a>\nChanging to critical in view of #33139.",
    "created_at": "2022-01-26T16:35:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532054",
    "user": "https://github.com/slel"
}
```

<a id='comment:30'></a>
Changing to critical in view of #33139.



---

archive/issue_comments_532055.json:
```json
{
    "body": "<a id='comment:31'></a>\nWhat does this have to do with a docbuild failure?",
    "created_at": "2022-01-26T16:48:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532055",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:31'></a>
What does this have to do with a docbuild failure?



---

archive/issue_events_294230.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2022-01-26T20:25:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "label": "https://github.com/sagemath/sage/labels/critical",
    "label_color": "ff0000",
    "label_name": "critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294230"
}
```



---

archive/issue_comments_532056.json:
```json
{
    "body": "<a id='comment:32'></a>\nRight, the link with singular was ruled out\nin [#32954 comment:8](https://github.com/sagemath/sage/issues/32954#comment:8).\n\nSorry for the noise.",
    "created_at": "2022-01-26T20:25:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532056",
    "user": "https://github.com/slel"
}
```

<a id='comment:32'></a>
Right, the link with singular was ruled out
in [#32954 comment:8](https://github.com/sagemath/sage/issues/32954#comment:8).

Sorry for the noise.



---

archive/issue_comments_532057.json:
```json
{
    "body": "**Author:** Dima Pasechnik",
    "created_at": "2022-02-11T12:58:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532057",
    "user": "https://github.com/dimpase"
}
```

**Author:** Dima Pasechnik



---

archive/issue_comments_532058.json:
```json
{
    "body": "<a id='comment:33'></a>\nstill testing. the library on Debian is recognised, at least.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c94e0c5631add37043e97a4dea9e0b4362b92556\">c94e0c5</a></td><td><code>added test for libsingular-Singular</code></td></tr></table>\n",
    "created_at": "2022-02-11T12:58:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532058",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:33'></a>
still testing. the library on Debian is recognised, at least.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c94e0c5631add37043e97a4dea9e0b4362b92556">c94e0c5</a></td><td><code>added test for libsingular-Singular</code></td></tr></table>




---

archive/issue_comments_532059.json:
```json
{
    "body": "**Branch:** [u/dimpase/packages/singular/libpath_fix](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/singular/libpath_fix)",
    "created_at": "2022-02-11T12:58:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532059",
    "user": "https://github.com/dimpase"
}
```

**Branch:** [u/dimpase/packages/singular/libpath_fix](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/singular/libpath_fix)



---

archive/issue_comments_532060.json:
```json
{
    "body": "**Commit:** [c94e0c5631add37043e97a4dea9e0b4362b92556](https://github.com/sagemath/sagetrac-mirror/commit/c94e0c5631add37043e97a4dea9e0b4362b92556)",
    "created_at": "2022-02-11T12:58:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532060",
    "user": "https://github.com/dimpase"
}
```

**Commit:** [c94e0c5631add37043e97a4dea9e0b4362b92556](https://github.com/sagemath/sagetrac-mirror/commit/c94e0c5631add37043e97a4dea9e0b4362b92556)



---

archive/issue_comments_532061.json:
```json
{
    "body": "**Changing commit** from \"[c94e0c5631add37043e97a4dea9e0b4362b92556](https://github.com/sagemath/sagetrac-mirror/commit/c94e0c5631add37043e97a4dea9e0b4362b92556)\" to \"[de1640511311c3a455587701c49ecd550f0949c5](https://github.com/sagemath/sagetrac-mirror/commit/de1640511311c3a455587701c49ecd550f0949c5)\".",
    "created_at": "2022-02-11T17:11:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532061",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[c94e0c5631add37043e97a4dea9e0b4362b92556](https://github.com/sagemath/sagetrac-mirror/commit/c94e0c5631add37043e97a4dea9e0b4362b92556)" to "[de1640511311c3a455587701c49ecd550f0949c5](https://github.com/sagemath/sagetrac-mirror/commit/de1640511311c3a455587701c49ecd550f0949c5)".



---

archive/issue_comments_532062.json:
```json
{
    "body": "<a id='comment:34'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/de1640511311c3a455587701c49ecd550f0949c5\">de16405</a></td><td><code>bump the minimal version to get polylib.lib</code></td></tr></table>\n",
    "created_at": "2022-02-11T17:11:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532062",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:34'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/de1640511311c3a455587701c49ecd550f0949c5">de16405</a></td><td><code>bump the minimal version to get polylib.lib</code></td></tr></table>




---

archive/issue_events_294231.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-02-11T17:21:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294231"
}
```



---

archive/issue_comments_532063.json:
```json
{
    "body": "<a id='comment:35'></a>\nNeeds review. I suppose allowing Singular 4.1.1 was to be bumped up, as 4.1.1 doesn't actually have `polylib.lib` (it's called `poly.lib` there, but it's anyway too old, I think).",
    "created_at": "2022-02-11T17:21:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532063",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:35'></a>
Needs review. I suppose allowing Singular 4.1.1 was to be bumped up, as 4.1.1 doesn't actually have `polylib.lib` (it's called `poly.lib` there, but it's anyway too old, I think).



---

archive/issue_comments_532064.json:
```json
{
    "body": "<a id='comment:36'></a>\nI actually checked that the branch allows using system Singular 4.1.1 on Debian 11, but then the result has test failures due to that `polylib.lib` absense.",
    "created_at": "2022-02-11T18:35:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532064",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:36'></a>
I actually checked that the branch allows using system Singular 4.1.1 on Debian 11, but then the result has test failures due to that `polylib.lib` absense.



---

archive/issue_comments_532065.json:
```json
{
    "body": "<a id='comment:37'></a>\nOK, this still correctly rejects singular on all ubuntu releases earlier than `jammy`.",
    "created_at": "2022-02-11T19:56:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532065",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:37'></a>
OK, this still correctly rejects singular on all ubuntu releases earlier than `jammy`.



---

archive/issue_comments_532066.json:
```json
{
    "body": "<a id='comment:38'></a>\nWith `TARGETS_PRE=build-local tox -e docker-ubuntu-jammy-standard -- build ptest` I see the following failures:\n\n```\nsage -t --random-seed=75077202530737540355693167266645487963 src/sage/interfaces/singular.py\n**********************************************************************\nFile \"src/sage/interfaces/singular.py\", line 2243, in sage.interfaces.singular.SingularFunction._instancedoc_\nFailed example:\n    'groebner' in singular.groebner.__doc__\nException raised:\n    Traceback (most recent call last):\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.interfaces.singular.SingularFunction._instancedoc_[0]>\", line 1, in <module>\n        'groebner' in singular.groebner.__doc__\n      File \"sage/docs/instancedoc.pyx\", line 211, in sage.docs.instancedoc.InstanceDocDescriptor.__get__ (build/cythonized/sage/docs/instancedoc.c:1878)\n        return self.instancedoc(obj)\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py\", line 2247, in _instancedoc_\n        generate_docstring_dictionary()\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py\", line 2337, in generate_docstring_dictionary\n        with io.open(singular_info_file,\n    TypeError: expected str, bytes or os.PathLike object, not NoneType\n**********************************************************************\nFile \"src/sage/interfaces/singular.py\", line 2283, in sage.interfaces.singular.SingularFunctionElement._instancedoc_\nFailed example:\n    'matrix_expression' in A.nrows.__doc__\nException raised:\n    Traceback (most recent call last):\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.interfaces.singular.SingularFunctionElement._instancedoc_[2]>\", line 1, in <module>\n        'matrix_expression' in A.nrows.__doc__\n      File \"sage/docs/instancedoc.pyx\", line 211, in sage.docs.instancedoc.InstanceDocDescriptor.__get__ (build/cythonized/sage/docs/instancedoc.c:1878)\n        return self.instancedoc(obj)\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py\", line 2287, in _instancedoc_\n        generate_docstring_dictionary()\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py\", line 2337, in generate_docstring_dictionary\n        with io.open(singular_info_file,\n    TypeError: expected str, bytes or os.PathLike object, not NoneType\n**********************************************************************\nFile \"src/sage/interfaces/singular.py\", line 2319, in sage.interfaces.singular.generate_docstring_dictionary\nFailed example:\n    generate_docstring_dictionary()\nException raised:\n    Traceback (most recent call last):\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.interfaces.singular.generate_docstring_dictionary[1]>\", line 1, in <module>\n        generate_docstring_dictionary()\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py\", line 2337, in generate_docstring_dictionary\n        with io.open(singular_info_file,\n    TypeError: expected str, bytes or os.PathLike object, not NoneType\n**********************************************************************\nFile \"src/sage/interfaces/singular.py\", line 2371, in sage.interfaces.singular.get_docstring\nFailed example:\n    'groebner' in get_docstring('groebner')\nException raised:\n    Traceback (most recent call last):\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.interfaces.singular.get_docstring[1]>\", line 1, in <module>\n        'groebner' in get_docstring('groebner')\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py\", line 2378, in get_docstring\n        generate_docstring_dictionary()\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py\", line 2337, in generate_docstring_dictionary\n        with io.open(singular_info_file,\n    TypeError: expected str, bytes or os.PathLike object, not NoneType\n**********************************************************************\nFile \"src/sage/interfaces/singular.py\", line 2373, in sage.interfaces.singular.get_docstring\nFailed example:\n    'standard.lib' in get_docstring('groebner')\nException raised:\n    Traceback (most recent call last):\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.interfaces.singular.get_docstring[2]>\", line 1, in <module>\n        'standard.lib' in get_docstring('groebner')\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py\", line 2378, in get_docstring\n        generate_docstring_dictionary()\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py\", line 2337, in generate_docstring_dictionary\n        with io.open(singular_info_file,\n    TypeError: expected str, bytes or os.PathLike object, not NoneType\n**********************************************************************\n\nsage -t --random-seed=75077202530737540355693167266645487963 src/sage/libs/singular/singular.pyx\n**********************************************************************\nFile \"src/sage/libs/singular/singular.pyx\", line 1583, in sage.libs.singular.singular.get_resource\nFailed example:\n    get_resource('i')            # SINGULAR_INFO_FILE\nExpected:\n    '.../singular...'\nGot:\n    <BLANKLINE>\n**********************************************************************\n```\nand similar",
    "created_at": "2022-02-11T22:24:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532066",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:38'></a>
With `TARGETS_PRE=build-local tox -e docker-ubuntu-jammy-standard -- build ptest` I see the following failures:

```
sage -t --random-seed=75077202530737540355693167266645487963 src/sage/interfaces/singular.py
**********************************************************************
File "src/sage/interfaces/singular.py", line 2243, in sage.interfaces.singular.SingularFunction._instancedoc_
Failed example:
    'groebner' in singular.groebner.__doc__
Exception raised:
    Traceback (most recent call last):
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.singular.SingularFunction._instancedoc_[0]>", line 1, in <module>
        'groebner' in singular.groebner.__doc__
      File "sage/docs/instancedoc.pyx", line 211, in sage.docs.instancedoc.InstanceDocDescriptor.__get__ (build/cythonized/sage/docs/instancedoc.c:1878)
        return self.instancedoc(obj)
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py", line 2247, in _instancedoc_
        generate_docstring_dictionary()
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py", line 2337, in generate_docstring_dictionary
        with io.open(singular_info_file,
    TypeError: expected str, bytes or os.PathLike object, not NoneType
**********************************************************************
File "src/sage/interfaces/singular.py", line 2283, in sage.interfaces.singular.SingularFunctionElement._instancedoc_
Failed example:
    'matrix_expression' in A.nrows.__doc__
Exception raised:
    Traceback (most recent call last):
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.singular.SingularFunctionElement._instancedoc_[2]>", line 1, in <module>
        'matrix_expression' in A.nrows.__doc__
      File "sage/docs/instancedoc.pyx", line 211, in sage.docs.instancedoc.InstanceDocDescriptor.__get__ (build/cythonized/sage/docs/instancedoc.c:1878)
        return self.instancedoc(obj)
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py", line 2287, in _instancedoc_
        generate_docstring_dictionary()
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py", line 2337, in generate_docstring_dictionary
        with io.open(singular_info_file,
    TypeError: expected str, bytes or os.PathLike object, not NoneType
**********************************************************************
File "src/sage/interfaces/singular.py", line 2319, in sage.interfaces.singular.generate_docstring_dictionary
Failed example:
    generate_docstring_dictionary()
Exception raised:
    Traceback (most recent call last):
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.singular.generate_docstring_dictionary[1]>", line 1, in <module>
        generate_docstring_dictionary()
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py", line 2337, in generate_docstring_dictionary
        with io.open(singular_info_file,
    TypeError: expected str, bytes or os.PathLike object, not NoneType
**********************************************************************
File "src/sage/interfaces/singular.py", line 2371, in sage.interfaces.singular.get_docstring
Failed example:
    'groebner' in get_docstring('groebner')
Exception raised:
    Traceback (most recent call last):
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.singular.get_docstring[1]>", line 1, in <module>
        'groebner' in get_docstring('groebner')
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py", line 2378, in get_docstring
        generate_docstring_dictionary()
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py", line 2337, in generate_docstring_dictionary
        with io.open(singular_info_file,
    TypeError: expected str, bytes or os.PathLike object, not NoneType
**********************************************************************
File "src/sage/interfaces/singular.py", line 2373, in sage.interfaces.singular.get_docstring
Failed example:
    'standard.lib' in get_docstring('groebner')
Exception raised:
    Traceback (most recent call last):
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.singular.get_docstring[2]>", line 1, in <module>
        'standard.lib' in get_docstring('groebner')
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py", line 2378, in get_docstring
        generate_docstring_dictionary()
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py", line 2337, in generate_docstring_dictionary
        with io.open(singular_info_file,
    TypeError: expected str, bytes or os.PathLike object, not NoneType
**********************************************************************

sage -t --random-seed=75077202530737540355693167266645487963 src/sage/libs/singular/singular.pyx
**********************************************************************
File "src/sage/libs/singular/singular.pyx", line 1583, in sage.libs.singular.singular.get_resource
Failed example:
    get_resource('i')            # SINGULAR_INFO_FILE
Expected:
    '.../singular...'
Got:
    <BLANKLINE>
**********************************************************************
```
and similar



---

archive/issue_events_294232.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-11T22:24:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294232"
}
```



---

archive/issue_events_294233.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-11T22:24:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294233"
}
```



---

archive/issue_comments_532067.json:
```json
{
    "body": "<a id='comment:39'></a>\nthis appears to be fixed by \n\n```\nexport SINGULAR_INFO_FILE=/usr/share/doc/singular/singular.hlp\n```\nbefore starting Sage. After this, instead of\n\n```\nsage: from sage.libs.singular.singular import get_resource\nsage: get_resource('i')\n// ** Could not get 'InfoFile'.\n// ** Either set environment variable 'SINGULAR_INFO_FILE' to 'InfoFile',\n// ** or make sure that 'InfoFile' is at \"/usr/bin/../share/info/singular.hlp\"\n```\none gets, as it should be:\n\n```\nsage: from sage.libs.singular.singular import get_resource\nsage: get_resource('i')\n'/usr/share/doc/singular/singular.hlp'\n```\nThe latter needs `singular-doc` installed, so it must be added to\n`build/pkgs/singular/distros/debian.txt`.",
    "created_at": "2022-02-12T10:16:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532067",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:39'></a>
this appears to be fixed by 

```
export SINGULAR_INFO_FILE=/usr/share/doc/singular/singular.hlp
```
before starting Sage. After this, instead of

```
sage: from sage.libs.singular.singular import get_resource
sage: get_resource('i')
// ** Could not get 'InfoFile'.
// ** Either set environment variable 'SINGULAR_INFO_FILE' to 'InfoFile',
// ** or make sure that 'InfoFile' is at "/usr/bin/../share/info/singular.hlp"
```
one gets, as it should be:

```
sage: from sage.libs.singular.singular import get_resource
sage: get_resource('i')
'/usr/share/doc/singular/singular.hlp'
```
The latter needs `singular-doc` installed, so it must be added to
`build/pkgs/singular/distros/debian.txt`.



---

archive/issue_comments_532068.json:
```json
{
    "body": "**Upstream:** Reported upstream. No feedback yet.",
    "created_at": "2022-02-12T10:46:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532068",
    "user": "https://github.com/dimpase"
}
```

**Upstream:** Reported upstream. No feedback yet.



---

archive/issue_comments_532069.json:
```json
{
    "body": "<a id='comment:41'></a>\nShould be fixed by\n\n```diff\n--- a/src/sage/libs/singular/singular.pyx\n+++ b/src/sage/libs/singular/singular.pyx\n@@ -1587,5 +1587,8 @@ def get_resource(id):\n     \"\"\"\n     cdef char *result = feGetResource(<char>ord(id))\n     if result == NULL:\n-        return None\n+        os.environ['SINGULAR_INFO_FILE']='/usr/share/doc/singular/singular.hlp'\n+        result = feGetResource(<char>ord(id))\n+        if result == NULL:\n+            return None\n     return bytes_to_str(result)\n```",
    "created_at": "2022-02-12T10:57:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532069",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:41'></a>
Should be fixed by

```diff
--- a/src/sage/libs/singular/singular.pyx
+++ b/src/sage/libs/singular/singular.pyx
@@ -1587,5 +1587,8 @@ def get_resource(id):
     """
     cdef char *result = feGetResource(<char>ord(id))
     if result == NULL:
-        return None
+        os.environ['SINGULAR_INFO_FILE']='/usr/share/doc/singular/singular.hlp'
+        result = feGetResource(<char>ord(id))
+        if result == NULL:
+            return None
     return bytes_to_str(result)
```



---

archive/issue_comments_532070.json:
```json
{
    "body": "**Changing commit** from \"[de1640511311c3a455587701c49ecd550f0949c5](https://github.com/sagemath/sagetrac-mirror/commit/de1640511311c3a455587701c49ecd550f0949c5)\" to \"[cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7](https://github.com/sagemath/sagetrac-mirror/commit/cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7)\".",
    "created_at": "2022-02-12T11:00:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532070",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[de1640511311c3a455587701c49ecd550f0949c5](https://github.com/sagemath/sagetrac-mirror/commit/de1640511311c3a455587701c49ecd550f0949c5)" to "[cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7](https://github.com/sagemath/sagetrac-mirror/commit/cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7)".



---

archive/issue_comments_532071.json:
```json
{
    "body": "<a id='comment:42'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7\">cb82ed0</a></td><td><code>make singular.hlp known to Sage for Debian Singular</code></td></tr></table>\n",
    "created_at": "2022-02-12T11:00:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532071",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:42'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7">cb82ed0</a></td><td><code>make singular.hlp known to Sage for Debian Singular</code></td></tr></table>




---

archive/issue_events_294234.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-02-12T11:01:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294234"
}
```



---

archive/issue_events_294235.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-02-12T11:01:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294235"
}
```



---

archive/issue_comments_532072.json:
```json
{
    "body": "<a id='comment:44'></a>\nAll !Debian/Ubuntu Singular 4.2.1 packages are  broken, some of them do not install the needed .hlp file at all.",
    "created_at": "2022-02-12T16:08:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532072",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:44'></a>
All !Debian/Ubuntu Singular 4.2.1 packages are  broken, some of them do not install the needed .hlp file at all.



---

archive/issue_comments_532073.json:
```json
{
    "body": "**Changing upstream** from \"Reported upstream. No feedback yet.\" to \"Reported upstream. Developers acknowledge bug.\".",
    "created_at": "2022-02-12T16:08:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532073",
    "user": "https://github.com/dimpase"
}
```

**Changing upstream** from "Reported upstream. No feedback yet." to "Reported upstream. Developers acknowledge bug.".



---

archive/issue_comments_532074.json:
```json
{
    "body": "<a id='comment:45'></a>\nReplying to [git](#comment%3A42):\n> Branch pushed to git repo; I updated commit sha1. **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7\">cb82ed0</a></td><td><code>make singular.hlp known to Sage for Debian Singular</code></td></tr></table>\n\nI don't think we should have this in our code",
    "created_at": "2022-02-12T16:51:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532074",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:45'></a>
Replying to [git](#comment%3A42):
> Branch pushed to git repo; I updated commit sha1. **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7">cb82ed0</a></td><td><code>make singular.hlp known to Sage for Debian Singular</code></td></tr></table>

I don't think we should have this in our code



---

archive/issue_comments_532075.json:
```json
{
    "body": "<a id='comment:46'></a>\nProbably best to wait until there's a suitable version packaged",
    "created_at": "2022-02-12T16:52:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532075",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:46'></a>
Probably best to wait until there's a suitable version packaged



---

archive/issue_events_294236.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-12T16:52:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294236"
}
```



---

archive/issue_events_294237.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-12T16:52:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294237"
}
```



---

archive/issue_comments_532076.json:
```json
{
    "body": "<a id='comment:47'></a>\nindeed, there are no packages that work for us atm.",
    "created_at": "2022-02-12T19:03:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532076",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:47'></a>
indeed, there are no packages that work for us atm.



---

archive/issue_comments_532077.json:
```json
{
    "body": "<a id='comment:48'></a>\nIt seems that actually something either goes wrong with dpkg in Ubuntu Jammy, or something is wrong in my Docker setup, but\ninstalling singular-doc Ubuntu package results in many (most) missing files.\nIn particular the crucial file \"singular.info\" is missing.",
    "created_at": "2022-02-12T23:00:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532077",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:48'></a>
It seems that actually something either goes wrong with dpkg in Ubuntu Jammy, or something is wrong in my Docker setup, but
installing singular-doc Ubuntu package results in many (most) missing files.
In particular the crucial file "singular.info" is missing.



---

archive/issue_comments_532078.json:
```json
{
    "body": "<a id='comment:50'></a>\nDisturbingly, while on my Jammy Docker installing singular-doc leads to missing files,\ninstalling the same package on another (\"real\") Ubuntu system works.\nSo this might be Docker-specific :-(",
    "created_at": "2022-02-12T23:38:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532078",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:50'></a>
Disturbingly, while on my Jammy Docker installing singular-doc leads to missing files,
installing the same package on another ("real") Ubuntu system works.
So this might be Docker-specific :-(



---

archive/issue_comments_532079.json:
```json
{
    "body": "<a id='comment:51'></a>\nYou can use `docker system prune --all` to get rid of bad stuff in the cache",
    "created_at": "2022-02-13T00:46:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532079",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:51'></a>
You can use `docker system prune --all` to get rid of bad stuff in the cache



---

archive/issue_comments_532080.json:
```json
{
    "body": "<a id='comment:52'></a>\ncache? No, it's worse, it's `dpkg -i` which does not do the job. \n\nIf I take the same .deb file, unpack it using `ar x` and manually install `data.tar.zst` using tar (one might have to install `zstd` first, to do un-compression), *all* the files from the package get installed.",
    "created_at": "2022-02-13T00:51:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532080",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:52'></a>
cache? No, it's worse, it's `dpkg -i` which does not do the job. 

If I take the same .deb file, unpack it using `ar x` and manually install `data.tar.zst` using tar (one might have to install `zstd` first, to do un-compression), *all* the files from the package get installed.



---

archive/issue_comments_532081.json:
```json
{
    "body": "<a id='comment:53'></a>\nFurther inspection shows that the problem is in the official !Ubuntu/Jammy Docker image. Both official Ubuntu's and Debian \n`singular-doc_4.2.1-p3+ds-1_all.deb` files exhibit the same error (apt used dpkg to install files .deb files, and the same error shows up if installation is done by `dpkg -i singular-doc_4.2.1-p3+ds-1_all.deb`).\n\nCould you check it's not only my Docker that plays up here? Steps to reproduce: \n\n* launch official Jammy image\n\n* get shell prompt there\n\n* run \n\n```\napt install singular-doc\ndpkg -V singular-doc\n```\n\nThe latter command should not output anything - but for me it outputs a log of missing files.\n\n\n\nIn !Debian/Bookworm image, which carries the same singular-doc version, everything is fine.\n\nPS. It would be good to check on a non-Docker installation of Jammy, too.",
    "created_at": "2022-02-13T08:45:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532081",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:53'></a>
Further inspection shows that the problem is in the official !Ubuntu/Jammy Docker image. Both official Ubuntu's and Debian 
`singular-doc_4.2.1-p3+ds-1_all.deb` files exhibit the same error (apt used dpkg to install files .deb files, and the same error shows up if installation is done by `dpkg -i singular-doc_4.2.1-p3+ds-1_all.deb`).

Could you check it's not only my Docker that plays up here? Steps to reproduce: 

* launch official Jammy image

* get shell prompt there

* run 

```
apt install singular-doc
dpkg -V singular-doc
```

The latter command should not output anything - but for me it outputs a log of missing files.



In !Debian/Bookworm image, which carries the same singular-doc version, everything is fine.

PS. It would be good to check on a non-Docker installation of Jammy, too.



---

archive/issue_comments_532082.json:
```json
{
    "body": "<a id='comment:54'></a>\nWe can go forward with this ticker (at least in Debian unstable it will be working) - but we will want a test to check that Singular docs work out of the box.\nOn a working system\n\n```\n# echo \"help;\" | Singular | grep error\n```\ndoes not return anything. On a broken one, one sees\n\n```\n# echo \"help;\" | Singular | grep error\n   ? No functioning help browser available.\n   ? error occurred in or before STDIN line 1: `help;`\n```",
    "created_at": "2022-02-13T08:49:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532082",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:54'></a>
We can go forward with this ticker (at least in Debian unstable it will be working) - but we will want a test to check that Singular docs work out of the box.
On a working system

```
# echo "help;" | Singular | grep error
```
does not return anything. On a broken one, one sees

```
# echo "help;" | Singular | grep error
   ? No functioning help browser available.
   ? error occurred in or before STDIN line 1: `help;`
```



---

archive/issue_comments_532083.json:
```json
{
    "body": "<a id='comment:55'></a>\nReplying to [@mkoeppe](#comment%3A45):\n> Replying to [git](#comment%3A42):\n> > Branch pushed to git repo; I updated commit sha1. New commits:\n\n> |                                                                                                                                                 |                                                     |\n> |-------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|\n> |[cb82ed0](https://github.com/sagemath/sagetrac-mirror/commit/cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7)|`make singular.hlp known to Sage for Debian Singular`|\n> \n> I don't think we should have this in our code\n\nindeed, I'll remove it.",
    "created_at": "2022-02-13T08:49:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532083",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:55'></a>
Replying to [@mkoeppe](#comment%3A45):
> Replying to [git](#comment%3A42):
> > Branch pushed to git repo; I updated commit sha1. New commits:

> |                                                                                                                                                 |                                                     |
> |-------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
> |[cb82ed0](https://github.com/sagemath/sagetrac-mirror/commit/cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7)|`make singular.hlp known to Sage for Debian Singular`|
> 
> I don't think we should have this in our code

indeed, I'll remove it.



---

archive/issue_comments_532084.json:
```json
{
    "body": "**Changing commit** from \"[cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7](https://github.com/sagemath/sagetrac-mirror/commit/cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7)\" to \"[45f1b198b3e5ff000ef9627bfb89a71b4522eda2](https://github.com/sagemath/sagetrac-mirror/commit/45f1b198b3e5ff000ef9627bfb89a71b4522eda2)\".",
    "created_at": "2022-02-13T10:15:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532084",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7](https://github.com/sagemath/sagetrac-mirror/commit/cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7)" to "[45f1b198b3e5ff000ef9627bfb89a71b4522eda2](https://github.com/sagemath/sagetrac-mirror/commit/45f1b198b3e5ff000ef9627bfb89a71b4522eda2)".



---

archive/issue_comments_532085.json:
```json
{
    "body": "<a id='comment:57'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/45f1b198b3e5ff000ef9627bfb89a71b4522eda2\">45f1b19</a></td><td><code>make sure Singular help works</code></td></tr></table>\n",
    "created_at": "2022-02-13T10:15:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532085",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:57'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/45f1b198b3e5ff000ef9627bfb89a71b4522eda2">45f1b19</a></td><td><code>make sure Singular help works</code></td></tr></table>




---

archive/issue_events_294238.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-02-13T10:18:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294238"
}
```



---

archive/issue_events_294239.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2022-02-13T10:18:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294239"
}
```



---

archive/issue_comments_532086.json:
```json
{
    "body": "<a id='comment:58'></a>\nthis should pick up system Singular on Debian/bookworm and sid.\n(and reject broken one on Jammy)",
    "created_at": "2022-02-13T10:18:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532086",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:58'></a>
this should pick up system Singular on Debian/bookworm and sid.
(and reject broken one on Jammy)



---

archive/issue_comments_532087.json:
```json
{
    "body": "<a id='comment:59'></a>\nBy the way, I see the same Jammy failure with singular-doc in Podman running on Fedora, as I see with Docker on macOS.\nSo it really points at a faulty image. Or it's fault in OS itself, for this one needs a non-!Docker/Podman test.",
    "created_at": "2022-02-13T11:22:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532087",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:59'></a>
By the way, I see the same Jammy failure with singular-doc in Podman running on Fedora, as I see with Docker on macOS.
So it really points at a faulty image. Or it's fault in OS itself, for this one needs a non-!Docker/Podman test.



---

archive/issue_comments_532088.json:
```json
{
    "body": "<a id='comment:60'></a>\nEverything is fine in Jammy run in an lxc container, so that's really !Docker/Podman.\nI filed https://github.com/tianon/docker-brew-ubuntu-core/issues/230",
    "created_at": "2022-02-13T12:22:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532088",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:60'></a>
Everything is fine in Jammy run in an lxc container, so that's really !Docker/Podman.
I filed https://github.com/tianon/docker-brew-ubuntu-core/issues/230



---

archive/issue_comments_532089.json:
```json
{
    "body": "**Changing upstream** from \"Reported upstream. Developers acknowledge bug.\" to \"Reported upstream. No feedback yet.\".",
    "created_at": "2022-02-13T12:22:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532089",
    "user": "https://github.com/dimpase"
}
```

**Changing upstream** from "Reported upstream. Developers acknowledge bug." to "Reported upstream. No feedback yet.".



---

archive/issue_comments_532090.json:
```json
{
    "body": "<a id='comment:61'></a>\nI'm told it's Jammy Ubuntu feature, not a bug, here:\nhttps://bugs.launchpad.net/ubuntu/+source/dpkg/+bug/1960749",
    "created_at": "2022-02-13T20:13:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532090",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:61'></a>
I'm told it's Jammy Ubuntu feature, not a bug, here:
https://bugs.launchpad.net/ubuntu/+source/dpkg/+bug/1960749



---

archive/issue_comments_532091.json:
```json
{
    "body": "<a id='comment:62'></a>\nBizarre, so this means we need to add a test for the availability of the info file to `spkg-configure.m4`.",
    "created_at": "2022-02-13T20:27:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532091",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:62'></a>
Bizarre, so this means we need to add a test for the availability of the info file to `spkg-configure.m4`.



---

archive/issue_comments_532092.json:
```json
{
    "body": "<a id='comment:63'></a>\nOh, I see you already did this in 45f1b19",
    "created_at": "2022-02-13T20:30:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532092",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:63'></a>
Oh, I see you already did this in 45f1b19



---

archive/issue_comments_532093.json:
```json
{
    "body": "<a id='comment:64'></a>\nhttps://askubuntu.com/questions/1173337/how-to-prevent-system-from-being-minimized",
    "created_at": "2022-02-13T20:33:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532093",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:64'></a>
https://askubuntu.com/questions/1173337/how-to-prevent-system-from-being-minimized



---

archive/issue_comments_532094.json:
```json
{
    "body": "<a id='comment:65'></a>\nWe can certainly add this step to `build/bin/write-dockerfile.sh` for Debian/Ubuntu",
    "created_at": "2022-02-13T20:35:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532094",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:65'></a>
We can certainly add this step to `build/bin/write-dockerfile.sh` for Debian/Ubuntu



---

archive/issue_comments_532095.json:
```json
{
    "body": "<a id='comment:66'></a>\nUsing their `unminimize` command, I see\n\n```\nReinstalling packages with system documentation in /usr/share/doc/ ..\ndpkg-query: error: --search needs at least one file name pattern argument\n\nUse --help for help about querying packages.\n```\nClearly commercial-grade work there",
    "created_at": "2022-02-13T20:46:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532095",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:66'></a>
Using their `unminimize` command, I see

```
Reinstalling packages with system documentation in /usr/share/doc/ ..
dpkg-query: error: --search needs at least one file name pattern argument

Use --help for help about querying packages.
```
Clearly commercial-grade work there



---

archive/issue_comments_532096.json:
```json
{
    "body": "**Changing branch** from \"[u/dimpase/packages/singular/libpath_fix](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/singular/libpath_fix)\" to \"[u/mkoeppe/packages/singular/libpath_fix](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/packages/singular/libpath_fix)\".",
    "created_at": "2022-02-13T20:47:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532096",
    "user": "https://github.com/mkoeppe"
}
```

**Changing branch** from "[u/dimpase/packages/singular/libpath_fix](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/singular/libpath_fix)" to "[u/mkoeppe/packages/singular/libpath_fix](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/packages/singular/libpath_fix)".



---

archive/issue_comments_532097.json:
```json
{
    "body": "<a id='comment:68'></a>\nIt might be quicker just to remove the `exclude` policy - this won't trigger reinstallation of all the packages already there. \n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2\">c0ceaf5</a></td><td><code>build/bin/write-dockerfile.sh: Use unminimize</code></td></tr></table>\n",
    "created_at": "2022-02-13T21:13:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532097",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:68'></a>
It might be quicker just to remove the `exclude` policy - this won't trigger reinstallation of all the packages already there. 

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2">c0ceaf5</a></td><td><code>build/bin/write-dockerfile.sh: Use unminimize</code></td></tr></table>




---

archive/issue_comments_532098.json:
```json
{
    "body": "**Changing commit** from \"[45f1b198b3e5ff000ef9627bfb89a71b4522eda2](https://github.com/sagemath/sagetrac-mirror/commit/45f1b198b3e5ff000ef9627bfb89a71b4522eda2)\" to \"[c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2](https://github.com/sagemath/sagetrac-mirror/commit/c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2)\".",
    "created_at": "2022-02-13T21:13:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532098",
    "user": "https://github.com/dimpase"
}
```

**Changing commit** from "[45f1b198b3e5ff000ef9627bfb89a71b4522eda2](https://github.com/sagemath/sagetrac-mirror/commit/45f1b198b3e5ff000ef9627bfb89a71b4522eda2)" to "[c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2](https://github.com/sagemath/sagetrac-mirror/commit/c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2)".



---

archive/issue_comments_532099.json:
```json
{
    "body": "<a id='comment:69'></a>\nFine with me, go ahead",
    "created_at": "2022-02-13T21:29:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532099",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:69'></a>
Fine with me, go ahead



---

archive/issue_comments_532100.json:
```json
{
    "body": "<a id='comment:70'></a>\nReplying to [@mkoeppe](#comment%3A69):\n> Fine with me, go ahead\n\nYour branch is actually good (I was worried that images will get much bigger, but I haven't noticed this at all).\nWhat worries me is what happens if `unminimize` is not even present, wouldn't it trigger an error?",
    "created_at": "2022-02-14T10:49:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532100",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:70'></a>
Replying to [@mkoeppe](#comment%3A69):
> Fine with me, go ahead

Your branch is actually good (I was worried that images will get much bigger, but I haven't noticed this at all).
What worries me is what happens if `unminimize` is not even present, wouldn't it trigger an error?



---

archive/issue_comments_532101.json:
```json
{
    "body": "<a id='comment:71'></a>\nOK, it's ignored if missing. No problem then.\nI actually tested this branch in a Ubuntu Jammy Docker, all good (with system Singular).",
    "created_at": "2022-02-14T10:59:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532101",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:71'></a>
OK, it's ignored if missing. No problem then.
I actually tested this branch in a Ubuntu Jammy Docker, all good (with system Singular).



---

archive/issue_comments_532102.json:
```json
{
    "body": "<a id='comment:72'></a>\nReplying to [@mkoeppe](#comment%3A66):\n> Clearly commercial-grade work there\n\nI heard stories from a long-term Canonical insider, such as : \"Boss: We're closing down project X, you're fired. \nProgrammer: But, but, I'm also doing projects Y, Z, ...?! Boss: Uhm, OK. You can stay then.\"",
    "created_at": "2022-02-14T11:13:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532102",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:72'></a>
Replying to [@mkoeppe](#comment%3A66):
> Clearly commercial-grade work there

I heard stories from a long-term Canonical insider, such as : "Boss: We're closing down project X, you're fired. 
Programmer: But, but, I'm also doing projects Y, Z, ...?! Boss: Uhm, OK. You can stay then."



---

archive/issue_comments_532103.json:
```json
{
    "body": "**Reviewer:** Matthias Koeppe",
    "created_at": "2022-02-14T22:26:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532103",
    "user": "https://github.com/mkoeppe"
}
```

**Reviewer:** Matthias Koeppe



---

archive/issue_events_294240.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-14T22:26:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294240"
}
```



---

archive/issue_events_294241.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-14T22:26:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294241"
}
```



---

archive/issue_comments_532104.json:
```json
{
    "body": "<a id='comment:74'></a>\nThanks!",
    "created_at": "2022-02-15T07:51:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532104",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:74'></a>
Thanks!



---

archive/issue_comments_532105.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/packages/singular/libpath_fix](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/packages/singular/libpath_fix)\" to \"[c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2](https://github.com/sagemath/sagetrac-mirror/commit/c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2)\".",
    "created_at": "2022-02-20T13:27:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32789#issuecomment-532105",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mkoeppe/packages/singular/libpath_fix](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/packages/singular/libpath_fix)" to "[c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2](https://github.com/sagemath/sagetrac-mirror/commit/c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2)".



---

archive/issue_events_294242.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-02-20T13:27:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294242"
}
```



---

archive/issue_events_294243.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "0f65e48e0115fa7450287717a5bb846dc13ea8f8",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-02-20T13:27:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32789",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32789#event-294243"
}
```
