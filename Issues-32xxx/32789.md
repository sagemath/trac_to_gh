# Issue 32789: Fix spkg-configure.m4 for singular

archive/issues_032552.json:
```json
{
    "body": "Follow-up from #29024. This time with testing on more than 1 platform.\n\nOn Debian 11 (a.k.a. bullseye, stable) Singular's libs have different names, and are failing to be picked up: they all are installed in `/usr/lib/x86_64-linux-gnu/` and we have the following: I add Sage's names next to their\n\n```\nDebian                             Sage\n\nlibsingular-factory.so             libfactory.so\nlibsingular-gfan.so                ???\nlibsingular-omalloc.so             libomalloc.so\nlibsingular-polys.so               libpolys.so\nlibsingular-resources.so           libsingular_resources.so\nlibsingular-Singular.so            libSingular.so            \n```\n\nWhile it's not hard to test for `libsingular-Singular.so` in place of `libSingular.so`, it's some more work to use it.\n\nLibrary names may be obtained from `$ pkg-config --libs-only-l singular`, which on Debian produces\n\n```\n-lsingular-Singular -ldl -lsingular-polys -lntl -lgmp -ldl -lsingular-factory -lntl -lgmp -lsingular-omalloc -lsingular-resources\n```\n\n\n\nCC:  @dimpase @kiwifb @slel @isuruf @orlitzky @tobiasdiez @tobihan\n\nBranch/Commit: c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2\n\nUpstream: Reported upstream. No feedback yet.\n\nReviewer: Matthias Koeppe\n\nAuthor: Dima Pasechnik\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/32789\n\n",
    "closed_at": "2022-02-20T13:27:51Z",
    "created_at": "2021-10-29T02:38:28Z",
    "labels": [
        "component: build: configure",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.6",
    "title": "Fix spkg-configure.m4 for singular",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32789",
    "user": "https://github.com/mkoeppe"
}
```
Follow-up from #29024. This time with testing on more than 1 platform.

On Debian 11 (a.k.a. bullseye, stable) Singular's libs have different names, and are failing to be picked up: they all are installed in `/usr/lib/x86_64-linux-gnu/` and we have the following: I add Sage's names next to their

```
Debian                             Sage

libsingular-factory.so             libfactory.so
libsingular-gfan.so                ???
libsingular-omalloc.so             libomalloc.so
libsingular-polys.so               libpolys.so
libsingular-resources.so           libsingular_resources.so
libsingular-Singular.so            libSingular.so            
```

While it's not hard to test for `libsingular-Singular.so` in place of `libSingular.so`, it's some more work to use it.

Library names may be obtained from `$ pkg-config --libs-only-l singular`, which on Debian produces

```
-lsingular-Singular -ldl -lsingular-polys -lntl -lgmp -ldl -lsingular-factory -lntl -lgmp -lsingular-omalloc -lsingular-resources
```



CC:  @dimpase @kiwifb @slel @isuruf @orlitzky @tobiasdiez @tobihan

Branch/Commit: c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2

Upstream: Reported upstream. No feedback yet.

Reviewer: Matthias Koeppe

Author: Dima Pasechnik

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/32789





---

archive/issue_comments_653604.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,23 @@\n Follow-up from #29024. This time with testing on more than 1 platform.\n \n+On Debian 11 (a.k.a. bullseye, stable) Singular's libs have different names, and are failing to be picked up: they all are installed in `/usr/lib/x86_64-linux-gnu/` and we have the following: I add Sage's names next to their\n+\n+```\n+Debian                             Sage\n+\n+libsingular-factory.so             libfactory.so\n+libsingular-gfan.so                ???\n+libsingular-omalloc.so             libomalloc.so\n+libsingular-polys.so               libpolys.so\n+libsingular-resources.so           libsingular_resources.so\n+libsingular-Singular.so            libSingular.so            \n+```\n+\n+While it's not hard to test for `libsingular-Singular.so` in place of `libSingular.so`, it's some more work to use it.\n+\n+Library names may be obtained from `$ pkg-config --libs-only-l singular`, which on Debian produces\n+\n+```\n+-lsingular-Singular -ldl -lsingular-polys -lntl -lgmp -ldl -lsingular-factory -lntl -lgmp -lsingular-omalloc -lsingular-resources\n+```\n+\n``````\n",
    "created_at": "2021-10-29T12:33:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653604",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,23 @@
 Follow-up from #29024. This time with testing on more than 1 platform.
 
+On Debian 11 (a.k.a. bullseye, stable) Singular's libs have different names, and are failing to be picked up: they all are installed in `/usr/lib/x86_64-linux-gnu/` and we have the following: I add Sage's names next to their
+
+```
+Debian                             Sage
+
+libsingular-factory.so             libfactory.so
+libsingular-gfan.so                ???
+libsingular-omalloc.so             libomalloc.so
+libsingular-polys.so               libpolys.so
+libsingular-resources.so           libsingular_resources.so
+libsingular-Singular.so            libSingular.so            
+```
+
+While it's not hard to test for `libsingular-Singular.so` in place of `libSingular.so`, it's some more work to use it.
+
+Library names may be obtained from `$ pkg-config --libs-only-l singular`, which on Debian produces
+
+```
+-lsingular-Singular -ldl -lsingular-polys -lntl -lgmp -ldl -lsingular-factory -lntl -lgmp -lsingular-omalloc -lsingular-resources
+```
+
``````




---

archive/issue_comments_653605.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,3 +21,15 @@\n -lsingular-Singular -ldl -lsingular-polys -lntl -lgmp -ldl -lsingular-factory -lntl -lgmp -lsingular-omalloc -lsingular-resources\n ```\n \n+\n+Also broken on Cygwin, as reported in https://groups.google.com/g/sage-release/c/FXpakLURP_0/m/La20cB4rBgAJ:\n+\n+```\n+  [sagemath_doc_html-none]     File \"sage/libs/singular/singular.pyx\", line 1555, in init sage.libs.singular.singular (build/cythonized/sage/libs/singular/singular.cpp:15622)\n+  [sagemath_doc_html-none]     File \"sage/libs/singular/singular.pyx\", line 1530, in sage.libs.singular.singular.init_libsingular (build/cythonized/sage/libs/singular/singular.cpp:12925)\n+  [sagemath_doc_html-none]   ImportError: cannot load Singular library from /home/s/sage9n/local/bin/libSingular.dll (b'No such file or directory')\n+  [sagemath_doc_html-none]   Error: './sage --docbuild --all-documents' failed\n+```\n+\n+\n+\n``````\n",
    "created_at": "2021-11-28T03:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653605",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,3 +21,15 @@
 -lsingular-Singular -ldl -lsingular-polys -lntl -lgmp -ldl -lsingular-factory -lntl -lgmp -lsingular-omalloc -lsingular-resources
 ```
 
+
+Also broken on Cygwin, as reported in https://groups.google.com/g/sage-release/c/FXpakLURP_0/m/La20cB4rBgAJ:
+
+```
+  [sagemath_doc_html-none]     File "sage/libs/singular/singular.pyx", line 1555, in init sage.libs.singular.singular (build/cythonized/sage/libs/singular/singular.cpp:15622)
+  [sagemath_doc_html-none]     File "sage/libs/singular/singular.pyx", line 1530, in sage.libs.singular.singular.init_libsingular (build/cythonized/sage/libs/singular/singular.cpp:12925)
+  [sagemath_doc_html-none]   ImportError: cannot load Singular library from /home/s/sage9n/local/bin/libSingular.dll (b'No such file or directory')
+  [sagemath_doc_html-none]   Error: './sage --docbuild --all-documents' failed
+```
+
+
+
``````




---

archive/issue_comments_653606.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2021-11-28T03:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653606",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_653607.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -22,7 +22,7 @@\n ```\n \n \n-Also broken on Cygwin, as reported in https://groups.google.com/g/sage-release/c/FXpakLURP_0/m/La20cB4rBgAJ:\n+Also broken on Cygwin (with singular from SPKG, as the cygwin-provided Singular is too old and is correctly rejected), as reported in https://groups.google.com/g/sage-release/c/FXpakLURP_0/m/La20cB4rBgAJ:\n \n ```\n   [sagemath_doc_html-none]     File \"sage/libs/singular/singular.pyx\", line 1555, in init sage.libs.singular.singular (build/cythonized/sage/libs/singular/singular.cpp:15622)\n``````\n",
    "created_at": "2021-11-28T03:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653607",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -22,7 +22,7 @@
 ```
 
 
-Also broken on Cygwin, as reported in https://groups.google.com/g/sage-release/c/FXpakLURP_0/m/La20cB4rBgAJ:
+Also broken on Cygwin (with singular from SPKG, as the cygwin-provided Singular is too old and is correctly rejected), as reported in https://groups.google.com/g/sage-release/c/FXpakLURP_0/m/La20cB4rBgAJ:
 
 ```
   [sagemath_doc_html-none]     File "sage/libs/singular/singular.pyx", line 1555, in init sage.libs.singular.singular (build/cythonized/sage/libs/singular/singular.cpp:15622)
``````




---

archive/issue_comments_653608.json:
```json
{
    "body": "<a id='comment:4'></a>\nWe already tried to fix the path to libSingular on cygwin once. Where does it really live?",
    "created_at": "2021-11-28T13:15:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653608",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:4'></a>
We already tried to fix the path to libSingular on cygwin once. Where does it really live?



---

archive/issue_comments_653609.json:
```json
{
    "body": "<a id='comment:5'></a>\nWe have a GH Actions workflow for Cygwin that allows you to download logs and the installation in `SAGE_LOCAL` for inspection, see for example https://github.com/sagemath/sage/actions/runs/1478855916",
    "created_at": "2021-11-28T19:36:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653609",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
We have a GH Actions workflow for Cygwin that allows you to download logs and the installation in `SAGE_LOCAL` for inspection, see for example https://github.com/sagemath/sage/actions/runs/1478855916



---

archive/issue_comments_653610.json:
```json
{
    "body": "<a id='comment:6'></a>\nHappy to run any commands under Cygwin too.",
    "created_at": "2021-11-29T18:59:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653610",
    "user": "https://github.com/slel"
}
```

<a id='comment:6'></a>
Happy to run any commands under Cygwin too.



---

archive/issue_comments_653611.json:
```json
{
    "body": "<a id='comment:7'></a>\nFrom https://github.com/mkoeppe/sage/suites/4487559073/artifacts/119913634:\nThe following DLLs are installed in `SAGE_LOCAL/bin`:\n\n```\ncygfactory-4-2-1.dll\ncygomalloc-0-9-6.dll\ncygpolys-4-2-1.dll\ncygsingular_resources-4-2-1.dll\ncygSingular-4-2-1.dll\n```",
    "created_at": "2021-11-29T19:53:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653611",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
From https://github.com/mkoeppe/sage/suites/4487559073/artifacts/119913634:
The following DLLs are installed in `SAGE_LOCAL/bin`:

```
cygfactory-4-2-1.dll
cygomalloc-0-9-6.dll
cygpolys-4-2-1.dll
cygsingular_resources-4-2-1.dll
cygSingular-4-2-1.dll
```



---

archive/issue_comments_653612.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [mkoeppe](#comment%3A7):\n> {{{\n> cygSingular-4-2-1.dll\n> }}}\n\n\nIs there a symlink from `cygSingular.dll` to that file?",
    "created_at": "2021-11-29T20:03:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653612",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:8'></a>
Replying to [mkoeppe](#comment%3A7):
> {{{
> cygSingular-4-2-1.dll
> }}}


Is there a symlink from `cygSingular.dll` to that file?



---

archive/issue_comments_653613.json:
```json
{
    "body": "<a id='comment:9'></a>\nNo",
    "created_at": "2021-11-29T20:05:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653613",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>
No



---

archive/issue_comments_653614.json:
```json
{
    "body": "<a id='comment:10'></a>\nThere is also a file `SAGE_LOCAL/lib/libSingular.dll.a`, which is used by the linker, and probably contains the information about the name of the actual DLL somehow.",
    "created_at": "2021-11-29T20:08:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653614",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>
There is also a file `SAGE_LOCAL/lib/libSingular.dll.a`, which is used by the linker, and probably contains the information about the name of the actual DLL somehow.



---

archive/issue_comments_653615.json:
```json
{
    "body": "<a id='comment:11'></a>\nApparently https://sourceware.org/binutils/docs/binutils/dlltool.html can be used for reading this info.\n\n`@`slelievre, could you run `dlltool --identify local/lib/libSingular.dll.a` please?",
    "created_at": "2021-11-29T20:16:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653615",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
Apparently https://sourceware.org/binutils/docs/binutils/dlltool.html can be used for reading this info.

`@`slelievre, could you run `dlltool --identify local/lib/libSingular.dll.a` please?



---

archive/issue_comments_653616.json:
```json
{
    "body": "<a id='comment:12'></a>\nThe SPKG won't be installed yet, so we can't read `local/lib/libSingular.dll.a` to obtain the necessary path during `./configure.` For the SPKG, we could hard-code the value as a last resort. Their library versioning scheme also corresponds to `package-version.txt`, but I doubt that's reliable.\n\nDetecting the system copy should be relatively easy in comparison. Unless there's a way to install multiple copies into the system libdir, we can use `find` to pick out what is hopefully the only copy of `cygSingular*.dll` during `./configure`.",
    "created_at": "2021-11-29T20:45:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653616",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:12'></a>
The SPKG won't be installed yet, so we can't read `local/lib/libSingular.dll.a` to obtain the necessary path during `./configure.` For the SPKG, we could hard-code the value as a last resort. Their library versioning scheme also corresponds to `package-version.txt`, but I doubt that's reliable.

Detecting the system copy should be relatively easy in comparison. Unless there's a way to install multiple copies into the system libdir, we can use `find` to pick out what is hopefully the only copy of `cygSingular*.dll` during `./configure`.



---

archive/issue_comments_653617.json:
```json
{
    "body": "<a id='comment:13'></a>\nIt would probably be a good idea to first test whether this whole symbol visibility issue is even a thing on Cygwin.",
    "created_at": "2021-11-29T20:52:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653617",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>
It would probably be a good idea to first test whether this whole symbol visibility issue is even a thing on Cygwin.



---

archive/issue_comments_653618.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/fix_spkg_configure_m4_for_singular\"",
    "created_at": "2021-11-29T21:04:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653618",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/fix_spkg_configure_m4_for_singular"



---

archive/issue_comments_653619.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#32944, #32945\"",
    "created_at": "2021-11-29T21:06:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653619",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#32944, #32945"



---

archive/issue_comments_653620.json:
```json
{
    "body": "<a id='comment:15'></a>\nNew commits:\n|                                                                                                                                          |                                                                                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------|\n|[47a6598](https://git.sagemath.org/sage.git/commit?id=47a6598471e55e4084a211a088ff0d9150a6f558)|`src/sage/libs/singular/singular.pyx: On Cygwin, do not try to make singular library symbols global`|",
    "created_at": "2021-11-29T21:06:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653620",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>
New commits:
|                                                                                                                                          |                                                                                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------|
|[47a6598](https://git.sagemath.org/sage.git/commit?id=47a6598471e55e4084a211a088ff0d9150a6f558)|`src/sage/libs/singular/singular.pyx: On Cygwin, do not try to make singular library symbols global`|



---

archive/issue_comments_653621.json:
```json
{
    "body": "Changing commit from \"\" to \"47a6598471e55e4084a211a088ff0d9150a6f558\"",
    "created_at": "2021-11-29T21:06:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653621",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "47a6598471e55e4084a211a088ff0d9150a6f558"



---

archive/issue_comments_653622.json:
```json
{
    "body": "Changing commit from \"47a6598471e55e4084a211a088ff0d9150a6f558\" to \"d14d0af891584e93c478fe71a91ef26f17a08962\"",
    "created_at": "2021-11-29T21:06:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653622",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "47a6598471e55e4084a211a088ff0d9150a6f558" to "d14d0af891584e93c478fe71a91ef26f17a08962"



---

archive/issue_comments_653623.json:
```json
{
    "body": "<a id='comment:16'></a>\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n|                                                                                                                                           |                                                                                                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------|\n|[fbb8228](https://git.sagemath.org/sage.git/commit/?id=fbb8228e04a410aac7990db34e57fb29fa2103d0)|`build/bin/sage-build-env: Do not use SETUPTOOLS_USE_DISTUTILS=local on platforms other than homebrew`|\n|[d5481d6](https://git.sagemath.org/sage.git/commit/?id=d5481d684f43293af9521d1fd51c6e5e2ec4f415)|`Merge #32944`|\n|[28e4fc6](https://git.sagemath.org/sage.git/commit/?id=28e4fc6526ee0543cb94ac7481a68cd998281d8b)|`build/pkgs/pip/patches: Add upstream PR 10574`|\n|[1b6ac2c](https://git.sagemath.org/sage.git/commit/?id=1b6ac2c509583c32bd006353f14203037bf95618)|`build/pkgs/pip/patches/10574.patch: Backport to 21.3.1`|\n|[d3a6fc3](https://git.sagemath.org/sage.git/commit/?id=d3a6fc38811ff3480724d27fc18f890a409592e8)|`build/pkgs/pip: Update to 21.3.1`|\n|[5b001a2](https://git.sagemath.org/sage.git/commit/?id=5b001a2f65b0c052081333f928e729ddfedf0b81)|`build/bin/sage-dist-helpers: Remove '--use-feature=in-tree-build' (default since pip 21.3)`|\n|[f1f4759](https://git.sagemath.org/sage.git/commit/?id=f1f475998ce77ab6dbaa9d5bd6b683fa7ebfd60e)|`build/pkgs/distlib: Update to 0.3.3`|\n|[760ff09](https://git.sagemath.org/sage.git/commit/?id=760ff0952d4f461e5f3b67ee8c5aceacc287f23e)|`Merge #32751`|\n|[f8400f7](https://git.sagemath.org/sage.git/commit/?id=f8400f719f46f046cd12a781d6dc16f43e92a100)|`Merge #32671`|\n|[d14d0af](https://git.sagemath.org/sage.git/commit/?id=d14d0af891584e93c478fe71a91ef26f17a08962)|`Merge #32945`|",
    "created_at": "2021-11-29T21:06:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653623",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
|                                                                                                                                           |                                                                                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------|
|[fbb8228](https://git.sagemath.org/sage.git/commit/?id=fbb8228e04a410aac7990db34e57fb29fa2103d0)|`build/bin/sage-build-env: Do not use SETUPTOOLS_USE_DISTUTILS=local on platforms other than homebrew`|
|[d5481d6](https://git.sagemath.org/sage.git/commit/?id=d5481d684f43293af9521d1fd51c6e5e2ec4f415)|`Merge #32944`|
|[28e4fc6](https://git.sagemath.org/sage.git/commit/?id=28e4fc6526ee0543cb94ac7481a68cd998281d8b)|`build/pkgs/pip/patches: Add upstream PR 10574`|
|[1b6ac2c](https://git.sagemath.org/sage.git/commit/?id=1b6ac2c509583c32bd006353f14203037bf95618)|`build/pkgs/pip/patches/10574.patch: Backport to 21.3.1`|
|[d3a6fc3](https://git.sagemath.org/sage.git/commit/?id=d3a6fc38811ff3480724d27fc18f890a409592e8)|`build/pkgs/pip: Update to 21.3.1`|
|[5b001a2](https://git.sagemath.org/sage.git/commit/?id=5b001a2f65b0c052081333f928e729ddfedf0b81)|`build/bin/sage-dist-helpers: Remove '--use-feature=in-tree-build' (default since pip 21.3)`|
|[f1f4759](https://git.sagemath.org/sage.git/commit/?id=f1f475998ce77ab6dbaa9d5bd6b683fa7ebfd60e)|`build/pkgs/distlib: Update to 0.3.3`|
|[760ff09](https://git.sagemath.org/sage.git/commit/?id=760ff0952d4f461e5f3b67ee8c5aceacc287f23e)|`Merge #32751`|
|[f8400f7](https://git.sagemath.org/sage.git/commit/?id=f8400f719f46f046cd12a781d6dc16f43e92a100)|`Merge #32671`|
|[d14d0af](https://git.sagemath.org/sage.git/commit/?id=d14d0af891584e93c478fe71a91ef26f17a08962)|`Merge #32945`|



---

archive/issue_comments_653624.json:
```json
{
    "body": "Changing commit from \"d14d0af891584e93c478fe71a91ef26f17a08962\" to \"377df3553e8be697de6210497d10f39d16bfd7e0\"",
    "created_at": "2021-11-29T21:07:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653624",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d14d0af891584e93c478fe71a91ef26f17a08962" to "377df3553e8be697de6210497d10f39d16bfd7e0"



---

archive/issue_comments_653625.json:
```json
{
    "body": "<a id='comment:17'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[377df35](https://git.sagemath.org/sage.git/commit/?id=377df3553e8be697de6210497d10f39d16bfd7e0)|`src/sage/libs/singular/singular.pyx: Fixup`|",
    "created_at": "2021-11-29T21:07:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653625",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[377df35](https://git.sagemath.org/sage.git/commit/?id=377df3553e8be697de6210497d10f39d16bfd7e0)|`src/sage/libs/singular/singular.pyx: Fixup`|



---

archive/issue_comments_653626.json:
```json
{
    "body": "<a id='comment:18'></a>\nI've put this on top of other Cygwin fixes for convenience of testing",
    "created_at": "2021-11-29T21:08:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653626",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>
I've put this on top of other Cygwin fixes for convenience of testing



---

archive/issue_comments_653627.json:
```json
{
    "body": "Changing reviewer from \"\" to \"https://github.com/sagemath/sagetrac-mirror/actions/runs/1517921823\"",
    "created_at": "2021-11-29T21:11:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653627",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "" to "https://github.com/sagemath/sagetrac-mirror/actions/runs/1517921823"



---

archive/issue_comments_653628.json:
```json
{
    "body": "<a id='comment:20'></a>\nHm, the test with `CYGWIN_VERSION` does not seem to have worked\nhttps://github.com/sagemath/sagetrac-mirror/runs/4371131888?check_suite_focus=true",
    "created_at": "2021-11-30T21:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653628",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>
Hm, the test with `CYGWIN_VERSION` does not seem to have worked
https://github.com/sagemath/sagetrac-mirror/runs/4371131888?check_suite_focus=true



---

archive/issue_comments_653629.json:
```json
{
    "body": "<a id='comment:21'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------|\n|[33d7d12](https://git.sagemath.org/sage.git/commit/?id=33d7d120081feb5a0e199ec46c1003cf4a079824)|`src/sage/libs/singular/singular.pyx: Use platform.system instead of sage.env.CYGWIN_VERSION`|",
    "created_at": "2021-11-30T21:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653629",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------|
|[33d7d12](https://git.sagemath.org/sage.git/commit/?id=33d7d120081feb5a0e199ec46c1003cf4a079824)|`src/sage/libs/singular/singular.pyx: Use platform.system instead of sage.env.CYGWIN_VERSION`|



---

archive/issue_comments_653630.json:
```json
{
    "body": "Changing commit from \"377df3553e8be697de6210497d10f39d16bfd7e0\" to \"33d7d120081feb5a0e199ec46c1003cf4a079824\"",
    "created_at": "2021-11-30T21:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653630",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "377df3553e8be697de6210497d10f39d16bfd7e0" to "33d7d120081feb5a0e199ec46c1003cf4a079824"



---

archive/issue_comments_653631.json:
```json
{
    "body": "Changing reviewer from \"https://github.com/sagemath/sagetrac-mirror/actions/runs/1517921823\" to \"https://github.com/sagemath/sagetrac-mirror/actions/runs/1523079928\"",
    "created_at": "2021-11-30T21:57:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653631",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "https://github.com/sagemath/sagetrac-mirror/actions/runs/1517921823" to "https://github.com/sagemath/sagetrac-mirror/actions/runs/1523079928"



---

archive/issue_comments_653632.json:
```json
{
    "body": "<a id='comment:23'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------|\n|[3d4f91b](https://git.sagemath.org/sage.git/commit/?id=3d4f91b09d4f1e7b998fe9fb056657ac6e7cbdb9)|`src/sage/env.py: Remove unused/defunct variable CYGWIN_VERSION`|",
    "created_at": "2021-11-30T22:01:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653632",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------|
|[3d4f91b](https://git.sagemath.org/sage.git/commit/?id=3d4f91b09d4f1e7b998fe9fb056657ac6e7cbdb9)|`src/sage/env.py: Remove unused/defunct variable CYGWIN_VERSION`|



---

archive/issue_comments_653633.json:
```json
{
    "body": "Changing commit from \"33d7d120081feb5a0e199ec46c1003cf4a079824\" to \"3d4f91b09d4f1e7b998fe9fb056657ac6e7cbdb9\"",
    "created_at": "2021-11-30T22:01:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653633",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "33d7d120081feb5a0e199ec46c1003cf4a079824" to "3d4f91b09d4f1e7b998fe9fb056657ac6e7cbdb9"



---

archive/issue_comments_653634.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/fix_spkg_configure_m4_for_singular\" to \"\"",
    "created_at": "2021-12-01T17:50:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653634",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "u/mkoeppe/fix_spkg_configure_m4_for_singular" to ""



---

archive/issue_comments_653635.json:
```json
{
    "body": "Changing commit from \"3d4f91b09d4f1e7b998fe9fb056657ac6e7cbdb9\" to \"\"",
    "created_at": "2021-12-01T17:50:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653635",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "3d4f91b09d4f1e7b998fe9fb056657ac6e7cbdb9" to ""



---

archive/issue_comments_653636.json:
```json
{
    "body": "Changing reviewer from \"https://github.com/sagemath/sagetrac-mirror/actions/runs/1523079928\" to \"\"",
    "created_at": "2021-12-01T17:50:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653636",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "https://github.com/sagemath/sagetrac-mirror/actions/runs/1523079928" to ""



---

archive/issue_comments_653637.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -22,14 +22,3 @@\n ```\n \n \n-Also broken on Cygwin (with singular from SPKG, as the cygwin-provided Singular is too old and is correctly rejected), as reported in https://groups.google.com/g/sage-release/c/FXpakLURP_0/m/La20cB4rBgAJ:\n-\n-```\n-  [sagemath_doc_html-none]     File \"sage/libs/singular/singular.pyx\", line 1555, in init sage.libs.singular.singular (build/cythonized/sage/libs/singular/singular.cpp:15622)\n-  [sagemath_doc_html-none]     File \"sage/libs/singular/singular.pyx\", line 1530, in sage.libs.singular.singular.init_libsingular (build/cythonized/sage/libs/singular/singular.cpp:12925)\n-  [sagemath_doc_html-none]   ImportError: cannot load Singular library from /home/s/sage9n/local/bin/libSingular.dll (b'No such file or directory')\n-  [sagemath_doc_html-none]   Error: './sage --docbuild --all-documents' failed\n-```\n-\n-\n-\n``````\n",
    "created_at": "2021-12-01T17:50:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653637",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -22,14 +22,3 @@
 ```
 
 
-Also broken on Cygwin (with singular from SPKG, as the cygwin-provided Singular is too old and is correctly rejected), as reported in https://groups.google.com/g/sage-release/c/FXpakLURP_0/m/La20cB4rBgAJ:
-
-```
-  [sagemath_doc_html-none]     File "sage/libs/singular/singular.pyx", line 1555, in init sage.libs.singular.singular (build/cythonized/sage/libs/singular/singular.cpp:15622)
-  [sagemath_doc_html-none]     File "sage/libs/singular/singular.pyx", line 1530, in sage.libs.singular.singular.init_libsingular (build/cythonized/sage/libs/singular/singular.cpp:12925)
-  [sagemath_doc_html-none]   ImportError: cannot load Singular library from /home/s/sage9n/local/bin/libSingular.dll (b'No such file or directory')
-  [sagemath_doc_html-none]   Error: './sage --docbuild --all-documents' failed
-```
-
-
-
``````




---

archive/issue_comments_653638.json:
```json
{
    "body": "Changing dependencies from \"#32944, #32945\" to \"\"",
    "created_at": "2021-12-01T17:50:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653638",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#32944, #32945" to ""



---

archive/issue_comments_653639.json:
```json
{
    "body": "Changing priority from blocker to critical.",
    "created_at": "2021-12-01T17:50:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653639",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from blocker to critical.



---

archive/issue_comments_653640.json:
```json
{
    "body": "<a id='comment:24'></a>\nI've split out the cygwin issue to #32954, ready for review",
    "created_at": "2021-12-01T17:50:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653640",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'></a>
I've split out the cygwin issue to #32954, ready for review



---

archive/issue_comments_653641.json:
```json
{
    "body": "<a id='comment:25'></a>\nCurrently on all `ubuntu` including `-jammy`, singular's dependency `cddlib` is rejected - so there's no urgency here",
    "created_at": "2021-12-23T19:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653641",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>
Currently on all `ubuntu` including `-jammy`, singular's dependency `cddlib` is rejected - so there's no urgency here



---

archive/issue_events_086754.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-23T19:51:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32789#event-86754"
}
```



---

archive/issue_comments_653642.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [mkoeppe](#comment%3A25):\n> Currently on all `ubuntu` including `-jammy`, singular's dependency `cddlib` is rejected - so there's no urgency here\n\n\nI didn't get that. Is there something that needs to be changed in a Debian package?",
    "created_at": "2021-12-24T12:29:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653642",
    "user": "https://github.com/tobihan"
}
```

<a id='comment:26'></a>
Replying to [mkoeppe](#comment%3A25):
> Currently on all `ubuntu` including `-jammy`, singular's dependency `cddlib` is rejected - so there's no urgency here


I didn't get that. Is there something that needs to be changed in a Debian package?



---

archive/issue_comments_653643.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [thansen](#comment%3A26):\n> Replying to [mkoeppe](#comment%3A25):\n> > Currently on all `ubuntu` including `-jammy`, singular's dependency `cddlib` is rejected - so there's no urgency here\n\n> \n> I didn't get that. Is there something that needs to be changed in a Debian package?\n\n\nYes, I think Debian's `cddlib` needs upgrading to 0.94m (see https://repology.org/project/cddlib/versions)",
    "created_at": "2021-12-25T19:50:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653643",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>
Replying to [thansen](#comment%3A26):
> Replying to [mkoeppe](#comment%3A25):
> > Currently on all `ubuntu` including `-jammy`, singular's dependency `cddlib` is rejected - so there's no urgency here

> 
> I didn't get that. Is there something that needs to be changed in a Debian package?


Yes, I think Debian's `cddlib` needs upgrading to 0.94m (see https://repology.org/project/cddlib/versions)



---

archive/issue_comments_653644.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [mkoeppe](#comment%3A27):\n> Yes, I think Debian's `cddlib` needs upgrading to 0.94m (see https://repology.org/project/cddlib/versions)\n\n\nOk, done.",
    "created_at": "2021-12-29T13:25:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653644",
    "user": "https://github.com/tobihan"
}
```

<a id='comment:28'></a>
Replying to [mkoeppe](#comment%3A27):
> Yes, I think Debian's `cddlib` needs upgrading to 0.94m (see https://repology.org/project/cddlib/versions)


Ok, done.



---

archive/issue_comments_653645.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [thansen](#comment%3A28):\n> Replying to [mkoeppe](#comment%3A27):\n> > Yes, I think Debian's `cddlib` needs upgrading to 0.94m (see https://repology.org/project/cddlib/versions)\n\n> \n> Ok, done.\n\n\nGreat. `tox -e docker-ubuntu-jammy-standard -- config.status` now gives:\n\n```\nChecking whether SageMath should install SPKG singular...\nchecking whether any of gmp ntl flint readline mpfr cddlib is installed as or will be installed as SPKG... no\nchecking for Singular... /usr/bin/Singular\nchecking for Singular >= 4.1.1... yes\nchecking if we can dlopen(/usr/lib/x86_64-linux-gnu/libSingular.so)... no\nconfigure: no suitable system package found for SPKG singular\n```\n\nSo it makes sense now to work on the present ticket.",
    "created_at": "2021-12-30T01:26:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653645",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>
Replying to [thansen](#comment%3A28):
> Replying to [mkoeppe](#comment%3A27):
> > Yes, I think Debian's `cddlib` needs upgrading to 0.94m (see https://repology.org/project/cddlib/versions)

> 
> Ok, done.


Great. `tox -e docker-ubuntu-jammy-standard -- config.status` now gives:

```
Checking whether SageMath should install SPKG singular...
checking whether any of gmp ntl flint readline mpfr cddlib is installed as or will be installed as SPKG... no
checking for Singular... /usr/bin/Singular
checking for Singular >= 4.1.1... yes
checking if we can dlopen(/usr/lib/x86_64-linux-gnu/libSingular.so)... no
configure: no suitable system package found for SPKG singular
```

So it makes sense now to work on the present ticket.



---

archive/issue_comments_653646.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2022-01-26T16:35:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653646",
    "user": "https://github.com/slel"
}
```

Changing priority from major to critical.



---

archive/issue_comments_653647.json:
```json
{
    "body": "<a id='comment:30'></a>\nChanging to critical in view of #33139.",
    "created_at": "2022-01-26T16:35:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653647",
    "user": "https://github.com/slel"
}
```

<a id='comment:30'></a>
Changing to critical in view of #33139.



---

archive/issue_comments_653648.json:
```json
{
    "body": "<a id='comment:31'></a>\nWhat does this have to do with a docbuild failure?",
    "created_at": "2022-01-26T16:48:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653648",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:31'></a>
What does this have to do with a docbuild failure?



---

archive/issue_comments_653649.json:
```json
{
    "body": "<a id='comment:32'></a>\nRight, the link with singular was ruled out\ninticket: ticket:32954#comment:8#comment:32954.\n\nSorry for the noise.",
    "created_at": "2022-01-26T20:25:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653649",
    "user": "https://github.com/slel"
}
```

<a id='comment:32'></a>
Right, the link with singular was ruled out
inticket: ticket:32954#comment:8#comment:32954.

Sorry for the noise.



---

archive/issue_comments_653650.json:
```json
{
    "body": "Changing author from \"\" to \"Dima Pasechnik\"",
    "created_at": "2022-02-11T12:58:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653650",
    "user": "https://github.com/dimpase"
}
```

Changing author from "" to "Dima Pasechnik"



---

archive/issue_comments_653651.json:
```json
{
    "body": "<a id='comment:33'></a>\nstill testing. the library on Debian is recognised, at least.\n\n---\nNew commits:\n|                                                                                                                                          |                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|\n|[c94e0c5](https://git.sagemath.org/sage.git/commit?id=c94e0c5631add37043e97a4dea9e0b4362b92556)|`added test for libsingular-Singular`|",
    "created_at": "2022-02-11T12:58:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653651",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:33'></a>
still testing. the library on Debian is recognised, at least.

---
New commits:
|                                                                                                                                          |                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
|[c94e0c5](https://git.sagemath.org/sage.git/commit?id=c94e0c5631add37043e97a4dea9e0b4362b92556)|`added test for libsingular-Singular`|



---

archive/issue_comments_653652.json:
```json
{
    "body": "Changing branch from \"\" to \"u/dimpase/packages/singular/libpath_fix\"",
    "created_at": "2022-02-11T12:58:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653652",
    "user": "https://github.com/dimpase"
}
```

Changing branch from "" to "u/dimpase/packages/singular/libpath_fix"



---

archive/issue_comments_653653.json:
```json
{
    "body": "Changing commit from \"\" to \"c94e0c5631add37043e97a4dea9e0b4362b92556\"",
    "created_at": "2022-02-11T12:58:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653653",
    "user": "https://github.com/dimpase"
}
```

Changing commit from "" to "c94e0c5631add37043e97a4dea9e0b4362b92556"



---

archive/issue_comments_653654.json:
```json
{
    "body": "Changing commit from \"c94e0c5631add37043e97a4dea9e0b4362b92556\" to \"de1640511311c3a455587701c49ecd550f0949c5\"",
    "created_at": "2022-02-11T17:11:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653654",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c94e0c5631add37043e97a4dea9e0b4362b92556" to "de1640511311c3a455587701c49ecd550f0949c5"



---

archive/issue_comments_653655.json:
```json
{
    "body": "<a id='comment:34'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|\n|[de16405](https://git.sagemath.org/sage.git/commit/?id=de1640511311c3a455587701c49ecd550f0949c5)|`bump the minimal version to get polylib.lib`|",
    "created_at": "2022-02-11T17:11:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653655",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|
|[de16405](https://git.sagemath.org/sage.git/commit/?id=de1640511311c3a455587701c49ecd550f0949c5)|`bump the minimal version to get polylib.lib`|



---

archive/issue_comments_653656.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-02-11T17:21:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653656",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_653657.json:
```json
{
    "body": "<a id='comment:35'></a>\nNeeds review. I suppose allowing Singular 4.1.1 was to be bumped up, as 4.1.1 doesn't actually have `polylib.lib` (it's called `poly.lib` there, but it's anyway too old, I think).",
    "created_at": "2022-02-11T17:21:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653657",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:35'></a>
Needs review. I suppose allowing Singular 4.1.1 was to be bumped up, as 4.1.1 doesn't actually have `polylib.lib` (it's called `poly.lib` there, but it's anyway too old, I think).



---

archive/issue_comments_653658.json:
```json
{
    "body": "<a id='comment:36'></a>\nI actually checked that the branch allows using system Singular 4.1.1 on Debian 11, but then the result has test failures due to that `polylib.lib` absense.",
    "created_at": "2022-02-11T18:35:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653658",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:36'></a>
I actually checked that the branch allows using system Singular 4.1.1 on Debian 11, but then the result has test failures due to that `polylib.lib` absense.



---

archive/issue_comments_653659.json:
```json
{
    "body": "<a id='comment:37'></a>\nOK, this still correctly rejects singular on all ubuntu releases earlier than `jammy`.",
    "created_at": "2022-02-11T19:56:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653659",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:37'></a>
OK, this still correctly rejects singular on all ubuntu releases earlier than `jammy`.



---

archive/issue_comments_653660.json:
```json
{
    "body": "<a id='comment:38'></a>\nWith `TARGETS_PRE=build-local tox -e docker-ubuntu-jammy-standard -- build ptest` I see the following failures:\n\n```\nsage -t --random-seed=75077202530737540355693167266645487963 src/sage/interfaces/singular.py\n**********************************************************************\nFile \"src/sage/interfaces/singular.py\", line 2243, in sage.interfaces.singular.SingularFunction._instancedoc_\nFailed example:\n    'groebner' in singular.groebner.__doc__\nException raised:\n    Traceback (most recent call last):\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.interfaces.singular.SingularFunction._instancedoc_[0]>\", line 1, in <module>\n        'groebner' in singular.groebner.__doc__\n      File \"sage/docs/instancedoc.pyx\", line 211, in sage.docs.instancedoc.InstanceDocDescriptor.__get__ (build/cythonized/sage/docs/instancedoc.c:1878)\n        return self.instancedoc(obj)\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py\", line 2247, in _instancedoc_\n        generate_docstring_dictionary()\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py\", line 2337, in generate_docstring_dictionary\n        with io.open(singular_info_file,\n    TypeError: expected str, bytes or os.PathLike object, not NoneType\n**********************************************************************\nFile \"src/sage/interfaces/singular.py\", line 2283, in sage.interfaces.singular.SingularFunctionElement._instancedoc_\nFailed example:\n    'matrix_expression' in A.nrows.__doc__\nException raised:\n    Traceback (most recent call last):\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.interfaces.singular.SingularFunctionElement._instancedoc_[2]>\", line 1, in <module>\n        'matrix_expression' in A.nrows.__doc__\n      File \"sage/docs/instancedoc.pyx\", line 211, in sage.docs.instancedoc.InstanceDocDescriptor.__get__ (build/cythonized/sage/docs/instancedoc.c:1878)\n        return self.instancedoc(obj)\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py\", line 2287, in _instancedoc_\n        generate_docstring_dictionary()\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py\", line 2337, in generate_docstring_dictionary\n        with io.open(singular_info_file,\n    TypeError: expected str, bytes or os.PathLike object, not NoneType\n**********************************************************************\nFile \"src/sage/interfaces/singular.py\", line 2319, in sage.interfaces.singular.generate_docstring_dictionary\nFailed example:\n    generate_docstring_dictionary()\nException raised:\n    Traceback (most recent call last):\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.interfaces.singular.generate_docstring_dictionary[1]>\", line 1, in <module>\n        generate_docstring_dictionary()\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py\", line 2337, in generate_docstring_dictionary\n        with io.open(singular_info_file,\n    TypeError: expected str, bytes or os.PathLike object, not NoneType\n**********************************************************************\nFile \"src/sage/interfaces/singular.py\", line 2371, in sage.interfaces.singular.get_docstring\nFailed example:\n    'groebner' in get_docstring('groebner')\nException raised:\n    Traceback (most recent call last):\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.interfaces.singular.get_docstring[1]>\", line 1, in <module>\n        'groebner' in get_docstring('groebner')\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py\", line 2378, in get_docstring\n        generate_docstring_dictionary()\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py\", line 2337, in generate_docstring_dictionary\n        with io.open(singular_info_file,\n    TypeError: expected str, bytes or os.PathLike object, not NoneType\n**********************************************************************\nFile \"src/sage/interfaces/singular.py\", line 2373, in sage.interfaces.singular.get_docstring\nFailed example:\n    'standard.lib' in get_docstring('groebner')\nException raised:\n    Traceback (most recent call last):\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 694, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.interfaces.singular.get_docstring[2]>\", line 1, in <module>\n        'standard.lib' in get_docstring('groebner')\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py\", line 2378, in get_docstring\n        generate_docstring_dictionary()\n      File \"/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py\", line 2337, in generate_docstring_dictionary\n        with io.open(singular_info_file,\n    TypeError: expected str, bytes or os.PathLike object, not NoneType\n**********************************************************************\n\nsage -t --random-seed=75077202530737540355693167266645487963 src/sage/libs/singular/singular.pyx\n**********************************************************************\nFile \"src/sage/libs/singular/singular.pyx\", line 1583, in sage.libs.singular.singular.get_resource\nFailed example:\n    get_resource('i')            # SINGULAR_INFO_FILE\nExpected:\n    '.../singular...'\nGot:\n    <BLANKLINE>\n**********************************************************************\n```\nand similar",
    "created_at": "2022-02-11T22:24:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653660",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:38'></a>
With `TARGETS_PRE=build-local tox -e docker-ubuntu-jammy-standard -- build ptest` I see the following failures:

```
sage -t --random-seed=75077202530737540355693167266645487963 src/sage/interfaces/singular.py
**********************************************************************
File "src/sage/interfaces/singular.py", line 2243, in sage.interfaces.singular.SingularFunction._instancedoc_
Failed example:
    'groebner' in singular.groebner.__doc__
Exception raised:
    Traceback (most recent call last):
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.singular.SingularFunction._instancedoc_[0]>", line 1, in <module>
        'groebner' in singular.groebner.__doc__
      File "sage/docs/instancedoc.pyx", line 211, in sage.docs.instancedoc.InstanceDocDescriptor.__get__ (build/cythonized/sage/docs/instancedoc.c:1878)
        return self.instancedoc(obj)
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py", line 2247, in _instancedoc_
        generate_docstring_dictionary()
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py", line 2337, in generate_docstring_dictionary
        with io.open(singular_info_file,
    TypeError: expected str, bytes or os.PathLike object, not NoneType
**********************************************************************
File "src/sage/interfaces/singular.py", line 2283, in sage.interfaces.singular.SingularFunctionElement._instancedoc_
Failed example:
    'matrix_expression' in A.nrows.__doc__
Exception raised:
    Traceback (most recent call last):
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.singular.SingularFunctionElement._instancedoc_[2]>", line 1, in <module>
        'matrix_expression' in A.nrows.__doc__
      File "sage/docs/instancedoc.pyx", line 211, in sage.docs.instancedoc.InstanceDocDescriptor.__get__ (build/cythonized/sage/docs/instancedoc.c:1878)
        return self.instancedoc(obj)
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py", line 2287, in _instancedoc_
        generate_docstring_dictionary()
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py", line 2337, in generate_docstring_dictionary
        with io.open(singular_info_file,
    TypeError: expected str, bytes or os.PathLike object, not NoneType
**********************************************************************
File "src/sage/interfaces/singular.py", line 2319, in sage.interfaces.singular.generate_docstring_dictionary
Failed example:
    generate_docstring_dictionary()
Exception raised:
    Traceback (most recent call last):
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.singular.generate_docstring_dictionary[1]>", line 1, in <module>
        generate_docstring_dictionary()
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py", line 2337, in generate_docstring_dictionary
        with io.open(singular_info_file,
    TypeError: expected str, bytes or os.PathLike object, not NoneType
**********************************************************************
File "src/sage/interfaces/singular.py", line 2371, in sage.interfaces.singular.get_docstring
Failed example:
    'groebner' in get_docstring('groebner')
Exception raised:
    Traceback (most recent call last):
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.singular.get_docstring[1]>", line 1, in <module>
        'groebner' in get_docstring('groebner')
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py", line 2378, in get_docstring
        generate_docstring_dictionary()
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py", line 2337, in generate_docstring_dictionary
        with io.open(singular_info_file,
    TypeError: expected str, bytes or os.PathLike object, not NoneType
**********************************************************************
File "src/sage/interfaces/singular.py", line 2373, in sage.interfaces.singular.get_docstring
Failed example:
    'standard.lib' in get_docstring('groebner')
Exception raised:
    Traceback (most recent call last):
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 694, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.singular.get_docstring[2]>", line 1, in <module>
        'standard.lib' in get_docstring('groebner')
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py", line 2378, in get_docstring
        generate_docstring_dictionary()
      File "/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/interfaces/singular.py", line 2337, in generate_docstring_dictionary
        with io.open(singular_info_file,
    TypeError: expected str, bytes or os.PathLike object, not NoneType
**********************************************************************

sage -t --random-seed=75077202530737540355693167266645487963 src/sage/libs/singular/singular.pyx
**********************************************************************
File "src/sage/libs/singular/singular.pyx", line 1583, in sage.libs.singular.singular.get_resource
Failed example:
    get_resource('i')            # SINGULAR_INFO_FILE
Expected:
    '.../singular...'
Got:
    <BLANKLINE>
**********************************************************************
```
and similar



---

archive/issue_comments_653661.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-02-11T22:24:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653661",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_653662.json:
```json
{
    "body": "<a id='comment:39'></a>\nthis appears to be fixed by \n\n```\nexport SINGULAR_INFO_FILE=/usr/share/doc/singular/singular.hlp\n```\nbefore starting Sage. After this, instead of\n\n```\nsage: from sage.libs.singular.singular import get_resource\nsage: get_resource('i')\n// ** Could not get 'InfoFile'.\n// ** Either set environment variable 'SINGULAR_INFO_FILE' to 'InfoFile',\n// ** or make sure that 'InfoFile' is at \"/usr/bin/../share/info/singular.hlp\"\n```\none gets, as it should be:\n\n```\nsage: from sage.libs.singular.singular import get_resource\nsage: get_resource('i')\n'/usr/share/doc/singular/singular.hlp'\n```\nThe latter needs `singular-doc` installed, so it must be added to\n`build/pkgs/singular/distros/debian.txt`.",
    "created_at": "2022-02-12T10:16:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653662",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:39'></a>
this appears to be fixed by 

```
export SINGULAR_INFO_FILE=/usr/share/doc/singular/singular.hlp
```
before starting Sage. After this, instead of

```
sage: from sage.libs.singular.singular import get_resource
sage: get_resource('i')
// ** Could not get 'InfoFile'.
// ** Either set environment variable 'SINGULAR_INFO_FILE' to 'InfoFile',
// ** or make sure that 'InfoFile' is at "/usr/bin/../share/info/singular.hlp"
```
one gets, as it should be:

```
sage: from sage.libs.singular.singular import get_resource
sage: get_resource('i')
'/usr/share/doc/singular/singular.hlp'
```
The latter needs `singular-doc` installed, so it must be added to
`build/pkgs/singular/distros/debian.txt`.



---

archive/issue_comments_653663.json:
```json
{
    "body": "Changing upstream from \"N/A\" to \"Reported upstream. No feedback yet.\"",
    "created_at": "2022-02-12T10:46:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653663",
    "user": "https://github.com/dimpase"
}
```

Changing upstream from "N/A" to "Reported upstream. No feedback yet."



---

archive/issue_comments_653664.json:
```json
{
    "body": "<a id='comment:41'></a>\nShould be fixed by\n\n```diff\n--- a/src/sage/libs/singular/singular.pyx\n+++ b/src/sage/libs/singular/singular.pyx\n@@ -1587,5 +1587,8 @@ def get_resource(id):\n     \"\"\"\n     cdef char *result = feGetResource(<char>ord(id))\n     if result == NULL:\n-        return None\n+        os.environ['SINGULAR_INFO_FILE']='/usr/share/doc/singular/singular.hlp'\n+        result = feGetResource(<char>ord(id))\n+        if result == NULL:\n+            return None\n     return bytes_to_str(result)\n```",
    "created_at": "2022-02-12T10:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653664",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:41'></a>
Should be fixed by

```diff
--- a/src/sage/libs/singular/singular.pyx
+++ b/src/sage/libs/singular/singular.pyx
@@ -1587,5 +1587,8 @@ def get_resource(id):
     """
     cdef char *result = feGetResource(<char>ord(id))
     if result == NULL:
-        return None
+        os.environ['SINGULAR_INFO_FILE']='/usr/share/doc/singular/singular.hlp'
+        result = feGetResource(<char>ord(id))
+        if result == NULL:
+            return None
     return bytes_to_str(result)
```



---

archive/issue_comments_653665.json:
```json
{
    "body": "Changing commit from \"de1640511311c3a455587701c49ecd550f0949c5\" to \"cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7\"",
    "created_at": "2022-02-12T11:00:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653665",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "de1640511311c3a455587701c49ecd550f0949c5" to "cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7"



---

archive/issue_comments_653666.json:
```json
{
    "body": "<a id='comment:42'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|\n|[cb82ed0](https://git.sagemath.org/sage.git/commit/?id=cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7)|`make singular.hlp known to Sage for Debian Singular`|",
    "created_at": "2022-02-12T11:00:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653666",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:42'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
|[cb82ed0](https://git.sagemath.org/sage.git/commit/?id=cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7)|`make singular.hlp known to Sage for Debian Singular`|



---

archive/issue_comments_653667.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-02-12T11:01:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653667",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_653668.json:
```json
{
    "body": "<a id='comment:44'></a>\nAll !Debian/Ubuntu Singular 4.2.1 packages are  broken, some of them do not install the needed .hlp file at all.",
    "created_at": "2022-02-12T16:08:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653668",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:44'></a>
All !Debian/Ubuntu Singular 4.2.1 packages are  broken, some of them do not install the needed .hlp file at all.



---

archive/issue_comments_653669.json:
```json
{
    "body": "Changing upstream from \"Reported upstream. No feedback yet.\" to \"Reported upstream. Developers acknowledge bug.\"",
    "created_at": "2022-02-12T16:08:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653669",
    "user": "https://github.com/dimpase"
}
```

Changing upstream from "Reported upstream. No feedback yet." to "Reported upstream. Developers acknowledge bug."



---

archive/issue_comments_653670.json:
```json
{
    "body": "<a id='comment:45'></a>\nReplying to [git](#comment%3A42):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                           |                                                     |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|\n> |[cb82ed0](https://git.sagemath.org/sage.git/commit/?id=cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7)|`make singular.hlp known to Sage for Debian Singular`|\n\n\nI don't think we should have this in our code",
    "created_at": "2022-02-12T16:51:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653670",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:45'></a>
Replying to [git](#comment%3A42):
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                           |                                                     |
> |-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
> |[cb82ed0](https://git.sagemath.org/sage.git/commit/?id=cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7)|`make singular.hlp known to Sage for Debian Singular`|


I don't think we should have this in our code



---

archive/issue_comments_653671.json:
```json
{
    "body": "<a id='comment:46'></a>\nProbably best to wait until there's a suitable version packaged",
    "created_at": "2022-02-12T16:52:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653671",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:46'></a>
Probably best to wait until there's a suitable version packaged



---

archive/issue_comments_653672.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2022-02-12T16:52:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653672",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_653673.json:
```json
{
    "body": "<a id='comment:47'></a>\nindeed, there are no packages that work for us atm.",
    "created_at": "2022-02-12T19:03:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653673",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:47'></a>
indeed, there are no packages that work for us atm.



---

archive/issue_comments_653674.json:
```json
{
    "body": "<a id='comment:48'></a>\nIt seems that actually something either goes wrong with dpkg in Ubuntu Jammy, or something is wrong in my Docker setup, but\ninstalling singular-doc Ubuntu package results in many (most) missing files.\nIn particular the crucial file \"singular.info\" is missing.",
    "created_at": "2022-02-12T23:00:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653674",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:48'></a>
It seems that actually something either goes wrong with dpkg in Ubuntu Jammy, or something is wrong in my Docker setup, but
installing singular-doc Ubuntu package results in many (most) missing files.
In particular the crucial file "singular.info" is missing.



---

archive/issue_comments_653675.json:
```json
{
    "body": "<a id='comment:50'></a>\nDisturbingly, while on my Jammy Docker installing singular-doc leads to missing files,\ninstalling the same package on another (\"real\") Ubuntu system works.\nSo this might be Docker-specific :-(",
    "created_at": "2022-02-12T23:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653675",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:50'></a>
Disturbingly, while on my Jammy Docker installing singular-doc leads to missing files,
installing the same package on another ("real") Ubuntu system works.
So this might be Docker-specific :-(



---

archive/issue_comments_653676.json:
```json
{
    "body": "<a id='comment:51'></a>\nYou can use `docker system prune --all` to get rid of bad stuff in the cache",
    "created_at": "2022-02-13T00:46:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653676",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:51'></a>
You can use `docker system prune --all` to get rid of bad stuff in the cache



---

archive/issue_comments_653677.json:
```json
{
    "body": "<a id='comment:52'></a>\ncache? No, it's worse, it's `dpkg -i` which does not do the job. \n\nIf I take the same .deb file, unpack it using `ar x` and manually install `data.tar.zst` using tar (one might have to install `zstd` first, to do un-compression), *all* the files from the package get installed.",
    "created_at": "2022-02-13T00:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653677",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:52'></a>
cache? No, it's worse, it's `dpkg -i` which does not do the job. 

If I take the same .deb file, unpack it using `ar x` and manually install `data.tar.zst` using tar (one might have to install `zstd` first, to do un-compression), *all* the files from the package get installed.



---

archive/issue_comments_653678.json:
```json
{
    "body": "<a id='comment:53'></a>\nFurther inspection shows that the problem is in the official !Ubuntu/Jammy Docker image. Both official Ubuntu's and Debian \n`singular-doc_4.2.1-p3+ds-1_all.deb` files exhibit the same error (apt used dpkg to install files .deb files, and the same error shows up if installation is done by `dpkg -i singular-doc_4.2.1-p3+ds-1_all.deb`).\n\nCould you check it's not only my Docker that plays up here? Steps to reproduce: \n\n* launch official Jammy image\n\n* get shell prompt there\n\n* run \n\n```\napt install singular-doc\ndpkg -V singular-doc\n```\n\nThe latter command should not output anything - but for me it outputs a log of missing files.\n\n\n\nIn !Debian/Bookworm image, which carries the same singular-doc version, everything is fine.\n\nPS. It would be good to check on a non-Docker installation of Jammy, too.",
    "created_at": "2022-02-13T08:45:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653678",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:53'></a>
Further inspection shows that the problem is in the official !Ubuntu/Jammy Docker image. Both official Ubuntu's and Debian 
`singular-doc_4.2.1-p3+ds-1_all.deb` files exhibit the same error (apt used dpkg to install files .deb files, and the same error shows up if installation is done by `dpkg -i singular-doc_4.2.1-p3+ds-1_all.deb`).

Could you check it's not only my Docker that plays up here? Steps to reproduce: 

* launch official Jammy image

* get shell prompt there

* run 

```
apt install singular-doc
dpkg -V singular-doc
```

The latter command should not output anything - but for me it outputs a log of missing files.



In !Debian/Bookworm image, which carries the same singular-doc version, everything is fine.

PS. It would be good to check on a non-Docker installation of Jammy, too.



---

archive/issue_comments_653679.json:
```json
{
    "body": "<a id='comment:54'></a>\nWe can go forward with this ticker (at least in Debian unstable it will be working) - but we will want a test to check that Singular docs work out of the box.\nOn a working system\n\n```\n# echo \"help;\" | Singular | grep error\n```\ndoes not return anything. On a broken one, one sees\n\n```\n# echo \"help;\" | Singular | grep error\n   ? No functioning help browser available.\n   ? error occurred in or before STDIN line 1: `help;`\n```",
    "created_at": "2022-02-13T08:49:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653679",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:54'></a>
We can go forward with this ticker (at least in Debian unstable it will be working) - but we will want a test to check that Singular docs work out of the box.
On a working system

```
# echo "help;" | Singular | grep error
```
does not return anything. On a broken one, one sees

```
# echo "help;" | Singular | grep error
   ? No functioning help browser available.
   ? error occurred in or before STDIN line 1: `help;`
```



---

archive/issue_comments_653680.json:
```json
{
    "body": "<a id='comment:55'></a>\nReplying to [mkoeppe](#comment%3A45):\n> Replying to [git](#comment%3A42):\n> > Branch pushed to git repo; I updated commit sha1. New commits:\n> > |                                                                                                                                           |                                                     |\n> > |-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|\n> > |[cb82ed0](https://git.sagemath.org/sage.git/commit/?id=cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7)|`make singular.hlp known to Sage for Debian Singular`|\n\n> \n> I don't think we should have this in our code\n\n\nindeed, I'll remove it.",
    "created_at": "2022-02-13T08:49:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653680",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:55'></a>
Replying to [mkoeppe](#comment%3A45):
> Replying to [git](#comment%3A42):
> > Branch pushed to git repo; I updated commit sha1. New commits:
> > |                                                                                                                                           |                                                     |
> > |-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
> > |[cb82ed0](https://git.sagemath.org/sage.git/commit/?id=cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7)|`make singular.hlp known to Sage for Debian Singular`|

> 
> I don't think we should have this in our code


indeed, I'll remove it.



---

archive/issue_comments_653681.json:
```json
{
    "body": "Changing commit from \"cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7\" to \"45f1b198b3e5ff000ef9627bfb89a71b4522eda2\"",
    "created_at": "2022-02-13T10:15:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653681",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "cb82ed03d722e8e1e1a8fb6e8a0320c28f8a3ea7" to "45f1b198b3e5ff000ef9627bfb89a71b4522eda2"



---

archive/issue_comments_653682.json:
```json
{
    "body": "<a id='comment:57'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n|[45f1b19](https://git.sagemath.org/sage.git/commit/?id=45f1b198b3e5ff000ef9627bfb89a71b4522eda2)|`make sure Singular help works`|",
    "created_at": "2022-02-13T10:15:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653682",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:57'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|[45f1b19](https://git.sagemath.org/sage.git/commit/?id=45f1b198b3e5ff000ef9627bfb89a71b4522eda2)|`make sure Singular help works`|



---

archive/issue_comments_653683.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2022-02-13T10:18:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653683",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_653684.json:
```json
{
    "body": "<a id='comment:58'></a>\nthis should pick up system Singular on Debian/bookworm and sid.\n(and reject broken one on Jammy)",
    "created_at": "2022-02-13T10:18:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653684",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:58'></a>
this should pick up system Singular on Debian/bookworm and sid.
(and reject broken one on Jammy)



---

archive/issue_comments_653685.json:
```json
{
    "body": "<a id='comment:59'></a>\nBy the way, I see the same Jammy failure with singular-doc in Podman running on Fedora, as I see with Docker on macOS.\nSo it really points at a faulty image. Or it's fault in OS itself, for this one needs a non-!Docker/Podman test.",
    "created_at": "2022-02-13T11:22:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653685",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:59'></a>
By the way, I see the same Jammy failure with singular-doc in Podman running on Fedora, as I see with Docker on macOS.
So it really points at a faulty image. Or it's fault in OS itself, for this one needs a non-!Docker/Podman test.



---

archive/issue_comments_653686.json:
```json
{
    "body": "<a id='comment:60'></a>\nEverything is fine in Jammy run in an lxc container, so that's really !Docker/Podman.\nI filed https://github.com/tianon/docker-brew-ubuntu-core/issues/230",
    "created_at": "2022-02-13T12:22:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653686",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:60'></a>
Everything is fine in Jammy run in an lxc container, so that's really !Docker/Podman.
I filed https://github.com/tianon/docker-brew-ubuntu-core/issues/230



---

archive/issue_comments_653687.json:
```json
{
    "body": "Changing upstream from \"Reported upstream. Developers acknowledge bug.\" to \"Reported upstream. No feedback yet.\"",
    "created_at": "2022-02-13T12:22:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653687",
    "user": "https://github.com/dimpase"
}
```

Changing upstream from "Reported upstream. Developers acknowledge bug." to "Reported upstream. No feedback yet."



---

archive/issue_comments_653688.json:
```json
{
    "body": "<a id='comment:61'></a>\nI'm told it's Jammy Ubuntu feature, not a bug, here:\nhttps://bugs.launchpad.net/ubuntu/+source/dpkg/+bug/1960749",
    "created_at": "2022-02-13T20:13:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653688",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:61'></a>
I'm told it's Jammy Ubuntu feature, not a bug, here:
https://bugs.launchpad.net/ubuntu/+source/dpkg/+bug/1960749



---

archive/issue_comments_653689.json:
```json
{
    "body": "<a id='comment:62'></a>\nBizarre, so this means we need to add a test for the availability of the info file to `spkg-configure.m4`.",
    "created_at": "2022-02-13T20:27:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653689",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:62'></a>
Bizarre, so this means we need to add a test for the availability of the info file to `spkg-configure.m4`.



---

archive/issue_comments_653690.json:
```json
{
    "body": "<a id='comment:63'></a>\nOh, I see you already did this in 45f1b19",
    "created_at": "2022-02-13T20:30:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653690",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:63'></a>
Oh, I see you already did this in 45f1b19



---

archive/issue_comments_653691.json:
```json
{
    "body": "<a id='comment:64'></a>\nhttps://askubuntu.com/questions/1173337/how-to-prevent-system-from-being-minimized",
    "created_at": "2022-02-13T20:33:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653691",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:64'></a>
https://askubuntu.com/questions/1173337/how-to-prevent-system-from-being-minimized



---

archive/issue_comments_653692.json:
```json
{
    "body": "<a id='comment:65'></a>\nWe can certainly add this step to `build/bin/write-dockerfile.sh` for Debian/Ubuntu",
    "created_at": "2022-02-13T20:35:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653692",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:65'></a>
We can certainly add this step to `build/bin/write-dockerfile.sh` for Debian/Ubuntu



---

archive/issue_comments_653693.json:
```json
{
    "body": "<a id='comment:66'></a>\nUsing their `unminimize` command, I see\n\n```\nReinstalling packages with system documentation in /usr/share/doc/ ..\ndpkg-query: error: --search needs at least one file name pattern argument\n\nUse --help for help about querying packages.\n```\nClearly commercial-grade work there",
    "created_at": "2022-02-13T20:46:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653693",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:66'></a>
Using their `unminimize` command, I see

```
Reinstalling packages with system documentation in /usr/share/doc/ ..
dpkg-query: error: --search needs at least one file name pattern argument

Use --help for help about querying packages.
```
Clearly commercial-grade work there



---

archive/issue_comments_653694.json:
```json
{
    "body": "Changing branch from \"u/dimpase/packages/singular/libpath_fix\" to \"u/mkoeppe/packages/singular/libpath_fix\"",
    "created_at": "2022-02-13T20:47:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653694",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "u/dimpase/packages/singular/libpath_fix" to "u/mkoeppe/packages/singular/libpath_fix"



---

archive/issue_comments_653695.json:
```json
{
    "body": "<a id='comment:68'></a>\nIt might be quicker just to remove the `exclude` policy - this won't trigger reinstallation of all the packages already there. \n\n---\nNew commits:\n|                                                                                                                                          |                                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|\n|[c0ceaf5](https://git.sagemath.org/sage.git/commit?id=c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2)|`build/bin/write-dockerfile.sh: Use unminimize`|",
    "created_at": "2022-02-13T21:13:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653695",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:68'></a>
It might be quicker just to remove the `exclude` policy - this won't trigger reinstallation of all the packages already there. 

---
New commits:
|                                                                                                                                          |                                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|
|[c0ceaf5](https://git.sagemath.org/sage.git/commit?id=c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2)|`build/bin/write-dockerfile.sh: Use unminimize`|



---

archive/issue_comments_653696.json:
```json
{
    "body": "Changing commit from \"45f1b198b3e5ff000ef9627bfb89a71b4522eda2\" to \"c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2\"",
    "created_at": "2022-02-13T21:13:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653696",
    "user": "https://github.com/dimpase"
}
```

Changing commit from "45f1b198b3e5ff000ef9627bfb89a71b4522eda2" to "c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2"



---

archive/issue_comments_653697.json:
```json
{
    "body": "<a id='comment:69'></a>\nFine with me, go ahead",
    "created_at": "2022-02-13T21:29:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653697",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:69'></a>
Fine with me, go ahead



---

archive/issue_comments_653698.json:
```json
{
    "body": "<a id='comment:70'></a>\nReplying to [mkoeppe](#comment%3A69):\n> Fine with me, go ahead\n\nYour branch is actually good (I was worried that images will get much bigger, but I haven't noticed this at all).\nWhat worries me is what happens if `unminimize` is not even present, wouldn't it trigger an error?",
    "created_at": "2022-02-14T10:49:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653698",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:70'></a>
Replying to [mkoeppe](#comment%3A69):
> Fine with me, go ahead

Your branch is actually good (I was worried that images will get much bigger, but I haven't noticed this at all).
What worries me is what happens if `unminimize` is not even present, wouldn't it trigger an error?



---

archive/issue_comments_653699.json:
```json
{
    "body": "<a id='comment:71'></a>\nOK, it's ignored if missing. No problem then.\nI actually tested this branch in a Ubuntu Jammy Docker, all good (with system Singular).",
    "created_at": "2022-02-14T10:59:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653699",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:71'></a>
OK, it's ignored if missing. No problem then.
I actually tested this branch in a Ubuntu Jammy Docker, all good (with system Singular).



---

archive/issue_comments_653700.json:
```json
{
    "body": "<a id='comment:72'></a>\nReplying to [mkoeppe](#comment%3A66):\n> Clearly commercial-grade work there\n\n\nI heard stories from a long-term Canonical insider, such as : \"Boss: We're closing down project X, you're fired. \nProgrammer: But, but, I'm also doing projects Y, Z, ...?! Boss: Uhm, OK. You can stay then.\"",
    "created_at": "2022-02-14T11:13:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653700",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:72'></a>
Replying to [mkoeppe](#comment%3A66):
> Clearly commercial-grade work there


I heard stories from a long-term Canonical insider, such as : "Boss: We're closing down project X, you're fired. 
Programmer: But, but, I'm also doing projects Y, Z, ...?! Boss: Uhm, OK. You can stay then."



---

archive/issue_comments_653701.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Matthias Koeppe\"",
    "created_at": "2022-02-14T22:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653701",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "" to "Matthias Koeppe"



---

archive/issue_comments_653702.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-02-14T22:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653702",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_653703.json:
```json
{
    "body": "<a id='comment:74'></a>\nThanks!",
    "created_at": "2022-02-15T07:51:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653703",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:74'></a>
Thanks!



---

archive/issue_comments_653704.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-02-20T13:27:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653704",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_653705.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/packages/singular/libpath_fix\" to \"c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2\"",
    "created_at": "2022-02-20T13:27:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32789#issuecomment-653705",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/packages/singular/libpath_fix" to "c0ceaf51d8ee6c7a55e60f6f9db2c92ca01245a2"



---

archive/issue_events_086755.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-02-20T13:27:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32789",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32789#event-86755"
}
```
