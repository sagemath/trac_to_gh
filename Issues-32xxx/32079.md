# Issue 32079: Provide early termination via *_found variable for AC_PATH_PROGS_FEATURE_CHECK

archive/issues_031842.json:
```json
{
    "body": "The spkg-configure.m4 files for\n\n- cmake, curl, gfan_version, giac, git, ninja, patch, tox, xz, yasm\n\nhave no termination for the loop through `PATH`.\n\nThis results in picking the last in `PATH`, rather than the first.\n\nSee [sage-devel post](https://groups.google.com/g/sage-devel/c/zkVEwaGPqNQ/m/8uGncM4YBwAJ).\n\nCC:  @mkoeppe @orlitzky @slel\n\nReviewer: Matthias Koeppe\n\nAuthor: Dima Pasechnik\n\nBranch: 0d3575e5249876dcbf49a67c32393e52ecc76473\n\nDependencies: #30668\n\nCommit: 0d3575e5249876dcbf49a67c32393e52ecc76473\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/32079\n\n",
    "closed_at": "2021-07-27T22:15:39Z",
    "created_at": "2021-06-28T22:54:38Z",
    "labels": [
        "component: build: configure",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Provide early termination via *_found variable for AC_PATH_PROGS_FEATURE_CHECK",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32079",
    "user": "https://github.com/dimpase"
}
```
The spkg-configure.m4 files for

- cmake, curl, gfan_version, giac, git, ninja, patch, tox, xz, yasm

have no termination for the loop through `PATH`.

This results in picking the last in `PATH`, rather than the first.

See [sage-devel post](https://groups.google.com/g/sage-devel/c/zkVEwaGPqNQ/m/8uGncM4YBwAJ).

CC:  @mkoeppe @orlitzky @slel

Reviewer: Matthias Koeppe

Author: Dima Pasechnik

Branch: 0d3575e5249876dcbf49a67c32393e52ecc76473

Dependencies: #30668

Commit: 0d3575e5249876dcbf49a67c32393e52ecc76473

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/32079





---

archive/issue_comments_454501.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-06-29T11:53:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32079#issuecomment-454501",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_454502.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2021-06-29T11:53:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32079#issuecomment-454502",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_454503.json:
```json
{
    "body": "<a id='comment:5'></a>\n```\n--- a/build/pkgs/curl/spkg-configure.m4\n+++ b/build/pkgs/curl/spkg-configure.m4\n@@ -4,6 +4,7 @@ SAGE_SPKG_CONFIGURE([curl], [\n     AC_CACHE_CHECK([for curl 7.22], [ac_cv_path_CURL], [\n         AC_PATH_PROGS_FEATURE_CHECK([CURL], [curl], [\n           ${ac_path_CURL}-config --checkfor 7.22 >/dev/null 2>/dev/null && ac_cv_path_CURL=${ac_path_CURL}\n+                    ac_path_CURL_found=:\n         ])\n```\n&& missing\n\nLikewise in `pkgs/git/spkg-configure.m4`, `pkgs/yasm/spkg-configure.m4`",
    "created_at": "2021-06-29T15:52:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32079#issuecomment-454503",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
```
--- a/build/pkgs/curl/spkg-configure.m4
+++ b/build/pkgs/curl/spkg-configure.m4
@@ -4,6 +4,7 @@ SAGE_SPKG_CONFIGURE([curl], [
     AC_CACHE_CHECK([for curl 7.22], [ac_cv_path_CURL], [
         AC_PATH_PROGS_FEATURE_CHECK([CURL], [curl], [
           ${ac_path_CURL}-config --checkfor 7.22 >/dev/null 2>/dev/null && ac_cv_path_CURL=${ac_path_CURL}
+                    ac_path_CURL_found=:
         ])
```
&& missing

Likewise in `pkgs/git/spkg-configure.m4`, `pkgs/yasm/spkg-configure.m4`



---

archive/issue_comments_454504.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-06-29T15:52:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32079#issuecomment-454504",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_454505.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-06-29T16:18:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32079#issuecomment-454505",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_454506.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-06-29T16:18:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32079#issuecomment-454506",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_454507.json:
```json
{
    "body": "<a id='comment:9'></a>OK, this looks fine.\n\nOf course, the ticket does not change the fact that most of our `AC_PATH_PROGS_FEATURE_CHECK`s are misleading because we do not use the resulting path variable. For example, `grep CMAKE config.status` reveals that we do not even pass on the information from the configure stage.",
    "created_at": "2021-06-29T16:35:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32079#issuecomment-454507",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>OK, this looks fine.

Of course, the ticket does not change the fact that most of our `AC_PATH_PROGS_FEATURE_CHECK`s are misleading because we do not use the resulting path variable. For example, `grep CMAKE config.status` reveals that we do not even pass on the information from the configure stage.



---

archive/issue_comments_454508.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-06-29T16:35:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32079#issuecomment-454508",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_454509.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-07-27T22:15:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32079",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32079#issuecomment-454509",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_084917.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-07-27T22:15:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32079",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32079#event-84917"
}
```
