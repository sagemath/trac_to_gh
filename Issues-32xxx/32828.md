# Issue 32828: pyzmq: Fix build errors; zeromq, pyzmq: Update; setuptools: upgrade to 59.2.0

archive/issues_032591.json:
```json
{
    "body": "`pyzmq` fails to build on some platforms. We fix it by \n- upgrading `setuptools` to a version that includes https://github.com/pypa/distutils/pull/65 \n- correcting the `pyzmq` build configuration\n\nWe also upgrade `pyzmq` and `zeromq` to the latest versions.\n\nFor example on `opensuse-tumbleweed-minimal` (https://github.com/mkoeppe/sage/runs/4085305194?check_suite_focus=true)\n\n```\nSetting up build directory for pyzmq-22.2.1\nFinished extraction\nNo patch files found in ../patches\n****************************************************\nHost system:\nLinux dd2167ea4425 5.11.0-1020-azure #21~20.04.1-Ubuntu SMP Mon Oct 11 18:54:28 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux\n****************************************************\nC compiler: gcc\nC compiler version:\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/lib64/gcc/x86_64-suse-linux/11/lto-wrapper\nOFFLOAD_TARGET_NAMES=nvptx-none:amdgcn-amdhsa\nOFFLOAD_TARGET_DEFAULT=1\nTarget: x86_64-suse-linux\nConfigured with: ../configure --prefix=/usr --infodir=/usr/share/info --mandir=/usr/share/man --libdir=/usr/lib64 --libexecdir=/usr/lib64 --enable-languages=c,c++,objc,fortran,obj-c++,ada,go,d,jit --enable-offload-targets=nvptx-none,amdgcn-amdhsa, --without-cuda-driver --enable-host-shared --enable-checking=release --disable-werror --with-gxx-include-dir=/usr/include/c++/11 --enable-ssp --disable-libssp --disable-libvtv --enable-cet=auto --disable-libcc1 --enable-plugin --with-bugurl=https://bugs.opensuse.org/ --with-pkgversion='SUSE Linux' --with-slibdir=/lib64 --with-system-zlib --enable-libstdcxx-allocator=new --disable-libstdcxx-pch --enable-libphobos --enable-version-specific-runtime-libs --with-gcc-major-version-only --enable-linker-build-id --enable-linux-futex --enable-gnu-indirect-function --program-suffix=-11 --without-system-libunwind --enable-multilib --with-arch-32=x86-64 --with-tune=generic --with-build-config=bootstrap-lto-lean --enable-link-mutex --build=x86_64-suse-linux --host=x86_64-suse-linux\nThread model: posix\nSupported LTO compression algorithms: zlib zstd\ngcc version 11.2.1 20210816 [revision 056e324ce46a7924b5cf10f61010cf9dd2ca10e9] (SUSE Linux) \n****************************************************\nPackage 'pyzmq' is currently not installed\nNo legacy uninstaller found for 'pyzmq'; nothing to do\nInstalling pyzmq-22.2.1\nProcessing /sage/local/var/lib/sage/venv-python3.9.7/var/tmp/sage/build/pyzmq-22.2.1/src\n    Preparing wheel metadata: started\n    Running command /sage/local/var/lib/sage/venv-python3.9.7/bin/python3 /sage/local/var/lib/sage/venv-python3.9.7/lib/python3.9/site-packages/pip/_vendor/pep517/in_process/_in_process.py prepare_metadata_for_build_wheel /tmp/tmpn08jd7qu\n    INFO: Disabling color, you really want to install colorlog.\n    Disabling color, you really want to install colorlog.\n    running dist_info\n    creating /tmp/pip-modern-metadata-oxt25qia/pyzmq.egg-info\n    writing /tmp/pip-modern-metadata-oxt25qia/pyzmq.egg-info/PKG-INFO\n    writing dependency_links to /tmp/pip-modern-metadata-oxt25qia/pyzmq.egg-info/dependency_links.txt\n    writing requirements to /tmp/pip-modern-metadata-oxt25qia/pyzmq.egg-info/requires.txt\n    writing top-level names to /tmp/pip-modern-metadata-oxt25qia/pyzmq.egg-info/top_level.txt\n    writing manifest file '/tmp/pip-modern-metadata-oxt25qia/pyzmq.egg-info/SOURCES.txt'\n    running configure\n    Settings obtained from pkg-config: {'library_dirs': [], 'include_dirs': [], 'libraries': ['zmq']}\n    {'libraries': ['zmq'], 'include_dirs': [], 'library_dirs': [], 'runtime_library_dirs': [], 'extra_link_args': []}\n    C compiler: gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -g -O2 -g -O2 -fPIC\n\n    compile options: '-c'\n    gcc: build/temp.linux-x86_64-3.9/scratch/check_sys_un.c\n    gcc build/temp.linux-x86_64-3.9/scratch/check_sys_un.o -o build/temp.linux-x86_64-3.9/scratch/check_sys_un\n    Configure: Autodetecting ZMQ settings...\n        Custom ZMQ dir:\n    Checking for timer_create\n    ** Errors about missing timer_create are a normal part of this process **\n    ************************************************\n    C compiler: gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -g -O2 -g -O2 -fPIC\n\n    creating build/temp.linux-x86_64-3.9/scratch/tmp\n    compile options: '-c'\n    gcc: /tmp/timer_create7kgvq7_0.c\n    /tmp/timer_create7kgvq7_0.c: In function 'main':\n    /tmp/timer_create7kgvq7_0.c:2:5: warning: implicit declaration of function 'timer_create' [-Wimplicit-function-declaration]\n        2 |     timer_create();\n          |     ^~~~~~~~~~~~\n    gcc build/temp.linux-x86_64-3.9/scratch/tmp/timer_create7kgvq7_0.o -o build/temp.linux-x86_64-3.9/scratch/a.out\n\n    error: [Errno 2] No such file or directory: 'a.out'\n    Failed with default libzmq, trying again with /usr/local\n    {'libraries': ['zmq'], 'include_dirs': ['/usr/local/include'], 'library_dirs': ['/usr/local/lib'], 'runtime_library_dirs': ['/usr/local/lib'], 'extra_link_args': []}\n    Configure: Autodetecting ZMQ settings...\n        Custom ZMQ dir:       /usr/local\n    Checking for timer_create\n    ** Errors about missing timer_create are a normal part of this process **\n    ************************************************\n    C compiler: gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -g -O2 -g -O2 -fPIC\n\n    compile options: '-c'\n    gcc: /tmp/timer_createl5aoyxgr.c\n    /tmp/timer_createl5aoyxgr.c: In function 'main':\n    /tmp/timer_createl5aoyxgr.c:2:5: warning: implicit declaration of function 'timer_create' [-Wimplicit-function-declaration]\n        2 |     timer_create();\n          |     ^~~~~~~~~~~~\n    Assembler messages:\n    Fatal error: can't create build/temp.linux-x86_64-3.9/scratch/tmp/timer_createl5aoyxgr.o: No such file or directory\n    ** The above error about timer_create is normal and not a problem! **\n    no timer_create, linking librt\n    C compiler: gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -g -O2 -g -O2 -fPIC\n\n    compile options: '-I/usr/local/include -Izmq/utils -c'\n    gcc: build/temp.linux-x86_64-3.9/scratch/vers.c\n    gcc build/temp.linux-x86_64-3.9/scratch/vers.o -L/usr/local/lib -Wl,--enable-new-dtags,-R/usr/local/lib -lzmq -lrt -o build/temp.linux-x86_64-3.9/scratch/vers\n    Error running version detection script:\n\n    build/temp.linux-x86_64-3.9/scratch/vers: error while loading shared libraries: libzmq.so.5: cannot open shared object file: No such file or directory\n\n\n    error: Error running version detection script:\n\n    build/temp.linux-x86_64-3.9/scratch/vers: error while loading shared libraries: libzmq.so.5: cannot open shared object file: No such file or directory\n\n\n    Warning: Couldn't find an acceptable libzmq on the system.\n\n    If you expected pyzmq to link against an installed libzmq, please check to make sure:\n\n        * You have a C compiler installed\n        * A development version of Python is installed (including headers)\n        * A development version of ZMQ >= 3.2 is installed (including headers)\n        * If ZMQ is not in a default location, supply the argument --zmq=<path>\n        * If you did recently install ZMQ to a default location,\n          try rebuilding the ld cache with `sudo ldconfig`\n          or specify zmq's location with `--zmq=/usr/local`\n\n    You can skip all this detection/waiting nonsense if you know\n    you want pyzmq to bundle libzmq as an extension by passing:\n\n        `--zmq=bundled`\n\n    I will now try to build libzmq as a Python extension\n    unless you interrupt me (^C) in the next 10 seconds...\n\n    ************************************************\n\n    10...\n     9...\n     8...\n     7...\n     6...\n     5...\n     4...\n     3...\n     2...\n     1...\n    Using bundled libzmq\n    already have bundled/zeromq\n    attempting ./configure to generate platform.hpp\n    Warning: failed to configure libzmq:\n    [Errno 2] No such file or directory: './configure'\n    staging platform.hpp from: /sage/local/var/lib/sage/venv-python3.9.7/var/tmp/sage/build/pyzmq-22.2.1/src/buildutils/include_linux\n    checking for timer_create\n```\n\nAlso reported in ticket:31855#comment:22\n\n\n**CC:**  @enriqueartal @jhpalmieri @dimpase\n\n**Branch:** [b430bcf4c46c4822a0b248db307565dd2c814119](https://github.com/sagemath/sagetrac-mirror/commit/b430bcf4c46c4822a0b248db307565dd2c814119)\n\n**Upstream:** Fixed upstream, in a later stable release.\n\n**Reviewer:** Dima Pasechnik\n\n**Author:** Matthias Koeppe\n\nIssue created by migration from https://trac.sagemath.org/ticket/32828\n\n",
    "closed_at": "2021-12-05T11:15:41Z",
    "created_at": "2021-11-05T17:09:37Z",
    "labels": [
        "component: packages: standard",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "pyzmq: Fix build errors; zeromq, pyzmq: Update; setuptools: upgrade to 59.2.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32828",
    "user": "https://github.com/mkoeppe"
}
```
`pyzmq` fails to build on some platforms. We fix it by 
- upgrading `setuptools` to a version that includes https://github.com/pypa/distutils/pull/65 
- correcting the `pyzmq` build configuration

We also upgrade `pyzmq` and `zeromq` to the latest versions.

For example on `opensuse-tumbleweed-minimal` (https://github.com/mkoeppe/sage/runs/4085305194?check_suite_focus=true)

```
Setting up build directory for pyzmq-22.2.1
Finished extraction
No patch files found in ../patches
****************************************************
Host system:
Linux dd2167ea4425 5.11.0-1020-azure #21~20.04.1-Ubuntu SMP Mon Oct 11 18:54:28 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib64/gcc/x86_64-suse-linux/11/lto-wrapper
OFFLOAD_TARGET_NAMES=nvptx-none:amdgcn-amdhsa
OFFLOAD_TARGET_DEFAULT=1
Target: x86_64-suse-linux
Configured with: ../configure --prefix=/usr --infodir=/usr/share/info --mandir=/usr/share/man --libdir=/usr/lib64 --libexecdir=/usr/lib64 --enable-languages=c,c++,objc,fortran,obj-c++,ada,go,d,jit --enable-offload-targets=nvptx-none,amdgcn-amdhsa, --without-cuda-driver --enable-host-shared --enable-checking=release --disable-werror --with-gxx-include-dir=/usr/include/c++/11 --enable-ssp --disable-libssp --disable-libvtv --enable-cet=auto --disable-libcc1 --enable-plugin --with-bugurl=https://bugs.opensuse.org/ --with-pkgversion='SUSE Linux' --with-slibdir=/lib64 --with-system-zlib --enable-libstdcxx-allocator=new --disable-libstdcxx-pch --enable-libphobos --enable-version-specific-runtime-libs --with-gcc-major-version-only --enable-linker-build-id --enable-linux-futex --enable-gnu-indirect-function --program-suffix=-11 --without-system-libunwind --enable-multilib --with-arch-32=x86-64 --with-tune=generic --with-build-config=bootstrap-lto-lean --enable-link-mutex --build=x86_64-suse-linux --host=x86_64-suse-linux
Thread model: posix
Supported LTO compression algorithms: zlib zstd
gcc version 11.2.1 20210816 [revision 056e324ce46a7924b5cf10f61010cf9dd2ca10e9] (SUSE Linux) 
****************************************************
Package 'pyzmq' is currently not installed
No legacy uninstaller found for 'pyzmq'; nothing to do
Installing pyzmq-22.2.1
Processing /sage/local/var/lib/sage/venv-python3.9.7/var/tmp/sage/build/pyzmq-22.2.1/src
    Preparing wheel metadata: started
    Running command /sage/local/var/lib/sage/venv-python3.9.7/bin/python3 /sage/local/var/lib/sage/venv-python3.9.7/lib/python3.9/site-packages/pip/_vendor/pep517/in_process/_in_process.py prepare_metadata_for_build_wheel /tmp/tmpn08jd7qu
    INFO: Disabling color, you really want to install colorlog.
    Disabling color, you really want to install colorlog.
    running dist_info
    creating /tmp/pip-modern-metadata-oxt25qia/pyzmq.egg-info
    writing /tmp/pip-modern-metadata-oxt25qia/pyzmq.egg-info/PKG-INFO
    writing dependency_links to /tmp/pip-modern-metadata-oxt25qia/pyzmq.egg-info/dependency_links.txt
    writing requirements to /tmp/pip-modern-metadata-oxt25qia/pyzmq.egg-info/requires.txt
    writing top-level names to /tmp/pip-modern-metadata-oxt25qia/pyzmq.egg-info/top_level.txt
    writing manifest file '/tmp/pip-modern-metadata-oxt25qia/pyzmq.egg-info/SOURCES.txt'
    running configure
    Settings obtained from pkg-config: {'library_dirs': [], 'include_dirs': [], 'libraries': ['zmq']}
    {'libraries': ['zmq'], 'include_dirs': [], 'library_dirs': [], 'runtime_library_dirs': [], 'extra_link_args': []}
    C compiler: gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -g -O2 -g -O2 -fPIC

    compile options: '-c'
    gcc: build/temp.linux-x86_64-3.9/scratch/check_sys_un.c
    gcc build/temp.linux-x86_64-3.9/scratch/check_sys_un.o -o build/temp.linux-x86_64-3.9/scratch/check_sys_un
    Configure: Autodetecting ZMQ settings...
        Custom ZMQ dir:
    Checking for timer_create
    ** Errors about missing timer_create are a normal part of this process **
    ************************************************
    C compiler: gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -g -O2 -g -O2 -fPIC

    creating build/temp.linux-x86_64-3.9/scratch/tmp
    compile options: '-c'
    gcc: /tmp/timer_create7kgvq7_0.c
    /tmp/timer_create7kgvq7_0.c: In function 'main':
    /tmp/timer_create7kgvq7_0.c:2:5: warning: implicit declaration of function 'timer_create' [-Wimplicit-function-declaration]
        2 |     timer_create();
          |     ^~~~~~~~~~~~
    gcc build/temp.linux-x86_64-3.9/scratch/tmp/timer_create7kgvq7_0.o -o build/temp.linux-x86_64-3.9/scratch/a.out

    error: [Errno 2] No such file or directory: 'a.out'
    Failed with default libzmq, trying again with /usr/local
    {'libraries': ['zmq'], 'include_dirs': ['/usr/local/include'], 'library_dirs': ['/usr/local/lib'], 'runtime_library_dirs': ['/usr/local/lib'], 'extra_link_args': []}
    Configure: Autodetecting ZMQ settings...
        Custom ZMQ dir:       /usr/local
    Checking for timer_create
    ** Errors about missing timer_create are a normal part of this process **
    ************************************************
    C compiler: gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -g -O2 -g -O2 -fPIC

    compile options: '-c'
    gcc: /tmp/timer_createl5aoyxgr.c
    /tmp/timer_createl5aoyxgr.c: In function 'main':
    /tmp/timer_createl5aoyxgr.c:2:5: warning: implicit declaration of function 'timer_create' [-Wimplicit-function-declaration]
        2 |     timer_create();
          |     ^~~~~~~~~~~~
    Assembler messages:
    Fatal error: can't create build/temp.linux-x86_64-3.9/scratch/tmp/timer_createl5aoyxgr.o: No such file or directory
    ** The above error about timer_create is normal and not a problem! **
    no timer_create, linking librt
    C compiler: gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -g -O2 -g -O2 -fPIC

    compile options: '-I/usr/local/include -Izmq/utils -c'
    gcc: build/temp.linux-x86_64-3.9/scratch/vers.c
    gcc build/temp.linux-x86_64-3.9/scratch/vers.o -L/usr/local/lib -Wl,--enable-new-dtags,-R/usr/local/lib -lzmq -lrt -o build/temp.linux-x86_64-3.9/scratch/vers
    Error running version detection script:

    build/temp.linux-x86_64-3.9/scratch/vers: error while loading shared libraries: libzmq.so.5: cannot open shared object file: No such file or directory


    error: Error running version detection script:

    build/temp.linux-x86_64-3.9/scratch/vers: error while loading shared libraries: libzmq.so.5: cannot open shared object file: No such file or directory


    Warning: Couldn't find an acceptable libzmq on the system.

    If you expected pyzmq to link against an installed libzmq, please check to make sure:

        * You have a C compiler installed
        * A development version of Python is installed (including headers)
        * A development version of ZMQ >= 3.2 is installed (including headers)
        * If ZMQ is not in a default location, supply the argument --zmq=<path>
        * If you did recently install ZMQ to a default location,
          try rebuilding the ld cache with `sudo ldconfig`
          or specify zmq's location with `--zmq=/usr/local`

    You can skip all this detection/waiting nonsense if you know
    you want pyzmq to bundle libzmq as an extension by passing:

        `--zmq=bundled`

    I will now try to build libzmq as a Python extension
    unless you interrupt me (^C) in the next 10 seconds...

    ************************************************

    10...
     9...
     8...
     7...
     6...
     5...
     4...
     3...
     2...
     1...
    Using bundled libzmq
    already have bundled/zeromq
    attempting ./configure to generate platform.hpp
    Warning: failed to configure libzmq:
    [Errno 2] No such file or directory: './configure'
    staging platform.hpp from: /sage/local/var/lib/sage/venv-python3.9.7/var/tmp/sage/build/pyzmq-22.2.1/src/buildutils/include_linux
    checking for timer_create
```

Also reported in ticket:31855#comment:22


**CC:**  @enriqueartal @jhpalmieri @dimpase

**Branch:** [b430bcf4c46c4822a0b248db307565dd2c814119](https://github.com/sagemath/sagetrac-mirror/commit/b430bcf4c46c4822a0b248db307565dd2c814119)

**Upstream:** Fixed upstream, in a later stable release.

**Reviewer:** Dima Pasechnik

**Author:** Matthias Koeppe

Issue created by migration from https://trac.sagemath.org/ticket/32828





---

archive/issue_comments_534176.json:
```json
{
    "body": "<a id='comment:3'></a>\n\n```\n    Configure: Autodetecting ZMQ settings...\n        Custom ZMQ dir:       /usr/local\n```\nweird.",
    "created_at": "2021-11-05T18:35:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534176",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>

```
    Configure: Autodetecting ZMQ settings...
        Custom ZMQ dir:       /usr/local
```
weird.



---

archive/issue_comments_534177.json:
```json
{
    "body": "<a id='comment:4'></a>\nI'd have tried updating zeromq to the latest version, 4.3.4.",
    "created_at": "2021-11-05T18:51:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534177",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>
I'd have tried updating zeromq to the latest version, 4.3.4.



---

archive/issue_comments_534178.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [dimpase](#comment%3A4):\n> I'd have tried updating zeromq to the latest version, 4.3.4.\n\nIt didn't work for me. I tried also to use pyzmq-22.3.0; it fails to download https://github.com/zeromq/libzmq/releases/download/v4.3.4/zeromq-4.3.4.zip and stops (downloading directly works)\n\nCompiling pyzmq outside Sage gives no error; maybe some local variable? Is is possible to use system package?",
    "created_at": "2021-11-05T19:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534178",
    "user": "https://github.com/enriqueartal"
}
```

<a id='comment:5'></a>
Replying to [dimpase](#comment%3A4):
> I'd have tried updating zeromq to the latest version, 4.3.4.

It didn't work for me. I tried also to use pyzmq-22.3.0; it fails to download https://github.com/zeromq/libzmq/releases/download/v4.3.4/zeromq-4.3.4.zip and stops (downloading directly works)

Compiling pyzmq outside Sage gives no error; maybe some local variable? Is is possible to use system package?



---

archive/issue_comments_534179.json:
```json
{
    "body": "<a id='comment:6'></a>\nI think the attempted configuration with `setup.cfg` does not work at all. This was masked so far by SAGE_VENV and SAGE_LOCAL being the same, which has changed.\n\nThis is another case where the locations discovered by the configure tests in `spkg-configure.m4` are not passed on",
    "created_at": "2021-11-05T19:40:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534179",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>
I think the attempted configuration with `setup.cfg` does not work at all. This was masked so far by SAGE_VENV and SAGE_LOCAL being the same, which has changed.

This is another case where the locations discovered by the configure tests in `spkg-configure.m4` are not passed on



---

archive/issue_comments_534180.json:
```json
{
    "body": "<a id='comment:7'></a>\nSorry, but the error happens in the minimal build, spkg-configure.m4 is not involved, right?",
    "created_at": "2021-11-05T20:02:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534180",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>
Sorry, but the error happens in the minimal build, spkg-configure.m4 is not involved, right?



---

archive/issue_comments_534181.json:
```json
{
    "body": "<a id='comment:8'></a>\nYou are right, it isn't; I should have written \"this is *also* another case...\"",
    "created_at": "2021-11-05T21:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534181",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
You are right, it isn't; I should have written "this is *also* another case..."



---

archive/issue_comments_534182.json:
```json
{
    "body": "<a id='comment:9'></a>\nIs there a temptative solution to test?\n\nReplying to [mkoeppe](#comment%3A6):\n> I think the attempted configuration with `setup.cfg` does not work at all. This was masked so far by SAGE_VENV and SAGE_LOCAL being the same, which has changed.\n> \n> This is another case where the locations discovered by the configure tests in `spkg-configure.m4` are not passed on\n",
    "created_at": "2021-11-05T21:15:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534182",
    "user": "https://github.com/enriqueartal"
}
```

<a id='comment:9'></a>
Is there a temptative solution to test?

Replying to [mkoeppe](#comment%3A6):
> I think the attempted configuration with `setup.cfg` does not work at all. This was masked so far by SAGE_VENV and SAGE_LOCAL being the same, which has changed.
> 
> This is another case where the locations discovered by the configure tests in `spkg-configure.m4` are not passed on




---

archive/issue_comments_534183.json:
```json
{
    "body": "<a id='comment:10'></a>\nDirty trick to test the other changes in Fedora 35:\n\n`sage -pip install pyzmq==22.0.3`\n\nand comment out the install line in `spkg-install.in`. In other installation I did the same thing with the last version of pyzmq. \n\nI am running tests now.",
    "created_at": "2021-11-06T09:02:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534183",
    "user": "https://github.com/enriqueartal"
}
```

<a id='comment:10'></a>
Dirty trick to test the other changes in Fedora 35:

`sage -pip install pyzmq==22.0.3`

and comment out the install line in `spkg-install.in`. In other installation I did the same thing with the last version of pyzmq. 

I am running tests now.



---

archive/issue_comments_534184.json:
```json
{
    "body": "<a id='comment:11'></a>\nI finished two compilations in Fedora 35, in both cases using a package of cysignals from https://github.com/enriqueartal/cysignals/commit/b404fbef69ddd5cfd0085ab15885e9f0315f9471 which is actually https://github.com/kliem/cysignals/tree/fix_non_constant_MINSIGSTKSZ up to a right parenthesis and installing pymzq as in [comment:10](#comment%3A10).\n\nOne compilation is for 9.4. The test gave the following failures:\n\n```\nsage -t --long --warn-long 212.7 --random-seed=0 src/sage/schemes/elliptic_curves/ell_rational_field.py  # 9 doctests failed\nsage -t --long --warn-long 212.7 --random-seed=0 src/sage/doctest/test.py  # 7 doctests failed\nsage -t --long --warn-long 212.7 --random-seed=0 src/sage/symbolic/integration/integral.py  # 1 doctest failed\nsage -t --long --warn-long 212.7 --random-seed=0 src/sage/rings/polynomial/polynomial_zmod_flint.pyx  # Timed out\nsage -t --long --warn-long 212.7 --random-seed=0 src/sage/tests/cmdline.py  # 2 doctests failed\nsage -t --long --warn-long 212.7 --random-seed=0 src/sage/modular/abvar/abvar.py  # 1 doctest failed\nsage -t --long --warn-long 212.7 --random-seed=0 src/sage/rings/polynomial/multi_polynomial_ideal.py  # 2 doctests failed\nsage -t --long --warn-long 212.7 --random-seed=0 src/sage/modular/hecke/submodule.py  # 1 doctest failed\nsage -t --long --warn-long 212.7 --random-seed=0 src/sage/lfunctions/sympow.py  # 13 doctests failed\nsage -t --long --warn-long 212.7 --random-seed=0 src/sage/schemes/elliptic_curves/lseries_ell.py  # 3 doctests failed\nsage -t --long --warn-long 212.7 --random-seed=0 src/sage/lfunctions/pari.py  # 1 doctest failed\nsage -t --long --warn-long 212.7 --random-seed=0 src/sage/libs/giac/__init__.py  # 13 doctests failed\nsage -t --long --warn-long 212.7 --random-seed=0 src/sage/lfunctions/lcalc.py  # 2 doctests failed\n```\nSome of them seem to be harmless (right permissions), other ones may reflect some problems between giac and cysignals.\n\nThe second one is for the branch #30766 merged with develop, with the above cysignals and pyzmq and also gmpy2-2.1.0rc1. Besides the errors below, I did not find jupyter in `$SAGE_ROOT/local/share` but in `$SAGE_ROOT/local/var/lib/sage/venv-python3.10/share`:\n\n```\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/schemes/elliptic_curves/ell_rational_field.py  # 9 doctests failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/rings/polynomial/polynomial_zmod_flint.pyx  # Timed out\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/schemes/elliptic_curves/isogeny_small_degree.py  # Timed out\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/rings/function_field/function_field.py  # Timed out\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/doctest/test.py  # 25 doctests failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/tests/cmdline.py  # 4 doctests failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/misc/sageinspect.py  # 1 doctest failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/dynamics/arithmetic_dynamics/projective_ds.py  # 1 doctest failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/schemes/riemann_surfaces/riemann_surface.py  # 1 doctest failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/modular/abvar/abvar.py  # 1 doctest failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/rings/polynomial/multi_polynomial_ideal.py  # 2 doctests failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/modular/hecke/submodule.py  # 1 doctest failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/lfunctions/sympow.py  # 13 doctests failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/schemes/elliptic_curves/lseries_ell.py  # 3 doctests failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/plot/colors.py  # 5 doctests failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage_docbuild/utils.py  # 2 doctests failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/lfunctions/pari.py  # 1 doctest failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/libs/giac/__init__.py  # 13 doctests failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/structure/unique_representation.py  # 1 doctest failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/lfunctions/lcalc.py  # 2 doctests failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/modular/modform/numerical.py  # 3 doctests failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/symbolic/callable.py  # 5 doctests failed\nsage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/cpython/atexit.pyx  # 6 doctests failed\n```",
    "created_at": "2021-11-06T22:19:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534184",
    "user": "https://github.com/enriqueartal"
}
```

<a id='comment:11'></a>
I finished two compilations in Fedora 35, in both cases using a package of cysignals from https://github.com/enriqueartal/cysignals/commit/b404fbef69ddd5cfd0085ab15885e9f0315f9471 which is actually https://github.com/kliem/cysignals/tree/fix_non_constant_MINSIGSTKSZ up to a right parenthesis and installing pymzq as in [comment:10](#comment%3A10).

One compilation is for 9.4. The test gave the following failures:

```
sage -t --long --warn-long 212.7 --random-seed=0 src/sage/schemes/elliptic_curves/ell_rational_field.py  # 9 doctests failed
sage -t --long --warn-long 212.7 --random-seed=0 src/sage/doctest/test.py  # 7 doctests failed
sage -t --long --warn-long 212.7 --random-seed=0 src/sage/symbolic/integration/integral.py  # 1 doctest failed
sage -t --long --warn-long 212.7 --random-seed=0 src/sage/rings/polynomial/polynomial_zmod_flint.pyx  # Timed out
sage -t --long --warn-long 212.7 --random-seed=0 src/sage/tests/cmdline.py  # 2 doctests failed
sage -t --long --warn-long 212.7 --random-seed=0 src/sage/modular/abvar/abvar.py  # 1 doctest failed
sage -t --long --warn-long 212.7 --random-seed=0 src/sage/rings/polynomial/multi_polynomial_ideal.py  # 2 doctests failed
sage -t --long --warn-long 212.7 --random-seed=0 src/sage/modular/hecke/submodule.py  # 1 doctest failed
sage -t --long --warn-long 212.7 --random-seed=0 src/sage/lfunctions/sympow.py  # 13 doctests failed
sage -t --long --warn-long 212.7 --random-seed=0 src/sage/schemes/elliptic_curves/lseries_ell.py  # 3 doctests failed
sage -t --long --warn-long 212.7 --random-seed=0 src/sage/lfunctions/pari.py  # 1 doctest failed
sage -t --long --warn-long 212.7 --random-seed=0 src/sage/libs/giac/__init__.py  # 13 doctests failed
sage -t --long --warn-long 212.7 --random-seed=0 src/sage/lfunctions/lcalc.py  # 2 doctests failed
```
Some of them seem to be harmless (right permissions), other ones may reflect some problems between giac and cysignals.

The second one is for the branch #30766 merged with develop, with the above cysignals and pyzmq and also gmpy2-2.1.0rc1. Besides the errors below, I did not find jupyter in `$SAGE_ROOT/local/share` but in `$SAGE_ROOT/local/var/lib/sage/venv-python3.10/share`:

```
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/schemes/elliptic_curves/ell_rational_field.py  # 9 doctests failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/rings/polynomial/polynomial_zmod_flint.pyx  # Timed out
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/schemes/elliptic_curves/isogeny_small_degree.py  # Timed out
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/rings/function_field/function_field.py  # Timed out
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/doctest/test.py  # 25 doctests failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/tests/cmdline.py  # 4 doctests failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/misc/sageinspect.py  # 1 doctest failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/dynamics/arithmetic_dynamics/projective_ds.py  # 1 doctest failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/schemes/riemann_surfaces/riemann_surface.py  # 1 doctest failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/modular/abvar/abvar.py  # 1 doctest failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/rings/polynomial/multi_polynomial_ideal.py  # 2 doctests failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/modular/hecke/submodule.py  # 1 doctest failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/lfunctions/sympow.py  # 13 doctests failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/schemes/elliptic_curves/lseries_ell.py  # 3 doctests failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/plot/colors.py  # 5 doctests failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage_docbuild/utils.py  # 2 doctests failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/lfunctions/pari.py  # 1 doctest failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/libs/giac/__init__.py  # 13 doctests failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/structure/unique_representation.py  # 1 doctest failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/lfunctions/lcalc.py  # 2 doctests failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/modular/modform/numerical.py  # 3 doctests failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/symbolic/callable.py  # 5 doctests failed
sage -t --long --random-seed=212072384500939741616547276375662149298 src/sage/cpython/atexit.pyx  # 6 doctests failed
```



---

archive/issue_comments_534185.json:
```json
{
    "body": "<a id='comment:12'></a>\nI think the above would be better to discuss in #30767.\nLet's please keep this ticket focused on the pyzmq build failures.",
    "created_at": "2021-11-06T22:22:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534185",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>
I think the above would be better to discuss in #30767.
Let's please keep this ticket focused on the pyzmq build failures.



---

archive/issue_comments_534186.json:
```json
{
    "body": "<a id='comment:13'></a>\nIt looks like `pyzmq` is incompatible with our use of `SETUPTOOLS_USE_DISTUTILS=local`.",
    "created_at": "2021-11-06T22:22:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534186",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>
It looks like `pyzmq` is incompatible with our use of `SETUPTOOLS_USE_DISTUTILS=local`.



---

archive/issue_comments_534187.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [mkoeppe](#comment%3A12):\n> I think the above would be better to discuss in #30767.\n> Let's please keep this ticket focused on the pyzmq build failures.\n\n\nOK, sorry for the noise (#32576 is also involved)",
    "created_at": "2021-11-06T22:56:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534187",
    "user": "https://github.com/enriqueartal"
}
```

<a id='comment:14'></a>
Replying to [mkoeppe](#comment%3A12):
> I think the above would be better to discuss in #30767.
> Let's please keep this ticket focused on the pyzmq build failures.


OK, sorry for the noise (#32576 is also involved)



---

archive/issue_comments_534188.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [mkoeppe](#comment%3A13):\n> It looks like `pyzmq` is incompatible with our use of `SETUPTOOLS_USE_DISTUTILS=local`.\n\n\nThe recent `setuptools` versions vendor a version of distutils that has a bug described in https://github.com/pypa/distutils/issues/64",
    "created_at": "2021-11-06T23:02:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534188",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>
Replying to [mkoeppe](#comment%3A13):
> It looks like `pyzmq` is incompatible with our use of `SETUPTOOLS_USE_DISTUTILS=local`.


The recent `setuptools` versions vendor a version of distutils that has a bug described in https://github.com/pypa/distutils/issues/64



---

archive/issue_comments_534189.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/pyzmq__build_errors](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/pyzmq__build_errors)",
    "created_at": "2021-11-07T01:57:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534189",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/pyzmq__build_errors](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/pyzmq__build_errors)



---

archive/issue_comments_534190.json:
```json
{
    "body": "**Commit:** [89e1dea356a04ee0f68def9823f9bee117a09057](https://github.com/sagemath/sagetrac-mirror/commit/89e1dea356a04ee0f68def9823f9bee117a09057)",
    "created_at": "2021-11-07T02:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534190",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [89e1dea356a04ee0f68def9823f9bee117a09057](https://github.com/sagemath/sagetrac-mirror/commit/89e1dea356a04ee0f68def9823f9bee117a09057)



---

archive/issue_comments_534191.json:
```json
{
    "body": "<a id='comment:17'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fb48e082f7b30942aeaa3b3fe6a3ba407ebc8e4d\">fb48e08</a></td><td><code>build/pkgs/pyzmq/spkg-install.in: Do not overwrite library_dirs, include_dirs here, instead use zmq_prefix</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/89e1dea356a04ee0f68def9823f9bee117a09057\">89e1dea</a></td><td><code>build/pkgs/setuptools: Instead of bumping the patch level, upgrade to 58.5.3</code></td></tr></table>\n",
    "created_at": "2021-11-07T02:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534191",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fb48e082f7b30942aeaa3b3fe6a3ba407ebc8e4d">fb48e08</a></td><td><code>build/pkgs/pyzmq/spkg-install.in: Do not overwrite library_dirs, include_dirs here, instead use zmq_prefix</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/89e1dea356a04ee0f68def9823f9bee117a09057">89e1dea</a></td><td><code>build/pkgs/setuptools: Instead of bumping the patch level, upgrade to 58.5.3</code></td></tr></table>




---

archive/issue_events_299308.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-11-07T02:11:30Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "rename": {
        "from": "pyzmq: Build errors",
        "to": "pyzmq: Fix build errors, upgrade and patch setuptools"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32828#event-299308"
}
```



---

archive/issue_events_299309.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-11-07T02:11:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32828#event-299309"
}
```



---

archive/issue_comments_534192.json:
```json
{
    "body": "**Author:** Matthias Koeppe",
    "created_at": "2021-11-07T02:11:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534192",
    "user": "https://github.com/mkoeppe"
}
```

**Author:** Matthias Koeppe



---

archive/issue_comments_534193.json:
```json
{
    "body": "<a id='comment:20'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/129d0fbd15736ebf8d547620f4a27e93ca431eb7\">129d0fb</a></td><td><code>build/pkgs/pyzmq/spkg-install.in: Fix up</code></td></tr></table>\n",
    "created_at": "2021-11-07T02:15:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534193",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/129d0fbd15736ebf8d547620f4a27e93ca431eb7">129d0fb</a></td><td><code>build/pkgs/pyzmq/spkg-install.in: Fix up</code></td></tr></table>




---

archive/issue_comments_534194.json:
```json
{
    "body": "**Changing commit** from \"[89e1dea356a04ee0f68def9823f9bee117a09057](https://github.com/sagemath/sagetrac-mirror/commit/89e1dea356a04ee0f68def9823f9bee117a09057)\" to \"[129d0fbd15736ebf8d547620f4a27e93ca431eb7](https://github.com/sagemath/sagetrac-mirror/commit/129d0fbd15736ebf8d547620f4a27e93ca431eb7)\".",
    "created_at": "2021-11-07T02:15:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534194",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[89e1dea356a04ee0f68def9823f9bee117a09057](https://github.com/sagemath/sagetrac-mirror/commit/89e1dea356a04ee0f68def9823f9bee117a09057)" to "[129d0fbd15736ebf8d547620f4a27e93ca431eb7](https://github.com/sagemath/sagetrac-mirror/commit/129d0fbd15736ebf8d547620f4a27e93ca431eb7)".



---

archive/issue_comments_534195.json:
```json
{
    "body": "**Changing commit** from \"[129d0fbd15736ebf8d547620f4a27e93ca431eb7](https://github.com/sagemath/sagetrac-mirror/commit/129d0fbd15736ebf8d547620f4a27e93ca431eb7)\" to \"[fc116124dfa4790bdd829f2b8518cf076adb4e49](https://github.com/sagemath/sagetrac-mirror/commit/fc116124dfa4790bdd829f2b8518cf076adb4e49)\".",
    "created_at": "2021-11-07T02:19:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534195",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[129d0fbd15736ebf8d547620f4a27e93ca431eb7](https://github.com/sagemath/sagetrac-mirror/commit/129d0fbd15736ebf8d547620f4a27e93ca431eb7)" to "[fc116124dfa4790bdd829f2b8518cf076adb4e49](https://github.com/sagemath/sagetrac-mirror/commit/fc116124dfa4790bdd829f2b8518cf076adb4e49)".



---

archive/issue_comments_534196.json:
```json
{
    "body": "<a id='comment:21'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2240cc157d1b17a087d42ea9010a920a80288de2\">2240cc1</a></td><td><code>build/pkgs/pyzmq: Update to 22.3.0</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc116124dfa4790bdd829f2b8518cf076adb4e49\">fc11612</a></td><td><code>build/pkgs/zeromq: Update to 4.3.4, add upstream_url</code></td></tr></table>\n",
    "created_at": "2021-11-07T02:19:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534196",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2240cc157d1b17a087d42ea9010a920a80288de2">2240cc1</a></td><td><code>build/pkgs/pyzmq: Update to 22.3.0</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc116124dfa4790bdd829f2b8518cf076adb4e49">fc11612</a></td><td><code>build/pkgs/zeromq: Update to 4.3.4, add upstream_url</code></td></tr></table>




---

archive/issue_events_299310.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-11-07T02:20:28Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "rename": {
        "from": "pyzmq: Fix build errors, upgrade and patch setuptools",
        "to": "pyzmq: Fix build errors; zeromq, pyzmq: Update; setuptools: upgrade to 58.5.3, add patch"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32828#event-299310"
}
```



---

archive/issue_comments_534197.json:
```json
{
    "body": "<a id='comment:23'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a8fe9da95f28efc4b3bf975a997ce6da05c928bf\">a8fe9da</a></td><td><code>build/pkgs/zeromq/patches/getrandom.patch: Remove</code></td></tr></table>\n",
    "created_at": "2021-11-07T02:26:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534197",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a8fe9da95f28efc4b3bf975a997ce6da05c928bf">a8fe9da</a></td><td><code>build/pkgs/zeromq/patches/getrandom.patch: Remove</code></td></tr></table>




---

archive/issue_comments_534198.json:
```json
{
    "body": "**Changing commit** from \"[fc116124dfa4790bdd829f2b8518cf076adb4e49](https://github.com/sagemath/sagetrac-mirror/commit/fc116124dfa4790bdd829f2b8518cf076adb4e49)\" to \"[a8fe9da95f28efc4b3bf975a997ce6da05c928bf](https://github.com/sagemath/sagetrac-mirror/commit/a8fe9da95f28efc4b3bf975a997ce6da05c928bf)\".",
    "created_at": "2021-11-07T02:26:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534198",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[fc116124dfa4790bdd829f2b8518cf076adb4e49](https://github.com/sagemath/sagetrac-mirror/commit/fc116124dfa4790bdd829f2b8518cf076adb4e49)" to "[a8fe9da95f28efc4b3bf975a997ce6da05c928bf](https://github.com/sagemath/sagetrac-mirror/commit/a8fe9da95f28efc4b3bf975a997ce6da05c928bf)".



---

archive/issue_comments_534199.json:
```json
{
    "body": "<a id='comment:24'></a>\nIn my case it worked with one more change; in `spkg-install.in` for `pyzmq`, replace `$SAGE_LOCAL` by `$SAGE_VENV` (I use python3.10).",
    "created_at": "2021-11-07T09:32:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534199",
    "user": "https://github.com/enriqueartal"
}
```

<a id='comment:24'></a>
In my case it worked with one more change; in `spkg-install.in` for `pyzmq`, replace `$SAGE_LOCAL` by `$SAGE_VENV` (I use python3.10).



---

archive/issue_comments_534200.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [enriqueartal](#comment%3A24):\n> In my case it worked with one more change; in `spkg-install.in` for `pyzmq`, replace `$SAGE_LOCAL` by `$SAGE_VENV` (I use python3.10).\n\n\nThis change doesn't make sense -- `zeromq` is not installed in `SAGE_VENV`.\nCan you show me the log of a failure without that change?",
    "created_at": "2021-11-07T16:54:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534200",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>
Replying to [enriqueartal](#comment%3A24):
> In my case it worked with one more change; in `spkg-install.in` for `pyzmq`, replace `$SAGE_LOCAL` by `$SAGE_VENV` (I use python3.10).


This change doesn't make sense -- `zeromq` is not installed in `SAGE_VENV`.
Can you show me the log of a failure without that change?



---

archive/issue_comments_534201.json:
```json
{
    "body": "<a id='comment:26'></a>\nDo you mean `zeromq` or `pyzmq`. FOR `zeromq` it used the system package. If it helps as I said in [comment:11](#comment%3A11) jupyter is located also in `$SAGE_VENV/share`.\n\nFind below the log\n\n```\nUsing cached file /usr/local/sage-310/upstream/pyzmq-22.3.0.tar.gz\npyzmq-22.3.0\n====================================================\nSetting up build directory for pyzmq-22.3.0\nFinished extraction\nNo patch files found in ../patches\n****************************************************\nHost system:\nLinux singular 5.14.16-301.fc35.x86_64 #1 SMP Wed Nov 3 13:55:42 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux\n****************************************************\nC compiler: gcc\nC compiler version:\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/libexec/gcc/x86_64-redhat-linux/11/lto-wrapper\nOFFLOAD_TARGET_NAMES=nvptx-none\nOFFLOAD_TARGET_DEFAULT=1\nTarget: x86_64-redhat-linux\nConfigured with: ../configure --enable-bootstrap --enable-languages=c,c++,fortran,objc,obj-c++,ada,go,d,lto --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-shared --enable-threads=posix --enable-checking=release --enable-multilib --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --with-gcc-major-version-only --with-linker-hash-style=gnu --enable-plugin --enable-initfini-array --with-isl=/builddir/build/BUILD/gcc-11.2.1-20210728/obj-x86_64-redhat-linux/isl-install --enable-offload-targets=nvptx-none --without-cuda-driver --enable-gnu-indirect-function --enable-cet --with-tune=generic --with-arch_32=i686 --build=x86_64-redhat-linux --with-build-config=bootstrap-lto --enable-link-serialization=1\nThread model: posix\nSupported LTO compression algorithms: zlib zstd\ngcc version 11.2.1 20210728 (Red Hat 11.2.1-1) (GCC) \n****************************************************\nPackage 'pyzmq' is currently not installed\nNo legacy uninstaller found for 'pyzmq'; nothing to do\nInstalling pyzmq-22.3.0\nProcessing /usr/local/sage-310/local/var/lib/sage/venv-python3.10/var/tmp/sage/build/pyzmq-22.3.0/src\n    Preparing wheel metadata: started\n    Running command /usr/local/sage-310/local/var/lib/sage/venv-python3.10/bin/python3 /usr/local/sage-310/local/var/lib/sage/venv-python3.10/lib64/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py prepare_metadata_for_build_wheel /tmp/tmpy23ywl50\n    running dist_info\n    creating /tmp/pip-modern-metadata-2ffuf65k/pyzmq.egg-info\n    writing /tmp/pip-modern-metadata-2ffuf65k/pyzmq.egg-info/PKG-INFO\n    writing dependency_links to /tmp/pip-modern-metadata-2ffuf65k/pyzmq.egg-info/dependency_links.txt\n    writing requirements to /tmp/pip-modern-metadata-2ffuf65k/pyzmq.egg-info/requires.txt\n    writing top-level names to /tmp/pip-modern-metadata-2ffuf65k/pyzmq.egg-info/top_level.txt\n    writing manifest file '/tmp/pip-modern-metadata-2ffuf65k/pyzmq.egg-info/SOURCES.txt'\n    running configure\n    {'libraries': ['zmq'], 'include_dirs': ['/usr/local/sage-310/local/include'], 'library_dirs': ['/usr/local/sage-310/local/lib'], 'runtime_library_dirs': ['/usr/local/sage-310/local/lib'], 'extra_link_args': []}\n    gcc -Wno-unused-result -Wsign-compare -DDYNAMIC_ANNOTATIONS_ENABLED=1 -DNDEBUG -O2 -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -g -O2 -fPIC -I/usr/local/sage-310/local/include -c build/temp.linux-x86_64-3.10/scratch/check_sys_un.c -o build/temp.linux-x86_64-3.10/scratch/check_sys_un.o\n    gcc build/temp.linux-x86_64-3.10/scratch/check_sys_un.o -L/usr/local/sage-310/local/lib -Wl,--enable-new-dtags,-R/usr/local/sage-310/local/lib -o build/temp.linux-x86_64-3.10/scratch/check_sys_un\n    Configure: Autodetecting ZMQ settings...\n        Custom ZMQ dir:       /usr/local/sage-310/local\n    Checking for timer_create\n    ** Errors about missing timer_create are a normal part of this process **\n    ************************************************\n    creating build/temp.linux-x86_64-3.10/scratch/tmp\n    gcc -Wno-unused-result -Wsign-compare -DDYNAMIC_ANNOTATIONS_ENABLED=1 -DNDEBUG -O2 -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -g -O2 -fPIC -c /tmp/timer_createhby4x8bf.c -o build/temp.linux-x86_64-3.10/scratch/tmp/timer_createhby4x8bf.o\n    /tmp/timer_createhby4x8bf.c: In function 'main':\n    /tmp/timer_createhby4x8bf.c:2:5: warning: implicit declaration of function 'timer_create' [-Wimplicit-function-declaration]\n        2 |     timer_create();\n          |     ^~~~~~~~~~~~\n    gcc build/temp.linux-x86_64-3.10/scratch/tmp/timer_createhby4x8bf.o -o build/temp.linux-x86_64-3.10/scratch/a.out\n\n    error: [Errno 2] No such file or directory: 'a.out'\n\n    Fatal: Falling back on bundled libzmq, but config has explicitly prohibited building the libzmq extension.\n    Preparing wheel metadata: finished with status 'error'\nWARNING: Discarding file:///usr/local/sage-310/local/var/lib/sage/venv-python3.10/var/tmp/sage/build/pyzmq-22.3.0/src. Command errored out with exit status 1: /usr/local/sage-310/local/var/lib/sage/venv-python3.10/bin/python3 /usr/local/sage-310/local/var/lib/sage/venv-python3.10/lib64/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py prepare_metadata_for_build_wheel /tmp/tmpy23ywl50 Check the logs for full command output.\nERROR: Command errored out with exit status 1: /usr/local/sage-310/local/var/lib/sage/venv-python3.10/bin/python3 /usr/local/sage-310/local/var/lib/sage/venv-python3.10/lib64/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py prepare_metadata_for_build_wheel /tmp/tmpy23ywl50 Check the logs for full command output.\n********************************************************************************************************************************************************************************************************************************************\nError building a wheel for pyzmq-22.3.0\n********************************************************************************************************************************************************************************************************************************************\n\nreal\t0m0.831s\nuser\t0m0.755s\nsys\t0m0.085s\n************************************************************************\nError installing package pyzmq-22.3.0\n```",
    "created_at": "2021-11-07T20:19:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534201",
    "user": "https://github.com/enriqueartal"
}
```

<a id='comment:26'></a>
Do you mean `zeromq` or `pyzmq`. FOR `zeromq` it used the system package. If it helps as I said in [comment:11](#comment%3A11) jupyter is located also in `$SAGE_VENV/share`.

Find below the log

```
Using cached file /usr/local/sage-310/upstream/pyzmq-22.3.0.tar.gz
pyzmq-22.3.0
====================================================
Setting up build directory for pyzmq-22.3.0
Finished extraction
No patch files found in ../patches
****************************************************
Host system:
Linux singular 5.14.16-301.fc35.x86_64 #1 SMP Wed Nov 3 13:55:42 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/libexec/gcc/x86_64-redhat-linux/11/lto-wrapper
OFFLOAD_TARGET_NAMES=nvptx-none
OFFLOAD_TARGET_DEFAULT=1
Target: x86_64-redhat-linux
Configured with: ../configure --enable-bootstrap --enable-languages=c,c++,fortran,objc,obj-c++,ada,go,d,lto --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-shared --enable-threads=posix --enable-checking=release --enable-multilib --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --with-gcc-major-version-only --with-linker-hash-style=gnu --enable-plugin --enable-initfini-array --with-isl=/builddir/build/BUILD/gcc-11.2.1-20210728/obj-x86_64-redhat-linux/isl-install --enable-offload-targets=nvptx-none --without-cuda-driver --enable-gnu-indirect-function --enable-cet --with-tune=generic --with-arch_32=i686 --build=x86_64-redhat-linux --with-build-config=bootstrap-lto --enable-link-serialization=1
Thread model: posix
Supported LTO compression algorithms: zlib zstd
gcc version 11.2.1 20210728 (Red Hat 11.2.1-1) (GCC) 
****************************************************
Package 'pyzmq' is currently not installed
No legacy uninstaller found for 'pyzmq'; nothing to do
Installing pyzmq-22.3.0
Processing /usr/local/sage-310/local/var/lib/sage/venv-python3.10/var/tmp/sage/build/pyzmq-22.3.0/src
    Preparing wheel metadata: started
    Running command /usr/local/sage-310/local/var/lib/sage/venv-python3.10/bin/python3 /usr/local/sage-310/local/var/lib/sage/venv-python3.10/lib64/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py prepare_metadata_for_build_wheel /tmp/tmpy23ywl50
    running dist_info
    creating /tmp/pip-modern-metadata-2ffuf65k/pyzmq.egg-info
    writing /tmp/pip-modern-metadata-2ffuf65k/pyzmq.egg-info/PKG-INFO
    writing dependency_links to /tmp/pip-modern-metadata-2ffuf65k/pyzmq.egg-info/dependency_links.txt
    writing requirements to /tmp/pip-modern-metadata-2ffuf65k/pyzmq.egg-info/requires.txt
    writing top-level names to /tmp/pip-modern-metadata-2ffuf65k/pyzmq.egg-info/top_level.txt
    writing manifest file '/tmp/pip-modern-metadata-2ffuf65k/pyzmq.egg-info/SOURCES.txt'
    running configure
    {'libraries': ['zmq'], 'include_dirs': ['/usr/local/sage-310/local/include'], 'library_dirs': ['/usr/local/sage-310/local/lib'], 'runtime_library_dirs': ['/usr/local/sage-310/local/lib'], 'extra_link_args': []}
    gcc -Wno-unused-result -Wsign-compare -DDYNAMIC_ANNOTATIONS_ENABLED=1 -DNDEBUG -O2 -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -g -O2 -fPIC -I/usr/local/sage-310/local/include -c build/temp.linux-x86_64-3.10/scratch/check_sys_un.c -o build/temp.linux-x86_64-3.10/scratch/check_sys_un.o
    gcc build/temp.linux-x86_64-3.10/scratch/check_sys_un.o -L/usr/local/sage-310/local/lib -Wl,--enable-new-dtags,-R/usr/local/sage-310/local/lib -o build/temp.linux-x86_64-3.10/scratch/check_sys_un
    Configure: Autodetecting ZMQ settings...
        Custom ZMQ dir:       /usr/local/sage-310/local
    Checking for timer_create
    ** Errors about missing timer_create are a normal part of this process **
    ************************************************
    creating build/temp.linux-x86_64-3.10/scratch/tmp
    gcc -Wno-unused-result -Wsign-compare -DDYNAMIC_ANNOTATIONS_ENABLED=1 -DNDEBUG -O2 -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -O2 -fexceptions -g -grecord-gcc-switches -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -Wp,-D_GLIBCXX_ASSERTIONS -fstack-protector-strong -m64 -mtune=generic -fasynchronous-unwind-tables -fstack-clash-protection -fcf-protection -D_GNU_SOURCE -fPIC -fwrapv -g -O2 -fPIC -c /tmp/timer_createhby4x8bf.c -o build/temp.linux-x86_64-3.10/scratch/tmp/timer_createhby4x8bf.o
    /tmp/timer_createhby4x8bf.c: In function 'main':
    /tmp/timer_createhby4x8bf.c:2:5: warning: implicit declaration of function 'timer_create' [-Wimplicit-function-declaration]
        2 |     timer_create();
          |     ^~~~~~~~~~~~
    gcc build/temp.linux-x86_64-3.10/scratch/tmp/timer_createhby4x8bf.o -o build/temp.linux-x86_64-3.10/scratch/a.out

    error: [Errno 2] No such file or directory: 'a.out'

    Fatal: Falling back on bundled libzmq, but config has explicitly prohibited building the libzmq extension.
    Preparing wheel metadata: finished with status 'error'
WARNING: Discarding file:///usr/local/sage-310/local/var/lib/sage/venv-python3.10/var/tmp/sage/build/pyzmq-22.3.0/src. Command errored out with exit status 1: /usr/local/sage-310/local/var/lib/sage/venv-python3.10/bin/python3 /usr/local/sage-310/local/var/lib/sage/venv-python3.10/lib64/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py prepare_metadata_for_build_wheel /tmp/tmpy23ywl50 Check the logs for full command output.
ERROR: Command errored out with exit status 1: /usr/local/sage-310/local/var/lib/sage/venv-python3.10/bin/python3 /usr/local/sage-310/local/var/lib/sage/venv-python3.10/lib64/python3.10/site-packages/pip/_vendor/pep517/in_process/_in_process.py prepare_metadata_for_build_wheel /tmp/tmpy23ywl50 Check the logs for full command output.
********************************************************************************************************************************************************************************************************************************************
Error building a wheel for pyzmq-22.3.0
********************************************************************************************************************************************************************************************************************************************

real	0m0.831s
user	0m0.755s
sys	0m0.085s
************************************************************************
Error installing package pyzmq-22.3.0
```



---

archive/issue_comments_534202.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [enriqueartal](#comment%3A26):\n> Do you mean `zeromq` or `pyzmq`. FOR `zeromq` it used the system package.\n\n\nThe configuration of `pyzmq` arranges for the `zeromq` installation to be found.\nWhen `zeromq` is not available as a system package, it is installed in `SAGE_LOCAL`, hence this line of the configuration.",
    "created_at": "2021-11-07T20:39:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534202",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>
Replying to [enriqueartal](#comment%3A26):
> Do you mean `zeromq` or `pyzmq`. FOR `zeromq` it used the system package.


The configuration of `pyzmq` arranges for the `zeromq` installation to be found.
When `zeromq` is not available as a system package, it is installed in `SAGE_LOCAL`, hence this line of the configuration.



---

archive/issue_comments_534203.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [enriqueartal](#comment%3A26):\n> Find below the log\n> \n> ```\n> ...\n>     /tmp/timer_createhby4x8bf.c:2:5: warning: implicit declaration of function 'timer_create' [-Wimplicit-function-declaration]\n>         2 |     timer_create();\n>           |     ^~~~~~~~~~~~\n>     gcc build/temp.linux-x86_64-3.10/scratch/tmp/timer_createhby4x8bf.o -o build/temp.linux-x86_64-3.10/scratch/a.out\n> \n>     error: [Errno 2] No such file or directory: 'a.out'\n> \n> ```\n\n\nThis is the bug that I fixed in `setuptools` here on the ticket -- are you sure this got installed?",
    "created_at": "2021-11-07T20:41:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534203",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:28'></a>
Replying to [enriqueartal](#comment%3A26):
> Find below the log
> 
> ```
> ...
>     /tmp/timer_createhby4x8bf.c:2:5: warning: implicit declaration of function 'timer_create' [-Wimplicit-function-declaration]
>         2 |     timer_create();
>           |     ^~~~~~~~~~~~
>     gcc build/temp.linux-x86_64-3.10/scratch/tmp/timer_createhby4x8bf.o -o build/temp.linux-x86_64-3.10/scratch/a.out
> 
>     error: [Errno 2] No such file or directory: 'a.out'
> 
> ```


This is the bug that I fixed in `setuptools` here on the ticket -- are you sure this got installed?



---

archive/issue_comments_534204.json:
```json
{
    "body": "<a id='comment:29'></a>\nI made a clean install (including cffi) and modifying cysignals, and it works the compilation, I am testing now. Sorry for the noise.",
    "created_at": "2021-11-08T12:41:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534204",
    "user": "https://github.com/enriqueartal"
}
```

<a id='comment:29'></a>
I made a clean install (including cffi) and modifying cysignals, and it works the compilation, I am testing now. Sorry for the noise.



---

archive/issue_comments_534205.json:
```json
{
    "body": "<a id='comment:30'></a>\nThese are the non successful tests:\n\n```\nsage -t --random-seed=271923535750116010797008611844103265449 src/sage/cpython/atexit.pyx  # 6 doctests failed\nsage -t --random-seed=271923535750116010797008611844103265449 src/sage/lfunctions/lcalc.py  # 2 doctests failed\nsage -t --random-seed=271923535750116010797008611844103265449 src/sage/lfunctions/pari.py  # 1 doctest failed\nsage -t --random-seed=271923535750116010797008611844103265449 src/sage/libs/giac/__init__.py  # 7 doctests failed\nsage -t --random-seed=271923535750116010797008611844103265449 src/sage/misc/sageinspect.py  # 1 doctest failed\nsage -t --random-seed=271923535750116010797008611844103265449 src/sage/plot/colors.py  # 5 doctests failed\nsage -t --random-seed=271923535750116010797008611844103265449 src/sage/rings/padics/padic_extension_leaves.py  # Timed out\nsage -t --random-seed=271923535750116010797008611844103265449 src/sage/schemes/elliptic_curves/BSD.py  # 3 doctests failed\nsage -t --random-seed=271923535750116010797008611844103265449 src/sage/schemes/elliptic_curves/lseries_ell.py  # 2 doctests failed\nsage -t --random-seed=271923535750116010797008611844103265449 src/sage/schemes/riemann_surfaces/riemann_surface.py  # 1 doctest failed\nsage -t --random-seed=271923535750116010797008611844103265449 src/sage/structure/unique_representation.py  # 1 doctest failed\nsage -t --random-seed=271923535750116010797008611844103265449 src/sage/symbolic/callable.py  # 5 doctests failed\nsage -t --random-seed=271923535750116010797008611844103265449 src/sage/tests/cmdline.py  # 7 doctests failed\nsage -t --random-seed=271923535750116010797008611844103265449 src/sage_docbuild/utils.py  # 2 doctests failed\n```\nThis is the result with Python3-3.10 package (with system package there were plenty of segmentation faults, also with the package and testpy installed). I hope it helps.",
    "created_at": "2021-11-08T19:59:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534205",
    "user": "https://github.com/enriqueartal"
}
```

<a id='comment:30'></a>
These are the non successful tests:

```
sage -t --random-seed=271923535750116010797008611844103265449 src/sage/cpython/atexit.pyx  # 6 doctests failed
sage -t --random-seed=271923535750116010797008611844103265449 src/sage/lfunctions/lcalc.py  # 2 doctests failed
sage -t --random-seed=271923535750116010797008611844103265449 src/sage/lfunctions/pari.py  # 1 doctest failed
sage -t --random-seed=271923535750116010797008611844103265449 src/sage/libs/giac/__init__.py  # 7 doctests failed
sage -t --random-seed=271923535750116010797008611844103265449 src/sage/misc/sageinspect.py  # 1 doctest failed
sage -t --random-seed=271923535750116010797008611844103265449 src/sage/plot/colors.py  # 5 doctests failed
sage -t --random-seed=271923535750116010797008611844103265449 src/sage/rings/padics/padic_extension_leaves.py  # Timed out
sage -t --random-seed=271923535750116010797008611844103265449 src/sage/schemes/elliptic_curves/BSD.py  # 3 doctests failed
sage -t --random-seed=271923535750116010797008611844103265449 src/sage/schemes/elliptic_curves/lseries_ell.py  # 2 doctests failed
sage -t --random-seed=271923535750116010797008611844103265449 src/sage/schemes/riemann_surfaces/riemann_surface.py  # 1 doctest failed
sage -t --random-seed=271923535750116010797008611844103265449 src/sage/structure/unique_representation.py  # 1 doctest failed
sage -t --random-seed=271923535750116010797008611844103265449 src/sage/symbolic/callable.py  # 5 doctests failed
sage -t --random-seed=271923535750116010797008611844103265449 src/sage/tests/cmdline.py  # 7 doctests failed
sage -t --random-seed=271923535750116010797008611844103265449 src/sage_docbuild/utils.py  # 2 doctests failed
```
This is the result with Python3-3.10 package (with system package there were plenty of segmentation faults, also with the package and testpy installed). I hope it helps.



---

archive/issue_comments_534206.json:
```json
{
    "body": "<a id='comment:31'></a>\nThanks for testing. So for this ticket - installation was successful. The test failures are surely unrelated to setuptools and pyzmq.\n\nLet's get this fix in then.",
    "created_at": "2021-11-08T20:19:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534206",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'></a>
Thanks for testing. So for this ticket - installation was successful. The test failures are surely unrelated to setuptools and pyzmq.

Let's get this fix in then.



---

archive/issue_comments_534207.json:
```json
{
    "body": "**Changing upstream** from \"N/A\" to \"Fixed upstream, but not in a stable release.\".",
    "created_at": "2021-11-09T23:57:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534207",
    "user": "https://github.com/mkoeppe"
}
```

**Changing upstream** from "N/A" to "Fixed upstream, but not in a stable release.".



---

archive/issue_comments_534208.json:
```json
{
    "body": "<a id='comment:32'></a>\nhttps://github.com/pypa/distutils/pull/65 has been merged",
    "created_at": "2021-11-09T23:57:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534208",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:32'></a>
https://github.com/pypa/distutils/pull/65 has been merged



---

archive/issue_comments_534209.json:
```json
{
    "body": "<a id='comment:33'></a>\n... and is included in https://setuptools.pypa.io/en/latest/history.html#v59-0-0 (not yet on PyPI)",
    "created_at": "2021-11-13T18:11:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534209",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'></a>
... and is included in https://setuptools.pypa.io/en/latest/history.html#v59-0-0 (not yet on PyPI)



---

archive/issue_comments_534210.json:
```json
{
    "body": "<a id='comment:34'></a>\nsetuptools 59.0.1 is out, but it looks like we should wait for 59.1.0 so that we can avoid the `setup_requires` deprecation done in 58.3.0 and reverted in 59.1.0",
    "created_at": "2021-11-15T00:26:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534210",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:34'></a>
setuptools 59.0.1 is out, but it looks like we should wait for 59.1.0 so that we can avoid the `setup_requires` deprecation done in 58.3.0 and reverted in 59.1.0



---

archive/issue_comments_534211.json:
```json
{
    "body": "<a id='comment:35'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/078e37bbcc8825841a80c9118a1d0598c01d78c8\">078e37b</a></td><td><code>build/pkgs/setuptools: Update to 59.1.0, remove patch</code></td></tr></table>\n",
    "created_at": "2021-11-15T02:19:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534211",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/078e37bbcc8825841a80c9118a1d0598c01d78c8">078e37b</a></td><td><code>build/pkgs/setuptools: Update to 59.1.0, remove patch</code></td></tr></table>




---

archive/issue_comments_534212.json:
```json
{
    "body": "**Changing commit** from \"[a8fe9da95f28efc4b3bf975a997ce6da05c928bf](https://github.com/sagemath/sagetrac-mirror/commit/a8fe9da95f28efc4b3bf975a997ce6da05c928bf)\" to \"[078e37bbcc8825841a80c9118a1d0598c01d78c8](https://github.com/sagemath/sagetrac-mirror/commit/078e37bbcc8825841a80c9118a1d0598c01d78c8)\".",
    "created_at": "2021-11-15T02:19:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534212",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a8fe9da95f28efc4b3bf975a997ce6da05c928bf](https://github.com/sagemath/sagetrac-mirror/commit/a8fe9da95f28efc4b3bf975a997ce6da05c928bf)" to "[078e37bbcc8825841a80c9118a1d0598c01d78c8](https://github.com/sagemath/sagetrac-mirror/commit/078e37bbcc8825841a80c9118a1d0598c01d78c8)".



---

archive/issue_events_299311.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-11-15T02:20:09Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "rename": {
        "from": "pyzmq: Fix build errors; zeromq, pyzmq: Update; setuptools: upgrade to 58.5.3, add patch",
        "to": "pyzmq: Fix build errors; zeromq, pyzmq: Update; setuptools: upgrade to 59.1.0"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32828#event-299311"
}
```



---

archive/issue_comments_534213.json:
```json
{
    "body": "**Changing upstream** from \"Fixed upstream, but not in a stable release.\" to \"Fixed upstream, in a later stable release.\".",
    "created_at": "2021-11-15T02:20:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534213",
    "user": "https://github.com/mkoeppe"
}
```

**Changing upstream** from "Fixed upstream, but not in a stable release." to "Fixed upstream, in a later stable release.".



---

archive/issue_comments_534214.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,10 @@\n+`pyzmq` fails to build on some platforms. We fix it by \n+- upgrading `setuptools` to a version that includes https://github.com/pypa/distutils/pull/65 \n+- correcting the `pyzmq` build configuration\n+\n+We also upgrade `pyzmq` and `zeromq` to the latest versions.\n+\n+\n For example on `opensuse-tumbleweed-minimal` (https://github.com/mkoeppe/sage/runs/4085305194?check_suite_focus=true)\n \n ```\n``````\n",
    "created_at": "2021-11-15T02:22:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534214",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,10 @@
+`pyzmq` fails to build on some platforms. We fix it by 
+- upgrading `setuptools` to a version that includes https://github.com/pypa/distutils/pull/65 
+- correcting the `pyzmq` build configuration
+
+We also upgrade `pyzmq` and `zeromq` to the latest versions.
+
+
 For example on `opensuse-tumbleweed-minimal` (https://github.com/mkoeppe/sage/runs/4085305194?check_suite_focus=true)
 
 ```
``````




---

archive/issue_comments_534215.json:
```json
{
    "body": "<a id='comment:38'></a>\nLet's get this in please",
    "created_at": "2021-11-16T20:23:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534215",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:38'></a>
Let's get this in please



---

archive/issue_comments_534216.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,7 +3,6 @@\n - correcting the `pyzmq` build configuration\n \n We also upgrade `pyzmq` and `zeromq` to the latest versions.\n-\n \n For example on `opensuse-tumbleweed-minimal` (https://github.com/mkoeppe/sage/runs/4085305194?check_suite_focus=true)\n \n``````\n",
    "created_at": "2021-11-18T19:45:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534216",
    "user": "https://github.com/slel"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,7 +3,6 @@
 - correcting the `pyzmq` build configuration
 
 We also upgrade `pyzmq` and `zeromq` to the latest versions.
-
 
 For example on `opensuse-tumbleweed-minimal` (https://github.com/mkoeppe/sage/runs/4085305194?check_suite_focus=true)
 
``````




---

archive/issue_comments_534217.json:
```json
{
    "body": "**Changing commit** from \"[078e37bbcc8825841a80c9118a1d0598c01d78c8](https://github.com/sagemath/sagetrac-mirror/commit/078e37bbcc8825841a80c9118a1d0598c01d78c8)\" to \"[b430bcf4c46c4822a0b248db307565dd2c814119](https://github.com/sagemath/sagetrac-mirror/commit/b430bcf4c46c4822a0b248db307565dd2c814119)\".",
    "created_at": "2021-11-19T05:25:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534217",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[078e37bbcc8825841a80c9118a1d0598c01d78c8](https://github.com/sagemath/sagetrac-mirror/commit/078e37bbcc8825841a80c9118a1d0598c01d78c8)" to "[b430bcf4c46c4822a0b248db307565dd2c814119](https://github.com/sagemath/sagetrac-mirror/commit/b430bcf4c46c4822a0b248db307565dd2c814119)".



---

archive/issue_comments_534218.json:
```json
{
    "body": "<a id='comment:40'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ee4f6b4a5af0122465882f5f42b5b561852756e2\">ee4f6b4</a></td><td><code>Merge tag '9.5.beta7' into t/32828/pyzmq__build_errors</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b430bcf4c46c4822a0b248db307565dd2c814119\">b430bcf</a></td><td><code>build/pkgs/setuptools: Update to 59.2.0</code></td></tr></table>\n",
    "created_at": "2021-11-19T05:25:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534218",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ee4f6b4a5af0122465882f5f42b5b561852756e2">ee4f6b4</a></td><td><code>Merge tag '9.5.beta7' into t/32828/pyzmq__build_errors</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b430bcf4c46c4822a0b248db307565dd2c814119">b430bcf</a></td><td><code>build/pkgs/setuptools: Update to 59.2.0</code></td></tr></table>




---

archive/issue_events_299312.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-11-19T05:25:35Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "rename": {
        "from": "pyzmq: Fix build errors; zeromq, pyzmq: Update; setuptools: upgrade to 59.1.0",
        "to": "pyzmq: Fix build errors; zeromq, pyzmq: Update; setuptools: upgrade to 59.2.0"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32828#event-299312"
}
```



---

archive/issue_events_299313.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-19T11:00:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32828#event-299313"
}
```



---

archive/issue_events_299314.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-19T11:00:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32828#event-299314"
}
```



---

archive/issue_comments_534219.json:
```json
{
    "body": "**Reviewer:** Dima Pasechnik",
    "created_at": "2021-11-19T11:00:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534219",
    "user": "https://github.com/dimpase"
}
```

**Reviewer:** Dima Pasechnik



---

archive/issue_comments_534220.json:
```json
{
    "body": "<a id='comment:42'></a>\nlgtm",
    "created_at": "2021-11-19T11:00:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534220",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:42'></a>
lgtm



---

archive/issue_comments_534221.json:
```json
{
    "body": "<a id='comment:43'></a>\nThanks!",
    "created_at": "2021-11-19T17:05:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534221",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:43'></a>
Thanks!



---

archive/issue_comments_534222.json:
```json
{
    "body": "<a id='comment:44'></a>\nWorks for me on void linux using musl libc which used to fail (I was carrying a different patch before; I've replaced that patch by the changes in this ticket and it works).",
    "created_at": "2021-11-22T18:24:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534222",
    "user": "https://github.com/tornaria"
}
```

<a id='comment:44'></a>
Works for me on void linux using musl libc which used to fail (I was carrying a different patch before; I've replaced that patch by the changes in this ticket and it works).



---

archive/issue_comments_534223.json:
```json
{
    "body": "<a id='comment:45'></a>\nThanks for testing!",
    "created_at": "2021-11-22T18:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534223",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:45'></a>
Thanks for testing!



---

archive/issue_events_299315.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-12-05T11:15:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32828#event-299315"
}
```



---

archive/issue_events_299316.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-12-05T11:15:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32828#event-299316"
}
```



---

archive/issue_comments_534224.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/pyzmq__build_errors](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/pyzmq__build_errors)\" to \"[b430bcf4c46c4822a0b248db307565dd2c814119](https://github.com/sagemath/sagetrac-mirror/commit/b430bcf4c46c4822a0b248db307565dd2c814119)\".",
    "created_at": "2021-12-05T11:15:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534224",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mkoeppe/pyzmq__build_errors](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/pyzmq__build_errors)" to "[b430bcf4c46c4822a0b248db307565dd2c814119](https://github.com/sagemath/sagetrac-mirror/commit/b430bcf4c46c4822a0b248db307565dd2c814119)".



---

archive/issue_comments_534225.json:
```json
{
    "body": "**Changing commit** from \"[b430bcf4c46c4822a0b248db307565dd2c814119](https://github.com/sagemath/sagetrac-mirror/commit/b430bcf4c46c4822a0b248db307565dd2c814119)\" to \"\".",
    "created_at": "2021-12-21T19:09:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534225",
    "user": "https://github.com/mkoeppe"
}
```

**Changing commit** from "[b430bcf4c46c4822a0b248db307565dd2c814119](https://github.com/sagemath/sagetrac-mirror/commit/b430bcf4c46c4822a0b248db307565dd2c814119)" to "".



---

archive/issue_comments_534226.json:
```json
{
    "body": "<a id='comment:47'></a>\nFollow-ups in #32944, #33059",
    "created_at": "2021-12-21T19:09:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32828#issuecomment-534226",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:47'></a>
Follow-ups in #32944, #33059
