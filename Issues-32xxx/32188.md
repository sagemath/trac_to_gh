# Issue 32188: Fix some doctests that fail for various random seeds

archive/issues_031951.json:
```json
{
    "body": "We fix some doctests or mark them as `# not tested` that were discovered when testing #29935. This should make the review of #29935 easier.\n\nAll the tests failed for some random seed during\n\n```\nsage -t --long --all --random-seed=n\n```\n\nCC:  @orlitzky\n\nBranch/Commit: 48b8e0ba382ef8e003d02839380a98fc604f5ecd\n\nReviewer: Michael Orlitzky\n\nAuthor: Jonathan Kliem\n\nDependencies: #32095, #32185\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/32188\n\n",
    "closed_at": "2021-09-07T20:52:25Z",
    "created_at": "2021-07-12T15:55:15Z",
    "labels": [
        "component: doctest framework"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Fix some doctests that fail for various random seeds",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32188",
    "user": "https://github.com/kliem"
}
```
We fix some doctests or mark them as `# not tested` that were discovered when testing #29935. This should make the review of #29935 easier.

All the tests failed for some random seed during

```
sage -t --long --all --random-seed=n
```

CC:  @orlitzky

Branch/Commit: 48b8e0ba382ef8e003d02839380a98fc604f5ecd

Reviewer: Michael Orlitzky

Author: Jonathan Kliem

Dependencies: #32095, #32185

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/32188





---

archive/issue_comments_640802.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2021-07-12T15:55:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32188#issuecomment-640802",
    "user": "https://github.com/kliem"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_640803.json:
```json
{
    "body": "Changing commit from \"\" to \"cb42bc3b2c8f359c36f925e2f8981a1ef3760bce\"",
    "created_at": "2021-07-12T15:55:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32188#issuecomment-640803",
    "user": "https://github.com/kliem"
}
```

Changing commit from "" to "cb42bc3b2c8f359c36f925e2f8981a1ef3760bce"



---

archive/issue_comments_640804.json:
```json
{
    "body": "Changing branch from \"\" to \"u/gh-kliem/fix_various_doctests_failing_on_random_seeds\"",
    "created_at": "2021-07-12T15:55:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32188#issuecomment-640804",
    "user": "https://github.com/kliem"
}
```

Changing branch from "" to "u/gh-kliem/fix_various_doctests_failing_on_random_seeds"



---

archive/issue_comments_640805.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-07-12T15:55:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32188#issuecomment-640805",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_640806.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#32095, #32185\"",
    "created_at": "2021-07-21T12:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32188#issuecomment-640806",
    "user": "https://github.com/orlitzky"
}
```

Changing dependencies from "" to "#32095, #32185"



---

archive/issue_comments_640807.json:
```json
{
    "body": "Changing commit from \"cb42bc3b2c8f359c36f925e2f8981a1ef3760bce\" to \"36e8666a4c2a7a22f87236d5beaf2b28c80d76c2\"",
    "created_at": "2021-07-21T13:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32188#issuecomment-640807",
    "user": "https://github.com/orlitzky"
}
```

Changing commit from "cb42bc3b2c8f359c36f925e2f8981a1ef3760bce" to "36e8666a4c2a7a22f87236d5beaf2b28c80d76c2"



---

archive/issue_comments_640808.json:
```json
{
    "body": "<a id='comment:3'></a>I've made three review commits: two just re-enable the tests for #32095 and #32185, and the last one tries to do something more useful with that rank example over `GF(2^4)[a]`.\n\nI have one other question:\n\n```\nsage: while True:\n....:     try:\n....:         y = Chan(c)\n....:         D.decode_to_message(y)\n....:     except ZeroDivisionError:\n....:         pass\n```\n\nThat looks suspicious to me. It's looping until... what? Neither `c`,`D`, nor `y` change inside the loop unless there's some randomness I missed.\n\nOtherwise the rest LGTM.",
    "created_at": "2021-07-21T13:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32188#issuecomment-640808",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:3'></a>I've made three review commits: two just re-enable the tests for #32095 and #32185, and the last one tries to do something more useful with that rank example over `GF(2^4)[a]`.

I have one other question:

```
sage: while True:
....:     try:
....:         y = Chan(c)
....:         D.decode_to_message(y)
....:     except ZeroDivisionError:
....:         pass
```

That looks suspicious to me. It's looping until... what? Neither `c`,`D`, nor `y` change inside the loop unless there's some randomness I missed.

Otherwise the rest LGTM.



---

archive/issue_comments_640809.json:
```json
{
    "body": "Changing branch from \"u/gh-kliem/fix_various_doctests_failing_on_random_seeds\" to \"u/mjo/ticket/32188\"",
    "created_at": "2021-07-21T13:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32188#issuecomment-640809",
    "user": "https://github.com/orlitzky"
}
```

Changing branch from "u/gh-kliem/fix_various_doctests_failing_on_random_seeds" to "u/mjo/ticket/32188"



---

archive/issue_events_085261.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32188#event-85261"
}
```



---

archive/issue_comments_640810.json:
```json
{
    "body": "Changing commit from \"36e8666a4c2a7a22f87236d5beaf2b28c80d76c2\" to \"48b8e0ba382ef8e003d02839380a98fc604f5ecd\"",
    "created_at": "2021-09-01T09:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32188#issuecomment-640810",
    "user": "https://github.com/kliem"
}
```

Changing commit from "36e8666a4c2a7a22f87236d5beaf2b28c80d76c2" to "48b8e0ba382ef8e003d02839380a98fc604f5ecd"



---

archive/issue_comments_640811.json:
```json
{
    "body": "Changing branch from \"u/mjo/ticket/32188\" to \"u/gh-kliem/ticket/32188\"",
    "created_at": "2021-09-01T09:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32188#issuecomment-640811",
    "user": "https://github.com/kliem"
}
```

Changing branch from "u/mjo/ticket/32188" to "u/gh-kliem/ticket/32188"



---

archive/issue_comments_640812.json:
```json
{
    "body": "<a id='comment:6'></a>New commits:",
    "created_at": "2021-09-01T09:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32188#issuecomment-640812",
    "user": "https://github.com/kliem"
}
```

<a id='comment:6'></a>New commits:



---

archive/issue_comments_640813.json:
```json
{
    "body": "<a id='comment:7'></a>To answer my own question from comment:3, it looks like `Chan(c)` does something that eliminates the `ZeroDivisionError`, leading to the `DecodingError` that we expect:\n\n```python\n# We arrive at this point by running\n# c = C.random_element(); y = Chan(c); D.decode_to_message(y)\n# in a loop until a ZeroDivisionError is thrown.\nsage: c                                                                         \n(56, 57, 51, 49, 50, 51, 18, 6, 56, 35, 53, 49, 25, 47, 19, 31, 3, 22, 34, 38, 53, 34, 29, 15, 58, 38, 21, 53, 23, 14, 1, 23, 22, 37, 39, 12, 8, 23, 39, 37)\nsage: y                                                                         \n(56, 22, 51, 36, 50, 10, 18, 6, 56, 35, 53, 49, 58, 56, 53, 31, 3, 22, 34, 3, 53, 34, 38, 15, 0, 38, 21, 0, 46, 3, 1, 23, 43, 42, 39, 12, 8, 23, 33, 37)\nsage: D.decode_to_message(y)\n...\nZeroDivisionError: inverse of Mod(0, 59) does not exist\nsage: y = Chan(c)                                                               \nsage: D.decode_to_message(y)\n...\nDecodingError: Decoding failed because the number of errors exceeded the decoding radius\n```\n\nRegardless... it's doing what it should somehow.",
    "created_at": "2021-09-01T23:41:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32188#issuecomment-640813",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:7'></a>To answer my own question from comment:3, it looks like `Chan(c)` does something that eliminates the `ZeroDivisionError`, leading to the `DecodingError` that we expect:

```python
# We arrive at this point by running
# c = C.random_element(); y = Chan(c); D.decode_to_message(y)
# in a loop until a ZeroDivisionError is thrown.
sage: c                                                                         
(56, 57, 51, 49, 50, 51, 18, 6, 56, 35, 53, 49, 25, 47, 19, 31, 3, 22, 34, 38, 53, 34, 29, 15, 58, 38, 21, 53, 23, 14, 1, 23, 22, 37, 39, 12, 8, 23, 39, 37)
sage: y                                                                         
(56, 22, 51, 36, 50, 10, 18, 6, 56, 35, 53, 49, 58, 56, 53, 31, 3, 22, 34, 3, 53, 34, 38, 15, 0, 38, 21, 0, 46, 3, 1, 23, 43, 42, 39, 12, 8, 23, 33, 37)
sage: D.decode_to_message(y)
...
ZeroDivisionError: inverse of Mod(0, 59) does not exist
sage: y = Chan(c)                                                               
sage: D.decode_to_message(y)
...
DecodingError: Decoding failed because the number of errors exceeded the decoding radius
```

Regardless... it's doing what it should somehow.



---

archive/issue_comments_640814.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Michael Orlitzky\"",
    "created_at": "2021-09-02T01:31:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32188#issuecomment-640814",
    "user": "https://github.com/orlitzky"
}
```

Changing reviewer from "" to "Michael Orlitzky"



---

archive/issue_comments_640815.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-09-02T01:31:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32188#issuecomment-640815",
    "user": "https://github.com/orlitzky"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_640816.json:
```json
{
    "body": "<a id='comment:9'></a>Thank you.\n\nI had somehow forgotten about your question from comment:3.",
    "created_at": "2021-09-02T05:41:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32188#issuecomment-640816",
    "user": "https://github.com/kliem"
}
```

<a id='comment:9'></a>Thank you.

I had somehow forgotten about your question from comment:3.



---

archive/issue_comments_640817.json:
```json
{
    "body": "Changing branch from \"u/gh-kliem/ticket/32188\" to \"48b8e0ba382ef8e003d02839380a98fc604f5ecd\"",
    "created_at": "2021-09-07T20:52:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32188#issuecomment-640817",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/gh-kliem/ticket/32188" to "48b8e0ba382ef8e003d02839380a98fc604f5ecd"



---

archive/issue_events_085262.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-09-07T20:52:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32188#event-85262"
}
```



---

archive/issue_comments_640818.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-09-07T20:52:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32188#issuecomment-640818",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
