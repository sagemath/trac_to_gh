# Issue 32520: Fix doctests to accept exception messages reworded in python 3.10

archive/issues_032283.json:
```json
{
    "body": "Tests with #30767 showed the following types of doctest failures from the more detailed exception messages provided by Python 3.10.\n\nWe fix them by widening the patterns.\n\n```\nsage -t --long --random-seed=0 src/sage/geometry/polyhedron/base.py\n**********************************************************************\nFile \"src/sage/geometry/polyhedron/base.py\", line 214, in sage.geometry.polyhedron.base.Polyhedron_base.__init__\nFailed example:\n    p = Polyhedron_field(parent, Vrep, 'nonsense',  # py3\n                         Vrep_minimal=True, Hrep_minimal=True, pref_rep='Vrep')\nExpected:\n    Traceback (most recent call last):\n    ...\n    TypeError: _init_Hrepresentation() takes 3 positional arguments but 9 were given\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n...\n    TypeError: Polyhedron_field._init_Hrepresentation() takes 3 positional arguments but 9 were given\n```\n\n```\nFile \"src/sage/plot/graphics.py\", line 1262, in sage.plot.graphics.Graphics.plot\nFailed example:\n    S.plot(hey=\"hou\")\nExpected:\n    Traceback (most recent call last):\n    ...\n    TypeError: plot() got an unexpected keyword argument 'hey'\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py\", line 704, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1098, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.plot.graphics.Graphics.plot[3]>\", line 1, in <module>\n        S.plot(hey=\"hou\")\n    TypeError: Graphics.plot() got an unexpected keyword argument 'hey'\n```\n\n```\nsage -t --long --random-seed=0 src/sage/functions/other.py\n**********************************************************************\nFile \"src/sage/functions/other.py\", line 2131, in sage.functions.other.Function_cases.__call__\nFailed example:\n    cases()\nExpected:\n    Traceback (most recent call last):\n    ...\n    TypeError: __call__() missing 1 required positional argument: 'l'\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py\", line 704, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1098, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.functions.other.Function_cases.__call__[1]>\", line 1, in <module>\n        cases()\n    TypeError: Function_cases.__call__() missing 1 required positional argument: 'l'\n```\n\n\n```\nExpected:\n    Traceback (most recent call last):\n    ...\n    TypeError: float() argument must be a string or a number...\nGot:\n    TypeError: float() argument must be a string or a real number, not 'list'\n```\n\n```\nsage -t --long --random-seed=0 src/sage/misc/lazy_attribute.pyx\n**********************************************************************\nFile \"src/sage/misc/lazy_attribute.pyx\", line 363, in sage.misc.lazy_attribute.lazy_attribute\nFailed example:\n    a.x = 4\nExpected:\n    Traceback (most recent call last):\n    ...\n    AttributeError: can...t set attribute\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py\", line 704, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1098, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.misc.lazy_attribute.lazy_attribute[35]>\", line 1, in <module>\n        a.x = Integer(4)\n    AttributeError: can't set attribute 'x'\n```\n\n```\nsage -t --long --random-seed=0 src/sage/repl/preparse.py\n**********************************************************************\nFile \"src/sage/repl/preparse.py\", line 118, in sage.repl.preparse\nFailed example:\n    eval('4.__add__(3)')\nExpected:\n    Traceback (most recent call last):\n    ...\n    SyntaxError: invalid syntax\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py\", line 704, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1098, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.preparse[24]>\", line 1, in <module>\n        eval('4.__add__(3)')\n      File \"<string>\", line 1\n        4.__add__(3)\n         ^\n    SyntaxError: invalid decimal literal\n```\n\n```\nsage -t --long --random-seed=0 src/sage/combinat/ncsf_qsym/tutorial.py\n**********************************************************************\nFile \"src/sage/combinat/ncsf_qsym/tutorial.py\", line 132, in sage.combinat.ncsf_qsym.tutorial\nFailed example:\n    M[]\nExpected:\n    Traceback (most recent call last):\n    ...\n    SyntaxError: invalid syntax\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py\", line 704, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1096, in compile_and_execute\n        compiled = compiler(example)\n      File \"/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py\", line 671, in compiler\n        code = compile(example.source, filename, \"single\",\n      File \"<doctest sage.combinat.ncsf_qsym.tutorial[27]>\", line 1\n        M[]\n        ^\n    SyntaxError: invalid syntax. Perhaps you forgot a comma?\n```\n\n\nCC:  @fchapoton @kiwifb @kliem\n\nReviewer: Jonathan Kliem\n\nAuthor: Matthias Koeppe\n\nBranch: 68d07f8ddf10132f116c2679264636675beda02c\n\nCommit: 68d07f8ddf10132f116c2679264636675beda02c\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/32520\n\n",
    "closed_at": "2021-10-09T11:10:19Z",
    "created_at": "2021-09-16T02:48:59Z",
    "labels": [
        "component: refactoring",
        "critical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Fix doctests to accept exception messages reworded in python 3.10",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32520",
    "user": "https://github.com/mkoeppe"
}
```
Tests with #30767 showed the following types of doctest failures from the more detailed exception messages provided by Python 3.10.

We fix them by widening the patterns.

```
sage -t --long --random-seed=0 src/sage/geometry/polyhedron/base.py
**********************************************************************
File "src/sage/geometry/polyhedron/base.py", line 214, in sage.geometry.polyhedron.base.Polyhedron_base.__init__
Failed example:
    p = Polyhedron_field(parent, Vrep, 'nonsense',  # py3
                         Vrep_minimal=True, Hrep_minimal=True, pref_rep='Vrep')
Expected:
    Traceback (most recent call last):
    ...
    TypeError: _init_Hrepresentation() takes 3 positional arguments but 9 were given
Got:
    <BLANKLINE>
    Traceback (most recent call last):
...
    TypeError: Polyhedron_field._init_Hrepresentation() takes 3 positional arguments but 9 were given
```

```
File "src/sage/plot/graphics.py", line 1262, in sage.plot.graphics.Graphics.plot
Failed example:
    S.plot(hey="hou")
Expected:
    Traceback (most recent call last):
    ...
    TypeError: plot() got an unexpected keyword argument 'hey'
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py", line 704, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py", line 1098, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.plot.graphics.Graphics.plot[3]>", line 1, in <module>
        S.plot(hey="hou")
    TypeError: Graphics.plot() got an unexpected keyword argument 'hey'
```

```
sage -t --long --random-seed=0 src/sage/functions/other.py
**********************************************************************
File "src/sage/functions/other.py", line 2131, in sage.functions.other.Function_cases.__call__
Failed example:
    cases()
Expected:
    Traceback (most recent call last):
    ...
    TypeError: __call__() missing 1 required positional argument: 'l'
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py", line 704, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py", line 1098, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.functions.other.Function_cases.__call__[1]>", line 1, in <module>
        cases()
    TypeError: Function_cases.__call__() missing 1 required positional argument: 'l'
```


```
Expected:
    Traceback (most recent call last):
    ...
    TypeError: float() argument must be a string or a number...
Got:
    TypeError: float() argument must be a string or a real number, not 'list'
```

```
sage -t --long --random-seed=0 src/sage/misc/lazy_attribute.pyx
**********************************************************************
File "src/sage/misc/lazy_attribute.pyx", line 363, in sage.misc.lazy_attribute.lazy_attribute
Failed example:
    a.x = 4
Expected:
    Traceback (most recent call last):
    ...
    AttributeError: can...t set attribute
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py", line 704, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py", line 1098, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.lazy_attribute.lazy_attribute[35]>", line 1, in <module>
        a.x = Integer(4)
    AttributeError: can't set attribute 'x'
```

```
sage -t --long --random-seed=0 src/sage/repl/preparse.py
**********************************************************************
File "src/sage/repl/preparse.py", line 118, in sage.repl.preparse
Failed example:
    eval('4.__add__(3)')
Expected:
    Traceback (most recent call last):
    ...
    SyntaxError: invalid syntax
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py", line 704, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py", line 1098, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.preparse[24]>", line 1, in <module>
        eval('4.__add__(3)')
      File "<string>", line 1
        4.__add__(3)
         ^
    SyntaxError: invalid decimal literal
```

```
sage -t --long --random-seed=0 src/sage/combinat/ncsf_qsym/tutorial.py
**********************************************************************
File "src/sage/combinat/ncsf_qsym/tutorial.py", line 132, in sage.combinat.ncsf_qsym.tutorial
Failed example:
    M[]
Expected:
    Traceback (most recent call last):
    ...
    SyntaxError: invalid syntax
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py", line 704, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py", line 1096, in compile_and_execute
        compiled = compiler(example)
      File "/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.10.0rc1/lib/python3.10/site-packages/sage/doctest/forker.py", line 671, in compiler
        code = compile(example.source, filename, "single",
      File "<doctest sage.combinat.ncsf_qsym.tutorial[27]>", line 1
        M[]
        ^
    SyntaxError: invalid syntax. Perhaps you forgot a comma?
```


CC:  @fchapoton @kiwifb @kliem

Reviewer: Jonathan Kliem

Author: Matthias Koeppe

Branch: 68d07f8ddf10132f116c2679264636675beda02c

Commit: 68d07f8ddf10132f116c2679264636675beda02c

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/32520





---

archive/issue_comments_460426.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-16T04:01:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32520",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32520#issuecomment-460426",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_460427.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-16T04:10:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32520",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32520#issuecomment-460427",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_460428.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-09-16T04:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32520",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32520#issuecomment-460428",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_460429.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-16T05:06:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32520",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32520#issuecomment-460429",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_460430.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-16T15:17:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32520",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32520#issuecomment-460430",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_460431.json:
```json
{
    "body": "<a id='comment:11'></a>Did you mean to add a different ticket as a dependency?",
    "created_at": "2021-09-19T17:13:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32520",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32520#issuecomment-460431",
    "user": "https://github.com/slel"
}
```

<a id='comment:11'></a>Did you mean to add a different ticket as a dependency?



---

archive/issue_comments_460432.json:
```json
{
    "body": "<a id='comment:12'></a>Thanks",
    "created_at": "2021-09-19T17:30:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32520",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32520#issuecomment-460432",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>Thanks



---

archive/issue_comments_460433.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-28T19:23:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32520",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32520#issuecomment-460433",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_460434.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2021-09-28T19:25:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32520",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32520#issuecomment-460434",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from major to critical.



---

archive/issue_comments_460435.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-09-29T07:42:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32520",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32520#issuecomment-460435",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_460436.json:
```json
{
    "body": "<a id='comment:16'></a>LGTM.",
    "created_at": "2021-09-29T07:42:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32520",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32520#issuecomment-460436",
    "user": "https://github.com/kliem"
}
```

<a id='comment:16'></a>LGTM.



---

archive/issue_comments_460437.json:
```json
{
    "body": "<a id='comment:17'></a>Thanks!",
    "created_at": "2021-09-29T15:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32520",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32520#issuecomment-460437",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>Thanks!



---

archive/issue_events_086229.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-09T11:10:19Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32520",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32520#event-86229"
}
```



---

archive/issue_comments_460438.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-10-09T11:10:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32520",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32520#issuecomment-460438",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
