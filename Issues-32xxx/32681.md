# Issue 32681: Changing brick polytopes of subword complexes to brick polyhedra

archive/issues_032444.json:
```json
{
    "body": "generalize the method brick_polytope() of sage.combinat.subword_complex.py to brick_polyhedron() as done in\n\nhttps://arxiv.org/abs/2103.03715\n\nCC:  stumpc5 @jplab @kliem\n\nKeywords: subword complex, brick vector, brick polyhedron, brick polytope,\n\nAuthor: Dennis Jahn\n\nBranch: u/gh-DennisJahn/changing_brick_polytopes_of_subword_complexes_to_brick_polyhedra\n\nStatus: needs_review\n\nDependencies: #32669\n\nCommit: b3abcc9f259239fe9c09013575183141a557d5b5\n\nIssue created by migration from https://trac.sagemath.org/ticket/32681\n\n",
    "created_at": "2021-10-13T10:16:42Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Changing brick polytopes of subword complexes to brick polyhedra",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32681",
    "user": "https://github.com/DennisJahn"
}
```
generalize the method brick_polytope() of sage.combinat.subword_complex.py to brick_polyhedron() as done in

https://arxiv.org/abs/2103.03715

CC:  stumpc5 @jplab @kliem

Keywords: subword complex, brick vector, brick polyhedron, brick polytope,

Author: Dennis Jahn

Branch: u/gh-DennisJahn/changing_brick_polytopes_of_subword_complexes_to_brick_polyhedra

Status: needs_review

Dependencies: #32669

Commit: b3abcc9f259239fe9c09013575183141a557d5b5

Issue created by migration from https://trac.sagemath.org/ticket/32681





---

archive/issue_comments_462275.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-14T09:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462275",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462276.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-14T10:18:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462276",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462277.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-14T11:05:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462277",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462278.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-14T12:35:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462278",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462279.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-14T13:24:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462279",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462280.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-18T07:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462280",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462281.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-10-18T08:51:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462281",
    "user": "https://github.com/DennisJahn"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_462282.json:
```json
{
    "body": "<a id='comment:9'></a>\n```\n+        from warnings import warn\n+        warn(\"brick_polytope() is deprecated; brick_polyhedron() is used instead; results are different for non-spherical subword complexes\", DeprecationWarning)\n```\nbetter to use `deprecation` from `sage.misc.superseded` for this",
    "created_at": "2021-10-18T19:41:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462282",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>
```
+        from warnings import warn
+        warn("brick_polytope() is deprecated; brick_polyhedron() is used instead; results are different for non-spherical subword complexes", DeprecationWarning)
```
better to use `deprecation` from `sage.misc.superseded` for this



---

archive/issue_comments_462283.json:
```json
{
    "body": "<a id='comment:10'></a>if you install the optional package `pynormaliz`, you can also do exact computations over number fields, this should probably be a user option",
    "created_at": "2021-10-18T19:42:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462283",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>if you install the optional package `pynormaliz`, you can also do exact computations over number fields, this should probably be a user option



---

archive/issue_comments_462284.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-19T09:10:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462284",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462285.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:10 mkoeppe]:\n> if you install the optional package `pynormaliz`, you can also do exact computations over number fields, this should probably be a user option\n\n\nI did install it but keep getting problems with vertices over the universal cyclotomic field:\n\n1.618033988749895? of type <class 'sage.rings.qqbar.AlgebraicReal'> not valid to initialize an element of the universal cyclotomic field\n\nIs there a way to work around this?",
    "created_at": "2021-10-19T09:58:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462285",
    "user": "https://github.com/DennisJahn"
}
```

<a id='comment:12'></a>Replying to [comment:10 mkoeppe]:
> if you install the optional package `pynormaliz`, you can also do exact computations over number fields, this should probably be a user option


I did install it but keep getting problems with vertices over the universal cyclotomic field:

1.618033988749895? of type <class 'sage.rings.qqbar.AlgebraicReal'> not valid to initialize an element of the universal cyclotomic field

Is there a way to work around this?



---

archive/issue_comments_462286.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-19T10:19:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462286",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462287.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-19T15:32:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462287",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462288.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-20T12:46:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462288",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462289.json:
```json
{
    "body": "<a id='comment:17'></a>\n```diff\ndiff --git a/src/sage/combinat/root_system/reflection_group_real.py b/src/sage/combinat/root_system/reflection_group_real.py\nindex 91333f0ca5..1fbf87496e 100644\n--- a/src/sage/combinat/root_system/reflection_group_real.py\n+++ b/src/sage/combinat/root_system/reflection_group_real.py\n@@ -706,8 +706,8 @@ class RealReflectionGroup(ComplexReflectionGroup):\n             [0, 1, 2]\n         \"\"\"\n         return self._index_set_inverse[i]\n-    \n-    def bruhat_cone(self, x, y, side = 'upper'):\n+\n+    def bruhat_cone(self, x, y, side='upper', backend='cdd'):\n         r\"\"\"\n         Return the polyhedral cone generated by the set of positive roots ``beta`` where ``s_beta`` is the reflection corresponding to ``beta`` and:\n \n@@ -744,12 +744,16 @@ class RealReflectionGroup(ComplexReflectionGroup):\n             raise ValueError(\"side must be either 'upper' or 'lower'\")\n         from sage.geometry.polyhedron.constructor import Polyhedron\n         if self.is_crystallographic():\n-            return Polyhedron(vertices = [[0]*self.rank()], rays = roots, ambient_dim = self.rank())\n+            return Polyhedron(vertices = [[0]*self.rank()], rays=roots, ambient_dim=self.rank(), backend=backend)\n         else:\n-            from warnings import warn\n-            warn(\"Using floating point numbers for roots of unity. This might cause numerical errors!\")\n-            from sage.rings.real_double import RDF\n-            return Polyhedron(vertices = [[0]*self.rank()], rays = roots, ambient_dim = self.rank(), base_ring = RDF)\n+            if backend == 'cdd':\n+                from warnings import warn\n+                warn(\"Using floating point numbers for roots of unity. This might cause numerical errors!\")\n+                from sage.rings.real_double import RDF as base_ring\n+                backend = 'cdd'\n+            else:\n+                from sage.rings.qqbar import AA as base_ring\n+            return Polyhedron(vertices = [[0]*self.rank()], rays=roots, ambient_dim=self.rank(), base_ring=base_ring, backend=backend)\n \n     class Element(RealReflectionGroupElement, ComplexReflectionGroup.Element):\n \ndiff --git a/src/sage/combinat/subword_complex.py b/src/sage/combinat/subword_complex.py\nindex bbf750b56d..dc64b5882c 100644\n--- a/src/sage/combinat/subword_complex.py\n+++ b/src/sage/combinat/subword_complex.py\n@@ -638,9 +638,9 @@ class SubwordComplexFacet(Simplex, Element):\n \n         - ``coefficients`` -- (optional) a list of coefficients used to\n           scale the fundamental weights\n-        \n+\n         - ``sign`` -- (default: ``'positive'``) must be one of the following:\n-        \n+\n           * ``'positive'`` - entries of the extended weight configuration are summed up as they are\n           * ``'negative'`` - entries of the extended weight configuration are summed up with a negative sign\n \n@@ -1660,9 +1660,9 @@ class SubwordComplex(UniqueRepresentation, SimplicialComplex):\n \n         - coefficients -- (optional) a list of coefficients used to\n           scale the fundamental weights\n-        \n+\n         - ``sign`` -- (default: ``'positive'``) must be one of the following:\n-        \n+\n           * ``'positive'`` - for brick vectors, entries of the extended weight configuration are summed up as they are\n           * ``'negative'`` - for brick vectors, entries of the extended weight configuration are summed up with a negative sign\n \n@@ -1690,7 +1690,7 @@ class SubwordComplex(UniqueRepresentation, SimplicialComplex):\n \n     def minkowski_summand(self, i):\n         r\"\"\"\n-        Return the `i` th Minkowski summand of ``self``. The brick polyhedron of ``self`` is the \n+        Return the `i` th Minkowski summand of ``self``. The brick polyhedron of ``self`` is the\n         Minkowski sum of its associated Bruhat cone and all Minkowski summands.\n \n         INPUT:\n@@ -1720,7 +1720,7 @@ class SubwordComplex(UniqueRepresentation, SimplicialComplex):\n             min_sum = [[QQ(CC(v)) for v in F.extended_weight_configuration()[i]] for F in self]\n         return Polyhedron(min_sum)\n \n-    def brick_polyhedron(self, coefficients=None, sign='positive'):\n+    def brick_polyhedron(self, coefficients=None, sign='positive', backend='cdd'):\n         r\"\"\"\n         Return the brick polyhedron of ``self``.\n \n@@ -1731,9 +1731,9 @@ class SubwordComplex(UniqueRepresentation, SimplicialComplex):\n \n         - coefficients -- (optional) a list of coefficients used to\n           scale the fundamental weights\n-        \n+\n         - ``sign`` -- (default: ``'positive'``) must be one of the following:\n-        \n+\n           * ``'positive'`` - entries of the extended weight configuration are summed up as they are.\n             The Bruhat cone is taken with a negative sign.\n           * ``'negative'`` - entries of the extended weight configuration are summed up with a negative sign.\n@@ -1762,29 +1762,32 @@ class SubwordComplex(UniqueRepresentation, SimplicialComplex):\n             sage: SC = SubwordComplex(Q,W.w0)                           # optional - gap3\n             sage: SC.brick_polyhedron()                                 # optional - gap3\n             A 3-dimensional polyhedron in RDF^3 defined as the convex hull of 32 vertices\n-            \n+\n             sage: W = ReflectionGroup(['B',2])                          # optional - gap3\n             sage: Q = W.w0.reduced_word()                               # optional - gap3\n             sage: SC = SubwordComplex(Q, W.from_reduced_word([1]))      # optional - gap3\n             sage: SC.brick_polyhedron()                                 # optional - gap3\n             A 2-dimensional polyhedron in QQ^2 defined as the convex hull of 2 vertices and 2 rays\n-            \n+\n         REFERENCES: [JahStu]_\n         \"\"\"\n         BV = self.brick_vectors(coefficients=coefficients, sign=sign)\n         G = self.group()\n         if sign == 'positive':\n-            BC = -G.bruhat_cone(self.pi(), G.demazure_product(self.word()))\n+            BC = -G.bruhat_cone(self.pi(), G.demazure_product(self.word()), backend=backend)\n         elif sign == 'negative':\n-            BC = G.bruhat_cone(self.pi(), G.demazure_product(self.word()))\n+            BC = G.bruhat_cone(self.pi(), G.demazure_product(self.word()), backend=backend)\n         else:\n             raise ValueError(\"sign must be either 'positive' or 'negative'\")\n         if G.coxeter_matrix().is_crystallographic():\n-            return Polyhedron(BV, ambient_dim = G.rank()) + BC\n+            return Polyhedron(BV, ambient_dim=G.rank(), backend=backend) + BC\n         else:\n-            from sage.rings.real_double import RDF\n-            return Polyhedron(BV, ambient_dim = G.rank(), base_ring = RDF) + BC\n-    \n+            if backend == 'cdd':\n+                from sage.rings.real_double import RDF as base_ring\n+            else:\n+                from sage.rings.qqbar import AA as base_ring\n+            return Polyhedron(BV, ambient_dim=G.rank(), base_ring=base_ring, backend=backend) + BC\n+\n     from sage.misc.superseded import deprecated_function_alias\n     brick_polytope = deprecated_function_alias(32681, brick_polyhedron)\n```\n\nThe `backend` keyword is missing anyway and should be added.\n\nIn can be documented similar to what is done in `src/sage/geometry/polyhedron/library.py`.\n\nA general remark: A keyword assignment should not have spaces guarding `=`: `Polyhedron(backend='cdd')`.",
    "created_at": "2021-10-25T09:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462289",
    "user": "https://github.com/kliem"
}
```

<a id='comment:17'></a>
```diff
diff --git a/src/sage/combinat/root_system/reflection_group_real.py b/src/sage/combinat/root_system/reflection_group_real.py
index 91333f0ca5..1fbf87496e 100644
--- a/src/sage/combinat/root_system/reflection_group_real.py
+++ b/src/sage/combinat/root_system/reflection_group_real.py
@@ -706,8 +706,8 @@ class RealReflectionGroup(ComplexReflectionGroup):
             [0, 1, 2]
         """
         return self._index_set_inverse[i]
-    
-    def bruhat_cone(self, x, y, side = 'upper'):
+
+    def bruhat_cone(self, x, y, side='upper', backend='cdd'):
         r"""
         Return the polyhedral cone generated by the set of positive roots ``beta`` where ``s_beta`` is the reflection corresponding to ``beta`` and:
 
@@ -744,12 +744,16 @@ class RealReflectionGroup(ComplexReflectionGroup):
             raise ValueError("side must be either 'upper' or 'lower'")
         from sage.geometry.polyhedron.constructor import Polyhedron
         if self.is_crystallographic():
-            return Polyhedron(vertices = [[0]*self.rank()], rays = roots, ambient_dim = self.rank())
+            return Polyhedron(vertices = [[0]*self.rank()], rays=roots, ambient_dim=self.rank(), backend=backend)
         else:
-            from warnings import warn
-            warn("Using floating point numbers for roots of unity. This might cause numerical errors!")
-            from sage.rings.real_double import RDF
-            return Polyhedron(vertices = [[0]*self.rank()], rays = roots, ambient_dim = self.rank(), base_ring = RDF)
+            if backend == 'cdd':
+                from warnings import warn
+                warn("Using floating point numbers for roots of unity. This might cause numerical errors!")
+                from sage.rings.real_double import RDF as base_ring
+                backend = 'cdd'
+            else:
+                from sage.rings.qqbar import AA as base_ring
+            return Polyhedron(vertices = [[0]*self.rank()], rays=roots, ambient_dim=self.rank(), base_ring=base_ring, backend=backend)
 
     class Element(RealReflectionGroupElement, ComplexReflectionGroup.Element):
 
diff --git a/src/sage/combinat/subword_complex.py b/src/sage/combinat/subword_complex.py
index bbf750b56d..dc64b5882c 100644
--- a/src/sage/combinat/subword_complex.py
+++ b/src/sage/combinat/subword_complex.py
@@ -638,9 +638,9 @@ class SubwordComplexFacet(Simplex, Element):
 
         - ``coefficients`` -- (optional) a list of coefficients used to
           scale the fundamental weights
-        
+
         - ``sign`` -- (default: ``'positive'``) must be one of the following:
-        
+
           * ``'positive'`` - entries of the extended weight configuration are summed up as they are
           * ``'negative'`` - entries of the extended weight configuration are summed up with a negative sign
 
@@ -1660,9 +1660,9 @@ class SubwordComplex(UniqueRepresentation, SimplicialComplex):
 
         - coefficients -- (optional) a list of coefficients used to
           scale the fundamental weights
-        
+
         - ``sign`` -- (default: ``'positive'``) must be one of the following:
-        
+
           * ``'positive'`` - for brick vectors, entries of the extended weight configuration are summed up as they are
           * ``'negative'`` - for brick vectors, entries of the extended weight configuration are summed up with a negative sign
 
@@ -1690,7 +1690,7 @@ class SubwordComplex(UniqueRepresentation, SimplicialComplex):
 
     def minkowski_summand(self, i):
         r"""
-        Return the `i` th Minkowski summand of ``self``. The brick polyhedron of ``self`` is the 
+        Return the `i` th Minkowski summand of ``self``. The brick polyhedron of ``self`` is the
         Minkowski sum of its associated Bruhat cone and all Minkowski summands.
 
         INPUT:
@@ -1720,7 +1720,7 @@ class SubwordComplex(UniqueRepresentation, SimplicialComplex):
             min_sum = [[QQ(CC(v)) for v in F.extended_weight_configuration()[i]] for F in self]
         return Polyhedron(min_sum)
 
-    def brick_polyhedron(self, coefficients=None, sign='positive'):
+    def brick_polyhedron(self, coefficients=None, sign='positive', backend='cdd'):
         r"""
         Return the brick polyhedron of ``self``.
 
@@ -1731,9 +1731,9 @@ class SubwordComplex(UniqueRepresentation, SimplicialComplex):
 
         - coefficients -- (optional) a list of coefficients used to
           scale the fundamental weights
-        
+
         - ``sign`` -- (default: ``'positive'``) must be one of the following:
-        
+
           * ``'positive'`` - entries of the extended weight configuration are summed up as they are.
             The Bruhat cone is taken with a negative sign.
           * ``'negative'`` - entries of the extended weight configuration are summed up with a negative sign.
@@ -1762,29 +1762,32 @@ class SubwordComplex(UniqueRepresentation, SimplicialComplex):
             sage: SC = SubwordComplex(Q,W.w0)                           # optional - gap3
             sage: SC.brick_polyhedron()                                 # optional - gap3
             A 3-dimensional polyhedron in RDF^3 defined as the convex hull of 32 vertices
-            
+
             sage: W = ReflectionGroup(['B',2])                          # optional - gap3
             sage: Q = W.w0.reduced_word()                               # optional - gap3
             sage: SC = SubwordComplex(Q, W.from_reduced_word([1]))      # optional - gap3
             sage: SC.brick_polyhedron()                                 # optional - gap3
             A 2-dimensional polyhedron in QQ^2 defined as the convex hull of 2 vertices and 2 rays
-            
+
         REFERENCES: [JahStu]_
         """
         BV = self.brick_vectors(coefficients=coefficients, sign=sign)
         G = self.group()
         if sign == 'positive':
-            BC = -G.bruhat_cone(self.pi(), G.demazure_product(self.word()))
+            BC = -G.bruhat_cone(self.pi(), G.demazure_product(self.word()), backend=backend)
         elif sign == 'negative':
-            BC = G.bruhat_cone(self.pi(), G.demazure_product(self.word()))
+            BC = G.bruhat_cone(self.pi(), G.demazure_product(self.word()), backend=backend)
         else:
             raise ValueError("sign must be either 'positive' or 'negative'")
         if G.coxeter_matrix().is_crystallographic():
-            return Polyhedron(BV, ambient_dim = G.rank()) + BC
+            return Polyhedron(BV, ambient_dim=G.rank(), backend=backend) + BC
         else:
-            from sage.rings.real_double import RDF
-            return Polyhedron(BV, ambient_dim = G.rank(), base_ring = RDF) + BC
-    
+            if backend == 'cdd':
+                from sage.rings.real_double import RDF as base_ring
+            else:
+                from sage.rings.qqbar import AA as base_ring
+            return Polyhedron(BV, ambient_dim=G.rank(), base_ring=base_ring, backend=backend) + BC
+
     from sage.misc.superseded import deprecated_function_alias
     brick_polytope = deprecated_function_alias(32681, brick_polyhedron)
```

The `backend` keyword is missing anyway and should be added.

In can be documented similar to what is done in `src/sage/geometry/polyhedron/library.py`.

A general remark: A keyword assignment should not have spaces guarding `=`: `Polyhedron(backend='cdd')`.



---

archive/issue_comments_462290.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2021-10-25T09:22:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462290",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_462291.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-25T13:58:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462291",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462292.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-25T14:14:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462292",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462293.json:
```json
{
    "body": "<a id='comment:21'></a>\n```diff\n-        - ``backend`` -- string (default: ``'ccd'``) -- The backend to use to create the polyhedron.\n+        - ``backend`` -- string (default: ``'cdd'``); the backend to use to create the polyhedron\n```\n\nand\n\n```diff\n-        - ``backend`` -- string (default: ``'cdd'``) The backend to use to create the polyhedron.\n+        - ``backend`` -- string (default: ``'cdd'``); the backend to use to create the polyhedron\n```",
    "created_at": "2021-10-25T14:20:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462293",
    "user": "https://github.com/kliem"
}
```

<a id='comment:21'></a>
```diff
-        - ``backend`` -- string (default: ``'ccd'``) -- The backend to use to create the polyhedron.
+        - ``backend`` -- string (default: ``'cdd'``); the backend to use to create the polyhedron
```

and

```diff
-        - ``backend`` -- string (default: ``'cdd'``) The backend to use to create the polyhedron.
+        - ``backend`` -- string (default: ``'cdd'``); the backend to use to create the polyhedron
```



---

archive/issue_comments_462294.json:
```json
{
    "body": "<a id='comment:22'></a>The above comment was edited to also remove the trailing period.",
    "created_at": "2021-10-25T14:22:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462294",
    "user": "https://github.com/kliem"
}
```

<a id='comment:22'></a>The above comment was edited to also remove the trailing period.



---

archive/issue_comments_462295.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-25T14:26:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462295",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462296.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-26T06:50:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462296",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462297.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-26T08:08:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462297",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462298.json:
```json
{
    "body": "<a id='comment:26'></a>Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.",
    "created_at": "2021-12-18T19:53:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462298",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.



---

archive/issue_events_086535.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32681#event-86535"
}
```



---

archive/issue_comments_462299.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-03-03T06:55:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462299",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_462300.json:
```json
{
    "body": "<a id='comment:27'></a>merge conflict (red branch) => needs work",
    "created_at": "2022-03-03T06:55:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462300",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>merge conflict (red branch) => needs work



---

archive/issue_events_086536.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-11T17:19:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32681#event-86536"
}
```



---

archive/issue_events_086537.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-11T17:19:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32681#event-86537"
}
```



---

archive/issue_events_086538.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32681#event-86538"
}
```



---

archive/issue_events_086539.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32681#event-86539"
}
```



---

archive/issue_comments_462301.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-09-13T08:08:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462301",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_462302.json:
```json
{
    "body": "<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-13T11:48:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462302",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462303.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-13T13:01:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462303",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462304.json:
```json
{
    "body": "<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-13T13:24:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462304",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462305.json:
```json
{
    "body": "<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-14T07:03:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462305",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462306.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-09-14T07:05:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462306",
    "user": "https://github.com/DennisJahn"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_462307.json:
```json
{
    "body": "<a id='comment:36'></a>The code looks good to me! `@`tscrim, `@`chapoton: I am sure you have some comments, at least concerning the formatting and/or the doctests. Could you maybe have a quick look? -- Thanks!",
    "created_at": "2022-09-14T10:56:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462307",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:36'></a>The code looks good to me! `@`tscrim, `@`chapoton: I am sure you have some comments, at least concerning the formatting and/or the doctests. Could you maybe have a quick look? -- Thanks!



---

archive/issue_comments_462308.json:
```json
{
    "body": "<a id='comment:37'></a>doc does not build\n\n```\n /home/sagemath/sage/src/sage/combinat/subword_complex.py:docstring of sage.combinat.subword_complex.SubwordComplex.brick_polyhedron:50: WARNING: citation not found: JS2021\n```",
    "created_at": "2022-09-14T12:54:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462308",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:37'></a>doc does not build

```
 /home/sagemath/sage/src/sage/combinat/subword_complex.py:docstring of sage.combinat.subword_complex.SubwordComplex.brick_polyhedron:50: WARNING: citation not found: JS2021
```



---

archive/issue_comments_462309.json:
```json
{
    "body": "<a id='comment:38'></a>the new deprecation must be doctested, for exemple in the module documentation near the top of the file",
    "created_at": "2022-09-14T13:35:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462309",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:38'></a>the new deprecation must be doctested, for exemple in the module documentation near the top of the file



---

archive/issue_comments_462310.json:
```json
{
    "body": "<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-14T17:02:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462310",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_462311.json:
```json
{
    "body": "<a id='comment:40'></a>Replying to [comment:37 Fr\u00e9d\u00e9ric Chapoton]:\n> doc does not build\n> \n> ```\n>  /home/sagemath/sage/src/sage/combinat/subword_complex.py:docstring of sage.combinat.subword_complex.SubwordComplex.brick_polyhedron:50: WARNING: citation not found: JS2021\n> ```\n\n\nThe reference [JS2021] was added in #32669\nI added the doctest for the new deprecation",
    "created_at": "2022-09-14T17:04:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32681#issuecomment-462311",
    "user": "https://github.com/DennisJahn"
}
```

<a id='comment:40'></a>Replying to [comment:37 Frédéric Chapoton]:
> doc does not build
> 
> ```
>  /home/sagemath/sage/src/sage/combinat/subword_complex.py:docstring of sage.combinat.subword_complex.SubwordComplex.brick_polyhedron:50: WARNING: citation not found: JS2021
> ```


The reference [JS2021] was added in #32669
I added the doctest for the new deprecation
