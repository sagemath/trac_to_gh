# Issue 32707: flit_core: Update to 3.4.0; setuptools_scm: Update to 6.3.2

archive/issues_032470.json:
```json
{
    "body": "https://flit.readthedocs.io/en/latest/history.html#version-3-4\n\nThis simplifies the dependencies and removes a \"circular dependency\" warning from the output during build.\n\nCC:  @vbraun @dimpase @jhpalmieri\n\nReviewer: Volker Braun\n\nAuthor: Matthias Koeppe\n\nBranch: 9eea50ccf4bf2db2f824c89b21a387334b1e01b4\n\nDependencies: #32698\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/32707\n\n",
    "closed_at": "2021-10-19T20:30:37Z",
    "created_at": "2021-10-17T17:38:01Z",
    "labels": [
        "component: packages: standard",
        "critical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "flit_core: Update to 3.4.0; setuptools_scm: Update to 6.3.2",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32707",
    "user": "https://github.com/mkoeppe"
}
```
https://flit.readthedocs.io/en/latest/history.html#version-3-4

This simplifies the dependencies and removes a "circular dependency" warning from the output during build.

CC:  @vbraun @dimpase @jhpalmieri

Reviewer: Volker Braun

Author: Matthias Koeppe

Branch: 9eea50ccf4bf2db2f824c89b21a387334b1e01b4

Dependencies: #32698

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/32707





---

archive/issue_comments_494620.json:
```json
{
    "body": "<a id='comment:5'></a>Last 10 new commits:",
    "created_at": "2021-10-17T17:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494620",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>Last 10 new commits:



---

archive/issue_comments_494621.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-17T18:03:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494621",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_494622.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-10-17T18:03:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494622",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_494623.json:
```json
{
    "body": "<a id='comment:8'></a>Is this the expected output?\n\n```\nERROR: Could not find a version that satisfies the requirement tomli (from flit-core) (from versions: none)\nERROR: No matching distribution found for tomli\nWarning: installing with \"python3 -m pip install --verbose --no-index --find-links=/home/release/Sage/local/var/lib/sage/venv-python3.9/var/lib/sage/wheels --disable-pip-version-check --isolated --no-cache-dir\" failed. Retrying, adding \"--no-deps --ignore-installed --ignore-requires-python\"\nUsing pip 21.2.4 from /home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/pip (python 3.9)\nLooking in links: /home/release/Sage/local/var/lib/sage/venv-python3.9/var/lib/sage/wheels\nProcessing /home/release/Sage/local/var/lib/sage/venv-python3.9/var/tmp/sage/build/flit_core-3.4.0/inst/home/release/Sage/local/var/lib/sage/venv-python3.9/var/lib/sage/wheels/flit_core-3.4.0-py3-none-any.whl\nInstalling collected packages: flit-core\nSuccessfully installed flit-core-3.4.0\nWarning: The installation needed to use \"--no-deps --ignore-installed --ignore-requires-python\" to succeed. This means that a dependencies file in build/pkgs/ needs to be updated. Please report this to sage-devel@googlegroups.com, including the build log of this package.\n```",
    "created_at": "2021-10-17T22:46:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494623",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:8'></a>Is this the expected output?

```
ERROR: Could not find a version that satisfies the requirement tomli (from flit-core) (from versions: none)
ERROR: No matching distribution found for tomli
Warning: installing with "python3 -m pip install --verbose --no-index --find-links=/home/release/Sage/local/var/lib/sage/venv-python3.9/var/lib/sage/wheels --disable-pip-version-check --isolated --no-cache-dir" failed. Retrying, adding "--no-deps --ignore-installed --ignore-requires-python"
Using pip 21.2.4 from /home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/pip (python 3.9)
Looking in links: /home/release/Sage/local/var/lib/sage/venv-python3.9/var/lib/sage/wheels
Processing /home/release/Sage/local/var/lib/sage/venv-python3.9/var/tmp/sage/build/flit_core-3.4.0/inst/home/release/Sage/local/var/lib/sage/venv-python3.9/var/lib/sage/wheels/flit_core-3.4.0-py3-none-any.whl
Installing collected packages: flit-core
Successfully installed flit-core-3.4.0
Warning: The installation needed to use "--no-deps --ignore-installed --ignore-requires-python" to succeed. This means that a dependencies file in build/pkgs/ needs to be updated. Please report this to sage-devel@googlegroups.com, including the build log of this package.
```



---

archive/issue_comments_494624.json:
```json
{
    "body": "<a id='comment:9'></a>tox still depends on toml:\n\n```\nbuild/pkgs/tox/dependencies:$(PYTHON) packaging six filelock pluggy py toml virtualenv importlib_metadata | $(PYTHON_TOOLCHAIN)\n```",
    "created_at": "2021-10-17T22:48:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494624",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:9'></a>tox still depends on toml:

```
build/pkgs/tox/dependencies:$(PYTHON) packaging six filelock pluggy py toml virtualenv importlib_metadata | $(PYTHON_TOOLCHAIN)
```



---

archive/issue_comments_494625.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:8 vbraun]:\n> Is this the expected output?\n> \n> ```\n> Warning: The installation needed to use \"--no-deps --ignore-installed --ignore-requires-python\" to succeed. This means that a dependencies file in build/pkgs/ needs to be updated. Please report this to sage-devel@googlegroups.com, including the build log of this package.\n> ```\n\nYes",
    "created_at": "2021-10-17T23:29:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494625",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>Replying to [comment:8 vbraun]:
> Is this the expected output?
> 
> ```
> Warning: The installation needed to use "--no-deps --ignore-installed --ignore-requires-python" to succeed. This means that a dependencies file in build/pkgs/ needs to be updated. Please report this to sage-devel@googlegroups.com, including the build log of this package.
> ```

Yes



---

archive/issue_comments_494626.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-10-17T23:33:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494626",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_494627.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:9 vbraun]:\n> tox still depends on toml:\n> \n> ```\n> build/pkgs/tox/dependencies:$(PYTHON) packaging six filelock pluggy py toml virtualenv importlib_metadata | $(PYTHON_TOOLCHAIN)\n> ```\n\nThanks for catching this",
    "created_at": "2021-10-17T23:34:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494627",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>Replying to [comment:9 vbraun]:
> tox still depends on toml:
> 
> ```
> build/pkgs/tox/dependencies:$(PYTHON) packaging six filelock pluggy py toml virtualenv importlib_metadata | $(PYTHON_TOOLCHAIN)
> ```

Thanks for catching this



---

archive/issue_comments_494628.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n https://flit.readthedocs.io/en/latest/history.html#version-3-4\n+\n+This simplifies the dependencies and removes a \"circular dependency\" warning from the output during build.\n \n Comment: 1\n \n``````\n",
    "created_at": "2021-10-18T19:12:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494628",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
 https://flit.readthedocs.io/en/latest/history.html#version-3-4
+
+This simplifies the dependencies and removes a "circular dependency" warning from the output during build.
 
 Comment: 1
 
``````




---

archive/issue_comments_494629.json:
```json
{
    "body": "<a id='comment:15'></a>Ok its a bit sub-optimal to tell people to complain on sage-devel upon successful installation, but hopefully nobody looks into the log.\n\nHowever, building the source tarball fails because tox still depends on toml:\n\n```\nsage -sdist\n[...]\n[threejs-r122.p0] Using cached file /home/release/Sage/upstream/threejs-sage-r122.tar.gz\nmake[1]: Nothing to be done for 'tomli'.\nmake[1]: Nothing to be done for 'tornado'.\nmake[1]: *** No rule to make target 'toml', needed by '/home/release/Sage/local/var/lib/sage/venv-python3.9/var/lib/sage/installed/tox-3.24.3'.  Stop.\nmake: *** [Makefile:2336: download-for-sdist] Error 2\n```",
    "created_at": "2021-10-18T20:25:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494629",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:15'></a>Ok its a bit sub-optimal to tell people to complain on sage-devel upon successful installation, but hopefully nobody looks into the log.

However, building the source tarball fails because tox still depends on toml:

```
sage -sdist
[...]
[threejs-r122.p0] Using cached file /home/release/Sage/upstream/threejs-sage-r122.tar.gz
make[1]: Nothing to be done for 'tomli'.
make[1]: Nothing to be done for 'tornado'.
make[1]: *** No rule to make target 'toml', needed by '/home/release/Sage/local/var/lib/sage/venv-python3.9/var/lib/sage/installed/tox-3.24.3'.  Stop.
make: *** [Makefile:2336: download-for-sdist] Error 2
```



---

archive/issue_comments_494630.json:
```json
{
    "body": "<a id='comment:16'></a>Did you run `bootstrap`?",
    "created_at": "2021-10-18T20:52:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494630",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>Did you run `bootstrap`?



---

archive/issue_comments_494631.json:
```json
{
    "body": "<a id='comment:17'></a>Yes, did run bootstrap. The content of the source tarball hopefully doesn't depend on which system libraries are available.\n\nAlso just got this while trying the latest version\n\n```\n****************************************************\nUninstalling existing 'pyparsing'\nWarning: File '/home/release/Sage/local/var/lib/sage/wheels/pyparsing-2.4.7-py2.py3-none-any.whl' not found\nWarning: Directory '/home/release/Sage/local/var/lib/sage/wheels' not found\nRunning pip-uninstall script for 'pyparsing'\nFound existing installation: pyparsing 2.4.7\nUninstalling pyparsing-2.4.7:\n  Successfully uninstalled pyparsing-2.4.7\nRemoving stamp file '/home/release/Sage/local/var/lib/sage/venv-python3.9/var/lib/sage/installed/pyparsing-2.4.7'\nInstalling pyparsing-2.4.7\nProcessing /home/release/Sage/local/var/lib/sage/venv-python3.9/var/tmp/sage/build/pyparsing-2.4.7/src\n    Running command python setup.py egg_info\n    Traceback (most recent call last):\n      File \"<string>\", line 1, in <module>\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/var/tmp/sage/build/pyparsing-2.4.7/src/setup.py\", line 18, in <module>\n        setup(# Distribution meta-data\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/setuptools/__init__.py\", line 153, in setup\n        return distutils.core.setup(**attrs)\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/setuptools/_distutils/core.py\", line 108, in setup\n        _setup_distribution = dist = klass(attrs)\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/setuptools/dist.py\", line 450, in __init__\n        _Distribution.__init__(\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/setuptools/_distutils/dist.py\", line 293, in __init__\n        self.finalize_options()\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/setuptools/dist.py\", line 827, in finalize_options\n        for ep in sorted(loaded, key=by_order):\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/setuptools/dist.py\", line 826, in <lambda>\n        loaded = map(lambda e: e.load(), filtered)\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/pkg_resources/__init__.py\", line 2449, in load\n        self.require(*args, **kwargs)\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/pkg_resources/__init__.py\", line 2472, in require\n        items = working_set.resolve(reqs, env, installer, extras=self.extras)\n      File \"/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/pkg_resources/__init__.py\", line 772, in resolve\n        raise DistributionNotFound(req, requirers)\n    pkg_resources.DistributionNotFound: The 'tomli>=1.0.0' distribution was not found and is required by the application\nWARNING: Discarding file:///home/release/Sage/local/var/lib/sage/venv-python3.9/var/tmp/sage/build/pyparsing-2.4.7/src. Command errored out with exit status 1: python setup.py egg_info Check the logs for full command output.\nERROR: Command errored out with exit status 1: python setup.py egg_info Check the logs for full command output.\n**************************************************************************************************************************************************************\nError building a wheel for pyparsing-2.4.7\n**************************************************************************************************************************************************************\n```",
    "created_at": "2021-10-18T20:54:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494631",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:17'></a>Yes, did run bootstrap. The content of the source tarball hopefully doesn't depend on which system libraries are available.

Also just got this while trying the latest version

```
****************************************************
Uninstalling existing 'pyparsing'
Warning: File '/home/release/Sage/local/var/lib/sage/wheels/pyparsing-2.4.7-py2.py3-none-any.whl' not found
Warning: Directory '/home/release/Sage/local/var/lib/sage/wheels' not found
Running pip-uninstall script for 'pyparsing'
Found existing installation: pyparsing 2.4.7
Uninstalling pyparsing-2.4.7:
  Successfully uninstalled pyparsing-2.4.7
Removing stamp file '/home/release/Sage/local/var/lib/sage/venv-python3.9/var/lib/sage/installed/pyparsing-2.4.7'
Installing pyparsing-2.4.7
Processing /home/release/Sage/local/var/lib/sage/venv-python3.9/var/tmp/sage/build/pyparsing-2.4.7/src
    Running command python setup.py egg_info
    Traceback (most recent call last):
      File "<string>", line 1, in <module>
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/var/tmp/sage/build/pyparsing-2.4.7/src/setup.py", line 18, in <module>
        setup(# Distribution meta-data
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/setuptools/__init__.py", line 153, in setup
        return distutils.core.setup(**attrs)
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/setuptools/_distutils/core.py", line 108, in setup
        _setup_distribution = dist = klass(attrs)
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/setuptools/dist.py", line 450, in __init__
        _Distribution.__init__(
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/setuptools/_distutils/dist.py", line 293, in __init__
        self.finalize_options()
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/setuptools/dist.py", line 827, in finalize_options
        for ep in sorted(loaded, key=by_order):
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/setuptools/dist.py", line 826, in <lambda>
        loaded = map(lambda e: e.load(), filtered)
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/pkg_resources/__init__.py", line 2449, in load
        self.require(*args, **kwargs)
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/pkg_resources/__init__.py", line 2472, in require
        items = working_set.resolve(reqs, env, installer, extras=self.extras)
      File "/home/release/Sage/local/var/lib/sage/venv-python3.9/lib64/python3.9/site-packages/pkg_resources/__init__.py", line 772, in resolve
        raise DistributionNotFound(req, requirers)
    pkg_resources.DistributionNotFound: The 'tomli>=1.0.0' distribution was not found and is required by the application
WARNING: Discarding file:///home/release/Sage/local/var/lib/sage/venv-python3.9/var/tmp/sage/build/pyparsing-2.4.7/src. Command errored out with exit status 1: python setup.py egg_info Check the logs for full command output.
ERROR: Command errored out with exit status 1: python setup.py egg_info Check the logs for full command output.
**************************************************************************************************************************************************************
Error building a wheel for pyparsing-2.4.7
**************************************************************************************************************************************************************
```



---

archive/issue_comments_494632.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:15 vbraun]:\n> Ok its a bit sub-optimal to tell people to complain on sage-devel upon successful installation, but hopefully nobody looks into the log.\n\n\nYes, we can address this in #32715.",
    "created_at": "2021-10-18T21:00:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494632",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>Replying to [comment:15 vbraun]:
> Ok its a bit sub-optimal to tell people to complain on sage-devel upon successful installation, but hopefully nobody looks into the log.


Yes, we can address this in #32715.



---

archive/issue_comments_494633.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [comment:17 vbraun]:\n> Yes, did run bootstrap. The content of the source tarball hopefully doesn't depend on which system libraries are available.\n\n\nAsking because it looks like what a make run would look like after the `toml` package has been removed.",
    "created_at": "2021-10-18T21:06:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494633",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>Replying to [comment:17 vbraun]:
> Yes, did run bootstrap. The content of the source tarball hopefully doesn't depend on which system libraries are available.


Asking because it looks like what a make run would look like after the `toml` package has been removed.



---

archive/issue_comments_494634.json:
```json
{
    "body": "<a id='comment:20'></a>I recommend to use `make dist` instead of directly using `./sage --sdist`, which takes care of regenerating the Makefile.",
    "created_at": "2021-10-18T21:12:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494634",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>I recommend to use `make dist` instead of directly using `./sage --sdist`, which takes care of regenerating the Makefile.



---

archive/issue_comments_494635.json:
```json
{
    "body": "<a id='comment:21'></a>Replying to [comment:17 vbraun]:\n> Also just got this while trying the latest version\n> \n> ```\n> ****************************************************\n> Uninstalling existing 'pyparsing'\n> Warning: File '/home/release/Sage/local/var/lib/sage/wheels/pyparsing-2.4.7-py2.py3-none-any.whl' not found\n> Warning: Directory '/home/release/Sage/local/var/lib/sage/wheels' not found\n> Running pip-uninstall script for 'pyparsing'\n> Found existing installation: pyparsing 2.4.7\n> ```\n\nBest to get rid of this messed up worktree",
    "created_at": "2021-10-18T21:24:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494635",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>Replying to [comment:17 vbraun]:
> Also just got this while trying the latest version
> 
> ```
> ****************************************************
> Uninstalling existing 'pyparsing'
> Warning: File '/home/release/Sage/local/var/lib/sage/wheels/pyparsing-2.4.7-py2.py3-none-any.whl' not found
> Warning: Directory '/home/release/Sage/local/var/lib/sage/wheels' not found
> Running pip-uninstall script for 'pyparsing'
> Found existing installation: pyparsing 2.4.7
> ```

Best to get rid of this messed up worktree



---

archive/issue_comments_494636.json:
```json
{
    "body": "<a id='comment:22'></a>The pyparsing error says that tomli is required, but its not listed as a dependency\n\n```\n[release@zen Sage]$ cat build/pkgs/pyparsing/dependencies \n$(PYTHON) | setuptools pip wheel\n```\nI think thats a real dependency error",
    "created_at": "2021-10-18T22:46:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494636",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:22'></a>The pyparsing error says that tomli is required, but its not listed as a dependency

```
[release@zen Sage]$ cat build/pkgs/pyparsing/dependencies 
$(PYTHON) | setuptools pip wheel
```
I think thats a real dependency error



---

archive/issue_comments_494637.json:
```json
{
    "body": "<a id='comment:23'></a>There's nothing in pyparsing that refers to tomli.\n\nI think in your worktree, you have for some reason a broken installation record of pip packages.\n\nCan you reproduce this in a from scratch build?",
    "created_at": "2021-10-18T22:50:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494637",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>There's nothing in pyparsing that refers to tomli.

I think in your worktree, you have for some reason a broken installation record of pip packages.

Can you reproduce this in a from scratch build?



---

archive/issue_comments_494638.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-10-19T20:29:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494638",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_494639.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-10-19T20:30:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494639",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_086599.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-19T20:30:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32707#event-86599"
}
```



---

archive/issue_comments_494640.json:
```json
{
    "body": "<a id='comment:26'></a>I'm still getting very frequent `pkg_resources.DistributionNotFound: The 'xxx>=20.0' distribution was not found and is required by the application` errors with incremental builds with some packaging-related pip packages. Basically have to do a `make distclean` every day now. Something is messed up there...",
    "created_at": "2021-10-24T08:48:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494640",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:26'></a>I'm still getting very frequent `pkg_resources.DistributionNotFound: The 'xxx>=20.0' distribution was not found and is required by the application` errors with incremental builds with some packaging-related pip packages. Basically have to do a `make distclean` every day now. Something is messed up there...



---

archive/issue_comments_494641.json:
```json
{
    "body": "<a id='comment:27'></a>I've created #32751 for this issue",
    "created_at": "2021-10-24T09:13:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494641",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:27'></a>I've created #32751 for this issue



---

archive/issue_comments_494642.json:
```json
{
    "body": "<a id='comment:28'></a>The issue is not fixed, I still see very frequent `pkg_resources.DistributionNotFound: The 'xxx>=20.0' distribution was not found and is required by the application` errors during incremental builds",
    "created_at": "2021-11-07T10:09:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32707",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32707#issuecomment-494642",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:28'></a>The issue is not fixed, I still see very frequent `pkg_resources.DistributionNotFound: The 'xxx>=20.0' distribution was not found and is required by the application` errors during incremental builds
