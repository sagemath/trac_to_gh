# Issue 32292: Reduction of Point Clusters

archive/issues_032055.json:
```json
{
    "assignees": [],
    "body": "In [https://arxiv.org/abs/0909.2808](https://arxiv.org/abs/0909.2808), Stoll proves that there exists a minimal representative of a point cluster. A point cluster is a formal sum of points of projective space. Here, minimal means that the representative minimizes the convariant he defines.\n\nThis ticket aims to add functions to find an approximation of the minimal representative. Such an approximation is useful as it can be used to reduce projective subschemes of dimension less than 1. We add a method to projective subschemes which implements such a reduction.\n\nCC:  @bhutz\n\nComponent: **algebraic geometry**\n\nKeywords: **gsoc2021**\n\nAuthor: **Alexander Galarraga**\n\nBranch/Commit: **[u/gh-EnderWannabe/cluster_reduction](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-EnderWannabe/cluster_reduction) @ [`59814a8`](https://github.com/sagemath/sagetrac-mirror/commit/59814a8557cfb7136a54419495da2315a697458a)**\n\nReviewer: **Ben Hutz**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/32292_\n\n",
    "created_at": "2021-07-28T20:18:16Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20algebraic%20geometry",
        "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/needs%20review"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Reduction of Point Clusters",
    "type": "issue",
    "updated_at": "2022-09-19T18:58:47Z",
    "url": "https://github.com/sagemath/sage/issues/32292",
    "user": "https://github.com/EnderWannabe"
}
```
In [https://arxiv.org/abs/0909.2808](https://arxiv.org/abs/0909.2808), Stoll proves that there exists a minimal representative of a point cluster. A point cluster is a formal sum of points of projective space. Here, minimal means that the representative minimizes the convariant he defines.

This ticket aims to add functions to find an approximation of the minimal representative. Such an approximation is useful as it can be used to reduce projective subschemes of dimension less than 1. We add a method to projective subschemes which implements such a reduction.

CC:  @bhutz

Component: **algebraic geometry**

Keywords: **gsoc2021**

Author: **Alexander Galarraga**

Branch/Commit: **[u/gh-EnderWannabe/cluster_reduction](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-EnderWannabe/cluster_reduction) @ [`59814a8`](https://github.com/sagemath/sagetrac-mirror/commit/59814a8557cfb7136a54419495da2315a697458a)**

Reviewer: **Ben Hutz**

_Issue created by migration from https://trac.sagemath.org/ticket/32292_





---

archive/issue_events_442159.json:
```json
{
    "actor": "https://github.com/EnderWannabe",
    "created_at": "2021-07-28T20:18:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442159"
}
```



---

archive/issue_events_442160.json:
```json
{
    "actor": "https://github.com/EnderWannabe",
    "created_at": "2021-07-28T20:18:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebraic%20geometry",
    "label_color": "0000ff",
    "label_name": "c: algebraic geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442160"
}
```



---

archive/issue_events_442161.json:
```json
{
    "actor": "https://github.com/EnderWannabe",
    "created_at": "2021-07-28T20:18:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442161"
}
```



---

archive/issue_events_442162.json:
```json
{
    "actor": "https://github.com/EnderWannabe",
    "created_at": "2021-07-28T20:18:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442162"
}
```



---

archive/issue_comments_519925.json:
```json
{
    "body": "Branch: **[u/gh-EnderWannabe/cluster_reduction](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-EnderWannabe/cluster_reduction)**",
    "created_at": "2021-07-28T20:18:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519925",
    "user": "https://github.com/EnderWannabe"
}
```

Branch: **[u/gh-EnderWannabe/cluster_reduction](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-EnderWannabe/cluster_reduction)**



---

archive/issue_comments_519926.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nA couple comments here.\n\n- Reduction theory of point clusters in projective space is published: https://ems.press/journals/ggd/articles/4454\n\n\n- `subschemes of dimension less than 1`  why not say dimension 0. If there are no points it doesn't work either...\n\n\n- need a statement that this is not necessarily the smallest possible coefficients, just one that corresponds to the minimal covariant (and there could be others)\n\n\n- `We create a subscheme of dimension 1 with large coefficients and reduce`  -> dimension 0\n\n\n\n- This one gets the False return in Magma and a different value the this function. What is happening with it?\n\n```\nP.<x,y>=ProjectiveSpace(QQ,1)\nf=DynamicalSystem([23454*x^2 + 234087*y^2, 234729384*y^2])\nX=f.periodic_points(1,return_scheme=True)\nprint(X)\nX.reduce_coefficients(return_transformation=True)\n```\n\n\n\n- Here is a P3 example\n\n```\n#long time\nP.<x,y,z,w>=ProjectiveSpace(QQ, 3)\nX = P.subscheme([2342*x^2*y - 23744*x*y^2 + 2234398*y^2*w - 239874234*x*w^2,\\\n  223487*x*y^2 + 2342*x^2*z - 23234975*x*z^2 + 2234398*y*z*w,\\\n  2342*x^2*w - 23284*x*w^2 + 2234398*y*w^2,\\\n  223487*y^3 + 23744*y^2*z - 23234975*y*z^2 + 239874234*z*w^2,\\\n  23744*y^2*w - 23284*y*w^2 + 239874234*w^3,\\\n  -223487*y^2*w + 23234975*z^2*w - 23284*z*w^2])\nX.reduce_coefficients(return_transformation=True)\n```\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6c0f68228699a0643e43de0c83539612ae4b0c8c\"><code>6c0f682</code></a></td><td><code>32292: initial commit with code and docs</code></td></tr></table>\n",
    "created_at": "2021-07-29T16:00:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519926",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:2" align="right">comment:2</div>

A couple comments here.

- Reduction theory of point clusters in projective space is published: https://ems.press/journals/ggd/articles/4454


- `subschemes of dimension less than 1`  why not say dimension 0. If there are no points it doesn't work either...


- need a statement that this is not necessarily the smallest possible coefficients, just one that corresponds to the minimal covariant (and there could be others)


- `We create a subscheme of dimension 1 with large coefficients and reduce`  -> dimension 0



- This one gets the False return in Magma and a different value the this function. What is happening with it?

```
P.<x,y>=ProjectiveSpace(QQ,1)
f=DynamicalSystem([23454*x^2 + 234087*y^2, 234729384*y^2])
X=f.periodic_points(1,return_scheme=True)
print(X)
X.reduce_coefficients(return_transformation=True)
```



- Here is a P3 example

```
#long time
P.<x,y,z,w>=ProjectiveSpace(QQ, 3)
X = P.subscheme([2342*x^2*y - 23744*x*y^2 + 2234398*y^2*w - 239874234*x*w^2,\
  223487*x*y^2 + 2342*x^2*z - 23234975*x*z^2 + 2234398*y*z*w,\
  2342*x^2*w - 23284*x*w^2 + 2234398*y*w^2,\
  223487*y^3 + 23744*y^2*z - 23234975*y*z^2 + 239874234*z*w^2,\
  23744*y^2*w - 23284*y*w^2 + 239874234*w^3,\
  -223487*y^2*w + 23234975*z^2*w - 23284*z*w^2])
X.reduce_coefficients(return_transformation=True)
```

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6c0f68228699a0643e43de0c83539612ae4b0c8c"><code>6c0f682</code></a></td><td><code>32292: initial commit with code and docs</code></td></tr></table>




---

archive/issue_comments_519927.json:
```json
{
    "body": "Commit: **[`6c0f682`](https://github.com/sagemath/sagetrac-mirror/commit/6c0f68228699a0643e43de0c83539612ae4b0c8c)**",
    "created_at": "2021-07-29T16:00:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519927",
    "user": "https://github.com/bhutz"
}
```

Commit: **[`6c0f682`](https://github.com/sagemath/sagetrac-mirror/commit/6c0f68228699a0643e43de0c83539612ae4b0c8c)**



---

archive/issue_comments_519928.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5254a5e6e561cad672cd5874eedb830795a1ac6d\"><code>5254a5e</code></a></td><td><code>Merge branch 'u/gh-EnderWannabe/cluster_reduction' of git://trac.sagemath.org/sage into cluster_reduce</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ab7d522a1504dfe3f4ca51dd175fa91ea5dea824\"><code>ab7d522</code></a></td><td><code>32292: added example and fixed wording</code></td></tr></table>\n",
    "created_at": "2021-08-02T22:09:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519928",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5254a5e6e561cad672cd5874eedb830795a1ac6d"><code>5254a5e</code></a></td><td><code>Merge branch 'u/gh-EnderWannabe/cluster_reduction' of git://trac.sagemath.org/sage into cluster_reduce</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ab7d522a1504dfe3f4ca51dd175fa91ea5dea824"><code>ab7d522</code></a></td><td><code>32292: added example and fixed wording</code></td></tr></table>




---

archive/issue_comments_519929.json:
```json
{
    "body": "Changed commit from **[`6c0f682`](https://github.com/sagemath/sagetrac-mirror/commit/6c0f68228699a0643e43de0c83539612ae4b0c8c)** to **[`ab7d522`](https://github.com/sagemath/sagetrac-mirror/commit/ab7d522a1504dfe3f4ca51dd175fa91ea5dea824)**",
    "created_at": "2021-08-02T22:09:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519929",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6c0f682`](https://github.com/sagemath/sagetrac-mirror/commit/6c0f68228699a0643e43de0c83539612ae4b0c8c)** to **[`ab7d522`](https://github.com/sagemath/sagetrac-mirror/commit/ab7d522a1504dfe3f4ca51dd175fa91ea5dea824)**



---

archive/issue_comments_519930.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@bhutz](#comment%3A2):\n\n> This one gets the False return in Magma and a different value the this function. What is happening with it?\n\nNot sure what is happening in your local Magma. Running reduce cluster on the points defined by that scheme on the online Magma calculator gives the correct output\n\n\n```\nC := ComplexField(30);\nlist := [Vector([C!0.000997263398969287822568751566512409423879206685727301710349110387118173172038025883370782563646410577176913432551825758831818069949792437117084439457231, C!1.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000]),\nVector([C!1.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000, C!0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000]),\nVector([C!10008.0737021482152542987724683423193919139324779178985653562584408614726925200998985307807376850751358866855501267311729120257678237821863037511663640, C!1.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000])];\nReduceCluster(list);\n```",
    "created_at": "2021-08-02T22:16:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519930",
    "user": "https://github.com/EnderWannabe"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@bhutz](#comment%3A2):

> This one gets the False return in Magma and a different value the this function. What is happening with it?

Not sure what is happening in your local Magma. Running reduce cluster on the points defined by that scheme on the online Magma calculator gives the correct output


```
C := ComplexField(30);
list := [Vector([C!0.000997263398969287822568751566512409423879206685727301710349110387118173172038025883370782563646410577176913432551825758831818069949792437117084439457231, C!1.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000]),
Vector([C!1.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000, C!0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000]),
Vector([C!10008.0737021482152542987724683423193919139324779178985653562584408614726925200998985307807376850751358866855501267311729120257678237821863037511663640, C!1.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000])];
ReduceCluster(list);
```



---

archive/issue_comments_519931.json:
```json
{
    "body": "Reviewer: **Ben Hutz**",
    "created_at": "2021-08-03T14:03:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519931",
    "user": "https://github.com/bhutz"
}
```

Reviewer: **Ben Hutz**



---

archive/issue_comments_519932.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\n- If you run the example from the equations rather than the points, you get the False\n\n```\nP1<x,y> := ProjectiveSpace(Rationals(), 1);\nX:=Cluster(P1,[23454*x^2*y - 234729384*x*y^2 + 234087*y^3]);\nReduceCluster(X);\n```\nIf you run it with the points Magma, is producing the same output as this function. I wonder if the False, is just noting that the new version has larger coefficients so you're better off with the identity?\n\n--\n\n- I looked through the code and had a few more comments.\n\n- name: What do you think about `reduced_form()` so that it matches the other function (in rings/polynomial/multi_polynomial.pyx)\n\n- 1440, 1472 point cluster is a Magma term -> dimension zero scheme is more familiar to our users\n\n- period at end of lines 1460, 1464\n\n- 1475. grammer: Seems like `that transformation` is referencing `representative`, which is not right. Need to re-word this a little bit\n\n- 1548. example has no output\n\n- 1551. Scheme must be dimension 0\n\n- 1552. do no need the extra variable subscheme (just use `self`)\n\n- 1561 output description says tuple, but you are simple returning two objects\n\n\n\n- reduce_cluster.py\n\n- file needs full header\n  - author\n  - copyright\n  - GPL\n\n- no camelcase for function names. Need to change throughout code and documentation\n\n- line 7,31. end citation with underscore [Sto2009]_\n\n- line 9, 36. The function was `adapted` from code provided by Stoll.\n\n- line 70. err, isn't S[0] a point. So you just need `S[0].codomain().dimension_relative()+1`\n\n- line 75 - fails if no embedding\n\n- 76 - do you actually need to coerce the norm to be real?\n\n- 80,83 - [0][0] makes more sense in python\n\n- 86:  what is the difference in output when totalcount exits the loop?\n\n- 122 - you have `B*pnt` and Stoll has `pnt*B` (whereas 131 you match his order). I'm getting the correct answers either way, which is interesting...\n\n\n- 128 - need comment here\n\n- line 146, 148, 151 - ending period\n\n- 176 - instead of doing `eps**2` for every loop, do that computation once\n\n- need blank line at end of file",
    "created_at": "2021-08-03T14:03:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519932",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:5" align="right">comment:5</div>

- If you run the example from the equations rather than the points, you get the False

```
P1<x,y> := ProjectiveSpace(Rationals(), 1);
X:=Cluster(P1,[23454*x^2*y - 234729384*x*y^2 + 234087*y^3]);
ReduceCluster(X);
```
If you run it with the points Magma, is producing the same output as this function. I wonder if the False, is just noting that the new version has larger coefficients so you're better off with the identity?

--

- I looked through the code and had a few more comments.

- name: What do you think about `reduced_form()` so that it matches the other function (in rings/polynomial/multi_polynomial.pyx)

- 1440, 1472 point cluster is a Magma term -> dimension zero scheme is more familiar to our users

- period at end of lines 1460, 1464

- 1475. grammer: Seems like `that transformation` is referencing `representative`, which is not right. Need to re-word this a little bit

- 1548. example has no output

- 1551. Scheme must be dimension 0

- 1552. do no need the extra variable subscheme (just use `self`)

- 1561 output description says tuple, but you are simple returning two objects



- reduce_cluster.py

- file needs full header
  - author
  - copyright
  - GPL

- no camelcase for function names. Need to change throughout code and documentation

- line 7,31. end citation with underscore [Sto2009]_

- line 9, 36. The function was `adapted` from code provided by Stoll.

- line 70. err, isn't S[0] a point. So you just need `S[0].codomain().dimension_relative()+1`

- line 75 - fails if no embedding

- 76 - do you actually need to coerce the norm to be real?

- 80,83 - [0][0] makes more sense in python

- 86:  what is the difference in output when totalcount exits the loop?

- 122 - you have `B*pnt` and Stoll has `pnt*B` (whereas 131 you match his order). I'm getting the correct answers either way, which is interesting...


- 128 - need comment here

- line 146, 148, 151 - ending period

- 176 - instead of doing `eps**2` for every loop, do that computation once

- need blank line at end of file



---

archive/issue_comments_519933.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f2655381f8b8c7ca7abe05084a5c6cfdea832f86\"><code>f265538</code></a></td><td><code>32292: fixes for docs and functionality</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bd5ac381f8b7e4f28ff9a15e8fa3dcfc73e15a09\"><code>bd5ac38</code></a></td><td><code>32292: added height check</code></td></tr></table>\n",
    "created_at": "2021-08-03T22:25:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519933",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f2655381f8b8c7ca7abe05084a5c6cfdea832f86"><code>f265538</code></a></td><td><code>32292: fixes for docs and functionality</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bd5ac381f8b7e4f28ff9a15e8fa3dcfc73e15a09"><code>bd5ac38</code></a></td><td><code>32292: added height check</code></td></tr></table>




---

archive/issue_comments_519934.json:
```json
{
    "body": "Changed commit from **[`ab7d522`](https://github.com/sagemath/sagetrac-mirror/commit/ab7d522a1504dfe3f4ca51dd175fa91ea5dea824)** to **[`bd5ac38`](https://github.com/sagemath/sagetrac-mirror/commit/bd5ac381f8b7e4f28ff9a15e8fa3dcfc73e15a09)**",
    "created_at": "2021-08-03T22:25:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519934",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ab7d522`](https://github.com/sagemath/sagetrac-mirror/commit/ab7d522a1504dfe3f4ca51dd175fa91ea5dea824)** to **[`bd5ac38`](https://github.com/sagemath/sagetrac-mirror/commit/bd5ac381f8b7e4f28ff9a15e8fa3dcfc73e15a09)**



---

archive/issue_comments_519935.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@bhutz](#comment%3A5):\n\n> If you run it with the points Magma, is producing the same output as this function. I wonder if the False, is just noting that the new version has larger coefficients so you're better off with the identity?\n\nAdded a check to emulate that functionality\n\n> - 1548. example has no output\n\nAdded output, but I can't quite get the formatting right. Could you take a look?\n\n\n> - 122 - you have `B*pnt` and Stoll has `pnt*B` (whereas 131 you match his order). I'm getting the correct answers either way, which is interesting...\n\nTaking a look at it, B is a symmetric matrix. B1 is a symmetrix matrix, and B is e<sup>B1</sup>, which is also symmetric.",
    "created_at": "2021-08-03T22:31:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519935",
    "user": "https://github.com/EnderWannabe"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@bhutz](#comment%3A5):

> If you run it with the points Magma, is producing the same output as this function. I wonder if the False, is just noting that the new version has larger coefficients so you're better off with the identity?

Added a check to emulate that functionality

> - 1548. example has no output

Added output, but I can't quite get the formatting right. Could you take a look?


> - 122 - you have `B*pnt` and Stoll has `pnt*B` (whereas 131 you match his order). I'm getting the correct answers either way, which is interesting...

Taking a look at it, B is a symmetric matrix. B1 is a symmetrix matrix, and B is e<sup>B1</sup>, which is also symmetric.



---

archive/issue_comments_519936.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cffe758cba2146eeceb507db59167428243cc662\"><code>cffe758</code></a></td><td><code>32292: added copyright</code></td></tr></table>\n",
    "created_at": "2021-08-03T22:31:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519936",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cffe758cba2146eeceb507db59167428243cc662"><code>cffe758</code></a></td><td><code>32292: added copyright</code></td></tr></table>




---

archive/issue_comments_519937.json:
```json
{
    "body": "Changed commit from **[`bd5ac38`](https://github.com/sagemath/sagetrac-mirror/commit/bd5ac381f8b7e4f28ff9a15e8fa3dcfc73e15a09)** to **[`cffe758`](https://github.com/sagemath/sagetrac-mirror/commit/cffe758cba2146eeceb507db59167428243cc662)**",
    "created_at": "2021-08-03T22:31:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519937",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`bd5ac38`](https://github.com/sagemath/sagetrac-mirror/commit/bd5ac381f8b7e4f28ff9a15e8fa3dcfc73e15a09)** to **[`cffe758`](https://github.com/sagemath/sagetrac-mirror/commit/cffe758cba2146eeceb507db59167428243cc662)**



---

archive/issue_events_442163.json:
```json
{
    "actor": "https://github.com/EnderWannabe",
    "created_at": "2021-08-04T19:11:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442163"
}
```



---

archive/issue_events_442164.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-10T17:30:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442164"
}
```



---

archive/issue_events_442165.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-10T17:30:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442165"
}
```



---

archive/issue_comments_519938.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThe main issue I've found is the embedding code is not working; both passing in an embedding and letting the code choose one.\n\n- embedding parameter doesn't work\n\n```\nR.<x> = QQ[]\nK.<k> = NumberField(x^2 + 1)\nP.<x,y,z> = ProjectiveSpace(K, 2)\nemb=K.embeddings(CC)[0]\nX = P.subscheme([2141136680*x^2 - 27173976948*x*y + 86218809624*y^2 - 3237154682*x*z + 20541978363*y*z + 1223552253*z^2, \\\n                      (-23886292125*k + 10098628775)*x^2 + (303150593245*k - 128165707435)*x*y \\\n                      + (-961851694100*k + 406650470284)*y^2 + (36113395312*k - 15267989043)*x*z \\\n                      + (-229164852285*k + 96886055543)*y*z + (-13649851075*k + 5770869853)*z^2, \\\n                      453608122027250*x^3 - 8635374873437055*x^2*y + 54797445624349105*x*y^2 \\\n                      - 115909272072050820*y^3 - 1028706119154993*x^2*z + 13055708282282128*x*y*z \\\n                      - 41423764177605297*y^2*z + 777643541637373*x*z^2 - 4934687875458069*y*z^2 - 195951485913414*z^3])\nX.reduced_form(embedding=emb)\n```\n\n- same is true when your code picks the embedding\n\n```\nR.<x> = QQ[]\nK.<k> = NumberField(x^4 + 1)\nP.<x,y,z> = ProjectiveSpace(K, 2)\nX = P.subscheme([2141136680*x^2 - 27173976948*x*y + 86218809624*y^2 - 3237154682*x*z + 20541978363*y*z + 1223552253*z^2, \\\n                      (-23886292125*k + 10098628775)*x^2 + (303150593245*k - 128165707435)*x*y \\\n                      + (-961851694100*k + 406650470284)*y^2 + (36113395312*k - 15267989043)*x*z \\\n                      + (-229164852285*k + 96886055543)*y*z + (-13649851075*k + 5770869853)*z^2, \\\n                      453608122027250*x^3 - 8635374873437055*x^2*y + 54797445624349105*x*y^2 \\\n                      - 115909272072050820*y^3 - 1028706119154993*x^2*z + 13055708282282128*x*y*z \\\n                      - 41423764177605297*y^2*z + 777643541637373*x*z^2 - 4934687875458069*y*z^2 - 195951485913414*z^3])\nX.reduced_form()\n```\n\n\n- output says tuple as return type -- that is not what you have\n\n- no [CamelCase](../wiki/CamelCase) for function names (e.g., MatExp)",
    "created_at": "2021-08-13T16:28:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519938",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:11" align="right">comment:11</div>

The main issue I've found is the embedding code is not working; both passing in an embedding and letting the code choose one.

- embedding parameter doesn't work

```
R.<x> = QQ[]
K.<k> = NumberField(x^2 + 1)
P.<x,y,z> = ProjectiveSpace(K, 2)
emb=K.embeddings(CC)[0]
X = P.subscheme([2141136680*x^2 - 27173976948*x*y + 86218809624*y^2 - 3237154682*x*z + 20541978363*y*z + 1223552253*z^2, \
                      (-23886292125*k + 10098628775)*x^2 + (303150593245*k - 128165707435)*x*y \
                      + (-961851694100*k + 406650470284)*y^2 + (36113395312*k - 15267989043)*x*z \
                      + (-229164852285*k + 96886055543)*y*z + (-13649851075*k + 5770869853)*z^2, \
                      453608122027250*x^3 - 8635374873437055*x^2*y + 54797445624349105*x*y^2 \
                      - 115909272072050820*y^3 - 1028706119154993*x^2*z + 13055708282282128*x*y*z \
                      - 41423764177605297*y^2*z + 777643541637373*x*z^2 - 4934687875458069*y*z^2 - 195951485913414*z^3])
X.reduced_form(embedding=emb)
```

- same is true when your code picks the embedding

```
R.<x> = QQ[]
K.<k> = NumberField(x^4 + 1)
P.<x,y,z> = ProjectiveSpace(K, 2)
X = P.subscheme([2141136680*x^2 - 27173976948*x*y + 86218809624*y^2 - 3237154682*x*z + 20541978363*y*z + 1223552253*z^2, \
                      (-23886292125*k + 10098628775)*x^2 + (303150593245*k - 128165707435)*x*y \
                      + (-961851694100*k + 406650470284)*y^2 + (36113395312*k - 15267989043)*x*z \
                      + (-229164852285*k + 96886055543)*y*z + (-13649851075*k + 5770869853)*z^2, \
                      453608122027250*x^3 - 8635374873437055*x^2*y + 54797445624349105*x*y^2 \
                      - 115909272072050820*y^3 - 1028706119154993*x^2*z + 13055708282282128*x*y*z \
                      - 41423764177605297*y^2*z + 777643541637373*x*z^2 - 4934687875458069*y*z^2 - 195951485913414*z^3])
X.reduced_form()
```


- output says tuple as return type -- that is not what you have

- no [CamelCase](../wiki/CamelCase) for function names (e.g., MatExp)



---

archive/issue_events_442166.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2021-08-13T16:28:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442166"
}
```



---

archive/issue_events_442167.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2021-08-13T16:28:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442167"
}
```



---

archive/issue_comments_519939.json:
```json
{
    "body": "Changed commit from **[`cffe758`](https://github.com/sagemath/sagetrac-mirror/commit/cffe758cba2146eeceb507db59167428243cc662)** to **[`12f721f`](https://github.com/sagemath/sagetrac-mirror/commit/12f721fbe68e38ee4763ba5626057a4439b9638a)**",
    "created_at": "2021-08-13T22:27:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519939",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`cffe758`](https://github.com/sagemath/sagetrac-mirror/commit/cffe758cba2146eeceb507db59167428243cc662)** to **[`12f721f`](https://github.com/sagemath/sagetrac-mirror/commit/12f721fbe68e38ee4763ba5626057a4439b9638a)**



---

archive/issue_comments_519940.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/016dd1ee580f69b433370d9bd48afe9e07368027\"><code>016dd1e</code></a></td><td><code>Merge branch 'u/gh-EnderWannabe/cluster_reduction' of git://trac.sagemath.org/sage into cluster_reduce</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/12f721fbe68e38ee4763ba5626057a4439b9638a\"><code>12f721f</code></a></td><td><code>32292: fixed embedding parameter</code></td></tr></table>\n",
    "created_at": "2021-08-13T22:27:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519940",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/016dd1ee580f69b433370d9bd48afe9e07368027"><code>016dd1e</code></a></td><td><code>Merge branch 'u/gh-EnderWannabe/cluster_reduction' of git://trac.sagemath.org/sage into cluster_reduce</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/12f721fbe68e38ee4763ba5626057a4439b9638a"><code>12f721f</code></a></td><td><code>32292: fixed embedding parameter</code></td></tr></table>




---

archive/issue_comments_519941.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a3b527d0601efe64c0142a8714e6072f19132ad\"><code>3a3b527</code></a></td><td><code>32292: added documentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/994868566fe4385ba9e44fdc796e69041285c78b\"><code>9948685</code></a></td><td><code>32292: updated error message</code></td></tr></table>\n",
    "created_at": "2021-08-13T22:32:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519941",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a3b527d0601efe64c0142a8714e6072f19132ad"><code>3a3b527</code></a></td><td><code>32292: added documentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/994868566fe4385ba9e44fdc796e69041285c78b"><code>9948685</code></a></td><td><code>32292: updated error message</code></td></tr></table>




---

archive/issue_comments_519942.json:
```json
{
    "body": "Changed commit from **[`12f721f`](https://github.com/sagemath/sagetrac-mirror/commit/12f721fbe68e38ee4763ba5626057a4439b9638a)** to **[`9948685`](https://github.com/sagemath/sagetrac-mirror/commit/994868566fe4385ba9e44fdc796e69041285c78b)**",
    "created_at": "2021-08-13T22:32:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519942",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`12f721f`](https://github.com/sagemath/sagetrac-mirror/commit/12f721fbe68e38ee4763ba5626057a4439b9638a)** to **[`9948685`](https://github.com/sagemath/sagetrac-mirror/commit/994868566fe4385ba9e44fdc796e69041285c78b)**



---

archive/issue_comments_519943.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThe embedding keyword should be fixed now. I switched from using an actual embedding to using complex numbers.\n\nThe return type is a tuple when `return_transformation` is `True`.\n\n```\ntype(X.reduced_form(embedding=emb, return_transformation=True))\n<class 'tuple'>\n```\nBut it isn't when `return_transformation` is `False`. Do you think these should both be tuples?",
    "created_at": "2021-08-13T22:34:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519943",
    "user": "https://github.com/EnderWannabe"
}
```

<div id="comment:14" align="right">comment:14</div>

The embedding keyword should be fixed now. I switched from using an actual embedding to using complex numbers.

The return type is a tuple when `return_transformation` is `True`.

```
type(X.reduced_form(embedding=emb, return_transformation=True))
<class 'tuple'>
```
But it isn't when `return_transformation` is `False`. Do you think these should both be tuples?



---

archive/issue_events_442168.json:
```json
{
    "actor": "https://github.com/EnderWannabe",
    "created_at": "2021-08-13T22:36:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442168"
}
```



---

archive/issue_events_442169.json:
```json
{
    "actor": "https://github.com/EnderWannabe",
    "created_at": "2021-08-13T22:36:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442169"
}
```



---

archive/issue_comments_519944.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nNo, I don't think they both need to be tuples.\n\nFor the embedding fix. I think you should leave the parameter as an embedding. Passing in a value and calling it `embedding` is a little off (even though that is how `NumberField` works). Why don't you just do the same thing as when you choose the embedding yourself; i.e., map all the generators with the user specified embedding.",
    "created_at": "2021-08-17T18:26:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519944",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:16" align="right">comment:16</div>

No, I don't think they both need to be tuples.

For the embedding fix. I think you should leave the parameter as an embedding. Passing in a value and calling it `embedding` is a little off (even though that is how `NumberField` works). Why don't you just do the same thing as when you choose the embedding yourself; i.e., map all the generators with the user specified embedding.



---

archive/issue_comments_519945.json:
```json
{
    "body": "Changed commit from **[`9948685`](https://github.com/sagemath/sagetrac-mirror/commit/994868566fe4385ba9e44fdc796e69041285c78b)** to **[`d2e6555`](https://github.com/sagemath/sagetrac-mirror/commit/d2e6555123de257efe5defe14811a175c829dc8f)**",
    "created_at": "2021-08-17T20:10:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519945",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9948685`](https://github.com/sagemath/sagetrac-mirror/commit/994868566fe4385ba9e44fdc796e69041285c78b)** to **[`d2e6555`](https://github.com/sagemath/sagetrac-mirror/commit/d2e6555123de257efe5defe14811a175c829dc8f)**



---

archive/issue_comments_519946.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2e6555123de257efe5defe14811a175c829dc8f\"><code>d2e6555</code></a></td><td><code>32292: changed embedding parameter</code></td></tr></table>\n",
    "created_at": "2021-08-17T20:10:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519946",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2e6555123de257efe5defe14811a175c829dc8f"><code>d2e6555</code></a></td><td><code>32292: changed embedding parameter</code></td></tr></table>




---

archive/issue_events_442170.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2021-08-18T14:05:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442170"
}
```



---

archive/issue_events_442171.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2021-08-18T14:05:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442171"
}
```



---

archive/issue_events_442172.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2021-08-18T14:07:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442172"
}
```



---

archive/issue_events_442173.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2021-08-18T14:07:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442173"
}
```



---

archive/issue_comments_519947.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nmarked it too soon. There are some tests that are failing in \n\nsrc/sage/schemes/projective/reduce_cluster.py",
    "created_at": "2021-08-18T14:07:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519947",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:19" align="right">comment:19</div>

marked it too soon. There are some tests that are failing in 

src/sage/schemes/projective/reduce_cluster.py



---

archive/issue_comments_519948.json:
```json
{
    "body": "<div id=\"comment:20\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/77da46d2f628ca30bae3678b3355815b86cf9eab\"><code>77da46d</code></a></td><td><code>32292: fixing failing tests</code></td></tr></table>\n",
    "created_at": "2021-08-18T17:27:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519948",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:20"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/77da46d2f628ca30bae3678b3355815b86cf9eab"><code>77da46d</code></a></td><td><code>32292: fixing failing tests</code></td></tr></table>




---

archive/issue_comments_519949.json:
```json
{
    "body": "Changed commit from **[`d2e6555`](https://github.com/sagemath/sagetrac-mirror/commit/d2e6555123de257efe5defe14811a175c829dc8f)** to **[`77da46d`](https://github.com/sagemath/sagetrac-mirror/commit/77da46d2f628ca30bae3678b3355815b86cf9eab)**",
    "created_at": "2021-08-18T17:27:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519949",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d2e6555`](https://github.com/sagemath/sagetrac-mirror/commit/d2e6555123de257efe5defe14811a175c829dc8f)** to **[`77da46d`](https://github.com/sagemath/sagetrac-mirror/commit/77da46d2f628ca30bae3678b3355815b86cf9eab)**



---

archive/issue_comments_519950.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nOk, pushed a fix. The latest patchbot failed to build, which is worrying. Hopefully the next one goes through.",
    "created_at": "2021-08-18T17:29:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519950",
    "user": "https://github.com/EnderWannabe"
}
```

<div id="comment:21" align="right">comment:21</div>

Ok, pushed a fix. The latest patchbot failed to build, which is worrying. Hopefully the next one goes through.



---

archive/issue_events_442174.json:
```json
{
    "actor": "https://github.com/EnderWannabe",
    "created_at": "2021-08-18T17:29:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442174"
}
```



---

archive/issue_events_442175.json:
```json
{
    "actor": "https://github.com/EnderWannabe",
    "created_at": "2021-08-18T17:29:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442175"
}
```



---

archive/issue_comments_519951.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nStill a doctest failing\n\n```\nFile \"src/sage/schemes/projective/projective_subscheme.py\", line 1559, in sage.schemes.projective.projective_subscheme.AlgebraicScheme_subscheme_projective_field.reduced_form\nFailed example:\n    X.reduced_form(return_transformation=True) #long time\nExpected:\n    (\n    Closed subscheme of Projective Space of dimension 3 over Rational Field defined by:\n      2342*x^2*y - 14376*x*y^2 - 38120*y^3 - 28104*x*y*w + 2320654*y^2*w - 239874234*x*w^2 - 479664156*y*w^2 + 1439245404*w^3,\n      223487*x*y^2 + 446974*y^3 + 2342*x^2*z + 9368*x*y*z + 9368*y^2*z - 23234975*x*z^2 - 46469950*y*z^2 - 1340922*y^2*w - 28104*x*z*w + 2178190*y*z*w + 139409850*z^2*w + 84312*z*w^2,\n      2342*x^2*w + 9368*x*y*w + 9368*y^2*w - 51388*x*w^2 + 2131622*y*w^2 + 224016*w^3,\n      223487*y^3 + 23744*y^2*z - 23234975*y*z^2 + 239874234*z*w^2,\n      23744*y^2*w - 23284*y*w^2 + 239874234*w^3,\n      -223487*y^2*w + 23234975*z^2*w - 23284*z*w^2\nGot:\n    (\n    Closed subscheme of Projective Space of dimension 3 over Rational Field defined by:                                                                                                \n      2342*x^2*y - 14376*x*y^2 - 38120*y^3 - 28104*x*y*w + 2320654*y^2*w - 239874234*x*w^2 - 479664156*y*w^2 + 1439245404*w^3,                                                         \n      223487*x*y^2 + 446974*y^3 + 2342*x^2*z + 9368*x*y*z + 9368*y^2*z - 23234975*x*z^2 - 46469950*y*z^2 - 1340922*y^2*w - 28104*x*z*w + 2178190*y*z*w + 139409850*z^2*w + 84312*z*w^2,\n      2342*x^2*w + 9368*x*y*w + 9368*y^2*w - 51388*x*w^2 + 2131622*y*w^2 + 224016*w^3,                                                                                                 \n      223487*y^3 + 23744*y^2*z - 23234975*y*z^2 + 239874234*z*w^2,                                                                                                                     \n      23744*y^2*w - 23284*y*w^2 + 239874234*w^3,                                                                                                                                       \n      -223487*y^2*w + 23234975*z^2*w - 23284*z*w^2                                                                                                                                     ,\n    <BLANKLINE>\n    [ 1  2  0 -6]\n    [ 0  1  0  0]\n    [ 0  0  1  0]\n    [ 0  0  0  1]\n    )\n```",
    "created_at": "2021-08-19T14:10:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519951",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:22" align="right">comment:22</div>

Still a doctest failing

```
File "src/sage/schemes/projective/projective_subscheme.py", line 1559, in sage.schemes.projective.projective_subscheme.AlgebraicScheme_subscheme_projective_field.reduced_form
Failed example:
    X.reduced_form(return_transformation=True) #long time
Expected:
    (
    Closed subscheme of Projective Space of dimension 3 over Rational Field defined by:
      2342*x^2*y - 14376*x*y^2 - 38120*y^3 - 28104*x*y*w + 2320654*y^2*w - 239874234*x*w^2 - 479664156*y*w^2 + 1439245404*w^3,
      223487*x*y^2 + 446974*y^3 + 2342*x^2*z + 9368*x*y*z + 9368*y^2*z - 23234975*x*z^2 - 46469950*y*z^2 - 1340922*y^2*w - 28104*x*z*w + 2178190*y*z*w + 139409850*z^2*w + 84312*z*w^2,
      2342*x^2*w + 9368*x*y*w + 9368*y^2*w - 51388*x*w^2 + 2131622*y*w^2 + 224016*w^3,
      223487*y^3 + 23744*y^2*z - 23234975*y*z^2 + 239874234*z*w^2,
      23744*y^2*w - 23284*y*w^2 + 239874234*w^3,
      -223487*y^2*w + 23234975*z^2*w - 23284*z*w^2
Got:
    (
    Closed subscheme of Projective Space of dimension 3 over Rational Field defined by:                                                                                                
      2342*x^2*y - 14376*x*y^2 - 38120*y^3 - 28104*x*y*w + 2320654*y^2*w - 239874234*x*w^2 - 479664156*y*w^2 + 1439245404*w^3,                                                         
      223487*x*y^2 + 446974*y^3 + 2342*x^2*z + 9368*x*y*z + 9368*y^2*z - 23234975*x*z^2 - 46469950*y*z^2 - 1340922*y^2*w - 28104*x*z*w + 2178190*y*z*w + 139409850*z^2*w + 84312*z*w^2,
      2342*x^2*w + 9368*x*y*w + 9368*y^2*w - 51388*x*w^2 + 2131622*y*w^2 + 224016*w^3,                                                                                                 
      223487*y^3 + 23744*y^2*z - 23234975*y*z^2 + 239874234*z*w^2,                                                                                                                     
      23744*y^2*w - 23284*y*w^2 + 239874234*w^3,                                                                                                                                       
      -223487*y^2*w + 23234975*z^2*w - 23284*z*w^2                                                                                                                                     ,
    <BLANKLINE>
    [ 1  2  0 -6]
    [ 0  1  0  0]
    [ 0  0  1  0]
    [ 0  0  0  1]
    )
```



---

archive/issue_events_442176.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2021-08-19T14:10:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442176"
}
```



---

archive/issue_events_442177.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2021-08-19T14:10:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442177"
}
```



---

archive/issue_comments_519952.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/59814a8557cfb7136a54419495da2315a697458a\"><code>59814a8</code></a></td><td><code>32292: fixed long test</code></td></tr></table>\n",
    "created_at": "2021-08-23T18:20:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519952",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/59814a8557cfb7136a54419495da2315a697458a"><code>59814a8</code></a></td><td><code>32292: fixed long test</code></td></tr></table>




---

archive/issue_comments_519953.json:
```json
{
    "body": "Changed commit from **[`77da46d`](https://github.com/sagemath/sagetrac-mirror/commit/77da46d2f628ca30bae3678b3355815b86cf9eab)** to **[`59814a8`](https://github.com/sagemath/sagetrac-mirror/commit/59814a8557cfb7136a54419495da2315a697458a)**",
    "created_at": "2021-08-23T18:20:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519953",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`77da46d`](https://github.com/sagemath/sagetrac-mirror/commit/77da46d2f628ca30bae3678b3355815b86cf9eab)** to **[`59814a8`](https://github.com/sagemath/sagetrac-mirror/commit/59814a8557cfb7136a54419495da2315a697458a)**



---

archive/issue_events_442178.json:
```json
{
    "actor": "https://github.com/EnderWannabe",
    "created_at": "2021-08-23T18:20:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442178"
}
```



---

archive/issue_events_442179.json:
```json
{
    "actor": "https://github.com/EnderWannabe",
    "created_at": "2021-08-23T18:20:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442179"
}
```



---

archive/issue_events_442180.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442180"
}
```



---

archive/issue_events_442181.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442181"
}
```



---

archive/issue_comments_519954.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nStalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.",
    "created_at": "2021-12-18T19:53:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32292#issuecomment-519954",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:25" align="right">comment:25</div>

Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.



---

archive/issue_events_442182.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T17:54:54Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442182"
}
```



---

archive/issue_events_442183.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T17:54:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442183"
}
```



---

archive/issue_events_442184.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442184"
}
```



---

archive/issue_events_442185.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32292",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32292#event-442185"
}
```
