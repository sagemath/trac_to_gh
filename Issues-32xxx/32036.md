# Issue 32036: sage.env: Remove direct uses of SAGE_LOCAL from the Sage library

archive/issues_031799.json:
```json
{
    "assignees": [],
    "body": "(from [#31338 comment:13](https://github.com/sagemath/sage/issues/31338#comment:13))\n\nThese changes are preparation for modularization and is also intended  to make downstream packaging easier.\n\n\n\n\nCC:  @kiwifb @antonio-rojas @dimpase @videlec @jhpalmieri\n\nComponent: **build: configure**\n\nAuthor: **Matthias Koeppe, Fran\u00e7ois Bissey**\n\nBranch/Commit: **[`985af6e`](https://github.com/sagemath/sagetrac-mirror/commit/985af6e8dccf44a02ba494b0e573aa0856b52cd3)**\n\nReviewer: **Dima Pasechnik, Fran\u00e7ois Bissey**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/32036_\n\n",
    "closed_at": "2021-07-09T20:23:30Z",
    "created_at": "2021-06-23T00:15:50Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build%3A%20configure",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "sage.env: Remove direct uses of SAGE_LOCAL from the Sage library",
    "type": "issue",
    "updated_at": "2021-07-09T20:23:30Z",
    "url": "https://github.com/sagemath/sage/issues/32036",
    "user": "https://github.com/mkoeppe"
}
```
(from [#31338 comment:13](https://github.com/sagemath/sage/issues/31338#comment:13))

These changes are preparation for modularization and is also intended  to make downstream packaging easier.




CC:  @kiwifb @antonio-rojas @dimpase @videlec @jhpalmieri

Component: **build: configure**

Author: **Matthias Koeppe, François Bissey**

Branch/Commit: **[`985af6e`](https://github.com/sagemath/sagetrac-mirror/commit/985af6e8dccf44a02ba494b0e573aa0856b52cd3)**

Reviewer: **Dima Pasechnik, François Bissey**

_Issue created by migration from https://trac.sagemath.org/ticket/32036_





---

archive/issue_events_438614.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-23T00:15:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438614"
}
```



---

archive/issue_events_438615.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-23T00:15:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build%3A%20configure",
    "label_color": "0000b0",
    "label_name": "c: build: configure",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438615"
}
```



---

archive/issue_events_438616.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-23T00:15:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438616"
}
```



---

archive/issue_events_438617.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-23T00:15:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438617"
}
```



---

archive/issue_comments_515652.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThere are a few remaining uses of `SAGE_SHARE` in `src/sage` that will have to be eliminated though.",
    "created_at": "2021-06-23T00:21:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515652",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

There are a few remaining uses of `SAGE_SHARE` in `src/sage` that will have to be eliminated though.



---

archive/issue_comments_515653.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\n(see #30819 `sage.databases`: Use `sage.feature` to define database file system location)",
    "created_at": "2021-06-23T00:23:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515653",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">comment:2</div>

(see #30819 `sage.databases`: Use `sage.feature` to define database file system location)



---

archive/issue_comments_515654.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nPerhaps now is also the time that we do #30914 (Meta-ticket: Create upstream repositories, pip-installable packages for database packages)?",
    "created_at": "2021-06-23T00:24:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515654",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

Perhaps now is also the time that we do #30914 (Meta-ticket: Create upstream repositories, pip-installable packages for database packages)?



---

archive/issue_comments_515655.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@mkoeppe](#comment%3A3):\n> Perhaps now is also the time that we do #30914 (Meta-ticket: Create upstream repositories, pip-installable packages for database packages)?\n\nThat would be timely if we could.\n\nOther issue about `sage_setup/setenv.py` I tried to replace `if SAGE_LOCAL:` by `if SAGE_ROOT:` since it is set to `None` for me in distro. But I still got the linking noise which means that it still accepted that as a positive. So a better test may be needed.",
    "created_at": "2021-06-23T00:28:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515655",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@mkoeppe](#comment%3A3):
> Perhaps now is also the time that we do #30914 (Meta-ticket: Create upstream repositories, pip-installable packages for database packages)?

That would be timely if we could.

Other issue about `sage_setup/setenv.py` I tried to replace `if SAGE_LOCAL:` by `if SAGE_ROOT:` since it is set to `None` for me in distro. But I still got the linking noise which means that it still accepted that as a positive. So a better test may be needed.



---

archive/issue_comments_515656.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nNo, `SAGE_ROOT` is not the right choice there.",
    "created_at": "2021-06-23T00:31:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515656",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">comment:5</div>

No, `SAGE_ROOT` is not the right choice there.



---

archive/issue_comments_515657.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@kiwifb](#comment%3A4):\n> Other issue about `sage_setup/setenv.py` I tried to replace `if SAGE_LOCAL:` by `if SAGE_ROOT:` since it is set to `None` for me in distro. But I still got the linking noise which means that it still accepted that as a positive. So a better test may be needed.\n\nScratch that, I think I did myself in at build time for some reasons (which I have top check).",
    "created_at": "2021-06-23T00:34:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515657",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@kiwifb](#comment%3A4):
> Other issue about `sage_setup/setenv.py` I tried to replace `if SAGE_LOCAL:` by `if SAGE_ROOT:` since it is set to `None` for me in distro. But I still got the linking noise which means that it still accepted that as a positive. So a better test may be needed.

Scratch that, I think I did myself in at build time for some reasons (which I have top check).



---

archive/issue_comments_515658.json:
```json
{
    "body": "Branch: **[u/mkoeppe/sage_env__remove_default_setting_of_sage_local_from_sage_venv](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_env__remove_default_setting_of_sage_local_from_sage_venv)**",
    "created_at": "2021-06-23T18:10:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515658",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/sage_env__remove_default_setting_of_sage_local_from_sage_venv](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_env__remove_default_setting_of_sage_local_from_sage_venv)**



---

archive/issue_comments_515659.json:
```json
{
    "body": "Commit: **[`95deabd`](https://github.com/sagemath/sagetrac-mirror/commit/95deabddc3d3c32d8f0362cfcf9e08f2e3b28205)**",
    "created_at": "2021-06-23T18:11:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515659",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`95deabd`](https://github.com/sagemath/sagetrac-mirror/commit/95deabddc3d3c32d8f0362cfcf9e08f2e3b28205)**



---

archive/issue_events_438618.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-23T18:11:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438618"
}
```



---

archive/issue_comments_515660.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/95deabddc3d3c32d8f0362cfcf9e08f2e3b28205\"><code>95deabd</code></a></td><td><code>src/sage/env.py: No fallback for SAGE_LOCAL</code></td></tr></table>\n",
    "created_at": "2021-06-23T18:11:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515660",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/95deabddc3d3c32d8f0362cfcf9e08f2e3b28205"><code>95deabd</code></a></td><td><code>src/sage/env.py: No fallback for SAGE_LOCAL</code></td></tr></table>




---

archive/issue_comments_515661.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2021-06-23T18:11:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515661",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_515662.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\n\n```\n> sage\nTraceback (most recent call last):\n  File \"/usr/bin/sage-ipython\", line 9, in <module>\n    from sage.misc.banner import banner\n  File \"/usr/lib/python3.9/site-packages/sage/misc/banner.py\", line 16, in <module>\n    from sage.env import (SAGE_VERSION, SAGE_VERSION_BANNER, SAGE_BANNER)\n  File \"/usr/lib/python3.9/site-packages/sage/env.py\", line 314, in <module>\n    SINGULAR_SO = var(\"SINGULAR_SO\", _get_shared_lib_path(\"Singular\", \"singular-Singular\"))\n  File \"/usr/lib/python3.9/site-packages/sage/env.py\", line 291, in _get_shared_lib_path\n    search_directories = [Path(SAGE_LOCAL) / 'lib']\n  File \"/usr/lib/python3.9/pathlib.py\", line 1072, in __new__\n    self = cls._from_parts(args, init=False)\n  File \"/usr/lib/python3.9/pathlib.py\", line 697, in _from_parts\n    drv, root, parts = self._parse_args(args)\n  File \"/usr/lib/python3.9/pathlib.py\", line 681, in _parse_args\n    a = os.fspath(a)\nTypeError: expected str, bytes or os.PathLike object, not NoneType\n```",
    "created_at": "2021-06-23T18:36:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515662",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:9" align="right">comment:9</div>


```
> sage
Traceback (most recent call last):
  File "/usr/bin/sage-ipython", line 9, in <module>
    from sage.misc.banner import banner
  File "/usr/lib/python3.9/site-packages/sage/misc/banner.py", line 16, in <module>
    from sage.env import (SAGE_VERSION, SAGE_VERSION_BANNER, SAGE_BANNER)
  File "/usr/lib/python3.9/site-packages/sage/env.py", line 314, in <module>
    SINGULAR_SO = var("SINGULAR_SO", _get_shared_lib_path("Singular", "singular-Singular"))
  File "/usr/lib/python3.9/site-packages/sage/env.py", line 291, in _get_shared_lib_path
    search_directories = [Path(SAGE_LOCAL) / 'lib']
  File "/usr/lib/python3.9/pathlib.py", line 1072, in __new__
    self = cls._from_parts(args, init=False)
  File "/usr/lib/python3.9/pathlib.py", line 697, in _from_parts
    drv, root, parts = self._parse_args(args)
  File "/usr/lib/python3.9/pathlib.py", line 681, in _parse_args
    a = os.fspath(a)
TypeError: expected str, bytes or os.PathLike object, not NoneType
```



---

archive/issue_comments_515663.json:
```json
{
    "body": "Changed commit from **[`95deabd`](https://github.com/sagemath/sagetrac-mirror/commit/95deabddc3d3c32d8f0362cfcf9e08f2e3b28205)** to **[`de66da4`](https://github.com/sagemath/sagetrac-mirror/commit/de66da48d0d2d09a1f0efe206135c8c9aa4fba0b)**",
    "created_at": "2021-06-23T21:19:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515663",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`95deabd`](https://github.com/sagemath/sagetrac-mirror/commit/95deabddc3d3c32d8f0362cfcf9e08f2e3b28205)** to **[`de66da4`](https://github.com/sagemath/sagetrac-mirror/commit/de66da48d0d2d09a1f0efe206135c8c9aa4fba0b)**



---

archive/issue_comments_515664.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/de66da48d0d2d09a1f0efe206135c8c9aa4fba0b\"><code>de66da4</code></a></td><td><code>sage.env._get_shared_lib_path: If SAGE_LOCAL is not set, skip it</code></td></tr></table>\n",
    "created_at": "2021-06-23T21:19:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515664",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/de66da48d0d2d09a1f0efe206135c8c9aa4fba0b"><code>de66da4</code></a></td><td><code>sage.env._get_shared_lib_path: If SAGE_LOCAL is not set, skip it</code></td></tr></table>




---

archive/issue_comments_515665.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThanks for catching this!",
    "created_at": "2021-06-23T21:19:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515665",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

Thanks for catching this!



---

archive/issue_comments_515666.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nNext issue:\n\n```\n/usr/lib/python3.9/site-packages/sage/interfaces/gap_workspace.py in gap_workspace_file(system='gap', name='workspace', dir='/home/antonio/.sage/gap')\n     [...]\n     57         sage: assert name1 == name2\n     58     \"\"\"\n     59     if dir is None:\n     60         dir = os.path.join(DOT_SAGE, 'gap')\n     61 \n---> 62     h = hashlib.sha1(SAGE_LOCAL.encode('utf-8')).hexdigest()\n        h = undefined\n        global hashlib.sha1 = <built-in function openssl_sha1>\n        global SAGE_LOCAL.encode.hexdigest = undefined\n     63     return os.path.join(dir, '%s-%s-%s' % (system, name, h))\n     64 \n     65 \nAttributeError: 'NoneType' object has no attribute 'encode'\n```\nand, after bypassing it\n\n```\n/usr/lib/python3.9/site-packages/sage/interfaces/lie.py in __init__(self=LiE Interpreter, maxread=None, script_subdirectory=None, logfile=None, server=None)\n    [...]\n    329                         # it to be very obfuscated that would be better.   Even\n    330                         # better is to use sequence numbers.\n    331                         prompt = '> ',\n    332 \n    333                         # This is the command that starts up your program\n--> 334                         command = \"bash \"+ SAGE_LOCAL + \"/bin/lie\",\n        global command = undefined\n        global SAGE_LOCAL = None\n    335 \n    336                         server=server,\n    337                         script_subdirectory = script_subdirectory,\n    338 \n\nTypeError: can only concatenate str (not \"NoneType\") to str\n```",
    "created_at": "2021-06-23T21:28:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515666",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:12" align="right">comment:12</div>

Next issue:

```
/usr/lib/python3.9/site-packages/sage/interfaces/gap_workspace.py in gap_workspace_file(system='gap', name='workspace', dir='/home/antonio/.sage/gap')
     [...]
     57         sage: assert name1 == name2
     58     """
     59     if dir is None:
     60         dir = os.path.join(DOT_SAGE, 'gap')
     61 
---> 62     h = hashlib.sha1(SAGE_LOCAL.encode('utf-8')).hexdigest()
        h = undefined
        global hashlib.sha1 = <built-in function openssl_sha1>
        global SAGE_LOCAL.encode.hexdigest = undefined
     63     return os.path.join(dir, '%s-%s-%s' % (system, name, h))
     64 
     65 
AttributeError: 'NoneType' object has no attribute 'encode'
```
and, after bypassing it

```
/usr/lib/python3.9/site-packages/sage/interfaces/lie.py in __init__(self=LiE Interpreter, maxread=None, script_subdirectory=None, logfile=None, server=None)
    [...]
    329                         # it to be very obfuscated that would be better.   Even
    330                         # better is to use sequence numbers.
    331                         prompt = '> ',
    332 
    333                         # This is the command that starts up your program
--> 334                         command = "bash "+ SAGE_LOCAL + "/bin/lie",
        global command = undefined
        global SAGE_LOCAL = None
    335 
    336                         server=server,
    337                         script_subdirectory = script_subdirectory,
    338 

TypeError: can only concatenate str (not "NoneType") to str
```



---

archive/issue_comments_515667.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nExcluding `env.py` for a minute those are the instances of `SAGE_LOCAL` still existing under in the sagelib tree from a simple grep command\n\n```\nsrc/sage/all.py:from sage.env import SAGE_ROOT, SAGE_SRC, SAGE_DOC_SRC, SAGE_LOCAL, DOT_SAGE, SAGE_ENV\nsrc/sage/all.py:        sage: started_file = os.path.join(SAGE_LOCAL, 'etc', 'sage-started.txt')\nsrc/sage/all.py:    started_file = os.path.join(SAGE_LOCAL, 'etc', 'sage-started.txt')\nsrc/sage/calculus/desolvers.py:                          os.path.join('$SAGE_LOCAL','lib','libTIDES.a') + ' $LDFLAGS '\nsrc/sage/calculus/desolvers.py:                          + os.path.join('-L$SAGE_LOCAL','lib ') +' -lm  -O2 ' +\nsrc/sage/calculus/desolvers.py:                          os.path.join('-I$SAGE_LOCAL','include '),\nsrc/sage/calculus/desolvers.py:                          os.path.join('$SAGE_LOCAL','lib','libTIDES.a') + ' $LDFLAGS '\nsrc/sage/calculus/desolvers.py:                          + os.path.join('-L$SAGE_LOCAL','lib ') + '-lmpfr -lgmp -lm  -O2 -w ' +\nsrc/sage/calculus/desolvers.py:                          os.path.join('-I$SAGE_LOCAL','include ') ,\nsrc/sage/doctest/control.py:        # only have the SAGE_LOCAL install tree but not SAGE_ROOT\nsrc/sage/doctest/control.py:            # only have the SAGE_LOCAL install tree but not SAGE_ROOT\nsrc/sage/interfaces/qepcad.py:    sage: with open(os.path.join(SAGE_LOCAL, 'default.qepcadrc')) as f:  # optional - qepcad\nsrc/sage/interfaces/qepcad.py:from sage.env import SAGE_LOCAL\nsrc/sage/interfaces/qepcad.py:        sage: s == 'env qe=%s qepcad '%SAGE_LOCAL\nsrc/sage/interfaces/qepcad.py:        sage: s == 'env qe=%s qepcad +N8000000'%SAGE_LOCAL\nsrc/sage/interfaces/qepcad.py:    return \"env qe=%s qepcad %s\"%(SAGE_LOCAL, memcells_arg)\nsrc/sage/interfaces/qepcad.py:    with open(os.path.join(SAGE_LOCAL, 'bin', 'qepcad.help')) as help:\nsrc/sage/interfaces/giac.py:    $SAGE_LOCAL/share/giac/doc/en/cascmd_local/index.html\nsrc/sage/interfaces/giac.py:If you got giac from the spkg then ``$PREFIX`` is ``$SAGE_LOCAL``\nsrc/sage/interfaces/gap_workspace.py:from sage.env import DOT_SAGE, SAGE_LOCAL\nsrc/sage/interfaces/gap_workspace.py:    h = hashlib.sha1(SAGE_LOCAL.encode('utf-8')).hexdigest()\nsrc/sage/interfaces/lie.py:from sage.env import DOT_SAGE, SAGE_LOCAL\nsrc/sage/interfaces/lie.py:                        command = \"bash \"+ SAGE_LOCAL + \"/bin/lie\",\nsrc/sage/interfaces/lie.py:            filename = SAGE_LOCAL + \"/lib/LiE/\" + f\nsrc/sage/interfaces/lie.py:    f = open(os.path.join(SAGE_LOCAL, 'lib', 'LiE', 'INFO.0'))\nsrc/sage/interfaces/maxima.py:from sage.env import DOT_SAGE, SAGE_LOCAL, MAXIMA\nsrc/sage/interfaces/mathematica.py:##            it in <SAGE_LOCAL>/bin/ is an easy way to ensure this).\nsrc/sage/libs/gap/util.pyx:    SAGE_LOCAL = sage.env.SAGE_LOCAL\nsrc/sage/libs/gap/util.pyx:    with open(os.path.join(SAGE_LOCAL, 'bin', 'gap')) as f:\nsrc/sage/libs/gap/util.pyx:    gapdir = gapdir.replace('$SAGE_LOCAL', SAGE_LOCAL)\nsrc/sage/libs/giac/giac.pyx:      - or in :doc:`$SAGE_LOCAL/share/giac/doc/en/cascmd_en/index.html`\nsrc/sage/misc/sage_ostools.pyx:        sage: have_program('there_is_not_a_program_with_this_name', os.path.join(SAGE_LOCAL, 'bin'))\nsrc/sage/misc/citation.pyx:from sage.env import SAGE_LOCAL\nsrc/sage/misc/citation.pyx:    strings = [a[0].replace(SAGE_LOCAL, \"\") + \" \" + a[2]\nsrc/sage/misc/cython.py:from sage.env import (SAGE_LOCAL, cython_aliases,\nsrc/sage/misc/cython.py:    standard_libdirs = [os.path.join(SAGE_LOCAL, \"lib\")] + aliases[\"CBLAS_LIBDIR\"] + aliases[\"NTL_LIBDIR\"]\nsrc/sage/misc/compat.py:from sage.env import SAGE_LOCAL\nsrc/sage/misc/compat.py:        for libdir in [os.path.join(SAGE_LOCAL, 'lib'),\nsrc/sage/misc/compat.py:        sage_local_lib = os.path.join(SAGE_LOCAL, 'lib')\nsrc/sage/misc/compat.py:    lib_dirs = (LDPATH_STR.split(':') if LDPATH_STR else []) + [os.path.join(SAGE_LOCAL, 'lib')]\nsrc/sage/misc/edit_module.py:    'SAGE_LOCAL/lib/python.../site-packages', it replaces this by\nsrc/sage/misc/dist.py:    from sage.env import SAGE_LOCAL\nsrc/sage/misc/dist.py:    SAGE_BIN = os.path.join(SAGE_LOCAL, 'bin')\nsrc/sage/misc/dist.py:    # SAGE_LOCAL/bin from PATH so that we can later check whether\nsrc/sage/plot/plot3d/base.pyx:from sage.env import SAGE_LOCAL\nsrc/sage/repl/interpreter.py:``$SAGE_LOCAL/bin/sage-ipython`` script to start the Sage\nsrc/sage/sandpiles/sandpile.py:from sage.env import SAGE_LOCAL\nsrc/sage/sandpiles/sandpile.py:path_to_zsolve = os.path.join(SAGE_LOCAL, 'bin', 'zsolve')\n```\n\n* `sage-started` could be eliminated without regrets (personal opinion). \n* The stuff in `calculus/desolvers.py` should be carefully reviewed - can we still use that stuff and if yes, how? \n* `qepcad.py` is long time serial offender. \n* `gap_workspace.py` needs to be looked at. \n* `lie.py` probably should have specific variable, distro may put the stuff somewhere else (Gentoo does). \n* `SAGE_LOCAL` is imported in `maxima.py` and `plot/plot3d/base.pyx` but appear to be unused - expunge. \n* `libs/gap/util.pyx` would need to be reworked. \n* `cython.py` need to be looked at.\n* What is happening with `SAGE_LOCAL` in `misc/compat.py`.\n* `citations.pyx` seem to rely on it.\n* `sandpiles/sandpile.py` features should be used.",
    "created_at": "2021-06-23T21:38:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515667",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:13" align="right">comment:13</div>

Excluding `env.py` for a minute those are the instances of `SAGE_LOCAL` still existing under in the sagelib tree from a simple grep command

```
src/sage/all.py:from sage.env import SAGE_ROOT, SAGE_SRC, SAGE_DOC_SRC, SAGE_LOCAL, DOT_SAGE, SAGE_ENV
src/sage/all.py:        sage: started_file = os.path.join(SAGE_LOCAL, 'etc', 'sage-started.txt')
src/sage/all.py:    started_file = os.path.join(SAGE_LOCAL, 'etc', 'sage-started.txt')
src/sage/calculus/desolvers.py:                          os.path.join('$SAGE_LOCAL','lib','libTIDES.a') + ' $LDFLAGS '
src/sage/calculus/desolvers.py:                          + os.path.join('-L$SAGE_LOCAL','lib ') +' -lm  -O2 ' +
src/sage/calculus/desolvers.py:                          os.path.join('-I$SAGE_LOCAL','include '),
src/sage/calculus/desolvers.py:                          os.path.join('$SAGE_LOCAL','lib','libTIDES.a') + ' $LDFLAGS '
src/sage/calculus/desolvers.py:                          + os.path.join('-L$SAGE_LOCAL','lib ') + '-lmpfr -lgmp -lm  -O2 -w ' +
src/sage/calculus/desolvers.py:                          os.path.join('-I$SAGE_LOCAL','include ') ,
src/sage/doctest/control.py:        # only have the SAGE_LOCAL install tree but not SAGE_ROOT
src/sage/doctest/control.py:            # only have the SAGE_LOCAL install tree but not SAGE_ROOT
src/sage/interfaces/qepcad.py:    sage: with open(os.path.join(SAGE_LOCAL, 'default.qepcadrc')) as f:  # optional - qepcad
src/sage/interfaces/qepcad.py:from sage.env import SAGE_LOCAL
src/sage/interfaces/qepcad.py:        sage: s == 'env qe=%s qepcad '%SAGE_LOCAL
src/sage/interfaces/qepcad.py:        sage: s == 'env qe=%s qepcad +N8000000'%SAGE_LOCAL
src/sage/interfaces/qepcad.py:    return "env qe=%s qepcad %s"%(SAGE_LOCAL, memcells_arg)
src/sage/interfaces/qepcad.py:    with open(os.path.join(SAGE_LOCAL, 'bin', 'qepcad.help')) as help:
src/sage/interfaces/giac.py:    $SAGE_LOCAL/share/giac/doc/en/cascmd_local/index.html
src/sage/interfaces/giac.py:If you got giac from the spkg then ``$PREFIX`` is ``$SAGE_LOCAL``
src/sage/interfaces/gap_workspace.py:from sage.env import DOT_SAGE, SAGE_LOCAL
src/sage/interfaces/gap_workspace.py:    h = hashlib.sha1(SAGE_LOCAL.encode('utf-8')).hexdigest()
src/sage/interfaces/lie.py:from sage.env import DOT_SAGE, SAGE_LOCAL
src/sage/interfaces/lie.py:                        command = "bash "+ SAGE_LOCAL + "/bin/lie",
src/sage/interfaces/lie.py:            filename = SAGE_LOCAL + "/lib/LiE/" + f
src/sage/interfaces/lie.py:    f = open(os.path.join(SAGE_LOCAL, 'lib', 'LiE', 'INFO.0'))
src/sage/interfaces/maxima.py:from sage.env import DOT_SAGE, SAGE_LOCAL, MAXIMA
src/sage/interfaces/mathematica.py:##            it in <SAGE_LOCAL>/bin/ is an easy way to ensure this).
src/sage/libs/gap/util.pyx:    SAGE_LOCAL = sage.env.SAGE_LOCAL
src/sage/libs/gap/util.pyx:    with open(os.path.join(SAGE_LOCAL, 'bin', 'gap')) as f:
src/sage/libs/gap/util.pyx:    gapdir = gapdir.replace('$SAGE_LOCAL', SAGE_LOCAL)
src/sage/libs/giac/giac.pyx:      - or in :doc:`$SAGE_LOCAL/share/giac/doc/en/cascmd_en/index.html`
src/sage/misc/sage_ostools.pyx:        sage: have_program('there_is_not_a_program_with_this_name', os.path.join(SAGE_LOCAL, 'bin'))
src/sage/misc/citation.pyx:from sage.env import SAGE_LOCAL
src/sage/misc/citation.pyx:    strings = [a[0].replace(SAGE_LOCAL, "") + " " + a[2]
src/sage/misc/cython.py:from sage.env import (SAGE_LOCAL, cython_aliases,
src/sage/misc/cython.py:    standard_libdirs = [os.path.join(SAGE_LOCAL, "lib")] + aliases["CBLAS_LIBDIR"] + aliases["NTL_LIBDIR"]
src/sage/misc/compat.py:from sage.env import SAGE_LOCAL
src/sage/misc/compat.py:        for libdir in [os.path.join(SAGE_LOCAL, 'lib'),
src/sage/misc/compat.py:        sage_local_lib = os.path.join(SAGE_LOCAL, 'lib')
src/sage/misc/compat.py:    lib_dirs = (LDPATH_STR.split(':') if LDPATH_STR else []) + [os.path.join(SAGE_LOCAL, 'lib')]
src/sage/misc/edit_module.py:    'SAGE_LOCAL/lib/python.../site-packages', it replaces this by
src/sage/misc/dist.py:    from sage.env import SAGE_LOCAL
src/sage/misc/dist.py:    SAGE_BIN = os.path.join(SAGE_LOCAL, 'bin')
src/sage/misc/dist.py:    # SAGE_LOCAL/bin from PATH so that we can later check whether
src/sage/plot/plot3d/base.pyx:from sage.env import SAGE_LOCAL
src/sage/repl/interpreter.py:``$SAGE_LOCAL/bin/sage-ipython`` script to start the Sage
src/sage/sandpiles/sandpile.py:from sage.env import SAGE_LOCAL
src/sage/sandpiles/sandpile.py:path_to_zsolve = os.path.join(SAGE_LOCAL, 'bin', 'zsolve')
```

* `sage-started` could be eliminated without regrets (personal opinion). 
* The stuff in `calculus/desolvers.py` should be carefully reviewed - can we still use that stuff and if yes, how? 
* `qepcad.py` is long time serial offender. 
* `gap_workspace.py` needs to be looked at. 
* `lie.py` probably should have specific variable, distro may put the stuff somewhere else (Gentoo does). 
* `SAGE_LOCAL` is imported in `maxima.py` and `plot/plot3d/base.pyx` but appear to be unused - expunge. 
* `libs/gap/util.pyx` would need to be reworked. 
* `cython.py` need to be looked at.
* What is happening with `SAGE_LOCAL` in `misc/compat.py`.
* `citations.pyx` seem to rely on it.
* `sandpiles/sandpile.py` features should be used.



---

archive/issue_comments_515668.json:
```json
{
    "body": "Changed commit from **[`de66da4`](https://github.com/sagemath/sagetrac-mirror/commit/de66da48d0d2d09a1f0efe206135c8c9aa4fba0b)** to **[`d4b822b`](https://github.com/sagemath/sagetrac-mirror/commit/d4b822b4d3eaaccb6dc34ddc981a33ee1685462d)**",
    "created_at": "2021-06-23T21:45:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515668",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`de66da4`](https://github.com/sagemath/sagetrac-mirror/commit/de66da48d0d2d09a1f0efe206135c8c9aa4fba0b)** to **[`d4b822b`](https://github.com/sagemath/sagetrac-mirror/commit/d4b822b4d3eaaccb6dc34ddc981a33ee1685462d)**



---

archive/issue_comments_515669.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d4b822b4d3eaaccb6dc34ddc981a33ee1685462d\"><code>d4b822b</code></a></td><td><code>src/sage/interfaces/maxima.py: Remove unused imports of DOT_SAGE, SAGE_LOCAL</code></td></tr></table>\n",
    "created_at": "2021-06-23T21:45:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515669",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d4b822b4d3eaaccb6dc34ddc981a33ee1685462d"><code>d4b822b</code></a></td><td><code>src/sage/interfaces/maxima.py: Remove unused imports of DOT_SAGE, SAGE_LOCAL</code></td></tr></table>




---

archive/issue_comments_515670.json:
```json
{
    "body": "Changed commit from **[`d4b822b`](https://github.com/sagemath/sagetrac-mirror/commit/d4b822b4d3eaaccb6dc34ddc981a33ee1685462d)** to **[`13b780b`](https://github.com/sagemath/sagetrac-mirror/commit/13b780bb2d1dccfc865be1c63eea09247b1f316a)**",
    "created_at": "2021-06-23T21:54:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515670",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d4b822b`](https://github.com/sagemath/sagetrac-mirror/commit/d4b822b4d3eaaccb6dc34ddc981a33ee1685462d)** to **[`13b780b`](https://github.com/sagemath/sagetrac-mirror/commit/13b780bb2d1dccfc865be1c63eea09247b1f316a)**



---

archive/issue_comments_515671.json:
```json
{
    "body": "<div id=\"comment:15\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/13b780bb2d1dccfc865be1c63eea09247b1f316a\"><code>13b780b</code></a></td><td><code>src/sage/interfaces/gap_workspace.py: Use hash of GAP_SO to disambiguate the workspace file, not SAGE_LOCAL</code></td></tr></table>\n",
    "created_at": "2021-06-23T21:54:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515671",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:15"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/13b780bb2d1dccfc865be1c63eea09247b1f316a"><code>13b780b</code></a></td><td><code>src/sage/interfaces/gap_workspace.py: Use hash of GAP_SO to disambiguate the workspace file, not SAGE_LOCAL</code></td></tr></table>




---

archive/issue_comments_515672.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nPerhaps someone who knows more about GAP workspaces can comment whether this change makes sense.",
    "created_at": "2021-06-23T21:54:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515672",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:16" align="right">comment:16</div>

Perhaps someone who knows more about GAP workspaces can comment whether this change makes sense.



---

archive/issue_comments_515673.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7ca61a94c12e43c070ba0cd83125b84f2e52019e\"><code>7ca61a9</code></a></td><td><code>build/pkgs/lie/distros/*.txt: New</code></td></tr></table>\n",
    "created_at": "2021-06-23T21:59:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515673",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7ca61a94c12e43c070ba0cd83125b84f2e52019e"><code>7ca61a9</code></a></td><td><code>build/pkgs/lie/distros/*.txt: New</code></td></tr></table>




---

archive/issue_comments_515674.json:
```json
{
    "body": "Changed commit from **[`13b780b`](https://github.com/sagemath/sagetrac-mirror/commit/13b780bb2d1dccfc865be1c63eea09247b1f316a)** to **[`7ca61a9`](https://github.com/sagemath/sagetrac-mirror/commit/7ca61a94c12e43c070ba0cd83125b84f2e52019e)**",
    "created_at": "2021-06-23T21:59:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515674",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`13b780b`](https://github.com/sagemath/sagetrac-mirror/commit/13b780bb2d1dccfc865be1c63eea09247b1f316a)** to **[`7ca61a9`](https://github.com/sagemath/sagetrac-mirror/commit/7ca61a94c12e43c070ba0cd83125b84f2e52019e)**



---

archive/issue_comments_515675.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@kiwifb](#comment%3A13):\n> * `lie.py` probably should have specific variable, distro may put the stuff somewhere else (Gentoo does). \n\nI agree.\n\nCould someone on such a distro take care of lie.py please?\n\nThere's no package for homebrew and our SPKG does not compile",
    "created_at": "2021-06-23T22:02:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515675",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@kiwifb](#comment%3A13):
> * `lie.py` probably should have specific variable, distro may put the stuff somewhere else (Gentoo does). 

I agree.

Could someone on such a distro take care of lie.py please?

There's no package for homebrew and our SPKG does not compile



---

archive/issue_comments_515676.json:
```json
{
    "body": "Changed commit from **[`7ca61a9`](https://github.com/sagemath/sagetrac-mirror/commit/7ca61a94c12e43c070ba0cd83125b84f2e52019e)** to **[`f1a9c25`](https://github.com/sagemath/sagetrac-mirror/commit/f1a9c25122821cc686511f34726ee90d606f4abe)**",
    "created_at": "2021-06-23T22:06:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515676",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7ca61a9`](https://github.com/sagemath/sagetrac-mirror/commit/7ca61a94c12e43c070ba0cd83125b84f2e52019e)** to **[`f1a9c25`](https://github.com/sagemath/sagetrac-mirror/commit/f1a9c25122821cc686511f34726ee90d606f4abe)**



---

archive/issue_comments_515677.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f1a9c25122821cc686511f34726ee90d606f4abe\"><code>f1a9c25</code></a></td><td><code>src/sage/misc/sage_ostools.pyx: Remove useless use of SAGE_LOCAL in doctest</code></td></tr></table>\n",
    "created_at": "2021-06-23T22:06:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515677",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f1a9c25122821cc686511f34726ee90d606f4abe"><code>f1a9c25</code></a></td><td><code>src/sage/misc/sage_ostools.pyx: Remove useless use of SAGE_LOCAL in doctest</code></td></tr></table>




---

archive/issue_comments_515678.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@mkoeppe](#comment%3A18):\n> Replying to [@kiwifb](#comment%3A13):\n> > * `lie.py` probably should have specific variable, distro may put the stuff somewhere else (Gentoo does). \n\n> \n> I agree.\n> \n> Could someone on such a distro take care of lie.py please?\n> \n\nI will.",
    "created_at": "2021-06-23T22:12:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515678",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@mkoeppe](#comment%3A18):
> Replying to [@kiwifb](#comment%3A13):
> > * `lie.py` probably should have specific variable, distro may put the stuff somewhere else (Gentoo does). 

> 
> I agree.
> 
> Could someone on such a distro take care of lie.py please?
> 

I will.



---

archive/issue_comments_515679.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/faa96373b773e562052491958fa18a937546c29d\"><code>faa9637</code></a></td><td><code>src/sage/misc/dist.py: Return with error message if SAGE_LOCAL is not set</code></td></tr></table>\n",
    "created_at": "2021-06-23T22:17:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515679",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/faa96373b773e562052491958fa18a937546c29d"><code>faa9637</code></a></td><td><code>src/sage/misc/dist.py: Return with error message if SAGE_LOCAL is not set</code></td></tr></table>




---

archive/issue_comments_515680.json:
```json
{
    "body": "Changed commit from **[`f1a9c25`](https://github.com/sagemath/sagetrac-mirror/commit/f1a9c25122821cc686511f34726ee90d606f4abe)** to **[`faa9637`](https://github.com/sagemath/sagetrac-mirror/commit/faa96373b773e562052491958fa18a937546c29d)**",
    "created_at": "2021-06-23T22:17:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515680",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f1a9c25`](https://github.com/sagemath/sagetrac-mirror/commit/f1a9c25122821cc686511f34726ee90d606f4abe)** to **[`faa9637`](https://github.com/sagemath/sagetrac-mirror/commit/faa96373b773e562052491958fa18a937546c29d)**



---

archive/issue_comments_515681.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/82f5c3afed12cb78f57dc4557d5447fdfcf9d646\"><code>82f5c3a</code></a></td><td><code>src/sage/misc/compat.py: Do not fail if SAGE_LOCAL is unset</code></td></tr></table>\n",
    "created_at": "2021-06-23T22:25:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515681",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/82f5c3afed12cb78f57dc4557d5447fdfcf9d646"><code>82f5c3a</code></a></td><td><code>src/sage/misc/compat.py: Do not fail if SAGE_LOCAL is unset</code></td></tr></table>




---

archive/issue_comments_515682.json:
```json
{
    "body": "Changed commit from **[`faa9637`](https://github.com/sagemath/sagetrac-mirror/commit/faa96373b773e562052491958fa18a937546c29d)** to **[`82f5c3a`](https://github.com/sagemath/sagetrac-mirror/commit/82f5c3afed12cb78f57dc4557d5447fdfcf9d646)**",
    "created_at": "2021-06-23T22:25:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515682",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`faa9637`](https://github.com/sagemath/sagetrac-mirror/commit/faa96373b773e562052491958fa18a937546c29d)** to **[`82f5c3a`](https://github.com/sagemath/sagetrac-mirror/commit/82f5c3afed12cb78f57dc4557d5447fdfcf9d646)**



---

archive/issue_comments_515683.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nI am a bit confused by what `dist.py` does. If it is doing an installation task, should it live in `sage_setup`?",
    "created_at": "2021-06-23T22:30:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515683",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:23" align="right">comment:23</div>

I am a bit confused by what `dist.py` does. If it is doing an installation task, should it live in `sage_setup`?



---

archive/issue_comments_515684.json:
```json
{
    "body": "Changed commit from **[`82f5c3a`](https://github.com/sagemath/sagetrac-mirror/commit/82f5c3afed12cb78f57dc4557d5447fdfcf9d646)** to **[`fc47386`](https://github.com/sagemath/sagetrac-mirror/commit/fc473866c2cdca092ca43133506f9be701100e5b)**",
    "created_at": "2021-06-23T22:34:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515684",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`82f5c3a`](https://github.com/sagemath/sagetrac-mirror/commit/82f5c3afed12cb78f57dc4557d5447fdfcf9d646)** to **[`fc47386`](https://github.com/sagemath/sagetrac-mirror/commit/fc473866c2cdca092ca43133506f9be701100e5b)**



---

archive/issue_comments_515685.json:
```json
{
    "body": "<div id=\"comment:24\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc473866c2cdca092ca43133506f9be701100e5b\"><code>fc47386</code></a></td><td><code>src/sage/misc/cython.py: Do not fail if SAGE_LOCAL is not set</code></td></tr></table>\n",
    "created_at": "2021-06-23T22:34:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515685",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:24"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc473866c2cdca092ca43133506f9be701100e5b"><code>fc47386</code></a></td><td><code>src/sage/misc/cython.py: Do not fail if SAGE_LOCAL is not set</code></td></tr></table>




---

archive/issue_comments_515686.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@kiwifb](#comment%3A23):\n> I am a bit confused by what `dist.py` does. If it is doing an installation task, should it live in `sage_setup`?\n\nIt's an optional installation step, which hopefully can be removed at some point (#30207)",
    "created_at": "2021-06-23T22:35:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515686",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@kiwifb](#comment%3A23):
> I am a bit confused by what `dist.py` does. If it is doing an installation task, should it live in `sage_setup`?

It's an optional installation step, which hopefully can be removed at some point (#30207)



---

archive/issue_comments_515687.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@kiwifb](#comment%3A13):\n> * `sage-started` could be eliminated without regrets (personal opinion). \n\nI'll remove it (a previous discussion in #26116 also indicated that there is no need for it any more).",
    "created_at": "2021-06-23T22:47:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515687",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@kiwifb](#comment%3A13):
> * `sage-started` could be eliminated without regrets (personal opinion). 

I'll remove it (a previous discussion in #26116 also indicated that there is no need for it any more).



---

archive/issue_comments_515688.json:
```json
{
    "body": "Changed commit from **[`fc47386`](https://github.com/sagemath/sagetrac-mirror/commit/fc473866c2cdca092ca43133506f9be701100e5b)** to **[`d3828ff`](https://github.com/sagemath/sagetrac-mirror/commit/d3828ff9d2383b2e534d2205c57bc70e66b5fe39)**",
    "created_at": "2021-06-23T22:48:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515688",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`fc47386`](https://github.com/sagemath/sagetrac-mirror/commit/fc473866c2cdca092ca43133506f9be701100e5b)** to **[`d3828ff`](https://github.com/sagemath/sagetrac-mirror/commit/d3828ff9d2383b2e534d2205c57bc70e66b5fe39)**



---

archive/issue_comments_515689.json:
```json
{
    "body": "<div id=\"comment:27\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3828ff9d2383b2e534d2205c57bc70e66b5fe39\"><code>d3828ff</code></a></td><td><code>src/sage/misc/dist.py: Fix typo</code></td></tr></table>\n",
    "created_at": "2021-06-23T22:48:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515689",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3828ff9d2383b2e534d2205c57bc70e66b5fe39"><code>d3828ff</code></a></td><td><code>src/sage/misc/dist.py: Fix typo</code></td></tr></table>




---

archive/issue_comments_515690.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bfa7ac046c37f8c7bbdf7e46339db5d42c1ed671\"><code>bfa7ac0</code></a></td><td><code>build/bin/sage-starts, build/make/Makefile.in, src/sage/all.py: Remove use of sage-started.txt file</code></td></tr></table>\n",
    "created_at": "2021-06-23T23:16:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515690",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bfa7ac046c37f8c7bbdf7e46339db5d42c1ed671"><code>bfa7ac0</code></a></td><td><code>build/bin/sage-starts, build/make/Makefile.in, src/sage/all.py: Remove use of sage-started.txt file</code></td></tr></table>




---

archive/issue_comments_515691.json:
```json
{
    "body": "Changed commit from **[`d3828ff`](https://github.com/sagemath/sagetrac-mirror/commit/d3828ff9d2383b2e534d2205c57bc70e66b5fe39)** to **[`bfa7ac0`](https://github.com/sagemath/sagetrac-mirror/commit/bfa7ac046c37f8c7bbdf7e46339db5d42c1ed671)**",
    "created_at": "2021-06-23T23:16:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515691",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d3828ff`](https://github.com/sagemath/sagetrac-mirror/commit/d3828ff9d2383b2e534d2205c57bc70e66b5fe39)** to **[`bfa7ac0`](https://github.com/sagemath/sagetrac-mirror/commit/bfa7ac046c37f8c7bbdf7e46339db5d42c1ed671)**



---

archive/issue_comments_515692.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@kiwifb](#comment%3A13):\n> * The stuff in `calculus/desolvers.py` should be carefully reviewed - can we still use that stuff and if yes, how? \n\nNo need to do this on this ticket -- SAGE_LOCAL is only used as an environment variable in a shell command line there, not as a Python variable",
    "created_at": "2021-06-23T23:17:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515692",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@kiwifb](#comment%3A13):
> * The stuff in `calculus/desolvers.py` should be carefully reviewed - can we still use that stuff and if yes, how? 

No need to do this on this ticket -- SAGE_LOCAL is only used as an environment variable in a shell command line there, not as a Python variable



---

archive/issue_comments_515693.json:
```json
{
    "body": "Changed commit from **[`bfa7ac0`](https://github.com/sagemath/sagetrac-mirror/commit/bfa7ac046c37f8c7bbdf7e46339db5d42c1ed671)** to **[`7d6eced`](https://github.com/sagemath/sagetrac-mirror/commit/7d6eceded36757155d993fe6b7ca70037792b754)**",
    "created_at": "2021-06-23T23:21:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515693",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`bfa7ac0`](https://github.com/sagemath/sagetrac-mirror/commit/bfa7ac046c37f8c7bbdf7e46339db5d42c1ed671)** to **[`7d6eced`](https://github.com/sagemath/sagetrac-mirror/commit/7d6eceded36757155d993fe6b7ca70037792b754)**



---

archive/issue_comments_515694.json:
```json
{
    "body": "<div id=\"comment:30\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7d6eceded36757155d993fe6b7ca70037792b754\"><code>7d6eced</code></a></td><td><code>src/sage/plot/plot3d/base.pyx: Remove unused imports, including SAGE_LOCAL</code></td></tr></table>\n",
    "created_at": "2021-06-23T23:21:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515694",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:30"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7d6eceded36757155d993fe6b7ca70037792b754"><code>7d6eced</code></a></td><td><code>src/sage/plot/plot3d/base.pyx: Remove unused imports, including SAGE_LOCAL</code></td></tr></table>




---

archive/issue_comments_515695.json:
```json
{
    "body": "<div id=\"comment:31\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6878a264a1b1c0815656fd2472a6b0b97bb80cb\"><code>c6878a2</code></a></td><td><code>src/sage/misc/citation.pyx: Do not fail if SAGE_LOCAL is unset; handle SAGE_VENV like SAGE_LOCAL</code></td></tr></table>\n",
    "created_at": "2021-06-23T23:26:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515695",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6878a264a1b1c0815656fd2472a6b0b97bb80cb"><code>c6878a2</code></a></td><td><code>src/sage/misc/citation.pyx: Do not fail if SAGE_LOCAL is unset; handle SAGE_VENV like SAGE_LOCAL</code></td></tr></table>




---

archive/issue_comments_515696.json:
```json
{
    "body": "Changed commit from **[`7d6eced`](https://github.com/sagemath/sagetrac-mirror/commit/7d6eceded36757155d993fe6b7ca70037792b754)** to **[`c6878a2`](https://github.com/sagemath/sagetrac-mirror/commit/c6878a264a1b1c0815656fd2472a6b0b97bb80cb)**",
    "created_at": "2021-06-23T23:26:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515696",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7d6eced`](https://github.com/sagemath/sagetrac-mirror/commit/7d6eceded36757155d993fe6b7ca70037792b754)** to **[`c6878a2`](https://github.com/sagemath/sagetrac-mirror/commit/c6878a264a1b1c0815656fd2472a6b0b97bb80cb)**



---

archive/issue_events_438619.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-23T23:30:57Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "title_is": "sage.env: Remove fallback of SAGE_LOCAL to SAGE_VENV, remove direct uses of SAGE_LOCAL from the Sage library",
    "title_was": "sage.env: Remove default setting of SAGE_LOCAL from SAGE_VENV",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438619"
}
```



---

archive/issue_comments_515697.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nFor the remaining items we have separate open tickets listed in #30818",
    "created_at": "2021-06-23T23:33:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515697",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:33" align="right">comment:33</div>

For the remaining items we have separate open tickets listed in #30818



---

archive/issue_comments_515698.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nShould I still provide a commit for `lie` here or add a new ticket in #30818?",
    "created_at": "2021-06-23T23:35:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515698",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:34" align="right">comment:34</div>

Should I still provide a commit for `lie` here or add a new ticket in #30818?



---

archive/issue_comments_515699.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nHere is fine, I think",
    "created_at": "2021-06-23T23:37:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515699",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:35" align="right">comment:35</div>

Here is fine, I think



---

archive/issue_comments_515700.json:
```json
{
    "body": "Changed author from **Matthias Koeppe** to **Matthias Koeppe, Fran\u00e7ois Bissey**",
    "created_at": "2021-06-24T01:05:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515700",
    "user": "https://github.com/kiwifb"
}
```

Changed author from **Matthias Koeppe** to **Matthias Koeppe, François Bissey**



---

archive/issue_comments_515701.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nAnd here is the LiE stuff. \n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/44fd912a5e1b2f3c4ac1d60ada8874165d783015\"><code>44fd912</code></a></td><td><code>Introduce LIE_INFO_DIR to point to the location of the info files of a LiE install and use it.</code></td></tr></table>\n",
    "created_at": "2021-06-24T01:05:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515701",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:36" align="right">comment:36</div>

And here is the LiE stuff. 

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/44fd912a5e1b2f3c4ac1d60ada8874165d783015"><code>44fd912</code></a></td><td><code>Introduce LIE_INFO_DIR to point to the location of the info files of a LiE install and use it.</code></td></tr></table>




---

archive/issue_comments_515702.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/sage_env__remove_default_setting_of_sage_local_from_sage_venv](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_env__remove_default_setting_of_sage_local_from_sage_venv)** to **[u/fbissey/sage_local_extinction_path](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/sage_local_extinction_path)**",
    "created_at": "2021-06-24T01:05:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515702",
    "user": "https://github.com/kiwifb"
}
```

Changed branch from **[u/mkoeppe/sage_env__remove_default_setting_of_sage_local_from_sage_venv](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_env__remove_default_setting_of_sage_local_from_sage_venv)** to **[u/fbissey/sage_local_extinction_path](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/sage_local_extinction_path)**



---

archive/issue_comments_515703.json:
```json
{
    "body": "Changed commit from **[`c6878a2`](https://github.com/sagemath/sagetrac-mirror/commit/c6878a264a1b1c0815656fd2472a6b0b97bb80cb)** to **[`44fd912`](https://github.com/sagemath/sagetrac-mirror/commit/44fd912a5e1b2f3c4ac1d60ada8874165d783015)**",
    "created_at": "2021-06-24T01:05:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515703",
    "user": "https://github.com/kiwifb"
}
```

Changed commit from **[`c6878a2`](https://github.com/sagemath/sagetrac-mirror/commit/c6878a264a1b1c0815656fd2472a6b0b97bb80cb)** to **[`44fd912`](https://github.com/sagemath/sagetrac-mirror/commit/44fd912a5e1b2f3c4ac1d60ada8874165d783015)**



---

archive/issue_comments_515704.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\n\n```\n+LIE_INFO_DIR = var(\"LIE_INFO_DIR\", join(SAGE_LOCAL, \"lib\". \"LiE\"))\n```\ntypo - there should be a comma",
    "created_at": "2021-06-24T01:24:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515704",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:37" align="right">comment:37</div>


```
+LIE_INFO_DIR = var("LIE_INFO_DIR", join(SAGE_LOCAL, "lib". "LiE"))
```
typo - there should be a comma



---

archive/issue_comments_515705.json:
```json
{
    "body": "Changed commit from **[`44fd912`](https://github.com/sagemath/sagetrac-mirror/commit/44fd912a5e1b2f3c4ac1d60ada8874165d783015)** to **[`405c248`](https://github.com/sagemath/sagetrac-mirror/commit/405c248d331489654c2dd1660c2d7112ce420a06)**",
    "created_at": "2021-06-24T01:27:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515705",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`44fd912`](https://github.com/sagemath/sagetrac-mirror/commit/44fd912a5e1b2f3c4ac1d60ada8874165d783015)** to **[`405c248`](https://github.com/sagemath/sagetrac-mirror/commit/405c248d331489654c2dd1660c2d7112ce420a06)**



---

archive/issue_comments_515706.json:
```json
{
    "body": "<div id=\"comment:38\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/405c248d331489654c2dd1660c2d7112ce420a06\"><code>405c248</code></a></td><td><code>correct typo (dot to comma)</code></td></tr></table>\n",
    "created_at": "2021-06-24T01:27:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515706",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:38"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/405c248d331489654c2dd1660c2d7112ce420a06"><code>405c248</code></a></td><td><code>correct typo (dot to comma)</code></td></tr></table>




---

archive/issue_comments_515707.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nReplying to [@mkoeppe](#comment%3A37):\n> \n> ```\n> +LIE_INFO_DIR = var(\"LIE_INFO_DIR\", join(SAGE_LOCAL, \"lib\". \"LiE\"))\n> ```\n> typo - there should be a comma\n\nThanks. I will add that all this work will actually further reduce some patching currently occurring in sage-on-gentoo. Which is a good thing^(TM).",
    "created_at": "2021-06-24T01:28:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515707",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:39" align="right">comment:39</div>

Replying to [@mkoeppe](#comment%3A37):
> 
> ```
> +LIE_INFO_DIR = var("LIE_INFO_DIR", join(SAGE_LOCAL, "lib". "LiE"))
> ```
> typo - there should be a comma

Thanks. I will add that all this work will actually further reduce some patching currently occurring in sage-on-gentoo. Which is a good thing^(TM).



---

archive/issue_comments_515708.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nStill crashing at startup with the current branch, this should probably depend on #30819\n\n```\n/usr/lib/python3.9/site-packages/sage/databases/conway.py in <module>\n     21 \n     22 from sage.env import CONWAY_POLYNOMIALS_DATA_DIR\n     23 \n---> 24 _CONWAYDATA = os.path.join(CONWAY_POLYNOMIALS_DATA_DIR, 'conway_polynomials.p')\n        global _CONWAYDATA = undefined\n        global os.path.join = <function join at 0x7fa811ace8b0>\n        global CONWAY_POLYNOMIALS_DATA_DIR = None\n     25 _conwaydict = None\n     26 \n     27 class DictInMapping(Mapping):\n\n/usr/lib/python3.9/posixpath.py in join(a=None, *p=('conway_polynomials.p',))\n     73     If any component is an absolute path, all previous path components\n     74     will be discarded.  An empty last part will result in a path that\n     75     ends with a separator.\"\"\"\n---> 76     a = os.fspath(a)\n        a = None\n        global os.fspath = <built-in function fspath>\n     77     sep = _get_sep(a)\n     78     path = a\n     79     try:\n\nTypeError: expected str, bytes or os.PathLike object, not NoneType\n```",
    "created_at": "2021-06-24T06:34:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515708",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:40" align="right">comment:40</div>

Still crashing at startup with the current branch, this should probably depend on #30819

```
/usr/lib/python3.9/site-packages/sage/databases/conway.py in <module>
     21 
     22 from sage.env import CONWAY_POLYNOMIALS_DATA_DIR
     23 
---> 24 _CONWAYDATA = os.path.join(CONWAY_POLYNOMIALS_DATA_DIR, 'conway_polynomials.p')
        global _CONWAYDATA = undefined
        global os.path.join = <function join at 0x7fa811ace8b0>
        global CONWAY_POLYNOMIALS_DATA_DIR = None
     25 _conwaydict = None
     26 
     27 class DictInMapping(Mapping):

/usr/lib/python3.9/posixpath.py in join(a=None, *p=('conway_polynomials.p',))
     73     If any component is an absolute path, all previous path components
     74     will be discarded.  An empty last part will result in a path that
     75     ends with a separator."""
---> 76     a = os.fspath(a)
        a = None
        global os.fspath = <built-in function fspath>
     77     sep = _get_sep(a)
     78     path = a
     79     try:

TypeError: expected str, bytes or os.PathLike object, not NoneType
```



---

archive/issue_comments_515709.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nReplying to [@kiwifb](#comment%3A36):\n> And here is the LiE stuff. \n\n`LIE_INFO_DIR = var(\"LIE_INFO_DIR\", join(SAGE_LOCAL, \"lib\", \"LiE\"))`\n\nThis will still break if neither SAGE_LOCAL nor LIE_INFO_DIR are set. Shouldn't it use features too? (or, at the very least, provide a fallback based on `sysconfig.get_config_var('LIBDIR')`)",
    "created_at": "2021-06-24T06:43:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515709",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:41" align="right">comment:41</div>

Replying to [@kiwifb](#comment%3A36):
> And here is the LiE stuff. 

`LIE_INFO_DIR = var("LIE_INFO_DIR", join(SAGE_LOCAL, "lib", "LiE"))`

This will still break if neither SAGE_LOCAL nor LIE_INFO_DIR are set. Shouldn't it use features too? (or, at the very least, provide a fallback based on `sysconfig.get_config_var('LIBDIR')`)



---

archive/issue_comments_515710.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\n`CONWAY_POLYNOMIALS_DATA_DIR` can just be set to the correct location in `sage_conf`",
    "created_at": "2021-06-24T06:46:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515710",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:42" align="right">comment:42</div>

`CONWAY_POLYNOMIALS_DATA_DIR` can just be set to the correct location in `sage_conf`



---

archive/issue_comments_515711.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nReplying to [@antonio-rojas](#comment%3A41):\n> Replying to [@kiwifb](#comment%3A36):\n> > And here is the LiE stuff. \n\n> \n> `LIE_INFO_DIR = var(\"LIE_INFO_DIR\", join(SAGE_LOCAL, \"lib\", \"LiE\"))`\n> \n> This will still break if neither SAGE_LOCAL nor LIE_INFO_DIR are set. Shouldn't it use features too? (or, at the very least, provide a fallback based on `sysconfig.get_config_var('LIBDIR')`)\n\nLiE is an optional package. So, it won't break unless you try to use it. Upstream is actually not installing stuff properly, we shouldn't be looking up info files under `lib` of any kind.\n\nUsing feature is certainly possible and it should start with detecting the executable. The rest is to consult the doc from inside sage and it really should be at the distribution's discretion because it is arbitrary and not something the program itself knows anything about.",
    "created_at": "2021-06-24T08:23:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515711",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:43" align="right">comment:43</div>

Replying to [@antonio-rojas](#comment%3A41):
> Replying to [@kiwifb](#comment%3A36):
> > And here is the LiE stuff. 

> 
> `LIE_INFO_DIR = var("LIE_INFO_DIR", join(SAGE_LOCAL, "lib", "LiE"))`
> 
> This will still break if neither SAGE_LOCAL nor LIE_INFO_DIR are set. Shouldn't it use features too? (or, at the very least, provide a fallback based on `sysconfig.get_config_var('LIBDIR')`)

LiE is an optional package. So, it won't break unless you try to use it. Upstream is actually not installing stuff properly, we shouldn't be looking up info files under `lib` of any kind.

Using feature is certainly possible and it should start with detecting the executable. The rest is to consult the doc from inside sage and it really should be at the distribution's discretion because it is arbitrary and not something the program itself knows anything about.



---

archive/issue_comments_515712.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nI have opened #32055 for the task of adding an `spkg-configure.m4` for `lie`. I don't think a fallback is needed",
    "created_at": "2021-06-24T15:33:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515712",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:44" align="right">comment:44</div>

I have opened #32055 for the task of adding an `spkg-configure.m4` for `lie`. I don't think a fallback is needed



---

archive/issue_comments_515713.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nI'll add a feature `DatabaseConwayPolynomials`",
    "created_at": "2021-06-24T15:39:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515713",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:45" align="right">comment:45</div>

I'll add a feature `DatabaseConwayPolynomials`



---

archive/issue_comments_515714.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nI don't get sci-mathematics/lie on my Gentoo box, is it not yet in Gentoo?",
    "created_at": "2021-06-24T15:47:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515714",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:46" align="right">comment:46</div>

I don't get sci-mathematics/lie on my Gentoo box, is it not yet in Gentoo?



---

archive/issue_comments_515715.json:
```json
{
    "body": "Changed branch from **[u/fbissey/sage_local_extinction_path](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/sage_local_extinction_path)** to **[u/mkoeppe/sage_local_extinction_path](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_local_extinction_path)**",
    "created_at": "2021-06-24T15:56:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515715",
    "user": "https://github.com/mkoeppe"
}
```

Changed branch from **[u/fbissey/sage_local_extinction_path](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/sage_local_extinction_path)** to **[u/mkoeppe/sage_local_extinction_path](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_local_extinction_path)**



---

archive/issue_comments_515716.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/sage_local_extinction_path](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_local_extinction_path)** to **[u/fbissey/sage_local_extinction_path](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/sage_local_extinction_path)**",
    "created_at": "2021-06-24T15:57:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515716",
    "user": "https://github.com/antonio-rojas"
}
```

Changed branch from **[u/mkoeppe/sage_local_extinction_path](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_local_extinction_path)** to **[u/fbissey/sage_local_extinction_path](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/sage_local_extinction_path)**



---

archive/issue_comments_515717.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nReplying to [@mkoeppe](#comment%3A42):\n> `CONWAY_POLYNOMIALS_DATA_DIR` can just be set to the correct location in `sage_conf`\n\nI think I'm missing something here, when was `sage_conf` made mandatory even for distro installs? The description says \"This default is no longer necessary because sage_conf is now a requirement\" but to me it looks the other way around: `sage_conf` is required because this ticket purposely breaks setups without it.",
    "created_at": "2021-06-24T15:57:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515717",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:48" align="right">comment:48</div>

Replying to [@mkoeppe](#comment%3A42):
> `CONWAY_POLYNOMIALS_DATA_DIR` can just be set to the correct location in `sage_conf`

I think I'm missing something here, when was `sage_conf` made mandatory even for distro installs? The description says "This default is no longer necessary because sage_conf is now a requirement" but to me it looks the other way around: `sage_conf` is required because this ticket purposely breaks setups without it.



---

archive/issue_comments_515718.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nReplying to [@mkoeppe](#comment%3A47):\n\nSorry, I think my comment reverted your branch change",
    "created_at": "2021-06-24T15:58:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515718",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:49" align="right">comment:49</div>

Replying to [@mkoeppe](#comment%3A47):

Sorry, I think my comment reverted your branch change



---

archive/issue_comments_515719.json:
```json
{
    "body": "<div id=\"comment:50\"></div>\n\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/faa96373b773e562052491958fa18a937546c29d\"><code>faa9637</code></a></td><td><code>src/sage/misc/dist.py: Return with error message if SAGE_LOCAL is not set</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/82f5c3afed12cb78f57dc4557d5447fdfcf9d646\"><code>82f5c3a</code></a></td><td><code>src/sage/misc/compat.py: Do not fail if SAGE_LOCAL is unset</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc473866c2cdca092ca43133506f9be701100e5b\"><code>fc47386</code></a></td><td><code>src/sage/misc/cython.py: Do not fail if SAGE_LOCAL is not set</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3828ff9d2383b2e534d2205c57bc70e66b5fe39\"><code>d3828ff</code></a></td><td><code>src/sage/misc/dist.py: Fix typo</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bfa7ac046c37f8c7bbdf7e46339db5d42c1ed671\"><code>bfa7ac0</code></a></td><td><code>build/bin/sage-starts, build/make/Makefile.in, src/sage/all.py: Remove use of sage-started.txt file</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7d6eceded36757155d993fe6b7ca70037792b754\"><code>7d6eced</code></a></td><td><code>src/sage/plot/plot3d/base.pyx: Remove unused imports, including SAGE_LOCAL</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6878a264a1b1c0815656fd2472a6b0b97bb80cb\"><code>c6878a2</code></a></td><td><code>src/sage/misc/citation.pyx: Do not fail if SAGE_LOCAL is unset; handle SAGE_VENV like SAGE_LOCAL</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/44fd912a5e1b2f3c4ac1d60ada8874165d783015\"><code>44fd912</code></a></td><td><code>Introduce LIE_INFO_DIR to point to the location of the info files of a LiE install and use it.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/405c248d331489654c2dd1660c2d7112ce420a06\"><code>405c248</code></a></td><td><code>correct typo (dot to comma)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1eac9f999d3ec13ea6c8c15625b6259d5660ea7\"><code>e1eac9f</code></a></td><td><code>sage.features.DatabaseConwayPolynomials: New, use it in sage.databases.conway</code></td></tr></table>\n",
    "created_at": "2021-06-24T17:01:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515719",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:50"></div>

Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/faa96373b773e562052491958fa18a937546c29d"><code>faa9637</code></a></td><td><code>src/sage/misc/dist.py: Return with error message if SAGE_LOCAL is not set</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/82f5c3afed12cb78f57dc4557d5447fdfcf9d646"><code>82f5c3a</code></a></td><td><code>src/sage/misc/compat.py: Do not fail if SAGE_LOCAL is unset</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc473866c2cdca092ca43133506f9be701100e5b"><code>fc47386</code></a></td><td><code>src/sage/misc/cython.py: Do not fail if SAGE_LOCAL is not set</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3828ff9d2383b2e534d2205c57bc70e66b5fe39"><code>d3828ff</code></a></td><td><code>src/sage/misc/dist.py: Fix typo</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bfa7ac046c37f8c7bbdf7e46339db5d42c1ed671"><code>bfa7ac0</code></a></td><td><code>build/bin/sage-starts, build/make/Makefile.in, src/sage/all.py: Remove use of sage-started.txt file</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7d6eceded36757155d993fe6b7ca70037792b754"><code>7d6eced</code></a></td><td><code>src/sage/plot/plot3d/base.pyx: Remove unused imports, including SAGE_LOCAL</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6878a264a1b1c0815656fd2472a6b0b97bb80cb"><code>c6878a2</code></a></td><td><code>src/sage/misc/citation.pyx: Do not fail if SAGE_LOCAL is unset; handle SAGE_VENV like SAGE_LOCAL</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/44fd912a5e1b2f3c4ac1d60ada8874165d783015"><code>44fd912</code></a></td><td><code>Introduce LIE_INFO_DIR to point to the location of the info files of a LiE install and use it.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/405c248d331489654c2dd1660c2d7112ce420a06"><code>405c248</code></a></td><td><code>correct typo (dot to comma)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1eac9f999d3ec13ea6c8c15625b6259d5660ea7"><code>e1eac9f</code></a></td><td><code>sage.features.DatabaseConwayPolynomials: New, use it in sage.databases.conway</code></td></tr></table>




---

archive/issue_comments_515720.json:
```json
{
    "body": "Changed branch from **[u/fbissey/sage_local_extinction_path](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/sage_local_extinction_path)** to **[u/mkoeppe/sage_local_extinction_path](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_local_extinction_path)**",
    "created_at": "2021-06-24T17:01:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515720",
    "user": "https://github.com/mkoeppe"
}
```

Changed branch from **[u/fbissey/sage_local_extinction_path](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/sage_local_extinction_path)** to **[u/mkoeppe/sage_local_extinction_path](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_local_extinction_path)**



---

archive/issue_comments_515721.json:
```json
{
    "body": "Changed commit from **[`405c248`](https://github.com/sagemath/sagetrac-mirror/commit/405c248d331489654c2dd1660c2d7112ce420a06)** to **[`e1eac9f`](https://github.com/sagemath/sagetrac-mirror/commit/e1eac9f999d3ec13ea6c8c15625b6259d5660ea7)**",
    "created_at": "2021-06-24T17:01:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515721",
    "user": "https://github.com/mkoeppe"
}
```

Changed commit from **[`405c248`](https://github.com/sagemath/sagetrac-mirror/commit/405c248d331489654c2dd1660c2d7112ce420a06)** to **[`e1eac9f`](https://github.com/sagemath/sagetrac-mirror/commit/e1eac9f999d3ec13ea6c8c15625b6259d5660ea7)**



---

archive/issue_comments_515722.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nReplying to [@dimpase](#comment%3A46):\n> I don't get sci-mathematics/lie on my Gentoo box, is it not yet in Gentoo?\n\nNo idea, I got this information from https://repology.org/project/lie/versions",
    "created_at": "2021-06-24T17:02:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515722",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:51" align="right">comment:51</div>

Replying to [@dimpase](#comment%3A46):
> I don't get sci-mathematics/lie on my Gentoo box, is it not yet in Gentoo?

No idea, I got this information from https://repology.org/project/lie/versions



---

archive/issue_comments_515723.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nReplying to [@mkoeppe](#comment%3A45):\n> I'll add a feature `DatabaseConwayPolynomials`\n\nThanks. Unfortunately this doesn't help since the search patch is still defined in terms of `CONWAY_POLYNOMIALS_DATA_DIR` without a fallback.\n\nI'm really strugging to understand the purpose of this change. Currently we have a long list of sane defaults in `env.py` which made everything work nicely out of the box. After this, if I understand correctly, are we expected to maintain a per-distro list of environment variables which essentially duplicates the list in `env.py`? This seems a big regression to me.",
    "created_at": "2021-06-24T19:29:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515723",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:52" align="right">comment:52</div>

Replying to [@mkoeppe](#comment%3A45):
> I'll add a feature `DatabaseConwayPolynomials`

Thanks. Unfortunately this doesn't help since the search patch is still defined in terms of `CONWAY_POLYNOMIALS_DATA_DIR` without a fallback.

I'm really strugging to understand the purpose of this change. Currently we have a long list of sane defaults in `env.py` which made everything work nicely out of the box. After this, if I understand correctly, are we expected to maintain a per-distro list of environment variables which essentially duplicates the list in `env.py`? This seems a big regression to me.



---

archive/issue_comments_515724.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nDo you set `SAGE_LOCAL` in your distribution packaging?",
    "created_at": "2021-06-24T19:42:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515724",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:53" align="right">comment:53</div>

Do you set `SAGE_LOCAL` in your distribution packaging?



---

archive/issue_comments_515725.json:
```json
{
    "body": "<div id=\"comment:54\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/62c8990175a6e3b0c9a31833d0a4d24be2763e2c\"><code>62c8990</code></a></td><td><code>src/sage/features/databases.py: Only use CONWAY_POLYNOMIALS_DATA_DIR if it is set</code></td></tr></table>\n",
    "created_at": "2021-06-24T19:44:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515725",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:54"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/62c8990175a6e3b0c9a31833d0a4d24be2763e2c"><code>62c8990</code></a></td><td><code>src/sage/features/databases.py: Only use CONWAY_POLYNOMIALS_DATA_DIR if it is set</code></td></tr></table>




---

archive/issue_comments_515726.json:
```json
{
    "body": "Changed commit from **[`e1eac9f`](https://github.com/sagemath/sagetrac-mirror/commit/e1eac9f999d3ec13ea6c8c15625b6259d5660ea7)** to **[`62c8990`](https://github.com/sagemath/sagetrac-mirror/commit/62c8990175a6e3b0c9a31833d0a4d24be2763e2c)**",
    "created_at": "2021-06-24T19:44:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515726",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e1eac9f`](https://github.com/sagemath/sagetrac-mirror/commit/e1eac9f999d3ec13ea6c8c15625b6259d5660ea7)** to **[`62c8990`](https://github.com/sagemath/sagetrac-mirror/commit/62c8990175a6e3b0c9a31833d0a4d24be2763e2c)**



---

archive/issue_comments_515727.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nReplying to [@mkoeppe](#comment%3A53):\n> Do you set `SAGE_LOCAL` in your distribution packaging?\n\nNo, I don't set any env variable at all. Before this change, it was set to `/usr` in `env.py` via `SAGE_LOCAL \u2192 SAGE_ENV \u2192 os.path.abspath(sys.prefix)`, which in turn made all other variables which depend on it point to the correct paths.",
    "created_at": "2021-06-24T20:13:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515727",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:55" align="right">comment:55</div>

Replying to [@mkoeppe](#comment%3A53):
> Do you set `SAGE_LOCAL` in your distribution packaging?

No, I don't set any env variable at all. Before this change, it was set to `/usr` in `env.py` via `SAGE_LOCAL → SAGE_ENV → os.path.abspath(sys.prefix)`, which in turn made all other variables which depend on it point to the correct paths.



---

archive/issue_comments_515728.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nReplying to [@mkoeppe](#comment%3A51):\n> Replying to [@dimpase](#comment%3A46):\n> > I don't get sci-mathematics/lie on my Gentoo box, is it not yet in Gentoo?\n\n> \n> No idea, I got this information from https://repology.org/project/lie/versions\n\nIt is not in the main tree, but it has been in the science overlay for a while. However, if you want one that will definitely work, you'll have to go with my sage-on-gentoo overlay. I updated it yesterday when I found that tarball has changed location.",
    "created_at": "2021-06-24T20:44:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515728",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:56" align="right">comment:56</div>

Replying to [@mkoeppe](#comment%3A51):
> Replying to [@dimpase](#comment%3A46):
> > I don't get sci-mathematics/lie on my Gentoo box, is it not yet in Gentoo?

> 
> No idea, I got this information from https://repology.org/project/lie/versions

It is not in the main tree, but it has been in the science overlay for a while. However, if you want one that will definitely work, you'll have to go with my sage-on-gentoo overlay. I updated it yesterday when I found that tarball has changed location.



---

archive/issue_comments_515729.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nAbout `sage_conf`. I will want some small change to make it easier for distro, in a separate ticket of course, but my audience is here for now.\n\nCurrently `sage_conf` is a very customised python package in the sage tree that requires the top configure to be run for the variables to be setup to the proper values. Matthias encourage distro to write their own version of `sage_conf`. After giving it some thoughts, considering the way things works from source in Gentoo, writing a full blown python package that passes QA is too much of a hassle. This is not a place where we can just take a file and just install it in the right place(s) [OK, if you really insist we can abuse the system in such a way]. There are other issue like versioning that would need sorting. I don't want to maintain such a package. \n\nBut I still want to use `sage_conf` as it means that I don't to have patch `env.py` anymore. So, I write a small `sage_conf.py` file with my stuff, I install it alongside `env.py` and I change the import to be from `sage.sage_conf` instead of just `sage_conf`. What I would like to happen is for that option to be available out of the box in sage. Try `sage_conf` first and if it isn't present, try `sage.sage_conf`. The file is maintained alongside sage which means I don't have to worry about versioning amongst other things.",
    "created_at": "2021-06-24T20:59:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515729",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:57" align="right">comment:57</div>

About `sage_conf`. I will want some small change to make it easier for distro, in a separate ticket of course, but my audience is here for now.

Currently `sage_conf` is a very customised python package in the sage tree that requires the top configure to be run for the variables to be setup to the proper values. Matthias encourage distro to write their own version of `sage_conf`. After giving it some thoughts, considering the way things works from source in Gentoo, writing a full blown python package that passes QA is too much of a hassle. This is not a place where we can just take a file and just install it in the right place(s) [OK, if you really insist we can abuse the system in such a way]. There are other issue like versioning that would need sorting. I don't want to maintain such a package. 

But I still want to use `sage_conf` as it means that I don't to have patch `env.py` anymore. So, I write a small `sage_conf.py` file with my stuff, I install it alongside `env.py` and I change the import to be from `sage.sage_conf` instead of just `sage_conf`. What I would like to happen is for that option to be available out of the box in sage. Try `sage_conf` first and if it isn't present, try `sage.sage_conf`. The file is maintained alongside sage which means I don't have to worry about versioning amongst other things.



---

archive/issue_comments_515730.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nReplying to [@kiwifb](#comment%3A57):\n> I change the import to be from `sage.sage_conf` instead of just `sage_conf`. What I would like to happen is for that option to be available out of the box in sage. Try `sage_conf` first and if it isn't present, try `sage.sage_conf`.\n\nThat's terrible because then people who want to install the Sage library from source will not be able to use your distribution's `sage_conf`.",
    "created_at": "2021-06-24T21:20:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515730",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:58" align="right">comment:58</div>

Replying to [@kiwifb](#comment%3A57):
> I change the import to be from `sage.sage_conf` instead of just `sage_conf`. What I would like to happen is for that option to be available out of the box in sage. Try `sage_conf` first and if it isn't present, try `sage.sage_conf`.

That's terrible because then people who want to install the Sage library from source will not be able to use your distribution's `sage_conf`.



---

archive/issue_comments_515731.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nReplying to [@kiwifb](#comment%3A57):\n> Currently `sage_conf` is a very customised python package in the sage tree that requires the top configure to be run for the variables to be setup to the proper values. Matthias encourage distro to write their own version of `sage_conf`. After giving it some thoughts, considering the way things works from source in Gentoo, writing a full blown python package that passes QA is too much of a hassle. \n\nThen just pass it off as a patched version of the upstream sage_conf package.",
    "created_at": "2021-06-24T21:21:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515731",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:59" align="right">comment:59</div>

Replying to [@kiwifb](#comment%3A57):
> Currently `sage_conf` is a very customised python package in the sage tree that requires the top configure to be run for the variables to be setup to the proper values. Matthias encourage distro to write their own version of `sage_conf`. After giving it some thoughts, considering the way things works from source in Gentoo, writing a full blown python package that passes QA is too much of a hassle. 

Then just pass it off as a patched version of the upstream sage_conf package.



---

archive/issue_comments_515732.json:
```json
{
    "body": "<div id=\"comment:60\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/83d0b7e8b29dc6c21f4a8fd07150f1d7a44ab090\"><code>83d0b7e</code></a></td><td><code>src/sage/misc/compat.py: Do not fail if SAGE_LOCAL is unset</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cd4ccd3adf78e216fbb62bd340238e9c0f25e998\"><code>cd4ccd3</code></a></td><td><code>src/sage/misc/cython.py: Do not fail if SAGE_LOCAL is not set</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1a62da688c4671946918f58231c97daf36e16f20\"><code>1a62da6</code></a></td><td><code>src/sage/misc/dist.py: Fix typo</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/638182e5d8f9ef21ccfe2990e96fcd92aa19373f\"><code>638182e</code></a></td><td><code>build/bin/sage-starts, build/make/Makefile.in, src/sage/all.py: Remove use of sage-started.txt file</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4a356a286707cba7ee65b69370c2f49055bf3a12\"><code>4a356a2</code></a></td><td><code>src/sage/plot/plot3d/base.pyx: Remove unused imports, including SAGE_LOCAL</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/07a1a44b0aab0c36baa6b7ef01a69329dd40bdf5\"><code>07a1a44</code></a></td><td><code>src/sage/misc/citation.pyx: Do not fail if SAGE_LOCAL is unset; handle SAGE_VENV like SAGE_LOCAL</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5645479d65c7502184c747ffd0db36526c02638c\"><code>5645479</code></a></td><td><code>Introduce LIE_INFO_DIR to point to the location of the info files of a LiE install and use it.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fa0520a844fe67374c982d3b884c9e2f6842c01c\"><code>fa0520a</code></a></td><td><code>correct typo (dot to comma)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d7b9954397181265e606549857c6d59cccefa13a\"><code>d7b9954</code></a></td><td><code>sage.features.DatabaseConwayPolynomials: New, use it in sage.databases.conway</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d88c884b3222e420997cc491e98a36a7b9f876f5\"><code>d88c884</code></a></td><td><code>src/sage/features/databases.py: Only use CONWAY_POLYNOMIALS_DATA_DIR if it is set</code></td></tr></table>\n",
    "created_at": "2021-06-24T21:23:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515732",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:60"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/83d0b7e8b29dc6c21f4a8fd07150f1d7a44ab090"><code>83d0b7e</code></a></td><td><code>src/sage/misc/compat.py: Do not fail if SAGE_LOCAL is unset</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cd4ccd3adf78e216fbb62bd340238e9c0f25e998"><code>cd4ccd3</code></a></td><td><code>src/sage/misc/cython.py: Do not fail if SAGE_LOCAL is not set</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1a62da688c4671946918f58231c97daf36e16f20"><code>1a62da6</code></a></td><td><code>src/sage/misc/dist.py: Fix typo</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/638182e5d8f9ef21ccfe2990e96fcd92aa19373f"><code>638182e</code></a></td><td><code>build/bin/sage-starts, build/make/Makefile.in, src/sage/all.py: Remove use of sage-started.txt file</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4a356a286707cba7ee65b69370c2f49055bf3a12"><code>4a356a2</code></a></td><td><code>src/sage/plot/plot3d/base.pyx: Remove unused imports, including SAGE_LOCAL</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/07a1a44b0aab0c36baa6b7ef01a69329dd40bdf5"><code>07a1a44</code></a></td><td><code>src/sage/misc/citation.pyx: Do not fail if SAGE_LOCAL is unset; handle SAGE_VENV like SAGE_LOCAL</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5645479d65c7502184c747ffd0db36526c02638c"><code>5645479</code></a></td><td><code>Introduce LIE_INFO_DIR to point to the location of the info files of a LiE install and use it.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fa0520a844fe67374c982d3b884c9e2f6842c01c"><code>fa0520a</code></a></td><td><code>correct typo (dot to comma)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d7b9954397181265e606549857c6d59cccefa13a"><code>d7b9954</code></a></td><td><code>sage.features.DatabaseConwayPolynomials: New, use it in sage.databases.conway</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d88c884b3222e420997cc491e98a36a7b9f876f5"><code>d88c884</code></a></td><td><code>src/sage/features/databases.py: Only use CONWAY_POLYNOMIALS_DATA_DIR if it is set</code></td></tr></table>




---

archive/issue_comments_515733.json:
```json
{
    "body": "Changed commit from **[`62c8990`](https://github.com/sagemath/sagetrac-mirror/commit/62c8990175a6e3b0c9a31833d0a4d24be2763e2c)** to **[`d88c884`](https://github.com/sagemath/sagetrac-mirror/commit/d88c884b3222e420997cc491e98a36a7b9f876f5)**",
    "created_at": "2021-06-24T21:23:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515733",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`62c8990`](https://github.com/sagemath/sagetrac-mirror/commit/62c8990175a6e3b0c9a31833d0a4d24be2763e2c)** to **[`d88c884`](https://github.com/sagemath/sagetrac-mirror/commit/d88c884b3222e420997cc491e98a36a7b9f876f5)**



---

archive/issue_comments_515734.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nI have removed the initial commit, so the fallback is back. The other changes made here have independent value, so let's get them in.",
    "created_at": "2021-06-24T21:24:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515734",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:61" align="right">comment:61</div>

I have removed the initial commit, so the fallback is back. The other changes made here have independent value, so let's get them in.



---

archive/issue_comments_515735.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n (from [#31338 comment:13](https://github.com/sagemath/sage/issues/31338#comment:13))\n \n-This default is no longer necessary because `sage_conf` is now a requirement; and should be removed.\n+These changes are preparation for modularization and is also intended  to make downstream packaging easier.\n \n \n \n``````\n",
    "created_at": "2021-06-24T21:25:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515735",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 (from [#31338 comment:13](https://github.com/sagemath/sage/issues/31338#comment:13))
 
-This default is no longer necessary because `sage_conf` is now a requirement; and should be removed.
+These changes are preparation for modularization and is also intended  to make downstream packaging easier.
 
 
 
``````




---

archive/issue_events_438620.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-24T21:25:09Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "title_is": "sage.env: Remove direct uses of SAGE_LOCAL from the Sage library",
    "title_was": "sage.env: Remove fallback of SAGE_LOCAL to SAGE_VENV, remove direct uses of SAGE_LOCAL from the Sage library",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438620"
}
```



---

archive/issue_comments_515736.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nI honestly don't think they should use my distro's `sage_conf`. At least not in the current state. But it is an interesting prospect.\n\nIn the current state, I certainly don't want to use a patched version of your stuff. It has to become a proper pypi package first. Passing it off would be the same as writing one myself. I decided that I should draw some lines in the sand as to what I should do. I decided I should say \"no\" more often because I have already too much stuff to do, and in the current state that would clearly go there.\n\n---\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/83d0b7e8b29dc6c21f4a8fd07150f1d7a44ab090\"><code>83d0b7e</code></a></td><td><code>src/sage/misc/compat.py: Do not fail if SAGE_LOCAL is unset</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cd4ccd3adf78e216fbb62bd340238e9c0f25e998\"><code>cd4ccd3</code></a></td><td><code>src/sage/misc/cython.py: Do not fail if SAGE_LOCAL is not set</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1a62da688c4671946918f58231c97daf36e16f20\"><code>1a62da6</code></a></td><td><code>src/sage/misc/dist.py: Fix typo</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/638182e5d8f9ef21ccfe2990e96fcd92aa19373f\"><code>638182e</code></a></td><td><code>build/bin/sage-starts, build/make/Makefile.in, src/sage/all.py: Remove use of sage-started.txt file</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4a356a286707cba7ee65b69370c2f49055bf3a12\"><code>4a356a2</code></a></td><td><code>src/sage/plot/plot3d/base.pyx: Remove unused imports, including SAGE_LOCAL</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/07a1a44b0aab0c36baa6b7ef01a69329dd40bdf5\"><code>07a1a44</code></a></td><td><code>src/sage/misc/citation.pyx: Do not fail if SAGE_LOCAL is unset; handle SAGE_VENV like SAGE_LOCAL</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5645479d65c7502184c747ffd0db36526c02638c\"><code>5645479</code></a></td><td><code>Introduce LIE_INFO_DIR to point to the location of the info files of a LiE install and use it.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fa0520a844fe67374c982d3b884c9e2f6842c01c\"><code>fa0520a</code></a></td><td><code>correct typo (dot to comma)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d7b9954397181265e606549857c6d59cccefa13a\"><code>d7b9954</code></a></td><td><code>sage.features.DatabaseConwayPolynomials: New, use it in sage.databases.conway</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d88c884b3222e420997cc491e98a36a7b9f876f5\"><code>d88c884</code></a></td><td><code>src/sage/features/databases.py: Only use CONWAY_POLYNOMIALS_DATA_DIR if it is set</code></td></tr></table>\n",
    "created_at": "2021-06-24T21:30:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515736",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:63" align="right">comment:63</div>

I honestly don't think they should use my distro's `sage_conf`. At least not in the current state. But it is an interesting prospect.

In the current state, I certainly don't want to use a patched version of your stuff. It has to become a proper pypi package first. Passing it off would be the same as writing one myself. I decided that I should draw some lines in the sand as to what I should do. I decided I should say "no" more often because I have already too much stuff to do, and in the current state that would clearly go there.

---
Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/83d0b7e8b29dc6c21f4a8fd07150f1d7a44ab090"><code>83d0b7e</code></a></td><td><code>src/sage/misc/compat.py: Do not fail if SAGE_LOCAL is unset</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cd4ccd3adf78e216fbb62bd340238e9c0f25e998"><code>cd4ccd3</code></a></td><td><code>src/sage/misc/cython.py: Do not fail if SAGE_LOCAL is not set</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1a62da688c4671946918f58231c97daf36e16f20"><code>1a62da6</code></a></td><td><code>src/sage/misc/dist.py: Fix typo</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/638182e5d8f9ef21ccfe2990e96fcd92aa19373f"><code>638182e</code></a></td><td><code>build/bin/sage-starts, build/make/Makefile.in, src/sage/all.py: Remove use of sage-started.txt file</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4a356a286707cba7ee65b69370c2f49055bf3a12"><code>4a356a2</code></a></td><td><code>src/sage/plot/plot3d/base.pyx: Remove unused imports, including SAGE_LOCAL</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/07a1a44b0aab0c36baa6b7ef01a69329dd40bdf5"><code>07a1a44</code></a></td><td><code>src/sage/misc/citation.pyx: Do not fail if SAGE_LOCAL is unset; handle SAGE_VENV like SAGE_LOCAL</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5645479d65c7502184c747ffd0db36526c02638c"><code>5645479</code></a></td><td><code>Introduce LIE_INFO_DIR to point to the location of the info files of a LiE install and use it.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fa0520a844fe67374c982d3b884c9e2f6842c01c"><code>fa0520a</code></a></td><td><code>correct typo (dot to comma)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d7b9954397181265e606549857c6d59cccefa13a"><code>d7b9954</code></a></td><td><code>sage.features.DatabaseConwayPolynomials: New, use it in sage.databases.conway</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d88c884b3222e420997cc491e98a36a7b9f876f5"><code>d88c884</code></a></td><td><code>src/sage/features/databases.py: Only use CONWAY_POLYNOMIALS_DATA_DIR if it is set</code></td></tr></table>




---

archive/issue_events_438621.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2021-06-24T21:30:07Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "title_is": "sage.env: Remove fallback of SAGE_LOCAL to SAGE_VENV, remove direct uses of SAGE_LOCAL from the Sage library",
    "title_was": "sage.env: Remove direct uses of SAGE_LOCAL from the Sage library",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438621"
}
```



---

archive/issue_comments_515737.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n (from [#31338 comment:13](https://github.com/sagemath/sage/issues/31338#comment:13))\n \n-These changes are preparation for modularization and is also intended  to make downstream packaging easier.\n+This default is no longer necessary because `sage_conf` is now a requirement; and should be removed.\n \n \n \n``````\n",
    "created_at": "2021-06-24T21:30:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515737",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 (from [#31338 comment:13](https://github.com/sagemath/sage/issues/31338#comment:13))
 
-These changes are preparation for modularization and is also intended  to make downstream packaging easier.
+This default is no longer necessary because `sage_conf` is now a requirement; and should be removed.
 
 
 
``````




---

archive/issue_comments_515738.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nRestoring your changes.",
    "created_at": "2021-06-24T21:32:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515738",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:64" align="right">comment:64</div>

Restoring your changes.



---

archive/issue_events_438622.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2021-06-24T21:32:14Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "title_is": "sage.env: Remove direct uses of SAGE_LOCAL from the Sage library",
    "title_was": "sage.env: Remove fallback of SAGE_LOCAL to SAGE_VENV, remove direct uses of SAGE_LOCAL from the Sage library",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438622"
}
```



---

archive/issue_comments_515739.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n (from [#31338 comment:13](https://github.com/sagemath/sage/issues/31338#comment:13))\n \n-This default is no longer necessary because `sage_conf` is now a requirement; and should be removed.\n+These changes are preparation for modularization and is also intended  to make downstream packaging easier.\n \n \n \n``````\n",
    "created_at": "2021-06-24T21:33:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515739",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 (from [#31338 comment:13](https://github.com/sagemath/sage/issues/31338#comment:13))
 
-This default is no longer necessary because `sage_conf` is now a requirement; and should be removed.
+These changes are preparation for modularization and is also intended  to make downstream packaging easier.
 
 
 
``````




---

archive/issue_comments_515740.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nI am otherwise quite happy with the state of the ticket. I would have prefered the initial commit to stay in but we can do that later.",
    "created_at": "2021-06-24T21:42:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515740",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:66" align="right">comment:66</div>

I am otherwise quite happy with the state of the ticket. I would have prefered the initial commit to stay in but we can do that later.



---

archive/issue_comments_515741.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nReplying to [@kiwifb](#comment%3A56):\n> Replying to [@mkoeppe](#comment%3A51):\n> > Replying to [@dimpase](#comment%3A46):\n> > > I don't get sci-mathematics/lie on my Gentoo box, is it not yet in Gentoo?\n\n> > \n> > No idea, I got this information from https://repology.org/project/lie/versions\n\n> \n> It is not in the main tree, but it has been in the science overlay for a while. However, if you want one that will definitely work, you'll have to go with my sage-on-gentoo overlay. I updated it yesterday when I found that tarball has changed location.\n\nI was able to install lie on Gentoo by doing\n\n```\nlayman --add science\nemerge --ask lie\n```\nShould we add\n\n```\nemerge --ask app-portage/layman\nlayman --add science\n```\nto whatever the current place for these per-system advice is (it was moved around...)",
    "created_at": "2021-06-25T09:57:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515741",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:68" align="right">comment:68</div>

Replying to [@kiwifb](#comment%3A56):
> Replying to [@mkoeppe](#comment%3A51):
> > Replying to [@dimpase](#comment%3A46):
> > > I don't get sci-mathematics/lie on my Gentoo box, is it not yet in Gentoo?

> > 
> > No idea, I got this information from https://repology.org/project/lie/versions

> 
> It is not in the main tree, but it has been in the science overlay for a while. However, if you want one that will definitely work, you'll have to go with my sage-on-gentoo overlay. I updated it yesterday when I found that tarball has changed location.

I was able to install lie on Gentoo by doing

```
layman --add science
emerge --ask lie
```
Should we add

```
emerge --ask app-portage/layman
layman --add science
```
to whatever the current place for these per-system advice is (it was moved around...)



---

archive/issue_comments_515742.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nReplying to [@dimpase](#comment%3A68):\n> Replying to [@kiwifb](#comment%3A56):\n> > Replying to [@mkoeppe](#comment%3A51):\n> > > Replying to [@dimpase](#comment%3A46):\n> > > > I don't get sci-mathematics/lie on my Gentoo box, is it not yet in Gentoo?\n\n> > > \n> > > No idea, I got this information from https://repology.org/project/lie/versions\n\n> > \n> > It is not in the main tree, but it has been in the science overlay for a while. However, if you want one that will definitely work, you'll have to go with my sage-on-gentoo overlay. I updated it yesterday when I found that tarball has changed location.\n\n> \n> I was able to install lie on Gentoo by doing\n> \n> ```\n> layman --add science\n> emerge --ask lie\n> ```\n> Should we add\n> \n> ```\n> emerge --ask app-portage/layman\n> layman --add science\n> ```\n> to whatever the current place for these per-system advice is (it was moved around...)\n\nUsing layman is so outdated - even I moved on (last month :) ). Seriously, it is deprecated.\n\n```\nemerge eselect-repository \neselect repository enable science \nemaint sync -r science \n```\nor `emerge --sync`, all the repos managed that way will get pulled by `emerge --sync` or equivalent like `eix-sync`.",
    "created_at": "2021-06-25T10:06:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515742",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:69" align="right">comment:69</div>

Replying to [@dimpase](#comment%3A68):
> Replying to [@kiwifb](#comment%3A56):
> > Replying to [@mkoeppe](#comment%3A51):
> > > Replying to [@dimpase](#comment%3A46):
> > > > I don't get sci-mathematics/lie on my Gentoo box, is it not yet in Gentoo?

> > > 
> > > No idea, I got this information from https://repology.org/project/lie/versions

> > 
> > It is not in the main tree, but it has been in the science overlay for a while. However, if you want one that will definitely work, you'll have to go with my sage-on-gentoo overlay. I updated it yesterday when I found that tarball has changed location.

> 
> I was able to install lie on Gentoo by doing
> 
> ```
> layman --add science
> emerge --ask lie
> ```
> Should we add
> 
> ```
> emerge --ask app-portage/layman
> layman --add science
> ```
> to whatever the current place for these per-system advice is (it was moved around...)

Using layman is so outdated - even I moved on (last month :) ). Seriously, it is deprecated.

```
emerge eselect-repository 
eselect repository enable science 
emaint sync -r science 
```
or `emerge --sync`, all the repos managed that way will get pulled by `emerge --sync` or equivalent like `eix-sync`.



---

archive/issue_comments_515743.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2021-06-25T19:35:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515743",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_comments_515744.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nOK",
    "created_at": "2021-06-25T19:35:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515744",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:70" align="right">comment:70</div>

OK



---

archive/issue_events_438623.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-06-25T19:35:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438623"
}
```



---

archive/issue_events_438624.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-06-25T19:35:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438624"
}
```



---

archive/issue_comments_515745.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nThanks!",
    "created_at": "2021-06-25T19:45:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515745",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:71" align="right">comment:71</div>

Thanks!



---

archive/issue_comments_515746.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nOn OSX:\n\n```\n**********************************************************************\nFile \"src/sage/misc/compat.py\", line 97, in sage.misc.compat\nFailed example:\n    find_library('Singular')\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.9/site-packages/sage/doctest/forker.py\", line 718, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.9/site-packages/sage/doctest/forker.py\", line 1137, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.misc.compat[1]>\", line 1, in <module>\n        find_library('Singular')\n      File \"/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.9/site-packages/sage/misc/compat.py\", line 102, in find_library\n        result = _find_library(name)\n      File \"/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.9/site-packages/sage/misc/compat.py\", line 66, in _find_library\n        os.environ['DYLD_LIBRARY_PATH'] = sage_local_lib\n    NameError: name 'sage_local_lib' is not defined\n**********************************************************************\n```",
    "created_at": "2021-07-06T06:21:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515746",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:72" align="right">comment:72</div>

On OSX:

```
**********************************************************************
File "src/sage/misc/compat.py", line 97, in sage.misc.compat
Failed example:
    find_library('Singular')
Exception raised:
    Traceback (most recent call last):
      File "/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.9/site-packages/sage/doctest/forker.py", line 718, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.9/site-packages/sage/doctest/forker.py", line 1137, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.compat[1]>", line 1, in <module>
        find_library('Singular')
      File "/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.9/site-packages/sage/misc/compat.py", line 102, in find_library
        result = _find_library(name)
      File "/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.9/site-packages/sage/misc/compat.py", line 66, in _find_library
        os.environ['DYLD_LIBRARY_PATH'] = sage_local_lib
    NameError: name 'sage_local_lib' is not defined
**********************************************************************
```



---

archive/issue_events_438625.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-07-06T06:21:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438625"
}
```



---

archive/issue_events_438626.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-07-06T06:21:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438626"
}
```



---

archive/issue_comments_515747.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\nI see, we forgot to replace `sage_local_lib` which was defined as `os.path.join(SAGE_LOCAL, 'lib')` by expressions based on the new `libdir` in the darwin section. That was a bit careless of me not to notice.",
    "created_at": "2021-07-06T08:29:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515747",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:74" align="right">comment:74</div>

I see, we forgot to replace `sage_local_lib` which was defined as `os.path.join(SAGE_LOCAL, 'lib')` by expressions based on the new `libdir` in the darwin section. That was a bit careless of me not to notice.



---

archive/issue_comments_515748.json:
```json
{
    "body": "<div id=\"comment:75\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/985af6e8dccf44a02ba494b0e573aa0856b52cd3\"><code>985af6e</code></a></td><td><code>sage.misc.compat._find_library [darwin]: Fix up</code></td></tr></table>\n",
    "created_at": "2021-07-06T13:12:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515748",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:75"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/985af6e8dccf44a02ba494b0e573aa0856b52cd3"><code>985af6e</code></a></td><td><code>sage.misc.compat._find_library [darwin]: Fix up</code></td></tr></table>




---

archive/issue_comments_515749.json:
```json
{
    "body": "Changed commit from **[`d88c884`](https://github.com/sagemath/sagetrac-mirror/commit/d88c884b3222e420997cc491e98a36a7b9f876f5)** to **[`985af6e`](https://github.com/sagemath/sagetrac-mirror/commit/985af6e8dccf44a02ba494b0e573aa0856b52cd3)**",
    "created_at": "2021-07-06T13:12:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515749",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d88c884`](https://github.com/sagemath/sagetrac-mirror/commit/d88c884b3222e420997cc491e98a36a7b9f876f5)** to **[`985af6e`](https://github.com/sagemath/sagetrac-mirror/commit/985af6e8dccf44a02ba494b0e573aa0856b52cd3)**



---

archive/issue_events_438627.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-06T13:14:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438627"
}
```



---

archive/issue_events_438628.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-06T13:14:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438628"
}
```



---

archive/issue_comments_515750.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nYes, looks like I fell asleep in the middle of rewriting this function.",
    "created_at": "2021-07-06T13:14:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515750",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:76" align="right">comment:76</div>

Yes, looks like I fell asleep in the middle of rewriting this function.



---

archive/issue_comments_515751.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nReplying to [@mkoeppe](#comment%3A76):\n> Yes, looks like I fell asleep in the middle of rewriting this function.\n\nThe new code should do the trick. I must say that when we were working on this originally, it felt like you were in my time zone. So, I guess falling asleep would have been fair.",
    "created_at": "2021-07-06T21:08:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515751",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:77" align="right">comment:77</div>

Replying to [@mkoeppe](#comment%3A76):
> Yes, looks like I fell asleep in the middle of rewriting this function.

The new code should do the trick. I must say that when we were working on this originally, it felt like you were in my time zone. So, I guess falling asleep would have been fair.



---

archive/issue_comments_515752.json:
```json
{
    "body": "Changed reviewer from **Dima Pasechnik** to **Dima Pasechnik, Fran\u00e7ois Bissey**",
    "created_at": "2021-07-06T21:08:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515752",
    "user": "https://github.com/kiwifb"
}
```

Changed reviewer from **Dima Pasechnik** to **Dima Pasechnik, François Bissey**



---

archive/issue_events_438629.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2021-07-06T21:08:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438629"
}
```



---

archive/issue_events_438630.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2021-07-06T21:08:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438630"
}
```



---

archive/issue_comments_515753.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nThanks!",
    "created_at": "2021-07-06T21:29:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515753",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:78" align="right">comment:78</div>

Thanks!



---

archive/issue_comments_515754.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">comment:79</div>\n\nI must say, this is not as useful without setting `SAGE_LOCAL` to `None` in distro like Gentoo. I just found out I cannot stop patching `misc/cython.py` to replace `lib` by `lib64` because it otherwise leaks \n\n```\n    /usr/lib/gcc/x86_64-pc-linux-gnu/10.3.0/../../../../x86_64-pc-linux-gnu/bin/ld: skipping incompatible /usr/lib/libm.so when searching for -lm\n    /usr/lib/gcc/x86_64-pc-linux-gnu/10.3.0/../../../../x86_64-pc-linux-gnu/bin/ld: skipping incompatible /usr/lib/libm.a when searching for -lm\n    /usr/lib/gcc/x86_64-pc-linux-gnu/10.3.0/../../../../x86_64-pc-linux-gnu/bin/ld: skipping incompatible /usr/lib/libpthread.so when searching for -lpthread\n    /usr/lib/gcc/x86_64-pc-linux-gnu/10.3.0/../../../../x86_64-pc-linux-gnu/bin/ld: skipping incompatible /usr/lib/libpthread.a when searching for -lpthread\n    /usr/lib/gcc/x86_64-pc-linux-gnu/10.3.0/../../../../x86_64-pc-linux-gnu/bin/ld: skipping incompatible /usr/lib/libc.so when searching for -lc\n    /usr/lib/gcc/x86_64-pc-linux-gnu/10.3.0/../../../../x86_64-pc-linux-gnu/bin/ld: skipping incompatible /usr/lib/libc.a when searching for -lc\n```\nin a good number of doctests. This wouldn't happen with `SAGE_LOCAL` being `None` when tested in `cython.py`.\n\nAs an aside, I tried to fix it by adding a line `SAGE_LOCAL = None` in `sage_conf`, which seemed to be the obvious fix. But it didn't work, it still reports `SAGE_LOCAL` as `/usr`. What am I doing wrong?",
    "created_at": "2021-07-08T02:42:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515754",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:79" align="right">comment:79</div>

I must say, this is not as useful without setting `SAGE_LOCAL` to `None` in distro like Gentoo. I just found out I cannot stop patching `misc/cython.py` to replace `lib` by `lib64` because it otherwise leaks 

```
    /usr/lib/gcc/x86_64-pc-linux-gnu/10.3.0/../../../../x86_64-pc-linux-gnu/bin/ld: skipping incompatible /usr/lib/libm.so when searching for -lm
    /usr/lib/gcc/x86_64-pc-linux-gnu/10.3.0/../../../../x86_64-pc-linux-gnu/bin/ld: skipping incompatible /usr/lib/libm.a when searching for -lm
    /usr/lib/gcc/x86_64-pc-linux-gnu/10.3.0/../../../../x86_64-pc-linux-gnu/bin/ld: skipping incompatible /usr/lib/libpthread.so when searching for -lpthread
    /usr/lib/gcc/x86_64-pc-linux-gnu/10.3.0/../../../../x86_64-pc-linux-gnu/bin/ld: skipping incompatible /usr/lib/libpthread.a when searching for -lpthread
    /usr/lib/gcc/x86_64-pc-linux-gnu/10.3.0/../../../../x86_64-pc-linux-gnu/bin/ld: skipping incompatible /usr/lib/libc.so when searching for -lc
    /usr/lib/gcc/x86_64-pc-linux-gnu/10.3.0/../../../../x86_64-pc-linux-gnu/bin/ld: skipping incompatible /usr/lib/libc.a when searching for -lc
```
in a good number of doctests. This wouldn't happen with `SAGE_LOCAL` being `None` when tested in `cython.py`.

As an aside, I tried to fix it by adding a line `SAGE_LOCAL = None` in `sage_conf`, which seemed to be the obvious fix. But it didn't work, it still reports `SAGE_LOCAL` as `/usr`. What am I doing wrong?



---

archive/issue_comments_515755.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\nDidn't we take care of this in #32057?",
    "created_at": "2021-07-08T02:50:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515755",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:80" align="right">comment:80</div>

Didn't we take care of this in #32057?



---

archive/issue_comments_515756.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\nReplying to [@mkoeppe](#comment%3A80):\n> Didn't we take care of this in #32057?\n\n#32057 helps with build time but not runtime - as it should, `sage_setup` is for building stuff. I get those as soon as cython.py is called to compile something at runtime. I have had the little patch for it for awhile. But https://github.com/sagemath/sagetrac-mirror/commit/cd4ccd3adf78e216fbb62bd340238e9c0f25e998 along with https://github.com/sagemath/sagetrac-mirror/commit/95deabddc3d3c32d8f0362cfcf9e08f2e3b28205 made the patch irrelevant. Unfortunately, we reversed the last one for Antonio who still relies on `SAGE_LOCAL` being set.",
    "created_at": "2021-07-08T03:56:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515756",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:81" align="right">comment:81</div>

Replying to [@mkoeppe](#comment%3A80):
> Didn't we take care of this in #32057?

#32057 helps with build time but not runtime - as it should, `sage_setup` is for building stuff. I get those as soon as cython.py is called to compile something at runtime. I have had the little patch for it for awhile. But https://github.com/sagemath/sagetrac-mirror/commit/cd4ccd3adf78e216fbb62bd340238e9c0f25e998 along with https://github.com/sagemath/sagetrac-mirror/commit/95deabddc3d3c32d8f0362cfcf9e08f2e3b28205 made the patch irrelevant. Unfortunately, we reversed the last one for Antonio who still relies on `SAGE_LOCAL` being set.



---

archive/issue_comments_515757.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">comment:82</div>\n\nRight, thanks. So, as discussed in [#31338 comment:18](https://github.com/sagemath/sage/issues/31338#comment:18), we're back to having to solve the same problem as #31578.",
    "created_at": "2021-07-08T04:09:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515757",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:82" align="right">comment:82</div>

Right, thanks. So, as discussed in [#31338 comment:18](https://github.com/sagemath/sage/issues/31338#comment:18), we're back to having to solve the same problem as #31578.



---

archive/issue_comments_515758.json:
```json
{
    "body": "<div id=\"comment:83\" align=\"right\">comment:83</div>\n\nThat complaint of mine was about build time. We had the runtime issue forever, it is just the opportunity to squash it is gone again :(\n\nBut what I want to know and I'll dig is why setting `SAGE_LOCAL` to `None` is `sage_conf` doesn't work. That would be the ideal fix, while keeping it the way it is for Antonio.",
    "created_at": "2021-07-08T04:13:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515758",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:83" align="right">comment:83</div>

That complaint of mine was about build time. We had the runtime issue forever, it is just the opportunity to squash it is gone again :(

But what I want to know and I'll dig is why setting `SAGE_LOCAL` to `None` is `sage_conf` doesn't work. That would be the ideal fix, while keeping it the way it is for Antonio.



---

archive/issue_comments_515759.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">comment:84</div>\n\nI think I will just adopt the commit you removed for Antonio. `sage_conf` is not really designed to set a variable to `None`, that cannot work and it is even probably undesirable.",
    "created_at": "2021-07-08T23:15:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515759",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:84" align="right">comment:84</div>

I think I will just adopt the commit you removed for Antonio. `sage_conf` is not really designed to set a variable to `None`, that cannot work and it is even probably undesirable.



---

archive/issue_comments_515760.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">comment:85</div>\n\nReplying to [@kiwifb](#comment%3A84):\n> I think I will just adopt the commit you removed for Antonio. `sage_conf` is not really designed to set a variable to `None`, that cannot work and it is even probably undesirable.\n\nInterestingly, adopting it broke docbuilding. So, there is probably more work to do on that subject in a follow up ticket.",
    "created_at": "2021-07-09T01:24:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515760",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:85" align="right">comment:85</div>

Replying to [@kiwifb](#comment%3A84):
> I think I will just adopt the commit you removed for Antonio. `sage_conf` is not really designed to set a variable to `None`, that cannot work and it is even probably undesirable.

Interestingly, adopting it broke docbuilding. So, there is probably more work to do on that subject in a follow up ticket.



---

archive/issue_events_438631.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-07-09T20:23:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438631"
}
```



---

archive/issue_events_438632.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "f2fbcac6dc4a67377945d084ba93de25f2013f15",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-07-09T20:23:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32036#event-438632"
}
```



---

archive/issue_comments_515761.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/sage_local_extinction_path](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_local_extinction_path)** to **[`985af6e`](https://github.com/sagemath/sagetrac-mirror/commit/985af6e8dccf44a02ba494b0e573aa0856b52cd3)**",
    "created_at": "2021-07-09T20:23:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32036",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32036#issuecomment-515761",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/sage_local_extinction_path](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/sage_local_extinction_path)** to **[`985af6e`](https://github.com/sagemath/sagetrac-mirror/commit/985af6e8dccf44a02ba494b0e573aa0856b52cd3)**
