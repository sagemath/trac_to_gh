# Issue 32582: Add colored Jones polynomial

archive/issues_032345.json:
```json
{
    "assignees": [],
    "body": "This a proposal to add a new method in braid.py to allow the calculation of the colored Jones polynomial. Following https://arxiv.org/abs/1804.07910\n\nDepends on #32629\n\n**CC:**  @miguelmarco @NathanDunfield\n\n**Keywords:** knots, braids\n\n**Branch:** [d2722d0b1128b578fc6e88d144f8a8af21cc9805](https://github.com/sagemath/sagetrac-mirror/commit/d2722d0b1128b578fc6e88d144f8a8af21cc9805)\n\n**Reviewer:** Travis Scrimshaw\n\n**Author:** Moritz Firsching\n\nIssue created by migration from https://trac.sagemath.org/ticket/32582\n\n",
    "closed_at": "2021-10-24T18:38:58Z",
    "created_at": "2021-09-28T19:38:04Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20group%20theory",
        "https://github.com/sagemath/sage/labels/minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Add colored Jones polynomial",
    "type": "issue",
    "updated_at": "2021-11-06T02:10:27Z",
    "url": "https://github.com/sagemath/sage/issues/32582",
    "user": "https://github.com/mo271"
}
```
This a proposal to add a new method in braid.py to allow the calculation of the colored Jones polynomial. Following https://arxiv.org/abs/1804.07910

Depends on #32629

**CC:**  @miguelmarco @NathanDunfield

**Keywords:** knots, braids

**Branch:** [d2722d0b1128b578fc6e88d144f8a8af21cc9805](https://github.com/sagemath/sagetrac-mirror/commit/d2722d0b1128b578fc6e88d144f8a8af21cc9805)

**Reviewer:** Travis Scrimshaw

**Author:** Moritz Firsching

Issue created by migration from https://trac.sagemath.org/ticket/32582





---

archive/issue_events_395402.json:
```json
{
    "actor": "https://github.com/mo271",
    "created_at": "2021-09-28T19:38:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395402"
}
```



---

archive/issue_events_395403.json:
```json
{
    "actor": "https://github.com/mo271",
    "created_at": "2021-09-28T19:38:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20group%20theory",
    "label_color": "08517b",
    "label_name": "component: group theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395403"
}
```



---

archive/issue_events_395404.json:
```json
{
    "actor": "https://github.com/mo271",
    "created_at": "2021-09-28T19:38:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/minor",
    "label_color": "ff0000",
    "label_name": "minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395404"
}
```



---

archive/issue_events_395405.json:
```json
{
    "actor": "https://github.com/mo271",
    "created_at": "2021-09-28T19:38:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395405"
}
```



---

archive/issue_events_395406.json:
```json
{
    "actor": "https://github.com/mo271",
    "created_at": "2021-09-28T19:41:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395406"
}
```



---

archive/issue_comments_528103.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5e2390dfdf47cb96d0d3d2c52753acf06454a04c\">5e2390d</a></td><td><code>remove walrus</code></td></tr></table>\n",
    "created_at": "2021-09-29T06:36:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528103",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5e2390dfdf47cb96d0d3d2c52753acf06454a04c">5e2390d</a></td><td><code>remove walrus</code></td></tr></table>




---

archive/issue_comments_528104.json:
```json
{
    "body": "**Changing commit** from \"[58efda8513bb3bd668bd4ffe31fb39e01c4ddf6b](https://github.com/sagemath/sagetrac-mirror/commit/58efda8513bb3bd668bd4ffe31fb39e01c4ddf6b)\" to \"[5e2390dfdf47cb96d0d3d2c52753acf06454a04c](https://github.com/sagemath/sagetrac-mirror/commit/5e2390dfdf47cb96d0d3d2c52753acf06454a04c)\".",
    "created_at": "2021-09-29T06:36:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528104",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[58efda8513bb3bd668bd4ffe31fb39e01c4ddf6b](https://github.com/sagemath/sagetrac-mirror/commit/58efda8513bb3bd668bd4ffe31fb39e01c4ddf6b)" to "[5e2390dfdf47cb96d0d3d2c52753acf06454a04c](https://github.com/sagemath/sagetrac-mirror/commit/5e2390dfdf47cb96d0d3d2c52753acf06454a04c)".



---

archive/issue_comments_528105.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2be8cbb4da06aadf1f8c171dd800b0827f3daf8\">d2be8cb</a></td><td><code>use q_inv instead of q for clarity</code></td></tr></table>\n",
    "created_at": "2021-09-29T13:51:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528105",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2be8cbb4da06aadf1f8c171dd800b0827f3daf8">d2be8cb</a></td><td><code>use q_inv instead of q for clarity</code></td></tr></table>




---

archive/issue_comments_528106.json:
```json
{
    "body": "**Changing commit** from \"[5e2390dfdf47cb96d0d3d2c52753acf06454a04c](https://github.com/sagemath/sagetrac-mirror/commit/5e2390dfdf47cb96d0d3d2c52753acf06454a04c)\" to \"[d2be8cbb4da06aadf1f8c171dd800b0827f3daf8](https://github.com/sagemath/sagetrac-mirror/commit/d2be8cbb4da06aadf1f8c171dd800b0827f3daf8)\".",
    "created_at": "2021-09-29T13:51:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528106",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[5e2390dfdf47cb96d0d3d2c52753acf06454a04c](https://github.com/sagemath/sagetrac-mirror/commit/5e2390dfdf47cb96d0d3d2c52753acf06454a04c)" to "[d2be8cbb4da06aadf1f8c171dd800b0827f3daf8](https://github.com/sagemath/sagetrac-mirror/commit/d2be8cbb4da06aadf1f8c171dd800b0827f3daf8)".



---

archive/issue_comments_528107.json:
```json
{
    "body": "<a id='comment:4'></a>\nplease check indentation in the doc. doctests inside EXAMPLES:: must be indented",
    "created_at": "2021-09-29T15:13:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528107",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'></a>
please check indentation in the doc. doctests inside EXAMPLES:: must be indented



---

archive/issue_comments_528108.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/17a1a7cb35afbdbc818a85649930fdde592f8100\">17a1a7c</a></td><td><code>add indentation for EXAMPLES</code></td></tr></table>\n",
    "created_at": "2021-09-29T19:48:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528108",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:5'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/17a1a7cb35afbdbc818a85649930fdde592f8100">17a1a7c</a></td><td><code>add indentation for EXAMPLES</code></td></tr></table>




---

archive/issue_comments_528109.json:
```json
{
    "body": "**Changing commit** from \"[d2be8cbb4da06aadf1f8c171dd800b0827f3daf8](https://github.com/sagemath/sagetrac-mirror/commit/d2be8cbb4da06aadf1f8c171dd800b0827f3daf8)\" to \"[17a1a7cb35afbdbc818a85649930fdde592f8100](https://github.com/sagemath/sagetrac-mirror/commit/17a1a7cb35afbdbc818a85649930fdde592f8100)\".",
    "created_at": "2021-09-29T19:48:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528109",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[d2be8cbb4da06aadf1f8c171dd800b0827f3daf8](https://github.com/sagemath/sagetrac-mirror/commit/d2be8cbb4da06aadf1f8c171dd800b0827f3daf8)" to "[17a1a7cb35afbdbc818a85649930fdde592f8100](https://github.com/sagemath/sagetrac-mirror/commit/17a1a7cb35afbdbc818a85649930fdde592f8100)".



---

archive/issue_comments_528110.json:
```json
{
    "body": "<a id='comment:6'></a>\nThanks for pointing that out and taking a look, chapoton! I tried to fix it in all places..",
    "created_at": "2021-09-29T19:52:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528110",
    "user": "https://github.com/mo271"
}
```

<a id='comment:6'></a>
Thanks for pointing that out and taking a look, chapoton! I tried to fix it in all places..



---

archive/issue_comments_528111.json:
```json
{
    "body": "**Changing commit** from \"[17a1a7cb35afbdbc818a85649930fdde592f8100](https://github.com/sagemath/sagetrac-mirror/commit/17a1a7cb35afbdbc818a85649930fdde592f8100)\" to \"[2e538a836becee890c70bdeb3a6370ff4796077b](https://github.com/sagemath/sagetrac-mirror/commit/2e538a836becee890c70bdeb3a6370ff4796077b)\".",
    "created_at": "2021-09-29T19:54:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528111",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[17a1a7cb35afbdbc818a85649930fdde592f8100](https://github.com/sagemath/sagetrac-mirror/commit/17a1a7cb35afbdbc818a85649930fdde592f8100)" to "[2e538a836becee890c70bdeb3a6370ff4796077b](https://github.com/sagemath/sagetrac-mirror/commit/2e538a836becee890c70bdeb3a6370ff4796077b)".



---

archive/issue_comments_528112.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2e538a836becee890c70bdeb3a6370ff4796077b\">2e538a8</a></td><td><code>remove unused index</code></td></tr></table>\n",
    "created_at": "2021-09-29T19:54:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528112",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2e538a836becee890c70bdeb3a6370ff4796077b">2e538a8</a></td><td><code>remove unused index</code></td></tr></table>




---

archive/issue_comments_528113.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2021-10-03T08:29:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528113",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_528114.json:
```json
{
    "body": "<a id='comment:10'></a>\nThank you for this implementation. I have a few comments/questions.\n\nWhy should `_RightQuantumWord` be internal? It seems like it would be okay as a separate class (in the `braid.py` file).\n\nWhy is `_deformed_burau_matrix` hidden? It seems like it would be useful for other people using the braid group class.\n\nI think `_quantum_determinant` should not be in `braid.py`, much less as a method of the braid group elements. The question then becomes where is a good home for this function. I am thinking it is best as a method on matrices. You should also add in the definition to the docstring and make it unhidden.\n\nWhile it is unlikely, I don't think we should have the caching of `colored_jones_polynomial` depend on the variable and `try_inverse`. The cached version would have a fixed choice of variable, such as `q`. Probably the better thing to do here is to manually handle the cache with an attribute, e.g., `self._colored_jones_poly`. The other option is to have the cached part be a separate hidden method (and `@cached_method` can take a key function, where we can ignore the `try_inverse` input).\n\nI am not a big fan of the `for` loop in `_colored_jones_sum`. While there might be some code duplication, having it as a `while` loop makes it easier to understand the logic IMO (which can be seen as you won't need the comment).\n\nYou have numerous formatting errors with your documentation. Please see the [Sage dev guide: docstrings](https://doc.sagemath.org/html/en/developer/coding_basics.html#documentation-strings) and the other code in `braid.py`. Let me know if you have any questions.",
    "created_at": "2021-10-03T08:29:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528114",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>
Thank you for this implementation. I have a few comments/questions.

Why should `_RightQuantumWord` be internal? It seems like it would be okay as a separate class (in the `braid.py` file).

Why is `_deformed_burau_matrix` hidden? It seems like it would be useful for other people using the braid group class.

I think `_quantum_determinant` should not be in `braid.py`, much less as a method of the braid group elements. The question then becomes where is a good home for this function. I am thinking it is best as a method on matrices. You should also add in the definition to the docstring and make it unhidden.

While it is unlikely, I don't think we should have the caching of `colored_jones_polynomial` depend on the variable and `try_inverse`. The cached version would have a fixed choice of variable, such as `q`. Probably the better thing to do here is to manually handle the cache with an attribute, e.g., `self._colored_jones_poly`. The other option is to have the cached part be a separate hidden method (and `@cached_method` can take a key function, where we can ignore the `try_inverse` input).

I am not a big fan of the `for` loop in `_colored_jones_sum`. While there might be some code duplication, having it as a `while` loop makes it easier to understand the logic IMO (which can be seen as you won't need the comment).

You have numerous formatting errors with your documentation. Please see the [Sage dev guide: docstrings](https://doc.sagemath.org/html/en/developer/coding_basics.html#documentation-strings) and the other code in `braid.py`. Let me know if you have any questions.



---

archive/issue_events_395407.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-10-03T08:29:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395407"
}
```



---

archive/issue_events_395408.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-10-03T08:29:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395408"
}
```



---

archive/issue_comments_528115.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [@tscrim](#comment%3A10):\n> Thank you for this implementation. I have a few comments/questions.\n> \n\nThanks for taking a look and the comments!\n> Why should `_RightQuantumWord` be internal? It seems like it would be okay as a separate class (in the `braid.py` file).\n> \n> Why is `_deformed_burau_matrix` hidden? It seems like it would be useful for other people using the braid group class.\n\nBoth for `_RightQuantumWord` and the `_deformed_burau_matrix`, I couldn't image that they would be used in any other context than in calculating the colored Jones, but why not, let's expose those, there might be some other uses. \n> \n> I think `_quantum_determinant` should not be in `braid.py`, much less as a method of the braid group elements. The question then becomes where is a good home for this function. I am thinking it is best as a method on matrices. You should also add in the definition to the docstring and make it unhidden.\n\nLooking around where to put this, I found a `quantum_determinant` method of `QuantumMatrixCoordinate`.\n\n```\nsage: O = algebras.QuantumMatrixCoordinate(3)                                                                                                                                                                                                                                                                                                                                                                                           \nsage: O.quantum_determinant()                                                                                                                                                                                                                                                                                                                                                                                                           \nx[1,1]*x[2,2]*x[3,3] - q*x[1,1]*x[2,3]*x[3,2] - q*x[1,2]*x[2,1]*x[3,3] + q^2*x[1,2]*x[2,3]*x[3,1] + q^2*x[1,3]*x[2,1]*x[3,2] - q^3*x[1,3]*x[2,2]*x[3,1]\n```\n However this is in its current form not useful for our purposes, since it cannot be accessed without creating the an instance of `QuantumMatrixCoordinate` and this is slow. It is also broken if one changes `3` to `11`, #32623. Perhaps it would be best to have a `quantum_determinant` method somewhere where both our code in braid.py as well as `QuantumMatrixCoordinate` can access it. If you agree I would prepare a separate ticket to add `quantum_determinant`.\n\n> \n> While it is unlikely, I don't think we should have the caching of `colored_jones_polynomial` depend on the variable and `try_inverse`. The cached version would have a fixed choice of variable, such as `q`. Probably the better thing to do here is to manually handle the cache with an attribute, e.g., `self._colored_jones_poly`. The other option is to have the cached part be a separate hidden method (and `@cached_method` can take a key function, where we can ignore the `try_inverse` input).\n\nMake sense, I will cache it in an attribute. \n> \n> I am not a big fan of the `for` loop in `_colored_jones_sum`. While there might be some code duplication, having it as a `while` loop makes it easier to understand the logic IMO (which can be seen as you won't need the comment).\n\nSure, will change to a while loop. \n> \n> You have numerous formatting errors with your documentation. Please see the [Sage dev guide: docstrings](https://doc.sagemath.org/html/en/developer/coding_basics.html#documentation-strings) and the other code in `braid.py`. Let me know if you have any questions.\n\nI will take another look at those...",
    "created_at": "2021-10-04T15:13:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528115",
    "user": "https://github.com/mo271"
}
```

<a id='comment:11'></a>
Replying to [@tscrim](#comment%3A10):
> Thank you for this implementation. I have a few comments/questions.
> 

Thanks for taking a look and the comments!
> Why should `_RightQuantumWord` be internal? It seems like it would be okay as a separate class (in the `braid.py` file).
> 
> Why is `_deformed_burau_matrix` hidden? It seems like it would be useful for other people using the braid group class.

Both for `_RightQuantumWord` and the `_deformed_burau_matrix`, I couldn't image that they would be used in any other context than in calculating the colored Jones, but why not, let's expose those, there might be some other uses. 
> 
> I think `_quantum_determinant` should not be in `braid.py`, much less as a method of the braid group elements. The question then becomes where is a good home for this function. I am thinking it is best as a method on matrices. You should also add in the definition to the docstring and make it unhidden.

Looking around where to put this, I found a `quantum_determinant` method of `QuantumMatrixCoordinate`.

```
sage: O = algebras.QuantumMatrixCoordinate(3)                                                                                                                                                                                                                                                                                                                                                                                           
sage: O.quantum_determinant()                                                                                                                                                                                                                                                                                                                                                                                                           
x[1,1]*x[2,2]*x[3,3] - q*x[1,1]*x[2,3]*x[3,2] - q*x[1,2]*x[2,1]*x[3,3] + q^2*x[1,2]*x[2,3]*x[3,1] + q^2*x[1,3]*x[2,1]*x[3,2] - q^3*x[1,3]*x[2,2]*x[3,1]
```
 However this is in its current form not useful for our purposes, since it cannot be accessed without creating the an instance of `QuantumMatrixCoordinate` and this is slow. It is also broken if one changes `3` to `11`, #32623. Perhaps it would be best to have a `quantum_determinant` method somewhere where both our code in braid.py as well as `QuantumMatrixCoordinate` can access it. If you agree I would prepare a separate ticket to add `quantum_determinant`.

> 
> While it is unlikely, I don't think we should have the caching of `colored_jones_polynomial` depend on the variable and `try_inverse`. The cached version would have a fixed choice of variable, such as `q`. Probably the better thing to do here is to manually handle the cache with an attribute, e.g., `self._colored_jones_poly`. The other option is to have the cached part be a separate hidden method (and `@cached_method` can take a key function, where we can ignore the `try_inverse` input).

Make sense, I will cache it in an attribute. 
> 
> I am not a big fan of the `for` loop in `_colored_jones_sum`. While there might be some code duplication, having it as a `while` loop makes it easier to understand the logic IMO (which can be seen as you won't need the comment).

Sure, will change to a while loop. 
> 
> You have numerous formatting errors with your documentation. Please see the [Sage dev guide: docstrings](https://doc.sagemath.org/html/en/developer/coding_basics.html#documentation-strings) and the other code in `braid.py`. Let me know if you have any questions.

I will take another look at those...



---

archive/issue_comments_528116.json:
```json
{
    "body": "<a id='comment:12'></a>\nI have fixed #32623, along with a speedup for the qdet. From a little bit of testing, it seems like they are approximately the same speed as they are the same algorithm. I agree that this should not use the quantum matrix coordinate ring as that is meant for that class specifically. I wouldn't try to refactor that out into a single function. Instead, I would just move the implementation to `src/sage/matrix/matrix2.pyx` as it is most natural to be a function acting on a matrix.\n\nI would also add a default `q`:\n\n```python\ndef quantum_determinant(self, q=None):\n    if q is None:\n        from sage.rings.polynomial.polynomial_ring_constructor import PolynomialRing\n        q = PolynomialRing(self.base_ring(), 'q').gen()\n    [rest of code]\n```\nThis will make it easier to use for a general user.",
    "created_at": "2021-10-05T06:45:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528116",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>
I have fixed #32623, along with a speedup for the qdet. From a little bit of testing, it seems like they are approximately the same speed as they are the same algorithm. I agree that this should not use the quantum matrix coordinate ring as that is meant for that class specifically. I wouldn't try to refactor that out into a single function. Instead, I would just move the implementation to `src/sage/matrix/matrix2.pyx` as it is most natural to be a function acting on a matrix.

I would also add a default `q`:

```python
def quantum_determinant(self, q=None):
    if q is None:
        from sage.rings.polynomial.polynomial_ring_constructor import PolynomialRing
        q = PolynomialRing(self.base_ring(), 'q').gen()
    [rest of code]
```
This will make it easier to use for a general user.



---

archive/issue_comments_528117.json:
```json
{
    "body": "**Dependencies:** #32629",
    "created_at": "2021-10-05T09:26:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528117",
    "user": "https://github.com/mo271"
}
```

**Dependencies:** #32629



---

archive/issue_comments_528118.json:
```json
{
    "body": "**Changing commit** from \"[2e538a836becee890c70bdeb3a6370ff4796077b](https://github.com/sagemath/sagetrac-mirror/commit/2e538a836becee890c70bdeb3a6370ff4796077b)\" to \"[062a9e9a44aba558ac4461e55eab8461a6f1ade8](https://github.com/sagemath/sagetrac-mirror/commit/062a9e9a44aba558ac4461e55eab8461a6f1ade8)\".",
    "created_at": "2021-10-05T11:33:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528118",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[2e538a836becee890c70bdeb3a6370ff4796077b](https://github.com/sagemath/sagetrac-mirror/commit/2e538a836becee890c70bdeb3a6370ff4796077b)" to "[062a9e9a44aba558ac4461e55eab8461a6f1ade8](https://github.com/sagemath/sagetrac-mirror/commit/062a9e9a44aba558ac4461e55eab8461a6f1ade8)".



---

archive/issue_comments_528119.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9793567a731d895b9239bee77d76e66276531172\">9793567</a></td><td><code>adding quantum_determinant to matrix</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b8969296368a4a1ad944792780d3cba17f72817a\">b896929</a></td><td><code>Reviewer changes to quantum_determinant.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6e95c3a6166db357df7f2ed497bc812ccdf1337d\">6e95c3a</a></td><td><code>add colored Jones polynomial to braids</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/78919fb0441a1edc5c858e423776c6b506165d7e\">78919fb</a></td><td><code>remove walrus</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eb1aab96f349f29d91ddf1089f934b74c0eead9c\">eb1aab9</a></td><td><code>use q_inv instead of q for clarity</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/535fef191c93ca20570eaf1c04e930d00f13f887\">535fef1</a></td><td><code>add indentation for EXAMPLES</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f6152521fb80f1a4112e9877633a08323c9ef578\">f615252</a></td><td><code>remove unused index</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/062a9e9a44aba558ac4461e55eab8461a6f1ade8\">062a9e9</a></td><td><code>first round of review comments</code></td></tr></table>\n",
    "created_at": "2021-10-05T11:33:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528119",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9793567a731d895b9239bee77d76e66276531172">9793567</a></td><td><code>adding quantum_determinant to matrix</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b8969296368a4a1ad944792780d3cba17f72817a">b896929</a></td><td><code>Reviewer changes to quantum_determinant.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6e95c3a6166db357df7f2ed497bc812ccdf1337d">6e95c3a</a></td><td><code>add colored Jones polynomial to braids</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/78919fb0441a1edc5c858e423776c6b506165d7e">78919fb</a></td><td><code>remove walrus</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eb1aab96f349f29d91ddf1089f934b74c0eead9c">eb1aab9</a></td><td><code>use q_inv instead of q for clarity</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/535fef191c93ca20570eaf1c04e930d00f13f887">535fef1</a></td><td><code>add indentation for EXAMPLES</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f6152521fb80f1a4112e9877633a08323c9ef578">f615252</a></td><td><code>remove unused index</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/062a9e9a44aba558ac4461e55eab8461a6f1ade8">062a9e9</a></td><td><code>first round of review comments</code></td></tr></table>




---

archive/issue_events_395409.json:
```json
{
    "actor": "https://github.com/mo271",
    "created_at": "2021-10-05T11:42:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395409"
}
```



---

archive/issue_events_395410.json:
```json
{
    "actor": "https://github.com/mo271",
    "created_at": "2021-10-05T11:42:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395410"
}
```



---

archive/issue_comments_528120.json:
```json
{
    "body": "<a id='comment:15'></a>\nI aimed to address all review comments as outlined in the reply above. \nAfter looking into it, I'm now not using an attribute, but cache the function \n`_colored_jones_sum`, using always `q` as a variable first and then substituting if necessary. This seems to work as intended:\n\n```\nsage: b = BraidGroup(5)([1,2,4,2,-4,-2,3,-2,-1,2,3,1,2,4])\nsage: %time b.colored_jones_polynomial(2, try_inverse=False)\nCPU times: user 2.14 s, sys: 9.22 ms, total: 2.15 s\nWall time: 2.15 s\nq - q^2 + 2*q^3 - q^4 + q^5 - q^6\nsage: %time b.colored_jones_polynomial(2, try_inverse=False)\nCPU times: user 24.6 ms, sys: 33 \u00b5s, total: 24.6 ms\nWall time: 24.3 ms\nq - q^2 + 2*q^3 - q^4 + q^5 - q^6\nsage: %time b.colored_jones_polynomial(2, 'z', try_inverse=False)\nCPU times: user 27.2 ms, sys: 263 \u00b5s, total: 27.4 ms\nWall time: 26.9 ms\nz - z^2 + 2*z^3 - z^4 + z^5 - z^6\nsage: %time b.colored_jones_polynomial(2, 'z', try_inverse=True)\nCPU times: user 167 ms, sys: 101 ms, total: 268 ms\nWall time: 267 ms\nz - z^2 + 2*z^3 - z^4 + z^5 - z^6\n```\n\nWe now use the new `quantum_determinant`. \nNot sure why lint on github is still failing, I at least made sure that now pep8 errors appear in the code I added. Also, I hope I now got the formatting for the doc strings correct.",
    "created_at": "2021-10-05T11:42:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528120",
    "user": "https://github.com/mo271"
}
```

<a id='comment:15'></a>
I aimed to address all review comments as outlined in the reply above. 
After looking into it, I'm now not using an attribute, but cache the function 
`_colored_jones_sum`, using always `q` as a variable first and then substituting if necessary. This seems to work as intended:

```
sage: b = BraidGroup(5)([1,2,4,2,-4,-2,3,-2,-1,2,3,1,2,4])
sage: %time b.colored_jones_polynomial(2, try_inverse=False)
CPU times: user 2.14 s, sys: 9.22 ms, total: 2.15 s
Wall time: 2.15 s
q - q^2 + 2*q^3 - q^4 + q^5 - q^6
sage: %time b.colored_jones_polynomial(2, try_inverse=False)
CPU times: user 24.6 ms, sys: 33 µs, total: 24.6 ms
Wall time: 24.3 ms
q - q^2 + 2*q^3 - q^4 + q^5 - q^6
sage: %time b.colored_jones_polynomial(2, 'z', try_inverse=False)
CPU times: user 27.2 ms, sys: 263 µs, total: 27.4 ms
Wall time: 26.9 ms
z - z^2 + 2*z^3 - z^4 + z^5 - z^6
sage: %time b.colored_jones_polynomial(2, 'z', try_inverse=True)
CPU times: user 167 ms, sys: 101 ms, total: 268 ms
Wall time: 267 ms
z - z^2 + 2*z^3 - z^4 + z^5 - z^6
```

We now use the new `quantum_determinant`. 
Not sure why lint on github is still failing, I at least made sure that now pep8 errors appear in the code I added. Also, I hope I now got the formatting for the doc strings correct.



---

archive/issue_comments_528121.json:
```json
{
    "body": "**Changing commit** from \"[062a9e9a44aba558ac4461e55eab8461a6f1ade8](https://github.com/sagemath/sagetrac-mirror/commit/062a9e9a44aba558ac4461e55eab8461a6f1ade8)\" to \"[ff5b10107e6d54d91ddd07b6516961a543f5c2f6](https://github.com/sagemath/sagetrac-mirror/commit/ff5b10107e6d54d91ddd07b6516961a543f5c2f6)\".",
    "created_at": "2021-10-06T06:27:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528121",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[062a9e9a44aba558ac4461e55eab8461a6f1ade8](https://github.com/sagemath/sagetrac-mirror/commit/062a9e9a44aba558ac4461e55eab8461a6f1ade8)" to "[ff5b10107e6d54d91ddd07b6516961a543f5c2f6](https://github.com/sagemath/sagetrac-mirror/commit/ff5b10107e6d54d91ddd07b6516961a543f5c2f6)".



---

archive/issue_comments_528122.json:
```json
{
    "body": "<a id='comment:16'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ff5b10107e6d54d91ddd07b6516961a543f5c2f6\">ff5b101</a></td><td><code>fix doc</code></td></tr></table>\n",
    "created_at": "2021-10-06T06:27:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528122",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:16'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ff5b10107e6d54d91ddd07b6516961a543f5c2f6">ff5b101</a></td><td><code>fix doc</code></td></tr></table>




---

archive/issue_comments_528123.json:
```json
{
    "body": "**Changing commit** from \"[ff5b10107e6d54d91ddd07b6516961a543f5c2f6](https://github.com/sagemath/sagetrac-mirror/commit/ff5b10107e6d54d91ddd07b6516961a543f5c2f6)\" to \"[01caa0ea3c25ac4fd928b7b070e274cd61390bc9](https://github.com/sagemath/sagetrac-mirror/commit/01caa0ea3c25ac4fd928b7b070e274cd61390bc9)\".",
    "created_at": "2021-10-08T01:37:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528123",
    "user": "https://github.com/tscrim"
}
```

**Changing commit** from "[ff5b10107e6d54d91ddd07b6516961a543f5c2f6](https://github.com/sagemath/sagetrac-mirror/commit/ff5b10107e6d54d91ddd07b6516961a543f5c2f6)" to "[01caa0ea3c25ac4fd928b7b070e274cd61390bc9](https://github.com/sagemath/sagetrac-mirror/commit/01caa0ea3c25ac4fd928b7b070e274cd61390bc9)".



---

archive/issue_comments_528124.json:
```json
{
    "body": "<a id='comment:17'></a>\nThank you. It is looking very good. I made some additional changes; most are minor tweaks for PEP8 (and breaking the 80 char/line rule when I felt it made things more readable) and documentation. The two biggest changes is I made are (1) the caching is now associated to `colored_jones_polynomial` so the quantum determinant did not have to be computed multiple times; (2) made `RightQuantumWord.to_tuples()` into a lazy attribute.\n\nIf my changes are good, then you can set a positive review.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/01caa0ea3c25ac4fd928b7b070e274cd61390bc9\">01caa0e</a></td><td><code>Reviewer changes to colored Jones polynomial.</code></td></tr></table>\n",
    "created_at": "2021-10-08T01:37:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528124",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>
Thank you. It is looking very good. I made some additional changes; most are minor tweaks for PEP8 (and breaking the 80 char/line rule when I felt it made things more readable) and documentation. The two biggest changes is I made are (1) the caching is now associated to `colored_jones_polynomial` so the quantum determinant did not have to be computed multiple times; (2) made `RightQuantumWord.to_tuples()` into a lazy attribute.

If my changes are good, then you can set a positive review.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/01caa0ea3c25ac4fd928b7b070e274cd61390bc9">01caa0e</a></td><td><code>Reviewer changes to colored Jones polynomial.</code></td></tr></table>




---

archive/issue_comments_528125.json:
```json
{
    "body": "**Changing branch** from \"[u/moritz/colored_jones](https://github.com/sagemath/sagetrac-mirror/tree/u/moritz/colored_jones)\" to \"[public/knots/colored_jones-32582](https://github.com/sagemath/sagetrac-mirror/tree/public/knots/colored_jones-32582)\".",
    "created_at": "2021-10-08T01:37:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528125",
    "user": "https://github.com/tscrim"
}
```

**Changing branch** from "[u/moritz/colored_jones](https://github.com/sagemath/sagetrac-mirror/tree/u/moritz/colored_jones)" to "[public/knots/colored_jones-32582](https://github.com/sagemath/sagetrac-mirror/tree/public/knots/colored_jones-32582)".



---

archive/issue_comments_528126.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f7aee70501f65f481f503f51da91292cf50c7b52\">f7aee70</a></td><td><code>Adding colored Jones polynomial to knots.</code></td></tr></table>\n",
    "created_at": "2021-10-08T01:54:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528126",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f7aee70501f65f481f503f51da91292cf50c7b52">f7aee70</a></td><td><code>Adding colored Jones polynomial to knots.</code></td></tr></table>




---

archive/issue_comments_528127.json:
```json
{
    "body": "**Changing commit** from \"[01caa0ea3c25ac4fd928b7b070e274cd61390bc9](https://github.com/sagemath/sagetrac-mirror/commit/01caa0ea3c25ac4fd928b7b070e274cd61390bc9)\" to \"[f7aee70501f65f481f503f51da91292cf50c7b52](https://github.com/sagemath/sagetrac-mirror/commit/f7aee70501f65f481f503f51da91292cf50c7b52)\".",
    "created_at": "2021-10-08T01:54:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528127",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[01caa0ea3c25ac4fd928b7b070e274cd61390bc9](https://github.com/sagemath/sagetrac-mirror/commit/01caa0ea3c25ac4fd928b7b070e274cd61390bc9)" to "[f7aee70501f65f481f503f51da91292cf50c7b52](https://github.com/sagemath/sagetrac-mirror/commit/f7aee70501f65f481f503f51da91292cf50c7b52)".



---

archive/issue_comments_528128.json:
```json
{
    "body": "<a id='comment:19'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d8a2a094bd95e2e60daa9ed820a38383c517bf13\">d8a2a09</a></td><td><code>Speedup of RightQuantumWord.tuples computation.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d1d20f88145e9db856f158972da7b3a676095a24\">d1d20f8</a></td><td><code>Further speedup to colored_jones_polynomial().</code></td></tr></table>\n",
    "created_at": "2021-10-08T02:34:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528128",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:19'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d8a2a094bd95e2e60daa9ed820a38383c517bf13">d8a2a09</a></td><td><code>Speedup of RightQuantumWord.tuples computation.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d1d20f88145e9db856f158972da7b3a676095a24">d1d20f8</a></td><td><code>Further speedup to colored_jones_polynomial().</code></td></tr></table>




---

archive/issue_comments_528129.json:
```json
{
    "body": "**Changing commit** from \"[f7aee70501f65f481f503f51da91292cf50c7b52](https://github.com/sagemath/sagetrac-mirror/commit/f7aee70501f65f481f503f51da91292cf50c7b52)\" to \"[d1d20f88145e9db856f158972da7b3a676095a24](https://github.com/sagemath/sagetrac-mirror/commit/d1d20f88145e9db856f158972da7b3a676095a24)\".",
    "created_at": "2021-10-08T02:34:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528129",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[f7aee70501f65f481f503f51da91292cf50c7b52](https://github.com/sagemath/sagetrac-mirror/commit/f7aee70501f65f481f503f51da91292cf50c7b52)" to "[d1d20f88145e9db856f158972da7b3a676095a24](https://github.com/sagemath/sagetrac-mirror/commit/d1d20f88145e9db856f158972da7b3a676095a24)".



---

archive/issue_comments_528130.json:
```json
{
    "body": "<a id='comment:20'></a>\nI also was able to get an ~8x speedup by being more careful about where objects live and knowing a bit about the internal workings of `FreeAlgebra`:\n\n```\nsage: B = BraidGroup(4)\nsage: b = B([1,1,1,2,-1,2,-3,2,-3])\nsage: %time b.colored_jones_polynomial(2)\nCPU times: user 1.4 s, sys: 4 ms, total: 1.4 s\nWall time: 1.4 s\nq^-1 - 2 + 4*q - 5*q^2 + 6*q^3 - 5*q^4 + 4*q^5 - 3*q^6 + q^7\n```\nBefore this took about 12s. I don't see any other obvious way to speed this up further. With this new version, I can now do the `N=3` case for the above in a reasonable amount of time:\n\n```\nsage: %time b.colored_jones_polynomial(3)\nCPU times: user 34.6 s, sys: 104 ms, total: 34.7 s\nWall time: 34.7 s\nq^-4 - 2*q^-3 + 6*q^-1 - 8 - 2*q + 18*q^2 - 17*q^3 - 8*q^4 + 32*q^5 - 22*q^6\n - 15*q^7 + 39*q^8 - 21*q^9 - 18*q^10 + 34*q^11 - 14*q^12 - 16*q^13 + 22*q^14\n - 5*q^15 - 10*q^16 + 9*q^17 - 3*q^19 + q^20\n```",
    "created_at": "2021-10-08T02:37:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528130",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:20'></a>
I also was able to get an ~8x speedup by being more careful about where objects live and knowing a bit about the internal workings of `FreeAlgebra`:

```
sage: B = BraidGroup(4)
sage: b = B([1,1,1,2,-1,2,-3,2,-3])
sage: %time b.colored_jones_polynomial(2)
CPU times: user 1.4 s, sys: 4 ms, total: 1.4 s
Wall time: 1.4 s
q^-1 - 2 + 4*q - 5*q^2 + 6*q^3 - 5*q^4 + 4*q^5 - 3*q^6 + q^7
```
Before this took about 12s. I don't see any other obvious way to speed this up further. With this new version, I can now do the `N=3` case for the above in a reasonable amount of time:

```
sage: %time b.colored_jones_polynomial(3)
CPU times: user 34.6 s, sys: 104 ms, total: 34.7 s
Wall time: 34.7 s
q^-4 - 2*q^-3 + 6*q^-1 - 8 - 2*q + 18*q^2 - 17*q^3 - 8*q^4 + 32*q^5 - 22*q^6
 - 15*q^7 + 39*q^8 - 21*q^9 - 18*q^10 + 34*q^11 - 14*q^12 - 16*q^13 + 22*q^14
 - 5*q^15 - 10*q^16 + 9*q^17 - 3*q^19 + q^20
```



---

archive/issue_comments_528131.json:
```json
{
    "body": "<a id='comment:21'></a>\nNow I am done (I also made this accessible directly from a knot). Please review my changes.",
    "created_at": "2021-10-08T02:38:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528131",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:21'></a>
Now I am done (I also made this accessible directly from a knot). Please review my changes.



---

archive/issue_events_395411.json:
```json
{
    "actor": "https://github.com/mo271",
    "created_at": "2021-10-08T06:42:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395411"
}
```



---

archive/issue_events_395412.json:
```json
{
    "actor": "https://github.com/mo271",
    "created_at": "2021-10-08T06:42:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395412"
}
```



---

archive/issue_comments_528132.json:
```json
{
    "body": "<a id='comment:22'></a>\nWow, nice speedup! All the changes look good to me.",
    "created_at": "2021-10-08T06:42:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528132",
    "user": "https://github.com/mo271"
}
```

<a id='comment:22'></a>
Wow, nice speedup! All the changes look good to me.



---

archive/issue_events_395413.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-20T23:03:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395413"
}
```



---

archive/issue_events_395414.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-20T23:03:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395414"
}
```



---

archive/issue_comments_528133.json:
```json
{
    "body": "<a id='comment:23'></a>\nMerge conflict",
    "created_at": "2021-10-20T23:03:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528133",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:23'></a>
Merge conflict



---

archive/issue_comments_528134.json:
```json
{
    "body": "**Changing branch** from \"[public/knots/colored_jones-32582](https://github.com/sagemath/sagetrac-mirror/tree/public/knots/colored_jones-32582)\" to \"[u/moritz/colored_jones](https://github.com/sagemath/sagetrac-mirror/tree/u/moritz/colored_jones)\".",
    "created_at": "2021-10-21T14:30:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528134",
    "user": "https://github.com/mo271"
}
```

**Changing branch** from "[public/knots/colored_jones-32582](https://github.com/sagemath/sagetrac-mirror/tree/public/knots/colored_jones-32582)" to "[u/moritz/colored_jones](https://github.com/sagemath/sagetrac-mirror/tree/u/moritz/colored_jones)".



---

archive/issue_comments_528135.json:
```json
{
    "body": "<a id='comment:24'></a>\n**Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c5ca5d014c2925aa2a6a6fb82537b9ea8004839f\">c5ca5d0</a></td><td><code>use q_inv instead of q for clarity</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/596a69c388ae4f0ecd4b909f66b62a0d3bbb226d\">596a69c</a></td><td><code>add indentation for EXAMPLES</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1bef72ef12ae7274acaf37e0f620714794c0d904\">1bef72e</a></td><td><code>remove unused index</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f7ee6ab63fdab8acecf2fdc4d0f7f61d4a41267\">0f7ee6a</a></td><td><code>first round of review comments</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b8bf2136733c343e6cc8e4cbd85ea2bc66560c8b\">b8bf213</a></td><td><code>fix doc</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/59ca81613750d450099912ebe62d9478625e877a\">59ca816</a></td><td><code>Reviewer changes to colored Jones polynomial.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c4a84c2fda4c9fe58ef9301b7f993cbb1cdc3ac3\">c4a84c2</a></td><td><code>Adding colored Jones polynomial to knots.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/04d9e3a18449c6bd0a9d06c41de80d67cb5a01bc\">04d9e3a</a></td><td><code>Speedup of RightQuantumWord.tuples computation.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b684eefeb4967bd633709da42bac84bdb9999954\">b684eef</a></td><td><code>Further speedup to colored_jones_polynomial().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8133b595716ede011fee480e395b1831c4428d98\">8133b59</a></td><td><code>fix q_inv typo</code></td></tr></table>\n",
    "created_at": "2021-10-21T14:30:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528135",
    "user": "https://github.com/mo271"
}
```

<a id='comment:24'></a>
**Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c5ca5d014c2925aa2a6a6fb82537b9ea8004839f">c5ca5d0</a></td><td><code>use q_inv instead of q for clarity</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/596a69c388ae4f0ecd4b909f66b62a0d3bbb226d">596a69c</a></td><td><code>add indentation for EXAMPLES</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1bef72ef12ae7274acaf37e0f620714794c0d904">1bef72e</a></td><td><code>remove unused index</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f7ee6ab63fdab8acecf2fdc4d0f7f61d4a41267">0f7ee6a</a></td><td><code>first round of review comments</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b8bf2136733c343e6cc8e4cbd85ea2bc66560c8b">b8bf213</a></td><td><code>fix doc</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/59ca81613750d450099912ebe62d9478625e877a">59ca816</a></td><td><code>Reviewer changes to colored Jones polynomial.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c4a84c2fda4c9fe58ef9301b7f993cbb1cdc3ac3">c4a84c2</a></td><td><code>Adding colored Jones polynomial to knots.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/04d9e3a18449c6bd0a9d06c41de80d67cb5a01bc">04d9e3a</a></td><td><code>Speedup of RightQuantumWord.tuples computation.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b684eefeb4967bd633709da42bac84bdb9999954">b684eef</a></td><td><code>Further speedup to colored_jones_polynomial().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8133b595716ede011fee480e395b1831c4428d98">8133b59</a></td><td><code>fix q_inv typo</code></td></tr></table>




---

archive/issue_comments_528136.json:
```json
{
    "body": "**Changing commit** from \"[d1d20f88145e9db856f158972da7b3a676095a24](https://github.com/sagemath/sagetrac-mirror/commit/d1d20f88145e9db856f158972da7b3a676095a24)\" to \"[8133b595716ede011fee480e395b1831c4428d98](https://github.com/sagemath/sagetrac-mirror/commit/8133b595716ede011fee480e395b1831c4428d98)\".",
    "created_at": "2021-10-21T14:30:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528136",
    "user": "https://github.com/mo271"
}
```

**Changing commit** from "[d1d20f88145e9db856f158972da7b3a676095a24](https://github.com/sagemath/sagetrac-mirror/commit/d1d20f88145e9db856f158972da7b3a676095a24)" to "[8133b595716ede011fee480e395b1831c4428d98](https://github.com/sagemath/sagetrac-mirror/commit/8133b595716ede011fee480e395b1831c4428d98)".



---

archive/issue_events_395415.json:
```json
{
    "actor": "https://github.com/mo271",
    "created_at": "2021-10-21T14:30:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395415"
}
```



---

archive/issue_events_395416.json:
```json
{
    "actor": "https://github.com/mo271",
    "created_at": "2021-10-21T14:30:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395416"
}
```



---

archive/issue_comments_528137.json:
```json
{
    "body": "<a id='comment:25'></a>\nrebased and fixed all conficts (hopefully)",
    "created_at": "2021-10-21T14:30:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528137",
    "user": "https://github.com/mo271"
}
```

<a id='comment:25'></a>
rebased and fixed all conficts (hopefully)



---

archive/issue_comments_528138.json:
```json
{
    "body": "<a id='comment:26'></a>\nbotched rebase, working on fixing it...",
    "created_at": "2021-10-21T14:58:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528138",
    "user": "https://github.com/mo271"
}
```

<a id='comment:26'></a>
botched rebase, working on fixing it...



---

archive/issue_events_395417.json:
```json
{
    "actor": "https://github.com/mo271",
    "created_at": "2021-10-21T14:58:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395417"
}
```



---

archive/issue_events_395418.json:
```json
{
    "actor": "https://github.com/mo271",
    "created_at": "2021-10-21T14:58:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395418"
}
```



---

archive/issue_comments_528139.json:
```json
{
    "body": "**Changing commit** from \"[8133b595716ede011fee480e395b1831c4428d98](https://github.com/sagemath/sagetrac-mirror/commit/8133b595716ede011fee480e395b1831c4428d98)\" to \"[4567a06aca6282db568540e02111f60b51a28655](https://github.com/sagemath/sagetrac-mirror/commit/4567a06aca6282db568540e02111f60b51a28655)\".",
    "created_at": "2021-10-21T15:13:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528139",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[8133b595716ede011fee480e395b1831c4428d98](https://github.com/sagemath/sagetrac-mirror/commit/8133b595716ede011fee480e395b1831c4428d98)" to "[4567a06aca6282db568540e02111f60b51a28655](https://github.com/sagemath/sagetrac-mirror/commit/4567a06aca6282db568540e02111f60b51a28655)".



---

archive/issue_comments_528140.json:
```json
{
    "body": "<a id='comment:27'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4567a06aca6282db568540e02111f60b51a28655\">4567a06</a></td><td><code>fix botched rebase</code></td></tr></table>\n",
    "created_at": "2021-10-21T15:13:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528140",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:27'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4567a06aca6282db568540e02111f60b51a28655">4567a06</a></td><td><code>fix botched rebase</code></td></tr></table>




---

archive/issue_events_395419.json:
```json
{
    "actor": "https://github.com/mo271",
    "created_at": "2021-10-21T15:15:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395419"
}
```



---

archive/issue_events_395420.json:
```json
{
    "actor": "https://github.com/mo271",
    "created_at": "2021-10-21T15:15:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395420"
}
```



---

archive/issue_comments_528141.json:
```json
{
    "body": "<a id='comment:29'></a>\nIt still conflicts. Sometimes the beta release it conflicts with is not released yet when Volker says there is a merge conflict.",
    "created_at": "2021-10-21T23:11:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528141",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:29'></a>
It still conflicts. Sometimes the beta release it conflicts with is not released yet when Volker says there is a merge conflict.



---

archive/issue_events_395421.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-10-21T23:11:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395421"
}
```



---

archive/issue_events_395422.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-10-21T23:11:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395422"
}
```



---

archive/issue_comments_528142.json:
```json
{
    "body": "**Changing commit** from \"[4567a06aca6282db568540e02111f60b51a28655](https://github.com/sagemath/sagetrac-mirror/commit/4567a06aca6282db568540e02111f60b51a28655)\" to \"[d2722d0b1128b578fc6e88d144f8a8af21cc9805](https://github.com/sagemath/sagetrac-mirror/commit/d2722d0b1128b578fc6e88d144f8a8af21cc9805)\".",
    "created_at": "2021-10-22T06:43:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528142",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[4567a06aca6282db568540e02111f60b51a28655](https://github.com/sagemath/sagetrac-mirror/commit/4567a06aca6282db568540e02111f60b51a28655)" to "[d2722d0b1128b578fc6e88d144f8a8af21cc9805](https://github.com/sagemath/sagetrac-mirror/commit/d2722d0b1128b578fc6e88d144f8a8af21cc9805)".



---

archive/issue_comments_528143.json:
```json
{
    "body": "<a id='comment:30'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bf8a4ffd041881661a7fa0c506960c49ef97fc5d\">bf8a4ff</a></td><td><code>add indentation for EXAMPLES</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b0b1d8beef5aecc791f61f9987cf87509b7ae96e\">b0b1d8b</a></td><td><code>remove unused index</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c01f408e147ad07aa076b9f61b22b357eb89934f\">c01f408</a></td><td><code>first round of review comments</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eca48699f69049ab305d3c42ca4fd49f2cd49399\">eca4869</a></td><td><code>fix doc</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/022fcde5e2c483d08300fedef34165df0ff7de21\">022fcde</a></td><td><code>Reviewer changes to colored Jones polynomial.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bac98e5dfbd758c3f67111be6ee1a6843c40c704\">bac98e5</a></td><td><code>Adding colored Jones polynomial to knots.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/93cc25eefa6587c24d05d88f8dab86c83305efce\">93cc25e</a></td><td><code>Speedup of RightQuantumWord.tuples computation.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2121743b84b822c443a4e1d45081d39244191aa6\">2121743</a></td><td><code>Further speedup to colored_jones_polynomial().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/524906e03f6dec6be462b7210289c2bf2a5ffcf9\">524906e</a></td><td><code>fix q_inv typo</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2722d0b1128b578fc6e88d144f8a8af21cc9805\">d2722d0</a></td><td><code>fix botched rebase</code></td></tr></table>\n",
    "created_at": "2021-10-22T06:43:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528143",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:30'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bf8a4ffd041881661a7fa0c506960c49ef97fc5d">bf8a4ff</a></td><td><code>add indentation for EXAMPLES</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b0b1d8beef5aecc791f61f9987cf87509b7ae96e">b0b1d8b</a></td><td><code>remove unused index</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c01f408e147ad07aa076b9f61b22b357eb89934f">c01f408</a></td><td><code>first round of review comments</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eca48699f69049ab305d3c42ca4fd49f2cd49399">eca4869</a></td><td><code>fix doc</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/022fcde5e2c483d08300fedef34165df0ff7de21">022fcde</a></td><td><code>Reviewer changes to colored Jones polynomial.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bac98e5dfbd758c3f67111be6ee1a6843c40c704">bac98e5</a></td><td><code>Adding colored Jones polynomial to knots.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/93cc25eefa6587c24d05d88f8dab86c83305efce">93cc25e</a></td><td><code>Speedup of RightQuantumWord.tuples computation.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2121743b84b822c443a4e1d45081d39244191aa6">2121743</a></td><td><code>Further speedup to colored_jones_polynomial().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/524906e03f6dec6be462b7210289c2bf2a5ffcf9">524906e</a></td><td><code>fix q_inv typo</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2722d0b1128b578fc6e88d144f8a8af21cc9805">d2722d0</a></td><td><code>fix botched rebase</code></td></tr></table>




---

archive/issue_comments_528144.json:
```json
{
    "body": "<a id='comment:31'></a>\nok, rebased on `9.5.beta4`, see if that helps...",
    "created_at": "2021-10-22T06:45:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528144",
    "user": "https://github.com/mo271"
}
```

<a id='comment:31'></a>
ok, rebased on `9.5.beta4`, see if that helps...



---

archive/issue_events_395423.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-10-22T07:17:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395423"
}
```



---

archive/issue_events_395424.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-10-22T07:17:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395424"
}
```



---

archive/issue_comments_528145.json:
```json
{
    "body": "<a id='comment:32'></a>\nThat should be good. Thank you.",
    "created_at": "2021-10-22T07:17:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528145",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:32'></a>
That should be good. Thank you.



---

archive/issue_events_395425.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-24T18:38:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395425"
}
```



---

archive/issue_events_395426.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a15c58c9d6e839fd3911db79a539d7460ddbb5c8",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-10-24T18:38:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32582#event-395426"
}
```



---

archive/issue_comments_528146.json:
```json
{
    "body": "**Changing branch** from \"[u/moritz/colored_jones](https://github.com/sagemath/sagetrac-mirror/tree/u/moritz/colored_jones)\" to \"[d2722d0b1128b578fc6e88d144f8a8af21cc9805](https://github.com/sagemath/sagetrac-mirror/commit/d2722d0b1128b578fc6e88d144f8a8af21cc9805)\".",
    "created_at": "2021-10-24T18:38:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528146",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/moritz/colored_jones](https://github.com/sagemath/sagetrac-mirror/tree/u/moritz/colored_jones)" to "[d2722d0b1128b578fc6e88d144f8a8af21cc9805](https://github.com/sagemath/sagetrac-mirror/commit/d2722d0b1128b578fc6e88d144f8a8af21cc9805)".



---

archive/issue_comments_528147.json:
```json
{
    "body": "<a id='comment:34'></a>\nIn the method `eps` of the class `RightQuantumWord`,\nthe auxiliary function `eps_monom`'s docstring should\ncome first:\n\n```diff\n         def eps_monom(q_tuple):\n-            q = self.q\n             r\"\"\"Evaluate the map $\\mathcal{E}_N$ for a single mononial.\"\"\"\n+            q = self.q\n```\n\nFor a follow-up ticket if you care enough.",
    "created_at": "2021-10-25T15:24:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528147",
    "user": "https://github.com/slel"
}
```

<a id='comment:34'></a>
In the method `eps` of the class `RightQuantumWord`,
the auxiliary function `eps_monom`'s docstring should
come first:

```diff
         def eps_monom(q_tuple):
-            q = self.q
             r"""Evaluate the map $\mathcal{E}_N$ for a single mononial."""
+            q = self.q
```

For a follow-up ticket if you care enough.



---

archive/issue_comments_528148.json:
```json
{
    "body": "**Changing commit** from \"[d2722d0b1128b578fc6e88d144f8a8af21cc9805](https://github.com/sagemath/sagetrac-mirror/commit/d2722d0b1128b578fc6e88d144f8a8af21cc9805)\" to \"\".",
    "created_at": "2021-10-25T15:24:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528148",
    "user": "https://github.com/slel"
}
```

**Changing commit** from "[d2722d0b1128b578fc6e88d144f8a8af21cc9805](https://github.com/sagemath/sagetrac-mirror/commit/d2722d0b1128b578fc6e88d144f8a8af21cc9805)" to "".



---

archive/issue_comments_528149.json:
```json
{
    "body": "<a id='comment:35'></a>\nI thought I had fixed that, but I missed it. Indeed, that should be fixed (it is likely causing a few lost CPU cycles with Python creating that string on each function call).",
    "created_at": "2021-10-26T05:51:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528149",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:35'></a>
I thought I had fixed that, but I missed it. Indeed, that should be fixed (it is likely causing a few lost CPU cycles with Python creating that string on each function call).



---

archive/issue_comments_528150.json:
```json
{
    "body": "<a id='comment:36'></a>\nReplying to [@tscrim](#comment%3A35):\n> I thought I had fixed that, but I missed it. Indeed, that should be fixed (it is likely causing a few lost CPU cycles with Python creating that string on each function call).\n\nFixed in #32829.",
    "created_at": "2021-11-06T02:10:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32582#issuecomment-528150",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:36'></a>
Replying to [@tscrim](#comment%3A35):
> I thought I had fixed that, but I missed it. Indeed, that should be fixed (it is likely causing a few lost CPU cycles with Python creating that string on each function call).

Fixed in #32829.
