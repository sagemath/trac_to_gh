# Issue 32016: Fix hurwitz_zeta(0, x) not expanding

archive/issues_031779.json:
```json
{
    "body": "Having defined:\n\n```\ndef B(n, x):\n    return -n*hurwitz_zeta(1 - n, x) if n != 0 else 1\n```\nwe expect `expand(B(n, x))` to\nmatch `bernoulli_polynomial(x, n)`.\n\nUsing this small utility function to compare them:\n\n```\ndef table(nmax):\n    nab = [('n', 'expand(B(n, x))', 'bernoulli_polynomial(x, n)')]\n    nab.extend([(n, expand(B(n, x)), bernoulli_polynomial(x, n))\n                for n in range(nmax + 1)])\n    k = len(str(nmax))\n    m = max(len(str(x)) for t in nab for x in t)\n    hline = '-' * (k + m + 7)\n    print(hline)\n    for n, a, b in nab:\n        print(f' %{k}s     %{m}s' % (n, a))\n        print(f' %{k}s     %{m}s' % ('', b))\n        print(hline)\n```\nwe notice they match except for n = 1:\n\n```\nsage: table(4)\n----------------------------------\n n                expand(B(n, x))\n       bernoulli_polynomial(x, n)\n----------------------------------\n 0                              1\n                                1\n----------------------------------\n 1            -hurwitz_zeta(0, x)\n                          x - 1/2\n----------------------------------\n 2                  x^2 - x + 1/6\n                    x^2 - x + 1/6\n----------------------------------\n 3          x^3 - 3/2*x^2 + 1/2*x\n            x^3 - 3/2*x^2 + 1/2*x\n----------------------------------\n 4       x^4 - 2*x^3 + x^2 - 1/30\n         x^4 - 2*x^3 + x^2 - 1/30\n----------------------------------\n```\nThis ticket fixes that case.\n\nCC:  @slel\n\nKeywords: hurwitz_zeta\n\nBranch/Commit: 785b4e27162892519d6bb1d5208551893e28a52e\n\nReviewer: Peter Luschny\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/32016\n\n",
    "closed_at": "2021-07-25T13:25:35Z",
    "created_at": "2021-06-21T06:36:40Z",
    "labels": [
        "component: symbolics",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Fix hurwitz_zeta(0, x) not expanding",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32016",
    "user": "https://github.com/PeterLuschny"
}
```
Having defined:

```
def B(n, x):
    return -n*hurwitz_zeta(1 - n, x) if n != 0 else 1
```
we expect `expand(B(n, x))` to
match `bernoulli_polynomial(x, n)`.

Using this small utility function to compare them:

```
def table(nmax):
    nab = [('n', 'expand(B(n, x))', 'bernoulli_polynomial(x, n)')]
    nab.extend([(n, expand(B(n, x)), bernoulli_polynomial(x, n))
                for n in range(nmax + 1)])
    k = len(str(nmax))
    m = max(len(str(x)) for t in nab for x in t)
    hline = '-' * (k + m + 7)
    print(hline)
    for n, a, b in nab:
        print(f' %{k}s     %{m}s' % (n, a))
        print(f' %{k}s     %{m}s' % ('', b))
        print(hline)
```
we notice they match except for n = 1:

```
sage: table(4)
----------------------------------
 n                expand(B(n, x))
       bernoulli_polynomial(x, n)
----------------------------------
 0                              1
                                1
----------------------------------
 1            -hurwitz_zeta(0, x)
                          x - 1/2
----------------------------------
 2                  x^2 - x + 1/6
                    x^2 - x + 1/6
----------------------------------
 3          x^3 - 3/2*x^2 + 1/2*x
            x^3 - 3/2*x^2 + 1/2*x
----------------------------------
 4       x^4 - 2*x^3 + x^2 - 1/30
         x^4 - 2*x^3 + x^2 - 1/30
----------------------------------
```
This ticket fixes that case.

CC:  @slel

Keywords: hurwitz_zeta

Branch/Commit: 785b4e27162892519d6bb1d5208551893e28a52e

Reviewer: Peter Luschny

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/32016





---

archive/issue_comments_484822.json:
```json
{
    "body": "<a id='comment:1'></a>fixed, please review\n\n---\nNew commits:",
    "created_at": "2021-06-21T13:29:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-484822",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>fixed, please review

---
New commits:



---

archive/issue_comments_484823.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-06-21T13:29:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-484823",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_484824.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-06-21T14:44:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-484824",
    "user": "https://github.com/PeterLuschny"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_484825.json:
```json
{
    "body": "<a id='comment:2'></a>Looks good to me. Merci!",
    "created_at": "2021-06-21T14:44:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-484825",
    "user": "https://github.com/PeterLuschny"
}
```

<a id='comment:2'></a>Looks good to me. Merci!



---

archive/issue_comments_484826.json:
```json
{
    "body": "<a id='comment:3'></a>reviewer full name please",
    "created_at": "2021-06-21T19:20:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-484826",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>reviewer full name please



---

archive/issue_comments_484827.json:
```json
{
    "body": "<a id='comment:4'></a>I don't know if I am qualified as a reviewer in the sense of the [SageMath](SageMath) organization.",
    "created_at": "2021-06-21T20:10:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-484827",
    "user": "https://github.com/PeterLuschny"
}
```

<a id='comment:4'></a>I don't know if I am qualified as a reviewer in the sense of the [SageMath](SageMath) organization.



---

archive/issue_comments_484828.json:
```json
{
    "body": "<a id='comment:5'></a>> I don't know if I am qualified as a reviewer\n> in the sense of the SageMath organization.\n\n\nYou are!",
    "created_at": "2021-06-27T22:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-484828",
    "user": "https://github.com/slel"
}
```

<a id='comment:5'></a>> I don't know if I am qualified as a reviewer
> in the sense of the SageMath organization.


You are!



---

archive/issue_comments_484829.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,17 +1,53 @@\n-See for example in:\n+Define:\n \n \\`\\`\\`\n-def B(n, x): return -n*hurwitz_zeta(1 - n, x) if n != 0 else 1\n-for n in (0..4):\n-    print(expand(B(n, x)), \" , \", bernoulli_polynomial(x, n))\n+def B(n, x):\n+    return -n*hurwitz_zeta(1 - n, x) if n != 0 else 1\n+\\`\\`\\`\n+and compare \\`expand(B(n, x))\\` to \\`bernoulli_polynomial(x, n)\\`.\n \n-    1  ,  1\n-    -hurwitz_zeta(0, x)  ,  x - 1/2\n-    x^2 - x + 1/6  ,  x^2 - x + 1/6\n-    x^3 - 3/2*x^2 + 1/2*x  ,  x^3 - 3/2*x^2 + 1/2*x\n-    x^4 - 2*x^3 + x^2 - 1/30  ,  x^4 - 2*x^3 + x^2 - 1/30\n-    }}}\n-This also shows the expected value.\n+Utility function to compare:\n+\n+\\`\\`\\`\n+def table(nmax):\n+    nab = [('n', 'expand(B(n, x))', 'bernoulli_polynomial(x, n)')]\n+    nab.extend([(n, expand(B(n, x)), bernoulli_polynomial(x, n))\n+                for n in range(nmax + 1)])\n+    k = len(str(nmax))\n+    m = max(len(str(x)) for t in nab for x in t)\n+    hline = '-' * (k + m + 7)\n+    print(hline)\n+    for n, a, b in nab:\n+        print(f' %{k}s     %{m}s' % (n, a))\n+        print(f' %{k}s     %{m}s' % ('', b))\n+        print(hline)\n+\\`\\`\\`\n+The comparison:\n+\n+\\`\\`\\`\n+sage: table(4)\n+----------------------------------\n+ n                expand(B(n, x))\n+       bernoulli_polynomial(x, n)\n+----------------------------------\n+ 0                              1\n+                                1\n+----------------------------------\n+ 1            -hurwitz_zeta(0, x)\n+                          x - 1/2\n+----------------------------------\n+ 2                  x^2 - x + 1/6\n+                    x^2 - x + 1/6\n+----------------------------------\n+ 3          x^3 - 3/2*x^2 + 1/2*x\n+            x^3 - 3/2*x^2 + 1/2*x\n+----------------------------------\n+ 4       x^4 - 2*x^3 + x^2 - 1/30\n+         x^4 - 2*x^3 + x^2 - 1/30\n+----------------------------------\n+\\`\\`\\`\n+\n+\n \n Comment: 1\n \n```\n",
    "created_at": "2021-06-27T22:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-484829",
    "user": "https://github.com/slel"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,17 +1,53 @@
-See for example in:
+Define:
 
 \`\`\`
-def B(n, x): return -n*hurwitz_zeta(1 - n, x) if n != 0 else 1
-for n in (0..4):
-    print(expand(B(n, x)), " , ", bernoulli_polynomial(x, n))
+def B(n, x):
+    return -n*hurwitz_zeta(1 - n, x) if n != 0 else 1
+\`\`\`
+and compare \`expand(B(n, x))\` to \`bernoulli_polynomial(x, n)\`.
 
-    1  ,  1
-    -hurwitz_zeta(0, x)  ,  x - 1/2
-    x^2 - x + 1/6  ,  x^2 - x + 1/6
-    x^3 - 3/2*x^2 + 1/2*x  ,  x^3 - 3/2*x^2 + 1/2*x
-    x^4 - 2*x^3 + x^2 - 1/30  ,  x^4 - 2*x^3 + x^2 - 1/30
-    }}}
-This also shows the expected value.
+Utility function to compare:
+
+\`\`\`
+def table(nmax):
+    nab = [('n', 'expand(B(n, x))', 'bernoulli_polynomial(x, n)')]
+    nab.extend([(n, expand(B(n, x)), bernoulli_polynomial(x, n))
+                for n in range(nmax + 1)])
+    k = len(str(nmax))
+    m = max(len(str(x)) for t in nab for x in t)
+    hline = '-' * (k + m + 7)
+    print(hline)
+    for n, a, b in nab:
+        print(f' %{k}s     %{m}s' % (n, a))
+        print(f' %{k}s     %{m}s' % ('', b))
+        print(hline)
+\`\`\`
+The comparison:
+
+\`\`\`
+sage: table(4)
+----------------------------------
+ n                expand(B(n, x))
+       bernoulli_polynomial(x, n)
+----------------------------------
+ 0                              1
+                                1
+----------------------------------
+ 1            -hurwitz_zeta(0, x)
+                          x - 1/2
+----------------------------------
+ 2                  x^2 - x + 1/6
+                    x^2 - x + 1/6
+----------------------------------
+ 3          x^3 - 3/2*x^2 + 1/2*x
+            x^3 - 3/2*x^2 + 1/2*x
+----------------------------------
+ 4       x^4 - 2*x^3 + x^2 - 1/30
+         x^4 - 2*x^3 + x^2 - 1/30
+----------------------------------
+\`\`\`
+
+
 
 Comment: 1
 
```




---

archive/issue_comments_484830.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2021-06-27T22:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-484830",
    "user": "https://github.com/slel"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_484831.json:
```json
{
    "body": "Changing keywords from \"\" to \"hurwitz_zeta\".",
    "created_at": "2021-06-27T22:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-484831",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "hurwitz_zeta".



---

archive/issue_comments_484832.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,53 @@\n+Having defined:\n \n+\\`\\`\\`\n+def B(n, x):\n+    return -n*hurwitz_zeta(1 - n, x) if n != 0 else 1\n+\\`\\`\\`\n+we expect \\`expand(B(n, x))\\` to\n+match \\`bernoulli_polynomial(x, n)\\`.\n+\n+Using this small utility function to compare them:\n+\n+\\`\\`\\`\n+def table(nmax):\n+    nab = [('n', 'expand(B(n, x))', 'bernoulli_polynomial(x, n)')]\n+    nab.extend([(n, expand(B(n, x)), bernoulli_polynomial(x, n))\n+                for n in range(nmax + 1)])\n+    k = len(str(nmax))\n+    m = max(len(str(x)) for t in nab for x in t)\n+    hline = '-' * (k + m + 7)\n+    print(hline)\n+    for n, a, b in nab:\n+        print(f' %{k}s     %{m}s' % (n, a))\n+        print(f' %{k}s     %{m}s' % ('', b))\n+        print(hline)\n+\\`\\`\\`\n+we notice they match except for n = 1:\n+\n+\\`\\`\\`\n+sage: table(4)\n+----------------------------------\n+ n                expand(B(n, x))\n+       bernoulli_polynomial(x, n)\n+----------------------------------\n+ 0                              1\n+                                1\n+----------------------------------\n+ 1            -hurwitz_zeta(0, x)\n+                          x - 1/2\n+----------------------------------\n+ 2                  x^2 - x + 1/6\n+                    x^2 - x + 1/6\n+----------------------------------\n+ 3          x^3 - 3/2*x^2 + 1/2*x\n+            x^3 - 3/2*x^2 + 1/2*x\n+----------------------------------\n+ 4       x^4 - 2*x^3 + x^2 - 1/30\n+         x^4 - 2*x^3 + x^2 - 1/30\n+----------------------------------\n+\\`\\`\\`\n+This ticket fixes that case.\n \n Comment: 1\n \n```\n",
    "created_at": "2021-06-27T22:58:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-484832",
    "user": "https://github.com/slel"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,53 @@
+Having defined:
 
+\`\`\`
+def B(n, x):
+    return -n*hurwitz_zeta(1 - n, x) if n != 0 else 1
+\`\`\`
+we expect \`expand(B(n, x))\` to
+match \`bernoulli_polynomial(x, n)\`.
+
+Using this small utility function to compare them:
+
+\`\`\`
+def table(nmax):
+    nab = [('n', 'expand(B(n, x))', 'bernoulli_polynomial(x, n)')]
+    nab.extend([(n, expand(B(n, x)), bernoulli_polynomial(x, n))
+                for n in range(nmax + 1)])
+    k = len(str(nmax))
+    m = max(len(str(x)) for t in nab for x in t)
+    hline = '-' * (k + m + 7)
+    print(hline)
+    for n, a, b in nab:
+        print(f' %{k}s     %{m}s' % (n, a))
+        print(f' %{k}s     %{m}s' % ('', b))
+        print(hline)
+\`\`\`
+we notice they match except for n = 1:
+
+\`\`\`
+sage: table(4)
+----------------------------------
+ n                expand(B(n, x))
+       bernoulli_polynomial(x, n)
+----------------------------------
+ 0                              1
+                                1
+----------------------------------
+ 1            -hurwitz_zeta(0, x)
+                          x - 1/2
+----------------------------------
+ 2                  x^2 - x + 1/6
+                    x^2 - x + 1/6
+----------------------------------
+ 3          x^3 - 3/2*x^2 + 1/2*x
+            x^3 - 3/2*x^2 + 1/2*x
+----------------------------------
+ 4       x^4 - 2*x^3 + x^2 - 1/30
+         x^4 - 2*x^3 + x^2 - 1/30
+----------------------------------
+\`\`\`
+This ticket fixes that case.
 
 Comment: 1
 
```




---

archive/issue_events_084691.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-07-25T13:25:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32016#event-84691"
}
```



---

archive/issue_comments_484833.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-07-25T13:25:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-484833",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
