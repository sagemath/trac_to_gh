# Issue 32016: Fix hurwitz_zeta(0, x) not expanding

archive/issues_031779.json:
```json
{
    "body": "Having defined:\n\n```\ndef B(n, x):\n    return -n*hurwitz_zeta(1 - n, x) if n != 0 else 1\n```\nwe expect `expand(B(n, x))` to\nmatch `bernoulli_polynomial(x, n)`.\n\nUsing this small utility function to compare them:\n\n```\ndef table(nmax):\n    nab = [('n', 'expand(B(n, x))', 'bernoulli_polynomial(x, n)')]\n    nab.extend([(n, expand(B(n, x)), bernoulli_polynomial(x, n))\n                for n in range(nmax + 1)])\n    k = len(str(nmax))\n    m = max(len(str(x)) for t in nab for x in t)\n    hline = '-' * (k + m + 7)\n    print(hline)\n    for n, a, b in nab:\n        print(f' %{k}s     %{m}s' % (n, a))\n        print(f' %{k}s     %{m}s' % ('', b))\n        print(hline)\n```\nwe notice they match except for n = 1:\n\n```\nsage: table(4)\n----------------------------------\n n                expand(B(n, x))\n       bernoulli_polynomial(x, n)\n----------------------------------\n 0                              1\n                                1\n----------------------------------\n 1            -hurwitz_zeta(0, x)\n                          x - 1/2\n----------------------------------\n 2                  x^2 - x + 1/6\n                    x^2 - x + 1/6\n----------------------------------\n 3          x^3 - 3/2*x^2 + 1/2*x\n            x^3 - 3/2*x^2 + 1/2*x\n----------------------------------\n 4       x^4 - 2*x^3 + x^2 - 1/30\n         x^4 - 2*x^3 + x^2 - 1/30\n----------------------------------\n```\nThis ticket fixes that case.\n\nCC:  @slel\n\nKeywords: hurwitz_zeta\n\nBranch/Commit: 785b4e27162892519d6bb1d5208551893e28a52e\n\nReviewer: Peter Luschny\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/32016\n\n",
    "closed_at": "2021-07-25T13:25:35Z",
    "created_at": "2021-06-21T06:36:40Z",
    "labels": [
        "component: symbolics",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Fix hurwitz_zeta(0, x) not expanding",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32016",
    "user": "https://github.com/PeterLuschny"
}
```
Having defined:

```
def B(n, x):
    return -n*hurwitz_zeta(1 - n, x) if n != 0 else 1
```
we expect `expand(B(n, x))` to
match `bernoulli_polynomial(x, n)`.

Using this small utility function to compare them:

```
def table(nmax):
    nab = [('n', 'expand(B(n, x))', 'bernoulli_polynomial(x, n)')]
    nab.extend([(n, expand(B(n, x)), bernoulli_polynomial(x, n))
                for n in range(nmax + 1)])
    k = len(str(nmax))
    m = max(len(str(x)) for t in nab for x in t)
    hline = '-' * (k + m + 7)
    print(hline)
    for n, a, b in nab:
        print(f' %{k}s     %{m}s' % (n, a))
        print(f' %{k}s     %{m}s' % ('', b))
        print(hline)
```
we notice they match except for n = 1:

```
sage: table(4)
----------------------------------
 n                expand(B(n, x))
       bernoulli_polynomial(x, n)
----------------------------------
 0                              1
                                1
----------------------------------
 1            -hurwitz_zeta(0, x)
                          x - 1/2
----------------------------------
 2                  x^2 - x + 1/6
                    x^2 - x + 1/6
----------------------------------
 3          x^3 - 3/2*x^2 + 1/2*x
            x^3 - 3/2*x^2 + 1/2*x
----------------------------------
 4       x^4 - 2*x^3 + x^2 - 1/30
         x^4 - 2*x^3 + x^2 - 1/30
----------------------------------
```
This ticket fixes that case.

CC:  @slel

Keywords: hurwitz_zeta

Branch/Commit: 785b4e27162892519d6bb1d5208551893e28a52e

Reviewer: Peter Luschny

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/32016





---

archive/issue_comments_637129.json:
```json
{
    "body": "<a id='comment:1'></a>fixed, please review\n\n---\nNew commits:",
    "created_at": "2021-06-21T13:29:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-637129",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>fixed, please review

---
New commits:



---

archive/issue_comments_637130.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/32016\"",
    "created_at": "2021-06-21T13:29:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-637130",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/32016"



---

archive/issue_comments_637131.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-06-21T13:29:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-637131",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_637132.json:
```json
{
    "body": "Changing author from \"\" to \"Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2021-06-21T13:29:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-637132",
    "user": "https://github.com/fchapoton"
}
```

Changing author from "" to "Frédéric Chapoton"



---

archive/issue_comments_637133.json:
```json
{
    "body": "Changing commit from \"\" to \"785b4e27162892519d6bb1d5208551893e28a52e\"",
    "created_at": "2021-06-21T13:29:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-637133",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "785b4e27162892519d6bb1d5208551893e28a52e"



---

archive/issue_comments_637134.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-06-21T14:44:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-637134",
    "user": "https://github.com/PeterLuschny"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_637135.json:
```json
{
    "body": "<a id='comment:2'></a>Looks good to me. Merci!",
    "created_at": "2021-06-21T14:44:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-637135",
    "user": "https://github.com/PeterLuschny"
}
```

<a id='comment:2'></a>Looks good to me. Merci!



---

archive/issue_comments_637136.json:
```json
{
    "body": "<a id='comment:3'></a>reviewer full name please",
    "created_at": "2021-06-21T19:20:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-637136",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>reviewer full name please



---

archive/issue_comments_637137.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Peter Luschny\"",
    "created_at": "2021-06-21T20:10:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-637137",
    "user": "https://github.com/PeterLuschny"
}
```

Changing reviewer from "" to "Peter Luschny"



---

archive/issue_comments_637138.json:
```json
{
    "body": "<a id='comment:4'></a>I don't know if I am qualified as a reviewer in the sense of the [SageMath](SageMath) organization.",
    "created_at": "2021-06-21T20:10:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-637138",
    "user": "https://github.com/PeterLuschny"
}
```

<a id='comment:4'></a>I don't know if I am qualified as a reviewer in the sense of the [SageMath](SageMath) organization.



---

archive/issue_comments_637139.json:
```json
{
    "body": "<a id='comment:5'></a>> I don't know if I am qualified as a reviewer\n> in the sense of the SageMath organization.\n\n\nYou are!",
    "created_at": "2021-06-27T22:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-637139",
    "user": "https://github.com/slel"
}
```

<a id='comment:5'></a>> I don't know if I am qualified as a reviewer
> in the sense of the SageMath organization.


You are!



---

archive/issue_comments_637140.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,16 +1,50 @@\n-See for example in:\n+Define:\n \n ```\n-def B(n, x): return -n*hurwitz_zeta(1 - n, x) if n != 0 else 1\n-for n in (0..4):\n-    print(expand(B(n, x)), \" , \", bernoulli_polynomial(x, n))\n+def B(n, x):\n+    return -n*hurwitz_zeta(1 - n, x) if n != 0 else 1\n+```\n+and compare `expand(B(n, x))` to `bernoulli_polynomial(x, n)`.\n \n-    1  ,  1\n-    -hurwitz_zeta(0, x)  ,  x - 1/2\n-    x^2 - x + 1/6  ,  x^2 - x + 1/6\n-    x^3 - 3/2*x^2 + 1/2*x  ,  x^3 - 3/2*x^2 + 1/2*x\n-    x^4 - 2*x^3 + x^2 - 1/30  ,  x^4 - 2*x^3 + x^2 - 1/30\n-    }}}\n-This also shows the expected value.\n+Utility function to compare:\n+\n+```\n+def table(nmax):\n+    nab = [('n', 'expand(B(n, x))', 'bernoulli_polynomial(x, n)')]\n+    nab.extend([(n, expand(B(n, x)), bernoulli_polynomial(x, n))\n+                for n in range(nmax + 1)])\n+    k = len(str(nmax))\n+    m = max(len(str(x)) for t in nab for x in t)\n+    hline = '-' * (k + m + 7)\n+    print(hline)\n+    for n, a, b in nab:\n+        print(f' %{k}s     %{m}s' % (n, a))\n+        print(f' %{k}s     %{m}s' % ('', b))\n+        print(hline)\n+```\n+The comparison:\n+\n+```\n+sage: table(4)\n+----------------------------------\n+ n                expand(B(n, x))\n+       bernoulli_polynomial(x, n)\n+----------------------------------\n+ 0                              1\n+                                1\n+----------------------------------\n+ 1            -hurwitz_zeta(0, x)\n+                          x - 1/2\n+----------------------------------\n+ 2                  x^2 - x + 1/6\n+                    x^2 - x + 1/6\n+----------------------------------\n+ 3          x^3 - 3/2*x^2 + 1/2*x\n+            x^3 - 3/2*x^2 + 1/2*x\n+----------------------------------\n+ 4       x^4 - 2*x^3 + x^2 - 1/30\n+         x^4 - 2*x^3 + x^2 - 1/30\n+----------------------------------\n+```\n \n \n``````\n",
    "created_at": "2021-06-27T22:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-637140",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,16 +1,50 @@
-See for example in:
+Define:
 
 ```
-def B(n, x): return -n*hurwitz_zeta(1 - n, x) if n != 0 else 1
-for n in (0..4):
-    print(expand(B(n, x)), " , ", bernoulli_polynomial(x, n))
+def B(n, x):
+    return -n*hurwitz_zeta(1 - n, x) if n != 0 else 1
+```
+and compare `expand(B(n, x))` to `bernoulli_polynomial(x, n)`.
 
-    1  ,  1
-    -hurwitz_zeta(0, x)  ,  x - 1/2
-    x^2 - x + 1/6  ,  x^2 - x + 1/6
-    x^3 - 3/2*x^2 + 1/2*x  ,  x^3 - 3/2*x^2 + 1/2*x
-    x^4 - 2*x^3 + x^2 - 1/30  ,  x^4 - 2*x^3 + x^2 - 1/30
-    }}}
-This also shows the expected value.
+Utility function to compare:
+
+```
+def table(nmax):
+    nab = [('n', 'expand(B(n, x))', 'bernoulli_polynomial(x, n)')]
+    nab.extend([(n, expand(B(n, x)), bernoulli_polynomial(x, n))
+                for n in range(nmax + 1)])
+    k = len(str(nmax))
+    m = max(len(str(x)) for t in nab for x in t)
+    hline = '-' * (k + m + 7)
+    print(hline)
+    for n, a, b in nab:
+        print(f' %{k}s     %{m}s' % (n, a))
+        print(f' %{k}s     %{m}s' % ('', b))
+        print(hline)
+```
+The comparison:
+
+```
+sage: table(4)
+----------------------------------
+ n                expand(B(n, x))
+       bernoulli_polynomial(x, n)
+----------------------------------
+ 0                              1
+                                1
+----------------------------------
+ 1            -hurwitz_zeta(0, x)
+                          x - 1/2
+----------------------------------
+ 2                  x^2 - x + 1/6
+                    x^2 - x + 1/6
+----------------------------------
+ 3          x^3 - 3/2*x^2 + 1/2*x
+            x^3 - 3/2*x^2 + 1/2*x
+----------------------------------
+ 4       x^4 - 2*x^3 + x^2 - 1/30
+         x^4 - 2*x^3 + x^2 - 1/30
+----------------------------------
+```
 
 
``````




---

archive/issue_comments_637141.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2021-06-27T22:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-637141",
    "user": "https://github.com/slel"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_637142.json:
```json
{
    "body": "Changing keywords from \"\" to \"hurwitz_zeta\".",
    "created_at": "2021-06-27T22:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-637142",
    "user": "https://github.com/slel"
}
```

Changing keywords from "" to "hurwitz_zeta".



---

archive/issue_comments_637143.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,12 +1,13 @@\n-Define:\n+Having defined:\n \n ```\n def B(n, x):\n     return -n*hurwitz_zeta(1 - n, x) if n != 0 else 1\n ```\n-and compare `expand(B(n, x))` to `bernoulli_polynomial(x, n)`.\n+we expect `expand(B(n, x))` to\n+match `bernoulli_polynomial(x, n)`.\n \n-Utility function to compare:\n+Using this small utility function to compare them:\n \n ```\n def table(nmax):\n@@ -22,7 +23,7 @@\n         print(f' %{k}s     %{m}s' % ('', b))\n         print(hline)\n ```\n-The comparison:\n+we notice they match except for n = 1:\n \n ```\n sage: table(4)\n@@ -46,5 +47,4 @@\n          x^4 - 2*x^3 + x^2 - 1/30\n ----------------------------------\n ```\n-\n-\n+This ticket fixes that case.\n``````\n",
    "created_at": "2021-06-27T22:58:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-637143",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,12 +1,13 @@
-Define:
+Having defined:
 
 ```
 def B(n, x):
     return -n*hurwitz_zeta(1 - n, x) if n != 0 else 1
 ```
-and compare `expand(B(n, x))` to `bernoulli_polynomial(x, n)`.
+we expect `expand(B(n, x))` to
+match `bernoulli_polynomial(x, n)`.
 
-Utility function to compare:
+Using this small utility function to compare them:
 
 ```
 def table(nmax):
@@ -22,7 +23,7 @@
         print(f' %{k}s     %{m}s' % ('', b))
         print(hline)
 ```
-The comparison:
+we notice they match except for n = 1:
 
 ```
 sage: table(4)
@@ -46,5 +47,4 @@
          x^4 - 2*x^3 + x^2 - 1/30
 ----------------------------------
 ```
-
-
+This ticket fixes that case.
``````




---

archive/issue_comments_637144.json:
```json
{
    "body": "Changing branch from \"u/chapoton/32016\" to \"785b4e27162892519d6bb1d5208551893e28a52e\"",
    "created_at": "2021-07-25T13:25:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-637144",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/chapoton/32016" to "785b4e27162892519d6bb1d5208551893e28a52e"



---

archive/issue_events_084691.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-07-25T13:25:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32016#event-84691"
}
```



---

archive/issue_comments_637145.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-07-25T13:25:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32016#issuecomment-637145",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
