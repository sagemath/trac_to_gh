# Issue 32501: Meta-ticket: Clear out __init__.py files in preparation for namespace packages

archive/issues_032264.json:
```json
{
    "body": "(Part of the modularization effort, #29705)\n\nWhenever there are two distribution packages that provide modules with a common prefix of Python packages, that prefix needs to be a native namespace package, i.e., there cannot be an `__init__.py` file. \n\nFor example, \n- **sagemath-tdlib** will provide `sage.graphs.graph_decompositions.tdlib`,\n- **sagemath-rw** will provide `sage.graphs.graph_decompositions.rankwidth`,\n- **sagemath-graphs** will provide all of the rest of `sage.graphs.graph_decompositions` (and most of `sage.graphs`).\nThen, none of \n- `sage`, \n- `sage.graphs`, \n- `sage.graphs.graph_decomposition` \ncan be an ordinary Python package (with `__init__.py` file), but rather each of them has to be a native namespace package (no `__init__.py` file).\n\nIn this meta-ticket, we make sure that all such `__init__.py` files are empty. (The actual removal of empty `__init__.py` files will be done in #28925.)\n\nNot all `__init__.py` files need to be empty. For example, \n- all of `sage.cpython` and `sage.structure` (after #29870) is intended to be in one distribution package, **sagemath-objects**. Hence `sage.cpython` and `sage.structure` keep their nonempty `__init__.py` files, and we may even add a comment that documents that they are intended to stay ordinary packages. (#31420 clears `sage.__init__` and adds such a comment to `sage.cpython.__init__`)\n- `sage.libs.giac` is intended to be in one distribution package, **sagemath-giac**. Hence `sage.libs.giac` will keep its nonempty `__init__.py` file (but `sage.libs` will not).\n\nWith positively-reviewed tickets #31420/#32479/#32506/#32507\n\n```\n$ find src/sage -name '__init__.py' | xargs wc -l | grep -v '^ *0'\n       2 src/sage/crypto/__init__.py\n       3 src/sage/crypto/mq/__init__.py\n       3 src/sage/dynamics/__init__.py\n       3 src/sage/dynamics/cellular_automata/__init__.py\n      42 src/sage/combinat/words/__init__.py\n      38 src/sage/combinat/designs/__init__.py            #32508\n      13 src/sage/combinat/chas/__init__.py               #32508\n      11 src/sage/combinat/path_tableaux/__init__.py      #32508\n      49 src/sage/combinat/__init__.py                    #32508\n      10 src/sage/combinat/cluster_algebra_quiver/__init__.py  #32508\n      51 src/sage/combinat/species/__init__.py            #32508\n      31 src/sage/combinat/sf/__init__.py                 #32508\n      29 src/sage/combinat/crystals/__init__.py           #32508\n      10 src/sage/combinat/ncsym/__init__.py              #32508\n      35 src/sage/combinat/posets/__init__.py             #32508\n      11 src/sage/combinat/ncsf_qsym/__init__.py          #32508\n       7 src/sage/combinat/integer_lists/__init__.py            # OK, 1 distro\n      36 src/sage/combinat/rigged_configurations/__init__.py  #32508\n     127 src/sage/combinat/root_system/__init__.py        #32508, #32840\n       9 src/sage/combinat/matrices/__init__.py\n       3 src/sage/doctest/__init__.py                           # OK, 1 distro sagemath-repl\n     826 src/sage/features/__init__.py                          # OK, 1 distro\n       4 src/sage/repl/rich_output/__init__.py                  # OK, 1 distro sagemath-repl\n      39 src/sage/__init__.py                             #32489\n     359 src/sage/libs/giac/__init__.py                         # OK, 1 distro sagemath-giac\n       2 src/sage/libs/ntl/__init__.py                          # OK, 1 distro\n       1 src/sage/libs/gap/__init__.py                          # OK, 1 distro\n     219 src/sage/libs/pari/__init__.py                         # OK, 1 distro\n      55 src/sage/cpython/__init__.py                           # OK, 1 distro sagemath-objects\n       2 src/sage/sat/converters/__init__.py\n       4 src/sage/sat/solvers/__init__.py\n       2 src/sage/matroids/__init__.py\n     114 src/sage/rings/polynomial/pbori/__init__.py            # OK, 1 distro sagemath-brial\n       2 src/sage/rings/polynomial/__init__.py            #32509\n      10 src/sage/modules/with_basis/__init__.py                # OK, 1 distro sagemath-categories\n       2 src/sage/structure/__init__.py                         # OK, 1 distro sagemath-objects\n      29 src/sage/categories/__init__.py                  #32508\n       2 src/sage/media/__init__.py                             # deprecated\n```\n\nTickets:\n- #31420/#32479/#32489 `sage`\n- #32506 Remove useless 'file is not empty' comments from `__init__.py` files\n- #32507 Remove useless 'from . import all' and similar from some `__init__.py` files\n- #32508 Eliminate use of `__init__.py` files for supplying package docstrings\n- #32509 Clear out `__init__.py` in `sage.rings.polynomial`\n- #32840 Fix `unpickle_global` when `register_unpickle_override` appears in a module not loaded at startup\n\nRelated:\n- #30666 Add \"sage_setup: distribution\" directives to all Cython modules needing external libraries -- related because the dependencies on C/C++ libraries guide the layout of the namespace packages.\n\n\n\nCC:  @tscrim @pjbruin @kiwifb @kliem @dcoudert\n\nReviewer: Michael Orlitzky\n\nResolution: invalid\n\nIssue created by migration from https://trac.sagemath.org/ticket/32501\n\n",
    "closed_at": "2021-12-01T02:46:14Z",
    "created_at": "2021-09-10T19:33:21Z",
    "labels": [
        "component: refactoring"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Meta-ticket: Clear out __init__.py files in preparation for namespace packages",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32501",
    "user": "https://github.com/mkoeppe"
}
```
(Part of the modularization effort, #29705)

Whenever there are two distribution packages that provide modules with a common prefix of Python packages, that prefix needs to be a native namespace package, i.e., there cannot be an `__init__.py` file. 

For example, 
- **sagemath-tdlib** will provide `sage.graphs.graph_decompositions.tdlib`,
- **sagemath-rw** will provide `sage.graphs.graph_decompositions.rankwidth`,
- **sagemath-graphs** will provide all of the rest of `sage.graphs.graph_decompositions` (and most of `sage.graphs`).
Then, none of 
- `sage`, 
- `sage.graphs`, 
- `sage.graphs.graph_decomposition` 
can be an ordinary Python package (with `__init__.py` file), but rather each of them has to be a native namespace package (no `__init__.py` file).

In this meta-ticket, we make sure that all such `__init__.py` files are empty. (The actual removal of empty `__init__.py` files will be done in #28925.)

Not all `__init__.py` files need to be empty. For example, 
- all of `sage.cpython` and `sage.structure` (after #29870) is intended to be in one distribution package, **sagemath-objects**. Hence `sage.cpython` and `sage.structure` keep their nonempty `__init__.py` files, and we may even add a comment that documents that they are intended to stay ordinary packages. (#31420 clears `sage.__init__` and adds such a comment to `sage.cpython.__init__`)
- `sage.libs.giac` is intended to be in one distribution package, **sagemath-giac**. Hence `sage.libs.giac` will keep its nonempty `__init__.py` file (but `sage.libs` will not).

With positively-reviewed tickets #31420/#32479/#32506/#32507

```
$ find src/sage -name '__init__.py' | xargs wc -l | grep -v '^ *0'
       2 src/sage/crypto/__init__.py
       3 src/sage/crypto/mq/__init__.py
       3 src/sage/dynamics/__init__.py
       3 src/sage/dynamics/cellular_automata/__init__.py
      42 src/sage/combinat/words/__init__.py
      38 src/sage/combinat/designs/__init__.py            #32508
      13 src/sage/combinat/chas/__init__.py               #32508
      11 src/sage/combinat/path_tableaux/__init__.py      #32508
      49 src/sage/combinat/__init__.py                    #32508
      10 src/sage/combinat/cluster_algebra_quiver/__init__.py  #32508
      51 src/sage/combinat/species/__init__.py            #32508
      31 src/sage/combinat/sf/__init__.py                 #32508
      29 src/sage/combinat/crystals/__init__.py           #32508
      10 src/sage/combinat/ncsym/__init__.py              #32508
      35 src/sage/combinat/posets/__init__.py             #32508
      11 src/sage/combinat/ncsf_qsym/__init__.py          #32508
       7 src/sage/combinat/integer_lists/__init__.py            # OK, 1 distro
      36 src/sage/combinat/rigged_configurations/__init__.py  #32508
     127 src/sage/combinat/root_system/__init__.py        #32508, #32840
       9 src/sage/combinat/matrices/__init__.py
       3 src/sage/doctest/__init__.py                           # OK, 1 distro sagemath-repl
     826 src/sage/features/__init__.py                          # OK, 1 distro
       4 src/sage/repl/rich_output/__init__.py                  # OK, 1 distro sagemath-repl
      39 src/sage/__init__.py                             #32489
     359 src/sage/libs/giac/__init__.py                         # OK, 1 distro sagemath-giac
       2 src/sage/libs/ntl/__init__.py                          # OK, 1 distro
       1 src/sage/libs/gap/__init__.py                          # OK, 1 distro
     219 src/sage/libs/pari/__init__.py                         # OK, 1 distro
      55 src/sage/cpython/__init__.py                           # OK, 1 distro sagemath-objects
       2 src/sage/sat/converters/__init__.py
       4 src/sage/sat/solvers/__init__.py
       2 src/sage/matroids/__init__.py
     114 src/sage/rings/polynomial/pbori/__init__.py            # OK, 1 distro sagemath-brial
       2 src/sage/rings/polynomial/__init__.py            #32509
      10 src/sage/modules/with_basis/__init__.py                # OK, 1 distro sagemath-categories
       2 src/sage/structure/__init__.py                         # OK, 1 distro sagemath-objects
      29 src/sage/categories/__init__.py                  #32508
       2 src/sage/media/__init__.py                             # deprecated
```

Tickets:
- #31420/#32479/#32489 `sage`
- #32506 Remove useless 'file is not empty' comments from `__init__.py` files
- #32507 Remove useless 'from . import all' and similar from some `__init__.py` files
- #32508 Eliminate use of `__init__.py` files for supplying package docstrings
- #32509 Clear out `__init__.py` in `sage.rings.polynomial`
- #32840 Fix `unpickle_global` when `register_unpickle_override` appears in a module not loaded at startup

Related:
- #30666 Add "sage_setup: distribution" directives to all Cython modules needing external libraries -- related because the dependencies on C/C++ libraries guide the layout of the namespace packages.



CC:  @tscrim @pjbruin @kiwifb @kliem @dcoudert

Reviewer: Michael Orlitzky

Resolution: invalid

Issue created by migration from https://trac.sagemath.org/ticket/32501





---

archive/issue_comments_460096.json:
```json
{
    "body": "<a id='comment:6'></a>A serious case:\n\n```\n$ cat src/sage/rings/polynomial/__init__.py\n# Resolve a cyclic import\nimport sage.rings.convert.mpfi\n```\nWe need to get rid of this one -- `sage.rings.polynomial` must become a namespace package",
    "created_at": "2021-09-13T06:19:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32501#issuecomment-460096",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>A serious case:

```
$ cat src/sage/rings/polynomial/__init__.py
# Resolve a cyclic import
import sage.rings.convert.mpfi
```
We need to get rid of this one -- `sage.rings.polynomial` must become a namespace package



---

archive/issue_comments_460097.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:6 mkoeppe]:\n> A serious case:\n> \n> ```\n> $ cat src/sage/rings/polynomial/__init__.py\n> # Resolve a cyclic import\n> import sage.rings.convert.mpfi\n> ```\n> We need to get rid of this one -- `sage.rings.polynomial` must become a namespace package\n\n\nThis one was added it #25848 (\"Some preparations for binding=True\") for a stalled effort in #22747/#26254",
    "created_at": "2021-09-13T19:14:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32501#issuecomment-460097",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>Replying to [comment:6 mkoeppe]:
> A serious case:
> 
> ```
> $ cat src/sage/rings/polynomial/__init__.py
> # Resolve a cyclic import
> import sage.rings.convert.mpfi
> ```
> We need to get rid of this one -- `sage.rings.polynomial` must become a namespace package


This one was added it #25848 ("Some preparations for binding=True") for a stalled effort in #22747/#26254



---

archive/issue_comments_460098.json:
```json
{
    "body": "<a id='comment:11'></a>We can close this meta-ticket because it only tracks one open ticket.",
    "created_at": "2021-10-20T17:41:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32501#issuecomment-460098",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>We can close this meta-ticket because it only tracks one open ticket.



---

archive/issue_comments_460099.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-10-20T17:41:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32501#issuecomment-460099",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_events_086203.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-20T17:41:24Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32501",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32501#event-86203"
}
```



---

archive/issue_comments_460100.json:
```json
{
    "body": "<a id='comment:12'></a>I think it would be good to keep it open until the final ticket is done.",
    "created_at": "2021-10-20T23:53:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32501#issuecomment-460100",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>I think it would be good to keep it open until the final ticket is done.



---

archive/issue_comments_460101.json:
```json
{
    "body": "<a id='comment:18'></a>Everything in the \"Tickets:\" list has been closed: fixed.",
    "created_at": "2021-12-01T01:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32501#issuecomment-460101",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:18'></a>Everything in the "Tickets:" list has been closed: fixed.



---

archive/issue_comments_460102.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-12-01T01:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32501#issuecomment-460102",
    "user": "https://github.com/orlitzky"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_086204.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-01T02:46:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32501",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32501#event-86204"
}
```



---

archive/issue_comments_460103.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2021-12-01T02:46:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32501#issuecomment-460103",
    "user": "https://github.com/mkoeppe"
}
```

Resolution: invalid
