# Issue 32215: Asymptotic Term Monoids: refactor element construction

archive/issues_031978.json:
```json
{
    "assignees": [],
    "body": "In #31933 conversion fails. In order to fix this properly, a refactor of the conversion process seems the best solution. This ticket does this (without fixing the open issue on #31933 which will be a follow up).\n\nDepends on #32214\n\nCC:  @cheuberg @behackl @thhagelmayer\n\nKeywords: **gsoc2021**\n\nBranch/Commit: **[`89ad9d2`](https://github.com/sagemath/sagetrac-mirror/commit/89ad9d2cbd4aed3a7c0b1065766c03727c754e01)**\n\nReviewer: **Benjamin Hackl**\n\nAuthor: **Daniel Krenn**\n\nComponent: **asymptotic expansions**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/32215_\n\n",
    "closed_at": "2021-12-12T15:08:54Z",
    "created_at": "2021-07-16T19:55:19Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20asymptotic%20expansions",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Asymptotic Term Monoids: refactor element construction",
    "type": "issue",
    "updated_at": "2021-12-12T15:08:54Z",
    "url": "https://github.com/sagemath/sage/issues/32215",
    "user": "https://github.com/dkrenn"
}
```
In #31933 conversion fails. In order to fix this properly, a refactor of the conversion process seems the best solution. This ticket does this (without fixing the open issue on #31933 which will be a follow up).

Depends on #32214

CC:  @cheuberg @behackl @thhagelmayer

Keywords: **gsoc2021**

Branch/Commit: **[`89ad9d2`](https://github.com/sagemath/sagetrac-mirror/commit/89ad9d2cbd4aed3a7c0b1065766c03727c754e01)**

Reviewer: **Benjamin Hackl**

Author: **Daniel Krenn**

Component: **asymptotic expansions**

_Issue created by migration from https://trac.sagemath.org/ticket/32215_





---

archive/issue_events_441174.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2021-07-16T19:55:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441174"
}
```



---

archive/issue_events_441175.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2021-07-16T19:55:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20asymptotic%20expansions",
    "label_color": "0000ff",
    "label_name": "c: asymptotic expansions",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441175"
}
```



---

archive/issue_events_441176.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2021-07-16T19:55:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441176"
}
```



---

archive/issue_events_441177.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2021-07-16T19:55:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441177"
}
```



---

archive/issue_comments_518931.json:
```json
{
    "body": "Branch: **[u/dkrenn/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/refactor-element-construction-term-monoids)**",
    "created_at": "2021-07-16T20:03:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518931",
    "user": "https://github.com/dkrenn"
}
```

Branch: **[u/dkrenn/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/refactor-element-construction-term-monoids)**



---

archive/issue_events_441178.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2021-07-16T20:04:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441178"
}
```



---

archive/issue_comments_518932.json:
```json
{
    "body": "Dependencies: **#32214**",
    "created_at": "2021-07-16T20:04:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518932",
    "user": "https://github.com/dkrenn"
}
```

Dependencies: **#32214**



---

archive/issue_comments_518933.json:
```json
{
    "body": "Commit: **[`c805fc1`](https://github.com/sagemath/sagetrac-mirror/commit/c805fc19b60e9ac4ff028f63d4c687cb4d50bca2)**",
    "created_at": "2021-07-16T20:04:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518933",
    "user": "https://github.com/dkrenn"
}
```

Commit: **[`c805fc1`](https://github.com/sagemath/sagetrac-mirror/commit/c805fc19b60e9ac4ff028f63d4c687cb4d50bca2)**



---

archive/issue_comments_518934.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9061510ffa10f76c4f2f7f984366b8be8974ed5a\"><code>9061510</code></a></td><td><code>add `_repr_` for TermWithCoefficientMonoid</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a0b6a1e235cb112b5a00b810cfd9cd0c65ea2521\"><code>a0b6a1e</code></a></td><td><code>update and unify GenericTermMonoid _repr_</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4062f9ae87745b2af9b6c2f12aa33519010a1080\"><code>4062f9a</code></a></td><td><code>refactor element construction in term monoids</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c805fc19b60e9ac4ff028f63d4c687cb4d50bca2\"><code>c805fc1</code></a></td><td><code>Trac #32215: deprecate positional \"coefficient\" argument</code></td></tr></table>\n",
    "created_at": "2021-07-16T20:04:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518934",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9061510ffa10f76c4f2f7f984366b8be8974ed5a"><code>9061510</code></a></td><td><code>add `_repr_` for TermWithCoefficientMonoid</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a0b6a1e235cb112b5a00b810cfd9cd0c65ea2521"><code>a0b6a1e</code></a></td><td><code>update and unify GenericTermMonoid _repr_</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4062f9ae87745b2af9b6c2f12aa33519010a1080"><code>4062f9a</code></a></td><td><code>refactor element construction in term monoids</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c805fc19b60e9ac4ff028f63d4c687cb4d50bca2"><code>c805fc1</code></a></td><td><code>Trac #32215: deprecate positional "coefficient" argument</code></td></tr></table>




---

archive/issue_comments_518935.json:
```json
{
    "body": "Author: **Daniel Krenn**",
    "created_at": "2021-07-16T20:04:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518935",
    "user": "https://github.com/dkrenn"
}
```

Author: **Daniel Krenn**



---

archive/issue_comments_518936.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReview recommendation: commit-wise",
    "created_at": "2021-07-16T20:06:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518936",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:3" align="right">comment:3</div>

Review recommendation: commit-wise



---

archive/issue_comments_518937.json:
```json
{
    "body": "Changed commit from **[`c805fc1`](https://github.com/sagemath/sagetrac-mirror/commit/c805fc19b60e9ac4ff028f63d4c687cb4d50bca2)** to **[`f76b7e7`](https://github.com/sagemath/sagetrac-mirror/commit/f76b7e7ef42e8cf09301cc38277a11024e210f1d)**",
    "created_at": "2021-07-17T10:00:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518937",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c805fc1`](https://github.com/sagemath/sagetrac-mirror/commit/c805fc19b60e9ac4ff028f63d4c687cb4d50bca2)** to **[`f76b7e7`](https://github.com/sagemath/sagetrac-mirror/commit/f76b7e7ef42e8cf09301cc38277a11024e210f1d)**



---

archive/issue_comments_518938.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f76b7e7ef42e8cf09301cc38277a11024e210f1d\"><code>f76b7e7</code></a></td><td><code>Trac #32215: use defaults of super class</code></td></tr></table>\n",
    "created_at": "2021-07-17T10:00:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518938",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f76b7e7ef42e8cf09301cc38277a11024e210f1d"><code>f76b7e7</code></a></td><td><code>Trac #32215: use defaults of super class</code></td></tr></table>




---

archive/issue_comments_518939.json:
```json
{
    "body": "Changed commit from **[`f76b7e7`](https://github.com/sagemath/sagetrac-mirror/commit/f76b7e7ef42e8cf09301cc38277a11024e210f1d)** to **[`c479267`](https://github.com/sagemath/sagetrac-mirror/commit/c4792672602326a9cc615fb0060d5e09a20d69dd)**",
    "created_at": "2021-07-18T11:26:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518939",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f76b7e7`](https://github.com/sagemath/sagetrac-mirror/commit/f76b7e7ef42e8cf09301cc38277a11024e210f1d)** to **[`c479267`](https://github.com/sagemath/sagetrac-mirror/commit/c4792672602326a9cc615fb0060d5e09a20d69dd)**



---

archive/issue_comments_518940.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c98180548fde5d14ff8999c89bd39b60b5640436\"><code>c981805</code></a></td><td><code>Trac #32215: unify docstrings of .construction</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c4792672602326a9cc615fb0060d5e09a20d69dd\"><code>c479267</code></a></td><td><code>Trac #32215: remove caching from _default_kwds_construction_</code></td></tr></table>\n",
    "created_at": "2021-07-18T11:26:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518940",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c98180548fde5d14ff8999c89bd39b60b5640436"><code>c981805</code></a></td><td><code>Trac #32215: unify docstrings of .construction</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c4792672602326a9cc615fb0060d5e09a20d69dd"><code>c479267</code></a></td><td><code>Trac #32215: remove caching from _default_kwds_construction_</code></td></tr></table>




---

archive/issue_comments_518941.json:
```json
{
    "body": "Changed commit from **[`c479267`](https://github.com/sagemath/sagetrac-mirror/commit/c4792672602326a9cc615fb0060d5e09a20d69dd)** to **[`3c5c0f0`](https://github.com/sagemath/sagetrac-mirror/commit/3c5c0f0d88eec1853137f15466f254c378b32b5d)**",
    "created_at": "2021-07-18T14:09:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518941",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c479267`](https://github.com/sagemath/sagetrac-mirror/commit/c4792672602326a9cc615fb0060d5e09a20d69dd)** to **[`3c5c0f0`](https://github.com/sagemath/sagetrac-mirror/commit/3c5c0f0d88eec1853137f15466f254c378b32b5d)**



---

archive/issue_comments_518942.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3c5c0f0d88eec1853137f15466f254c378b32b5d\"><code>3c5c0f0</code></a></td><td><code>fix coercion related to absorbtion</code></td></tr></table>\n",
    "created_at": "2021-07-18T14:09:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518942",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3c5c0f0d88eec1853137f15466f254c378b32b5d"><code>3c5c0f0</code></a></td><td><code>fix coercion related to absorbtion</code></td></tr></table>




---

archive/issue_comments_518943.json:
```json
{
    "body": "Changed branch from **[u/dkrenn/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/refactor-element-construction-term-monoids)** to **[u/behackl/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/behackl/refactor-element-construction-term-monoids)**",
    "created_at": "2021-07-22T11:06:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518943",
    "user": "https://github.com/behackl"
}
```

Changed branch from **[u/dkrenn/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/refactor-element-construction-term-monoids)** to **[u/behackl/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/behackl/refactor-element-construction-term-monoids)**



---

archive/issue_comments_518944.json:
```json
{
    "body": "Changed commit from **[`3c5c0f0`](https://github.com/sagemath/sagetrac-mirror/commit/3c5c0f0d88eec1853137f15466f254c378b32b5d)** to **[`1975a10`](https://github.com/sagemath/sagetrac-mirror/commit/1975a10ac0f58240e195e66cf08c6105ad125a7e)**",
    "created_at": "2021-07-22T11:12:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518944",
    "user": "https://github.com/behackl"
}
```

Changed commit from **[`3c5c0f0`](https://github.com/sagemath/sagetrac-mirror/commit/3c5c0f0d88eec1853137f15466f254c378b32b5d)** to **[`1975a10`](https://github.com/sagemath/sagetrac-mirror/commit/1975a10ac0f58240e195e66cf08c6105ad125a7e)**



---

archive/issue_comments_518945.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nHere are some minor points that should be addressed: \n\n1. The new exceptions caused by ambiguously passing additional `growth` and `coefficient` keyword arguments should be tested.\n\n2. Is there a particular reason for changing the implementation of `OTerm.can_absorb`?\n\n3. The implementations of `TermWithCoefficientMonoid._convert_construction_` and `ExactTermMonoid._convert_construction_` are identical. I think the tests contained in the docstring of `ExactTermMonoid._convert_construction_` should be moved to `TermWithCoefficientMonoid._convert_construction_` and the separate implementation of `ExactTermMonoid._convert_construction_` should be removed.\n\n\nOtherwise, the proposed changes look good to me. Here are the changes I've made in my reviewer commits:\n\n- the `cached_method` import was unused and is now removed.\n\n- The `EXAMPLES` block in some newly added methods used `TermMonoidFactory` to manually construct a factory, I've changed it to `from sage.rings.asymptotic.term_monoid import DefaultTermMonoidFactory as TermMonoid` (also see #32032).\n\n- Language improvements for the error messages and the deprecation warning in `GenericTermMonoid._element_constructor`.\n \n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bc7b2bc56ad6541bd8a8e5adf55e698915fad6dc\"><code>bc7b2bc</code></a></td><td><code>removed superfluous import</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d7cefd91f1218a4253920b32f21ac06dd0c828e2\"><code>d7cefd9</code></a></td><td><code>minor language improvements for docstrings and deprecation warning</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1975a10ac0f58240e195e66cf08c6105ad125a7e\"><code>1975a10</code></a></td><td><code>changed doctests of new methods to use DefaultTermMonoidFactory</code></td></tr></table>\n",
    "created_at": "2021-07-22T11:12:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518945",
    "user": "https://github.com/behackl"
}
```

<div id="comment:9" align="right">comment:9</div>

Here are some minor points that should be addressed: 

1. The new exceptions caused by ambiguously passing additional `growth` and `coefficient` keyword arguments should be tested.

2. Is there a particular reason for changing the implementation of `OTerm.can_absorb`?

3. The implementations of `TermWithCoefficientMonoid._convert_construction_` and `ExactTermMonoid._convert_construction_` are identical. I think the tests contained in the docstring of `ExactTermMonoid._convert_construction_` should be moved to `TermWithCoefficientMonoid._convert_construction_` and the separate implementation of `ExactTermMonoid._convert_construction_` should be removed.


Otherwise, the proposed changes look good to me. Here are the changes I've made in my reviewer commits:

- the `cached_method` import was unused and is now removed.

- The `EXAMPLES` block in some newly added methods used `TermMonoidFactory` to manually construct a factory, I've changed it to `from sage.rings.asymptotic.term_monoid import DefaultTermMonoidFactory as TermMonoid` (also see #32032).

- Language improvements for the error messages and the deprecation warning in `GenericTermMonoid._element_constructor`.
 
---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bc7b2bc56ad6541bd8a8e5adf55e698915fad6dc"><code>bc7b2bc</code></a></td><td><code>removed superfluous import</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d7cefd91f1218a4253920b32f21ac06dd0c828e2"><code>d7cefd9</code></a></td><td><code>minor language improvements for docstrings and deprecation warning</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1975a10ac0f58240e195e66cf08c6105ad125a7e"><code>1975a10</code></a></td><td><code>changed doctests of new methods to use DefaultTermMonoidFactory</code></td></tr></table>




---

archive/issue_events_441179.json:
```json
{
    "actor": "https://github.com/behackl",
    "created_at": "2021-07-22T11:12:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441179"
}
```



---

archive/issue_events_441180.json:
```json
{
    "actor": "https://github.com/behackl",
    "created_at": "2021-07-22T11:12:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441180"
}
```



---

archive/issue_comments_518946.json:
```json
{
    "body": "Reviewer: **Benjamin Hackl**",
    "created_at": "2021-07-22T11:12:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518946",
    "user": "https://github.com/behackl"
}
```

Reviewer: **Benjamin Hackl**



---

archive/issue_comments_518947.json:
```json
{
    "body": "Changed branch from **[u/behackl/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/behackl/refactor-element-construction-term-monoids)** to **[u/gh-thhagelmayer/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-thhagelmayer/refactor-element-construction-term-monoids)**",
    "created_at": "2021-08-07T16:10:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518947",
    "user": "https://github.com/thhagelmayer"
}
```

Changed branch from **[u/behackl/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/behackl/refactor-element-construction-term-monoids)** to **[u/gh-thhagelmayer/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-thhagelmayer/refactor-element-construction-term-monoids)**



---

archive/issue_comments_518948.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI have merged #32032 and fixed some doctests.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e925c053bb08e38a85d4df1fa48b658409020104\"><code>e925c05</code></a></td><td><code>Merge branch 't/32032/a3bad87abf0a70f85adbcba9b88244b0393a82ad' into t/32215/refactor-element-construction-term-monoids</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0a506354ea6ec01df3e7ba5b093d5c6e06179393\"><code>0a50635</code></a></td><td><code>Trac #32215: fix doctests</code></td></tr></table>\n",
    "created_at": "2021-08-07T16:15:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518948",
    "user": "https://github.com/thhagelmayer"
}
```

<div id="comment:11" align="right">comment:11</div>

I have merged #32032 and fixed some doctests.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e925c053bb08e38a85d4df1fa48b658409020104"><code>e925c05</code></a></td><td><code>Merge branch 't/32032/a3bad87abf0a70f85adbcba9b88244b0393a82ad' into t/32215/refactor-element-construction-term-monoids</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0a506354ea6ec01df3e7ba5b093d5c6e06179393"><code>0a50635</code></a></td><td><code>Trac #32215: fix doctests</code></td></tr></table>




---

archive/issue_comments_518949.json:
```json
{
    "body": "Changed commit from **[`1975a10`](https://github.com/sagemath/sagetrac-mirror/commit/1975a10ac0f58240e195e66cf08c6105ad125a7e)** to **[`0a50635`](https://github.com/sagemath/sagetrac-mirror/commit/0a506354ea6ec01df3e7ba5b093d5c6e06179393)**",
    "created_at": "2021-08-07T16:15:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518949",
    "user": "https://github.com/thhagelmayer"
}
```

Changed commit from **[`1975a10`](https://github.com/sagemath/sagetrac-mirror/commit/1975a10ac0f58240e195e66cf08c6105ad125a7e)** to **[`0a50635`](https://github.com/sagemath/sagetrac-mirror/commit/0a506354ea6ec01df3e7ba5b093d5c6e06179393)**



---

archive/issue_comments_518950.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@behackl](#comment:9):\n> Otherwise, the proposed changes look good to me. Here are the changes I've made in my reviewer commits:\n> \n> - the `cached_method` import was unused and is now removed.\n> \n> - The `EXAMPLES` block in some newly added methods used `TermMonoidFactory` to manually construct a factory, I've changed it to `from sage.rings.asymptotic.term_monoid import DefaultTermMonoidFactory as TermMonoid` (also see #32032).\n> \n> - Language improvements for the error messages and the deprecation warning in `GenericTermMonoid._element_constructor`.\n\nLGTM, thanks.",
    "created_at": "2021-08-09T13:55:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518950",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@behackl](#comment:9):
> Otherwise, the proposed changes look good to me. Here are the changes I've made in my reviewer commits:
> 
> - the `cached_method` import was unused and is now removed.
> 
> - The `EXAMPLES` block in some newly added methods used `TermMonoidFactory` to manually construct a factory, I've changed it to `from sage.rings.asymptotic.term_monoid import DefaultTermMonoidFactory as TermMonoid` (also see #32032).
> 
> - Language improvements for the error messages and the deprecation warning in `GenericTermMonoid._element_constructor`.

LGTM, thanks.



---

archive/issue_comments_518951.json:
```json
{
    "body": "Changed branch from **[u/gh-thhagelmayer/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-thhagelmayer/refactor-element-construction-term-monoids)** to **[u/dkrenn/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/refactor-element-construction-term-monoids)**",
    "created_at": "2021-08-09T14:09:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518951",
    "user": "https://github.com/dkrenn"
}
```

Changed branch from **[u/gh-thhagelmayer/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-thhagelmayer/refactor-element-construction-term-monoids)** to **[u/dkrenn/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/refactor-element-construction-term-monoids)**



---

archive/issue_comments_518952.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d763d663355c4519128a616fb5f6ce7ebba2cfee\"><code>d763d66</code></a></td><td><code>Trac #32215: full coverage of _element_constructor_</code></td></tr></table>\n",
    "created_at": "2021-08-09T14:42:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518952",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d763d663355c4519128a616fb5f6ce7ebba2cfee"><code>d763d66</code></a></td><td><code>Trac #32215: full coverage of _element_constructor_</code></td></tr></table>




---

archive/issue_comments_518953.json:
```json
{
    "body": "Changed commit from **[`0a50635`](https://github.com/sagemath/sagetrac-mirror/commit/0a506354ea6ec01df3e7ba5b093d5c6e06179393)** to **[`d763d66`](https://github.com/sagemath/sagetrac-mirror/commit/d763d663355c4519128a616fb5f6ce7ebba2cfee)**",
    "created_at": "2021-08-09T14:42:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518953",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0a50635`](https://github.com/sagemath/sagetrac-mirror/commit/0a506354ea6ec01df3e7ba5b093d5c6e06179393)** to **[`d763d66`](https://github.com/sagemath/sagetrac-mirror/commit/d763d663355c4519128a616fb5f6ce7ebba2cfee)**



---

archive/issue_comments_518954.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@behackl](#comment:9):\n> 1. The new exceptions caused by ambiguously passing additional `growth` and `coefficient` keyword arguments should be tested.\n\nTested now. Indeed there was code, that could have never been reached. I think we should have full coverage now.\n\n> 2. Is there a particular reason for changing the implementation of `OTerm.can_absorb`?\n\nThis was the only place, where the `<=` of a term was used. However, I think it should be made clear what we compare here (\"explicit is better than implicit\"), so I switched to comparing the growth directly.\n\nThe reason for having `<=` (and method `le`) is for being compatible with SageMath's poset class in this perspective. If it wouldn't be for that, I would suggest to deprecate `<=` in the long run. However, as there is a reason for keeping it, I suggest to, at least, not use it further.\n\n> 3. The implementations of `TermWithCoefficientMonoid._convert_construction_` and `ExactTermMonoid._convert_construction_` are identical. I think the tests contained in the docstring of `ExactTermMonoid._convert_construction_` should be moved to `TermWithCoefficientMonoid._convert_construction_` and the separate implementation of `ExactTermMonoid._convert_construction_` should be removed.\n\nI disagree here. Usually I am in strong favour of removeing code duplicities, however, `_convert_construction_` is the one crucial method that all different terms (or their monoids, to be precise) have that do the conversion and making this conversion as explicit as possible helps understanding what is going on. I find it more of an incidient that two different type of terms have the same conversion.",
    "created_at": "2021-08-09T14:48:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518954",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@behackl](#comment:9):
> 1. The new exceptions caused by ambiguously passing additional `growth` and `coefficient` keyword arguments should be tested.

Tested now. Indeed there was code, that could have never been reached. I think we should have full coverage now.

> 2. Is there a particular reason for changing the implementation of `OTerm.can_absorb`?

This was the only place, where the `<=` of a term was used. However, I think it should be made clear what we compare here ("explicit is better than implicit"), so I switched to comparing the growth directly.

The reason for having `<=` (and method `le`) is for being compatible with SageMath's poset class in this perspective. If it wouldn't be for that, I would suggest to deprecate `<=` in the long run. However, as there is a reason for keeping it, I suggest to, at least, not use it further.

> 3. The implementations of `TermWithCoefficientMonoid._convert_construction_` and `ExactTermMonoid._convert_construction_` are identical. I think the tests contained in the docstring of `ExactTermMonoid._convert_construction_` should be moved to `TermWithCoefficientMonoid._convert_construction_` and the separate implementation of `ExactTermMonoid._convert_construction_` should be removed.

I disagree here. Usually I am in strong favour of removeing code duplicities, however, `_convert_construction_` is the one crucial method that all different terms (or their monoids, to be precise) have that do the conversion and making this conversion as explicit as possible helps understanding what is going on. I find it more of an incidient that two different type of terms have the same conversion.



---

archive/issue_events_441181.json:
```json
{
    "actor": "https://github.com/behackl",
    "created_at": "2021-08-09T16:22:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441181"
}
```



---

archive/issue_events_441182.json:
```json
{
    "actor": "https://github.com/behackl",
    "created_at": "2021-08-09T16:22:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441182"
}
```



---

archive/issue_comments_518955.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\n> I think we should have full coverage now.\n\nGreat, thanks!\n\n>  I would suggest to deprecate `<=` in the long run. However, as there is a reason for keeping it, I suggest to, at least, not use it further.\n\nAnother example of *spiritual deprecation*. +1.\n\n>  I find it more of an incidient that two different type of terms have the same conversion.\n\nOkay, good argument.\n\nThis LGTM now, thanks for your efforts!",
    "created_at": "2021-08-09T16:22:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518955",
    "user": "https://github.com/behackl"
}
```

<div id="comment:16" align="right">comment:16</div>

> I think we should have full coverage now.

Great, thanks!

>  I would suggest to deprecate `<=` in the long run. However, as there is a reason for keeping it, I suggest to, at least, not use it further.

Another example of *spiritual deprecation*. +1.

>  I find it more of an incidient that two different type of terms have the same conversion.

Okay, good argument.

This LGTM now, thanks for your efforts!



---

archive/issue_comments_518956.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI am not sure why the `deprecation_number` test in the most recent patchbot run failed though. The deprecation introduced here correctly uses 32215.",
    "created_at": "2021-08-09T16:47:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518956",
    "user": "https://github.com/behackl"
}
```

<div id="comment:17" align="right">comment:17</div>

I am not sure why the `deprecation_number` test in the most recent patchbot run failed though. The deprecation introduced here correctly uses 32215.



---

archive/issue_comments_518957.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/540d08880bdcc5fbda1b2487bce9c74d3d35f27c\"><code>540d088</code></a></td><td><code>Merge commit 'c11b2f4' into t/32215/refactor-element-construction-term-monoids</code></td></tr></table>\n",
    "created_at": "2021-08-09T20:47:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518957",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/540d08880bdcc5fbda1b2487bce9c74d3d35f27c"><code>540d088</code></a></td><td><code>Merge commit 'c11b2f4' into t/32215/refactor-element-construction-term-monoids</code></td></tr></table>




---

archive/issue_events_441183.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2021-08-09T20:47:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441183"
}
```



---

archive/issue_events_441184.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2021-08-09T20:47:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441184"
}
```



---

archive/issue_comments_518958.json:
```json
{
    "body": "Changed commit from **[`d763d66`](https://github.com/sagemath/sagetrac-mirror/commit/d763d663355c4519128a616fb5f6ce7ebba2cfee)** to **[`540d088`](https://github.com/sagemath/sagetrac-mirror/commit/540d08880bdcc5fbda1b2487bce9c74d3d35f27c)**",
    "created_at": "2021-08-09T20:47:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518958",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d763d66`](https://github.com/sagemath/sagetrac-mirror/commit/d763d663355c4519128a616fb5f6ce7ebba2cfee)** to **[`540d088`](https://github.com/sagemath/sagetrac-mirror/commit/540d08880bdcc5fbda1b2487bce9c74d3d35f27c)**



---

archive/issue_comments_518959.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/62cae10d33ab58abe5b2bbb2388adce8e01d1487\"><code>62cae10</code></a></td><td><code>Trac #32215: fix doctest after merge</code></td></tr></table>\n",
    "created_at": "2021-08-09T20:48:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518959",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/62cae10d33ab58abe5b2bbb2388adce8e01d1487"><code>62cae10</code></a></td><td><code>Trac #32215: fix doctest after merge</code></td></tr></table>




---

archive/issue_comments_518960.json:
```json
{
    "body": "Changed commit from **[`540d088`](https://github.com/sagemath/sagetrac-mirror/commit/540d08880bdcc5fbda1b2487bce9c74d3d35f27c)** to **[`62cae10`](https://github.com/sagemath/sagetrac-mirror/commit/62cae10d33ab58abe5b2bbb2388adce8e01d1487)**",
    "created_at": "2021-08-09T20:48:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518960",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`540d088`](https://github.com/sagemath/sagetrac-mirror/commit/540d08880bdcc5fbda1b2487bce9c74d3d35f27c)** to **[`62cae10`](https://github.com/sagemath/sagetrac-mirror/commit/62cae10d33ab58abe5b2bbb2388adce8e01d1487)**



---

archive/issue_comments_518961.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nMerged #32153 and fixed doctest. It's now on 9.4.beta4.",
    "created_at": "2021-08-09T20:49:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518961",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:20" align="right">comment:20</div>

Merged #32153 and fixed doctest. It's now on 9.4.beta4.



---

archive/issue_events_441185.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441185"
}
```



---

archive/issue_events_441186.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441186"
}
```



---

archive/issue_events_441187.json:
```json
{
    "actor": "https://github.com/behackl",
    "created_at": "2021-08-10T07:44:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441187"
}
```



---

archive/issue_events_441188.json:
```json
{
    "actor": "https://github.com/behackl",
    "created_at": "2021-08-10T07:44:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441188"
}
```



---

archive/issue_comments_518962.json:
```json
{
    "body": "Changed keywords from none to **gsoc2021**",
    "created_at": "2021-08-18T13:58:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518962",
    "user": "https://github.com/thhagelmayer"
}
```

Changed keywords from none to **gsoc2021**



---

archive/issue_comments_518963.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nMerge conflict",
    "created_at": "2021-08-30T22:47:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518963",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:24" align="right">comment:24</div>

Merge conflict



---

archive/issue_events_441189.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-08-30T22:47:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441189"
}
```



---

archive/issue_events_441190.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-08-30T22:47:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441190"
}
```



---

archive/issue_comments_518964.json:
```json
{
    "body": "Changed branch from **[u/dkrenn/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/refactor-element-construction-term-monoids)** to **[u/gh-thhagelmayer/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-thhagelmayer/refactor-element-construction-term-monoids)**",
    "created_at": "2021-09-15T15:29:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518964",
    "user": "https://github.com/thhagelmayer"
}
```

Changed branch from **[u/dkrenn/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/refactor-element-construction-term-monoids)** to **[u/gh-thhagelmayer/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-thhagelmayer/refactor-element-construction-term-monoids)**



---

archive/issue_comments_518965.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nI merged #31933 into this ticket and resolved the merge conflict.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2eb45dcd993194e9e5c262a5ef3e3d352666a2d\"><code>d2eb45d</code></a></td><td><code>Merge commit 'f631489' into t/32215/refactor-element-construction-term-monoids</code></td></tr></table>\n",
    "created_at": "2021-09-15T15:31:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518965",
    "user": "https://github.com/thhagelmayer"
}
```

<div id="comment:26" align="right">comment:26</div>

I merged #31933 into this ticket and resolved the merge conflict.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2eb45dcd993194e9e5c262a5ef3e3d352666a2d"><code>d2eb45d</code></a></td><td><code>Merge commit 'f631489' into t/32215/refactor-element-construction-term-monoids</code></td></tr></table>




---

archive/issue_comments_518966.json:
```json
{
    "body": "Changed commit from **[`62cae10`](https://github.com/sagemath/sagetrac-mirror/commit/62cae10d33ab58abe5b2bbb2388adce8e01d1487)** to **[`d2eb45d`](https://github.com/sagemath/sagetrac-mirror/commit/d2eb45dcd993194e9e5c262a5ef3e3d352666a2d)**",
    "created_at": "2021-09-15T15:31:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518966",
    "user": "https://github.com/thhagelmayer"
}
```

Changed commit from **[`62cae10`](https://github.com/sagemath/sagetrac-mirror/commit/62cae10d33ab58abe5b2bbb2388adce8e01d1487)** to **[`d2eb45d`](https://github.com/sagemath/sagetrac-mirror/commit/d2eb45dcd993194e9e5c262a5ef3e3d352666a2d)**



---

archive/issue_events_441191.json:
```json
{
    "actor": "https://github.com/thhagelmayer",
    "created_at": "2021-09-15T15:31:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441191"
}
```



---

archive/issue_events_441192.json:
```json
{
    "actor": "https://github.com/thhagelmayer",
    "created_at": "2021-09-15T15:31:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441192"
}
```



---

archive/issue_comments_518967.json:
```json
{
    "body": "<div id=\"comment:27\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5e9887771df00abbdf9827d8a46bf546721ac22b\"><code>5e98877</code></a></td><td><code>Restore files which have been accidentally removed in the last commit and prevented building sage.</code></td></tr></table>\n",
    "created_at": "2021-09-17T08:14:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518967",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5e9887771df00abbdf9827d8a46bf546721ac22b"><code>5e98877</code></a></td><td><code>Restore files which have been accidentally removed in the last commit and prevented building sage.</code></td></tr></table>




---

archive/issue_comments_518968.json:
```json
{
    "body": "Changed commit from **[`d2eb45d`](https://github.com/sagemath/sagetrac-mirror/commit/d2eb45dcd993194e9e5c262a5ef3e3d352666a2d)** to **[`5e98877`](https://github.com/sagemath/sagetrac-mirror/commit/5e9887771df00abbdf9827d8a46bf546721ac22b)**",
    "created_at": "2021-09-17T08:14:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518968",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d2eb45d`](https://github.com/sagemath/sagetrac-mirror/commit/d2eb45dcd993194e9e5c262a5ef3e3d352666a2d)** to **[`5e98877`](https://github.com/sagemath/sagetrac-mirror/commit/5e9887771df00abbdf9827d8a46bf546721ac22b)**



---

archive/issue_comments_518969.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6c3af69c70abfd729faa03b70f8d14f77ce16861\"><code>6c3af69</code></a></td><td><code>Merge commit 'f631489' into t/32215/refactor-element-construction-term-monoids</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dfd5ae49c72effc3d0811f84d9e7a9d346809933\"><code>dfd5ae4</code></a></td><td><code>Trac #32215: fix doctest after merge</code></td></tr></table>\n",
    "created_at": "2021-11-24T12:49:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518969",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6c3af69c70abfd729faa03b70f8d14f77ce16861"><code>6c3af69</code></a></td><td><code>Merge commit 'f631489' into t/32215/refactor-element-construction-term-monoids</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dfd5ae49c72effc3d0811f84d9e7a9d346809933"><code>dfd5ae4</code></a></td><td><code>Trac #32215: fix doctest after merge</code></td></tr></table>




---

archive/issue_comments_518970.json:
```json
{
    "body": "Changed commit from **[`5e98877`](https://github.com/sagemath/sagetrac-mirror/commit/5e9887771df00abbdf9827d8a46bf546721ac22b)** to **[`dfd5ae4`](https://github.com/sagemath/sagetrac-mirror/commit/dfd5ae49c72effc3d0811f84d9e7a9d346809933)**",
    "created_at": "2021-11-24T12:49:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518970",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5e98877`](https://github.com/sagemath/sagetrac-mirror/commit/5e9887771df00abbdf9827d8a46bf546721ac22b)** to **[`dfd5ae4`](https://github.com/sagemath/sagetrac-mirror/commit/dfd5ae49c72effc3d0811f84d9e7a9d346809933)**



---

archive/issue_comments_518971.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nSomwthing went wrong with the last push here, so I went back to the status of `u/dkrenn/refactor-element-construction-term-monoids` and redid the merge and fixed the doctests. There is still one doctest failing:\n\n\n```\nFile \"src/sage/rings/asymptotic/term_monoid.py\", line 4698, in sage.rings.asymptotic.term_monoid.BTerm.can_absorb\nFailed example:\n    t2.absorb(t1)\nExpected:\n    B(2003/400*x^3, x >= 20)\nGot:\n...\n    DeprecationWarning: Passing 'coefficient' as a positional argument is deprecated; specify it as keyword argument 'coefficient=...'.\n    See https://trac.sagemath.org/32215 for details.\n    B(2003/400*x^3, x >= 20)\n```",
    "created_at": "2021-11-24T12:52:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518971",
    "user": "https://github.com/thhagelmayer"
}
```

<div id="comment:29" align="right">comment:29</div>

Somwthing went wrong with the last push here, so I went back to the status of `u/dkrenn/refactor-element-construction-term-monoids` and redid the merge and fixed the doctests. There is still one doctest failing:


```
File "src/sage/rings/asymptotic/term_monoid.py", line 4698, in sage.rings.asymptotic.term_monoid.BTerm.can_absorb
Failed example:
    t2.absorb(t1)
Expected:
    B(2003/400*x^3, x >= 20)
Got:
...
    DeprecationWarning: Passing 'coefficient' as a positional argument is deprecated; specify it as keyword argument 'coefficient=...'.
    See https://trac.sagemath.org/32215 for details.
    B(2003/400*x^3, x >= 20)
```



---

archive/issue_comments_518972.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@thhagelmayer](#comment:29):\n> Somwthing went wrong with the last push here, so I went back to the status of `u/dkrenn/refactor-element-construction-term-monoids` and redid the merge and fixed the doctests. There is still one doctest failing:\n> \n> \n> ```\n> File \"src/sage/rings/asymptotic/term_monoid.py\", line 4698, in sage.rings.asymptotic.term_monoid.BTerm.can_absorb\n> Failed example:\n>     t2.absorb(t1)\n> Expected:\n>     B(2003/400*x^3, x >= 20)\n> Got:\n> ...\n>     DeprecationWarning: Passing 'coefficient' as a positional argument is deprecated; specify it as keyword argument 'coefficient=...'.\n>     See https://trac.sagemath.org/32215 for details.\n>     B(2003/400*x^3, x >= 20)\n> ```\n\nYes, this should be resolved as well: it comes from https://github.com/sagemath/sagetrac-mirror/blob/develop/src/sage/rings/asymptotic/term_monoid.py?id=683acc1eaa07fd3375bdd031516cfce30f1e363b#n4753, the coefficient should be passed via keyword argument.",
    "created_at": "2021-11-24T13:54:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518972",
    "user": "https://github.com/behackl"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@thhagelmayer](#comment:29):
> Somwthing went wrong with the last push here, so I went back to the status of `u/dkrenn/refactor-element-construction-term-monoids` and redid the merge and fixed the doctests. There is still one doctest failing:
> 
> 
> ```
> File "src/sage/rings/asymptotic/term_monoid.py", line 4698, in sage.rings.asymptotic.term_monoid.BTerm.can_absorb
> Failed example:
>     t2.absorb(t1)
> Expected:
>     B(2003/400*x^3, x >= 20)
> Got:
> ...
>     DeprecationWarning: Passing 'coefficient' as a positional argument is deprecated; specify it as keyword argument 'coefficient=...'.
>     See https://trac.sagemath.org/32215 for details.
>     B(2003/400*x^3, x >= 20)
> ```

Yes, this should be resolved as well: it comes from https://github.com/sagemath/sagetrac-mirror/blob/develop/src/sage/rings/asymptotic/term_monoid.py?id=683acc1eaa07fd3375bdd031516cfce30f1e363b#n4753, the coefficient should be passed via keyword argument.



---

archive/issue_comments_518973.json:
```json
{
    "body": "Changed commit from **[`dfd5ae4`](https://github.com/sagemath/sagetrac-mirror/commit/dfd5ae49c72effc3d0811f84d9e7a9d346809933)** to **[`7e7b5c7`](https://github.com/sagemath/sagetrac-mirror/commit/7e7b5c7bf93c713e3688a94ccb33561092556b83)**",
    "created_at": "2021-11-25T11:17:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518973",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`dfd5ae4`](https://github.com/sagemath/sagetrac-mirror/commit/dfd5ae49c72effc3d0811f84d9e7a9d346809933)** to **[`7e7b5c7`](https://github.com/sagemath/sagetrac-mirror/commit/7e7b5c7bf93c713e3688a94ccb33561092556b83)**



---

archive/issue_comments_518974.json:
```json
{
    "body": "<div id=\"comment:31\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7e7b5c7bf93c713e3688a94ccb33561092556b83\"><code>7e7b5c7</code></a></td><td><code>Trac #32215: fix a doctest. Use **kwds instead of coefficient</code></td></tr></table>\n",
    "created_at": "2021-11-25T11:17:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518974",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7e7b5c7bf93c713e3688a94ccb33561092556b83"><code>7e7b5c7</code></a></td><td><code>Trac #32215: fix a doctest. Use **kwds instead of coefficient</code></td></tr></table>




---

archive/issue_comments_518975.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nI fixed the doctest in [7e7b5c7](https://github.com/sagemath/sagetrac-mirror/commit/7e7b5c7bf93c713e3688a94ccb33561092556b83)",
    "created_at": "2021-11-25T11:23:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518975",
    "user": "https://github.com/thhagelmayer"
}
```

<div id="comment:32" align="right">comment:32</div>

I fixed the doctest in [7e7b5c7](https://github.com/sagemath/sagetrac-mirror/commit/7e7b5c7bf93c713e3688a94ccb33561092556b83)



---

archive/issue_comments_518976.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nI've managed to find the problem causing the `deprecation_number` plugin failure: looking at the implementation of the plugin over at https://github.com/sagemath/sage-patchbot/blob/745ec21b12f3bce03e8f1c8399cba0fb77bdc45c/sage_patchbot/plugins.py#L546, the plugin parses all *added* lines. If one of those contains `deprecation(` or `deprecated_function_alias(`, the code tries to parse the part following afterwards to find the ticket number, and then compares this parsed number to the actual ticket number.\n\nThe problem with our code is that we currently have\n\n```diff\n+            deprecation(\n+                32215,\n+                \"Passing 'coefficient' as a positional argument is deprecated; \"\n+                \"specify it as keyword argument 'coefficient=...'.\")\n```\nin our diff, so the code fails to properly parse the deprecation number. Changing this addition in `term_monoid.py` to\n\n```diff\n+            deprecation(32215,\n+                \"Passing 'coefficient' as a positional argument is deprecated; \"\n+                \"specify it as keyword argument 'coefficient=...'.\")\n```\nwill fix the failing test.",
    "created_at": "2021-11-25T20:28:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518976",
    "user": "https://github.com/behackl"
}
```

<div id="comment:33" align="right">comment:33</div>

I've managed to find the problem causing the `deprecation_number` plugin failure: looking at the implementation of the plugin over at https://github.com/sagemath/sage-patchbot/blob/745ec21b12f3bce03e8f1c8399cba0fb77bdc45c/sage_patchbot/plugins.py#L546, the plugin parses all *added* lines. If one of those contains `deprecation(` or `deprecated_function_alias(`, the code tries to parse the part following afterwards to find the ticket number, and then compares this parsed number to the actual ticket number.

The problem with our code is that we currently have

```diff
+            deprecation(
+                32215,
+                "Passing 'coefficient' as a positional argument is deprecated; "
+                "specify it as keyword argument 'coefficient=...'.")
```
in our diff, so the code fails to properly parse the deprecation number. Changing this addition in `term_monoid.py` to

```diff
+            deprecation(32215,
+                "Passing 'coefficient' as a positional argument is deprecated; "
+                "specify it as keyword argument 'coefficient=...'.")
```
will fix the failing test.



---

archive/issue_comments_518977.json:
```json
{
    "body": "Changed commit from **[`7e7b5c7`](https://github.com/sagemath/sagetrac-mirror/commit/7e7b5c7bf93c713e3688a94ccb33561092556b83)** to **[`89ad9d2`](https://github.com/sagemath/sagetrac-mirror/commit/89ad9d2cbd4aed3a7c0b1065766c03727c754e01)**",
    "created_at": "2021-11-26T10:57:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518977",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7e7b5c7`](https://github.com/sagemath/sagetrac-mirror/commit/7e7b5c7bf93c713e3688a94ccb33561092556b83)** to **[`89ad9d2`](https://github.com/sagemath/sagetrac-mirror/commit/89ad9d2cbd4aed3a7c0b1065766c03727c754e01)**



---

archive/issue_comments_518978.json:
```json
{
    "body": "<div id=\"comment:34\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/89ad9d2cbd4aed3a7c0b1065766c03727c754e01\"><code>89ad9d2</code></a></td><td><code>Trac #31125: fix deprecation plugin failure</code></td></tr></table>\n",
    "created_at": "2021-11-26T10:57:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518978",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/89ad9d2cbd4aed3a7c0b1065766c03727c754e01"><code>89ad9d2</code></a></td><td><code>Trac #31125: fix deprecation plugin failure</code></td></tr></table>




---

archive/issue_comments_518979.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nReplying to [@behackl](#comment:33):\n> I've managed to find the problem causing the `deprecation_number` plugin failure: looking at the implementation of the plugin over at https://github.com/sagemath/sage-patchbot/blob/745ec21b12f3bce03e8f1c8399cba0fb77bdc45c/sage_patchbot/plugins.py#L546, the plugin parses all *added* lines. If one of those contains `deprecation(` or `deprecated_function_alias(`, the code tries to parse the part following afterwards to find the ticket number, and then compares this parsed number to the actual ticket number.\n> \n> The problem with our code is that we currently have\n> \n> ```diff\n> +            deprecation(\n> +                32215,\n> +                \"Passing 'coefficient' as a positional argument is deprecated; \"\n> +                \"specify it as keyword argument 'coefficient=...'.\")\n> ```\n> in our diff, so the code fails to properly parse the deprecation number. Changing this addition in `term_monoid.py` to\n> \n> ```diff\n> +            deprecation(32215,\n> +                \"Passing 'coefficient' as a positional argument is deprecated; \"\n> +                \"specify it as keyword argument 'coefficient=...'.\")\n> ```\n> will fix the failing test.\n\nI changed that line accordingly.",
    "created_at": "2021-11-26T10:58:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518979",
    "user": "https://github.com/thhagelmayer"
}
```

<div id="comment:35" align="right">comment:35</div>

Replying to [@behackl](#comment:33):
> I've managed to find the problem causing the `deprecation_number` plugin failure: looking at the implementation of the plugin over at https://github.com/sagemath/sage-patchbot/blob/745ec21b12f3bce03e8f1c8399cba0fb77bdc45c/sage_patchbot/plugins.py#L546, the plugin parses all *added* lines. If one of those contains `deprecation(` or `deprecated_function_alias(`, the code tries to parse the part following afterwards to find the ticket number, and then compares this parsed number to the actual ticket number.
> 
> The problem with our code is that we currently have
> 
> ```diff
> +            deprecation(
> +                32215,
> +                "Passing 'coefficient' as a positional argument is deprecated; "
> +                "specify it as keyword argument 'coefficient=...'.")
> ```
> in our diff, so the code fails to properly parse the deprecation number. Changing this addition in `term_monoid.py` to
> 
> ```diff
> +            deprecation(32215,
> +                "Passing 'coefficient' as a positional argument is deprecated; "
> +                "specify it as keyword argument 'coefficient=...'.")
> ```
> will fix the failing test.

I changed that line accordingly.



---

archive/issue_events_441193.json:
```json
{
    "actor": "https://github.com/behackl",
    "created_at": "2021-12-01T09:36:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441193"
}
```



---

archive/issue_events_441194.json:
```json
{
    "actor": "https://github.com/behackl",
    "created_at": "2021-12-01T09:36:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441194"
}
```



---

archive/issue_comments_518980.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nThis seems fine to me now, thank you! The latest patchbot test failures seem unrelated.",
    "created_at": "2021-12-01T09:36:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518980",
    "user": "https://github.com/behackl"
}
```

<div id="comment:36" align="right">comment:36</div>

This seems fine to me now, thank you! The latest patchbot test failures seem unrelated.



---

archive/issue_events_441195.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-12-12T15:08:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441195"
}
```



---

archive/issue_events_441196.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "36135459d57177c9480eda0f779c0fb8650727be",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-12-12T15:08:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32215#event-441196"
}
```



---

archive/issue_comments_518981.json:
```json
{
    "body": "Changed branch from **[u/gh-thhagelmayer/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-thhagelmayer/refactor-element-construction-term-monoids)** to **[`89ad9d2`](https://github.com/sagemath/sagetrac-mirror/commit/89ad9d2cbd4aed3a7c0b1065766c03727c754e01)**",
    "created_at": "2021-12-12T15:08:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32215",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32215#issuecomment-518981",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/gh-thhagelmayer/refactor-element-construction-term-monoids](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-thhagelmayer/refactor-element-construction-term-monoids)** to **[`89ad9d2`](https://github.com/sagemath/sagetrac-mirror/commit/89ad9d2cbd4aed3a7c0b1065766c03727c754e01)**
