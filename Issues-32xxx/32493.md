# Issue 32493: Add missing dependencies for Python packages revealed by #32492

archive/issues_032256.json:
```json
{
    "body": "CC:  @dimpase\n\nAfter reinstalling the Python packages using the instructions shown in #32492:\n\n```\n$ grep -B2 -r \"Warning.*try.*no-deps\" logs/pkgs\nlogs/pkgs/html5lib-1.0.1.log-pip._internal.exceptions.DistributionNotFound: No matching distribution found for webencodings\nlogs/pkgs/html5lib-1.0.1.log-Removed build tracker: '/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-req-tracker-tafh_kg_'\nlogs/pkgs/html5lib-1.0.1.log:Warning: installing with \"python3 -m pip install --verbose --no-index --find-links=/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/venv-32492/var/lib/sage/wheels --disable-pip-version-check --isolated --no-cache-dir\" failed. Retrying, adding \"--no-deps --ignore-installed\"\n--\nlogs/pkgs/importlib_resources-5.1.4.log-pip._internal.exceptions.DistributionNotFound: No matching distribution found for zipp>=3.1.0; python_version < \"3.10\"\nlogs/pkgs/importlib_resources-5.1.4.log-Removed build tracker: '/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-req-tracker-3gqjedfc'\nlogs/pkgs/importlib_resources-5.1.4.log:Warning: installing with \"python3 -m pip install --verbose --no-index --find-links=/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/venv-32492/var/lib/sage/wheels --disable-pip-version-check --isolated --no-cache-dir\" failed. Retrying, adding \"--no-deps --ignore-installed\"\n--\nlogs/pkgs/bleach-3.1.5.log-pip._internal.exceptions.DistributionNotFound: No matching distribution found for packaging\nlogs/pkgs/bleach-3.1.5.log-Removed build tracker: '/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-req-tracker-v0hoaj95'\nlogs/pkgs/bleach-3.1.5.log:Warning: installing with \"python3 -m pip install --verbose --no-index --find-links=/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/venv-32492/var/lib/sage/wheels --disable-pip-version-check --isolated --no-cache-dir\" failed. Retrying, adding \"--no-deps --ignore-installed\"\n--\nlogs/pkgs/sagenb_export-3.3.log-pip._internal.exceptions.DistributionNotFound: No matching distribution found for notebook\nlogs/pkgs/sagenb_export-3.3.log-Removed build tracker: '/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-req-tracker-gz3vbd0n'\nlogs/pkgs/sagenb_export-3.3.log:Warning: installing with \"python3 -m pip install --verbose --no-index --find-links=/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/venv-32492/var/lib/sage/wheels --disable-pip-version-check --isolated --no-cache-dir\" failed. Retrying, adding \"--no-deps --ignore-installed\"\n```\n\nWith the Jupyter upgrade in #31280 merged, there are a few more. We fix them all.\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/32493\n\n",
    "closed_at": "2021-09-19T09:58:16Z",
    "created_at": "2021-09-08T19:39:28Z",
    "labels": [
        "component: build",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Add missing dependencies for Python packages revealed by #32492",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32493",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @dimpase

After reinstalling the Python packages using the instructions shown in #32492:

```
$ grep -B2 -r "Warning.*try.*no-deps" logs/pkgs
logs/pkgs/html5lib-1.0.1.log-pip._internal.exceptions.DistributionNotFound: No matching distribution found for webencodings
logs/pkgs/html5lib-1.0.1.log-Removed build tracker: '/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-req-tracker-tafh_kg_'
logs/pkgs/html5lib-1.0.1.log:Warning: installing with "python3 -m pip install --verbose --no-index --find-links=/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/venv-32492/var/lib/sage/wheels --disable-pip-version-check --isolated --no-cache-dir" failed. Retrying, adding "--no-deps --ignore-installed"
--
logs/pkgs/importlib_resources-5.1.4.log-pip._internal.exceptions.DistributionNotFound: No matching distribution found for zipp>=3.1.0; python_version < "3.10"
logs/pkgs/importlib_resources-5.1.4.log-Removed build tracker: '/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-req-tracker-3gqjedfc'
logs/pkgs/importlib_resources-5.1.4.log:Warning: installing with "python3 -m pip install --verbose --no-index --find-links=/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/venv-32492/var/lib/sage/wheels --disable-pip-version-check --isolated --no-cache-dir" failed. Retrying, adding "--no-deps --ignore-installed"
--
logs/pkgs/bleach-3.1.5.log-pip._internal.exceptions.DistributionNotFound: No matching distribution found for packaging
logs/pkgs/bleach-3.1.5.log-Removed build tracker: '/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-req-tracker-v0hoaj95'
logs/pkgs/bleach-3.1.5.log:Warning: installing with "python3 -m pip install --verbose --no-index --find-links=/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/venv-32492/var/lib/sage/wheels --disable-pip-version-check --isolated --no-cache-dir" failed. Retrying, adding "--no-deps --ignore-installed"
--
logs/pkgs/sagenb_export-3.3.log-pip._internal.exceptions.DistributionNotFound: No matching distribution found for notebook
logs/pkgs/sagenb_export-3.3.log-Removed build tracker: '/private/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/pip-req-tracker-gz3vbd0n'
logs/pkgs/sagenb_export-3.3.log:Warning: installing with "python3 -m pip install --verbose --no-index --find-links=/Users/mkoeppe/s/sage/sage-rebasing/worktree-rebase/venv-32492/var/lib/sage/wheels --disable-pip-version-check --isolated --no-cache-dir" failed. Retrying, adding "--no-deps --ignore-installed"
```

With the Jupyter upgrade in #31280 merged, there are a few more. We fix them all.


Issue created by migration from https://trac.sagemath.org/ticket/32493





---

archive/issue_comments_460030.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-09T03:10:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32493#issuecomment-460030",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_460031.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-09-09T03:22:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32493#issuecomment-460031",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_460032.json:
```json
{
    "body": "Tested now with #32492 using `make -j50`.",
    "created_at": "2021-09-09T03:22:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32493#issuecomment-460032",
    "user": "https://github.com/mkoeppe"
}
```

Tested now with #32492 using `make -j50`.



---

archive/issue_comments_460033.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-09T04:47:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32493#issuecomment-460033",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_460034.json:
```json
{
    "body": "how about\n\n```diff\n--- a/build/pkgs/ipykernel/dependencies\n+++ b/build/pkgs/ipykernel/dependencies\n@@ -1,4 +1,4 @@\n-$(PYTHON) | ipython jupyter_client $(PYTHON_TOOLCHAIN) scandir\n+$(PYTHON) | ipython jupyter_client $(PYTHON_TOOLCHAIN) scandir debugpy\n \n ----------\n All lines of this file are ignored except the first.\n```",
    "created_at": "2021-09-09T10:57:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32493#issuecomment-460034",
    "user": "https://github.com/dimpase"
}
```

how about

```diff
--- a/build/pkgs/ipykernel/dependencies
+++ b/build/pkgs/ipykernel/dependencies
@@ -1,4 +1,4 @@
-$(PYTHON) | ipython jupyter_client $(PYTHON_TOOLCHAIN) scandir
+$(PYTHON) | ipython jupyter_client $(PYTHON_TOOLCHAIN) scandir debugpy
 
 ----------
 All lines of this file are ignored except the first.
```



---

archive/issue_comments_460035.json:
```json
{
    "body": "Replying to [comment:9 dimpase]:\n> how about\n> \n> ```diff\n> --- a/build/pkgs/ipykernel/dependencies\n> +++ b/build/pkgs/ipykernel/dependencies\n> @@ -1,4 +1,4 @@\n> -$(PYTHON) | ipython jupyter_client $(PYTHON_TOOLCHAIN) scandir\n> +$(PYTHON) | ipython jupyter_client $(PYTHON_TOOLCHAIN) scandir debugpy\n>  \n>  ----------\n>  All lines of this file are ignored except the first.\n> ```\n\n\noops, OK, that was  already in.",
    "created_at": "2021-09-09T12:19:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32493#issuecomment-460035",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:9 dimpase]:
> how about
> 
> ```diff
> --- a/build/pkgs/ipykernel/dependencies
> +++ b/build/pkgs/ipykernel/dependencies
> @@ -1,4 +1,4 @@
> -$(PYTHON) | ipython jupyter_client $(PYTHON_TOOLCHAIN) scandir
> +$(PYTHON) | ipython jupyter_client $(PYTHON_TOOLCHAIN) scandir debugpy
>  
>  ----------
>  All lines of this file are ignored except the first.
> ```


oops, OK, that was  already in.



---

archive/issue_comments_460036.json:
```json
{
    "body": "Perhaps a separate issue but html docs for `9.5.beta1` will not build without `debugpy`.\n\n```\ncd /local/sage-git/sage && ./sage --docbuild --no-pdf-links reference/repl inventory --no-prune-empty-dirs\nWarning: Could not import sage.repl.ipython_kernel.kernel No module named 'debugpy'\n[repl     ] building [inventory]: targets for 36 source files that are out of date\n[repl     ] updating environment: [new config] 36 added, 0 changed, 0 removed\n[repl     ] WARNING: autodoc: failed to import module 'kernel' from module 'sage.repl.ipython_kernel'; the following exception was raised:\n[repl     ] No module named 'debugpy'\n[repl     ] The inventory files are in local/share/doc/sage/inventory/en/reference/repl.\nError building the documentation.\n```\nand\n\n```\nsage: from sage.repl.ipython_kernel import kernel\n---------------------------------------------------------------------------\nModuleNotFoundError                       Traceback (most recent call last)\n<ipython-input-1-ae6dbb0420a7> in <module>\n----> 1 from sage.repl.ipython_kernel import kernel\n\n/local/sage-git/sage/local/lib/python3.9/site-packages/sage/repl/ipython_kernel/kernel.py in <module>\n     17 \n     18 import sys\n---> 19 from ipykernel.ipkernel import IPythonKernel\n     20 from ipykernel.zmqshell import ZMQInteractiveShell\n     21 from traitlets import Type\n\n/local/sage-git/sage/local/lib/python3.9/site-packages/ipykernel/ipkernel.py in <module>\n     18 from .zmqshell import ZMQInteractiveShell\n     19 from .eventloops import _use_appnope\n---> 20 from .debugger import Debugger\n     21 from .compiler import XCachingCompiler\n     22 \n\n/local/sage-git/sage/local/lib/python3.9/site-packages/ipykernel/debugger.py in <module>\n     15 \n     16 # This import is required to have the next ones working...\n---> 17 from debugpy.server import api\n     18 from _pydevd_bundle import pydevd_frame_utils\n     19 from _pydevd_bundle.pydevd_suspended_frames import SuspendedFramesManager, _FramesTracker\n\nModuleNotFoundError: No module named 'debugpy'\n```",
    "created_at": "2021-09-14T04:27:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32493#issuecomment-460036",
    "user": "https://github.com/strogdon"
}
```

Perhaps a separate issue but html docs for `9.5.beta1` will not build without `debugpy`.

```
cd /local/sage-git/sage && ./sage --docbuild --no-pdf-links reference/repl inventory --no-prune-empty-dirs
Warning: Could not import sage.repl.ipython_kernel.kernel No module named 'debugpy'
[repl     ] building [inventory]: targets for 36 source files that are out of date
[repl     ] updating environment: [new config] 36 added, 0 changed, 0 removed
[repl     ] WARNING: autodoc: failed to import module 'kernel' from module 'sage.repl.ipython_kernel'; the following exception was raised:
[repl     ] No module named 'debugpy'
[repl     ] The inventory files are in local/share/doc/sage/inventory/en/reference/repl.
Error building the documentation.
```
and

```
sage: from sage.repl.ipython_kernel import kernel
---------------------------------------------------------------------------
ModuleNotFoundError                       Traceback (most recent call last)
<ipython-input-1-ae6dbb0420a7> in <module>
----> 1 from sage.repl.ipython_kernel import kernel

/local/sage-git/sage/local/lib/python3.9/site-packages/sage/repl/ipython_kernel/kernel.py in <module>
     17 
     18 import sys
---> 19 from ipykernel.ipkernel import IPythonKernel
     20 from ipykernel.zmqshell import ZMQInteractiveShell
     21 from traitlets import Type

/local/sage-git/sage/local/lib/python3.9/site-packages/ipykernel/ipkernel.py in <module>
     18 from .zmqshell import ZMQInteractiveShell
     19 from .eventloops import _use_appnope
---> 20 from .debugger import Debugger
     21 from .compiler import XCachingCompiler
     22 

/local/sage-git/sage/local/lib/python3.9/site-packages/ipykernel/debugger.py in <module>
     15 
     16 # This import is required to have the next ones working...
---> 17 from debugpy.server import api
     18 from _pydevd_bundle import pydevd_frame_utils
     19 from _pydevd_bundle.pydevd_suspended_frames import SuspendedFramesManager, _FramesTracker

ModuleNotFoundError: No module named 'debugpy'
```



---

archive/issue_comments_460037.json:
```json
{
    "body": "Same issue, fixed by this ticket. Needs review",
    "created_at": "2021-09-14T04:37:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32493#issuecomment-460037",
    "user": "https://github.com/mkoeppe"
}
```

Same issue, fixed by this ticket. Needs review



---

archive/issue_comments_460038.json:
```json
{
    "body": "Replying to [comment:12 mkoeppe]:\n> Same issue, fixed by this ticket. Needs review\n\nThe updated dependencies for `ipykernel` do allow the docs to build.",
    "created_at": "2021-09-14T05:48:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32493#issuecomment-460038",
    "user": "https://github.com/strogdon"
}
```

Replying to [comment:12 mkoeppe]:
> Same issue, fixed by this ticket. Needs review

The updated dependencies for `ipykernel` do allow the docs to build.



---

archive/issue_comments_460039.json:
```json
{
    "body": "lgtm",
    "created_at": "2021-09-14T09:35:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32493#issuecomment-460039",
    "user": "https://github.com/dimpase"
}
```

lgtm



---

archive/issue_comments_460040.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-09-14T09:35:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32493#issuecomment-460040",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_460041.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-09-19T09:58:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32493#issuecomment-460041",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_086190.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-09-19T09:58:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32493",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32493#event-86190"
}
```
