# Issue 32001: Upgrade: Singular 4.2.1

archive/issues_031764.json:
```json
{
    "body": "released 2021-06-09\n\nPrevious update: #31642 (4.2.0p3)\n\n\n**CC:**  @kiwifb @mkoeppe @orlitzky\n\n**Keywords:** upgrade, singular\n\n**Branch/Commit:** [0629663729a077dc9b703566514321aeb4ba9058](https://github.com/sagemath/sagetrac-mirror/commit/0629663729a077dc9b703566514321aeb4ba9058)\n\n**Reviewer:** Matthias Koeppe\n\n**Author:** Samuel Leli\u00e8vre\n\nIssue created by migration from https://trac.sagemath.org/ticket/32001\n\n",
    "closed_at": "2021-08-29T09:36:18Z",
    "created_at": "2021-06-18T06:20:26Z",
    "labels": [
        "component: packages: standard",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "title": "Upgrade: Singular 4.2.1",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/32001",
    "user": "https://github.com/mkoeppe"
}
```
released 2021-06-09

Previous update: #31642 (4.2.0p3)


**CC:**  @kiwifb @mkoeppe @orlitzky

**Keywords:** upgrade, singular

**Branch/Commit:** [0629663729a077dc9b703566514321aeb4ba9058](https://github.com/sagemath/sagetrac-mirror/commit/0629663729a077dc9b703566514321aeb4ba9058)

**Reviewer:** Matthias Koeppe

**Author:** Samuel Lelièvre

Issue created by migration from https://trac.sagemath.org/ticket/32001





---

archive/issue_comments_517921.json:
```json
{
    "body": "<a id='comment:1'></a>\nThis will need careful checking in particular on Cygwin.\nIt appears that the last update to 4.2.0p3 broke Cygwin again - https://github.com/mkoeppe/sage/runs/2909494587?check_suite_focus=true\n\n```\n [pynac-0.7.27.p8]   /usr/lib/gcc/x86_64-pc-cygwin/10/../../../../x86_64-pc-cygwin/bin/ld: .libs/libpynac_la-mpoly-singular.o:/opt/sage-a9c3c18820b8c96cd2336b90dc480417eaefd6d6/var/tmp/sage/build/pynac-0.7.27.p8/src/ginac/mpoly-singular.cpp:110: undefined reference to `operator-(CanonicalForm const&)'\n  [pynac-0.7.27.p8]   /usr/lib/gcc/x86_64-pc-cygwin/10/../../../../x86_64-pc-cygwin/bin/ld: .libs/libpynac_la-mpoly-singular.o: in function `num2canonical':\n  [pynac-0.7.27.p8]   /opt/sage-a9c3c18820b8c96cd2336b90dc480417eaefd6d6/var/tmp/sage/build/pynac-0.7.27.p8/src/ginac/mpoly-singular.cpp:94: undefined reference to `operator-(CanonicalForm const&)'\n  [pynac-0.7.27.p8]   /usr/lib/gcc/x86_64-pc-cygwin/10/../../../../x86_64-pc-cygwin/bin/ld: /opt/sage-a9c3c18820b8c96cd2336b90dc480417eaefd6d6/var/tmp/sage/build/pynac-0.7.27.p8/src/ginac/mpoly-singular.cpp:104: undefined reference to `operator-(CanonicalForm const&)'\n  [pynac-0.7.27.p8]   collect2: error: ld returned 1 exit status\n  [pynac-0.7.27.p8]   make[5]: *** [Makefile:560: libpynac.la] Error 1\n  [pynac-0.7.27.p8]   make[5]: Target 'all' not remade because of errors.\n  [pynac-0.7.27.p8]   make[4]: *** [Makefile:495: all-recursive] Error 1\n  [pynac-0.7.27.p8]   make[3]: *** [Makefile:402: all] Error 2\n  [pynac-0.7.27.p8]   ********************************************************************************\n```\n\n(this is #32156)",
    "created_at": "2021-06-25T04:07:40Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517921",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'></a>
This will need careful checking in particular on Cygwin.
It appears that the last update to 4.2.0p3 broke Cygwin again - https://github.com/mkoeppe/sage/runs/2909494587?check_suite_focus=true

```
 [pynac-0.7.27.p8]   /usr/lib/gcc/x86_64-pc-cygwin/10/../../../../x86_64-pc-cygwin/bin/ld: .libs/libpynac_la-mpoly-singular.o:/opt/sage-a9c3c18820b8c96cd2336b90dc480417eaefd6d6/var/tmp/sage/build/pynac-0.7.27.p8/src/ginac/mpoly-singular.cpp:110: undefined reference to `operator-(CanonicalForm const&)'
  [pynac-0.7.27.p8]   /usr/lib/gcc/x86_64-pc-cygwin/10/../../../../x86_64-pc-cygwin/bin/ld: .libs/libpynac_la-mpoly-singular.o: in function `num2canonical':
  [pynac-0.7.27.p8]   /opt/sage-a9c3c18820b8c96cd2336b90dc480417eaefd6d6/var/tmp/sage/build/pynac-0.7.27.p8/src/ginac/mpoly-singular.cpp:94: undefined reference to `operator-(CanonicalForm const&)'
  [pynac-0.7.27.p8]   /usr/lib/gcc/x86_64-pc-cygwin/10/../../../../x86_64-pc-cygwin/bin/ld: /opt/sage-a9c3c18820b8c96cd2336b90dc480417eaefd6d6/var/tmp/sage/build/pynac-0.7.27.p8/src/ginac/mpoly-singular.cpp:104: undefined reference to `operator-(CanonicalForm const&)'
  [pynac-0.7.27.p8]   collect2: error: ld returned 1 exit status
  [pynac-0.7.27.p8]   make[5]: *** [Makefile:560: libpynac.la] Error 1
  [pynac-0.7.27.p8]   make[5]: Target 'all' not remade because of errors.
  [pynac-0.7.27.p8]   make[4]: *** [Makefile:495: all-recursive] Error 1
  [pynac-0.7.27.p8]   make[3]: *** [Makefile:402: all] Error 2
  [pynac-0.7.27.p8]   ********************************************************************************
```

(this is #32156)



---

archive/issue_comments_517922.json:
```json
{
    "body": "<a id='comment:3'></a>\nWhere to download the sources from? There seems to be two options:\n\n- https://github.com/Singular/Singular/releases/tag/Release-4-2-1\n- ftp://jim.mathematik.uni-kl.de/pub/Math/Singular/SOURCES/",
    "created_at": "2021-07-11T22:38:35Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517922",
    "user": "https://github.com/slel"
}
```

<a id='comment:3'></a>
Where to download the sources from? There seems to be two options:

- https://github.com/Singular/Singular/releases/tag/Release-4-2-1
- ftp://jim.mathematik.uni-kl.de/pub/Math/Singular/SOURCES/



---

archive/issue_comments_517923.json:
```json
{
    "body": "<a id='comment:4'></a>\nUsually the ftp has a complete dist tarball while github just have the source (not autoconf generated), although I haven't checked lately.",
    "created_at": "2021-07-11T22:40:26Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517923",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'></a>
Usually the ftp has a complete dist tarball while github just have the source (not autoconf generated), although I haven't checked lately.



---

archive/issue_comments_517924.json:
```json
{
    "body": "<a id='comment:5'></a>\nGitHub seems to have only the GitHub's automatically generated tarballs.",
    "created_at": "2021-07-18T09:57:13Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517924",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>
GitHub seems to have only the GitHub's automatically generated tarballs.



---

archive/issue_comments_517925.json:
```json
{
    "body": "**Author:** Samuel Leli\u00e8vre",
    "created_at": "2021-07-18T19:01:34Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517925",
    "user": "https://github.com/slel"
}
```

**Author:** Samuel Lelièvre



---

archive/issue_comments_517926.json:
```json
{
    "body": "**Branch:** [u/slelievre/32001](https://github.com/sagemath/sagetrac-mirror/tree/u/slelievre/32001)",
    "created_at": "2021-07-18T19:01:34Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517926",
    "user": "https://github.com/slel"
}
```

**Branch:** [u/slelievre/32001](https://github.com/sagemath/sagetrac-mirror/tree/u/slelievre/32001)



---

archive/issue_comments_517927.json:
```json
{
    "body": "**Commit:** [e45bdf77e6c30c2e45bbfbaae384f4dad8f92349](https://github.com/sagemath/sagetrac-mirror/commit/e45bdf77e6c30c2e45bbfbaae384f4dad8f92349)",
    "created_at": "2021-07-18T19:01:34Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517927",
    "user": "https://github.com/slel"
}
```

**Commit:** [e45bdf77e6c30c2e45bbfbaae384f4dad8f92349](https://github.com/sagemath/sagetrac-mirror/commit/e45bdf77e6c30c2e45bbfbaae384f4dad8f92349)



---

archive/issue_events_287416.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-07-18T19:01:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32001#event-287416"
}
```



---

archive/issue_comments_517928.json:
```json
{
    "body": "<a id='comment:6'></a>\nThis branch passes testlong on Debian.\n\n(Except one test in `src/sage/modular/local_comp/local_comp.py`\nwhich has a hotfix in #29977 and is the object of #32134.)\n\nLaunching GitHub actions on this would be useful.\n\nI've pushed a branch to my fork on [GitHub](GitHub):\n\n- https://github.com/slel/sage/tree/32001\n\nbut I don't remember if that's enough to launch tests\non multiple platforms. I can see\n\n- https://github.com/slel/sage/actions/runs/1042993351\n\nwhich indicates linting tests have failed (unsurprisingly\nas linting the whole Sage code base is work in progress);\ndoes that block further tests from running?\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e45bdf77e6c30c2e45bbfbaae384f4dad8f92349\">e45bdf7</a></td><td><code>32001: Upgrade: Singular 4.2.1</code></td></tr></table>\n",
    "created_at": "2021-07-18T19:01:34Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517928",
    "user": "https://github.com/slel"
}
```

<a id='comment:6'></a>
This branch passes testlong on Debian.

(Except one test in `src/sage/modular/local_comp/local_comp.py`
which has a hotfix in #29977 and is the object of #32134.)

Launching GitHub actions on this would be useful.

I've pushed a branch to my fork on [GitHub](GitHub):

- https://github.com/slel/sage/tree/32001

but I don't remember if that's enough to launch tests
on multiple platforms. I can see

- https://github.com/slel/sage/actions/runs/1042993351

which indicates linting tests have failed (unsurprisingly
as linting the whole Sage code base is work in progress);
does that block further tests from running?

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e45bdf77e6c30c2e45bbfbaae384f4dad8f92349">e45bdf7</a></td><td><code>32001: Upgrade: Singular 4.2.1</code></td></tr></table>




---

archive/issue_comments_517929.json:
```json
{
    "body": "<a id='comment:7'></a>\nyou need to choose TOX workflow by Actions\nand pick the branch to test manually",
    "created_at": "2021-07-18T19:09:19Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517929",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>
you need to choose TOX workflow by Actions
and pick the branch to test manually



---

archive/issue_comments_517930.json:
```json
{
    "body": "<a id='comment:8'></a>\n... or push a tag.",
    "created_at": "2021-07-18T19:09:39Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517930",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
... or push a tag.



---

archive/issue_comments_517931.json:
```json
{
    "body": "<a id='comment:9'></a>\nThanks for the reminder. I pushed tag 32001,\nwhich launched some bots.\n\n- https://github.com/slel/sage/actions",
    "created_at": "2021-07-20T00:03:36Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517931",
    "user": "https://github.com/slel"
}
```

<a id='comment:9'></a>
Thanks for the reminder. I pushed tag 32001,
which launched some bots.

- https://github.com/slel/sage/actions



---

archive/issue_comments_517932.json:
```json
{
    "body": "<a id='comment:10'></a>\nA new trouble with GH Actions, not enough disk space:\n\n```\n[sagelib-9.4.beta4]   build/cythonized/sage/ext/interpreters/wrapper_rdf.c:9127:1: fatal error: error writing to /tmp/ccRPWbhl.s: No space left on device\n```\n\n:-( (that's on Ubuntu 20.04)",
    "created_at": "2021-07-20T10:01:42Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517932",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>
A new trouble with GH Actions, not enough disk space:

```
[sagelib-9.4.beta4]   build/cythonized/sage/ext/interpreters/wrapper_rdf.c:9127:1: fatal error: error writing to /tmp/ccRPWbhl.s: No space left on device
```

:-( (that's on Ubuntu 20.04)



---

archive/issue_comments_517933.json:
```json
{
    "body": "<a id='comment:11'></a>\nThe pynac failure on `cygwin-standard` is unfortunately still there with this update https://github.com/slel/sage/runs/3114171604?check_suite_focus=true",
    "created_at": "2021-07-21T00:11:04Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517933",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
The pynac failure on `cygwin-standard` is unfortunately still there with this update https://github.com/slel/sage/runs/3114171604?check_suite_focus=true



---

archive/issue_events_287417.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-21T03:10:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32001#event-287417"
}
```



---

archive/issue_events_287418.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-21T03:10:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32001#event-287418"
}
```



---

archive/issue_comments_517934.json:
```json
{
    "body": "<a id='comment:13'></a>\nAdding #32257 as a dependency as it makes this work on Cygwin.",
    "created_at": "2021-07-22T05:25:21Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517934",
    "user": "https://github.com/slel"
}
```

<a id='comment:13'></a>
Adding #32257 as a dependency as it makes this work on Cygwin.



---

archive/issue_comments_517935.json:
```json
{
    "body": "**Dependencies:** #32257",
    "created_at": "2021-07-22T05:25:21Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517935",
    "user": "https://github.com/slel"
}
```

**Dependencies:** #32257



---

archive/issue_comments_517936.json:
```json
{
    "body": "<a id='comment:14'></a>\nAnother round of GH Actions on top of 9.4.beta5 + #32257 would be good",
    "created_at": "2021-07-22T15:55:41Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517936",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>
Another round of GH Actions on top of 9.4.beta5 + #32257 would be good



---

archive/issue_comments_517937.json:
```json
{
    "body": "**Changing commit** from \"[e45bdf77e6c30c2e45bbfbaae384f4dad8f92349](https://github.com/sagemath/sagetrac-mirror/commit/e45bdf77e6c30c2e45bbfbaae384f4dad8f92349)\" to \"[9a73ab2b9c25530dece180cad372666a28088922](https://github.com/sagemath/sagetrac-mirror/commit/9a73ab2b9c25530dece180cad372666a28088922)\".",
    "created_at": "2021-07-22T17:11:31Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517937",
    "user": "https://github.com/slel"
}
```

**Changing commit** from "[e45bdf77e6c30c2e45bbfbaae384f4dad8f92349](https://github.com/sagemath/sagetrac-mirror/commit/e45bdf77e6c30c2e45bbfbaae384f4dad8f92349)" to "[9a73ab2b9c25530dece180cad372666a28088922](https://github.com/sagemath/sagetrac-mirror/commit/9a73ab2b9c25530dece180cad372666a28088922)".



---

archive/issue_comments_517938.json:
```json
{
    "body": "**Changing branch** from \"[u/slelievre/32001](https://github.com/sagemath/sagetrac-mirror/tree/u/slelievre/32001)\" to \"[public/32001](https://github.com/sagemath/sagetrac-mirror/tree/public/32001)\".",
    "created_at": "2021-07-22T17:11:31Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517938",
    "user": "https://github.com/slel"
}
```

**Changing branch** from "[u/slelievre/32001](https://github.com/sagemath/sagetrac-mirror/tree/u/slelievre/32001)" to "[public/32001](https://github.com/sagemath/sagetrac-mirror/tree/public/32001)".



---

archive/issue_comments_517939.json:
```json
{
    "body": "<a id='comment:15'></a>\nRebased on #32257.\n\nPushed tag ci-32001 to launch a new round of gh-actions.\n\nhttps://github.com/slel/sage/actions\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d4156f754ca211962bd58057a547a1c726d60e33\">d4156f7</a></td><td><code>build/pkgs/singular/patches/0001-factory-canonicalform.h-Add-more-FACTORY_PUBLIC.patch: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a73ab2b9c25530dece180cad372666a28088922\">9a73ab2</a></td><td><code>32001: Upgrade: Singular 4.2.1</code></td></tr></table>\n",
    "created_at": "2021-07-22T17:11:31Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517939",
    "user": "https://github.com/slel"
}
```

<a id='comment:15'></a>
Rebased on #32257.

Pushed tag ci-32001 to launch a new round of gh-actions.

https://github.com/slel/sage/actions

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d4156f754ca211962bd58057a547a1c726d60e33">d4156f7</a></td><td><code>build/pkgs/singular/patches/0001-factory-canonicalform.h-Add-more-FACTORY_PUBLIC.patch: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a73ab2b9c25530dece180cad372666a28088922">9a73ab2</a></td><td><code>32001: Upgrade: Singular 4.2.1</code></td></tr></table>




---

archive/issue_comments_517940.json:
```json
{
    "body": "<a id='comment:16'></a>\nSome github-actions workflows are running out of disk space.\n\nhttps://github.com/slel/sage/actions?query=branch%3Aci-32001",
    "created_at": "2021-07-24T08:24:42Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517940",
    "user": "https://github.com/slel"
}
```

<a id='comment:16'></a>
Some github-actions workflows are running out of disk space.

https://github.com/slel/sage/actions?query=branch%3Aci-32001



---

archive/issue_comments_517941.json:
```json
{
    "body": "<a id='comment:17'></a>\nperhaps one can try this: https://github.com/easimon/maximize-build-space",
    "created_at": "2021-07-24T21:40:46Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517941",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:17'></a>
perhaps one can try this: https://github.com/easimon/maximize-build-space



---

archive/issue_comments_517942.json:
```json
{
    "body": "**Changing commit** from \"[9a73ab2b9c25530dece180cad372666a28088922](https://github.com/sagemath/sagetrac-mirror/commit/9a73ab2b9c25530dece180cad372666a28088922)\" to \"[367618cfd6f836c4d880520fe58401bc5ea73941](https://github.com/sagemath/sagetrac-mirror/commit/367618cfd6f836c4d880520fe58401bc5ea73941)\".",
    "created_at": "2021-07-25T12:20:10Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517942",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9a73ab2b9c25530dece180cad372666a28088922](https://github.com/sagemath/sagetrac-mirror/commit/9a73ab2b9c25530dece180cad372666a28088922)" to "[367618cfd6f836c4d880520fe58401bc5ea73941](https://github.com/sagemath/sagetrac-mirror/commit/367618cfd6f836c4d880520fe58401bc5ea73941)".



---

archive/issue_comments_517943.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/367618cfd6f836c4d880520fe58401bc5ea73941\">367618c</a></td><td><code>32001: Upgrade: Singular 4.2.1</code></td></tr></table>\n",
    "created_at": "2021-07-25T12:20:10Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517943",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/367618cfd6f836c4d880520fe58401bc5ea73941">367618c</a></td><td><code>32001: Upgrade: Singular 4.2.1</code></td></tr></table>




---

archive/issue_comments_517944.json:
```json
{
    "body": "<a id='comment:19'></a>\nRebased on Sage 9.4.beta6. Pushed tag to run github-actions at:\n\nhttps://github.com/slel/sage/actions?query=branch:ci-s94b6-32001",
    "created_at": "2021-07-25T12:22:14Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517944",
    "user": "https://github.com/slel"
}
```

<a id='comment:19'></a>
Rebased on Sage 9.4.beta6. Pushed tag to run github-actions at:

https://github.com/slel/sage/actions?query=branch:ci-s94b6-32001



---

archive/issue_comments_517945.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [dimpase](#comment%3A17):\n> perhaps one can try this: https://github.com/easimon/maximize-build-space\n\nThanks for the pointer, looks promising.\n\nMeanwhile, successfully ran `make -s V=0 ptestlong` on macOS and Debian.",
    "created_at": "2021-07-26T00:16:55Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517945",
    "user": "https://github.com/slel"
}
```

<a id='comment:20'></a>
Replying to [dimpase](#comment%3A17):
> perhaps one can try this: https://github.com/easimon/maximize-build-space

Thanks for the pointer, looks promising.

Meanwhile, successfully ran `make -s V=0 ptestlong` on macOS and Debian.



---

archive/issue_comments_517946.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [slelievre](#comment%3A19):\n> Rebased on Sage 9.4.beta6. Pushed tag to run github-actions at:\n> \n> https://github.com/slel/sage/actions?query=branch:ci-s94b6-32001\n\nBut `sci-mathematics/singular-4.2.1` is already installed in gentoo image. \nI expected to see\n\n```\nconfigure: will use system package and not install SPKG singular\n```",
    "created_at": "2021-07-27T05:27:12Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517946",
    "user": "https://github.com/sheerluck"
}
```

<a id='comment:21'></a>
Replying to [slelievre](#comment%3A19):
> Rebased on Sage 9.4.beta6. Pushed tag to run github-actions at:
> 
> https://github.com/slel/sage/actions?query=branch:ci-s94b6-32001

But `sci-mathematics/singular-4.2.1` is already installed in gentoo image. 
I expected to see

```
configure: will use system package and not install SPKG singular
```



---

archive/issue_comments_517947.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [gh-sheerluck](#comment%3A21):\n> Replying to [slelievre](#comment%3A19):\n> > Rebased on Sage 9.4.beta6. Pushed tag to run github-actions at:\n> > \n> > https://github.com/slel/sage/actions?query=branch:ci-s94b6-32001\n\n> But `sci-mathematics/singular-4.2.1` is already installed in gentoo image. \n> I expected to see\n> \n> ```\n> configure: will use system package and not install SPKG singular\n> ```\n\nthis won't happen until #29024 is done. \n\nYou can try putting\nhttps://github.com/sagemath/sage/files/ticket29024/spkg-configure.m4\ninto build/pkgs/singular/spkg-configure.m4\nand run ./bootstrap\n(then, assuming Singular is known to pkg-config, it might work...)",
    "created_at": "2021-07-27T09:02:52Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517947",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:22'></a>
Replying to [gh-sheerluck](#comment%3A21):
> Replying to [slelievre](#comment%3A19):
> > Rebased on Sage 9.4.beta6. Pushed tag to run github-actions at:
> > 
> > https://github.com/slel/sage/actions?query=branch:ci-s94b6-32001

> But `sci-mathematics/singular-4.2.1` is already installed in gentoo image. 
> I expected to see
> 
> ```
> configure: will use system package and not install SPKG singular
> ```

this won't happen until #29024 is done. 

You can try putting
https://github.com/sagemath/sage/files/ticket29024/spkg-configure.m4
into build/pkgs/singular/spkg-configure.m4
and run ./bootstrap
(then, assuming Singular is known to pkg-config, it might work...)



---

archive/issue_comments_517948.json:
```json
{
    "body": "<a id='comment:23'></a>\nmay we please also fix the following cython warning:\n\n```diff\ndiff --git a/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx b/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx\nindex b043ce719a..ec706f3129 100644\n--- a/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx\n+++ b/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx\n@@ -3181,7 +3181,8 @@ cdef class MPolynomial_libsingular(MPolynomial):\n         cdef ring *_ring = parent._ring\n         if _ring != currRing: rChangeCurrRing(_ring)\n         base = parent._base\n-        cdef poly *t, *p = p_Copy(self._poly, _ring)\n+        cdef poly *t\n+        cdef poly *p = p_Copy(self._poly, _ring)\n \n         while p:\n             t = pNext(p)\n```",
    "created_at": "2021-07-31T09:15:48Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517948",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:23'></a>
may we please also fix the following cython warning:

```diff
diff --git a/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx b/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx
index b043ce719a..ec706f3129 100644
--- a/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx
+++ b/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx
@@ -3181,7 +3181,8 @@ cdef class MPolynomial_libsingular(MPolynomial):
         cdef ring *_ring = parent._ring
         if _ring != currRing: rChangeCurrRing(_ring)
         base = parent._base
-        cdef poly *t, *p = p_Copy(self._poly, _ring)
+        cdef poly *t
+        cdef poly *p = p_Copy(self._poly, _ring)
 
         while p:
             t = pNext(p)
```



---

archive/issue_comments_517949.json:
```json
{
    "body": "**Changing commit** from \"[367618cfd6f836c4d880520fe58401bc5ea73941](https://github.com/sagemath/sagetrac-mirror/commit/367618cfd6f836c4d880520fe58401bc5ea73941)\" to \"[0629663729a077dc9b703566514321aeb4ba9058](https://github.com/sagemath/sagetrac-mirror/commit/0629663729a077dc9b703566514321aeb4ba9058)\".",
    "created_at": "2021-07-31T12:26:03Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517949",
    "user": "https://github.com/slel"
}
```

**Changing commit** from "[367618cfd6f836c4d880520fe58401bc5ea73941](https://github.com/sagemath/sagetrac-mirror/commit/367618cfd6f836c4d880520fe58401bc5ea73941)" to "[0629663729a077dc9b703566514321aeb4ba9058](https://github.com/sagemath/sagetrac-mirror/commit/0629663729a077dc9b703566514321aeb4ba9058)".



---

archive/issue_comments_517950.json:
```json
{
    "body": "**Changing branch** from \"[public/32001](https://github.com/sagemath/sagetrac-mirror/tree/public/32001)\" to \"[u/slelievre/32001-a](https://github.com/sagemath/sagetrac-mirror/tree/u/slelievre/32001-a)\".",
    "created_at": "2021-07-31T12:26:03Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517950",
    "user": "https://github.com/slel"
}
```

**Changing branch** from "[public/32001](https://github.com/sagemath/sagetrac-mirror/tree/public/32001)" to "[u/slelievre/32001-a](https://github.com/sagemath/sagetrac-mirror/tree/u/slelievre/32001-a)".



---

archive/issue_events_287419.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-07-31T12:26:03Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "rename": {
        "from": "Singular update: 4.2.1",
        "to": "Upgrade: Singular 4.2.1"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32001#event-287419"
}
```



---

archive/issue_comments_517951.json:
```json
{
    "body": "<a id='comment:24'></a>\nRebased on Sage 9.4.rc0. Fixed Cython warning as requested.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2abd30761ee9e31b8f6780763d02912a00d531d8\">2abd307</a></td><td><code>32001: Upgrade: Singular 4.2.1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0629663729a077dc9b703566514321aeb4ba9058\">0629663</a></td><td><code>32001: Fix Cython warning in multi_polynomial_libsingular.pyx</code></td></tr></table>\n",
    "created_at": "2021-07-31T12:26:03Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517951",
    "user": "https://github.com/slel"
}
```

<a id='comment:24'></a>
Rebased on Sage 9.4.rc0. Fixed Cython warning as requested.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2abd30761ee9e31b8f6780763d02912a00d531d8">2abd307</a></td><td><code>32001: Upgrade: Singular 4.2.1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0629663729a077dc9b703566514321aeb4ba9058">0629663</a></td><td><code>32001: Fix Cython warning in multi_polynomial_libsingular.pyx</code></td></tr></table>




---

archive/issue_comments_517952.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"upgrade, singular\".",
    "created_at": "2021-07-31T12:26:03Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517952",
    "user": "https://github.com/slel"
}
```

**Changing keywords** from "" to "upgrade, singular".



---

archive/issue_comments_517953.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [chapoton](#comment%3A23):\n> may we please also fix the following cython warning:\n\nI think it is poor practice to put unrelated changes on an update ticket. It just adds ambiguity for packagers.",
    "created_at": "2021-08-01T21:15:38Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517953",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>
Replying to [chapoton](#comment%3A23):
> may we please also fix the following cython warning:

I think it is poor practice to put unrelated changes on an update ticket. It just adds ambiguity for packagers.



---

archive/issue_comments_517954.json:
```json
{
    "body": "<a id='comment:26'></a>\nAs noted in #32323, the file `singular.idx` is not getting installed (neither before nor after this upgrade). This is an issue both in upstream and our fallback docbuild (which only makes `singular.hlp`)",
    "created_at": "2021-08-01T22:12:57Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517954",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>
As noted in #32323, the file `singular.idx` is not getting installed (neither before nor after this upgrade). This is an issue both in upstream and our fallback docbuild (which only makes `singular.hlp`)



---

archive/issue_comments_517955.json:
```json
{
    "body": "<a id='comment:27'></a>\nSeveral of the GH Actions tests failed with:\n\n```\n  [singular-4.2.1]   Attempting to download from ftp://jim.mathematik.uni-kl.de/pub/Math/Singular/SOURCES/4-2-1/singular-4.2.1.tar.gz\n  [singular-4.2.1]   [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]\n  [singular-4.2.1]   ERROR [transfer|run:135]: [Errno ftp error] 550 Failed to change directory.\n  [singular-4.2.1]   ************************************************************************\n  [singular-4.2.1]   Traceback (most recent call last):\n  [singular-4.2.1]     File \"/sage/build/bin/../sage_bootstrap/download/cmdline.py\", line 126, in run_safe\n```\nThis may have been caused by an intermittent server error",
    "created_at": "2021-08-01T22:47:26Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517955",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>
Several of the GH Actions tests failed with:

```
  [singular-4.2.1]   Attempting to download from ftp://jim.mathematik.uni-kl.de/pub/Math/Singular/SOURCES/4-2-1/singular-4.2.1.tar.gz
  [singular-4.2.1]   [xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx]
  [singular-4.2.1]   ERROR [transfer|run:135]: [Errno ftp error] 550 Failed to change directory.
  [singular-4.2.1]   ************************************************************************
  [singular-4.2.1]   Traceback (most recent call last):
  [singular-4.2.1]     File "/sage/build/bin/../sage_bootstrap/download/cmdline.py", line 126, in run_safe
```
This may have been caused by an intermittent server error



---

archive/issue_comments_517956.json:
```json
{
    "body": "**Reviewer:** Matthias Koeppe",
    "created_at": "2021-08-01T22:49:53Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517956",
    "user": "https://github.com/mkoeppe"
}
```

**Reviewer:** Matthias Koeppe



---

archive/issue_comments_517957.json:
```json
{
    "body": "<a id='comment:28'></a>\nThe tests that went through look fine, including Cygwin.\n\nThanks for preparing this upgrade!",
    "created_at": "2021-08-01T22:49:53Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517957",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:28'></a>
The tests that went through look fine, including Cygwin.

Thanks for preparing this upgrade!



---

archive/issue_comments_517958.json:
```json
{
    "body": "**Changing dependencies** from \"#32257\" to \"\".",
    "created_at": "2021-08-01T22:49:53Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517958",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#32257" to "".



---

archive/issue_events_287420.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-01T22:49:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32001#event-287420"
}
```



---

archive/issue_events_287421.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-01T22:49:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32001#event-287421"
}
```



---

archive/issue_comments_517959.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [mkoeppe](#comment%3A25):\n> Replying to [chapoton](#comment%3A23):\n> > may we please also fix the following cython warning:\n\n> \n> I think it is poor practice to put unrelated changes on an update ticket. It just adds ambiguity for packagers.\n\nLet me know if I should split that off to a separate ticket.",
    "created_at": "2021-08-02T12:40:19Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517959",
    "user": "https://github.com/slel"
}
```

<a id='comment:29'></a>
Replying to [mkoeppe](#comment%3A25):
> Replying to [chapoton](#comment%3A23):
> > may we please also fix the following cython warning:

> 
> I think it is poor practice to put unrelated changes on an update ticket. It just adds ambiguity for packagers.

Let me know if I should split that off to a separate ticket.



---

archive/issue_events_287422.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-08-29T09:36:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32001#event-287422"
}
```



---

archive/issue_events_287423.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "f1f5c24b5b8f89a5cd719825c14853fdc39c1509",
    "created_at": "2021-08-29T09:36:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32001#event-287423"
}
```



---

archive/issue_comments_517960.json:
```json
{
    "body": "**Changing branch** from \"[u/slelievre/32001-a](https://github.com/sagemath/sagetrac-mirror/tree/u/slelievre/32001-a)\" to \"[0629663729a077dc9b703566514321aeb4ba9058](https://github.com/sagemath/sagetrac-mirror/commit/0629663729a077dc9b703566514321aeb4ba9058)\".",
    "created_at": "2021-08-29T09:36:18Z",
    "issue": "https://github.com/sagemath/sage/issues/32001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32001#issuecomment-517960",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/slelievre/32001-a](https://github.com/sagemath/sagetrac-mirror/tree/u/slelievre/32001-a)" to "[0629663729a077dc9b703566514321aeb4ba9058](https://github.com/sagemath/sagetrac-mirror/commit/0629663729a077dc9b703566514321aeb4ba9058)".
