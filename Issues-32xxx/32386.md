# Issue 32386: Merge pynac sources as src/sage/symbolic/ginac

archive/issues_032149.json:
```json
{
    "body": "Pynac has a compile-time dependency on the Python library but is not installed using Python package infrastructure. This is problematic because Python users cannot install it using standard Python tools - for example for testing different Python versions.\n\nPynac has no other uses than as the core of the symbolic expressions facility of Sage; and cannot even be tested without Sage.\n\nWe merge Pynac (i.e., the directory https://github.com/pynac/pynac/tree/master/ginac) into the Sage library as `src/sage/symbolic/ginac`. It is not a very big package - one flat directory with 100 *.h and *.cpp files, a total of 50kLOC. (The existing !Python/Cython symbolics code in `sage.symbolic`, `sage.calculus`, `sage.functions` is about 60kLOC.)\n\nThe Pynac sources are compiled like other C++ sources that are already in the Sage source tree. They are linked into a single Python extension module, `sage.symbolic.expression`. All other extension modules that used to link to pynac (`sage.libs.pynac.pynac`, `sage.symbolic.function`, `sage.symbolic.series` etc.) are \n- either refactored so that they only `import` helper functions provided by `sage.symbolic.expression` instead of having to `cimport` Pynac functions directly (see #32391, #32407)\n- or merged into the extension module `sage.symbolic.expression` (via Cython `include` statements, not by copy-paste of source code, to keep the diff small)\n\nThis solves the same issues that #30534 tried to address, which ran into unresolved technical difficulties.\n\nIt will also make it easier for Sage developers to make changes to Pynac and the related symbolic implementation.\n\nFollow-up: #32387 Remove pynac spkg\n\n\nDepends on #32391\n\nDepends on #32407\n\nDepends on #32461\n\n**CC:**  @kliem @kiwifb @antonio-rojas @DaveWitteMorris @slel @dimpase @tscrim @egourgoulhon @nbruin\n\n**Branch:** [0d0b58f65c0ca01d51756798d6910efb5f26f47c](https://github.com/sagemath/sagetrac-mirror/commit/0d0b58f65c0ca01d51756798d6910efb5f26f47c)\n\n**Reviewer:** Dima Pasechnik\n\n**Author:** Matthias Koeppe, Jonathan Kliem\n\nIssue created by migration from https://trac.sagemath.org/ticket/32386\n\n",
    "closed_at": "2021-09-15T22:06:00Z",
    "created_at": "2021-08-16T17:27:13Z",
    "labels": [
        "component: symbolics",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "title": "Merge pynac sources as src/sage/symbolic/ginac",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/32386",
    "user": "https://github.com/mkoeppe"
}
```
Pynac has a compile-time dependency on the Python library but is not installed using Python package infrastructure. This is problematic because Python users cannot install it using standard Python tools - for example for testing different Python versions.

Pynac has no other uses than as the core of the symbolic expressions facility of Sage; and cannot even be tested without Sage.

We merge Pynac (i.e., the directory https://github.com/pynac/pynac/tree/master/ginac) into the Sage library as `src/sage/symbolic/ginac`. It is not a very big package - one flat directory with 100 *.h and *.cpp files, a total of 50kLOC. (The existing !Python/Cython symbolics code in `sage.symbolic`, `sage.calculus`, `sage.functions` is about 60kLOC.)

The Pynac sources are compiled like other C++ sources that are already in the Sage source tree. They are linked into a single Python extension module, `sage.symbolic.expression`. All other extension modules that used to link to pynac (`sage.libs.pynac.pynac`, `sage.symbolic.function`, `sage.symbolic.series` etc.) are 
- either refactored so that they only `import` helper functions provided by `sage.symbolic.expression` instead of having to `cimport` Pynac functions directly (see #32391, #32407)
- or merged into the extension module `sage.symbolic.expression` (via Cython `include` statements, not by copy-paste of source code, to keep the diff small)

This solves the same issues that #30534 tried to address, which ran into unresolved technical difficulties.

It will also make it easier for Sage developers to make changes to Pynac and the related symbolic implementation.

Follow-up: #32387 Remove pynac spkg


Depends on #32391

Depends on #32407

Depends on #32461

**CC:**  @kliem @kiwifb @antonio-rojas @DaveWitteMorris @slel @dimpase @tscrim @egourgoulhon @nbruin

**Branch:** [0d0b58f65c0ca01d51756798d6910efb5f26f47c](https://github.com/sagemath/sagetrac-mirror/commit/0d0b58f65c0ca01d51756798d6910efb5f26f47c)

**Reviewer:** Dima Pasechnik

**Author:** Matthias Koeppe, Jonathan Kliem

Issue created by migration from https://trac.sagemath.org/ticket/32386





---

archive/issue_events_291143.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-16T17:29:42Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "rename": {
        "from": "Merge pynac as src/sage/symbolics/ginac",
        "to": "Merge pynac as src/sage/symbolic/ginac"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291143"
}
```



---

archive/issue_comments_524730.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,7 +2,7 @@\n \n Pynac has no other uses than as the core of the symbolic expressions facility of Sage; and cannot even be tested without Sage.\n \n-We merge Pynac (i.e., the directory https://github.com/pynac/pynac/tree/master/ginac) into the Sage library as `src/sage/symbolics/ginac`. It is not a very big package - one flat directory with 100 *.h and *.cpp files, a total of 50kLOC.\n+We merge Pynac (i.e., the directory https://github.com/pynac/pynac/tree/master/ginac) into the Sage library as `src/sage/symbolic/ginac`. It is not a very big package - one flat directory with 100 *.h and *.cpp files, a total of 50kLOC.\n \n This will solve the same issues that #30534 tried to address, which ran into unresolved technical difficulties.\n \n``````\n",
    "created_at": "2021-08-16T17:29:42Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524730",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,7 +2,7 @@
 
 Pynac has no other uses than as the core of the symbolic expressions facility of Sage; and cannot even be tested without Sage.
 
-We merge Pynac (i.e., the directory https://github.com/pynac/pynac/tree/master/ginac) into the Sage library as `src/sage/symbolics/ginac`. It is not a very big package - one flat directory with 100 *.h and *.cpp files, a total of 50kLOC.
+We merge Pynac (i.e., the directory https://github.com/pynac/pynac/tree/master/ginac) into the Sage library as `src/sage/symbolic/ginac`. It is not a very big package - one flat directory with 100 *.h and *.cpp files, a total of 50kLOC.
 
 This will solve the same issues that #30534 tried to address, which ran into unresolved technical difficulties.
 
``````




---

archive/issue_comments_524731.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)",
    "created_at": "2021-08-16T18:15:48Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524731",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)



---

archive/issue_comments_524732.json:
```json
{
    "body": "<a id='comment:3'></a>\nI ran `git filter-branch -f --tree-filter 'rm -f Makefile.am; mkdir -p src/sage/symbolic/ginac; mv *.* src/sage/symbolic/ginac/; :' -- --all` on pynac 0.7.29 and merged it here, thus preserving the relevant history\n\n---\n**Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f3bb79f5091e83ed2deaeda9e9a987bdd5ef6362\">f3bb79f</a></td><td><code>Merge pull request #374 from slel/fix-exp-inv-hyp</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a99791b4f688cbc5823cbd8a056639be7135b48f\">a99791b</a></td><td><code>apply patches from #31479 and #31554</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/91cb6facf1b5400012ab58fd979d774f5404e1d8\">91cb6fa</a></td><td><code>apply trac 31869 fix pynac integer_content</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d96393c301bf5017c25ec2a730b3a07fd7e98f65\">d96393c</a></td><td><code>apply trac 30688 patch infinite loop in pynac</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/80269c5c31192031523a33caaaefe711b665325f\">80269c5</a></td><td><code>apply trac 31645 handling of constant term in series</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4caca2e1b843d3f1cec4b3c52fe52775a51a1855\">4caca2e</a></td><td><code>apply trac 31530 patch pynac power::subs</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cba9038d840ea2fb4340ecb571b45a414aea497c\">cba9038</a></td><td><code>trac 31585 32-bit overflow</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8acb54803fc18bec2a1e6d81090b8555161661be\">8acb548</a></td><td><code>also fix /=</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f2040c84015675749e0eaf626367cb05377ae086\">f2040c8</a></td><td><code>ginac/numeric.cpp: Only use builtin for smull_overflow if supported by the compiler</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e43830d72c9a45a60f9959fe8a0bbb43f8d39256\">e43830d</a></td><td><code>Merge remote-tracking branch 'pynac-filtered/master' into t/32386/merge_pynac_as_src_sage_symbolic_ginac</code></td></tr></table>\n",
    "created_at": "2021-08-16T18:17:19Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524732",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>
I ran `git filter-branch -f --tree-filter 'rm -f Makefile.am; mkdir -p src/sage/symbolic/ginac; mv *.* src/sage/symbolic/ginac/; :' -- --all` on pynac 0.7.29 and merged it here, thus preserving the relevant history

---
**Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f3bb79f5091e83ed2deaeda9e9a987bdd5ef6362">f3bb79f</a></td><td><code>Merge pull request #374 from slel/fix-exp-inv-hyp</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a99791b4f688cbc5823cbd8a056639be7135b48f">a99791b</a></td><td><code>apply patches from #31479 and #31554</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/91cb6facf1b5400012ab58fd979d774f5404e1d8">91cb6fa</a></td><td><code>apply trac 31869 fix pynac integer_content</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d96393c301bf5017c25ec2a730b3a07fd7e98f65">d96393c</a></td><td><code>apply trac 30688 patch infinite loop in pynac</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/80269c5c31192031523a33caaaefe711b665325f">80269c5</a></td><td><code>apply trac 31645 handling of constant term in series</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4caca2e1b843d3f1cec4b3c52fe52775a51a1855">4caca2e</a></td><td><code>apply trac 31530 patch pynac power::subs</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cba9038d840ea2fb4340ecb571b45a414aea497c">cba9038</a></td><td><code>trac 31585 32-bit overflow</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8acb54803fc18bec2a1e6d81090b8555161661be">8acb548</a></td><td><code>also fix /=</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f2040c84015675749e0eaf626367cb05377ae086">f2040c8</a></td><td><code>ginac/numeric.cpp: Only use builtin for smull_overflow if supported by the compiler</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e43830d72c9a45a60f9959fe8a0bbb43f8d39256">e43830d</a></td><td><code>Merge remote-tracking branch 'pynac-filtered/master' into t/32386/merge_pynac_as_src_sage_symbolic_ginac</code></td></tr></table>




---

archive/issue_comments_524733.json:
```json
{
    "body": "**Commit:** [e43830d72c9a45a60f9959fe8a0bbb43f8d39256](https://github.com/sagemath/sagetrac-mirror/commit/e43830d72c9a45a60f9959fe8a0bbb43f8d39256)",
    "created_at": "2021-08-16T18:17:19Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524733",
    "user": "https://github.com/mkoeppe"
}
```

**Commit:** [e43830d72c9a45a60f9959fe8a0bbb43f8d39256](https://github.com/sagemath/sagetrac-mirror/commit/e43830d72c9a45a60f9959fe8a0bbb43f8d39256)



---

archive/issue_comments_524734.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2bbf412594790a63b81855f9f5d467c98e4b3a54\">2bbf412</a></td><td><code>build/pkgs/pynac: Remove</code></td></tr></table>\n",
    "created_at": "2021-08-16T18:29:14Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524734",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2bbf412594790a63b81855f9f5d467c98e4b3a54">2bbf412</a></td><td><code>build/pkgs/pynac: Remove</code></td></tr></table>




---

archive/issue_comments_524735.json:
```json
{
    "body": "**Changing commit** from \"[e43830d72c9a45a60f9959fe8a0bbb43f8d39256](https://github.com/sagemath/sagetrac-mirror/commit/e43830d72c9a45a60f9959fe8a0bbb43f8d39256)\" to \"[2bbf412594790a63b81855f9f5d467c98e4b3a54](https://github.com/sagemath/sagetrac-mirror/commit/2bbf412594790a63b81855f9f5d467c98e4b3a54)\".",
    "created_at": "2021-08-16T18:29:14Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524735",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e43830d72c9a45a60f9959fe8a0bbb43f8d39256](https://github.com/sagemath/sagetrac-mirror/commit/e43830d72c9a45a60f9959fe8a0bbb43f8d39256)" to "[2bbf412594790a63b81855f9f5d467c98e4b3a54](https://github.com/sagemath/sagetrac-mirror/commit/2bbf412594790a63b81855f9f5d467c98e4b3a54)".



---

archive/issue_comments_524736.json:
```json
{
    "body": "<a id='comment:5'></a>\nNext: Move stuff from `sage.libs.pynac` to `sage.symbolic.ginac`, leaving some deprecated reimports behind. \n\nHelp from Cython experts very welcome...",
    "created_at": "2021-08-16T18:32:07Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524736",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
Next: Move stuff from `sage.libs.pynac` to `sage.symbolic.ginac`, leaving some deprecated reimports behind. 

Help from Cython experts very welcome...



---

archive/issue_comments_524737.json:
```json
{
    "body": "**Changing commit** from \"[2bbf412594790a63b81855f9f5d467c98e4b3a54](https://github.com/sagemath/sagetrac-mirror/commit/2bbf412594790a63b81855f9f5d467c98e4b3a54)\" to \"[e693827e4e554469a35b62ba0c9e68f2a24d3503](https://github.com/sagemath/sagetrac-mirror/commit/e693827e4e554469a35b62ba0c9e68f2a24d3503)\".",
    "created_at": "2021-08-16T19:16:28Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524737",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[2bbf412594790a63b81855f9f5d467c98e4b3a54](https://github.com/sagemath/sagetrac-mirror/commit/2bbf412594790a63b81855f9f5d467c98e4b3a54)" to "[e693827e4e554469a35b62ba0c9e68f2a24d3503](https://github.com/sagemath/sagetrac-mirror/commit/e693827e4e554469a35b62ba0c9e68f2a24d3503)".



---

archive/issue_comments_524738.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e693827e4e554469a35b62ba0c9e68f2a24d3503\">e693827</a></td><td><code>Move stuff from sage.libs.pynac to sage.symbolic.ginac, leaving some deprecated reimports behind</code></td></tr></table>\n",
    "created_at": "2021-08-16T19:16:28Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524738",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e693827e4e554469a35b62ba0c9e68f2a24d3503">e693827</a></td><td><code>Move stuff from sage.libs.pynac to sage.symbolic.ginac, leaving some deprecated reimports behind</code></td></tr></table>




---

archive/issue_comments_524739.json:
```json
{
    "body": "**Changing commit** from \"[e693827e4e554469a35b62ba0c9e68f2a24d3503](https://github.com/sagemath/sagetrac-mirror/commit/e693827e4e554469a35b62ba0c9e68f2a24d3503)\" to \"[0581bac4e5cae56162ef7ff2bb55081434054414](https://github.com/sagemath/sagetrac-mirror/commit/0581bac4e5cae56162ef7ff2bb55081434054414)\".",
    "created_at": "2021-08-16T19:30:37Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524739",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e693827e4e554469a35b62ba0c9e68f2a24d3503](https://github.com/sagemath/sagetrac-mirror/commit/e693827e4e554469a35b62ba0c9e68f2a24d3503)" to "[0581bac4e5cae56162ef7ff2bb55081434054414](https://github.com/sagemath/sagetrac-mirror/commit/0581bac4e5cae56162ef7ff2bb55081434054414)".



---

archive/issue_comments_524740.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0bfc24f9f91043a0066b412c2e3dd1c2cab7d2de\">0bfc24f</a></td><td><code>src/sage/symbolic/ginac/version.h.in: Remove</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0581bac4e5cae56162ef7ff2bb55081434054414\">0581bac</a></td><td><code>src/sage/symbolic/ginac/pynac-config.h: New</code></td></tr></table>\n",
    "created_at": "2021-08-16T19:30:37Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524740",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0bfc24f9f91043a0066b412c2e3dd1c2cab7d2de">0bfc24f</a></td><td><code>src/sage/symbolic/ginac/version.h.in: Remove</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0581bac4e5cae56162ef7ff2bb55081434054414">0581bac</a></td><td><code>src/sage/symbolic/ginac/pynac-config.h: New</code></td></tr></table>




---

archive/issue_comments_524741.json:
```json
{
    "body": "<a id='comment:8'></a>\nThis version compiles OK",
    "created_at": "2021-08-16T19:31:59Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524741",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
This version compiles OK



---

archive/issue_events_291144.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-16T19:32:21Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "rename": {
        "from": "Merge pynac as src/sage/symbolic/ginac",
        "to": "Merge pynac sources as src/sage/symbolic/ginac"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291144"
}
```



---

archive/issue_comments_524742.json:
```json
{
    "body": "**Author:** Matthias Koeppe",
    "created_at": "2021-08-16T19:32:21Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524742",
    "user": "https://github.com/mkoeppe"
}
```

**Author:** Matthias Koeppe



---

archive/issue_comments_524743.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/496102dbdf8ac4c03c7ce417e267ef4d64b023f2\">496102d</a></td><td><code>src/sage/symbolic/ginac/utils.h, pynac-config.h: Eliminate use of PYNAC_SIZEOF_LONG, PYNAC_SIZEOF_LONG_LONG</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc29c1de46013777a5e4e2b592b9e0e0cf3e21d0\">fc29c1d</a></td><td><code>src/sage/symbolic/pynac.pyx, pynac.pxd: Fixup distutils: sources</code></td></tr></table>\n",
    "created_at": "2021-08-16T20:02:49Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524743",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/496102dbdf8ac4c03c7ce417e267ef4d64b023f2">496102d</a></td><td><code>src/sage/symbolic/ginac/utils.h, pynac-config.h: Eliminate use of PYNAC_SIZEOF_LONG, PYNAC_SIZEOF_LONG_LONG</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc29c1de46013777a5e4e2b592b9e0e0cf3e21d0">fc29c1d</a></td><td><code>src/sage/symbolic/pynac.pyx, pynac.pxd: Fixup distutils: sources</code></td></tr></table>




---

archive/issue_comments_524744.json:
```json
{
    "body": "**Changing commit** from \"[0581bac4e5cae56162ef7ff2bb55081434054414](https://github.com/sagemath/sagetrac-mirror/commit/0581bac4e5cae56162ef7ff2bb55081434054414)\" to \"[fc29c1de46013777a5e4e2b592b9e0e0cf3e21d0](https://github.com/sagemath/sagetrac-mirror/commit/fc29c1de46013777a5e4e2b592b9e0e0cf3e21d0)\".",
    "created_at": "2021-08-16T20:02:49Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524744",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0581bac4e5cae56162ef7ff2bb55081434054414](https://github.com/sagemath/sagetrac-mirror/commit/0581bac4e5cae56162ef7ff2bb55081434054414)" to "[fc29c1de46013777a5e4e2b592b9e0e0cf3e21d0](https://github.com/sagemath/sagetrac-mirror/commit/fc29c1de46013777a5e4e2b592b9e0e0cf3e21d0)".



---

archive/issue_comments_524745.json:
```json
{
    "body": "<a id='comment:11'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8223127e18030e663830e60b04c61f8d8f737f2d\">8223127</a></td><td><code>src/sage/symbolic/ginac/utils.h: Fixup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/add5e891706dd779b6129cea0e8dc175c3c48054\">add5e89</a></td><td><code>src/sage/symbolic/ginac/utils.cpp: Fixup removal of version.h</code></td></tr></table>\n",
    "created_at": "2021-08-16T20:11:13Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524745",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8223127e18030e663830e60b04c61f8d8f737f2d">8223127</a></td><td><code>src/sage/symbolic/ginac/utils.h: Fixup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/add5e891706dd779b6129cea0e8dc175c3c48054">add5e89</a></td><td><code>src/sage/symbolic/ginac/utils.cpp: Fixup removal of version.h</code></td></tr></table>




---

archive/issue_comments_524746.json:
```json
{
    "body": "**Changing commit** from \"[fc29c1de46013777a5e4e2b592b9e0e0cf3e21d0](https://github.com/sagemath/sagetrac-mirror/commit/fc29c1de46013777a5e4e2b592b9e0e0cf3e21d0)\" to \"[add5e891706dd779b6129cea0e8dc175c3c48054](https://github.com/sagemath/sagetrac-mirror/commit/add5e891706dd779b6129cea0e8dc175c3c48054)\".",
    "created_at": "2021-08-16T20:11:13Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524746",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[fc29c1de46013777a5e4e2b592b9e0e0cf3e21d0](https://github.com/sagemath/sagetrac-mirror/commit/fc29c1de46013777a5e4e2b592b9e0e0cf3e21d0)" to "[add5e891706dd779b6129cea0e8dc175c3c48054](https://github.com/sagemath/sagetrac-mirror/commit/add5e891706dd779b6129cea0e8dc175c3c48054)".



---

archive/issue_events_291145.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-16T20:17:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291145"
}
```



---

archive/issue_comments_524747.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,7 +2,7 @@\n \n Pynac has no other uses than as the core of the symbolic expressions facility of Sage; and cannot even be tested without Sage.\n \n-We merge Pynac (i.e., the directory https://github.com/pynac/pynac/tree/master/ginac) into the Sage library as `src/sage/symbolic/ginac`. It is not a very big package - one flat directory with 100 *.h and *.cpp files, a total of 50kLOC.\n+We merge Pynac (i.e., the directory https://github.com/pynac/pynac/tree/master/ginac) into the Sage library as `src/sage/symbolic/ginac`. It is not a very big package - one flat directory with 100 *.h and *.cpp files, a total of 50kLOC. (The existing Python/Cython symbolics code in `sage.symbolic`, `sage.calculus`, `sage.functions` is about 60kLOC.)\n \n This will solve the same issues that #30534 tried to address, which ran into unresolved technical difficulties.\n \n``````\n",
    "created_at": "2021-08-16T20:52:11Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524747",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,7 +2,7 @@
 
 Pynac has no other uses than as the core of the symbolic expressions facility of Sage; and cannot even be tested without Sage.
 
-We merge Pynac (i.e., the directory https://github.com/pynac/pynac/tree/master/ginac) into the Sage library as `src/sage/symbolic/ginac`. It is not a very big package - one flat directory with 100 *.h and *.cpp files, a total of 50kLOC.
+We merge Pynac (i.e., the directory https://github.com/pynac/pynac/tree/master/ginac) into the Sage library as `src/sage/symbolic/ginac`. It is not a very big package - one flat directory with 100 *.h and *.cpp files, a total of 50kLOC. (The existing Python/Cython symbolics code in `sage.symbolic`, `sage.calculus`, `sage.functions` is about 60kLOC.)
 
 This will solve the same issues that #30534 tried to address, which ran into unresolved technical difficulties.
 
``````




---

archive/issue_comments_524748.json:
```json
{
    "body": "<a id='comment:14'></a>\nThis mostly works but I'm getting a few timeouts/crashes that I'm not sure about\n\n```\nsage -t --random-seed=0 src/sage/schemes/elliptic_curves/ell_number_field.py  # Timed out\nsage -t --random-seed=0 src/sage/manifolds/differentiable/degenerate_submanifold.py  # 1 doctest failed\nsage -t --random-seed=0 src/sage/manifolds/differentiable/tensorfield.py  # Timed out\nsage -t --random-seed=0 src/sage/plot/plot3d/parametric_plot3d.py  # Timed out\nsage -t --random-seed=0 src/sage/plot/plot3d/plot3d.py  # Timed out\nsage -t --random-seed=0 src/sage/plot/plot3d/base.pyx  # Timed out\nsage -t --random-seed=0 src/sage/plot/plot3d/implicit_plot3d.py  # Timed out\nsage -t --random-seed=0 src/sage/symbolic/relation.py  # Timed out\nsage -t --random-seed=0 src/sage/symbolic/expression.pyx  # Killed due to illegal instruction\nsage -t --random-seed=0 src/sage/symbolic/pynac_constant.pyx  # 18 doctests failed\n```",
    "created_at": "2021-08-16T21:06:51Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524748",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>
This mostly works but I'm getting a few timeouts/crashes that I'm not sure about

```
sage -t --random-seed=0 src/sage/schemes/elliptic_curves/ell_number_field.py  # Timed out
sage -t --random-seed=0 src/sage/manifolds/differentiable/degenerate_submanifold.py  # 1 doctest failed
sage -t --random-seed=0 src/sage/manifolds/differentiable/tensorfield.py  # Timed out
sage -t --random-seed=0 src/sage/plot/plot3d/parametric_plot3d.py  # Timed out
sage -t --random-seed=0 src/sage/plot/plot3d/plot3d.py  # Timed out
sage -t --random-seed=0 src/sage/plot/plot3d/base.pyx  # Timed out
sage -t --random-seed=0 src/sage/plot/plot3d/implicit_plot3d.py  # Timed out
sage -t --random-seed=0 src/sage/symbolic/relation.py  # Timed out
sage -t --random-seed=0 src/sage/symbolic/expression.pyx  # Killed due to illegal instruction
sage -t --random-seed=0 src/sage/symbolic/pynac_constant.pyx  # 18 doctests failed
```



---

archive/issue_comments_524749.json:
```json
{
    "body": "**Changing commit** from \"[add5e891706dd779b6129cea0e8dc175c3c48054](https://github.com/sagemath/sagetrac-mirror/commit/add5e891706dd779b6129cea0e8dc175c3c48054)\" to \"[d9a14207300cc7baece7289cf309e7db1bfdebe1](https://github.com/sagemath/sagetrac-mirror/commit/d9a14207300cc7baece7289cf309e7db1bfdebe1)\".",
    "created_at": "2021-08-16T21:13:48Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524749",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[add5e891706dd779b6129cea0e8dc175c3c48054](https://github.com/sagemath/sagetrac-mirror/commit/add5e891706dd779b6129cea0e8dc175c3c48054)" to "[d9a14207300cc7baece7289cf309e7db1bfdebe1](https://github.com/sagemath/sagetrac-mirror/commit/d9a14207300cc7baece7289cf309e7db1bfdebe1)".



---

archive/issue_comments_524750.json:
```json
{
    "body": "<a id='comment:15'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d9a14207300cc7baece7289cf309e7db1bfdebe1\">d9a1420</a></td><td><code>src/sage/symbolic/pynac_constant.pyx: Fix imports in doctests</code></td></tr></table>\n",
    "created_at": "2021-08-16T21:13:48Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524750",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d9a14207300cc7baece7289cf309e7db1bfdebe1">d9a1420</a></td><td><code>src/sage/symbolic/pynac_constant.pyx: Fix imports in doctests</code></td></tr></table>




---

archive/issue_comments_524751.json:
```json
{
    "body": "<a id='comment:16'></a>\nThe crash is from this doctest:\n\n```\n>>> m = var('m')\n>>> assume(m, 'integer')\n>>> (I**m).real_part()\n```\nwhich seems to lead to an infinite recursion through `GiNaC::power::real_part()`",
    "created_at": "2021-08-16T21:39:52Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524751",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>
The crash is from this doctest:

```
>>> m = var('m')
>>> assume(m, 'integer')
>>> (I**m).real_part()
```
which seems to lead to an infinite recursion through `GiNaC::power::real_part()`



---

archive/issue_comments_524752.json:
```json
{
    "body": "<a id='comment:17'></a>\nOh, this is #28357 and I forgot to apply `realpartloop.patch`",
    "created_at": "2021-08-16T21:47:24Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524752",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>
Oh, this is #28357 and I forgot to apply `realpartloop.patch`



---

archive/issue_comments_524753.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bc0d5f379151013fdcfd942fc0fea030feb11456\">bc0d5f3</a></td><td><code>Trac #28357: patch power::real_part</code></td></tr></table>\n",
    "created_at": "2021-08-16T21:54:51Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524753",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bc0d5f379151013fdcfd942fc0fea030feb11456">bc0d5f3</a></td><td><code>Trac #28357: patch power::real_part</code></td></tr></table>




---

archive/issue_comments_524754.json:
```json
{
    "body": "**Changing commit** from \"[d9a14207300cc7baece7289cf309e7db1bfdebe1](https://github.com/sagemath/sagetrac-mirror/commit/d9a14207300cc7baece7289cf309e7db1bfdebe1)\" to \"[bc0d5f379151013fdcfd942fc0fea030feb11456](https://github.com/sagemath/sagetrac-mirror/commit/bc0d5f379151013fdcfd942fc0fea030feb11456)\".",
    "created_at": "2021-08-16T21:54:51Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524754",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d9a14207300cc7baece7289cf309e7db1bfdebe1](https://github.com/sagemath/sagetrac-mirror/commit/d9a14207300cc7baece7289cf309e7db1bfdebe1)" to "[bc0d5f379151013fdcfd942fc0fea030feb11456](https://github.com/sagemath/sagetrac-mirror/commit/bc0d5f379151013fdcfd942fc0fea030feb11456)".



---

archive/issue_comments_524755.json:
```json
{
    "body": "<a id='comment:19'></a>\nReady for testing and review. (I think the patchbot will not run because `build/pkgs/pynac/` is removed by the ticket.)",
    "created_at": "2021-08-16T22:11:03Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524755",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>
Ready for testing and review. (I think the patchbot will not run because `build/pkgs/pynac/` is removed by the ticket.)



---

archive/issue_comments_524756.json:
```json
{
    "body": "**Changing commit** from \"[bc0d5f379151013fdcfd942fc0fea030feb11456](https://github.com/sagemath/sagetrac-mirror/commit/bc0d5f379151013fdcfd942fc0fea030feb11456)\" to \"[881e21ba0f445e4e257c72c4415894023cab7826](https://github.com/sagemath/sagetrac-mirror/commit/881e21ba0f445e4e257c72c4415894023cab7826)\".",
    "created_at": "2021-08-16T22:14:13Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524756",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[bc0d5f379151013fdcfd942fc0fea030feb11456](https://github.com/sagemath/sagetrac-mirror/commit/bc0d5f379151013fdcfd942fc0fea030feb11456)" to "[881e21ba0f445e4e257c72c4415894023cab7826](https://github.com/sagemath/sagetrac-mirror/commit/881e21ba0f445e4e257c72c4415894023cab7826)".



---

archive/issue_comments_524757.json:
```json
{
    "body": "<a id='comment:20'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/881e21ba0f445e4e257c72c4415894023cab7826\">881e21b</a></td><td><code>.gitignore: Unignore ginac cpp sources</code></td></tr></table>\n",
    "created_at": "2021-08-16T22:14:13Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524757",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/881e21ba0f445e4e257c72c4415894023cab7826">881e21b</a></td><td><code>.gitignore: Unignore ginac cpp sources</code></td></tr></table>




---

archive/issue_comments_524758.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [@mkoeppe](#comment%3A19):\n> Ready for testing and review. (I think the patchbot will not run because `build/pkgs/pynac/` is removed by the ticket.)\n\nThat's a bit inconvenient. Such a massive change needs all the bot runs it can get.",
    "created_at": "2021-08-16T22:20:55Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524758",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:21'></a>
Replying to [@mkoeppe](#comment%3A19):
> Ready for testing and review. (I think the patchbot will not run because `build/pkgs/pynac/` is removed by the ticket.)

That's a bit inconvenient. Such a massive change needs all the bot runs it can get.



---

archive/issue_comments_524759.json:
```json
{
    "body": "<a id='comment:22'></a>\nI can of course move the pynac removal to a follow-up ticket",
    "created_at": "2021-08-16T22:28:42Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524759",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'></a>
I can of course move the pynac removal to a follow-up ticket



---

archive/issue_comments_524760.json:
```json
{
    "body": "<a id='comment:23'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8c1fd8d21947f72684ba4b963db683db5cd6ce07\">8c1fd8d</a></td><td><code>.gitignore: Unignore ginac cpp sources</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c8c3f53fb8203ba1aab19cfda0fb078d0843e426\">c8c3f53</a></td><td><code>Trac #28357: patch power::real_part</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1177244cf20d76b2d3aaa8d673a9cc3e3ebd2a9\">e117724</a></td><td><code>Move stuff from sage.libs.pynac to sage.symbolic.ginac, leaving some deprecated reimports behind</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e166523e4afb34e42e3c02bc75325f1e0a40937a\">e166523</a></td><td><code>src/sage/symbolic/ginac/version.h.in: Remove</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e428de14e6009c8204f0347733bc0245f50bf62\">3e428de</a></td><td><code>src/sage/symbolic/ginac/pynac-config.h: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dec1c4052644d6a311856418e92d16130f73e9cc\">dec1c40</a></td><td><code>src/sage/symbolic/ginac/utils.h, pynac-config.h: Eliminate use of PYNAC_SIZEOF_LONG, PYNAC_SIZEOF_LONG_LONG</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/17d6d2d5e8cb021481d4a4b1d483d924097e504b\">17d6d2d</a></td><td><code>src/sage/symbolic/pynac_constant.pyx: Fix imports in doctests</code></td></tr></table>\n",
    "created_at": "2021-08-16T22:32:36Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524760",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8c1fd8d21947f72684ba4b963db683db5cd6ce07">8c1fd8d</a></td><td><code>.gitignore: Unignore ginac cpp sources</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c8c3f53fb8203ba1aab19cfda0fb078d0843e426">c8c3f53</a></td><td><code>Trac #28357: patch power::real_part</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1177244cf20d76b2d3aaa8d673a9cc3e3ebd2a9">e117724</a></td><td><code>Move stuff from sage.libs.pynac to sage.symbolic.ginac, leaving some deprecated reimports behind</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e166523e4afb34e42e3c02bc75325f1e0a40937a">e166523</a></td><td><code>src/sage/symbolic/ginac/version.h.in: Remove</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e428de14e6009c8204f0347733bc0245f50bf62">3e428de</a></td><td><code>src/sage/symbolic/ginac/pynac-config.h: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dec1c4052644d6a311856418e92d16130f73e9cc">dec1c40</a></td><td><code>src/sage/symbolic/ginac/utils.h, pynac-config.h: Eliminate use of PYNAC_SIZEOF_LONG, PYNAC_SIZEOF_LONG_LONG</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/17d6d2d5e8cb021481d4a4b1d483d924097e504b">17d6d2d</a></td><td><code>src/sage/symbolic/pynac_constant.pyx: Fix imports in doctests</code></td></tr></table>




---

archive/issue_comments_524761.json:
```json
{
    "body": "**Changing commit** from \"[881e21ba0f445e4e257c72c4415894023cab7826](https://github.com/sagemath/sagetrac-mirror/commit/881e21ba0f445e4e257c72c4415894023cab7826)\" to \"[17d6d2d5e8cb021481d4a4b1d483d924097e504b](https://github.com/sagemath/sagetrac-mirror/commit/17d6d2d5e8cb021481d4a4b1d483d924097e504b)\".",
    "created_at": "2021-08-16T22:32:36Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524761",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[881e21ba0f445e4e257c72c4415894023cab7826](https://github.com/sagemath/sagetrac-mirror/commit/881e21ba0f445e4e257c72c4415894023cab7826)" to "[17d6d2d5e8cb021481d4a4b1d483d924097e504b](https://github.com/sagemath/sagetrac-mirror/commit/17d6d2d5e8cb021481d4a4b1d483d924097e504b)".



---

archive/issue_comments_524762.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -8,5 +8,5 @@\n \n It will also make it easier for Sage developers to make changes to Pynac.\n \n+Follow-up: #32387 Remove pynac spkg\n \n-\n``````\n",
    "created_at": "2021-08-16T22:33:32Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524762",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -8,5 +8,5 @@
 
 It will also make it easier for Sage developers to make changes to Pynac.
 
+Follow-up: #32387 Remove pynac spkg
 
-
``````




---

archive/issue_comments_524763.json:
```json
{
    "body": "<a id='comment:25'></a>\nMy previous tests were on macOS. On Linux this fails with \n\n```\n  File \"sage/symbolic/pynac.pyx\", line 1, in init sage.symbolic.pynac (build/cythonized/sage/symbolic/pynac.cpp:31348)\nImportError: /home/sagemath/sage-9.1/local/lib/python3.7/site-packages/sage/symbolic/expression.cpython-37m-x86_64-linux-gnu.so: undefined symbol: _ZTIN5GiNaC5basicE\n```\n(as reported by a patchbot; also verified using `tox -e docker-ubuntu-focal-standard`)",
    "created_at": "2021-08-17T00:16:56Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524763",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>
My previous tests were on macOS. On Linux this fails with 

```
  File "sage/symbolic/pynac.pyx", line 1, in init sage.symbolic.pynac (build/cythonized/sage/symbolic/pynac.cpp:31348)
ImportError: /home/sagemath/sage-9.1/local/lib/python3.7/site-packages/sage/symbolic/expression.cpython-37m-x86_64-linux-gnu.so: undefined symbol: _ZTIN5GiNaC5basicE
```
(as reported by a patchbot; also verified using `tox -e docker-ubuntu-focal-standard`)



---

archive/issue_events_291146.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-17T00:16:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291146"
}
```



---

archive/issue_events_291147.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-17T00:16:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291147"
}
```



---

archive/issue_comments_524764.json:
```json
{
    "body": "<a id='comment:26'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9e17a4b47fdd1209ebe4046bbab20e1631810779\">9e17a4b</a></td><td><code>src/sage/symbolic/pynac_wrap.h: Clean up #include</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3355234a8d74da9413d18c44dd987897d05ed0fe\">3355234</a></td><td><code>Replace 'from sage.symbolic.pynac cimport *' by more specific cimports</code></td></tr></table>\n",
    "created_at": "2021-08-17T01:42:20Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524764",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9e17a4b47fdd1209ebe4046bbab20e1631810779">9e17a4b</a></td><td><code>src/sage/symbolic/pynac_wrap.h: Clean up #include</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3355234a8d74da9413d18c44dd987897d05ed0fe">3355234</a></td><td><code>Replace 'from sage.symbolic.pynac cimport *' by more specific cimports</code></td></tr></table>




---

archive/issue_comments_524765.json:
```json
{
    "body": "**Changing commit** from \"[17d6d2d5e8cb021481d4a4b1d483d924097e504b](https://github.com/sagemath/sagetrac-mirror/commit/17d6d2d5e8cb021481d4a4b1d483d924097e504b)\" to \"[3355234a8d74da9413d18c44dd987897d05ed0fe](https://github.com/sagemath/sagetrac-mirror/commit/3355234a8d74da9413d18c44dd987897d05ed0fe)\".",
    "created_at": "2021-08-17T01:42:20Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524765",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[17d6d2d5e8cb021481d4a4b1d483d924097e504b](https://github.com/sagemath/sagetrac-mirror/commit/17d6d2d5e8cb021481d4a4b1d483d924097e504b)" to "[3355234a8d74da9413d18c44dd987897d05ed0fe](https://github.com/sagemath/sagetrac-mirror/commit/3355234a8d74da9413d18c44dd987897d05ed0fe)".



---

archive/issue_comments_524766.json:
```json
{
    "body": "<a id='comment:27'></a>\nThis problem with linking can likely be solved by merging all *.pyx files that `cimport` from `sage.symbolic.pynac` into one (taking care of the ones in `ring.pyx` by refactoring)\n\n```\n$ git grep pynac.*cimport\nsrc/sage/symbolic/comparison.pyx:from sage.symbolic.pynac cimport (\nsrc/sage/symbolic/expression.pxd:from sage.symbolic.pynac cimport GEx\nsrc/sage/symbolic/expression.pyx:from sage.symbolic.pynac cimport *\nsrc/sage/symbolic/function.pyx:from sage.symbolic.pynac cimport (\nsrc/sage/symbolic/getitem.pyx:from sage.symbolic.pynac cimport GEx\nsrc/sage/symbolic/pynac.pyx:from .pynac_constant cimport PynacConstant\nsrc/sage/symbolic/pynac_constant.pxd:from .pynac cimport GConstant\nsrc/sage/symbolic/pynac_constant.pyx:from .pynac cimport (\nsrc/sage/symbolic/ring.pyx:from sage.symbolic.pynac cimport (GEx, GExprSeq, GExVector, GSymbol,\nsrc/sage/symbolic/series.pyx:from sage.symbolic.pynac cimport GEx, g_is_a_terminating_series, g_series_var, series_to_poly\nsrc/sage/symbolic/substitution_map.pxd:from sage.symbolic.pynac cimport GExMap\nsrc/sage/symbolic/substitution_map.pyx:from sage.symbolic.pynac cimport make_pair, GEx, GExPair\n```\nI don't know if there's a better solution.",
    "created_at": "2021-08-17T01:52:59Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524766",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>
This problem with linking can likely be solved by merging all *.pyx files that `cimport` from `sage.symbolic.pynac` into one (taking care of the ones in `ring.pyx` by refactoring)

```
$ git grep pynac.*cimport
src/sage/symbolic/comparison.pyx:from sage.symbolic.pynac cimport (
src/sage/symbolic/expression.pxd:from sage.symbolic.pynac cimport GEx
src/sage/symbolic/expression.pyx:from sage.symbolic.pynac cimport *
src/sage/symbolic/function.pyx:from sage.symbolic.pynac cimport (
src/sage/symbolic/getitem.pyx:from sage.symbolic.pynac cimport GEx
src/sage/symbolic/pynac.pyx:from .pynac_constant cimport PynacConstant
src/sage/symbolic/pynac_constant.pxd:from .pynac cimport GConstant
src/sage/symbolic/pynac_constant.pyx:from .pynac cimport (
src/sage/symbolic/ring.pyx:from sage.symbolic.pynac cimport (GEx, GExprSeq, GExVector, GSymbol,
src/sage/symbolic/series.pyx:from sage.symbolic.pynac cimport GEx, g_is_a_terminating_series, g_series_var, series_to_poly
src/sage/symbolic/substitution_map.pxd:from sage.symbolic.pynac cimport GExMap
src/sage/symbolic/substitution_map.pyx:from sage.symbolic.pynac cimport make_pair, GEx, GExPair
```
I don't know if there's a better solution.



---

archive/issue_comments_524767.json:
```json
{
    "body": "<a id='comment:28'></a>\nI will take a look, if I can resolve this.",
    "created_at": "2021-08-17T07:56:33Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524767",
    "user": "https://github.com/kliem"
}
```

<a id='comment:28'></a>
I will take a look, if I can resolve this.



---

archive/issue_comments_524768.json:
```json
{
    "body": "<a id='comment:29'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/01dfef3756a4da5fc01355f10954dea69fbf01f6\">01dfef3</a></td><td><code>missing headers</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/04397d2e547f0a81c727165d9e9fee0d54b3ee6d\">04397d2</a></td><td><code>add missing singular libraries</code></td></tr></table>\n",
    "created_at": "2021-08-17T10:19:19Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524768",
    "user": "https://github.com/kliem"
}
```

<a id='comment:29'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/01dfef3756a4da5fc01355f10954dea69fbf01f6">01dfef3</a></td><td><code>missing headers</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/04397d2e547f0a81c727165d9e9fee0d54b3ee6d">04397d2</a></td><td><code>add missing singular libraries</code></td></tr></table>




---

archive/issue_comments_524769.json:
```json
{
    "body": "**Changing commit** from \"[3355234a8d74da9413d18c44dd987897d05ed0fe](https://github.com/sagemath/sagetrac-mirror/commit/3355234a8d74da9413d18c44dd987897d05ed0fe)\" to \"[04397d2e547f0a81c727165d9e9fee0d54b3ee6d](https://github.com/sagemath/sagetrac-mirror/commit/04397d2e547f0a81c727165d9e9fee0d54b3ee6d)\".",
    "created_at": "2021-08-17T10:19:19Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524769",
    "user": "https://github.com/kliem"
}
```

**Changing commit** from "[3355234a8d74da9413d18c44dd987897d05ed0fe](https://github.com/sagemath/sagetrac-mirror/commit/3355234a8d74da9413d18c44dd987897d05ed0fe)" to "[04397d2e547f0a81c727165d9e9fee0d54b3ee6d](https://github.com/sagemath/sagetrac-mirror/commit/04397d2e547f0a81c727165d9e9fee0d54b3ee6d)".



---

archive/issue_comments_524770.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)\" to \"[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)\".",
    "created_at": "2021-08-17T10:19:19Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524770",
    "user": "https://github.com/kliem"
}
```

**Changing branch** from "[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)" to "[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)".



---

archive/issue_comments_524771.json:
```json
{
    "body": "<a id='comment:30'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/70bcddf168950f477c2b56fca725e668a1236fb6\">70bcddf</a></td><td><code>simpler inclusion of headers</code></td></tr></table>\n",
    "created_at": "2021-08-17T13:40:05Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524771",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/70bcddf168950f477c2b56fca725e668a1236fb6">70bcddf</a></td><td><code>simpler inclusion of headers</code></td></tr></table>




---

archive/issue_comments_524772.json:
```json
{
    "body": "**Changing commit** from \"[04397d2e547f0a81c727165d9e9fee0d54b3ee6d](https://github.com/sagemath/sagetrac-mirror/commit/04397d2e547f0a81c727165d9e9fee0d54b3ee6d)\" to \"[70bcddf168950f477c2b56fca725e668a1236fb6](https://github.com/sagemath/sagetrac-mirror/commit/70bcddf168950f477c2b56fca725e668a1236fb6)\".",
    "created_at": "2021-08-17T13:40:05Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524772",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[04397d2e547f0a81c727165d9e9fee0d54b3ee6d](https://github.com/sagemath/sagetrac-mirror/commit/04397d2e547f0a81c727165d9e9fee0d54b3ee6d)" to "[70bcddf168950f477c2b56fca725e668a1236fb6](https://github.com/sagemath/sagetrac-mirror/commit/70bcddf168950f477c2b56fca725e668a1236fb6)".



---

archive/issue_comments_524773.json:
```json
{
    "body": "**Changing commit** from \"[70bcddf168950f477c2b56fca725e668a1236fb6](https://github.com/sagemath/sagetrac-mirror/commit/70bcddf168950f477c2b56fca725e668a1236fb6)\" to \"[7ce050fdea338610b91680584c0db59e54d4c5cf](https://github.com/sagemath/sagetrac-mirror/commit/7ce050fdea338610b91680584c0db59e54d4c5cf)\".",
    "created_at": "2021-08-17T15:04:56Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524773",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[70bcddf168950f477c2b56fca725e668a1236fb6](https://github.com/sagemath/sagetrac-mirror/commit/70bcddf168950f477c2b56fca725e668a1236fb6)" to "[7ce050fdea338610b91680584c0db59e54d4c5cf](https://github.com/sagemath/sagetrac-mirror/commit/7ce050fdea338610b91680584c0db59e54d4c5cf)".



---

archive/issue_comments_524774.json:
```json
{
    "body": "<a id='comment:31'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7ce050fdea338610b91680584c0db59e54d4c5cf\">7ce050f</a></td><td><code>somewhat fix doctest</code></td></tr></table>\n",
    "created_at": "2021-08-17T15:04:56Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524774",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7ce050fdea338610b91680584c0db59e54d4c5cf">7ce050f</a></td><td><code>somewhat fix doctest</code></td></tr></table>




---

archive/issue_comments_524775.json:
```json
{
    "body": "<a id='comment:32'></a>\nI basically have this working by specifying:\n\n```diff\ndiff --git a/src/sage/symbolic/series.pyx b/src/sage/symbolic/series.pyx\nindex 0e395ae4b4..d93cccc50b 100644\n--- a/src/sage/symbolic/series.pyx\n+++ b/src/sage/symbolic/series.pyx\n@@ -1,3 +1,4 @@\n+# distutils: extra_link_args = /srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/symbolic/pynac.cpython-37m-x86_64-linux-gnu.so\n \"\"\"\n Symbolic Series\n```\n\nto all of those files (and the one doctest in `sage/symbolic/pynac.pxd` that raises an `ImportError` currently).\n\nSo this is basically working, but the correct linking is missing.\n\nWe could create an extra file `sage/symbolic/linked_pynac.pxd`, which just consists of\n\n```\n# distutils: extra_link_args = ...\nfrom sage.symbolic/pynac cimport *\n```\n\nthen there is no need to specify this extra distutils thing in every file that cimports pynac.",
    "created_at": "2021-08-17T15:11:45Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524775",
    "user": "https://github.com/kliem"
}
```

<a id='comment:32'></a>
I basically have this working by specifying:

```diff
diff --git a/src/sage/symbolic/series.pyx b/src/sage/symbolic/series.pyx
index 0e395ae4b4..d93cccc50b 100644
--- a/src/sage/symbolic/series.pyx
+++ b/src/sage/symbolic/series.pyx
@@ -1,3 +1,4 @@
+# distutils: extra_link_args = /srv/public/kliem/sage/local/lib/python3.7/site-packages/sage/symbolic/pynac.cpython-37m-x86_64-linux-gnu.so
 """
 Symbolic Series
```

to all of those files (and the one doctest in `sage/symbolic/pynac.pxd` that raises an `ImportError` currently).

So this is basically working, but the correct linking is missing.

We could create an extra file `sage/symbolic/linked_pynac.pxd`, which just consists of

```
# distutils: extra_link_args = ...
from sage.symbolic/pynac cimport *
```

then there is no need to specify this extra distutils thing in every file that cimports pynac.



---

archive/issue_comments_524776.json:
```json
{
    "body": "<a id='comment:33'></a>\nOnce more thing: The headers in `pkgs/sagemath-standard/build/cythonized/` are not cleaned up. Can this be fixed somehow or is this just going to stay this way? (This is probably the reason, why you did not notice the missing headers that were fixed in ||[01dfef3](https://github.com/sagemath/sagetrac-mirror/commit/01dfef3756a4da5fc01355f10954dea69fbf01f6)||`missing headers`||",
    "created_at": "2021-08-17T15:15:11Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524776",
    "user": "https://github.com/kliem"
}
```

<a id='comment:33'></a>
Once more thing: The headers in `pkgs/sagemath-standard/build/cythonized/` are not cleaned up. Can this be fixed somehow or is this just going to stay this way? (This is probably the reason, why you did not notice the missing headers that were fixed in ||[01dfef3](https://github.com/sagemath/sagetrac-mirror/commit/01dfef3756a4da5fc01355f10954dea69fbf01f6)||`missing headers`||



---

archive/issue_comments_524777.json:
```json
{
    "body": "<a id='comment:34'></a>\nI don't like the change https://github.com/sagemath/sagetrac-mirror/commit/70bcddf168950f477c2b56fca725e668a1236fb6 (simpler inclusion of headers); putting stuff in the include search path can lead to shadowing headers of other libraries",
    "created_at": "2021-08-17T17:48:13Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524777",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:34'></a>
I don't like the change https://github.com/sagemath/sagetrac-mirror/commit/70bcddf168950f477c2b56fca725e668a1236fb6 (simpler inclusion of headers); putting stuff in the include search path can lead to shadowing headers of other libraries



---

archive/issue_comments_524778.json:
```json
{
    "body": "<a id='comment:35'></a>\nThanks for the investigation and fixes.\n\nI think I would be reluctant to use the `extra_link_args` workaround -- it will requires changes to the build system because now building one extension module would depend on another extension module.\n\nIn any case, I'd think that your successful experiment indicates the approach of merging everything that needs to `cimport` stuff from ginac/ into one extension module would work.",
    "created_at": "2021-08-17T17:54:56Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524778",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:35'></a>
Thanks for the investigation and fixes.

I think I would be reluctant to use the `extra_link_args` workaround -- it will requires changes to the build system because now building one extension module would depend on another extension module.

In any case, I'd think that your successful experiment indicates the approach of merging everything that needs to `cimport` stuff from ginac/ into one extension module would work.



---

archive/issue_comments_524779.json:
```json
{
    "body": "<a id='comment:36'></a>\nReplying to [@kliem](#comment%3A33):\n> Once more thing: The headers in `pkgs/sagemath-standard/build/cythonized/` are not cleaned up. \n\nDo we already have a ticket for this? If not, please open one\n\nHowever, I think we should move away from the custom build system of Sage. I have opened #32390 for the next step in this.",
    "created_at": "2021-08-17T18:06:12Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524779",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:36'></a>
Replying to [@kliem](#comment%3A33):
> Once more thing: The headers in `pkgs/sagemath-standard/build/cythonized/` are not cleaned up. 

Do we already have a ticket for this? If not, please open one

However, I think we should move away from the custom build system of Sage. I have opened #32390 for the next step in this.



---

archive/issue_comments_524780.json:
```json
{
    "body": "<a id='comment:37'></a>\nReplying to [@mkoeppe](#comment%3A27):\n> This problem with linking can likely be solved by merging all *.pyx files that `cimport` from `sage.symbolic.pynac` into one (taking care of the ones in `ring.pyx` by refactoring)\n\nFor cleaning up `ring.pyx`, I have opened #32391.",
    "created_at": "2021-08-17T18:17:05Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524780",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:37'></a>
Replying to [@mkoeppe](#comment%3A27):
> This problem with linking can likely be solved by merging all *.pyx files that `cimport` from `sage.symbolic.pynac` into one (taking care of the ones in `ring.pyx` by refactoring)

For cleaning up `ring.pyx`, I have opened #32391.



---

archive/issue_comments_524781.json:
```json
{
    "body": "**Dependencies:** #32391",
    "created_at": "2021-08-17T18:17:05Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524781",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #32391



---

archive/issue_comments_524782.json:
```json
{
    "body": "<a id='comment:38'></a>\nReplying to [@mkoeppe](#comment%3A37):\n> Replying to [@mkoeppe](#comment%3A27):\n> > This problem with linking can likely be solved by merging all *.pyx files that `cimport` from `sage.symbolic.pynac` into one (taking care of the ones in `ring.pyx` by refactoring)\n\n> \n> For cleaning up `ring.pyx`, I have opened #32391.\n\nWe would still lose ability to use it directly in cython at all. E.g. the doctest in `pynac.pxd` would fail.\n\nAt the moment, I'm building this branch with `./configure --enable-editable` and will report whether this resolves anything.",
    "created_at": "2021-08-17T18:38:34Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524782",
    "user": "https://github.com/kliem"
}
```

<a id='comment:38'></a>
Replying to [@mkoeppe](#comment%3A37):
> Replying to [@mkoeppe](#comment%3A27):
> > This problem with linking can likely be solved by merging all *.pyx files that `cimport` from `sage.symbolic.pynac` into one (taking care of the ones in `ring.pyx` by refactoring)

> 
> For cleaning up `ring.pyx`, I have opened #32391.

We would still lose ability to use it directly in cython at all. E.g. the doctest in `pynac.pxd` would fail.

At the moment, I'm building this branch with `./configure --enable-editable` and will report whether this resolves anything.



---

archive/issue_comments_524783.json:
```json
{
    "body": "<a id='comment:39'></a>\nReplying to [@mkoeppe](#comment%3A34):\n> I don't like the change https://github.com/sagemath/sagetrac-mirror/commit/70bcddf168950f477c2b56fca725e668a1236fb6 (simpler inclusion of headers); putting stuff in the include search path can lead to shadowing headers of other libraries\n\n`from ... cimport ...` should usually just work out of the box. But of course one can also spell out all those header (e.g. with a cython alias).\n\nThen again, if we decide to put it all into one large `pyx` and not cimport things from `ginac` directly, the commit isn't necessary at all.",
    "created_at": "2021-08-17T18:51:35Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524783",
    "user": "https://github.com/kliem"
}
```

<a id='comment:39'></a>
Replying to [@mkoeppe](#comment%3A34):
> I don't like the change https://github.com/sagemath/sagetrac-mirror/commit/70bcddf168950f477c2b56fca725e668a1236fb6 (simpler inclusion of headers); putting stuff in the include search path can lead to shadowing headers of other libraries

`from ... cimport ...` should usually just work out of the box. But of course one can also spell out all those header (e.g. with a cython alias).

Then again, if we decide to put it all into one large `pyx` and not cimport things from `ginac` directly, the commit isn't necessary at all.



---

archive/issue_comments_524784.json:
```json
{
    "body": "<a id='comment:40'></a>\nReplying to [@kliem](#comment%3A38):\n> Replying to [@mkoeppe](#comment%3A37):\n> > Replying to [@mkoeppe](#comment%3A27):\n> > > This problem with linking can likely be solved by merging all *.pyx files that `cimport` from `sage.symbolic.pynac` into one (taking care of the ones in `ring.pyx` by refactoring)\n\n> > \n> > For cleaning up `ring.pyx`, I have opened #32391.\n\n> \n> We would still lose ability to use it directly in cython at all. E.g. the doctest in `pynac.pxd` would fail.\n\nI wouldn't be too concerned about this. I'd be surprised if there's any user code in the wild that does that; and if at all necessary, it can be mitigated by adding some missing methods at a higher level.",
    "created_at": "2021-08-17T19:00:01Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524784",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:40'></a>
Replying to [@kliem](#comment%3A38):
> Replying to [@mkoeppe](#comment%3A37):
> > Replying to [@mkoeppe](#comment%3A27):
> > > This problem with linking can likely be solved by merging all *.pyx files that `cimport` from `sage.symbolic.pynac` into one (taking care of the ones in `ring.pyx` by refactoring)

> > 
> > For cleaning up `ring.pyx`, I have opened #32391.

> 
> We would still lose ability to use it directly in cython at all. E.g. the doctest in `pynac.pxd` would fail.

I wouldn't be too concerned about this. I'd be surprised if there's any user code in the wild that does that; and if at all necessary, it can be mitigated by adding some missing methods at a higher level.



---

archive/issue_comments_524785.json:
```json
{
    "body": "<a id='comment:41'></a>\nOk, same problem with `./configure --enable-editable`.\n\nBtw, this is exactly our problem and there is no proper solution to it. So instead of adding a custom one, I agree that it would be easier, to move all the `cdef extern from ...` into one large `pyx` and only `cimport` the cython wrappers. This is the way, your meant to do it anyway.",
    "created_at": "2021-08-17T19:03:36Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524785",
    "user": "https://github.com/kliem"
}
```

<a id='comment:41'></a>
Ok, same problem with `./configure --enable-editable`.

Btw, this is exactly our problem and there is no proper solution to it. So instead of adding a custom one, I agree that it would be easier, to move all the `cdef extern from ...` into one large `pyx` and only `cimport` the cython wrappers. This is the way, your meant to do it anyway.



---

archive/issue_comments_524786.json:
```json
{
    "body": "<a id='comment:42'></a>\nA simple way of doing this might be to rename files like `series.pxd` to `series.pxi` and `series.pyx` to `series_impl.pxi` and then to `include` them into the target extension module (`pynac.pxd`, `pynac.pyx`?)",
    "created_at": "2021-08-17T19:11:18Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524786",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:42'></a>
A simple way of doing this might be to rename files like `series.pxd` to `series.pxi` and `series.pyx` to `series_impl.pxi` and then to `include` them into the target extension module (`pynac.pxd`, `pynac.pyx`?)



---

archive/issue_comments_524787.json:
```json
{
    "body": "<a id='comment:43'></a>\nUsing `pxi` is outdated, I was told. But maybe using something outdated is more desirable than having huge files.",
    "created_at": "2021-08-17T19:21:06Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524787",
    "user": "https://github.com/kliem"
}
```

<a id='comment:43'></a>
Using `pxi` is outdated, I was told. But maybe using something outdated is more desirable than having huge files.



---

archive/issue_comments_524788.json:
```json
{
    "body": "<a id='comment:44'></a>\nThat's probably just from the warning at https://cython.readthedocs.io/en/latest/src/userguide/language_basics.html?highlight=include#the-include-statement-and-include-files; but if I'm not mistaken, this just refers to a particular use case of \"pxi\" that was superseded by \"pxd\". I don't see any indication that the mechanism of `include` is intended to be removed in Cython.",
    "created_at": "2021-08-17T19:25:31Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524788",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:44'></a>
That's probably just from the warning at https://cython.readthedocs.io/en/latest/src/userguide/language_basics.html?highlight=include#the-include-statement-and-include-files; but if I'm not mistaken, this just refers to a particular use case of "pxi" that was superseded by "pxd". I don't see any indication that the mechanism of `include` is intended to be removed in Cython.



---

archive/issue_comments_524789.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)\" to \"[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)\".",
    "created_at": "2021-08-17T20:04:01Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524789",
    "user": "https://github.com/mkoeppe"
}
```

**Changing branch** from "[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)" to "[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)".



---

archive/issue_comments_524790.json:
```json
{
    "body": "**Changing commit** from \"[7ce050fdea338610b91680584c0db59e54d4c5cf](https://github.com/sagemath/sagetrac-mirror/commit/7ce050fdea338610b91680584c0db59e54d4c5cf)\" to \"[188714b3bb4f953e1fb56c2841899e1e946d5900](https://github.com/sagemath/sagetrac-mirror/commit/188714b3bb4f953e1fb56c2841899e1e946d5900)\".",
    "created_at": "2021-08-17T20:04:38Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524790",
    "user": "https://github.com/mkoeppe"
}
```

**Changing commit** from "[7ce050fdea338610b91680584c0db59e54d4c5cf](https://github.com/sagemath/sagetrac-mirror/commit/7ce050fdea338610b91680584c0db59e54d4c5cf)" to "[188714b3bb4f953e1fb56c2841899e1e946d5900](https://github.com/sagemath/sagetrac-mirror/commit/188714b3bb4f953e1fb56c2841899e1e946d5900)".



---

archive/issue_comments_524791.json:
```json
{
    "body": "<a id='comment:46'></a>\nIt would look like this (currently does not compile because I haven't done the changes to `ring.pyx`)\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1f76b222a2bccd440922e9f3a777fcf7effe5e17\">1f76b22</a></td><td><code>missing headers</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ff21838dcdd034ec94e24259f547c3b2752911f6\">ff21838</a></td><td><code>add missing singular libraries</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/188714b3bb4f953e1fb56c2841899e1e946d5900\">188714b</a></td><td><code>sage.symbolic: Change extension modules cimporting from pynac to pxi files included in sage.symbolic.pynac</code></td></tr></table>\n",
    "created_at": "2021-08-17T20:04:38Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524791",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:46'></a>
It would look like this (currently does not compile because I haven't done the changes to `ring.pyx`)

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1f76b222a2bccd440922e9f3a777fcf7effe5e17">1f76b22</a></td><td><code>missing headers</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ff21838dcdd034ec94e24259f547c3b2752911f6">ff21838</a></td><td><code>add missing singular libraries</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/188714b3bb4f953e1fb56c2841899e1e946d5900">188714b</a></td><td><code>sage.symbolic: Change extension modules cimporting from pynac to pxi files included in sage.symbolic.pynac</code></td></tr></table>




---

archive/issue_comments_524792.json:
```json
{
    "body": "<a id='comment:47'></a>\n(cherry-picked some of your changes onto this branch)",
    "created_at": "2021-08-17T20:06:33Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524792",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:47'></a>
(cherry-picked some of your changes onto this branch)



---

archive/issue_comments_524793.json:
```json
{
    "body": "**Changing commit** from \"[188714b3bb4f953e1fb56c2841899e1e946d5900](https://github.com/sagemath/sagetrac-mirror/commit/188714b3bb4f953e1fb56c2841899e1e946d5900)\" to \"[57ff18ac158d3c2541332652314aab9cdfa9d900](https://github.com/sagemath/sagetrac-mirror/commit/57ff18ac158d3c2541332652314aab9cdfa9d900)\".",
    "created_at": "2021-08-17T21:45:12Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524793",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[188714b3bb4f953e1fb56c2841899e1e946d5900](https://github.com/sagemath/sagetrac-mirror/commit/188714b3bb4f953e1fb56c2841899e1e946d5900)" to "[57ff18ac158d3c2541332652314aab9cdfa9d900](https://github.com/sagemath/sagetrac-mirror/commit/57ff18ac158d3c2541332652314aab9cdfa9d900)".



---

archive/issue_comments_524794.json:
```json
{
    "body": "<a id='comment:48'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/57ff18ac158d3c2541332652314aab9cdfa9d900\">57ff18a</a></td><td><code>Make sage.symbolic.expression the extension module that includes pynac</code></td></tr></table>\n",
    "created_at": "2021-08-17T21:45:12Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524794",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:48'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/57ff18ac158d3c2541332652314aab9cdfa9d900">57ff18a</a></td><td><code>Make sage.symbolic.expression the extension module that includes pynac</code></td></tr></table>




---

archive/issue_comments_524795.json:
```json
{
    "body": "<a id='comment:49'></a>\nor perhaps better like this.",
    "created_at": "2021-08-17T21:45:22Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524795",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:49'></a>
or perhaps better like this.



---

archive/issue_comments_524796.json:
```json
{
    "body": "<a id='comment:50'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6a2ada278e567b7fafd06ce97cad895e1f323f95\">6a2ada2</a></td><td><code>src/sage/symbolic/expression.pyx: Move 'distutils: sources' here</code></td></tr></table>\n",
    "created_at": "2021-08-18T00:21:45Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524796",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:50'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6a2ada278e567b7fafd06ce97cad895e1f323f95">6a2ada2</a></td><td><code>src/sage/symbolic/expression.pyx: Move 'distutils: sources' here</code></td></tr></table>




---

archive/issue_comments_524797.json:
```json
{
    "body": "**Changing commit** from \"[57ff18ac158d3c2541332652314aab9cdfa9d900](https://github.com/sagemath/sagetrac-mirror/commit/57ff18ac158d3c2541332652314aab9cdfa9d900)\" to \"[6a2ada278e567b7fafd06ce97cad895e1f323f95](https://github.com/sagemath/sagetrac-mirror/commit/6a2ada278e567b7fafd06ce97cad895e1f323f95)\".",
    "created_at": "2021-08-18T00:21:45Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524797",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[57ff18ac158d3c2541332652314aab9cdfa9d900](https://github.com/sagemath/sagetrac-mirror/commit/57ff18ac158d3c2541332652314aab9cdfa9d900)" to "[6a2ada278e567b7fafd06ce97cad895e1f323f95](https://github.com/sagemath/sagetrac-mirror/commit/6a2ada278e567b7fafd06ce97cad895e1f323f95)".



---

archive/issue_comments_524798.json:
```json
{
    "body": "<a id='comment:51'></a>\nForgive me for asking a na\u00efve question, but isn't this going against the modularization you are trying to have Sage do? I fully understand the reason for bringing it in (which should make it easier to bug-fix), but doesn't this make Sage more monolithic?",
    "created_at": "2021-08-18T04:19:29Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524798",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:51'></a>
Forgive me for asking a naïve question, but isn't this going against the modularization you are trying to have Sage do? I fully understand the reason for bringing it in (which should make it easier to bug-fix), but doesn't this make Sage more monolithic?



---

archive/issue_comments_524799.json:
```json
{
    "body": "<a id='comment:52'></a>\nReplying to [@tscrim](#comment%3A51):\n> isn't this going against the modularization you are trying to have Sage do? I fully understand the reason for bringing it in (which should make it easier to bug-fix), but doesn't this make Sage more monolithic?\n\nThis is a natural question. \n\nThe pynac library just does not make sense as a module. It is the basis of the implementation of SR elements and as such there is no way to build Sage symbolics without it. \n\nIn the modularization plan of #29705, we would instead create a distribution package `sagemath-symbolics`, containing the integrated pynac from the present ticket and most of `sage.symbolic`, `sage.calculus`, `sage.functions`, and parts of `sage.interfaces`. This will make sense as a module because there are many parts of Sage that (fortunately!) do not depend at all on Sage symbolics, or only depend on it for some smaller features. For example, `sage.graphs` has 0 imports from `sage.symbolic`, `sage.combinat` just a handful, etc.",
    "created_at": "2021-08-18T17:53:58Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524799",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:52'></a>
Replying to [@tscrim](#comment%3A51):
> isn't this going against the modularization you are trying to have Sage do? I fully understand the reason for bringing it in (which should make it easier to bug-fix), but doesn't this make Sage more monolithic?

This is a natural question. 

The pynac library just does not make sense as a module. It is the basis of the implementation of SR elements and as such there is no way to build Sage symbolics without it. 

In the modularization plan of #29705, we would instead create a distribution package `sagemath-symbolics`, containing the integrated pynac from the present ticket and most of `sage.symbolic`, `sage.calculus`, `sage.functions`, and parts of `sage.interfaces`. This will make sense as a module because there are many parts of Sage that (fortunately!) do not depend at all on Sage symbolics, or only depend on it for some smaller features. For example, `sage.graphs` has 0 imports from `sage.symbolic`, `sage.combinat` just a handful, etc.



---

archive/issue_comments_524800.json:
```json
{
    "body": "<a id='comment:53'></a>\nThank you for the explanation. So wouldn't it make sense to instead take the symbolics stuff out from Sage in one go rather than this two step process of add in pynac just to remove it later? Or is this just meant to be a stop-gap until it comes time to split everything?",
    "created_at": "2021-08-22T02:06:34Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524800",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:53'></a>
Thank you for the explanation. So wouldn't it make sense to instead take the symbolics stuff out from Sage in one go rather than this two step process of add in pynac just to remove it later? Or is this just meant to be a stop-gap until it comes time to split everything?



---

archive/issue_comments_524801.json:
```json
{
    "body": "<a id='comment:54'></a>\nReplying to [@tscrim](#comment%3A53):\n> So wouldn't it make sense to instead take the symbolics stuff out from Sage in one go rather than this two step process of add in pynac just to remove it later? Or is this just meant to be a stop-gap until it comes time to split everything?\n\nThe modularization plan does not involve \"taking ... stuff out from Sage\" at all. It will all remain in the same git repository, and also `src/sage` will remain monolithic.\n\nModularization is achieved by preparing sub-distributions defined using one of several possible mechanisms. Take a look at `sagemath-objects` from #29865 (https://pypi.org/project/sagemath-objects/), for example: It defines a sub-distribution using a `MANIFEST` file. Via the Python 3 \"native namespace packages\" mechanism, (after some work in #31420, #28925), these distributions can be installed cleanly next to each other and provide the shared `sage.*` namespace.",
    "created_at": "2021-08-22T02:30:55Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524801",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:54'></a>
Replying to [@tscrim](#comment%3A53):
> So wouldn't it make sense to instead take the symbolics stuff out from Sage in one go rather than this two step process of add in pynac just to remove it later? Or is this just meant to be a stop-gap until it comes time to split everything?

The modularization plan does not involve "taking ... stuff out from Sage" at all. It will all remain in the same git repository, and also `src/sage` will remain monolithic.

Modularization is achieved by preparing sub-distributions defined using one of several possible mechanisms. Take a look at `sagemath-objects` from #29865 (https://pypi.org/project/sagemath-objects/), for example: It defines a sub-distribution using a `MANIFEST` file. Via the Python 3 "native namespace packages" mechanism, (after some work in #31420, #28925), these distributions can be installed cleanly next to each other and provide the shared `sage.*` namespace.



---

archive/issue_comments_524802.json:
```json
{
    "body": "**Changing dependencies** from \"#32391\" to \"#32391, #32407\".",
    "created_at": "2021-08-22T04:18:03Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524802",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#32391" to "#32391, #32407".



---

archive/issue_comments_524803.json:
```json
{
    "body": "**Changing commit** from \"[6a2ada278e567b7fafd06ce97cad895e1f323f95](https://github.com/sagemath/sagetrac-mirror/commit/6a2ada278e567b7fafd06ce97cad895e1f323f95)\" to \"[759aa5d012d2ee2924456cb8df33514e351d2ffb](https://github.com/sagemath/sagetrac-mirror/commit/759aa5d012d2ee2924456cb8df33514e351d2ffb)\".",
    "created_at": "2021-08-22T22:33:37Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524803",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6a2ada278e567b7fafd06ce97cad895e1f323f95](https://github.com/sagemath/sagetrac-mirror/commit/6a2ada278e567b7fafd06ce97cad895e1f323f95)" to "[759aa5d012d2ee2924456cb8df33514e351d2ffb](https://github.com/sagemath/sagetrac-mirror/commit/759aa5d012d2ee2924456cb8df33514e351d2ffb)".



---

archive/issue_comments_524804.json:
```json
{
    "body": "<a id='comment:56'></a>\n**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ef222579fae43a764bb65be8e8fc301be5c7cc35\">ef22257</a></td><td><code>src/sage/symbolic/function.pyx: Undo rename</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4ac54dfcb7d1ea7c4bc8cefabf93d18970c20bdb\">4ac54df</a></td><td><code>src/sage/symbolic/function.pyx: Replace cimport * by more specific cimport</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f49aee1af2c5effbb4d916f56cbae216045230f\">6f49aee</a></td><td><code>sage.symbolic.function.Function.__call__: Refactor through new helper function sage.symbolic.expression.call_by_ginac_serial</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f92b908d3ba7086a2559810595ac958d57367a9\">2f92b90</a></td><td><code>sage.symbolic.function.Function._register_function: Refactor through new function sage.symbolic.expression.register_or_update_function</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e81e6c71e7797b45ae8e96cec3bc9a9daac78475\">e81e6c7</a></td><td><code>sage.symbolic.function.GinacFunction._register_function: Refactor through sage.symbolic.expression.register_or_update_function</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d397ef1ada43b7f7884c29ab8235dcaf5d53fdab\">d397ef1</a></td><td><code>sage.symbolic.function: Remove unused imports, cimports</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1c43dbe157de2231d77edf97a7e46babc4952822\">1c43dbe</a></td><td><code>sage.symbolic.function.{GinacFunction,BuiltinFunction}._is_registered: Refactor through new function sage.symbolic.expression.find_registered_function; remove last pynac import</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9d4fe5fec91a2da1f9504b5869167bcb3634379f\">9d4fe5f</a></td><td><code>sage.symbolic.function: Remove unused cimport</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a9fdc750bc49f5e54cd04bdd0589bff32bb5b42\">9a9fdc7</a></td><td><code>Merge #32407</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/759aa5d012d2ee2924456cb8df33514e351d2ffb\">759aa5d</a></td><td><code>sage.symbolic.expression: Finish merging code using pynac into this one DSO</code></td></tr></table>\n",
    "created_at": "2021-08-22T22:33:37Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524804",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:56'></a>
**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ef222579fae43a764bb65be8e8fc301be5c7cc35">ef22257</a></td><td><code>src/sage/symbolic/function.pyx: Undo rename</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4ac54dfcb7d1ea7c4bc8cefabf93d18970c20bdb">4ac54df</a></td><td><code>src/sage/symbolic/function.pyx: Replace cimport * by more specific cimport</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f49aee1af2c5effbb4d916f56cbae216045230f">6f49aee</a></td><td><code>sage.symbolic.function.Function.__call__: Refactor through new helper function sage.symbolic.expression.call_by_ginac_serial</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f92b908d3ba7086a2559810595ac958d57367a9">2f92b90</a></td><td><code>sage.symbolic.function.Function._register_function: Refactor through new function sage.symbolic.expression.register_or_update_function</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e81e6c71e7797b45ae8e96cec3bc9a9daac78475">e81e6c7</a></td><td><code>sage.symbolic.function.GinacFunction._register_function: Refactor through sage.symbolic.expression.register_or_update_function</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d397ef1ada43b7f7884c29ab8235dcaf5d53fdab">d397ef1</a></td><td><code>sage.symbolic.function: Remove unused imports, cimports</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1c43dbe157de2231d77edf97a7e46babc4952822">1c43dbe</a></td><td><code>sage.symbolic.function.{GinacFunction,BuiltinFunction}._is_registered: Refactor through new function sage.symbolic.expression.find_registered_function; remove last pynac import</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9d4fe5fec91a2da1f9504b5869167bcb3634379f">9d4fe5f</a></td><td><code>sage.symbolic.function: Remove unused cimport</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a9fdc750bc49f5e54cd04bdd0589bff32bb5b42">9a9fdc7</a></td><td><code>Merge #32407</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/759aa5d012d2ee2924456cb8df33514e351d2ffb">759aa5d</a></td><td><code>sage.symbolic.expression: Finish merging code using pynac into this one DSO</code></td></tr></table>




---

archive/issue_comments_524805.json:
```json
{
    "body": "<a id='comment:57'></a>\nIt remains to remove the import cycle `sage.symbolic.ring` -> `sage.symbolic.expression` -> `sage.symbolic.function` -> `sage.symbolic.ring`",
    "created_at": "2021-08-22T22:34:53Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524805",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:57'></a>
It remains to remove the import cycle `sage.symbolic.ring` -> `sage.symbolic.expression` -> `sage.symbolic.function` -> `sage.symbolic.ring`



---

archive/issue_comments_524806.json:
```json
{
    "body": "<a id='comment:58'></a>\nAh, okay, I was thinking the modularization meant splitting Sage up into different subprojects that would have a main link that would be the actual Sage. However, it is a little different than that. I don't completely understand how all of this works and some of the benefits, but it doesn't seem to be as fragmented as I was thinking. Thank you.",
    "created_at": "2021-08-23T00:31:54Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524806",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:58'></a>
Ah, okay, I was thinking the modularization meant splitting Sage up into different subprojects that would have a main link that would be the actual Sage. However, it is a little different than that. I don't completely understand how all of this works and some of the benefits, but it doesn't seem to be as fragmented as I was thinking. Thank you.



---

archive/issue_comments_524807.json:
```json
{
    "body": "<a id='comment:59'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b6400149f26eba95779bac6d9cc79704a761c07c\">b640014</a></td><td><code>Replace import from sage.symbolic.pynac by sage.symbolic.expression</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/46c4a6b0b6815076d8f0f5925459bb221f2c408b\">46c4a6b</a></td><td><code>sage.symbolic.function: Move sfunction_serial_dict, get_sfunction_from_serial to .expression, refactor</code></td></tr></table>\n",
    "created_at": "2021-08-23T00:45:04Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524807",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:59'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b6400149f26eba95779bac6d9cc79704a761c07c">b640014</a></td><td><code>Replace import from sage.symbolic.pynac by sage.symbolic.expression</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/46c4a6b0b6815076d8f0f5925459bb221f2c408b">46c4a6b</a></td><td><code>sage.symbolic.function: Move sfunction_serial_dict, get_sfunction_from_serial to .expression, refactor</code></td></tr></table>




---

archive/issue_comments_524808.json:
```json
{
    "body": "**Changing commit** from \"[759aa5d012d2ee2924456cb8df33514e351d2ffb](https://github.com/sagemath/sagetrac-mirror/commit/759aa5d012d2ee2924456cb8df33514e351d2ffb)\" to \"[46c4a6b0b6815076d8f0f5925459bb221f2c408b](https://github.com/sagemath/sagetrac-mirror/commit/46c4a6b0b6815076d8f0f5925459bb221f2c408b)\".",
    "created_at": "2021-08-23T00:45:04Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524808",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[759aa5d012d2ee2924456cb8df33514e351d2ffb](https://github.com/sagemath/sagetrac-mirror/commit/759aa5d012d2ee2924456cb8df33514e351d2ffb)" to "[46c4a6b0b6815076d8f0f5925459bb221f2c408b](https://github.com/sagemath/sagetrac-mirror/commit/46c4a6b0b6815076d8f0f5925459bb221f2c408b)".



---

archive/issue_comments_524809.json:
```json
{
    "body": "**Changing commit** from \"[46c4a6b0b6815076d8f0f5925459bb221f2c408b](https://github.com/sagemath/sagetrac-mirror/commit/46c4a6b0b6815076d8f0f5925459bb221f2c408b)\" to \"[903792a901e783b70244efa2f8ed6cb4f1eaf454](https://github.com/sagemath/sagetrac-mirror/commit/903792a901e783b70244efa2f8ed6cb4f1eaf454)\".",
    "created_at": "2021-08-23T00:53:45Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524809",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[46c4a6b0b6815076d8f0f5925459bb221f2c408b](https://github.com/sagemath/sagetrac-mirror/commit/46c4a6b0b6815076d8f0f5925459bb221f2c408b)" to "[903792a901e783b70244efa2f8ed6cb4f1eaf454](https://github.com/sagemath/sagetrac-mirror/commit/903792a901e783b70244efa2f8ed6cb4f1eaf454)".



---

archive/issue_comments_524810.json:
```json
{
    "body": "<a id='comment:60'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/903792a901e783b70244efa2f8ed6cb4f1eaf454\">903792a</a></td><td><code>src/sage/symbolic/pynac_constant.py: New</code></td></tr></table>\n",
    "created_at": "2021-08-23T00:53:45Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524810",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:60'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/903792a901e783b70244efa2f8ed6cb4f1eaf454">903792a</a></td><td><code>src/sage/symbolic/pynac_constant.py: New</code></td></tr></table>




---

archive/issue_comments_524811.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,11 +2,15 @@\n \n Pynac has no other uses than as the core of the symbolic expressions facility of Sage; and cannot even be tested without Sage.\n \n-We merge Pynac (i.e., the directory https://github.com/pynac/pynac/tree/master/ginac) into the Sage library as `src/sage/symbolic/ginac`. It is not a very big package - one flat directory with 100 *.h and *.cpp files, a total of 50kLOC. (The existing Python/Cython symbolics code in `sage.symbolic`, `sage.calculus`, `sage.functions` is about 60kLOC.)\n+We merge Pynac (i.e., the directory https://github.com/pynac/pynac/tree/master/ginac) into the Sage library as `src/sage/symbolic/ginac`. It is not a very big package - one flat directory with 100 *.h and *.cpp files, a total of 50kLOC. (The existing !Python/Cython symbolics code in `sage.symbolic`, `sage.calculus`, `sage.functions` is about 60kLOC.)\n \n-This will solve the same issues that #30534 tried to address, which ran into unresolved technical difficulties.\n+The Pynac sources are compiled like other C++ sources that are already in the Sage source tree. They are linked into a single Python extension module, `sage.symbolic.expression`. All other extension modules that used to link to pynac (`sage.libs.pynac.pynac`, `sage.symbolic.function`, `sage.symbolic.series` etc.) are \n+- either refactored so that they only `import` helper functions provided by `sage.symbolic.expression` instead of having to `cimport` Pynac functions directly (see #32391, #32407)\n+- or merged into the extension module `sage.symbolic.expression` (via Cython `include` statements, not by copy-paste of source code, to keep the diff small)\n \n-It will also make it easier for Sage developers to make changes to Pynac.\n+This solves the same issues that #30534 tried to address, which ran into unresolved technical difficulties.\n+\n+It will also make it easier for Sage developers to make changes to Pynac and the related symbolic implementation.\n \n Follow-up: #32387 Remove pynac spkg\n \n``````\n",
    "created_at": "2021-08-23T01:14:09Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524811",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,11 +2,15 @@
 
 Pynac has no other uses than as the core of the symbolic expressions facility of Sage; and cannot even be tested without Sage.
 
-We merge Pynac (i.e., the directory https://github.com/pynac/pynac/tree/master/ginac) into the Sage library as `src/sage/symbolic/ginac`. It is not a very big package - one flat directory with 100 *.h and *.cpp files, a total of 50kLOC. (The existing Python/Cython symbolics code in `sage.symbolic`, `sage.calculus`, `sage.functions` is about 60kLOC.)
+We merge Pynac (i.e., the directory https://github.com/pynac/pynac/tree/master/ginac) into the Sage library as `src/sage/symbolic/ginac`. It is not a very big package - one flat directory with 100 *.h and *.cpp files, a total of 50kLOC. (The existing !Python/Cython symbolics code in `sage.symbolic`, `sage.calculus`, `sage.functions` is about 60kLOC.)
 
-This will solve the same issues that #30534 tried to address, which ran into unresolved technical difficulties.
+The Pynac sources are compiled like other C++ sources that are already in the Sage source tree. They are linked into a single Python extension module, `sage.symbolic.expression`. All other extension modules that used to link to pynac (`sage.libs.pynac.pynac`, `sage.symbolic.function`, `sage.symbolic.series` etc.) are 
+- either refactored so that they only `import` helper functions provided by `sage.symbolic.expression` instead of having to `cimport` Pynac functions directly (see #32391, #32407)
+- or merged into the extension module `sage.symbolic.expression` (via Cython `include` statements, not by copy-paste of source code, to keep the diff small)
 
-It will also make it easier for Sage developers to make changes to Pynac.
+This solves the same issues that #30534 tried to address, which ran into unresolved technical difficulties.
+
+It will also make it easier for Sage developers to make changes to Pynac and the related symbolic implementation.
 
 Follow-up: #32387 Remove pynac spkg
 
``````




---

archive/issue_comments_524812.json:
```json
{
    "body": "<a id='comment:62'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9f56aa26d702555868d3ba6d9b9338fc19aac390\">9f56aa2</a></td><td><code>sage.symbolic.ring: cimport the helper functions from sage.symbolic.expression (safe because expression.pxd no longer declares the Expression class)</code></td></tr></table>\n",
    "created_at": "2021-08-23T01:33:05Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524812",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:62'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9f56aa26d702555868d3ba6d9b9338fc19aac390">9f56aa2</a></td><td><code>sage.symbolic.ring: cimport the helper functions from sage.symbolic.expression (safe because expression.pxd no longer declares the Expression class)</code></td></tr></table>




---

archive/issue_comments_524813.json:
```json
{
    "body": "**Changing commit** from \"[903792a901e783b70244efa2f8ed6cb4f1eaf454](https://github.com/sagemath/sagetrac-mirror/commit/903792a901e783b70244efa2f8ed6cb4f1eaf454)\" to \"[9f56aa26d702555868d3ba6d9b9338fc19aac390](https://github.com/sagemath/sagetrac-mirror/commit/9f56aa26d702555868d3ba6d9b9338fc19aac390)\".",
    "created_at": "2021-08-23T01:33:05Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524813",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[903792a901e783b70244efa2f8ed6cb4f1eaf454](https://github.com/sagemath/sagetrac-mirror/commit/903792a901e783b70244efa2f8ed6cb4f1eaf454)" to "[9f56aa26d702555868d3ba6d9b9338fc19aac390](https://github.com/sagemath/sagetrac-mirror/commit/9f56aa26d702555868d3ba6d9b9338fc19aac390)".



---

archive/issue_comments_524814.json:
```json
{
    "body": "**Changing commit** from \"[9f56aa26d702555868d3ba6d9b9338fc19aac390](https://github.com/sagemath/sagetrac-mirror/commit/9f56aa26d702555868d3ba6d9b9338fc19aac390)\" to \"[3153781f5e6c02b9a1a0cef9f8295f206a702162](https://github.com/sagemath/sagetrac-mirror/commit/3153781f5e6c02b9a1a0cef9f8295f206a702162)\".",
    "created_at": "2021-08-23T02:02:05Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524814",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9f56aa26d702555868d3ba6d9b9338fc19aac390](https://github.com/sagemath/sagetrac-mirror/commit/9f56aa26d702555868d3ba6d9b9338fc19aac390)" to "[3153781f5e6c02b9a1a0cef9f8295f206a702162](https://github.com/sagemath/sagetrac-mirror/commit/3153781f5e6c02b9a1a0cef9f8295f206a702162)".



---

archive/issue_comments_524815.json:
```json
{
    "body": "<a id='comment:63'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3153781f5e6c02b9a1a0cef9f8295f206a702162\">3153781</a></td><td><code>WIP: Try to break import cycle</code></td></tr></table>\n",
    "created_at": "2021-08-23T02:02:05Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524815",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:63'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3153781f5e6c02b9a1a0cef9f8295f206a702162">3153781</a></td><td><code>WIP: Try to break import cycle</code></td></tr></table>




---

archive/issue_comments_524816.json:
```json
{
    "body": "<a id='comment:64'></a>\nStill struggling with an import cycle `sage.symbolic.ring` -> `sage.symbolic.expression` -> `sage.symbolic.ring`",
    "created_at": "2021-08-23T02:05:09Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524816",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:64'></a>
Still struggling with an import cycle `sage.symbolic.ring` -> `sage.symbolic.expression` -> `sage.symbolic.ring`



---

archive/issue_comments_524817.json:
```json
{
    "body": "<a id='comment:65'></a>\nHelp welcome",
    "created_at": "2021-08-23T02:05:28Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524817",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:65'></a>
Help welcome



---

archive/issue_comments_524818.json:
```json
{
    "body": "<a id='comment:66'></a>\nI recall that `i`, a.k.a. `I`, is really close the the center of the import troubles.",
    "created_at": "2021-08-23T07:08:27Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524818",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:66'></a>
I recall that `i`, a.k.a. `I`, is really close the the center of the import troubles.



---

archive/issue_comments_524819.json:
```json
{
    "body": "**Changing commit** from \"[3153781f5e6c02b9a1a0cef9f8295f206a702162](https://github.com/sagemath/sagetrac-mirror/commit/3153781f5e6c02b9a1a0cef9f8295f206a702162)\" to \"[7ce050fdea338610b91680584c0db59e54d4c5cf](https://github.com/sagemath/sagetrac-mirror/commit/7ce050fdea338610b91680584c0db59e54d4c5cf)\".",
    "created_at": "2021-08-23T10:50:46Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524819",
    "user": "https://github.com/kliem"
}
```

**Changing commit** from "[3153781f5e6c02b9a1a0cef9f8295f206a702162](https://github.com/sagemath/sagetrac-mirror/commit/3153781f5e6c02b9a1a0cef9f8295f206a702162)" to "[7ce050fdea338610b91680584c0db59e54d4c5cf](https://github.com/sagemath/sagetrac-mirror/commit/7ce050fdea338610b91680584c0db59e54d4c5cf)".



---

archive/issue_comments_524820.json:
```json
{
    "body": "<a id='comment:67'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/01dfef3756a4da5fc01355f10954dea69fbf01f6\">01dfef3</a></td><td><code>missing headers</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/04397d2e547f0a81c727165d9e9fee0d54b3ee6d\">04397d2</a></td><td><code>add missing singular libraries</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/70bcddf168950f477c2b56fca725e668a1236fb6\">70bcddf</a></td><td><code>simpler inclusion of headers</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7ce050fdea338610b91680584c0db59e54d4c5cf\">7ce050f</a></td><td><code>somewhat fix doctest</code></td></tr></table>\n",
    "created_at": "2021-08-23T10:50:46Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524820",
    "user": "https://github.com/kliem"
}
```

<a id='comment:67'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/01dfef3756a4da5fc01355f10954dea69fbf01f6">01dfef3</a></td><td><code>missing headers</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/04397d2e547f0a81c727165d9e9fee0d54b3ee6d">04397d2</a></td><td><code>add missing singular libraries</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/70bcddf168950f477c2b56fca725e668a1236fb6">70bcddf</a></td><td><code>simpler inclusion of headers</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7ce050fdea338610b91680584c0db59e54d4c5cf">7ce050f</a></td><td><code>somewhat fix doctest</code></td></tr></table>




---

archive/issue_comments_524821.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)\" to \"[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)\".",
    "created_at": "2021-08-23T10:50:46Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524821",
    "user": "https://github.com/kliem"
}
```

**Changing branch** from "[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)" to "[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)".



---

archive/issue_comments_524822.json:
```json
{
    "body": "**Changing author** from \"Matthias Koeppe\" to \"Matthias Koeppe, Jonathan Kliem\".",
    "created_at": "2021-08-23T10:50:46Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524822",
    "user": "https://github.com/kliem"
}
```

**Changing author** from "Matthias Koeppe" to "Matthias Koeppe, Jonathan Kliem".



---

archive/issue_comments_524823.json:
```json
{
    "body": "**Changing commit** from \"[7ce050fdea338610b91680584c0db59e54d4c5cf](https://github.com/sagemath/sagetrac-mirror/commit/7ce050fdea338610b91680584c0db59e54d4c5cf)\" to \"[48267a7cc19287bd9523370ea9ebbda6d3f1085b](https://github.com/sagemath/sagetrac-mirror/commit/48267a7cc19287bd9523370ea9ebbda6d3f1085b)\".",
    "created_at": "2021-08-23T10:51:00Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524823",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7ce050fdea338610b91680584c0db59e54d4c5cf](https://github.com/sagemath/sagetrac-mirror/commit/7ce050fdea338610b91680584c0db59e54d4c5cf)" to "[48267a7cc19287bd9523370ea9ebbda6d3f1085b](https://github.com/sagemath/sagetrac-mirror/commit/48267a7cc19287bd9523370ea9ebbda6d3f1085b)".



---

archive/issue_comments_524824.json:
```json
{
    "body": "<a id='comment:68'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a9fdc750bc49f5e54cd04bdd0589bff32bb5b42\">9a9fdc7</a></td><td><code>Merge #32407</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/759aa5d012d2ee2924456cb8df33514e351d2ffb\">759aa5d</a></td><td><code>sage.symbolic.expression: Finish merging code using pynac into this one DSO</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b6400149f26eba95779bac6d9cc79704a761c07c\">b640014</a></td><td><code>Replace import from sage.symbolic.pynac by sage.symbolic.expression</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/46c4a6b0b6815076d8f0f5925459bb221f2c408b\">46c4a6b</a></td><td><code>sage.symbolic.function: Move sfunction_serial_dict, get_sfunction_from_serial to .expression, refactor</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/903792a901e783b70244efa2f8ed6cb4f1eaf454\">903792a</a></td><td><code>src/sage/symbolic/pynac_constant.py: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9f56aa26d702555868d3ba6d9b9338fc19aac390\">9f56aa2</a></td><td><code>sage.symbolic.ring: cimport the helper functions from sage.symbolic.expression (safe because expression.pxd no longer declares the Expression class)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3153781f5e6c02b9a1a0cef9f8295f206a702162\">3153781</a></td><td><code>WIP: Try to break import cycle</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a56c69dd376731943b5edd9050adbe853f7c8efc\">a56c69d</a></td><td><code>fix startup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5b557c68dd722ae8063334b23a595f9b1482a5d7\">5b557c6</a></td><td><code>deprecation warnings</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/48267a7cc19287bd9523370ea9ebbda6d3f1085b\">48267a7</a></td><td><code>fix doctests</code></td></tr></table>\n",
    "created_at": "2021-08-23T10:51:00Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524824",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:68'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a9fdc750bc49f5e54cd04bdd0589bff32bb5b42">9a9fdc7</a></td><td><code>Merge #32407</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/759aa5d012d2ee2924456cb8df33514e351d2ffb">759aa5d</a></td><td><code>sage.symbolic.expression: Finish merging code using pynac into this one DSO</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b6400149f26eba95779bac6d9cc79704a761c07c">b640014</a></td><td><code>Replace import from sage.symbolic.pynac by sage.symbolic.expression</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/46c4a6b0b6815076d8f0f5925459bb221f2c408b">46c4a6b</a></td><td><code>sage.symbolic.function: Move sfunction_serial_dict, get_sfunction_from_serial to .expression, refactor</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/903792a901e783b70244efa2f8ed6cb4f1eaf454">903792a</a></td><td><code>src/sage/symbolic/pynac_constant.py: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9f56aa26d702555868d3ba6d9b9338fc19aac390">9f56aa2</a></td><td><code>sage.symbolic.ring: cimport the helper functions from sage.symbolic.expression (safe because expression.pxd no longer declares the Expression class)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3153781f5e6c02b9a1a0cef9f8295f206a702162">3153781</a></td><td><code>WIP: Try to break import cycle</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a56c69dd376731943b5edd9050adbe853f7c8efc">a56c69d</a></td><td><code>fix startup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5b557c68dd722ae8063334b23a595f9b1482a5d7">5b557c6</a></td><td><code>deprecation warnings</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/48267a7cc19287bd9523370ea9ebbda6d3f1085b">48267a7</a></td><td><code>fix doctests</code></td></tr></table>




---

archive/issue_events_291148.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-08-23T10:56:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291148"
}
```



---

archive/issue_events_291149.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-08-23T10:56:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291149"
}
```



---

archive/issue_comments_524825.json:
```json
{
    "body": "<a id='comment:69'></a>\nSeems to work now.",
    "created_at": "2021-08-23T10:56:25Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524825",
    "user": "https://github.com/kliem"
}
```

<a id='comment:69'></a>
Seems to work now.



---

archive/issue_comments_524826.json:
```json
{
    "body": "**Changing commit** from \"[48267a7cc19287bd9523370ea9ebbda6d3f1085b](https://github.com/sagemath/sagetrac-mirror/commit/48267a7cc19287bd9523370ea9ebbda6d3f1085b)\" to \"[5776163f25a6a26bb0063b56ad01517907c00b3a](https://github.com/sagemath/sagetrac-mirror/commit/5776163f25a6a26bb0063b56ad01517907c00b3a)\".",
    "created_at": "2021-08-23T15:19:04Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524826",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[48267a7cc19287bd9523370ea9ebbda6d3f1085b](https://github.com/sagemath/sagetrac-mirror/commit/48267a7cc19287bd9523370ea9ebbda6d3f1085b)" to "[5776163f25a6a26bb0063b56ad01517907c00b3a](https://github.com/sagemath/sagetrac-mirror/commit/5776163f25a6a26bb0063b56ad01517907c00b3a)".



---

archive/issue_comments_524827.json:
```json
{
    "body": "<a id='comment:70'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5776163f25a6a26bb0063b56ad01517907c00b3a\">5776163</a></td><td><code>wrong import</code></td></tr></table>\n",
    "created_at": "2021-08-23T15:19:04Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524827",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:70'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5776163f25a6a26bb0063b56ad01517907c00b3a">5776163</a></td><td><code>wrong import</code></td></tr></table>




---

archive/issue_comments_524828.json:
```json
{
    "body": "<a id='comment:71'></a>\nCool, thanks very much!!",
    "created_at": "2021-08-23T16:34:39Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524828",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:71'></a>
Cool, thanks very much!!



---

archive/issue_comments_524829.json:
```json
{
    "body": "<a id='comment:72'></a>\nI'm getting\n\n```\nsage -t --random-seed=0 src/sage/functions/prime_pi.pyx\n**********************************************************************\nFile \"src/sage/functions/prime_pi.pyx\", line 17, in sage.functions.prime_pi\nFailed example:\n    loads(dumps(z)) == z\nExpected:\n    True\nGot:\n    False\n```",
    "created_at": "2021-08-23T16:35:50Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524829",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:72'></a>
I'm getting

```
sage -t --random-seed=0 src/sage/functions/prime_pi.pyx
**********************************************************************
File "src/sage/functions/prime_pi.pyx", line 17, in sage.functions.prime_pi
Failed example:
    loads(dumps(z)) == z
Expected:
    True
Got:
    False
```



---

archive/issue_comments_524830.json:
```json
{
    "body": "<a id='comment:73'></a>\nIt will also need to be checked that the deferred imports (such as those introduced in my commit 3153781) do not lead to speed regressions",
    "created_at": "2021-08-23T16:38:35Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524830",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:73'></a>
It will also need to be checked that the deferred imports (such as those introduced in my commit 3153781) do not lead to speed regressions



---

archive/issue_comments_524831.json:
```json
{
    "body": "<a id='comment:74'></a>\nAlso I don't think we need `src/sage/symbolic/pynac.py` -- the module `sage.symbolic.pynac` only had a short-lived existence here in this branch.\nDid you mean to add these `lazy_import` to `src/sage/libs/pynac/pynac.py`?",
    "created_at": "2021-08-23T16:49:55Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524831",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:74'></a>
Also I don't think we need `src/sage/symbolic/pynac.py` -- the module `sage.symbolic.pynac` only had a short-lived existence here in this branch.
Did you mean to add these `lazy_import` to `src/sage/libs/pynac/pynac.py`?



---

archive/issue_comments_524832.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)\" to \"[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)\".",
    "created_at": "2021-08-23T17:21:24Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524832",
    "user": "https://github.com/mkoeppe"
}
```

**Changing branch** from "[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)" to "[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)".



---

archive/issue_comments_524833.json:
```json
{
    "body": "**Changing commit** from \"[5776163f25a6a26bb0063b56ad01517907c00b3a](https://github.com/sagemath/sagetrac-mirror/commit/5776163f25a6a26bb0063b56ad01517907c00b3a)\" to \"[a27d820bb00ddcd82353eec55eab8920920068b7](https://github.com/sagemath/sagetrac-mirror/commit/a27d820bb00ddcd82353eec55eab8920920068b7)\".",
    "created_at": "2021-08-23T17:54:37Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524833",
    "user": "https://github.com/kliem"
}
```

**Changing commit** from "[5776163f25a6a26bb0063b56ad01517907c00b3a](https://github.com/sagemath/sagetrac-mirror/commit/5776163f25a6a26bb0063b56ad01517907c00b3a)" to "[a27d820bb00ddcd82353eec55eab8920920068b7](https://github.com/sagemath/sagetrac-mirror/commit/a27d820bb00ddcd82353eec55eab8920920068b7)".



---

archive/issue_comments_524834.json:
```json
{
    "body": "<a id='comment:76'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c12e71e5c52fc773fa0e8beda90df200f4fb0583\">c12e71e</a></td><td><code>moved imports to libs/pynac/pynac.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b898086efb19438f7c313267c8f78158d13c0cdb\">b898086</a></td><td><code>fix serial getting of BuiltinFunction</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7e1715067e422bc924a7bf8c632502c50e7760e0\">7e17150</a></td><td><code>fixed import in doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4ec43a22f87ab7aadbf4de31ff0e6af6bb1d5495\">4ec43a2</a></td><td><code>src/sage/symbolic/ginac/README.md: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a27d820bb00ddcd82353eec55eab8920920068b7\">a27d820</a></td><td><code>Merge branch 'u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac' of git://trac.sagemath.org/sage into u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac</code></td></tr></table>\n",
    "created_at": "2021-08-23T17:54:37Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524834",
    "user": "https://github.com/kliem"
}
```

<a id='comment:76'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c12e71e5c52fc773fa0e8beda90df200f4fb0583">c12e71e</a></td><td><code>moved imports to libs/pynac/pynac.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b898086efb19438f7c313267c8f78158d13c0cdb">b898086</a></td><td><code>fix serial getting of BuiltinFunction</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7e1715067e422bc924a7bf8c632502c50e7760e0">7e17150</a></td><td><code>fixed import in doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4ec43a22f87ab7aadbf4de31ff0e6af6bb1d5495">4ec43a2</a></td><td><code>src/sage/symbolic/ginac/README.md: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a27d820bb00ddcd82353eec55eab8920920068b7">a27d820</a></td><td><code>Merge branch 'u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac' of git://trac.sagemath.org/sage into u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac</code></td></tr></table>




---

archive/issue_comments_524835.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)\" to \"[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)\".",
    "created_at": "2021-08-23T17:54:37Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524835",
    "user": "https://github.com/kliem"
}
```

**Changing branch** from "[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)" to "[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)".



---

archive/issue_comments_524836.json:
```json
{
    "body": "<a id='comment:77'></a>\nReplying to [@mkoeppe](#comment%3A72):\n> I'm getting\n> \n> ```\n> sage -t --random-seed=0 src/sage/functions/prime_pi.pyx\n> **********************************************************************\n> File \"src/sage/functions/prime_pi.pyx\", line 17, in sage.functions.prime_pi\n> Failed example:\n>     loads(dumps(z)) == z\n> Expected:\n>     True\n> Got:\n>     False\n> ```\n\nFixed.",
    "created_at": "2021-08-23T17:54:57Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524836",
    "user": "https://github.com/kliem"
}
```

<a id='comment:77'></a>
Replying to [@mkoeppe](#comment%3A72):
> I'm getting
> 
> ```
> sage -t --random-seed=0 src/sage/functions/prime_pi.pyx
> **********************************************************************
> File "src/sage/functions/prime_pi.pyx", line 17, in sage.functions.prime_pi
> Failed example:
>     loads(dumps(z)) == z
> Expected:
>     True
> Got:
>     False
> ```

Fixed.



---

archive/issue_comments_524837.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)\" to \"[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)\".",
    "created_at": "2021-08-23T18:34:06Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524837",
    "user": "https://github.com/mkoeppe"
}
```

**Changing branch** from "[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)" to "[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)".



---

archive/issue_comments_524838.json:
```json
{
    "body": "**Changing commit** from \"[a27d820bb00ddcd82353eec55eab8920920068b7](https://github.com/sagemath/sagetrac-mirror/commit/a27d820bb00ddcd82353eec55eab8920920068b7)\" to \"[2d2153446fc3bb4d2d17d32cc770c0efc5121ecf](https://github.com/sagemath/sagetrac-mirror/commit/2d2153446fc3bb4d2d17d32cc770c0efc5121ecf)\".",
    "created_at": "2021-08-23T18:51:10Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524838",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a27d820bb00ddcd82353eec55eab8920920068b7](https://github.com/sagemath/sagetrac-mirror/commit/a27d820bb00ddcd82353eec55eab8920920068b7)" to "[2d2153446fc3bb4d2d17d32cc770c0efc5121ecf](https://github.com/sagemath/sagetrac-mirror/commit/2d2153446fc3bb4d2d17d32cc770c0efc5121ecf)".



---

archive/issue_comments_524839.json:
```json
{
    "body": "<a id='comment:79'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2d2153446fc3bb4d2d17d32cc770c0efc5121ecf\">2d21534</a></td><td><code>src/sage/symbolic/expression.pyx: Update copyright according to 'git blame -w --date=format:%Y src/sage/symbolic/expression.pyx | sort -k2'</code></td></tr></table>\n",
    "created_at": "2021-08-23T18:51:10Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524839",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:79'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2d2153446fc3bb4d2d17d32cc770c0efc5121ecf">2d21534</a></td><td><code>src/sage/symbolic/expression.pyx: Update copyright according to 'git blame -w --date=format:%Y src/sage/symbolic/expression.pyx | sort -k2'</code></td></tr></table>




---

archive/issue_comments_524840.json:
```json
{
    "body": "<a id='comment:80'></a>\nIf we want to deprecate these reimports like you do here...\n\n```\n+++ b/src/sage/symbolic/series.py\n@@ -0,0 +1,2 @@\n+from sage.misc.lazy_import import lazy_import\n+lazy_import('sage.symbolic.expression', 'SymbolicSeries', deprecation=32386)\n```\n... then we should probably also do this in `substitution_map.py` (and perhaps other places).",
    "created_at": "2021-08-23T18:56:15Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524840",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:80'></a>
If we want to deprecate these reimports like you do here...

```
+++ b/src/sage/symbolic/series.py
@@ -0,0 +1,2 @@
+from sage.misc.lazy_import import lazy_import
+lazy_import('sage.symbolic.expression', 'SymbolicSeries', deprecation=32386)
```
... then we should probably also do this in `substitution_map.py` (and perhaps other places).



---

archive/issue_comments_524841.json:
```json
{
    "body": "<a id='comment:81'></a>\nI tried to get all places. I didn't do `substitution_map.py` because, you had already added the reimport.\n\nI did those lazy imports here, so that people importing python functions from places where they used to be, get a proper deprecation warning:\n\nhttps://github.com/sagemath/sagetrac-mirror/commit/5b557c68dd722ae8063334b23a595f9b1482a5d7",
    "created_at": "2021-08-23T19:00:39Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524841",
    "user": "https://github.com/kliem"
}
```

<a id='comment:81'></a>
I tried to get all places. I didn't do `substitution_map.py` because, you had already added the reimport.

I did those lazy imports here, so that people importing python functions from places where they used to be, get a proper deprecation warning:

https://github.com/sagemath/sagetrac-mirror/commit/5b557c68dd722ae8063334b23a595f9b1482a5d7



---

archive/issue_comments_524842.json:
```json
{
    "body": "**Changing commit** from \"[2d2153446fc3bb4d2d17d32cc770c0efc5121ecf](https://github.com/sagemath/sagetrac-mirror/commit/2d2153446fc3bb4d2d17d32cc770c0efc5121ecf)\" to \"[03a4b83be3c6379679cb1b138ee440f60db2710c](https://github.com/sagemath/sagetrac-mirror/commit/03a4b83be3c6379679cb1b138ee440f60db2710c)\".",
    "created_at": "2021-08-23T19:00:45Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524842",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[2d2153446fc3bb4d2d17d32cc770c0efc5121ecf](https://github.com/sagemath/sagetrac-mirror/commit/2d2153446fc3bb4d2d17d32cc770c0efc5121ecf)" to "[03a4b83be3c6379679cb1b138ee440f60db2710c](https://github.com/sagemath/sagetrac-mirror/commit/03a4b83be3c6379679cb1b138ee440f60db2710c)".



---

archive/issue_comments_524843.json:
```json
{
    "body": "<a id='comment:82'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/03a4b83be3c6379679cb1b138ee440f60db2710c\">03a4b83</a></td><td><code>src/sage/symbolic/function.pyx: Update copyright according to 'git blame -w --date=format:%Y src/sage/symbolic/function.pyx | sort -k2'</code></td></tr></table>\n",
    "created_at": "2021-08-23T19:00:45Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524843",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:82'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/03a4b83be3c6379679cb1b138ee440f60db2710c">03a4b83</a></td><td><code>src/sage/symbolic/function.pyx: Update copyright according to 'git blame -w --date=format:%Y src/sage/symbolic/function.pyx | sort -k2'</code></td></tr></table>




---

archive/issue_comments_524844.json:
```json
{
    "body": "**Changing commit** from \"[03a4b83be3c6379679cb1b138ee440f60db2710c](https://github.com/sagemath/sagetrac-mirror/commit/03a4b83be3c6379679cb1b138ee440f60db2710c)\" to \"[53453b4d897219e536450651225fb2d2a0b71e92](https://github.com/sagemath/sagetrac-mirror/commit/53453b4d897219e536450651225fb2d2a0b71e92)\".",
    "created_at": "2021-08-23T22:44:22Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524844",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[03a4b83be3c6379679cb1b138ee440f60db2710c](https://github.com/sagemath/sagetrac-mirror/commit/03a4b83be3c6379679cb1b138ee440f60db2710c)" to "[53453b4d897219e536450651225fb2d2a0b71e92](https://github.com/sagemath/sagetrac-mirror/commit/53453b4d897219e536450651225fb2d2a0b71e92)".



---

archive/issue_comments_524845.json:
```json
{
    "body": "<a id='comment:83'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/53453b4d897219e536450651225fb2d2a0b71e92\">53453b4</a></td><td><code>src/sage/symbolic/*_impl.pxi: Update copyright according to git blame</code></td></tr></table>\n",
    "created_at": "2021-08-23T22:44:22Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524845",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:83'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/53453b4d897219e536450651225fb2d2a0b71e92">53453b4</a></td><td><code>src/sage/symbolic/*_impl.pxi: Update copyright according to git blame</code></td></tr></table>




---

archive/issue_comments_524846.json:
```json
{
    "body": "<a id='comment:84'></a>\nReplying to [@mkoeppe](#comment%3A73):\n> It will also need to be checked that the deferred imports (such as those introduced in my commit 3153781) do not lead to speed regressions\n\nA quick comparison using `./sage -tp --long src/sage/symbolic/ src/sage/functions/ src/sage/calculus/ src/sage/manifolds/` shows a serious slowdown around +30% with this branch",
    "created_at": "2021-08-24T00:42:08Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524846",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:84'></a>
Replying to [@mkoeppe](#comment%3A73):
> It will also need to be checked that the deferred imports (such as those introduced in my commit 3153781) do not lead to speed regressions

A quick comparison using `./sage -tp --long src/sage/symbolic/ src/sage/functions/ src/sage/calculus/ src/sage/manifolds/` shows a serious slowdown around +30% with this branch



---

archive/issue_events_291150.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-24T00:42:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291150"
}
```



---

archive/issue_events_291151.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-24T00:42:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291151"
}
```



---

archive/issue_comments_524847.json:
```json
{
    "body": "<a id='comment:85'></a>\nI cannot reproduce these timings any more; perhaps this was just from CPU throttling.",
    "created_at": "2021-08-24T03:52:37Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524847",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:85'></a>
I cannot reproduce these timings any more; perhaps this was just from CPU throttling.



---

archive/issue_events_291152.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-24T03:53:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291152"
}
```



---

archive/issue_events_291153.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-24T03:53:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291153"
}
```



---

archive/issue_comments_524848.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)\" to \"[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)\".",
    "created_at": "2021-08-24T11:42:11Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524848",
    "user": "https://github.com/kliem"
}
```

**Changing branch** from "[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)" to "[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)".



---

archive/issue_comments_524849.json:
```json
{
    "body": "<a id='comment:87'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e79cc47188db3896891d951f63973994d64251be\">e79cc47</a></td><td><code>sporadic failing tests</code></td></tr></table>\n",
    "created_at": "2021-08-24T11:42:11Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524849",
    "user": "https://github.com/kliem"
}
```

<a id='comment:87'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e79cc47188db3896891d951f63973994d64251be">e79cc47</a></td><td><code>sporadic failing tests</code></td></tr></table>




---

archive/issue_comments_524850.json:
```json
{
    "body": "**Changing commit** from \"[53453b4d897219e536450651225fb2d2a0b71e92](https://github.com/sagemath/sagetrac-mirror/commit/53453b4d897219e536450651225fb2d2a0b71e92)\" to \"[e79cc47188db3896891d951f63973994d64251be](https://github.com/sagemath/sagetrac-mirror/commit/e79cc47188db3896891d951f63973994d64251be)\".",
    "created_at": "2021-08-24T11:42:11Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524850",
    "user": "https://github.com/kliem"
}
```

**Changing commit** from "[53453b4d897219e536450651225fb2d2a0b71e92](https://github.com/sagemath/sagetrac-mirror/commit/53453b4d897219e536450651225fb2d2a0b71e92)" to "[e79cc47188db3896891d951f63973994d64251be](https://github.com/sagemath/sagetrac-mirror/commit/e79cc47188db3896891d951f63973994d64251be)".



---

archive/issue_comments_524851.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)\" to \"[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)\".",
    "created_at": "2021-08-24T17:40:27Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524851",
    "user": "https://github.com/mkoeppe"
}
```

**Changing branch** from "[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)" to "[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)".



---

archive/issue_comments_524852.json:
```json
{
    "body": "<a id='comment:89'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ac9c9594cc1d0e12cb91214a9be3d8c1ec293e4d\">ac9c959</a></td><td><code>sage.symbolic.pynac_constant: Use lazy_import with deprecation</code></td></tr></table>\n",
    "created_at": "2021-08-24T18:01:09Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524852",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:89'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ac9c9594cc1d0e12cb91214a9be3d8c1ec293e4d">ac9c959</a></td><td><code>sage.symbolic.pynac_constant: Use lazy_import with deprecation</code></td></tr></table>




---

archive/issue_comments_524853.json:
```json
{
    "body": "**Changing commit** from \"[e79cc47188db3896891d951f63973994d64251be](https://github.com/sagemath/sagetrac-mirror/commit/e79cc47188db3896891d951f63973994d64251be)\" to \"[ac9c9594cc1d0e12cb91214a9be3d8c1ec293e4d](https://github.com/sagemath/sagetrac-mirror/commit/ac9c9594cc1d0e12cb91214a9be3d8c1ec293e4d)\".",
    "created_at": "2021-08-24T18:01:09Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524853",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e79cc47188db3896891d951f63973994d64251be](https://github.com/sagemath/sagetrac-mirror/commit/e79cc47188db3896891d951f63973994d64251be)" to "[ac9c9594cc1d0e12cb91214a9be3d8c1ec293e4d](https://github.com/sagemath/sagetrac-mirror/commit/ac9c9594cc1d0e12cb91214a9be3d8c1ec293e4d)".



---

archive/issue_comments_524854.json:
```json
{
    "body": "<a id='comment:90'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d680c35562f8925640e24fd421fd9ddf348dd301\">d680c35</a></td><td><code>sage.symbolic.expression.call_registered_function: Rename from call_by_ginac_serial</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1f761d88643c2ff64913ec3a7a836f3d292eecf1\">1f761d8</a></td><td><code>src/sage/symbolic/pynac_function_impl.pxi: Split out from src/sage/symbolic/expression.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/47adbccd75968e5e40f36dbbed0aa57e4918043e\">47adbcc</a></td><td><code>src/sage/symbolic/pynac_function_impl.pxi: Add doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1d07a025f6c71f5d6ef94bfc49c86cb07dd9d59c\">1d07a02</a></td><td><code>Merge #32407</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e9c8637392c1a811b53b4d9ae21799d02b38a8c8\">e9c8637</a></td><td><code>get_sfunction_from_hash: Add doctest</code></td></tr></table>\n",
    "created_at": "2021-08-24T21:05:46Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524854",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:90'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d680c35562f8925640e24fd421fd9ddf348dd301">d680c35</a></td><td><code>sage.symbolic.expression.call_registered_function: Rename from call_by_ginac_serial</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1f761d88643c2ff64913ec3a7a836f3d292eecf1">1f761d8</a></td><td><code>src/sage/symbolic/pynac_function_impl.pxi: Split out from src/sage/symbolic/expression.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/47adbccd75968e5e40f36dbbed0aa57e4918043e">47adbcc</a></td><td><code>src/sage/symbolic/pynac_function_impl.pxi: Add doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1d07a025f6c71f5d6ef94bfc49c86cb07dd9d59c">1d07a02</a></td><td><code>Merge #32407</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e9c8637392c1a811b53b4d9ae21799d02b38a8c8">e9c8637</a></td><td><code>get_sfunction_from_hash: Add doctest</code></td></tr></table>




---

archive/issue_comments_524855.json:
```json
{
    "body": "**Changing commit** from \"[ac9c9594cc1d0e12cb91214a9be3d8c1ec293e4d](https://github.com/sagemath/sagetrac-mirror/commit/ac9c9594cc1d0e12cb91214a9be3d8c1ec293e4d)\" to \"[e9c8637392c1a811b53b4d9ae21799d02b38a8c8](https://github.com/sagemath/sagetrac-mirror/commit/e9c8637392c1a811b53b4d9ae21799d02b38a8c8)\".",
    "created_at": "2021-08-24T21:05:46Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524855",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ac9c9594cc1d0e12cb91214a9be3d8c1ec293e4d](https://github.com/sagemath/sagetrac-mirror/commit/ac9c9594cc1d0e12cb91214a9be3d8c1ec293e4d)" to "[e9c8637392c1a811b53b4d9ae21799d02b38a8c8](https://github.com/sagemath/sagetrac-mirror/commit/e9c8637392c1a811b53b4d9ae21799d02b38a8c8)".



---

archive/issue_comments_524856.json:
```json
{
    "body": "<a id='comment:91'></a>\nIf I understand well, that means that when sage 9.5 enters Debian pynac can be let go.\n\nIs that right?\n\n(Asking as the one responsible for pynac in Debian: [package tracker](https://tracker.debian.org/pkg/pynac))",
    "created_at": "2021-08-25T06:56:14Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524856",
    "user": "https://trac.sagemath.org/admin/accounts/users/Snark"
}
```

<a id='comment:91'></a>
If I understand well, that means that when sage 9.5 enters Debian pynac can be let go.

Is that right?

(Asking as the one responsible for pynac in Debian: [package tracker](https://tracker.debian.org/pkg/pynac))



---

archive/issue_comments_524857.json:
```json
{
    "body": "<a id='comment:92'></a>\nReplying to [Snark](#comment%3A91):\n> If I understand well, that means that when sage 9.5 enters Debian pynac can be let go.\n> \n> Is that right?\n> \n> (Asking as the one responsible for pynac in Debian: [package tracker](https://tracker.debian.org/pkg/pynac))\n\nYes, you understand well.",
    "created_at": "2021-08-25T08:03:39Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524857",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:92'></a>
Replying to [Snark](#comment%3A91):
> If I understand well, that means that when sage 9.5 enters Debian pynac can be let go.
> 
> Is that right?
> 
> (Asking as the one responsible for pynac in Debian: [package tracker](https://tracker.debian.org/pkg/pynac))

Yes, you understand well.



---

archive/issue_comments_524858.json:
```json
{
    "body": "<a id='comment:93'></a>\n\n```\nsage -t --long --random-seed=0 src/sage/misc/sageinspect.py\n**********************************************************************\nFile \"src/sage/misc/sageinspect.py\", line 2263, in sage.misc.sageinspect.sage_getsourcelines\nFailed example:\n    lines, lineno = sage_getsourcelines(x); lines[0:2]\nExpected:\n    ['cdef class Expression(CommutativeRingElement):\\n',\n     '    cpdef object pyobject(self):\\n']\nGot:\n    ['cdef class Expression(CommutativeRingElement):\\n', '\\n']\n```",
    "created_at": "2021-08-25T15:57:55Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524858",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:93'></a>

```
sage -t --long --random-seed=0 src/sage/misc/sageinspect.py
**********************************************************************
File "src/sage/misc/sageinspect.py", line 2263, in sage.misc.sageinspect.sage_getsourcelines
Failed example:
    lines, lineno = sage_getsourcelines(x); lines[0:2]
Expected:
    ['cdef class Expression(CommutativeRingElement):\n',
     '    cpdef object pyobject(self):\n']
Got:
    ['cdef class Expression(CommutativeRingElement):\n', '\n']
```



---

archive/issue_comments_524859.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)\" to \"[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)\".",
    "created_at": "2021-08-25T17:25:53Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524859",
    "user": "https://github.com/kliem"
}
```

**Changing branch** from "[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)" to "[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)".



---

archive/issue_comments_524860.json:
```json
{
    "body": "**Changing commit** from \"[e9c8637392c1a811b53b4d9ae21799d02b38a8c8](https://github.com/sagemath/sagetrac-mirror/commit/e9c8637392c1a811b53b4d9ae21799d02b38a8c8)\" to \"[712f9261c25496053ae203ec6b12b6410560f01c](https://github.com/sagemath/sagetrac-mirror/commit/712f9261c25496053ae203ec6b12b6410560f01c)\".",
    "created_at": "2021-08-25T17:25:53Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524860",
    "user": "https://github.com/kliem"
}
```

**Changing commit** from "[e9c8637392c1a811b53b4d9ae21799d02b38a8c8](https://github.com/sagemath/sagetrac-mirror/commit/e9c8637392c1a811b53b4d9ae21799d02b38a8c8)" to "[712f9261c25496053ae203ec6b12b6410560f01c](https://github.com/sagemath/sagetrac-mirror/commit/712f9261c25496053ae203ec6b12b6410560f01c)".



---

archive/issue_comments_524861.json:
```json
{
    "body": "<a id='comment:94'></a>\nFixed that test in `sageinspect.py`.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/712f9261c25496053ae203ec6b12b6410560f01c\">712f926</a></td><td><code>fix doctest getting source code</code></td></tr></table>\n",
    "created_at": "2021-08-25T17:25:53Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524861",
    "user": "https://github.com/kliem"
}
```

<a id='comment:94'></a>
Fixed that test in `sageinspect.py`.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/712f9261c25496053ae203ec6b12b6410560f01c">712f926</a></td><td><code>fix doctest getting source code</code></td></tr></table>




---

archive/issue_comments_524862.json:
```json
{
    "body": "<a id='comment:95'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/97060e941a2eeae71fbb7a740a0f44c0c3233d75\">97060e9</a></td><td><code>fix docbuild</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d062ed36ce07dde3c9ba0b3ae7e39e825a6a1b2\">5d062ed</a></td><td><code>one more doctest</code></td></tr></table>\n",
    "created_at": "2021-08-25T21:26:50Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524862",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:95'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/97060e941a2eeae71fbb7a740a0f44c0c3233d75">97060e9</a></td><td><code>fix docbuild</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d062ed36ce07dde3c9ba0b3ae7e39e825a6a1b2">5d062ed</a></td><td><code>one more doctest</code></td></tr></table>




---

archive/issue_comments_524863.json:
```json
{
    "body": "**Changing commit** from \"[712f9261c25496053ae203ec6b12b6410560f01c](https://github.com/sagemath/sagetrac-mirror/commit/712f9261c25496053ae203ec6b12b6410560f01c)\" to \"[5d062ed36ce07dde3c9ba0b3ae7e39e825a6a1b2](https://github.com/sagemath/sagetrac-mirror/commit/5d062ed36ce07dde3c9ba0b3ae7e39e825a6a1b2)\".",
    "created_at": "2021-08-25T21:26:50Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524863",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[712f9261c25496053ae203ec6b12b6410560f01c](https://github.com/sagemath/sagetrac-mirror/commit/712f9261c25496053ae203ec6b12b6410560f01c)" to "[5d062ed36ce07dde3c9ba0b3ae7e39e825a6a1b2](https://github.com/sagemath/sagetrac-mirror/commit/5d062ed36ce07dde3c9ba0b3ae7e39e825a6a1b2)".



---

archive/issue_comments_524864.json:
```json
{
    "body": "<a id='comment:96'></a>\nCoverage is still an issue, e.g. `new_Expression_from_pyobject` doesn't even have a docstring.",
    "created_at": "2021-08-25T21:27:51Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524864",
    "user": "https://github.com/kliem"
}
```

<a id='comment:96'></a>
Coverage is still an issue, e.g. `new_Expression_from_pyobject` doesn't even have a docstring.



---

archive/issue_comments_524865.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)\" to \"[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)\".",
    "created_at": "2021-08-25T23:04:10Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524865",
    "user": "https://github.com/mkoeppe"
}
```

**Changing branch** from "[u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/merge_pynac_as_src_sage_symbolic_ginac)" to "[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)".



---

archive/issue_comments_524866.json:
```json
{
    "body": "<a id='comment:98'></a>\nI've solved this by consolidating two similar functions into one \n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3f1ac2e8a415de7612f3b9c5ad82165761b61fad\">3f1ac2e</a></td><td><code>sage.symbolic.expression: Merge new_Expression_from_pyobject and new_Expression_force_pyobject</code></td></tr></table>\n",
    "created_at": "2021-08-25T23:04:42Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524866",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:98'></a>
I've solved this by consolidating two similar functions into one 

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3f1ac2e8a415de7612f3b9c5ad82165761b61fad">3f1ac2e</a></td><td><code>sage.symbolic.expression: Merge new_Expression_from_pyobject and new_Expression_force_pyobject</code></td></tr></table>




---

archive/issue_comments_524867.json:
```json
{
    "body": "**Changing commit** from \"[5d062ed36ce07dde3c9ba0b3ae7e39e825a6a1b2](https://github.com/sagemath/sagetrac-mirror/commit/5d062ed36ce07dde3c9ba0b3ae7e39e825a6a1b2)\" to \"[3f1ac2e8a415de7612f3b9c5ad82165761b61fad](https://github.com/sagemath/sagetrac-mirror/commit/3f1ac2e8a415de7612f3b9c5ad82165761b61fad)\".",
    "created_at": "2021-08-25T23:04:42Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524867",
    "user": "https://github.com/mkoeppe"
}
```

**Changing commit** from "[5d062ed36ce07dde3c9ba0b3ae7e39e825a6a1b2](https://github.com/sagemath/sagetrac-mirror/commit/5d062ed36ce07dde3c9ba0b3ae7e39e825a6a1b2)" to "[3f1ac2e8a415de7612f3b9c5ad82165761b61fad](https://github.com/sagemath/sagetrac-mirror/commit/3f1ac2e8a415de7612f3b9c5ad82165761b61fad)".



---

archive/issue_comments_524868.json:
```json
{
    "body": "**Reviewer:** https://github.com/mkoeppe/sage/actions/runs/1168763794, https://github.com/mkoeppe/sage/actions/runs/1168763799, ...",
    "created_at": "2021-08-26T01:48:19Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524868",
    "user": "https://github.com/mkoeppe"
}
```

**Reviewer:** https://github.com/mkoeppe/sage/actions/runs/1168763794, https://github.com/mkoeppe/sage/actions/runs/1168763799, ...



---

archive/issue_comments_524869.json:
```json
{
    "body": "**Changing commit** from \"[3f1ac2e8a415de7612f3b9c5ad82165761b61fad](https://github.com/sagemath/sagetrac-mirror/commit/3f1ac2e8a415de7612f3b9c5ad82165761b61fad)\" to \"[0643756930700a165b83987dc9d51e6105e2945a](https://github.com/sagemath/sagetrac-mirror/commit/0643756930700a165b83987dc9d51e6105e2945a)\".",
    "created_at": "2021-08-26T18:24:46Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524869",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[3f1ac2e8a415de7612f3b9c5ad82165761b61fad](https://github.com/sagemath/sagetrac-mirror/commit/3f1ac2e8a415de7612f3b9c5ad82165761b61fad)" to "[0643756930700a165b83987dc9d51e6105e2945a](https://github.com/sagemath/sagetrac-mirror/commit/0643756930700a165b83987dc9d51e6105e2945a)".



---

archive/issue_comments_524870.json:
```json
{
    "body": "<a id='comment:0'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0643756930700a165b83987dc9d51e6105e2945a\">0643756</a></td><td><code>new_Expression_from_pyobject: Add output for new doctests</code></td></tr></table>\n",
    "created_at": "2021-08-26T18:24:46Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524870",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0643756930700a165b83987dc9d51e6105e2945a">0643756</a></td><td><code>new_Expression_from_pyobject: Add output for new doctests</code></td></tr></table>




---

archive/issue_comments_524871.json:
```json
{
    "body": "**Changing commit** from \"[0643756930700a165b83987dc9d51e6105e2945a](https://github.com/sagemath/sagetrac-mirror/commit/0643756930700a165b83987dc9d51e6105e2945a)\" to \"[327ca5f3f5ca2c28d0c66685a2b528c88c10d265](https://github.com/sagemath/sagetrac-mirror/commit/327ca5f3f5ca2c28d0c66685a2b528c88c10d265)\".",
    "created_at": "2021-08-26T19:37:18Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524871",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0643756930700a165b83987dc9d51e6105e2945a](https://github.com/sagemath/sagetrac-mirror/commit/0643756930700a165b83987dc9d51e6105e2945a)" to "[327ca5f3f5ca2c28d0c66685a2b528c88c10d265](https://github.com/sagemath/sagetrac-mirror/commit/327ca5f3f5ca2c28d0c66685a2b528c88c10d265)".



---

archive/issue_comments_524872.json:
```json
{
    "body": "<a id='comment:1'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7f1e5bea8523d42b8daa0f2c21123cfd3cc2fe17\">7f1e5be</a></td><td><code>src/sage/symbolic/pynac_function_impl.pxi: Remove unused import in doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/06e8c31893082088270d595460935163b92010c7\">06e8c31</a></td><td><code>src/sage/symbolic/pynac_function_impl.pxi: Fix doc markup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/327ca5f3f5ca2c28d0c66685a2b528c88c10d265\">327ca5f</a></td><td><code>Merge #32407</code></td></tr></table>\n",
    "created_at": "2021-08-26T19:37:18Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524872",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7f1e5bea8523d42b8daa0f2c21123cfd3cc2fe17">7f1e5be</a></td><td><code>src/sage/symbolic/pynac_function_impl.pxi: Remove unused import in doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/06e8c31893082088270d595460935163b92010c7">06e8c31</a></td><td><code>src/sage/symbolic/pynac_function_impl.pxi: Fix doc markup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/327ca5f3f5ca2c28d0c66685a2b528c88c10d265">327ca5f</a></td><td><code>Merge #32407</code></td></tr></table>




---

archive/issue_comments_524873.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe portability tests on GH Actions ran through successfully. \n\nReady for review",
    "created_at": "2021-08-27T23:06:23Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524873",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
The portability tests on GH Actions ran through successfully. 

Ready for review



---

archive/issue_comments_524874.json:
```json
{
    "body": "<a id='comment:4'></a>\nthere is a failing test:\n\n```\ne023915d474 (Markus Wageringel   2021-06-15 19:54:54 +0200 340)     sage: result = integral(sinh(x^2+sqrt(x-1)),x)  # long time (15s on sage.math, 2012)\ne023915d474 (Markus Wageringel   2021-06-15 19:54:54 +0200 341)     ...\ne023915d474 (Markus Wageringel   2021-06-15 19:54:54 +0200 342)     sage: result\nd0c52e4aa36 (Jean-Pierre Flori   2013-05-27 15:36:24 +0200 343)     integrate(sinh(x^2 + sqrt(x - 1)), x)\n```\nline 342 needs `# long time` tag.",
    "created_at": "2021-09-03T16:33:29Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524874",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>
there is a failing test:

```
e023915d474 (Markus Wageringel   2021-06-15 19:54:54 +0200 340)     sage: result = integral(sinh(x^2+sqrt(x-1)),x)  # long time (15s on sage.math, 2012)
e023915d474 (Markus Wageringel   2021-06-15 19:54:54 +0200 341)     ...
e023915d474 (Markus Wageringel   2021-06-15 19:54:54 +0200 342)     sage: result
d0c52e4aa36 (Jean-Pierre Flori   2013-05-27 15:36:24 +0200 343)     integrate(sinh(x^2 + sqrt(x - 1)), x)
```
line 342 needs `# long time` tag.



---

archive/issue_comments_524875.json:
```json
{
    "body": "<a id='comment:5'></a>\nUnrelated to this ticket but yes",
    "created_at": "2021-09-03T17:18:48Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524875",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
Unrelated to this ticket but yes



---

archive/issue_comments_524876.json:
```json
{
    "body": "<a id='comment:6'></a>\nopened #32461 for this",
    "created_at": "2021-09-03T17:24:47Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524876",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>
opened #32461 for this



---

archive/issue_events_291154.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-09-03T19:29:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291154"
}
```



---

archive/issue_events_291155.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-09-03T19:29:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291155"
}
```



---

archive/issue_comments_524877.json:
```json
{
    "body": "**Changing reviewer** from \"https://github.com/mkoeppe/sage/actions/runs/1168763794, https://github.com/mkoeppe/sage/actions/runs/1168763799, ...\" to \"Dima Pasechnik\".",
    "created_at": "2021-09-03T19:29:00Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524877",
    "user": "https://github.com/dimpase"
}
```

**Changing reviewer** from "https://github.com/mkoeppe/sage/actions/runs/1168763794, https://github.com/mkoeppe/sage/actions/runs/1168763799, ..." to "Dima Pasechnik".



---

archive/issue_comments_524878.json:
```json
{
    "body": "<a id='comment:7'></a>\nlgtm",
    "created_at": "2021-09-03T19:29:00Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524878",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>
lgtm



---

archive/issue_comments_524879.json:
```json
{
    "body": "<a id='comment:8'></a>\nThank you!",
    "created_at": "2021-09-03T19:53:10Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524879",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
Thank you!



---

archive/issue_comments_524880.json:
```json
{
    "body": "<a id='comment:9'></a>\nshould #32461  be a dependency here?",
    "created_at": "2021-09-04T08:45:48Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524880",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'></a>
should #32461  be a dependency here?



---

archive/issue_comments_524881.json:
```json
{
    "body": "**Changing dependencies** from \"#32391, #32407\" to \"#32391, #32407, #32461\".",
    "created_at": "2021-09-04T16:18:10Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524881",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#32391, #32407" to "#32391, #32407, #32461".



---

archive/issue_comments_524882.json:
```json
{
    "body": "**Changing commit** from \"[327ca5f3f5ca2c28d0c66685a2b528c88c10d265](https://github.com/sagemath/sagetrac-mirror/commit/327ca5f3f5ca2c28d0c66685a2b528c88c10d265)\" to \"[0d0b58f65c0ca01d51756798d6910efb5f26f47c](https://github.com/sagemath/sagetrac-mirror/commit/0d0b58f65c0ca01d51756798d6910efb5f26f47c)\".",
    "created_at": "2021-09-13T23:39:27Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524882",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[327ca5f3f5ca2c28d0c66685a2b528c88c10d265](https://github.com/sagemath/sagetrac-mirror/commit/327ca5f3f5ca2c28d0c66685a2b528c88c10d265)" to "[0d0b58f65c0ca01d51756798d6910efb5f26f47c](https://github.com/sagemath/sagetrac-mirror/commit/0d0b58f65c0ca01d51756798d6910efb5f26f47c)".



---

archive/issue_events_291156.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2021-09-13T23:39:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291156"
}
```



---

archive/issue_events_291157.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2021-09-13T23:39:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291157"
}
```



---

archive/issue_comments_524883.json:
```json
{
    "body": "<a id='comment:1'></a>\n**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0d0b58f65c0ca01d51756798d6910efb5f26f47c\">0d0b58f</a></td><td><code>Merge tag '9.5.beta1' into t/32386/merge_pynac_as_src_sage_symbolic_ginac</code></td></tr></table>\n",
    "created_at": "2021-09-13T23:39:27Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524883",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>
**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0d0b58f65c0ca01d51756798d6910efb5f26f47c">0d0b58f</a></td><td><code>Merge tag '9.5.beta1' into t/32386/merge_pynac_as_src_sage_symbolic_ginac</code></td></tr></table>




---

archive/issue_events_291158.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-13T23:40:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291158"
}
```



---

archive/issue_events_291159.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-13T23:40:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291159"
}
```



---

archive/issue_events_291160.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-09-15T22:06:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291160"
}
```



---

archive/issue_events_291161.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "95fbd7cb875701c201879f7a6faa3f7a9a9c0b30",
    "created_at": "2021-09-15T22:06:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32386#event-291161"
}
```



---

archive/issue_comments_524884.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)\" to \"[0d0b58f65c0ca01d51756798d6910efb5f26f47c](https://github.com/sagemath/sagetrac-mirror/commit/0d0b58f65c0ca01d51756798d6910efb5f26f47c)\".",
    "created_at": "2021-09-15T22:06:00Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524884",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/merge_pynac_as_src_sage_symbolic_ginac)" to "[0d0b58f65c0ca01d51756798d6910efb5f26f47c](https://github.com/sagemath/sagetrac-mirror/commit/0d0b58f65c0ca01d51756798d6910efb5f26f47c)".



---

archive/issue_comments_524885.json:
```json
{
    "body": "**Changing commit** from \"[0d0b58f65c0ca01d51756798d6910efb5f26f47c](https://github.com/sagemath/sagetrac-mirror/commit/0d0b58f65c0ca01d51756798d6910efb5f26f47c)\" to \"\".",
    "created_at": "2021-09-28T19:37:27Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524885",
    "user": "https://github.com/egourgoulhon"
}
```

**Changing commit** from "[0d0b58f65c0ca01d51756798d6910efb5f26f47c](https://github.com/sagemath/sagetrac-mirror/commit/0d0b58f65c0ca01d51756798d6910efb5f26f47c)" to "".



---

archive/issue_comments_524886.json:
```json
{
    "body": "<a id='comment:114'></a>\nReplying to [@mkoeppe](#comment%3A73):\n> It will also need to be checked that the deferred imports (such as those introduced in my commit 3153781) do not lead to speed regressions\n\nFWIW, the change performed here did not introduced any speed regression in the rather demanding [Kerr spacetime notebook](https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_Kerr.ipynb), which involves parallelized (8 threads) heavy symbolic computations. On the contrary, it seems there is some little speed up :-) On my i7-8665U laptop:\n- Sage 9.4: 461 s \n- Sage 9.5.beta2: 449 s",
    "created_at": "2021-09-28T19:37:27Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524886",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:114'></a>
Replying to [@mkoeppe](#comment%3A73):
> It will also need to be checked that the deferred imports (such as those introduced in my commit 3153781) do not lead to speed regressions

FWIW, the change performed here did not introduced any speed regression in the rather demanding [Kerr spacetime notebook](https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_Kerr.ipynb), which involves parallelized (8 threads) heavy symbolic computations. On the contrary, it seems there is some little speed up :-) On my i7-8665U laptop:
- Sage 9.4: 461 s 
- Sage 9.5.beta2: 449 s



---

archive/issue_comments_524887.json:
```json
{
    "body": "<a id='comment:5'></a>\nThanks for testing!",
    "created_at": "2021-09-28T19:38:43Z",
    "issue": "https://github.com/sagemath/sage/issues/32386",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32386#issuecomment-524887",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
Thanks for testing!
