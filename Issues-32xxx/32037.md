# Issue 32037: Upgrade to lcalc-2.0.4

archive/issues_031800.json:
```json
{
    "assignees": [],
    "body": "The new lcalc 2.0.3 has been released.\nNote in particular:\n\n- sane build system\n- comes with a pkg-config file\n- public API header has moved to `lcalc/L.h`\n- the `find_zeros_via_N_v()` function was removed\n  and replaced by `find_zeros()`\n\nIn this ticket we upgrade to lcalc 2.0.3 and:\n\n- add gengetopt as a new standard SPKG\n- adjust dependencies\n- adjust spkg-* files for the saner build system\n- adjust spkg-configure.m4 to find the new version\n- adjust tolerance in some doctests\n\n\nDepends on #32061\nDepends on #31837\n\nCC:  @JohnCremona @antonio-rojas @kiwifb @dimpase\n\nBranch: **[`cbb7908`](https://github.com/sagemath/sagetrac-mirror/commit/cbb790846f52d690c84f0a6207723973c9ff0042)**\n\nReviewer: **Antonio Rojas, Dima Pasechnik**\n\nAuthor: **Michael Orlitzky, Fr\u00e9d\u00e9ric Chapoton**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/32037_\n\n",
    "closed_at": "2021-12-12T15:08:56Z",
    "created_at": "2021-06-23T03:11:42Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Upgrade to lcalc-2.0.4",
    "type": "issue",
    "updated_at": "2021-12-18T18:12:04Z",
    "url": "https://github.com/sagemath/sage/issues/32037",
    "user": "https://github.com/orlitzky"
}
```
The new lcalc 2.0.3 has been released.
Note in particular:

- sane build system
- comes with a pkg-config file
- public API header has moved to `lcalc/L.h`
- the `find_zeros_via_N_v()` function was removed
  and replaced by `find_zeros()`

In this ticket we upgrade to lcalc 2.0.3 and:

- add gengetopt as a new standard SPKG
- adjust dependencies
- adjust spkg-* files for the saner build system
- adjust spkg-configure.m4 to find the new version
- adjust tolerance in some doctests


Depends on #32061
Depends on #31837

CC:  @JohnCremona @antonio-rojas @kiwifb @dimpase

Branch: **[`cbb7908`](https://github.com/sagemath/sagetrac-mirror/commit/cbb790846f52d690c84f0a6207723973c9ff0042)**

Reviewer: **Antonio Rojas, Dima Pasechnik**

Author: **Michael Orlitzky, Frédéric Chapoton**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/32037_





---

archive/issue_events_441879.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-06-23T03:11:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441879"
}
```



---

archive/issue_events_441880.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-06-23T03:11:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441880"
}
```



---

archive/issue_events_441881.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-06-23T03:11:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441881"
}
```



---

archive/issue_events_441882.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-06-23T03:11:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441882"
}
```



---

archive/issue_comments_515926.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nUh, a branch please?",
    "created_at": "2021-06-23T05:23:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515926",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

Uh, a branch please?



---

archive/issue_comments_515927.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nJohn, L-functions question here...",
    "created_at": "2021-06-23T08:30:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515927",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:2" align="right">comment:2</div>

John, L-functions question here...



---

archive/issue_comments_515928.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nFor the first doctest, the PARI implementation (only available for real input) gives a different answer at 0:\n\n```\nsage: chi = DirichletGroup(5)[2]                                                \nsage: chi.lfunction().hardy(0)                                                  \n0.793597201093544\n```\n\n***EDIT***\n\nbut Pari doc of \"lfunhardy\" says this gives a \"Variant of the Hardy Z-function\"",
    "created_at": "2021-06-23T10:20:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515928",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:3" align="right">comment:3</div>

For the first doctest, the PARI implementation (only available for real input) gives a different answer at 0:

```
sage: chi = DirichletGroup(5)[2]                                                
sage: chi.lfunction().hardy(0)                                                  
0.793597201093544
```

***EDIT***

but Pari doc of "lfunhardy" says this gives a "Variant of the Hardy Z-function"



---

archive/issue_comments_515929.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nFor the second doctest, the values are indeed zeroes, according to pari :\n\n```\nsage: chi = DirichletGroup(5)[1]                                               \nsage: f = chi.lfunction() \nsage: f(1/2+6.18357819545086*I)                                                 \n2.61452836816118e-15 + 6.48370608217824e-15*I\nsage: f(1/2+8.45722917442320*I)                                                 \n3.51419504210656e-14 - 3.69407271406328e-14*I\nsage: f(1/2-4.13290370521286*I)       \n-4.69010768657543e-15 - 8.53389710587884e-15*I\n```\n\n\n***EDIT***\n\nBut that doc says that \"L.find_zeros_via_N(3)\" is supposed to find 3 zeroes, ignoring negative ones !",
    "created_at": "2021-06-23T11:21:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515929",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:5" align="right">comment:5</div>

For the second doctest, the values are indeed zeroes, according to pari :

```
sage: chi = DirichletGroup(5)[1]                                               
sage: f = chi.lfunction() 
sage: f(1/2+6.18357819545086*I)                                                 
2.61452836816118e-15 + 6.48370608217824e-15*I
sage: f(1/2+8.45722917442320*I)                                                 
3.51419504210656e-14 - 3.69407271406328e-14*I
sage: f(1/2-4.13290370521286*I)       
-4.69010768657543e-15 - 8.53389710587884e-15*I
```


***EDIT***

But that doc says that "L.find_zeros_via_N(3)" is supposed to find 3 zeroes, ignoring negative ones !



---

archive/issue_comments_515930.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@mkoeppe](#comment:1):\n> Uh, a branch please?\n\nI hacked together the minimal changes needed to get this to compile (bonus: it doesn't crash), but all of the patches in the description should be viewed with great suspicion. It will take some more time to sort out the right things to do here.",
    "created_at": "2021-06-23T23:55:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515930",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@mkoeppe](#comment:1):
> Uh, a branch please?

I hacked together the minimal changes needed to get this to compile (bonus: it doesn't crash), but all of the patches in the description should be viewed with great suspicion. It will take some more time to sort out the right things to do here.



---

archive/issue_comments_515931.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@fchapoton](#comment:5):\n> ***EDIT***\n> \n> But that doc says that \"L.find_zeros_via_N(3)\" is supposed to find 3 zeroes, ignoring negative ones !\n\nThere used to be a parameter called `do_negative` that made it look for zeros with a negative imaginary part, but the new libLfunction computes `do_negative` on its own:\n\n```C++\nbool do_negative=is_complex();\n...\ntemplate <class ttype>\nbool L_function <ttype>::\nis_complex(){\n\n    if(my_verbose>2) cout << \"#            start is_complex()\" << endl;\n\n    bool do_negative=false;\n\n    int n=0;\n    if(what_type_L!=-1) //if not the zeta function, check if self dual. If so, do_negative stays false                                                     \n    do{\n        n++;\n        if(abs(imag(Complex(dirichlet_coefficient[n])))>.00001){\n            do_negative=true;\n\t    if(my_verbose>2) cout << \"#            is_complex: Dirichlet co\\\neff \" << n << \" \" << setprecision(DIGITS) << dirichlet_coefficient[n] << endl;\n        }\n\t}while(n<number_of_dirichlet_coefficients&&!do_negative);\n    if(my_verbose>2) cout << \"#            is_complex() = \" << do_negative<\\\n< endl;\n\n    return do_negative;\n\n}\n```\n\nSo maybe it's just the documentation that needs to be updated. I don't know what self-dual means, or what it's ultimately checking to make that decision in this case.",
    "created_at": "2021-06-24T00:06:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515931",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@fchapoton](#comment:5):
> ***EDIT***
> 
> But that doc says that "L.find_zeros_via_N(3)" is supposed to find 3 zeroes, ignoring negative ones !

There used to be a parameter called `do_negative` that made it look for zeros with a negative imaginary part, but the new libLfunction computes `do_negative` on its own:

```C++
bool do_negative=is_complex();
...
template <class ttype>
bool L_function <ttype>::
is_complex(){

    if(my_verbose>2) cout << "#            start is_complex()" << endl;

    bool do_negative=false;

    int n=0;
    if(what_type_L!=-1) //if not the zeta function, check if self dual. If so, do_negative stays false                                                     
    do{
        n++;
        if(abs(imag(Complex(dirichlet_coefficient[n])))>.00001){
            do_negative=true;
	    if(my_verbose>2) cout << "#            is_complex: Dirichlet co\
eff " << n << " " << setprecision(DIGITS) << dirichlet_coefficient[n] << endl;
        }
	}while(n<number_of_dirichlet_coefficients&&!do_negative);
    if(my_verbose>2) cout << "#            is_complex() = " << do_negative<\
< endl;

    return do_negative;

}
```

So maybe it's just the documentation that needs to be updated. I don't know what self-dual means, or what it's ultimately checking to make that decision in this case.



---

archive/issue_comments_515932.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nFWIW, here is my reading of this code: If all of the coefficients of the Dirichlet series are real (up to a tolerance of `.00001`), then the conjugate of any root is also a root.  (This is what \"self-dual\" must mean.) We do not need to look for roots below the real axis in this case (because they are conjugates of roots that are above the real axis), so `do_negative` is set to `False`. Otherwise, `do_negative` is set to `True`.\n\nReplying to [@orlitzky](#comment:7):\n> Replying to [@fchapoton](#comment:5):\n> ...\n> So maybe it's just the documentation that needs to be updated. I don't know what self-dual means, or what it's ultimately checking to make that decision in this case.",
    "created_at": "2021-06-24T02:26:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515932",
    "user": "https://github.com/DaveWitteMorris"
}
```

<div id="comment:8" align="right">comment:8</div>

FWIW, here is my reading of this code: If all of the coefficients of the Dirichlet series are real (up to a tolerance of `.00001`), then the conjugate of any root is also a root.  (This is what "self-dual" must mean.) We do not need to look for roots below the real axis in this case (because they are conjugates of roots that are above the real axis), so `do_negative` is set to `False`. Otherwise, `do_negative` is set to `True`.

Replying to [@orlitzky](#comment:7):
> Replying to [@fchapoton](#comment:5):
> ...
> So maybe it's just the documentation that needs to be updated. I don't know what self-dual means, or what it's ultimately checking to make that decision in this case.



---

archive/issue_comments_515933.json:
```json
{
    "body": "Branch: **[public/lcalc_version_2](https://github.com/sagemath/sagetrac-mirror/tree/public/lcalc_version_2)**",
    "created_at": "2021-06-24T07:18:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515933",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[public/lcalc_version_2](https://github.com/sagemath/sagetrac-mirror/tree/public/lcalc_version_2)**



---

archive/issue_comments_515934.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nhere is a first branch, just changing version, checksums and lcalc_sage.h\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61be05df342fb59e8c1856770009608c6d8a11e7\"><code>61be05d</code></a></td><td><code>first steps towards lcalc 2.0.0</code></td></tr></table>\n",
    "created_at": "2021-06-24T07:18:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515934",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:9" align="right">comment:9</div>

here is a first branch, just changing version, checksums and lcalc_sage.h

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61be05df342fb59e8c1856770009608c6d8a11e7"><code>61be05d</code></a></td><td><code>first steps towards lcalc 2.0.0</code></td></tr></table>




---

archive/issue_comments_515935.json:
```json
{
    "body": "Commit: **[`61be05d`](https://github.com/sagemath/sagetrac-mirror/commit/61be05df342fb59e8c1856770009608c6d8a11e7)**",
    "created_at": "2021-06-24T07:18:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515935",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`61be05d`](https://github.com/sagemath/sagetrac-mirror/commit/61be05df342fb59e8c1856770009608c6d8a11e7)**



---

archive/issue_comments_515936.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nshould we remove all the old patches ?",
    "created_at": "2021-06-24T07:20:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515936",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:10" align="right">comment:10</div>

should we remove all the old patches ?



---

archive/issue_comments_515937.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@fchapoton](#comment:10):\n> should we remove all the old patches ?\n\nYep, all patches are obsolete. The spkg-install.in should now be,\n\n```\nsdh_configure --with-pari\nsdh_make_install\n```\n\nand we can add an spkg-check.in containing,\n\n```\nsdh_make_check\n```",
    "created_at": "2021-06-24T12:28:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515937",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@fchapoton](#comment:10):
> should we remove all the old patches ?

Yep, all patches are obsolete. The spkg-install.in should now be,

```
sdh_configure --with-pari
sdh_make_install
```

and we can add an spkg-check.in containing,

```
sdh_make_check
```



---

archive/issue_comments_515938.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7f68936e3191f55025665a8184911c48c364758a\"><code>7f68936</code></a></td><td><code>lcalc 2.0.0 removing all patches</code></td></tr></table>\n",
    "created_at": "2021-06-24T15:07:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515938",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7f68936e3191f55025665a8184911c48c364758a"><code>7f68936</code></a></td><td><code>lcalc 2.0.0 removing all patches</code></td></tr></table>




---

archive/issue_comments_515939.json:
```json
{
    "body": "Changed commit from **[`61be05d`](https://github.com/sagemath/sagetrac-mirror/commit/61be05df342fb59e8c1856770009608c6d8a11e7)** to **[`7f68936`](https://github.com/sagemath/sagetrac-mirror/commit/7f68936e3191f55025665a8184911c48c364758a)**",
    "created_at": "2021-06-24T15:07:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515939",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`61be05d`](https://github.com/sagemath/sagetrac-mirror/commit/61be05df342fb59e8c1856770009608c6d8a11e7)** to **[`7f68936`](https://github.com/sagemath/sagetrac-mirror/commit/7f68936e3191f55025665a8184911c48c364758a)**



---

archive/issue_comments_515940.json:
```json
{
    "body": "Changed commit from **[`7f68936`](https://github.com/sagemath/sagetrac-mirror/commit/7f68936e3191f55025665a8184911c48c364758a)** to **[`ef80bc3`](https://github.com/sagemath/sagetrac-mirror/commit/ef80bc3588b7fd9d6c22f2c20414d438e75822fb)**",
    "created_at": "2021-06-24T15:10:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515940",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7f68936`](https://github.com/sagemath/sagetrac-mirror/commit/7f68936e3191f55025665a8184911c48c364758a)** to **[`ef80bc3`](https://github.com/sagemath/sagetrac-mirror/commit/ef80bc3588b7fd9d6c22f2c20414d438e75822fb)**



---

archive/issue_comments_515941.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ef80bc3588b7fd9d6c22f2c20414d438e75822fb\"><code>ef80bc3</code></a></td><td><code>update installation scripts</code></td></tr></table>\n",
    "created_at": "2021-06-24T15:10:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515941",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ef80bc3588b7fd9d6c22f2c20414d438e75822fb"><code>ef80bc3</code></a></td><td><code>update installation scripts</code></td></tr></table>




---

archive/issue_comments_515942.json:
```json
{
    "body": "Changed commit from **[`ef80bc3`](https://github.com/sagemath/sagetrac-mirror/commit/ef80bc3588b7fd9d6c22f2c20414d438e75822fb)** to **[`76226d7`](https://github.com/sagemath/sagetrac-mirror/commit/76226d74470962d0c31753fa755d558fd9b0e76f)**",
    "created_at": "2021-06-24T16:32:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515942",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ef80bc3`](https://github.com/sagemath/sagetrac-mirror/commit/ef80bc3588b7fd9d6c22f2c20414d438e75822fb)** to **[`76226d7`](https://github.com/sagemath/sagetrac-mirror/commit/76226d74470962d0c31753fa755d558fd9b0e76f)**



---

archive/issue_comments_515943.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/76226d74470962d0c31753fa755d558fd9b0e76f\"><code>76226d7</code></a></td><td><code>lcalc 2.0.0 no dependency to mpfr</code></td></tr></table>\n",
    "created_at": "2021-06-24T16:32:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515943",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/76226d74470962d0c31753fa755d558fd9b0e76f"><code>76226d7</code></a></td><td><code>lcalc 2.0.0 no dependency to mpfr</code></td></tr></table>




---

archive/issue_comments_515944.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nshould we \"cd src\" in spkg-install ?\n\nI have not managed to install so far with the current branch, \"sage -i lcalc\" complains as follows\n\n```\n[lcalc-2.0.0] Uninstalling 'lcalc' with legacy uninstaller\n[lcalc-2.0.0] Package 'lcalc' is currently not installed\n[lcalc-2.0.0] Now building lcalc, example programs and the shared library...\n[lcalc-2.0.0] Building lcalc-2.0.0\n[lcalc-2.0.0] make[3]: *** No targets specified and no makefile found.  Stop.\n```",
    "created_at": "2021-06-24T17:52:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515944",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:15" align="right">comment:15</div>

should we "cd src" in spkg-install ?

I have not managed to install so far with the current branch, "sage -i lcalc" complains as follows

```
[lcalc-2.0.0] Uninstalling 'lcalc' with legacy uninstaller
[lcalc-2.0.0] Package 'lcalc' is currently not installed
[lcalc-2.0.0] Now building lcalc, example programs and the shared library...
[lcalc-2.0.0] Building lcalc-2.0.0
[lcalc-2.0.0] make[3]: *** No targets specified and no makefile found.  Stop.
```



---

archive/issue_comments_515945.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI don't understand anything about the build system, so it's likely that this is noise (in which case I apologize), but [dimpase says](https://groups.google.com/g/sage-devel/c/euE9MJnfjAo/m/XOB7X1TxBQAJ) not to use \"sage -i\":\n\n```\nwe are trying to switch to a sane building scheme:\n\n./bootstrap\n./configure\nmake build\nmake pynormaliz\n\nsage -i is an old hack noone should use...\n```\nSo maybe you are supposed to try \"make lcalc\" ?",
    "created_at": "2021-06-24T18:40:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515945",
    "user": "https://github.com/DaveWitteMorris"
}
```

<div id="comment:16" align="right">comment:16</div>

I don't understand anything about the build system, so it's likely that this is noise (in which case I apologize), but [dimpase says](https://groups.google.com/g/sage-devel/c/euE9MJnfjAo/m/XOB7X1TxBQAJ) not to use "sage -i":

```
we are trying to switch to a sane building scheme:

./bootstrap
./configure
make build
make pynormaliz

sage -i is an old hack noone should use...
```
So maybe you are supposed to try "make lcalc" ?



---

archive/issue_comments_515946.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@fchapoton](#comment:15):\n> should we \"cd src\" in spkg-install ?\n\nyes",
    "created_at": "2021-06-24T18:43:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515946",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@fchapoton](#comment:15):
> should we "cd src" in spkg-install ?

yes



---

archive/issue_comments_515947.json:
```json
{
    "body": "Changed commit from **[`76226d7`](https://github.com/sagemath/sagetrac-mirror/commit/76226d74470962d0c31753fa755d558fd9b0e76f)** to **[`aa2bb03`](https://github.com/sagemath/sagetrac-mirror/commit/aa2bb03392532ab113180bc8aa0b2e80e1867219)**",
    "created_at": "2021-06-24T22:26:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515947",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`76226d7`](https://github.com/sagemath/sagetrac-mirror/commit/76226d74470962d0c31753fa755d558fd9b0e76f)** to **[`aa2bb03`](https://github.com/sagemath/sagetrac-mirror/commit/aa2bb03392532ab113180bc8aa0b2e80e1867219)**



---

archive/issue_comments_515948.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aa2bb03392532ab113180bc8aa0b2e80e1867219\"><code>aa2bb03</code></a></td><td><code>Trac #32037: update spkg-configure.m4 for lcalc-2.0.0.</code></td></tr></table>\n",
    "created_at": "2021-06-24T22:26:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515948",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aa2bb03392532ab113180bc8aa0b2e80e1867219"><code>aa2bb03</code></a></td><td><code>Trac #32037: update spkg-configure.m4 for lcalc-2.0.0.</code></td></tr></table>




---

archive/issue_comments_515949.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nShould .m4 files mix tabs and spaces?",
    "created_at": "2021-06-24T23:13:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515949",
    "user": "https://github.com/slel"
}
```

<div id="comment:19" align="right">comment:19</div>

Should .m4 files mix tabs and spaces?



---

archive/issue_comments_515950.json:
```json
{
    "body": "<div id=\"comment:20\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/849de4b283a3c460cb8276771e663d7ee3c9d2aa\"><code>849de4b</code></a></td><td><code>Trac #32037: fixup: kill tabs in build/pkgs/lcalc/spkg-configure.m4.</code></td></tr></table>\n",
    "created_at": "2021-06-24T23:16:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515950",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:20"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/849de4b283a3c460cb8276771e663d7ee3c9d2aa"><code>849de4b</code></a></td><td><code>Trac #32037: fixup: kill tabs in build/pkgs/lcalc/spkg-configure.m4.</code></td></tr></table>




---

archive/issue_comments_515951.json:
```json
{
    "body": "Changed commit from **[`aa2bb03`](https://github.com/sagemath/sagetrac-mirror/commit/aa2bb03392532ab113180bc8aa0b2e80e1867219)** to **[`849de4b`](https://github.com/sagemath/sagetrac-mirror/commit/849de4b283a3c460cb8276771e663d7ee3c9d2aa)**",
    "created_at": "2021-06-24T23:16:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515951",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`aa2bb03`](https://github.com/sagemath/sagetrac-mirror/commit/aa2bb03392532ab113180bc8aa0b2e80e1867219)** to **[`849de4b`](https://github.com/sagemath/sagetrac-mirror/commit/849de4b283a3c460cb8276771e663d7ee3c9d2aa)**



---

archive/issue_comments_515952.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@slel](#comment:19):\n> Should .m4 files mix tabs and spaces?\n\nAccording to me, no. According to emacs, at every opportunity.",
    "created_at": "2021-06-24T23:18:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515952",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@slel](#comment:19):
> Should .m4 files mix tabs and spaces?

According to me, no. According to emacs, at every opportunity.



---

archive/issue_comments_515953.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nUsing \"make lcalc\", I am still not able to build, with or without \"cd src\".\n\nComplains of missing makefile, as in [comment:17](#comment:17)",
    "created_at": "2021-06-25T09:31:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515953",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:22" align="right">comment:22</div>

Using "make lcalc", I am still not able to build, with or without "cd src".

Complains of missing makefile, as in [comment:17](#comment:17)



---

archive/issue_comments_515954.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@fchapoton](#comment:22):\n> Using \"make lcalc\", I am still not able to build, with or without \"cd src\".\n> \n> Complains of missing makefile, as in [comment:17](#comment:17)\n\nI think you have to get rid of `spkg-build.in`, too.",
    "created_at": "2021-06-25T14:40:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515954",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@fchapoton](#comment:22):
> Using "make lcalc", I am still not able to build, with or without "cd src".
> 
> Complains of missing makefile, as in [comment:17](#comment:17)

I think you have to get rid of `spkg-build.in`, too.



---

archive/issue_comments_515955.json:
```json
{
    "body": "Changed commit from **[`849de4b`](https://github.com/sagemath/sagetrac-mirror/commit/849de4b283a3c460cb8276771e663d7ee3c9d2aa)** to **[`7327388`](https://github.com/sagemath/sagetrac-mirror/commit/73273882b19a12cc84f82452f81212e339a686cd)**",
    "created_at": "2021-06-25T15:49:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515955",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`849de4b`](https://github.com/sagemath/sagetrac-mirror/commit/849de4b283a3c460cb8276771e663d7ee3c9d2aa)** to **[`7327388`](https://github.com/sagemath/sagetrac-mirror/commit/73273882b19a12cc84f82452f81212e339a686cd)**



---

archive/issue_comments_515956.json:
```json
{
    "body": "<div id=\"comment:24\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/73273882b19a12cc84f82452f81212e339a686cd\"><code>7327388</code></a></td><td><code>lcalc 2.0.0 towards a working make</code></td></tr></table>\n",
    "created_at": "2021-06-25T15:49:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515956",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:24"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/73273882b19a12cc84f82452f81212e339a686cd"><code>7327388</code></a></td><td><code>lcalc 2.0.0 towards a working make</code></td></tr></table>




---

archive/issue_comments_515957.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nok, now \"make lcalc\" starts doing something and stops at\n\n```\n[lcalc-2.0.0] Thread model: posix\n[lcalc-2.0.0] gcc version 9.3.0 (Ubuntu 9.3.0-17ubuntu1~20.04) \n...\n[lcalc-2.0.0] checking for gengetopt... no\n[lcalc-2.0.0] configure: error: GNU gengetopt is required\n```",
    "created_at": "2021-06-25T15:50:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515957",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:25" align="right">comment:25</div>

ok, now "make lcalc" starts doing something and stops at

```
[lcalc-2.0.0] Thread model: posix
[lcalc-2.0.0] gcc version 9.3.0 (Ubuntu 9.3.0-17ubuntu1~20.04) 
...
[lcalc-2.0.0] checking for gengetopt... no
[lcalc-2.0.0] configure: error: GNU gengetopt is required
```



---

archive/issue_comments_515958.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,6 +2,7 @@\n \n There are a few issues that need to be addressed during the upgrade.\n \n+0. The build requires GNU gengetopt, so we'll need a new gengetopt SPKG for lcalc to depend on. (It doesn't need to go in the DEPCHECK macro though, since it's a build-only dependency.)\n 1. The build system is now sane. This should make life easier in the long run, but means that spkg-* need to be rewritten. `./configure --with-pari` should suffice.\n \n 2. The lcalc spkg shouldn't depend on mpfr (I'm not sure why it ever did).\n``````\n",
    "created_at": "2021-06-25T17:15:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515958",
    "user": "https://github.com/orlitzky"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,6 +2,7 @@
 
 There are a few issues that need to be addressed during the upgrade.
 
+0. The build requires GNU gengetopt, so we'll need a new gengetopt SPKG for lcalc to depend on. (It doesn't need to go in the DEPCHECK macro though, since it's a build-only dependency.)
 1. The build system is now sane. This should make life easier in the long run, but means that spkg-* need to be rewritten. `./configure --with-pari` should suffice.
 
 2. The lcalc spkg shouldn't depend on mpfr (I'm not sure why it ever did).
``````




---

archive/issue_comments_515959.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nWell the good news is that it's supposed to do that, but the bad news is that we'll have to add another gengetopt SPKG for lcalc to depend on.",
    "created_at": "2021-06-25T17:15:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515959",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:26" align="right">comment:26</div>

Well the good news is that it's supposed to do that, but the bad news is that we'll have to add another gengetopt SPKG for lcalc to depend on.



---

archive/issue_comments_515960.json:
```json
{
    "body": "Dependencies: **#32061**",
    "created_at": "2021-06-25T17:15:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515960",
    "user": "https://github.com/orlitzky"
}
```

Dependencies: **#32061**



---

archive/issue_comments_515961.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nI posted a branch for review on #32061 to add the missing dependency.",
    "created_at": "2021-06-25T18:09:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515961",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:27" align="right">comment:27</div>

I posted a branch for review on #32061 to add the missing dependency.



---

archive/issue_events_441883.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-06-26T00:14:57Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "title_is": "Upgrade to lcalc-2.0.1",
    "title_was": "Upgrade to lcalc-2.0.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441883"
}
```



---

archive/issue_comments_515962.json:
```json
{
    "body": "Changed commit from **[`7327388`](https://github.com/sagemath/sagetrac-mirror/commit/73273882b19a12cc84f82452f81212e339a686cd)** to **[`3b44220`](https://github.com/sagemath/sagetrac-mirror/commit/3b44220644165a289248bdacc8ea1ab7ce21abca)**",
    "created_at": "2021-06-26T00:14:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515962",
    "user": "https://github.com/orlitzky"
}
```

Changed commit from **[`7327388`](https://github.com/sagemath/sagetrac-mirror/commit/73273882b19a12cc84f82452f81212e339a686cd)** to **[`3b44220`](https://github.com/sagemath/sagetrac-mirror/commit/3b44220644165a289248bdacc8ea1ab7ce21abca)**



---

archive/issue_comments_515963.json:
```json
{
    "body": "Changed branch from **[public/lcalc_version_2](https://github.com/sagemath/sagetrac-mirror/tree/public/lcalc_version_2)** to **[u/mjo/ticket/32037](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/32037)**",
    "created_at": "2021-06-26T00:14:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515963",
    "user": "https://github.com/orlitzky"
}
```

Changed branch from **[public/lcalc_version_2](https://github.com/sagemath/sagetrac-mirror/tree/public/lcalc_version_2)** to **[u/mjo/ticket/32037](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/32037)**



---

archive/issue_comments_515964.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nI figured out how to fix the build scripts... and then found a typo in the upstream configure.ac that I had to release a 2.0.1 to fix. I think this will actually work now.",
    "created_at": "2021-06-26T00:14:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515964",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:28" align="right">comment:28</div>

I figured out how to fix the build scripts... and then found a typo in the upstream configure.ac that I had to release a 2.0.1 to fix. I think this will actually work now.



---

archive/issue_comments_515965.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@DaveWitteMorris](#comment:8):\n> FWIW, here is my reading of this code: If all of the coefficients of the Dirichlet series are real (up to a tolerance of `.00001`), then the conjugate of any root is also a root.  (This is what \"self-dual\" must mean.) We do not need to look for roots below the real axis in this case (because they are conjugates of roots that are above the real axis), so `do_negative` is set to `False`. Otherwise, `do_negative` is set to `True`.\n\nThese functions are supposed to \"return the first `n` zeros.\" That's vague, but scrutable if you're starting from the real axis and moving up: basically, the numbers (imaginary parts) it outputs get bigger. I guess when `do_negative` is true, we output the first `n` zeros in *magnitude*?",
    "created_at": "2021-06-26T00:18:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515965",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@DaveWitteMorris](#comment:8):
> FWIW, here is my reading of this code: If all of the coefficients of the Dirichlet series are real (up to a tolerance of `.00001`), then the conjugate of any root is also a root.  (This is what "self-dual" must mean.) We do not need to look for roots below the real axis in this case (because they are conjugates of roots that are above the real axis), so `do_negative` is set to `False`. Otherwise, `do_negative` is set to `True`.

These functions are supposed to "return the first `n` zeros." That's vague, but scrutable if you're starting from the real axis and moving up: basically, the numbers (imaginary parts) it outputs get bigger. I guess when `do_negative` is true, we output the first `n` zeros in *magnitude*?



---

archive/issue_comments_515966.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-I've just tagged a 2.0.0 release of lcalc: https://gitlab.com/sagemath/lcalc/-/tags/2.0.0\n+I've just tagged a 2.0.1 release of lcalc: https://gitlab.com/sagemath/lcalc/-/tags/2.0.1\n \n There are a few issues that need to be addressed during the upgrade.\n \n``````\n",
    "created_at": "2021-06-26T12:12:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515966",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-I've just tagged a 2.0.0 release of lcalc: https://gitlab.com/sagemath/lcalc/-/tags/2.0.0
+I've just tagged a 2.0.1 release of lcalc: https://gitlab.com/sagemath/lcalc/-/tags/2.0.1
 
 There are a few issues that need to be addressed during the upgrade.
 
``````




---

archive/issue_comments_515967.json:
```json
{
    "body": "<div id=\"comment:32\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f248552456ccd1e78666e5059bd0011e3cadfff5\"><code>f248552</code></a></td><td><code>Trac #32061: add distro package information for GNU Gengetopt.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37299edba78bcd3a720eae3725a2756e7336b519\"><code>37299ed</code></a></td><td><code>Trac #32061: add spkg-check.in for gengetopt.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd445a4e3925d9a8729f4c686771d901beff1588\"><code>fd445a4</code></a></td><td><code>first steps towards lcalc 2.0.0</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/62e2f2ef640754fa3c2880e353d76e2e4d1d1646\"><code>62e2f2e</code></a></td><td><code>lcalc 2.0.0 removing all patches</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2658f0d82fbed2d4d69d50d3a8248c2ed0965ff2\"><code>2658f0d</code></a></td><td><code>update installation scripts</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a09e5a1b7049827037959c555df7f49c4f7e3180\"><code>a09e5a1</code></a></td><td><code>lcalc 2.0.0 no dependency to mpfr</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/de1c43de6782e8ef612e4bc7847b9ceacc897514\"><code>de1c43d</code></a></td><td><code>Trac #32037: update spkg-configure.m4 for lcalc-2.0.0.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/101ec5fdb5c00c9bdbb8967cf589b53cb20e60ec\"><code>101ec5f</code></a></td><td><code>Trac #32037: have lcalc depend on gengetopt.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/24928e92d711e56c3ccbf7356a7623d5622b419e\"><code>24928e9</code></a></td><td><code>Trac #32037: upgrade lcalc to v2.0.1.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4d5fc586d5cf69adc2ffe5f71d325c52fd86107c\"><code>4d5fc58</code></a></td><td><code>Trac #32037: fix build scripts for lcalc SPKG.</code></td></tr></table>\n",
    "created_at": "2021-06-26T13:07:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515967",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:32"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f248552456ccd1e78666e5059bd0011e3cadfff5"><code>f248552</code></a></td><td><code>Trac #32061: add distro package information for GNU Gengetopt.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37299edba78bcd3a720eae3725a2756e7336b519"><code>37299ed</code></a></td><td><code>Trac #32061: add spkg-check.in for gengetopt.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd445a4e3925d9a8729f4c686771d901beff1588"><code>fd445a4</code></a></td><td><code>first steps towards lcalc 2.0.0</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/62e2f2ef640754fa3c2880e353d76e2e4d1d1646"><code>62e2f2e</code></a></td><td><code>lcalc 2.0.0 removing all patches</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2658f0d82fbed2d4d69d50d3a8248c2ed0965ff2"><code>2658f0d</code></a></td><td><code>update installation scripts</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a09e5a1b7049827037959c555df7f49c4f7e3180"><code>a09e5a1</code></a></td><td><code>lcalc 2.0.0 no dependency to mpfr</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/de1c43de6782e8ef612e4bc7847b9ceacc897514"><code>de1c43d</code></a></td><td><code>Trac #32037: update spkg-configure.m4 for lcalc-2.0.0.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/101ec5fdb5c00c9bdbb8967cf589b53cb20e60ec"><code>101ec5f</code></a></td><td><code>Trac #32037: have lcalc depend on gengetopt.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/24928e92d711e56c3ccbf7356a7623d5622b419e"><code>24928e9</code></a></td><td><code>Trac #32037: upgrade lcalc to v2.0.1.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4d5fc586d5cf69adc2ffe5f71d325c52fd86107c"><code>4d5fc58</code></a></td><td><code>Trac #32037: fix build scripts for lcalc SPKG.</code></td></tr></table>




---

archive/issue_comments_515968.json:
```json
{
    "body": "Changed commit from **[`3b44220`](https://github.com/sagemath/sagetrac-mirror/commit/3b44220644165a289248bdacc8ea1ab7ce21abca)** to **[`4d5fc58`](https://github.com/sagemath/sagetrac-mirror/commit/4d5fc586d5cf69adc2ffe5f71d325c52fd86107c)**",
    "created_at": "2021-06-26T13:07:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515968",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3b44220`](https://github.com/sagemath/sagetrac-mirror/commit/3b44220644165a289248bdacc8ea1ab7ce21abca)** to **[`4d5fc58`](https://github.com/sagemath/sagetrac-mirror/commit/4d5fc586d5cf69adc2ffe5f71d325c52fd86107c)**



---

archive/issue_comments_515969.json:
```json
{
    "body": "Changed commit from **[`4d5fc58`](https://github.com/sagemath/sagetrac-mirror/commit/4d5fc586d5cf69adc2ffe5f71d325c52fd86107c)** to **[`44f2e0d`](https://github.com/sagemath/sagetrac-mirror/commit/44f2e0d4be583c6143da267c690f8b87e1c2396d)**",
    "created_at": "2021-06-28T02:52:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515969",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4d5fc58`](https://github.com/sagemath/sagetrac-mirror/commit/4d5fc586d5cf69adc2ffe5f71d325c52fd86107c)** to **[`44f2e0d`](https://github.com/sagemath/sagetrac-mirror/commit/44f2e0d4be583c6143da267c690f8b87e1c2396d)**



---

archive/issue_comments_515970.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51f93f2aa5507f23dc60416e2fa78938fa816dc9\"><code>51f93f2</code></a></td><td><code>Trac #32037: update libs/lcalc API for lcalc-2.x.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/74ba3550e8cb945304bf95e563ec486607d8099f\"><code>74ba355</code></a></td><td><code>Trac #32037: use lcalc-2.x API in libs/lcalc/lcalc_Lfunction.pyx.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/44f2e0d4be583c6143da267c690f8b87e1c2396d\"><code>44f2e0d</code></a></td><td><code>Trac #32037: update find_zeros_via_N() to match the lcalc-2.x API.</code></td></tr></table>\n",
    "created_at": "2021-06-28T02:52:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515970",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51f93f2aa5507f23dc60416e2fa78938fa816dc9"><code>51f93f2</code></a></td><td><code>Trac #32037: update libs/lcalc API for lcalc-2.x.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/74ba3550e8cb945304bf95e563ec486607d8099f"><code>74ba355</code></a></td><td><code>Trac #32037: use lcalc-2.x API in libs/lcalc/lcalc_Lfunction.pyx.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/44f2e0d4be583c6143da267c690f8b87e1c2396d"><code>44f2e0d</code></a></td><td><code>Trac #32037: update find_zeros_via_N() to match the lcalc-2.x API.</code></td></tr></table>




---

archive/issue_comments_515971.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@orlitzky](#comment:29):\n> Replying to [@DaveWitteMorris](#comment:8):\n\n>> ... I guess when `do_negative` is true, we output the first `n` zeros in *magnitude*?\n\nYes, I'm pretty sure that is correct. For example, a comment introducing the `find_zeros` function says \"Finds zeros of L(1/2+It) or of L(1/2+It)*L(1/2-It) (depending on whether self dual or not)\". (The second form will combine the zeros with negative imaginary into the ones with positive imaginary part.) And a comment in the code of the function says \"in the self dual case we only count half the zeros with |t|<T\".",
    "created_at": "2021-06-29T00:59:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515971",
    "user": "https://github.com/DaveWitteMorris"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@orlitzky](#comment:29):
> Replying to [@DaveWitteMorris](#comment:8):

>> ... I guess when `do_negative` is true, we output the first `n` zeros in *magnitude*?

Yes, I'm pretty sure that is correct. For example, a comment introducing the `find_zeros` function says "Finds zeros of L(1/2+It) or of L(1/2+It)*L(1/2-It) (depending on whether self dual or not)". (The second form will combine the zeros with negative imaginary into the ones with positive imaginary part.) And a comment in the code of the function says "in the self dual case we only count half the zeros with |t|<T".



---

archive/issue_comments_515972.json:
```json
{
    "body": "<div id=\"comment:35\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/13da394fb088449048b1a7a75ccae22e077e9eb8\"><code>13da394</code></a></td><td><code>Trac #32037: ensure lcalc has PRECISION_DOUBLE and HAVE_PARI.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/63bbfcc13115411b0caf7d55a7c30638b6acf011\"><code>63bbfcc</code></a></td><td><code>Trac #32037: add Gentoo package information for lcalc.</code></td></tr></table>\n",
    "created_at": "2021-07-01T19:01:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515972",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:35"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/13da394fb088449048b1a7a75ccae22e077e9eb8"><code>13da394</code></a></td><td><code>Trac #32037: ensure lcalc has PRECISION_DOUBLE and HAVE_PARI.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/63bbfcc13115411b0caf7d55a7c30638b6acf011"><code>63bbfcc</code></a></td><td><code>Trac #32037: add Gentoo package information for lcalc.</code></td></tr></table>




---

archive/issue_comments_515973.json:
```json
{
    "body": "Changed commit from **[`44f2e0d`](https://github.com/sagemath/sagetrac-mirror/commit/44f2e0d4be583c6143da267c690f8b87e1c2396d)** to **[`63bbfcc`](https://github.com/sagemath/sagetrac-mirror/commit/63bbfcc13115411b0caf7d55a7c30638b6acf011)**",
    "created_at": "2021-07-01T19:01:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515973",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`44f2e0d`](https://github.com/sagemath/sagetrac-mirror/commit/44f2e0d4be583c6143da267c690f8b87e1c2396d)** to **[`63bbfcc`](https://github.com/sagemath/sagetrac-mirror/commit/63bbfcc13115411b0caf7d55a7c30638b6acf011)**



---

archive/issue_comments_515974.json:
```json
{
    "body": "<div id=\"comment:36\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8d70dfde098ae5d63cb70212e7587b24fe47ae93\"><code>8d70dfd</code></a></td><td><code>Trac 32037: fixup lcalc header name in sage/libs/lcalc/lcalc_sage.h.</code></td></tr></table>\n",
    "created_at": "2021-07-02T23:08:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515974",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:36"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8d70dfde098ae5d63cb70212e7587b24fe47ae93"><code>8d70dfd</code></a></td><td><code>Trac 32037: fixup lcalc header name in sage/libs/lcalc/lcalc_sage.h.</code></td></tr></table>




---

archive/issue_comments_515975.json:
```json
{
    "body": "Changed commit from **[`63bbfcc`](https://github.com/sagemath/sagetrac-mirror/commit/63bbfcc13115411b0caf7d55a7c30638b6acf011)** to **[`8d70dfd`](https://github.com/sagemath/sagetrac-mirror/commit/8d70dfde098ae5d63cb70212e7587b24fe47ae93)**",
    "created_at": "2021-07-02T23:08:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515975",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`63bbfcc`](https://github.com/sagemath/sagetrac-mirror/commit/63bbfcc13115411b0caf7d55a7c30638b6acf011)** to **[`8d70dfd`](https://github.com/sagemath/sagetrac-mirror/commit/8d70dfde098ae5d63cb70212e7587b24fe47ae93)**



---

archive/issue_comments_515976.json:
```json
{
    "body": "Changed commit from **[`8d70dfd`](https://github.com/sagemath/sagetrac-mirror/commit/8d70dfde098ae5d63cb70212e7587b24fe47ae93)** to **[`4c40554`](https://github.com/sagemath/sagetrac-mirror/commit/4c40554f4a852858017bc4ff7cfb5f9e8295b1fa)**",
    "created_at": "2021-07-03T12:13:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515976",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8d70dfd`](https://github.com/sagemath/sagetrac-mirror/commit/8d70dfde098ae5d63cb70212e7587b24fe47ae93)** to **[`4c40554`](https://github.com/sagemath/sagetrac-mirror/commit/4c40554f4a852858017bc4ff7cfb5f9e8295b1fa)**



---

archive/issue_comments_515977.json:
```json
{
    "body": "<div id=\"comment:37\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/882bbc236e460e31b8380bb24813fe86c66ad4d7\"><code>882bbc2</code></a></td><td><code>Trac #32037: update the doctest for the DirichletGroup(5)[1] L-function.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6c127ff71a6f6264a48505d933ce1b506a83d40c\"><code>6c127ff</code></a></td><td><code>Trac #32037: lower all lcalc tolerances to 1e-8.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5404c185f723c5f797b7d230adf73533597035ec\"><code>5404c18</code></a></td><td><code>Trac #32037: add abs_tol to an lcalc test to fix a new failure.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4c40554f4a852858017bc4ff7cfb5f9e8295b1fa\"><code>4c40554</code></a></td><td><code>Trac #32037: update an lcalc doctest that counts zeros.</code></td></tr></table>\n",
    "created_at": "2021-07-03T12:13:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515977",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:37"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/882bbc236e460e31b8380bb24813fe86c66ad4d7"><code>882bbc2</code></a></td><td><code>Trac #32037: update the doctest for the DirichletGroup(5)[1] L-function.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6c127ff71a6f6264a48505d933ce1b506a83d40c"><code>6c127ff</code></a></td><td><code>Trac #32037: lower all lcalc tolerances to 1e-8.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5404c185f723c5f797b7d230adf73533597035ec"><code>5404c18</code></a></td><td><code>Trac #32037: add abs_tol to an lcalc test to fix a new failure.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4c40554f4a852858017bc4ff7cfb5f9e8295b1fa"><code>4c40554</code></a></td><td><code>Trac #32037: update an lcalc doctest that counts zeros.</code></td></tr></table>




---

archive/issue_comments_515978.json:
```json
{
    "body": "Changed commit from **[`4c40554`](https://github.com/sagemath/sagetrac-mirror/commit/4c40554f4a852858017bc4ff7cfb5f9e8295b1fa)** to **[`1b6cdbc`](https://github.com/sagemath/sagetrac-mirror/commit/1b6cdbc50cc308c83392207977aaf96d0fd1d515)**",
    "created_at": "2021-07-03T12:43:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515978",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4c40554`](https://github.com/sagemath/sagetrac-mirror/commit/4c40554f4a852858017bc4ff7cfb5f9e8295b1fa)** to **[`1b6cdbc`](https://github.com/sagemath/sagetrac-mirror/commit/1b6cdbc50cc308c83392207977aaf96d0fd1d515)**



---

archive/issue_comments_515979.json:
```json
{
    "body": "<div id=\"comment:38\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f4a15513018fa86ddee9359d5d0071504af56cb1\"><code>f4a1551</code></a></td><td><code>Trac #32037: add tolerance to a few sage/lfunctions/lcalc.py doctests.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e4ea9c21df75b80dd9b099b77b3a0c019632f06c\"><code>e4ea9c2</code></a></td><td><code>Trac #32037: delete a failing doctest.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1b6cdbc50cc308c83392207977aaf96d0fd1d515\"><code>1b6cdbc</code></a></td><td><code>Trac #32037: replace some ellipeses with abs_tol.</code></td></tr></table>\n",
    "created_at": "2021-07-03T12:43:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515979",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:38"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f4a15513018fa86ddee9359d5d0071504af56cb1"><code>f4a1551</code></a></td><td><code>Trac #32037: add tolerance to a few sage/lfunctions/lcalc.py doctests.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e4ea9c21df75b80dd9b099b77b3a0c019632f06c"><code>e4ea9c2</code></a></td><td><code>Trac #32037: delete a failing doctest.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1b6cdbc50cc308c83392207977aaf96d0fd1d515"><code>1b6cdbc</code></a></td><td><code>Trac #32037: replace some ellipeses with abs_tol.</code></td></tr></table>




---

archive/issue_comments_515980.json:
```json
{
    "body": "Changed commit from **[`1b6cdbc`](https://github.com/sagemath/sagetrac-mirror/commit/1b6cdbc50cc308c83392207977aaf96d0fd1d515)** to **[`fec80eb`](https://github.com/sagemath/sagetrac-mirror/commit/fec80eb18c6fde27065465c07b8808b8e201cced)**",
    "created_at": "2021-07-03T12:44:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515980",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1b6cdbc`](https://github.com/sagemath/sagetrac-mirror/commit/1b6cdbc50cc308c83392207977aaf96d0fd1d515)** to **[`fec80eb`](https://github.com/sagemath/sagetrac-mirror/commit/fec80eb18c6fde27065465c07b8808b8e201cced)**



---

archive/issue_comments_515981.json:
```json
{
    "body": "<div id=\"comment:39\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fec80eb18c6fde27065465c07b8808b8e201cced\"><code>fec80eb</code></a></td><td><code>Trac #32037: replace some ellipses with abs_tol.</code></td></tr></table>\n",
    "created_at": "2021-07-03T12:44:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515981",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:39"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fec80eb18c6fde27065465c07b8808b8e201cced"><code>fec80eb</code></a></td><td><code>Trac #32037: replace some ellipses with abs_tol.</code></td></tr></table>




---

archive/issue_events_441884.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-07-03T12:46:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441884"
}
```



---

archive/issue_comments_515982.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nI've fixed all of the problems I know about, and deleted the one remaining failing doctest that no one knows what to do with. Pending a ptestlong, I think it's ready for a serious look.",
    "created_at": "2021-07-03T12:46:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515982",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:40" align="right">comment:40</div>

I've fixed all of the problems I know about, and deleted the one remaining failing doctest that no one knows what to do with. Pending a ptestlong, I think it's ready for a serious look.



---

archive/issue_comments_515983.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nThe branch is red. Is there a merge conflict?",
    "created_at": "2021-07-03T18:28:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515983",
    "user": "https://github.com/DaveWitteMorris"
}
```

<div id="comment:41" align="right">comment:41</div>

The branch is red. Is there a merge conflict?



---

archive/issue_comments_515984.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nReplying to [@DaveWitteMorris](#comment:41):\n> The branch is red. Is there a merge conflict?\n\nProbably the gcc-11 patch that was added for the lcalc SPKG before sage-9.4. I can rebase after my ptestlong finishes.",
    "created_at": "2021-07-03T18:32:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515984",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:42" align="right">comment:42</div>

Replying to [@DaveWitteMorris](#comment:41):
> The branch is red. Is there a merge conflict?

Probably the gcc-11 patch that was added for the lcalc SPKG before sage-9.4. I can rebase after my ptestlong finishes.



---

archive/issue_comments_515985.json:
```json
{
    "body": "Changed commit from **[`fec80eb`](https://github.com/sagemath/sagetrac-mirror/commit/fec80eb18c6fde27065465c07b8808b8e201cced)** to **[`1750827`](https://github.com/sagemath/sagetrac-mirror/commit/175082741e57941abf48a7d3365cc0b75f6ca404)**",
    "created_at": "2021-07-03T21:28:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515985",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`fec80eb`](https://github.com/sagemath/sagetrac-mirror/commit/fec80eb18c6fde27065465c07b8808b8e201cced)** to **[`1750827`](https://github.com/sagemath/sagetrac-mirror/commit/175082741e57941abf48a7d3365cc0b75f6ca404)**



---

archive/issue_comments_515986.json:
```json
{
    "body": "<div id=\"comment:43\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eab9b441ce1fe67b8fd04eefa2bc0577c57c1fdc\"><code>eab9b44</code></a></td><td><code>Trac #32037: adjust doctest tolerance for lcalc-2.0.1 in lseries_ell.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/175082741e57941abf48a7d3365cc0b75f6ca404\"><code>1750827</code></a></td><td><code>Trac #32037: weaken doctest tolerance for lcalc-2.0.1 in modular/dirichlet.py.</code></td></tr></table>\n",
    "created_at": "2021-07-03T21:28:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515986",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:43"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eab9b441ce1fe67b8fd04eefa2bc0577c57c1fdc"><code>eab9b44</code></a></td><td><code>Trac #32037: adjust doctest tolerance for lcalc-2.0.1 in lseries_ell.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/175082741e57941abf48a7d3365cc0b75f6ca404"><code>1750827</code></a></td><td><code>Trac #32037: weaken doctest tolerance for lcalc-2.0.1 in modular/dirichlet.py.</code></td></tr></table>




---

archive/issue_comments_515987.json:
```json
{
    "body": "Changed commit from **[`1750827`](https://github.com/sagemath/sagetrac-mirror/commit/175082741e57941abf48a7d3365cc0b75f6ca404)** to **[`dce49da`](https://github.com/sagemath/sagetrac-mirror/commit/dce49daa311c2574b934d4ebecdb6e6ee0226e1e)**",
    "created_at": "2021-07-03T21:42:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515987",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1750827`](https://github.com/sagemath/sagetrac-mirror/commit/175082741e57941abf48a7d3365cc0b75f6ca404)** to **[`dce49da`](https://github.com/sagemath/sagetrac-mirror/commit/dce49daa311c2574b934d4ebecdb6e6ee0226e1e)**



---

archive/issue_comments_515988.json:
```json
{
    "body": "<div id=\"comment:44\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dce49daa311c2574b934d4ebecdb6e6ee0226e1e\"><code>dce49da</code></a></td><td><code>Trac #32037: tweak a doctest in elliptic_curves/ell_rational_field.py.</code></td></tr></table>\n",
    "created_at": "2021-07-03T21:42:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515988",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:44"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dce49daa311c2574b934d4ebecdb6e6ee0226e1e"><code>dce49da</code></a></td><td><code>Trac #32037: tweak a doctest in elliptic_curves/ell_rational_field.py.</code></td></tr></table>




---

archive/issue_events_441885.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2021-07-04T08:34:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441885"
}
```



---

archive/issue_events_441886.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2021-07-04T08:34:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441886"
}
```



---

archive/issue_comments_515989.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nDoesn't merge cleanly on current develop, please rebase",
    "created_at": "2021-07-04T08:34:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515989",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:45" align="right">comment:45</div>

Doesn't merge cleanly on current develop, please rebase



---

archive/issue_comments_515990.json:
```json
{
    "body": "Changed commit from **[`dce49da`](https://github.com/sagemath/sagetrac-mirror/commit/dce49daa311c2574b934d4ebecdb6e6ee0226e1e)** to **[`c5d8924`](https://github.com/sagemath/sagetrac-mirror/commit/c5d8924a907d40ebc9bd6121fe869ea4acadf85f)**",
    "created_at": "2021-07-04T12:24:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515990",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`dce49da`](https://github.com/sagemath/sagetrac-mirror/commit/dce49daa311c2574b934d4ebecdb6e6ee0226e1e)** to **[`c5d8924`](https://github.com/sagemath/sagetrac-mirror/commit/c5d8924a907d40ebc9bd6121fe869ea4acadf85f)**



---

archive/issue_comments_515991.json:
```json
{
    "body": "<div id=\"comment:46\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1a4df39703e481fd508df71087e286fcddefcd77\"><code>1a4df39</code></a></td><td><code>Trac #32037: update the doctest for the DirichletGroup(5)[1] L-function.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/44e5d57303df7cde0755ecf4b43d02075e569c64\"><code>44e5d57</code></a></td><td><code>Trac #32037: lower all lcalc tolerances to 1e-8.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d1dbfb54fc5ab2ecf921cbf29b7ff6545a98cc34\"><code>d1dbfb5</code></a></td><td><code>Trac #32037: add abs_tol to an lcalc test to fix a new failure.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a84d284b52bd5226cce7ad6cdf5aa1590523484c\"><code>a84d284</code></a></td><td><code>Trac #32037: update an lcalc doctest that counts zeros.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1727c69c88b074d6ed4e2e40a30aed87e8397d86\"><code>1727c69</code></a></td><td><code>Trac #32037: add tolerance to a few sage/lfunctions/lcalc.py doctests.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/191147f3aaafbb29e0aa6031e52c4bf1a22e3831\"><code>191147f</code></a></td><td><code>Trac #32037: delete a failing doctest.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0b668c90ccfb5aa3087b0e22ce5e3c78f49ec618\"><code>0b668c9</code></a></td><td><code>Trac #32037: replace some ellipses with abs_tol.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9e3f55fc41ac9f77d9f3e4e8d1090e4d5094e3ff\"><code>9e3f55f</code></a></td><td><code>Trac #32037: adjust doctest tolerance for lcalc-2.0.1 in lseries_ell.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7fc9b896ff9a9b868a14db1e1c0becb52544f037\"><code>7fc9b89</code></a></td><td><code>Trac #32037: weaken doctest tolerance for lcalc-2.0.1 in modular/dirichlet.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c5d8924a907d40ebc9bd6121fe869ea4acadf85f\"><code>c5d8924</code></a></td><td><code>Trac #32037: tweak a doctest in elliptic_curves/ell_rational_field.py.</code></td></tr></table>\n",
    "created_at": "2021-07-04T12:24:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515991",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:46"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1a4df39703e481fd508df71087e286fcddefcd77"><code>1a4df39</code></a></td><td><code>Trac #32037: update the doctest for the DirichletGroup(5)[1] L-function.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/44e5d57303df7cde0755ecf4b43d02075e569c64"><code>44e5d57</code></a></td><td><code>Trac #32037: lower all lcalc tolerances to 1e-8.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d1dbfb54fc5ab2ecf921cbf29b7ff6545a98cc34"><code>d1dbfb5</code></a></td><td><code>Trac #32037: add abs_tol to an lcalc test to fix a new failure.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a84d284b52bd5226cce7ad6cdf5aa1590523484c"><code>a84d284</code></a></td><td><code>Trac #32037: update an lcalc doctest that counts zeros.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1727c69c88b074d6ed4e2e40a30aed87e8397d86"><code>1727c69</code></a></td><td><code>Trac #32037: add tolerance to a few sage/lfunctions/lcalc.py doctests.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/191147f3aaafbb29e0aa6031e52c4bf1a22e3831"><code>191147f</code></a></td><td><code>Trac #32037: delete a failing doctest.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0b668c90ccfb5aa3087b0e22ce5e3c78f49ec618"><code>0b668c9</code></a></td><td><code>Trac #32037: replace some ellipses with abs_tol.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9e3f55fc41ac9f77d9f3e4e8d1090e4d5094e3ff"><code>9e3f55f</code></a></td><td><code>Trac #32037: adjust doctest tolerance for lcalc-2.0.1 in lseries_ell.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7fc9b896ff9a9b868a14db1e1c0becb52544f037"><code>7fc9b89</code></a></td><td><code>Trac #32037: weaken doctest tolerance for lcalc-2.0.1 in modular/dirichlet.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c5d8924a907d40ebc9bd6121fe869ea4acadf85f"><code>c5d8924</code></a></td><td><code>Trac #32037: tweak a doctest in elliptic_curves/ell_rational_field.py.</code></td></tr></table>




---

archive/issue_comments_515992.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nshould be ok now",
    "created_at": "2021-07-04T12:26:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515992",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:47" align="right">comment:47</div>

should be ok now



---

archive/issue_comments_515993.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nThis breaks build of sagelib with GCC 11, which worked fine with 1.23 (will all patches on top)\n\n```\nIn file included from /usr/include/lcalc/Lglobals.h:70,\n                 from /usr/include/lcalc/L.h:43,\n                 from build/cythonized/sage/libs/lcalc/lcalc_sage.h:1,\n                 from build/cythonized/sage/libs/lcalc/lcalc_Lfunction.cpp:676:\n/usr/include/c++/11.1.0/limits: In static member function \u2018static constexpr double std::numeric_limits<double>::min()\u2019:\n/usr/include/c++/11.1.0/limits:1748:44: error: call to non-\u2018constexpr\u2019 function \u2018double lcalc_to_double(const long double&)\u2019\n 1748 |       min() _GLIBCXX_USE_NOEXCEPT { return __DBL_MIN__; }\n      |                                            ^~~~~~~~~~~\n/usr/include/lcalc/Lcommon.h:35:15: note: \u2018double lcalc_to_double(const long double&)\u2019 declared here\n   35 | inline double lcalc_to_double(const long double& x) { return x; }\n      |               ^~~~~~~~~~~~~~~\n```",
    "created_at": "2021-07-04T13:13:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515993",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:48" align="right">comment:48</div>

This breaks build of sagelib with GCC 11, which worked fine with 1.23 (will all patches on top)

```
In file included from /usr/include/lcalc/Lglobals.h:70,
                 from /usr/include/lcalc/L.h:43,
                 from build/cythonized/sage/libs/lcalc/lcalc_sage.h:1,
                 from build/cythonized/sage/libs/lcalc/lcalc_Lfunction.cpp:676:
/usr/include/c++/11.1.0/limits: In static member function ‘static constexpr double std::numeric_limits<double>::min()’:
/usr/include/c++/11.1.0/limits:1748:44: error: call to non-‘constexpr’ function ‘double lcalc_to_double(const long double&)’
 1748 |       min() _GLIBCXX_USE_NOEXCEPT { return __DBL_MIN__; }
      |                                            ^~~~~~~~~~~
/usr/include/lcalc/Lcommon.h:35:15: note: ‘double lcalc_to_double(const long double&)’ declared here
   35 | inline double lcalc_to_double(const long double& x) { return x; }
      |               ^~~~~~~~~~~~~~~
```



---

archive/issue_comments_515994.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nOk, thanks, I'll have to investigate after the holiday (it would take more than a day to build gcc-11 on my laptop). The absence of `constexpr` in lcalc is \"correct,\" since lcalc can use MPFR for its double type and the MPFR type is not a constexpr.",
    "created_at": "2021-07-04T13:40:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515994",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:49" align="right">comment:49</div>

Ok, thanks, I'll have to investigate after the holiday (it would take more than a day to build gcc-11 on my laptop). The absence of `constexpr` in lcalc is "correct," since lcalc can use MPFR for its double type and the MPFR type is not a constexpr.



---

archive/issue_comments_515995.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nwe can add archlinux, or some other way to get gcc 11, on  lcalc CI.\n\nhttps://stackoverflow.com/a/67406788/557937\n\n\nwe can make a macro expanding to constexpr or to \"\", and set it up at configure time.",
    "created_at": "2021-07-04T16:21:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515995",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:50" align="right">comment:50</div>

we can add archlinux, or some other way to get gcc 11, on  lcalc CI.

https://stackoverflow.com/a/67406788/557937


we can make a macro expanding to constexpr or to "", and set it up at configure time.



---

archive/issue_comments_515996.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nI'm still not 100% sure what's going on, but this is a `-std=c++11` problem and not a gcc-11 problem. If you let gcc-11 pick the standard, everything works. But if you specify `-std=c++11`, then even the following trivial program will fail,\n\n```C\n#include <lcalc/L.h>\n```\n\nThe errors suggest that somehow `lcalc_to_double()` from lcalc is being invoked in the C++ standard library's `min()` function that's just trying to return a constant:\n\n```\nIn file included from /usr/include/lcalc/Lglobals.h:70,\n                 from /usr/include/lcalc/L.h:43,\n                 from conftest.cpp:1:\n/usr/lib/gcc/x86_64-pc-linux-gnu/11.1.0/include/g++-v11/limits: In static member function 'static constexpr double std::numeric_limits<double>::min()':\n/usr/lib/gcc/x86_64-pc-linux-gnu/11.1.0/include/g++-v11/limits:1748:44: error: call to non-'constexpr' function 'double lcalc_to_double(const long double&)'\n 1748 |       min() _GLIBCXX_USE_NOEXCEPT { return __DBL_MIN__; }\n```",
    "created_at": "2021-07-05T13:05:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515996",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:51" align="right">comment:51</div>

I'm still not 100% sure what's going on, but this is a `-std=c++11` problem and not a gcc-11 problem. If you let gcc-11 pick the standard, everything works. But if you specify `-std=c++11`, then even the following trivial program will fail,

```C
#include <lcalc/L.h>
```

The errors suggest that somehow `lcalc_to_double()` from lcalc is being invoked in the C++ standard library's `min()` function that's just trying to return a constant:

```
In file included from /usr/include/lcalc/Lglobals.h:70,
                 from /usr/include/lcalc/L.h:43,
                 from conftest.cpp:1:
/usr/lib/gcc/x86_64-pc-linux-gnu/11.1.0/include/g++-v11/limits: In static member function 'static constexpr double std::numeric_limits<double>::min()':
/usr/lib/gcc/x86_64-pc-linux-gnu/11.1.0/include/g++-v11/limits:1748:44: error: call to non-'constexpr' function 'double lcalc_to_double(const long double&)'
 1748 |       min() _GLIBCXX_USE_NOEXCEPT { return __DBL_MIN__; }
```



---

archive/issue_comments_515997.json:
```json
{
    "body": "<div id=\"comment:52\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1a4061a098519973bd3085db3c7414bdb37ce944\"><code>1a4061a</code></a></td><td><code>Trac #32037: update to lcalc-2.0.2 to fix the build with std=c++11.</code></td></tr></table>\n",
    "created_at": "2021-07-05T14:52:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515997",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:52"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1a4061a098519973bd3085db3c7414bdb37ce944"><code>1a4061a</code></a></td><td><code>Trac #32037: update to lcalc-2.0.2 to fix the build with std=c++11.</code></td></tr></table>




---

archive/issue_comments_515998.json:
```json
{
    "body": "Changed commit from **[`c5d8924`](https://github.com/sagemath/sagetrac-mirror/commit/c5d8924a907d40ebc9bd6121fe869ea4acadf85f)** to **[`1a4061a`](https://github.com/sagemath/sagetrac-mirror/commit/1a4061a098519973bd3085db3c7414bdb37ce944)**",
    "created_at": "2021-07-05T14:52:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515998",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c5d8924`](https://github.com/sagemath/sagetrac-mirror/commit/c5d8924a907d40ebc9bd6121fe869ea4acadf85f)** to **[`1a4061a`](https://github.com/sagemath/sagetrac-mirror/commit/1a4061a098519973bd3085db3c7414bdb37ce944)**



---

archive/issue_events_441887.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-07-05T14:54:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441887"
}
```



---

archive/issue_events_441888.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-07-05T14:54:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441888"
}
```



---

archive/issue_comments_515999.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nThere was a recent change that started adding `-std=gnu++11` to our `CXXFLAGS` and broke lcalc. I released lcalc-2.0.2 which should work again.",
    "created_at": "2021-07-05T14:54:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-515999",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:53" align="right">comment:53</div>

There was a recent change that started adding `-std=gnu++11` to our `CXXFLAGS` and broke lcalc. I released lcalc-2.0.2 which should work again.



---

archive/issue_events_441889.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-07-05T14:54:49Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "title_is": "Upgrade to lcalc-2.0.2",
    "title_was": "Upgrade to lcalc-2.0.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441889"
}
```



---

archive/issue_comments_516000.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nI confirm sagelib builds fine again with GCC 11",
    "created_at": "2021-07-05T15:17:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516000",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:54" align="right">comment:54</div>

I confirm sagelib builds fine again with GCC 11



---

archive/issue_comments_516001.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nwhat change was adding the -std=gnu++11 ?\n\nit is certainly important that all the Sage  C++ libs are compatible wrt to C++ ABI.",
    "created_at": "2021-07-05T15:52:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516001",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:55" align="right">comment:55</div>

what change was adding the -std=gnu++11 ?

it is certainly important that all the Sage  C++ libs are compatible wrt to C++ ABI.



---

archive/issue_comments_516002.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nI haven't followed the discussion on the ticket, but if a specific C++ standard is needed to use the headers, then it is best to declare it in the `.pxd` file using `distutils: extra_compile_args=-std=c++11`.\n\n`sage_setup.command.sage_build_cython` does set this as a default - but I consider this only legacy behavior of our homegrown build system for sagelib. \n\nIt will have to be tested with `./configure --enable-editable`, which switches the sagelib build to a simpler build system.",
    "created_at": "2021-07-05T16:59:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516002",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:56" align="right">comment:56</div>

I haven't followed the discussion on the ticket, but if a specific C++ standard is needed to use the headers, then it is best to declare it in the `.pxd` file using `distutils: extra_compile_args=-std=c++11`.

`sage_setup.command.sage_build_cython` does set this as a default - but I consider this only legacy behavior of our homegrown build system for sagelib. 

It will have to be tested with `./configure --enable-editable`, which switches the sagelib build to a simpler build system.



---

archive/issue_comments_516003.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nReplying to [@dimpase](#comment:55):\n> what change was adding the -std=gnu++11 ?\n\nThe switch to c++11 is actually pretty old (see e.g. 370c03505f290f). What must have changed is that `-std=gnu++11` started being added earlier in the build process, before we try to detect lcalc (I know *something* changed because detecting lcalc-2.0.1 used to work before I rebased onto develop). Regardless, adding the flag early is the right thing to do if we're ultimately going to be compiling code against these libraries with `-std=gnu++11` in `CXXFLAGS`.\n\nFor me now, that flag gets added while detecting GCC.",
    "created_at": "2021-07-06T15:47:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516003",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:57" align="right">comment:57</div>

Replying to [@dimpase](#comment:55):
> what change was adding the -std=gnu++11 ?

The switch to c++11 is actually pretty old (see e.g. 370c03505f290f). What must have changed is that `-std=gnu++11` started being added earlier in the build process, before we try to detect lcalc (I know *something* changed because detecting lcalc-2.0.1 used to work before I rebased onto develop). Regardless, adding the flag early is the right thing to do if we're ultimately going to be compiling code against these libraries with `-std=gnu++11` in `CXXFLAGS`.

For me now, that flag gets added while detecting GCC.



---

archive/issue_comments_516004.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nReplying to [@mkoeppe](#comment:56):\n> I haven't followed the discussion on the ticket, but if a specific C++ standard is needed to use the headers, then it is best to declare it in the `.pxd` file using `distutils: extra_compile_args=-std=c++11`.\n\nNo special flags are needed. The latest lcalc-2.0.2 will work with any of the 11, 14, or 17 standards.",
    "created_at": "2021-07-06T15:48:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516004",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:58" align="right">comment:58</div>

Replying to [@mkoeppe](#comment:56):
> I haven't followed the discussion on the ticket, but if a specific C++ standard is needed to use the headers, then it is best to declare it in the `.pxd` file using `distutils: extra_compile_args=-std=c++11`.

No special flags are needed. The latest lcalc-2.0.2 will work with any of the 11, 14, or 17 standards.



---

archive/issue_comments_516005.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nWith my distro packages, getting one test failure only\n\n```\nFile \"/usr/lib/python3.9/site-packages/sage/lfunctions/zero_sums.pyx\", line 832, in sage.lfunctions.zero_sums.LFunctionZeroSum_abstract._zerosum_cauchy\nFailed example:\n    E.lseries().zeros(2)\nExpected:\n    [6.36261389, 8.60353962]\nGot:\n    [6.36261390, 8.60353962]\n**********************************************************************\n```",
    "created_at": "2021-07-07T06:14:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516005",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:59" align="right">comment:59</div>

With my distro packages, getting one test failure only

```
File "/usr/lib/python3.9/site-packages/sage/lfunctions/zero_sums.pyx", line 832, in sage.lfunctions.zero_sums.LFunctionZeroSum_abstract._zerosum_cauchy
Failed example:
    E.lseries().zeros(2)
Expected:
    [6.36261389, 8.60353962]
Got:
    [6.36261390, 8.60353962]
**********************************************************************
```



---

archive/issue_comments_516006.json:
```json
{
    "body": "Changed commit from **[`1a4061a`](https://github.com/sagemath/sagetrac-mirror/commit/1a4061a098519973bd3085db3c7414bdb37ce944)** to **[`12ac186`](https://github.com/sagemath/sagetrac-mirror/commit/12ac186b28f7a49469a3019f3a39ac313d656807)**",
    "created_at": "2021-07-07T11:57:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516006",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1a4061a`](https://github.com/sagemath/sagetrac-mirror/commit/1a4061a098519973bd3085db3c7414bdb37ce944)** to **[`12ac186`](https://github.com/sagemath/sagetrac-mirror/commit/12ac186b28f7a49469a3019f3a39ac313d656807)**



---

archive/issue_comments_516007.json:
```json
{
    "body": "<div id=\"comment:60\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/12ac186b28f7a49469a3019f3a39ac313d656807\"><code>12ac186</code></a></td><td><code>Trac #32037: add tolerance to a test in sage/lfunctions/zero_sums.pyx.</code></td></tr></table>\n",
    "created_at": "2021-07-07T11:57:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516007",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:60"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/12ac186b28f7a49469a3019f3a39ac313d656807"><code>12ac186</code></a></td><td><code>Trac #32037: add tolerance to a test in sage/lfunctions/zero_sums.pyx.</code></td></tr></table>




---

archive/issue_comments_516008.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\ntests run on https://github.com/sagemath/sagetrac-mirror/actions/runs/1009717554",
    "created_at": "2021-07-07T22:50:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516008",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:61" align="right">comment:61</div>

tests run on https://github.com/sagemath/sagetrac-mirror/actions/runs/1009717554



---

archive/issue_comments_516009.json:
```json
{
    "body": "Changed commit from **[`12ac186`](https://github.com/sagemath/sagetrac-mirror/commit/12ac186b28f7a49469a3019f3a39ac313d656807)** to **[`2d13818`](https://github.com/sagemath/sagetrac-mirror/commit/2d138187193b0661ee950b7a59af7b8b70fc3bf4)**",
    "created_at": "2021-07-13T18:48:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516009",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`12ac186`](https://github.com/sagemath/sagetrac-mirror/commit/12ac186b28f7a49469a3019f3a39ac313d656807)** to **[`2d13818`](https://github.com/sagemath/sagetrac-mirror/commit/2d138187193b0661ee950b7a59af7b8b70fc3bf4)**



---

archive/issue_comments_516010.json:
```json
{
    "body": "<div id=\"comment:62\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f58d06e15acf7a74cc5d6808a67ccdcb8dd5454d\"><code>f58d06e</code></a></td><td><code>Trac #32037: update an lcalc doctest that counts zeros.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3f6911772f7c351ce6bb515f9b33a8bb7b7b89fe\"><code>3f69117</code></a></td><td><code>Trac #32037: add tolerance to a few sage/lfunctions/lcalc.py doctests.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b642382defcef7381bc97906ea44d1fba5e0eb9e\"><code>b642382</code></a></td><td><code>Trac #32037: delete a failing doctest.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51750e325acb3c40aca45446589beeee2bf10cf8\"><code>51750e3</code></a></td><td><code>Trac #32037: replace some ellipses with abs_tol.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0eeb0730525be086cb779b76e5f286ae8db52619\"><code>0eeb073</code></a></td><td><code>Trac #32037: adjust doctest tolerance for lcalc-2.0.1 in lseries_ell.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c99d844a325b251e39084f5db1fe53319bc61967\"><code>c99d844</code></a></td><td><code>Trac #32037: weaken doctest tolerance for lcalc-2.0.1 in modular/dirichlet.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/300ee8971674f1507a44d3c882de06f85d09a406\"><code>300ee89</code></a></td><td><code>Trac #32037: tweak a doctest in elliptic_curves/ell_rational_field.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/10123527ce580be55cf778fc23a5f7df32ea844e\"><code>1012352</code></a></td><td><code>Trac #32037: update to lcalc-2.0.2 to fix the build with std=c++11.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/57d4c29d05fb1ae8ae9307cd5b2d20ce2212d413\"><code>57d4c29</code></a></td><td><code>Trac #32037: add tolerance to a test in sage/lfunctions/zero_sums.pyx.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2d138187193b0661ee950b7a59af7b8b70fc3bf4\"><code>2d13818</code></a></td><td><code>Trac #32037: upgrade to lcalc-2.0.3.</code></td></tr></table>\n",
    "created_at": "2021-07-13T18:48:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516010",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:62"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f58d06e15acf7a74cc5d6808a67ccdcb8dd5454d"><code>f58d06e</code></a></td><td><code>Trac #32037: update an lcalc doctest that counts zeros.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3f6911772f7c351ce6bb515f9b33a8bb7b7b89fe"><code>3f69117</code></a></td><td><code>Trac #32037: add tolerance to a few sage/lfunctions/lcalc.py doctests.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b642382defcef7381bc97906ea44d1fba5e0eb9e"><code>b642382</code></a></td><td><code>Trac #32037: delete a failing doctest.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51750e325acb3c40aca45446589beeee2bf10cf8"><code>51750e3</code></a></td><td><code>Trac #32037: replace some ellipses with abs_tol.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0eeb0730525be086cb779b76e5f286ae8db52619"><code>0eeb073</code></a></td><td><code>Trac #32037: adjust doctest tolerance for lcalc-2.0.1 in lseries_ell.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c99d844a325b251e39084f5db1fe53319bc61967"><code>c99d844</code></a></td><td><code>Trac #32037: weaken doctest tolerance for lcalc-2.0.1 in modular/dirichlet.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/300ee8971674f1507a44d3c882de06f85d09a406"><code>300ee89</code></a></td><td><code>Trac #32037: tweak a doctest in elliptic_curves/ell_rational_field.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/10123527ce580be55cf778fc23a5f7df32ea844e"><code>1012352</code></a></td><td><code>Trac #32037: update to lcalc-2.0.2 to fix the build with std=c++11.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/57d4c29d05fb1ae8ae9307cd5b2d20ce2212d413"><code>57d4c29</code></a></td><td><code>Trac #32037: add tolerance to a test in sage/lfunctions/zero_sums.pyx.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2d138187193b0661ee950b7a59af7b8b70fc3bf4"><code>2d13818</code></a></td><td><code>Trac #32037: upgrade to lcalc-2.0.3.</code></td></tr></table>




---

archive/issue_comments_516011.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-I've just tagged a 2.0.1 release of lcalc: https://gitlab.com/sagemath/lcalc/-/tags/2.0.1\n+I've just tagged a 2.0.3 release of lcalc: https://gitlab.com/sagemath/lcalc/-/tags/2.0.3\n \n There are a few issues that need to be addressed during the upgrade.\n \n``````\n",
    "created_at": "2021-07-13T18:50:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516011",
    "user": "https://github.com/orlitzky"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-I've just tagged a 2.0.1 release of lcalc: https://gitlab.com/sagemath/lcalc/-/tags/2.0.1
+I've just tagged a 2.0.3 release of lcalc: https://gitlab.com/sagemath/lcalc/-/tags/2.0.3
 
 There are a few issues that need to be addressed during the upgrade.
 
``````




---

archive/issue_comments_516012.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nI accidentally broke the soname in the last version, so here's v2.0.3 to fix it. Also rebased onto the latest gengetopt branch.",
    "created_at": "2021-07-13T18:50:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516012",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:63" align="right">comment:63</div>

I accidentally broke the soname in the last version, so here's v2.0.3 to fix it. Also rebased onto the latest gengetopt branch.



---

archive/issue_events_441890.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-07-13T18:50:48Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "title_is": "Upgrade to lcalc-2.0.3",
    "title_was": "Upgrade to lcalc-2.0.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441890"
}
```



---

archive/issue_events_441891.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T02:58:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441891"
}
```



---

archive/issue_events_441892.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T02:58:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441892"
}
```



---

archive/issue_comments_516013.json:
```json
{
    "body": "Changed commit from **[`2d13818`](https://github.com/sagemath/sagetrac-mirror/commit/2d138187193b0661ee950b7a59af7b8b70fc3bf4)** to **[`dd656cf`](https://github.com/sagemath/sagetrac-mirror/commit/dd656cf19dbd95e3e55d591252dfea052258a7c1)**",
    "created_at": "2021-07-19T12:15:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516013",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2d13818`](https://github.com/sagemath/sagetrac-mirror/commit/2d138187193b0661ee950b7a59af7b8b70fc3bf4)** to **[`dd656cf`](https://github.com/sagemath/sagetrac-mirror/commit/dd656cf19dbd95e3e55d591252dfea052258a7c1)**



---

archive/issue_comments_516014.json:
```json
{
    "body": "<div id=\"comment:65\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dd656cf19dbd95e3e55d591252dfea052258a7c1\"><code>dd656cf</code></a></td><td><code>Trac #32037: make getgetopt an order-only dependency of lcalc.</code></td></tr></table>\n",
    "created_at": "2021-07-19T12:15:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516014",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:65"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dd656cf19dbd95e3e55d591252dfea052258a7c1"><code>dd656cf</code></a></td><td><code>Trac #32037: make getgetopt an order-only dependency of lcalc.</code></td></tr></table>




---

archive/issue_comments_516015.json:
```json
{
    "body": "Author: **Michael Orlitzky, Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2021-08-19T21:38:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516015",
    "user": "https://github.com/slel"
}
```

Author: **Michael Orlitzky, Frédéric Chapoton**



---

archive/issue_events_441893.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2021-10-29T06:24:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441893"
}
```



---

archive/issue_events_441894.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2021-10-29T06:24:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441894"
}
```



---

archive/issue_comments_516016.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nI've been shipping this downstream for 3 months without issues",
    "created_at": "2021-10-29T06:24:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516016",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:67" align="right">comment:67</div>

I've been shipping this downstream for 3 months without issues



---

archive/issue_comments_516017.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nTicket description should be cleaned up",
    "created_at": "2021-10-29T06:32:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516017",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:68" align="right">comment:68</div>

Ticket description should be cleaned up



---

archive/issue_comments_516018.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nI tried to reduce the ticket description to a digest.\n\nNot sure what the conclusion was on item 7, so I left that out.\n\nThe ticket description from before my edit is reproduced below.\n\n---\n\nI've just tagged a 2.0.3 release of lcalc: https://gitlab.com/sagemath/lcalc/-/tags/2.0.3\n\nThere are a few issues that need to be addressed during the upgrade.\n\n0. The build requires GNU gengetopt, so we'll need a new gengetopt SPKG for lcalc to depend on. (It doesn't need to go in the DEPCHECK macro though, since it's a build-only dependency.)\n1. The build system is now sane. This should make life easier in the long run, but means that spkg-* need to be rewritten. `./configure --with-pari` should suffice.\n\n2. The lcalc spkg shouldn't depend on mpfr (I'm not sure why it ever did).\n\n3. spkg-configure.m4 should be modified to find the new version, for example...\n\n```patch\ndiff --git a/build/pkgs/lcalc/spkg-configure.m4 b/build/pkgs/lcalc/spkg-configure.m4\nindex 19a87c8d30..b332294eae 100644\n--- a/build/pkgs/lcalc/spkg-configure.m4\n+++ b/build/pkgs/lcalc/spkg-configure.m4\n@@ -1,20 +1,20 @@\n SAGE_SPKG_CONFIGURE([lcalc], [\n-    m4_pushdef([SAGE_LCALC_MINVER],[\"1.22\"])\n-    SAGE_SPKG_DEPCHECK([pari mpfr], [\n+    m4_pushdef([SAGE_LCALC_MINVER],[\"2.0.0\"])\n+    SAGE_SPKG_DEPCHECK([pari], [\n         AC_PATH_PROG([LCALC], [lcalc])\n         AS_IF([test x$LCALC = x], [\n            AC_MSG_NOTICE([lcalc not found. Installing lcalc])\n            sage_spkg_install_lcalc=yes], [\n            AC_MSG_CHECKING([is lcalc's version good enough? ])\n-           lcalc_ver=`$LCALC --version 2>>/dev/null | $SED -e 's/lcalc\\ //' | $SED -e 's/\\ .*//g'`\n+           lcalc_ver=$($LCALC --version 2>>/dev/null | $SED -e 's/lcalc\\ //' | cut -d' ' -f2)\n            AX_COMPARE_VERSION([$lcalc_ver], [ge], [$SAGE_LCALC_MINVER], [\n                AC_MSG_RESULT([yes.])\n-               AC_CHECK_HEADER([Lfunction/L.h], [], [sage_spkg_install_lcalc=yes])\n+               AC_CHECK_HEADER([lcalc/L.h], [], [sage_spkg_install_lcalc=yes])\n           AC_MSG_CHECKING([whether we can link and run a program using libLfunction])\n           LCALC_SAVED_LIBS=$LIBS\n           LIBS=\"$LIBS -lLfunction\"\n           AC_RUN_IFELSE([\n-            AC_LANG_PROGRAM([[#include <Lfunction/L.h>]],\n+            AC_LANG_PROGRAM([[#include <lcalc/L.h>]],\n                       [[initialize_globals();\n                         Complex x;\n                         x = Pi*I;\n```\n\nHowever, lcalc-2.0.0 comes with a pkg-config file, so we could greatly simplify that.\n\n4. The public API header has moved to `lcalc/L.h`:\n\n```patch\ndiff --git a/src/sage/libs/lcalc/lcalc_sage.h b/src/sage/libs/lcalc/lcalc_sage.h\nindex 498528917f..18e5232cbe 100644\n--- a/src/sage/libs/lcalc/lcalc_sage.h\n+++ b/src/sage/libs/lcalc/lcalc_sage.h\n@@ -1,4 +1,4 @@\n-#include \"Lfunction/L.h\"\n+#include \"lcalc/L.h\"\n int *new_ints(int l)\n {\n     return new int[l];\n\n```\n\n5. The `find_zeros_via_N_v()` function was removed, and replaced by `find_zeros()`. Here's a patch:\n\n```patch\ndiff --git a/src/sage/libs/lcalc/lcalc_Lfunction.pxd b/src/sage/libs/lcalc/lcalc_Lfunction.pxd\nindex d1dbb5d95d..5edf0844f3 100644\n--- a/src/sage/libs/lcalc/lcalc_Lfunction.pxd\n+++ b/src/sage/libs/lcalc/lcalc_Lfunction.pxd\n@@ -21,7 +21,7 @@ cdef extern from \"lcalc_sage.h\":\n         int (* compute_rank) ()\n         double (* N) (double T)\n         void  (* find_zeros_v)(double T1, double T2, double stepsize, doublevec result )\n-        void (*find_zeros_via_N_v)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec result)\n+        int (*find_zeros)(long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)\n         void (*print_data_L)()\n \n         #Constructor and destructor\n@@ -38,7 +38,7 @@ cdef extern from \"lcalc_sage.h\":\n         double (* N) (double T)\n         double *dirichlet_coefficient\n         void  (* find_zeros_v)(double T1, double T2, double stepsize, doublevec result )\n-        void (*find_zeros_via_N_v)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec result)\n+        int (*find_zeros)(long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)\n         void (*print_data_L)()\n \n         #Constructor and destructor\n@@ -54,7 +54,7 @@ cdef extern from \"lcalc_sage.h\":\n         int (* compute_rank) ()\n         double (* N) (double T)\n         void  (* find_zeros_v)(double T1, double T2, double stepsize, doublevec result )\n-        void (*find_zeros_via_N_v)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec result)\n+        int (*find_zeros)(long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)\n         void (*print_data_L)()\n \n         #Constructor and destructor\n@@ -70,7 +70,7 @@ cdef extern from \"lcalc_sage.h\":\n         int (* compute_rank) ()\n         double (* N) (double T)\n         void  (* find_zeros_v)(double T1, double T2, double stepsize, doublevec result )\n-        void (*find_zeros_via_N_v)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec result)#puts result in vector<double> result\n+        int (*find_zeros)(long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)\n         void (*find_zeros_via_N)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, char *filename) #puts result in filename\n \n         #Constructor and destructor\n@@ -111,7 +111,7 @@ cdef class Lfunction:\n     #strange bug, replacing Double with double gives me a compile error\n     cdef Double __typedN(self, double T)\n     cdef void __find_zeros_v(self, double T1, double T2, double stepsize,doublevec *result)\n-    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula,doublevec *result)\n+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)\n \n     cdef str _repr\n\n```\n\n```patch\ndiff --git a/src/sage/libs/lcalc/lcalc_Lfunction.pyx b/src/sage/libs/lcalc/lcalc_Lfunction.pyx\nindex 7e54d7e78d..409987c5d0 100644\n--- a/src/sage/libs/lcalc/lcalc_Lfunction.pyx\n+++ b/src/sage/libs/lcalc/lcalc_Lfunction.pyx\n@@ -307,8 +307,7 @@ cdef class Lfunction:\n         return returnvalue\n \n     #The default values are from L.h. See L.h\n-    def find_zeros_via_N(self, count=0, do_negative=False, max_refine=1025,\n-                         rank=-1, test_explicit_formula=0):\n+    def find_zeros_via_N(self, count=0, start=0, max_refine=1025, rank=-1):\n         \"\"\"\n         Finds ``count`` number of zeros with positive imaginary part\n         starting at real axis. This function also verifies that all\n@@ -317,8 +316,7 @@ cdef class Lfunction:\n         INPUT:\n \n         - ``count`` - number of zeros to be found\n-        - ``do_negative`` - (default: False) False to ignore zeros below the\n-          real axis.\n+        - ``start`` - (default: 0) how many initial zeros to skip\n         - ``max_refine`` - when some zeros are found to be missing, the step\n           size used to find zeros is refined. max_refine gives an upper limit\n           on when lcalc should give up. Use default value unless you know\n@@ -326,13 +324,9 @@ cdef class Lfunction:\n         - ``rank`` - integer (default: -1) analytic rank of the L-function.\n           If -1 is passed, then we attempt to compute it. (Use default if in\n           doubt)\n-        - ``test_explicit_formula`` - integer (default: 0) If nonzero, test\n-          the explicit formula for additional confidence that all the zeros\n-          have been found and are accurate. This is still being tested, so\n-          using the default is recommended.\n \n         OUTPUT:\n-        \n+\n         list -- A list of the imaginary parts of the zeros that have been found\n \n         EXAMPLES::\n@@ -356,14 +350,10 @@ cdef class Lfunction:\n             sage: L.find_zeros_via_N(3)\n             [14.1347251417..., 21.0220396387..., 25.0108575801...]\n         \"\"\"\n-        cdef Integer count_I = Integer(count)\n-        cdef Integer do_negative_I = Integer(do_negative)\n-        cdef RealNumber max_refine_R = RRR(max_refine)\n-        cdef Integer rank_I = Integer(rank)\n-        cdef Integer test_explicit_I = Integer(test_explicit_formula)\n+        cdef const char *message_stamp = \"\"\n         cdef doublevec result\n         sig_on()\n-        self.__find_zeros_via_N_v(mpz_get_si(count_I.value), mpz_get_si(do_negative_I.value), mpfr_get_d(max_refine_R.value, MPFR_RNDN), mpz_get_si(rank_I.value), mpz_get_si(test_explicit_I.value), &result)\n+        self.__find_zeros(count, start, max_refine, rank, message_stamp, &result)\n         sig_off()\n         returnvalue = []\n         for i in range(result.size()):\n@@ -390,7 +380,7 @@ cdef class Lfunction:\n     cdef void __find_zeros_v(self,double T1, double T2, double stepsize, doublevec *result):\n         raise NotImplementedError\n \n-    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):\n+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec *result):\n         raise NotImplementedError\n \n ##############################################################################\n@@ -486,8 +476,8 @@ cdef class Lfunction_I(Lfunction):\n     cdef double __typedN(self, double T):\n         return (<c_Lfunction_I *>self.thisptr).N(T)\n \n-    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):\n-        (<c_Lfunction_I *>self.thisptr).find_zeros_via_N_v(count, do_negative, max_refine, rank, test_explicit_formula, result[0])\n+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec *result):\n+        (<c_Lfunction_I *>self.thisptr).find_zeros(count, start, max_refine, rank, message_stamp, result)\n \n     # debug tools\n     def _print_data_to_standard_output(self):\n@@ -624,8 +614,8 @@ cdef class Lfunction_D(Lfunction):\n     cdef double __typedN(self, double T):\n         return (<c_Lfunction_D *>self.thisptr).N(T)\n \n-    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):\n-        (<c_Lfunction_D *>self.thisptr).find_zeros_via_N_v(count, do_negative, max_refine, rank, test_explicit_formula, result[0])\n+    cdef int __find_zeros(self, long count, long start,double max_refine, int rank, const char* message_stamp, doublevec *result):\n+        (<c_Lfunction_D *>self.thisptr).find_zeros(count, start, max_refine, rank, message_stamp, result)\n \n     # debug tools\n     def _print_data_to_standard_output(self):\n@@ -769,8 +759,8 @@ cdef class Lfunction_C:\n     cdef double __typedN(self, double T):\n         return (<c_Lfunction_C *>self.thisptr).N(T)\n \n-    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):\n-        (<c_Lfunction_C *>self.thisptr).find_zeros_via_N_v(count, do_negative, max_refine, rank, test_explicit_formula, result[0])\n+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec *result):\n+        (<c_Lfunction_C *>self.thisptr).find_zeros(count, start, max_refine, rank, message_stamp, result)\n \n     # debug tools\n     def _print_data_to_standard_output(self):\n@@ -854,8 +844,8 @@ cdef class Lfunction_Zeta(Lfunction):\n     cdef double __typedN(self, double T):\n         return (<c_Lfunction_Zeta *>self.thisptr).N(T)\n \n-    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):\n-        (<c_Lfunction_Zeta *>self.thisptr).find_zeros_via_N_v(count, do_negative, max_refine, rank, test_explicit_formula, result[0])\n+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec *result):\n+        (<c_Lfunction_Zeta *>self.thisptr).find_zeros(count, start, max_refine, rank, message_stamp, result)\n \n     def __dealloc__(self):\n         \"\"\"\n```\n\n6. Some tests need tolerance updates because the answers have changed slightly.\n\n7. Two tests give different answers entirely and require help from someone who knows what an L-function is. These are discussed on #24820 as well:\n\n```\n**********************************************************************\nFile \"src/sage/libs/lcalc/lcalc_Lfunction.pyx\", line 194, in sage.libs.lcalc.lcalc_Lfunction.Lfunction.hardy_z_function\nFailed example:\n    L.hardy_z_function(.4+.3*I)\nExpected:\n    0.2166144222685... - 0.00408187127850...*I\nGot:\n    0.0240947990422036 + 0.215308871779581*I\n**********************************************************************\nFile \"src/sage/libs/lcalc/lcalc_Lfunction.pyx\", line 350, in sage.libs.lcalc.lcalc_Lfunction.Lfunction.find_zeros_via_N\nFailed example:\n    L.find_zeros_via_N(3)\nExpected:\n    [6.18357819545..., 8.45722917442..., 12.6749464170...]\nGot:\n    [-4.13290370521286, 6.18357819545086, 8.45722917442320]\n**********************************************************************\n```",
    "created_at": "2021-10-29T15:18:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516018",
    "user": "https://github.com/slel"
}
```

<div id="comment:69" align="right">comment:69</div>

I tried to reduce the ticket description to a digest.

Not sure what the conclusion was on item 7, so I left that out.

The ticket description from before my edit is reproduced below.

---

I've just tagged a 2.0.3 release of lcalc: https://gitlab.com/sagemath/lcalc/-/tags/2.0.3

There are a few issues that need to be addressed during the upgrade.

0. The build requires GNU gengetopt, so we'll need a new gengetopt SPKG for lcalc to depend on. (It doesn't need to go in the DEPCHECK macro though, since it's a build-only dependency.)
1. The build system is now sane. This should make life easier in the long run, but means that spkg-* need to be rewritten. `./configure --with-pari` should suffice.

2. The lcalc spkg shouldn't depend on mpfr (I'm not sure why it ever did).

3. spkg-configure.m4 should be modified to find the new version, for example...

```patch
diff --git a/build/pkgs/lcalc/spkg-configure.m4 b/build/pkgs/lcalc/spkg-configure.m4
index 19a87c8d30..b332294eae 100644
--- a/build/pkgs/lcalc/spkg-configure.m4
+++ b/build/pkgs/lcalc/spkg-configure.m4
@@ -1,20 +1,20 @@
 SAGE_SPKG_CONFIGURE([lcalc], [
-    m4_pushdef([SAGE_LCALC_MINVER],["1.22"])
-    SAGE_SPKG_DEPCHECK([pari mpfr], [
+    m4_pushdef([SAGE_LCALC_MINVER],["2.0.0"])
+    SAGE_SPKG_DEPCHECK([pari], [
         AC_PATH_PROG([LCALC], [lcalc])
         AS_IF([test x$LCALC = x], [
            AC_MSG_NOTICE([lcalc not found. Installing lcalc])
            sage_spkg_install_lcalc=yes], [
            AC_MSG_CHECKING([is lcalc's version good enough? ])
-           lcalc_ver=`$LCALC --version 2>>/dev/null | $SED -e 's/lcalc\ //' | $SED -e 's/\ .*//g'`
+           lcalc_ver=$($LCALC --version 2>>/dev/null | $SED -e 's/lcalc\ //' | cut -d' ' -f2)
            AX_COMPARE_VERSION([$lcalc_ver], [ge], [$SAGE_LCALC_MINVER], [
                AC_MSG_RESULT([yes.])
-               AC_CHECK_HEADER([Lfunction/L.h], [], [sage_spkg_install_lcalc=yes])
+               AC_CHECK_HEADER([lcalc/L.h], [], [sage_spkg_install_lcalc=yes])
           AC_MSG_CHECKING([whether we can link and run a program using libLfunction])
           LCALC_SAVED_LIBS=$LIBS
           LIBS="$LIBS -lLfunction"
           AC_RUN_IFELSE([
-            AC_LANG_PROGRAM([[#include <Lfunction/L.h>]],
+            AC_LANG_PROGRAM([[#include <lcalc/L.h>]],
                       [[initialize_globals();
                         Complex x;
                         x = Pi*I;
```

However, lcalc-2.0.0 comes with a pkg-config file, so we could greatly simplify that.

4. The public API header has moved to `lcalc/L.h`:

```patch
diff --git a/src/sage/libs/lcalc/lcalc_sage.h b/src/sage/libs/lcalc/lcalc_sage.h
index 498528917f..18e5232cbe 100644
--- a/src/sage/libs/lcalc/lcalc_sage.h
+++ b/src/sage/libs/lcalc/lcalc_sage.h
@@ -1,4 +1,4 @@
-#include "Lfunction/L.h"
+#include "lcalc/L.h"
 int *new_ints(int l)
 {
     return new int[l];

```

5. The `find_zeros_via_N_v()` function was removed, and replaced by `find_zeros()`. Here's a patch:

```patch
diff --git a/src/sage/libs/lcalc/lcalc_Lfunction.pxd b/src/sage/libs/lcalc/lcalc_Lfunction.pxd
index d1dbb5d95d..5edf0844f3 100644
--- a/src/sage/libs/lcalc/lcalc_Lfunction.pxd
+++ b/src/sage/libs/lcalc/lcalc_Lfunction.pxd
@@ -21,7 +21,7 @@ cdef extern from "lcalc_sage.h":
         int (* compute_rank) ()
         double (* N) (double T)
         void  (* find_zeros_v)(double T1, double T2, double stepsize, doublevec result )
-        void (*find_zeros_via_N_v)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec result)
+        int (*find_zeros)(long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)
         void (*print_data_L)()
 
         #Constructor and destructor
@@ -38,7 +38,7 @@ cdef extern from "lcalc_sage.h":
         double (* N) (double T)
         double *dirichlet_coefficient
         void  (* find_zeros_v)(double T1, double T2, double stepsize, doublevec result )
-        void (*find_zeros_via_N_v)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec result)
+        int (*find_zeros)(long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)
         void (*print_data_L)()
 
         #Constructor and destructor
@@ -54,7 +54,7 @@ cdef extern from "lcalc_sage.h":
         int (* compute_rank) ()
         double (* N) (double T)
         void  (* find_zeros_v)(double T1, double T2, double stepsize, doublevec result )
-        void (*find_zeros_via_N_v)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec result)
+        int (*find_zeros)(long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)
         void (*print_data_L)()
 
         #Constructor and destructor
@@ -70,7 +70,7 @@ cdef extern from "lcalc_sage.h":
         int (* compute_rank) ()
         double (* N) (double T)
         void  (* find_zeros_v)(double T1, double T2, double stepsize, doublevec result )
-        void (*find_zeros_via_N_v)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec result)#puts result in vector<double> result
+        int (*find_zeros)(long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)
         void (*find_zeros_via_N)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, char *filename) #puts result in filename
 
         #Constructor and destructor
@@ -111,7 +111,7 @@ cdef class Lfunction:
     #strange bug, replacing Double with double gives me a compile error
     cdef Double __typedN(self, double T)
     cdef void __find_zeros_v(self, double T1, double T2, double stepsize,doublevec *result)
-    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula,doublevec *result)
+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)
 
     cdef str _repr

```

```patch
diff --git a/src/sage/libs/lcalc/lcalc_Lfunction.pyx b/src/sage/libs/lcalc/lcalc_Lfunction.pyx
index 7e54d7e78d..409987c5d0 100644
--- a/src/sage/libs/lcalc/lcalc_Lfunction.pyx
+++ b/src/sage/libs/lcalc/lcalc_Lfunction.pyx
@@ -307,8 +307,7 @@ cdef class Lfunction:
         return returnvalue
 
     #The default values are from L.h. See L.h
-    def find_zeros_via_N(self, count=0, do_negative=False, max_refine=1025,
-                         rank=-1, test_explicit_formula=0):
+    def find_zeros_via_N(self, count=0, start=0, max_refine=1025, rank=-1):
         """
         Finds ``count`` number of zeros with positive imaginary part
         starting at real axis. This function also verifies that all
@@ -317,8 +316,7 @@ cdef class Lfunction:
         INPUT:
 
         - ``count`` - number of zeros to be found
-        - ``do_negative`` - (default: False) False to ignore zeros below the
-          real axis.
+        - ``start`` - (default: 0) how many initial zeros to skip
         - ``max_refine`` - when some zeros are found to be missing, the step
           size used to find zeros is refined. max_refine gives an upper limit
           on when lcalc should give up. Use default value unless you know
@@ -326,13 +324,9 @@ cdef class Lfunction:
         - ``rank`` - integer (default: -1) analytic rank of the L-function.
           If -1 is passed, then we attempt to compute it. (Use default if in
           doubt)
-        - ``test_explicit_formula`` - integer (default: 0) If nonzero, test
-          the explicit formula for additional confidence that all the zeros
-          have been found and are accurate. This is still being tested, so
-          using the default is recommended.
 
         OUTPUT:
-        
+
         list -- A list of the imaginary parts of the zeros that have been found
 
         EXAMPLES::
@@ -356,14 +350,10 @@ cdef class Lfunction:
             sage: L.find_zeros_via_N(3)
             [14.1347251417..., 21.0220396387..., 25.0108575801...]
         """
-        cdef Integer count_I = Integer(count)
-        cdef Integer do_negative_I = Integer(do_negative)
-        cdef RealNumber max_refine_R = RRR(max_refine)
-        cdef Integer rank_I = Integer(rank)
-        cdef Integer test_explicit_I = Integer(test_explicit_formula)
+        cdef const char *message_stamp = ""
         cdef doublevec result
         sig_on()
-        self.__find_zeros_via_N_v(mpz_get_si(count_I.value), mpz_get_si(do_negative_I.value), mpfr_get_d(max_refine_R.value, MPFR_RNDN), mpz_get_si(rank_I.value), mpz_get_si(test_explicit_I.value), &result)
+        self.__find_zeros(count, start, max_refine, rank, message_stamp, &result)
         sig_off()
         returnvalue = []
         for i in range(result.size()):
@@ -390,7 +380,7 @@ cdef class Lfunction:
     cdef void __find_zeros_v(self,double T1, double T2, double stepsize, doublevec *result):
         raise NotImplementedError
 
-    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):
+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec *result):
         raise NotImplementedError
 
 ##############################################################################
@@ -486,8 +476,8 @@ cdef class Lfunction_I(Lfunction):
     cdef double __typedN(self, double T):
         return (<c_Lfunction_I *>self.thisptr).N(T)
 
-    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):
-        (<c_Lfunction_I *>self.thisptr).find_zeros_via_N_v(count, do_negative, max_refine, rank, test_explicit_formula, result[0])
+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec *result):
+        (<c_Lfunction_I *>self.thisptr).find_zeros(count, start, max_refine, rank, message_stamp, result)
 
     # debug tools
     def _print_data_to_standard_output(self):
@@ -624,8 +614,8 @@ cdef class Lfunction_D(Lfunction):
     cdef double __typedN(self, double T):
         return (<c_Lfunction_D *>self.thisptr).N(T)
 
-    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):
-        (<c_Lfunction_D *>self.thisptr).find_zeros_via_N_v(count, do_negative, max_refine, rank, test_explicit_formula, result[0])
+    cdef int __find_zeros(self, long count, long start,double max_refine, int rank, const char* message_stamp, doublevec *result):
+        (<c_Lfunction_D *>self.thisptr).find_zeros(count, start, max_refine, rank, message_stamp, result)
 
     # debug tools
     def _print_data_to_standard_output(self):
@@ -769,8 +759,8 @@ cdef class Lfunction_C:
     cdef double __typedN(self, double T):
         return (<c_Lfunction_C *>self.thisptr).N(T)
 
-    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):
-        (<c_Lfunction_C *>self.thisptr).find_zeros_via_N_v(count, do_negative, max_refine, rank, test_explicit_formula, result[0])
+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec *result):
+        (<c_Lfunction_C *>self.thisptr).find_zeros(count, start, max_refine, rank, message_stamp, result)
 
     # debug tools
     def _print_data_to_standard_output(self):
@@ -854,8 +844,8 @@ cdef class Lfunction_Zeta(Lfunction):
     cdef double __typedN(self, double T):
         return (<c_Lfunction_Zeta *>self.thisptr).N(T)
 
-    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):
-        (<c_Lfunction_Zeta *>self.thisptr).find_zeros_via_N_v(count, do_negative, max_refine, rank, test_explicit_formula, result[0])
+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec *result):
+        (<c_Lfunction_Zeta *>self.thisptr).find_zeros(count, start, max_refine, rank, message_stamp, result)
 
     def __dealloc__(self):
         """
```

6. Some tests need tolerance updates because the answers have changed slightly.

7. Two tests give different answers entirely and require help from someone who knows what an L-function is. These are discussed on #24820 as well:

```
**********************************************************************
File "src/sage/libs/lcalc/lcalc_Lfunction.pyx", line 194, in sage.libs.lcalc.lcalc_Lfunction.Lfunction.hardy_z_function
Failed example:
    L.hardy_z_function(.4+.3*I)
Expected:
    0.2166144222685... - 0.00408187127850...*I
Got:
    0.0240947990422036 + 0.215308871779581*I
**********************************************************************
File "src/sage/libs/lcalc/lcalc_Lfunction.pyx", line 350, in sage.libs.lcalc.lcalc_Lfunction.Lfunction.find_zeros_via_N
Failed example:
    L.find_zeros_via_N(3)
Expected:
    [6.18357819545..., 8.45722917442..., 12.6749464170...]
Got:
    [-4.13290370521286, 6.18357819545086, 8.45722917442320]
**********************************************************************
```



---

archive/issue_comments_516019.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,251 +1,17 @@\n-I've just tagged a 2.0.3 release of lcalc: https://gitlab.com/sagemath/lcalc/-/tags/2.0.3\n+The new lcalc 2.0.3 has been released.\n+Note in particular:\n \n-There are a few issues that need to be addressed during the upgrade.\n+- sane build system\n+- comes with a pkg-config file\n+- public API header has moved to `lcalc/L.h`\n+- the `find_zeros_via_N_v()` function was removed\n+  and replaced by `find_zeros()`\n \n-0. The build requires GNU gengetopt, so we'll need a new gengetopt SPKG for lcalc to depend on. (It doesn't need to go in the DEPCHECK macro though, since it's a build-only dependency.)\n-1. The build system is now sane. This should make life easier in the long run, but means that spkg-* need to be rewritten. `./configure --with-pari` should suffice.\n+In this ticket we upgrade to lcalc 2.0.3 and:\n \n-2. The lcalc spkg shouldn't depend on mpfr (I'm not sure why it ever did).\n+- add gengetopt as a new standard SPKG\n+- adjust dependencies\n+- adjust spkg-* files for the saner build system\n+- adjust spkg-configure.m4 to find the new version\n+- adjust tolerance in some doctests\n \n-3. spkg-configure.m4 should be modified to find the new version, for example...\n-\n-```patch\n-diff --git a/build/pkgs/lcalc/spkg-configure.m4 b/build/pkgs/lcalc/spkg-configure.m4\n-index 19a87c8d30..b332294eae 100644\n---- a/build/pkgs/lcalc/spkg-configure.m4\n-+++ b/build/pkgs/lcalc/spkg-configure.m4\n-@@ -1,20 +1,20 @@\n- SAGE_SPKG_CONFIGURE([lcalc], [\n--    m4_pushdef([SAGE_LCALC_MINVER],[\"1.22\"])\n--    SAGE_SPKG_DEPCHECK([pari mpfr], [\n-+    m4_pushdef([SAGE_LCALC_MINVER],[\"2.0.0\"])\n-+    SAGE_SPKG_DEPCHECK([pari], [\n-         AC_PATH_PROG([LCALC], [lcalc])\n-         AS_IF([test x$LCALC = x], [\n-            AC_MSG_NOTICE([lcalc not found. Installing lcalc])\n-            sage_spkg_install_lcalc=yes], [\n-            AC_MSG_CHECKING([is lcalc's version good enough? ])\n--           lcalc_ver=`$LCALC --version 2>>/dev/null | $SED -e 's/lcalc\\ //' | $SED -e 's/\\ .*//g'`\n-+           lcalc_ver=$($LCALC --version 2>>/dev/null | $SED -e 's/lcalc\\ //' | cut -d' ' -f2)\n-            AX_COMPARE_VERSION([$lcalc_ver], [ge], [$SAGE_LCALC_MINVER], [\n-                AC_MSG_RESULT([yes.])\n--               AC_CHECK_HEADER([Lfunction/L.h], [], [sage_spkg_install_lcalc=yes])\n-+               AC_CHECK_HEADER([lcalc/L.h], [], [sage_spkg_install_lcalc=yes])\n-           AC_MSG_CHECKING([whether we can link and run a program using libLfunction])\n-           LCALC_SAVED_LIBS=$LIBS\n-           LIBS=\"$LIBS -lLfunction\"\n-           AC_RUN_IFELSE([\n--            AC_LANG_PROGRAM([[#include <Lfunction/L.h>]],\n-+            AC_LANG_PROGRAM([[#include <lcalc/L.h>]],\n-                       [[initialize_globals();\n-                         Complex x;\n-                         x = Pi*I;\n-```\n-\n-However, lcalc-2.0.0 comes with a pkg-config file, so we could greatly simplify that.\n-\n-4. The public API header has moved to `lcalc/L.h`:\n-\n-```patch\n-diff --git a/src/sage/libs/lcalc/lcalc_sage.h b/src/sage/libs/lcalc/lcalc_sage.h\n-index 498528917f..18e5232cbe 100644\n---- a/src/sage/libs/lcalc/lcalc_sage.h\n-+++ b/src/sage/libs/lcalc/lcalc_sage.h\n-@@ -1,4 +1,4 @@\n--#include \"Lfunction/L.h\"\n-+#include \"lcalc/L.h\"\n- int *new_ints(int l)\n- {\n-     return new int[l];\n-\n-```\n-\n-5. The `find_zeros_via_N_v()` function was removed, and replaced by `find_zeros()`. Here's a patch:\n-\n-```patch\n-diff --git a/src/sage/libs/lcalc/lcalc_Lfunction.pxd b/src/sage/libs/lcalc/lcalc_Lfunction.pxd\n-index d1dbb5d95d..5edf0844f3 100644\n---- a/src/sage/libs/lcalc/lcalc_Lfunction.pxd\n-+++ b/src/sage/libs/lcalc/lcalc_Lfunction.pxd\n-@@ -21,7 +21,7 @@ cdef extern from \"lcalc_sage.h\":\n-         int (* compute_rank) ()\n-         double (* N) (double T)\n-         void  (* find_zeros_v)(double T1, double T2, double stepsize, doublevec result )\n--        void (*find_zeros_via_N_v)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec result)\n-+        int (*find_zeros)(long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)\n-         void (*print_data_L)()\n- \n-         #Constructor and destructor\n-@@ -38,7 +38,7 @@ cdef extern from \"lcalc_sage.h\":\n-         double (* N) (double T)\n-         double *dirichlet_coefficient\n-         void  (* find_zeros_v)(double T1, double T2, double stepsize, doublevec result )\n--        void (*find_zeros_via_N_v)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec result)\n-+        int (*find_zeros)(long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)\n-         void (*print_data_L)()\n- \n-         #Constructor and destructor\n-@@ -54,7 +54,7 @@ cdef extern from \"lcalc_sage.h\":\n-         int (* compute_rank) ()\n-         double (* N) (double T)\n-         void  (* find_zeros_v)(double T1, double T2, double stepsize, doublevec result )\n--        void (*find_zeros_via_N_v)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec result)\n-+        int (*find_zeros)(long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)\n-         void (*print_data_L)()\n- \n-         #Constructor and destructor\n-@@ -70,7 +70,7 @@ cdef extern from \"lcalc_sage.h\":\n-         int (* compute_rank) ()\n-         double (* N) (double T)\n-         void  (* find_zeros_v)(double T1, double T2, double stepsize, doublevec result )\n--        void (*find_zeros_via_N_v)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec result)#puts result in vector<double> result\n-+        int (*find_zeros)(long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)\n-         void (*find_zeros_via_N)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, char *filename) #puts result in filename\n- \n-         #Constructor and destructor\n-@@ -111,7 +111,7 @@ cdef class Lfunction:\n-     #strange bug, replacing Double with double gives me a compile error\n-     cdef Double __typedN(self, double T)\n-     cdef void __find_zeros_v(self, double T1, double T2, double stepsize,doublevec *result)\n--    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula,doublevec *result)\n-+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)\n- \n-     cdef str _repr\n-\n-```\n-\n-```patch\n-diff --git a/src/sage/libs/lcalc/lcalc_Lfunction.pyx b/src/sage/libs/lcalc/lcalc_Lfunction.pyx\n-index 7e54d7e78d..409987c5d0 100644\n---- a/src/sage/libs/lcalc/lcalc_Lfunction.pyx\n-+++ b/src/sage/libs/lcalc/lcalc_Lfunction.pyx\n-@@ -307,8 +307,7 @@ cdef class Lfunction:\n-         return returnvalue\n- \n-     #The default values are from L.h. See L.h\n--    def find_zeros_via_N(self, count=0, do_negative=False, max_refine=1025,\n--                         rank=-1, test_explicit_formula=0):\n-+    def find_zeros_via_N(self, count=0, start=0, max_refine=1025, rank=-1):\n-         \"\"\"\n-         Finds ``count`` number of zeros with positive imaginary part\n-         starting at real axis. This function also verifies that all\n-@@ -317,8 +316,7 @@ cdef class Lfunction:\n-         INPUT:\n- \n-         - ``count`` - number of zeros to be found\n--        - ``do_negative`` - (default: False) False to ignore zeros below the\n--          real axis.\n-+        - ``start`` - (default: 0) how many initial zeros to skip\n-         - ``max_refine`` - when some zeros are found to be missing, the step\n-           size used to find zeros is refined. max_refine gives an upper limit\n-           on when lcalc should give up. Use default value unless you know\n-@@ -326,13 +324,9 @@ cdef class Lfunction:\n-         - ``rank`` - integer (default: -1) analytic rank of the L-function.\n-           If -1 is passed, then we attempt to compute it. (Use default if in\n-           doubt)\n--        - ``test_explicit_formula`` - integer (default: 0) If nonzero, test\n--          the explicit formula for additional confidence that all the zeros\n--          have been found and are accurate. This is still being tested, so\n--          using the default is recommended.\n- \n-         OUTPUT:\n--        \n-+\n-         list -- A list of the imaginary parts of the zeros that have been found\n- \n-         EXAMPLES::\n-@@ -356,14 +350,10 @@ cdef class Lfunction:\n-             sage: L.find_zeros_via_N(3)\n-             [14.1347251417..., 21.0220396387..., 25.0108575801...]\n-         \"\"\"\n--        cdef Integer count_I = Integer(count)\n--        cdef Integer do_negative_I = Integer(do_negative)\n--        cdef RealNumber max_refine_R = RRR(max_refine)\n--        cdef Integer rank_I = Integer(rank)\n--        cdef Integer test_explicit_I = Integer(test_explicit_formula)\n-+        cdef const char *message_stamp = \"\"\n-         cdef doublevec result\n-         sig_on()\n--        self.__find_zeros_via_N_v(mpz_get_si(count_I.value), mpz_get_si(do_negative_I.value), mpfr_get_d(max_refine_R.value, MPFR_RNDN), mpz_get_si(rank_I.value), mpz_get_si(test_explicit_I.value), &result)\n-+        self.__find_zeros(count, start, max_refine, rank, message_stamp, &result)\n-         sig_off()\n-         returnvalue = []\n-         for i in range(result.size()):\n-@@ -390,7 +380,7 @@ cdef class Lfunction:\n-     cdef void __find_zeros_v(self,double T1, double T2, double stepsize, doublevec *result):\n-         raise NotImplementedError\n- \n--    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):\n-+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec *result):\n-         raise NotImplementedError\n- \n- ##############################################################################\n-@@ -486,8 +476,8 @@ cdef class Lfunction_I(Lfunction):\n-     cdef double __typedN(self, double T):\n-         return (<c_Lfunction_I *>self.thisptr).N(T)\n- \n--    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):\n--        (<c_Lfunction_I *>self.thisptr).find_zeros_via_N_v(count, do_negative, max_refine, rank, test_explicit_formula, result[0])\n-+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec *result):\n-+        (<c_Lfunction_I *>self.thisptr).find_zeros(count, start, max_refine, rank, message_stamp, result)\n- \n-     # debug tools\n-     def _print_data_to_standard_output(self):\n-@@ -624,8 +614,8 @@ cdef class Lfunction_D(Lfunction):\n-     cdef double __typedN(self, double T):\n-         return (<c_Lfunction_D *>self.thisptr).N(T)\n- \n--    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):\n--        (<c_Lfunction_D *>self.thisptr).find_zeros_via_N_v(count, do_negative, max_refine, rank, test_explicit_formula, result[0])\n-+    cdef int __find_zeros(self, long count, long start,double max_refine, int rank, const char* message_stamp, doublevec *result):\n-+        (<c_Lfunction_D *>self.thisptr).find_zeros(count, start, max_refine, rank, message_stamp, result)\n- \n-     # debug tools\n-     def _print_data_to_standard_output(self):\n-@@ -769,8 +759,8 @@ cdef class Lfunction_C:\n-     cdef double __typedN(self, double T):\n-         return (<c_Lfunction_C *>self.thisptr).N(T)\n- \n--    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):\n--        (<c_Lfunction_C *>self.thisptr).find_zeros_via_N_v(count, do_negative, max_refine, rank, test_explicit_formula, result[0])\n-+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec *result):\n-+        (<c_Lfunction_C *>self.thisptr).find_zeros(count, start, max_refine, rank, message_stamp, result)\n- \n-     # debug tools\n-     def _print_data_to_standard_output(self):\n-@@ -854,8 +844,8 @@ cdef class Lfunction_Zeta(Lfunction):\n-     cdef double __typedN(self, double T):\n-         return (<c_Lfunction_Zeta *>self.thisptr).N(T)\n- \n--    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):\n--        (<c_Lfunction_Zeta *>self.thisptr).find_zeros_via_N_v(count, do_negative, max_refine, rank, test_explicit_formula, result[0])\n-+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec *result):\n-+        (<c_Lfunction_Zeta *>self.thisptr).find_zeros(count, start, max_refine, rank, message_stamp, result)\n- \n-     def __dealloc__(self):\n-         \"\"\"\n-```\n-\n-6. Some tests need tolerance updates because the answers have changed slightly.\n-\n-7. Two tests give different answers entirely and require help from someone who knows what an L-function is. These are discussed on #24820 as well:\n-\n-```\n-**********************************************************************\n-File \"src/sage/libs/lcalc/lcalc_Lfunction.pyx\", line 194, in sage.libs.lcalc.lcalc_Lfunction.Lfunction.hardy_z_function\n-Failed example:\n-    L.hardy_z_function(.4+.3*I)\n-Expected:\n-    0.2166144222685... - 0.00408187127850...*I\n-Got:\n-    0.0240947990422036 + 0.215308871779581*I\n-**********************************************************************\n-File \"src/sage/libs/lcalc/lcalc_Lfunction.pyx\", line 350, in sage.libs.lcalc.lcalc_Lfunction.Lfunction.find_zeros_via_N\n-Failed example:\n-    L.find_zeros_via_N(3)\n-Expected:\n-    [6.18357819545..., 8.45722917442..., 12.6749464170...]\n-Got:\n-    [-4.13290370521286, 6.18357819545086, 8.45722917442320]\n-**********************************************************************\n-```\n``````\n",
    "created_at": "2021-10-29T15:18:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516019",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,251 +1,17 @@
-I've just tagged a 2.0.3 release of lcalc: https://gitlab.com/sagemath/lcalc/-/tags/2.0.3
+The new lcalc 2.0.3 has been released.
+Note in particular:
 
-There are a few issues that need to be addressed during the upgrade.
+- sane build system
+- comes with a pkg-config file
+- public API header has moved to `lcalc/L.h`
+- the `find_zeros_via_N_v()` function was removed
+  and replaced by `find_zeros()`
 
-0. The build requires GNU gengetopt, so we'll need a new gengetopt SPKG for lcalc to depend on. (It doesn't need to go in the DEPCHECK macro though, since it's a build-only dependency.)
-1. The build system is now sane. This should make life easier in the long run, but means that spkg-* need to be rewritten. `./configure --with-pari` should suffice.
+In this ticket we upgrade to lcalc 2.0.3 and:
 
-2. The lcalc spkg shouldn't depend on mpfr (I'm not sure why it ever did).
+- add gengetopt as a new standard SPKG
+- adjust dependencies
+- adjust spkg-* files for the saner build system
+- adjust spkg-configure.m4 to find the new version
+- adjust tolerance in some doctests
 
-3. spkg-configure.m4 should be modified to find the new version, for example...
-
-```patch
-diff --git a/build/pkgs/lcalc/spkg-configure.m4 b/build/pkgs/lcalc/spkg-configure.m4
-index 19a87c8d30..b332294eae 100644
---- a/build/pkgs/lcalc/spkg-configure.m4
-+++ b/build/pkgs/lcalc/spkg-configure.m4
-@@ -1,20 +1,20 @@
- SAGE_SPKG_CONFIGURE([lcalc], [
--    m4_pushdef([SAGE_LCALC_MINVER],["1.22"])
--    SAGE_SPKG_DEPCHECK([pari mpfr], [
-+    m4_pushdef([SAGE_LCALC_MINVER],["2.0.0"])
-+    SAGE_SPKG_DEPCHECK([pari], [
-         AC_PATH_PROG([LCALC], [lcalc])
-         AS_IF([test x$LCALC = x], [
-            AC_MSG_NOTICE([lcalc not found. Installing lcalc])
-            sage_spkg_install_lcalc=yes], [
-            AC_MSG_CHECKING([is lcalc's version good enough? ])
--           lcalc_ver=`$LCALC --version 2>>/dev/null | $SED -e 's/lcalc\ //' | $SED -e 's/\ .*//g'`
-+           lcalc_ver=$($LCALC --version 2>>/dev/null | $SED -e 's/lcalc\ //' | cut -d' ' -f2)
-            AX_COMPARE_VERSION([$lcalc_ver], [ge], [$SAGE_LCALC_MINVER], [
-                AC_MSG_RESULT([yes.])
--               AC_CHECK_HEADER([Lfunction/L.h], [], [sage_spkg_install_lcalc=yes])
-+               AC_CHECK_HEADER([lcalc/L.h], [], [sage_spkg_install_lcalc=yes])
-           AC_MSG_CHECKING([whether we can link and run a program using libLfunction])
-           LCALC_SAVED_LIBS=$LIBS
-           LIBS="$LIBS -lLfunction"
-           AC_RUN_IFELSE([
--            AC_LANG_PROGRAM([[#include <Lfunction/L.h>]],
-+            AC_LANG_PROGRAM([[#include <lcalc/L.h>]],
-                       [[initialize_globals();
-                         Complex x;
-                         x = Pi*I;
-```
-
-However, lcalc-2.0.0 comes with a pkg-config file, so we could greatly simplify that.
-
-4. The public API header has moved to `lcalc/L.h`:
-
-```patch
-diff --git a/src/sage/libs/lcalc/lcalc_sage.h b/src/sage/libs/lcalc/lcalc_sage.h
-index 498528917f..18e5232cbe 100644
---- a/src/sage/libs/lcalc/lcalc_sage.h
-+++ b/src/sage/libs/lcalc/lcalc_sage.h
-@@ -1,4 +1,4 @@
--#include "Lfunction/L.h"
-+#include "lcalc/L.h"
- int *new_ints(int l)
- {
-     return new int[l];
-
-```
-
-5. The `find_zeros_via_N_v()` function was removed, and replaced by `find_zeros()`. Here's a patch:
-
-```patch
-diff --git a/src/sage/libs/lcalc/lcalc_Lfunction.pxd b/src/sage/libs/lcalc/lcalc_Lfunction.pxd
-index d1dbb5d95d..5edf0844f3 100644
---- a/src/sage/libs/lcalc/lcalc_Lfunction.pxd
-+++ b/src/sage/libs/lcalc/lcalc_Lfunction.pxd
-@@ -21,7 +21,7 @@ cdef extern from "lcalc_sage.h":
-         int (* compute_rank) ()
-         double (* N) (double T)
-         void  (* find_zeros_v)(double T1, double T2, double stepsize, doublevec result )
--        void (*find_zeros_via_N_v)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec result)
-+        int (*find_zeros)(long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)
-         void (*print_data_L)()
- 
-         #Constructor and destructor
-@@ -38,7 +38,7 @@ cdef extern from "lcalc_sage.h":
-         double (* N) (double T)
-         double *dirichlet_coefficient
-         void  (* find_zeros_v)(double T1, double T2, double stepsize, doublevec result )
--        void (*find_zeros_via_N_v)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec result)
-+        int (*find_zeros)(long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)
-         void (*print_data_L)()
- 
-         #Constructor and destructor
-@@ -54,7 +54,7 @@ cdef extern from "lcalc_sage.h":
-         int (* compute_rank) ()
-         double (* N) (double T)
-         void  (* find_zeros_v)(double T1, double T2, double stepsize, doublevec result )
--        void (*find_zeros_via_N_v)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec result)
-+        int (*find_zeros)(long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)
-         void (*print_data_L)()
- 
-         #Constructor and destructor
-@@ -70,7 +70,7 @@ cdef extern from "lcalc_sage.h":
-         int (* compute_rank) ()
-         double (* N) (double T)
-         void  (* find_zeros_v)(double T1, double T2, double stepsize, doublevec result )
--        void (*find_zeros_via_N_v)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec result)#puts result in vector<double> result
-+        int (*find_zeros)(long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)
-         void (*find_zeros_via_N)(long count,int do_negative,double max_refine, int rank, int test_explicit_formula, char *filename) #puts result in filename
- 
-         #Constructor and destructor
-@@ -111,7 +111,7 @@ cdef class Lfunction:
-     #strange bug, replacing Double with double gives me a compile error
-     cdef Double __typedN(self, double T)
-     cdef void __find_zeros_v(self, double T1, double T2, double stepsize,doublevec *result)
--    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula,doublevec *result)
-+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec* result)
- 
-     cdef str _repr
-
-```
-
-```patch
-diff --git a/src/sage/libs/lcalc/lcalc_Lfunction.pyx b/src/sage/libs/lcalc/lcalc_Lfunction.pyx
-index 7e54d7e78d..409987c5d0 100644
---- a/src/sage/libs/lcalc/lcalc_Lfunction.pyx
-+++ b/src/sage/libs/lcalc/lcalc_Lfunction.pyx
-@@ -307,8 +307,7 @@ cdef class Lfunction:
-         return returnvalue
- 
-     #The default values are from L.h. See L.h
--    def find_zeros_via_N(self, count=0, do_negative=False, max_refine=1025,
--                         rank=-1, test_explicit_formula=0):
-+    def find_zeros_via_N(self, count=0, start=0, max_refine=1025, rank=-1):
-         """
-         Finds ``count`` number of zeros with positive imaginary part
-         starting at real axis. This function also verifies that all
-@@ -317,8 +316,7 @@ cdef class Lfunction:
-         INPUT:
- 
-         - ``count`` - number of zeros to be found
--        - ``do_negative`` - (default: False) False to ignore zeros below the
--          real axis.
-+        - ``start`` - (default: 0) how many initial zeros to skip
-         - ``max_refine`` - when some zeros are found to be missing, the step
-           size used to find zeros is refined. max_refine gives an upper limit
-           on when lcalc should give up. Use default value unless you know
-@@ -326,13 +324,9 @@ cdef class Lfunction:
-         - ``rank`` - integer (default: -1) analytic rank of the L-function.
-           If -1 is passed, then we attempt to compute it. (Use default if in
-           doubt)
--        - ``test_explicit_formula`` - integer (default: 0) If nonzero, test
--          the explicit formula for additional confidence that all the zeros
--          have been found and are accurate. This is still being tested, so
--          using the default is recommended.
- 
-         OUTPUT:
--        
-+
-         list -- A list of the imaginary parts of the zeros that have been found
- 
-         EXAMPLES::
-@@ -356,14 +350,10 @@ cdef class Lfunction:
-             sage: L.find_zeros_via_N(3)
-             [14.1347251417..., 21.0220396387..., 25.0108575801...]
-         """
--        cdef Integer count_I = Integer(count)
--        cdef Integer do_negative_I = Integer(do_negative)
--        cdef RealNumber max_refine_R = RRR(max_refine)
--        cdef Integer rank_I = Integer(rank)
--        cdef Integer test_explicit_I = Integer(test_explicit_formula)
-+        cdef const char *message_stamp = ""
-         cdef doublevec result
-         sig_on()
--        self.__find_zeros_via_N_v(mpz_get_si(count_I.value), mpz_get_si(do_negative_I.value), mpfr_get_d(max_refine_R.value, MPFR_RNDN), mpz_get_si(rank_I.value), mpz_get_si(test_explicit_I.value), &result)
-+        self.__find_zeros(count, start, max_refine, rank, message_stamp, &result)
-         sig_off()
-         returnvalue = []
-         for i in range(result.size()):
-@@ -390,7 +380,7 @@ cdef class Lfunction:
-     cdef void __find_zeros_v(self,double T1, double T2, double stepsize, doublevec *result):
-         raise NotImplementedError
- 
--    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):
-+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec *result):
-         raise NotImplementedError
- 
- ##############################################################################
-@@ -486,8 +476,8 @@ cdef class Lfunction_I(Lfunction):
-     cdef double __typedN(self, double T):
-         return (<c_Lfunction_I *>self.thisptr).N(T)
- 
--    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):
--        (<c_Lfunction_I *>self.thisptr).find_zeros_via_N_v(count, do_negative, max_refine, rank, test_explicit_formula, result[0])
-+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec *result):
-+        (<c_Lfunction_I *>self.thisptr).find_zeros(count, start, max_refine, rank, message_stamp, result)
- 
-     # debug tools
-     def _print_data_to_standard_output(self):
-@@ -624,8 +614,8 @@ cdef class Lfunction_D(Lfunction):
-     cdef double __typedN(self, double T):
-         return (<c_Lfunction_D *>self.thisptr).N(T)
- 
--    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):
--        (<c_Lfunction_D *>self.thisptr).find_zeros_via_N_v(count, do_negative, max_refine, rank, test_explicit_formula, result[0])
-+    cdef int __find_zeros(self, long count, long start,double max_refine, int rank, const char* message_stamp, doublevec *result):
-+        (<c_Lfunction_D *>self.thisptr).find_zeros(count, start, max_refine, rank, message_stamp, result)
- 
-     # debug tools
-     def _print_data_to_standard_output(self):
-@@ -769,8 +759,8 @@ cdef class Lfunction_C:
-     cdef double __typedN(self, double T):
-         return (<c_Lfunction_C *>self.thisptr).N(T)
- 
--    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):
--        (<c_Lfunction_C *>self.thisptr).find_zeros_via_N_v(count, do_negative, max_refine, rank, test_explicit_formula, result[0])
-+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec *result):
-+        (<c_Lfunction_C *>self.thisptr).find_zeros(count, start, max_refine, rank, message_stamp, result)
- 
-     # debug tools
-     def _print_data_to_standard_output(self):
-@@ -854,8 +844,8 @@ cdef class Lfunction_Zeta(Lfunction):
-     cdef double __typedN(self, double T):
-         return (<c_Lfunction_Zeta *>self.thisptr).N(T)
- 
--    cdef void __find_zeros_via_N_v(self, long count,int do_negative,double max_refine, int rank, int test_explicit_formula, doublevec *result):
--        (<c_Lfunction_Zeta *>self.thisptr).find_zeros_via_N_v(count, do_negative, max_refine, rank, test_explicit_formula, result[0])
-+    cdef int __find_zeros(self, long count, long start, double max_refine, int rank, const char* message_stamp, doublevec *result):
-+        (<c_Lfunction_Zeta *>self.thisptr).find_zeros(count, start, max_refine, rank, message_stamp, result)
- 
-     def __dealloc__(self):
-         """
-```
-
-6. Some tests need tolerance updates because the answers have changed slightly.
-
-7. Two tests give different answers entirely and require help from someone who knows what an L-function is. These are discussed on #24820 as well:
-
-```
-**********************************************************************
-File "src/sage/libs/lcalc/lcalc_Lfunction.pyx", line 194, in sage.libs.lcalc.lcalc_Lfunction.Lfunction.hardy_z_function
-Failed example:
-    L.hardy_z_function(.4+.3*I)
-Expected:
-    0.2166144222685... - 0.00408187127850...*I
-Got:
-    0.0240947990422036 + 0.215308871779581*I
-**********************************************************************
-File "src/sage/libs/lcalc/lcalc_Lfunction.pyx", line 350, in sage.libs.lcalc.lcalc_Lfunction.Lfunction.find_zeros_via_N
-Failed example:
-    L.find_zeros_via_N(3)
-Expected:
-    [6.18357819545..., 8.45722917442..., 12.6749464170...]
-Got:
-    [-4.13290370521286, 6.18357819545086, 8.45722917442320]
-**********************************************************************
-```
``````




---

archive/issue_comments_516020.json:
```json
{
    "body": "Reviewer: **Antonio Rojas**",
    "created_at": "2021-10-29T15:18:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516020",
    "user": "https://github.com/slel"
}
```

Reviewer: **Antonio Rojas**



---

archive/issue_comments_516021.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nReplying to [@slel](#comment:69):\n> I tried to reduce the ticket description to a digest.\n> \n> Not sure what the conclusion was on item 7, so I left that out.\n> \n\nThanks. One of those doctests was updated for the new output, an expected change now that the API automatically determines that the L-function is complex:\n\nhttps://github.com/sagemath/sagetrac-mirror/commits/8d1221a4\n\nThe other was ultimately deleted, because no one can explain either the old or new output:\n\nhttps://github.com/sagemath/sagetrac-mirror/commits/b642382d\n\n> add gengetopt as a new standard SPKG \n\nThis is actually still open as a dependency in #32061.\n\n(Edit: link to the correct commits.)",
    "created_at": "2021-10-29T17:49:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516021",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:70" align="right">comment:70</div>

Replying to [@slel](#comment:69):
> I tried to reduce the ticket description to a digest.
> 
> Not sure what the conclusion was on item 7, so I left that out.
> 

Thanks. One of those doctests was updated for the new output, an expected change now that the API automatically determines that the L-function is complex:

https://github.com/sagemath/sagetrac-mirror/commits/8d1221a4

The other was ultimately deleted, because no one can explain either the old or new output:

https://github.com/sagemath/sagetrac-mirror/commits/b642382d

> add gengetopt as a new standard SPKG 

This is actually still open as a dependency in #32061.

(Edit: link to the correct commits.)



---

archive/issue_comments_516022.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nshould be good to go now.",
    "created_at": "2021-11-01T13:02:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516022",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:71" align="right">comment:71</div>

should be good to go now.



---

archive/issue_comments_516023.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nNeeds to be rebased on top of #31837, which brings a patch that does not apply to the new version",
    "created_at": "2021-11-06T23:24:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516023",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:72" align="right">comment:72</div>

Needs to be rebased on top of #31837, which brings a patch that does not apply to the new version



---

archive/issue_events_441895.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-11-06T23:24:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441895"
}
```



---

archive/issue_events_441896.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-11-06T23:24:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441896"
}
```



---

archive/issue_comments_516024.json:
```json
{
    "body": "Changed dependencies from **#32061** to **#32061, #31837**",
    "created_at": "2021-11-06T23:24:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516024",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#32061** to **#32061, #31837**



---

archive/issue_comments_516025.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\n... as seen in https://github.com/mkoeppe/sage/runs/4127380314?check_suite_focus=true",
    "created_at": "2021-11-06T23:25:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516025",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:73" align="right">comment:73</div>

... as seen in https://github.com/mkoeppe/sage/runs/4127380314?check_suite_focus=true



---

archive/issue_comments_516026.json:
```json
{
    "body": "Changed commit from **[`dd656cf`](https://github.com/sagemath/sagetrac-mirror/commit/dd656cf19dbd95e3e55d591252dfea052258a7c1)** to **[`93f9928`](https://github.com/sagemath/sagetrac-mirror/commit/93f9928194e352bb8ba1ed42b9ab3db4c2786bbe)**",
    "created_at": "2021-11-07T13:28:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516026",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`dd656cf`](https://github.com/sagemath/sagetrac-mirror/commit/dd656cf19dbd95e3e55d591252dfea052258a7c1)** to **[`93f9928`](https://github.com/sagemath/sagetrac-mirror/commit/93f9928194e352bb8ba1ed42b9ab3db4c2786bbe)**



---

archive/issue_comments_516027.json:
```json
{
    "body": "<div id=\"comment:74\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a42b787c808a010ab8ad495645a95add6475774\"><code>9a42b78</code></a></td><td><code>Trac #32037: delete a failing doctest.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1537168d7b33e4e04127b5e5085108ae5441b06a\"><code>1537168</code></a></td><td><code>Trac #32037: replace some ellipses with abs_tol.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c2f3e5c1a62b9338fc7218d0b27f10fd30dcd72b\"><code>c2f3e5c</code></a></td><td><code>Trac #32037: adjust doctest tolerance for lcalc-2.0.1 in lseries_ell.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5a63aa52a347e327cdfac5ac98200f547232d5a0\"><code>5a63aa5</code></a></td><td><code>Trac #32037: weaken doctest tolerance for lcalc-2.0.1 in modular/dirichlet.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68b89a7b2f16634799e0b10fdc8aa365125af00b\"><code>68b89a7</code></a></td><td><code>Trac #32037: tweak a doctest in elliptic_curves/ell_rational_field.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9bb551bd1a802ded62626b71fb6419b84615d182\"><code>9bb551b</code></a></td><td><code>Trac #32037: update to lcalc-2.0.2 to fix the build with std=c++11.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/513003c47f8e9967e5851ec59e940f6373123705\"><code>513003c</code></a></td><td><code>Trac #32037: add tolerance to a test in sage/lfunctions/zero_sums.pyx.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/413f11454dd839ae5ceca3f51874c6edca2ed66e\"><code>413f114</code></a></td><td><code>Trac #32037: upgrade to lcalc-2.0.3.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3ea32f7dc82996f446405ca03b3ce8d2656242c6\"><code>3ea32f7</code></a></td><td><code>Trac #32037: make getgetopt an order-only dependency of lcalc.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/93f9928194e352bb8ba1ed42b9ab3db4c2786bbe\"><code>93f9928</code></a></td><td><code>Trac #32037: remove remaining lcalc patches.</code></td></tr></table>\n",
    "created_at": "2021-11-07T13:28:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516027",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:74"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a42b787c808a010ab8ad495645a95add6475774"><code>9a42b78</code></a></td><td><code>Trac #32037: delete a failing doctest.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1537168d7b33e4e04127b5e5085108ae5441b06a"><code>1537168</code></a></td><td><code>Trac #32037: replace some ellipses with abs_tol.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c2f3e5c1a62b9338fc7218d0b27f10fd30dcd72b"><code>c2f3e5c</code></a></td><td><code>Trac #32037: adjust doctest tolerance for lcalc-2.0.1 in lseries_ell.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5a63aa52a347e327cdfac5ac98200f547232d5a0"><code>5a63aa5</code></a></td><td><code>Trac #32037: weaken doctest tolerance for lcalc-2.0.1 in modular/dirichlet.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68b89a7b2f16634799e0b10fdc8aa365125af00b"><code>68b89a7</code></a></td><td><code>Trac #32037: tweak a doctest in elliptic_curves/ell_rational_field.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9bb551bd1a802ded62626b71fb6419b84615d182"><code>9bb551b</code></a></td><td><code>Trac #32037: update to lcalc-2.0.2 to fix the build with std=c++11.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/513003c47f8e9967e5851ec59e940f6373123705"><code>513003c</code></a></td><td><code>Trac #32037: add tolerance to a test in sage/lfunctions/zero_sums.pyx.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/413f11454dd839ae5ceca3f51874c6edca2ed66e"><code>413f114</code></a></td><td><code>Trac #32037: upgrade to lcalc-2.0.3.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3ea32f7dc82996f446405ca03b3ce8d2656242c6"><code>3ea32f7</code></a></td><td><code>Trac #32037: make getgetopt an order-only dependency of lcalc.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/93f9928194e352bb8ba1ed42b9ab3db4c2786bbe"><code>93f9928</code></a></td><td><code>Trac #32037: remove remaining lcalc patches.</code></td></tr></table>




---

archive/issue_events_441897.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-11-07T13:30:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441897"
}
```



---

archive/issue_events_441898.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-11-07T13:30:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441898"
}
```



---

archive/issue_comments_516028.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nRebased cleanly onto develop, and added one additional commit to remove the new patch.",
    "created_at": "2021-11-07T13:30:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516028",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:75" align="right">comment:75</div>

Rebased cleanly onto develop, and added one additional commit to remove the new patch.



---

archive/issue_events_441899.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-11-14T09:13:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441899"
}
```



---

archive/issue_events_441900.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-11-14T09:13:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441900"
}
```



---

archive/issue_comments_516029.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nred branch => needs work",
    "created_at": "2021-11-14T09:13:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516029",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:76" align="right">comment:76</div>

red branch => needs work



---

archive/issue_comments_516030.json:
```json
{
    "body": "<div id=\"comment:77\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1a4d43df709ad403f12b8c15b1ea728082ed09bb\"><code>1a4d43d</code></a></td><td><code>Trac #32037: update the doctest for the DirichletGroup(5)[1] L-function.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1601d3bd1cf8490cc678c187cff60c53a7011264\"><code>1601d3b</code></a></td><td><code>Trac #32037: lower all lcalc tolerances to 1e-8.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7ab32bdc6e77c170db2c7cc39b2bfa294bfbdac9\"><code>7ab32bd</code></a></td><td><code>Trac #32037: add abs_tol to an lcalc test to fix a new failure.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2897402a544d8e57853aa1717e361158614ff211\"><code>2897402</code></a></td><td><code>Trac #32037: update an lcalc doctest that counts zeros.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c44adc5687f5d679b72589f5a3316c37dab0162a\"><code>c44adc5</code></a></td><td><code>Trac #32037: add tolerance to a few sage/lfunctions/lcalc.py doctests.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ef57b435898f8d5382f121686afaaebeb53a0924\"><code>ef57b43</code></a></td><td><code>Trac #32037: delete a failing doctest.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad5c3bf39db64ce3fb9469c3cb58866c51879406\"><code>ad5c3bf</code></a></td><td><code>Trac #32037: replace some ellipses with abs_tol.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fae1d2075ca918c1bbd9d3a8427eaf551f1b231d\"><code>fae1d20</code></a></td><td><code>Trac #32037: adjust doctest tolerance for lcalc-2.0.1 in lseries_ell.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/35870f25e54f11732f1423bd0588e074f4103173\"><code>35870f2</code></a></td><td><code>Trac #32037: weaken doctest tolerance for lcalc-2.0.1 in modular/dirichlet.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/69e646df02782b6d7da6d7065a08507c6ab1937e\"><code>69e646d</code></a></td><td><code>Trac #32037: tweak a doctest in elliptic_curves/ell_rational_field.py.</code></td></tr></table>\n",
    "created_at": "2021-11-14T20:00:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516030",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:77"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1a4d43df709ad403f12b8c15b1ea728082ed09bb"><code>1a4d43d</code></a></td><td><code>Trac #32037: update the doctest for the DirichletGroup(5)[1] L-function.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1601d3bd1cf8490cc678c187cff60c53a7011264"><code>1601d3b</code></a></td><td><code>Trac #32037: lower all lcalc tolerances to 1e-8.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7ab32bdc6e77c170db2c7cc39b2bfa294bfbdac9"><code>7ab32bd</code></a></td><td><code>Trac #32037: add abs_tol to an lcalc test to fix a new failure.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2897402a544d8e57853aa1717e361158614ff211"><code>2897402</code></a></td><td><code>Trac #32037: update an lcalc doctest that counts zeros.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c44adc5687f5d679b72589f5a3316c37dab0162a"><code>c44adc5</code></a></td><td><code>Trac #32037: add tolerance to a few sage/lfunctions/lcalc.py doctests.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ef57b435898f8d5382f121686afaaebeb53a0924"><code>ef57b43</code></a></td><td><code>Trac #32037: delete a failing doctest.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad5c3bf39db64ce3fb9469c3cb58866c51879406"><code>ad5c3bf</code></a></td><td><code>Trac #32037: replace some ellipses with abs_tol.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fae1d2075ca918c1bbd9d3a8427eaf551f1b231d"><code>fae1d20</code></a></td><td><code>Trac #32037: adjust doctest tolerance for lcalc-2.0.1 in lseries_ell.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/35870f25e54f11732f1423bd0588e074f4103173"><code>35870f2</code></a></td><td><code>Trac #32037: weaken doctest tolerance for lcalc-2.0.1 in modular/dirichlet.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/69e646df02782b6d7da6d7065a08507c6ab1937e"><code>69e646d</code></a></td><td><code>Trac #32037: tweak a doctest in elliptic_curves/ell_rational_field.py.</code></td></tr></table>




---

archive/issue_comments_516031.json:
```json
{
    "body": "Changed commit from **[`93f9928`](https://github.com/sagemath/sagetrac-mirror/commit/93f9928194e352bb8ba1ed42b9ab3db4c2786bbe)** to **[`69e646d`](https://github.com/sagemath/sagetrac-mirror/commit/69e646df02782b6d7da6d7065a08507c6ab1937e)**",
    "created_at": "2021-11-14T20:00:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516031",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`93f9928`](https://github.com/sagemath/sagetrac-mirror/commit/93f9928194e352bb8ba1ed42b9ab3db4c2786bbe)** to **[`69e646d`](https://github.com/sagemath/sagetrac-mirror/commit/69e646df02782b6d7da6d7065a08507c6ab1937e)**



---

archive/issue_events_441901.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-11-14T20:01:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441901"
}
```



---

archive/issue_events_441902.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-11-14T20:01:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441902"
}
```



---

archive/issue_comments_516032.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nNot sure why, it merged cleanly with beta6 for me. Here it is again rebased onto develop.",
    "created_at": "2021-11-14T20:01:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516032",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:78" align="right">comment:78</div>

Not sure why, it merged cleanly with beta6 for me. Here it is again rebased onto develop.



---

archive/issue_comments_516033.json:
```json
{
    "body": "Changed reviewer from **Antonio Rojas** to **Antonio Rojas, Dima Pasechnik**",
    "created_at": "2021-11-16T14:45:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516033",
    "user": "https://github.com/dimpase"
}
```

Changed reviewer from **Antonio Rojas** to **Antonio Rojas, Dima Pasechnik**



---

archive/issue_comments_516034.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">comment:79</div>\n\nlgtm",
    "created_at": "2021-11-16T14:45:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516034",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:79" align="right">comment:79</div>

lgtm



---

archive/issue_events_441903.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-16T14:45:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441903"
}
```



---

archive/issue_events_441904.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-16T14:45:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441904"
}
```



---

archive/issue_events_441905.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-20T10:46:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441905"
}
```



---

archive/issue_events_441906.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-20T10:46:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441906"
}
```



---

archive/issue_comments_516035.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\n\n```\nUsing cached file /home/release/Sage/upstream/lcalc-2.0.1.tar.xz\nlcalc-2.0.1\n====================================================\nSetting up build directory for lcalc-2.0.1\nFinished extraction\nApplying patches from ../patches...\nApplying ../patches/lcalc-1.23-gcc11.patch\ncan't find file to patch at input line 5\nPerhaps you used the wrong -p or --strip option?\nThe text leading up to this was:\n--------------------------\n|diff --git a/include/Lcommon.h b/include/Lcommon.h\n|index 1b3be43..717fcde 100644\n|--- a/include/Lcommon.h\n|+++ b/include/Lcommon.h\n--------------------------\nFile to patch: \nSkip this patch? [y] \nSkipping patch.\n2 out of 2 hunks ignored\nError applying '../patches/lcalc-1.23-gcc11.patch'\n************************************************************************\nError applying patches\n************************************************************************\n```",
    "created_at": "2021-11-20T10:46:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516035",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:80" align="right">comment:80</div>


```
Using cached file /home/release/Sage/upstream/lcalc-2.0.1.tar.xz
lcalc-2.0.1
====================================================
Setting up build directory for lcalc-2.0.1
Finished extraction
Applying patches from ../patches...
Applying ../patches/lcalc-1.23-gcc11.patch
can't find file to patch at input line 5
Perhaps you used the wrong -p or --strip option?
The text leading up to this was:
--------------------------
|diff --git a/include/Lcommon.h b/include/Lcommon.h
|index 1b3be43..717fcde 100644
|--- a/include/Lcommon.h
|+++ b/include/Lcommon.h
--------------------------
File to patch: 
Skip this patch? [y] 
Skipping patch.
2 out of 2 hunks ignored
Error applying '../patches/lcalc-1.23-gcc11.patch'
************************************************************************
Error applying patches
************************************************************************
```



---

archive/issue_comments_516036.json:
```json
{
    "body": "Changed commit from **[`69e646d`](https://github.com/sagemath/sagetrac-mirror/commit/69e646df02782b6d7da6d7065a08507c6ab1937e)** to **[`8286107`](https://github.com/sagemath/sagetrac-mirror/commit/82861077a6c485a84a72d93c371738e0cfb85d62)**",
    "created_at": "2021-11-20T12:38:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516036",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`69e646d`](https://github.com/sagemath/sagetrac-mirror/commit/69e646df02782b6d7da6d7065a08507c6ab1937e)** to **[`8286107`](https://github.com/sagemath/sagetrac-mirror/commit/82861077a6c485a84a72d93c371738e0cfb85d62)**



---

archive/issue_comments_516037.json:
```json
{
    "body": "<div id=\"comment:81\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eb84c7b2480a50e76a5869f1bd173974fa2cf74f\"><code>eb84c7b</code></a></td><td><code>Trac #32037: delete a failing doctest.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/648e1317adc6a62987ae60fdad7f84286c5577e4\"><code>648e131</code></a></td><td><code>Trac #32037: replace some ellipses with abs_tol.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f80d33502244ffb92d69367c6d0a1384c6601f01\"><code>f80d335</code></a></td><td><code>Trac #32037: adjust doctest tolerance for lcalc-2.0.1 in lseries_ell.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dc5766c85b1c03f8d3cf7fe34967f8755f49292b\"><code>dc5766c</code></a></td><td><code>Trac #32037: weaken doctest tolerance for lcalc-2.0.1 in modular/dirichlet.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/efabc7ef80a4f3f5277d1177f0bc9b4c0b01352f\"><code>efabc7e</code></a></td><td><code>Trac #32037: tweak a doctest in elliptic_curves/ell_rational_field.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7b0f6e2caed5465d9634ccab3de6a032a0bfa5ae\"><code>7b0f6e2</code></a></td><td><code>Trac #32037: update to lcalc-2.0.2 to fix the build with std=c++11.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a2e9d8e1f49af1889908fdc266f86a973b9b646\"><code>8a2e9d8</code></a></td><td><code>Trac #32037: add tolerance to a test in sage/lfunctions/zero_sums.pyx.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e00ab0c1ccc5a81099799876d1595df49ed91100\"><code>e00ab0c</code></a></td><td><code>Trac #32037: upgrade to lcalc-2.0.3.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a6011956ce6d822e816099bfabc338b47aea89b9\"><code>a601195</code></a></td><td><code>Trac #32037: make getgetopt an order-only dependency of lcalc.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/82861077a6c485a84a72d93c371738e0cfb85d62\"><code>8286107</code></a></td><td><code>Trac #32037: remove remaining lcalc patches.</code></td></tr></table>\n",
    "created_at": "2021-11-20T12:38:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516037",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:81"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eb84c7b2480a50e76a5869f1bd173974fa2cf74f"><code>eb84c7b</code></a></td><td><code>Trac #32037: delete a failing doctest.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/648e1317adc6a62987ae60fdad7f84286c5577e4"><code>648e131</code></a></td><td><code>Trac #32037: replace some ellipses with abs_tol.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f80d33502244ffb92d69367c6d0a1384c6601f01"><code>f80d335</code></a></td><td><code>Trac #32037: adjust doctest tolerance for lcalc-2.0.1 in lseries_ell.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dc5766c85b1c03f8d3cf7fe34967f8755f49292b"><code>dc5766c</code></a></td><td><code>Trac #32037: weaken doctest tolerance for lcalc-2.0.1 in modular/dirichlet.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/efabc7ef80a4f3f5277d1177f0bc9b4c0b01352f"><code>efabc7e</code></a></td><td><code>Trac #32037: tweak a doctest in elliptic_curves/ell_rational_field.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7b0f6e2caed5465d9634ccab3de6a032a0bfa5ae"><code>7b0f6e2</code></a></td><td><code>Trac #32037: update to lcalc-2.0.2 to fix the build with std=c++11.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a2e9d8e1f49af1889908fdc266f86a973b9b646"><code>8a2e9d8</code></a></td><td><code>Trac #32037: add tolerance to a test in sage/lfunctions/zero_sums.pyx.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e00ab0c1ccc5a81099799876d1595df49ed91100"><code>e00ab0c</code></a></td><td><code>Trac #32037: upgrade to lcalc-2.0.3.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a6011956ce6d822e816099bfabc338b47aea89b9"><code>a601195</code></a></td><td><code>Trac #32037: make getgetopt an order-only dependency of lcalc.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/82861077a6c485a84a72d93c371738e0cfb85d62"><code>8286107</code></a></td><td><code>Trac #32037: remove remaining lcalc patches.</code></td></tr></table>




---

archive/issue_events_441907.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-11-20T12:40:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441907"
}
```



---

archive/issue_events_441908.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-11-20T12:40:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441908"
}
```



---

archive/issue_comments_516038.json:
```json
{
    "body": "<div id=\"comment:83\" align=\"right\">comment:83</div>\n\nstil same error?",
    "created_at": "2021-11-23T21:34:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516038",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:83" align="right">comment:83</div>

stil same error?



---

archive/issue_events_441909.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-23T21:34:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441909"
}
```



---

archive/issue_events_441910.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-23T21:34:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441910"
}
```



---

archive/issue_comments_516039.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">comment:84</div>\n\nnevermind...",
    "created_at": "2021-11-23T21:35:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516039",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:84" align="right">comment:84</div>

nevermind...



---

archive/issue_events_441911.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-23T21:35:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441911"
}
```



---

archive/issue_events_441912.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-23T21:35:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441912"
}
```



---

archive/issue_comments_516040.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">comment:85</div>\n\nOn Debian 9 x86_64:\n\n```\n**********************************************************************\nFile \"src/sage/libs/lcalc/lcalc_Lfunction.pyx\", line 194, in sage.libs.lcalc.lcalc_Lfunction.Lfunction.hardy_z_function\nFailed example:\n    L.hardy_z_function(0) # abs tol 1e-8\nExpected:\n    0.793967590477 + 0.0*I\nGot:\n    0.793967590477090\n**********************************************************************\n1 item had failures:\n   1 of  14 in sage.libs.lcalc.lcalc_Lfunction.Lfunction.hardy_z_function\n    [105 tests, 1 failure, 0.76 s]\n----------------------------------------------------------------------\nsage -t --long --random-seed=234205826713938282410851315937822845647 src/sage/libs/lcalc/lcalc_Lfunction.pyx  # 1 doctest failed\n----------------------------------------------------------------------\n```\non OSX Big Sur:\n\n```\nIn file included from ../../src/libLfunction/L.h:43:\nIn file included from ../../src/libLfunction/Lglobals.h:55:\n../../src/libLfunction/Lcomplex.h:48:10: fatal error: 'bits/c++config.h' file not found\n#include <bits/c++config.h>\n         ^~~~~~~~~~~~~~~~~~\n1 error generated.\nmake[6]: *** [Lcommandline.o] Error 1\nmake[6]: Target `all' not remade because of errors.\nMaking all in tests\nMaking all in lib\nmake[7]: Nothing to be done for `all'.\nmake[7]: Nothing to be done for `all-am'.\nmake[6]: Nothing to be done for `all-am'.\nmake[5]: *** [all-recursive] Error 1\nmake[5]: Target `all' not remade because of errors.\n********************************************************************************\nError building lcalc-2.0.3\n********************************************************************************\n```",
    "created_at": "2021-11-25T00:22:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516040",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:85" align="right">comment:85</div>

On Debian 9 x86_64:

```
**********************************************************************
File "src/sage/libs/lcalc/lcalc_Lfunction.pyx", line 194, in sage.libs.lcalc.lcalc_Lfunction.Lfunction.hardy_z_function
Failed example:
    L.hardy_z_function(0) # abs tol 1e-8
Expected:
    0.793967590477 + 0.0*I
Got:
    0.793967590477090
**********************************************************************
1 item had failures:
   1 of  14 in sage.libs.lcalc.lcalc_Lfunction.Lfunction.hardy_z_function
    [105 tests, 1 failure, 0.76 s]
----------------------------------------------------------------------
sage -t --long --random-seed=234205826713938282410851315937822845647 src/sage/libs/lcalc/lcalc_Lfunction.pyx  # 1 doctest failed
----------------------------------------------------------------------
```
on OSX Big Sur:

```
In file included from ../../src/libLfunction/L.h:43:
In file included from ../../src/libLfunction/Lglobals.h:55:
../../src/libLfunction/Lcomplex.h:48:10: fatal error: 'bits/c++config.h' file not found
#include <bits/c++config.h>
         ^~~~~~~~~~~~~~~~~~
1 error generated.
make[6]: *** [Lcommandline.o] Error 1
make[6]: Target `all' not remade because of errors.
Making all in tests
Making all in lib
make[7]: Nothing to be done for `all'.
make[7]: Nothing to be done for `all-am'.
make[6]: Nothing to be done for `all-am'.
make[5]: *** [all-recursive] Error 1
make[5]: Target `all' not remade because of errors.
********************************************************************************
Error building lcalc-2.0.3
********************************************************************************
```



---

archive/issue_events_441913.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-25T00:22:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441913"
}
```



---

archive/issue_events_441914.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-11-25T00:22:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441914"
}
```



---

archive/issue_comments_516041.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">comment:86</div>\n\nReplying to [@vbraun](#comment:85):\n> On Debian 9 x86_64:\n> \n> ```\n> **********************************************************************\n> File \"src/sage/libs/lcalc/lcalc_Lfunction.pyx\", line 194, in sage.libs.lcalc.lcalc_Lfunction.Lfunction.hardy_z_function\n> Failed example:\n>     L.hardy_z_function(0) # abs tol 1e-8\n> Expected:\n>     0.793967590477 + 0.0*I\n> Got:\n>     0.793967590477090\n> **********************************************************************\n> ```\n\nWell... all of these `abs_tol` tests involving complex numbers are wrong. I was naively assuming that our doctest framework would do the obvious thing here, but it's using regexps to find strings that look like floating point numbers and then e.g. deciding that the lists `[\"0.793967590477\", \" + 0.0\"]` and  `[\"0.793967590477090\"]` cannot be equivalent because they are of different lengths.\n\nI'll redo all of the tests to compare the real and imaginary parts separately I guess.\n\n> on OSX Big Sur:\n> \n> ```\n> In file included from ../../src/libLfunction/L.h:43:\n> In file included from ../../src/libLfunction/Lglobals.h:55:\n> ../../src/libLfunction/Lcomplex.h:48:10: fatal error: 'bits/c++config.h' file not found\n> #include <bits/c++config.h>\n>          ^~~~~~~~~~~~~~~~~~\n> ```\n\nI don't know what to do about this. That's a standard C++ header, and I don't have access to OSX to debug. The full build log *might* help, if something is very obviously wrong.",
    "created_at": "2021-11-25T02:06:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516041",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:86" align="right">comment:86</div>

Replying to [@vbraun](#comment:85):
> On Debian 9 x86_64:
> 
> ```
> **********************************************************************
> File "src/sage/libs/lcalc/lcalc_Lfunction.pyx", line 194, in sage.libs.lcalc.lcalc_Lfunction.Lfunction.hardy_z_function
> Failed example:
>     L.hardy_z_function(0) # abs tol 1e-8
> Expected:
>     0.793967590477 + 0.0*I
> Got:
>     0.793967590477090
> **********************************************************************
> ```

Well... all of these `abs_tol` tests involving complex numbers are wrong. I was naively assuming that our doctest framework would do the obvious thing here, but it's using regexps to find strings that look like floating point numbers and then e.g. deciding that the lists `["0.793967590477", " + 0.0"]` and  `["0.793967590477090"]` cannot be equivalent because they are of different lengths.

I'll redo all of the tests to compare the real and imaginary parts separately I guess.

> on OSX Big Sur:
> 
> ```
> In file included from ../../src/libLfunction/L.h:43:
> In file included from ../../src/libLfunction/Lglobals.h:55:
> ../../src/libLfunction/Lcomplex.h:48:10: fatal error: 'bits/c++config.h' file not found
> #include <bits/c++config.h>
>          ^~~~~~~~~~~~~~~~~~
> ```

I don't know what to do about this. That's a standard C++ header, and I don't have access to OSX to debug. The full build log *might* help, if something is very obviously wrong.



---

archive/issue_comments_516042.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nSeen that kind of stuff before when porting to clang. I don't think anything in `bits` should be included directly because they are implementation specific functions. Would have to check what exactly was needed from there.\n\nFrom the file itself\n\n```\n/** @file bits/c++config.h\n  *  This is an internal header file, included by other library headers.\n  *  Do not attempt to use it directly. @headername{iosfwd}\n  */\n```",
    "created_at": "2021-11-25T03:14:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516042",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:87" align="right">comment:87</div>

Seen that kind of stuff before when porting to clang. I don't think anything in `bits` should be included directly because they are implementation specific functions. Would have to check what exactly was needed from there.

From the file itself

```
/** @file bits/c++config.h
  *  This is an internal header file, included by other library headers.
  *  Do not attempt to use it directly. @headername{iosfwd}
  */
```



---

archive/issue_comments_516043.json:
```json
{
    "body": "<div id=\"comment:88\" align=\"right\">comment:88</div>\n\nFor gcc, this particular header is included in `<cmath>` which is also included later. So, I'd recommend removing that include altogether.",
    "created_at": "2021-11-25T09:19:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516043",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:88" align="right">comment:88</div>

For gcc, this particular header is included in `<cmath>` which is also included later. So, I'd recommend removing that include altogether.



---

archive/issue_comments_516044.json:
```json
{
    "body": "<div id=\"comment:89\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/22efbb4807a20aa4ff10a8b6b2d17d9157778e86\"><code>22efbb4</code></a></td><td><code>Trac #32037: don't use \"abs tol\" for complex numbers.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/acf4d44c932de5ff89a52e831cf5d62e4a863596\"><code>acf4d44</code></a></td><td><code>Trac #32037: whitespace cleanup in sage.libs.lcalc.lcalc_Lfunction.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1a2dd14015b4900fab3bf8836f8929e43cd827cc\"><code>1a2dd14</code></a></td><td><code>Trac #32037: example cosmetology in sage.libs.lcalc.lcalc_Lfunction.</code></td></tr></table>\n",
    "created_at": "2021-11-25T16:29:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516044",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:89"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/22efbb4807a20aa4ff10a8b6b2d17d9157778e86"><code>22efbb4</code></a></td><td><code>Trac #32037: don't use "abs tol" for complex numbers.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/acf4d44c932de5ff89a52e831cf5d62e4a863596"><code>acf4d44</code></a></td><td><code>Trac #32037: whitespace cleanup in sage.libs.lcalc.lcalc_Lfunction.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1a2dd14015b4900fab3bf8836f8929e43cd827cc"><code>1a2dd14</code></a></td><td><code>Trac #32037: example cosmetology in sage.libs.lcalc.lcalc_Lfunction.</code></td></tr></table>




---

archive/issue_comments_516045.json:
```json
{
    "body": "Changed commit from **[`8286107`](https://github.com/sagemath/sagetrac-mirror/commit/82861077a6c485a84a72d93c371738e0cfb85d62)** to **[`1a2dd14`](https://github.com/sagemath/sagetrac-mirror/commit/1a2dd14015b4900fab3bf8836f8929e43cd827cc)**",
    "created_at": "2021-11-25T16:29:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516045",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8286107`](https://github.com/sagemath/sagetrac-mirror/commit/82861077a6c485a84a72d93c371738e0cfb85d62)** to **[`1a2dd14`](https://github.com/sagemath/sagetrac-mirror/commit/1a2dd14015b4900fab3bf8836f8929e43cd827cc)**



---

archive/issue_comments_516046.json:
```json
{
    "body": "<div id=\"comment:90\" align=\"right\">comment:90</div>\n\nReplying to [@kiwifb](#comment:88):\n> For gcc, this particular header is included in `<cmath>` which is also included later. So, I'd recommend removing that include altogether.\n\nThis works well with both clang and gcc on linux... but can anyone confirm that it works on OSX before I make a whole new release and upgrade again?",
    "created_at": "2021-11-25T16:51:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516046",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:90" align="right">comment:90</div>

Replying to [@kiwifb](#comment:88):
> For gcc, this particular header is included in `<cmath>` which is also included later. So, I'd recommend removing that include altogether.

This works well with both clang and gcc on linux... but can anyone confirm that it works on OSX before I make a whole new release and upgrade again?



---

archive/issue_comments_516047.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">comment:91</div>\n\nIf the repo was on GH, I'd send you a PR for portability/integration testing.\n\nLooks like GitLab is also starting to provide macOS testing? https://docs.gitlab.com/ee/ci/runners/saas/macos_saas_runner.html",
    "created_at": "2021-11-25T18:25:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516047",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:91" align="right">comment:91</div>

If the repo was on GH, I'd send you a PR for portability/integration testing.

Looks like GitLab is also starting to provide macOS testing? https://docs.gitlab.com/ee/ci/runners/saas/macos_saas_runner.html



---

archive/issue_comments_516048.json:
```json
{
    "body": "<div id=\"comment:92\" align=\"right\">comment:92</div>\n\nReplying to [@orlitzky](#comment:90):\n> Replying to [@kiwifb](#comment:88):\n> > For gcc, this particular header is included in `<cmath>` which is also included later. So, I'd recommend removing that include altogether.\n\n> \n> This works well with both clang and gcc on linux... but can anyone confirm that it works on OSX before I make a whole new release and upgrade again?\n\nCould have mentioned that. But clang on linux is not a good test unless you build clang's libstdc++ and make use of it. However, if you do it almost a sure deal. But I couldn't test on mac os because I am not properly set and was missing dependencies.",
    "created_at": "2021-11-25T18:47:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516048",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:92" align="right">comment:92</div>

Replying to [@orlitzky](#comment:90):
> Replying to [@kiwifb](#comment:88):
> > For gcc, this particular header is included in `<cmath>` which is also included later. So, I'd recommend removing that include altogether.

> 
> This works well with both clang and gcc on linux... but can anyone confirm that it works on OSX before I make a whole new release and upgrade again?

Could have mentioned that. But clang on linux is not a good test unless you build clang's libstdc++ and make use of it. However, if you do it almost a sure deal. But I couldn't test on mac os because I am not properly set and was missing dependencies.



---

archive/issue_comments_516049.json:
```json
{
    "body": "<div id=\"comment:93\" align=\"right\">comment:93</div>\n\nclang's C++ library is libc++, not libstdc++\n\nI'll try checking on macOS 12 now.",
    "created_at": "2021-11-25T19:46:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516049",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:93" align="right">comment:93</div>

clang's C++ library is libc++, not libstdc++

I'll try checking on macOS 12 now.



---

archive/issue_comments_516050.json:
```json
{
    "body": "<div id=\"comment:94\" align=\"right\">comment:94</div>\n\n\n```\nlibtool: compile:  clang++ -std=gnu++11 -DHAVE_CONFIG_H -I. -I../../src -g -O2 -c Lriemannsiegel.cc  -fno-common -DPIC -o .libs/Lriemannsiegel.o\nIn file included from Lmisc.cc:24:\nIn file included from ./Lmisc.h:27:\nIn file included from ./Lglobals.h:55:\n./Lcomplex.h:48:10: fatal error: 'bits/c++config.h' file not found\nIn file included from Lgamma.cc:24:\nIn file included from ./Lgamma.h:#include <bits/c++config.h>\n         ^~~~~~~~~~~~~~~~~~\n28:\nIn file included from ./Lglobals.h:55:\n./Lcomplex.h:48:10: fatal error: 'bits/c++config.h' file not found\n#include <bits/c++config.h>\n         ^~~~~~~~~~~~~~~~~~\nIn file included from Lglobals.cc:24:\nIn file included from ./Lglobals.h:55:\n./Lcomplex.h:48:10: fatal error: 'bits/c++config.h' file not found\n#include <bits/c++config.h>\n         ^~~~~~~~~~~~~~~~~~\n1 error generated.\nIn file included from Lnumbertheory.cc:24:\nIn file included from ./Lnumbertheory.h:32:\nIn file included from ./Lglobals.h:55:\n./Lcomplex.h:48:10: fatal error: 'bits/c++config.h' file not found\n#include <bits/c++config.h>\n         ^~~~~~~~~~~~~~~~~~\nmake[6]: *** [Lmisc.lo] Error 1\nmake[6]: *** Waiting for unfinished jobs....\n```\n\nremoving the offending #include, i.e.\n\n```diff\ndiff --git a/src/libLfunction/Lcomplex.h b/src/libLfunction/Lcomplex.h\nindex 639dbfa..be29aab 100644\n--- a/src/libLfunction/Lcomplex.h\n+++ b/src/libLfunction/Lcomplex.h\n@@ -45,7 +45,7 @@\n \n #pragma GCC system_header\n \n-#include <bits/c++config.h>\n+// #include <bits/c++config.h>\n \n //no longer include:\n //#include <bits/cpp_type_traits.h>  only thing used was is_floating... \n```\n\nmakes it build",
    "created_at": "2021-11-25T20:08:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516050",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:94" align="right">comment:94</div>


```
libtool: compile:  clang++ -std=gnu++11 -DHAVE_CONFIG_H -I. -I../../src -g -O2 -c Lriemannsiegel.cc  -fno-common -DPIC -o .libs/Lriemannsiegel.o
In file included from Lmisc.cc:24:
In file included from ./Lmisc.h:27:
In file included from ./Lglobals.h:55:
./Lcomplex.h:48:10: fatal error: 'bits/c++config.h' file not found
In file included from Lgamma.cc:24:
In file included from ./Lgamma.h:#include <bits/c++config.h>
         ^~~~~~~~~~~~~~~~~~
28:
In file included from ./Lglobals.h:55:
./Lcomplex.h:48:10: fatal error: 'bits/c++config.h' file not found
#include <bits/c++config.h>
         ^~~~~~~~~~~~~~~~~~
In file included from Lglobals.cc:24:
In file included from ./Lglobals.h:55:
./Lcomplex.h:48:10: fatal error: 'bits/c++config.h' file not found
#include <bits/c++config.h>
         ^~~~~~~~~~~~~~~~~~
1 error generated.
In file included from Lnumbertheory.cc:24:
In file included from ./Lnumbertheory.h:32:
In file included from ./Lglobals.h:55:
./Lcomplex.h:48:10: fatal error: 'bits/c++config.h' file not found
#include <bits/c++config.h>
         ^~~~~~~~~~~~~~~~~~
make[6]: *** [Lmisc.lo] Error 1
make[6]: *** Waiting for unfinished jobs....
```

removing the offending #include, i.e.

```diff
diff --git a/src/libLfunction/Lcomplex.h b/src/libLfunction/Lcomplex.h
index 639dbfa..be29aab 100644
--- a/src/libLfunction/Lcomplex.h
+++ b/src/libLfunction/Lcomplex.h
@@ -45,7 +45,7 @@
 
 #pragma GCC system_header
 
-#include <bits/c++config.h>
+// #include <bits/c++config.h>
 
 //no longer include:
 //#include <bits/cpp_type_traits.h>  only thing used was is_floating... 
```

makes it build



---

archive/issue_comments_516051.json:
```json
{
    "body": "<div id=\"comment:95\" align=\"right\">comment:95</div>\n\nThanks, release/upgrade incoming.",
    "created_at": "2021-11-25T20:35:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516051",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:95" align="right">comment:95</div>

Thanks, release/upgrade incoming.



---

archive/issue_comments_516052.json:
```json
{
    "body": "<div id=\"comment:96\" align=\"right\">comment:96</div>\n\nReplying to [@kiwifb](#comment:92):\n> \n> Could have mentioned that. But clang on linux is not a good test unless you build clang's libstdc++ and make use of it.\n\nArgh, TIL about `USE=default-libcxx` on sys-devel/clang.",
    "created_at": "2021-11-25T21:03:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516052",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:96" align="right">comment:96</div>

Replying to [@kiwifb](#comment:92):
> 
> Could have mentioned that. But clang on linux is not a good test unless you build clang's libstdc++ and make use of it.

Argh, TIL about `USE=default-libcxx` on sys-devel/clang.



---

archive/issue_comments_516053.json:
```json
{
    "body": "<div id=\"comment:97\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cbb790846f52d690c84f0a6207723973c9ff0042\"><code>cbb7908</code></a></td><td><code>Trac #32037: upgrade to lcalc-2.0.4.</code></td></tr></table>\n",
    "created_at": "2021-11-26T00:45:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516053",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:97"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cbb790846f52d690c84f0a6207723973c9ff0042"><code>cbb7908</code></a></td><td><code>Trac #32037: upgrade to lcalc-2.0.4.</code></td></tr></table>




---

archive/issue_comments_516054.json:
```json
{
    "body": "Changed commit from **[`1a2dd14`](https://github.com/sagemath/sagetrac-mirror/commit/1a2dd14015b4900fab3bf8836f8929e43cd827cc)** to **[`cbb7908`](https://github.com/sagemath/sagetrac-mirror/commit/cbb790846f52d690c84f0a6207723973c9ff0042)**",
    "created_at": "2021-11-26T00:45:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516054",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1a2dd14`](https://github.com/sagemath/sagetrac-mirror/commit/1a2dd14015b4900fab3bf8836f8929e43cd827cc)** to **[`cbb7908`](https://github.com/sagemath/sagetrac-mirror/commit/cbb790846f52d690c84f0a6207723973c9ff0042)**



---

archive/issue_comments_516055.json:
```json
{
    "body": "<div id=\"comment:98\" align=\"right\">comment:98</div>\n\nCertain (non-sage) builds were failing with newer clangs anyway so I guess this was timely.",
    "created_at": "2021-11-26T00:47:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516055",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:98" align="right">comment:98</div>

Certain (non-sage) builds were failing with newer clangs anyway so I guess this was timely.



---

archive/issue_events_441915.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-11-26T00:47:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441915"
}
```



---

archive/issue_events_441916.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-11-26T00:47:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441916"
}
```



---

archive/issue_events_441917.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-27T18:59:58Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "title_is": "Upgrade to lcalc-2.0.4",
    "title_was": "Upgrade to lcalc-2.0.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441917"
}
```



---

archive/issue_comments_516056.json:
```json
{
    "body": "<div id=\"comment:99\" align=\"right\">comment:99</div>\n\nmaybe you can drop all the `register` things, as\n\n```\n warning: 'register' storage class specifier is deprecated and incompatible with C++17 [-Wdeprecated-register]\n```\nis all over there on macOS.",
    "created_at": "2021-11-27T18:59:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516056",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:99" align="right">comment:99</div>

maybe you can drop all the `register` things, as

```
 warning: 'register' storage class specifier is deprecated and incompatible with C++17 [-Wdeprecated-register]
```
is all over there on macOS.



---

archive/issue_comments_516057.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nlgtm, otherwise",
    "created_at": "2021-11-27T21:00:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516057",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:0" align="right">comment:0</div>

lgtm, otherwise



---

archive/issue_comments_516058.json:
```json
{
    "body": "<div id=\"comment:101\" align=\"right\">comment:101</div>\n\nReplying to [@dimpase](#comment:99):\n> maybe you can drop all the `register` things, as\n> \n> ```\n>  warning: 'register' storage class specifier is deprecated and incompatible with C++17 [-Wdeprecated-register]\n> ```\n> is all over there on macOS.\n\nAre you sure this was with v2.0.4? I already fixed a warning like that, and there's no more *register* in the lcalc repo.",
    "created_at": "2021-11-28T23:31:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516058",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:101" align="right">comment:101</div>

Replying to [@dimpase](#comment:99):
> maybe you can drop all the `register` things, as
> 
> ```
>  warning: 'register' storage class specifier is deprecated and incompatible with C++17 [-Wdeprecated-register]
> ```
> is all over there on macOS.

Are you sure this was with v2.0.4? I already fixed a warning like that, and there's no more *register* in the lcalc repo.



---

archive/issue_comments_516059.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nAh, these came from the included pari headers /usr/local/include/pari/pari.h.\nAll good.",
    "created_at": "2021-11-29T00:10:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516059",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:2" align="right">comment:2</div>

Ah, these came from the included pari headers /usr/local/include/pari/pari.h.
All good.



---

archive/issue_events_441918.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-29T00:10:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441918"
}
```



---

archive/issue_events_441919.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-29T00:10:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441919"
}
```



---

archive/issue_comments_516060.json:
```json
{
    "body": "Changed branch from **[u/mjo/ticket/32037](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/32037)** to **[`cbb7908`](https://github.com/sagemath/sagetrac-mirror/commit/cbb790846f52d690c84f0a6207723973c9ff0042)**",
    "created_at": "2021-12-12T15:08:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516060",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mjo/ticket/32037](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/32037)** to **[`cbb7908`](https://github.com/sagemath/sagetrac-mirror/commit/cbb790846f52d690c84f0a6207723973c9ff0042)**



---

archive/issue_events_441920.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-12-12T15:08:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441920"
}
```



---

archive/issue_events_441921.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "493433c9e604e7914b1b5e71a7a2d070e4917178",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-12-12T15:08:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32037#event-441921"
}
```



---

archive/issue_comments_516061.json:
```json
{
    "body": "Changed commit from **[`cbb7908`](https://github.com/sagemath/sagetrac-mirror/commit/cbb790846f52d690c84f0a6207723973c9ff0042)** to none",
    "created_at": "2021-12-18T18:12:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516061",
    "user": "https://github.com/mkoeppe"
}
```

Changed commit from **[`cbb7908`](https://github.com/sagemath/sagetrac-mirror/commit/cbb790846f52d690c84f0a6207723973c9ff0042)** to none



---

archive/issue_comments_516062.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThis broke cygwin: #33043",
    "created_at": "2021-12-18T18:12:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32037",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32037#issuecomment-516062",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

This broke cygwin: #33043
