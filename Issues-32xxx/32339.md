# Issue 32339: Optimize no broken circuit sets

archive/issues_032102.json:
```json
{
    "assignees": [],
    "body": "Algorithms in the literature (https://arxiv.org/pdf/1110.0120.pdf) exist to speed up the computation of no broken circuit sets of a matroid. We implement them in this ticket.\n\nAssignee: **@trevorkarn**\n\nCC:  @tscrim @trevorkarn\n\nKeywords: **gsoc2021 optimization matroid no-broken-circuit-sets**\n\nBranch/Commit: **[fe6d6d6](https://github.com/sagemath/sagetrac-mirror/commit/fe6d6d6f92688ed0811827e88367aec03f91a256)**\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **Trevor K. Karn**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/32339_\n\n",
    "closed_at": "2021-09-15T22:06:04Z",
    "created_at": "2021-08-05T23:28:10Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20matroid%20theory",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Optimize no broken circuit sets",
    "type": "issue",
    "updated_at": "2021-09-15T22:06:04Z",
    "url": "https://github.com/sagemath/sage/issues/32339",
    "user": "https://github.com/trevorkarn"
}
```
Algorithms in the literature (https://arxiv.org/pdf/1110.0120.pdf) exist to speed up the computation of no broken circuit sets of a matroid. We implement them in this ticket.

Assignee: **@trevorkarn**

CC:  @tscrim @trevorkarn

Keywords: **gsoc2021 optimization matroid no-broken-circuit-sets**

Branch/Commit: **[fe6d6d6](https://github.com/sagemath/sagetrac-mirror/commit/fe6d6d6f92688ed0811827e88367aec03f91a256)**

Reviewer: **Travis Scrimshaw**

Author: **Trevor K. Karn**

_Issue created by migration from https://trac.sagemath.org/ticket/32339_





---

archive/issue_events_427805.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2021-08-05T23:28:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32339#event-427805"
}
```



---

archive/issue_events_427806.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2021-08-05T23:28:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20matroid%20theory",
    "label_color": "0000ff",
    "label_name": "component: matroid theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32339#event-427806"
}
```



---

archive/issue_events_427807.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2021-08-05T23:28:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32339#event-427807"
}
```



---

archive/issue_events_427808.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2021-08-05T23:28:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32339#event-427808"
}
```



---

archive/issue_comments_524060.json:
```json
{
    "body": "Timing comparison of n.b.c. set computation for the braid matroid",
    "created_at": "2021-08-05T23:29:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524060",
    "user": "https://github.com/trevorkarn"
}
```

Timing comparison of n.b.c. set computation for the braid matroid



---

archive/issue_comments_524061.json:
```json
{
    "body": "Assignee: **@trevorkarn**",
    "created_at": "2021-08-05T23:31:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524061",
    "user": "https://github.com/trevorkarn"
}
```

Assignee: **@trevorkarn**



---

archive/issue_comments_524062.json:
```json
{
    "body": "Branch: **[u/tkarn/optimize-nbc-set-computation-32339](https://github.com/sagemath/sagetrac-mirror/tree/u/tkarn/optimize-nbc-set-computation-32339)**",
    "created_at": "2021-08-05T23:31:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524062",
    "user": "https://github.com/trevorkarn"
}
```

Branch: **[u/tkarn/optimize-nbc-set-computation-32339](https://github.com/sagemath/sagetrac-mirror/tree/u/tkarn/optimize-nbc-set-computation-32339)**



---

archive/issue_comments_524063.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nAttachment: **[optimize-nbc-creating.pdf.gz](https://github.com/sagemath/sage/files/ticket32339/optimize-nbc-creating.pdf.gz)**\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5b751919903c8c1c3fd73cfd43b1c113de1f561f\">5b75191</a></td><td><code>Implement faster n.b.c. set computation</code></td></tr></table>\n",
    "created_at": "2021-08-05T23:31:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524063",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:1'>Comment 1:</a>
Attachment: **[optimize-nbc-creating.pdf.gz](https://github.com/sagemath/sage/files/ticket32339/optimize-nbc-creating.pdf.gz)**

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5b751919903c8c1c3fd73cfd43b1c113de1f561f">5b75191</a></td><td><code>Implement faster n.b.c. set computation</code></td></tr></table>




---

archive/issue_comments_524064.json:
```json
{
    "body": "Commit: **[5b75191](https://github.com/sagemath/sagetrac-mirror/commit/5b751919903c8c1c3fd73cfd43b1c113de1f561f)**",
    "created_at": "2021-08-05T23:31:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524064",
    "user": "https://github.com/trevorkarn"
}
```

Commit: **[5b75191](https://github.com/sagemath/sagetrac-mirror/commit/5b751919903c8c1c3fd73cfd43b1c113de1f561f)**



---

archive/issue_events_427809.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2021-08-05T23:35:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32339#event-427809"
}
```



---

archive/issue_comments_524065.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nI think it would be easier to follow (and also faster) to modify the algorithm to work with Sage's convention. Also, here are some tweaks:\n\n```diff\n-        order_dict = {Tmax-i-1:e for i,e in enumerate(ordering)}\n-        reverse_dict = {value:key for key,value in order_dict.items()}\n+        order_dict = {Tmax-i-1: e for i, e in enumerate(ordering)}\n+        reverse_dict = {value: key for key, value in order_dict.items()}\n \n         B = list()\n         Q = deque(([],))\n         i = 0\n         while Q:\n             H = Q.popleft()\n-            tp = reverse_dict[H[-1]] if len(H)>0 else -1\n-            Ht = [H+[order_dict[i]] for i in range(tp+1,Tmax)]\n-            if all(map(self.is_independent, Ht)):\n+            tp = reverse_dict[H[-1]] if len(H) > 0 else -1\n+            Ht = [H + [order_dict[i]] for i in range(tp+1, Tmax)]\n+            if all(self.is_independent(x) for x in Ht):\n                 B.append(frozenset(H))\n                 Q.extend(Ht)\n         return B\n```\nThe only non-trivial/PEP8 tweak is removing the `map` as I find generator expressions easier to read (although perhaps it is slower and so we shouldn't do it).\n\nCan you also just post the complete tests and timings as a comment in the ticket. Just the result of `%time`/`%timeit` should be sufficient. It makes it easier to see at which stage the timings were conducted and less to navigate.",
    "created_at": "2021-08-06T02:47:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524065",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'>Comment 3:</a>
I think it would be easier to follow (and also faster) to modify the algorithm to work with Sage's convention. Also, here are some tweaks:

```diff
-        order_dict = {Tmax-i-1:e for i,e in enumerate(ordering)}
-        reverse_dict = {value:key for key,value in order_dict.items()}
+        order_dict = {Tmax-i-1: e for i, e in enumerate(ordering)}
+        reverse_dict = {value: key for key, value in order_dict.items()}
 
         B = list()
         Q = deque(([],))
         i = 0
         while Q:
             H = Q.popleft()
-            tp = reverse_dict[H[-1]] if len(H)>0 else -1
-            Ht = [H+[order_dict[i]] for i in range(tp+1,Tmax)]
-            if all(map(self.is_independent, Ht)):
+            tp = reverse_dict[H[-1]] if len(H) > 0 else -1
+            Ht = [H + [order_dict[i]] for i in range(tp+1, Tmax)]
+            if all(self.is_independent(x) for x in Ht):
                 B.append(frozenset(H))
                 Q.extend(Ht)
         return B
```
The only non-trivial/PEP8 tweak is removing the `map` as I find generator expressions easier to read (although perhaps it is slower and so we shouldn't do it).

Can you also just post the complete tests and timings as a comment in the ticket. Just the result of `%time`/`%timeit` should be sufficient. It makes it easier to see at which stage the timings were conducted and less to navigate.



---

archive/issue_comments_524066.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nTests with the original:\n\n```\nsage: M = matroids.CompleteGraphic(5)                                                                                             \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                                                  \n25 loops, best of 3: 15.1 ms per loop\nsage: M = matroids.Uniform(4,4)                                                                                                   \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                                                  \n625 loops, best of 3: 14.4 \u03bcs per loop\nsage: M = matroids.Wheel(5)                                                                                                       \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                                                  \n625 loops, best of 3: 1.1 ms per loop\nsage: M = matroids.Uniform(5,5)                                                                                                   \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                                                  \n625 loops, best of 3: 20.2 \u03bcs per loop\nsage: M = matroids.Uniform(5,7)                                                                                                   \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                                                  \n625 loops, best of 3: 303 \u03bcs per loop\nsage: M = matroids.CompleteGraphic(6)                                                                                             \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                                                  \n5 loops, best of 3: 306 ms per loop\nsage: M = matroids.PG(2,3)                                                                                                                                                                \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                                                                                                          \n125 loops, best of 3: 6.39 ms per loop\nsage: M = matroids.PG(2,5)                                                                                                                                                                \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                                                                                                          \n5 loops, best of 3: 1.98 s per loop\n```\n\nTests using commit 5b75191:\n\n```\nsage: M = matroids.CompleteGraphic(5)                                                               \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                    \n125 loops, best of 3: 2.72 ms per loop\nsage: M = matroids.Uniform(4,4)                                                                     \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                    \n625 loops, best of 3: 56.4 \u03bcs per loop\nsage: M = matroids.Wheel(5)                                                                         \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                    \n625 loops, best of 3: 1.16 ms per loop\nsage: timeit.eval('M.no_broken_circuits_sets()')                                                    \n625 loops, best of 3: 102 \u03bcs per loop\nsage: timeit.eval('M.no_broken_circuits_sets()')                                                    \n625 loops, best of 3: 286 \u03bcs per loop\nsage: M = matroids.CompleteGraphic(6)                                                               \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                    \n5 loops, best of 3: 37.9 ms per loop\nsage: M = matroids.PG(2,3)                                                                          \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                    \n625 loops, best of 3: 618 \u03bcs per loop\nsage: M = matroids.PG(2,5)                                                                          \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                    \n5 loops, best of 3: 42.6 ms per loop\n```\n\nSo it does seem to vary a bit. In particular, it is not faster for small matroids with a relatively simple structure and I think the speed up for other classes of matroids makes this change worth it.",
    "created_at": "2021-08-06T20:28:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524066",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:4'>Comment 4:</a>
Tests with the original:

```
sage: M = matroids.CompleteGraphic(5)                                                                                             
sage: timeit.eval('M.no_broken_circuits_sets()')                                                                                  
25 loops, best of 3: 15.1 ms per loop
sage: M = matroids.Uniform(4,4)                                                                                                   
sage: timeit.eval('M.no_broken_circuits_sets()')                                                                                  
625 loops, best of 3: 14.4 μs per loop
sage: M = matroids.Wheel(5)                                                                                                       
sage: timeit.eval('M.no_broken_circuits_sets()')                                                                                  
625 loops, best of 3: 1.1 ms per loop
sage: M = matroids.Uniform(5,5)                                                                                                   
sage: timeit.eval('M.no_broken_circuits_sets()')                                                                                  
625 loops, best of 3: 20.2 μs per loop
sage: M = matroids.Uniform(5,7)                                                                                                   
sage: timeit.eval('M.no_broken_circuits_sets()')                                                                                  
625 loops, best of 3: 303 μs per loop
sage: M = matroids.CompleteGraphic(6)                                                                                             
sage: timeit.eval('M.no_broken_circuits_sets()')                                                                                  
5 loops, best of 3: 306 ms per loop
sage: M = matroids.PG(2,3)                                                                                                                                                                
sage: timeit.eval('M.no_broken_circuits_sets()')                                                                                                                                          
125 loops, best of 3: 6.39 ms per loop
sage: M = matroids.PG(2,5)                                                                                                                                                                
sage: timeit.eval('M.no_broken_circuits_sets()')                                                                                                                                          
5 loops, best of 3: 1.98 s per loop
```

Tests using commit 5b75191:

```
sage: M = matroids.CompleteGraphic(5)                                                               
sage: timeit.eval('M.no_broken_circuits_sets()')                                                    
125 loops, best of 3: 2.72 ms per loop
sage: M = matroids.Uniform(4,4)                                                                     
sage: timeit.eval('M.no_broken_circuits_sets()')                                                    
625 loops, best of 3: 56.4 μs per loop
sage: M = matroids.Wheel(5)                                                                         
sage: timeit.eval('M.no_broken_circuits_sets()')                                                    
625 loops, best of 3: 1.16 ms per loop
sage: timeit.eval('M.no_broken_circuits_sets()')                                                    
625 loops, best of 3: 102 μs per loop
sage: timeit.eval('M.no_broken_circuits_sets()')                                                    
625 loops, best of 3: 286 μs per loop
sage: M = matroids.CompleteGraphic(6)                                                               
sage: timeit.eval('M.no_broken_circuits_sets()')                                                    
5 loops, best of 3: 37.9 ms per loop
sage: M = matroids.PG(2,3)                                                                          
sage: timeit.eval('M.no_broken_circuits_sets()')                                                    
625 loops, best of 3: 618 μs per loop
sage: M = matroids.PG(2,5)                                                                          
sage: timeit.eval('M.no_broken_circuits_sets()')                                                    
5 loops, best of 3: 42.6 ms per loop
```

So it does seem to vary a bit. In particular, it is not faster for small matroids with a relatively simple structure and I think the speed up for other classes of matroids makes this change worth it.



---

archive/issue_comments_524067.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nReplacing the `map` with a comprehension seems to break the code unless it is in a list. I don't see why this should be the case (maybe a Cython problem?), but it is. Testing including the list yields:\n\n```\nsage: M = matroids.CompleteGraphic(5)                                                               \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                    \n125 loops, best of 3: 3.72 ms per loop\nsage: M = matroids.Uniform(4,4)                                                                     \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                    \n625 loops, best of 3: 24.5 \u03bcs per loop\nsage: M = matroids.Wheel(5)                                                                                                                                                                     \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                    \n625 loops, best of 3: 1.36 ms per loop\nsage: M = matroids.Uniform(5,5)                                                                     \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                    \n625 loops, best of 3: 50.2 \u03bcs per loop\nsage: M = matroids.Uniform(5,7)                                                                     \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                    \n625 loops, best of 3: 251 \u03bcs per loop\nsage: M = matroids.CompleteGraphic(6)                                                               \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                    \n25 loops, best of 3: 32 ms per loop\nsage: M = matroids.PG(2,3)                                                                          \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                    \n625 loops, best of 3: 798 \u03bcs per loop\nsage: M = matroids.PG(2,5)                                                                          \nsage: timeit.eval('M.no_broken_circuits_sets()')                                                    \n5 loops, best of 3: 67.9 ms per loop                                 \n```\n\nThis appears noticably slower than with `map` (although still faster than the original), so if its ok, I'd like to keep it as a `map`.",
    "created_at": "2021-08-06T20:47:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524067",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:5'>Comment 5:</a>
Replacing the `map` with a comprehension seems to break the code unless it is in a list. I don't see why this should be the case (maybe a Cython problem?), but it is. Testing including the list yields:

```
sage: M = matroids.CompleteGraphic(5)                                                               
sage: timeit.eval('M.no_broken_circuits_sets()')                                                    
125 loops, best of 3: 3.72 ms per loop
sage: M = matroids.Uniform(4,4)                                                                     
sage: timeit.eval('M.no_broken_circuits_sets()')                                                    
625 loops, best of 3: 24.5 μs per loop
sage: M = matroids.Wheel(5)                                                                                                                                                                     
sage: timeit.eval('M.no_broken_circuits_sets()')                                                    
625 loops, best of 3: 1.36 ms per loop
sage: M = matroids.Uniform(5,5)                                                                     
sage: timeit.eval('M.no_broken_circuits_sets()')                                                    
625 loops, best of 3: 50.2 μs per loop
sage: M = matroids.Uniform(5,7)                                                                     
sage: timeit.eval('M.no_broken_circuits_sets()')                                                    
625 loops, best of 3: 251 μs per loop
sage: M = matroids.CompleteGraphic(6)                                                               
sage: timeit.eval('M.no_broken_circuits_sets()')                                                    
25 loops, best of 3: 32 ms per loop
sage: M = matroids.PG(2,3)                                                                          
sage: timeit.eval('M.no_broken_circuits_sets()')                                                    
625 loops, best of 3: 798 μs per loop
sage: M = matroids.PG(2,5)                                                                          
sage: timeit.eval('M.no_broken_circuits_sets()')                                                    
5 loops, best of 3: 67.9 ms per loop                                 
```

This appears noticably slower than with `map` (although still faster than the original), so if its ok, I'd like to keep it as a `map`.



---

archive/issue_comments_524068.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nAh, that's right, its a cpdef method so we can't have generator objects.\n\nI made some Cython specific stuff for speed. I also tweaked the algorithm slightly to avoid some of the checks you were doing. Granted, my improvement pales in comparison to your original one, but I still am squeezing a bit more out. Here are the timings in the same order as what you have above:\n\n```\n1.59 ms \u00b1 14.6 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1000 loops each)\n12.5 \u00b5s \u00b1 138 ns per loop (mean \u00b1 std. dev. of 7 runs, 100000 loops each)\n608 \u00b5s \u00b1 5.2 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1000 loops each)\n27.7 \u00b5s \u00b1 322 ns per loop (mean \u00b1 std. dev. of 7 runs, 10000 loops each)\n150 \u00b5s \u00b1 5.19 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 10000 loops each)\n12.6 ms \u00b1 35.9 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\n320 \u00b5s \u00b1 3.61 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1000 loops each)\n15.7 ms \u00b1 156 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\n```\nvs your branch:\n\n```\nsage: %timeit M.no_broken_circuits_sets()\n1.78 ms \u00b1 14.6 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1000 loops each)\n23.1 \u00b5s \u00b1 256 ns per loop (mean \u00b1 std. dev. of 7 runs, 10000 loops each)\n789 \u00b5s \u00b1 12.4 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1000 loops each)\n46.6 \u00b5s \u00b1 1.01 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 10000 loops each)\n209 \u00b5s \u00b1 2.21 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1000 loops each)\n13.8 ms \u00b1 125 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\n406 \u00b5s \u00b1 2.42 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1000 loops each)\n16.2 ms \u00b1 42 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\n```\n\nIf my changes are good, then positive review.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/16061d2beb5dff3b4b3ef6ddb81c435189fdab60\">16061d2</a></td><td><code>Further Cython and algorithm speedups.</code></td></tr></table>\n",
    "created_at": "2021-08-06T22:13:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524068",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'>Comment 6:</a>
Ah, that's right, its a cpdef method so we can't have generator objects.

I made some Cython specific stuff for speed. I also tweaked the algorithm slightly to avoid some of the checks you were doing. Granted, my improvement pales in comparison to your original one, but I still am squeezing a bit more out. Here are the timings in the same order as what you have above:

```
1.59 ms ± 14.6 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
12.5 µs ± 138 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
608 µs ± 5.2 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
27.7 µs ± 322 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
150 µs ± 5.19 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
12.6 ms ± 35.9 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
320 µs ± 3.61 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
15.7 ms ± 156 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
```
vs your branch:

```
sage: %timeit M.no_broken_circuits_sets()
1.78 ms ± 14.6 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
23.1 µs ± 256 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
789 µs ± 12.4 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
46.6 µs ± 1.01 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
209 µs ± 2.21 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
13.8 ms ± 125 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
406 µs ± 2.42 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
16.2 ms ± 42 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
```

If my changes are good, then positive review.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/16061d2beb5dff3b4b3ef6ddb81c435189fdab60">16061d2</a></td><td><code>Further Cython and algorithm speedups.</code></td></tr></table>




---

archive/issue_comments_524069.json:
```json
{
    "body": "Changed branch from **[u/tkarn/optimize-nbc-set-computation-32339](https://github.com/sagemath/sagetrac-mirror/tree/u/tkarn/optimize-nbc-set-computation-32339)** to **[public/matroids/optimize_nbc_set-32339](https://github.com/sagemath/sagetrac-mirror/tree/public/matroids/optimize_nbc_set-32339)**",
    "created_at": "2021-08-06T22:13:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524069",
    "user": "https://github.com/tscrim"
}
```

Changed branch from **[u/tkarn/optimize-nbc-set-computation-32339](https://github.com/sagemath/sagetrac-mirror/tree/u/tkarn/optimize-nbc-set-computation-32339)** to **[public/matroids/optimize_nbc_set-32339](https://github.com/sagemath/sagetrac-mirror/tree/public/matroids/optimize_nbc_set-32339)**



---

archive/issue_comments_524070.json:
```json
{
    "body": "Changed commit from **[5b75191](https://github.com/sagemath/sagetrac-mirror/commit/5b751919903c8c1c3fd73cfd43b1c113de1f561f)** to **[16061d2](https://github.com/sagemath/sagetrac-mirror/commit/16061d2beb5dff3b4b3ef6ddb81c435189fdab60)**",
    "created_at": "2021-08-06T22:13:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524070",
    "user": "https://github.com/tscrim"
}
```

Changed commit from **[5b75191](https://github.com/sagemath/sagetrac-mirror/commit/5b751919903c8c1c3fd73cfd43b1c113de1f561f)** to **[16061d2](https://github.com/sagemath/sagetrac-mirror/commit/16061d2beb5dff3b4b3ef6ddb81c435189fdab60)**



---

archive/issue_comments_524071.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2021-08-06T22:13:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524071",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_524072.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nHere is a version that skips some checks and short-circuits the independence check. This gets me another 25%-50% speed reduction:\n\n```\n1.41 ms \u00b1 13.8 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1000 loops each)\n10.1 \u00b5s \u00b1 119 ns per loop (mean \u00b1 std. dev. of 7 runs, 100000 loops each)\n429 \u00b5s \u00b1 3.21 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1000 loops each)\n19.2 \u00b5s \u00b1 112 ns per loop (mean \u00b1 std. dev. of 7 runs, 100000 loops each)\n100 \u00b5s \u00b1 1.07 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 10000 loops each)\n11.2 ms \u00b1 60.1 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\n209 \u00b5s \u00b1 1.77 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1000 loops each)\n13.9 ms \u00b1 204 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\n```",
    "created_at": "2021-08-06T22:47:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524072",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'>Comment 7:</a>
Here is a version that skips some checks and short-circuits the independence check. This gets me another 25%-50% speed reduction:

```
1.41 ms ± 13.8 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
10.1 µs ± 119 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
429 µs ± 3.21 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
19.2 µs ± 112 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
100 µs ± 1.07 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
11.2 ms ± 60.1 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
209 µs ± 1.77 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
13.9 ms ± 204 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
```



---

archive/issue_comments_524073.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a0a201484b48ef0115d3654257a68e5471af1656\">a0a2014</a></td><td><code>Avoiding some useless checks in NBC sets.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/de750fe9634238c2a052150603ce83581daf13e2\">de750fe</a></td><td><code>Use short-circuiting for the independence check.</code></td></tr></table>\n",
    "created_at": "2021-08-06T22:47:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524073",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:8'>Comment 8:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a0a201484b48ef0115d3654257a68e5471af1656">a0a2014</a></td><td><code>Avoiding some useless checks in NBC sets.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/de750fe9634238c2a052150603ce83581daf13e2">de750fe</a></td><td><code>Use short-circuiting for the independence check.</code></td></tr></table>




---

archive/issue_comments_524074.json:
```json
{
    "body": "Changed commit from **[16061d2](https://github.com/sagemath/sagetrac-mirror/commit/16061d2beb5dff3b4b3ef6ddb81c435189fdab60)** to **[de750fe](https://github.com/sagemath/sagetrac-mirror/commit/de750fe9634238c2a052150603ce83581daf13e2)**",
    "created_at": "2021-08-06T22:47:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524074",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[16061d2](https://github.com/sagemath/sagetrac-mirror/commit/16061d2beb5dff3b4b3ef6ddb81c435189fdab60)** to **[de750fe](https://github.com/sagemath/sagetrac-mirror/commit/de750fe9634238c2a052150603ce83581daf13e2)**



---

archive/issue_comments_524075.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nNow I feel I have gotten everything out that is possible without significant modifications. Ready for review.",
    "created_at": "2021-08-06T22:49:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524075",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'>Comment 9:</a>
Now I feel I have gotten everything out that is possible without significant modifications. Ready for review.



---

archive/issue_comments_524076.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nI'm slightly worried about disabling bounds checking because of possible crashing and security issues. \n\nOn my machine commit de750fe has the following timings:\n\n```\n625 loops, best of 3: 1.36 ms per loop\n625 loops, best of 3: 10.4 \u03bcs per loop\n625 loops, best of 3: 401 \u03bcs per loop\n625 loops, best of 3: 17.8 \u03bcs per loop\n625 loops, best of 3: 87.4 \u03bcs per loop\n25 loops, best of 3: 9.82 ms per loop\n625 loops, best of 3: 183 \u03bcs per loop\n25 loops, best of 3: 12.8 ms per loop\n```\n\nand with bounds checking enabled:\n\n```\n625 loops, best of 3: 1.38 ms per loop\n625 loops, best of 3: 9.85 \u03bcs per loop\n625 loops, best of 3: 404 \u03bcs per loop\n625 loops, best of 3: 17.1 \u03bcs per loop\n625 loops, best of 3: 83.1 \u03bcs per loop\n25 loops, best of 3: 9.87 ms per loop\n625 loops, best of 3: 179 \u03bcs per loop\n25 loops, best of 3: 13.1 ms per loop\n```\n\nI don't see an appreciable difference between bounds-checking enabled and disabled. So if my changes are good, positive review.",
    "created_at": "2021-08-09T13:45:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524076",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:10'>Comment 10:</a>
I'm slightly worried about disabling bounds checking because of possible crashing and security issues. 

On my machine commit de750fe has the following timings:

```
625 loops, best of 3: 1.36 ms per loop
625 loops, best of 3: 10.4 μs per loop
625 loops, best of 3: 401 μs per loop
625 loops, best of 3: 17.8 μs per loop
625 loops, best of 3: 87.4 μs per loop
25 loops, best of 3: 9.82 ms per loop
625 loops, best of 3: 183 μs per loop
25 loops, best of 3: 12.8 ms per loop
```

and with bounds checking enabled:

```
625 loops, best of 3: 1.38 ms per loop
625 loops, best of 3: 9.85 μs per loop
625 loops, best of 3: 404 μs per loop
625 loops, best of 3: 17.1 μs per loop
625 loops, best of 3: 83.1 μs per loop
25 loops, best of 3: 9.87 ms per loop
625 loops, best of 3: 179 μs per loop
25 loops, best of 3: 13.1 ms per loop
```

I don't see an appreciable difference between bounds-checking enabled and disabled. So if my changes are good, positive review.



---

archive/issue_comments_524077.json:
```json
{
    "body": "Changed commit from **[de750fe](https://github.com/sagemath/sagetrac-mirror/commit/de750fe9634238c2a052150603ce83581daf13e2)** to **[446512e](https://github.com/sagemath/sagetrac-mirror/commit/446512e2e3efe74e0218867c2b60092a052ac7a2)**",
    "created_at": "2021-08-09T13:46:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524077",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[de750fe](https://github.com/sagemath/sagetrac-mirror/commit/de750fe9634238c2a052150603ce83581daf13e2)** to **[446512e](https://github.com/sagemath/sagetrac-mirror/commit/446512e2e3efe74e0218867c2b60092a052ac7a2)**



---

archive/issue_comments_524078.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/446512e2e3efe74e0218867c2b60092a052ac7a2\">446512e</a></td><td><code>Re-enable bounds checking</code></td></tr></table>\n",
    "created_at": "2021-08-09T13:46:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524078",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:11'>Comment 11:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/446512e2e3efe74e0218867c2b60092a052ac7a2">446512e</a></td><td><code>Re-enable bounds checking</code></td></tr></table>




---

archive/issue_events_427810.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-08-10T23:46:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32339#event-427810"
}
```



---

archive/issue_events_427811.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-08-10T23:46:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32339#event-427811"
}
```



---

archive/issue_comments_524079.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nReplying to [@trevorkarn](#comment%3A10):\n> I'm slightly worried about disabling bounds checking because of possible crashing and security issues. \n\nYou should not be worried about crashing. We have doctests for the places in the code where it would fail. I don't understand why there would be any security issue (unless you mean something different than system security here).\n\n> I don't see an appreciable difference between bounds-checking enabled and disabled. So if my changes are good, positive review.\n\nThere are a lot of variations in your timings, and enabling the bounds-checking should not result in a speedup. I am bit suspicious of the reliability, but this is a minor point and we don't need this level of micro-optimization.\n\nThank you for improving this.",
    "created_at": "2021-08-10T23:46:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524079",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'>Comment 12:</a>
Replying to [@trevorkarn](#comment%3A10):
> I'm slightly worried about disabling bounds checking because of possible crashing and security issues. 

You should not be worried about crashing. We have doctests for the places in the code where it would fail. I don't understand why there would be any security issue (unless you mean something different than system security here).

> I don't see an appreciable difference between bounds-checking enabled and disabled. So if my changes are good, positive review.

There are a lot of variations in your timings, and enabling the bounds-checking should not result in a speedup. I am bit suspicious of the reliability, but this is a minor point and we don't need this level of micro-optimization.

Thank you for improving this.



---

archive/issue_comments_524080.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nReplying to [@tscrim](#comment%3A12):\n> Replying to [@trevorkarn](#comment%3A10):\n> > I'm slightly worried about disabling bounds checking because of possible crashing and security issues. \n\n> \n> You should not be worried about crashing. We have doctests for the places in the code where it would fail. I don't understand why there would be any security issue (unless you mean something different than system security here).\n> \n\nI was just worried about providing a vector for a buffer overflow attack.\n> > I don't see an appreciable difference between bounds-checking enabled and disabled. So if my changes are good, positive review.\n\n> \n> There are a lot of variations in your timings, and enabling the bounds-checking should not result in a speedup. \n\nSorry, I meant that enabling bounds-checking did not appear to slow it down. If there was a big slow down I would have looked more into the security side of things to see if it was ok to disable the bounds checking, but since there was not any apparent slow down, it seemed ok to me to just disable it.\n\n\nThanks for the review!",
    "created_at": "2021-08-11T02:18:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524080",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:13'>Comment 13:</a>
Replying to [@tscrim](#comment%3A12):
> Replying to [@trevorkarn](#comment%3A10):
> > I'm slightly worried about disabling bounds checking because of possible crashing and security issues. 

> 
> You should not be worried about crashing. We have doctests for the places in the code where it would fail. I don't understand why there would be any security issue (unless you mean something different than system security here).
> 

I was just worried about providing a vector for a buffer overflow attack.
> > I don't see an appreciable difference between bounds-checking enabled and disabled. So if my changes are good, positive review.

> 
> There are a lot of variations in your timings, and enabling the bounds-checking should not result in a speedup. 

Sorry, I meant that enabling bounds-checking did not appear to slow it down. If there was a big slow down I would have looked more into the security side of things to see if it was ok to disable the bounds checking, but since there was not any apparent slow down, it seemed ok to me to just disable it.


Thanks for the review!



---

archive/issue_comments_524081.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nReplying to [@trevorkarn](#comment%3A13):\n> Replying to [@tscrim](#comment%3A12):\n> > Replying to [@trevorkarn](#comment%3A10):\n> > > I'm slightly worried about disabling bounds checking because of possible crashing and security issues. \n\n> > \n> > You should not be worried about crashing. We have doctests for the places in the code where it would fail. I don't understand why there would be any security issue (unless you mean something different than system security here).\n> > \n\n> I was just worried about providing a vector for a buffer overflow attack.\n\nhttps://xkcd.com/538/\n\nOne thing I missed if you could do really quick. Please remove the `import cython` as it is no longer needed. You can immediately reset back to a positive review once pushed.",
    "created_at": "2021-08-11T03:23:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524081",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'>Comment 14:</a>
Replying to [@trevorkarn](#comment%3A13):
> Replying to [@tscrim](#comment%3A12):
> > Replying to [@trevorkarn](#comment%3A10):
> > > I'm slightly worried about disabling bounds checking because of possible crashing and security issues. 

> > 
> > You should not be worried about crashing. We have doctests for the places in the code where it would fail. I don't understand why there would be any security issue (unless you mean something different than system security here).
> > 

> I was just worried about providing a vector for a buffer overflow attack.

https://xkcd.com/538/

One thing I missed if you could do really quick. Please remove the `import cython` as it is no longer needed. You can immediately reset back to a positive review once pushed.



---

archive/issue_events_427812.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2021-08-11T19:21:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32339#event-427812"
}
```



---

archive/issue_events_427813.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2021-08-11T19:21:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32339#event-427813"
}
```



---

archive/issue_comments_524082.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1f28d9c8da03a5efe66ab29aa50229c1c8d351e2\">1f28d9c</a></td><td><code>Remove cython import</code></td></tr></table>\n",
    "created_at": "2021-08-11T19:21:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524082",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:15'>Comment 15:</a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1f28d9c8da03a5efe66ab29aa50229c1c8d351e2">1f28d9c</a></td><td><code>Remove cython import</code></td></tr></table>




---

archive/issue_comments_524083.json:
```json
{
    "body": "Changed commit from **[446512e](https://github.com/sagemath/sagetrac-mirror/commit/446512e2e3efe74e0218867c2b60092a052ac7a2)** to **[1f28d9c](https://github.com/sagemath/sagetrac-mirror/commit/1f28d9c8da03a5efe66ab29aa50229c1c8d351e2)**",
    "created_at": "2021-08-11T19:21:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524083",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[446512e](https://github.com/sagemath/sagetrac-mirror/commit/446512e2e3efe74e0218867c2b60092a052ac7a2)** to **[1f28d9c](https://github.com/sagemath/sagetrac-mirror/commit/1f28d9c8da03a5efe66ab29aa50229c1c8d351e2)**



---

archive/issue_comments_524084.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nReplying to [@tscrim](#comment%3A14):\n> Replying to [@trevorkarn](#comment%3A13):\n> > Replying to [@tscrim](#comment%3A12):\n> > > Replying to [@trevorkarn](#comment%3A10):\n> > > > I'm slightly worried about disabling bounds checking because of possible crashing and security issues. \n\n> > > \n> > > You should not be worried about crashing. We have doctests for the places in the code where it would fail. I don't understand why there would be any security issue (unless you mean something different than system security here).\n> > > \n\n> > I was just worried about providing a vector for a buffer overflow attack.\n\n> \n> https://xkcd.com/538/\n\nFair enough!\n\n> One thing I missed if you could do really quick. Please remove the `import cython` as it is no longer needed. You can immediately reset back to a positive review once pushed.\n\nDone.",
    "created_at": "2021-08-11T19:24:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524084",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:16'>Comment 16:</a>
Replying to [@tscrim](#comment%3A14):
> Replying to [@trevorkarn](#comment%3A13):
> > Replying to [@tscrim](#comment%3A12):
> > > Replying to [@trevorkarn](#comment%3A10):
> > > > I'm slightly worried about disabling bounds checking because of possible crashing and security issues. 

> > > 
> > > You should not be worried about crashing. We have doctests for the places in the code where it would fail. I don't understand why there would be any security issue (unless you mean something different than system security here).
> > > 

> > I was just worried about providing a vector for a buffer overflow attack.

> 
> https://xkcd.com/538/

Fair enough!

> One thing I missed if you could do really quick. Please remove the `import cython` as it is no longer needed. You can immediately reset back to a positive review once pushed.

Done.



---

archive/issue_comments_524085.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nThank you.",
    "created_at": "2021-08-11T21:38:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524085",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'>Comment 17:</a>
Thank you.



---

archive/issue_events_427814.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-08-11T21:38:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32339#event-427814"
}
```



---

archive/issue_events_427815.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-08-11T21:38:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32339#event-427815"
}
```



---

archive/issue_events_427816.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-09-04T14:01:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32339#event-427816"
}
```



---

archive/issue_events_427817.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-09-04T14:01:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32339#event-427817"
}
```



---

archive/issue_comments_524086.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\n\n```\n**********************************************************************\nFile \"src/sage/algebras/orlik_solomon.py\", line 535, in sage.algebras.orlik_solomon.OrlikSolomonInvariantAlgebra\nFailed example:\n    [OSH.lift(b) for b in OSH.basis()]\nExpected:\n    [OS{}, OS{1} + OS{2} + OS{3}, OS{4} + OS{5} + OS{6}]\nGot:\n    [OS{}, OS{4} + OS{5} + OS{6}, OS{1} + OS{2} + OS{3}]\n**********************************************************************\n```",
    "created_at": "2021-09-04T14:01:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524086",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:18'>Comment 18:</a>

```
**********************************************************************
File "src/sage/algebras/orlik_solomon.py", line 535, in sage.algebras.orlik_solomon.OrlikSolomonInvariantAlgebra
Failed example:
    [OSH.lift(b) for b in OSH.basis()]
Expected:
    [OS{}, OS{1} + OS{2} + OS{3}, OS{4} + OS{5} + OS{6}]
Got:
    [OS{}, OS{4} + OS{5} + OS{6}, OS{1} + OS{2} + OS{3}]
**********************************************************************
```



---

archive/issue_comments_524087.json:
```json
{
    "body": "Changed commit from **[1f28d9c](https://github.com/sagemath/sagetrac-mirror/commit/1f28d9c8da03a5efe66ab29aa50229c1c8d351e2)** to **[7b0be16](https://github.com/sagemath/sagetrac-mirror/commit/7b0be1603b92104ecb68fefc740c6551f1e301af)**",
    "created_at": "2021-09-08T01:32:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524087",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1f28d9c](https://github.com/sagemath/sagetrac-mirror/commit/1f28d9c8da03a5efe66ab29aa50229c1c8d351e2)** to **[7b0be16](https://github.com/sagemath/sagetrac-mirror/commit/7b0be1603b92104ecb68fefc740c6551f1e301af)**



---

archive/issue_comments_524088.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/203d706b408afe38a143e09385333292c4eceabd\">203d706</a></td><td><code>Merge branch 'public/matroids/optimize_nbc_set-32339' of git://trac.sagemath.org/sage into public/matroids/optimize_nbc_set-32339</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7b0be1603b92104ecb68fefc740c6551f1e301af\">7b0be16</a></td><td><code>Updating doctests due to NBC order output changed.</code></td></tr></table>\n",
    "created_at": "2021-09-08T01:32:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524088",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:19'>Comment 19:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/203d706b408afe38a143e09385333292c4eceabd">203d706</a></td><td><code>Merge branch 'public/matroids/optimize_nbc_set-32339' of git://trac.sagemath.org/sage into public/matroids/optimize_nbc_set-32339</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7b0be1603b92104ecb68fefc740c6551f1e301af">7b0be16</a></td><td><code>Updating doctests due to NBC order output changed.</code></td></tr></table>




---

archive/issue_comments_524089.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fe6d6d6f92688ed0811827e88367aec03f91a256\">fe6d6d6</a></td><td><code>Updating doctests due to NBC order output changed.</code></td></tr></table>\n",
    "created_at": "2021-09-08T01:35:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524089",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:20'>Comment 20:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fe6d6d6f92688ed0811827e88367aec03f91a256">fe6d6d6</a></td><td><code>Updating doctests due to NBC order output changed.</code></td></tr></table>




---

archive/issue_comments_524090.json:
```json
{
    "body": "Changed commit from **[7b0be16](https://github.com/sagemath/sagetrac-mirror/commit/7b0be1603b92104ecb68fefc740c6551f1e301af)** to **[fe6d6d6](https://github.com/sagemath/sagetrac-mirror/commit/fe6d6d6f92688ed0811827e88367aec03f91a256)**",
    "created_at": "2021-09-08T01:35:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524090",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7b0be16](https://github.com/sagemath/sagetrac-mirror/commit/7b0be1603b92104ecb68fefc740c6551f1e301af)** to **[fe6d6d6](https://github.com/sagemath/sagetrac-mirror/commit/fe6d6d6f92688ed0811827e88367aec03f91a256)**



---

archive/issue_comments_524091.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nTrivial updating the output of the doctests.",
    "created_at": "2021-09-08T01:35:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524091",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:21'>Comment 21:</a>
Trivial updating the output of the doctests.



---

archive/issue_events_427818.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-09-08T01:35:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32339#event-427818"
}
```



---

archive/issue_events_427819.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-09-08T01:35:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32339#event-427819"
}
```



---

archive/issue_comments_524092.json:
```json
{
    "body": "Changed branch from **[public/matroids/optimize_nbc_set-32339](https://github.com/sagemath/sagetrac-mirror/tree/public/matroids/optimize_nbc_set-32339)** to **[fe6d6d6](https://github.com/sagemath/sagetrac-mirror/commit/fe6d6d6f92688ed0811827e88367aec03f91a256)**",
    "created_at": "2021-09-15T22:06:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32339#issuecomment-524092",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/matroids/optimize_nbc_set-32339](https://github.com/sagemath/sagetrac-mirror/tree/public/matroids/optimize_nbc_set-32339)** to **[fe6d6d6](https://github.com/sagemath/sagetrac-mirror/commit/fe6d6d6f92688ed0811827e88367aec03f91a256)**



---

archive/issue_events_427820.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-09-15T22:06:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32339#event-427820"
}
```



---

archive/issue_events_427821.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a93854115672693de84f3ff18823441d0e4e6fe2",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-09-15T22:06:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32339",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32339#event-427821"
}
```
