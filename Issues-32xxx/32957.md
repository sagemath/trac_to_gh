# Issue 32957: Replace `have_program` usage by Features

archive/issues_032720.json:
```json
{
    "body": "After #32650, remaining usage of `have_program` are:\n\n```\n$ git grep have_program\nsrc/sage/interfaces/chomp.py:        from sage.misc.sage_ostools import have_program\nsrc/sage/interfaces/chomp.py:        _have_chomp[program] = have_program(program)\nsrc/sage/interfaces/phc.py:            from sage.misc.sage_ostools import have_program\nsrc/sage/interfaces/phc.py:            if not have_program('phc'):\nsrc/sage/misc/dist.py:    from sage.misc.sage_ostools import have_program\nsrc/sage/misc/dist.py:        cmd_inside_sage = have_program(cmd, path=SAGE_BIN)\nsrc/sage/misc/dist.py:        cmd_outside_sage = have_program(cmd, path=PATH)\nsrc/sage/misc/sage_ostools.pyx:def have_program(program, path=None):\nsrc/sage/misc/sage_ostools.pyx:        sage: from sage.misc.sage_ostools import have_program\nsrc/sage/misc/sage_ostools.pyx:        sage: have_program('ls')\nsrc/sage/misc/sage_ostools.pyx:        sage: have_program('there_is_not_a_program_with_this_name')\nsrc/sage/misc/sage_ostools.pyx:        sage: have_program('sage', os.path.join(SAGE_VENV, 'bin'))\nsrc/sage/misc/sage_ostools.pyx:        sage: have_program('sage', '/there_is_not_a_path_with_this_name')\nsrc/sage/misc/sage_ostools.pyx:        sage: have_program('there_is_not_a_program_with_this_name', os.path.join(SAGE_VENV, 'bin'))\nsrc/sage/misc/viewer.py:    from sage.misc.sage_ostools import have_program\nsrc/sage/misc/viewer.py:    elif have_program('xdg-open'):\nsrc/sage/misc/viewer.py:                if have_program(cmd):\nsrc/sage/misc/viewer.py:                if have_program(cmd):\nsrc/sage/misc/viewer.py:                if have_program(cmd):\n```\n\nSee also: \n- #33405 Eliminate direct use of `os.getenv` in sage.interfaces\n- #30207 Deprecate `sage.misc.dist.install_scripts`\n- #30207 Deprecate `sage.misc.dist`\n- #33931 Deprecate `sage.misc.viewer`\n- #33777 Deprecate the CHomP interface\n\n**CC:**  @seblabbe @tornaria\n\nIssue created by migration from https://trac.sagemath.org/ticket/32957\n\n",
    "created_at": "2021-12-01T21:11:38Z",
    "labels": [
        "component: distribution",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Replace `have_program` usage by Features",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32957",
    "user": "https://github.com/seblabbe"
}
```
After #32650, remaining usage of `have_program` are:

```
$ git grep have_program
src/sage/interfaces/chomp.py:        from sage.misc.sage_ostools import have_program
src/sage/interfaces/chomp.py:        _have_chomp[program] = have_program(program)
src/sage/interfaces/phc.py:            from sage.misc.sage_ostools import have_program
src/sage/interfaces/phc.py:            if not have_program('phc'):
src/sage/misc/dist.py:    from sage.misc.sage_ostools import have_program
src/sage/misc/dist.py:        cmd_inside_sage = have_program(cmd, path=SAGE_BIN)
src/sage/misc/dist.py:        cmd_outside_sage = have_program(cmd, path=PATH)
src/sage/misc/sage_ostools.pyx:def have_program(program, path=None):
src/sage/misc/sage_ostools.pyx:        sage: from sage.misc.sage_ostools import have_program
src/sage/misc/sage_ostools.pyx:        sage: have_program('ls')
src/sage/misc/sage_ostools.pyx:        sage: have_program('there_is_not_a_program_with_this_name')
src/sage/misc/sage_ostools.pyx:        sage: have_program('sage', os.path.join(SAGE_VENV, 'bin'))
src/sage/misc/sage_ostools.pyx:        sage: have_program('sage', '/there_is_not_a_path_with_this_name')
src/sage/misc/sage_ostools.pyx:        sage: have_program('there_is_not_a_program_with_this_name', os.path.join(SAGE_VENV, 'bin'))
src/sage/misc/viewer.py:    from sage.misc.sage_ostools import have_program
src/sage/misc/viewer.py:    elif have_program('xdg-open'):
src/sage/misc/viewer.py:                if have_program(cmd):
src/sage/misc/viewer.py:                if have_program(cmd):
src/sage/misc/viewer.py:                if have_program(cmd):
```

See also: 
- #33405 Eliminate direct use of `os.getenv` in sage.interfaces
- #30207 Deprecate `sage.misc.dist.install_scripts`
- #30207 Deprecate `sage.misc.dist`
- #33931 Deprecate `sage.misc.viewer`
- #33777 Deprecate the CHomP interface

**CC:**  @seblabbe @tornaria

Issue created by migration from https://trac.sagemath.org/ticket/32957





---

archive/issue_comments_536509.json:
```json
{
    "body": "<a id='comment:1'></a>\n#30207 proposes to deprecate `sage.misc.dist`",
    "created_at": "2021-12-09T19:59:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32957#issuecomment-536509",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'></a>
#30207 proposes to deprecate `sage.misc.dist`



---

archive/issue_events_300395.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:11:26Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32957#event-300395"
}
```



---

archive/issue_events_300396.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:11:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32957#event-300396"
}
```



---

archive/issue_comments_536510.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -22,3 +22,5 @@\n src/sage/misc/viewer.py:                if have_program(cmd):\n src/sage/misc/viewer.py:                if have_program(cmd):\n ```\n+\n+See also: #33405 Eliminate direct use of `os.getenv` in sage.interfaces\n``````\n",
    "created_at": "2022-03-17T18:15:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32957#issuecomment-536510",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -22,3 +22,5 @@
 src/sage/misc/viewer.py:                if have_program(cmd):
 src/sage/misc/viewer.py:                if have_program(cmd):
 ```
+
+See also: #33405 Eliminate direct use of `os.getenv` in sage.interfaces
``````




---

archive/issue_comments_536511.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -23,4 +23,6 @@\n src/sage/misc/viewer.py:                if have_program(cmd):\n ```\n \n-See also: #33405 Eliminate direct use of `os.getenv` in sage.interfaces\n+See also: \n+- #33405 Eliminate direct use of `os.getenv` in sage.interfaces\n+- #30207 Deprecate `sage.misc.dist.install_scripts`\n``````\n",
    "created_at": "2022-04-02T17:32:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32957#issuecomment-536511",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -23,4 +23,6 @@
 src/sage/misc/viewer.py:                if have_program(cmd):
 ```
 
-See also: #33405 Eliminate direct use of `os.getenv` in sage.interfaces
+See also: 
+- #33405 Eliminate direct use of `os.getenv` in sage.interfaces
+- #30207 Deprecate `sage.misc.dist.install_scripts`
``````




---

archive/issue_events_300397.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32957#event-300397"
}
```



---

archive/issue_events_300398.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32957#event-300398"
}
```



---

archive/issue_comments_536512.json:
```json
{
    "body": "<a id='comment:7'></a>\nI can try to convert the `chomp` stuff to something in `features`, but I can't test it very well because `CHomP` doesn't build on OS X, with an error\n\n```\nIn file included from /Users/jpalmier/Desktop/Sage/git/CHomP/source/chomp-matrix.cpp:4:\n/Users/jpalmier/Desktop/Sage/git/CHomP/include/chomp/Ring.h:224:3: error: C++ requires a type specifier for all declarations\n  BOOST_SERIALIZATION_SPLIT_MEMBER()\n```\n`BOOST_SERIALIZATION_SPLIT_MEMBER` seems to come from `/usr/local/include/boost/`, and I don't know why it's not being found. I wonder if it's time to deprecate the `CHomP` stuff in Sage anyway; the software at https://github.com/marciogameiro/CHomP hasn't been modified in 5 years.",
    "created_at": "2022-04-27T18:26:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32957#issuecomment-536512",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
I can try to convert the `chomp` stuff to something in `features`, but I can't test it very well because `CHomP` doesn't build on OS X, with an error

```
In file included from /Users/jpalmier/Desktop/Sage/git/CHomP/source/chomp-matrix.cpp:4:
/Users/jpalmier/Desktop/Sage/git/CHomP/include/chomp/Ring.h:224:3: error: C++ requires a type specifier for all declarations
  BOOST_SERIALIZATION_SPLIT_MEMBER()
```
`BOOST_SERIALIZATION_SPLIT_MEMBER` seems to come from `/usr/local/include/boost/`, and I don't know why it's not being found. I wonder if it's time to deprecate the `CHomP` stuff in Sage anyway; the software at https://github.com/marciogameiro/CHomP hasn't been modified in 5 years.



---

archive/issue_comments_536513.json:
```json
{
    "body": "<a id='comment:8'></a>\nI also feel like there must be a good way to replace `sage/misc/viewer.py` these days.",
    "created_at": "2022-04-27T18:31:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32957#issuecomment-536513",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>
I also feel like there must be a good way to replace `sage/misc/viewer.py` these days.



---

archive/issue_comments_536514.json:
```json
{
    "body": "<a id='comment:9'></a>\nShould we deprecate `sage/misc/dist.py`? It obviously hasn't been examined in a while, since it still talks about installing a script for `mercurial`. It is an artifact of older days when a feature of Sage was that it provided copies of `gap`, `gp/pari`, etc., as opposed to now, when we are trying to modularize and we want Sage to rely on system versions of those packages.",
    "created_at": "2022-04-27T18:34:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32957#issuecomment-536514",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>
Should we deprecate `sage/misc/dist.py`? It obviously hasn't been examined in a while, since it still talks about installing a script for `mercurial`. It is an artifact of older days when a feature of Sage was that it provided copies of `gap`, `gp/pari`, etc., as opposed to now, when we are trying to modularize and we want Sage to rely on system versions of those packages.



---

archive/issue_comments_536515.json:
```json
{
    "body": "<a id='comment:10'></a>\nI'm in favor of deprecating sage.misc.dist (see #30207).",
    "created_at": "2022-04-27T18:38:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32957#issuecomment-536515",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>
I'm in favor of deprecating sage.misc.dist (see #30207).



---

archive/issue_comments_536516.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [jhpalmieri](#comment%3A7):\n> I wonder if it's time to deprecate the `CHomP` stuff in Sage anyway\n\n\nI agree. Looks like it was only provided by an old-style spkg",
    "created_at": "2022-04-27T18:43:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32957#issuecomment-536516",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
Replying to [jhpalmieri](#comment%3A7):
> I wonder if it's time to deprecate the `CHomP` stuff in Sage anyway


I agree. Looks like it was only provided by an old-style spkg



---

archive/issue_comments_536517.json:
```json
{
    "body": "<a id='comment:12'></a>\nDeprecating `CHomP` is now #33777.",
    "created_at": "2022-04-30T19:55:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32957#issuecomment-536517",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:12'></a>
Deprecating `CHomP` is now #33777.



---

archive/issue_comments_536518.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [jhpalmieri](#comment%3A8):\n> I also feel like there must be a good way to replace `sage/misc/viewer.py` these days.\n\n\nthere's https://docs.python.org/3/library/webbrowser.html",
    "created_at": "2022-05-18T06:07:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32957#issuecomment-536518",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>
Replying to [jhpalmieri](#comment%3A8):
> I also feel like there must be a good way to replace `sage/misc/viewer.py` these days.


there's https://docs.python.org/3/library/webbrowser.html



---

archive/issue_comments_536519.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [mkoeppe](#comment%3A13):\n> Replying to [jhpalmieri](#comment%3A8):\n> > I also feel like there must be a good way to replace `sage/misc/viewer.py` these days.\n\n> \n> there's https://docs.python.org/3/library/webbrowser.html\n\n\nOh, I see:\n\n```\nwebbrowser.open(r'file:///path/to/file')\n```\nworks for me on OS X, for `pdf` and image files. For `png` and `jpg` files, there is also `PIL`:\n\n```\nfrom PIL import Image\nwith Image.open('filename') as im:\n    im.show()\n```",
    "created_at": "2022-05-27T21:35:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32957#issuecomment-536519",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:14'></a>
Replying to [mkoeppe](#comment%3A13):
> Replying to [jhpalmieri](#comment%3A8):
> > I also feel like there must be a good way to replace `sage/misc/viewer.py` these days.

> 
> there's https://docs.python.org/3/library/webbrowser.html


Oh, I see:

```
webbrowser.open(r'file:///path/to/file')
```
works for me on OS X, for `pdf` and image files. For `png` and `jpg` files, there is also `PIL`:

```
from PIL import Image
with Image.open('filename') as im:
    im.show()
```



---

archive/issue_comments_536520.json:
```json
{
    "body": "<a id='comment:15'></a>\nSee #33931 for the deprecation of `sage.misc.viewer`.",
    "created_at": "2022-05-29T00:54:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32957#issuecomment-536520",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:15'></a>
See #33931 for the deprecation of `sage.misc.viewer`.



---

archive/issue_comments_536521.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -26,3 +26,6 @@\n See also: \n - #33405 Eliminate direct use of `os.getenv` in sage.interfaces\n - #30207 Deprecate `sage.misc.dist.install_scripts`\n+- #30207 Deprecate `sage.misc.dist`\n+- #33931 Deprecate `sage.misc.viewer`\n+- #33777 Deprecate the CHomP interface\n``````\n",
    "created_at": "2022-05-29T00:55:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32957#issuecomment-536521",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -26,3 +26,6 @@
 See also: 
 - #33405 Eliminate direct use of `os.getenv` in sage.interfaces
 - #30207 Deprecate `sage.misc.dist.install_scripts`
+- #30207 Deprecate `sage.misc.dist`
+- #33931 Deprecate `sage.misc.viewer`
+- #33777 Deprecate the CHomP interface
``````




---

archive/issue_events_300399.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32957#event-300399"
}
```



---

archive/issue_events_300400.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32957",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32957#event-300400"
}
```
