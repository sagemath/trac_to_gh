# Issue 32549: Remove package mpir

archive/issues_032312.json:
```json
{
    "body": "MPIR, a fork of GMP, has not been updated upstream. The latest release, 3.0.0, is from 2017-03-01 (https://mpir.org/downloads.html). \n\nSage currently provides an SPKG for MPIR as a configurable alternative to GMP. We should remove this option and package, as previously suggested in #29620#comment:10\n\n \n\nCC:  @jhpalmieri @orlitzky @dimpase wbhart brg@gladman.plus.com riemannic@gmail.com\n\nReviewer: Dima Pasechnik, Matthias Koeppe\n\nAuthor: Matthias Koeppe, John Palmieri, Dima Pasechnik\n\nBranch: 286b39c22f710795775506cfbdcb0cb3be51ced3\n\nDependencies: #30350, #31163\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/32549\n\n",
    "closed_at": "2021-10-13T22:51:04Z",
    "created_at": "2021-09-22T02:59:56Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Remove package mpir",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32549",
    "user": "https://github.com/mkoeppe"
}
```
MPIR, a fork of GMP, has not been updated upstream. The latest release, 3.0.0, is from 2017-03-01 (https://mpir.org/downloads.html). 

Sage currently provides an SPKG for MPIR as a configurable alternative to GMP. We should remove this option and package, as previously suggested in #29620#comment:10

 

CC:  @jhpalmieri @orlitzky @dimpase wbhart brg@gladman.plus.com riemannic@gmail.com

Reviewer: Dima Pasechnik, Matthias Koeppe

Author: Matthias Koeppe, John Palmieri, Dima Pasechnik

Branch: 286b39c22f710795775506cfbdcb0cb3be51ced3

Dependencies: #30350, #31163

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/32549





---

archive/issue_comments_492505.json:
```json
{
    "body": "<a id='comment:1'></a>It seems there are some commits since then (the last is from December 2020 for Linux version and August 2021 for Windows version), perhaps should we ask to the people involved in MPIR how they see the future of MPIR ?",
    "created_at": "2021-09-22T09:49:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492505",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:1'></a>It seems there are some commits since then (the last is from December 2020 for Linux version and August 2021 for Windows version), perhaps should we ask to the people involved in MPIR how they see the future of MPIR ?



---

archive/issue_comments_492506.json:
```json
{
    "body": "<a id='comment:2'></a>+1\n\nRegardless of the state of MPIR upstream, sage never really developed a coherent plan for packages that are substitutes for one another. The `./configure` options that are available now don't really make sense, and the best thing to do for our end users is to eliminate the confusion (if also the choice). If someone later wants to overhaul the build system to handle these choices consistently, then OK; but I don't think anyone does right now.",
    "created_at": "2021-09-22T13:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492506",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:2'></a>+1

Regardless of the state of MPIR upstream, sage never really developed a coherent plan for packages that are substitutes for one another. The `./configure` options that are available now don't really make sense, and the best thing to do for our end users is to eliminate the confusion (if also the choice). If someone later wants to overhaul the build system to handle these choices consistently, then OK; but I don't think anyone does right now.



---

archive/issue_comments_492507.json:
```json
{
    "body": "<a id='comment:3'></a>The upstream (Bill) told me some time ago that due to Spectre and other CPU vulns discovered few years ago, parts of MPIR became obsolete, as speedups there relied on CPUs being unpatched.\n\nIMHO it's semi-abandonware now.",
    "created_at": "2021-09-22T15:49:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492507",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>The upstream (Bill) told me some time ago that due to Spectre and other CPU vulns discovered few years ago, parts of MPIR became obsolete, as speedups there relied on CPUs being unpatched.

IMHO it's semi-abandonware now.



---

archive/issue_comments_492508.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [comment:2 mjo]:\n> sage never really developed a coherent plan for packages that are substitutes for one another. The `./configure` options that are available now don't really make sense\n\n#29620 tracks this",
    "created_at": "2021-09-22T15:57:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492508",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>Replying to [comment:2 mjo]:
> sage never really developed a coherent plan for packages that are substitutes for one another. The `./configure` options that are available now don't really make sense

#29620 tracks this



---

archive/issue_comments_492509.json:
```json
{
    "body": "<a id='comment:6'></a>New commits:",
    "created_at": "2021-09-23T03:29:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492509",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>New commits:



---

archive/issue_comments_492510.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-09-23T03:29:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492510",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_492511.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-23T03:34:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492511",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_492512.json:
```json
{
    "body": "<a id='comment:8'></a>There are a few references to yasm: a comment in `m4/sage_spkg_configure.m4` and many mentions in `doc/en/developer/portability_testing.rst`.",
    "created_at": "2021-09-23T04:11:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492512",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>There are a few references to yasm: a comment in `m4/sage_spkg_configure.m4` and many mentions in `doc/en/developer/portability_testing.rst`.



---

archive/issue_comments_492513.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-23T04:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492513",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_492514.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-23T04:16:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492514",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_492515.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-23T04:20:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492515",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_492516.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-23T04:28:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492516",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_492517.json:
```json
{
    "body": "<a id='comment:13'></a>In two places of the Sage library, also `'mpir'` appears as a possible value of an `algorithm` parameter:\n\n```\nsrc/sage/arith/misc.py:        sage: a = binomial(100, 45, algorithm='mpir')\nsrc/sage/rings/integer.pyx:    def binomial(self, m, algorithm='mpir'):\n```",
    "created_at": "2021-09-23T04:34:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492517",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>In two places of the Sage library, also `'mpir'` appears as a possible value of an `algorithm` parameter:

```
src/sage/arith/misc.py:        sage: a = binomial(100, 45, algorithm='mpir')
src/sage/rings/integer.pyx:    def binomial(self, m, algorithm='mpir'):
```



---

archive/issue_comments_492518.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-23T04:39:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492518",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_492519.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:13 mkoeppe]:\n> In two places of the Sage library, also `'mpir'` appears as a possible value of an `algorithm` parameter:\n> \n> ```\n> src/sage/arith/misc.py:        sage: a = binomial(100, 45, algorithm='mpir')\n> src/sage/rings/integer.pyx:    def binomial(self, m, algorithm='mpir'):\n> ```\n\n\nthis option should be renamed `gmp`, and respective tests should drop `# optional` tag.\nIndeed, it just calls a gmp/mpir function (which are more or less the same, and mpir provided a replacement for gmp there).\n\n```\nsage: 100.binomial(45, algorithm='mpir')\n61448471214136179596720592960\n```\nsee, it still works, without any mpir installed.",
    "created_at": "2021-09-23T08:22:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492519",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'></a>Replying to [comment:13 mkoeppe]:
> In two places of the Sage library, also `'mpir'` appears as a possible value of an `algorithm` parameter:
> 
> ```
> src/sage/arith/misc.py:        sage: a = binomial(100, 45, algorithm='mpir')
> src/sage/rings/integer.pyx:    def binomial(self, m, algorithm='mpir'):
> ```


this option should be renamed `gmp`, and respective tests should drop `# optional` tag.
Indeed, it just calls a gmp/mpir function (which are more or less the same, and mpir provided a replacement for gmp there).

```
sage: 100.binomial(45, algorithm='mpir')
61448471214136179596720592960
```
see, it still works, without any mpir installed.



---

archive/issue_comments_492520.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-23T14:43:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492520",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_492521.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:15 dimpase]:\n> this option should be renamed `gmp`\n\n\nI have kept `mpir` as an alias, without deprecation warnings; after all, if we use system GMP, that could as well be MPIR",
    "created_at": "2021-09-23T14:47:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492521",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>Replying to [comment:15 dimpase]:
> this option should be renamed `gmp`


I have kept `mpir` as an alias, without deprecation warnings; after all, if we use system GMP, that could as well be MPIR



---

archive/issue_comments_492522.json:
```json
{
    "body": "<a id='comment:18'></a>there is still an `#optional : mpir` tag in integer.pyx, line 6427.\nAnd analogous `gmp` tag few lines down.",
    "created_at": "2021-09-23T15:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492522",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:18'></a>there is still an `#optional : mpir` tag in integer.pyx, line 6427.
And analogous `gmp` tag few lines down.



---

archive/issue_comments_492523.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-23T16:23:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492523",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_492524.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:18 dimpase]:\n> there is still an `#optional : mpir` tag in integer.pyx, line 6427.\n> And analogous `gmp` tag few lines down.\n\nThese doctests weren't actually being run because neither `mpir` nor `gmp` were optional packages. I've rewritten it in a less specific way, it now runs",
    "created_at": "2021-09-23T16:23:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492524",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>Replying to [comment:18 dimpase]:
> there is still an `#optional : mpir` tag in integer.pyx, line 6427.
> And analogous `gmp` tag few lines down.

These doctests weren't actually being run because neither `mpir` nor `gmp` were optional packages. I've rewritten it in a less specific way, it now runs



---

archive/issue_comments_492525.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-23T16:30:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492525",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_492526.json:
```json
{
    "body": "<a id='comment:22'></a>There is a similar test in `src/sage/ext/memory.pyx`. We can also remove `mpir` from `COPYING.txt`. (Was there ever talk of autogenerating that file? Each package could have a file `license.txt`...)",
    "created_at": "2021-09-23T20:01:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492526",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:22'></a>There is a similar test in `src/sage/ext/memory.pyx`. We can also remove `mpir` from `COPYING.txt`. (Was there ever talk of autogenerating that file? Each package could have a file `license.txt`...)



---

archive/issue_comments_492527.json:
```json
{
    "body": "<a id='comment:23'></a>Also in `m4/sage_spkg_collect.m4`:\n\n```\n    # Packages that should be included in the source distribution\n    # This includes all standard packages and two special cases\n    case \"$SPKG_NAME\" in\n    mpir)\n        in_sdist=yes\n        ;;\n    esac\n```",
    "created_at": "2021-09-23T21:57:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492527",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:23'></a>Also in `m4/sage_spkg_collect.m4`:

```
    # Packages that should be included in the source distribution
    # This includes all standard packages and two special cases
    case "$SPKG_NAME" in
    mpir)
        in_sdist=yes
        ;;
    esac
```



---

archive/issue_comments_492528.json:
```json
{
    "body": "<a id='comment:24'></a>I don't understand this comment, line 286 in `src/sage/all.py`:\n\n```\n    # Free globally allocated mpir integers.\n```\nJust delete the comment and leave the code? Replace the comment with something else? Remove the code?",
    "created_at": "2021-09-23T22:01:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492528",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:24'></a>I don't understand this comment, line 286 in `src/sage/all.py`:

```
    # Free globally allocated mpir integers.
```
Just delete the comment and leave the code? Replace the comment with something else? Remove the code?



---

archive/issue_comments_492529.json:
```json
{
    "body": "<a id='comment:25'></a>Here are some proposed changes:\n\n```diff\ndiff --git a/COPYING.txt b/COPYING.txt\nindex 2da3a8e492..7ce750a1aa 100644\n--- a/COPYING.txt\n+++ b/COPYING.txt\n@@ -86,7 +86,6 @@ mistune                     Modified BSD\n mpc                         LGPLv3+\n mpfi                        COPYING is GPLv2, source files state LGPLv2.1+\n mpfr                        LGPLv3+\n-mpir                        LGPLv3+\n mpmath                      Modified BSD\n networkx                    Modified BSD\n ntl                         GPLv2+\ndiff --git a/build/pkgs/ecm/spkg-configure.m4 b/build/pkgs/ecm/spkg-configure.m4\nindex e62c21cb32..d5302a89fb 100644\n--- a/build/pkgs/ecm/spkg-configure.m4\n+++ b/build/pkgs/ecm/spkg-configure.m4\n@@ -1,7 +1,7 @@\n SAGE_SPKG_CONFIGURE([ecm], [\n     m4_pushdef([SAGE_ECM_MINVER],[7.0.4])\n     AC_REQUIRE([SAGE_SPKG_CONFIGURE_GMP])\n-    AC_MSG_CHECKING([installing gmp/mpir? ])\n+    AC_MSG_CHECKING([installing gmp? ])\n     if test x$sage_spkg_install_gmp = xyes; then\n         AC_MSG_RESULT([yes; install ecm as well])\n         sage_spkg_install_ecm=yes\ndiff --git a/build/pkgs/gdb/SPKG.rst b/build/pkgs/gdb/SPKG.rst\nindex b89773fe67..0716ac53fa 100644\n--- a/build/pkgs/gdb/SPKG.rst\n+++ b/build/pkgs/gdb/SPKG.rst\n@@ -19,17 +19,6 @@ Upstream Contact\n \n http://www.gnu.org/software/gdb/\n \n-Dependencies\n-------------\n-\n--  python\n--  mpc\n--  mpfr\n--  ppl\n--  gmp/mpir\n--  makeinfo (external)\n-\n-\n Special Update/Build Instructions\n ---------------------------------\n \ndiff --git a/build/pkgs/isl/spkg-configure.m4 b/build/pkgs/isl/spkg-configure.m4\nindex 1b16f70870..d7bbef80c6 100644\n--- a/build/pkgs/isl/spkg-configure.m4\n+++ b/build/pkgs/isl/spkg-configure.m4\n@@ -1,6 +1,6 @@\n SAGE_SPKG_CONFIGURE([isl], [\n     AC_REQUIRE([SAGE_SPKG_CONFIGURE_GMP])\n-    AC_MSG_CHECKING([installing gmp/mpir? ])\n+    AC_MSG_CHECKING([installing gmp? ])\n     if test x$sage_spkg_install_gmp = xyes; then\n         AC_MSG_RESULT([yes; install isl as well])\n         sage_spkg_install_isl=yes\ndiff --git a/build/pkgs/mpfr/spkg-configure.m4 b/build/pkgs/mpfr/spkg-configure.m4\nindex 2300be6707..f64ede4b75 100644\n--- a/build/pkgs/mpfr/spkg-configure.m4\n+++ b/build/pkgs/mpfr/spkg-configure.m4\n@@ -1,6 +1,6 @@\n SAGE_SPKG_CONFIGURE([mpfr], [\n     AC_REQUIRE([SAGE_SPKG_CONFIGURE_GMP])\n-    AC_MSG_CHECKING([installing gmp/mpir? ])\n+    AC_MSG_CHECKING([installing gmp? ])\n     if test x$sage_spkg_install_gmp = xyes; then\n         AC_MSG_RESULT([yes; install mpfr as well])\n         sage_spkg_install_mpfr=yes\ndiff --git a/m4/sage_spkg_collect.m4 b/m4/sage_spkg_collect.m4\nindex 1ab62d6fa4..c364ab62b7 100644\n--- a/m4/sage_spkg_collect.m4\n+++ b/m4/sage_spkg_collect.m4\n@@ -259,14 +259,6 @@ for DIR in $SAGE_ROOT/build/pkgs/*; do\n         AS_VAR_POPDEF([sage_require])dnl\n         AS_VAR_POPDEF([sage_spkg_install])dnl\n \n-    # Packages that should be included in the source distribution\n-    # This includes all standard packages and two special cases\n-    case \"$SPKG_NAME\" in\n-    mpir)\n-        in_sdist=yes\n-        ;;\n-    esac\n-\n     # Determine package source\n     #\n     if test -f \"$DIR/requirements.txt\"; then\n```",
    "created_at": "2021-09-23T22:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492529",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:25'></a>Here are some proposed changes:

```diff
diff --git a/COPYING.txt b/COPYING.txt
index 2da3a8e492..7ce750a1aa 100644
--- a/COPYING.txt
+++ b/COPYING.txt
@@ -86,7 +86,6 @@ mistune                     Modified BSD
 mpc                         LGPLv3+
 mpfi                        COPYING is GPLv2, source files state LGPLv2.1+
 mpfr                        LGPLv3+
-mpir                        LGPLv3+
 mpmath                      Modified BSD
 networkx                    Modified BSD
 ntl                         GPLv2+
diff --git a/build/pkgs/ecm/spkg-configure.m4 b/build/pkgs/ecm/spkg-configure.m4
index e62c21cb32..d5302a89fb 100644
--- a/build/pkgs/ecm/spkg-configure.m4
+++ b/build/pkgs/ecm/spkg-configure.m4
@@ -1,7 +1,7 @@
 SAGE_SPKG_CONFIGURE([ecm], [
     m4_pushdef([SAGE_ECM_MINVER],[7.0.4])
     AC_REQUIRE([SAGE_SPKG_CONFIGURE_GMP])
-    AC_MSG_CHECKING([installing gmp/mpir? ])
+    AC_MSG_CHECKING([installing gmp? ])
     if test x$sage_spkg_install_gmp = xyes; then
         AC_MSG_RESULT([yes; install ecm as well])
         sage_spkg_install_ecm=yes
diff --git a/build/pkgs/gdb/SPKG.rst b/build/pkgs/gdb/SPKG.rst
index b89773fe67..0716ac53fa 100644
--- a/build/pkgs/gdb/SPKG.rst
+++ b/build/pkgs/gdb/SPKG.rst
@@ -19,17 +19,6 @@ Upstream Contact
 
 http://www.gnu.org/software/gdb/
 
-Dependencies
-------------
-
--  python
--  mpc
--  mpfr
--  ppl
--  gmp/mpir
--  makeinfo (external)
-
-
 Special Update/Build Instructions
 ---------------------------------
 
diff --git a/build/pkgs/isl/spkg-configure.m4 b/build/pkgs/isl/spkg-configure.m4
index 1b16f70870..d7bbef80c6 100644
--- a/build/pkgs/isl/spkg-configure.m4
+++ b/build/pkgs/isl/spkg-configure.m4
@@ -1,6 +1,6 @@
 SAGE_SPKG_CONFIGURE([isl], [
     AC_REQUIRE([SAGE_SPKG_CONFIGURE_GMP])
-    AC_MSG_CHECKING([installing gmp/mpir? ])
+    AC_MSG_CHECKING([installing gmp? ])
     if test x$sage_spkg_install_gmp = xyes; then
         AC_MSG_RESULT([yes; install isl as well])
         sage_spkg_install_isl=yes
diff --git a/build/pkgs/mpfr/spkg-configure.m4 b/build/pkgs/mpfr/spkg-configure.m4
index 2300be6707..f64ede4b75 100644
--- a/build/pkgs/mpfr/spkg-configure.m4
+++ b/build/pkgs/mpfr/spkg-configure.m4
@@ -1,6 +1,6 @@
 SAGE_SPKG_CONFIGURE([mpfr], [
     AC_REQUIRE([SAGE_SPKG_CONFIGURE_GMP])
-    AC_MSG_CHECKING([installing gmp/mpir? ])
+    AC_MSG_CHECKING([installing gmp? ])
     if test x$sage_spkg_install_gmp = xyes; then
         AC_MSG_RESULT([yes; install mpfr as well])
         sage_spkg_install_mpfr=yes
diff --git a/m4/sage_spkg_collect.m4 b/m4/sage_spkg_collect.m4
index 1ab62d6fa4..c364ab62b7 100644
--- a/m4/sage_spkg_collect.m4
+++ b/m4/sage_spkg_collect.m4
@@ -259,14 +259,6 @@ for DIR in $SAGE_ROOT/build/pkgs/*; do
         AS_VAR_POPDEF([sage_require])dnl
         AS_VAR_POPDEF([sage_spkg_install])dnl
 
-    # Packages that should be included in the source distribution
-    # This includes all standard packages and two special cases
-    case "$SPKG_NAME" in
-    mpir)
-        in_sdist=yes
-        ;;
-    esac
-
     # Determine package source
     #
     if test -f "$DIR/requirements.txt"; then
```



---

archive/issue_comments_492530.json:
```json
{
    "body": "<a id='comment:26'></a>All looking fine, please push them to the ticket",
    "created_at": "2021-09-23T22:16:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492530",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>All looking fine, please push them to the ticket



---

archive/issue_comments_492531.json:
```json
{
    "body": "<a id='comment:28'></a>Replying to [comment:26 mkoeppe]:\n> All looking fine, please push them to the ticket\n\n\nDone\n\n---\nNew commits:",
    "created_at": "2021-09-23T22:25:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492531",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:28'></a>Replying to [comment:26 mkoeppe]:
> All looking fine, please push them to the ticket


Done

---
New commits:



---

archive/issue_comments_492532.json:
```json
{
    "body": "<a id='comment:30'></a>Let's use this ticket to update to consistently use `SAGE_SPKG_DEPCHECK` instead of that `if test ...` in all the packages affected.",
    "created_at": "2021-09-26T08:25:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492532",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:30'></a>Let's use this ticket to update to consistently use `SAGE_SPKG_DEPCHECK` instead of that `if test ...` in all the packages affected.



---

archive/issue_comments_492533.json:
```json
{
    "body": "<a id='comment:31'></a>the monster isn't completely gone yet:\n\n```\nbuild//pkgs/ppl/spkg-install.in:# Make sure that we prefer Sage's mpir library over system-wide gmp/mpir installs\nsrc/doc/it/faq/faq-usage.rst:    rm spkg/installed/mpir* spkg/installed/atlas*\nsrc/doc/it/faq/faq-general.rst:`MPIR <http://www.mpir.org>`_,\nsrc/doc/en/faq/faq-usage.rst:    $ rm spkg/installed/mpir* spkg/installed/atlas*\nsrc/doc/en/faq/faq-general.rst:`MPIR <http://www.mpir.org>`_,\nsrc/sage/ext_data/valgrind/sage-additional.supp:   fun:sage_mpir_malloc\nsrc/sage/ext_data/valgrind/sage-additional.supp:   mpir_realloc\nsrc/sage/ext_data/valgrind/sage-additional.supp:   fun:sage_mpir_realloc\nsrc/sage/ext/memory.pyx:    sage: 2^(2^63-2)      # optional - mpir\nsrc/sage/all.py:    # Free globally allocated mpir integers.\n```\ntaking care of this now.\n\n---\nNew commits:",
    "created_at": "2021-09-26T09:24:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492533",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:31'></a>the monster isn't completely gone yet:

```
build//pkgs/ppl/spkg-install.in:# Make sure that we prefer Sage's mpir library over system-wide gmp/mpir installs
src/doc/it/faq/faq-usage.rst:    rm spkg/installed/mpir* spkg/installed/atlas*
src/doc/it/faq/faq-general.rst:`MPIR <http://www.mpir.org>`_,
src/doc/en/faq/faq-usage.rst:    $ rm spkg/installed/mpir* spkg/installed/atlas*
src/doc/en/faq/faq-general.rst:`MPIR <http://www.mpir.org>`_,
src/sage/ext_data/valgrind/sage-additional.supp:   fun:sage_mpir_malloc
src/sage/ext_data/valgrind/sage-additional.supp:   mpir_realloc
src/sage/ext_data/valgrind/sage-additional.supp:   fun:sage_mpir_realloc
src/sage/ext/memory.pyx:    sage: 2^(2^63-2)      # optional - mpir
src/sage/all.py:    # Free globally allocated mpir integers.
```
taking care of this now.

---
New commits:



---

archive/issue_comments_492534.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-26T09:49:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492534",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_492535.json:
```json
{
    "body": "<a id='comment:34'></a>Looking good. Let's merge #30350 (ATLAS removal) to resolve merge conflicts in the documentation and other places",
    "created_at": "2021-09-26T18:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492535",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:34'></a>Looking good. Let's merge #30350 (ATLAS removal) to resolve merge conflicts in the documentation and other places



---

archive/issue_comments_492536.json:
```json
{
    "body": "<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-26T18:37:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492536",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_492537.json:
```json
{
    "body": "<a id='comment:37'></a>there were a couple of docbuild errors in FAQs  in my branch. Should merge the  latest commit from `u/dimpase/remove_package_mpir`",
    "created_at": "2021-09-26T19:20:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492537",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:37'></a>there were a couple of docbuild errors in FAQs  in my branch. Should merge the  latest commit from `u/dimpase/remove_package_mpir`



---

archive/issue_comments_492538.json:
```json
{
    "body": "<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-26T19:56:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492538",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_492539.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-09-26T20:49:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492539",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_492540.json:
```json
{
    "body": "<a id='comment:39'></a>OK, this works.",
    "created_at": "2021-09-26T20:49:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492540",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:39'></a>OK, this works.



---

archive/issue_comments_492541.json:
```json
{
    "body": "<a id='comment:40'></a>Merge conflict",
    "created_at": "2021-10-10T10:20:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492541",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:40'></a>Merge conflict



---

archive/issue_comments_492542.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-10-10T10:20:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492542",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_492543.json:
```json
{
    "body": "<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-10T17:40:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492543",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_492544.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2021-10-10T17:41:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492544",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_492545.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-10-13T22:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492545",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_086308.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-13T22:51:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32549#event-86308"
}
```



---

archive/issue_comments_492546.json:
```json
{
    "body": "<a id='comment:44'></a>> perhaps should we ask to the people involved in MPIR how they see the future of MPIR ?\n\n\nBill also told me recently that MPIR is not going forward at this point for a combination of reasons.  +1 to this ticket.",
    "created_at": "2021-10-20T18:04:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32549",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32549#issuecomment-492546",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:44'></a>> perhaps should we ask to the people involved in MPIR how they see the future of MPIR ?


Bill also told me recently that MPIR is not going forward at this point for a combination of reasons.  +1 to this ticket.
