# Issue 32184: derivative of symbolic integration with Infinity limit fails

archive/issues_031947.json:
```json
{
    "assignees": [],
    "body": "\n```\nsage: x,y = var(\"x,y\")\nsage: f = integrate(-2*(2*(x - floor(x))^3 - 3*(x - floor(x))^2 + x - floor(x))*(8*x^3/(x^2 + y^2)^5 - 3*x/(x^2 + y^2)^4), x, 1, +Infinity, hold=True)\nsage: f \nintegrate(-2*(2*(x - floor(x))^3 - 3*(x - floor(x))^2 + x - floor(x))*(8*x^3/(x^2 + y^2)^5 - 3*x/(x^2 + y^2)^4), x, 1, +Infinity)\nsage: assume(y>0)\nsage: f.diff(y)\n```\n\n\n```\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n<ipython-input-3-f1ce8deb4ff7> in <module>\n      1 assume(y>Integer(0))\n----> 2 f.diff(y)\n\n/usr3/articles/sagemath_docker_build/sage/local/lib/python3.9/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.derivative (build/cythonized/sage/symbolic/expression.cpp:27215)()\n   4361             ValueError: No differentiation variable specified.\n   4362         \"\"\"\n-> 4363         return multi_derivative(self, args)\n   4364 \n   4365     diff = differentiate = derivative\n\n/usr3/articles/sagemath_docker_build/sage/local/lib/python3.9/site-packages/sage/misc/derivative.pyx in sage.misc.derivative.multi_derivative (build/cythonized/sage/misc/derivative.c:3176)()\n    220 \n    221     for arg in derivative_parse(args):\n--> 222         F = F._derivative(arg)\n    223     return F\n    224 \n\n/usr3/articles/sagemath_docker_build/sage/local/lib/python3.9/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._derivative (build/cythonized/sage/symbolic/expression.cpp:27738)()\n   4433         sig_on()\n   4434         try:\n-> 4435             x = self._gobj.diff(ex_to_symbol(symbol._gobj), deg)\n   4436         finally:\n   4437             sig_off()\n\n/usr3/articles/sagemath_docker_build/sage/local/lib/python3.9/site-packages/sage/symbolic/integration/integral.py in _tderivative_(self, f, x, a, b, diff_param)\n    294             ans = SR.zero()\n    295         if hasattr(b, 'diff'):\n--> 296             ans += f.subs(x == b) * b.diff(diff_param)\n    297         if hasattr(a, 'diff'):\n    298             ans -= f.subs(x == a) * a.diff(diff_param)\n\n/usr3/articles/sagemath_docker_build/sage/local/lib/python3.9/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.substitute (build/cythonized/sage/symbolic/expression.cpp:32201)()\n   5579             smap.insert(make_pair((<Expression>self.coerce_in(k))._gobj,\n   5580                                   (<Expression>self.coerce_in(v))._gobj))\n-> 5581         res = self._gobj.subs_map(smap, 0)\n   5582         return new_Expression_from_GEx(self._parent, res)\n   5583 \n\nRuntimeError: indeterminate expression: 0 * infinity encountered.\n\n```\n\n\n\n**Assignee:** @daju1\n\n**CC:**  @EmmanuelCharpentier @slel @mkoeppe\n\n**Branch:** [u/gh-daju1/derivative_of_symbolic_integration_with_infinity_limit_fails](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-daju1/derivative_of_symbolic_integration_with_infinity_limit_fails)\n\n**Commit:** [fd5cf30688a372d3bbba9d15139b00703500864d](https://github.com/sagemath/sagetrac-mirror/commit/fd5cf30688a372d3bbba9d15139b00703500864d)\n\n**Reviewer:** Matthias Koeppe\n\n**Author:** Alexey Drozdov\n\nIssue created by migration from https://trac.sagemath.org/ticket/32184\n\n",
    "created_at": "2021-07-11T21:53:58Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20symbolics",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/needs%20review"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "derivative of symbolic integration with Infinity limit fails",
    "type": "issue",
    "updated_at": "2022-09-19T18:58:47Z",
    "url": "https://github.com/sagemath/sage/issues/32184",
    "user": "https://github.com/daju1"
}
```

```
sage: x,y = var("x,y")
sage: f = integrate(-2*(2*(x - floor(x))^3 - 3*(x - floor(x))^2 + x - floor(x))*(8*x^3/(x^2 + y^2)^5 - 3*x/(x^2 + y^2)^4), x, 1, +Infinity, hold=True)
sage: f 
integrate(-2*(2*(x - floor(x))^3 - 3*(x - floor(x))^2 + x - floor(x))*(8*x^3/(x^2 + y^2)^5 - 3*x/(x^2 + y^2)^4), x, 1, +Infinity)
sage: assume(y>0)
sage: f.diff(y)
```


```
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
<ipython-input-3-f1ce8deb4ff7> in <module>
      1 assume(y>Integer(0))
----> 2 f.diff(y)

/usr3/articles/sagemath_docker_build/sage/local/lib/python3.9/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.derivative (build/cythonized/sage/symbolic/expression.cpp:27215)()
   4361             ValueError: No differentiation variable specified.
   4362         """
-> 4363         return multi_derivative(self, args)
   4364 
   4365     diff = differentiate = derivative

/usr3/articles/sagemath_docker_build/sage/local/lib/python3.9/site-packages/sage/misc/derivative.pyx in sage.misc.derivative.multi_derivative (build/cythonized/sage/misc/derivative.c:3176)()
    220 
    221     for arg in derivative_parse(args):
--> 222         F = F._derivative(arg)
    223     return F
    224 

/usr3/articles/sagemath_docker_build/sage/local/lib/python3.9/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._derivative (build/cythonized/sage/symbolic/expression.cpp:27738)()
   4433         sig_on()
   4434         try:
-> 4435             x = self._gobj.diff(ex_to_symbol(symbol._gobj), deg)
   4436         finally:
   4437             sig_off()

/usr3/articles/sagemath_docker_build/sage/local/lib/python3.9/site-packages/sage/symbolic/integration/integral.py in _tderivative_(self, f, x, a, b, diff_param)
    294             ans = SR.zero()
    295         if hasattr(b, 'diff'):
--> 296             ans += f.subs(x == b) * b.diff(diff_param)
    297         if hasattr(a, 'diff'):
    298             ans -= f.subs(x == a) * a.diff(diff_param)

/usr3/articles/sagemath_docker_build/sage/local/lib/python3.9/site-packages/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.substitute (build/cythonized/sage/symbolic/expression.cpp:32201)()
   5579             smap.insert(make_pair((<Expression>self.coerce_in(k))._gobj,
   5580                                   (<Expression>self.coerce_in(v))._gobj))
-> 5581         res = self._gobj.subs_map(smap, 0)
   5582         return new_Expression_from_GEx(self._parent, res)
   5583 

RuntimeError: indeterminate expression: 0 * infinity encountered.

```



**Assignee:** @daju1

**CC:**  @EmmanuelCharpentier @slel @mkoeppe

**Branch:** [u/gh-daju1/derivative_of_symbolic_integration_with_infinity_limit_fails](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-daju1/derivative_of_symbolic_integration_with_infinity_limit_fails)

**Commit:** [fd5cf30688a372d3bbba9d15139b00703500864d](https://github.com/sagemath/sagetrac-mirror/commit/fd5cf30688a372d3bbba9d15139b00703500864d)

**Reviewer:** Matthias Koeppe

**Author:** Alexey Drozdov

Issue created by migration from https://trac.sagemath.org/ticket/32184





---

archive/issue_events_390846.json:
```json
{
    "actor": "https://github.com/daju1",
    "created_at": "2021-07-11T21:53:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390846"
}
```



---

archive/issue_events_390847.json:
```json
{
    "actor": "https://github.com/daju1",
    "created_at": "2021-07-11T21:53:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20symbolics",
    "label_color": "08517b",
    "label_name": "component: symbolics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390847"
}
```



---

archive/issue_events_390848.json:
```json
{
    "actor": "https://github.com/daju1",
    "created_at": "2021-07-11T21:53:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "008080",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390848"
}
```



---

archive/issue_comments_521214.json:
```json
{
    "body": "**Attachment:** [derivative of symbolic integration with Infinity limit fails.ipynb.gz](https://github.com/sagemath/sage/files/ticket32184/5632a8fcbb059177d07d4841c9f4fa2d.gz)",
    "created_at": "2021-07-11T21:54:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521214",
    "user": "https://github.com/daju1"
}
```

**Attachment:** [derivative of symbolic integration with Infinity limit fails.ipynb.gz](https://github.com/sagemath/sage/files/ticket32184/5632a8fcbb059177d07d4841c9f4fa2d.gz)



---

archive/issue_comments_521215.json:
```json
{
    "body": "**Assignee:** @daju1",
    "created_at": "2021-07-11T21:55:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521215",
    "user": "https://github.com/daju1"
}
```

**Assignee:** @daju1



---

archive/issue_comments_521216.json:
```json
{
    "body": "**Branch:** [u/gh-daju1/derivative_of_symbolic_integration_with_infinity_limit_fails](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-daju1/derivative_of_symbolic_integration_with_infinity_limit_fails)",
    "created_at": "2021-07-12T11:55:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521216",
    "user": "https://github.com/daju1"
}
```

**Branch:** [u/gh-daju1/derivative_of_symbolic_integration_with_infinity_limit_fails](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-daju1/derivative_of_symbolic_integration_with_infinity_limit_fails)



---

archive/issue_comments_521217.json:
```json
{
    "body": "**Commit:** [c5dce368cf6156f8bd336e422a9ab2343af06f31](https://github.com/sagemath/sagetrac-mirror/commit/c5dce368cf6156f8bd336e422a9ab2343af06f31)",
    "created_at": "2021-07-12T11:58:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521217",
    "user": "https://github.com/daju1"
}
```

**Commit:** [c5dce368cf6156f8bd336e422a9ab2343af06f31](https://github.com/sagemath/sagetrac-mirror/commit/c5dce368cf6156f8bd336e422a9ab2343af06f31)



---

archive/issue_comments_521218.json:
```json
{
    "body": "<a id='comment:3'>**Comment 3:**</a>\n**Attachment:** [derivative of symbolic integration with Infinity limit fail fixed.ipynb.gz](https://github.com/sagemath/sage/files/ticket32184/56ad07b83adf03b4c332ec7fe86a10d0.gz)\n\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c5dce368cf6156f8bd336e422a9ab2343af06f31\">c5dce36</a></td><td><code>Trac #32184: derivative of symbolic integration with Infinity limit fails</code></td></tr></table>\n",
    "created_at": "2021-07-12T11:58:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521218",
    "user": "https://github.com/daju1"
}
```

<a id='comment:3'>**Comment 3:**</a>
**Attachment:** [derivative of symbolic integration with Infinity limit fail fixed.ipynb.gz](https://github.com/sagemath/sage/files/ticket32184/56ad07b83adf03b4c332ec7fe86a10d0.gz)

**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c5dce368cf6156f8bd336e422a9ab2343af06f31">c5dce36</a></td><td><code>Trac #32184: derivative of symbolic integration with Infinity limit fails</code></td></tr></table>




---

archive/issue_events_390849.json:
```json
{
    "actor": "https://github.com/daju1",
    "created_at": "2021-07-12T11:58:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390849"
}
```



---

archive/issue_comments_521219.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\nUsing this commit I have successful derivative of symbolic integration with Infinity limit\n\n```\nsage: f.diff(y)\n16*integrate((2*(x - floor(x))^3 - 3*(x - floor(x))^2 + x - floor(x))*(10*x^3*y/(x^2 + y^2)^6 - 3*x*y/(x^2 + y^2)^5), x, 1, +Infinity)\n```",
    "created_at": "2021-07-12T11:58:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521219",
    "user": "https://github.com/daju1"
}
```

<a id='comment:4'>**Comment 4:**</a>
Using this commit I have successful derivative of symbolic integration with Infinity limit

```
sage: f.diff(y)
16*integrate((2*(x - floor(x))^3 - 3*(x - floor(x))^2 + x - floor(x))*(10*x^3*y/(x^2 + y^2)^6 - 3*x*y/(x^2 + y^2)^5), x, 1, +Infinity)
```



---

archive/issue_comments_521220.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\nNeeds doctests - https://www.sagemath.org/git-developer-guide/coding_basics.html#writing-testable-examples",
    "created_at": "2021-07-12T18:34:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521220",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'>**Comment 5:**</a>
Needs doctests - https://www.sagemath.org/git-developer-guide/coding_basics.html#writing-testable-examples



---

archive/issue_comments_521221.json:
```json
{
    "body": "**Author:** Alexey Drozdov",
    "created_at": "2021-07-12T18:34:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521221",
    "user": "https://github.com/mkoeppe"
}
```

**Author:** Alexey Drozdov



---

archive/issue_events_390850.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-12T18:37:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390850"
}
```



---

archive/issue_events_390851.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-12T18:37:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390851"
}
```



---

archive/issue_comments_521222.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/42fccb26b37b5f7abb4a0f60953df07add5a4f0f\">42fccb2</a></td><td><code>Trac: #32184 testable example added</code></td></tr></table>\n",
    "created_at": "2021-07-15T20:23:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521222",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:7'>**Comment 7:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/42fccb26b37b5f7abb4a0f60953df07add5a4f0f">42fccb2</a></td><td><code>Trac: #32184 testable example added</code></td></tr></table>




---

archive/issue_comments_521223.json:
```json
{
    "body": "**Changing commit** from \"[c5dce368cf6156f8bd336e422a9ab2343af06f31](https://github.com/sagemath/sagetrac-mirror/commit/c5dce368cf6156f8bd336e422a9ab2343af06f31)\" to \"[42fccb26b37b5f7abb4a0f60953df07add5a4f0f](https://github.com/sagemath/sagetrac-mirror/commit/42fccb26b37b5f7abb4a0f60953df07add5a4f0f)\".",
    "created_at": "2021-07-15T20:23:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521223",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[c5dce368cf6156f8bd336e422a9ab2343af06f31](https://github.com/sagemath/sagetrac-mirror/commit/c5dce368cf6156f8bd336e422a9ab2343af06f31)" to "[42fccb26b37b5f7abb4a0f60953df07add5a4f0f](https://github.com/sagemath/sagetrac-mirror/commit/42fccb26b37b5f7abb4a0f60953df07add5a4f0f)".



---

archive/issue_events_390852.json:
```json
{
    "actor": "https://github.com/daju1",
    "created_at": "2021-07-15T20:24:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390852"
}
```



---

archive/issue_events_390853.json:
```json
{
    "actor": "https://github.com/daju1",
    "created_at": "2021-07-15T20:24:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390853"
}
```



---

archive/issue_comments_521224.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nI don't know this code very well, but I would suggest replacing `b.diff(diff_param) != 0` by `not b.diff(diff_param).is_trivial_zero()` if that already fixes the example.\n\nAlso this markup\n\n```\n+        :trac:`32184 fixed::\n+            sage: x,y = var(\"x,y\")\n```\nis not correct, there needs to be a backquote after the ticket number and an empty line after `::`. Best to build the HTML documentation and inspect the output to make sure it is OK.",
    "created_at": "2021-07-16T17:32:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521224",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'>**Comment 9:**</a>
I don't know this code very well, but I would suggest replacing `b.diff(diff_param) != 0` by `not b.diff(diff_param).is_trivial_zero()` if that already fixes the example.

Also this markup

```
+        :trac:`32184 fixed::
+            sage: x,y = var("x,y")
```
is not correct, there needs to be a backquote after the ticket number and an empty line after `::`. Best to build the HTML documentation and inspect the output to make sure it is OK.



---

archive/issue_comments_521225.json:
```json
{
    "body": "**Changing commit** from \"[42fccb26b37b5f7abb4a0f60953df07add5a4f0f](https://github.com/sagemath/sagetrac-mirror/commit/42fccb26b37b5f7abb4a0f60953df07add5a4f0f)\" to \"[c1f1d15eeeb3b2acb6c905a3cd4e9dd8fab2a45e](https://github.com/sagemath/sagetrac-mirror/commit/c1f1d15eeeb3b2acb6c905a3cd4e9dd8fab2a45e)\".",
    "created_at": "2021-07-19T13:55:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521225",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[42fccb26b37b5f7abb4a0f60953df07add5a4f0f](https://github.com/sagemath/sagetrac-mirror/commit/42fccb26b37b5f7abb4a0f60953df07add5a4f0f)" to "[c1f1d15eeeb3b2acb6c905a3cd4e9dd8fab2a45e](https://github.com/sagemath/sagetrac-mirror/commit/c1f1d15eeeb3b2acb6c905a3cd4e9dd8fab2a45e)".



---

archive/issue_comments_521226.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c1f1d15eeeb3b2acb6c905a3cd4e9dd8fab2a45e\">c1f1d15</a></td><td><code>Trac: #32184 testable example fixed</code></td></tr></table>\n",
    "created_at": "2021-07-19T13:55:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521226",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:10'>**Comment 10:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c1f1d15eeeb3b2acb6c905a3cd4e9dd8fab2a45e">c1f1d15</a></td><td><code>Trac: #32184 testable example fixed</code></td></tr></table>




---

archive/issue_comments_521227.json:
```json
{
    "body": "**Changing commit** from \"[c1f1d15eeeb3b2acb6c905a3cd4e9dd8fab2a45e](https://github.com/sagemath/sagetrac-mirror/commit/c1f1d15eeeb3b2acb6c905a3cd4e9dd8fab2a45e)\" to \"[78e4c1ef4f48d6d89b13f8c411628f8655f87bcd](https://github.com/sagemath/sagetrac-mirror/commit/78e4c1ef4f48d6d89b13f8c411628f8655f87bcd)\".",
    "created_at": "2021-07-22T14:51:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521227",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[c1f1d15eeeb3b2acb6c905a3cd4e9dd8fab2a45e](https://github.com/sagemath/sagetrac-mirror/commit/c1f1d15eeeb3b2acb6c905a3cd4e9dd8fab2a45e)" to "[78e4c1ef4f48d6d89b13f8c411628f8655f87bcd](https://github.com/sagemath/sagetrac-mirror/commit/78e4c1ef4f48d6d89b13f8c411628f8655f87bcd)".



---

archive/issue_comments_521228.json:
```json
{
    "body": "<a id='comment:11'>**Comment 11:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/78e4c1ef4f48d6d89b13f8c411628f8655f87bcd\">78e4c1e</a></td><td><code>Trac: #32184 replacing b.diff(diff_param) != 0 by not b.diff(diff_param).is_trivial_zero() fixes the example</code></td></tr></table>\n",
    "created_at": "2021-07-22T14:51:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521228",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:11'>**Comment 11:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/78e4c1ef4f48d6d89b13f8c411628f8655f87bcd">78e4c1e</a></td><td><code>Trac: #32184 replacing b.diff(diff_param) != 0 by not b.diff(diff_param).is_trivial_zero() fixes the example</code></td></tr></table>




---

archive/issue_comments_521229.json:
```json
{
    "body": "<a id='comment:13'>**Comment 13:**</a>\nThe HTML documentation is OK now too",
    "created_at": "2021-07-22T14:53:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521229",
    "user": "https://github.com/daju1"
}
```

<a id='comment:13'>**Comment 13:**</a>
The HTML documentation is OK now too



---

archive/issue_events_390854.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-22T15:57:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390854"
}
```



---

archive/issue_events_390855.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-22T15:57:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390855"
}
```



---

archive/issue_comments_521230.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\nWith this version I am getting:\n\n```\nTrying (line 308):    f.diff(y)\nExpecting:\n    16*integrate((2*(x - floor(x))^3 - 3*(x - floor(x))^2 + x - floor(x))*(10*x^3*y/(x^2 + y^2)^6 - 3*x*y/(x^2 + y^2)^5), x, 1, +Infinity)\n**********************************************************************\nFile \"src/sage/symbolic/integration/integral.py\", line 308, in sage.symbolic.integration.integral.DefiniteIntegral._tderivative_\nFailed example:\n    f.diff(y)\nExpected:\n    16*integrate((2*(x - floor(x))^3 - 3*(x - floor(x))^2 + x - floor(x))*(10*x^3*y/(x^2 + y^2)^6 - 3*x*y/(x^2 + y^2)^5), x, 1, +Infinity)\nGot:\n    16*y*(integrate(14*x^6/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-6*x^4*y^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-42*x^5*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(18*x^3*y^2*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(42*x^4*floor(x)^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-18*x^2*y^2*floor(x)^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-14*x^3*floor(x)^3/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(6*x*y^2*floor(x)^3/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-21*x^5/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(9*x^3*y^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(42*x^4*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-18*x^2*y^2*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-21*x^3*floor(x)^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(9*x*y^2*floor(x)^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(7*x^4/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-3*x^2*y^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-7*x^3*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(3*x*y^2*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity))\n```",
    "created_at": "2021-07-22T15:57:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521230",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'>**Comment 14:**</a>
With this version I am getting:

```
Trying (line 308):    f.diff(y)
Expecting:
    16*integrate((2*(x - floor(x))^3 - 3*(x - floor(x))^2 + x - floor(x))*(10*x^3*y/(x^2 + y^2)^6 - 3*x*y/(x^2 + y^2)^5), x, 1, +Infinity)
**********************************************************************
File "src/sage/symbolic/integration/integral.py", line 308, in sage.symbolic.integration.integral.DefiniteIntegral._tderivative_
Failed example:
    f.diff(y)
Expected:
    16*integrate((2*(x - floor(x))^3 - 3*(x - floor(x))^2 + x - floor(x))*(10*x^3*y/(x^2 + y^2)^6 - 3*x*y/(x^2 + y^2)^5), x, 1, +Infinity)
Got:
    16*y*(integrate(14*x^6/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-6*x^4*y^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-42*x^5*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(18*x^3*y^2*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(42*x^4*floor(x)^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-18*x^2*y^2*floor(x)^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-14*x^3*floor(x)^3/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(6*x*y^2*floor(x)^3/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-21*x^5/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(9*x^3*y^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(42*x^4*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-18*x^2*y^2*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-21*x^3*floor(x)^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(9*x*y^2*floor(x)^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(7*x^4/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-3*x^2*y^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-7*x^3*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(3*x*y^2*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity))
```



---

archive/issue_comments_521231.json:
```json
{
    "body": "**Reviewer:** Matthias Koeppe",
    "created_at": "2021-07-22T15:57:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521231",
    "user": "https://github.com/mkoeppe"
}
```

**Reviewer:** Matthias Koeppe



---

archive/issue_comments_521232.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\nHi, Matthias Koeppe! \nyou have very strange result as for me: on my code stack I have\n\n\n```\n./sage -t --long src/sage/symbolic/integration/integral.py\ntoo few successful tests, not using stored timings\nRunning doctests with ID 2021-07-26-13-15-25-32b680b2.\nGit branch: t/32184/derivative_of_symbolic_integration_with_infinity_limit_fails\nUsing --optional=build,debian,dochtml,pip,sage,sage_spkg\nDoctesting 1 file.\nsage -t --long --random-seed=0 src/sage/symbolic/integration/integral.py\n    [221 tests, 33.23 s]\n----------------------------------------------------------------------\nAll tests passed!\n```\n\nInteresting, can you provide your git status and git log (for example in the attachment).\nThanks",
    "created_at": "2021-07-26T13:35:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521232",
    "user": "https://github.com/daju1"
}
```

<a id='comment:15'>**Comment 15:**</a>
Hi, Matthias Koeppe! 
you have very strange result as for me: on my code stack I have


```
./sage -t --long src/sage/symbolic/integration/integral.py
too few successful tests, not using stored timings
Running doctests with ID 2021-07-26-13-15-25-32b680b2.
Git branch: t/32184/derivative_of_symbolic_integration_with_infinity_limit_fails
Using --optional=build,debian,dochtml,pip,sage,sage_spkg
Doctesting 1 file.
sage -t --long --random-seed=0 src/sage/symbolic/integration/integral.py
    [221 tests, 33.23 s]
----------------------------------------------------------------------
All tests passed!
```

Interesting, can you provide your git status and git log (for example in the attachment).
Thanks



---

archive/issue_comments_521233.json:
```json
{
    "body": "**Attachment:** [track_32184_git_status.txt](https://github.com/sagemath/sage/files/ticket32184/track_32184_git_status.txt)",
    "created_at": "2021-07-26T13:37:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521233",
    "user": "https://github.com/daju1"
}
```

**Attachment:** [track_32184_git_status.txt](https://github.com/sagemath/sage/files/ticket32184/track_32184_git_status.txt)



---

archive/issue_events_390856.json:
```json
{
    "actor": "https://github.com/daju1",
    "created_at": "2021-08-06T18:28:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390856"
}
```



---

archive/issue_events_390857.json:
```json
{
    "actor": "https://github.com/daju1",
    "created_at": "2021-08-06T18:28:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390857"
}
```



---

archive/issue_events_390858.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2021-08-06T19:35:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390858"
}
```



---

archive/issue_events_390859.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2021-08-06T19:35:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390859"
}
```



---

archive/issue_comments_521234.json:
```json
{
    "body": "<a id='comment:17'>**Comment 17:**</a>\nA patchbot confirms the error in [comment:14](#comment%3A14), so the ticket needs work, not review. The successful log that was posted seems to use 9.4b4, not the current sage version, which is 9.4rc0.",
    "created_at": "2021-08-06T19:35:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521234",
    "user": "https://github.com/DaveWitteMorris"
}
```

<a id='comment:17'>**Comment 17:**</a>
A patchbot confirms the error in [comment:14](#comment%3A14), so the ticket needs work, not review. The successful log that was posted seems to use 9.4b4, not the current sage version, which is 9.4rc0.



---

archive/issue_comments_521235.json:
```json
{
    "body": "<a id='comment:18'>**Comment 18:**</a>\nOk, thanks gh-DaveWitteMorris\n\nI have reproduced the issue just by merging of my current branch with develop branch\n\n```\n\n**********************************************************************\nFile \"src/sage/symbolic/integration/integral.py\", line 308, in sage.symbolic.integration.integral.DefiniteIntegral._tderivative_\nFailed example:\n    f.diff(y)\nExpected:\n    16*integrate((2*(x - floor(x))^3 - 3*(x - floor(x))^2 + x - floor(x))*(10*x^3*y/(x^2 + y^2)^6 - 3*x*y/(x^2 + y^2)^5), x, 1, +Infinity)\nGot:\n    DefiniteIntegral integrator <function maxima_integrator at 0x7fc2a8ed8040>\n    DefiniteIntegral integrator <function giac_integrator at 0x7fc2a8ed8280>\n    DefiniteIntegral integrator <function sympy_integrator at 0x7fc2a8ed80d0>\n    16*y*(integrate(14*x^6/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-6*x^4*y^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-42*x^5*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(18*x^3*y^2*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(42*x^4*floor(x)^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-18*x^2*y^2*floor(x)^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-14*x^3*floor(x)^3/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(6*x*y^2*floor(x)^3/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-21*x^5/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(9*x^3*y^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(42*x^4*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-18*x^2*y^2*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-21*x^3*floor(x)^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(9*x*y^2*floor(x)^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(7*x^4/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-3*x^2*y^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-7*x^3*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(3*x*y^2*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity))\n**********************************************************************\n```\n\nSeems like we have new behavior of sympy_integrator in the develop branch",
    "created_at": "2021-08-09T08:56:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521235",
    "user": "https://github.com/daju1"
}
```

<a id='comment:18'>**Comment 18:**</a>
Ok, thanks gh-DaveWitteMorris

I have reproduced the issue just by merging of my current branch with develop branch

```

**********************************************************************
File "src/sage/symbolic/integration/integral.py", line 308, in sage.symbolic.integration.integral.DefiniteIntegral._tderivative_
Failed example:
    f.diff(y)
Expected:
    16*integrate((2*(x - floor(x))^3 - 3*(x - floor(x))^2 + x - floor(x))*(10*x^3*y/(x^2 + y^2)^6 - 3*x*y/(x^2 + y^2)^5), x, 1, +Infinity)
Got:
    DefiniteIntegral integrator <function maxima_integrator at 0x7fc2a8ed8040>
    DefiniteIntegral integrator <function giac_integrator at 0x7fc2a8ed8280>
    DefiniteIntegral integrator <function sympy_integrator at 0x7fc2a8ed80d0>
    16*y*(integrate(14*x^6/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-6*x^4*y^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-42*x^5*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(18*x^3*y^2*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(42*x^4*floor(x)^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-18*x^2*y^2*floor(x)^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-14*x^3*floor(x)^3/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(6*x*y^2*floor(x)^3/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-21*x^5/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(9*x^3*y^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(42*x^4*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-18*x^2*y^2*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-21*x^3*floor(x)^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(9*x*y^2*floor(x)^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(7*x^4/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-3*x^2*y^2/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(-7*x^3*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity) + integrate(3*x*y^2*floor(x)/(x^12 + 6*x^10*y^2 + 15*x^8*y^4 + 20*x^6*y^6 + 15*x^4*y^8 + 6*x^2*y^10 + y^12), x, 1, +Infinity))
**********************************************************************
```

Seems like we have new behavior of sympy_integrator in the develop branch



---

archive/issue_comments_521236.json:
```json
{
    "body": "<a id='comment:19'>**Comment 19:**</a>\nMy investigation of git log have shown that behavior of integrator was changed in the ticket\n\nFix wrong selection of integrator in some cases\nhttps://trac.sagemath.org/ticket/32002\n\nby commit\n\nenhanced switching between integrators\n[https://github.com/sagemath/sagetrac-mirror/commit/bd7886996829e8edcf3d0054ed579f8115f487aa](https://github.com/sagemath/sagetrac-mirror/commit/bd7886996829e8edcf3d0054ed579f8115f487aa)",
    "created_at": "2021-08-09T19:04:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521236",
    "user": "https://github.com/daju1"
}
```

<a id='comment:19'>**Comment 19:**</a>
My investigation of git log have shown that behavior of integrator was changed in the ticket

Fix wrong selection of integrator in some cases
https://trac.sagemath.org/ticket/32002

by commit

enhanced switching between integrators
[https://github.com/sagemath/sagetrac-mirror/commit/bd7886996829e8edcf3d0054ed579f8115f487aa](https://github.com/sagemath/sagetrac-mirror/commit/bd7886996829e8edcf3d0054ed579f8115f487aa)



---

archive/issue_comments_521237.json:
```json
{
    "body": "**Changing commit** from \"[78e4c1ef4f48d6d89b13f8c411628f8655f87bcd](https://github.com/sagemath/sagetrac-mirror/commit/78e4c1ef4f48d6d89b13f8c411628f8655f87bcd)\" to \"[3d9ce1db01e7bafb7cbcfce27020410ee1782f37](https://github.com/sagemath/sagetrac-mirror/commit/3d9ce1db01e7bafb7cbcfce27020410ee1782f37)\".",
    "created_at": "2021-08-17T09:06:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521237",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[78e4c1ef4f48d6d89b13f8c411628f8655f87bcd](https://github.com/sagemath/sagetrac-mirror/commit/78e4c1ef4f48d6d89b13f8c411628f8655f87bcd)" to "[3d9ce1db01e7bafb7cbcfce27020410ee1782f37](https://github.com/sagemath/sagetrac-mirror/commit/3d9ce1db01e7bafb7cbcfce27020410ee1782f37)".



---

archive/issue_comments_521238.json:
```json
{
    "body": "<a id='comment:20'>**Comment 20:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b2416e2a6381413f239ed48b2ba003d928c2b7d2\">b2416e2</a></td><td><code>Merge tag '9.4.rc0' into t/32184/derivative_of_symbolic_integration_with_infinity_limit_fails</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3d9ce1db01e7bafb7cbcfce27020410ee1782f37\">3d9ce1d</a></td><td><code>Trac: #32184 testable example fixed according with enhanced switching between integrators</code></td></tr></table>\n",
    "created_at": "2021-08-17T09:06:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521238",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:20'>**Comment 20:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b2416e2a6381413f239ed48b2ba003d928c2b7d2">b2416e2</a></td><td><code>Merge tag '9.4.rc0' into t/32184/derivative_of_symbolic_integration_with_infinity_limit_fails</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3d9ce1db01e7bafb7cbcfce27020410ee1782f37">3d9ce1d</a></td><td><code>Trac: #32184 testable example fixed according with enhanced switching between integrators</code></td></tr></table>




---

archive/issue_comments_521239.json:
```json
{
    "body": "**Changing commit** from \"[3d9ce1db01e7bafb7cbcfce27020410ee1782f37](https://github.com/sagemath/sagetrac-mirror/commit/3d9ce1db01e7bafb7cbcfce27020410ee1782f37)\" to \"[fd5cf30688a372d3bbba9d15139b00703500864d](https://github.com/sagemath/sagetrac-mirror/commit/fd5cf30688a372d3bbba9d15139b00703500864d)\".",
    "created_at": "2021-08-17T10:11:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521239",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[3d9ce1db01e7bafb7cbcfce27020410ee1782f37](https://github.com/sagemath/sagetrac-mirror/commit/3d9ce1db01e7bafb7cbcfce27020410ee1782f37)" to "[fd5cf30688a372d3bbba9d15139b00703500864d](https://github.com/sagemath/sagetrac-mirror/commit/fd5cf30688a372d3bbba9d15139b00703500864d)".



---

archive/issue_comments_521240.json:
```json
{
    "body": "<a id='comment:21'>**Comment 21:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd5cf30688a372d3bbba9d15139b00703500864d\">fd5cf30</a></td><td><code>Merge tag '9.4.rc2' into t/32184/derivative_of_symbolic_integration_with_infinity_limit_fails</code></td></tr></table>\n",
    "created_at": "2021-08-17T10:11:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521240",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:21'>**Comment 21:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd5cf30688a372d3bbba9d15139b00703500864d">fd5cf30</a></td><td><code>Merge tag '9.4.rc2' into t/32184/derivative_of_symbolic_integration_with_infinity_limit_fails</code></td></tr></table>




---

archive/issue_events_390860.json:
```json
{
    "actor": "https://github.com/daju1",
    "created_at": "2021-08-17T10:43:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390860"
}
```



---

archive/issue_events_390861.json:
```json
{
    "actor": "https://github.com/daju1",
    "created_at": "2021-08-17T10:43:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390861"
}
```



---

archive/issue_events_390862.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390862"
}
```



---

archive/issue_events_390863.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390863"
}
```



---

archive/issue_events_390864.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390864"
}
```



---

archive/issue_events_390865.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390865"
}
```



---

archive/issue_comments_521241.json:
```json
{
    "body": "<a id='comment:24'>**Comment 24:**</a>\nStalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.",
    "created_at": "2021-12-18T19:53:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32184#issuecomment-521241",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'>**Comment 24:**</a>
Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.



---

archive/issue_events_390866.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390866"
}
```



---

archive/issue_events_390867.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390867"
}
```



---

archive/issue_events_390868.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390868"
}
```



---

archive/issue_events_390869.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32184",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32184#event-390869"
}
```
