# Issue 32332: using argparse in sage-runtests script

archive/issues_032095.json:
```json
{
    "body": "instead of the deprecated optparse\n\nThis was rather simple, but needs testing.\n\nalso full flake8 cleanup for the modified file\n\n**CC:**  @tscrim @slel @kliem @antonio-rojas\n\n**Branch:** [c87148b86fe0de11be68a0f01917e45b705e4c83](https://github.com/sagemath/sagetrac-mirror/commit/c87148b86fe0de11be68a0f01917e45b705e4c83)\n\n**Reviewer:** Travis Scrimshaw\n\n**Author:** Fr\u00e9d\u00e9ric Chapoton\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/32332\n\n",
    "closed_at": "2021-10-09T11:09:57Z",
    "created_at": "2021-08-04T07:54:04Z",
    "labels": [
        "component: scripts"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "using argparse in sage-runtests script",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32332",
    "user": "https://github.com/fchapoton"
}
```
instead of the deprecated optparse

This was rather simple, but needs testing.

also full flake8 cleanup for the modified file

**CC:**  @tscrim @slel @kliem @antonio-rojas

**Branch:** [c87148b86fe0de11be68a0f01917e45b705e4c83](https://github.com/sagemath/sagetrac-mirror/commit/c87148b86fe0de11be68a0f01917e45b705e4c83)

**Reviewer:** Travis Scrimshaw

**Author:** Frédéric Chapoton

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/32332





---

archive/issue_comments_643860.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n instead of the deprecated optparse\n+\n+This was rather simple, but needs testing.\n+\n+also full flake8 cleanup for the modified file\n``````\n",
    "created_at": "2021-08-04T07:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643860",
    "user": "https://github.com/fchapoton"
}
```


**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,5 @@
 instead of the deprecated optparse
+
+This was rather simple, but needs testing.
+
+also full flake8 cleanup for the modified file
``````




---

archive/issue_comments_643861.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2021-08-04T07:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643861",
    "user": "https://github.com/fchapoton"
}
```


**Changing status** from new to needs_review.



---

archive/issue_comments_643862.json:
```json
{
    "body": "**Branch:** [u/chapoton/32332](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/32332)",
    "created_at": "2021-08-04T07:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643862",
    "user": "https://github.com/fchapoton"
}
```


**Branch:** [u/chapoton/32332](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/32332)



---

archive/issue_comments_643863.json:
```json
{
    "body": "**Commit:** [32d10d1ab718b78cbcfefaf8f976a8f72865bdc8](https://github.com/sagemath/sagetrac-mirror/commit/32d10d1ab718b78cbcfefaf8f976a8f72865bdc8)",
    "created_at": "2021-08-04T07:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643863",
    "user": "https://github.com/fchapoton"
}
```


**Commit:** [32d10d1ab718b78cbcfefaf8f976a8f72865bdc8](https://github.com/sagemath/sagetrac-mirror/commit/32d10d1ab718b78cbcfefaf8f976a8f72865bdc8)



---

archive/issue_comments_643864.json:
```json
{
    "body": "<a id='comment:1'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/32d10d1ab718b78cbcfefaf8f976a8f72865bdc8\">32d10d1</a></td><td><code>use argparse in sage-runtests</code></td></tr></table>\n",
    "created_at": "2021-08-04T07:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643864",
    "user": "https://github.com/fchapoton"
}
```


<a id='comment:1'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/32d10d1ab718b78cbcfefaf8f976a8f72865bdc8">32d10d1</a></td><td><code>use argparse in sage-runtests</code></td></tr></table>




---

archive/issue_comments_643865.json:
```json
{
    "body": "**Changing commit** from \"[32d10d1ab718b78cbcfefaf8f976a8f72865bdc8](https://github.com/sagemath/sagetrac-mirror/commit/32d10d1ab718b78cbcfefaf8f976a8f72865bdc8)\" to \"[8c92fc443c0f2c816564d804cb3ac893d5889344](https://github.com/sagemath/sagetrac-mirror/commit/8c92fc443c0f2c816564d804cb3ac893d5889344)\".",
    "created_at": "2021-08-04T08:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643865",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[32d10d1ab718b78cbcfefaf8f976a8f72865bdc8](https://github.com/sagemath/sagetrac-mirror/commit/32d10d1ab718b78cbcfefaf8f976a8f72865bdc8)" to "[8c92fc443c0f2c816564d804cb3ac893d5889344](https://github.com/sagemath/sagetrac-mirror/commit/8c92fc443c0f2c816564d804cb3ac893d5889344)".



---

archive/issue_comments_643866.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8c92fc443c0f2c816564d804cb3ac893d5889344\">8c92fc4</a></td><td><code>simplify GCAction in sage-runtests</code></td></tr></table>\n",
    "created_at": "2021-08-04T08:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643866",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8c92fc443c0f2c816564d804cb3ac893d5889344">8c92fc4</a></td><td><code>simplify GCAction in sage-runtests</code></td></tr></table>




---

archive/issue_comments_643867.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2021-08-05T05:06:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643867",
    "user": "https://github.com/tscrim"
}
```


**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_643868.json:
```json
{
    "body": "<a id='comment:4'></a>\nLGTM as far as I can tell. A good ticket for the initial 9.5.beta0 release.",
    "created_at": "2021-08-05T05:06:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643868",
    "user": "https://github.com/tscrim"
}
```


<a id='comment:4'></a>
LGTM as far as I can tell. A good ticket for the initial 9.5.beta0 release.



---

archive/issue_events_096449.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-08-05T05:06:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32332#event-96449"
}
```




---

archive/issue_comments_643869.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2021-08-05T05:06:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643869",
    "user": "https://github.com/tscrim"
}
```


**Changing status** from needs_review to positive_review.



---

archive/issue_comments_643870.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2021-09-05T22:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643870",
    "user": "https://github.com/vbraun"
}
```


**Changing status** from positive_review to needs_work.



---

archive/issue_comments_643871.json:
```json
{
    "body": "<a id='comment:5'></a>\n\n```\nmake ptestlong\n[...]\nmake[1]: Leaving directory '/home/release/Sage'\n./sage -t -p --all --long --logfile=logs/ptestlong.log\nusage: sage -t [options] filenames\nsage-runtests: error: argument -p/--nthreads: expected one argument\nmake: *** [Makefile:201: ptestlong] Error 2\n```",
    "created_at": "2021-09-05T22:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643871",
    "user": "https://github.com/vbraun"
}
```


<a id='comment:5'></a>

```
make ptestlong
[...]
make[1]: Leaving directory '/home/release/Sage'
./sage -t -p --all --long --logfile=logs/ptestlong.log
usage: sage -t [options] filenames
sage-runtests: error: argument -p/--nthreads: expected one argument
make: *** [Makefile:201: ptestlong] Error 2
```



---

archive/issue_comments_643872.json:
```json
{
    "body": "**Changing commit** from \"[8c92fc443c0f2c816564d804cb3ac893d5889344](https://github.com/sagemath/sagetrac-mirror/commit/8c92fc443c0f2c816564d804cb3ac893d5889344)\" to \"[1d3dfc38b6f75c0783763e6aa52d568f359678e7](https://github.com/sagemath/sagetrac-mirror/commit/1d3dfc38b6f75c0783763e6aa52d568f359678e7)\".",
    "created_at": "2021-09-06T07:10:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643872",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[8c92fc443c0f2c816564d804cb3ac893d5889344](https://github.com/sagemath/sagetrac-mirror/commit/8c92fc443c0f2c816564d804cb3ac893d5889344)" to "[1d3dfc38b6f75c0783763e6aa52d568f359678e7](https://github.com/sagemath/sagetrac-mirror/commit/1d3dfc38b6f75c0783763e6aa52d568f359678e7)".



---

archive/issue_comments_643873.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0d148cbd7febda0df3b0336934d0703303cb4ccb\">0d148cb</a></td><td><code>Merge branch 'u/chapoton/32332' in 9.5.b0</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1d3dfc38b6f75c0783763e6aa52d568f359678e7\">1d3dfc3</a></td><td><code>fix for argparse when using -p</code></td></tr></table>\n",
    "created_at": "2021-09-06T07:10:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643873",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0d148cbd7febda0df3b0336934d0703303cb4ccb">0d148cb</a></td><td><code>Merge branch 'u/chapoton/32332' in 9.5.b0</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1d3dfc38b6f75c0783763e6aa52d568f359678e7">1d3dfc3</a></td><td><code>fix for argparse when using -p</code></td></tr></table>




---

archive/issue_comments_643874.json:
```json
{
    "body": "**Changing commit** from \"[1d3dfc38b6f75c0783763e6aa52d568f359678e7](https://github.com/sagemath/sagetrac-mirror/commit/1d3dfc38b6f75c0783763e6aa52d568f359678e7)\" to \"[4aa95ed2d10329290772e1b7e67354153e5c43e5](https://github.com/sagemath/sagetrac-mirror/commit/4aa95ed2d10329290772e1b7e67354153e5c43e5)\".",
    "created_at": "2021-09-06T07:18:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643874",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[1d3dfc38b6f75c0783763e6aa52d568f359678e7](https://github.com/sagemath/sagetrac-mirror/commit/1d3dfc38b6f75c0783763e6aa52d568f359678e7)" to "[4aa95ed2d10329290772e1b7e67354153e5c43e5](https://github.com/sagemath/sagetrac-mirror/commit/4aa95ed2d10329290772e1b7e67354153e5c43e5)".



---

archive/issue_comments_643875.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4aa95ed2d10329290772e1b7e67354153e5c43e5\">4aa95ed</a></td><td><code>another fix for the logfile</code></td></tr></table>\n",
    "created_at": "2021-09-06T07:18:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643875",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4aa95ed2d10329290772e1b7e67354153e5c43e5">4aa95ed</a></td><td><code>another fix for the logfile</code></td></tr></table>




---

archive/issue_comments_643876.json:
```json
{
    "body": "<a id='comment:8'></a>\nok, should be better now. I fixed the behaviour of -p and --logfile.",
    "created_at": "2021-09-06T07:18:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643876",
    "user": "https://github.com/fchapoton"
}
```


<a id='comment:8'></a>
ok, should be better now. I fixed the behaviour of -p and --logfile.



---

archive/issue_comments_643877.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2021-09-06T07:18:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643877",
    "user": "https://github.com/fchapoton"
}
```


**Changing status** from needs_work to needs_review.



---

archive/issue_comments_643878.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a458aa5b9513400251dd58858b199cdbb83f484\">8a458aa</a></td><td><code>better handling for -p</code></td></tr></table>\n",
    "created_at": "2021-09-06T07:20:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643878",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a458aa5b9513400251dd58858b199cdbb83f484">8a458aa</a></td><td><code>better handling for -p</code></td></tr></table>




---

archive/issue_comments_643879.json:
```json
{
    "body": "**Changing commit** from \"[4aa95ed2d10329290772e1b7e67354153e5c43e5](https://github.com/sagemath/sagetrac-mirror/commit/4aa95ed2d10329290772e1b7e67354153e5c43e5)\" to \"[8a458aa5b9513400251dd58858b199cdbb83f484](https://github.com/sagemath/sagetrac-mirror/commit/8a458aa5b9513400251dd58858b199cdbb83f484)\".",
    "created_at": "2021-09-06T07:20:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643879",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[4aa95ed2d10329290772e1b7e67354153e5c43e5](https://github.com/sagemath/sagetrac-mirror/commit/4aa95ed2d10329290772e1b7e67354153e5c43e5)" to "[8a458aa5b9513400251dd58858b199cdbb83f484](https://github.com/sagemath/sagetrac-mirror/commit/8a458aa5b9513400251dd58858b199cdbb83f484)".



---

archive/issue_comments_643880.json:
```json
{
    "body": "<a id='comment:10'></a>\nThere are still issues:\n\n```\n$ ./sage -btp src/sage/combinat/partition.py\n...\nsage-runtests: error: argument -p/--nthreads: invalid int value: 'src/sage/combinat/partition.py'\n$ ./sage -tp src/sage/combinat/partition.py \nusage: sage -t [options] filenames\nsage-runtests: error: argument -p/--nthreads: invalid int value: 'src/sage/combinat/partition.py'\n```\nI at least use these shortcuts a lot, but I guess that is not a strict requirement to have them fixed. It would just mean a lot of relearning for me.\n\nThese both continue to not work (so they don't need to be fixed)\n\n```\n$ ./sage -btp8 src/sage/combinat/partition.py \nError: unknown option: -btp8\n$ ./sage -tp8 src/sage/combinat/partition.py \nError: unknown option: -tp8\n```\nbut this now works (before it didn't):\n\n```\n$ ./sage -t -p8 src/sage/combinat/partition.py\n```",
    "created_at": "2021-09-10T02:58:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643880",
    "user": "https://github.com/tscrim"
}
```


<a id='comment:10'></a>
There are still issues:

```
$ ./sage -btp src/sage/combinat/partition.py
...
sage-runtests: error: argument -p/--nthreads: invalid int value: 'src/sage/combinat/partition.py'
$ ./sage -tp src/sage/combinat/partition.py 
usage: sage -t [options] filenames
sage-runtests: error: argument -p/--nthreads: invalid int value: 'src/sage/combinat/partition.py'
```
I at least use these shortcuts a lot, but I guess that is not a strict requirement to have them fixed. It would just mean a lot of relearning for me.

These both continue to not work (so they don't need to be fixed)

```
$ ./sage -btp8 src/sage/combinat/partition.py 
Error: unknown option: -btp8
$ ./sage -tp8 src/sage/combinat/partition.py 
Error: unknown option: -tp8
```
but this now works (before it didn't):

```
$ ./sage -t -p8 src/sage/combinat/partition.py
```



---

archive/issue_comments_643881.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2021-09-10T02:58:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643881",
    "user": "https://github.com/tscrim"
}
```


**Changing status** from needs_review to needs_work.



---

archive/issue_comments_643882.json:
```json
{
    "body": "<a id='comment:11'></a>\nThis may be difficult to fix. What's the point of tp alone, given that the default value for nthreads is 1 ? This amounts to say, parallel, but not parallel.\n\nNote that\n`./sage -tp 8 src/sage/combinat/partition.py`\nworks fine, and same for btp.\n\nThere is an inherent ambiguity in the options\n\n```\n-p filename.py\n```\nthat argparse cannot really handle, if I understand correctly.",
    "created_at": "2021-09-10T11:51:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643882",
    "user": "https://github.com/fchapoton"
}
```


<a id='comment:11'></a>
This may be difficult to fix. What's the point of tp alone, given that the default value for nthreads is 1 ? This amounts to say, parallel, but not parallel.

Note that
`./sage -tp 8 src/sage/combinat/partition.py`
works fine, and same for btp.

There is an inherent ambiguity in the options

```
-p filename.py
```
that argparse cannot really handle, if I understand correctly.



---

archive/issue_comments_643883.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b6f8162e7a78df3f7479c3305a243981587f7006\">b6f8162</a></td><td><code>little tweak in argparse for runtests</code></td></tr></table>\n",
    "created_at": "2021-09-10T12:14:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643883",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:12'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b6f8162e7a78df3f7479c3305a243981587f7006">b6f8162</a></td><td><code>little tweak in argparse for runtests</code></td></tr></table>




---

archive/issue_comments_643884.json:
```json
{
    "body": "**Changing commit** from \"[8a458aa5b9513400251dd58858b199cdbb83f484](https://github.com/sagemath/sagetrac-mirror/commit/8a458aa5b9513400251dd58858b199cdbb83f484)\" to \"[b6f8162e7a78df3f7479c3305a243981587f7006](https://github.com/sagemath/sagetrac-mirror/commit/b6f8162e7a78df3f7479c3305a243981587f7006)\".",
    "created_at": "2021-09-10T12:14:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643884",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[8a458aa5b9513400251dd58858b199cdbb83f484](https://github.com/sagemath/sagetrac-mirror/commit/8a458aa5b9513400251dd58858b199cdbb83f484)" to "[b6f8162e7a78df3f7479c3305a243981587f7006](https://github.com/sagemath/sagetrac-mirror/commit/b6f8162e7a78df3f7479c3305a243981587f7006)".



---

archive/issue_comments_643885.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [chapoton](#comment%3A11):\n> This may be difficult to fix. What's the point of tp alone, given that the default value for nthreads is 1 ? This amounts to say, parallel, but not parallel.\n\n\nFrom what I can tell, it does run it in parallel.",
    "created_at": "2021-09-10T21:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643885",
    "user": "https://github.com/tscrim"
}
```


<a id='comment:13'></a>
Replying to [chapoton](#comment%3A11):
> This may be difficult to fix. What's the point of tp alone, given that the default value for nthreads is 1 ? This amounts to say, parallel, but not parallel.


From what I can tell, it does run it in parallel.



---

archive/issue_comments_643886.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0c556408ff92446a738f13b421b21f997e3e5f13\">0c55640</a></td><td><code>use argparse in sage-runtests</code></td></tr></table>\n",
    "created_at": "2021-09-11T07:47:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643886",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0c556408ff92446a738f13b421b21f997e3e5f13">0c55640</a></td><td><code>use argparse in sage-runtests</code></td></tr></table>




---

archive/issue_comments_643887.json:
```json
{
    "body": "**Changing commit** from \"[b6f8162e7a78df3f7479c3305a243981587f7006](https://github.com/sagemath/sagetrac-mirror/commit/b6f8162e7a78df3f7479c3305a243981587f7006)\" to \"[0c556408ff92446a738f13b421b21f997e3e5f13](https://github.com/sagemath/sagetrac-mirror/commit/0c556408ff92446a738f13b421b21f997e3e5f13)\".",
    "created_at": "2021-09-11T07:47:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643887",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[b6f8162e7a78df3f7479c3305a243981587f7006](https://github.com/sagemath/sagetrac-mirror/commit/b6f8162e7a78df3f7479c3305a243981587f7006)" to "[0c556408ff92446a738f13b421b21f997e3e5f13](https://github.com/sagemath/sagetrac-mirror/commit/0c556408ff92446a738f13b421b21f997e3e5f13)".



---

archive/issue_comments_643888.json:
```json
{
    "body": "<a id='comment:15'></a>\nNow the behaviour is\n\n```\nno option -p   =>   nthreads = 1\n-p             =>   nthreads = 0\n-p k           =>   nthreads = k\n```\n\nBut I still do not see how to fix your concern.",
    "created_at": "2021-09-11T07:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643888",
    "user": "https://github.com/fchapoton"
}
```


<a id='comment:15'></a>
Now the behaviour is

```
no option -p   =>   nthreads = 1
-p             =>   nthreads = 0
-p k           =>   nthreads = k
```

But I still do not see how to fix your concern.



---

archive/issue_comments_643889.json:
```json
{
    "body": "<a id='comment:16'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3a9358337afbf13e28ae769308cf0e992b571905\">3a93583</a></td><td><code>better handling short and warn-long</code></td></tr></table>\n",
    "created_at": "2021-09-11T07:57:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643889",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:16'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3a9358337afbf13e28ae769308cf0e992b571905">3a93583</a></td><td><code>better handling short and warn-long</code></td></tr></table>




---

archive/issue_comments_643890.json:
```json
{
    "body": "**Changing commit** from \"[0c556408ff92446a738f13b421b21f997e3e5f13](https://github.com/sagemath/sagetrac-mirror/commit/0c556408ff92446a738f13b421b21f997e3e5f13)\" to \"[3a9358337afbf13e28ae769308cf0e992b571905](https://github.com/sagemath/sagetrac-mirror/commit/3a9358337afbf13e28ae769308cf0e992b571905)\".",
    "created_at": "2021-09-11T07:57:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643890",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[0c556408ff92446a738f13b421b21f997e3e5f13](https://github.com/sagemath/sagetrac-mirror/commit/0c556408ff92446a738f13b421b21f997e3e5f13)" to "[3a9358337afbf13e28ae769308cf0e992b571905](https://github.com/sagemath/sagetrac-mirror/commit/3a9358337afbf13e28ae769308cf0e992b571905)".



---

archive/issue_comments_643891.json:
```json
{
    "body": "<a id='comment:17'></a>\nI would see a solution to avoid breaking `sage -tp file.py`\n\nbut at the prize of breaking\n\n`sage -tp 4 [...]`\n\nThe idea is to always add the argument 0 to `-p` when using `-tp` or `-btp`.\n\nSo what would you prefer ?\n\nPeople would still be able to use\n\n```\nsage -t -p 4 [...]\n```",
    "created_at": "2021-09-11T08:26:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643891",
    "user": "https://github.com/fchapoton"
}
```


<a id='comment:17'></a>
I would see a solution to avoid breaking `sage -tp file.py`

but at the prize of breaking

`sage -tp 4 [...]`

The idea is to always add the argument 0 to `-p` when using `-tp` or `-btp`.

So what would you prefer ?

People would still be able to use

```
sage -t -p 4 [...]
```



---

archive/issue_comments_643892.json:
```json
{
    "body": "<a id='comment:18'></a>\nWe have the same issue with other options\n\n```\n~/sage$ sage -t --short src/sage/combinat/partition.py \neither use --new or --all or some filenames\n~/sage$ sage -t --warn-long src/sage/combinat/partition.py \neither use --new or --all or some filenames\n```\nA workaround seems to be\n\n```\n~/sage$ sage -t --warn-long -- src/sage/combinat/partition.py \n```",
    "created_at": "2021-09-11T09:43:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643892",
    "user": "https://github.com/fchapoton"
}
```


<a id='comment:18'></a>
We have the same issue with other options

```
~/sage$ sage -t --short src/sage/combinat/partition.py 
either use --new or --all or some filenames
~/sage$ sage -t --warn-long src/sage/combinat/partition.py 
either use --new or --all or some filenames
```
A workaround seems to be

```
~/sage$ sage -t --warn-long -- src/sage/combinat/partition.py 
```



---

archive/issue_comments_643893.json:
```json
{
    "body": "**Changing commit** from \"[3a9358337afbf13e28ae769308cf0e992b571905](https://github.com/sagemath/sagetrac-mirror/commit/3a9358337afbf13e28ae769308cf0e992b571905)\" to \"[7328505eff557af40d5a9f1fb32ac5d1a8c9d24e](https://github.com/sagemath/sagetrac-mirror/commit/7328505eff557af40d5a9f1fb32ac5d1a8c9d24e)\".",
    "created_at": "2021-09-11T10:10:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643893",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[3a9358337afbf13e28ae769308cf0e992b571905](https://github.com/sagemath/sagetrac-mirror/commit/3a9358337afbf13e28ae769308cf0e992b571905)" to "[7328505eff557af40d5a9f1fb32ac5d1a8c9d24e](https://github.com/sagemath/sagetrac-mirror/commit/7328505eff557af40d5a9f1fb32ac5d1a8c9d24e)".



---

archive/issue_comments_643894.json:
```json
{
    "body": "<a id='comment:19'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7328505eff557af40d5a9f1fb32ac5d1a8c9d24e\">7328505</a></td><td><code>adding custom treatment</code></td></tr></table>\n",
    "created_at": "2021-09-11T10:10:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643894",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:19'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7328505eff557af40d5a9f1fb32ac5d1a8c9d24e">7328505</a></td><td><code>adding custom treatment</code></td></tr></table>




---

archive/issue_comments_643895.json:
```json
{
    "body": "**Changing commit** from \"[7328505eff557af40d5a9f1fb32ac5d1a8c9d24e](https://github.com/sagemath/sagetrac-mirror/commit/7328505eff557af40d5a9f1fb32ac5d1a8c9d24e)\" to \"[c3dc88c9d9974339b58f9a983fbd8a53904d9188](https://github.com/sagemath/sagetrac-mirror/commit/c3dc88c9d9974339b58f9a983fbd8a53904d9188)\".",
    "created_at": "2021-09-11T10:36:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643895",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[7328505eff557af40d5a9f1fb32ac5d1a8c9d24e](https://github.com/sagemath/sagetrac-mirror/commit/7328505eff557af40d5a9f1fb32ac5d1a8c9d24e)" to "[c3dc88c9d9974339b58f9a983fbd8a53904d9188](https://github.com/sagemath/sagetrac-mirror/commit/c3dc88c9d9974339b58f9a983fbd8a53904d9188)".



---

archive/issue_comments_643896.json:
```json
{
    "body": "<a id='comment:20'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c3dc88c9d9974339b58f9a983fbd8a53904d9188\">c3dc88c</a></td><td><code>use argparse in sage-runtests</code></td></tr></table>\n",
    "created_at": "2021-09-11T10:36:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643896",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:20'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c3dc88c9d9974339b58f9a983fbd8a53904d9188">c3dc88c</a></td><td><code>use argparse in sage-runtests</code></td></tr></table>




---

archive/issue_comments_643897.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2021-09-11T10:37:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643897",
    "user": "https://github.com/fchapoton"
}
```


**Changing status** from needs_work to needs_review.



---

archive/issue_comments_643898.json:
```json
{
    "body": "<a id='comment:21'></a>\nI think I have found a solution. Maybe not perfect.",
    "created_at": "2021-09-11T10:37:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643898",
    "user": "https://github.com/fchapoton"
}
```


<a id='comment:21'></a>
I think I have found a solution. Maybe not perfect.



---

archive/issue_comments_643899.json:
```json
{
    "body": "<a id='comment:22'></a>\nIf we have to make a choice, I personally would prefer `-tp` and `-btp` to work, but that is because it is what I most frequently use. Does your solution keep both input formats?\n\nWhat about `.pyx` (and probably `.pxd` and `.pxi`) files? I think those also need to be added to the list.",
    "created_at": "2021-09-11T10:51:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643899",
    "user": "https://github.com/tscrim"
}
```


<a id='comment:22'></a>
If we have to make a choice, I personally would prefer `-tp` and `-btp` to work, but that is because it is what I most frequently use. Does your solution keep both input formats?

What about `.pyx` (and probably `.pxd` and `.pxi`) files? I think those also need to be added to the list.



---

archive/issue_comments_643900.json:
```json
{
    "body": "**Changing commit** from \"[c3dc88c9d9974339b58f9a983fbd8a53904d9188](https://github.com/sagemath/sagetrac-mirror/commit/c3dc88c9d9974339b58f9a983fbd8a53904d9188)\" to \"[dd18675b44c31d387d96caff5646046af9fdde4b](https://github.com/sagemath/sagetrac-mirror/commit/dd18675b44c31d387d96caff5646046af9fdde4b)\".",
    "created_at": "2021-09-11T11:19:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643900",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[c3dc88c9d9974339b58f9a983fbd8a53904d9188](https://github.com/sagemath/sagetrac-mirror/commit/c3dc88c9d9974339b58f9a983fbd8a53904d9188)" to "[dd18675b44c31d387d96caff5646046af9fdde4b](https://github.com/sagemath/sagetrac-mirror/commit/dd18675b44c31d387d96caff5646046af9fdde4b)".



---

archive/issue_comments_643901.json:
```json
{
    "body": "<a id='comment:23'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dd18675b44c31d387d96caff5646046af9fdde4b\">dd18675</a></td><td><code>fix</code></td></tr></table>\n",
    "created_at": "2021-09-11T11:19:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643901",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:23'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dd18675b44c31d387d96caff5646046af9fdde4b">dd18675</a></td><td><code>fix</code></td></tr></table>




---

archive/issue_comments_643902.json:
```json
{
    "body": "<a id='comment:24'></a>\nThanks for the suggestion about pyx. I have added that.\n\nI think everything works smoothly now.\n\nWhat would still fail would be something like\n\n```\nsage -tp src/sage/combinat/\n```\nwhich can easily be obtained as\n\n```\nsage -tp 0 src/sage/combinat\n```",
    "created_at": "2021-09-11T11:21:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643902",
    "user": "https://github.com/fchapoton"
}
```


<a id='comment:24'></a>
Thanks for the suggestion about pyx. I have added that.

I think everything works smoothly now.

What would still fail would be something like

```
sage -tp src/sage/combinat/
```
which can easily be obtained as

```
sage -tp 0 src/sage/combinat
```



---

archive/issue_comments_643903.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [chapoton](#comment%3A24):\n> What would still fail would be something like\n> \n> ```\n> sage -tp src/sage/combinat/\n> ```\n> which can easily be obtained as\n> \n> ```\n> sage -tp 0 src/sage/combinat\n> ```\n\n\n-1 on making such incompatible changes, it will be annoying to developers",
    "created_at": "2021-09-11T21:10:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643903",
    "user": "https://github.com/mkoeppe"
}
```


<a id='comment:25'></a>
Replying to [chapoton](#comment%3A24):
> What would still fail would be something like
> 
> ```
> sage -tp src/sage/combinat/
> ```
> which can easily be obtained as
> 
> ```
> sage -tp 0 src/sage/combinat
> ```


-1 on making such incompatible changes, it will be annoying to developers



---

archive/issue_comments_643904.json:
```json
{
    "body": "<a id='comment:26'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d057ee2d3263e4aca9f4a26a763364a616ed2a0d\">d057ee2</a></td><td><code>another try for argparse of runtests</code></td></tr></table>\n",
    "created_at": "2021-09-12T07:28:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643904",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:26'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d057ee2d3263e4aca9f4a26a763364a616ed2a0d">d057ee2</a></td><td><code>another try for argparse of runtests</code></td></tr></table>




---

archive/issue_comments_643905.json:
```json
{
    "body": "**Changing commit** from \"[dd18675b44c31d387d96caff5646046af9fdde4b](https://github.com/sagemath/sagetrac-mirror/commit/dd18675b44c31d387d96caff5646046af9fdde4b)\" to \"[d057ee2d3263e4aca9f4a26a763364a616ed2a0d](https://github.com/sagemath/sagetrac-mirror/commit/d057ee2d3263e4aca9f4a26a763364a616ed2a0d)\".",
    "created_at": "2021-09-12T07:28:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643905",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[dd18675b44c31d387d96caff5646046af9fdde4b](https://github.com/sagemath/sagetrac-mirror/commit/dd18675b44c31d387d96caff5646046af9fdde4b)" to "[d057ee2d3263e4aca9f4a26a763364a616ed2a0d](https://github.com/sagemath/sagetrac-mirror/commit/d057ee2d3263e4aca9f4a26a763364a616ed2a0d)".



---

archive/issue_comments_643906.json:
```json
{
    "body": "<a id='comment:27'></a>\nHere is a new proposal. I tried to keep things simple.",
    "created_at": "2021-09-12T07:30:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643906",
    "user": "https://github.com/fchapoton"
}
```


<a id='comment:27'></a>
Here is a new proposal. I tried to keep things simple.



---

archive/issue_comments_643907.json:
```json
{
    "body": "<a id='comment:28'></a>\nThank you. We are getting close.\n\n```\n$ ./sage -tp --warn-long src/sage/rings/function_field/function_field.py\n```\nworks, but this does not (although it used to)\n\n```\n$ ./sage -tp src/sage/rings/function_field/function_field.py --warn-long\ntoo few successful tests, not using stored timings\nRunning doctests with ID 2021-09-13-14-49-55-02c83a90.\nGit branch: u/chapoton/32332\nUsing --optional=bliss,build,debian,dochtml,dot2tex,e_antic,libnauty,ninja_build,normaliz,pip,sage,sage_spkg\nTraceback (most recent call last):\n  File \"/home/uqtscrim/sage-build/src/bin/sage-runtests\", line 149, in <module>\n    err = DC.run()\n  File \"/home/uqtscrim/sage-build/local/lib/python3.9/site-packages/sage/doctest/control.py\", line 1204, in run\n    self.expand_files_into_sources()\n  File \"/home/uqtscrim/sage-build/local/lib/python3.9/site-packages/sage/doctest/control.py\", line 788, in expand_files_into_sources\n    self.sources = [FileDocTestSource(path, self.options) for path in expand()]\n  File \"/home/uqtscrim/sage-build/local/lib/python3.9/site-packages/sage/doctest/control.py\", line 788, in <listcomp>\n    self.sources = [FileDocTestSource(path, self.options) for path in expand()]\n  File \"/home/uqtscrim/sage-build/local/lib/python3.9/site-packages/sage/doctest/sources.py\", line 527, in __init__\n    raise ValueError(\"unknown file extension %r\"%ext)\nValueError: unknown file extension ''\n```\nAlthough I could very easily argue that this is not supported behavior, so it might be more luck than anything it worked before. This is a very minor point and not something I would withhold a positive review for.",
    "created_at": "2021-09-13T04:55:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643907",
    "user": "https://github.com/tscrim"
}
```


<a id='comment:28'></a>
Thank you. We are getting close.

```
$ ./sage -tp --warn-long src/sage/rings/function_field/function_field.py
```
works, but this does not (although it used to)

```
$ ./sage -tp src/sage/rings/function_field/function_field.py --warn-long
too few successful tests, not using stored timings
Running doctests with ID 2021-09-13-14-49-55-02c83a90.
Git branch: u/chapoton/32332
Using --optional=bliss,build,debian,dochtml,dot2tex,e_antic,libnauty,ninja_build,normaliz,pip,sage,sage_spkg
Traceback (most recent call last):
  File "/home/uqtscrim/sage-build/src/bin/sage-runtests", line 149, in <module>
    err = DC.run()
  File "/home/uqtscrim/sage-build/local/lib/python3.9/site-packages/sage/doctest/control.py", line 1204, in run
    self.expand_files_into_sources()
  File "/home/uqtscrim/sage-build/local/lib/python3.9/site-packages/sage/doctest/control.py", line 788, in expand_files_into_sources
    self.sources = [FileDocTestSource(path, self.options) for path in expand()]
  File "/home/uqtscrim/sage-build/local/lib/python3.9/site-packages/sage/doctest/control.py", line 788, in <listcomp>
    self.sources = [FileDocTestSource(path, self.options) for path in expand()]
  File "/home/uqtscrim/sage-build/local/lib/python3.9/site-packages/sage/doctest/sources.py", line 527, in __init__
    raise ValueError("unknown file extension %r"%ext)
ValueError: unknown file extension ''
```
Although I could very easily argue that this is not supported behavior, so it might be more luck than anything it worked before. This is a very minor point and not something I would withhold a positive review for.



---

archive/issue_comments_643908.json:
```json
{
    "body": "<a id='comment:29'></a>\nI do not think that we should allow options after the filenames.\n\nThe usage is \"options then filenames\", and that's all.",
    "created_at": "2021-09-13T07:13:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643908",
    "user": "https://github.com/fchapoton"
}
```


<a id='comment:29'></a>
I do not think that we should allow options after the filenames.

The usage is "options then filenames", and that's all.



---

archive/issue_comments_643909.json:
```json
{
    "body": "<a id='comment:30'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/66083fd7e500980ecef13e5d691784772acc6a09\">66083fd</a></td><td><code>Merge branch 'u/chapoton/32332' in 9.5.b1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/04e40ffba2f944c8369cc48f3b5aeef6fc409bfc\">04e40ff</a></td><td><code>fine tuning short and warn-long options</code></td></tr></table>\n",
    "created_at": "2021-09-14T16:14:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643909",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:30'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/66083fd7e500980ecef13e5d691784772acc6a09">66083fd</a></td><td><code>Merge branch 'u/chapoton/32332' in 9.5.b1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/04e40ffba2f944c8369cc48f3b5aeef6fc409bfc">04e40ff</a></td><td><code>fine tuning short and warn-long options</code></td></tr></table>




---

archive/issue_comments_643910.json:
```json
{
    "body": "**Changing commit** from \"[d057ee2d3263e4aca9f4a26a763364a616ed2a0d](https://github.com/sagemath/sagetrac-mirror/commit/d057ee2d3263e4aca9f4a26a763364a616ed2a0d)\" to \"[04e40ffba2f944c8369cc48f3b5aeef6fc409bfc](https://github.com/sagemath/sagetrac-mirror/commit/04e40ffba2f944c8369cc48f3b5aeef6fc409bfc)\".",
    "created_at": "2021-09-14T16:14:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643910",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[d057ee2d3263e4aca9f4a26a763364a616ed2a0d](https://github.com/sagemath/sagetrac-mirror/commit/d057ee2d3263e4aca9f4a26a763364a616ed2a0d)" to "[04e40ffba2f944c8369cc48f3b5aeef6fc409bfc](https://github.com/sagemath/sagetrac-mirror/commit/04e40ffba2f944c8369cc48f3b5aeef6fc409bfc)".



---

archive/issue_comments_643911.json:
```json
{
    "body": "<a id='comment:31'></a>\nOkay, then let's not (unofficially) support that input format anymore.\n\nShouldn't `--short` take floating points? Granted, I find it unlikely that someone will want to do something in `321.0123` seconds, but perhaps for one file they don't want whole seconds? The output for `--short` has also become a lot more verbose. (Not that that is a bad thing, it is just a change in behavior.)\n\nAnyways, this should hopefully be the last of it. The sooner we can get this merged and out for people to test it more in the wild, the better we can pick up other changes in behavior (that people care about).",
    "created_at": "2021-09-15T01:45:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643911",
    "user": "https://github.com/tscrim"
}
```


<a id='comment:31'></a>
Okay, then let's not (unofficially) support that input format anymore.

Shouldn't `--short` take floating points? Granted, I find it unlikely that someone will want to do something in `321.0123` seconds, but perhaps for one file they don't want whole seconds? The output for `--short` has also become a lot more verbose. (Not that that is a bad thing, it is just a change in behavior.)

Anyways, this should hopefully be the last of it. The sooner we can get this merged and out for people to test it more in the wild, the better we can pick up other changes in behavior (that people care about).



---

archive/issue_comments_643912.json:
```json
{
    "body": "<a id='comment:32'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/84471a3d11c198c23fd59ced9815069181bb5f58\">84471a3</a></td><td><code>fix for --short</code></td></tr></table>\n",
    "created_at": "2021-09-15T07:01:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643912",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:32'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/84471a3d11c198c23fd59ced9815069181bb5f58">84471a3</a></td><td><code>fix for --short</code></td></tr></table>




---

archive/issue_comments_643913.json:
```json
{
    "body": "**Changing commit** from \"[04e40ffba2f944c8369cc48f3b5aeef6fc409bfc](https://github.com/sagemath/sagetrac-mirror/commit/04e40ffba2f944c8369cc48f3b5aeef6fc409bfc)\" to \"[84471a3d11c198c23fd59ced9815069181bb5f58](https://github.com/sagemath/sagetrac-mirror/commit/84471a3d11c198c23fd59ced9815069181bb5f58)\".",
    "created_at": "2021-09-15T07:01:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643913",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[04e40ffba2f944c8369cc48f3b5aeef6fc409bfc](https://github.com/sagemath/sagetrac-mirror/commit/04e40ffba2f944c8369cc48f3b5aeef6fc409bfc)" to "[84471a3d11c198c23fd59ced9815069181bb5f58](https://github.com/sagemath/sagetrac-mirror/commit/84471a3d11c198c23fd59ced9815069181bb5f58)".



---

archive/issue_comments_643914.json:
```json
{
    "body": "<a id='comment:33'></a>\nok, short was indeed broken by the change of default value. Repaired now.\n\nShort was taking integers and will still take integers. I would prefer not to change that.",
    "created_at": "2021-09-15T07:03:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643914",
    "user": "https://github.com/fchapoton"
}
```


<a id='comment:33'></a>
ok, short was indeed broken by the change of default value. Repaired now.

Short was taking integers and will still take integers. I would prefer not to change that.



---

archive/issue_comments_643915.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2021-09-15T09:10:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643915",
    "user": "https://github.com/tscrim"
}
```


**Changing status** from needs_review to positive_review.



---

archive/issue_comments_643916.json:
```json
{
    "body": "<a id='comment:34'></a>\nOkay, thank you. Let's get this tested by the rest of the developers.",
    "created_at": "2021-09-15T09:10:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643916",
    "user": "https://github.com/tscrim"
}
```


<a id='comment:34'></a>
Okay, thank you. Let's get this tested by the rest of the developers.



---

archive/issue_comments_643917.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2021-09-19T22:39:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643917",
    "user": "https://github.com/vbraun"
}
```


**Changing status** from positive_review to needs_work.



---

archive/issue_comments_643918.json:
```json
{
    "body": "<a id='comment:35'></a>\n\n```\nsage -t --long --warn-long 44.9 --random-seed=0 src/sage/doctest/test.py  # 21 doctests failed\nsage -t --long --warn-long 44.9 --random-seed=0 src/sage/doctest/forker.py  # 11 doctests failed\nsage -t --long --warn-long 44.9 --random-seed=0 src/sage/doctest/control.py  # Bad exit: 1 after testing finished\n```",
    "created_at": "2021-09-19T22:39:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643918",
    "user": "https://github.com/vbraun"
}
```


<a id='comment:35'></a>

```
sage -t --long --warn-long 44.9 --random-seed=0 src/sage/doctest/test.py  # 21 doctests failed
sage -t --long --warn-long 44.9 --random-seed=0 src/sage/doctest/forker.py  # 11 doctests failed
sage -t --long --warn-long 44.9 --random-seed=0 src/sage/doctest/control.py  # Bad exit: 1 after testing finished
```



---

archive/issue_comments_643919.json:
```json
{
    "body": "**Changing commit** from \"[84471a3d11c198c23fd59ced9815069181bb5f58](https://github.com/sagemath/sagetrac-mirror/commit/84471a3d11c198c23fd59ced9815069181bb5f58)\" to \"[c87148b86fe0de11be68a0f01917e45b705e4c83](https://github.com/sagemath/sagetrac-mirror/commit/c87148b86fe0de11be68a0f01917e45b705e4c83)\".",
    "created_at": "2021-09-20T08:34:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643919",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


**Changing commit** from "[84471a3d11c198c23fd59ced9815069181bb5f58](https://github.com/sagemath/sagetrac-mirror/commit/84471a3d11c198c23fd59ced9815069181bb5f58)" to "[c87148b86fe0de11be68a0f01917e45b705e4c83](https://github.com/sagemath/sagetrac-mirror/commit/c87148b86fe0de11be68a0f01917e45b705e4c83)".



---

archive/issue_comments_643920.json:
```json
{
    "body": "<a id='comment:36'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c87148b86fe0de11be68a0f01917e45b705e4c83\">c87148b</a></td><td><code>fixing logfile and warn-long handling</code></td></tr></table>\n",
    "created_at": "2021-09-20T08:34:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643920",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```


<a id='comment:36'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c87148b86fe0de11be68a0f01917e45b705e4c83">c87148b</a></td><td><code>fixing logfile and warn-long handling</code></td></tr></table>




---

archive/issue_comments_643921.json:
```json
{
    "body": "<a id='comment:37'></a>\ndamn. I have fixed a few things again.",
    "created_at": "2021-09-20T08:36:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643921",
    "user": "https://github.com/fchapoton"
}
```


<a id='comment:37'></a>
damn. I have fixed a few things again.



---

archive/issue_comments_643922.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2021-09-20T08:36:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643922",
    "user": "https://github.com/fchapoton"
}
```


**Changing status** from needs_work to needs_review.



---

archive/issue_comments_643923.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2021-09-21T08:17:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643923",
    "user": "https://github.com/tscrim"
}
```


**Changing status** from needs_review to positive_review.



---

archive/issue_comments_643924.json:
```json
{
    "body": "<a id='comment:38'></a>\nGreen bot and passes locally.",
    "created_at": "2021-09-21T08:17:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643924",
    "user": "https://github.com/tscrim"
}
```


<a id='comment:38'></a>
Green bot and passes locally.



---

archive/issue_events_096450.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-09T11:09:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32332#event-96450"
}
```




---

archive/issue_comments_643925.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2021-10-09T11:09:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643925",
    "user": "https://github.com/vbraun"
}
```


**Resolution:** fixed



---

archive/issue_comments_643926.json:
```json
{
    "body": "**Changing branch** from \"[u/chapoton/32332](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/32332)\" to \"[c87148b86fe0de11be68a0f01917e45b705e4c83](https://github.com/sagemath/sagetrac-mirror/commit/c87148b86fe0de11be68a0f01917e45b705e4c83)\".",
    "created_at": "2021-10-09T11:09:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643926",
    "user": "https://github.com/vbraun"
}
```


**Changing branch** from "[u/chapoton/32332](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/32332)" to "[c87148b86fe0de11be68a0f01917e45b705e4c83](https://github.com/sagemath/sagetrac-mirror/commit/c87148b86fe0de11be68a0f01917e45b705e4c83)".



---

archive/issue_comments_643927.json:
```json
{
    "body": "**Changing commit** from \"[c87148b86fe0de11be68a0f01917e45b705e4c83](https://github.com/sagemath/sagetrac-mirror/commit/c87148b86fe0de11be68a0f01917e45b705e4c83)\" to \"\".",
    "created_at": "2021-10-12T10:42:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643927",
    "user": "https://github.com/antonio-rojas"
}
```


**Changing commit** from "[c87148b86fe0de11be68a0f01917e45b705e4c83](https://github.com/sagemath/sagetrac-mirror/commit/c87148b86fe0de11be68a0f01917e45b705e4c83)" to "".



---

archive/issue_comments_643928.json:
```json
{
    "body": "<a id='comment:40'></a>\nThis breaks running `sage -t file --optional=foo` for me, regardless of the optional tags I specify\n\n```\n> sage -t /usr/lib/python3.9/site-packages/sage/sets/integer_range.py --optional=sage\ntoo many failed tests, not using stored timings\nRunning doctests with ID 2021-10-12-12-41-27-6d41dc7c.\nUsing --optional=dochtml,pip,sage\nTraceback (most recent call last):\n  File \"/usr/bin/sage-runtests\", line 151, in <module>\n    err = DC.run()\n  File \"/usr/lib/python3.9/site-packages/sage/doctest/control.py\", line 1210, in run\n    self.expand_files_into_sources()\n  File \"/usr/lib/python3.9/site-packages/sage/doctest/control.py\", line 794, in expand_files_into_sources\n    self.sources = [FileDocTestSource(path, self.options) for path in expand()]\n  File \"/usr/lib/python3.9/site-packages/sage/doctest/control.py\", line 794, in <listcomp>\n    self.sources = [FileDocTestSource(path, self.options) for path in expand()]\n  File \"/usr/lib/python3.9/site-packages/sage/doctest/sources.py\", line 527, in __init__\n    raise ValueError(\"unknown file extension %r\"%ext)\nValueError: unknown file extension ''\n```",
    "created_at": "2021-10-12T10:42:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643928",
    "user": "https://github.com/antonio-rojas"
}
```


<a id='comment:40'></a>
This breaks running `sage -t file --optional=foo` for me, regardless of the optional tags I specify

```
> sage -t /usr/lib/python3.9/site-packages/sage/sets/integer_range.py --optional=sage
too many failed tests, not using stored timings
Running doctests with ID 2021-10-12-12-41-27-6d41dc7c.
Using --optional=dochtml,pip,sage
Traceback (most recent call last):
  File "/usr/bin/sage-runtests", line 151, in <module>
    err = DC.run()
  File "/usr/lib/python3.9/site-packages/sage/doctest/control.py", line 1210, in run
    self.expand_files_into_sources()
  File "/usr/lib/python3.9/site-packages/sage/doctest/control.py", line 794, in expand_files_into_sources
    self.sources = [FileDocTestSource(path, self.options) for path in expand()]
  File "/usr/lib/python3.9/site-packages/sage/doctest/control.py", line 794, in <listcomp>
    self.sources = [FileDocTestSource(path, self.options) for path in expand()]
  File "/usr/lib/python3.9/site-packages/sage/doctest/sources.py", line 527, in __init__
    raise ValueError("unknown file extension %r"%ext)
ValueError: unknown file extension ''
```



---

archive/issue_comments_643929.json:
```json
{
    "body": "<a id='comment:42'></a>\nNevermind, I see this is intentional (re comment 29)",
    "created_at": "2021-10-12T10:48:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32332#issuecomment-643929",
    "user": "https://github.com/antonio-rojas"
}
```


<a id='comment:42'></a>
Nevermind, I see this is intentional (re comment 29)
