# Issue 32242: Use GNU Info to parse singular's Info file

archive/issues_032005.json:
```json
{
    "assignees": [],
    "body": "Our Singular interface currently contains a hand-written parser for Singular's \"info\" file. In this ticket, we add an optional GNU Info package to parse this file instead.\n\nRelative to running \"info\", the hand-written parser has several drawbacks:\n\n* The extra code is a maintenance burden. We should not be wasting\n  our time (poorly) reimplementing standard tools.\n\n* The custom parser is buggy. For example, it is supposed to raise a\n  `KeyError` when documentation for a non-existent function is\n  requested. However, the parser does not keep track of what section\n  it's in, so, for example, `get_docstring(\"Preface\")` will happily\n  return the contents of the preface even though \"Preface\" is not a\n  Singular function.\n\n* The first time documentation is requested, the entire info file\n  (see above) is loaded into a dictionary. With the Singular info\n  file currently weighing in at around 11MiB, this is wasting a\n  good chunk of memory.\n\n* The `singular_console()` itself tries to launch GNU Info to display\n  its interactive help, and cannot use our hand-written parser.\n\nThe one downside to requiring \"info\" is that it would add a new runtime dependency to sagelib. To avoid that, we make GNU Info optional, and suggest to the user that he install it when he tries to read Singular's documentation.\n\nGNU Info (or its superset, Texinfo) are widespread, portable, and easy to install on all of the systems we support, so in most cases this should be a \"free\" improvement.\n\nDepends on #32302\n\nBranch/Commit: **[u/mjo/ticket/32242](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/32242) @ [`137a918`](https://github.com/sagemath/sagetrac-mirror/commit/137a9182a02d4aa329a78c2e936b48431c1e9017)**\n\nAuthor: **Michael Orlitzky**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/32242_\n\n",
    "created_at": "2021-07-19T17:39:59Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/needs%20review"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Use GNU Info to parse singular's Info file",
    "type": "issue",
    "updated_at": "2022-08-31T05:25:02Z",
    "url": "https://github.com/sagemath/sage/issues/32242",
    "user": "https://github.com/orlitzky"
}
```
Our Singular interface currently contains a hand-written parser for Singular's "info" file. In this ticket, we add an optional GNU Info package to parse this file instead.

Relative to running "info", the hand-written parser has several drawbacks:

* The extra code is a maintenance burden. We should not be wasting
  our time (poorly) reimplementing standard tools.

* The custom parser is buggy. For example, it is supposed to raise a
  `KeyError` when documentation for a non-existent function is
  requested. However, the parser does not keep track of what section
  it's in, so, for example, `get_docstring("Preface")` will happily
  return the contents of the preface even though "Preface" is not a
  Singular function.

* The first time documentation is requested, the entire info file
  (see above) is loaded into a dictionary. With the Singular info
  file currently weighing in at around 11MiB, this is wasting a
  good chunk of memory.

* The `singular_console()` itself tries to launch GNU Info to display
  its interactive help, and cannot use our hand-written parser.

The one downside to requiring "info" is that it would add a new runtime dependency to sagelib. To avoid that, we make GNU Info optional, and suggest to the user that he install it when he tries to read Singular's documentation.

GNU Info (or its superset, Texinfo) are widespread, portable, and easy to install on all of the systems we support, so in most cases this should be a "free" improvement.

Depends on #32302

Branch/Commit: **[u/mjo/ticket/32242](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/32242) @ [`137a918`](https://github.com/sagemath/sagetrac-mirror/commit/137a9182a02d4aa329a78c2e936b48431c1e9017)**

Author: **Michael Orlitzky**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/32242_





---

archive/issue_events_444752.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-07-19T17:39:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32242#event-444752"
}
```



---

archive/issue_events_444753.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-07-19T17:39:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32242#event-444753"
}
```



---

archive/issue_events_444754.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-07-19T17:39:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32242#event-444754"
}
```



---

archive/issue_events_444755.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-07-19T17:39:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32242#event-444755"
}
```



---

archive/issue_comments_519500.json:
```json
{
    "body": "Commit: **[`fc7fd02`](https://github.com/sagemath/sagetrac-mirror/commit/fc7fd02b833b2f76755f1e50a28dd7dd566962e5)**",
    "created_at": "2021-07-19T17:41:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519500",
    "user": "https://github.com/orlitzky"
}
```

Commit: **[`fc7fd02`](https://github.com/sagemath/sagetrac-mirror/commit/fc7fd02b833b2f76755f1e50a28dd7dd566962e5)**



---

archive/issue_comments_519501.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/285d8ac662b530a51c2478f6febea994cbf97ef9\"><code>285d8ac</code></a></td><td><code>Trac #XXXXX: new package for the standalone GNU Info reader.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/21586aa31267099e4e7062edefd2a90cd91357e5\"><code>21586aa</code></a></td><td><code>Trac #XXXXX: drop SINGULAR_EXECUTABLE from src/bin/sage-env.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc7fd02b833b2f76755f1e50a28dd7dd566962e5\"><code>fc7fd02</code></a></td><td><code>Trac #XXXXX: use GNU Info to obtain Singular docstrings.</code></td></tr></table>\n",
    "created_at": "2021-07-19T17:41:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519501",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/285d8ac662b530a51c2478f6febea994cbf97ef9"><code>285d8ac</code></a></td><td><code>Trac #XXXXX: new package for the standalone GNU Info reader.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/21586aa31267099e4e7062edefd2a90cd91357e5"><code>21586aa</code></a></td><td><code>Trac #XXXXX: drop SINGULAR_EXECUTABLE from src/bin/sage-env.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc7fd02b833b2f76755f1e50a28dd7dd566962e5"><code>fc7fd02</code></a></td><td><code>Trac #XXXXX: use GNU Info to obtain Singular docstrings.</code></td></tr></table>




---

archive/issue_comments_519502.json:
```json
{
    "body": "Author: **Michael Orlitzky**",
    "created_at": "2021-07-19T17:41:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519502",
    "user": "https://github.com/orlitzky"
}
```

Author: **Michael Orlitzky**



---

archive/issue_comments_519503.json:
```json
{
    "body": "Branch: **[u/mjo/ticket/32242](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/32242)**",
    "created_at": "2021-07-19T17:41:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519503",
    "user": "https://github.com/orlitzky"
}
```

Branch: **[u/mjo/ticket/32242](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/32242)**



---

archive/issue_events_444756.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-07-19T17:41:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32242#event-444756"
}
```



---

archive/issue_comments_519504.json:
```json
{
    "body": "Changed commit from **[`fc7fd02`](https://github.com/sagemath/sagetrac-mirror/commit/fc7fd02b833b2f76755f1e50a28dd7dd566962e5)** to **[`c4f6938`](https://github.com/sagemath/sagetrac-mirror/commit/c4f693803fdc7deb904bb85c7352f6327f338a66)**",
    "created_at": "2021-07-19T17:42:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519504",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`fc7fd02`](https://github.com/sagemath/sagetrac-mirror/commit/fc7fd02b833b2f76755f1e50a28dd7dd566962e5)** to **[`c4f6938`](https://github.com/sagemath/sagetrac-mirror/commit/c4f693803fdc7deb904bb85c7352f6327f338a66)**



---

archive/issue_comments_519505.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4768540a2684fe1cc5a9669616641545d2e94a1a\"><code>4768540</code></a></td><td><code>Trac #32242: new package for the standalone GNU Info reader.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/47eb39154797140c3fd24447a78af0c03fff511f\"><code>47eb391</code></a></td><td><code>Trac #32242: drop SINGULAR_EXECUTABLE from src/bin/sage-env.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c4f693803fdc7deb904bb85c7352f6327f338a66\"><code>c4f6938</code></a></td><td><code>Trac #32242: use GNU Info to obtain Singular docstrings.</code></td></tr></table>\n",
    "created_at": "2021-07-19T17:42:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519505",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4768540a2684fe1cc5a9669616641545d2e94a1a"><code>4768540</code></a></td><td><code>Trac #32242: new package for the standalone GNU Info reader.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/47eb39154797140c3fd24447a78af0c03fff511f"><code>47eb391</code></a></td><td><code>Trac #32242: drop SINGULAR_EXECUTABLE from src/bin/sage-env.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c4f693803fdc7deb904bb85c7352f6327f338a66"><code>c4f6938</code></a></td><td><code>Trac #32242: use GNU Info to obtain Singular docstrings.</code></td></tr></table>




---

archive/issue_comments_519506.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI don't know... shouldn't there be a feature request / PR to Singular to make the docstrings available via API?",
    "created_at": "2021-07-19T18:33:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519506",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

I don't know... shouldn't there be a feature request / PR to Singular to make the docstrings available via API?



---

archive/issue_comments_519507.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nSingular renders its own interactive help using \"info\" or one of its alternatives: https://www.singular.uni-kl.de/Manual/latest/sing_16.htm\n\nI don't think they can give us an API without making \"info\" a dependency of Singular itself.",
    "created_at": "2021-07-19T18:41:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519507",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:4" align="right">comment:4</div>

Singular renders its own interactive help using "info" or one of its alternatives: https://www.singular.uni-kl.de/Manual/latest/sing_16.htm

I don't think they can give us an API without making "info" a dependency of Singular itself.



---

archive/issue_comments_519508.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nOK I see.\n\nI still don't get why it's necessary or helpful to replace our parser with calling the `info` program. \n\nWouldn't it be much easier to just obtain the help file location from Singular itself?",
    "created_at": "2021-07-19T19:23:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519508",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">comment:5</div>

OK I see.

I still don't get why it's necessary or helpful to replace our parser with calling the `info` program. 

Wouldn't it be much easier to just obtain the help file location from Singular itself?



---

archive/issue_comments_519509.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI would also think it's pretty problematic from the viewpoint of modularization. We may soon have a pip-installable package for the Sage functionality that uses Singular. The wheel could then vendor `libsingular`. But vendoring the `info` program? That would be rather strange.",
    "created_at": "2021-07-19T19:28:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519509",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">comment:6</div>

I would also think it's pretty problematic from the viewpoint of modularization. We may soon have a pip-installable package for the Sage functionality that uses Singular. The wheel could then vendor `libsingular`. But vendoring the `info` program? That would be rather strange.



---

archive/issue_comments_519510.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@mkoeppe](#comment:5):\n> OK I see.\n> \n> I still don't get why it's necessary or helpful to replace our parser with calling the `info` program. \n\nThe interface gets a lot smaller and simpler.\n\n\n> Wouldn't it be much easier to just obtain the help file location from Singular itself?\n\nSingular does know where it lives, but how do you propose we get it? Ask them to add a special command-line option to support our outlandish use case?",
    "created_at": "2021-07-19T19:40:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519510",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@mkoeppe](#comment:5):
> OK I see.
> 
> I still don't get why it's necessary or helpful to replace our parser with calling the `info` program. 

The interface gets a lot smaller and simpler.


> Wouldn't it be much easier to just obtain the help file location from Singular itself?

Singular does know where it lives, but how do you propose we get it? Ask them to add a special command-line option to support our outlandish use case?



---

archive/issue_comments_519511.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@mkoeppe](#comment:6):\n> I would also think it's pretty problematic from the viewpoint of modularization. We may soon have a pip-installable package for the Sage functionality that uses Singular. The wheel could then vendor `libsingular`. But vendoring the `info` program? That would be rather strange.\n\nLeave it as part of the main Sage package, assumed to be there by the Singular wheel? In almost all cases, the system Info will be used anyway. But I don't really know enough about what you're trying to do to make a good suggestion.",
    "created_at": "2021-07-19T19:45:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519511",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@mkoeppe](#comment:6):
> I would also think it's pretty problematic from the viewpoint of modularization. We may soon have a pip-installable package for the Sage functionality that uses Singular. The wheel could then vendor `libsingular`. But vendoring the `info` program? That would be rather strange.

Leave it as part of the main Sage package, assumed to be there by the Singular wheel? In almost all cases, the system Info will be used anyway. But I don't really know enough about what you're trying to do to make a good suggestion.



---

archive/issue_comments_519512.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@orlitzky](#comment:7):\n> Singular does know where it lives, but how do you propose we get it?\n\nUse `feGetResource` in libsingular_resources?",
    "created_at": "2021-07-19T20:10:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519512",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@orlitzky](#comment:7):
> Singular does know where it lives, but how do you propose we get it?

Use `feGetResource` in libsingular_resources?



---

archive/issue_comments_519513.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@mkoeppe](#comment:9):\n> Replying to [@orlitzky](#comment:7):\n> > Singular does know where it lives, but how do you propose we get it?\n\n> \n> Use `feGetResource` in libsingular_resources?\n\nLooks like it will work, thanks. I still think it's kinda dumb to poorly reimplement a ubiquitous 300k tool in math software, but it's good to know that we can find the help file if we really need to.",
    "created_at": "2021-07-19T20:28:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519513",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@mkoeppe](#comment:9):
> Replying to [@orlitzky](#comment:7):
> > Singular does know where it lives, but how do you propose we get it?

> 
> Use `feGetResource` in libsingular_resources?

Looks like it will work, thanks. I still think it's kinda dumb to poorly reimplement a ubiquitous 300k tool in math software, but it's good to know that we can find the help file if we really need to.



---

archive/issue_comments_519514.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\ninfo is a well-documented, stable, extremely simple file format, I don't think there's anything wrong with doing basic parsing on it in Python.",
    "created_at": "2021-07-19T20:38:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519514",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

info is a well-documented, stable, extremely simple file format, I don't think there's anything wrong with doing basic parsing on it in Python.



---

archive/issue_comments_519515.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nWell, we don't really parse it. It's more like a grep:\n\n```\nsage: from sage.interfaces.singular import get_docstring                        \nsage: get_docstring(\"Preface\")\n```\n\nwill dutifully pull up the \"Preface\" node without regard for where in the manual it lives (it's not a function that we wrap and should throw a `KeyError` instead). The current branch oversimplifies a bit here too, checking only that the parent node is \"Functions\", but you can pass a series of (sub)nodes to `info` to ensure that you're navigating to where you think you are.\n\nIt looks like we also install info files for maxima and giac. So not only would having \"info\" installed allow you to run the interactive help in a `singular_console()`, but it may help somebody read the maxima and giac docs, too.",
    "created_at": "2021-07-19T20:50:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519515",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:12" align="right">comment:12</div>

Well, we don't really parse it. It's more like a grep:

```
sage: from sage.interfaces.singular import get_docstring                        
sage: get_docstring("Preface")
```

will dutifully pull up the "Preface" node without regard for where in the manual it lives (it's not a function that we wrap and should throw a `KeyError` instead). The current branch oversimplifies a bit here too, checking only that the parent node is "Functions", but you can pass a series of (sub)nodes to `info` to ensure that you're navigating to where you think you are.

It looks like we also install info files for maxima and giac. So not only would having "info" installed allow you to run the interactive help in a `singular_console()`, but it may help somebody read the maxima and giac docs, too.



---

archive/issue_comments_519516.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nI don't really have an objection to adding `info` as a package. Accessing the interactive help in the standalone giac, maxima, singular shipped with Sage is a nice-to-have feature; but I don't think this is a strong argument to making it a \"standard\" package.\n\nHowever, I don't support replacing the in-Python code (no issues have been reported with it -- no matter how primitive the code may be) by calling out to the `info` program. This adds a complication that I would really hope to avoid.",
    "created_at": "2021-07-19T21:41:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519516",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:13" align="right">comment:13</div>

I don't really have an objection to adding `info` as a package. Accessing the interactive help in the standalone giac, maxima, singular shipped with Sage is a nice-to-have feature; but I don't think this is a strong argument to making it a "standard" package.

However, I don't support replacing the in-Python code (no issues have been reported with it -- no matter how primitive the code may be) by calling out to the `info` program. This adds a complication that I would really hope to avoid.



---

archive/issue_comments_519517.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nConversely, I'm only willing to tolerate the new dependency if it eliminates these hacks. It may be true that no issues have been reported with the info parser, but how long have we been waiting for someone to write an spkg-configure.m4 for singular? The only reason no one has done it (singular has a pc file, and is a huge, slow-to-build package) is because everyone is afraid to step into a pile of shit when they open singular.py{,x} =)\n\nReplacing the cruft is its own reward if it makes maintaining the singular interface easier. I'm  unhappy about the dependency myself, but who does it really hurt? Doing *something* about `SINGULARPATH` is necessary before we can use Singular from the system. Using GNU Info to read the info file is an easy and principled way to get us to a point where everyone on Fedora, Debian, Gentoo, Homebrew, Conda, Nix, etc. can just use Singular (and Info) from their package manager. That's a big gain for what constitutes almost the entirety of our users. And who is penalized by having Info be a standard package? Maybe some BSD installs that aren't currently supported platforms? This should be something like bzip2 that no one ever builds.",
    "created_at": "2021-07-19T23:08:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519517",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:14" align="right">comment:14</div>

Conversely, I'm only willing to tolerate the new dependency if it eliminates these hacks. It may be true that no issues have been reported with the info parser, but how long have we been waiting for someone to write an spkg-configure.m4 for singular? The only reason no one has done it (singular has a pc file, and is a huge, slow-to-build package) is because everyone is afraid to step into a pile of shit when they open singular.py{,x} =)

Replacing the cruft is its own reward if it makes maintaining the singular interface easier. I'm  unhappy about the dependency myself, but who does it really hurt? Doing *something* about `SINGULARPATH` is necessary before we can use Singular from the system. Using GNU Info to read the info file is an easy and principled way to get us to a point where everyone on Fedora, Debian, Gentoo, Homebrew, Conda, Nix, etc. can just use Singular (and Info) from their package manager. That's a big gain for what constitutes almost the entirety of our users. And who is penalized by having Info be a standard package? Maybe some BSD installs that aren't currently supported platforms? This should be something like bzip2 that no one ever builds.



---

archive/issue_comments_519518.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@orlitzky](#comment:14):\n> who is penalized by having Info be a standard package? \n\nThere is no problem with making `info` a standard package.\n\nBut there is a problem in adding an additional non-Python runtime dependency to the Sage library. `info` cannot be installed by `pip`.",
    "created_at": "2021-07-19T23:13:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519518",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@orlitzky](#comment:14):
> who is penalized by having Info be a standard package? 

There is no problem with making `info` a standard package.

But there is a problem in adding an additional non-Python runtime dependency to the Sage library. `info` cannot be installed by `pip`.



---

archive/issue_comments_519519.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@orlitzky](#comment:14):\n> how long have we been waiting for someone to write an spkg-configure.m4 for singular? \n\nThis task was waiting for the stalled Singular upgrade ticket #25993.",
    "created_at": "2021-07-19T23:59:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519519",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@orlitzky](#comment:14):
> how long have we been waiting for someone to write an spkg-configure.m4 for singular? 

This task was waiting for the stalled Singular upgrade ticket #25993.



---

archive/issue_comments_519520.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nOne final point for GNU Info:\n\nThe Singular manual is now 11MB in singular-4.2.1. The existing implementation loads the entire thing (not just the function documentation, as I've shown) into a global variable that lives forever. This permanently wastes roughly the same amount of memory:\n\n```\nsage: from sage.interfaces.singular import generate_docstring_dictionary        \nsage: get_memory_usage()                                                        \n6467.30859375\nsage: generate_docstring_dictionary()                                           \nsage: get_memory_usage()                                                        \n6479.34765625\n```\n\nAnd that will get worse as the Singular manual grows.",
    "created_at": "2021-07-20T11:40:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519520",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:17" align="right">comment:17</div>

One final point for GNU Info:

The Singular manual is now 11MB in singular-4.2.1. The existing implementation loads the entire thing (not just the function documentation, as I've shown) into a global variable that lives forever. This permanently wastes roughly the same amount of memory:

```
sage: from sage.interfaces.singular import generate_docstring_dictionary        
sage: get_memory_usage()                                                        
6467.30859375
sage: generate_docstring_dictionary()                                           
sage: get_memory_usage()                                                        
6479.34765625
```

And that will get worse as the Singular manual grows.



---

archive/issue_comments_519521.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nBy the way, this ticket does not solve the original problem at all. If we want to use system Singular on a system that does not have `info`, then the installed `info` from the proposed SPKG does not have information regarding the info file location. So you are only shifting the problem of locating the info file from runtime to build time; *and* you are introducing a new non-Python dependency for the sagelib runtime.",
    "created_at": "2021-07-20T16:15:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519521",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:18" align="right">comment:18</div>

By the way, this ticket does not solve the original problem at all. If we want to use system Singular on a system that does not have `info`, then the installed `info` from the proposed SPKG does not have information regarding the info file location. So you are only shifting the problem of locating the info file from runtime to build time; *and* you are introducing a new non-Python dependency for the sagelib runtime.



---

archive/issue_comments_519522.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@mkoeppe](#comment:18):\n> By the way, this ticket does not solve the original problem at all. If we want to use system Singular on a system that does not have `info`, then the installed `info` from the proposed SPKG does not have information regarding the info file location. So you are only shifting the problem of locating the info file from runtime to build time; *and* you are introducing a new non-Python dependency for the sagelib runtime.\n\nWhile it's possible to put the info files *anywhere*, we can stick a colon on the end of `$INFOPATH` to have the SPKG try the default list as fallbacks: https://git.savannah.gnu.org/cgit/texinfo.git/tree/info/filesys.h#n70\n\nIf we manage to find a system that both doesn't have GNU Info and yet still goes out of its way to install info files in a crazy location... then I guess at that point we could use DEPCHECK to ensure that the Singular SPKG gets built on that system.",
    "created_at": "2021-07-20T16:33:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519522",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@mkoeppe](#comment:18):
> By the way, this ticket does not solve the original problem at all. If we want to use system Singular on a system that does not have `info`, then the installed `info` from the proposed SPKG does not have information regarding the info file location. So you are only shifting the problem of locating the info file from runtime to build time; *and* you are introducing a new non-Python dependency for the sagelib runtime.

While it's possible to put the info files *anywhere*, we can stick a colon on the end of `$INFOPATH` to have the SPKG try the default list as fallbacks: https://git.savannah.gnu.org/cgit/texinfo.git/tree/info/filesys.h#n70

If we manage to find a system that both doesn't have GNU Info and yet still goes out of its way to install info files in a crazy location... then I guess at that point we could use DEPCHECK to ensure that the Singular SPKG gets built on that system.



---

archive/issue_comments_519523.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nSorry, overall this ticket looks like a solution in search of a problem, and one that will create new problems as a side effect.\n\nThe actual problem has a simple solution, [comment:9](#comment:9).",
    "created_at": "2021-07-20T16:36:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519523",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:20" align="right">comment:20</div>

Sorry, overall this ticket looks like a solution in search of a problem, and one that will create new problems as a side effect.

The actual problem has a simple solution, [comment:9](#comment:9).



---

archive/issue_comments_519524.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nWe could always make GNU Info an optional package, and take the same approach to\n\n```\nsage: singular.<function>?\n```\n\nthat we take to\n\n```\nsage: singular_console()\n> help <function>;\n```\n\nThat is, it doesn't work unless you have Info installed. The docstring for the sage object would suggest the optional package if it's not available.",
    "created_at": "2021-07-20T16:39:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519524",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:21" align="right">comment:21</div>

We could always make GNU Info an optional package, and take the same approach to

```
sage: singular.<function>?
```

that we take to

```
sage: singular_console()
> help <function>;
```

That is, it doesn't work unless you have Info installed. The docstring for the sage object would suggest the optional package if it's not available.



---

archive/issue_comments_519525.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@mkoeppe](#comment:20):\n> Sorry, overall this ticket looks like a solution in search of a problem, and one that will create new problems as a side effect.\n> \n> The actual problem has a simple solution, [comment:9](#comment:9).\n> \n\nThis is only a solution if you insist on keeping our lame python implementation and all of the problems it comes with. It'll get the job done, but I won't be the one to do it.",
    "created_at": "2021-07-20T16:40:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519525",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@mkoeppe](#comment:20):
> Sorry, overall this ticket looks like a solution in search of a problem, and one that will create new problems as a side effect.
> 
> The actual problem has a simple solution, [comment:9](#comment:9).
> 

This is only a solution if you insist on keeping our lame python implementation and all of the problems it comes with. It'll get the job done, but I won't be the one to do it.



---

archive/issue_comments_519526.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a82847c7617969350dbc409c6821d10abc74817f\"><code>a82847c</code></a></td><td><code>Trac #32242: use fallback defaults for $INFOPATH.</code></td></tr></table>\n",
    "created_at": "2021-07-20T17:00:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519526",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a82847c7617969350dbc409c6821d10abc74817f"><code>a82847c</code></a></td><td><code>Trac #32242: use fallback defaults for $INFOPATH.</code></td></tr></table>




---

archive/issue_comments_519527.json:
```json
{
    "body": "Changed commit from **[`c4f6938`](https://github.com/sagemath/sagetrac-mirror/commit/c4f693803fdc7deb904bb85c7352f6327f338a66)** to **[`a82847c`](https://github.com/sagemath/sagetrac-mirror/commit/a82847c7617969350dbc409c6821d10abc74817f)**",
    "created_at": "2021-07-20T17:00:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519527",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c4f6938`](https://github.com/sagemath/sagetrac-mirror/commit/c4f693803fdc7deb904bb85c7352f6327f338a66)** to **[`a82847c`](https://github.com/sagemath/sagetrac-mirror/commit/a82847c7617969350dbc409c6821d10abc74817f)**



---

archive/issue_comments_519528.json:
```json
{
    "body": "Work Issues: **reduce ticket to adding info as optional package**",
    "created_at": "2021-07-24T18:47:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519528",
    "user": "https://github.com/mkoeppe"
}
```

Work Issues: **reduce ticket to adding info as optional package**



---

archive/issue_events_444757.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-24T18:47:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32242#event-444757"
}
```



---

archive/issue_events_444758.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-24T18:47:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32242#event-444758"
}
```



---

archive/issue_events_444759.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-07-29T22:04:00Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32242#event-444759"
}
```



---

archive/issue_events_444760.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-07-29T22:04:00Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32242#event-444760"
}
```



---

archive/issue_comments_519529.json:
```json
{
    "body": "Dependencies: **#32302**",
    "created_at": "2021-07-29T22:04:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519529",
    "user": "https://github.com/orlitzky"
}
```

Dependencies: **#32302**



---

archive/issue_comments_519530.json:
```json
{
    "body": "<div id=\"comment:26\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2acc06eb7da60821a8e602a1c8fc83657f918765\"><code>2acc06e</code></a></td><td><code>Trac #32302: drop SINGULAR_EXECUTABLE from src/bin/sage-env.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fde32def9c77db3d7c22fce449cb2e9b7650d9f7\"><code>fde32de</code></a></td><td><code>Trac #32242: new optional package for the standalone GNU Info reader.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7d1e61b1652190e2e8930b674566e3247f19907a\"><code>7d1e61b</code></a></td><td><code>Trac #32242: use fallback defaults for $INFOPATH.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/56186bfe468b57cdc0928bb9f442235129f90989\"><code>56186bf</code></a></td><td><code>Trac #32242: use GNU Info to obtain Singular docstrings.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/624a0e8d064ba70d40af701ec65b0cd47d9cbad6\"><code>624a0e8</code></a></td><td><code>Trac #32242: add \"optional\" tags for tests that require GNU Info.</code></td></tr></table>\n",
    "created_at": "2021-07-29T22:06:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519530",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:26"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2acc06eb7da60821a8e602a1c8fc83657f918765"><code>2acc06e</code></a></td><td><code>Trac #32302: drop SINGULAR_EXECUTABLE from src/bin/sage-env.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fde32def9c77db3d7c22fce449cb2e9b7650d9f7"><code>fde32de</code></a></td><td><code>Trac #32242: new optional package for the standalone GNU Info reader.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7d1e61b1652190e2e8930b674566e3247f19907a"><code>7d1e61b</code></a></td><td><code>Trac #32242: use fallback defaults for $INFOPATH.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/56186bfe468b57cdc0928bb9f442235129f90989"><code>56186bf</code></a></td><td><code>Trac #32242: use GNU Info to obtain Singular docstrings.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/624a0e8d064ba70d40af701ec65b0cd47d9cbad6"><code>624a0e8</code></a></td><td><code>Trac #32242: add "optional" tags for tests that require GNU Info.</code></td></tr></table>




---

archive/issue_comments_519531.json:
```json
{
    "body": "Changed commit from **[`a82847c`](https://github.com/sagemath/sagetrac-mirror/commit/a82847c7617969350dbc409c6821d10abc74817f)** to **[`624a0e8`](https://github.com/sagemath/sagetrac-mirror/commit/624a0e8d064ba70d40af701ec65b0cd47d9cbad6)**",
    "created_at": "2021-07-29T22:06:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519531",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a82847c`](https://github.com/sagemath/sagetrac-mirror/commit/a82847c7617969350dbc409c6821d10abc74817f)** to **[`624a0e8`](https://github.com/sagemath/sagetrac-mirror/commit/624a0e8d064ba70d40af701ec65b0cd47d9cbad6)**



---

archive/issue_comments_519532.json:
```json
{
    "body": "Changed work issues from **reduce ticket to adding info as optional package** to none",
    "created_at": "2021-07-29T22:25:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519532",
    "user": "https://github.com/orlitzky"
}
```

Changed work issues from **reduce ticket to adding info as optional package** to none



---

archive/issue_events_444761.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-07-29T22:25:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32242#event-444761"
}
```



---

archive/issue_events_444762.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-07-29T22:25:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32242#event-444762"
}
```



---

archive/issue_comments_519533.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,25 @@\n-In the description of #29024, a few problems are listed as prerequisites for accepting a system installation of Singular. Basically, they ask that we either use singular in a less crazy manner, or find a way to make our existing hacks work with a system copy of singular.\n+Our Singular interface currently contains a hand-written parser for Singular's \"info\" file. In this ticket, we add an optional GNU Info package to parse this file instead.\n \n-One of those issues is that the `sage/interfaces/singular.py` is using an environment variable `SINGULARPATH` to guess at the location where Singular's Info file is installed, so that it can be manually parsed.\n+Relative to running \"info\", the hand-written parser has several drawbacks:\n \n-In the interest of using Singular in a less crazy manner, I propose we add the standalone GNU \"info\" as a new package, and use it to read Singular's documentation from wherever it is configured to do so. This eliminates two of the problems in #29024.\n+* The extra code is a maintenance burden. We should not be wasting\n+  our time (poorly) reimplementing standard tools.\n \n+* The custom parser is buggy. For example, it is supposed to raise a\n+  `KeyError` when documentation for a non-existent function is\n+  requested. However, the parser does not keep track of what section\n+  it's in, so, for example, `get_docstring(\"Preface\")` will happily\n+  return the contents of the preface even though \"Preface\" is not a\n+  Singular function.\n+\n+* The first time documentation is requested, the entire info file\n+  (see above) is loaded into a dictionary. With the Singular info\n+  file currently weighing in at around 11MiB, this is wasting a\n+  good chunk of memory.\n+\n+* The `singular_console()` itself tries to launch GNU Info to display\n+  its interactive help, and cannot use our hand-written parser.\n+\n+The one downside to requiring \"info\" is that it would add a new runtime dependency to sagelib. To avoid that, we make GNU Info optional, and suggest to the user that he install it when he tries to read Singular's documentation.\n+\n+GNU Info (or its superset, Texinfo) are widespread, portable, and easy to install on all of the systems we support, so in most cases this should be a \"free\" improvement.\n``````\n",
    "created_at": "2021-07-29T22:25:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519533",
    "user": "https://github.com/orlitzky"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,25 @@
-In the description of #29024, a few problems are listed as prerequisites for accepting a system installation of Singular. Basically, they ask that we either use singular in a less crazy manner, or find a way to make our existing hacks work with a system copy of singular.
+Our Singular interface currently contains a hand-written parser for Singular's "info" file. In this ticket, we add an optional GNU Info package to parse this file instead.
 
-One of those issues is that the `sage/interfaces/singular.py` is using an environment variable `SINGULARPATH` to guess at the location where Singular's Info file is installed, so that it can be manually parsed.
+Relative to running "info", the hand-written parser has several drawbacks:
 
-In the interest of using Singular in a less crazy manner, I propose we add the standalone GNU "info" as a new package, and use it to read Singular's documentation from wherever it is configured to do so. This eliminates two of the problems in #29024.
+* The extra code is a maintenance burden. We should not be wasting
+  our time (poorly) reimplementing standard tools.
 
+* The custom parser is buggy. For example, it is supposed to raise a
+  `KeyError` when documentation for a non-existent function is
+  requested. However, the parser does not keep track of what section
+  it's in, so, for example, `get_docstring("Preface")` will happily
+  return the contents of the preface even though "Preface" is not a
+  Singular function.
+
+* The first time documentation is requested, the entire info file
+  (see above) is loaded into a dictionary. With the Singular info
+  file currently weighing in at around 11MiB, this is wasting a
+  good chunk of memory.
+
+* The `singular_console()` itself tries to launch GNU Info to display
+  its interactive help, and cannot use our hand-written parser.
+
+The one downside to requiring "info" is that it would add a new runtime dependency to sagelib. To avoid that, we make GNU Info optional, and suggest to the user that he install it when he tries to read Singular's documentation.
+
+GNU Info (or its superset, Texinfo) are widespread, portable, and easy to install on all of the systems we support, so in most cases this should be a "free" improvement.
``````




---

archive/issue_comments_519534.json:
```json
{
    "body": "<div id=\"comment:27\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2acc06eb7da60821a8e602a1c8fc83657f918765\"><code>2acc06e</code></a></td><td><code>Trac #32302: drop SINGULAR_EXECUTABLE from src/bin/sage-env.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fde32def9c77db3d7c22fce449cb2e9b7650d9f7\"><code>fde32de</code></a></td><td><code>Trac #32242: new optional package for the standalone GNU Info reader.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7d1e61b1652190e2e8930b674566e3247f19907a\"><code>7d1e61b</code></a></td><td><code>Trac #32242: use fallback defaults for $INFOPATH.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/56186bfe468b57cdc0928bb9f442235129f90989\"><code>56186bf</code></a></td><td><code>Trac #32242: use GNU Info to obtain Singular docstrings.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/624a0e8d064ba70d40af701ec65b0cd47d9cbad6\"><code>624a0e8</code></a></td><td><code>Trac #32242: add \"optional\" tags for tests that require GNU Info.</code></td></tr></table>\n",
    "created_at": "2021-07-29T22:25:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519534",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:27"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2acc06eb7da60821a8e602a1c8fc83657f918765"><code>2acc06e</code></a></td><td><code>Trac #32302: drop SINGULAR_EXECUTABLE from src/bin/sage-env.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fde32def9c77db3d7c22fce449cb2e9b7650d9f7"><code>fde32de</code></a></td><td><code>Trac #32242: new optional package for the standalone GNU Info reader.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7d1e61b1652190e2e8930b674566e3247f19907a"><code>7d1e61b</code></a></td><td><code>Trac #32242: use fallback defaults for $INFOPATH.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/56186bfe468b57cdc0928bb9f442235129f90989"><code>56186bf</code></a></td><td><code>Trac #32242: use GNU Info to obtain Singular docstrings.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/624a0e8d064ba70d40af701ec65b0cd47d9cbad6"><code>624a0e8</code></a></td><td><code>Trac #32242: add "optional" tags for tests that require GNU Info.</code></td></tr></table>




---

archive/issue_comments_519535.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nIt's now completely optional. When \"info\" is not installed, you'll be prodded to install it:\n\n```\nsage: singular.align?                                                           \nSignature:   singular.align(*args, **kwds)\nType:        SingularFunction\nString form: align\nFile:        ~/src/sage.git/local/lib/python3.9/site-packages/sage/interfaces/singular.py\nDocstring:  \nThis function is an automatically generated pexpect wrapper around the\nSingular function 'align'.\n\nEXAMPLES:\n\n   sage: groebner = singular.groebner\n   sage: P.<x, y> = PolynomialRing(QQ)\n   sage: I = P.ideal(x^2-y, y+x)\n   sage: groebner(singular(I))\n   x+y,\n   y^2-y\n\nThe relevant Singular documentation will be shown here if you install\nGNU Texinfo, the stand-alone GNU Info program, or the SageMath \"info\"\nSPKG.\n```",
    "created_at": "2021-07-29T22:27:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519535",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:28" align="right">comment:28</div>

It's now completely optional. When "info" is not installed, you'll be prodded to install it:

```
sage: singular.align?                                                           
Signature:   singular.align(*args, **kwds)
Type:        SingularFunction
String form: align
File:        ~/src/sage.git/local/lib/python3.9/site-packages/sage/interfaces/singular.py
Docstring:  
This function is an automatically generated pexpect wrapper around the
Singular function 'align'.

EXAMPLES:

   sage: groebner = singular.groebner
   sage: P.<x, y> = PolynomialRing(QQ)
   sage: I = P.ideal(x^2-y, y+x)
   sage: groebner(singular(I))
   x+y,
   y^2-y

The relevant Singular documentation will be shown here if you install
GNU Texinfo, the stand-alone GNU Info program, or the SageMath "info"
SPKG.
```



---

archive/issue_comments_519536.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nI have opened #32323 for the uncontroversial part \"Add GNU info as an optional package\".",
    "created_at": "2021-08-01T21:08:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519536",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:29" align="right">comment:29</div>

I have opened #32323 for the uncontroversial part "Add GNU info as an optional package".



---

archive/issue_events_444763.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2021-12-02T00:43:02Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "title_is": "Use GNU Info to parse singular's Info file",
    "title_was": "Use GNU Info (new package) to parse singular's Info file",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32242#event-444763"
}
```



---

archive/issue_comments_519537.json:
```json
{
    "body": "<div id=\"comment:31\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cdfa63c9680f741a40e1b127a500ec08a0ae9426\"><code>cdfa63c</code></a></td><td><code>Trac #32242: use GNU Info to obtain Singular docstrings.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/137a9182a02d4aa329a78c2e936b48431c1e9017\"><code>137a918</code></a></td><td><code>Trac #32242: add \"optional\" tags for tests that require GNU Info.</code></td></tr></table>\n",
    "created_at": "2021-12-02T00:59:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519537",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cdfa63c9680f741a40e1b127a500ec08a0ae9426"><code>cdfa63c</code></a></td><td><code>Trac #32242: use GNU Info to obtain Singular docstrings.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/137a9182a02d4aa329a78c2e936b48431c1e9017"><code>137a918</code></a></td><td><code>Trac #32242: add "optional" tags for tests that require GNU Info.</code></td></tr></table>




---

archive/issue_comments_519538.json:
```json
{
    "body": "Changed commit from **[`624a0e8`](https://github.com/sagemath/sagetrac-mirror/commit/624a0e8d064ba70d40af701ec65b0cd47d9cbad6)** to **[`137a918`](https://github.com/sagemath/sagetrac-mirror/commit/137a9182a02d4aa329a78c2e936b48431c1e9017)**",
    "created_at": "2021-12-02T00:59:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32242#issuecomment-519538",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`624a0e8`](https://github.com/sagemath/sagetrac-mirror/commit/624a0e8d064ba70d40af701ec65b0cd47d9cbad6)** to **[`137a918`](https://github.com/sagemath/sagetrac-mirror/commit/137a9182a02d4aa329a78c2e936b48431c1e9017)**



---

archive/issue_events_444764.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-27T01:03:43Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32242#event-444764"
}
```



---

archive/issue_events_444765.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-27T01:03:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32242#event-444765"
}
```



---

archive/issue_events_444766.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32242#event-444766"
}
```



---

archive/issue_events_444767.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32242#event-444767"
}
```



---

archive/issue_events_444768.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T05:25:02Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32242#event-444768"
}
```



---

archive/issue_events_444769.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T05:25:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32242",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32242#event-444769"
}
```
