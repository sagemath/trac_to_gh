# Issue 32894: split out a separate Python package primecountpy

archive/issues_032657.json:
```json
{
    "body": "This is a followup to #25009, and also resolves the bugs mentioned in  #24960.\n\nHere is my attempt (WIP) to create such a package:\nhttps://github.com/dimpase/primecountpy \n\nOn PyPI: https://pypi.org/project/primecountpy/\n\nCC:  @mkoeppe\n\nBranch/Commit: 74b38459edb9c9ae7417883adf15eba1e981631d\n\nReviewer: Matthias Koeppe\n\nAuthor: Dima Pasechnik\n\nDependencies: #25009\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/32894\n\n",
    "closed_at": "2021-12-23T20:25:59Z",
    "created_at": "2021-11-18T10:43:18Z",
    "labels": [
        "component: packages: standard",
        "critical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "split out a separate Python package primecountpy",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32894",
    "user": "https://github.com/dimpase"
}
```
This is a followup to #25009, and also resolves the bugs mentioned in  #24960.

Here is my attempt (WIP) to create such a package:
https://github.com/dimpase/primecountpy 

On PyPI: https://pypi.org/project/primecountpy/

CC:  @mkoeppe

Branch/Commit: 74b38459edb9c9ae7417883adf15eba1e981631d

Reviewer: Matthias Koeppe

Author: Dima Pasechnik

Dependencies: #25009

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/32894





---

archive/issue_comments_497430.json:
```json
{
    "body": "<a id='comment:2'></a>As you know, https://pypi.org/project/primecount/ is already taken...",
    "created_at": "2021-11-18T18:12:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497430",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>As you know, https://pypi.org/project/primecount/ is already taken...



---

archive/issue_comments_497431.json:
```json
{
    "body": "<a id='comment:3'></a>I must say I don't quite know what exactly pypi package name is, and whether anything beyond changes in MANIFEST.in and setup.py is needed.\nCan the module name still be the same, `primecount` ?\n\nWe'd call it `pyprimecount` instead.",
    "created_at": "2021-11-18T19:57:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497431",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>I must say I don't quite know what exactly pypi package name is, and whether anything beyond changes in MANIFEST.in and setup.py is needed.
Can the module name still be the same, `primecount` ?

We'd call it `pyprimecount` instead.



---

archive/issue_comments_497432.json:
```json
{
    "body": "<a id='comment:4'></a>I explained it recently in https://groups.google.com/g/sage-devel/c/p4MO6L95s7E/m/yZF93ewIBAAJ, take a look",
    "created_at": "2021-11-18T21:23:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497432",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>I explained it recently in https://groups.google.com/g/sage-devel/c/p4MO6L95s7E/m/yZF93ewIBAAJ, take a look



---

archive/issue_comments_497433.json:
```json
{
    "body": "<a id='comment:5'></a>OK, thanks. Another thing I don't understand is how the C++ library prinecount is meant to be provided. It's not something too standard to assume it's just installed.\n\n Does it mean to be a non-python dependency of Sage? Or of (py)prinecount?",
    "created_at": "2021-11-18T22:00:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497433",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>OK, thanks. Another thing I don't understand is how the C++ library prinecount is meant to be provided. It's not something too standard to assume it's just installed.

 Does it mean to be a non-python dependency of Sage? Or of (py)prinecount?



---

archive/issue_comments_497434.json:
```json
{
    "body": "<a id='comment:6'></a>When `pyprimecount` is installed from a source distribution, it will just assume that the necessary library is available. Python packages do not have a way to declare non-Python dependencies.\n\nLater one may consider to build wheels that include a copy of the shared library.\nThis is what for example `numpy` does regarding BLAS: The source distribution certainly does not contain a copy of BLAS, but the wheels ship with a copy of the OpenBLAS shared library.",
    "created_at": "2021-11-18T22:31:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497434",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>When `pyprimecount` is installed from a source distribution, it will just assume that the necessary library is available. Python packages do not have a way to declare non-Python dependencies.

Later one may consider to build wheels that include a copy of the shared library.
This is what for example `numpy` does regarding BLAS: The source distribution certainly does not contain a copy of BLAS, but the wheels ship with a copy of the OpenBLAS shared library.



---

archive/issue_comments_497435.json:
```json
{
    "body": "<a id='comment:7'></a>On the Sage side, there will be two SPKGs: One for `primecount`, one for `pyprimecount`. This mirrors what is done, for example, for `ppl` and `pplpy`. The SPKG `dependencies` of `pyprimecount` include `primecount`; so when `pyprimecount` is pip-installed, the library has already been installed.",
    "created_at": "2021-11-18T22:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497435",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>On the Sage side, there will be two SPKGs: One for `primecount`, one for `pyprimecount`. This mirrors what is done, for example, for `ppl` and `pplpy`. The SPKG `dependencies` of `pyprimecount` include `primecount`; so when `pyprimecount` is pip-installed, the library has already been installed.



---

archive/issue_comments_497436.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n This is a followup to #25009\n \n-Here is my failing attempt to create such a package:\n-https://github.com/dimpase/primecount \n+Here is my attempt (WIP) to create such a package:\n+https://github.com/dimpase/primecountpy \n \n Attention of Cython/packaging experts needed\n \n``````\n",
    "created_at": "2021-11-19T11:23:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497436",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,7 @@
 This is a followup to #25009
 
-Here is my failing attempt to create such a package:
-https://github.com/dimpase/primecount 
+Here is my attempt (WIP) to create such a package:
+https://github.com/dimpase/primecountpy 
 
 Attention of Cython/packaging experts needed
 
``````




---

archive/issue_comments_497437.json:
```json
{
    "body": "<a id='comment:8'></a>after a very careful consideration, decided to rename it `primecountpy`.",
    "created_at": "2021-11-19T11:23:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497437",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>after a very careful consideration, decided to rename it `primecountpy`.



---

archive/issue_comments_497438.json:
```json
{
    "body": "<a id='comment:10'></a>OK, so prinecountpy works (needs setting up proper tests, etc), but other than that, what else is needed on that side?Some pypi/pip magic? \n\n(on Sage's side clearly code to be removed and replaced by hopefully clear something...)",
    "created_at": "2021-11-20T14:39:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497438",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>OK, so prinecountpy works (needs setting up proper tests, etc), but other than that, what else is needed on that side?Some pypi/pip magic? 

(on Sage's side clearly code to be removed and replaced by hopefully clear something...)



---

archive/issue_comments_497439.json:
```json
{
    "body": "<a id='comment:11'></a>when primecountpy is ready, use `setup.py sdist` to create an sdist and upload to PyPI with `twine`\n\nThen on the Sage side, use `./sage -package create primecountpy --pypi`",
    "created_at": "2021-11-20T16:47:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497439",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>when primecountpy is ready, use `setup.py sdist` to create an sdist and upload to PyPI with `twine`

Then on the Sage side, use `./sage -package create primecountpy --pypi`



---

archive/issue_comments_497440.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,9 @@\n+This is a followup to #25009\n \n+Here is my attempt (WIP) to create such a package:\n+https://github.com/dimpase/primecountpy \n+\n+On PyPI: https://pypi.org/project/primecountpy/\n \n Comment: 1\n \n``````\n",
    "created_at": "2021-11-25T12:13:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497440",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,9 @@
+This is a followup to #25009
 
+Here is my attempt (WIP) to create such a package:
+https://github.com/dimpase/primecountpy 
+
+On PyPI: https://pypi.org/project/primecountpy/
 
 Comment: 1
 
``````




---

archive/issue_comments_497441.json:
```json
{
    "body": "<a id='comment:13'></a>OK, here it is: https://pypi.org/project/primecountpy/",
    "created_at": "2021-11-25T12:13:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497441",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'></a>OK, here it is: https://pypi.org/project/primecountpy/



---

archive/issue_comments_497442.json:
```json
{
    "body": "<a id='comment:14'></a>Last 10 new commits:",
    "created_at": "2021-11-25T13:11:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497442",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:14'></a>Last 10 new commits:



---

archive/issue_comments_497443.json:
```json
{
    "body": "<a id='comment:15'></a>it works, apparently.",
    "created_at": "2021-11-25T13:45:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497443",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'></a>it works, apparently.



---

archive/issue_comments_497444.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-11-25T13:45:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497444",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_497445.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-25T13:54:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497445",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_497446.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,9 @@\n+This is a followup to #25009, and also resolves the bugs mentioned in  #24960.\n \n+Here is my attempt (WIP) to create such a package:\n+https://github.com/dimpase/primecountpy \n+\n+On PyPI: https://pypi.org/project/primecountpy/\n \n Comment: 1\n \n``````\n",
    "created_at": "2021-11-25T13:55:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497446",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,9 @@
+This is a followup to #25009, and also resolves the bugs mentioned in  #24960.
 
+Here is my attempt (WIP) to create such a package:
+https://github.com/dimpase/primecountpy 
+
+On PyPI: https://pypi.org/project/primecountpy/
 
 Comment: 1
 
``````




---

archive/issue_comments_497447.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-26T23:40:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497447",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_497448.json:
```json
{
    "body": "<a id='comment:19'></a>this should go to #25009",
    "created_at": "2021-11-26T23:42:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497448",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>this should go to #25009



---

archive/issue_comments_497449.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-11-27T00:02:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497449",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_497450.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-11-29T20:16:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497450",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_497451.json:
```json
{
    "body": "<a id='comment:23'></a>Shouldn't `sage.interfaces.primecount` provide some deprecated re-imports?",
    "created_at": "2021-11-29T20:23:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497451",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>Shouldn't `sage.interfaces.primecount` provide some deprecated re-imports?



---

archive/issue_comments_497452.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-11-29T20:44:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497452",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_497453.json:
```json
{
    "body": "<a id='comment:25'></a>`build/pkgs/primecountpy/dependencies` is still missing the dependency `cython`. It is NOT part of `PYTHON_TOOLCHAIN` as you can see in `build/make/Makefile.in`",
    "created_at": "2021-11-29T20:44:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497453",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>`build/pkgs/primecountpy/dependencies` is still missing the dependency `cython`. It is NOT part of `PYTHON_TOOLCHAIN` as you can see in `build/make/Makefile.in`



---

archive/issue_comments_497454.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-30T09:46:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497454",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_497455.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-11-30T09:47:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497455",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_497456.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-12-01T13:52:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497456",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_497457.json:
```json
{
    "body": "<a id='comment:29'></a>\n```\n+from primecountpy.primecount import prime_pi as _prime_pi\n+from primecountpy.primecount import phi as _phi\n```\nI think this should use `lazy_import` with a `deprecation` parameter",
    "created_at": "2021-12-01T20:17:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497457",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>
```
+from primecountpy.primecount import prime_pi as _prime_pi
+from primecountpy.primecount import phi as _phi
```
I think this should use `lazy_import` with a `deprecation` parameter



---

archive/issue_comments_497458.json:
```json
{
    "body": "<a id='comment:30'></a>What does one want to deprecate here?\n\nlazy_import is a good idea, yes.",
    "created_at": "2021-12-01T20:54:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497458",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:30'></a>What does one want to deprecate here?

lazy_import is a good idea, yes.



---

archive/issue_comments_497459.json:
```json
{
    "body": "<a id='comment:31'></a>Sorry, I was looking in the wrong place. I should have said: `sage.interfaces.primecount`  cannot be eliminated immediately, instead it should use `lazy_import` with a `deprecation` parameter to re-export the functions provided by `primecountpy`.",
    "created_at": "2021-12-01T21:00:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497459",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'></a>Sorry, I was looking in the wrong place. I should have said: `sage.interfaces.primecount`  cannot be eliminated immediately, instead it should use `lazy_import` with a `deprecation` parameter to re-export the functions provided by `primecountpy`.



---

archive/issue_comments_497460.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-12-02T11:48:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497460",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_497461.json:
```json
{
    "body": "<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-12-02T14:36:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497461",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_497462.json:
```json
{
    "body": "<a id='comment:34'></a>Replying to [comment:33 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                           |                                                       |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|\n> |[9cfdad8](https://git.sagemath.org/sage.git/commit/?id=9cfdad8bbb3bc7371d8c45f01e23d1e31e5cf732)|`deprecate sage.interfaces.primecount, not just remove`|\n\n\nThis should resolve comment:29 - although perhaps not perfectly, as this is now Python-only. I don't know how to deprecate Cython functions.",
    "created_at": "2021-12-02T14:38:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497462",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:34'></a>Replying to [comment:33 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                           |                                                       |
> |-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|
> |[9cfdad8](https://git.sagemath.org/sage.git/commit/?id=9cfdad8bbb3bc7371d8c45f01e23d1e31e5cf732)|`deprecate sage.interfaces.primecount, not just remove`|


This should resolve comment:29 - although perhaps not perfectly, as this is now Python-only. I don't know how to deprecate Cython functions.



---

archive/issue_comments_497463.json:
```json
{
    "body": "<a id='comment:35'></a>Replying to [comment:32 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                           |                      |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|----------------------|\n> |[30346c0](https://git.sagemath.org/sage.git/commit/?id=30346c0f7a5866249ee791d5a5b3a00840f20143)|`cysignals are needed`|\n\n\nNow the CI on https://github.com/dimpase/primecountpy/runs/4394526057\npasses. (The whole platforms shebang is still running).",
    "created_at": "2021-12-02T14:41:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497463",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:35'></a>Replying to [comment:32 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                           |                      |
> |-------------------------------------------------------------------------------------------------------------------------------------------|----------------------|
> |[30346c0](https://git.sagemath.org/sage.git/commit/?id=30346c0f7a5866249ee791d5a5b3a00840f20143)|`cysignals are needed`|


Now the CI on https://github.com/dimpase/primecountpy/runs/4394526057
passes. (The whole platforms shebang is still running).



---

archive/issue_comments_497464.json:
```json
{
    "body": "<a id='comment:36'></a>Replying to [comment:34 dimpase]:\n> This should resolve comment:29 - although perhaps not perfectly, as this is now Python-only. \n\n\nYes, this is what I had in mind, thanks.\n\n> I don't know how to deprecate Cython functions.\n\n\nWe don't have a mechanism for that.",
    "created_at": "2021-12-02T18:07:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497464",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:36'></a>Replying to [comment:34 dimpase]:
> This should resolve comment:29 - although perhaps not perfectly, as this is now Python-only. 


Yes, this is what I had in mind, thanks.

> I don't know how to deprecate Cython functions.


We don't have a mechanism for that.



---

archive/issue_comments_497465.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-12-02T18:56:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497465",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_497466.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2021-12-02T20:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497466",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_497467.json:
```json
{
    "body": "<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2021-12-02T20:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497467",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_497468.json:
```json
{
    "body": "<a id='comment:39'></a>a trivial addition.",
    "created_at": "2021-12-02T20:42:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497468",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:39'></a>a trivial addition.



---

archive/issue_comments_497469.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-12-02T20:42:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497469",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_497470.json:
```json
{
    "body": "<a id='comment:40'></a>Can you add `primesieve` conda package too?",
    "created_at": "2021-12-05T04:02:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497470",
    "user": "https://github.com/isuruf"
}
```

<a id='comment:40'></a>Can you add `primesieve` conda package too?



---

archive/issue_comments_497471.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2021-12-05T12:11:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497471",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_497472.json:
```json
{
    "body": "<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2021-12-05T12:11:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497472",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_497473.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-12-05T12:12:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497473",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_497474.json:
```json
{
    "body": "<a id='comment:42'></a>Replying to [comment:40 isuruf]:\n> Can you add `primesieve` conda package too?\n\ndone.",
    "created_at": "2021-12-05T12:12:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497474",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:42'></a>Replying to [comment:40 isuruf]:
> Can you add `primesieve` conda package too?

done.



---

archive/issue_comments_497475.json:
```json
{
    "body": "<a id='comment:43'></a>Test fail, e.g. \n\n```\nFile \"src/sage/plot/plot.py\", line 1753, in sage.plot.plot.plot\nFailed example:\n    plot(lambda x: prime_pi(x), (x, 1, 100), exclude=jumps)\nExpected:\n    Graphics object consisting of 26 graphics primitives\nGot:\n    verbose 0 (3839: plot.py, generate_plot_points) WARNING: When plotting, failed to evaluate function at 248 points.\n    verbose 0 (3839: plot.py, generate_plot_points) Last error message: 'unable to simplify to float approximation'\n    Graphics object consisting of 0 graphics primitives\n**********************************************************************\n1 item had failures:\n   1 of 147 in sage.plot.plot.plot\n    [423 tests, 1 failure, 28.78 s]\n----------------------------------------------------------------------\nsage -t --warn-long 47.7 --random-seed=57011699320160764553253619770787736483 src/sage/plot/plot.py  # 1 doctest failed\n```",
    "created_at": "2021-12-12T17:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497475",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:43'></a>Test fail, e.g. 

```
File "src/sage/plot/plot.py", line 1753, in sage.plot.plot.plot
Failed example:
    plot(lambda x: prime_pi(x), (x, 1, 100), exclude=jumps)
Expected:
    Graphics object consisting of 26 graphics primitives
Got:
    verbose 0 (3839: plot.py, generate_plot_points) WARNING: When plotting, failed to evaluate function at 248 points.
    verbose 0 (3839: plot.py, generate_plot_points) Last error message: 'unable to simplify to float approximation'
    Graphics object consisting of 0 graphics primitives
**********************************************************************
1 item had failures:
   1 of 147 in sage.plot.plot.plot
    [423 tests, 1 failure, 28.78 s]
----------------------------------------------------------------------
sage -t --warn-long 47.7 --random-seed=57011699320160764553253619770787736483 src/sage/plot/plot.py  # 1 doctest failed
```



---

archive/issue_comments_497476.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-12-12T17:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497476",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_497477.json:
```json
{
    "body": "<a id='comment:44'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2021-12-13T00:36:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497477",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:44'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_497478.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-12-13T18:16:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497478",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_497479.json:
```json
{
    "body": "<a id='comment:45'></a>rebased an added `\u200b74b3845\tallow float inputs for prime_pi` to deal with the need for `prime_pi` to accept floats as input.\nAll the relevant tests pass.",
    "created_at": "2021-12-13T18:16:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497479",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:45'></a>rebased an added `â€‹74b3845	allow float inputs for prime_pi` to deal with the need for `prime_pi` to accept floats as input.
All the relevant tests pass.



---

archive/issue_comments_497480.json:
```json
{
    "body": "<a id='comment:46'></a>LGTM.",
    "created_at": "2021-12-13T19:09:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497480",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:46'></a>LGTM.



---

archive/issue_comments_497481.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-12-13T19:09:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497481",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_497482.json:
```json
{
    "body": "<a id='comment:47'></a>Marking this ticket \"critical\" in light of #33054 because it adds the conda package information",
    "created_at": "2021-12-21T01:39:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497482",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:47'></a>Marking this ticket "critical" in light of #33054 because it adds the conda package information



---

archive/issue_comments_497483.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2021-12-21T01:39:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497483",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from major to critical.



---

archive/issue_events_086945.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-12-23T20:25:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32894#event-86945"
}
```



---

archive/issue_comments_497484.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-12-23T20:25:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32894#issuecomment-497484",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
