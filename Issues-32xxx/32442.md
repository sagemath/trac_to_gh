# Issue 32442: ./configure: Make --with-sage-venv=auto the default

archive/issues_032205.json:
```json
{
    "assignees": [],
    "body": "Since Sage 9.4, it is possible to use an installation tree for Python packages separate from SAGE_LOCAL:\nhttps://wiki.sagemath.org/ReleaseTours/sage-9.4#For_developers:_..2Fconfigure_--prefix.3DSAGE_LOCAL_--with-sage-venv.3DSAGE_VENV\n\nIn this ticket we make a new setting `--with-sage-venv=auto` the default, which means: \n- if `--prefix` has not been used (so `SAGE_LOCAL=local`), then set `SAGE_VENV` to `local/var/lib/sage/venv-PYTHONVERSION`\nUsers can also pass `--with-sage-venv` or `--with-sage-venv=yes`, which means to unconditionally set `SAGE_VENV` to `SAGE_LOCAL/var/lib/sage/venv-PYTHONVERSION`.\n\n(We keep the layout as is in incremental builds.)\n\nBy keying the default name to the Python version, we ensure that if the system python version changes (either because of system updates or explicit reconfiguration), we create a fresh venv and automatically rebuild all Python packages, eliminating problems such as the one reported in https://groups.google.com/g/sage-devel/c/hZPHxqn_Cyk/m/fOAZCUWHAQAJ\n\nMoreover, at `config.status` time, we create a symbolic link `SAGE_ROOT/venv -> SAGE_VENV` (overwriting an existing symbolic link)\n\nThe link is for easy access by users and is not used otherwise. Instead of `local/lib/python3/site-packages/` or `local/bin/sage`, use `venv/local/lib/python3/site-packages/` etc.\n\nFor symmetry, we also create a symbolic link `SAGE_ROOT/prefix -> SAGE_LOCAL`. (This generalizes what is already done by `tox local`.)\n\nUsers will still be able to restore the previous behavior by using `--with-sage-venv=no`, or use a specific path as in `--with-sage-venv=/path/to/venv`.\n\n\nCC:  @dimpase @jhpalmieri\n\nReviewer: **John Palmieri**\n\nAuthor: **Matthias Koeppe**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/32442_\n\n",
    "closed_at": "2021-10-19T22:01:59Z",
    "created_at": "2021-08-31T19:59:32Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20build%3A%20configure",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "./configure: Make --with-sage-venv=auto the default",
    "type": "issue",
    "updated_at": "2021-10-19T22:01:59Z",
    "url": "https://github.com/sagemath/sage/issues/32442",
    "user": "https://github.com/mkoeppe"
}
```
Since Sage 9.4, it is possible to use an installation tree for Python packages separate from SAGE_LOCAL:
https://wiki.sagemath.org/ReleaseTours/sage-9.4#For_developers:_..2Fconfigure_--prefix.3DSAGE_LOCAL_--with-sage-venv.3DSAGE_VENV

In this ticket we make a new setting `--with-sage-venv=auto` the default, which means: 
- if `--prefix` has not been used (so `SAGE_LOCAL=local`), then set `SAGE_VENV` to `local/var/lib/sage/venv-PYTHONVERSION`
Users can also pass `--with-sage-venv` or `--with-sage-venv=yes`, which means to unconditionally set `SAGE_VENV` to `SAGE_LOCAL/var/lib/sage/venv-PYTHONVERSION`.

(We keep the layout as is in incremental builds.)

By keying the default name to the Python version, we ensure that if the system python version changes (either because of system updates or explicit reconfiguration), we create a fresh venv and automatically rebuild all Python packages, eliminating problems such as the one reported in https://groups.google.com/g/sage-devel/c/hZPHxqn_Cyk/m/fOAZCUWHAQAJ

Moreover, at `config.status` time, we create a symbolic link `SAGE_ROOT/venv -> SAGE_VENV` (overwriting an existing symbolic link)

The link is for easy access by users and is not used otherwise. Instead of `local/lib/python3/site-packages/` or `local/bin/sage`, use `venv/local/lib/python3/site-packages/` etc.

For symmetry, we also create a symbolic link `SAGE_ROOT/prefix -> SAGE_LOCAL`. (This generalizes what is already done by `tox local`.)

Users will still be able to restore the previous behavior by using `--with-sage-venv=no`, or use a specific path as in `--with-sage-venv=/path/to/venv`.


CC:  @dimpase @jhpalmieri

Reviewer: **John Palmieri**

Author: **Matthias Koeppe**

_Issue created by migration from https://trac.sagemath.org/ticket/32442_





---

archive/issue_events_414900.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-31T19:59:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414900"
}
```



---

archive/issue_events_414901.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-31T19:59:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build%3A%20configure",
    "label_color": "000080",
    "label_name": "component: build: configure",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414901"
}
```



---

archive/issue_events_414902.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-31T19:59:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414902"
}
```



---

archive/issue_events_414903.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-31T19:59:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414903"
}
```



---

archive/issue_comments_526497.json:
```json
{
    "body": "Changed dependencies from **#32286, #32387** to **#32386, #32387**",
    "created_at": "2021-08-31T20:01:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526497",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#32286, #32387** to **#32386, #32387**



---

archive/issue_comments_526498.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,16 +1,18 @@\n Since Sage 9.4, it is possible to use an installation tree for Python packages separate from SAGE_LOCAL:\n https://wiki.sagemath.org/ReleaseTours/sage-9.4#For_developers:_..2Fconfigure_--prefix.3DSAGE_LOCAL_--with-sage-venv.3DSAGE_VENV\n \n-In this ticket we make `--with-sage-venv[=yes]` the default, which will mean:\n-- set `SAGE_VENV` to `SAGE_LOCAL/var/lib/sage/venv-PYTHONVERSION`\n+In this ticket we make a new setting `--with-sage-venv=auto` the default, which means: \n+- if `--prefix` has not been used (so `SAGE_LOCAL=local`), then \n+set `SAGE_VENV` to `local/var/lib/sage/venv-PYTHONVERSION`\n+Users can also pass `--with-sage-venv` or `--with-sage-venv=yes`, which means to unconditionally set `SAGE_VENV` to `SAGE_LOCAL/var/lib/sage/venv-PYTHONVERSION`.\n \n-  By keying the name to the Python version, we ensure that if the system python version changes, we create a fresh venv and automatically rebuild all Python packages, eliminating problems such as the one reported in https://groups.google.com/g/sage-devel/c/hZPHxqn_Cyk/m/fOAZCUWHAQAJ\n+By keying the default name to the Python version, we ensure that if the system python version changes (either because of system updates or explicit reconfiguration), we create a fresh venv and automatically rebuild all Python packages, eliminating problems such as the one reported in https://groups.google.com/g/sage-devel/c/hZPHxqn_Cyk/m/fOAZCUWHAQAJ\n \n-- at `config.status` time, create a symbolic link `SAGE_ROOT/venv -> SAGE_VENV` (overwriting an existing symbolic link)\n+Moreover, at `config.status` time, we create a symbolic link `SAGE_ROOT/venv -> SAGE_VENV` (overwriting an existing symbolic link)\n \n-  The link is for easy access by users and is not used otherwise. Instead of `local/lib/python3/site-packages/` or `local/bin/sage`, use `venv/local/lib/python3/site-packages/` etc.\n+The link is for easy access by users and is not used otherwise. Instead of `local/lib/python3/site-packages/` or `local/bin/sage`, use `venv/local/lib/python3/site-packages/` etc.\n \n-  For symmetry, we also create a symbolic link `SAGE_ROOT/prefix -> SAGE_LOCAL`. (This generalizes what is already done by `tox local`.)\n+For symmetry, we also create a symbolic link `SAGE_ROOT/prefix -> SAGE_LOCAL`. (This generalizes what is already done by `tox local`.)\n \n Users will still be able to restore the previous behavior by using `--with-sage-venv=no`, or use a specific path as in `--with-sage-venv=/path/to/venv`.\n \n``````\n",
    "created_at": "2021-09-11T02:40:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526498",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,16 +1,18 @@
 Since Sage 9.4, it is possible to use an installation tree for Python packages separate from SAGE_LOCAL:
 https://wiki.sagemath.org/ReleaseTours/sage-9.4#For_developers:_..2Fconfigure_--prefix.3DSAGE_LOCAL_--with-sage-venv.3DSAGE_VENV
 
-In this ticket we make `--with-sage-venv[=yes]` the default, which will mean:
-- set `SAGE_VENV` to `SAGE_LOCAL/var/lib/sage/venv-PYTHONVERSION`
+In this ticket we make a new setting `--with-sage-venv=auto` the default, which means: 
+- if `--prefix` has not been used (so `SAGE_LOCAL=local`), then 
+set `SAGE_VENV` to `local/var/lib/sage/venv-PYTHONVERSION`
+Users can also pass `--with-sage-venv` or `--with-sage-venv=yes`, which means to unconditionally set `SAGE_VENV` to `SAGE_LOCAL/var/lib/sage/venv-PYTHONVERSION`.
 
-  By keying the name to the Python version, we ensure that if the system python version changes, we create a fresh venv and automatically rebuild all Python packages, eliminating problems such as the one reported in https://groups.google.com/g/sage-devel/c/hZPHxqn_Cyk/m/fOAZCUWHAQAJ
+By keying the default name to the Python version, we ensure that if the system python version changes (either because of system updates or explicit reconfiguration), we create a fresh venv and automatically rebuild all Python packages, eliminating problems such as the one reported in https://groups.google.com/g/sage-devel/c/hZPHxqn_Cyk/m/fOAZCUWHAQAJ
 
-- at `config.status` time, create a symbolic link `SAGE_ROOT/venv -> SAGE_VENV` (overwriting an existing symbolic link)
+Moreover, at `config.status` time, we create a symbolic link `SAGE_ROOT/venv -> SAGE_VENV` (overwriting an existing symbolic link)
 
-  The link is for easy access by users and is not used otherwise. Instead of `local/lib/python3/site-packages/` or `local/bin/sage`, use `venv/local/lib/python3/site-packages/` etc.
+The link is for easy access by users and is not used otherwise. Instead of `local/lib/python3/site-packages/` or `local/bin/sage`, use `venv/local/lib/python3/site-packages/` etc.
 
-  For symmetry, we also create a symbolic link `SAGE_ROOT/prefix -> SAGE_LOCAL`. (This generalizes what is already done by `tox local`.)
+For symmetry, we also create a symbolic link `SAGE_ROOT/prefix -> SAGE_LOCAL`. (This generalizes what is already done by `tox local`.)
 
 Users will still be able to restore the previous behavior by using `--with-sage-venv=no`, or use a specific path as in `--with-sage-venv=/path/to/venv`.
 
``````




---

archive/issue_comments_526499.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,8 +2,7 @@\n https://wiki.sagemath.org/ReleaseTours/sage-9.4#For_developers:_..2Fconfigure_--prefix.3DSAGE_LOCAL_--with-sage-venv.3DSAGE_VENV\n \n In this ticket we make a new setting `--with-sage-venv=auto` the default, which means: \n-- if `--prefix` has not been used (so `SAGE_LOCAL=local`), then \n-set `SAGE_VENV` to `local/var/lib/sage/venv-PYTHONVERSION`\n+- if `--prefix` has not been used (so `SAGE_LOCAL=local`), then set `SAGE_VENV` to `local/var/lib/sage/venv-PYTHONVERSION`\n Users can also pass `--with-sage-venv` or `--with-sage-venv=yes`, which means to unconditionally set `SAGE_VENV` to `SAGE_LOCAL/var/lib/sage/venv-PYTHONVERSION`.\n \n By keying the default name to the Python version, we ensure that if the system python version changes (either because of system updates or explicit reconfiguration), we create a fresh venv and automatically rebuild all Python packages, eliminating problems such as the one reported in https://groups.google.com/g/sage-devel/c/hZPHxqn_Cyk/m/fOAZCUWHAQAJ\n``````\n",
    "created_at": "2021-09-11T02:40:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526499",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,8 +2,7 @@
 https://wiki.sagemath.org/ReleaseTours/sage-9.4#For_developers:_..2Fconfigure_--prefix.3DSAGE_LOCAL_--with-sage-venv.3DSAGE_VENV
 
 In this ticket we make a new setting `--with-sage-venv=auto` the default, which means: 
-- if `--prefix` has not been used (so `SAGE_LOCAL=local`), then 
-set `SAGE_VENV` to `local/var/lib/sage/venv-PYTHONVERSION`
+- if `--prefix` has not been used (so `SAGE_LOCAL=local`), then set `SAGE_VENV` to `local/var/lib/sage/venv-PYTHONVERSION`
 Users can also pass `--with-sage-venv` or `--with-sage-venv=yes`, which means to unconditionally set `SAGE_VENV` to `SAGE_LOCAL/var/lib/sage/venv-PYTHONVERSION`.
 
 By keying the default name to the Python version, we ensure that if the system python version changes (either because of system updates or explicit reconfiguration), we create a fresh venv and automatically rebuild all Python packages, eliminating problems such as the one reported in https://groups.google.com/g/sage-devel/c/hZPHxqn_Cyk/m/fOAZCUWHAQAJ
``````




---

archive/issue_comments_526500.json:
```json
{
    "body": "Branch: **[u/mkoeppe/__configure__make___with_sage_venv_the_default](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/__configure__make___with_sage_venv_the_default)**",
    "created_at": "2021-09-11T03:18:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526500",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/__configure__make___with_sage_venv_the_default](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/__configure__make___with_sage_venv_the_default)**



---

archive/issue_comments_526501.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f5be2d0bd3a77bc132c3cd18b90238d96c2164d\">2f5be2d</a></td><td><code>configure.ac, build/pkgs/python3/spkg-configure.m4: New default --with-sage-venv=auto</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f70064047c24f2ffffcdd2b4bae4aee5d8cca7c2\">f700640</a></td><td><code>configure.ac: In config.status, create convenience symlinks prefix, venv</code></td></tr></table>\n",
    "created_at": "2021-09-11T03:33:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526501",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'>Comment 5:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f5be2d0bd3a77bc132c3cd18b90238d96c2164d">2f5be2d</a></td><td><code>configure.ac, build/pkgs/python3/spkg-configure.m4: New default --with-sage-venv=auto</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f70064047c24f2ffffcdd2b4bae4aee5d8cca7c2">f700640</a></td><td><code>configure.ac: In config.status, create convenience symlinks prefix, venv</code></td></tr></table>




---

archive/issue_comments_526502.json:
```json
{
    "body": "Commit: **[f700640](https://github.com/sagemath/sagetrac-mirror/commit/f70064047c24f2ffffcdd2b4bae4aee5d8cca7c2)**",
    "created_at": "2021-09-11T03:33:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526502",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[f700640](https://github.com/sagemath/sagetrac-mirror/commit/f70064047c24f2ffffcdd2b4bae4aee5d8cca7c2)**



---

archive/issue_events_414904.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-11T03:33:11Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "title_is": "./configure: Make --with-sage-venv=auto the default",
    "title_was": "./configure: Make --with-sage-venv the default",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414904"
}
```



---

archive/issue_events_414905.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-11T03:33:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414905"
}
```



---

archive/issue_comments_526503.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2021-09-11T03:33:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526503",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_comments_526504.json:
```json
{
    "body": "Changed commit from **[f700640](https://github.com/sagemath/sagetrac-mirror/commit/f70064047c24f2ffffcdd2b4bae4aee5d8cca7c2)** to **[12cbbda](https://github.com/sagemath/sagetrac-mirror/commit/12cbbdaaf45b96b9cf680d544d0b268afd6b4258)**",
    "created_at": "2021-09-15T23:44:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526504",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[f700640](https://github.com/sagemath/sagetrac-mirror/commit/f70064047c24f2ffffcdd2b4bae4aee5d8cca7c2)** to **[12cbbda](https://github.com/sagemath/sagetrac-mirror/commit/12cbbdaaf45b96b9cf680d544d0b268afd6b4258)**



---

archive/issue_comments_526505.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b4a3845dc3f61f0547c890aa1a81b1d212c648a4\">b4a3845</a></td><td><code>m4/sage_spkg_collect.m4: If we install python3 spkg, install it in SAGE_VENV</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/12cbbdaaf45b96b9cf680d544d0b268afd6b4258\">12cbbda</a></td><td><code>configure.ac: Keep old behavior of SAGE_VENV in incremental builds</code></td></tr></table>\n",
    "created_at": "2021-09-15T23:44:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526505",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:6'>Comment 6:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b4a3845dc3f61f0547c890aa1a81b1d212c648a4">b4a3845</a></td><td><code>m4/sage_spkg_collect.m4: If we install python3 spkg, install it in SAGE_VENV</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/12cbbdaaf45b96b9cf680d544d0b268afd6b4258">12cbbda</a></td><td><code>configure.ac: Keep old behavior of SAGE_VENV in incremental builds</code></td></tr></table>




---

archive/issue_comments_526506.json:
```json
{
    "body": "Changed commit from **[12cbbda](https://github.com/sagemath/sagetrac-mirror/commit/12cbbdaaf45b96b9cf680d544d0b268afd6b4258)** to **[117fe3a](https://github.com/sagemath/sagetrac-mirror/commit/117fe3a3ed83aa97ed8c5faee347587772d00749)**",
    "created_at": "2021-09-16T00:30:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526506",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[12cbbda](https://github.com/sagemath/sagetrac-mirror/commit/12cbbdaaf45b96b9cf680d544d0b268afd6b4258)** to **[117fe3a](https://github.com/sagemath/sagetrac-mirror/commit/117fe3a3ed83aa97ed8c5faee347587772d00749)**



---

archive/issue_comments_526507.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/117fe3a3ed83aa97ed8c5faee347587772d00749\">117fe3a</a></td><td><code>build/make/Makefile.in (...-clean): Do not fail trying to uninstall if SAGE_VENV has not been created yet</code></td></tr></table>\n",
    "created_at": "2021-09-16T00:30:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526507",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:7'>Comment 7:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/117fe3a3ed83aa97ed8c5faee347587772d00749">117fe3a</a></td><td><code>build/make/Makefile.in (...-clean): Do not fail trying to uninstall if SAGE_VENV has not been created yet</code></td></tr></table>




---

archive/issue_comments_526508.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,6 +4,8 @@\n In this ticket we make a new setting `--with-sage-venv=auto` the default, which means: \n - if `--prefix` has not been used (so `SAGE_LOCAL=local`), then set `SAGE_VENV` to `local/var/lib/sage/venv-PYTHONVERSION`\n Users can also pass `--with-sage-venv` or `--with-sage-venv=yes`, which means to unconditionally set `SAGE_VENV` to `SAGE_LOCAL/var/lib/sage/venv-PYTHONVERSION`.\n+\n+(We keep the layout as is in incremental builds.)\n \n By keying the default name to the Python version, we ensure that if the system python version changes (either because of system updates or explicit reconfiguration), we create a fresh venv and automatically rebuild all Python packages, eliminating problems such as the one reported in https://groups.google.com/g/sage-devel/c/hZPHxqn_Cyk/m/fOAZCUWHAQAJ\n \n``````\n",
    "created_at": "2021-09-16T01:32:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526508",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,6 +4,8 @@
 In this ticket we make a new setting `--with-sage-venv=auto` the default, which means: 
 - if `--prefix` has not been used (so `SAGE_LOCAL=local`), then set `SAGE_VENV` to `local/var/lib/sage/venv-PYTHONVERSION`
 Users can also pass `--with-sage-venv` or `--with-sage-venv=yes`, which means to unconditionally set `SAGE_VENV` to `SAGE_LOCAL/var/lib/sage/venv-PYTHONVERSION`.
+
+(We keep the layout as is in incremental builds.)
 
 By keying the default name to the Python version, we ensure that if the system python version changes (either because of system updates or explicit reconfiguration), we create a fresh venv and automatically rebuild all Python packages, eliminating problems such as the one reported in https://groups.google.com/g/sage-devel/c/hZPHxqn_Cyk/m/fOAZCUWHAQAJ
 
``````




---

archive/issue_comments_526509.json:
```json
{
    "body": "Changed dependencies from **#32386, #32387** to none",
    "created_at": "2021-09-27T04:14:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526509",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#32386, #32387** to none



---

archive/issue_comments_526510.json:
```json
{
    "body": "Changed commit from **[117fe3a](https://github.com/sagemath/sagetrac-mirror/commit/117fe3a3ed83aa97ed8c5faee347587772d00749)** to **[8af6041](https://github.com/sagemath/sagetrac-mirror/commit/8af6041abfa62e3fe7cbd279b3bec25665cea449)**",
    "created_at": "2021-09-27T04:15:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526510",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[117fe3a](https://github.com/sagemath/sagetrac-mirror/commit/117fe3a3ed83aa97ed8c5faee347587772d00749)** to **[8af6041](https://github.com/sagemath/sagetrac-mirror/commit/8af6041abfa62e3fe7cbd279b3bec25665cea449)**



---

archive/issue_comments_526511.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8af6041abfa62e3fe7cbd279b3bec25665cea449\">8af6041</a></td><td><code>Merge tag '9.5.beta2' into t/32442/__configure__make___with_sage_venv_the_default</code></td></tr></table>\n",
    "created_at": "2021-09-27T04:15:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526511",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:10'>Comment 10:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8af6041abfa62e3fe7cbd279b3bec25665cea449">8af6041</a></td><td><code>Merge tag '9.5.beta2' into t/32442/__configure__make___with_sage_venv_the_default</code></td></tr></table>




---

archive/issue_comments_526512.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nAfter running `make distclean && ./configure`:\n\n```\n% git status\nOn branch t/32442/__configure__make___with_sage_venv_the_default\nYour branch is up to date with 'trac/u/mkoeppe/__configure__make___with_sage_venv_the_default'.\n\nUntracked files:\n  (use \"git add <file>...\" to include in what will be committed)\n\tvenv\n\nnothing added to commit but untracked files present (use \"git add\" to track)\n```",
    "created_at": "2021-09-27T20:34:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526512",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:11'>Comment 11:</a>
After running `make distclean && ./configure`:

```
% git status
On branch t/32442/__configure__make___with_sage_venv_the_default
Your branch is up to date with 'trac/u/mkoeppe/__configure__make___with_sage_venv_the_default'.

Untracked files:
  (use "git add <file>..." to include in what will be committed)
	venv

nothing added to commit but untracked files present (use "git add" to track)
```



---

archive/issue_comments_526513.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nOh, and `venv` is a symlink pointing to `local`.",
    "created_at": "2021-09-27T20:35:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526513",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:12'>Comment 12:</a>
Oh, and `venv` is a symlink pointing to `local`.



---

archive/issue_comments_526514.json:
```json
{
    "body": "Changed commit from **[8af6041](https://github.com/sagemath/sagetrac-mirror/commit/8af6041abfa62e3fe7cbd279b3bec25665cea449)** to **[b3f7d34](https://github.com/sagemath/sagetrac-mirror/commit/b3f7d3426499114eed31882f06bdc6cc3b7053f1)**",
    "created_at": "2021-09-27T20:49:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526514",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8af6041](https://github.com/sagemath/sagetrac-mirror/commit/8af6041abfa62e3fe7cbd279b3bec25665cea449)** to **[b3f7d34](https://github.com/sagemath/sagetrac-mirror/commit/b3f7d3426499114eed31882f06bdc6cc3b7053f1)**



---

archive/issue_comments_526515.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b3f7d3426499114eed31882f06bdc6cc3b7053f1\">b3f7d34</a></td><td><code>.gitignore: Add /venv</code></td></tr></table>\n",
    "created_at": "2021-09-27T20:49:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526515",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:13'>Comment 13:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b3f7d3426499114eed31882f06bdc6cc3b7053f1">b3f7d34</a></td><td><code>.gitignore: Add /venv</code></td></tr></table>




---

archive/issue_comments_526516.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nThanks for catching this!",
    "created_at": "2021-09-27T20:49:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526516",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'>Comment 14:</a>
Thanks for catching this!



---

archive/issue_comments_526517.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nReplying to [@jhpalmieri](#comment%3A12):\n> Oh, and `venv` is a symlink pointing to `local`.\n\nYes, in an incremental build, nothing should change (except that this symlink is created).\n\nAfter a `make distclean`, the new behavior will show",
    "created_at": "2021-09-27T20:51:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526517",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'>Comment 15:</a>
Replying to [@jhpalmieri](#comment%3A12):
> Oh, and `venv` is a symlink pointing to `local`.

Yes, in an incremental build, nothing should change (except that this symlink is created).

After a `make distclean`, the new behavior will show



---

archive/issue_comments_526518.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nOh, now I see that you said you did `make distclean`...",
    "created_at": "2021-09-27T20:52:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526518",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'>Comment 16:</a>
Oh, now I see that you said you did `make distclean`...



---

archive/issue_comments_526519.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nMaybe this has been going on with `venv` builds for a while, but the symlinks look messed up to me: my `local` directory looks like\n\n```\n% ls -l local\ntotal 0\ndrwxr-xr-x  148 jpalmier  staff  4736 Sep 27 16:21 bin\ndrwxr-xr-x    2 jpalmier  staff    64 Sep 27 16:09 etc\ndrwxr-xr-x   47 jpalmier  staff  1504 Sep 27 16:21 include\ndrwxr-xr-x   73 jpalmier  staff  2336 Sep 27 16:44 lib\nlrwxr-xr-x    1 jpalmier  staff     3 Sep 27 16:09 lib64 -> lib\ndrwxr-xr-x    4 jpalmier  staff   128 Sep 27 16:21 libexec\nlrwxr-xr-x    1 jpalmier  staff     5 Sep 27 16:09 local -> local\ndrwxr-xr-x   34 jpalmier  staff  1088 Sep 27 16:21 share\ndrwxr-xr-x    5 jpalmier  staff   160 Sep 27 16:13 var\nlrwxr-xr-x    1 jpalmier  staff    33 Sep 27 16:09 venv-python3.9 -> local/var/lib/sage/venv-python3.9\n```\nIn particular, `local/local` points to itself, and so `venv-python3.9` doesn't point anywhere. `venv-python3.9` should probably point to `../local/....`. I don't know what the `local` symlink is supposed to do.\n\nEverything still builds, so this is obviously not crucial, but it doesn't look right.",
    "created_at": "2021-09-28T17:06:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526519",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:17'>Comment 17:</a>
Maybe this has been going on with `venv` builds for a while, but the symlinks look messed up to me: my `local` directory looks like

```
% ls -l local
total 0
drwxr-xr-x  148 jpalmier  staff  4736 Sep 27 16:21 bin
drwxr-xr-x    2 jpalmier  staff    64 Sep 27 16:09 etc
drwxr-xr-x   47 jpalmier  staff  1504 Sep 27 16:21 include
drwxr-xr-x   73 jpalmier  staff  2336 Sep 27 16:44 lib
lrwxr-xr-x    1 jpalmier  staff     3 Sep 27 16:09 lib64 -> lib
drwxr-xr-x    4 jpalmier  staff   128 Sep 27 16:21 libexec
lrwxr-xr-x    1 jpalmier  staff     5 Sep 27 16:09 local -> local
drwxr-xr-x   34 jpalmier  staff  1088 Sep 27 16:21 share
drwxr-xr-x    5 jpalmier  staff   160 Sep 27 16:13 var
lrwxr-xr-x    1 jpalmier  staff    33 Sep 27 16:09 venv-python3.9 -> local/var/lib/sage/venv-python3.9
```
In particular, `local/local` points to itself, and so `venv-python3.9` doesn't point anywhere. `venv-python3.9` should probably point to `../local/....`. I don't know what the `local` symlink is supposed to do.

Everything still builds, so this is obviously not crucial, but it doesn't look right.



---

archive/issue_comments_526520.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nYes, that doesn't look right. Could you post `config.log` please?",
    "created_at": "2021-09-28T17:09:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526520",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'>Comment 18:</a>
Yes, that doesn't look right. Could you post `config.log` please?



---

archive/issue_comments_526521.json:
```json
{
    "body": "Attachment: **[config.log](https://github.com/sagemath/sage/files/ticket32442/config.log)**",
    "created_at": "2021-09-28T17:10:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526521",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[config.log](https://github.com/sagemath/sage/files/ticket32442/config.log)**



---

archive/issue_comments_526522.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nThis was after `make distclean && ./configure && make ptestlong`.",
    "created_at": "2021-09-28T17:11:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526522",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'>Comment 19:</a>
This was after `make distclean && ./configure && make ptestlong`.



---

archive/issue_comments_526523.json:
```json
{
    "body": "Changed commit from **[b3f7d34](https://github.com/sagemath/sagetrac-mirror/commit/b3f7d3426499114eed31882f06bdc6cc3b7053f1)** to **[fc4b641](https://github.com/sagemath/sagetrac-mirror/commit/fc4b641f651968af7fd8c4accb5841021ea0390c)**",
    "created_at": "2021-09-28T20:37:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526523",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b3f7d34](https://github.com/sagemath/sagetrac-mirror/commit/b3f7d3426499114eed31882f06bdc6cc3b7053f1)** to **[fc4b641](https://github.com/sagemath/sagetrac-mirror/commit/fc4b641f651968af7fd8c4accb5841021ea0390c)**



---

archive/issue_comments_526524.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc4b641f651968af7fd8c4accb5841021ea0390c\">fc4b641</a></td><td><code>configure.ac: Remove conveniene symlinks before (re)creating them</code></td></tr></table>\n",
    "created_at": "2021-09-28T20:37:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526524",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:20'>Comment 20:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc4b641f651968af7fd8c4accb5841021ea0390c">fc4b641</a></td><td><code>configure.ac: Remove conveniene symlinks before (re)creating them</code></td></tr></table>




---

archive/issue_comments_526525.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nTry with this version please",
    "created_at": "2021-09-28T20:38:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526525",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'>Comment 21:</a>
Try with this version please



---

archive/issue_comments_526526.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nI've started, and I now only see one symlink in `local`: `lib64 -> lib`. At the top level, I see `prefix -> local` and `venv -> local/var/lib/sage/venv-python3.9`.\n\nBy the way, `make distclean` should probably remove the top-level symlink `venv`. As it is, running `make distclean` first runs `./configure` (at least some of the time) which creates `venv`.",
    "created_at": "2021-09-28T20:56:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526526",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:22'>Comment 22:</a>
I've started, and I now only see one symlink in `local`: `lib64 -> lib`. At the top level, I see `prefix -> local` and `venv -> local/var/lib/sage/venv-python3.9`.

By the way, `make distclean` should probably remove the top-level symlink `venv`. As it is, running `make distclean` first runs `./configure` (at least some of the time) which creates `venv`.



---

archive/issue_comments_526527.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\n`make distclean` should also remove `prefix`.",
    "created_at": "2021-09-28T20:59:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526527",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:23'>Comment 23:</a>
`make distclean` should also remove `prefix`.



---

archive/issue_comments_526528.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nReplying to [@jhpalmieri](#comment%3A22):\n> I've started, and I now only see one symlink in `local`: `lib64 -> lib`. At the top level, I see `prefix -> local` and `venv -> local/var/lib/sage/venv-python3.9`.\n\nGreat, this is the intended layout.",
    "created_at": "2021-09-28T22:15:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526528",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'>Comment 24:</a>
Replying to [@jhpalmieri](#comment%3A22):
> I've started, and I now only see one symlink in `local`: `lib64 -> lib`. At the top level, I see `prefix -> local` and `venv -> local/var/lib/sage/venv-python3.9`.

Great, this is the intended layout.



---

archive/issue_comments_526529.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8bcbf1d919d7d90cefe1442a23aaa66df4ecd2d3\">8bcbf1d</a></td><td><code>Makefile (distclean): Remove convenience symlinks prefix, venv</code></td></tr></table>\n",
    "created_at": "2021-09-28T22:21:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526529",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:25'>Comment 25:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8bcbf1d919d7d90cefe1442a23aaa66df4ecd2d3">8bcbf1d</a></td><td><code>Makefile (distclean): Remove convenience symlinks prefix, venv</code></td></tr></table>




---

archive/issue_comments_526530.json:
```json
{
    "body": "Changed commit from **[fc4b641](https://github.com/sagemath/sagetrac-mirror/commit/fc4b641f651968af7fd8c4accb5841021ea0390c)** to **[8bcbf1d](https://github.com/sagemath/sagetrac-mirror/commit/8bcbf1d919d7d90cefe1442a23aaa66df4ecd2d3)**",
    "created_at": "2021-09-28T22:21:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526530",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[fc4b641](https://github.com/sagemath/sagetrac-mirror/commit/fc4b641f651968af7fd8c4accb5841021ea0390c)** to **[8bcbf1d](https://github.com/sagemath/sagetrac-mirror/commit/8bcbf1d919d7d90cefe1442a23aaa66df4ecd2d3)**



---

archive/issue_comments_526531.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nHow is it decided which documentation goes in `local/share/doc` and which goes in `venv/share/doc`? For example, `pplpy` and `sage` are `local/share/doc`, although their corresponding installation files are in `venv/var/lib/sage/installed`.",
    "created_at": "2021-09-29T03:42:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526531",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:26'>Comment 26:</a>
How is it decided which documentation goes in `local/share/doc` and which goes in `venv/share/doc`? For example, `pplpy` and `sage` are `local/share/doc`, although their corresponding installation files are in `venv/var/lib/sage/installed`.



---

archive/issue_comments_526532.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nI haven't really paid attention to the documentation. There is no attempt to actively install documentation in `venv`. The installation of the documentation is not really done by these Python packages themselves but rather by our Sage-specific install scripts. `build/pkgs/pplpy/spkg-postinst.in` directly refers to `SAGE_SHARE` (= `local/share`) for the installation location. I'd say a more systematic consideration of this issue would be something for #29868.",
    "created_at": "2021-09-29T04:11:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526532",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'>Comment 27:</a>
I haven't really paid attention to the documentation. There is no attempt to actively install documentation in `venv`. The installation of the documentation is not really done by these Python packages themselves but rather by our Sage-specific install scripts. `build/pkgs/pplpy/spkg-postinst.in` directly refers to `SAGE_SHARE` (= `local/share`) for the installation location. I'd say a more systematic consideration of this issue would be something for #29868.



---

archive/issue_comments_526533.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nOn the other hand, `networkx` and `sagetex` put their docs in the venv location. Not a big deal and we can certainly deal with it on another ticket.",
    "created_at": "2021-09-29T16:20:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526533",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:28'>Comment 28:</a>
On the other hand, `networkx` and `sagetex` put their docs in the venv location. Not a big deal and we can certainly deal with it on another ticket.



---

archive/issue_comments_526534.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nThanks for investigating. These two Python packages install their documentation by themselves on `setup.py install` (and similar), we are not doing anything Sage-specific there. Perhaps at some point we'll get around to moving #27164 forward...",
    "created_at": "2021-09-29T16:28:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526534",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'>Comment 29:</a>
Thanks for investigating. These two Python packages install their documentation by themselves on `setup.py install` (and similar), we are not doing anything Sage-specific there. Perhaps at some point we'll get around to moving #27164 forward...



---

archive/issue_comments_526535.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nCan you explain the change in `Makefile.in`? In what circumstances would the package tree directory not exist?",
    "created_at": "2021-09-29T22:13:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526535",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:30'>Comment 30:</a>
Can you explain the change in `Makefile.in`? In what circumstances would the package tree directory not exist?



---

archive/issue_comments_526536.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nI think that `./configure --help` should be changed from\n\n```\n  --with-sage-venv={auto,yes,no,SAGE_VENV}\n```\nto\n\n```\n  --with-sage-venv={auto (default),yes,no,SAGE_VENV}\n```",
    "created_at": "2021-09-29T22:13:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526536",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:31'>Comment 31:</a>
I think that `./configure --help` should be changed from

```
  --with-sage-venv={auto,yes,no,SAGE_VENV}
```
to

```
  --with-sage-venv={auto (default),yes,no,SAGE_VENV}
```



---

archive/issue_comments_526537.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nIn this line from configure.ac:\n\n```\n    eval SAGE_VENV=\"$SAGE_VENV\"dnl eval so as to evaluate the embedded ${SAGE_LOCAL}\n```\nthe placement of `dnl...` doesn't fit the style of the rest of the file. I honestly don't care. Is there any point to change it?",
    "created_at": "2021-09-29T22:15:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526537",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:32'>Comment 32:</a>
In this line from configure.ac:

```
    eval SAGE_VENV="$SAGE_VENV"dnl eval so as to evaluate the embedded ${SAGE_LOCAL}
```
the placement of `dnl...` doesn't fit the style of the rest of the file. I honestly don't care. Is there any point to change it?



---

archive/issue_comments_526538.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nReplying to [@jhpalmieri](#comment%3A30):\n> Can you explain the change in `Makefile.in`? In what circumstances would the package tree directory not exist?\n\nRunning `make SCRIPTPACKAGE-clean` or `./sage -f SCRIPTPACKAGE` right after running `./configure` (or before any package is installed into the venv)",
    "created_at": "2021-09-29T22:18:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526538",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'>Comment 33:</a>
Replying to [@jhpalmieri](#comment%3A30):
> Can you explain the change in `Makefile.in`? In what circumstances would the package tree directory not exist?

Running `make SCRIPTPACKAGE-clean` or `./sage -f SCRIPTPACKAGE` right after running `./configure` (or before any package is installed into the venv)



---

archive/issue_comments_526539.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dcb4a08a1d5e5e2363c4b6e2f2f3d852efd3aae0\">dcb4a08</a></td><td><code>configure.ac: Indicate default in help string for --with-sage-venv</code></td></tr></table>\n",
    "created_at": "2021-09-29T22:24:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526539",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:34'>Comment 34:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dcb4a08a1d5e5e2363c4b6e2f2f3d852efd3aae0">dcb4a08</a></td><td><code>configure.ac: Indicate default in help string for --with-sage-venv</code></td></tr></table>




---

archive/issue_comments_526540.json:
```json
{
    "body": "Changed commit from **[8bcbf1d](https://github.com/sagemath/sagetrac-mirror/commit/8bcbf1d919d7d90cefe1442a23aaa66df4ecd2d3)** to **[dcb4a08](https://github.com/sagemath/sagetrac-mirror/commit/dcb4a08a1d5e5e2363c4b6e2f2f3d852efd3aae0)**",
    "created_at": "2021-09-29T22:24:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526540",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8bcbf1d](https://github.com/sagemath/sagetrac-mirror/commit/8bcbf1d919d7d90cefe1442a23aaa66df4ecd2d3)** to **[dcb4a08](https://github.com/sagemath/sagetrac-mirror/commit/dcb4a08a1d5e5e2363c4b6e2f2f3d852efd3aae0)**



---

archive/issue_comments_526541.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nReplying to [@jhpalmieri](#comment%3A32):\n> the placement of `dnl...` doesn't fit the style of the rest of the file. I honestly don't care. Is there any point to change it?\n\nIt's correct as is, to suppress unnecessary whitespace in the generated file. There are lots of other places in our autoconf scripts that are not quite so careful about this, in the end it does not matter so much",
    "created_at": "2021-09-29T22:26:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526541",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:35'>Comment 35:</a>
Replying to [@jhpalmieri](#comment%3A32):
> the placement of `dnl...` doesn't fit the style of the rest of the file. I honestly don't care. Is there any point to change it?

It's correct as is, to suppress unnecessary whitespace in the generated file. There are lots of other places in our autoconf scripts that are not quite so careful about this, in the end it does not matter so much



---

archive/issue_comments_526542.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nI think this is ready to go, but I will ask one more question \u2014\u00a0probably not a question for this ticket, just a general venv question: how do I use a venv? I built Sage using homebrew's Python 3.9, and I wanted to see what happened with /usr/bin/python3, which is version 3.8. But just doing `./configure --with-python=/usr/bin/python3` doesn't accomplish anything because `local/bin/python3` is still a symlink pointing to homebrew's Python. What do I need to do to convince Sage to use a different Python, therefore creating a different `venv`, while keeping the other `venv`? Do I need to manually remove the Python symlink?",
    "created_at": "2021-09-29T23:11:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526542",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:36'>Comment 36:</a>
I think this is ready to go, but I will ask one more question — probably not a question for this ticket, just a general venv question: how do I use a venv? I built Sage using homebrew's Python 3.9, and I wanted to see what happened with /usr/bin/python3, which is version 3.8. But just doing `./configure --with-python=/usr/bin/python3` doesn't accomplish anything because `local/bin/python3` is still a symlink pointing to homebrew's Python. What do I need to do to convince Sage to use a different Python, therefore creating a different `venv`, while keeping the other `venv`? Do I need to manually remove the Python symlink?



---

archive/issue_comments_526543.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\nReplying to [@jhpalmieri](#comment%3A36):\n> But just doing `./configure --with-python=/usr/bin/python3` doesn't accomplish anything because `local/bin/python3` is still a symlink pointing to homebrew's Python.\n\nTry `./configure --with-python=/usr/bin/python3 --with-sage-venv=yes`",
    "created_at": "2021-09-29T23:13:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526543",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:37'>Comment 37:</a>
Replying to [@jhpalmieri](#comment%3A36):
> But just doing `./configure --with-python=/usr/bin/python3` doesn't accomplish anything because `local/bin/python3` is still a symlink pointing to homebrew's Python.

Try `./configure --with-python=/usr/bin/python3 --with-sage-venv=yes`



---

archive/issue_comments_526544.json:
```json
{
    "body": "<a id='comment:38'>Comment 38:</a>\nShould `--with-sage-venv=auto` detect whether this is an incremental build from an earlier build using `--with-sage-venv=auto`, i.e. whether SAGE_ENV matches `local/var/lib/sage/venv-SOMEPYTHONVERSION`? And if so, then should it use the appropriate possibly new directory for the venv? Otherwise the ticket description's \"we ensure that if the system python version changes (either because of system updates or explicit reconfiguration), we create a fresh venv\" is not accurate: this will only happen if the user says `--with-sage-venv=yes`, if I understand correctly.",
    "created_at": "2021-09-29T23:39:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526544",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:38'>Comment 38:</a>
Should `--with-sage-venv=auto` detect whether this is an incremental build from an earlier build using `--with-sage-venv=auto`, i.e. whether SAGE_ENV matches `local/var/lib/sage/venv-SOMEPYTHONVERSION`? And if so, then should it use the appropriate possibly new directory for the venv? Otherwise the ticket description's "we ensure that if the system python version changes (either because of system updates or explicit reconfiguration), we create a fresh venv" is not accurate: this will only happen if the user says `--with-sage-venv=yes`, if I understand correctly.



---

archive/issue_comments_526545.json:
```json
{
    "body": "<a id='comment:39'>Comment 39:</a>\nIf you start from a distclean source tree, the default `--with-sage-venv=auto` does not create a python3 in `local/bin/`. So it will work as advertised.\n\nI think you are testing with a tree that has python3 in `local/bin/`, either from a build before this ticket, or from a defective earlier version of this ticket.",
    "created_at": "2021-09-29T23:57:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526545",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:39'>Comment 39:</a>
If you start from a distclean source tree, the default `--with-sage-venv=auto` does not create a python3 in `local/bin/`. So it will work as advertised.

I think you are testing with a tree that has python3 in `local/bin/`, either from a build before this ticket, or from a defective earlier version of this ticket.



---

archive/issue_comments_526546.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\nI think you're right, I think it's working the way it's supposed to. Let me test one or two more things.",
    "created_at": "2021-09-30T00:03:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526546",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:40'>Comment 40:</a>
I think you're right, I think it's working the way it's supposed to. Let me test one or two more things.



---

archive/issue_comments_526547.json:
```json
{
    "body": "<a id='comment:41'>Comment 41:</a>\nCan this be fixed? I did\n\n```\n% ./configure   # use homebrew's Python 3.9\n% make ptestlong\n...\nall tests passed\n% ./configure --with-python=/usr/bin/python3   # Python 3.8\n% make\n% ./sage -tp src/sage_setup\n...\nsage -t --warn-long 107.1 --random-seed=0 src/sage_setup/clean.py  # 1 doctest failed\nsage -t --warn-long 107.1 --random-seed=0 src/sage_setup/find.py  # 2 doctests failed\n```\nDetails:\n\n```\nFile \"src/sage_setup/clean.py\", line 96, in sage_setup.clean._find_stale_files\nFailed example:\n    for f in stale_iter:\n        if f.endswith(skip_extensions): continue\n        if '/ext_data/' in f: continue\n        print('Found stale file: ' + f)\nExpected nothing\nGot:\n    Found stale file: /Users/palmieri/Library/Caches/com.apple.python/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta2/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/all_cmdline.cpython-38.pyc\n    Found stale file: /Users/palmieri/Library/Caches/com.apple.python/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta2/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/version.cpython-38.pyc\n...\n [many lines like this]\n```\nand\n\n```\nFile \"src/sage_setup/find.py\", line 365, in sage_setup.find.installed_files_by_module\nFailed example:\n    f1\nExpected:\n    'sage/structure/__init__.py'\nGot:\n    '/Users/palmieri/Library/Caches/com.apple.python/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta2/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/structure/__init__.cpython-38.pyc'\n**********************************************************************\nFile \"src/sage_setup/find.py\", line 367, in sage_setup.find.installed_files_by_module\nFailed example:\n    f2\nExpected:\n    'sage/structure/....pyc'\nGot:\n    'sage/structure/__init__.py'\n```",
    "created_at": "2021-09-30T04:46:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526547",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:41'>Comment 41:</a>
Can this be fixed? I did

```
% ./configure   # use homebrew's Python 3.9
% make ptestlong
...
all tests passed
% ./configure --with-python=/usr/bin/python3   # Python 3.8
% make
% ./sage -tp src/sage_setup
...
sage -t --warn-long 107.1 --random-seed=0 src/sage_setup/clean.py  # 1 doctest failed
sage -t --warn-long 107.1 --random-seed=0 src/sage_setup/find.py  # 2 doctests failed
```
Details:

```
File "src/sage_setup/clean.py", line 96, in sage_setup.clean._find_stale_files
Failed example:
    for f in stale_iter:
        if f.endswith(skip_extensions): continue
        if '/ext_data/' in f: continue
        print('Found stale file: ' + f)
Expected nothing
Got:
    Found stale file: /Users/palmieri/Library/Caches/com.apple.python/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta2/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/all_cmdline.cpython-38.pyc
    Found stale file: /Users/palmieri/Library/Caches/com.apple.python/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta2/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/version.cpython-38.pyc
...
 [many lines like this]
```
and

```
File "src/sage_setup/find.py", line 365, in sage_setup.find.installed_files_by_module
Failed example:
    f1
Expected:
    'sage/structure/__init__.py'
Got:
    '/Users/palmieri/Library/Caches/com.apple.python/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.5.beta2/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/structure/__init__.cpython-38.pyc'
**********************************************************************
File "src/sage_setup/find.py", line 367, in sage_setup.find.installed_files_by_module
Failed example:
    f2
Expected:
    'sage/structure/....pyc'
Got:
    'sage/structure/__init__.py'
```



---

archive/issue_comments_526548.json:
```json
{
    "body": "<a id='comment:42'>Comment 42:</a>\nThis is #31314",
    "created_at": "2021-09-30T04:58:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526548",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:42'>Comment 42:</a>
This is #31314



---

archive/issue_comments_526549.json:
```json
{
    "body": "<a id='comment:43'>Comment 43:</a>\nOkay, then I think this is ready.",
    "created_at": "2021-09-30T17:30:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526549",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:43'>Comment 43:</a>
Okay, then I think this is ready.



---

archive/issue_events_414906.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2021-09-30T17:30:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414906"
}
```



---

archive/issue_events_414907.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2021-09-30T17:30:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414907"
}
```



---

archive/issue_comments_526550.json:
```json
{
    "body": "Reviewer: **John Palmieri**",
    "created_at": "2021-09-30T17:30:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526550",
    "user": "https://github.com/jhpalmieri"
}
```

Reviewer: **John Palmieri**



---

archive/issue_comments_526551.json:
```json
{
    "body": "<a id='comment:44'>Comment 44:</a>\nThank you!",
    "created_at": "2021-09-30T17:41:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526551",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:44'>Comment 44:</a>
Thank you!



---

archive/issue_events_414908.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-04T21:15:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414908"
}
```



---

archive/issue_events_414909.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-04T21:15:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414909"
}
```



---

archive/issue_comments_526552.json:
```json
{
    "body": "<a id='comment:45'>Comment 45:</a>\nBreaks build on Debian 9:\n\n```\nTesting importing of various modules...\nctypes module imported OK\nmath module imported OK\nhashlib module imported OK\ncrypt module imported OK\nsocket module imported OK\nzlib module imported OK\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\n  File \"/home/buildbot/slave/sage_git/build/local/var/lib/sage/venv-python3.9.7/var/tmp/sage/build/python3-3.9.7/src/Lib/sqlite3/__init__.py\", line 23, in <module>\n    from sqlite3.dbapi2 import *\n  File \"/home/buildbot/slave/sage_git/build/local/var/lib/sage/venv-python3.9.7/var/tmp/sage/build/python3-3.9.7/src/Lib/sqlite3/dbapi2.py\", line 27, in <module>\n    from _sqlite3 import *\nModuleNotFoundError: No module named '_sqlite3'\nsqlite3 module failed to import\nssl module imported OK\nError: One or more modules failed to import.\nreal\t1m25.694s\nuser\t2m0.796s\nsys\t0m10.188s\n************************************************************************\nError building package python3-3.9.7\n************************************************************************\n```",
    "created_at": "2021-10-04T21:15:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526552",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:45'>Comment 45:</a>
Breaks build on Debian 9:

```
Testing importing of various modules...
ctypes module imported OK
math module imported OK
hashlib module imported OK
crypt module imported OK
socket module imported OK
zlib module imported OK
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/buildbot/slave/sage_git/build/local/var/lib/sage/venv-python3.9.7/var/tmp/sage/build/python3-3.9.7/src/Lib/sqlite3/__init__.py", line 23, in <module>
    from sqlite3.dbapi2 import *
  File "/home/buildbot/slave/sage_git/build/local/var/lib/sage/venv-python3.9.7/var/tmp/sage/build/python3-3.9.7/src/Lib/sqlite3/dbapi2.py", line 27, in <module>
    from _sqlite3 import *
ModuleNotFoundError: No module named '_sqlite3'
sqlite3 module failed to import
ssl module imported OK
Error: One or more modules failed to import.
real	1m25.694s
user	2m0.796s
sys	0m10.188s
************************************************************************
Error building package python3-3.9.7
************************************************************************
```



---

archive/issue_comments_526553.json:
```json
{
    "body": "<a id='comment:46'>Comment 46:</a>\nBuild log please",
    "created_at": "2021-10-04T21:20:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526553",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:46'>Comment 46:</a>
Build log please



---

archive/issue_comments_526554.json:
```json
{
    "body": "<a id='comment:47'>Comment 47:</a>\nI was able to reproduce this using `tox -e docker-debian-stretch-minimal`.",
    "created_at": "2021-10-12T01:33:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526554",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:47'>Comment 47:</a>
I was able to reproduce this using `tox -e docker-debian-stretch-minimal`.



---

archive/issue_comments_526555.json:
```json
{
    "body": "Changed commit from **[dcb4a08](https://github.com/sagemath/sagetrac-mirror/commit/dcb4a08a1d5e5e2363c4b6e2f2f3d852efd3aae0)** to **[2101b8c](https://github.com/sagemath/sagetrac-mirror/commit/2101b8cccc8b0b2fc782dbeb8c476e6a52243498)**",
    "created_at": "2021-10-12T03:06:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526555",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[dcb4a08](https://github.com/sagemath/sagetrac-mirror/commit/dcb4a08a1d5e5e2363c4b6e2f2f3d852efd3aae0)** to **[2101b8c](https://github.com/sagemath/sagetrac-mirror/commit/2101b8cccc8b0b2fc782dbeb8c476e6a52243498)**



---

archive/issue_comments_526556.json:
```json
{
    "body": "<a id='comment:48'>Comment 48:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e33bc89dd280dec5aa9241b2722d57102ac126b4\">e33bc89</a></td><td><code>Merge tag '9.5.beta3' into t/32442/__configure__make___with_sage_venv_the_default</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2101b8cccc8b0b2fc782dbeb8c476e6a52243498\">2101b8c</a></td><td><code>build/pkgs/python3/spkg-build.in: Make sure that python finds sqlite3 when determining which extension modules to build</code></td></tr></table>\n",
    "created_at": "2021-10-12T03:06:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526556",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:48'>Comment 48:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e33bc89dd280dec5aa9241b2722d57102ac126b4">e33bc89</a></td><td><code>Merge tag '9.5.beta3' into t/32442/__configure__make___with_sage_venv_the_default</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2101b8cccc8b0b2fc782dbeb8c476e6a52243498">2101b8c</a></td><td><code>build/pkgs/python3/spkg-build.in: Make sure that python finds sqlite3 when determining which extension modules to build</code></td></tr></table>




---

archive/issue_events_414910.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-12T03:07:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414910"
}
```



---

archive/issue_events_414911.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-12T03:07:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414911"
}
```



---

archive/issue_comments_526557.json:
```json
{
    "body": "<a id='comment:50'>Comment 50:</a>\nWhen I run `tox -e docker-debian-stretch-minimal`, where are the package log files?",
    "created_at": "2021-10-13T17:20:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526557",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:50'>Comment 50:</a>
When I run `tox -e docker-debian-stretch-minimal`, where are the package log files?



---

archive/issue_comments_526558.json:
```json
{
    "body": "<a id='comment:51'>Comment 51:</a>\nThey are in the Docker container. \nAt the end of the build, tox will tell you name and/or sha256 hash of the image built.\nYou can to `docker run -it IMAGE bash` to enter the container and then it's all in /sage/logs",
    "created_at": "2021-10-13T17:24:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526558",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:51'>Comment 51:</a>
They are in the Docker container. 
At the end of the build, tox will tell you name and/or sha256 hash of the image built.
You can to `docker run -it IMAGE bash` to enter the container and then it's all in /sage/logs



---

archive/issue_comments_526559.json:
```json
{
    "body": "<a id='comment:52'>Comment 52:</a>\nOkay, before this latest change I see the Python problem, as well as:\n\n```\n* package:         python3-3.9.7\n  last build time: Oct 13 17:49\n  log file:        /sage/logs/pkgs/python3-3.9.7.log\n\n* package:         fplll-5.4.1\n  last build time: Oct 13 18:01\n  log file:        /sage/logs/pkgs/fplll-5.4.1.log\n  build directory: /sage/local/var/tmp/sage/build/fplll-5.4.1\n\n* package:         cmake-3.21.0\n  last build time: Oct 13 18:04\n  log file:        /sage/logs/pkgs/cmake-3.21.0.log\n  build directory: /sage/local/var/tmp/sage/build/cmake-3.21.0\n\n* package:         gfortran-10.3.0\n  last build time: Oct 13 18:14\n  log file:        /sage/logs/pkgs/gfortran-10.3.0.log\n  build directory: /sage/local/var/tmp/sage/build/gfortran-10.3.0\n```\nThe other failures appear to be unrelated to this ticket: I get them with the `develop` branch.",
    "created_at": "2021-10-13T19:25:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526559",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:52'>Comment 52:</a>
Okay, before this latest change I see the Python problem, as well as:

```
* package:         python3-3.9.7
  last build time: Oct 13 17:49
  log file:        /sage/logs/pkgs/python3-3.9.7.log

* package:         fplll-5.4.1
  last build time: Oct 13 18:01
  log file:        /sage/logs/pkgs/fplll-5.4.1.log
  build directory: /sage/local/var/tmp/sage/build/fplll-5.4.1

* package:         cmake-3.21.0
  last build time: Oct 13 18:04
  log file:        /sage/logs/pkgs/cmake-3.21.0.log
  build directory: /sage/local/var/tmp/sage/build/cmake-3.21.0

* package:         gfortran-10.3.0
  last build time: Oct 13 18:14
  log file:        /sage/logs/pkgs/gfortran-10.3.0.log
  build directory: /sage/local/var/tmp/sage/build/gfortran-10.3.0
```
The other failures appear to be unrelated to this ticket: I get them with the `develop` branch.



---

archive/issue_comments_526560.json:
```json
{
    "body": "<a id='comment:53'>Comment 53:</a>\nReplying to [@jhpalmieri](#comment%3A52):\n> The other failures appear to be related to this ticket: I get them with the `develop` branch.\n\nDid you mean to write \"unrelated to this ticket\"?",
    "created_at": "2021-10-13T19:32:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526560",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:53'>Comment 53:</a>
Replying to [@jhpalmieri](#comment%3A52):
> The other failures appear to be related to this ticket: I get them with the `develop` branch.

Did you mean to write "unrelated to this ticket"?



---

archive/issue_events_414912.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2021-10-13T21:18:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414912"
}
```



---

archive/issue_events_414913.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2021-10-13T21:18:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414913"
}
```



---

archive/issue_comments_526561.json:
```json
{
    "body": "<a id='comment:54'>Comment 54:</a>\nYes, sorry, unrelated. I've edited to make it clearer in case anyone looks at this later. With the most recent branch here, Python builds correctly. I think that's good enough for another positive review.",
    "created_at": "2021-10-13T21:18:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526561",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:54'>Comment 54:</a>
Yes, sorry, unrelated. I've edited to make it clearer in case anyone looks at this later. With the most recent branch here, Python builds correctly. I think that's good enough for another positive review.



---

archive/issue_comments_526562.json:
```json
{
    "body": "<a id='comment:55'>Comment 55:</a>\nThank you!\n\nBy the way, I cannot reproduce the failures with the other packages, and they also built correctly on GH Actions https://github.com/sagemath/sage/runs/3863930628?check_suite_focus=true",
    "created_at": "2021-10-13T21:22:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526562",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:55'>Comment 55:</a>
Thank you!

By the way, I cannot reproduce the failures with the other packages, and they also built correctly on GH Actions https://github.com/sagemath/sage/runs/3863930628?check_suite_focus=true



---

archive/issue_comments_526563.json:
```json
{
    "body": "<a id='comment:56'>Comment 56:</a>\nMaybe the issue was that my Docker was out of date, or maybe it was a memory issue. I upgraded Docker and allocated more RAM to it, and now those packages build.",
    "created_at": "2021-10-13T23:20:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526563",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:56'>Comment 56:</a>
Maybe the issue was that my Docker was out of date, or maybe it was a memory issue. I upgraded Docker and allocated more RAM to it, and now those packages build.



---

archive/issue_comments_526564.json:
```json
{
    "body": "<a id='comment:57'>Comment 57:</a>\nI do get another failure, though; don't know if it's related to this ticket. With `tox -e docker-debian-stretch-minimal`, I get:\n\n```\ngcc version 6.3.0 20170516 (Debian 6.3.0-18+deb9u1) \n****************************************************\nPackage 'setuptools' is currently not installed\nNo legacy uninstaller found for 'setuptools'; nothing to do\npython3: error while loading shared libraries: libpython3.9.so.1.0: cannot open shared object file: No such file or directory\n********************************************************************************\nError building / installing setuptools for Python\n********************************************************************************\n\nreal\t0m0.021s\nuser\t0m0.011s\nsys\t0m0.010s\n************************************************************************\nError installing package setuptools-58.0.2\n************************************************************************\nPlease email sage-devel (http://groups.google.com/group/sage-devel)\nexplaining the problem and including the log files\n  /sage/logs/pkgs/setuptools-58.0.2.log\nand\n  /sage/config.log\nDescribe your computer, operating system, etc.\nIf you want to try to fix the problem yourself, *don't* just cd to\n/sage/local/var/lib/sage/venv-python3.9.7/var/tmp/sage/build/setuptools-58.0.2 and type 'make' or whatever is appropriate.\nInstead, the following commands setup all environment variables\ncorrectly and load a subshell for you to debug the error:\n  (cd '/sage/local/var/lib/sage/venv-python3.9.7/var/tmp/sage/build/setuptools-58.0.2' && '/sage/sage' --buildsh)\nWhen you are done debugging, you can type \"exit\" to leave the subshell.\n```",
    "created_at": "2021-10-14T00:20:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526564",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:57'>Comment 57:</a>
I do get another failure, though; don't know if it's related to this ticket. With `tox -e docker-debian-stretch-minimal`, I get:

```
gcc version 6.3.0 20170516 (Debian 6.3.0-18+deb9u1) 
****************************************************
Package 'setuptools' is currently not installed
No legacy uninstaller found for 'setuptools'; nothing to do
python3: error while loading shared libraries: libpython3.9.so.1.0: cannot open shared object file: No such file or directory
********************************************************************************
Error building / installing setuptools for Python
********************************************************************************

real	0m0.021s
user	0m0.011s
sys	0m0.010s
************************************************************************
Error installing package setuptools-58.0.2
************************************************************************
Please email sage-devel (http://groups.google.com/group/sage-devel)
explaining the problem and including the log files
  /sage/logs/pkgs/setuptools-58.0.2.log
and
  /sage/config.log
Describe your computer, operating system, etc.
If you want to try to fix the problem yourself, *don't* just cd to
/sage/local/var/lib/sage/venv-python3.9.7/var/tmp/sage/build/setuptools-58.0.2 and type 'make' or whatever is appropriate.
Instead, the following commands setup all environment variables
correctly and load a subshell for you to debug the error:
  (cd '/sage/local/var/lib/sage/venv-python3.9.7/var/tmp/sage/build/setuptools-58.0.2' && '/sage/sage' --buildsh)
When you are done debugging, you can type "exit" to leave the subshell.
```



---

archive/issue_comments_526565.json:
```json
{
    "body": "<a id='comment:58'>Comment 58:</a>\nThere is a file `SAGE_ROOT/venv/local/lib/libpython3.9.so.1.0`. If I run `./sage --python` then I get the same error.",
    "created_at": "2021-10-14T00:22:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526565",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:58'>Comment 58:</a>
There is a file `SAGE_ROOT/venv/local/lib/libpython3.9.so.1.0`. If I run `./sage --python` then I get the same error.



---

archive/issue_comments_526566.json:
```json
{
    "body": "<a id='comment:59'>Comment 59:</a>\nYes, I see this error now too.",
    "created_at": "2021-10-14T01:56:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526566",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:59'>Comment 59:</a>
Yes, I see this error now too.



---

archive/issue_events_414914.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2021-10-14T01:58:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414914"
}
```



---

archive/issue_events_414915.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2021-10-14T01:58:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414915"
}
```



---

archive/issue_comments_526567.json:
```json
{
    "body": "<a id='comment:61'>Comment 61:</a>\nLooks like on Linux I need to set the linker flags differently.",
    "created_at": "2021-10-14T02:01:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526567",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:61'>Comment 61:</a>
Looks like on Linux I need to set the linker flags differently.



---

archive/issue_comments_526568.json:
```json
{
    "body": "Changed commit from **[2101b8c](https://github.com/sagemath/sagetrac-mirror/commit/2101b8cccc8b0b2fc782dbeb8c476e6a52243498)** to **[3bbc5d8](https://github.com/sagemath/sagetrac-mirror/commit/3bbc5d8fb9aa3abc81fe2a46da52312b843c796e)**",
    "created_at": "2021-10-14T02:30:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526568",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2101b8c](https://github.com/sagemath/sagetrac-mirror/commit/2101b8cccc8b0b2fc782dbeb8c476e6a52243498)** to **[3bbc5d8](https://github.com/sagemath/sagetrac-mirror/commit/3bbc5d8fb9aa3abc81fe2a46da52312b843c796e)**



---

archive/issue_comments_526569.json:
```json
{
    "body": "<a id='comment:62'>Comment 62:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3bbc5d8fb9aa3abc81fe2a46da52312b843c796e\">3bbc5d8</a></td><td><code>build/pkgs/python3/spkg-build.in: Set rpath</code></td></tr></table>\n",
    "created_at": "2021-10-14T02:30:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526569",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:62'>Comment 62:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3bbc5d8fb9aa3abc81fe2a46da52312b843c796e">3bbc5d8</a></td><td><code>build/pkgs/python3/spkg-build.in: Set rpath</code></td></tr></table>




---

archive/issue_events_414916.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-14T05:43:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414916"
}
```



---

archive/issue_events_414917.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-14T05:43:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414917"
}
```



---

archive/issue_comments_526570.json:
```json
{
    "body": "<a id='comment:64'>Comment 64:</a>\nThis fixes it for me; this time I ran a complete build",
    "created_at": "2021-10-14T05:44:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526570",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:64'>Comment 64:</a>
This fixes it for me; this time I ran a complete build



---

archive/issue_comments_526571.json:
```json
{
    "body": "<a id='comment:65'>Comment 65:</a>\nThis ticket (at 2101b8cccc) is already on Volker's branch.\nI've opened #32698 for the fix.",
    "created_at": "2021-10-14T22:41:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526571",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:65'>Comment 65:</a>
This ticket (at 2101b8cccc) is already on Volker's branch.
I've opened #32698 for the fix.



---

archive/issue_comments_526572.json:
```json
{
    "body": "<a id='comment:66'>Comment 66:</a>\nThis works for me with a few different builds (standard build on my machine and a few tox builds via Docker).",
    "created_at": "2021-10-15T03:22:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526572",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:66'>Comment 66:</a>
This works for me with a few different builds (standard build on my machine and a few tox builds via Docker).



---

archive/issue_events_414918.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2021-10-15T03:22:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414918"
}
```



---

archive/issue_events_414919.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2021-10-15T03:22:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414919"
}
```



---

archive/issue_comments_526573.json:
```json
{
    "body": "Changed commit from **[3bbc5d8](https://github.com/sagemath/sagetrac-mirror/commit/3bbc5d8fb9aa3abc81fe2a46da52312b843c796e)** to none",
    "created_at": "2021-10-19T22:01:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526573",
    "user": "https://github.com/mkoeppe"
}
```

Changed commit from **[3bbc5d8](https://github.com/sagemath/sagetrac-mirror/commit/3bbc5d8fb9aa3abc81fe2a46da52312b843c796e)** to none



---

archive/issue_comments_526574.json:
```json
{
    "body": "<a id='comment:67'>Comment 67:</a>\nThis was merged along with #32698",
    "created_at": "2021-10-19T22:01:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526574",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:67'>Comment 67:</a>
This was merged along with #32698



---

archive/issue_events_414920.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-19T22:01:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414920"
}
```



---

archive/issue_events_414921.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-19T22:01:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32442#event-414921"
}
```



---

archive/issue_comments_526575.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/__configure__make___with_sage_venv_the_default](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/__configure__make___with_sage_venv_the_default)** to none",
    "created_at": "2021-10-19T22:01:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32442#issuecomment-526575",
    "user": "https://github.com/mkoeppe"
}
```

Changed branch from **[u/mkoeppe/__configure__make___with_sage_venv_the_default](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/__configure__make___with_sage_venv_the_default)** to none
