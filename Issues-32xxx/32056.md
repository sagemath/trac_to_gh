# Issue 32056: python3 spkg: ModuleNotFoundError: No module named 'binascii'

archive/issues_031819.json:
```json
{
    "assignees": [],
    "body": "This happens when python3 spkg is installed on top of an existing build. During the build, `setuptools` from our site-packages leaks in, causing the failure.\n\nReported for Sage 9.3 (Python 3.9.2) within freshly installed Ubuntu 20.04.02 LTS in https://groups.google.com/g/sage-devel/c/euE9MJnfjAo/m/QUv4fXXuBQAJ \n\nReported for Sage 9.4.beta3 (Python 3.9.5) on macOS 11.4 https://groups.google.com/g/sage-devel/c/euE9MJnfjAo/m/QUv4fXXuBQAJ\n\nReported for Sage 9.4.beta3 (Python 3.9.5) on Ubuntu 18.04 in \nhttps://groups.google.com/g/sage-release/c/vCHOb2h80kU/m/pu3FEv6aAAAJ\n\n\nCC:  @culler @dimpase\n\nBranch: **[`8d31983`](https://github.com/sagemath/sagetrac-mirror/commit/8d319830fd177b18aaefdd9a22c92696fef5cc73)**\n\nReviewer: **Dima Pasechnik, S\u00e9bastien Labb\u00e9**\n\nAuthor: **Matthias Koeppe**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/32056_\n\n",
    "closed_at": "2021-06-29T17:40:01Z",
    "created_at": "2021-06-24T17:36:52Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "python3 spkg: ModuleNotFoundError: No module named 'binascii'",
    "type": "issue",
    "updated_at": "2021-09-25T04:20:31Z",
    "url": "https://github.com/sagemath/sage/issues/32056",
    "user": "https://github.com/mkoeppe"
}
```
This happens when python3 spkg is installed on top of an existing build. During the build, `setuptools` from our site-packages leaks in, causing the failure.

Reported for Sage 9.3 (Python 3.9.2) within freshly installed Ubuntu 20.04.02 LTS in https://groups.google.com/g/sage-devel/c/euE9MJnfjAo/m/QUv4fXXuBQAJ 

Reported for Sage 9.4.beta3 (Python 3.9.5) on macOS 11.4 https://groups.google.com/g/sage-devel/c/euE9MJnfjAo/m/QUv4fXXuBQAJ

Reported for Sage 9.4.beta3 (Python 3.9.5) on Ubuntu 18.04 in 
https://groups.google.com/g/sage-release/c/vCHOb2h80kU/m/pu3FEv6aAAAJ


CC:  @culler @dimpase

Branch: **[`8d31983`](https://github.com/sagemath/sagetrac-mirror/commit/8d319830fd177b18aaefdd9a22c92696fef5cc73)**

Reviewer: **Dima Pasechnik, Sébastien Labbé**

Author: **Matthias Koeppe**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/32056_





---

archive/issue_events_442141.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-24T17:36:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32056#event-442141"
}
```



---

archive/issue_events_442142.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-24T17:36:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32056#event-442142"
}
```



---

archive/issue_events_442143.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-24T17:36:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32056#event-442143"
}
```



---

archive/issue_events_442144.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-24T17:36:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32056#event-442144"
}
```



---

archive/issue_comments_516245.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nFor macOS the binascii module mysteriously failed to be compiled after running\n\n```\ngit switch develop\nmake\n```\n\nbut the problem went away after running\n\n```\nmake distclean\n./configure\nmake\n```",
    "created_at": "2021-06-24T18:08:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516245",
    "user": "https://github.com/culler"
}
```

<div id="comment:1" align="right">comment:1</div>

For macOS the binascii module mysteriously failed to be compiled after running

```
git switch develop
make
```

but the problem went away after running

```
make distclean
./configure
make
```



---

archive/issue_comments_516246.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\n... that's unfortunately not specific enough. Any chance you can restore the broken state with TimeMachine so that we can diagnose the issue?",
    "created_at": "2021-06-24T18:18:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516246",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">comment:2</div>

... that's unfortunately not specific enough. Any chance you can restore the broken state with TimeMachine so that we can diagnose the issue?



---

archive/issue_comments_516247.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,3 +2,6 @@\n \n Reported for Sage 9.4.beta3 (Python 3.9.5) on macOS 11.4 https://groups.google.com/g/sage-devel/c/euE9MJnfjAo/m/QUv4fXXuBQAJ\n \n+Reported for Sage 9.4.beta3 (Python 3.9.5) on Ubuntu 18.04 in \n+https://groups.google.com/g/sage-release/c/vCHOb2h80kU/m/pu3FEv6aAAAJ\n+\n``````\n",
    "created_at": "2021-06-24T20:11:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516247",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,3 +2,6 @@
 
 Reported for Sage 9.4.beta3 (Python 3.9.5) on macOS 11.4 https://groups.google.com/g/sage-devel/c/euE9MJnfjAo/m/QUv4fXXuBQAJ
 
+Reported for Sage 9.4.beta3 (Python 3.9.5) on Ubuntu 18.04 in 
+https://groups.google.com/g/sage-release/c/vCHOb2h80kU/m/pu3FEv6aAAAJ
+
``````




---

archive/issue_comments_516248.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nIn my case, the end of log file is:\n\n```\n  [python3-3.9.5] error installing, exit status 1. End of log file:\n  [python3-3.9.5]     File \"/home/slabbe/GitBox/sage/local/var/tmp/sage/build/python3-3.9.5/src/./setup.py\", line 33, in <module>\n  [python3-3.9.5]       from distutils import log\n  [python3-3.9.5]     File \"/home/slabbe/GitBox/sage/local/lib/python3.9/site-packages/_distutils_hack/__init__.py\", line 83, in create_module\n  [python3-3.9.5]       return importlib.import_module('setuptools._distutils')\n  [python3-3.9.5]     File \"/home/slabbe/GitBox/sage/local/var/tmp/sage/build/python3-3.9.5/src/Lib/importlib/__init__.py\", line 127, in import_module\n  [python3-3.9.5]       return _bootstrap._gcd_import(name[level:], package, level)\n  [python3-3.9.5]     File \"/home/slabbe/GitBox/sage/local/lib/python3.9/site-packages/setuptools/__init__.py\", line 16, in <module>\n  [python3-3.9.5]       import setuptools.version\n  [python3-3.9.5]     File \"/home/slabbe/GitBox/sage/local/lib/python3.9/site-packages/setuptools/version.py\", line 1, in <module>\n  [python3-3.9.5]       import pkg_resources\n  [python3-3.9.5]     File \"/home/slabbe/GitBox/sage/local/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 23, in <module>\n  [python3-3.9.5]       import zipfile\n  [python3-3.9.5]     File \"/home/slabbe/GitBox/sage/local/var/tmp/sage/build/python3-3.9.5/src/Lib/zipfile.py\", line 6, in <module>\n  [python3-3.9.5]       import binascii\n  [python3-3.9.5]   ModuleNotFoundError: No module named 'binascii'\n  [python3-3.9.5]   Makefile:641: recipe for target 'sharedmods' failed\n  [python3-3.9.5]   make[5]: *** [sharedmods] Error 1\n  [python3-3.9.5]   ********************************************************************************************\n  [python3-3.9.5]   Error building python3-3.9.5\n  [python3-3.9.5]   ********************************************************************************************\n  [python3-3.9.5]   \n  [python3-3.9.5]   real    2m13.957s\n  [python3-3.9.5]   user    1m48.606s\n  [python3-3.9.5]   sys    0m10.179s\n  [python3-3.9.5]   ************************************************************************\n  [python3-3.9.5]   Error building package python3-3.9.5\n  [python3-3.9.5]   ************************************************************************\n  [python3-3.9.5] Full log file: /home/slabbe/GitBox/sage/logs/pkgs/python3-3.9.5.log\n```",
    "created_at": "2021-06-24T20:14:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516248",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:4" align="right">comment:4</div>

In my case, the end of log file is:

```
  [python3-3.9.5] error installing, exit status 1. End of log file:
  [python3-3.9.5]     File "/home/slabbe/GitBox/sage/local/var/tmp/sage/build/python3-3.9.5/src/./setup.py", line 33, in <module>
  [python3-3.9.5]       from distutils import log
  [python3-3.9.5]     File "/home/slabbe/GitBox/sage/local/lib/python3.9/site-packages/_distutils_hack/__init__.py", line 83, in create_module
  [python3-3.9.5]       return importlib.import_module('setuptools._distutils')
  [python3-3.9.5]     File "/home/slabbe/GitBox/sage/local/var/tmp/sage/build/python3-3.9.5/src/Lib/importlib/__init__.py", line 127, in import_module
  [python3-3.9.5]       return _bootstrap._gcd_import(name[level:], package, level)
  [python3-3.9.5]     File "/home/slabbe/GitBox/sage/local/lib/python3.9/site-packages/setuptools/__init__.py", line 16, in <module>
  [python3-3.9.5]       import setuptools.version
  [python3-3.9.5]     File "/home/slabbe/GitBox/sage/local/lib/python3.9/site-packages/setuptools/version.py", line 1, in <module>
  [python3-3.9.5]       import pkg_resources
  [python3-3.9.5]     File "/home/slabbe/GitBox/sage/local/lib/python3.9/site-packages/pkg_resources/__init__.py", line 23, in <module>
  [python3-3.9.5]       import zipfile
  [python3-3.9.5]     File "/home/slabbe/GitBox/sage/local/var/tmp/sage/build/python3-3.9.5/src/Lib/zipfile.py", line 6, in <module>
  [python3-3.9.5]       import binascii
  [python3-3.9.5]   ModuleNotFoundError: No module named 'binascii'
  [python3-3.9.5]   Makefile:641: recipe for target 'sharedmods' failed
  [python3-3.9.5]   make[5]: *** [sharedmods] Error 1
  [python3-3.9.5]   ********************************************************************************************
  [python3-3.9.5]   Error building python3-3.9.5
  [python3-3.9.5]   ********************************************************************************************
  [python3-3.9.5]   
  [python3-3.9.5]   real    2m13.957s
  [python3-3.9.5]   user    1m48.606s
  [python3-3.9.5]   sys    0m10.179s
  [python3-3.9.5]   ************************************************************************
  [python3-3.9.5]   Error building package python3-3.9.5
  [python3-3.9.5]   ************************************************************************
  [python3-3.9.5] Full log file: /home/slabbe/GitBox/sage/logs/pkgs/python3-3.9.5.log
```



---

archive/issue_comments_516249.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\n\n```\n [python3-3.9.5]     File \"/home/slabbe/GitBox/sage/local/lib/python3.9/site-packages/_distutils_hack/__init__.py\", line 83, in create_module\n```\nExcellent -- it's what I thought.\nCan you try `make setuptools-clean python3` please?",
    "created_at": "2021-06-24T20:19:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516249",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">comment:5</div>


```
 [python3-3.9.5]     File "/home/slabbe/GitBox/sage/local/lib/python3.9/site-packages/_distutils_hack/__init__.py", line 83, in create_module
```
Excellent -- it's what I thought.
Can you try `make setuptools-clean python3` please?



---

archive/issue_comments_516250.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n+This happens when python3 spkg is installed on top of an existing build. During the build, `setuptools` from our site-packages leaks in, causing the failure.\n+\n Reported for Sage 9.3 (Python 3.9.2) within freshly installed Ubuntu 20.04.02 LTS in https://groups.google.com/g/sage-devel/c/euE9MJnfjAo/m/QUv4fXXuBQAJ \n \n Reported for Sage 9.4.beta3 (Python 3.9.5) on macOS 11.4 https://groups.google.com/g/sage-devel/c/euE9MJnfjAo/m/QUv4fXXuBQAJ\n``````\n",
    "created_at": "2021-06-24T21:28:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516250",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
+This happens when python3 spkg is installed on top of an existing build. During the build, `setuptools` from our site-packages leaks in, causing the failure.
+
 Reported for Sage 9.3 (Python 3.9.2) within freshly installed Ubuntu 20.04.02 LTS in https://groups.google.com/g/sage-devel/c/euE9MJnfjAo/m/QUv4fXXuBQAJ 
 
 Reported for Sage 9.4.beta3 (Python 3.9.5) on macOS 11.4 https://groups.google.com/g/sage-devel/c/euE9MJnfjAo/m/QUv4fXXuBQAJ
``````




---

archive/issue_comments_516251.json:
```json
{
    "body": "Branch: **[u/mkoeppe/python3_spkg__modulenotfounderror__no_module_named__binascii_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/python3_spkg__modulenotfounderror__no_module_named__binascii_)**",
    "created_at": "2021-06-24T21:58:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516251",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/python3_spkg__modulenotfounderror__no_module_named__binascii_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/python3_spkg__modulenotfounderror__no_module_named__binascii_)**



---

archive/issue_comments_516252.json:
```json
{
    "body": "Commit: **[`8d31983`](https://github.com/sagemath/sagetrac-mirror/commit/8d319830fd177b18aaefdd9a22c92696fef5cc73)**",
    "created_at": "2021-06-24T22:02:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516252",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[`8d31983`](https://github.com/sagemath/sagetrac-mirror/commit/8d319830fd177b18aaefdd9a22c92696fef5cc73)**



---

archive/issue_comments_516253.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nHere's a solution\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8d319830fd177b18aaefdd9a22c92696fef5cc73\">8d31983</a></td><td><code>build/make/Makefile.in: Uninstall setuptools before reinstalling python3</code></td></tr></table>\n",
    "created_at": "2021-06-24T22:02:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516253",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

Here's a solution

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8d319830fd177b18aaefdd9a22c92696fef5cc73">8d31983</a></td><td><code>build/make/Makefile.in: Uninstall setuptools before reinstalling python3</code></td></tr></table>




---

archive/issue_events_442145.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-24T22:02:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32056#event-442145"
}
```



---

archive/issue_comments_516254.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2021-06-24T22:02:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516254",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_events_442146.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-24T22:02:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32056#event-442146"
}
```



---

archive/issue_events_442147.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-24T22:02:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32056#event-442147"
}
```



---

archive/issue_comments_516255.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2021-06-25T09:40:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516255",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_comments_516256.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nOK - although I don't have an easy way to reproduce the bug, so the review is based on reading only.",
    "created_at": "2021-06-25T09:40:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516256",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:10" align="right">comment:10</div>

OK - although I don't have an easy way to reproduce the bug, so the review is based on reading only.



---

archive/issue_events_442148.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-06-25T09:40:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32056#event-442148"
}
```



---

archive/issue_events_442149.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-06-25T09:40:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32056#event-442149"
}
```



---

archive/issue_comments_516257.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nAfter the issue, I did `.configure --with-python=/usr/bin/python3.8` which made the compilation of sage to work.\n\nThis morning, I tried to reproduce the bug without the `--with-python=/usr/bin/python3.8`. It triggers the compilation of python3.9.5 shipped with sage, but it did build it correctly:\n\n```\n-----------------------------------------------------------------------------\nChecking whether SageMath should install SPKG python3...                                             \nchecking whether any of bzip2 xz libffi is installed as or will be installed as SPKG... no\nchecking for python3 >= 3.7.0, < 3.10.0 with modules sqlite3, ctypes, math, hashlib, crypt, readline,\n socket, zlib, distutils.core...                                                                     checking ... whether /usr/bin/python3 is good... no, Python 3.6.9 is too old                 \n                                                                                                     configure: to try to use a different system python, use ./configure --with-python=/path/to/python    \nconfigure: no suitable system package found for SPKG python3                                         -----------------------------------------------------------------------------   \n\n[...]\n\n[python3-3.9.5] installing. Log file: /home/slabbe/GitBox/sage/logs/pkgs/python3-3.9.5.log\n  [python3-3.9.5] successfully installed.\n```\n\nWhat should I do to reproduce the bug? Checkout 9.4.beta0, compile it, and then checkout 9.4.beta3 and then compile it?",
    "created_at": "2021-06-25T12:23:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516257",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:11" align="right">comment:11</div>

After the issue, I did `.configure --with-python=/usr/bin/python3.8` which made the compilation of sage to work.

This morning, I tried to reproduce the bug without the `--with-python=/usr/bin/python3.8`. It triggers the compilation of python3.9.5 shipped with sage, but it did build it correctly:

```
-----------------------------------------------------------------------------
Checking whether SageMath should install SPKG python3...                                             
checking whether any of bzip2 xz libffi is installed as or will be installed as SPKG... no
checking for python3 >= 3.7.0, < 3.10.0 with modules sqlite3, ctypes, math, hashlib, crypt, readline,
 socket, zlib, distutils.core...                                                                     checking ... whether /usr/bin/python3 is good... no, Python 3.6.9 is too old                 
                                                                                                     configure: to try to use a different system python, use ./configure --with-python=/path/to/python    
configure: no suitable system package found for SPKG python3                                         -----------------------------------------------------------------------------   

[...]

[python3-3.9.5] installing. Log file: /home/slabbe/GitBox/sage/logs/pkgs/python3-3.9.5.log
  [python3-3.9.5] successfully installed.
```

What should I do to reproduce the bug? Checkout 9.4.beta0, compile it, and then checkout 9.4.beta3 and then compile it?



---

archive/issue_comments_516258.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nOk, I managed to reproduce the bug by compiling 9.4.beta1 (after downgrading from a compiled 9.4.beta3) which is shipped with Python 3.9.2.\n\n```\n  File \"/home/slabbe/GitBox/sage/local/lib/python3.9/site-packages/setuptools/__init__.py\", line 16, in <module>\n    import setuptools.version\n  File \"/home/slabbe/GitBox/sage/local/lib/python3.9/site-packages/setuptools/version.py\", line 1, in <module>\n    import pkg_resources\n  File \"/home/slabbe/GitBox/sage/local/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 23, in <module>\n    import zipfile\n  File \"/home/slabbe/GitBox/sage/local/var/tmp/sage/build/python3-3.9.2/src/Lib/zipfile.py\", line 6, in <module>\n    import binascii\nModuleNotFoundError: No module named 'binascii'\nMakefile:638: recipe for target 'sharedmods' failed\nmake[5]: *** [sharedmods] Error 1\n*****************************************************************************************************\nError building python3-3.9.2\n*****************************************************************************************************\n```",
    "created_at": "2021-06-25T13:03:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516258",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:12" align="right">comment:12</div>

Ok, I managed to reproduce the bug by compiling 9.4.beta1 (after downgrading from a compiled 9.4.beta3) which is shipped with Python 3.9.2.

```
  File "/home/slabbe/GitBox/sage/local/lib/python3.9/site-packages/setuptools/__init__.py", line 16, in <module>
    import setuptools.version
  File "/home/slabbe/GitBox/sage/local/lib/python3.9/site-packages/setuptools/version.py", line 1, in <module>
    import pkg_resources
  File "/home/slabbe/GitBox/sage/local/lib/python3.9/site-packages/pkg_resources/__init__.py", line 23, in <module>
    import zipfile
  File "/home/slabbe/GitBox/sage/local/var/tmp/sage/build/python3-3.9.2/src/Lib/zipfile.py", line 6, in <module>
    import binascii
ModuleNotFoundError: No module named 'binascii'
Makefile:638: recipe for target 'sharedmods' failed
make[5]: *** [sharedmods] Error 1
*****************************************************************************************************
Error building python3-3.9.2
*****************************************************************************************************
```



---

archive/issue_comments_516259.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThen, I checked out 9.4.beta3, run make, and was able to reproduce the error with python 3.9.5. Then, I pulled the current branch of this ticket and then `python3.9.5` was built ok after a make. So I feel this branch is fixing the issue.\n\nBut, I now get an error with cython (forgot to copy paste the error message, sorry). Then, I did make distclean and make and I am waiting for the result.",
    "created_at": "2021-06-25T14:24:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516259",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:13" align="right">comment:13</div>

Then, I checked out 9.4.beta3, run make, and was able to reproduce the error with python 3.9.5. Then, I pulled the current branch of this ticket and then `python3.9.5` was built ok after a make. So I feel this branch is fixing the issue.

But, I now get an error with cython (forgot to copy paste the error message, sorry). Then, I did make distclean and make and I am waiting for the result.



---

archive/issue_comments_516260.json:
```json
{
    "body": "Changed reviewer from **Dima Pasechnik** to **Dima Pasechnik, S\u00e9bastien Labb\u00e9**",
    "created_at": "2021-06-25T14:50:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516260",
    "user": "https://github.com/seblabbe"
}
```

Changed reviewer from **Dima Pasechnik** to **Dima Pasechnik, Sébastien Labbé**



---

archive/issue_comments_516261.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\n\n```\n[...]\nSage build/upgrade complete!\n[...]\n$ ./sage\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 9.4.beta3, Release Date: 2021-06-21               \u2502\n\u2502 Using Python 3.9.5. Type \"help()\" for help.                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\nsage: \n```",
    "created_at": "2021-06-25T14:50:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516261",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:14" align="right">comment:14</div>


```
[...]
Sage build/upgrade complete!
[...]
$ ./sage
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 9.4.beta3, Release Date: 2021-06-21               │
│ Using Python 3.9.5. Type "help()" for help.                        │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: 
```



---

archive/issue_comments_516262.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThanks for the review!",
    "created_at": "2021-06-25T15:37:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516262",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">comment:15</div>

Thanks for the review!



---

archive/issue_comments_516263.json:
```json
{
    "body": "Attachment: **[numpy-1.20.3.log](https://github.com/sagemath/sage/files/ticket32056/numpy-1.20.3.log)**",
    "created_at": "2021-06-25T20:07:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516263",
    "user": "https://github.com/culler"
}
```

Attachment: **[numpy-1.20.3.log](https://github.com/sagemath/sage/files/ticket32056/numpy-1.20.3.log)**



---

archive/issue_comments_516264.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI built the master branch after \"make distclean\" and then switched to the develop branch. I applied the patch to Makefile.in and then ran the incremental build with make.  There was no problem building python3.  However, the build failed on the numpy spkg. It is hard to imagine that this is related, as the exception occurred in the pip package. But perhaps there is an analagous issue with pip.  The actual exception was:\n\n```\n  ImportError: cannot import name 'gen' from 'tornado' (unknown location)  \n```\n\nThe traceback is below.  I will attach the numpy build log. \n\n```\n[numpy-1.20.3] Traceback (most recent call last):\n[numpy-1.20.3]   File \"/Users/culler/programs/Sage_macOS/Sage_framework/repo/sage/local/lib/python3.9/runpy.py\", line 197, in _run_module_as_main\n[numpy-1.20.3]     return _run_code(code, main_globals, None,\n[numpy-1.20.3]   File \"/Users/culler/programs/Sage_macOS/Sage_framework/repo/sage/local/lib/python3.9/runpy.py\", line 87, in _run_code\n[numpy-1.20.3]     exec(code, run_globals)\n[numpy-1.20.3]   File \"/Users/culler/.sage/local/lib/python3.9/site-packages/pip/__main__.py\", line 29, in <module>\n[numpy-1.20.3]     from pip._internal.cli.main import main as _main\n[numpy-1.20.3]   File \"/Users/culler/.sage/local/lib/python3.9/site-packages/pip/_internal/cli/main.py\", line 9, in <module>\n[numpy-1.20.3]     from pip._internal.cli.autocompletion import autocomplete\n[numpy-1.20.3]   File \"/Users/culler/.sage/local/lib/python3.9/site-packages/pip/_internal/cli/autocompletion.py\", line 10, in <module>\n[numpy-1.20.3]     from pip._internal.cli.main_parser import create_main_parser\n[numpy-1.20.3]   File \"/Users/culler/.sage/local/lib/python3.9/site-packages/pip/_internal/cli/main_parser.py\", line 8, in <module>\n[numpy-1.20.3]     from pip._internal.cli import cmdoptions\n[numpy-1.20.3]   File \"/Users/culler/.sage/local/lib/python3.9/site-packages/pip/_internal/cli/cmdoptions.py\", line 23, in <module>\n[numpy-1.20.3]     from pip._internal.cli.parser import ConfigOptionParser\n[numpy-1.20.3]   File \"/Users/culler/.sage/local/lib/python3.9/site-packages/pip/_internal/cli/parser.py\", line 12, in <module>\n[numpy-1.20.3]     from pip._internal.configuration import Configuration, ConfigurationError\n[numpy-1.20.3]   File \"/Users/culler/.sage/local/lib/python3.9/site-packages/pip/_internal/configuration.py\", line 27, in <module>\n[numpy-1.20.3]     from pip._internal.utils.misc import ensure_dir, enum\n[numpy-1.20.3]   File \"/Users/culler/.sage/local/lib/python3.9/site-packages/pip/_internal/utils/misc.py\", line 38, in <module>\n[numpy-1.20.3]     from pip._vendor.tenacity import retry, stop_after_delay, wait_fixed\n[numpy-1.20.3]   File \"/Users/culler/.sage/local/lib/python3.9/site-packages/pip/_vendor/tenacity/__init__.py\", line 523, in <module>\n[numpy-1.20.3]     from pip._vendor.tenacity.tornadoweb import TornadoRetrying\n[numpy-1.20.3]   File \"/Users/culler/.sage/local/lib/python3.9/site-packages/pip/_vendor/tenacity/tornadoweb.py\", line 23, in <module>\n[numpy-1.20.3]     from tornado import gen\n[numpy-1.20.3] ImportError: cannot import name 'gen' from 'tornado' (unknown location)\n[numpy-1.20.3] Error: installing with pip3 failed\n[numpy-1.20.3] ********************************************************************************\n[numpy-1.20.3] Error installing numpy-1.20.3-cp39-cp39-macosx_10_9_x86_64.whl\n[numpy-1.20.3] ******************************************************************************\n```",
    "created_at": "2021-06-25T20:10:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516264",
    "user": "https://github.com/culler"
}
```

<div id="comment:16" align="right">comment:16</div>

I built the master branch after "make distclean" and then switched to the develop branch. I applied the patch to Makefile.in and then ran the incremental build with make.  There was no problem building python3.  However, the build failed on the numpy spkg. It is hard to imagine that this is related, as the exception occurred in the pip package. But perhaps there is an analagous issue with pip.  The actual exception was:

```
  ImportError: cannot import name 'gen' from 'tornado' (unknown location)  
```

The traceback is below.  I will attach the numpy build log. 

```
[numpy-1.20.3] Traceback (most recent call last):
[numpy-1.20.3]   File "/Users/culler/programs/Sage_macOS/Sage_framework/repo/sage/local/lib/python3.9/runpy.py", line 197, in _run_module_as_main
[numpy-1.20.3]     return _run_code(code, main_globals, None,
[numpy-1.20.3]   File "/Users/culler/programs/Sage_macOS/Sage_framework/repo/sage/local/lib/python3.9/runpy.py", line 87, in _run_code
[numpy-1.20.3]     exec(code, run_globals)
[numpy-1.20.3]   File "/Users/culler/.sage/local/lib/python3.9/site-packages/pip/__main__.py", line 29, in <module>
[numpy-1.20.3]     from pip._internal.cli.main import main as _main
[numpy-1.20.3]   File "/Users/culler/.sage/local/lib/python3.9/site-packages/pip/_internal/cli/main.py", line 9, in <module>
[numpy-1.20.3]     from pip._internal.cli.autocompletion import autocomplete
[numpy-1.20.3]   File "/Users/culler/.sage/local/lib/python3.9/site-packages/pip/_internal/cli/autocompletion.py", line 10, in <module>
[numpy-1.20.3]     from pip._internal.cli.main_parser import create_main_parser
[numpy-1.20.3]   File "/Users/culler/.sage/local/lib/python3.9/site-packages/pip/_internal/cli/main_parser.py", line 8, in <module>
[numpy-1.20.3]     from pip._internal.cli import cmdoptions
[numpy-1.20.3]   File "/Users/culler/.sage/local/lib/python3.9/site-packages/pip/_internal/cli/cmdoptions.py", line 23, in <module>
[numpy-1.20.3]     from pip._internal.cli.parser import ConfigOptionParser
[numpy-1.20.3]   File "/Users/culler/.sage/local/lib/python3.9/site-packages/pip/_internal/cli/parser.py", line 12, in <module>
[numpy-1.20.3]     from pip._internal.configuration import Configuration, ConfigurationError
[numpy-1.20.3]   File "/Users/culler/.sage/local/lib/python3.9/site-packages/pip/_internal/configuration.py", line 27, in <module>
[numpy-1.20.3]     from pip._internal.utils.misc import ensure_dir, enum
[numpy-1.20.3]   File "/Users/culler/.sage/local/lib/python3.9/site-packages/pip/_internal/utils/misc.py", line 38, in <module>
[numpy-1.20.3]     from pip._vendor.tenacity import retry, stop_after_delay, wait_fixed
[numpy-1.20.3]   File "/Users/culler/.sage/local/lib/python3.9/site-packages/pip/_vendor/tenacity/__init__.py", line 523, in <module>
[numpy-1.20.3]     from pip._vendor.tenacity.tornadoweb import TornadoRetrying
[numpy-1.20.3]   File "/Users/culler/.sage/local/lib/python3.9/site-packages/pip/_vendor/tenacity/tornadoweb.py", line 23, in <module>
[numpy-1.20.3]     from tornado import gen
[numpy-1.20.3] ImportError: cannot import name 'gen' from 'tornado' (unknown location)
[numpy-1.20.3] Error: installing with pip3 failed
[numpy-1.20.3] ********************************************************************************
[numpy-1.20.3] Error installing numpy-1.20.3-cp39-cp39-macosx_10_9_x86_64.whl
[numpy-1.20.3] ******************************************************************************
```



---

archive/issue_comments_516265.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI just noticed that the cysignals spkg also failed to install with the same exception about importing gen from tornado.  I was using make -j4, and evidently I got both errors simultaneously.",
    "created_at": "2021-06-25T20:18:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516265",
    "user": "https://github.com/culler"
}
```

<div id="comment:17" align="right">comment:17</div>

I just noticed that the cysignals spkg also failed to install with the same exception about importing gen from tornado.  I was using make -j4, and evidently I got both errors simultaneously.



---

archive/issue_comments_516266.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThat's an unrelated problem fixed in #32022",
    "created_at": "2021-06-25T20:20:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516266",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:18" align="right">comment:18</div>

That's an unrelated problem fixed in #32022



---

archive/issue_comments_516267.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/python3_spkg__modulenotfounderror__no_module_named__binascii_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/python3_spkg__modulenotfounderror__no_module_named__binascii_)** to **[`8d31983`](https://github.com/sagemath/sagetrac-mirror/commit/8d319830fd177b18aaefdd9a22c92696fef5cc73)**",
    "created_at": "2021-06-29T17:40:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516267",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/python3_spkg__modulenotfounderror__no_module_named__binascii_](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/python3_spkg__modulenotfounderror__no_module_named__binascii_)** to **[`8d31983`](https://github.com/sagemath/sagetrac-mirror/commit/8d319830fd177b18aaefdd9a22c92696fef5cc73)**



---

archive/issue_events_442150.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-06-29T17:40:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32056#event-442150"
}
```



---

archive/issue_events_442151.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "6f1eef63c0d7467cf3e5489b4dbad702f553414f",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-06-29T17:40:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32056#event-442151"
}
```



---

archive/issue_comments_516268.json:
```json
{
    "body": "Changed commit from **[`8d31983`](https://github.com/sagemath/sagetrac-mirror/commit/8d319830fd177b18aaefdd9a22c92696fef5cc73)** to none",
    "created_at": "2021-09-25T04:20:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516268",
    "user": "https://github.com/isuruf"
}
```

Changed commit from **[`8d31983`](https://github.com/sagemath/sagetrac-mirror/commit/8d319830fd177b18aaefdd9a22c92696fef5cc73)** to none



---

archive/issue_comments_516269.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nThis is still an issue with conda-forge ubuntu tox job. See https://github.com/isuruf/sage/runs/3704134442?check_suite_focus=true\n\n```\nLog file: /home/runner/work/sage/sage/logs/pkgs/python3-3.9.6.log\n  [python3-3.9.6] error installing, exit status 1. End of log file:\n  [python3-3.9.6]     File \"/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-minimal/local/var/tmp/sage/build/python3-3.9.6/src/./setup.py\", line 33, in <module>\n  [python3-3.9.6]       from distutils import log\n  [python3-3.9.6]     File \"/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-minimal/conda/lib/python3.9/site-packages/_distutils_hack/__init__.py\", line 88, in create_module\n  [python3-3.9.6]       return importlib.import_module('setuptools._distutils')\n  [python3-3.9.6]     File \"/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-minimal/conda/lib/python3.9/importlib/__init__.py\", line 127, in import_module\n  [python3-3.9.6]       return _bootstrap._gcd_import(name[level:], package, level)\n  [python3-3.9.6]     File \"/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-minimal/conda/lib/python3.9/site-packages/setuptools/__init__.py\", line 16, in <module>\n  [python3-3.9.6]       import setuptools.version\n  [python3-3.9.6]     File \"/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-minimal/conda/lib/python3.9/site-packages/setuptools/version.py\", line 1, in <module>\n  [python3-3.9.6]       import pkg_resources\n  [python3-3.9.6]     File \"/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-minimal/conda/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 23, in <module>\n  [python3-3.9.6]       import zipfile\n  [python3-3.9.6]     File \"/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-minimal/conda/lib/python3.9/zipfile.py\", line 6, in <module>\n  [python3-3.9.6]       import binascii\n  [python3-3.9.6]   ModuleNotFoundError: No module named 'binascii'\n```",
    "created_at": "2021-09-25T04:20:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32056#issuecomment-516269",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:20" align="right">comment:20</div>

This is still an issue with conda-forge ubuntu tox job. See https://github.com/isuruf/sage/runs/3704134442?check_suite_focus=true

```
Log file: /home/runner/work/sage/sage/logs/pkgs/python3-3.9.6.log
  [python3-3.9.6] error installing, exit status 1. End of log file:
  [python3-3.9.6]     File "/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-minimal/local/var/tmp/sage/build/python3-3.9.6/src/./setup.py", line 33, in <module>
  [python3-3.9.6]       from distutils import log
  [python3-3.9.6]     File "/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-minimal/conda/lib/python3.9/site-packages/_distutils_hack/__init__.py", line 88, in create_module
  [python3-3.9.6]       return importlib.import_module('setuptools._distutils')
  [python3-3.9.6]     File "/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-minimal/conda/lib/python3.9/importlib/__init__.py", line 127, in import_module
  [python3-3.9.6]       return _bootstrap._gcd_import(name[level:], package, level)
  [python3-3.9.6]     File "/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-minimal/conda/lib/python3.9/site-packages/setuptools/__init__.py", line 16, in <module>
  [python3-3.9.6]       import setuptools.version
  [python3-3.9.6]     File "/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-minimal/conda/lib/python3.9/site-packages/setuptools/version.py", line 1, in <module>
  [python3-3.9.6]       import pkg_resources
  [python3-3.9.6]     File "/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-minimal/conda/lib/python3.9/site-packages/pkg_resources/__init__.py", line 23, in <module>
  [python3-3.9.6]       import zipfile
  [python3-3.9.6]     File "/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-minimal/conda/lib/python3.9/zipfile.py", line 6, in <module>
  [python3-3.9.6]       import binascii
  [python3-3.9.6]   ModuleNotFoundError: No module named 'binascii'
```
