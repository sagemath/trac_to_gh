# Issue 32176: Support building Sage with the Flang Fortran compiler

archive/issues_031939.json:
```json
{
    "assignees": [],
    "body": "Part of:\n\n- #23926: Meta-ticket: allow more Fortran compilers\n\nCC:  @dimpase @mkoeppe @slel\n\nKeywords: **fortran, flang**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/32176_\n\n",
    "created_at": "2021-07-11T04:56:54Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/wishlist%20item"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Support building Sage with the Flang Fortran compiler",
    "type": "issue",
    "updated_at": "2021-09-24T11:46:52Z",
    "url": "https://github.com/sagemath/sage/issues/32176",
    "user": "https://github.com/slel"
}
```
Part of:

- #23926: Meta-ticket: allow more Fortran compilers

CC:  @dimpase @mkoeppe @slel

Keywords: **fortran, flang**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/32176_





---

archive/issue_events_440601.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-07-11T04:56:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/32176",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32176#event-440601"
}
```



---

archive/issue_events_440602.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-07-11T04:56:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32176",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "0000b0",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32176#event-440602"
}
```



---

archive/issue_events_440603.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-07-11T04:56:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32176",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32176#event-440603"
}
```



---

archive/issue_events_440604.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-07-11T04:56:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32176",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32176#event-440604"
}
```



---

archive/issue_comments_518234.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nFrom a discussion at [#30835 comment:11](https://github.com/sagemath/sage/issues/30835#comment:11).\n\nPlease confirm we are talking about this Flang:\n\n- http://flang.llvm.org/docs/\n\nrather than this one:\n\n- https://github.com/flang-compiler/flang",
    "created_at": "2021-07-11T04:59:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32176#issuecomment-518234",
    "user": "https://github.com/slel"
}
```

<div id="comment:1" align="right">comment:1</div>

From a discussion at [#30835 comment:11](https://github.com/sagemath/sage/issues/30835#comment:11).

Please confirm we are talking about this Flang:

- http://flang.llvm.org/docs/

rather than this one:

- https://github.com/flang-compiler/flang



---

archive/issue_comments_518235.json:
```json
{
    "body": "Changed keywords from none to **fortran, flang**",
    "created_at": "2021-07-11T04:59:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32176#issuecomment-518235",
    "user": "https://github.com/slel"
}
```

Changed keywords from none to **fortran, flang**



---

archive/issue_comments_518236.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThe former is not yet a real compiler.",
    "created_at": "2021-07-11T06:51:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32176#issuecomment-518236",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:2" align="right">comment:2</div>

The former is not yet a real compiler.



---

archive/issue_events_440605.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-11T17:19:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/32176",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32176#event-440605"
}
```



---

archive/issue_events_440606.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-11T17:19:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/32176",
    "label": "https://github.com/sagemath/sage/labels/wishlist%20item",
    "label_color": "e81ff9",
    "label_name": "wishlist item",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/32176#event-440606"
}
```



---

archive/issue_comments_518237.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n+Part of:\n \n+- #23926: Meta-ticket: allow more Fortran compilers\n``````\n",
    "created_at": "2021-07-11T18:26:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32176#issuecomment-518237",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
+Part of:
 
+- #23926: Meta-ticket: allow more Fortran compilers
``````




---

archive/issue_comments_518238.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@dimpase](#comment%3A2):\n> The former is not yet a real compiler.\n\nCan you elaborate?",
    "created_at": "2021-09-24T05:27:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32176#issuecomment-518238",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@dimpase](#comment%3A2):
> The former is not yet a real compiler.

Can you elaborate?



---

archive/issue_comments_518239.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@williamstein](#comment%3A5):\n> Replying to [@dimpase](#comment%3A2):\n> > The former is not yet a real compiler.\n\n> \n> Can you elaborate? \n\nhttps://releases.llvm.org/11.0.0/tools/flang/docs/ReleaseNotes.html says that it needs an \"external Fortran compiler\", defaulted to `gfortran`, to operate\n\n```\nUsing Flang\n\nUsage: flang hello.f90 -o hello.bin\n\nBy default, Flang will parse the Fortran file hello.f90 then unparse it to a canonical Fortran source file. \nFlang will then invoke an external Fortran compiler to compile this source file and link it, placing the resulting executable in hello.bin.\n\nTo specify the external Fortran compiler, set the F18_FC environment variable to the name of the compiler binary and ensure that it is on your PATH. \nThe default value for F18_FC is gfortran.\n```",
    "created_at": "2021-09-24T11:46:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/32176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/32176#issuecomment-518239",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@williamstein](#comment%3A5):
> Replying to [@dimpase](#comment%3A2):
> > The former is not yet a real compiler.

> 
> Can you elaborate? 

https://releases.llvm.org/11.0.0/tools/flang/docs/ReleaseNotes.html says that it needs an "external Fortran compiler", defaulted to `gfortran`, to operate

```
Using Flang

Usage: flang hello.f90 -o hello.bin

By default, Flang will parse the Fortran file hello.f90 then unparse it to a canonical Fortran source file. 
Flang will then invoke an external Fortran compiler to compile this source file and link it, placing the resulting executable in hello.bin.

To specify the external Fortran compiler, set the F18_FC environment variable to the name of the compiler binary and ensure that it is on your PATH. 
The default value for F18_FC is gfortran.
```
