# Issue 32352: Efficient algorithm to compute products in the C' basis of an Iwahori-Hecke algebra

archive/issues_032115.json:
```json
{
    "body": "> **(Update after review completed)** The `Cp_Coxeter3` class mentioned below was eventually merged into the `Cp` class, and the `Cp_Coxeter3.product_on_basis` method is moved into the latter. \n\n\nThis ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis more quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:\n\n```python\nsage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3\nsage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\nsage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\nsage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\nsage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n+ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n+ (v^-1+v)*Cp[3,4,1,2,3,4]\n+ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n+ (v^-1+v)*Cp[3,4,1,2]\nsage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n+ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n+ (v^-1+v)*CpC[3,4,1,2,3,4]\n+ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n+ (v^-1+v)*CpC[3,4,1,2]\n```\n\nThe following computation also seems infeasible in the existing `Cp` basis (it did not terminate in any reasonable time), but it is again instant in `Cp_Coxeter3`:\n\n```python\nsage: W = CoxeterGroup('A9', implementation='coxeter3')     # optional - coxeter3\nsage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\nsage: CpC = H.Cp_Coxeter3()                                 # optional - coxeter3\nsage: CpC[1,2,1,8,9,8]*CpC[1,2,3,7,8,9]                     # optional - coxeter3\n(v^-2+2+v^2)*CpC[1,2,1,3,7,8,7,9,8,7]\n+ (v^-2+2+v^2)*CpC[1,2,1,3,8,9,8,7]\n+ (v^-3+3*v^-1+3*v+v^3)*CpC[1,2,1,3,8,9,8]\n```\n \nThe main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples (including more previously infeasible computations) are given in the documentation for this function and the class. We also handle conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way.\n\nThe product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to determine all cells in any finite Coxeter group. We have included functions in `sage/categories/coxeter_groups.py` that can calculate the cells containing an element or compute all cells within a finite Coxeter group. Some example computations are given below.\n\n\n```python\nsage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3\nsage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3\nsage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3\n{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}\nsage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3\n{[3], [3, 2], [3, 2, 1], [3, 2, 3]}\nsage: W.kazhdan_lusztig_cell(s3, side='two-sided')          # optional - coxeter3\n{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],\n [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}\n```\n\nCC:  @tscrim @AndrewAtLarge\n\nKeywords: Coxeter systems,Coxeter groups,Iwahori-Hecke algebra,Kazhdan-Lusztig cells,Kazhdan-Lusztig basis\n\nBranch/Commit: 901699badeb305cdfbbfd52cc8427a3ea53512b8\n\nReviewer: Travis Scrimshaw\n\nAuthor: Chase Meadors, Tianyuan Xu\n\nDependencies: #32266\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/32352\n\n",
    "closed_at": "2021-10-19T20:30:43Z",
    "created_at": "2021-08-09T22:37:49Z",
    "labels": [
        "component: combinatorics",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Efficient algorithm to compute products in the C' basis of an Iwahori-Hecke algebra",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32352",
    "user": "https://github.com/cemulate"
}
```
> **(Update after review completed)** The `Cp_Coxeter3` class mentioned below was eventually merged into the `Cp` class, and the `Cp_Coxeter3.product_on_basis` method is moved into the latter. 


This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis more quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:

```python
sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3
sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
+ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
+ (v^-1+v)*Cp[3,4,1,2,3,4]
+ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
+ (v^-1+v)*Cp[3,4,1,2]
sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
+ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
+ (v^-1+v)*CpC[3,4,1,2,3,4]
+ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
+ (v^-1+v)*CpC[3,4,1,2]
```

The following computation also seems infeasible in the existing `Cp` basis (it did not terminate in any reasonable time), but it is again instant in `Cp_Coxeter3`:

```python
sage: W = CoxeterGroup('A9', implementation='coxeter3')     # optional - coxeter3
sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
sage: CpC = H.Cp_Coxeter3()                                 # optional - coxeter3
sage: CpC[1,2,1,8,9,8]*CpC[1,2,3,7,8,9]                     # optional - coxeter3
(v^-2+2+v^2)*CpC[1,2,1,3,7,8,7,9,8,7]
+ (v^-2+2+v^2)*CpC[1,2,1,3,8,9,8,7]
+ (v^-3+3*v^-1+3*v+v^3)*CpC[1,2,1,3,8,9,8]
```
 
The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples (including more previously infeasible computations) are given in the documentation for this function and the class. We also handle conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way.

The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to determine all cells in any finite Coxeter group. We have included functions in `sage/categories/coxeter_groups.py` that can calculate the cells containing an element or compute all cells within a finite Coxeter group. Some example computations are given below.


```python
sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3
sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3
sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3
{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}
sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3
{[3], [3, 2], [3, 2, 1], [3, 2, 3]}
sage: W.kazhdan_lusztig_cell(s3, side='two-sided')          # optional - coxeter3
{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],
 [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}
```

CC:  @tscrim @AndrewAtLarge

Keywords: Coxeter systems,Coxeter groups,Iwahori-Hecke algebra,Kazhdan-Lusztig cells,Kazhdan-Lusztig basis

Branch/Commit: 901699badeb305cdfbbfd52cc8427a3ea53512b8

Reviewer: Travis Scrimshaw

Author: Chase Meadors, Tianyuan Xu

Dependencies: #32266

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/32352





---

archive/issue_comments_489614.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2021-08-09T22:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489614",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_489615.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,77 @@\n+This ticket introduces a feature to perform complex and highly-nontrivial calculations in the Kazhdan-Lusztig basis of an Iwahori-Hecke algebra.\n \n+The existing implementation of the C' basis (`IwahoriHeckeAlgebra.Cp`) works by converting elements to the T-basis, performing multiplication there, and converting back.\n+This ticket introduces a new basis, `IwahoriHeckeAlgebra.Cp_Coxeter3`, that provides an alternative implementation of the C' basis that relies on the package coxeter3 for its computations (specifically, computation of \"mu-coefficients\" is delegated to coxeter3).\n+It uses an algorithm to compute products of basis elements directly in the C' basis (without conversion), and is able to achieve computations that seem infeasable or prohibitively long in the existing `Cp` basis.\n+A description of the ideas and algorithm can be found in the class documentation for `IwahoriHeckeAlgebra.Cp_Coxeter3`; the main content of the algorithm occurs in `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. \n+\n+To use the `Cp_Coxeter3` basis, the `IwahoriHeckeAlgebra` must be created with a `coxeter3`-implemented Coxeter group.\n+As `IwahoriHeckeAlgebra.Cp_Coxeter3` is an alternative implementation of the C' basis, it has identical usage to the existing implementation `IwahoriHeckeAlgebra.Cp`.\n+See the `Cp_Coxeter3` class documentation a thorough introduction to the implementation; we include here two examples from the class documentation that demonstrate the improvement in computational power:\n+\n+First, an example of a computation that takes 5 seconds in `Cp` and is instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+\n+Secondly, a computation in `H4` that seems infeasible in the existing `Cp` implementation (that is, it did not terminate in any reasonable time):\n+\n+```python\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+\n+The main content of this ticket is the addition of the `Cp_Coxeter3` basis to `iwahori_hecke_algebra.py`.\n+We also implement conversions to and from the other existing bases.\n+As an application, we have included a method to compute Kazhdan-Lusztig left, right, and two-sided cells of Coxeter group elements, that uses the `Cp_Coxeter3` basis to compute products.\n+Its usage is as follows:\n+\n+```\n+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3\n+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3\n+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3\n+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}\n+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3\n+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}\n+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3\n+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='both')               # optional - coxeter3\n+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],\n+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+```\n \n Author: Chase Meadors, Tianyuan Xu\n \n``````\n",
    "created_at": "2021-08-09T23:31:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489615",
    "user": "https://github.com/cemulate"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,77 @@
+This ticket introduces a feature to perform complex and highly-nontrivial calculations in the Kazhdan-Lusztig basis of an Iwahori-Hecke algebra.
 
+The existing implementation of the C' basis (`IwahoriHeckeAlgebra.Cp`) works by converting elements to the T-basis, performing multiplication there, and converting back.
+This ticket introduces a new basis, `IwahoriHeckeAlgebra.Cp_Coxeter3`, that provides an alternative implementation of the C' basis that relies on the package coxeter3 for its computations (specifically, computation of "mu-coefficients" is delegated to coxeter3).
+It uses an algorithm to compute products of basis elements directly in the C' basis (without conversion), and is able to achieve computations that seem infeasable or prohibitively long in the existing `Cp` basis.
+A description of the ideas and algorithm can be found in the class documentation for `IwahoriHeckeAlgebra.Cp_Coxeter3`; the main content of the algorithm occurs in `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. 
+
+To use the `Cp_Coxeter3` basis, the `IwahoriHeckeAlgebra` must be created with a `coxeter3`-implemented Coxeter group.
+As `IwahoriHeckeAlgebra.Cp_Coxeter3` is an alternative implementation of the C' basis, it has identical usage to the existing implementation `IwahoriHeckeAlgebra.Cp`.
+See the `Cp_Coxeter3` class documentation a thorough introduction to the implementation; we include here two examples from the class documentation that demonstrate the improvement in computational power:
+
+First, an example of a computation that takes 5 seconds in `Cp` and is instant in `Cp_Coxeter3`:
+
+```python
+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+
+Secondly, a computation in `H4` that seems infeasible in the existing `Cp` implementation (that is, it did not terminate in any reasonable time):
+
+```python
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+
+The main content of this ticket is the addition of the `Cp_Coxeter3` basis to `iwahori_hecke_algebra.py`.
+We also implement conversions to and from the other existing bases.
+As an application, we have included a method to compute Kazhdan-Lusztig left, right, and two-sided cells of Coxeter group elements, that uses the `Cp_Coxeter3` basis to compute products.
+Its usage is as follows:
+
+```
+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3
+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3
+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3
+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}
+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3
+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}
+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3
+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='both')               # optional - coxeter3
+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],
+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}
+```
 
 Author: Chase Meadors, Tianyuan Xu
 
``````




---

archive/issue_comments_489616.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,80 @@\n+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, viewing the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, I can rebase or reorganize branches in the appropriate way as directed by a reviewer.\n \n+\n+This ticket introduces a feature to perform complex and highly-nontrivial calculations in the Kazhdan-Lusztig basis of an Iwahori-Hecke algebra.\n+\n+The existing implementation of the C' basis (`IwahoriHeckeAlgebra.Cp`) works by converting elements to the T-basis, performing multiplication there, and converting back.\n+This ticket introduces a new basis, `IwahoriHeckeAlgebra.Cp_Coxeter3`, that provides an alternative implementation of the C' basis that relies on the package coxeter3 for its computations (specifically, computation of \"mu-coefficients\" is delegated to coxeter3).\n+It uses an algorithm to compute products of basis elements directly in the C' basis (without conversion), and is able to achieve computations that seem infeasable or prohibitively long in the existing `Cp` basis.\n+A description of the ideas and algorithm can be found in the class documentation for `IwahoriHeckeAlgebra.Cp_Coxeter3`; the main content of the algorithm occurs in `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. \n+\n+To use the `Cp_Coxeter3` basis, the `IwahoriHeckeAlgebra` must be created with a `coxeter3`-implemented Coxeter group.\n+As `IwahoriHeckeAlgebra.Cp_Coxeter3` is an alternative implementation of the C' basis, it has identical usage to the existing implementation `IwahoriHeckeAlgebra.Cp`.\n+See the `Cp_Coxeter3` class documentation a thorough introduction to the implementation; we include here two examples from the class documentation that demonstrate the improvement in computational power:\n+\n+First, an example of a computation that takes 5 seconds in `Cp` and is instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+\n+Secondly, a computation in `H4` that seems infeasible in the existing `Cp` implementation (that is, it did not terminate in any reasonable time):\n+\n+```python\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+\n+The main content of this ticket is the addition of the `Cp_Coxeter3` basis to `iwahori_hecke_algebra.py`.\n+We also implement conversions to and from the other existing bases.\n+As an application, we have included a method to compute Kazhdan-Lusztig left, right, and two-sided cells of Coxeter group elements, that uses the `Cp_Coxeter3` basis to compute products.\n+Its usage is as follows:\n+\n+```\n+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3\n+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3\n+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3\n+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}\n+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3\n+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}\n+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3\n+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='both')               # optional - coxeter3\n+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],\n+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+```\n \n Author: Chase Meadors, Tianyuan Xu\n \n``````\n",
    "created_at": "2021-08-09T23:34:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489616",
    "user": "https://github.com/cemulate"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,80 @@
+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, viewing the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, I can rebase or reorganize branches in the appropriate way as directed by a reviewer.
 
+
+This ticket introduces a feature to perform complex and highly-nontrivial calculations in the Kazhdan-Lusztig basis of an Iwahori-Hecke algebra.
+
+The existing implementation of the C' basis (`IwahoriHeckeAlgebra.Cp`) works by converting elements to the T-basis, performing multiplication there, and converting back.
+This ticket introduces a new basis, `IwahoriHeckeAlgebra.Cp_Coxeter3`, that provides an alternative implementation of the C' basis that relies on the package coxeter3 for its computations (specifically, computation of "mu-coefficients" is delegated to coxeter3).
+It uses an algorithm to compute products of basis elements directly in the C' basis (without conversion), and is able to achieve computations that seem infeasable or prohibitively long in the existing `Cp` basis.
+A description of the ideas and algorithm can be found in the class documentation for `IwahoriHeckeAlgebra.Cp_Coxeter3`; the main content of the algorithm occurs in `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. 
+
+To use the `Cp_Coxeter3` basis, the `IwahoriHeckeAlgebra` must be created with a `coxeter3`-implemented Coxeter group.
+As `IwahoriHeckeAlgebra.Cp_Coxeter3` is an alternative implementation of the C' basis, it has identical usage to the existing implementation `IwahoriHeckeAlgebra.Cp`.
+See the `Cp_Coxeter3` class documentation a thorough introduction to the implementation; we include here two examples from the class documentation that demonstrate the improvement in computational power:
+
+First, an example of a computation that takes 5 seconds in `Cp` and is instant in `Cp_Coxeter3`:
+
+```python
+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+
+Secondly, a computation in `H4` that seems infeasible in the existing `Cp` implementation (that is, it did not terminate in any reasonable time):
+
+```python
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+
+The main content of this ticket is the addition of the `Cp_Coxeter3` basis to `iwahori_hecke_algebra.py`.
+We also implement conversions to and from the other existing bases.
+As an application, we have included a method to compute Kazhdan-Lusztig left, right, and two-sided cells of Coxeter group elements, that uses the `Cp_Coxeter3` basis to compute products.
+Its usage is as follows:
+
+```
+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3
+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3
+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3
+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}
+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3
+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}
+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3
+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='both')               # optional - coxeter3
+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],
+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}
+```
 
 Author: Chase Meadors, Tianyuan Xu
 
``````




---

archive/issue_comments_489617.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,80 @@\n+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, viewing the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, I can rebase or reorganize branches in the appropriate way as directed by a reviewer.\n \n+\n+This ticket introduces a feature to perform complex and highly non-trivial calculations in the Kazhdan-Lusztig C' basis of an Iwahori-Hecke algebra.\n+\n+The existing implementation of the C' basis (`IwahoriHeckeAlgebra.Cp`) works by converting elements to the T-basis, performing multiplication there, and converting back.\n+This ticket introduces a new basis, `IwahoriHeckeAlgebra.Cp_Coxeter3`, that provides an alternative implementation of the C' basis that relies on the package coxeter3 for its computations (specifically, computation of \"mu-coefficients\" is delegated to coxeter3).\n+It uses an algorithm to compute products of basis elements directly in the C' basis (without conversion), and is able to achieve computations that seem infeasable or prohibitively long in the existing `Cp` basis.\n+A description of the ideas and algorithm can be found in the class documentation for `IwahoriHeckeAlgebra.Cp_Coxeter3`; the main content of the algorithm occurs in `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. \n+\n+To use the `Cp_Coxeter3` basis, the `IwahoriHeckeAlgebra` must be created with a `coxeter3`-implemented Coxeter group.\n+As `IwahoriHeckeAlgebra.Cp_Coxeter3` is an alternative implementation of the C' basis, it has identical usage to the existing implementation `IwahoriHeckeAlgebra.Cp`.\n+See the `Cp_Coxeter3` class documentation a thorough introduction to the implementation; we include here two examples from the class documentation that demonstrate the improvement in computational power:\n+\n+First, an example of a computation that takes 5 seconds in `Cp` and is instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+\n+Secondly, a computation in `H4` that seems infeasible in the existing `Cp` implementation (that is, it did not terminate in any reasonable time):\n+\n+```python\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+\n+The main content of this ticket is the addition of the `Cp_Coxeter3` basis to `iwahori_hecke_algebra.py`.\n+We also implement conversions to and from the other existing bases.\n+As an application, we have included a method to compute Kazhdan-Lusztig left, right, and two-sided cells of Coxeter group elements, that uses the `Cp_Coxeter3` basis to compute products.\n+Its usage is as follows:\n+\n+```\n+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3\n+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3\n+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3\n+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}\n+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3\n+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}\n+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3\n+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='both')               # optional - coxeter3\n+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],\n+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+```\n \n Author: Chase Meadors, Tianyuan Xu\n \n``````\n",
    "created_at": "2021-08-09T23:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489617",
    "user": "https://github.com/cemulate"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,80 @@
+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, viewing the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, I can rebase or reorganize branches in the appropriate way as directed by a reviewer.
 
+
+This ticket introduces a feature to perform complex and highly non-trivial calculations in the Kazhdan-Lusztig C' basis of an Iwahori-Hecke algebra.
+
+The existing implementation of the C' basis (`IwahoriHeckeAlgebra.Cp`) works by converting elements to the T-basis, performing multiplication there, and converting back.
+This ticket introduces a new basis, `IwahoriHeckeAlgebra.Cp_Coxeter3`, that provides an alternative implementation of the C' basis that relies on the package coxeter3 for its computations (specifically, computation of "mu-coefficients" is delegated to coxeter3).
+It uses an algorithm to compute products of basis elements directly in the C' basis (without conversion), and is able to achieve computations that seem infeasable or prohibitively long in the existing `Cp` basis.
+A description of the ideas and algorithm can be found in the class documentation for `IwahoriHeckeAlgebra.Cp_Coxeter3`; the main content of the algorithm occurs in `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. 
+
+To use the `Cp_Coxeter3` basis, the `IwahoriHeckeAlgebra` must be created with a `coxeter3`-implemented Coxeter group.
+As `IwahoriHeckeAlgebra.Cp_Coxeter3` is an alternative implementation of the C' basis, it has identical usage to the existing implementation `IwahoriHeckeAlgebra.Cp`.
+See the `Cp_Coxeter3` class documentation a thorough introduction to the implementation; we include here two examples from the class documentation that demonstrate the improvement in computational power:
+
+First, an example of a computation that takes 5 seconds in `Cp` and is instant in `Cp_Coxeter3`:
+
+```python
+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+
+Secondly, a computation in `H4` that seems infeasible in the existing `Cp` implementation (that is, it did not terminate in any reasonable time):
+
+```python
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+
+The main content of this ticket is the addition of the `Cp_Coxeter3` basis to `iwahori_hecke_algebra.py`.
+We also implement conversions to and from the other existing bases.
+As an application, we have included a method to compute Kazhdan-Lusztig left, right, and two-sided cells of Coxeter group elements, that uses the `Cp_Coxeter3` basis to compute products.
+Its usage is as follows:
+
+```
+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3
+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3
+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3
+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}
+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3
+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}
+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3
+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='both')               # optional - coxeter3
+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],
+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}
+```
 
 Author: Chase Meadors, Tianyuan Xu
 
``````




---

archive/issue_comments_489618.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,69 @@\n+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.\n \n+\n+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+\n+The next example seems infeasible in the existing `Cp` implementation (it did not terminate in any reasonable time) but is again instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+ \n+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples are given in the documentation for this function and the class. The class also handles conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way. \n+\n+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in ``. A typical example is given below. \n+\n+\n+```\n+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3\n+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3\n+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3\n+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}\n+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3\n+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}\n+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3\n+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='both')               # optional - coxeter3\n+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],\n+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+```\n \n Author: Chase Meadors, Tianyuan Xu\n \n``````\n",
    "created_at": "2021-08-10T00:38:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489618",
    "user": "https://github.com/TianyuanX"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,69 @@
+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.
 
+
+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:
+
+```python
+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+
+The next example seems infeasible in the existing `Cp` implementation (it did not terminate in any reasonable time) but is again instant in `Cp_Coxeter3`:
+
+```python
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+ 
+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples are given in the documentation for this function and the class. The class also handles conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way. 
+
+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in ``. A typical example is given below. 
+
+
+```
+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3
+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3
+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3
+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}
+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3
+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}
+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3
+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='both')               # optional - coxeter3
+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],
+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}
+```
 
 Author: Chase Meadors, Tianyuan Xu
 
``````




---

archive/issue_comments_489619.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,69 @@\n+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.\n \n+\n+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. The new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the direct method is able to compute products in the C'-basis more quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+\n+The next example seems infeasible in the existing `Cp` implementation (it did not terminate in any reasonable time) but is again instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+ \n+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanation of the relevant algorithms and detailed examples are given in the documentation for this function and the class. The class also handles conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same basis in a trivial way. \n+\n+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in ``. A typical example is given below. \n+\n+\n+```\n+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3\n+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3\n+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3\n+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}\n+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3\n+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}\n+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3\n+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='both')               # optional - coxeter3\n+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],\n+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+```\n \n Author: Chase Meadors, Tianyuan Xu\n \n``````\n",
    "created_at": "2021-08-10T00:41:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489619",
    "user": "https://github.com/TianyuanX"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,69 @@
+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.
 
+
+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. The new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the direct method is able to compute products in the C'-basis more quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:
+
+```python
+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+
+The next example seems infeasible in the existing `Cp` implementation (it did not terminate in any reasonable time) but is again instant in `Cp_Coxeter3`:
+
+```python
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+ 
+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanation of the relevant algorithms and detailed examples are given in the documentation for this function and the class. The class also handles conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same basis in a trivial way. 
+
+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in ``. A typical example is given below. 
+
+
+```
+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3
+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3
+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3
+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}
+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3
+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}
+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3
+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='both')               # optional - coxeter3
+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],
+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}
+```
 
 Author: Chase Meadors, Tianyuan Xu
 
``````




---

archive/issue_comments_489620.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,69 @@\n+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.\n \n+\n+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. The new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the direct method is able to compute products in the C'-basis more quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+\n+The next example seems infeasible in the existing `Cp` implementation (it did not terminate in any reasonable time) but is again instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+ \n+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanation of the relevant algorithms and detailed examples are given in the documentation for this function and the class. The class also handles conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same basis in a trivial way. \n+\n+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in ``. A typical example is given below. \n+\n+\n+```python\n+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3\n+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3\n+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3\n+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}\n+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3\n+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}\n+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3\n+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='both')               # optional - coxeter3\n+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],\n+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+```\n \n Author: Chase Meadors, Tianyuan Xu\n \n``````\n",
    "created_at": "2021-08-10T00:43:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489620",
    "user": "https://github.com/TianyuanX"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,69 @@
+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.
 
+
+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. The new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the direct method is able to compute products in the C'-basis more quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:
+
+```python
+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+
+The next example seems infeasible in the existing `Cp` implementation (it did not terminate in any reasonable time) but is again instant in `Cp_Coxeter3`:
+
+```python
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+ 
+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanation of the relevant algorithms and detailed examples are given in the documentation for this function and the class. The class also handles conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same basis in a trivial way. 
+
+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in ``. A typical example is given below. 
+
+
+```python
+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3
+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3
+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3
+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}
+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3
+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}
+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3
+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='both')               # optional - coxeter3
+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],
+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}
+```
 
 Author: Chase Meadors, Tianyuan Xu
 
``````




---

archive/issue_comments_489621.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,83 @@\n+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.\n \n+\n+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+\n+The next examples in type `B_9` seem infeasible in the existing `Cp` implementation (it did not terminate in any reasonable time) but is again instant in `Cp_Coxeter3` (here, we work with a relabled type `B_9` where the strong bond is between generators 1 and 2):\n+\n+```python\n+sage: B9 = CoxeterType(['B', 9])\n+sage: B9 = B9.relabel({ i: 9-i+1 for i in range(1, 10) })    # optional - coxeter3\n+sage: W = CoxeterGroup(B9, implementation='coxeter3')        # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v, -1/v)                    # optional - coxeter3\n+sage: CpC, Cp = H.Cp_Coxeter3(), H.Cp()                      # optional - coxeter3\n+sage: s = W.simple_reflections()                             # optional - coxeter3\n+sage: Cp(s[1]*s[2]*s[1]*s[2])                                # optional - coxeter3\n+Cp[1,2,1,2]\n+sage: Cp[3,2,3,4,5] * Cp[2,3]                                # optional - coxeter3\n+(v^-1+v)*Cp[2,3,2,4,3,5] + (v^-1+v)*Cp[2,3,2,5]\n+sage: CpC[3,2,3,4,5] * CpC[2,3]                              # optional - coxeter3\n+(v^-1+v)*CpC[2,3,2,4,3,5] + (v^-1+v)*CpC[2,3,2,5]\n+sage: CpC[9,5,6,7,8,9,2,3,4,5,6,7,8,9] * CpC[9,8,7,6]        # optional - coxeter3\n+(v^-3+3*v^-1+3*v+v^3)*CpC[2,3,4,5,4,6,5,7,6,8,7,9,8,7,6]\n+sage: CpC[1,5,4,3,2,1,8,7,6,5,4,3,2,1] * CpC[1,2,3,4]        # long time (4 seconds) # optional - coxeter3\n+(v^-1+v)*CpC[1,5,4,3,2,1,8,7,6,5,4,3,2,1,2,3,4]\n++ (v^-1+v)*CpC[1,2,1,5,4,3,2,1,2,3,8,7,6,5,4]\n++ (v^-1+v)*CpC[1,3,2,1,5,4,3,2,1,2,3,4,8,7,6]\n++ (v^-1+v)*CpC[1,4,3,2,1,5,4,3,2,1,2,3,4,8,7]\n++ (v^-1+v)*CpC[1,5,4,3,2,1,2,3,8,7,6,5,4,3,2]\n++ (v^-1+v)*CpC[1,2,5,4,3,2,1,8,7,6,5,4,3]\n++ (v^-1+v)*CpC[1,2,5,4,3,2,8,7,6,5,4,3,2]\n++ (v^-1+v)*CpC[1,2,3,2,5,4,3,2,8,7,6]\n++ (v^-1+v)*CpC[1,2,4,3,2,5,4,3,2,8,7]\n++ (v^-1+v)*CpC[1,2,5,4,3,2,8,7,6,5,4]\n++ (v^-1+v)*CpC[1,5,4,3,2,1,8,7,6,5,4]\n++ (v^-1+v)*CpC[1,5,4,3,8,7,6,5,4,3,2]\n++ (v^-1+v)*CpC[1,3,5,4,3,2,8,7,6]\n++ (v^-1+v)*CpC[1,4,3,5,4,3,2,8,7]\n+```\n+ \n+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples are given in the documentation for this function and the class. The class also handles conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way. \n+\n+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in `sage/libs/coxeter3/coxeter_group.py`. A typical example is given below:\n+\n+\n+```python\n+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3\n+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3\n+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3\n+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}\n+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3\n+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}\n+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3\n+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='both')               # optional - coxeter3\n+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],\n+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+```\n \n Author: Chase Meadors, Tianyuan Xu\n \n``````\n",
    "created_at": "2021-08-10T00:45:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489621",
    "user": "https://github.com/cemulate"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,83 @@
+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.
 
+
+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:
+
+```python
+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+
+The next examples in type `B_9` seem infeasible in the existing `Cp` implementation (it did not terminate in any reasonable time) but is again instant in `Cp_Coxeter3` (here, we work with a relabled type `B_9` where the strong bond is between generators 1 and 2):
+
+```python
+sage: B9 = CoxeterType(['B', 9])
+sage: B9 = B9.relabel({ i: 9-i+1 for i in range(1, 10) })    # optional - coxeter3
+sage: W = CoxeterGroup(B9, implementation='coxeter3')        # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v, -1/v)                    # optional - coxeter3
+sage: CpC, Cp = H.Cp_Coxeter3(), H.Cp()                      # optional - coxeter3
+sage: s = W.simple_reflections()                             # optional - coxeter3
+sage: Cp(s[1]*s[2]*s[1]*s[2])                                # optional - coxeter3
+Cp[1,2,1,2]
+sage: Cp[3,2,3,4,5] * Cp[2,3]                                # optional - coxeter3
+(v^-1+v)*Cp[2,3,2,4,3,5] + (v^-1+v)*Cp[2,3,2,5]
+sage: CpC[3,2,3,4,5] * CpC[2,3]                              # optional - coxeter3
+(v^-1+v)*CpC[2,3,2,4,3,5] + (v^-1+v)*CpC[2,3,2,5]
+sage: CpC[9,5,6,7,8,9,2,3,4,5,6,7,8,9] * CpC[9,8,7,6]        # optional - coxeter3
+(v^-3+3*v^-1+3*v+v^3)*CpC[2,3,4,5,4,6,5,7,6,8,7,9,8,7,6]
+sage: CpC[1,5,4,3,2,1,8,7,6,5,4,3,2,1] * CpC[1,2,3,4]        # long time (4 seconds) # optional - coxeter3
+(v^-1+v)*CpC[1,5,4,3,2,1,8,7,6,5,4,3,2,1,2,3,4]
++ (v^-1+v)*CpC[1,2,1,5,4,3,2,1,2,3,8,7,6,5,4]
++ (v^-1+v)*CpC[1,3,2,1,5,4,3,2,1,2,3,4,8,7,6]
++ (v^-1+v)*CpC[1,4,3,2,1,5,4,3,2,1,2,3,4,8,7]
++ (v^-1+v)*CpC[1,5,4,3,2,1,2,3,8,7,6,5,4,3,2]
++ (v^-1+v)*CpC[1,2,5,4,3,2,1,8,7,6,5,4,3]
++ (v^-1+v)*CpC[1,2,5,4,3,2,8,7,6,5,4,3,2]
++ (v^-1+v)*CpC[1,2,3,2,5,4,3,2,8,7,6]
++ (v^-1+v)*CpC[1,2,4,3,2,5,4,3,2,8,7]
++ (v^-1+v)*CpC[1,2,5,4,3,2,8,7,6,5,4]
++ (v^-1+v)*CpC[1,5,4,3,2,1,8,7,6,5,4]
++ (v^-1+v)*CpC[1,5,4,3,8,7,6,5,4,3,2]
++ (v^-1+v)*CpC[1,3,5,4,3,2,8,7,6]
++ (v^-1+v)*CpC[1,4,3,5,4,3,2,8,7]
+```
+ 
+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples are given in the documentation for this function and the class. The class also handles conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way. 
+
+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in `sage/libs/coxeter3/coxeter_group.py`. A typical example is given below:
+
+
+```python
+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3
+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3
+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3
+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}
+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3
+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}
+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3
+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='both')               # optional - coxeter3
+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],
+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}
+```
 
 Author: Chase Meadors, Tianyuan Xu
 
``````




---

archive/issue_comments_489622.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,83 @@\n+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.\n \n+\n+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+\n+The final two computations in this example seem infeasible in the existing `Cp` implementation (it did not terminate in any reasonable time) but is again instant or quite quick in `Cp_Coxeter3` (here, we work with a relabled type `B_9` where the strong bond is between generators 1 and 2):\n+\n+```python\n+sage: B9 = CoxeterType(['B', 9])\n+sage: B9 = B9.relabel({ i: 9-i+1 for i in range(1, 10) })    # optional - coxeter3\n+sage: W = CoxeterGroup(B9, implementation='coxeter3')        # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v, -1/v)                    # optional - coxeter3\n+sage: CpC, Cp = H.Cp_Coxeter3(), H.Cp()                      # optional - coxeter3\n+sage: s = W.simple_reflections()                             # optional - coxeter3\n+sage: Cp(s[1]*s[2]*s[1]*s[2])                                # optional - coxeter3\n+Cp[1,2,1,2]\n+sage: Cp[3,2,3,4,5] * Cp[2,3]                                # optional - coxeter3\n+(v^-1+v)*Cp[2,3,2,4,3,5] + (v^-1+v)*Cp[2,3,2,5]\n+sage: CpC[3,2,3,4,5] * CpC[2,3]                              # optional - coxeter3\n+(v^-1+v)*CpC[2,3,2,4,3,5] + (v^-1+v)*CpC[2,3,2,5]\n+sage: CpC[9,5,6,7,8,9,2,3,4,5,6,7,8,9] * CpC[9,8,7,6]        # optional - coxeter3\n+(v^-3+3*v^-1+3*v+v^3)*CpC[2,3,4,5,4,6,5,7,6,8,7,9,8,7,6]\n+sage: CpC[1,5,4,3,2,1,8,7,6,5,4,3,2,1] * CpC[1,2,3,4]        # long time (4 seconds) # optional - coxeter3\n+(v^-1+v)*CpC[1,5,4,3,2,1,8,7,6,5,4,3,2,1,2,3,4]\n++ (v^-1+v)*CpC[1,2,1,5,4,3,2,1,2,3,8,7,6,5,4]\n++ (v^-1+v)*CpC[1,3,2,1,5,4,3,2,1,2,3,4,8,7,6]\n++ (v^-1+v)*CpC[1,4,3,2,1,5,4,3,2,1,2,3,4,8,7]\n++ (v^-1+v)*CpC[1,5,4,3,2,1,2,3,8,7,6,5,4,3,2]\n++ (v^-1+v)*CpC[1,2,5,4,3,2,1,8,7,6,5,4,3]\n++ (v^-1+v)*CpC[1,2,5,4,3,2,8,7,6,5,4,3,2]\n++ (v^-1+v)*CpC[1,2,3,2,5,4,3,2,8,7,6]\n++ (v^-1+v)*CpC[1,2,4,3,2,5,4,3,2,8,7]\n++ (v^-1+v)*CpC[1,2,5,4,3,2,8,7,6,5,4]\n++ (v^-1+v)*CpC[1,5,4,3,2,1,8,7,6,5,4]\n++ (v^-1+v)*CpC[1,5,4,3,8,7,6,5,4,3,2]\n++ (v^-1+v)*CpC[1,3,5,4,3,2,8,7,6]\n++ (v^-1+v)*CpC[1,4,3,5,4,3,2,8,7]\n+```\n+ \n+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples are given in the documentation for this function and the class. The class also handles conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way. \n+\n+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in `sage/libs/coxeter3/coxeter_group.py`. A typical example is given below:\n+\n+\n+```python\n+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3\n+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3\n+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3\n+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}\n+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3\n+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}\n+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3\n+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='both')               # optional - coxeter3\n+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],\n+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+```\n \n Author: Chase Meadors, Tianyuan Xu\n \n``````\n",
    "created_at": "2021-08-10T00:47:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489622",
    "user": "https://github.com/cemulate"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,83 @@
+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.
 
+
+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:
+
+```python
+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+
+The final two computations in this example seem infeasible in the existing `Cp` implementation (it did not terminate in any reasonable time) but is again instant or quite quick in `Cp_Coxeter3` (here, we work with a relabled type `B_9` where the strong bond is between generators 1 and 2):
+
+```python
+sage: B9 = CoxeterType(['B', 9])
+sage: B9 = B9.relabel({ i: 9-i+1 for i in range(1, 10) })    # optional - coxeter3
+sage: W = CoxeterGroup(B9, implementation='coxeter3')        # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v, -1/v)                    # optional - coxeter3
+sage: CpC, Cp = H.Cp_Coxeter3(), H.Cp()                      # optional - coxeter3
+sage: s = W.simple_reflections()                             # optional - coxeter3
+sage: Cp(s[1]*s[2]*s[1]*s[2])                                # optional - coxeter3
+Cp[1,2,1,2]
+sage: Cp[3,2,3,4,5] * Cp[2,3]                                # optional - coxeter3
+(v^-1+v)*Cp[2,3,2,4,3,5] + (v^-1+v)*Cp[2,3,2,5]
+sage: CpC[3,2,3,4,5] * CpC[2,3]                              # optional - coxeter3
+(v^-1+v)*CpC[2,3,2,4,3,5] + (v^-1+v)*CpC[2,3,2,5]
+sage: CpC[9,5,6,7,8,9,2,3,4,5,6,7,8,9] * CpC[9,8,7,6]        # optional - coxeter3
+(v^-3+3*v^-1+3*v+v^3)*CpC[2,3,4,5,4,6,5,7,6,8,7,9,8,7,6]
+sage: CpC[1,5,4,3,2,1,8,7,6,5,4,3,2,1] * CpC[1,2,3,4]        # long time (4 seconds) # optional - coxeter3
+(v^-1+v)*CpC[1,5,4,3,2,1,8,7,6,5,4,3,2,1,2,3,4]
++ (v^-1+v)*CpC[1,2,1,5,4,3,2,1,2,3,8,7,6,5,4]
++ (v^-1+v)*CpC[1,3,2,1,5,4,3,2,1,2,3,4,8,7,6]
++ (v^-1+v)*CpC[1,4,3,2,1,5,4,3,2,1,2,3,4,8,7]
++ (v^-1+v)*CpC[1,5,4,3,2,1,2,3,8,7,6,5,4,3,2]
++ (v^-1+v)*CpC[1,2,5,4,3,2,1,8,7,6,5,4,3]
++ (v^-1+v)*CpC[1,2,5,4,3,2,8,7,6,5,4,3,2]
++ (v^-1+v)*CpC[1,2,3,2,5,4,3,2,8,7,6]
++ (v^-1+v)*CpC[1,2,4,3,2,5,4,3,2,8,7]
++ (v^-1+v)*CpC[1,2,5,4,3,2,8,7,6,5,4]
++ (v^-1+v)*CpC[1,5,4,3,2,1,8,7,6,5,4]
++ (v^-1+v)*CpC[1,5,4,3,8,7,6,5,4,3,2]
++ (v^-1+v)*CpC[1,3,5,4,3,2,8,7,6]
++ (v^-1+v)*CpC[1,4,3,5,4,3,2,8,7]
+```
+ 
+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples are given in the documentation for this function and the class. The class also handles conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way. 
+
+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in `sage/libs/coxeter3/coxeter_group.py`. A typical example is given below:
+
+
+```python
+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3
+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3
+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3
+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}
+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3
+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}
+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3
+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='both')               # optional - coxeter3
+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],
+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}
+```
 
 Author: Chase Meadors, Tianyuan Xu
 
``````




---

archive/issue_comments_489623.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-10T01:18:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489623",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_489624.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,61 @@\n+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.\n \n+\n+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+\n+The following is an example of a computation that seems infeasible in the existing `Cp` basis (it did not terminate in any reasonable time), but is instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: W = CoxeterGroup('A9', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: CpC = H.Cp_Coxeter3()                                 # optional - coxeter3\n+sage: CpC[1,2,1,8,9,8]*CpC[1,2,3,7,8,9]                     # optional - coxeter3\n+(v^-2+2+v^2)*CpC[1,2,1,3,7,8,7,9,8,7]\n++ (v^-2+2+v^2)*CpC[1,2,1,3,8,9,8,7]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[1,2,1,3,8,9,8]\n+```\n+ \n+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples (including more previously-infeasible computations) are given in the documentation for this function and the class. We also handle conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way.\n+\n+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in `sage/libs/coxeter3/coxeter_group.py`. A typical example is given below:\n+\n+\n+```python\n+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3\n+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3\n+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3\n+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}\n+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3\n+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}\n+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3\n+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='two-sided')          # optional - coxeter3\n+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],\n+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+```\n \n Author: Chase Meadors, Tianyuan Xu\n \n``````\n",
    "created_at": "2021-08-10T01:35:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489624",
    "user": "https://github.com/cemulate"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,61 @@
+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.
 
+
+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:
+
+```python
+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+
+The following is an example of a computation that seems infeasible in the existing `Cp` basis (it did not terminate in any reasonable time), but is instant in `Cp_Coxeter3`:
+
+```python
+sage: W = CoxeterGroup('A9', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: CpC = H.Cp_Coxeter3()                                 # optional - coxeter3
+sage: CpC[1,2,1,8,9,8]*CpC[1,2,3,7,8,9]                     # optional - coxeter3
+(v^-2+2+v^2)*CpC[1,2,1,3,7,8,7,9,8,7]
++ (v^-2+2+v^2)*CpC[1,2,1,3,8,9,8,7]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[1,2,1,3,8,9,8]
+```
+ 
+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples (including more previously-infeasible computations) are given in the documentation for this function and the class. We also handle conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way.
+
+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in `sage/libs/coxeter3/coxeter_group.py`. A typical example is given below:
+
+
+```python
+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3
+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3
+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3
+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}
+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3
+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}
+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3
+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='two-sided')          # optional - coxeter3
+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],
+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}
+```
 
 Author: Chase Meadors, Tianyuan Xu
 
``````




---

archive/issue_comments_489625.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-10T01:35:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489625",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_489626.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,61 @@\n+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.\n \n+\n+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis more quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+\n+The following computation also seems infeasible in the existing `Cp` basis (it did not terminate in any reasonable time), but it is again instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: W = CoxeterGroup('A9', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: CpC = H.Cp_Coxeter3()                                 # optional - coxeter3\n+sage: CpC[1,2,1,8,9,8]*CpC[1,2,3,7,8,9]                     # optional - coxeter3\n+(v^-2+2+v^2)*CpC[1,2,1,3,7,8,7,9,8,7]\n++ (v^-2+2+v^2)*CpC[1,2,1,3,8,9,8,7]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[1,2,1,3,8,9,8]\n+```\n+ \n+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples (including more previously-infeasible computations) are given in the documentation for this function and the class. We also handle conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way.\n+\n+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in `sage/libs/coxeter3/coxeter_group.py`. A typical example is given below:\n+\n+\n+```python\n+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3\n+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3\n+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3\n+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}\n+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3\n+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}\n+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3\n+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3\n+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='two-sided')          # optional - coxeter3\n+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],\n+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+```\n \n Author: Chase Meadors, Tianyuan Xu\n \n``````\n",
    "created_at": "2021-08-11T21:37:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489626",
    "user": "https://github.com/TianyuanX"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,61 @@
+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.
 
+
+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis more quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:
+
+```python
+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+
+The following computation also seems infeasible in the existing `Cp` basis (it did not terminate in any reasonable time), but it is again instant in `Cp_Coxeter3`:
+
+```python
+sage: W = CoxeterGroup('A9', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: CpC = H.Cp_Coxeter3()                                 # optional - coxeter3
+sage: CpC[1,2,1,8,9,8]*CpC[1,2,3,7,8,9]                     # optional - coxeter3
+(v^-2+2+v^2)*CpC[1,2,1,3,7,8,7,9,8,7]
++ (v^-2+2+v^2)*CpC[1,2,1,3,8,9,8,7]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[1,2,1,3,8,9,8]
+```
+ 
+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples (including more previously-infeasible computations) are given in the documentation for this function and the class. We also handle conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way.
+
+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in `sage/libs/coxeter3/coxeter_group.py`. A typical example is given below:
+
+
+```python
+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3
+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3
+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3
+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}
+sage: W.kazhdan_lusztig_cell(s2*s3*s2)                      # optional - coxeter3
+{[1, 2], [1, 2, 3, 2], [2], [2, 3, 2], [3, 2]}
+sage: W.kazhdan_lusztig_cell(s1*s2*s3)                      # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3)                            # optional - coxeter3
+{[1, 2, 3], [2, 3], [3], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3
+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='two-sided')          # optional - coxeter3
+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],
+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}
+```
 
 Author: Chase Meadors, Tianyuan Xu
 
``````




---

archive/issue_comments_489627.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,55 @@\n+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.\n \n+\n+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis more quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+\n+The following computation also seems infeasible in the existing `Cp` basis (it did not terminate in any reasonable time), but it is again instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: W = CoxeterGroup('A9', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: CpC = H.Cp_Coxeter3()                                 # optional - coxeter3\n+sage: CpC[1,2,1,8,9,8]*CpC[1,2,3,7,8,9]                     # optional - coxeter3\n+(v^-2+2+v^2)*CpC[1,2,1,3,7,8,7,9,8,7]\n++ (v^-2+2+v^2)*CpC[1,2,1,3,8,9,8,7]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[1,2,1,3,8,9,8]\n+```\n+ \n+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples (including more previously-infeasible computations) are given in the documentation for this function and the class. We also handle conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way.\n+\n+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in `sage/libs/coxeter3/coxeter_group.py`. A typical example is given below:\n+\n+\n+```python\n+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3\n+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3\n+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3\n+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}\n+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3\n+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='two-sided')          # optional - coxeter3\n+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],\n+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+```\n \n Author: Chase Meadors, Tianyuan Xu\n \n``````\n",
    "created_at": "2021-08-11T21:43:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489627",
    "user": "https://github.com/TianyuanX"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,55 @@
+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.
 
+
+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis more quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:
+
+```python
+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+
+The following computation also seems infeasible in the existing `Cp` basis (it did not terminate in any reasonable time), but it is again instant in `Cp_Coxeter3`:
+
+```python
+sage: W = CoxeterGroup('A9', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: CpC = H.Cp_Coxeter3()                                 # optional - coxeter3
+sage: CpC[1,2,1,8,9,8]*CpC[1,2,3,7,8,9]                     # optional - coxeter3
+(v^-2+2+v^2)*CpC[1,2,1,3,7,8,7,9,8,7]
++ (v^-2+2+v^2)*CpC[1,2,1,3,8,9,8,7]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[1,2,1,3,8,9,8]
+```
+ 
+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples (including more previously-infeasible computations) are given in the documentation for this function and the class. We also handle conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way.
+
+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in `sage/libs/coxeter3/coxeter_group.py`. A typical example is given below:
+
+
+```python
+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3
+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3
+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3
+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}
+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3
+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='two-sided')          # optional - coxeter3
+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],
+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}
+```
 
 Author: Chase Meadors, Tianyuan Xu
 
``````




---

archive/issue_comments_489628.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,55 @@\n+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.\n \n+\n+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis more quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+\n+The following computation also seems infeasible in the existing `Cp` basis (it did not terminate in any reasonable time), but it is again instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: W = CoxeterGroup('A9', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: CpC = H.Cp_Coxeter3()                                 # optional - coxeter3\n+sage: CpC[1,2,1,8,9,8]*CpC[1,2,3,7,8,9]                     # optional - coxeter3\n+(v^-2+2+v^2)*CpC[1,2,1,3,7,8,7,9,8,7]\n++ (v^-2+2+v^2)*CpC[1,2,1,3,8,9,8,7]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[1,2,1,3,8,9,8]\n+```\n+ \n+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples (including more previously-infeasible computations) are given in the documentation for this function and the class. We also handle conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way.\n+\n+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in `sage/libs/coxeter3/coxeter_group.py`. Some example computations are given below.\n+\n+\n+```python\n+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3\n+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3\n+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3\n+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}\n+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3\n+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='two-sided')          # optional - coxeter3\n+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],\n+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+```\n \n Author: Chase Meadors, Tianyuan Xu\n \n``````\n",
    "created_at": "2021-08-11T22:03:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489628",
    "user": "https://github.com/TianyuanX"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,55 @@
+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.
 
+
+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis more quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:
+
+```python
+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+
+The following computation also seems infeasible in the existing `Cp` basis (it did not terminate in any reasonable time), but it is again instant in `Cp_Coxeter3`:
+
+```python
+sage: W = CoxeterGroup('A9', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: CpC = H.Cp_Coxeter3()                                 # optional - coxeter3
+sage: CpC[1,2,1,8,9,8]*CpC[1,2,3,7,8,9]                     # optional - coxeter3
+(v^-2+2+v^2)*CpC[1,2,1,3,7,8,7,9,8,7]
++ (v^-2+2+v^2)*CpC[1,2,1,3,8,9,8,7]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[1,2,1,3,8,9,8]
+```
+ 
+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples (including more previously-infeasible computations) are given in the documentation for this function and the class. We also handle conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way.
+
+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in `sage/libs/coxeter3/coxeter_group.py`. Some example computations are given below.
+
+
+```python
+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3
+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3
+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3
+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}
+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3
+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='two-sided')          # optional - coxeter3
+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],
+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}
+```
 
 Author: Chase Meadors, Tianyuan Xu
 
``````




---

archive/issue_comments_489629.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,55 @@\n+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.\n \n+\n+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis more quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+\n+The following computation also seems infeasible in the existing `Cp` basis (it did not terminate in any reasonable time), but it is again instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: W = CoxeterGroup('A9', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: CpC = H.Cp_Coxeter3()                                 # optional - coxeter3\n+sage: CpC[1,2,1,8,9,8]*CpC[1,2,3,7,8,9]                     # optional - coxeter3\n+(v^-2+2+v^2)*CpC[1,2,1,3,7,8,7,9,8,7]\n++ (v^-2+2+v^2)*CpC[1,2,1,3,8,9,8,7]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[1,2,1,3,8,9,8]\n+```\n+ \n+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples (including more previously infeasible computations) are given in the documentation for this function and the class. We also handle conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way.\n+\n+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in `sage/libs/coxeter3/coxeter_group.py`. Some example computations are given below.\n+\n+\n+```python\n+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3\n+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3\n+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3\n+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}\n+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3\n+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='two-sided')          # optional - coxeter3\n+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],\n+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+```\n \n Author: Chase Meadors, Tianyuan Xu\n \n``````\n",
    "created_at": "2021-08-11T22:04:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489629",
    "user": "https://github.com/TianyuanX"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,55 @@
+> **(technical note)** the branch associated with this ticket is based off of the branch associated to its dependency, #32266 (a bug fix). As such, the change-set of this branch includes the changes in that ticket. If this is not the usual way to handle ticket dependencies, or if that ticket should be merged first, please let us know so that we can rebase or reorganize branches in the appropriate way as directed.
 
+
+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis more quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:
+
+```python
+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+
+The following computation also seems infeasible in the existing `Cp` basis (it did not terminate in any reasonable time), but it is again instant in `Cp_Coxeter3`:
+
+```python
+sage: W = CoxeterGroup('A9', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: CpC = H.Cp_Coxeter3()                                 # optional - coxeter3
+sage: CpC[1,2,1,8,9,8]*CpC[1,2,3,7,8,9]                     # optional - coxeter3
+(v^-2+2+v^2)*CpC[1,2,1,3,7,8,7,9,8,7]
++ (v^-2+2+v^2)*CpC[1,2,1,3,8,9,8,7]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[1,2,1,3,8,9,8]
+```
+ 
+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples (including more previously infeasible computations) are given in the documentation for this function and the class. We also handle conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way.
+
+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to detemine all cells in any finite Coxeter group. We have included a function for calculating the cells containing a given element in `sage/libs/coxeter3/coxeter_group.py`. Some example computations are given below.
+
+
+```python
+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3
+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3
+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3
+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}
+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3
+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='two-sided')          # optional - coxeter3
+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],
+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}
+```
 
 Author: Chase Meadors, Tianyuan Xu
 
``````




---

archive/issue_events_085836.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-11T22:19:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32352#event-85836"
}
```



---

archive/issue_comments_489630.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-11T23:44:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489630",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_489631.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-12T00:45:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489631",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_489632.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-12T17:25:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489632",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_489633.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-08-12T17:26:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489633",
    "user": "https://github.com/cemulate"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_489634.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2021-08-14T23:49:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489634",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_489635.json:
```json
{
    "body": "<a id='comment:26'></a>I made some changes to improve the speed by creating fewer transient objects and using more efficient code paths. I also tweaked the doctests so that everything is tested on systems without coxeter3 and all tests pass both with and without coxeter3. I also tweaked the documentation accordingly and hid the internal computational methods. If my changes are good, then positive review.",
    "created_at": "2021-08-16T01:49:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489635",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:26'></a>I made some changes to improve the speed by creating fewer transient objects and using more efficient code paths. I also tweaked the doctests so that everything is tested on systems without coxeter3 and all tests pass both with and without coxeter3. I also tweaked the documentation accordingly and hid the internal computational methods. If my changes are good, then positive review.



---

archive/issue_comments_489636.json:
```json
{
    "body": "<a id='comment:27'></a>Last 10 new commits:",
    "created_at": "2021-08-16T01:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489636",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:27'></a>Last 10 new commits:



---

archive/issue_comments_489637.json:
```json
{
    "body": "<a id='comment:28'></a>Everything looks good! Thanks!\n\nWe've set the ticket to positive review.",
    "created_at": "2021-08-16T06:54:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489637",
    "user": "https://github.com/cemulate"
}
```

<a id='comment:28'></a>Everything looks good! Thanks!

We've set the ticket to positive review.



---

archive/issue_comments_489638.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-08-16T06:54:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489638",
    "user": "https://github.com/cemulate"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_489639.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,55 @@\n+> **(Update after review completed)** The `Cp_Coxeter3` class was eventually merged into the `Cp` class and the `Cp_Coxeter3.product_on_basis` method described below is eventually moved into the latter. \n \n+\n+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis more quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+\n+The following computation also seems infeasible in the existing `Cp` basis (it did not terminate in any reasonable time), but it is again instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: W = CoxeterGroup('A9', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: CpC = H.Cp_Coxeter3()                                 # optional - coxeter3\n+sage: CpC[1,2,1,8,9,8]*CpC[1,2,3,7,8,9]                     # optional - coxeter3\n+(v^-2+2+v^2)*CpC[1,2,1,3,7,8,7,9,8,7]\n++ (v^-2+2+v^2)*CpC[1,2,1,3,8,9,8,7]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[1,2,1,3,8,9,8]\n+```\n+ \n+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples (including more previously infeasible computations) are given in the documentation for this function and the class. We also handle conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way.\n+\n+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to determine all cells in any finite Coxeter group. We have included functions in `sage/categories/coxeter_groups.py` that can calculate the cells containing an element or compute all cells within a finite Coxeter group. Some example computations are given below.\n+\n+\n+```python\n+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3\n+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3\n+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3\n+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}\n+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3\n+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='two-sided')          # optional - coxeter3\n+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],\n+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+```\n \n Author: Chase Meadors, Tianyuan Xu\n \n``````\n",
    "created_at": "2021-08-16T20:06:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489639",
    "user": "https://github.com/TianyuanX"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,55 @@
+> **(Update after review completed)** The `Cp_Coxeter3` class was eventually merged into the `Cp` class and the `Cp_Coxeter3.product_on_basis` method described below is eventually moved into the latter. 
 
+
+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis more quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:
+
+```python
+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+
+The following computation also seems infeasible in the existing `Cp` basis (it did not terminate in any reasonable time), but it is again instant in `Cp_Coxeter3`:
+
+```python
+sage: W = CoxeterGroup('A9', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: CpC = H.Cp_Coxeter3()                                 # optional - coxeter3
+sage: CpC[1,2,1,8,9,8]*CpC[1,2,3,7,8,9]                     # optional - coxeter3
+(v^-2+2+v^2)*CpC[1,2,1,3,7,8,7,9,8,7]
++ (v^-2+2+v^2)*CpC[1,2,1,3,8,9,8,7]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[1,2,1,3,8,9,8]
+```
+ 
+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples (including more previously infeasible computations) are given in the documentation for this function and the class. We also handle conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way.
+
+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to determine all cells in any finite Coxeter group. We have included functions in `sage/categories/coxeter_groups.py` that can calculate the cells containing an element or compute all cells within a finite Coxeter group. Some example computations are given below.
+
+
+```python
+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3
+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3
+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3
+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}
+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3
+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='two-sided')          # optional - coxeter3
+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],
+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}
+```
 
 Author: Chase Meadors, Tianyuan Xu
 
``````




---

archive/issue_comments_489640.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,55 @@\n+> **(Update after review completed)** The `Cp_Coxeter3` class mentioned below was eventually merged into the `Cp` class, and the `Cp_Coxeter3.product_on_basis` method is moved into the latter. \n \n+\n+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis more quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3\n+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3\n+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3\n+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]\n++ (v^-1+v)*Cp[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]\n++ (v^-1+v)*Cp[3,4,1,2]\n+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3\n+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]\n++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]\n++ (v^-1+v)*CpC[3,4,1,2,3,4]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]\n++ (v^-1+v)*CpC[3,4,1,2]\n+```\n+\n+The following computation also seems infeasible in the existing `Cp` basis (it did not terminate in any reasonable time), but it is again instant in `Cp_Coxeter3`:\n+\n+```python\n+sage: W = CoxeterGroup('A9', implementation='coxeter3')     # optional - coxeter3\n+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3\n+sage: CpC = H.Cp_Coxeter3()                                 # optional - coxeter3\n+sage: CpC[1,2,1,8,9,8]*CpC[1,2,3,7,8,9]                     # optional - coxeter3\n+(v^-2+2+v^2)*CpC[1,2,1,3,7,8,7,9,8,7]\n++ (v^-2+2+v^2)*CpC[1,2,1,3,8,9,8,7]\n++ (v^-3+3*v^-1+3*v+v^3)*CpC[1,2,1,3,8,9,8]\n+```\n+ \n+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples (including more previously infeasible computations) are given in the documentation for this function and the class. We also handle conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way.\n+\n+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to determine all cells in any finite Coxeter group. We have included functions in `sage/categories/coxeter_groups.py` that can calculate the cells containing an element or compute all cells within a finite Coxeter group. Some example computations are given below.\n+\n+\n+```python\n+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3\n+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3\n+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3\n+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}\n+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3\n+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+sage: W.kazhdan_lusztig_cell(s3, side='two-sided')          # optional - coxeter3\n+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],\n+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}\n+```\n \n Author: Chase Meadors, Tianyuan Xu\n \n``````\n",
    "created_at": "2021-08-16T20:08:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489640",
    "user": "https://github.com/TianyuanX"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,55 @@
+> **(Update after review completed)** The `Cp_Coxeter3` class mentioned below was eventually merged into the `Cp` class, and the `Cp_Coxeter3.product_on_basis` method is moved into the latter. 
 
+
+This ticket introduces, in the class `IwahoriHeckeAlgebra.Cp_Coxeter3`, an alternative implementation of the Kazhdan--Lusztig C'-basis in an Iwahori--Hecke algebra. This new implementation is to be contrasted with the existing implementation of the same C'-basis via the class `IwahoriHeckeAlgebra.Cp`. The latter class computes products in the C'-basis indirectly by converting elements to the T-basis, performing multiplication there, and converting back, while the main feature of our new class is the direct computation of products in the C'-basis. By delegating some computations to the optional package coxeter3, the new class is able to compute products in the C'-basis more quickly, including some products that take prohibitively long in the existing `Cp` class. For example, the following calculation takes 5 seconds in `Cp` but is instant in `Cp_Coxeter3`:
+
+```python
+sage: R.<v> = LaurentPolynomialRing(ZZ)                     # optional - coxeter3
+sage: W = CoxeterGroup('H4', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: Cp = H.Cp(); CpC = H.Cp_Coxeter3()                    # optional - coxeter3
+sage: Cp[3,4,3]*Cp[3,4,3,4]*Cp[1,2,3,4]                     # long time (5 seconds) # optional - coxeter3
+(v^-2+2+v^2)*Cp[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*Cp[4,3,4,3,4,1,2]
++ (v^-1+v)*Cp[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*Cp[4,3,4,3,4,1]
++ (v^-1+v)*Cp[3,4,1,2]
+sage: CpC[3,4,3]*CpC[3,4,3,4]*CpC[1,2,3,4]                  # optional - coxeter3
+(v^-2+2+v^2)*CpC[4,3,4,3,4,1,2,3,4]
++ (v^-2+2+v^2)*CpC[4,3,4,3,4,1,2]
++ (v^-1+v)*CpC[3,4,1,2,3,4]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[4,3,4,3,4,1]
++ (v^-1+v)*CpC[3,4,1,2]
+```
+
+The following computation also seems infeasible in the existing `Cp` basis (it did not terminate in any reasonable time), but it is again instant in `Cp_Coxeter3`:
+
+```python
+sage: W = CoxeterGroup('A9', implementation='coxeter3')     # optional - coxeter3
+sage: H = IwahoriHeckeAlgebra(W, v**2)                      # optional - coxeter3
+sage: CpC = H.Cp_Coxeter3()                                 # optional - coxeter3
+sage: CpC[1,2,1,8,9,8]*CpC[1,2,3,7,8,9]                     # optional - coxeter3
+(v^-2+2+v^2)*CpC[1,2,1,3,7,8,7,9,8,7]
++ (v^-2+2+v^2)*CpC[1,2,1,3,8,9,8,7]
++ (v^-3+3*v^-1+3*v+v^3)*CpC[1,2,1,3,8,9,8]
+```
+ 
+The main function for the class `IwahoriHeckeAlgebra.Cp_Coxeter3` is `IwahoriHeckeAlgebra.Cp_Coxeter3.product_on_basis`. Explanations of the relevant algorithms and detailed examples (including more previously infeasible computations) are given in the documentation for this function and the class. We also handle conversions between the C'-basis (implemented in `Cp_Coxeter3`) and other bases of the Iwahori--Hecke algebra, by building on existing conversions involving the `Cp` implementation of the same C'-basis in a trivial way.
+
+The product computations introduced in this ticket can potentially be used to calculate the left, right, or two-sided Kazhdan-Lusztig cell containing arbitrary Coxeter group elements, which can in turn be used to determine all cells in any finite Coxeter group. We have included functions in `sage/categories/coxeter_groups.py` that can calculate the cells containing an element or compute all cells within a finite Coxeter group. Some example computations are given below.
+
+
+```python
+sage: W = CoxeterGroup('B3', implementation='coxeter3')     # optional - coxeter3
+sage: s1,s2,s3 = W.simple_reflections()                     # optional - coxeter3
+sage: W.kazhdan_lusztig_cell(s1*s2*s1)                      # optional - coxeter3
+{[2, 1, 2], [2, 3, 2, 1, 2], [3, 2, 1, 2]}
+sage: W.kazhdan_lusztig_cell(s3, side='right')              # optional - coxeter3
+{[3], [3, 2], [3, 2, 1], [3, 2, 3]}
+sage: W.kazhdan_lusztig_cell(s3, side='two-sided')          # optional - coxeter3
+{[1], [1, 2], [1, 2, 3], [1, 2, 3, 2], [1, 2, 3, 2, 1], [2], [2, 1],
+ [2, 3], [2, 3, 2], [2, 3, 2, 1], [3], [3, 2], [3, 2, 1], [3, 2, 3]}
+```
 
 Author: Chase Meadors, Tianyuan Xu
 
``````




---

archive/issue_comments_489641.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2021-08-16T23:24:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489641",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_489642.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2021-08-16T23:24:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489642",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_489643.json:
```json
{
    "body": "<a id='comment:33'></a>(After `make` finished I discovered a couple docstring errors)",
    "created_at": "2021-08-16T23:25:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489643",
    "user": "https://github.com/cemulate"
}
```

<a id='comment:33'></a>(After `make` finished I discovered a couple docstring errors)



---

archive/issue_comments_489644.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-08-16T23:25:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489644",
    "user": "https://github.com/cemulate"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_085837.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-19T20:30:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32352#event-85837"
}
```



---

archive/issue_comments_489645.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-10-19T20:30:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32352",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32352#issuecomment-489645",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
