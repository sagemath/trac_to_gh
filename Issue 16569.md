# Issue 16569: Isogeny Bounds for Elliptic Curves over Number Fields

archive/issues_016569.json:
```json
{
    "body": "CC:  cremona wuthrich\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/16806\n\n",
    "created_at": "2014-08-12T18:33:26Z",
    "labels": [
        "PLEASE CHANGE",
        "major"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Isogeny Bounds for Elliptic Curves over Number Fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16569",
    "user": "elarson3"
}
```
CC:  cremona wuthrich



Issue created by migration from https://trac.sagemath.org/ticket/16806





---

archive/issue_comments_218136.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to elliptic curves.",
    "created_at": "2014-08-12T18:35:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218136",
    "user": "elarson3"
}
```

Changing component from PLEASE CHANGE to elliptic curves.



---

archive/issue_comments_218137.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2014-08-12T18:35:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218137",
    "user": "elarson3"
}
```

Changing priority from major to minor.



---

archive/issue_comments_218138.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2014-08-12T18:35:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218138",
    "user": "elarson3"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_218139.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-08-12T18:35:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218139",
    "user": "elarson3"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_218140.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-13T16:36:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218140",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218141.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-13T16:53:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218141",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218142.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-13T16:59:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218142",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218143.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-13T17:08:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218143",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218144.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-13T17:13:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218144",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218145.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-13T17:55:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218145",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218146.json:
```json
{
    "body": "OK -- branch now works, I successfully merged it into my own working branch for #16743 (which does not yet use this new code).",
    "created_at": "2014-08-13T19:03:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218146",
    "user": "cremona"
}
```

OK -- branch now works, I successfully merged it into my own working branch for #16743 (which does not yet use this new code).



---

archive/issue_comments_218147.json:
```json
{
    "body": "I made some rather superficial changes to the new function and added a couple more examples.  The changes simlify the code while retaining exactly the same logic.   I had to rename the branch on trac (it is now u/cremona/ticket/16806) as that's the way it has to be (I cannot edit a u/elarson3 branch).\n\nMy edits were superficial, otherwise I give the original new code a positive review.  That means that if you are happy with my additional changes we can jointly give it a positive review.  Before that I'll merge in the current develop branch and re-upload, but the changes I made should all be visible already in the commit 828ed6f.\n----\nNew commits:",
    "created_at": "2014-08-27T12:22:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218147",
    "user": "cremona"
}
```

I made some rather superficial changes to the new function and added a couple more examples.  The changes simlify the code while retaining exactly the same logic.   I had to rename the branch on trac (it is now u/cremona/ticket/16806) as that's the way it has to be (I cannot edit a u/elarson3 branch).

My edits were superficial, otherwise I give the original new code a positive review.  That means that if you are happy with my additional changes we can jointly give it a positive review.  Before that I'll merge in the current develop branch and re-upload, but the changes I made should all be visible already in the commit 828ed6f.
----
New commits:



---

archive/issue_comments_218148.json:
```json
{
    "body": "Forget the last part of my previous comment:  I had already done the merge, as you can see from the list of new commits (first the merge, then my reviewer's patch).  So this is ready for re-review by the original author!\n\nI have now made #16743 dependent on this (isogeny classes of elliptic curves over number fields), which means that I am keener than ever to get this merged.",
    "created_at": "2014-08-27T12:24:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218148",
    "user": "cremona"
}
```

Forget the last part of my previous comment:  I had already done the merge, as you can see from the list of new commits (first the merge, then my reviewer's patch).  So this is ready for re-review by the original author!

I have now made #16743 dependent on this (isogeny classes of elliptic curves over number fields), which means that I am keener than ever to get this merged.



---

archive/issue_comments_218149.json:
```json
{
    "body": "A few comments:\n* The docstring of the main function reads \"\"Returns a list of primes `p` including all primes for which the mod-`p` representation might not be contained in a Borel.\"\" Isn't it the complement, i.e., all those that \"may be contained in a Borel\" ?\n\n* I thought  \"try: ...  except `ValueError`: return [0]\"  is not what we should do. If the long and convoluted line in try produces a `ValueError`, that could have many reasons, and we should not just ignore this and send back [0] but pass the error on.\n\n* It is a shame that this function will not be available for curves over Q. But I guess it should be a separate ticket to merge the two classes dealing with Galois Reps together at some point.",
    "created_at": "2014-09-16T14:01:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218149",
    "user": "wuthrich"
}
```

A few comments:
* The docstring of the main function reads ""Returns a list of primes `p` including all primes for which the mod-`p` representation might not be contained in a Borel."" Isn't it the complement, i.e., all those that "may be contained in a Borel" ?

* I thought  "try: ...  except `ValueError`: return [0]"  is not what we should do. If the long and convoluted line in try produces a `ValueError`, that could have many reasons, and we should not just ignore this and send back [0] but pass the error on.

* It is a shame that this function will not be available for curves over Q. But I guess it should be a separate ticket to merge the two classes dealing with Galois Reps together at some point.



---

archive/issue_comments_218150.json:
```json
{
    "body": "Replying to [comment:14 wuthrich]:\n> A few comments:\n> * The docstring of the main function reads \"\"Returns a list of primes `p` including all primes for which the mod-`p` representation might not be contained in a Borel.\"\" Isn't it the complement, i.e., all those that \"may be contained in a Borel\" ?\n> \n\nYou are right.\n\n> * I thought  \"try: ...  except `ValueError`: return [0]\"  is not what we should do. If the long and convoluted line in try produces a `ValueError`, that could have many reasons, and we should not just ignore this and send back [0] but pass the error on.\n\nI'm to blame for the long line -- the original version had this split over many lines.   The set we return is the union of (1) primes of additive reduction (found as factors of gcd(c4,Delta) in effect; (2) primes ramified in the field; (3) the ones returned by _semistable_reducible_primes.  The latter function uses [0] to denote CM.  So I cannot see what circumstances will lead to a ValueError, and suggest we can simplify this.\n\n> \n> * It is a shame that this function will not be available for curves over Q. But I guess it should be a separate ticket to merge the two classes dealing with Galois Reps together at some point.\n\nAgreed.  I said so myself somewhere.\n\nI will revise the branch to take into account your first two points...",
    "created_at": "2014-09-16T14:28:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218150",
    "user": "cremona"
}
```

Replying to [comment:14 wuthrich]:
> A few comments:
> * The docstring of the main function reads ""Returns a list of primes `p` including all primes for which the mod-`p` representation might not be contained in a Borel."" Isn't it the complement, i.e., all those that "may be contained in a Borel" ?
> 

You are right.

> * I thought  "try: ...  except `ValueError`: return [0]"  is not what we should do. If the long and convoluted line in try produces a `ValueError`, that could have many reasons, and we should not just ignore this and send back [0] but pass the error on.

I'm to blame for the long line -- the original version had this split over many lines.   The set we return is the union of (1) primes of additive reduction (found as factors of gcd(c4,Delta) in effect; (2) primes ramified in the field; (3) the ones returned by _semistable_reducible_primes.  The latter function uses [0] to denote CM.  So I cannot see what circumstances will lead to a ValueError, and suggest we can simplify this.

> 
> * It is a shame that this function will not be available for curves over Q. But I guess it should be a separate ticket to merge the two classes dealing with Galois Reps together at some point.

Agreed.  I said so myself somewhere.

I will revise the branch to take into account your first two points...



---

archive/issue_comments_218151.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-17T10:27:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218151",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218152.json:
```json
{
    "body": "I made cosmetic changes in line with Chris's comments:  various tidying of docstrings (including fixing that double negative) and simplifying (making clearer I hope) the two long lines where various sets of primes are collected.  It turned out that a try/except is needed since the function _semistable_reducible_primes() does raise a ValueError if given a CM curve.\n\nReady for a new review!",
    "created_at": "2014-09-17T10:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218152",
    "user": "cremona"
}
```

I made cosmetic changes in line with Chris's comments:  various tidying of docstrings (including fixing that double negative) and simplifying (making clearer I hope) the two long lines where various sets of primes are collected.  It turned out that a try/except is needed since the function _semistable_reducible_primes() does raise a ValueError if given a CM curve.

Ready for a new review!



---

archive/issue_comments_218153.json:
```json
{
    "body": "Am I right that the file does not appear in the reference manual ?\n\nI added this and modified the starting docstring so that the reference manual builds. \n\nStarting testing now. Except a positive review soon. \n\n----\nNew commits:",
    "created_at": "2014-09-17T11:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218153",
    "user": "wuthrich"
}
```

Am I right that the file does not appear in the reference manual ?

I added this and modified the starting docstring so that the reference manual builds. 

Starting testing now. Except a positive review soon. 

----
New commits:



---

archive/issue_comments_218154.json:
```json
{
    "body": "Thanks.  I seem to have forgotten to check that building the docs worked, but that would have been null anyway until you added it to the manual.  Good!",
    "created_at": "2014-09-17T12:12:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218154",
    "user": "cremona"
}
```

Thanks.  I seem to have forgotten to check that building the docs worked, but that would have been null anyway until you added it to the manual.  Good!



---

archive/issue_comments_218155.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-17T14:43:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218155",
    "user": "wuthrich"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_218156.json:
```json
{
    "body": "Thanks!",
    "created_at": "2014-09-17T14:53:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218156",
    "user": "cremona"
}
```

Thanks!



---

archive/issue_comments_218157.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-09-25T12:05:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16569",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16569#issuecomment-218157",
    "user": "vbraun"
}
```

Resolution: fixed
