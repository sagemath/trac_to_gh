# Issue 15931: use p_iter_fork in projective_morphism

Issue created by migration from https://trac.sagemath.org/ticket/16168

Original creator: bhutz

Original creation time: 2014-04-15 11:32:04

Keywords: propjective morphism parallel

projective_morphism uses parallel calls in several functions. It uses the multiprocessing.py function parallel_iter. It seems on OSX that there is some issue with the function. For example, calling possible_periods on a function multiple times (usually 50 is sufficient) will result in a error which varies. This does seem appear to occur on linux.

The p_iter_fork function seems more stable and does not have this issue.

While we are adjusting how parallel works, I think a ncpus kwd should also be added.


---

Comment by bhutz created at 2014-04-15 11:32:26

Changing keywords from "propjective morphism parallel" to "projective morphism parallel".


---

Comment by bhutz created at 2014-04-15 11:32:26

Set assignee to drose.


---

Comment by git created at 2014-04-21 23:56:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by drose created at 2014-04-22 00:16:47

Changing status from new to needs_review.


---

Comment by bhutz created at 2014-04-22 12:32:17

Changing status from needs_review to needs_work.


---

Comment by bhutz created at 2014-04-22 12:32:17

parallel_iter is still being used in possible_periods.


Switch that to p_iter_fork and add the ncpus kwd.


---

Comment by git created at 2014-04-22 14:15:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by drose created at 2014-04-22 14:20:35

Changing status from needs_work to needs_review.


---

Comment by git created at 2014-04-23 03:52:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2014-04-23 13:31:21

Changing status from needs_review to positive_review.


---

Comment by bhutz created at 2014-04-23 13:31:21

This looks good to me. I am unable to reproduce the errors I was seeing on OSX after this fix.

I made one minor change, which was to move the import out of the function and to the top of the file.
----
New commits:


---

Comment by vbraun created at 2014-05-08 11:52:07

Resolution: fixed
