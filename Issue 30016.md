# Issue 30016: Coset graph of linear codes

archive/issues_030016.json:
```json
{
    "body": "CC:  @dimpase @johanrosenkilde @xcaruso\n\nKeywords: linear_codes coset_graph\n\nAdded method to the `AbstractLinearCode` class to compute the coset graph of a linear code.\n\nIssue created by migration from https://trac.sagemath.org/ticket/30253\n\n",
    "created_at": "2020-07-30T08:21:38Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Coset graph of linear codes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30016",
    "user": "https://github.com/Ivo-Maffei"
}
```
CC:  @dimpase @johanrosenkilde @xcaruso

Keywords: linear_codes coset_graph

Added method to the `AbstractLinearCode` class to compute the coset graph of a linear code.

Issue created by migration from https://trac.sagemath.org/ticket/30253





---

archive/issue_comments_426223.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-07-30T08:22:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30016#issuecomment-426223",
    "user": "https://github.com/Ivo-Maffei"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_426224.json:
```json
{
    "body": "hamming -> Hamming\n\nAlso: we have abstract linear codes, to which you can attach different metrics.\nE.g. there are rank codes (on matrices, with distance being the rank of the difference), already implemented in Sage. So it would be good to have this implemented there too.\n\nProvide a definition of the coset graph.\n\nOne day we should have additive codes (to have cosets of C, it suffices to have C an additive subgroup), so that we can also implement coset graphs for them, see e.g. https://arxiv.org/abs/1806.07069",
    "created_at": "2020-07-31T10:57:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30016#issuecomment-426224",
    "user": "https://github.com/dimpase"
}
```

hamming -> Hamming

Also: we have abstract linear codes, to which you can attach different metrics.
E.g. there are rank codes (on matrices, with distance being the rank of the difference), already implemented in Sage. So it would be good to have this implemented there too.

Provide a definition of the coset graph.

One day we should have additive codes (to have cosets of C, it suffices to have C an additive subgroup), so that we can also implement coset graphs for them, see e.g. https://arxiv.org/abs/1806.07069



---

archive/issue_comments_426225.json:
```json
{
    "body": "What kind of graph does this correspond to in terms of the dual to C code?",
    "created_at": "2020-07-31T11:09:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30016#issuecomment-426225",
    "user": "https://github.com/dimpase"
}
```

What kind of graph does this correspond to in terms of the dual to C code?



---

archive/issue_comments_426226.json:
```json
{
    "body": "First of all, I'm not sure the algorithm used is the best one. I could simply compute the cosets of C and work with their representatives, but I have a feeling it will be slower. \nThat said, I think the algorithm relies on `C` being a set of vectors. In Sagemath `MatrixSpace` is not a subtype of `VectorSpace` so I think this function will have issues if the vectors are actually matrices.\n\nA definition for the coset graph is provided in the docstring: \"the vertices are the cosets and 2 cosets are adjacent if they have representatives that differ in one coordinate\". \\\\\nI haven't found any `LinearRankMetricCode` in Sagemath that doesn't use vectors, so I could just move the `cosetGraph` method to\n`AbstractLinearCodeNoMetric`. However, if you wish to use a different definition of coset graph that uses a more general metric, then we need a substantially different implementation (still doable).\n\nAs far as the dual code is concerned, if I get it right the dual code of `C` is the orthogonal complement of `C` which is not a direct sum complement of `C` if we use a non positive-definite bilinear form. So I don't see many connections when the base field is finite.\nFor instance:\n\n```\nsage: C = codes.GolayCode(GF(3))\nsage: U = C.dual_code()\nsage: U == C\nTrue\n```\n",
    "created_at": "2020-07-31T12:09:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30016#issuecomment-426226",
    "user": "https://github.com/Ivo-Maffei"
}
```

First of all, I'm not sure the algorithm used is the best one. I could simply compute the cosets of C and work with their representatives, but I have a feeling it will be slower. 
That said, I think the algorithm relies on `C` being a set of vectors. In Sagemath `MatrixSpace` is not a subtype of `VectorSpace` so I think this function will have issues if the vectors are actually matrices.

A definition for the coset graph is provided in the docstring: "the vertices are the cosets and 2 cosets are adjacent if they have representatives that differ in one coordinate". \\
I haven't found any `LinearRankMetricCode` in Sagemath that doesn't use vectors, so I could just move the `cosetGraph` method to
`AbstractLinearCodeNoMetric`. However, if you wish to use a different definition of coset graph that uses a more general metric, then we need a substantially different implementation (still doable).

As far as the dual code is concerned, if I get it right the dual code of `C` is the orthogonal complement of `C` which is not a direct sum complement of `C` if we use a non positive-definite bilinear form. So I don't see many connections when the base field is finite.
For instance:

```
sage: C = codes.GolayCode(GF(3))
sage: U = C.dual_code()
sage: U == C
True
```




---

archive/issue_comments_426227.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-31T12:11:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30016#issuecomment-426227",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_426228.json:
```json
{
    "body": "Replying to [comment:4 gh-Ivo-Maffei]:\n> First of all, I'm not sure the algorithm used is the best one. I could simply compute the cosets of C and work with their representatives, but I have a feeling it will be slower. \n\nI think working in a complement space, as you did, is good.\n\n> That said, I think the algorithm relies on `C` being a set of vectors. In Sagemath `MatrixSpace` is not a subtype of `VectorSpace` so I think this function will have issues if the vectors are actually matrices.\n\n\n> \n> A definition for the coset graph is provided in the docstring: \"the vertices are the cosets and 2 cosets are adjacent if they have representatives that differ in one coordinate\". \\\\\n\nmaybe something like \"the vertices are the cosets of C, considered as a subgroup of the additive group of the ambient vector space, and two cosets are adjacent if they have representatives that differ in exactly one coordinate\". \n\n\n> I haven't found any `LinearRankMetricCode` in Sagemath that doesn't use vectors, so I could just move the `cosetGraph` method to\n> `AbstractLinearCodeNoMetric`. \n\nhmm, no, as there is no metric at all, whereas you do use the Hamming metric.\n\n> However, if you wish to use a different definition of coset graph that uses a more general metric, then we need a substantially different implementation (still doable).\n> \n> As far as the dual code is concerned, if I get it right the dual code of `C` is the orthogonal complement of `C` which is not a direct sum complement of `C` if we use a non positive-definite bilinear form. So I don't see many connections when the base field is finite.\n\nyou're right, sorry for noise at this point.",
    "created_at": "2020-07-31T13:19:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30016#issuecomment-426228",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:4 gh-Ivo-Maffei]:
> First of all, I'm not sure the algorithm used is the best one. I could simply compute the cosets of C and work with their representatives, but I have a feeling it will be slower. 

I think working in a complement space, as you did, is good.

> That said, I think the algorithm relies on `C` being a set of vectors. In Sagemath `MatrixSpace` is not a subtype of `VectorSpace` so I think this function will have issues if the vectors are actually matrices.


> 
> A definition for the coset graph is provided in the docstring: "the vertices are the cosets and 2 cosets are adjacent if they have representatives that differ in one coordinate". \\

maybe something like "the vertices are the cosets of C, considered as a subgroup of the additive group of the ambient vector space, and two cosets are adjacent if they have representatives that differ in exactly one coordinate". 


> I haven't found any `LinearRankMetricCode` in Sagemath that doesn't use vectors, so I could just move the `cosetGraph` method to
> `AbstractLinearCodeNoMetric`. 

hmm, no, as there is no metric at all, whereas you do use the Hamming metric.

> However, if you wish to use a different definition of coset graph that uses a more general metric, then we need a substantially different implementation (still doable).
> 
> As far as the dual code is concerned, if I get it right the dual code of `C` is the orthogonal complement of `C` which is not a direct sum complement of `C` if we use a non positive-definite bilinear form. So I don't see many connections when the base field is finite.

you're right, sorry for noise at this point.



---

archive/issue_comments_426229.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-31T18:52:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30016#issuecomment-426229",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_426230.json:
```json
{
    "body": "`the (direct sum) complement` -> `a (direct sum) complement` (it's certainly not unique)",
    "created_at": "2020-07-31T21:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30016#issuecomment-426230",
    "user": "https://github.com/dimpase"
}
```

`the (direct sum) complement` -> `a (direct sum) complement` (it's certainly not unique)



---

archive/issue_comments_426231.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-01T07:47:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30016#issuecomment-426231",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_426232.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-02T09:23:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30016#issuecomment-426232",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_426233.json:
```json
{
    "body": "looks good to me",
    "created_at": "2020-08-02T11:38:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30016#issuecomment-426233",
    "user": "https://github.com/dimpase"
}
```

looks good to me



---

archive/issue_comments_426234.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-08-02T11:38:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30016#issuecomment-426234",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_426235.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-08-07T19:06:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30016",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30016#issuecomment-426235",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_027621.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2020-08-07T19:06:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30016",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30016#event-27621"
}
```
