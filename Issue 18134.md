# Issue 18134: Implement supercharacter bases of Bergeron and Thiem for NCSym

Issue created by migration from https://trac.sagemath.org/ticket/18371

Original creator: tscrim

Original creation time: 2015-05-05 23:59:05

Assignee: sage-combinat

CC:  sage-combinat saliola zabrocki

Keywords: ncsym, symmetric functions

This ticket implements the following bases based upon N. Bergeron, N. Thiem. _A supercharacter table decomposition via power-sum symmetric functions_ (2013):

- `a` -- the arc powersum basis
- `rho` -- the q-deformation of `a`
- `chi` -- the supercharacter basis

and transition maps between them. This is distinct from #6924 in which a finer supercharacter theory is considered.


---

Comment by tscrim created at 2015-05-05 23:59:59

New commits:


---

Comment by tscrim created at 2015-05-05 23:59:59

Changing status from new to needs_review.


---

Comment by git created at 2015-05-06 00:02:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-05-06 00:09:39

I should note that I cannot reproduce Example 3.2 in (the arXiv version of) the paper in the sense that I get far fewer zeros in my matrix, but on the non-zero entries, it agrees:

```
[                       1                        0                        0                        0                        0                        0                        0                        0                        0                        0                        0                        0                        0                        0                        0]
[                   q - 1                       -q                        0                        0                        0                        0                        0                        0                        0                        0                        0                        0                        0                        0                        0]
[                   q - 1                        0                       -q                        0                        0                        0                        0                        0                        0                        0                        0                        0                        0                        0                        0]
[                   q - 1                        0                        0                       -q                        0                        0                        0                        0                        0                        0                        0                        0                        0                        0                        0]
[           q^2 - 2*q + 1                 -q^2 + q                 -q^2 + q                        0                      q^2                        0                        0                        0                        0                        0                        0                        0                        0                        0                        0]
[           q^2 - 2*q + 1                 -q^2 + q                        0                 -q^2 + q                        0                      q^2                        0                        0                        0                        0                        0                        0                        0                        0                        0]
[           q^2 - 2*q + 1                        0                 -q^2 + q                 -q^2 + q                        0                        0                      q^2                        0                        0                        0                        0                        0                        0                        0                        0]
[   q^3 - 3*q^2 + 3*q - 1         -q^3 + 2*q^2 - q         -q^3 + 2*q^2 - q         -q^3 + 2*q^2 - q                q^3 - q^2                q^3 - q^2                q^3 - q^2                     -q^3                        0                        0                        0                        0                        0                        0                        0]
[                 q^2 - q                 -q^2 + q                 -q^2 + q                        0                  q^2 - q                        0                        0                        0                     -q^2                        0                        0                        0                        0                        0                        0]
[                 q^2 - q                        0                 -q^2 + q                 -q^2 + q                        0                        0                  q^2 - q                        0                        0                     -q^2                        0                        0                        0                        0                        0]
[         q^3 - 2*q^2 + q               -q^3 + q^2         -q^3 + 2*q^2 - q         -q^3 + 2*q^2 - q                q^3 - q^2                q^3 - q^2          q^3 - 2*q^2 + q               -q^3 + q^2                        0               -q^3 + q^2                      q^3                        0                        0                        0                        0]
[         q^3 - 2*q^2 + q         -q^3 + 2*q^2 - q         -q^3 + 2*q^2 - q               -q^3 + q^2          q^3 - 2*q^2 + q                q^3 - q^2                q^3 - q^2               -q^3 + q^2               -q^3 + q^2                        0                        0                      q^3                        0                        0                        0]
[       q^4 - 2*q^3 + q^2       -q^4 + 2*q^3 - q^2       -q^4 + 2*q^3 - q^2       -q^4 + 2*q^3 - q^2        q^4 - 2*q^3 + q^2        q^4 - 2*q^3 + q^2        q^4 - 2*q^3 + q^2       -q^4 + 2*q^3 - q^2               -q^4 + q^3               -q^4 + q^3                q^4 - q^3                q^4 - q^3                      q^4                        0                        0]
[               q^3 - q^2               -q^3 + q^2         -q^3 + 2*q^2 - q               -q^3 + q^2          q^3 - 2*q^2 + q                q^3 - q^2          q^3 - 2*q^2 + q         -q^3 + 2*q^2 - q               -q^3 + q^2               -q^3 + q^2                q^3 - q^2                q^3 - q^2                q^3 - q^2                     -q^3                        0]
[       q^4 - 2*q^3 + q^2       -q^4 + 2*q^3 - q^2 -q^4 + 2*q^3 - 2*q^2 + q       -q^4 + 2*q^3 - q^2  q^4 - 2*q^3 + 2*q^2 - q        q^4 - 2*q^3 + q^2  q^4 - 2*q^3 + 2*q^2 - q -q^4 + 2*q^3 - 2*q^2 + q       -q^4 + 2*q^3 - q^2       -q^4 + 2*q^3 - q^2        q^4 - 2*q^3 + q^2        q^4 - 2*q^3 + q^2        q^4 - 2*q^3 + q^2               -q^4 + q^3                      q^3]
```



---

Comment by zabrocki created at 2015-05-07 13:07:35

Is there a difference between the q and a bases?
`all(a(A)==q(A) for A in SetPartitions(n))` is true for n<=7.

Can we go with a t-deformation since Hall-Littlewoods use that parameter (and then q is the second Macdonald parameter)


---

Comment by zabrocki created at 2015-05-07 13:14:18

This doesn't work:
`h(rho([[1,2,5],[3],[4,6]]))`


---

Comment by zabrocki created at 2015-05-07 13:15:04

Changing status from needs_review to needs_work.


---

Comment by git created at 2015-05-07 17:27:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by zabrocki created at 2015-05-07 17:31:24

Message from Nantel:  Can you tell Travis that he is right. Some non-zero entries of example 3.2 in our paper were set wrongly to zero.  The matrix is indeed lower triangular (as the proof is correct) but the program to compute examples was wrong :(


---

Comment by tscrim created at 2015-05-07 17:41:30

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2015-05-07 17:41:30

Thanks for taking a look at this Mike. You are correct that the `a` basis is the same as the `q` basis (the strictly coarser set partitions is the same as the ordering as in BT). Good catch. I also fixed the coercions when working over rings that don't have a good notation of `abs` by just coercing after doing the arithmetic on `QQ`.

For the t vs q, I'd think having it be a q gives a better relation with finite fields which are typically denoted by F<sub>q</sub>. Nor do these seem to be an NCSym analog of Hall-Littlewood as the multiplication has coefficients in ZZ (as I was hoping). However, I'm not really attached to the variable name and I will change it if you think the association is not a good enough reason to keep it.

Nantel, thank you for checking. I was worried that something subtle was going wrong with my implementation or I misunderstood something from your paper.


---

Comment by zabrocki created at 2015-05-07 19:23:54

I expressed my concern about using `q` mainly because there is the *q*-basis.  I am slightly concerned about the confusion in expressions like `q*q[3]`.  I had just started looking this morning so I will keep testing.


---

Comment by tscrim created at 2015-05-08 00:17:47

Replying to [comment:10 zabrocki]:
> I expressed my concern about using `q` mainly because there is the *q*-basis.  I am slightly concerned about the confusion in expressions like `q*q[3]`.  I had just started looking this morning so I will keep testing.

That's a good point. At least because Python doesn't have any polymorphism, you could never write `q * q[[1,3], [2]]` with `q` being both the q-deformation and the *q*-basis. I think because the letter bases for NCSym are boldfaced letters, there is less danger of confusion too, at least in terms of the doc. However, this is a good reason for me to call it a t-deformation if you think it's for the best.


---

Comment by zabrocki created at 2015-05-08 13:28:32

I think it is a choice between changing the parameter `q` and the basis `q`.  I think that you are right that `t` is not ideal either.  Testing examples I have expressions like `q{{1, 2, 5}, {3}, {4, 6}} + ((-q+1)/q)*q{{1, 2, 5}, {3, 4, 6`}.  Would it be a bad idea at this point to rename the *q*-basis?  I am looking in the reference you pulled it from and they called it $p_\nu$, however if I remember when Nantel and I first defined it in http://arxiv.org/abs/math/0509265, we recognized it was similar to the power sum basis and the letter *q* is a reflection of *p* in the vertical axis.  Maybe we want to call it the *b*-basis (reflect in the horizontal axis).


---

Comment by tscrim created at 2015-05-08 17:59:02

I'm okay with calling it the *b*-basis. It's not too hard to change the name, just a relatively simple deprecation for the *q*-basis. The other option I'm toying with, but in some ways less happy, is the *c*-basis or *cp*-basis as short for "coarse powersum".


---

Comment by zabrocki created at 2015-05-08 20:53:09

Changing status from needs_review to needs_work.


---

Comment by zabrocki created at 2015-05-08 20:53:09

I was looking at the rho basis and it states "This basis was defined in [BT13] as a q-deformation of the *a* basis" which should now read "q-deformation of the *q* basis" (and this is no good)
What are the other basis names?
chi = supercharacter
x = doesn't have a name
q = doesn't have a name = I like perhaps calling this the coarse_powersum
m,h,e,p = monomial, homogeneous, elementary and powersum


---

Comment by tscrim created at 2015-05-09 02:21:04

Replying to [comment:14 zabrocki]:
> I was looking at the rho basis and it states "This basis was defined in [BT13] as a q-deformation of the *a* basis" which should now read "q-deformation of the *q* basis" (and this is no good)

Forgot about that. However I will change that once we decide on what we want for the *q*-basis.

> What are the other basis names?
> chi = supercharacter
> x = doesn't have a name
> q = doesn't have a name = I like perhaps calling this the coarse_powersum
> m,h,e,p = monomial, homogeneous, elementary and powersum

Correct. So should I then rename *q* to `coarse_powersum` with a shorthand name of *cp*?


---

Comment by zabrocki created at 2015-05-09 10:59:11

Yes.  I agree that `coarse_powersum` and `cp` are better than `q` for a basis name.  The documentation should indicate that [BT13] the basis is p_\nu and in [BZ05] it is *q*_A


---

Comment by zabrocki created at 2015-05-09 11:30:34

I'm also thinking that `rho` should have a long name as well (and `x` too, even if that is `x_basis`).  How about `deformed_coarse_powersum`?


---

Comment by git created at 2015-05-09 17:04:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-05-09 17:05:30

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2015-05-09 17:05:30

Works for me. All points have been addressed in my previous commit.


---

Comment by git created at 2015-05-10 11:21:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-05-10 14:08:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-05-10 14:51:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-05-10 15:17:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-05-10 17:49:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-05-12 02:40:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-05-12 11:26:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by zabrocki created at 2015-05-12 11:48:58

I think that I'm done.  If you are happy with the changes you can set to positive review.  I tried computing `e(chi([[1], [2, 3],[4], [6], [5,7]]))` and it takes an extremely long time.  It seems as though it can handle an expression up to degree 5 fine, 6 slow, 7 ?beyond the limit of my patience?.


---

Comment by git created at 2015-05-13 01:25:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-05-13 01:27:36

Thank you for all your additional fixes and cleanup. There might be a better way to do things than the current implementation, but I haven't done any serious profiling or know of some direct mathematical interpretation. However, going to the `m` basis already contains a large number of terms:

```
sage: len(m(chi([[1],[2,3],[4],[6],[5,7]])))
523
```

Currently there's a directly implemented coercion `e -> m`, but to go back, we have `m -> p -> h -> e`. I've changed the ordering that other bases get created with the `e` basis to get the coercion path `m -> p -> e`. So it should be a little bit faster. However I think there's some other speedups we could get, but perhaps on a followup?


---

Comment by zabrocki created at 2015-05-13 02:23:54

Changing status from needs_review to positive_review.


---

Comment by zabrocki created at 2015-05-13 02:23:54

I'm not sure if changing the coercion path is the issue.  There might be another ticket to be had here: implement coercion between generators of multiplicative bases.  Since the example that I gave above is `e(chi([[1], [2, 3]]))*e(chi([This is the Trac macro *1* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1-macro)))*e(chi([[2], [1,3]]))` there is a faster way of computing it.  I did manage to compute it with this commit, but it took a while.  Real improvements will come from developing the mathematics.

I am happy with the current version.


---

Comment by tscrim created at 2015-05-13 02:57:15

It's definitely not the issue, but it does help. However, I like the idea of factoring, but definitely for a follow-up ticket. Thanks again.


---

Comment by vbraun created at 2015-05-13 20:11:31

Resolution: fixed
