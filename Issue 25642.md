# Issue 25642: Residue incorrect for extensions of CA and FM extensions

Issue created by migration from Trac.

Original creator: saraedum

Original creation time: 2018-07-19 06:13:46

CC:  roed xcaruso


```
sage: K = ZpCA(3,5)
sage: R.<a> = K[]
sage: L.<a> = K.extension(a^2 - 3)
sage: a.residue()
1
```



---

Comment by saraedum created at 2018-07-19 06:13:55

Changing type from PLEASE CHANGE to defect.


---

Comment by saraedum created at 2018-07-19 06:25:15

The issue seems to be in `expansion(n)`:

```
sage: a.expansion()
[0, 1]
sage: a.expansion(0)
1
```


The problem is a line that says:

```
return ulist[n - self.ordp]
```


Here the index is negative in our case (`n=0`, `self.ordp=1`)


---

Comment by saraedum created at 2018-07-19 06:30:35

New commits:


---

Comment by git created at 2018-07-19 06:32:19

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by saraedum created at 2018-07-19 06:32:48

New commits:


---

Comment by saraedum created at 2018-07-19 06:32:48

Changing status from new to needs_review.


---

Comment by chapoton created at 2018-07-19 13:01:20

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2018-07-19 13:01:20

let it be


---

Comment by vbraun created at 2018-08-05 08:16:00

Resolution: fixed
