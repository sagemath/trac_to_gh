# Issue 24845: Fix symbolic power of matrix

Issue created by migration from https://trac.sagemath.org/ticket/25082

Original creator: slelievre

Original creation time: 2018-04-02 18:00:26

CC:  mforets slelievre tmonteil tscrim

Keywords: matrix power, symbolic

The symbolic power of a matrix was requested and discussed in
[Ask Sage question 25658](https://ask.sagemath.org/question/35658/general-power-of-a-matrix/),
and implemented in #22523.

That implementation works in basic cases (diagonalizable case, two by two case, ...).

As reported in
[Ask Sage question 41622](https://ask.sagemath.org/question/41622/bug-in-general-power-of-a-matrix)
though, it fails in some cases.

The reason is that the general matrix power is computed on the Jordan form of the matrix,
but the k-th block was placed at (k, k), which is incorrect if a Jordan block of size at least two
occurs in any position but the last.

This ticket implements the fix suggested in an answer to Ask Sage question 41622.

Before this ticket:


```
sage: n = SR.var('n')
sage: A = matrix(QQ, 3, [[2, 1, 0], [0, 2, 0], [0, 0, 3]]); A
sage: B = A^n; B
[        2^n 2^(n - 1)*n           0]
[          0         3^n           0]
[          0           0           0]
```


After this ticket:


```
sage: B = A^n; B
[        2^n 2^(n - 1)*n           0]
[          0         2^n           0]
[          0           0         3^n]
```




---

Comment by slelievre created at 2018-04-02 18:06:48

Cc-ing authors and reviewers of #22523.

I pushed the fix from my answer at Ask Sage.


---

Comment by slelievre created at 2018-04-02 18:09:08

Changing status from new to needs_review.


---

Comment by chapoton created at 2018-04-06 08:38:11

ok


---

Comment by chapoton created at 2018-04-06 08:38:11

Changing status from needs_review to positive_review.


---

Comment by mforets created at 2018-04-06 10:26:09

thanks for the fix.


---

Comment by vbraun created at 2018-04-08 23:26:39

Resolution: fixed
