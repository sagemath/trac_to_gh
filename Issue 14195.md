# Issue 14195: MPIR 2.6.0's test suite fails with GCC 4.8.0

Issue created by migration from Trac.

Original creator: leif

Original creation time: 2013-04-02 17:33:33

Assignee: leif

CC:  jpflori

Keywords: spkg t-scan segmentation fault segfault

The fix is fairly easy:

```patch
--- mpir-2.6.0/tests/mpz/t-scan.c.orig	2012-10-03 22:07:32.000000000 +0200
+++ mpir-2.6.0/tests/mpz/t-scan.c	2013-04-02 18:39:17.704366985 +0200
`@``@` -84,7 +84,7 `@``@`
 
               for (isize = 0; isize <= size; isize++)
                 {
-                  for (oindex = 0; oindex <= numberof (offset); oindex++)
+                  for (oindex = 0; oindex < numberof (offset); oindex++)
                     {
                       o = offset[oindex];
                       if ((int) isize*GMP_NUMB_BITS < -o)
```



---

Comment by kcrisman created at 2013-04-02 18:40:35

Upstream report is at [this mpir-devel thread](http://groups.google.com/group/mpir-devel/browse_thread/thread/a0b93780c50bc6ed).


---

Attachment

Diff between the `.p1` and the `.p2` spkg.  For reference / review only.


---

Comment by leif created at 2013-04-03 13:41:48

Changing status from new to needs_review.


---

Comment by jpflori created at 2013-04-03 16:55:25

Looks ok and at least still works as expected on a usual system where the MPIR spkg used to work.


---

Comment by jpflori created at 2013-04-03 16:55:25

Changing status from needs_review to positive_review.


---

Comment by leif created at 2013-04-03 17:51:10

Replying to [comment:4 jpflori]:
> Looks ok and at least still works as expected on a usual system where the MPIR spkg used to work.

Thanks.  I guess using GCC 4.8 will become less "unusual" soon.  (Ubuntu tends to incorporate patches from later versions into their "previous" GCC versions anyway, and as mentioned, it's rather surprising this long-lasting bug never caused problems before.  Although note that only the test code was broken, not the library itself.)


---

Comment by jdemeyer created at 2013-04-04 17:41:01

Resolution: fixed
