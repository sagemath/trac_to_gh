# Issue 14195: MPIR 2.6.0's test suite fails with GCC 4.8.0

archive/issues_014195.json:
```json
{
    "body": "Assignee: @nexttime\n\nCC:  jpflori\n\nKeywords: spkg t-scan segmentation fault segfault\n\nThe fix is fairly easy:\n\n```patch\n--- mpir-2.6.0/tests/mpz/t-scan.c.orig\t2012-10-03 22:07:32.000000000 +0200\n+++ mpir-2.6.0/tests/mpz/t-scan.c\t2013-04-02 18:39:17.704366985 +0200\n@@ -84,7 +84,7 @@\n \n               for (isize = 0; isize <= size; isize++)\n                 {\n-                  for (oindex = 0; oindex <= numberof (offset); oindex++)\n+                  for (oindex = 0; oindex < numberof (offset); oindex++)\n                     {\n                       o = offset[oindex];\n                       if ((int) isize*GMP_NUMB_BITS < -o)\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/14399\n\n",
    "created_at": "2013-04-02T17:33:33Z",
    "labels": [
        "packages: standard",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.9",
    "title": "MPIR 2.6.0's test suite fails with GCC 4.8.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14195",
    "user": "@nexttime"
}
```
Assignee: @nexttime

CC:  jpflori

Keywords: spkg t-scan segmentation fault segfault

The fix is fairly easy:

```patch
--- mpir-2.6.0/tests/mpz/t-scan.c.orig	2012-10-03 22:07:32.000000000 +0200
+++ mpir-2.6.0/tests/mpz/t-scan.c	2013-04-02 18:39:17.704366985 +0200
@@ -84,7 +84,7 @@
 
               for (isize = 0; isize <= size; isize++)
                 {
-                  for (oindex = 0; oindex <= numberof (offset); oindex++)
+                  for (oindex = 0; oindex < numberof (offset); oindex++)
                     {
                       o = offset[oindex];
                       if ((int) isize*GMP_NUMB_BITS < -o)
```


Issue created by migration from https://trac.sagemath.org/ticket/14399





---

archive/issue_comments_178395.json:
```json
{
    "body": "Upstream report is at [this mpir-devel thread](http://groups.google.com/group/mpir-devel/browse_thread/thread/a0b93780c50bc6ed).",
    "created_at": "2013-04-02T18:40:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14195#issuecomment-178395",
    "user": "@kcrisman"
}
```

Upstream report is at [this mpir-devel thread](http://groups.google.com/group/mpir-devel/browse_thread/thread/a0b93780c50bc6ed).



---

archive/issue_comments_178396.json:
```json
{
    "body": "Attachment [mpir-2.6.0.p1-p2.diff](tarball://root/attachments/some-uuid/ticket14399/mpir-2.6.0.p1-p2.diff) by @nexttime created at 2013-04-03 13:36:21\n\nDiff between the `.p1` and the `.p2` spkg.  For reference / review only.",
    "created_at": "2013-04-03T13:36:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14195#issuecomment-178396",
    "user": "@nexttime"
}
```

Attachment [mpir-2.6.0.p1-p2.diff](tarball://root/attachments/some-uuid/ticket14399/mpir-2.6.0.p1-p2.diff) by @nexttime created at 2013-04-03 13:36:21

Diff between the `.p1` and the `.p2` spkg.  For reference / review only.



---

archive/issue_comments_178397.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-04-03T13:41:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14195#issuecomment-178397",
    "user": "@nexttime"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_178398.json:
```json
{
    "body": "Looks ok and at least still works as expected on a usual system where the MPIR spkg used to work.",
    "created_at": "2013-04-03T16:55:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14195#issuecomment-178398",
    "user": "jpflori"
}
```

Looks ok and at least still works as expected on a usual system where the MPIR spkg used to work.



---

archive/issue_comments_178399.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-04-03T16:55:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14195#issuecomment-178399",
    "user": "jpflori"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_178400.json:
```json
{
    "body": "Replying to [comment:4 jpflori]:\n> Looks ok and at least still works as expected on a usual system where the MPIR spkg used to work.\n\nThanks.  I guess using GCC 4.8 will become less \"unusual\" soon.  (Ubuntu tends to incorporate patches from later versions into their \"previous\" GCC versions anyway, and as mentioned, it's rather surprising this long-lasting bug never caused problems before.  Although note that only the test code was broken, not the library itself.)",
    "created_at": "2013-04-03T17:51:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14195#issuecomment-178400",
    "user": "@nexttime"
}
```

Replying to [comment:4 jpflori]:
> Looks ok and at least still works as expected on a usual system where the MPIR spkg used to work.

Thanks.  I guess using GCC 4.8 will become less "unusual" soon.  (Ubuntu tends to incorporate patches from later versions into their "previous" GCC versions anyway, and as mentioned, it's rather surprising this long-lasting bug never caused problems before.  Although note that only the test code was broken, not the library itself.)



---

archive/issue_comments_178401.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-04-04T17:41:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14195#issuecomment-178401",
    "user": "@jdemeyer"
}
```

Resolution: fixed
