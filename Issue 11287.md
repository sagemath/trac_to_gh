# Issue 11287: Implement sage -rst2notebook

archive/issues_011287.json:
```json
{
    "body": "Assignee: slabbe\n\nCC:  kcrisman kini jasonbhill\n\nConvert a rst file into a notebook file (text file). \n\nThe idea is that in general I wrote code using the Sage Code Convention where examples are formatted in ReST. Then converting rst examples to the notebook would be nice. Also, ReST file is more fun to edit than the html/cells notebook text file.\n\nI implemented a script called `rst2notebook` available [on the Sage Combinat server](http://combinat.sagemath.org/hgwebdir.cgi/misc/file/ef17ccb37589/notebook2rst/).\n\nIn this script, I use docutils to translate a rst file into html file. From this, I convert blocks into cells. Note that I do not use sphinx so that not all usual Sage Rest syntax is working. But I am able to make math role work by adding dollar signs.\n\nI am planning to make this script more clean during [Sage Days 31](http://wiki.sagemath.org/days31), I hope based on sphinx and written as patches.\n\nRelated to : #10637 (Implement sage -sws2rst) and #10652.\n\nI mentionned the idea on sage-devel in December 2010 [here](http://groups.google.com/group/sage-devel/browse_thread/thread/5d86874cd359e1a5/eda52be07a9fb994).\n\nIssue created by migration from https://trac.sagemath.org/ticket/11459\n\n",
    "created_at": "2011-06-10T15:54:43Z",
    "labels": [
        "notebook",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.1",
    "title": "Implement sage -rst2notebook",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11287",
    "user": "slabbe"
}
```
Assignee: slabbe

CC:  kcrisman kini jasonbhill

Convert a rst file into a notebook file (text file). 

The idea is that in general I wrote code using the Sage Code Convention where examples are formatted in ReST. Then converting rst examples to the notebook would be nice. Also, ReST file is more fun to edit than the html/cells notebook text file.

I implemented a script called `rst2notebook` available [on the Sage Combinat server](http://combinat.sagemath.org/hgwebdir.cgi/misc/file/ef17ccb37589/notebook2rst/).

In this script, I use docutils to translate a rst file into html file. From this, I convert blocks into cells. Note that I do not use sphinx so that not all usual Sage Rest syntax is working. But I am able to make math role work by adding dollar signs.

I am planning to make this script more clean during [Sage Days 31](http://wiki.sagemath.org/days31), I hope based on sphinx and written as patches.

Related to : #10637 (Implement sage -sws2rst) and #10652.

I mentionned the idea on sage-devel in December 2010 [here](http://groups.google.com/group/sage-devel/browse_thread/thread/5d86874cd359e1a5/eda52be07a9fb994).

Issue created by migration from https://trac.sagemath.org/ticket/11459





---

archive/issue_comments_124411.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd31, days31\".",
    "created_at": "2011-06-14T00:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124411",
    "user": "slabbe"
}
```

Changing keywords from "" to "sd31, days31".



---

archive/issue_comments_124412.json:
```json
{
    "body": "Maybe this should be rst2sws rather than rst2notebook?  By analogy with #10637 sws2rst.",
    "created_at": "2011-06-14T17:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124412",
    "user": "kcrisman"
}
```

Maybe this should be rst2sws rather than rst2notebook?  By analogy with #10637 sws2rst.



---

archive/issue_comments_124413.json:
```json
{
    "body": "Replying to [comment:2 kcrisman]:\n> Maybe this should be rst2sws rather than rst2notebook?  By analogy with #10637 sws2rst.\n\nBy rst2notebook, I mean something different. I mean the worksheet txt file which is made of html code and `{{{`'s cells. I agree rst2notebook is confusing. Maybe `sage -rst2worksheet_txt` would be better?\n\nBy the way, I also implemented the `sage -rst2sws`. I still need to add some doctests and do some more testing before it needs review. I hope to get to that point by wednesday.\n\nS\u00e9bastien",
    "created_at": "2011-06-15T10:08:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124413",
    "user": "slabbe"
}
```

Replying to [comment:2 kcrisman]:
> Maybe this should be rst2sws rather than rst2notebook?  By analogy with #10637 sws2rst.

By rst2notebook, I mean something different. I mean the worksheet txt file which is made of html code and `{{{`'s cells. I agree rst2notebook is confusing. Maybe `sage -rst2worksheet_txt` would be better?

By the way, I also implemented the `sage -rst2sws`. I still need to add some doctests and do some more testing before it needs review. I hope to get to that point by wednesday.

SÃ©bastien



---

archive/issue_comments_124414.json:
```json
{
    "body": "Replying to [comment:3 slabbe]:\n> Replying to [comment:2 kcrisman]:\n> > Maybe this should be rst2sws rather than rst2notebook?  By analogy with #10637 sws2rst.\n> \n> By rst2notebook, I mean something different. I mean the worksheet txt file which is made of html code and `{{{`'s cells. I agree rst2notebook is confusing. Maybe `sage -rst2worksheet_txt` would be better?\n\nHmm, or something like that.  That is really long.  But rst2worksheet would be misleading as well, so maybe that's the best option.\n\nWhat about rst2txt?\n\n> By the way, I also implemented the `sage -rst2sws`. I still need to add some doctests and do some more testing before it needs review. I hope to get to that point by wednesday.\n\nGreat! Except for the fact that I usually need to go the other direction - but of course those are also appearing.",
    "created_at": "2011-06-15T16:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124414",
    "user": "kcrisman"
}
```

Replying to [comment:3 slabbe]:
> Replying to [comment:2 kcrisman]:
> > Maybe this should be rst2sws rather than rst2notebook?  By analogy with #10637 sws2rst.
> 
> By rst2notebook, I mean something different. I mean the worksheet txt file which is made of html code and `{{{`'s cells. I agree rst2notebook is confusing. Maybe `sage -rst2worksheet_txt` would be better?

Hmm, or something like that.  That is really long.  But rst2worksheet would be misleading as well, so maybe that's the best option.

What about rst2txt?

> By the way, I also implemented the `sage -rst2sws`. I still need to add some doctests and do some more testing before it needs review. I hope to get to that point by wednesday.

Great! Except for the fact that I usually need to go the other direction - but of course those are also appearing.



---

archive/issue_comments_124415.json:
```json
{
    "body": "> What about rst2txt?\n\nWell, at first, I excluded that because txt extension are often used for  writing ReST files. But, on the other hand, when one uploads a file  having a `.txt` extension from the notebook, it is assume to be  that worksheet txt file made of html code and triple braces cells. So I  think you are right. rst2txt is a good suggestion. Thank you!\n\n\n\n> > By the way, I also implemented the `sage -rst2sws`. I still need to add some doctests and do some more testing before it needs review. I hope to get to that point by wednesday.\n> Great! Except for the fact that I usually need to go the other direction - but of course those are also appearing.\n\nWhy BTW? I feel I am the only one that needs more the rst -> sws  way?! I write all my examples in ReST syntax in my personal code, that  might be why.",
    "created_at": "2011-06-15T17:19:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124415",
    "user": "slabbe"
}
```

> What about rst2txt?

Well, at first, I excluded that because txt extension are often used for  writing ReST files. But, on the other hand, when one uploads a file  having a `.txt` extension from the notebook, it is assume to be  that worksheet txt file made of html code and triple braces cells. So I  think you are right. rst2txt is a good suggestion. Thank you!



> > By the way, I also implemented the `sage -rst2sws`. I still need to add some doctests and do some more testing before it needs review. I hope to get to that point by wednesday.
> Great! Except for the fact that I usually need to go the other direction - but of course those are also appearing.

Why BTW? I feel I am the only one that needs more the rst -> sws  way?! I write all my examples in ReST syntax in my personal code, that  might be why.



---

archive/issue_comments_124416.json:
```json
{
    "body": "Attachment [trac11459_rst2notebook_sagenb-sl.patch](tarball://root/attachments/some-uuid/ticket11459/trac11459_rst2notebook_sagenb-sl.patch) by slabbe created at 2011-06-18 04:00:52\n\nApplies on the new flask sagenb repository",
    "created_at": "2011-06-18T04:00:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124416",
    "user": "slabbe"
}
```

Attachment [trac11459_rst2notebook_sagenb-sl.patch](tarball://root/attachments/some-uuid/ticket11459/trac11459_rst2notebook_sagenb-sl.patch) by slabbe created at 2011-06-18 04:00:52

Applies on the new flask sagenb repository



---

archive/issue_comments_124417.json:
```json
{
    "body": "I'm testing this, but I wanted to give others a heads-up on something. (Maybe Kini can shed some light on this from the hg side of things.)\n\nI'm currently using the flask repo (the ~official~ one...) and have a symlink redirecting devel/sagenb->flask. The path for various diffs in this patch should be following that sagenb symlink, but they're following my sage->sage-main (or whatever clone I'm working in) repo instead.",
    "created_at": "2011-06-21T01:26:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124417",
    "user": "jasonbhill"
}
```

I'm testing this, but I wanted to give others a heads-up on something. (Maybe Kini can shed some light on this from the hg side of things.)

I'm currently using the flask repo (the ~official~ one...) and have a symlink redirecting devel/sagenb->flask. The path for various diffs in this patch should be following that sagenb symlink, but they're following my sage->sage-main (or whatever clone I'm working in) repo instead.



---

archive/issue_comments_124418.json:
```json
{
    "body": "The root of the sagenb repository is *in* your `devel/sagenb`, i.e. already beyond the symlink. The paths should have nothing to do with that (and look fine to me fwiw). Are you applying it in the right place?",
    "created_at": "2011-06-21T02:08:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124418",
    "user": "kini"
}
```

The root of the sagenb repository is *in* your `devel/sagenb`, i.e. already beyond the symlink. The paths should have nothing to do with that (and look fine to me fwiw). Are you applying it in the right place?



---

archive/issue_comments_124419.json:
```json
{
    "body": "Yup... \"sagenb\" and \"sage\" are the two symlinks in devel. All of my patches are attempting to following the latter. \n\nI'm using hg_sage.apply(\"address\"). My usual workflow is to create a clone, build into that clone, then apply any patches. This has always worked, but then again I am always working under the \"sage\" symlink. But, in this situation the patch (regardless of branch) is attempting to apply in \"devel/sage->my_\".\n\nHow might one apply this otherwise ... in a specific location?",
    "created_at": "2011-06-21T02:27:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124419",
    "user": "jasonbhill"
}
```

Yup... "sagenb" and "sage" are the two symlinks in devel. All of my patches are attempting to following the latter. 

I'm using hg_sage.apply("address"). My usual workflow is to create a clone, build into that clone, then apply any patches. This has always worked, but then again I am always working under the "sage" symlink. But, in this situation the patch (regardless of branch) is attempting to apply in "devel/sage->my_".

How might one apply this otherwise ... in a specific location?



---

archive/issue_comments_124420.json:
```json
{
    "body": "Ah. Use `hg_sagenb` instead of `hg_sage` - try tab completing `hg_` in the Sage console to see the list of repositories you have access to. `hg_sage` is the Sage library, `hg_sagenb` is the notebook, `hg_extcode` seems to be for the interfaces to other software, `hg_scripts` is for the sage command line tools and related stuff, `hg_root` is for some miscellaneous \"top-level\" stuff.\n\nI would personally recommend using Mercurial from the command line, though - it allows you to see what you are doing more precisely, where patches are going exactly, etc.",
    "created_at": "2011-06-21T03:14:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124420",
    "user": "kini"
}
```

Ah. Use `hg_sagenb` instead of `hg_sage` - try tab completing `hg_` in the Sage console to see the list of repositories you have access to. `hg_sage` is the Sage library, `hg_sagenb` is the notebook, `hg_extcode` seems to be for the interfaces to other software, `hg_scripts` is for the sage command line tools and related stuff, `hg_root` is for some miscellaneous "top-level" stuff.

I would personally recommend using Mercurial from the command line, though - it allows you to see what you are doing more precisely, where patches are going exactly, etc.



---

archive/issue_comments_124421.json:
```json
{
    "body": "To be precise, `hg_sage` points to `devel/sage`, `hg_sagenb` points to `devel/sagenb`, `hg_extcode` points to `data/extcode`, and `hg_scripts` points to `local/bin`, if you want to go exploring. Using `sage -clone` and `sage -b <branchname>` only apply to `devel/sage` - other repositories are left uncloned and unmodified.\n\nBy the way, you might consider dropping by [IRC](http://sagemath.org/help-irc.html) to talk about these things in realtime instead of posting to this trac ticket, as this is getting quite off-topic... :)",
    "created_at": "2011-06-21T03:21:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124421",
    "user": "kini"
}
```

To be precise, `hg_sage` points to `devel/sage`, `hg_sagenb` points to `devel/sagenb`, `hg_extcode` points to `data/extcode`, and `hg_scripts` points to `local/bin`, if you want to go exploring. Using `sage -clone` and `sage -b <branchname>` only apply to `devel/sage` - other repositories are left uncloned and unmodified.

By the way, you might consider dropping by [IRC](http://sagemath.org/help-irc.html) to talk about these things in realtime instead of posting to this trac ticket, as this is getting quite off-topic... :)



---

archive/issue_comments_124422.json:
```json
{
    "body": "Salut!\n\nJust to give an update about the status of the patches on this ticket :\n\n1. trac11459_rst2notebook_sagenb-sl.patch : I was not able to export the patch once I qfinish it and pushed it on my branch on the sagenb google code. Hence, the patch available here do not have the very last modification I did just before I made qfinish. So if you are testing it, it would be better if you test my sagenb branch. Anyhow, I do not intend to change my sagenb branch. I believe it is ready for review.\n\nQuestion for kini : How can I export the patch once it is qfinished (commited) so that I upload here the latest version?\n\n2. trac11459_rst2notebook_localbin-sl.patch : The script needs work. I want to implement better options about escaping backslashes. I should be able to finish this in the next days during the week. Once this is done, I will change the status of this ticket to needs review.\n\nS\u00e9bastien",
    "created_at": "2011-06-21T15:46:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124422",
    "user": "slabbe"
}
```

Salut!

Just to give an update about the status of the patches on this ticket :

1. trac11459_rst2notebook_sagenb-sl.patch : I was not able to export the patch once I qfinish it and pushed it on my branch on the sagenb google code. Hence, the patch available here do not have the very last modification I did just before I made qfinish. So if you are testing it, it would be better if you test my sagenb branch. Anyhow, I do not intend to change my sagenb branch. I believe it is ready for review.

Question for kini : How can I export the patch once it is qfinished (commited) so that I upload here the latest version?

2. trac11459_rst2notebook_localbin-sl.patch : The script needs work. I want to implement better options about escaping backslashes. I should be able to finish this in the next days during the week. Once this is done, I will change the status of this ticket to needs review.

SÃ©bastien



---

archive/issue_comments_124423.json:
```json
{
    "body": "You can turn committed changes back into patches with `hg qimport -r tip` if you want. If you want to leave them committed but export a patch, use `hg export tip > file.patch`. (don't forget to put \"[diff]\\ngit=yes\" in your `~/.hgrc`.)",
    "created_at": "2011-06-21T17:18:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124423",
    "user": "kini"
}
```

You can turn committed changes back into patches with `hg qimport -r tip` if you want. If you want to leave them committed but export a patch, use `hg export tip > file.patch`. (don't forget to put "[diff]\ngit=yes" in your `~/.hgrc`.)



---

archive/issue_comments_124424.json:
```json
{
    "body": "> Hence, the patch available here do not have the very last modification I did just before I made qfinish.\n\nIt was not true finally. The patch trac11459_rst2notebook_sagenb-sl.patch available here contains the very last modifications.",
    "created_at": "2011-06-22T14:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124424",
    "user": "slabbe"
}
```

> Hence, the patch available here do not have the very last modification I did just before I made qfinish.

It was not true finally. The patch trac11459_rst2notebook_sagenb-sl.patch available here contains the very last modifications.



---

archive/issue_comments_124425.json:
```json
{
    "body": "Attachment [trac11459_rst2notebook_localbin-sl.patch](tarball://root/attachments/some-uuid/ticket11459/trac11459_rst2notebook_localbin-sl.patch) by slabbe created at 2011-06-22 14:42:21\n\nApplies in the local/bin repository",
    "created_at": "2011-06-22T14:42:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124425",
    "user": "slabbe"
}
```

Attachment [trac11459_rst2notebook_localbin-sl.patch](tarball://root/attachments/some-uuid/ticket11459/trac11459_rst2notebook_localbin-sl.patch) by slabbe created at 2011-06-22 14:42:21

Applies in the local/bin repository



---

archive/issue_comments_124426.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-06-22T14:44:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124426",
    "user": "slabbe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_124427.json:
```json
{
    "body": "I finished working on the `local/bin` scripts and just re-uploaded the patch.\n\nNow needs review!",
    "created_at": "2011-06-22T14:44:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124427",
    "user": "slabbe"
}
```

I finished working on the `local/bin` scripts and just re-uploaded the patch.

Now needs review!



---

archive/issue_comments_124428.json:
```json
{
    "body": "Attachment [trac_11459-root.patch](tarball://root/attachments/some-uuid/ticket11459/trac_11459-root.patch) by kini created at 2012-05-16 14:31:34\n\napply to $SAGE_ROOT",
    "created_at": "2012-05-16T14:31:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124428",
    "user": "kini"
}
```

Attachment [trac_11459-root.patch](tarball://root/attachments/some-uuid/ticket11459/trac_11459-root.patch) by kini created at 2012-05-16 14:31:34

apply to $SAGE_ROOT



---

archive/issue_comments_124429.json:
```json
{
    "body": "Attachment [trac_11459-scripts.patch](tarball://root/attachments/some-uuid/ticket11459/trac_11459-scripts.patch) by kini created at 2012-05-16 14:32:08\n\napply to $SAGE_LOCAL/bin",
    "created_at": "2012-05-16T14:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124429",
    "user": "kini"
}
```

Attachment [trac_11459-scripts.patch](tarball://root/attachments/some-uuid/ticket11459/trac_11459-scripts.patch) by kini created at 2012-05-16 14:32:08

apply to $SAGE_LOCAL/bin



---

archive/issue_comments_124430.json:
```json
{
    "body": "Hi Sebastien,\n\nI've rebased the scripts patch to Sage 5.0. Because the file formerly at `$SAGE_LOCAL/bin/sage-sage` is now at `$SAGE_ROOT/spkg/bin/sage`, it had to be split into two patches.\n\nThe notebook patch will probably need to be rebased as well, but since we're doing development of sagenb on github now, it won't go here on trac. I'll see what I can do...",
    "created_at": "2012-05-16T14:37:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124430",
    "user": "kini"
}
```

Hi Sebastien,

I've rebased the scripts patch to Sage 5.0. Because the file formerly at `$SAGE_LOCAL/bin/sage-sage` is now at `$SAGE_ROOT/spkg/bin/sage`, it had to be split into two patches.

The notebook patch will probably need to be rebased as well, but since we're doing development of sagenb on github now, it won't go here on trac. I'll see what I can do...



---

archive/issue_comments_124431.json:
```json
{
    "body": "Never mind, it looks like you [already got that code into sagenb](https://github.com/sagemath/sagenb/commit/44733a2965e89e43a28431cb46eca38108771a3c) after all.",
    "created_at": "2012-05-17T12:21:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124431",
    "user": "kini"
}
```

Never mind, it looks like you [already got that code into sagenb](https://github.com/sagemath/sagenb/commit/44733a2965e89e43a28431cb46eca38108771a3c) after all.



---

archive/issue_comments_124432.json:
```json
{
    "body": "whoops",
    "created_at": "2012-05-17T12:21:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124432",
    "user": "kini"
}
```

whoops



---

archive/issue_comments_124433.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-05-25T20:51:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124433",
    "user": "kini"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_124434.json:
```json
{
    "body": "So here is a reviewer patch, and positive review for this ticket. Everything looks good to me.",
    "created_at": "2012-05-25T20:51:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124434",
    "user": "kini"
}
```

So here is a reviewer patch, and positive review for this ticket. Everything looks good to me.



---

archive/issue_comments_124435.json:
```json
{
    "body": "Changing keywords from \"sd31, days31\" to \"sd31, days31, sd40.5\".",
    "created_at": "2012-05-25T20:51:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124435",
    "user": "kini"
}
```

Changing keywords from "sd31, days31" to "sd31, days31, sd40.5".



---

archive/issue_comments_124436.json:
```json
{
    "body": "Changing keywords from \"sd31, days31, sd40.5\" to \"sd31 days31 sd40.5\".",
    "created_at": "2012-05-25T20:51:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124436",
    "user": "kini"
}
```

Changing keywords from "sd31, days31, sd40.5" to "sd31 days31 sd40.5".



---

archive/issue_comments_124437.json:
```json
{
    "body": "apply to $SAGE_ROOT",
    "created_at": "2012-05-25T21:11:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124437",
    "user": "kini"
}
```

apply to $SAGE_ROOT



---

archive/issue_comments_124438.json:
```json
{
    "body": "Attachment [trac_11459-root.reviewer.patch](tarball://root/attachments/some-uuid/ticket11459/trac_11459-root.reviewer.patch) by kini created at 2012-05-25 21:13:08\n\nWhoops, forgot the other reviewer patch...",
    "created_at": "2012-05-25T21:13:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124438",
    "user": "kini"
}
```

Attachment [trac_11459-root.reviewer.patch](tarball://root/attachments/some-uuid/ticket11459/trac_11459-root.reviewer.patch) by kini created at 2012-05-25 21:13:08

Whoops, forgot the other reviewer patch...



---

archive/issue_comments_124439.json:
```json
{
    "body": "Hi Kini,\n\nThanks for looking at this!\n\nI remember I wanted to remove the guillemets (\") in the line of documentation of both scripts:\n\n\"..  escape-backslashes\" \n\nCan you update your patch to do it, if you agree? I am sorry I never did it...\n\nIs the new notebook now part of Sage ? If I want to test this ticket, should I install the latest sage-alpha or should I install the new sage-notebook?\n\nS\u00e9bastien",
    "created_at": "2012-05-25T22:27:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124439",
    "user": "slabbe"
}
```

Hi Kini,

Thanks for looking at this!

I remember I wanted to remove the guillemets (") in the line of documentation of both scripts:

"..  escape-backslashes" 

Can you update your patch to do it, if you agree? I am sorry I never did it...

Is the new notebook now part of Sage ? If I want to test this ticket, should I install the latest sage-alpha or should I install the new sage-notebook?

SÃ©bastien



---

archive/issue_comments_124440.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-05-25T23:35:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124440",
    "user": "kini"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_124441.json:
```json
{
    "body": "OK, I'll do it, and I'll also modify the file `sage-rst2txt` which I completely overlooked...!\n\nThe new notebook is not part of Sage yet (though it finally got positive review a couple of hours ago - #11080). If you want to test the ticket, follow the instructions on #11080 to install the new notebook first.",
    "created_at": "2012-05-25T23:35:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124441",
    "user": "kini"
}
```

OK, I'll do it, and I'll also modify the file `sage-rst2txt` which I completely overlooked...!

The new notebook is not part of Sage yet (though it finally got positive review a couple of hours ago - #11080). If you want to test the ticket, follow the instructions on #11080 to install the new notebook first.



---

archive/issue_comments_124442.json:
```json
{
    "body": "apply to $SAGE_LOCAL/bin",
    "created_at": "2012-05-25T23:46:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124442",
    "user": "kini"
}
```

apply to $SAGE_LOCAL/bin



---

archive/issue_comments_124443.json:
```json
{
    "body": "Attachment [trac_11459-scripts.reviewer.patch](tarball://root/attachments/some-uuid/ticket11459/trac_11459-scripts.reviewer.patch) by kini created at 2012-05-25 23:46:40\n\nOK, there we go.",
    "created_at": "2012-05-25T23:46:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124443",
    "user": "kini"
}
```

Attachment [trac_11459-scripts.reviewer.patch](tarball://root/attachments/some-uuid/ticket11459/trac_11459-scripts.reviewer.patch) by kini created at 2012-05-25 23:46:40

OK, there we go.



---

archive/issue_comments_124444.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-05-25T23:46:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124444",
    "user": "kini"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_124445.json:
```json
{
    "body": "Thanks for the review Keshav!",
    "created_at": "2012-05-29T13:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124445",
    "user": "slabbe"
}
```

Thanks for the review Keshav!



---

archive/issue_comments_124446.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-06-02T12:10:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124446",
    "user": "jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_124447.json:
```json
{
    "body": "Hi!  I'm trying to get #10637 (the other direction) in shape for positive review, and I notice there are no patches here documenting in the Sage library how to use this.  I guess that's because they just make text and sws.  Was there any place that you would think would be natural, other than `sage -advanced`?",
    "created_at": "2012-06-21T16:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124447",
    "user": "kcrisman"
}
```

Hi!  I'm trying to get #10637 (the other direction) in shape for positive review, and I notice there are no patches here documenting in the Sage library how to use this.  I guess that's because they just make text and sws.  Was there any place that you would think would be natural, other than `sage -advanced`?



---

archive/issue_comments_124448.json:
```json
{
    "body": "> Was there any place that you would think would be natural, other than sage -advanced?\n\nNote: There is some documentation in `sage -rst2sws -h` as well.\n\nIt would be a good idea to add documentation somewhere in the Sage reference manual. Where are the other sage-scripts documented?",
    "created_at": "2012-06-21T18:17:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124448",
    "user": "slabbe"
}
```

> Was there any place that you would think would be natural, other than sage -advanced?

Note: There is some documentation in `sage -rst2sws -h` as well.

It would be a good idea to add documentation somewhere in the Sage reference manual. Where are the other sage-scripts documented?



---

archive/issue_comments_124449.json:
```json
{
    "body": "My sense is that they are not.\n\nOkay, I'll look at your script and see how you implement that, then do that at #10637.  That would suffice for the purposes there.\n\nDo you want to open another ticket to document (at least some) of the scripts in the usual reference manual?",
    "created_at": "2012-06-21T18:39:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124449",
    "user": "kcrisman"
}
```

My sense is that they are not.

Okay, I'll look at your script and see how you implement that, then do that at #10637.  That would suffice for the purposes there.

Do you want to open another ticket to document (at least some) of the scripts in the usual reference manual?



---

archive/issue_comments_124450.json:
```json
{
    "body": "By the way, not that you have to deal with this now, see [http://docs.python.org/library/optparse.html](http://docs.python.org/library/optparse.html):\n\n```\nDeprecated since version 2.7: The optparse module is deprecated and will not be developed further; \ndevelopment will continue with the argparse module.\n```\n\nOh well.",
    "created_at": "2012-06-21T19:00:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124450",
    "user": "kcrisman"
}
```

By the way, not that you have to deal with this now, see [http://docs.python.org/library/optparse.html](http://docs.python.org/library/optparse.html):

```
Deprecated since version 2.7: The optparse module is deprecated and will not be developed further; 
development will continue with the argparse module.
```

Oh well.



---

archive/issue_comments_124451.json:
```json
{
    "body": "This \"depends\" on #11080 but somehow got merged anyway.",
    "created_at": "2012-07-23T06:59:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124451",
    "user": "jdemeyer"
}
```

This "depends" on #11080 but somehow got merged anyway.



---

archive/issue_comments_124452.json:
```json
{
    "body": "Replying to [comment:38 jdemeyer]:\n> This \"depends\" on #11080 but somehow got merged anyway.\n\nIt depends on code written in the new sagenb indeed. That means the script won't work on sage-5.1 : it will get an import error I would guess. The thing is that there is no test for the script... so you could not see that the script was broken without #11080. Or worse, in the future, if a patch on sagenb breaks the script, we won't know it. How should a script be doctested?",
    "created_at": "2012-07-26T14:13:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124452",
    "user": "slabbe"
}
```

Replying to [comment:38 jdemeyer]:
> This "depends" on #11080 but somehow got merged anyway.

It depends on code written in the new sagenb indeed. That means the script won't work on sage-5.1 : it will get an import error I would guess. The thing is that there is no test for the script... so you could not see that the script was broken without #11080. Or worse, in the future, if a patch on sagenb breaks the script, we won't know it. How should a script be doctested?



---

archive/issue_comments_124453.json:
```json
{
    "body": "The part of the script which depends on the new sagenb is the following :\n\n\n```python\n# Do the translation html -> worksheet txt \nfrom sagenb.notebook.docHTMLProcessor import docutilsHTMLProcessor \ntranslator = docutilsHTMLProcessor() \nworksheet_txt = translator.process_doc_html(html) \n \n# create a Notebook \nfrom sagenb.notebook.notebook import Notebook \nfrom sage.misc.misc import tmp_dir \nnb = Notebook(tmp_dir()+'.sagenb') \n \n# create a worksheet \nW = nb.create_new_worksheet(title, 'admin') \nW.edit_save(worksheet_txt) \n \n# export the worksheet as sws \nnb.export_worksheet(W.filename(), output, title=title) \n \n# delete the Notebook \nnb.delete() \n```\n\n\nIs it possible that such code get broken in future version of sagenb?",
    "created_at": "2012-07-26T14:22:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124453",
    "user": "slabbe"
}
```

The part of the script which depends on the new sagenb is the following :


```python
# Do the translation html -> worksheet txt 
from sagenb.notebook.docHTMLProcessor import docutilsHTMLProcessor 
translator = docutilsHTMLProcessor() 
worksheet_txt = translator.process_doc_html(html) 
 
# create a Notebook 
from sagenb.notebook.notebook import Notebook 
from sage.misc.misc import tmp_dir 
nb = Notebook(tmp_dir()+'.sagenb') 
 
# create a worksheet 
W = nb.create_new_worksheet(title, 'admin') 
W.edit_save(worksheet_txt) 
 
# export the worksheet as sws 
nb.export_worksheet(W.filename(), output, title=title) 
 
# delete the Notebook 
nb.delete() 
```


Is it possible that such code get broken in future version of sagenb?



---

archive/issue_comments_124454.json:
```json
{
    "body": "Replying to [comment:39 slabbe]:\n> How should a script be doctested?\nYou can have a look at `sage/tests/cmdline.py` for many examples.\n\nIn any case, such a test should be the subject of a new ticket.",
    "created_at": "2012-07-26T14:38:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124454",
    "user": "jdemeyer"
}
```

Replying to [comment:39 slabbe]:
> How should a script be doctested?
You can have a look at `sage/tests/cmdline.py` for many examples.

In any case, such a test should be the subject of a new ticket.



---

archive/issue_comments_124455.json:
```json
{
    "body": "> In any case, such a test should be the subject of a new ticket.\n\nThis is now #13297.",
    "created_at": "2012-07-26T16:14:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11287",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11287#issuecomment-124455",
    "user": "slabbe"
}
```

> In any case, such a test should be the subject of a new ticket.

This is now #13297.
