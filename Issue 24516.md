# Issue 24516: py3: fixes to sage.repl.rich_output

archive/issues_024516.json:
```json
{
    "body": "Fixes most/all bytes/str issues in `sage.repl.rich_output`.  In particular, this is an important counterpart to #24343, since without it most tests fail trivially due to incorrect treatment of bytes in the doctest output backend.\n\nThe most significant change in this branch is the addition of a new method: `OutputBuffer.get_str()`.  This is plays a similar role to `bytes_to_str`, in that on Python 2 it is equivalent to `OutputBuffer.get()`, and on Python 3 it is equivalent to `OutputBuffer.get_unicode()`.  In order for this code to work consistently across Python 2 and Python 3, most places that called `OutputBuffer.get()` are changed to use `OutputBuffer.get_str()` (except for some cases where we explicitly want `bytes` output, such as with binary data).\n\nI'm happy to split this change off to a separate ticket from the other minor fixes if so demanded...\n\nIssue created by migration from https://trac.sagemath.org/ticket/24753\n\n",
    "created_at": "2018-02-16T13:54:47Z",
    "labels": [
        "python3",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "py3: fixes to sage.repl.rich_output",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24516",
    "user": "embray"
}
```
Fixes most/all bytes/str issues in `sage.repl.rich_output`.  In particular, this is an important counterpart to #24343, since without it most tests fail trivially due to incorrect treatment of bytes in the doctest output backend.

The most significant change in this branch is the addition of a new method: `OutputBuffer.get_str()`.  This is plays a similar role to `bytes_to_str`, in that on Python 2 it is equivalent to `OutputBuffer.get()`, and on Python 3 it is equivalent to `OutputBuffer.get_unicode()`.  In order for this code to work consistently across Python 2 and Python 3, most places that called `OutputBuffer.get()` are changed to use `OutputBuffer.get_str()` (except for some cases where we explicitly want `bytes` output, such as with binary data).

I'm happy to split this change off to a separate ticket from the other minor fixes if so demanded...

Issue created by migration from https://trac.sagemath.org/ticket/24753





---

archive/issue_comments_343991.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-02-16T13:54:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24516#issuecomment-343991",
    "user": "embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_343992.json:
```json
{
    "body": "looks ok to me",
    "created_at": "2018-02-26T13:23:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24516#issuecomment-343992",
    "user": "chapoton"
}
```

looks ok to me



---

archive/issue_comments_343993.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-02-26T13:23:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24516#issuecomment-343993",
    "user": "chapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_343994.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-03-04T23:28:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24516#issuecomment-343994",
    "user": "vbraun"
}
```

Resolution: fixed
