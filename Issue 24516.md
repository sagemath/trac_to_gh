# Issue 24516: py3: fixes to sage.repl.rich_output

Issue created by migration from Trac.

Original creator: embray

Original creation time: 2018-02-16 13:54:47

Fixes most/all bytes/str issues in `sage.repl.rich_output`.  In particular, this is an important counterpart to #24343, since without it most tests fail trivially due to incorrect treatment of bytes in the doctest output backend.

The most significant change in this branch is the addition of a new method: `OutputBuffer.get_str()`.  This is plays a similar role to `bytes_to_str`, in that on Python 2 it is equivalent to `OutputBuffer.get()`, and on Python 3 it is equivalent to `OutputBuffer.get_unicode()`.  In order for this code to work consistently across Python 2 and Python 3, most places that called `OutputBuffer.get()` are changed to use `OutputBuffer.get_str()` (except for some cases where we explicitly want `bytes` output, such as with binary data).

I'm happy to split this change off to a separate ticket from the other minor fixes if so demanded...


---

Comment by embray created at 2018-02-16 13:54:56

Changing status from new to needs_review.


---

Comment by chapoton created at 2018-02-26 13:23:14

looks ok to me


---

Comment by chapoton created at 2018-02-26 13:23:14

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-03-04 23:28:53

Resolution: fixed
