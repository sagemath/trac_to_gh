# Issue 28879: affine_basis does not always work when used with orthogonal or orthonormal

Issue created by migration from https://trac.sagemath.org/ticket/29116

Original creator: @LaisRast

Original creation time: 2020-01-31 09:27:38

CC:  jipilab @kliem

Keywords: polytopes, affine_hull

When using `affine_basis` of `Polyhedron` with `orthogonal` or `orthonormal` we get the following errors.

```
sage: V =[
....:    [1, 0, -1, 0, 0],
....:    [1, 0, 0, -1, 0],
....:    [1, 0, 0, 0, -1],
....:    [1, 0, 0, +1, 0],
....:    [1, 0, 0, 0, +1],
....:    [1, +1, 0, 0, 0]
....:     ]
sage: P = Polyhedron(V)
sage: P.affine_hull()
A 4-dimensional polyhedron in ZZ^4 defined as the convex hull of 6 vertices
```


```
sage: P.affine_hull(orthogonal=True) 
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
...
ValueError: V-representation data requires a list of length ambient_dim
```


```
sage: P.affine_hull(orthonormal=True, extend=True)
A 4-dimensional polyhedron in AA^4 defined as the convex hull of 5 vertices and 1 line
```



This happens because the method for computing an affine basis depends on the order of the vertices. We fix that by computing an affine basis of the polyhedron in the right way.


---

Comment by @kliem created at 2020-01-31 22:13:41

New commits:


---

Comment by @kliem created at 2020-01-31 22:13:41

Changing status from new to needs_review.


---

Comment by @kliem created at 2020-02-19 08:28:20

New commits:


---

Comment by @LaisRast created at 2020-02-28 10:46:14

Changing status from needs_review to positive_review.


---

Comment by @LaisRast created at 2020-02-28 10:46:14

Since #29127 is on "positive review", I think this one also should be on "positive review".
It looks good to me.
(pycodestyle warnings are not sourced from her)


---

Comment by @LaisRast created at 2020-02-28 10:48:06

I forgot to mention:

```diff
-            # We implicitely translate the first vertex of the affine basis to zero.
+            # We implicitly translate the first vertex of the affine basis to zero.
```



---

Comment by git created at 2020-02-28 10:51:04

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by git created at 2020-02-28 10:51:04

Changing status from positive_review to needs_review.


---

Comment by @LaisRast created at 2020-02-28 14:11:16

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-03-01 23:46:00

Resolution: fixed
