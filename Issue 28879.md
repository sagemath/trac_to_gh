# Issue 28879: affine_basis does not always work when used with orthogonal or orthonormal

archive/issues_028879.json:
```json
{
    "body": "CC:  @jplab @kliem\n\nKeywords: polytopes, affine_hull\n\nWhen using `affine_basis` of `Polyhedron` with `orthogonal` or `orthonormal` we get the following errors.\n\n```\nsage: V =[\n....:    [1, 0, -1, 0, 0],\n....:    [1, 0, 0, -1, 0],\n....:    [1, 0, 0, 0, -1],\n....:    [1, 0, 0, +1, 0],\n....:    [1, 0, 0, 0, +1],\n....:    [1, +1, 0, 0, 0]\n....:     ]\nsage: P = Polyhedron(V)\nsage: P.affine_hull()\nA 4-dimensional polyhedron in ZZ^4 defined as the convex hull of 6 vertices\n```\n\n\n```\nsage: P.affine_hull(orthogonal=True) \n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n...\nValueError: V-representation data requires a list of length ambient_dim\n```\n\n\n```\nsage: P.affine_hull(orthonormal=True, extend=True)\nA 4-dimensional polyhedron in AA^4 defined as the convex hull of 5 vertices and 1 line\n```\n\n\n\nThis happens because the method for computing an affine basis depends on the order of the vertices. We fix that by computing an affine basis of the polyhedron in the right way.\n\nIssue created by migration from https://trac.sagemath.org/ticket/29116\n\n",
    "created_at": "2020-01-31T09:27:38Z",
    "labels": [
        "component: geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "affine_basis does not always work when used with orthogonal or orthonormal",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28879",
    "user": "https://github.com/LaisRast"
}
```
CC:  @jplab @kliem

Keywords: polytopes, affine_hull

When using `affine_basis` of `Polyhedron` with `orthogonal` or `orthonormal` we get the following errors.

```
sage: V =[
....:    [1, 0, -1, 0, 0],
....:    [1, 0, 0, -1, 0],
....:    [1, 0, 0, 0, -1],
....:    [1, 0, 0, +1, 0],
....:    [1, 0, 0, 0, +1],
....:    [1, +1, 0, 0, 0]
....:     ]
sage: P = Polyhedron(V)
sage: P.affine_hull()
A 4-dimensional polyhedron in ZZ^4 defined as the convex hull of 6 vertices
```


```
sage: P.affine_hull(orthogonal=True) 
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
...
ValueError: V-representation data requires a list of length ambient_dim
```


```
sage: P.affine_hull(orthonormal=True, extend=True)
A 4-dimensional polyhedron in AA^4 defined as the convex hull of 5 vertices and 1 line
```



This happens because the method for computing an affine basis depends on the order of the vertices. We fix that by computing an affine basis of the polyhedron in the right way.

Issue created by migration from https://trac.sagemath.org/ticket/29116





---

archive/issue_comments_408355.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-01-31T22:13:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28879",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28879#issuecomment-408355",
    "user": "https://github.com/kliem"
}
```

New commits:



---

archive/issue_comments_408356.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-01-31T22:13:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28879",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28879#issuecomment-408356",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_408357.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-02-19T08:28:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28879",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28879#issuecomment-408357",
    "user": "https://github.com/kliem"
}
```

New commits:



---

archive/issue_comments_408358.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-02-28T10:46:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28879",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28879#issuecomment-408358",
    "user": "https://github.com/LaisRast"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_408359.json:
```json
{
    "body": "Since #29127 is on \"positive review\", I think this one also should be on \"positive review\".\nIt looks good to me.\n(pycodestyle warnings are not sourced from her)",
    "created_at": "2020-02-28T10:46:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28879",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28879#issuecomment-408359",
    "user": "https://github.com/LaisRast"
}
```

Since #29127 is on "positive review", I think this one also should be on "positive review".
It looks good to me.
(pycodestyle warnings are not sourced from her)



---

archive/issue_comments_408360.json:
```json
{
    "body": "I forgot to mention:\n\n```diff\n-            # We implicitely translate the first vertex of the affine basis to zero.\n+            # We implicitly translate the first vertex of the affine basis to zero.\n```\n",
    "created_at": "2020-02-28T10:48:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28879",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28879#issuecomment-408360",
    "user": "https://github.com/LaisRast"
}
```

I forgot to mention:

```diff
-            # We implicitely translate the first vertex of the affine basis to zero.
+            # We implicitly translate the first vertex of the affine basis to zero.
```




---

archive/issue_comments_408361.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2020-02-28T10:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28879",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28879#issuecomment-408361",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_408362.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-02-28T10:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28879",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28879#issuecomment-408362",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_408363.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-02-28T14:11:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28879",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28879#issuecomment-408363",
    "user": "https://github.com/LaisRast"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_026709.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-03-01T23:46:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28879",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28879#event-26709"
}
```



---

archive/issue_comments_408364.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-03-01T23:46:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28879",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28879#issuecomment-408364",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
