# Issue 13484: FiniteEnumeratedSets cardinality override

archive/issues_013484.json:
```json
{
    "body": "Assignee: sage-combinat\n\nCC:  nthiery andrew.mathas sage-combinat\n\nKeywords: finite sets, category, cardinality\n\nRight now the category `FiniteEnumeratedSets` overrides a parent class's `cardinality()` when creating a list. Below is a minimal example of this behavior:\n\n```\nfrom sage.structure.parent import Parent\nfrom sage.categories.finite_enumerated_sets import FiniteEnumeratedSets\n\nclass TestParent(Parent):\n    def __init__(self):\n        Parent.__init__(self, category=FiniteEnumeratedSets())\n\n    def __iter__(self):\n        yield 1\n        return\n\n    def cardinality(self, n):\n        \"\"\"\n        EXAMPLES::\n\n            sage: P = sage.combinat.category_doctest_fail.TestParent()\n            sage: P.cardinality(-1)\n            -1\n            sage: v = P.list(); v\n            [1]\n            sage: len(v)\n            1\n            sage: P.cardinality()\n            1\n            sage: P.cardinality(-1) # This test breaks\n            -1\n        \"\"\"\n        return n\n```\n\n\nThis seems to be caused by not checking if the parent class has a `cardinality()` function implemented, and just overriding it with `_cardinality_from_list()` (which takes no [optional] parameters).\n\nIssue created by migration from https://trac.sagemath.org/ticket/13688\n\n",
    "created_at": "2012-11-05T22:53:15Z",
    "labels": [
        "categories",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.8",
    "title": "FiniteEnumeratedSets cardinality override",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13484",
    "user": "tscrim"
}
```
Assignee: sage-combinat

CC:  nthiery andrew.mathas sage-combinat

Keywords: finite sets, category, cardinality

Right now the category `FiniteEnumeratedSets` overrides a parent class's `cardinality()` when creating a list. Below is a minimal example of this behavior:

```
from sage.structure.parent import Parent
from sage.categories.finite_enumerated_sets import FiniteEnumeratedSets

class TestParent(Parent):
    def __init__(self):
        Parent.__init__(self, category=FiniteEnumeratedSets())

    def __iter__(self):
        yield 1
        return

    def cardinality(self, n):
        """
        EXAMPLES::

            sage: P = sage.combinat.category_doctest_fail.TestParent()
            sage: P.cardinality(-1)
            -1
            sage: v = P.list(); v
            [1]
            sage: len(v)
            1
            sage: P.cardinality()
            1
            sage: P.cardinality(-1) # This test breaks
            -1
        """
        return n
```


This seems to be caused by not checking if the parent class has a `cardinality()` function implemented, and just overriding it with `_cardinality_from_list()` (which takes no [optional] parameters).

Issue created by migration from https://trac.sagemath.org/ticket/13688





---

archive/issue_comments_166296.json:
```json
{
    "body": "Tweaked example to show we don't want to change the semantics of `cardinality()`.",
    "created_at": "2012-11-06T17:55:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13484",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13484#issuecomment-166296",
    "user": "tscrim"
}
```

Tweaked example to show we don't want to change the semantics of `cardinality()`.



---

archive/issue_comments_166297.json:
```json
{
    "body": "Patch which has `_cardinality_from_*` take dummy optional args and discard them.",
    "created_at": "2013-02-16T05:22:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13484",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13484#issuecomment-166297",
    "user": "tscrim"
}
```

Patch which has `_cardinality_from_*` take dummy optional args and discard them.



---

archive/issue_comments_166298.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-02-16T05:22:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13484",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13484#issuecomment-166298",
    "user": "tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_166299.json:
```json
{
    "body": "Changing keywords from \"finite sets, category, cardinality\" to \"finite sets, category, cardinality, days45\".",
    "created_at": "2013-02-20T03:28:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13484",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13484#issuecomment-166299",
    "user": "andrew.mathas"
}
```

Changing keywords from "finite sets, category, cardinality" to "finite sets, category, cardinality, days45".



---

archive/issue_comments_166300.json:
```json
{
    "body": "The patch is quite innocuous and fixes a problem. All doc tests pass. \n\nCan you add a doctest for testing for this? Presumably it showed up in a real class. Happy for you to set this to a positive review once that's done.",
    "created_at": "2013-02-20T03:28:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13484",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13484#issuecomment-166300",
    "user": "andrew.mathas"
}
```

The patch is quite innocuous and fixes a problem. All doc tests pass. 

Can you add a doctest for testing for this? Presumably it showed up in a real class. Happy for you to set this to a positive review once that's done.



---

archive/issue_comments_166301.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-02-20T16:00:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13484",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13484#issuecomment-166301",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_166302.json:
```json
{
    "body": "Replying to [comment:4 andrew.mathas]: \n> Can you add a doctest for testing for this?\n\nDone. I expanded on the example I gave in the description.\n\n> Presumably it showed up in a real class.\n\nIn `partition.py` after #13605 is applied (of course without this patch).\n\n> Happy for you to set this to a positive review once that's done.\n\nAlso done. Thank you for reviewing this.\n\nBest,\n\nTravis",
    "created_at": "2013-02-20T16:00:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13484",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13484#issuecomment-166302",
    "user": "tscrim"
}
```

Replying to [comment:4 andrew.mathas]: 
> Can you add a doctest for testing for this?

Done. I expanded on the example I gave in the description.

> Presumably it showed up in a real class.

In `partition.py` after #13605 is applied (of course without this patch).

> Happy for you to set this to a positive review once that's done.

Also done. Thank you for reviewing this.

Best,

Travis



---

archive/issue_comments_166303.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-02-22T19:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13484",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13484#issuecomment-166303",
    "user": "jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_166304.json:
```json
{
    "body": "Attachment [trac_13688-finite_sets_cardinality_override-ts.patch](tarball://root/attachments/some-uuid/ticket13688/trac_13688-finite_sets_cardinality_override-ts.patch) by jdemeyer created at 2013-02-22 19:11:28",
    "created_at": "2013-02-22T19:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13484",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13484#issuecomment-166304",
    "user": "jdemeyer"
}
```

Attachment [trac_13688-finite_sets_cardinality_override-ts.patch](tarball://root/attachments/some-uuid/ticket13688/trac_13688-finite_sets_cardinality_override-ts.patch) by jdemeyer created at 2013-02-22 19:11:28
