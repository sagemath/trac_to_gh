# Issue 6910: Singular should not build its version of NTL

Issue created by migration from Trac.

Original creator: pcpa

Original creation time: 2009-09-09 23:49:04

Assignee: mabshoff

in singular-3-1-0-2-20090620.p0/spkg-install, it should say:

                --disable-NTL \

instead of:

                --with-NTL \

otherwise, things can get messed as libsingular.so will have the
same NTL symbols as libtnl.so. What can be very problematic, if
something also links with the libntl.a generated by the singular
package.

This appears to be the root of some of the problems in my
sagemath rpm packages, where some doctests would fail due to
libc aborting, and to make things worse, if running the doctest
only in the offending file, it would not crash, *or* if LD_PRELOAD'ing libntl.so.




---

Comment by pcpa created at 2009-09-10 19:22:53

Replying to [ticket:6910 pcpa]:
> in singular-3-1-0-2-20090620.p0/spkg-install, it should say:
> 
>                 --disable-NTL \
> 
> instead of:
> 
>                 --with-NTL \
> 
> otherwise, things can get messed as libsingular.so will have the
> same NTL symbols as libtnl.so. What can be very problematic, if
> something also links with the libntl.a generated by the singular
> package.
> 
> This appears to be the root of some of the problems in my
> sagemath rpm packages, where some doctests would fail due to
> libc aborting, and to make things worse, if running the doctest
> only in the offending file, it would not crash, *or* if LD_PRELOAD'ing libntl.so.

This bug is not really relevant, because singular-3-1-0-2-20090620.p0.spkg removes the ntl directory (as noticed in spkg-changes). I reported the problem after checking symbols in libsingular.so of a sage 4.1 install. But, by using the suggested patch, it is not required to remove the ntl directory.


---

Comment by pcpa created at 2009-09-10 19:22:53

Changing type from defect to enhancement.


---

Comment by pcpa created at 2009-09-10 19:22:53

Changing priority from major to trivial.


---

Comment by pcpa created at 2011-06-01 11:03:01

I just tracked and corrected most, if not all, crashes in the new
Mandriva sagemath-4.7 rpm package by rebuilding singular but before
that, rm -rf'ing the ntl subdirectory.

Interestingly I had noticed the issue long long ago, and forgot
about it, but the problem is that if not removing the ntl
subdirectory, it will still build the local ntl and/or link
statically to it, even when told to use the system ntl, with
something like --with-ntl=/usr

I had this issue because I did use pristine upstream tarball
for the singular package, and not make it based on the sage
spkg tarball.


---

Comment by leif created at 2011-08-06 18:29:27

Changing status from new to needs_info.


---

Comment by leif created at 2011-08-06 18:29:27

So if this is not (or no longer) a Sage issue, can we close this ticket?

Or did I miss something?


---

Comment by mmezzarobba created at 2014-03-15 17:11:54

Changing status from needs_info to positive_review.


---

Comment by vbraun created at 2014-03-19 04:43:03

Resolution: fixed
