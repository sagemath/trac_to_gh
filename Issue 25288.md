# Issue 25288: Critical exponent for words

Issue created by migration from Trac.

Original creator: evandomme

Original creation time: 2018-06-07 08:57:28

CC:  vdelecroix slabbe

Keywords: MathExp2018, thursdaysbdx

We improve the algorithm computing the critical exponent for words.


---

Comment by evandomme created at 2018-06-07 09:35:27

Changing status from new to needs_review.


---

Comment by evandomme created at 2018-06-07 09:35:27

New commits:


---

Comment by evandomme created at 2018-06-07 09:42:31

Changing type from PLEASE CHANGE to enhancement.


---

Comment by vdelecroix created at 2018-06-07 13:53:12

Impressive timings! Cool :-)


---

Comment by vdelecroix created at 2018-06-07 14:00:18

This following line can be removed

```
        m = 0
```

(since `m` is later initialized with `m = pft[l-j+k-2]` before it is used)

It would be nice to add a little bit of comment in the code

```python
pft = [0] * wlen         # the prefix function table
queue = [(0, 0, -1, 0)]  # suffix tree vertices to visit for DFS
best_exp = 1             # best exponent so far
```


You can replace `w` with `self` instead of having two variables pointing to the same object.

What should be the critical exponent of the empty word? (I guess the function currently returns `1` but should rather raise an error). There should be a doctest for this.


---

Comment by git created at 2018-06-07 17:39:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2018-06-08 12:04:11

The syntax

```
raise ValueError, 'The empty word has no critical exponent.'
```

is valid in Python2 but not Python3. To prepare the future, use

```
raise ValueError('The empty word has no critical exponent.')
```

(which is Python2 _and_ Python3 valid).

And convention for the error messages: keep it short, start with a lower case and no punctuation. Similar to

```
sage: l = []
sage: l[1]
sage: l = []
sage: l[1]
Traceback (most recent call last):
...
IndexError: list index out of range
```



---

Comment by vdelecroix created at 2018-06-17 09:39:23

Changing status from needs_review to needs_work.


---

Comment by slabbe created at 2018-06-21 08:28:13

Is it possible to add a reference in the documentation of the method to the article where this algorithm is defined?

I have time this morning to review the code. Otherwise, I will review it next Thursday.


---

Comment by vdelecroix created at 2018-06-21 08:32:39

Replying to [comment:10 slabbe]:
> Is it possible to add a reference in the documentation of the method to the article where this algorithm is defined?

The algorithm is the *same* as before. It is just more efficiently done. You just go through all factors of the word and compute the exponent. The version in this branch is better because
- instead of running through the factors it performs a depth first search in the suffix tree
- it does not build the factors, it simply updates the prefix function table

> I have time this morning to review the code. Otherwise, I will review it next Thursday.

[comment:8 comment:8] should be addressed before review (status is needs_work).


---

Comment by vdelecroix created at 2018-06-21 08:39:11

rebased on beta6
----
New commits:


---

Comment by vdelecroix created at 2018-06-21 08:39:11

Changing status from needs_work to needs_review.


---

Comment by slabbe created at 2018-06-21 08:46:27

Changing status from needs_review to positive_review.


---

Comment by vdelecroix created at 2018-06-21 08:46:46

Merci SÃ©bastien!


---

Comment by vbraun created at 2018-06-22 22:58:39

Resolution: fixed
