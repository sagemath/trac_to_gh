# Issue 25288: Critical exponent for words

archive/issues_025288.json:
```json
{
    "body": "CC:  vdelecroix slabbe\n\nKeywords: MathExp2018, thursdaysbdx\n\nWe improve the algorithm computing the critical exponent for words.\n\nIssue created by migration from https://trac.sagemath.org/ticket/25525\n\n",
    "created_at": "2018-06-07T08:57:28Z",
    "labels": [
        "combinatorics",
        "major",
        "PLEASE CHANGE"
    ],
    "title": "Critical exponent for words",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25288",
    "user": "evandomme"
}
```
CC:  vdelecroix slabbe

Keywords: MathExp2018, thursdaysbdx

We improve the algorithm computing the critical exponent for words.

Issue created by migration from https://trac.sagemath.org/ticket/25525





---

archive/issue_comments_356482.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-06-07T09:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25288#issuecomment-356482",
    "user": "evandomme"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_356483.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-06-07T09:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25288#issuecomment-356483",
    "user": "evandomme"
}
```

New commits:



---

archive/issue_comments_356484.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2018-06-07T09:42:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25288#issuecomment-356484",
    "user": "evandomme"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_356485.json:
```json
{
    "body": "Impressive timings! Cool :-)",
    "created_at": "2018-06-07T13:53:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25288#issuecomment-356485",
    "user": "vdelecroix"
}
```

Impressive timings! Cool :-)



---

archive/issue_comments_356486.json:
```json
{
    "body": "This following line can be removed\n\n```\n        m = 0\n```\n\n(since `m` is later initialized with `m = pft[l-j+k-2]` before it is used)\n\nIt would be nice to add a little bit of comment in the code\n\n```python\npft = [0] * wlen         # the prefix function table\nqueue = [(0, 0, -1, 0)]  # suffix tree vertices to visit for DFS\nbest_exp = 1             # best exponent so far\n```\n\n\nYou can replace `w` with `self` instead of having two variables pointing to the same object.\n\nWhat should be the critical exponent of the empty word? (I guess the function currently returns `1` but should rather raise an error). There should be a doctest for this.",
    "created_at": "2018-06-07T14:00:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25288#issuecomment-356486",
    "user": "vdelecroix"
}
```

This following line can be removed

```
        m = 0
```

(since `m` is later initialized with `m = pft[l-j+k-2]` before it is used)

It would be nice to add a little bit of comment in the code

```python
pft = [0] * wlen         # the prefix function table
queue = [(0, 0, -1, 0)]  # suffix tree vertices to visit for DFS
best_exp = 1             # best exponent so far
```


You can replace `w` with `self` instead of having two variables pointing to the same object.

What should be the critical exponent of the empty word? (I guess the function currently returns `1` but should rather raise an error). There should be a doctest for this.



---

archive/issue_comments_356487.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-07T17:39:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25288#issuecomment-356487",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_356488.json:
```json
{
    "body": "The syntax\n\n```\nraise ValueError, 'The empty word has no critical exponent.'\n```\n\nis valid in Python2 but not Python3. To prepare the future, use\n\n```\nraise ValueError('The empty word has no critical exponent.')\n```\n\n(which is Python2 *and* Python3 valid).\n\nAnd convention for the error messages: keep it short, start with a lower case and no punctuation. Similar to\n\n```\nsage: l = []\nsage: l[1]\nsage: l = []\nsage: l[1]\nTraceback (most recent call last):\n...\nIndexError: list index out of range\n```\n",
    "created_at": "2018-06-08T12:04:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25288#issuecomment-356488",
    "user": "vdelecroix"
}
```

The syntax

```
raise ValueError, 'The empty word has no critical exponent.'
```

is valid in Python2 but not Python3. To prepare the future, use

```
raise ValueError('The empty word has no critical exponent.')
```

(which is Python2 *and* Python3 valid).

And convention for the error messages: keep it short, start with a lower case and no punctuation. Similar to

```
sage: l = []
sage: l[1]
sage: l = []
sage: l[1]
Traceback (most recent call last):
...
IndexError: list index out of range
```




---

archive/issue_comments_356489.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-06-17T09:39:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25288#issuecomment-356489",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_356490.json:
```json
{
    "body": "Is it possible to add a reference in the documentation of the method to the article where this algorithm is defined?\n\nI have time this morning to review the code. Otherwise, I will review it next Thursday.",
    "created_at": "2018-06-21T08:28:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25288#issuecomment-356490",
    "user": "slabbe"
}
```

Is it possible to add a reference in the documentation of the method to the article where this algorithm is defined?

I have time this morning to review the code. Otherwise, I will review it next Thursday.



---

archive/issue_comments_356491.json:
```json
{
    "body": "Replying to [comment:10 slabbe]:\n> Is it possible to add a reference in the documentation of the method to the article where this algorithm is defined?\n\nThe algorithm is the **same** as before. It is just more efficiently done. You just go through all factors of the word and compute the exponent. The version in this branch is better because\n- instead of running through the factors it performs a depth first search in the suffix tree\n- it does not build the factors, it simply updates the prefix function table\n\n> I have time this morning to review the code. Otherwise, I will review it next Thursday.\n\n[comment:8 comment:8] should be addressed before review (status is needs_work).",
    "created_at": "2018-06-21T08:32:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25288#issuecomment-356491",
    "user": "vdelecroix"
}
```

Replying to [comment:10 slabbe]:
> Is it possible to add a reference in the documentation of the method to the article where this algorithm is defined?

The algorithm is the **same** as before. It is just more efficiently done. You just go through all factors of the word and compute the exponent. The version in this branch is better because
- instead of running through the factors it performs a depth first search in the suffix tree
- it does not build the factors, it simply updates the prefix function table

> I have time this morning to review the code. Otherwise, I will review it next Thursday.

[comment:8 comment:8] should be addressed before review (status is needs_work).



---

archive/issue_comments_356492.json:
```json
{
    "body": "rebased on beta6\n----\nNew commits:",
    "created_at": "2018-06-21T08:39:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25288#issuecomment-356492",
    "user": "vdelecroix"
}
```

rebased on beta6
----
New commits:



---

archive/issue_comments_356493.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-06-21T08:39:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25288#issuecomment-356493",
    "user": "vdelecroix"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_356494.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-06-21T08:46:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25288#issuecomment-356494",
    "user": "slabbe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_356495.json:
```json
{
    "body": "Merci S\u00e9bastien!",
    "created_at": "2018-06-21T08:46:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25288#issuecomment-356495",
    "user": "vdelecroix"
}
```

Merci SÃ©bastien!



---

archive/issue_comments_356496.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-06-22T22:58:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25288",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25288#issuecomment-356496",
    "user": "vbraun"
}
```

Resolution: fixed
