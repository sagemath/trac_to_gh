# Issue 22406: build with clang: fplll symbol not found errors

archive/issues_022406.json:
```json
{
    "body": "CC:  @kiwifb @dimpase @malb\n\nAs mentioned in #12426 comment 106, there are symbol lookup errors when fpylll accesses fplll.\n\nIssue created by migration from https://trac.sagemath.org/ticket/22643\n\n",
    "created_at": "2017-03-19T01:10:44Z",
    "labels": [
        "component: porting",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "build with clang: fplll symbol not found errors",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22406",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @kiwifb @dimpase @malb

As mentioned in #12426 comment 106, there are symbol lookup errors when fpylll accesses fplll.

Issue created by migration from https://trac.sagemath.org/ticket/22643





---

archive/issue_comments_311618.json:
```json
{
    "body": "Replying to [ticket:22643 mkoeppe]:\n> As mentioned in #12426 comment 106\n\nIt would be nice if the ticket description would be self-contained.",
    "created_at": "2017-03-19T15:43:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311618",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:22643 mkoeppe]:
> As mentioned in #12426 comment 106

It would be nice if the ticket description would be self-contained.



---

archive/issue_comments_311619.json:
```json
{
    "body": "My current investigation shows that the missing symbols is in libfplll.dylib but it is a local symbol (\"t\") not a global one and as such it is not seen by objects linking to libfplll.dylib. I am not sure why it is the case but is likely because it was produced with a template.",
    "created_at": "2017-03-20T22:23:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311619",
    "user": "https://github.com/kiwifb"
}
```

My current investigation shows that the missing symbols is in libfplll.dylib but it is a local symbol ("t") not a global one and as such it is not seen by objects linking to libfplll.dylib. I am not sure why it is the case but is likely because it was produced with a template.



---

archive/issue_comments_311620.json:
```json
{
    "body": "The method `process_solution` in enumerate.h is declared private. That's why the symbol is local. It probably shouldn't make its way into the sage interface in the first place. And if it is needed in the sage interface it needs to be public. Digging sage's side...",
    "created_at": "2017-03-20T22:30:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311620",
    "user": "https://github.com/kiwifb"
}
```

The method `process_solution` in enumerate.h is declared private. That's why the symbol is local. It probably shouldn't make its way into the sage interface in the first place. And if it is needed in the sage interface it needs to be public. Digging sage's side...



---

archive/issue_comments_311621.json:
```json
{
    "body": "Wait not sage's side, fpylll's side.",
    "created_at": "2017-03-20T22:31:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311621",
    "user": "https://github.com/kiwifb"
}
```

Wait not sage's side, fpylll's side.



---

archive/issue_comments_311622.json:
```json
{
    "body": "This is typically why I hate C++. So, in fplll, `EnumerationDyn` in `enumerate.h` defines a private method `process_solution`, but it is a derived class from `EnumerationBase` in `enumerate_base.h` which does also have a `process_solution` method but this one is only protected. I think there is a conflict there. But that's one of the point where my head hurts with C++.\n\nActually the method `process_subsolution` is in the same boat in both files.",
    "created_at": "2017-03-21T01:54:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311622",
    "user": "https://github.com/kiwifb"
}
```

This is typically why I hate C++. So, in fplll, `EnumerationDyn` in `enumerate.h` defines a private method `process_solution`, but it is a derived class from `EnumerationBase` in `enumerate_base.h` which does also have a `process_solution` method but this one is only protected. I think there is a conflict there. But that's one of the point where my head hurts with C++.

Actually the method `process_subsolution` is in the same boat in both files.



---

archive/issue_comments_311623.json:
```json
{
    "body": "Well moving in `process_solution` into protected in `EnumerationDyn` didn't change a thing. Don't know enough c++.",
    "created_at": "2017-03-21T02:22:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311623",
    "user": "https://github.com/kiwifb"
}
```

Well moving in `process_solution` into protected in `EnumerationDyn` didn't change a thing. Don't know enough c++.



---

archive/issue_comments_311624.json:
```json
{
    "body": "I've been bitten by this before and couldn't resolve it then. Have you tried the nuclear option of making everything public? I can also ask our resident C++ expert.",
    "created_at": "2017-03-21T09:53:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311624",
    "user": "https://github.com/malb"
}
```

I've been bitten by this before and couldn't resolve it then. Have you tried the nuclear option of making everything public? I can also ask our resident C++ expert.



---

archive/issue_comments_311625.json:
```json
{
    "body": "Replying to [comment:10 malb]:\n> I've been bitten by this before and couldn't resolve it then. Have you tried the nuclear option of making everything public? I can also ask our resident C++ expert.\n\nOnly `process_solution` and `process_subsolution` to no effect. I am even sure what is the chain leading to the creation of this symbol in fplll or why fpylll thinks it should have it.",
    "created_at": "2017-03-21T09:56:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311625",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:10 malb]:
> I've been bitten by this before and couldn't resolve it then. Have you tried the nuclear option of making everything public? I can also ask our resident C++ expert.

Only `process_solution` and `process_subsolution` to no effect. I am even sure what is the chain leading to the creation of this symbol in fplll or why fpylll thinks it should have it.



---

archive/issue_comments_311626.json:
```json
{
    "body": "Replying to [comment:11 fbissey]:\n> Replying to [comment:10 malb]:\n> > I've been bitten by this before and couldn't resolve it then. Have you tried the nuclear option of making everything public? I can also ask our resident C++ expert.\n> \n> Only `process_solution` and `process_subsolution` to no effect.\n\nI should qualify that. I moved them to public in `enumerate.h` but not the parent ones in `enumerate_base.h`.",
    "created_at": "2017-03-22T01:49:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311626",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:11 fbissey]:
> Replying to [comment:10 malb]:
> > I've been bitten by this before and couldn't resolve it then. Have you tried the nuclear option of making everything public? I can also ask our resident C++ expert.
> 
> Only `process_solution` and `process_subsolution` to no effect.

I should qualify that. I moved them to public in `enumerate.h` but not the parent ones in `enumerate_base.h`.



---

archive/issue_comments_311627.json:
```json
{
    "body": "it's strange that creating fplll with clang works fine, while making a cython extension fails. It might well be a cython bug.\nSo the 1st step towards debugging this might be to try to trigger this without cython.",
    "created_at": "2017-03-22T09:34:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311627",
    "user": "https://github.com/dimpase"
}
```

it's strange that creating fplll with clang works fine, while making a cython extension fails. It might well be a cython bug.
So the 1st step towards debugging this might be to try to trigger this without cython.



---

archive/issue_comments_311628.json:
```json
{
    "body": "Replying to [comment:13 dimpase]:\n> It might well be a cython bug.\n\nCython only creates a `.cpp` file. This seems like a linking issue, which Cython has nothing to do with.",
    "created_at": "2017-03-22T09:38:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311628",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:13 dimpase]:
> It might well be a cython bug.

Cython only creates a `.cpp` file. This seems like a linking issue, which Cython has nothing to do with.



---

archive/issue_comments_311629.json:
```json
{
    "body": "Replying to [comment:14 jdemeyer]:\n> Replying to [comment:13 dimpase]:\n> > It might well be a cython bug.\n> \n> Cython only creates a `.cpp` file. This seems like a linking issue, which Cython has nothing to do with.\nit is perfectly possible to create a `.cpp` file that will produce a linking failure.\nGiven that fplll passes all of its own checks, it seems a bit strange that fpylll fails here.\n\nBy the way, I wonder what precisely are options passed to clang that lead to this. \n\n* Does it get `-std=c++11`? \n* Does it get `-stdlib=libc++`?",
    "created_at": "2017-03-22T10:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311629",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:14 jdemeyer]:
> Replying to [comment:13 dimpase]:
> > It might well be a cython bug.
> 
> Cython only creates a `.cpp` file. This seems like a linking issue, which Cython has nothing to do with.
it is perfectly possible to create a `.cpp` file that will produce a linking failure.
Given that fplll passes all of its own checks, it seems a bit strange that fpylll fails here.

By the way, I wonder what precisely are options passed to clang that lead to this. 

* Does it get `-std=c++11`? 
* Does it get `-stdlib=libc++`?



---

archive/issue_comments_311630.json:
```json
{
    "body": "Replying to [comment:15 dimpase]:\n> Replying to [comment:14 jdemeyer]:\n> > Replying to [comment:13 dimpase]:\n> > > It might well be a cython bug.\n> > \n> > Cython only creates a `.cpp` file. This seems like a linking issue, which Cython has nothing to do with.\n> it is perfectly possible to create a `.cpp` file that will produce a linking failure.\n> Given that fplll passes all of its own checks, it seems a bit strange that fpylll fails here.\n> \n> By the way, I wonder what precisely are options passed to clang that lead to this. \n> \n>  * Does it get `-std=c++11`? \n>  * Does it get `-stdlib=libc++`?\n> \n\nThere may be something to look there. `fplll` is compiled with `-std=c++11` but not `fpylll`. For the second, well it is a recent OS X so implicitly we are using `--stdlib=libc++` since this is the default one - I would have to point to the gnu one for it to be used.",
    "created_at": "2017-03-22T10:47:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311630",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:15 dimpase]:
> Replying to [comment:14 jdemeyer]:
> > Replying to [comment:13 dimpase]:
> > > It might well be a cython bug.
> > 
> > Cython only creates a `.cpp` file. This seems like a linking issue, which Cython has nothing to do with.
> it is perfectly possible to create a `.cpp` file that will produce a linking failure.
> Given that fplll passes all of its own checks, it seems a bit strange that fpylll fails here.
> 
> By the way, I wonder what precisely are options passed to clang that lead to this. 
> 
>  * Does it get `-std=c++11`? 
>  * Does it get `-stdlib=libc++`?
> 

There may be something to look there. `fplll` is compiled with `-std=c++11` but not `fpylll`. For the second, well it is a recent OS X so implicitly we are using `--stdlib=libc++` since this is the default one - I would have to point to the gnu one for it to be used.



---

archive/issue_comments_311631.json:
```json
{
    "body": "Replying to [comment:16 fbissey]:\n> \n> There may be something to look there. `fplll` is compiled with `-std=c++11` but not `fpylll`. For the second, well it is a recent OS X so implicitly we are using `--stdlib=libc++` since this is the default one - I would have to point to the gnu one for it to be used.\n\nNope, adding `-std=c++11` in fpylll didn't help so it is not sufficient.",
    "created_at": "2017-03-22T10:53:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311631",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:16 fbissey]:
> 
> There may be something to look there. `fplll` is compiled with `-std=c++11` but not `fpylll`. For the second, well it is a recent OS X so implicitly we are using `--stdlib=libc++` since this is the default one - I would have to point to the gnu one for it to be used.

Nope, adding `-std=c++11` in fpylll didn't help so it is not sufficient.



---

archive/issue_comments_311632.json:
```json
{
    "body": "to give you some context, I get \n\n```\nbuilding 'fplll.integer_matrix' extension\ngcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -I/usr/local/lib/python2.7/site-packages/cysignals -I/usr/local/include/python2.7 -c build/src/fpylll/fplll/integer_matrix.cpp -o build/temp.macosx-10.4-x86_64-2.7/build/src/fpylll/fplll/integer_matrix.o -std=c++11 -stdlib=libc++\nclang: error: invalid deployment target for -stdlib=libc++ (requires OS X 10.7 or later)\n```\n\nif I try using non-sage python; I first got that `build/temp.macosx-10.4` and weird C++ errors, and then this after I added explicit\n`-stdlib=libc++` in `setup.py`.\n\nSo this is some sort of p/cython misconfiguration related to (lack of) c++ support we have seen a lot already.\n\nPS. this particular error is fixed by `export MACOSX_DEPLOYMENT_TARGET=10.12`, and I am able to reproduce the import problem.",
    "created_at": "2017-03-22T10:57:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311632",
    "user": "https://github.com/dimpase"
}
```

to give you some context, I get 

```
building 'fplll.integer_matrix' extension
gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -I/usr/local/lib/python2.7/site-packages/cysignals -I/usr/local/include/python2.7 -c build/src/fpylll/fplll/integer_matrix.cpp -o build/temp.macosx-10.4-x86_64-2.7/build/src/fpylll/fplll/integer_matrix.o -std=c++11 -stdlib=libc++
clang: error: invalid deployment target for -stdlib=libc++ (requires OS X 10.7 or later)
```

if I try using non-sage python; I first got that `build/temp.macosx-10.4` and weird C++ errors, and then this after I added explicit
`-stdlib=libc++` in `setup.py`.

So this is some sort of p/cython misconfiguration related to (lack of) c++ support we have seen a lot already.

PS. this particular error is fixed by `export MACOSX_DEPLOYMENT_TARGET=10.12`, and I am able to reproduce the import problem.



---

archive/issue_comments_311633.json:
```json
{
    "body": "this is what this mangled symbol stands for:\n\n```\n$ c++filt -n _ZN5fplll14EnumerationDynINS_5FP_NRIA1_10dpe_structEEE16process_solutionEd\nfplll::EnumerationDyn<fplll::FP_NR<dpe_struct [1]> >::process_solution(double)\n```\n\nhowever `enumeration.so` only has\n\n```\ntypeinfo for fplll::EnumerationDyn<fplll::FP_NR<dpe_struct [1]> >\n  and\ntypeinfo name for fplll::EnumerationDyn<fplll::FP_NR<dpe_struct [1]> >\n```\n\n(I extracted the latter running `nm -gU` on that .so file.)\nIn comparison, `enumeration.so` built with `gcc`, also has\n\n```\nfplll::EnumerationDyn<fplll::FP_NR<dpe_struct [1]> >::~EnumerationDyn()\n```\n\n\nI have no idea why this happens.\n\n-------------\n\nmoreover, the same kind of difference can be traced by to `fplll.dynlib`, where the one built with gcc does have\nexplicit `process_solution` entries, e.g.\n\n```\nfplll::EnumerationDyn<fplll::FP_NR<dpe_struct [1]> >::process_solution(double)\n```\n\nbut the one built with clang does not. So perhaps the problem is already in `fplll.dynlib`, it's just not tested properly.",
    "created_at": "2017-03-22T14:12:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311633",
    "user": "https://github.com/dimpase"
}
```

this is what this mangled symbol stands for:

```
$ c++filt -n _ZN5fplll14EnumerationDynINS_5FP_NRIA1_10dpe_structEEE16process_solutionEd
fplll::EnumerationDyn<fplll::FP_NR<dpe_struct [1]> >::process_solution(double)
```

however `enumeration.so` only has

```
typeinfo for fplll::EnumerationDyn<fplll::FP_NR<dpe_struct [1]> >
  and
typeinfo name for fplll::EnumerationDyn<fplll::FP_NR<dpe_struct [1]> >
```

(I extracted the latter running `nm -gU` on that .so file.)
In comparison, `enumeration.so` built with `gcc`, also has

```
fplll::EnumerationDyn<fplll::FP_NR<dpe_struct [1]> >::~EnumerationDyn()
```


I have no idea why this happens.

-------------

moreover, the same kind of difference can be traced by to `fplll.dynlib`, where the one built with gcc does have
explicit `process_solution` entries, e.g.

```
fplll::EnumerationDyn<fplll::FP_NR<dpe_struct [1]> >::process_solution(double)
```

but the one built with clang does not. So perhaps the problem is already in `fplll.dynlib`, it's just not tested properly.



---

archive/issue_comments_311634.json:
```json
{
    "body": "The `-g` option of `nm` only show global symbols. The faulty one is \"local\", you will find it in the clang version if you don't pass any option to `nm`. What type of symbol is it according to `nm` for gcc on OS X for you?\n\nOn linux it is of type \"W\", according to the man page:\n\nThe symbol is a weak symbol that has not been specifically tagged as a weak object symbol. When a weak defined symbol is linked with a normal defined symbol, the normal defined symbol is used with no error. When a weak undefined symbol is linked and the symbol is not defined, the value of the symbol is determined in a system-specific manner without error. On some systems, uppercase indicates that a default value has been specified.",
    "created_at": "2017-03-22T21:00:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311634",
    "user": "https://github.com/kiwifb"
}
```

The `-g` option of `nm` only show global symbols. The faulty one is "local", you will find it in the clang version if you don't pass any option to `nm`. What type of symbol is it according to `nm` for gcc on OS X for you?

On linux it is of type "W", according to the man page:

The symbol is a weak symbol that has not been specifically tagged as a weak object symbol. When a weak defined symbol is linked with a normal defined symbol, the normal defined symbol is used with no error. When a weak undefined symbol is linked and the symbol is not defined, the value of the symbol is determined in a system-specific manner without error. On some systems, uppercase indicates that a default value has been specified.



---

archive/issue_comments_311635.json:
```json
{
    "body": "Replying to [comment:20 fbissey]:\n> The `-g` option of `nm` only show global symbols. The faulty one is \"local\", you will find it in the clang version if you don't pass any option to `nm`. What type of symbol is it according to `nm` for gcc on OS X for you?\n> \nrunning `nm` without options, I see that `gcc` makes them type 'T', whereas `clang` makes them type 't'. I.e. `gcc` makes them externally exposed, whereas `clang` does not (`t` stands for non-external section symbol, and `T` stands for external section symbol).\nIn fact, `clang` is totally correct there - private class members must not be exposed.\n\nIt seems that the design only works on `gcc` due to a bug there :-)\n\nAlso, it appears that `fplll` does not supply any tests for this \"enumeration\" functionality. I'm trying to write one now, so that it can be seen purely on C++ level.",
    "created_at": "2017-03-22T22:17:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311635",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:20 fbissey]:
> The `-g` option of `nm` only show global symbols. The faulty one is "local", you will find it in the clang version if you don't pass any option to `nm`. What type of symbol is it according to `nm` for gcc on OS X for you?
> 
running `nm` without options, I see that `gcc` makes them type 'T', whereas `clang` makes them type 't'. I.e. `gcc` makes them externally exposed, whereas `clang` does not (`t` stands for non-external section symbol, and `T` stands for external section symbol).
In fact, `clang` is totally correct there - private class members must not be exposed.

It seems that the design only works on `gcc` due to a bug there :-)

Also, it appears that `fplll` does not supply any tests for this "enumeration" functionality. I'm trying to write one now, so that it can be seen purely on C++ level.



---

archive/issue_comments_311636.json:
```json
{
    "body": "Need this patch to build with clang on OSX https://github.com/fplll/fplll/commit/f372182bbe0f0597e7d6e39f8d23f18a21d1d500\n\nHere's the backported patch for 5.0.3 https://github.com/conda-forge/fplll-feedstock/blob/master/recipe/enumeration-link-error.patch",
    "created_at": "2017-03-23T11:28:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311636",
    "user": "https://github.com/isuruf"
}
```

Need this patch to build with clang on OSX https://github.com/fplll/fplll/commit/f372182bbe0f0597e7d6e39f8d23f18a21d1d500

Here's the backported patch for 5.0.3 https://github.com/conda-forge/fplll-feedstock/blob/master/recipe/enumeration-link-error.patch



---

archive/issue_comments_311637.json:
```json
{
    "body": "Doh! Sage's fplll is not current! Thanks!",
    "created_at": "2017-03-23T11:36:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311637",
    "user": "https://github.com/malb"
}
```

Doh! Sage's fplll is not current! Thanks!



---

archive/issue_comments_311638.json:
```json
{
    "body": "Replying to [comment:23 malb]:\n> Doh! Sage's fplll is not current! Thanks!\n\nwith the current fplll master branch, I get the following error in building fpylll with clang:\n\n```\nbuilding 'fplll.bkz_param' extension\ngcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -I/usr/local/lib/python2.7/site-packages/cysignals -I/usr/local/include/python2.7 -c build/src/fpylll/fplll/bkz_param.cpp -o build/temp.macosx-10.4-x86_64-2.7/build/src/fpylll/fplll/bkz_param.o -std=c++11 -stdlib=libc++\nbuild/src/fpylll/fplll/bkz_param.cpp:2084:44: error: no member named 'probability' in 'fplll::Pruning'\n  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_p.probability); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 65, __pyx_L1_error)\n                                 ~~~~~~~~~ ^\nbuild/src/fpylll/fplll/bkz_param.cpp:2185:16: error: no member named 'probability' in 'fplll::Pruning'\n  __pyx_v_self.probability = __pyx_t_1;\n  ~~~~~~~~~~~~ ^\n2 errors generated.\nerror: command 'gcc' failed with exit status 1\n\n$ gcc -v\nConfigured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1\nApple LLVM version 8.0.0 (clang-800.0.42.1)\nTarget: x86_64-apple-darwin16.4.0\nThread model: posix\nInstalledDir: /Volumes/Sage/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\n```\n",
    "created_at": "2017-03-23T12:58:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311638",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:23 malb]:
> Doh! Sage's fplll is not current! Thanks!

with the current fplll master branch, I get the following error in building fpylll with clang:

```
building 'fplll.bkz_param' extension
gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -I/usr/local/lib/python2.7/site-packages/cysignals -I/usr/local/include/python2.7 -c build/src/fpylll/fplll/bkz_param.cpp -o build/temp.macosx-10.4-x86_64-2.7/build/src/fpylll/fplll/bkz_param.o -std=c++11 -stdlib=libc++
build/src/fpylll/fplll/bkz_param.cpp:2084:44: error: no member named 'probability' in 'fplll::Pruning'
  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_p.probability); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 65, __pyx_L1_error)
                                 ~~~~~~~~~ ^
build/src/fpylll/fplll/bkz_param.cpp:2185:16: error: no member named 'probability' in 'fplll::Pruning'
  __pyx_v_self.probability = __pyx_t_1;
  ~~~~~~~~~~~~ ^
2 errors generated.
error: command 'gcc' failed with exit status 1

$ gcc -v
Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1
Apple LLVM version 8.0.0 (clang-800.0.42.1)
Target: x86_64-apple-darwin16.4.0
Thread model: posix
InstalledDir: /Volumes/Sage/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
```




---

archive/issue_comments_311639.json:
```json
{
    "body": "Replying to [comment:24 dimpase]:\n> Replying to [comment:23 malb]:\n> > Doh! Sage's fplll is not current! Thanks!\n> \n> with the current fplll master branch, I get the following error in building fpylll with clang:\n>  \noh, fpylll isn't up do date in Sage, either. With the git master version of fpylll, everything works.\nMartin, time for new fp(y)lll Sage packages?",
    "created_at": "2017-03-23T13:15:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311639",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:24 dimpase]:
> Replying to [comment:23 malb]:
> > Doh! Sage's fplll is not current! Thanks!
> 
> with the current fplll master branch, I get the following error in building fpylll with clang:
>  
oh, fpylll isn't up do date in Sage, either. With the git master version of fpylll, everything works.
Martin, time for new fp(y)lll Sage packages?



---

archive/issue_comments_311640.json:
```json
{
    "body": "fpylll 0.2.3dev with fplll 5.0.3 + patch I mentioned works on OSX with clang.\n\nIt's great to have new releases though.",
    "created_at": "2017-03-23T13:26:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311640",
    "user": "https://github.com/isuruf"
}
```

fpylll 0.2.3dev with fplll 5.0.3 + patch I mentioned works on OSX with clang.

It's great to have new releases though.



---

archive/issue_comments_311641.json:
```json
{
    "body": "Agreed, I'll get on that.",
    "created_at": "2017-03-23T13:45:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311641",
    "user": "https://github.com/malb"
}
```

Agreed, I'll get on that.



---

archive/issue_comments_311642.json:
```json
{
    "body": "Set assignee to @malb.",
    "created_at": "2017-03-23T13:45:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311642",
    "user": "https://github.com/malb"
}
```

Set assignee to @malb.



---

archive/issue_comments_311643.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-03-26T18:26:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311643",
    "user": "https://github.com/malb"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_311644.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-03-26T18:26:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311644",
    "user": "https://github.com/malb"
}
```

New commits:



---

archive/issue_comments_311645.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-03-26T22:47:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311645",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_311646.json:
```json
{
    "body": "Works for me, solve the problem at hand fully.",
    "created_at": "2017-03-26T22:47:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311646",
    "user": "https://github.com/kiwifb"
}
```

Works for me, solve the problem at hand fully.



---

archive/issue_comments_311647.json:
```json
{
    "body": "works on FreeBSD 11.0 with clang (libc++) / gfortran (sic!, cf.  #22679) too.",
    "created_at": "2017-03-27T14:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311647",
    "user": "https://github.com/dimpase"
}
```

works on FreeBSD 11.0 with clang (libc++) / gfortran (sic!, cf.  #22679) too.



---

archive/issue_comments_311648.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-04-03T21:00:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22406",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22406#issuecomment-311648",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
