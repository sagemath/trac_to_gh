# Issue 11672: Some more doctests from the book "Calcul mathématique avec Sage"

archive/issues_011500.json:
```json
{
    "assignees": [],
    "body": "The attached patch adds to the Sage testsuite most examples appearing Chapters 6 and 8 (Polynomials, Polynomial Systems) of the French book [Calcul math\u00e9matique avec Sage](http://sagebook.gforge.inria.fr/). See #9395 for some background.\n\nAll tests pass with sage 5.5.\n\nAssignee: **mvngu**\n\nCC:  @malb Bouillaguet\n\nReviewer: **Martin Albrecht, Charles Bouillaguet**\n\nAuthor: **Marc Mezzarobba**\n\nMerged: **sage-5.7.beta2**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11672_\n\n",
    "closed_at": "2013-01-30T07:34:57Z",
    "created_at": "2011-08-09T19:59:51Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/doctest%20coverage",
        "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Some more doctests from the book \"Calcul math\u00e9matique avec Sage\"",
    "type": "issue",
    "updated_at": "2013-01-30T07:34:57Z",
    "url": "https://github.com/sagemath/sage/issues/11672",
    "user": "https://github.com/mezzarobba"
}
```
The attached patch adds to the Sage testsuite most examples appearing Chapters 6 and 8 (Polynomials, Polynomial Systems) of the French book [Calcul mathématique avec Sage](http://sagebook.gforge.inria.fr/). See #9395 for some background.

All tests pass with sage 5.5.

Assignee: **mvngu**

CC:  @malb Bouillaguet

Reviewer: **Martin Albrecht, Charles Bouillaguet**

Author: **Marc Mezzarobba**

Merged: **sage-5.7.beta2**

_Issue created by migration from https://trac.sagemath.org/ticket/11672_





---

archive/issue_events_138184.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2011-08-09T19:59:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "milestone_number": null,
    "milestone_title": "sage-5.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138184"
}
```



---

archive/issue_events_138185.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2011-08-09T19:59:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/doctest%20coverage",
    "label_color": "696969",
    "label_name": "doctest coverage",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138185"
}
```



---

archive/issue_events_138186.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2011-08-09T19:59:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138186"
}
```



---

archive/issue_events_138187.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2011-08-09T19:59:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138187"
}
```



---

archive/issue_events_138188.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2011-08-10T06:03:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138188"
}
```



---

archive/issue_comments_122618.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nMartin, please could you review this? This will help our book to be more stable with future\nversions of Sage. Thank you in advance (as a coauthor of the book, I'm quite reluctant to\nreview this).\n\nPaul",
    "created_at": "2011-08-24T19:36:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122618",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:2'>Comment 2:</a>
Martin, please could you review this? This will help our book to be more stable with future
versions of Sage. Thank you in advance (as a coauthor of the book, I'm quite reluctant to
review this).

Paul



---

archive/issue_comments_122619.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nSure, I can take a look:\n\n* Please rename the patch to have the \".patch\" suffix.\n* There might be an issue with the UTF-8, but we should try and wait if anybody complaints.\n* Do you really want to include an autogenerated file without any manual post processing? (\"This file was *autogenerated* from sagebook.tex with sagetex.sty\")\n* Please add your full name to the author field here on Trac.\n* I get some numerical noise errors:\n\n```python\nFile \"/mnt/usb1/scratch/malb/sage-4.7.2/devel/sage/sage/tests/french_book/mpoly.py\", line 373:\n    sage: [CDF['x'](p(y=ys[0][0])).roots() for p in J.gens()]\nExpected:\n    [[(-0.6 - 1.30624677741e-16*I, 1), (0.6 + 1.30624677741e-16*I, 1)],\n    [(0.6 - 3.13499226579e-16*I, 1), (2.6 + 3.13499226579e-16*I, 1)]]\nGot:\n    [[(-0.6 - 1.30628991909e-16*I, 1), (0.6 + 1.30628991909e-16*I, 1)], \n    [(0.6 - 3.13509580582e-16*I, 1), (2.6 + 3.13509580582e-16*I, 1)]]\n```",
    "created_at": "2011-08-24T21:50:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122619",
    "user": "https://github.com/malb"
}
```

<a id='comment:3'>Comment 3:</a>
Sure, I can take a look:

* Please rename the patch to have the ".patch" suffix.
* There might be an issue with the UTF-8, but we should try and wait if anybody complaints.
* Do you really want to include an autogenerated file without any manual post processing? ("This file was *autogenerated* from sagebook.tex with sagetex.sty")
* Please add your full name to the author field here on Trac.
* I get some numerical noise errors:

```python
File "/mnt/usb1/scratch/malb/sage-4.7.2/devel/sage/sage/tests/french_book/mpoly.py", line 373:
    sage: [CDF['x'](p(y=ys[0][0])).roots() for p in J.gens()]
Expected:
    [[(-0.6 - 1.30624677741e-16*I, 1), (0.6 + 1.30624677741e-16*I, 1)],
    [(0.6 - 3.13499226579e-16*I, 1), (2.6 + 3.13499226579e-16*I, 1)]]
Got:
    [[(-0.6 - 1.30628991909e-16*I, 1), (0.6 + 1.30628991909e-16*I, 1)], 
    [(0.6 - 3.13509580582e-16*I, 1), (2.6 + 3.13509580582e-16*I, 1)]]
```



---

archive/issue_comments_122620.json:
```json
{
    "body": "Reviewer: **Martin Albrecht**",
    "created_at": "2011-08-24T21:50:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122620",
    "user": "https://github.com/malb"
}
```

Reviewer: **Martin Albrecht**



---

archive/issue_events_138189.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-08-24T21:50:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138189"
}
```



---

archive/issue_events_138190.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-08-24T21:50:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138190"
}
```



---

archive/issue_comments_122621.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nMartin, on which platform do you get numerical noise errors? With Sage 4.7 on a 64-bit Core 2,\nI get no difference.\n\nPaul",
    "created_at": "2011-08-25T10:15:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122621",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:4'>Comment 4:</a>
Martin, on which platform do you get numerical noise errors? With Sage 4.7 on a 64-bit Core 2,
I get no difference.

Paul



---

archive/issue_comments_122622.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nThis was on sage.math (sorry, should have mentioned).",
    "created_at": "2011-08-26T12:40:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122622",
    "user": "https://github.com/malb"
}
```

<a id='comment:5'>Comment 5:</a>
This was on sage.math (sorry, should have mentioned).



---

archive/issue_comments_122623.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nI will try to make this go through",
    "created_at": "2013-01-12T09:02:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122623",
    "user": "https://github.com/sagetrac-Bouillaguet"
}
```

<a id='comment:6'>Comment 6:</a>
I will try to make this go through



---

archive/issue_comments_122624.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nthanks Charles!\n\nPaul",
    "created_at": "2013-01-12T11:32:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122624",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:7'>Comment 7:</a>
thanks Charles!

Paul



---

archive/issue_comments_122625.json:
```json
{
    "body": "Author: **Marc Mezzarobba**",
    "created_at": "2013-01-18T13:14:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122625",
    "user": "https://github.com/mezzarobba"
}
```

Author: **Marc Mezzarobba**



---

archive/issue_events_138191.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2013-01-18T13:14:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138191"
}
```



---

archive/issue_events_138192.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2013-01-18T13:14:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138192"
}
```



---

archive/issue_events_138193.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2013-01-18T13:14:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138193"
}
```



---

archive/issue_events_138194.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2013-01-18T13:14:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138194"
}
```



---

archive/issue_comments_122626.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nCharles: Thanks!\n\nHere is a new version of the patch, updated to the last draft of the book (which contains what should hopefully be the final version of the chapters in question...) and to Sage 5.5.",
    "created_at": "2013-01-18T13:16:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122626",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:9'>Comment 9:</a>
Charles: Thanks!

Here is a new version of the patch, updated to the last draft of the book (which contains what should hopefully be the final version of the chapters in question...) and to Sage 5.5.



---

archive/issue_comments_122627.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nLooks good to me !",
    "created_at": "2013-01-18T16:57:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122627",
    "user": "https://github.com/sagetrac-Bouillaguet"
}
```

<a id='comment:10'>Comment 10:</a>
Looks good to me !



---

archive/issue_comments_122628.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n The attached patch adds to the Sage testsuite most examples appearing Chapters 6 and 8 (Polynomials, Polynomial Systems) of the French book [Calcul math\u00e9matique avec Sage](http://sagebook.gforge.inria.fr/). See #9395 for some background.\n \n-All tests pass with sage 4.7.\n+All tests pass with sage 5.5.\n``````\n",
    "created_at": "2013-01-18T16:57:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122628",
    "user": "https://github.com/sagetrac-Bouillaguet"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 The attached patch adds to the Sage testsuite most examples appearing Chapters 6 and 8 (Polynomials, Polynomial Systems) of the French book [Calcul mathématique avec Sage](http://sagebook.gforge.inria.fr/). See #9395 for some background.
 
-All tests pass with sage 4.7.
+All tests pass with sage 5.5.
``````




---

archive/issue_comments_122629.json:
```json
{
    "body": "Changed reviewer from **Martin Albrecht** to **Martin Albrecht, Charles Bouillaguet**",
    "created_at": "2013-01-18T16:57:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122629",
    "user": "https://github.com/sagetrac-Bouillaguet"
}
```

Changed reviewer from **Martin Albrecht** to **Martin Albrecht, Charles Bouillaguet**



---

archive/issue_events_138195.json:
```json
{
    "actor": "https://github.com/sagetrac-Bouillaguet",
    "created_at": "2013-01-18T16:57:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138195"
}
```



---

archive/issue_events_138196.json:
```json
{
    "actor": "https://github.com/sagetrac-Bouillaguet",
    "created_at": "2013-01-18T16:57:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138196"
}
```



---

archive/issue_events_138197.json:
```json
{
    "actor": "https://github.com/sagetrac-Bouillaguet",
    "created_at": "2013-01-18T16:57:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "milestone_number": null,
    "milestone_title": "sage-5.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138197"
}
```



---

archive/issue_events_138198.json:
```json
{
    "actor": "https://github.com/sagetrac-Bouillaguet",
    "created_at": "2013-01-18T16:57:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "milestone_number": null,
    "milestone_title": "sage-5.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138198"
}
```



---

archive/issue_events_138199.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-19T13:59:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138199"
}
```



---

archive/issue_events_138200.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-19T13:59:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138200"
}
```



---

archive/issue_comments_122630.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nOn sage.math (Linux x86_64):\n\n```\nsage -t  -force_lib devel/sage/sage/tests/french_book/mpoly.py\n**********************************************************************\nFile \"/release/merger/sage-5.7.beta0/devel/sage-main/sage/tests/french_book/mpoly.py\", line 366:\n    sage: [CDF['x'](p(y=ys[0][0])).roots() for p in J.gens()]\nExpected:\n    [[(-0.6 - 1.30624...e-16*I, 1), (0.6 + 1.30624...e-16*I, 1)],\n    [(0.6 - 3.13499...e-16*I, 1), (2.6 + 3.13499...e-16*I, 1)]]\nGot:\n    [[(-0.6 - 1.30628991909e-16*I, 1), (0.6 + 1.30628991909e-16*I, 1)], [(0.6 - 3.13509580582e-16*I, 1), (2.6 + 3.13509580582e-16*I, 1)]]\n**********************************************************************\n```",
    "created_at": "2013-01-19T13:59:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122630",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'>Comment 11:</a>
On sage.math (Linux x86_64):

```
sage -t  -force_lib devel/sage/sage/tests/french_book/mpoly.py
**********************************************************************
File "/release/merger/sage-5.7.beta0/devel/sage-main/sage/tests/french_book/mpoly.py", line 366:
    sage: [CDF['x'](p(y=ys[0][0])).roots() for p in J.gens()]
Expected:
    [[(-0.6 - 1.30624...e-16*I, 1), (0.6 + 1.30624...e-16*I, 1)],
    [(0.6 - 3.13499...e-16*I, 1), (2.6 + 3.13499...e-16*I, 1)]]
Got:
    [[(-0.6 - 1.30628991909e-16*I, 1), (0.6 + 1.30628991909e-16*I, 1)], [(0.6 - 3.13509580582e-16*I, 1), (2.6 + 3.13509580582e-16*I, 1)]]
**********************************************************************
```



---

archive/issue_comments_122631.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nI am unable to reproduce the failure you get on sage.math (though I am working on Linux x86_64 too),  so I just reduced the number of digits taken into account in this test again.",
    "created_at": "2013-01-19T14:32:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122631",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:12'>Comment 12:</a>
I am unable to reproduce the failure you get on sage.math (though I am working on Linux x86_64 too),  so I just reduced the number of digits taken into account in this test again.



---

archive/issue_events_138201.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2013-01-19T14:32:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138201"
}
```



---

archive/issue_events_138202.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2013-01-19T14:32:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138202"
}
```



---

archive/issue_events_138203.json:
```json
{
    "actor": "https://github.com/sagetrac-Bouillaguet",
    "created_at": "2013-01-20T10:28:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138203"
}
```



---

archive/issue_events_138204.json:
```json
{
    "actor": "https://github.com/sagetrac-Bouillaguet",
    "created_at": "2013-01-20T10:28:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138204"
}
```



---

archive/issue_comments_122632.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nI confirm that I ran the tests before giving the earlier positive review. It did work fine on my core i7-3615QM CPU running OS X 10.7.5...\n\nThe new patch also gets a positive review (the tests pass).",
    "created_at": "2013-01-20T10:28:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122632",
    "user": "https://github.com/sagetrac-Bouillaguet"
}
```

<a id='comment:13'>Comment 13:</a>
I confirm that I ran the tests before giving the earlier positive review. It did work fine on my core i7-3615QM CPU running OS X 10.7.5...

The new patch also gets a positive review (the tests pass).



---

archive/issue_events_138205.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-21T14:54:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138205"
}
```



---

archive/issue_events_138206.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-21T14:54:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138206"
}
```



---

archive/issue_comments_122633.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nOn bsd (OS X 10.6 x86_64):\n\n```\nsage -t  --long -force_lib devel/sage/sage/tests/french_book/mpoly.py\n**********************************************************************\nFile \"/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-5.7.alpha1/devel/sage-main/sage/tests/french_book/mpoly.py\", line 373:\n    sage: J.variety(RDF)\nExpected:\n    [{y: 396340.89..., x: 26.61226...}]\nGot:\n    [{y: 396340.890167, x: -54.9445477048}]\n**********************************************************************\n```\n\nOn arando (Linux Ubuntu 12.04 i686):\n\n```\nsage -t  --long -force_lib devel/sage/sage/tests/french_book/mpoly.py\n**********************************************************************\nFile \"/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.7.alpha1/devel/sage-main/sage/tests/french_book/mpoly.py\", line 373:\n    sage: J.variety(RDF)\nExpected:\n    [{y: 396340.89..., x: 26.61226...}]\nGot:\n    [{y: 396340.890167, x: -46.7888621592}]\n**********************************************************************\n```",
    "created_at": "2013-01-21T14:54:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122633",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'>Comment 14:</a>
On bsd (OS X 10.6 x86_64):

```
sage -t  --long -force_lib devel/sage/sage/tests/french_book/mpoly.py
**********************************************************************
File "/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-5.7.alpha1/devel/sage-main/sage/tests/french_book/mpoly.py", line 373:
    sage: J.variety(RDF)
Expected:
    [{y: 396340.89..., x: 26.61226...}]
Got:
    [{y: 396340.890167, x: -54.9445477048}]
**********************************************************************
```

On arando (Linux Ubuntu 12.04 i686):

```
sage -t  --long -force_lib devel/sage/sage/tests/french_book/mpoly.py
**********************************************************************
File "/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.7.alpha1/devel/sage-main/sage/tests/french_book/mpoly.py", line 373:
    sage: J.variety(RDF)
Expected:
    [{y: 396340.89..., x: 26.61226...}]
Got:
    [{y: 396340.890167, x: -46.7888621592}]
**********************************************************************
```



---

archive/issue_comments_122634.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nI wonder why we get different results for `x`. If all computations are based on IEEE 754, we should get the same (wrong) value. Is it possible to know which components of Sage are used for `J.variety(RDF)` on each platform? On mine I get:\n\n```\nsage: get_systems('J.variety(RDF)')                          \n['MPFI', 'Singular', 'numpy', 'ginac']\n```\nSince MPFI is based on MPFR, MPFI should be architecture independent, but I wonder if the same applies to Singular, numpy and ginac...\n\nPaul",
    "created_at": "2013-01-21T15:46:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122634",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:15'>Comment 15:</a>
I wonder why we get different results for `x`. If all computations are based on IEEE 754, we should get the same (wrong) value. Is it possible to know which components of Sage are used for `J.variety(RDF)` on each platform? On mine I get:

```
sage: get_systems('J.variety(RDF)')                          
['MPFI', 'Singular', 'numpy', 'ginac']
```
Since MPFI is based on MPFR, MPFI should be architecture independent, but I wonder if the same applies to Singular, numpy and ginac...

Paul



---

archive/issue_comments_122635.json:
```json
{
    "body": "Attachment: **[trac_11672_doctests_from_french_book.patch.gz](https://github.com/sagemath/sage/files/ticket11672/trac_11672_doctests_from_french_book.patch.gz)**\n\nNew version (last draft of the book, Sage 5.5)",
    "created_at": "2013-01-21T16:20:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122635",
    "user": "https://github.com/mezzarobba"
}
```

Attachment: **[trac_11672_doctests_from_french_book.patch.gz](https://github.com/sagemath/sage/files/ticket11672/trac_11672_doctests_from_french_book.patch.gz)**

New version (last draft of the book, Sage 5.5)



---

archive/issue_comments_122636.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nPaul: Could it be that whatever is used is compiled using extended precision on some platforms? Another strange thing, though, is that\n\n```\nsage: J.variety(Reals(p))\n[{y: -1.00000001350726, x: -1929.60019649825}, {y: -0.999999986492719, x: 1929.62017010095}, {y: 396340.890166545, x: 10.3009522157620}]\n```\nfinds 3 solutions for p as low as 39...\n\nAnyway, this test doesn't make much sense, I shouldn't have included this test in the first place. Here is a new version of the patch without that test. I took the opportunity to ignore the last few significant digits in another numerical result that might change a bit in the future.",
    "created_at": "2013-01-21T16:21:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122636",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:16'>Comment 16:</a>
Paul: Could it be that whatever is used is compiled using extended precision on some platforms? Another strange thing, though, is that

```
sage: J.variety(Reals(p))
[{y: -1.00000001350726, x: -1929.60019649825}, {y: -0.999999986492719, x: 1929.62017010095}, {y: 396340.890166545, x: 10.3009522157620}]
```
finds 3 solutions for p as low as 39...

Anyway, this test doesn't make much sense, I shouldn't have included this test in the first place. Here is a new version of the patch without that test. I took the opportunity to ignore the last few significant digits in another numerical result that might change a bit in the future.



---

archive/issue_events_138207.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2013-01-21T16:21:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138207"
}
```



---

archive/issue_events_138208.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2013-01-21T16:21:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138208"
}
```



---

archive/issue_comments_122637.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\n> Paul: Could it be that whatever is used is compiled using extended precision on some platforms?\n\nyes, or with a different rounding precision. Anyway, it might be worth tracking down this issue. Jeroen, is there a way to trace the calls to the different Sage components (MPFI, Singular, numpy, ginac)?\n\nPaul",
    "created_at": "2013-01-21T16:30:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122637",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:18'>Comment 18:</a>
> Paul: Could it be that whatever is used is compiled using extended precision on some platforms?

yes, or with a different rounding precision. Anyway, it might be worth tracking down this issue. Jeroen, is there a way to trace the calls to the different Sage components (MPFI, Singular, numpy, ginac)?

Paul



---

archive/issue_comments_122638.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nReplying to [@mezzarobba](#comment%3A16):\n> Paul: Could it be that whatever is used is compiled using extended precision on some platforms? Another strange thing, though, is that\n> \n> ```\n> sage: J.variety(Reals(p))\n> [{y: -1.00000001350726, x: -1929.60019649825}, {y: -0.999999986492719, x: 1929.62017010095}, {y: 396340.890166545, x: 10.3009522157620}]\n> ```\n> finds 3 solutions for p as low as 39...\n> \n> Anyway, this test doesn't make much sense, I shouldn't have included this test in the first place. Here is a new version of the patch without that test. I took the opportunity to ignore the last few significant digits in another numerical result that might change a bit in the future.\n\nWell, the test obviously indicate that there is a problem somewhere, and I tend to believe that we should keep the test and track the problem.\n\nEither your computation is ill-conditioned, and the test should be removed from Sage (and probably also from the book), or there is a component of sage that misbehaves. We should understand what the situation is, and act accordingly. These tests have been there for 1.5 years, so we are not in a hurry.  Maybe we could compare intermediate results on different machines?",
    "created_at": "2013-01-21T16:44:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122638",
    "user": "https://github.com/sagetrac-Bouillaguet"
}
```

<a id='comment:19'>Comment 19:</a>
Replying to [@mezzarobba](#comment%3A16):
> Paul: Could it be that whatever is used is compiled using extended precision on some platforms? Another strange thing, though, is that
> 
> ```
> sage: J.variety(Reals(p))
> [{y: -1.00000001350726, x: -1929.60019649825}, {y: -0.999999986492719, x: 1929.62017010095}, {y: 396340.890166545, x: 10.3009522157620}]
> ```
> finds 3 solutions for p as low as 39...
> 
> Anyway, this test doesn't make much sense, I shouldn't have included this test in the first place. Here is a new version of the patch without that test. I took the opportunity to ignore the last few significant digits in another numerical result that might change a bit in the future.

Well, the test obviously indicate that there is a problem somewhere, and I tend to believe that we should keep the test and track the problem.

Either your computation is ill-conditioned, and the test should be removed from Sage (and probably also from the book), or there is a component of sage that misbehaves. We should understand what the situation is, and act accordingly. These tests have been there for 1.5 years, so we are not in a hurry.  Maybe we could compare intermediate results on different machines?



---

archive/issue_comments_122639.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nReplying to [@zimmermann6](#comment%3A18):\n> Jeroen, is there a way to trace the calls to the different Sage components (MPFI, Singular, numpy, ginac)?\n\nI don't think so.  You could of course use `gdb` and set suitable breakpoints...",
    "created_at": "2013-01-21T19:34:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122639",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'>Comment 20:</a>
Replying to [@zimmermann6](#comment%3A18):
> Jeroen, is there a way to trace the calls to the different Sage components (MPFI, Singular, numpy, ginac)?

I don't think so.  You could of course use `gdb` and set suitable breakpoints...



---

archive/issue_comments_122640.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nReplying to [Bouillaguet](#comment%3A19):\n> Either your computation is ill-conditioned, and the test should be removed from Sage (and probably also from the book), or there is a component of sage that misbehaves. We should understand what the situation is, and act accordingly.\n\nSorry for the lack of context. Yes, the computation is ill-conditioned, that's deliberate (see http://purple.lateralis.org/sagebook-r1014.pdf, p. 210-211), and all three results above are completely wrong (the correct result is x=6.305...).\n\nAs Paul noted, in an ideal world, this code should nontheless yield the same result everywhere, so it might have made sense to test that the result didn't change over time. But there are a number of reasonable explanations for what we observe, and (as far as I can tell) in Sage, floating-point results are usually interpreted as mere approximations that should agree with the correct answer \"up to some numerical noise\" rather than well-defined exact results. So I am in favor of dropping this testcase\u2014unless the policy *is* that machine-precision floating-point computations should yield exactly the same result on all platforms.\n\n(Of course, this doesn't mean we shouldn't try to understand exactly what is going on!)",
    "created_at": "2013-01-21T19:43:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122640",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:21'>Comment 21:</a>
Replying to [Bouillaguet](#comment%3A19):
> Either your computation is ill-conditioned, and the test should be removed from Sage (and probably also from the book), or there is a component of sage that misbehaves. We should understand what the situation is, and act accordingly.

Sorry for the lack of context. Yes, the computation is ill-conditioned, that's deliberate (see http://purple.lateralis.org/sagebook-r1014.pdf, p. 210-211), and all three results above are completely wrong (the correct result is x=6.305...).

As Paul noted, in an ideal world, this code should nontheless yield the same result everywhere, so it might have made sense to test that the result didn't change over time. But there are a number of reasonable explanations for what we observe, and (as far as I can tell) in Sage, floating-point results are usually interpreted as mere approximations that should agree with the correct answer "up to some numerical noise" rather than well-defined exact results. So I am in favor of dropping this testcase—unless the policy *is* that machine-precision floating-point computations should yield exactly the same result on all platforms.

(Of course, this doesn't mean we shouldn't try to understand exactly what is going on!)



---

archive/issue_comments_122641.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nOr, add\n\n```\nJ.variety(RDF)    # random\n```",
    "created_at": "2013-01-21T19:49:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122641",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'>Comment 22:</a>
Or, add

```
J.variety(RDF)    # random
```



---

archive/issue_comments_122642.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nI have created #13980 to keep track of the numerical noise issue, so that we can make progress on this\nticket independently.\n\nPaul",
    "created_at": "2013-01-21T20:41:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122642",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:23'>Comment 23:</a>
I have created #13980 to keep track of the numerical noise issue, so that we can make progress on this
ticket independently.

Paul



---

archive/issue_comments_122643.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nReplying to [@jdemeyer](#comment%3A22):\n\n> Or, add ` J.variety(RDF)    # random `\n\nIs that better? (Given that many examples from the book are already excluded from the tests for various reasons.) Please tell me if you would like me to update the test file.",
    "created_at": "2013-01-21T21:12:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122643",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:24'>Comment 24:</a>
Replying to [@jdemeyer](#comment%3A22):

> Or, add ` J.variety(RDF)    # random `

Is that better? (Given that many examples from the book are already excluded from the tests for various reasons.) Please tell me if you would like me to update the test file.



---

archive/issue_comments_122644.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nIt was only a suggestion, do as you wish.",
    "created_at": "2013-01-21T21:16:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122644",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'>Comment 25:</a>
It was only a suggestion, do as you wish.



---

archive/issue_events_138209.json:
```json
{
    "actor": "https://github.com/sagetrac-Bouillaguet",
    "created_at": "2013-01-26T11:11:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138209"
}
```



---

archive/issue_events_138210.json:
```json
{
    "actor": "https://github.com/sagetrac-Bouillaguet",
    "created_at": "2013-01-26T11:11:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138210"
}
```



---

archive/issue_comments_122645.json:
```json
{
    "body": "Merged: **sage-5.7.beta2**",
    "created_at": "2013-01-30T07:34:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11672#issuecomment-122645",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.7.beta2**



---

archive/issue_events_138211.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-30T07:34:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138211"
}
```



---

archive/issue_events_138212.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-30T07:34:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11672",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11672#event-138212"
}
```
