# Issue 11459: Implement sage -rst2txt and sage -rst2sws

archive/issues_011287.json:
```json
{
    "body": "This ticket concerns the following :\n\n* Convert a ReST file into a worksheet file from the command line : `sage -rst2txt`.\n* Convert a ReST file into a Sage worksheet from the command line : `sage -rst2sws`.\n* Upload a ReST (.rst) file from the Notebook.\n* Upload a .html file output from docutils rst2html on a ReST.\n* Upload a `worksheet.html` file as those stored in the repository `~/.sage/sage_notebook.sagenb/home/admin` without having to change the extension to `.txt`.\n* Add the class `docutilsHTMLProcessor` to the file `sagenb/notebook/docHTMLProcessor.py` which translates HTML file generated by docutils ``rst2html`` command into a worksheet text file. This class was inspired from the class `SphinxHTMLProcessor` already in the same Python file.\n* Add the class `genericHTMLProcessor` to the same file which gathers all the common methods of the other two classes.\n* Improve a lot the documentation of the file `sagenb/notebook/docHTMLProcessor.py` : it is now 100% doctest coveraged.\n\nMy motivation is that in general I wrote my own code using the Sage Code Convention where examples are formatted in ReST. The possibility of converting rst syntax to a worksheet would be nice. Also, ReST file is more fun to edit than the html/cells worksheet text file. It is also more versatile as it can be used to generate a web page or S5 presentation, etc. using docutils.\n\nOn my web page, I created a page [rst2sws](http://www.thales.math.uqam.ca/~labbes/Sage/rst2sws/) where I put an example of ReST file. Note that I managed to use MathJax to render the HTML output of docutils `rst2html` command.\n\nHere is [my clone of the sage-flask-notebook](http://code.google.com/r/slabqc-flask/) where I my patch on the sage notebook will be available.\n\nI am planning to make this script more clean during [Sage Days 31](http://wiki.sagemath.org/days31). I will upload patches as it gets better.\n\nRelated to : #10637 (Implement sage -sws2rst) and #10652.\n\nI mentionned the idea on sage-devel in December 2010 [here](http://groups.google.com/group/sage-devel/browse_thread/thread/5d86874cd359e1a5/eda52be07a9fb994).\n\nThis is based on a script called `rst2notebook` I wrote in January 2011 available [on the Sage Combinat server](http://combinat.sagemath.org/hgwebdir.cgi/misc/file/ef17ccb37589/notebook2rst/).\n\n---\n\nApply: [attachment:trac_11459-root.patch], [attachment:trac_11459-root.reviewer.patch] to `$SAGE_ROOT`\n\nApply: [attachment:trac_11459-scripts.patch], [attachment:trac_11459-scripts.reviewer.patch] to `$SAGE_LOCAL/bin`\n\n**Assignee:** @seblabbe\n\n**CC:**  @kcrisman @kini jasonbhill\n\n**Keywords:** sd31 days31 sd40.5\n\n**Reviewer:** Keshav Kini\n\n**Author:** S\u00e9bastien Labb\u00e9\n\n**Merged:** sage-5.1.beta2\n\n**Dependencies:** #11080\n\nIssue created by migration from https://trac.sagemath.org/ticket/11459\n\n",
    "closed_at": "2012-06-02T12:10:07Z",
    "created_at": "2011-06-10T15:54:43Z",
    "labels": [
        "component: notebook",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.1",
    "title": "Implement sage -rst2txt and sage -rst2sws",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11459",
    "user": "https://github.com/seblabbe"
}
```
This ticket concerns the following :

* Convert a ReST file into a worksheet file from the command line : `sage -rst2txt`.
* Convert a ReST file into a Sage worksheet from the command line : `sage -rst2sws`.
* Upload a ReST (.rst) file from the Notebook.
* Upload a .html file output from docutils rst2html on a ReST.
* Upload a `worksheet.html` file as those stored in the repository `~/.sage/sage_notebook.sagenb/home/admin` without having to change the extension to `.txt`.
* Add the class `docutilsHTMLProcessor` to the file `sagenb/notebook/docHTMLProcessor.py` which translates HTML file generated by docutils ``rst2html`` command into a worksheet text file. This class was inspired from the class `SphinxHTMLProcessor` already in the same Python file.
* Add the class `genericHTMLProcessor` to the same file which gathers all the common methods of the other two classes.
* Improve a lot the documentation of the file `sagenb/notebook/docHTMLProcessor.py` : it is now 100% doctest coveraged.

My motivation is that in general I wrote my own code using the Sage Code Convention where examples are formatted in ReST. The possibility of converting rst syntax to a worksheet would be nice. Also, ReST file is more fun to edit than the html/cells worksheet text file. It is also more versatile as it can be used to generate a web page or S5 presentation, etc. using docutils.

On my web page, I created a page [rst2sws](http://www.thales.math.uqam.ca/~labbes/Sage/rst2sws/) where I put an example of ReST file. Note that I managed to use MathJax to render the HTML output of docutils `rst2html` command.

Here is [my clone of the sage-flask-notebook](http://code.google.com/r/slabqc-flask/) where I my patch on the sage notebook will be available.

I am planning to make this script more clean during [Sage Days 31](http://wiki.sagemath.org/days31). I will upload patches as it gets better.

Related to : #10637 (Implement sage -sws2rst) and #10652.

I mentionned the idea on sage-devel in December 2010 [here](http://groups.google.com/group/sage-devel/browse_thread/thread/5d86874cd359e1a5/eda52be07a9fb994).

This is based on a script called `rst2notebook` I wrote in January 2011 available [on the Sage Combinat server](http://combinat.sagemath.org/hgwebdir.cgi/misc/file/ef17ccb37589/notebook2rst/).

---

Apply: [attachment:trac_11459-root.patch], [attachment:trac_11459-root.reviewer.patch] to `$SAGE_ROOT`

Apply: [attachment:trac_11459-scripts.patch], [attachment:trac_11459-scripts.reviewer.patch] to `$SAGE_LOCAL/bin`

**Assignee:** @seblabbe

**CC:**  @kcrisman @kini jasonbhill

**Keywords:** sd31 days31 sd40.5

**Reviewer:** Keshav Kini

**Author:** Sébastien Labbé

**Merged:** sage-5.1.beta2

**Dependencies:** #11080

Issue created by migration from https://trac.sagemath.org/ticket/11459





---

archive/issue_comments_119795.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"sd31, days31\".",
    "created_at": "2011-06-14T00:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119795",
    "user": "https://github.com/seblabbe"
}
```

**Changing keywords** from "" to "sd31, days31".



---

archive/issue_comments_119796.json:
```json
{
    "body": "<a id='comment:2'></a>\nMaybe this should be rst2sws rather than rst2notebook?  By analogy with #10637 sws2rst.",
    "created_at": "2011-06-14T17:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119796",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:2'></a>
Maybe this should be rst2sws rather than rst2notebook?  By analogy with #10637 sws2rst.



---

archive/issue_comments_119797.json:
```json
{
    "body": "<a id='comment:3'></a>\nReplying to [kcrisman](#comment%3A2):\n> Maybe this should be rst2sws rather than rst2notebook?  By analogy with #10637 sws2rst.\n\n\nBy rst2notebook, I mean something different. I mean the worksheet txt file which is made of html code and `{{{`'s cells. I agree rst2notebook is confusing. Maybe `sage -rst2worksheet_txt` would be better?\n\nBy the way, I also implemented the `sage -rst2sws`. I still need to add some doctests and do some more testing before it needs review. I hope to get to that point by wednesday.\n\nS\u00e9bastien",
    "created_at": "2011-06-15T10:08:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119797",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:3'></a>
Replying to [kcrisman](#comment%3A2):
> Maybe this should be rst2sws rather than rst2notebook?  By analogy with #10637 sws2rst.


By rst2notebook, I mean something different. I mean the worksheet txt file which is made of html code and `{{{`'s cells. I agree rst2notebook is confusing. Maybe `sage -rst2worksheet_txt` would be better?

By the way, I also implemented the `sage -rst2sws`. I still need to add some doctests and do some more testing before it needs review. I hope to get to that point by wednesday.

Sébastien



---

archive/issue_comments_119798.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [slabbe](#comment%3A3):\n> Replying to [kcrisman](#comment%3A2):\n> > Maybe this should be rst2sws rather than rst2notebook?  By analogy with #10637 sws2rst.\n\n> \n> By rst2notebook, I mean something different. I mean the worksheet txt file which is made of html code and `{{{`'s cells. I agree rst2notebook is confusing. Maybe `sage -rst2worksheet_txt` would be better?\n\n\nHmm, or something like that.  That is really long.  But rst2worksheet would be misleading as well, so maybe that's the best option.\n\nWhat about rst2txt?\n\n> By the way, I also implemented the `sage -rst2sws`. I still need to add some doctests and do some more testing before it needs review. I hope to get to that point by wednesday.\n\n\nGreat! Except for the fact that I usually need to go the other direction - but of course those are also appearing.",
    "created_at": "2011-06-15T16:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119798",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:4'></a>
Replying to [slabbe](#comment%3A3):
> Replying to [kcrisman](#comment%3A2):
> > Maybe this should be rst2sws rather than rst2notebook?  By analogy with #10637 sws2rst.

> 
> By rst2notebook, I mean something different. I mean the worksheet txt file which is made of html code and `{{{`'s cells. I agree rst2notebook is confusing. Maybe `sage -rst2worksheet_txt` would be better?


Hmm, or something like that.  That is really long.  But rst2worksheet would be misleading as well, so maybe that's the best option.

What about rst2txt?

> By the way, I also implemented the `sage -rst2sws`. I still need to add some doctests and do some more testing before it needs review. I hope to get to that point by wednesday.


Great! Except for the fact that I usually need to go the other direction - but of course those are also appearing.



---

archive/issue_comments_119799.json:
```json
{
    "body": "<a id='comment:5'></a>\n> What about rst2txt?\n\n\nWell, at first, I excluded that because txt extension are often used for  writing ReST files. But, on the other hand, when one uploads a file  having a `.txt` extension from the notebook, it is assume to be  that worksheet txt file made of html code and triple braces cells. So I  think you are right. rst2txt is a good suggestion. Thank you!\n\n\n\n> > By the way, I also implemented the `sage -rst2sws`. I still need to add some doctests and do some more testing before it needs review. I hope to get to that point by wednesday.\n\n> Great! Except for the fact that I usually need to go the other direction - but of course those are also appearing.\n\nWhy BTW? I feel I am the only one that needs more the rst -> sws  way?! I write all my examples in ReST syntax in my personal code, that  might be why.",
    "created_at": "2011-06-15T17:19:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119799",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:5'></a>
> What about rst2txt?


Well, at first, I excluded that because txt extension are often used for  writing ReST files. But, on the other hand, when one uploads a file  having a `.txt` extension from the notebook, it is assume to be  that worksheet txt file made of html code and triple braces cells. So I  think you are right. rst2txt is a good suggestion. Thank you!



> > By the way, I also implemented the `sage -rst2sws`. I still need to add some doctests and do some more testing before it needs review. I hope to get to that point by wednesday.

> Great! Except for the fact that I usually need to go the other direction - but of course those are also appearing.

Why BTW? I feel I am the only one that needs more the rst -> sws  way?! I write all my examples in ReST syntax in my personal code, that  might be why.



---

archive/issue_events_092462.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2011-06-15T23:38:22Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "rename": {
        "from": "Implement sage -rst2notebook",
        "to": "Implement sage -rst2txt and sage -rst2sws"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11459#event-92462"
}
```



---

archive/issue_comments_119800.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,12 +1,16 @@\n-Convert a rst file into a notebook file (text file). \n+This ticket concerns the following :\n \n-The idea is that in general I wrote code using the Sage Code Convention where examples are formatted in ReST. Then converting rst examples to the notebook would be nice. Also, ReST file is more fun to edit than the html/cells notebook text file.\n+- Convert a ReST file into a worksheet file (txt) \n+- Convert a ReST file into a Sage worksheet (sws)\n+- Add the possibility to upload a .rst file from the Notebook.\n \n-I implemented a script called `rst2notebook` available [on the Sage Combinat server](http://combinat.sagemath.org/hgwebdir.cgi/misc/file/ef17ccb37589/notebook2rst/).\n+My motivation is that in general I wrote my own code using the Sage Code Convention where examples are formatted in ReST. The possibility of converting rst syntax to a worksheet would be nice. Also, ReST file is more fun to edit than the html/cells worksheet text file. It is also more versatile as it can be used to generate a web page or S5 presentation, etc. using docutils.\n \n-In this script, I use docutils to translate a rst file into html file. From this, I convert blocks into cells. Note that I do not use sphinx so that not all usual Sage Rest syntax is working. But I am able to make math role work by adding dollar signs.\n+This is based on a script called `rst2notebook` available [on the Sage Combinat server](http://combinat.sagemath.org/hgwebdir.cgi/misc/file/ef17ccb37589/notebook2rst/).\n \n-I am planning to make this script more clean during [Sage Days 31](http://wiki.sagemath.org/days31), I hope based on sphinx and written as patches.\n+The docutils is used to translate a rst file into html file. From this, I convert blocks into cells. Note that I do not use sphinx so that not all usual Sage Rest syntax is working (yet). But I am able to make math role work by adding dollar signs.\n+\n+I am planning to make this script more clean during [Sage Days 31](http://wiki.sagemath.org/days31). I will upload patches as it gets better.\n \n Related to : #10637 (Implement sage -sws2rst) and #10652.\n \n``````\n",
    "created_at": "2011-06-15T23:38:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119800",
    "user": "https://github.com/seblabbe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,12 +1,16 @@
-Convert a rst file into a notebook file (text file). 
+This ticket concerns the following :
 
-The idea is that in general I wrote code using the Sage Code Convention where examples are formatted in ReST. Then converting rst examples to the notebook would be nice. Also, ReST file is more fun to edit than the html/cells notebook text file.
+- Convert a ReST file into a worksheet file (txt) 
+- Convert a ReST file into a Sage worksheet (sws)
+- Add the possibility to upload a .rst file from the Notebook.
 
-I implemented a script called `rst2notebook` available [on the Sage Combinat server](http://combinat.sagemath.org/hgwebdir.cgi/misc/file/ef17ccb37589/notebook2rst/).
+My motivation is that in general I wrote my own code using the Sage Code Convention where examples are formatted in ReST. The possibility of converting rst syntax to a worksheet would be nice. Also, ReST file is more fun to edit than the html/cells worksheet text file. It is also more versatile as it can be used to generate a web page or S5 presentation, etc. using docutils.
 
-In this script, I use docutils to translate a rst file into html file. From this, I convert blocks into cells. Note that I do not use sphinx so that not all usual Sage Rest syntax is working. But I am able to make math role work by adding dollar signs.
+This is based on a script called `rst2notebook` available [on the Sage Combinat server](http://combinat.sagemath.org/hgwebdir.cgi/misc/file/ef17ccb37589/notebook2rst/).
 
-I am planning to make this script more clean during [Sage Days 31](http://wiki.sagemath.org/days31), I hope based on sphinx and written as patches.
+The docutils is used to translate a rst file into html file. From this, I convert blocks into cells. Note that I do not use sphinx so that not all usual Sage Rest syntax is working (yet). But I am able to make math role work by adding dollar signs.
+
+I am planning to make this script more clean during [Sage Days 31](http://wiki.sagemath.org/days31). I will upload patches as it gets better.
 
 Related to : #10637 (Implement sage -sws2rst) and #10652.
 
``````




---

archive/issue_comments_119801.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,17 +1,21 @@\n This ticket concerns the following :\n \n-- Convert a ReST file into a worksheet file (txt) \n-- Convert a ReST file into a Sage worksheet (sws)\n-- Add the possibility to upload a .rst file from the Notebook.\n+* Convert a ReST file into a worksheet file from the command line : `sage -rst2txt`.\n+* Convert a ReST file into a Sage worksheet from the command line : `sage -rst2sws`.\n+* Upload a ReST (.rst) file from the Notebook.\n+* Upload a .html file output from docutils rst2html on a ReST.\n+* Upload a `worksheet.html` file as those stored in the repository `~/.sage/sage_notebook.sagenb/home/admin` without having to change the extension to `.txt`.\n \n My motivation is that in general I wrote my own code using the Sage Code Convention where examples are formatted in ReST. The possibility of converting rst syntax to a worksheet would be nice. Also, ReST file is more fun to edit than the html/cells worksheet text file. It is also more versatile as it can be used to generate a web page or S5 presentation, etc. using docutils.\n \n-This is based on a script called `rst2notebook` available [on the Sage Combinat server](http://combinat.sagemath.org/hgwebdir.cgi/misc/file/ef17ccb37589/notebook2rst/).\n+On my web page, I created a page [rst2sws](http://www.thales.math.uqam.ca/~labbes/Sage/rst2sws/) where I put an example of ReST file. Note that I managed to use MathJax to render the HTML output of docutils `rst2html` command.\n \n-The docutils is used to translate a rst file into html file. From this, I convert blocks into cells. Note that I do not use sphinx so that not all usual Sage Rest syntax is working (yet). But I am able to make math role work by adding dollar signs.\n+Here is [my clone of the sage-flask-notebook](http://code.google.com/r/slabqc-flask/) where I my patch on the sage notebook will be available.\n \n I am planning to make this script more clean during [Sage Days 31](http://wiki.sagemath.org/days31). I will upload patches as it gets better.\n \n Related to : #10637 (Implement sage -sws2rst) and #10652.\n \n I mentionned the idea on sage-devel in December 2010 [here](http://groups.google.com/group/sage-devel/browse_thread/thread/5d86874cd359e1a5/eda52be07a9fb994).\n+\n+This is based on a script called `rst2notebook` I wrote in January 2011 available [on the Sage Combinat server](http://combinat.sagemath.org/hgwebdir.cgi/misc/file/ef17ccb37589/notebook2rst/).\n``````\n",
    "created_at": "2011-06-18T03:41:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119801",
    "user": "https://github.com/seblabbe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,17 +1,21 @@
 This ticket concerns the following :
 
-- Convert a ReST file into a worksheet file (txt) 
-- Convert a ReST file into a Sage worksheet (sws)
-- Add the possibility to upload a .rst file from the Notebook.
+* Convert a ReST file into a worksheet file from the command line : `sage -rst2txt`.
+* Convert a ReST file into a Sage worksheet from the command line : `sage -rst2sws`.
+* Upload a ReST (.rst) file from the Notebook.
+* Upload a .html file output from docutils rst2html on a ReST.
+* Upload a `worksheet.html` file as those stored in the repository `~/.sage/sage_notebook.sagenb/home/admin` without having to change the extension to `.txt`.
 
 My motivation is that in general I wrote my own code using the Sage Code Convention where examples are formatted in ReST. The possibility of converting rst syntax to a worksheet would be nice. Also, ReST file is more fun to edit than the html/cells worksheet text file. It is also more versatile as it can be used to generate a web page or S5 presentation, etc. using docutils.
 
-This is based on a script called `rst2notebook` available [on the Sage Combinat server](http://combinat.sagemath.org/hgwebdir.cgi/misc/file/ef17ccb37589/notebook2rst/).
+On my web page, I created a page [rst2sws](http://www.thales.math.uqam.ca/~labbes/Sage/rst2sws/) where I put an example of ReST file. Note that I managed to use MathJax to render the HTML output of docutils `rst2html` command.
 
-The docutils is used to translate a rst file into html file. From this, I convert blocks into cells. Note that I do not use sphinx so that not all usual Sage Rest syntax is working (yet). But I am able to make math role work by adding dollar signs.
+Here is [my clone of the sage-flask-notebook](http://code.google.com/r/slabqc-flask/) where I my patch on the sage notebook will be available.
 
 I am planning to make this script more clean during [Sage Days 31](http://wiki.sagemath.org/days31). I will upload patches as it gets better.
 
 Related to : #10637 (Implement sage -sws2rst) and #10652.
 
 I mentionned the idea on sage-devel in December 2010 [here](http://groups.google.com/group/sage-devel/browse_thread/thread/5d86874cd359e1a5/eda52be07a9fb994).
+
+This is based on a script called `rst2notebook` I wrote in January 2011 available [on the Sage Combinat server](http://combinat.sagemath.org/hgwebdir.cgi/misc/file/ef17ccb37589/notebook2rst/).
``````




---

archive/attachments_015090.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac11459_rst2notebook_sagenb-sl.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11459/trac11459_rst2notebook_sagenb-sl.patch",
    "created_at": "2011-06-18T04:00:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/seblabbe"
}
```



---

archive/issue_comments_119802.json:
```json
{
    "body": "Applies on the new flask sagenb repository",
    "created_at": "2011-06-18T04:00:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119802",
    "user": "https://github.com/seblabbe"
}
```

Applies on the new flask sagenb repository



---

archive/issue_comments_119803.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,6 +5,9 @@\n * Upload a ReST (.rst) file from the Notebook.\n * Upload a .html file output from docutils rst2html on a ReST.\n * Upload a `worksheet.html` file as those stored in the repository `~/.sage/sage_notebook.sagenb/home/admin` without having to change the extension to `.txt`.\n+* Add the class `docutilsHTMLProcessor` to the file `sagenb/notebook/docHTMLProcessor.py` which translates HTML file generated by docutils ``rst2html`` command into a worksheet text file. This class was inspired from the class `SphinxHTMLProcessor` already in the same Python file.\n+* Add the class `genericHTMLProcessor` to the same file which gathers all the common methods of the other two classes.\n+* Improve a lot the documentation of the file `sagenb/notebook/docHTMLProcessor.py` : it is now 100% doctest coveraged.\n \n My motivation is that in general I wrote my own code using the Sage Code Convention where examples are formatted in ReST. The possibility of converting rst syntax to a worksheet would be nice. Also, ReST file is more fun to edit than the html/cells worksheet text file. It is also more versatile as it can be used to generate a web page or S5 presentation, etc. using docutils.\n \n``````\n",
    "created_at": "2011-06-18T04:34:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119803",
    "user": "https://github.com/seblabbe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,6 +5,9 @@
 * Upload a ReST (.rst) file from the Notebook.
 * Upload a .html file output from docutils rst2html on a ReST.
 * Upload a `worksheet.html` file as those stored in the repository `~/.sage/sage_notebook.sagenb/home/admin` without having to change the extension to `.txt`.
+* Add the class `docutilsHTMLProcessor` to the file `sagenb/notebook/docHTMLProcessor.py` which translates HTML file generated by docutils ``rst2html`` command into a worksheet text file. This class was inspired from the class `SphinxHTMLProcessor` already in the same Python file.
+* Add the class `genericHTMLProcessor` to the same file which gathers all the common methods of the other two classes.
+* Improve a lot the documentation of the file `sagenb/notebook/docHTMLProcessor.py` : it is now 100% doctest coveraged.
 
 My motivation is that in general I wrote my own code using the Sage Code Convention where examples are formatted in ReST. The possibility of converting rst syntax to a worksheet would be nice. Also, ReST file is more fun to edit than the html/cells worksheet text file. It is also more versatile as it can be used to generate a web page or S5 presentation, etc. using docutils.
 
``````




---

archive/issue_comments_119804.json:
```json
{
    "body": "<a id='comment:11'></a>\nI'm testing this, but I wanted to give others a heads-up on something. (Maybe Kini can shed some light on this from the hg side of things.)\n\nI'm currently using the flask repo (the ~official~ one...) and have a symlink redirecting devel/sagenb->flask. The path for various diffs in this patch should be following that sagenb symlink, but they're following my sage->sage-main (or whatever clone I'm working in) repo instead.",
    "created_at": "2011-06-21T01:26:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119804",
    "user": "https://trac.sagemath.org/admin/accounts/users/jasonbhill"
}
```

<a id='comment:11'></a>
I'm testing this, but I wanted to give others a heads-up on something. (Maybe Kini can shed some light on this from the hg side of things.)

I'm currently using the flask repo (the ~official~ one...) and have a symlink redirecting devel/sagenb->flask. The path for various diffs in this patch should be following that sagenb symlink, but they're following my sage->sage-main (or whatever clone I'm working in) repo instead.



---

archive/issue_comments_119805.json:
```json
{
    "body": "<a id='comment:12'></a>\nThe root of the sagenb repository is *in* your `devel/sagenb`, i.e. already beyond the symlink. The paths should have nothing to do with that (and look fine to me fwiw). Are you applying it in the right place?",
    "created_at": "2011-06-21T02:08:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119805",
    "user": "https://github.com/kini"
}
```

<a id='comment:12'></a>
The root of the sagenb repository is *in* your `devel/sagenb`, i.e. already beyond the symlink. The paths should have nothing to do with that (and look fine to me fwiw). Are you applying it in the right place?



---

archive/issue_comments_119806.json:
```json
{
    "body": "<a id='comment:13'></a>\nYup... \"sagenb\" and \"sage\" are the two symlinks in devel. All of my patches are attempting to following the latter. \n\nI'm using hg_sage.apply(\"address\"). My usual workflow is to create a clone, build into that clone, then apply any patches. This has always worked, but then again I am always working under the \"sage\" symlink. But, in this situation the patch (regardless of branch) is attempting to apply in \"devel/sage->my_\".\n\nHow might one apply this otherwise ... in a specific location?",
    "created_at": "2011-06-21T02:27:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119806",
    "user": "https://trac.sagemath.org/admin/accounts/users/jasonbhill"
}
```

<a id='comment:13'></a>
Yup... "sagenb" and "sage" are the two symlinks in devel. All of my patches are attempting to following the latter. 

I'm using hg_sage.apply("address"). My usual workflow is to create a clone, build into that clone, then apply any patches. This has always worked, but then again I am always working under the "sage" symlink. But, in this situation the patch (regardless of branch) is attempting to apply in "devel/sage->my_".

How might one apply this otherwise ... in a specific location?



---

archive/issue_comments_119807.json:
```json
{
    "body": "<a id='comment:14'></a>\nAh. Use `hg_sagenb` instead of `hg_sage` - try tab completing `hg_` in the Sage console to see the list of repositories you have access to. `hg_sage` is the Sage library, `hg_sagenb` is the notebook, `hg_extcode` seems to be for the interfaces to other software, `hg_scripts` is for the sage command line tools and related stuff, `hg_root` is for some miscellaneous \"top-level\" stuff.\n\nI would personally recommend using Mercurial from the command line, though - it allows you to see what you are doing more precisely, where patches are going exactly, etc.",
    "created_at": "2011-06-21T03:14:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119807",
    "user": "https://github.com/kini"
}
```

<a id='comment:14'></a>
Ah. Use `hg_sagenb` instead of `hg_sage` - try tab completing `hg_` in the Sage console to see the list of repositories you have access to. `hg_sage` is the Sage library, `hg_sagenb` is the notebook, `hg_extcode` seems to be for the interfaces to other software, `hg_scripts` is for the sage command line tools and related stuff, `hg_root` is for some miscellaneous "top-level" stuff.

I would personally recommend using Mercurial from the command line, though - it allows you to see what you are doing more precisely, where patches are going exactly, etc.



---

archive/issue_comments_119808.json:
```json
{
    "body": "<a id='comment:15'></a>\nTo be precise, `hg_sage` points to `devel/sage`, `hg_sagenb` points to `devel/sagenb`, `hg_extcode` points to `data/extcode`, and `hg_scripts` points to `local/bin`, if you want to go exploring. Using `sage -clone` and `sage -b <branchname>` only apply to `devel/sage` - other repositories are left uncloned and unmodified.\n\nBy the way, you might consider dropping by [IRC](http://sagemath.org/help-irc.html) to talk about these things in realtime instead of posting to this trac ticket, as this is getting quite off-topic... :)",
    "created_at": "2011-06-21T03:21:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119808",
    "user": "https://github.com/kini"
}
```

<a id='comment:15'></a>
To be precise, `hg_sage` points to `devel/sage`, `hg_sagenb` points to `devel/sagenb`, `hg_extcode` points to `data/extcode`, and `hg_scripts` points to `local/bin`, if you want to go exploring. Using `sage -clone` and `sage -b <branchname>` only apply to `devel/sage` - other repositories are left uncloned and unmodified.

By the way, you might consider dropping by [IRC](http://sagemath.org/help-irc.html) to talk about these things in realtime instead of posting to this trac ticket, as this is getting quite off-topic... :)



---

archive/issue_comments_119809.json:
```json
{
    "body": "<a id='comment:16'></a>\nSalut!\n\nJust to give an update about the status of the patches on this ticket :\n\n1. trac11459_rst2notebook_sagenb-sl.patch : I was not able to export the patch once I qfinish it and pushed it on my branch on the sagenb google code. Hence, the patch available here do not have the very last modification I did just before I made qfinish. So if you are testing it, it would be better if you test my sagenb branch. Anyhow, I do not intend to change my sagenb branch. I believe it is ready for review.\n\nQuestion for kini : How can I export the patch once it is qfinished (commited) so that I upload here the latest version?\n\n2. trac11459_rst2notebook_localbin-sl.patch : The script needs work. I want to implement better options about escaping backslashes. I should be able to finish this in the next days during the week. Once this is done, I will change the status of this ticket to needs review.\n\nS\u00e9bastien",
    "created_at": "2011-06-21T15:46:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119809",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:16'></a>
Salut!

Just to give an update about the status of the patches on this ticket :

1. trac11459_rst2notebook_sagenb-sl.patch : I was not able to export the patch once I qfinish it and pushed it on my branch on the sagenb google code. Hence, the patch available here do not have the very last modification I did just before I made qfinish. So if you are testing it, it would be better if you test my sagenb branch. Anyhow, I do not intend to change my sagenb branch. I believe it is ready for review.

Question for kini : How can I export the patch once it is qfinished (commited) so that I upload here the latest version?

2. trac11459_rst2notebook_localbin-sl.patch : The script needs work. I want to implement better options about escaping backslashes. I should be able to finish this in the next days during the week. Once this is done, I will change the status of this ticket to needs review.

Sébastien



---

archive/issue_comments_119810.json:
```json
{
    "body": "<a id='comment:17'></a>\nYou can turn committed changes back into patches with `hg qimport -r tip` if you want. If you want to leave them committed but export a patch, use `hg export tip > file.patch`. (don't forget to put \"[diff]\\ngit=yes\" in your `~/.hgrc`.)",
    "created_at": "2011-06-21T17:18:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119810",
    "user": "https://github.com/kini"
}
```

<a id='comment:17'></a>
You can turn committed changes back into patches with `hg qimport -r tip` if you want. If you want to leave them committed but export a patch, use `hg export tip > file.patch`. (don't forget to put "[diff]\ngit=yes" in your `~/.hgrc`.)



---

archive/issue_comments_119811.json:
```json
{
    "body": "<a id='comment:18'></a>\n> Hence, the patch available here do not have the very last modification I did just before I made qfinish.\n\n\nIt was not true finally. The patch trac11459_rst2notebook_sagenb-sl.patch available here contains the very last modifications.",
    "created_at": "2011-06-22T14:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119811",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:18'></a>
> Hence, the patch available here do not have the very last modification I did just before I made qfinish.


It was not true finally. The patch trac11459_rst2notebook_sagenb-sl.patch available here contains the very last modifications.



---

archive/attachments_015091.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac11459_rst2notebook_localbin-sl.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11459/trac11459_rst2notebook_localbin-sl.patch",
    "created_at": "2011-06-22T14:42:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/seblabbe"
}
```



---

archive/issue_comments_119812.json:
```json
{
    "body": "Applies in the local/bin repository",
    "created_at": "2011-06-22T14:42:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119812",
    "user": "https://github.com/seblabbe"
}
```

Applies in the local/bin repository



---

archive/issue_events_092463.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2011-06-22T14:44:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11459#event-92463"
}
```



---

archive/issue_comments_119813.json:
```json
{
    "body": "<a id='comment:19'></a>\nI finished working on the `local/bin` scripts and just re-uploaded the patch.\n\nNow needs review!",
    "created_at": "2011-06-22T14:44:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119813",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:19'></a>
I finished working on the `local/bin` scripts and just re-uploaded the patch.

Now needs review!



---

archive/issue_comments_119814.json:
```json
{
    "body": "**Author:** S\u00e9bastien Labb\u00e9",
    "created_at": "2011-06-22T14:44:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119814",
    "user": "https://github.com/seblabbe"
}
```

**Author:** Sébastien Labbé



---

archive/issue_comments_119815.json:
```json
{
    "body": "**Dependencies:** #11080",
    "created_at": "2012-01-29T19:08:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119815",
    "user": "https://github.com/seblabbe"
}
```

**Dependencies:** #11080



---

archive/attachments_015092.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11459-root.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11459/trac_11459-root.patch",
    "created_at": "2012-05-16T14:31:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/kini"
}
```



---

archive/issue_comments_119816.json:
```json
{
    "body": "apply to $SAGE_ROOT",
    "created_at": "2012-05-16T14:31:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119816",
    "user": "https://github.com/kini"
}
```

apply to $SAGE_ROOT



---

archive/attachments_015093.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11459-scripts.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11459/trac_11459-scripts.patch",
    "created_at": "2012-05-16T14:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/kini"
}
```



---

archive/issue_comments_119817.json:
```json
{
    "body": "apply to $SAGE_LOCAL/bin",
    "created_at": "2012-05-16T14:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119817",
    "user": "https://github.com/kini"
}
```

apply to $SAGE_LOCAL/bin



---

archive/issue_comments_119818.json:
```json
{
    "body": "<a id='comment:21'></a>\nHi Sebastien,\n\nI've rebased the scripts patch to Sage 5.0. Because the file formerly at `$SAGE_LOCAL/bin/sage-sage` is now at `$SAGE_ROOT/spkg/bin/sage`, it had to be split into two patches.\n\nThe notebook patch will probably need to be rebased as well, but since we're doing development of sagenb on github now, it won't go here on trac. I'll see what I can do...",
    "created_at": "2012-05-16T14:37:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119818",
    "user": "https://github.com/kini"
}
```

<a id='comment:21'></a>
Hi Sebastien,

I've rebased the scripts patch to Sage 5.0. Because the file formerly at `$SAGE_LOCAL/bin/sage-sage` is now at `$SAGE_ROOT/spkg/bin/sage`, it had to be split into two patches.

The notebook patch will probably need to be rebased as well, but since we're doing development of sagenb on github now, it won't go here on trac. I'll see what I can do...



---

archive/issue_comments_119819.json:
```json
{
    "body": "<a id='comment:22'></a>\nNever mind, it looks like you [already got that code into sagenb](https://github.com/sagemath/sagenb/commit/44733a2965e89e43a28431cb46eca38108771a3c) after all.",
    "created_at": "2012-05-17T12:21:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119819",
    "user": "https://github.com/kini"
}
```

<a id='comment:22'></a>
Never mind, it looks like you [already got that code into sagenb](https://github.com/sagemath/sagenb/commit/44733a2965e89e43a28431cb46eca38108771a3c) after all.



---

archive/issue_events_092464.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-05-17T12:21:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "milestone": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11459#event-92464"
}
```



---

archive/issue_events_092465.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-05-17T12:21:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "milestone": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11459#event-92465"
}
```



---

archive/issue_comments_119820.json:
```json
{
    "body": "<a id='comment:23'></a>\nwhoops",
    "created_at": "2012-05-17T12:21:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119820",
    "user": "https://github.com/kini"
}
```

<a id='comment:23'></a>
whoops



---

archive/issue_events_092466.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-05-17T12:21:39Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "milestone": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11459#event-92466"
}
```



---

archive/issue_events_092467.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-05-17T12:21:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "milestone": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11459#event-92467"
}
```



---

archive/issue_events_092468.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-05-25T20:51:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11459#event-92468"
}
```



---

archive/issue_events_092469.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-05-25T20:51:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11459#event-92469"
}
```



---

archive/issue_comments_119821.json:
```json
{
    "body": "<a id='comment:24'></a>\nSo here is a reviewer patch, and positive review for this ticket. Everything looks good to me.",
    "created_at": "2012-05-25T20:51:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119821",
    "user": "https://github.com/kini"
}
```

<a id='comment:24'></a>
So here is a reviewer patch, and positive review for this ticket. Everything looks good to me.



---

archive/issue_comments_119822.json:
```json
{
    "body": "**Changing keywords** from \"sd31, days31\" to \"sd31, days31, sd40.5\".",
    "created_at": "2012-05-25T20:51:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119822",
    "user": "https://github.com/kini"
}
```

**Changing keywords** from "sd31, days31" to "sd31, days31, sd40.5".



---

archive/issue_comments_119823.json:
```json
{
    "body": "**Reviewer:** Keshav Kini",
    "created_at": "2012-05-25T20:51:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119823",
    "user": "https://github.com/kini"
}
```

**Reviewer:** Keshav Kini



---

archive/issue_comments_119824.json:
```json
{
    "body": "**Changing keywords** from \"sd31, days31, sd40.5\" to \"sd31 days31 sd40.5\".",
    "created_at": "2012-05-25T20:51:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119824",
    "user": "https://github.com/kini"
}
```

**Changing keywords** from "sd31, days31, sd40.5" to "sd31 days31 sd40.5".



---

archive/issue_comments_119825.json:
```json
{
    "body": "apply to $SAGE_ROOT",
    "created_at": "2012-05-25T21:11:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119825",
    "user": "https://github.com/kini"
}
```

apply to $SAGE_ROOT



---

archive/attachments_015094.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11459-root.reviewer.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11459/trac_11459-root.reviewer.patch",
    "created_at": "2012-05-25T21:13:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/kini"
}
```



---

archive/issue_comments_119826.json:
```json
{
    "body": "<a id='comment:26'></a>\nWhoops, forgot the other reviewer patch...",
    "created_at": "2012-05-25T21:13:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119826",
    "user": "https://github.com/kini"
}
```

<a id='comment:26'></a>
Whoops, forgot the other reviewer patch...



---

archive/issue_comments_119827.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -22,3 +22,9 @@\n I mentionned the idea on sage-devel in December 2010 [here](http://groups.google.com/group/sage-devel/browse_thread/thread/5d86874cd359e1a5/eda52be07a9fb994).\n \n This is based on a script called `rst2notebook` I wrote in January 2011 available [on the Sage Combinat server](http://combinat.sagemath.org/hgwebdir.cgi/misc/file/ef17ccb37589/notebook2rst/).\n+\n+---\n+\n+Apply: [attachment:trac_11459-root.patch], [attachment:trac_11459-root.reviewer.patch] to `$SAGE_ROOT`\n+\n+Apply: [attachment:trac_11459-scripts.patch], [attachment:trac_11459-scripts.reviewer.patch] to `$SAGE_LOCAL/bin`\n``````\n",
    "created_at": "2012-05-25T21:13:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119827",
    "user": "https://github.com/kini"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -22,3 +22,9 @@
 I mentionned the idea on sage-devel in December 2010 [here](http://groups.google.com/group/sage-devel/browse_thread/thread/5d86874cd359e1a5/eda52be07a9fb994).
 
 This is based on a script called `rst2notebook` I wrote in January 2011 available [on the Sage Combinat server](http://combinat.sagemath.org/hgwebdir.cgi/misc/file/ef17ccb37589/notebook2rst/).
+
+---
+
+Apply: [attachment:trac_11459-root.patch], [attachment:trac_11459-root.reviewer.patch] to `$SAGE_ROOT`
+
+Apply: [attachment:trac_11459-scripts.patch], [attachment:trac_11459-scripts.reviewer.patch] to `$SAGE_LOCAL/bin`
``````




---

archive/issue_comments_119828.json:
```json
{
    "body": "<a id='comment:27'></a>\nHi Kini,\n\nThanks for looking at this!\n\nI remember I wanted to remove the guillemets (\") in the line of documentation of both scripts:\n\n\"..  escape-backslashes\" \n\nCan you update your patch to do it, if you agree? I am sorry I never did it...\n\nIs the new notebook now part of Sage ? If I want to test this ticket, should I install the latest sage-alpha or should I install the new sage-notebook?\n\nS\u00e9bastien",
    "created_at": "2012-05-25T22:27:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119828",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:27'></a>
Hi Kini,

Thanks for looking at this!

I remember I wanted to remove the guillemets (") in the line of documentation of both scripts:

"..  escape-backslashes" 

Can you update your patch to do it, if you agree? I am sorry I never did it...

Is the new notebook now part of Sage ? If I want to test this ticket, should I install the latest sage-alpha or should I install the new sage-notebook?

Sébastien



---

archive/issue_events_092470.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-05-25T23:35:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11459#event-92470"
}
```



---

archive/issue_events_092471.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-05-25T23:35:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11459#event-92471"
}
```



---

archive/issue_comments_119829.json:
```json
{
    "body": "<a id='comment:28'></a>\nOK, I'll do it, and I'll also modify the file `sage-rst2txt` which I completely overlooked...!\n\nThe new notebook is not part of Sage yet (though it finally got positive review a couple of hours ago - #11080). If you want to test the ticket, follow the instructions on #11080 to install the new notebook first.",
    "created_at": "2012-05-25T23:35:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119829",
    "user": "https://github.com/kini"
}
```

<a id='comment:28'></a>
OK, I'll do it, and I'll also modify the file `sage-rst2txt` which I completely overlooked...!

The new notebook is not part of Sage yet (though it finally got positive review a couple of hours ago - #11080). If you want to test the ticket, follow the instructions on #11080 to install the new notebook first.



---

archive/issue_comments_119830.json:
```json
{
    "body": "apply to $SAGE_LOCAL/bin",
    "created_at": "2012-05-25T23:46:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119830",
    "user": "https://github.com/kini"
}
```

apply to $SAGE_LOCAL/bin



---

archive/attachments_015095.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11459-scripts.reviewer.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11459/trac_11459-scripts.reviewer.patch",
    "created_at": "2012-05-25T23:46:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/kini"
}
```



---

archive/issue_comments_119831.json:
```json
{
    "body": "<a id='comment:29'></a>\nOK, there we go.",
    "created_at": "2012-05-25T23:46:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119831",
    "user": "https://github.com/kini"
}
```

<a id='comment:29'></a>
OK, there we go.



---

archive/issue_events_092472.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-05-25T23:46:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11459#event-92472"
}
```



---

archive/issue_events_092473.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2012-05-25T23:46:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11459#event-92473"
}
```



---

archive/issue_events_092474.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-26T03:27:29Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "milestone": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11459#event-92474"
}
```



---

archive/issue_events_092475.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-05-26T03:27:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "label": "pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11459#event-92475"
}
```



---

archive/issue_comments_119832.json:
```json
{
    "body": "<a id='comment:31'></a>\nThanks for the review Keshav!",
    "created_at": "2012-05-29T13:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119832",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:31'></a>
Thanks for the review Keshav!



---

archive/issue_events_092476.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-02T12:10:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11459#event-92476"
}
```



---

archive/issue_events_092477.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-02T12:10:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11459#event-92477"
}
```



---

archive/issue_comments_119833.json:
```json
{
    "body": "**Merged:** sage-5.1.beta2",
    "created_at": "2012-06-02T12:10:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119833",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.1.beta2



---

archive/issue_comments_119834.json:
```json
{
    "body": "<a id='comment:33'></a>\nHi!  I'm trying to get #10637 (the other direction) in shape for positive review, and I notice there are no patches here documenting in the Sage library how to use this.  I guess that's because they just make text and sws.  Was there any place that you would think would be natural, other than `sage -advanced`?",
    "created_at": "2012-06-21T16:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119834",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:33'></a>
Hi!  I'm trying to get #10637 (the other direction) in shape for positive review, and I notice there are no patches here documenting in the Sage library how to use this.  I guess that's because they just make text and sws.  Was there any place that you would think would be natural, other than `sage -advanced`?



---

archive/issue_comments_119835.json:
```json
{
    "body": "<a id='comment:34'></a>\n> Was there any place that you would think would be natural, other than sage -advanced?\n\n\nNote: There is some documentation in `sage -rst2sws -h` as well.\n\nIt would be a good idea to add documentation somewhere in the Sage reference manual. Where are the other sage-scripts documented?",
    "created_at": "2012-06-21T18:17:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119835",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:34'></a>
> Was there any place that you would think would be natural, other than sage -advanced?


Note: There is some documentation in `sage -rst2sws -h` as well.

It would be a good idea to add documentation somewhere in the Sage reference manual. Where are the other sage-scripts documented?



---

archive/issue_comments_119836.json:
```json
{
    "body": "<a id='comment:35'></a>\nMy sense is that they are not.\n\nOkay, I'll look at your script and see how you implement that, then do that at #10637.  That would suffice for the purposes there.\n\nDo you want to open another ticket to document (at least some) of the scripts in the usual reference manual?",
    "created_at": "2012-06-21T18:39:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119836",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:35'></a>
My sense is that they are not.

Okay, I'll look at your script and see how you implement that, then do that at #10637.  That would suffice for the purposes there.

Do you want to open another ticket to document (at least some) of the scripts in the usual reference manual?



---

archive/issue_comments_119837.json:
```json
{
    "body": "<a id='comment:36'></a>\nBy the way, not that you have to deal with this now, see [http://docs.python.org/library/optparse.html](http://docs.python.org/library/optparse.html):\n\n```\nDeprecated since version 2.7: The optparse module is deprecated and will not be developed further; \ndevelopment will continue with the argparse module.\n```\nOh well.",
    "created_at": "2012-06-21T19:00:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119837",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:36'></a>
By the way, not that you have to deal with this now, see [http://docs.python.org/library/optparse.html](http://docs.python.org/library/optparse.html):

```
Deprecated since version 2.7: The optparse module is deprecated and will not be developed further; 
development will continue with the argparse module.
```
Oh well.



---

archive/issue_events_092478.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-23T06:58:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "milestone": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11459#event-92478"
}
```



---

archive/issue_events_092479.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-23T06:58:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "label": "pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11459#event-92479"
}
```



---

archive/issue_comments_119838.json:
```json
{
    "body": "<a id='comment:38'></a>\nThis \"depends\" on #11080 but somehow got merged anyway.",
    "created_at": "2012-07-23T06:59:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119838",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:38'></a>
This "depends" on #11080 but somehow got merged anyway.



---

archive/issue_comments_119839.json:
```json
{
    "body": "<a id='comment:39'></a>\nReplying to [jdemeyer](#comment%3A38):\n> This \"depends\" on #11080 but somehow got merged anyway.\n\n\nIt depends on code written in the new sagenb indeed. That means the script won't work on sage-5.1 : it will get an import error I would guess. The thing is that there is no test for the script... so you could not see that the script was broken without #11080. Or worse, in the future, if a patch on sagenb breaks the script, we won't know it. How should a script be doctested?",
    "created_at": "2012-07-26T14:13:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119839",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:39'></a>
Replying to [jdemeyer](#comment%3A38):
> This "depends" on #11080 but somehow got merged anyway.


It depends on code written in the new sagenb indeed. That means the script won't work on sage-5.1 : it will get an import error I would guess. The thing is that there is no test for the script... so you could not see that the script was broken without #11080. Or worse, in the future, if a patch on sagenb breaks the script, we won't know it. How should a script be doctested?



---

archive/issue_comments_119840.json:
```json
{
    "body": "<a id='comment:40'></a>\nThe part of the script which depends on the new sagenb is the following :\n\n```python\n# Do the translation html -> worksheet txt \nfrom sagenb.notebook.docHTMLProcessor import docutilsHTMLProcessor \ntranslator = docutilsHTMLProcessor() \nworksheet_txt = translator.process_doc_html(html) \n \n# create a Notebook \nfrom sagenb.notebook.notebook import Notebook \nfrom sage.misc.misc import tmp_dir \nnb = Notebook(tmp_dir()+'.sagenb') \n \n# create a worksheet \nW = nb.create_new_worksheet(title, 'admin') \nW.edit_save(worksheet_txt) \n \n# export the worksheet as sws \nnb.export_worksheet(W.filename(), output, title=title) \n \n# delete the Notebook \nnb.delete() \n```\n\nIs it possible that such code get broken in future version of sagenb?",
    "created_at": "2012-07-26T14:22:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119840",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:40'></a>
The part of the script which depends on the new sagenb is the following :

```python
# Do the translation html -> worksheet txt 
from sagenb.notebook.docHTMLProcessor import docutilsHTMLProcessor 
translator = docutilsHTMLProcessor() 
worksheet_txt = translator.process_doc_html(html) 
 
# create a Notebook 
from sagenb.notebook.notebook import Notebook 
from sage.misc.misc import tmp_dir 
nb = Notebook(tmp_dir()+'.sagenb') 
 
# create a worksheet 
W = nb.create_new_worksheet(title, 'admin') 
W.edit_save(worksheet_txt) 
 
# export the worksheet as sws 
nb.export_worksheet(W.filename(), output, title=title) 
 
# delete the Notebook 
nb.delete() 
```

Is it possible that such code get broken in future version of sagenb?



---

archive/issue_comments_119841.json:
```json
{
    "body": "<a id='comment:41'></a>\nReplying to [slabbe](#comment%3A39):\n> How should a script be doctested?\n\nYou can have a look at `sage/tests/cmdline.py` for many examples.\n\nIn any case, such a test should be the subject of a new ticket.",
    "created_at": "2012-07-26T14:38:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119841",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:41'></a>
Replying to [slabbe](#comment%3A39):
> How should a script be doctested?

You can have a look at `sage/tests/cmdline.py` for many examples.

In any case, such a test should be the subject of a new ticket.



---

archive/issue_comments_119842.json:
```json
{
    "body": "<a id='comment:42'></a>\n> In any case, such a test should be the subject of a new ticket.\n\n\nThis is now #13297.",
    "created_at": "2012-07-26T16:14:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11459",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11459#issuecomment-119842",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:42'></a>
> In any case, such a test should be the subject of a new ticket.


This is now #13297.
