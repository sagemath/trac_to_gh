# Issue 11376: Remove the hardcoding of python version in setup.py and SConstruct to build sage_clib and sage itself

archive/issues_011204.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-GeorgSWeber"
    ],
    "body": "<div id=\"comment:0\"></div>\n\nCurrently to build sage (the spkg) four files are involved in major way:\n1. SConstuct to build sage-clib\n2. setup.py\n3. module_list.py\n4. sage/misc/cython.py\n\nThe last three to build the sage python extensions. setup.py, and SConstruct both have the version of python used hardcoded in them, module_list.py doesn't refer to the python version anywhere. cython.py mention the python version explicitly in doctest but smartly find the version used for building all by itself. \n\nIn this ticket I bring this smartness to SConstruct and setup.py. The advantage of doing this is that sage then can be build with either python-2.6 or 2.7 (and 3.x in the future) without patching. Of course it may still require patches to fix doctest and syntax in some parts - but you would be able to build sage in the first place without having to patch the build system. It has been found to be an impediment to testing in #9958.\n\nDepend: #11373\n\nApply:\n* [attachment: trac_11376-SConstruct.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-SConstruct.patch.gz)\n* [attachment: trac_11376-setuppy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-setuppy.patch.gz)\n* [attachment: trac_11376-msic_cythonpy-p2.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-msic_cythonpy-p2.patch.gz)\n* [attachment: trac_11376-fix_cythonpy_doctest.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-fix_cythonpy_doctest.patch.gz)\n\nDepends on #11373\n\nCC:  @strogdon @nexttime\n\nComponent: **build**\n\nAuthor: **Fran\u00e7ois Bissey**\n\nReviewer: **Mariah Lenox**\n\nMerged: **sage-4.7.2.alpha0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11376_\n\n",
    "closed_at": "2011-07-24T11:16:36Z",
    "created_at": "2011-05-25T01:12:06Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.7.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Remove the hardcoding of python version in setup.py and SConstruct to build sage_clib and sage itself",
    "type": "issue",
    "updated_at": "2011-07-24T11:16:36Z",
    "url": "https://github.com/sagemath/sage/issues/11376",
    "user": "https://github.com/kiwifb"
}
```
<div id="comment:0"></div>

Currently to build sage (the spkg) four files are involved in major way:
1. SConstuct to build sage-clib
2. setup.py
3. module_list.py
4. sage/misc/cython.py

The last three to build the sage python extensions. setup.py, and SConstruct both have the version of python used hardcoded in them, module_list.py doesn't refer to the python version anywhere. cython.py mention the python version explicitly in doctest but smartly find the version used for building all by itself. 

In this ticket I bring this smartness to SConstruct and setup.py. The advantage of doing this is that sage then can be build with either python-2.6 or 2.7 (and 3.x in the future) without patching. Of course it may still require patches to fix doctest and syntax in some parts - but you would be able to build sage in the first place without having to patch the build system. It has been found to be an impediment to testing in #9958.

Depend: #11373

Apply:
* [attachment: trac_11376-SConstruct.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-SConstruct.patch.gz)
* [attachment: trac_11376-setuppy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-setuppy.patch.gz)
* [attachment: trac_11376-msic_cythonpy-p2.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-msic_cythonpy-p2.patch.gz)
* [attachment: trac_11376-fix_cythonpy_doctest.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-fix_cythonpy_doctest.patch.gz)

Depends on #11373

CC:  @strogdon @nexttime

Component: **build**

Author: **François Bissey**

Reviewer: **Mariah Lenox**

Merged: **sage-4.7.2.alpha0**

_Issue created by migration from https://trac.sagemath.org/ticket/11376_





---

archive/issue_events_149766.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2011-05-25T01:12:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "milestone_number": null,
    "milestone_title": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149766"
}
```



---

archive/issue_events_149767.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2011-05-25T01:12:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "0000b0",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149767"
}
```



---

archive/issue_events_149768.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2011-05-25T01:12:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149768"
}
```



---

archive/issue_events_149769.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2011-05-25T01:12:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149769"
}
```



---

archive/issue_events_149770.json:
```json
{
    "actor": "https://github.com/sagetrac-GeorgSWeber",
    "created_at": "2011-05-25T01:12:06Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "subject": "https://github.com/kiwifb",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149770"
}
```



---

archive/issue_comments_114831.json:
```json
{
    "body": "Attachment: **[trac_11376-build-sage_clib.patch.gz](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build-sage_clib.patch.gz)**\n\nRemove the python version hardcoding in SConstruct, remove debian cruft as well.",
    "created_at": "2011-05-25T01:15:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114831",
    "user": "https://github.com/kiwifb"
}
```

Attachment: **[trac_11376-build-sage_clib.patch.gz](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build-sage_clib.patch.gz)**

Remove the python version hardcoding in SConstruct, remove debian cruft as well.



---

archive/issue_comments_114832.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI also remove the Debian cruft from SConstruct and setup.py at the same time.",
    "created_at": "2011-05-25T01:16:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114832",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:1" align="right">comment:1</div>

I also remove the Debian cruft from SConstruct and setup.py at the same time.



---

archive/issue_comments_114833.json:
```json
{
    "body": "Author: **Fran\u00e7ois Bissey**",
    "created_at": "2011-05-25T01:16:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114833",
    "user": "https://github.com/kiwifb"
}
```

Author: **François Bissey**



---

archive/issue_events_149771.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2011-05-25T01:23:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149771"
}
```



---

archive/issue_events_149772.json:
```json
{
    "actor": "https://github.com/sagetrac-mariah",
    "created_at": "2011-05-25T20:41:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149772"
}
```



---

archive/issue_events_149773.json:
```json
{
    "actor": "https://github.com/sagetrac-mariah",
    "created_at": "2011-05-25T20:41:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149773"
}
```



---

archive/issue_comments_114834.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\npatch [attachment: trac_11376-build-sage_clib.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build-sage_clib.patch.gz) failed to apply\nto sage-4.7.rc4:\n\n```\nsage: hg_sage.apply(\"/home/mariah/trac_11376-build-sage_clib.patch\")\ncd \"/home/mariah/sage/sage-4.7.rc4-x86_64-Linux-core2-fc/devel/sage\" && hg status\ncd \"/home/mariah/sage/sage-4.7.rc4-x86_64-Linux-core2-fc/devel/sage\" && hg status\ncd \"/home/mariah/sage/sage-4.7.rc4-x86_64-Linux-core2-fc/devel/sage\" && hg import   \"/home/mariah/trac_11376-build-sage_clib.patch\"\napplying /home/mariah/trac_11376-build-sage_clib.patch\npatching file c_lib/SConstruct\nHunk #3 FAILED at 133\n1 out of 3 hunks FAILED -- saving rejects to file c_lib/SConstruct.rej\nabort: patch failed to apply\nsage:\n```",
    "created_at": "2011-05-25T20:41:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114834",
    "user": "https://github.com/sagetrac-mariah"
}
```

<div id="comment:4" align="right">comment:4</div>

patch [attachment: trac_11376-build-sage_clib.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build-sage_clib.patch.gz) failed to apply
to sage-4.7.rc4:

```
sage: hg_sage.apply("/home/mariah/trac_11376-build-sage_clib.patch")
cd "/home/mariah/sage/sage-4.7.rc4-x86_64-Linux-core2-fc/devel/sage" && hg status
cd "/home/mariah/sage/sage-4.7.rc4-x86_64-Linux-core2-fc/devel/sage" && hg status
cd "/home/mariah/sage/sage-4.7.rc4-x86_64-Linux-core2-fc/devel/sage" && hg import   "/home/mariah/trac_11376-build-sage_clib.patch"
applying /home/mariah/trac_11376-build-sage_clib.patch
patching file c_lib/SConstruct
Hunk #3 FAILED at 133
1 out of 3 hunks FAILED -- saving rejects to file c_lib/SConstruct.rej
abort: patch failed to apply
sage:
```



---

archive/issue_comments_114835.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nThanks for looking at this Mariah. It doesn't apply because it was based on 4.7.1.alpha1. It was based on 4.7.1.alpha1 because of #11167 I cannot produce a patch that will work equally on 4.7.rc and 4.7.1.alpha. That's unfortunate but such is life. In fact I may have to rebase [attachment: trac_11376-build_setuppy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build_setuppy.patch.gz) because of #11373 in 4.7.1.alpha2.",
    "created_at": "2011-05-25T21:36:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114835",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:5" align="right">comment:5</div>

Thanks for looking at this Mariah. It doesn't apply because it was based on 4.7.1.alpha1. It was based on 4.7.1.alpha1 because of #11167 I cannot produce a patch that will work equally on 4.7.rc and 4.7.1.alpha. That's unfortunate but such is life. In fact I may have to rebase [attachment: trac_11376-build_setuppy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build_setuppy.patch.gz) because of #11373 in 4.7.1.alpha2.



---

archive/issue_comments_114836.json:
```json
{
    "body": "a version of this patch that works with 4.7.rc4",
    "created_at": "2011-05-25T21:45:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114836",
    "user": "https://github.com/kiwifb"
}
```

a version of this patch that works with 4.7.rc4



---

archive/issue_comments_114837.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nAttachment: **[trac_11376-build-sage_clib-4.7.patch.gz](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build-sage_clib-4.7.patch.gz)**\n\nJust in case you still want to test it against 4.7.rc4 use this patch [attachment: trac_11376-build-sage_clib-4.7.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build-sage_clib-4.7.patch.gz) instead.",
    "created_at": "2011-05-25T21:46:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114837",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:6" align="right">comment:6</div>

Attachment: **[trac_11376-build-sage_clib-4.7.patch.gz](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build-sage_clib-4.7.patch.gz)**

Just in case you still want to test it against 4.7.rc4 use this patch [attachment: trac_11376-build-sage_clib-4.7.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build-sage_clib-4.7.patch.gz) instead.



---

archive/issue_events_149774.json:
```json
{
    "actor": "https://github.com/sagetrac-mariah",
    "created_at": "2011-05-26T13:15:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149774"
}
```



---

archive/issue_events_149775.json:
```json
{
    "actor": "https://github.com/sagetrac-mariah",
    "created_at": "2011-05-26T13:15:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149775"
}
```



---

archive/issue_comments_114838.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@kiwifb](#comment%3A5):\n> Thanks for looking at this Mariah. It doesn't apply because it was based on 4.7.1.alpha1. \n\nApologies for the noise.  I did not realize that 4.7.1.alpha1 was out.  I have not seen any announcement of 4.7.1-alpha1 on sage-release.  Is there someplace I should be looking for such announcements?",
    "created_at": "2011-05-26T13:15:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114838",
    "user": "https://github.com/sagetrac-mariah"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@kiwifb](#comment%3A5):
> Thanks for looking at this Mariah. It doesn't apply because it was based on 4.7.1.alpha1. 

Apologies for the noise.  I did not realize that 4.7.1.alpha1 was out.  I have not seen any announcement of 4.7.1-alpha1 on sage-release.  Is there someplace I should be looking for such announcements?



---

archive/issue_comments_114839.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@sagetrac-mariah](#comment%3A7):\n> Replying to [@kiwifb](#comment%3A5):\n> > Thanks for looking at this Mariah. It doesn't apply because it was based on 4.7.1.alpha1. \n> \n> \n> Apologies for the noise.  I did not realize that 4.7.1.alpha1 was out.  I have not seen any announcement of 4.7.1-alpha1 on sage-release.  Is there someplace I should be looking for such announcements?\n\nNo apologies required. It isn't officially out but Jeroen  has \"prototypes\" alpha0, alpha1 and alpha2 already on [http://sage.math.washington.edu/home/release/](http://sage.math.washington.edu/home/release/).\nIt is a bit a pain to know that if you do something against 4.7.rc4 it will have to be put back to \"needs work\" once 4.7 is finally out and Jeroen officially announce the next alpha.",
    "created_at": "2011-05-26T13:41:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114839",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@sagetrac-mariah](#comment%3A7):
> Replying to [@kiwifb](#comment%3A5):
> > Thanks for looking at this Mariah. It doesn't apply because it was based on 4.7.1.alpha1. 
> 
> 
> Apologies for the noise.  I did not realize that 4.7.1.alpha1 was out.  I have not seen any announcement of 4.7.1-alpha1 on sage-release.  Is there someplace I should be looking for such announcements?

No apologies required. It isn't officially out but Jeroen  has "prototypes" alpha0, alpha1 and alpha2 already on [http://sage.math.washington.edu/home/release/](http://sage.math.washington.edu/home/release/).
It is a bit a pain to know that if you do something against 4.7.rc4 it will have to be put back to "needs work" once 4.7 is finally out and Jeroen officially announce the next alpha.



---

archive/issue_comments_114840.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI will add that it is perfectly acceptable to me if you want to leave this ticket for now and come back to it once a 4.7.1.alpha is released.",
    "created_at": "2011-05-26T19:11:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114840",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:9" align="right">comment:9</div>

I will add that it is perfectly acceptable to me if you want to leave this ticket for now and come back to it once a 4.7.1.alpha is released.



---

archive/issue_comments_114841.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nNow that 4.7.1.alpha0 is released this ticket should be in a reviewable state.",
    "created_at": "2011-05-27T21:23:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114841",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:10" align="right">comment:10</div>

Now that 4.7.1.alpha0 is released this ticket should be in a reviewable state.



---

archive/issue_comments_114842.json:
```json
{
    "body": "Attachment: **[trac_11376-build_setuppy.patch.gz](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build_setuppy.patch.gz)**\n\nMake setup.py python version smart, remove debian cruft. (made dependent on #11373)",
    "created_at": "2011-05-27T22:16:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114842",
    "user": "https://github.com/kiwifb"
}
```

Attachment: **[trac_11376-build_setuppy.patch.gz](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build_setuppy.patch.gz)**

Make setup.py python version smart, remove debian cruft. (made dependent on #11373)



---

archive/issue_comments_114843.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,3 +7,9 @@\n The last three to build the sage python extensions. setup.py, and SConstruct both have the version of python used hardcoded in them, module_list.py doesn't refer to the python version anywhere. cython.py mention the python version explicitly in doctest but smartly find the version used for building all by itself. \n \n In this ticket I bring this smartness to SConstruct and setup.py. The advantage of doing this is that sage then can be build with either python-2.6 or 2.7 (and 3.x in the future) without patching. Of course it may still require patches to fix doctest and syntax in some parts - but you would be able to build sage in the first place without having to patch the build system. It has been found to be an impediment to testing in #9958.\n+\n+Depend: #11373\n+\n+Apply:\n+* [attachment: trac_11376-build-sage_clib.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build-sage_clib.patch.gz)\n+* [attachment: trac_11376-build_setuppy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build_setuppy.patch.gz)\n``````\n",
    "created_at": "2011-05-27T22:18:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114843",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,3 +7,9 @@
 The last three to build the sage python extensions. setup.py, and SConstruct both have the version of python used hardcoded in them, module_list.py doesn't refer to the python version anywhere. cython.py mention the python version explicitly in doctest but smartly find the version used for building all by itself. 
 
 In this ticket I bring this smartness to SConstruct and setup.py. The advantage of doing this is that sage then can be build with either python-2.6 or 2.7 (and 3.x in the future) without patching. Of course it may still require patches to fix doctest and syntax in some parts - but you would be able to build sage in the first place without having to patch the build system. It has been found to be an impediment to testing in #9958.
+
+Depend: #11373
+
+Apply:
+* [attachment: trac_11376-build-sage_clib.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build-sage_clib.patch.gz)
+* [attachment: trac_11376-build_setuppy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build_setuppy.patch.gz)
``````




---

archive/issue_comments_114844.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nDecided to avoid problem with #11373 so make it depend on it.",
    "created_at": "2011-05-27T22:18:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114844",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:11" align="right">comment:11</div>

Decided to avoid problem with #11373 so make it depend on it.



---

archive/issue_comments_114845.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThe python documentation for sys.version says \"Do not extract version information out of it, rather, use version_info and the functions provided by the platform module.\"  It looks to me as though you could use\n\n```\nplatform.python_version()  # gives '2.6.4'\nplatform.python_version().rstrip('.', 1)[0]  # gives '2.6'\nver = platform.python_version_tuple()  # gives ('2', '6', '4')\nver[0] + '.' + ver[1]  # gives '2.6'\n```\nor\n\n```\nver = sys.version_info\nstr(ver[0]) + '.' + str(ver[1])   # gives '2.6'\n```\nI'll take a look at the rest of the patches...",
    "created_at": "2011-06-01T19:59:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114845",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:12" align="right">comment:12</div>

The python documentation for sys.version says "Do not extract version information out of it, rather, use version_info and the functions provided by the platform module."  It looks to me as though you could use

```
platform.python_version()  # gives '2.6.4'
platform.python_version().rstrip('.', 1)[0]  # gives '2.6'
ver = platform.python_version_tuple()  # gives ('2', '6', '4')
ver[0] + '.' + ver[1]  # gives '2.6'
```
or

```
ver = sys.version_info
str(ver[0]) + '.' + str(ver[1])   # gives '2.6'
```
I'll take a look at the rest of the patches...



---

archive/issue_comments_114846.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@jhpalmieri](#comment%3A12):\n> The python documentation for sys.version says \"Do not extract version information out of it, rather, use version_info and the functions provided by the platform module.\"  It looks to me as though you could use\n> \n> ```\n> platform.python_version()  # gives '2.6.4'\n> platform.python_version().rstrip('.', 1)[0]  # gives '2.6'\n> ver = platform.python_version_tuple()  # gives ('2', '6', '4')\n> ver[0] + '.' + ver[1]  # gives '2.6'\n> ```\n> or\n> \n> ```\n> ver = sys.version_info\n> str(ver[0]) + '.' + str(ver[1])   # gives '2.6'\n> ```\n> I'll take a look at the rest of the patches...\n\nOK I will rewrite that then. It was purely a case of stealing code from somewhere else. Looks cool in misc/cython.py that will be useful here. I should bring cython.py in line too.",
    "created_at": "2011-06-01T21:57:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114846",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@jhpalmieri](#comment%3A12):
> The python documentation for sys.version says "Do not extract version information out of it, rather, use version_info and the functions provided by the platform module."  It looks to me as though you could use
> 
> ```
> platform.python_version()  # gives '2.6.4'
> platform.python_version().rstrip('.', 1)[0]  # gives '2.6'
> ver = platform.python_version_tuple()  # gives ('2', '6', '4')
> ver[0] + '.' + ver[1]  # gives '2.6'
> ```
> or
> 
> ```
> ver = sys.version_info
> str(ver[0]) + '.' + str(ver[1])   # gives '2.6'
> ```
> I'll take a look at the rest of the patches...

OK I will rewrite that then. It was purely a case of stealing code from somewhere else. Looks cool in misc/cython.py that will be useful here. I should bring cython.py in line too.



---

archive/issue_comments_114847.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nBy the way, I should have provided a link: see [http://docs.python.org/library/sys.html#sys.version](http://docs.python.org/library/sys.html#sys.version) for information about sys.version, and pointers to the other options.",
    "created_at": "2011-06-01T22:33:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114847",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:14" align="right">comment:14</div>

By the way, I should have provided a link: see [http://docs.python.org/library/sys.html#sys.version](http://docs.python.org/library/sys.html#sys.version) for information about sys.version, and pointers to the other options.



---

archive/issue_comments_114848.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nNew version of patches all using the platform module. I also included sage/misc/cython.py to switch it from sys to platform. The cython patch in #9958 will be updated consequently.",
    "created_at": "2011-06-02T00:37:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114848",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:15" align="right">comment:15</div>

New version of patches all using the platform module. I also included sage/misc/cython.py to switch it from sys to platform. The cython patch in #9958 will be updated consequently.



---

archive/issue_comments_114849.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,5 +11,6 @@\n Depend: #11373\n \n Apply:\n-* [attachment: trac_11376-build-sage_clib.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build-sage_clib.patch.gz)\n-* [attachment: trac_11376-build_setuppy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build_setuppy.patch.gz)\n+* [attachment: trac_11376-SConstruct.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-SConstruct.patch.gz)\n+* [attachment: trac_11376-setuppy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-setuppy.patch.gz)\n+* [attachment: trac_11376-misc-cythonpy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-misc-cythonpy.patch.gz)\n``````\n",
    "created_at": "2011-06-02T00:37:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114849",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,5 +11,6 @@
 Depend: #11373
 
 Apply:
-* [attachment: trac_11376-build-sage_clib.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build-sage_clib.patch.gz)
-* [attachment: trac_11376-build_setuppy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-build_setuppy.patch.gz)
+* [attachment: trac_11376-SConstruct.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-SConstruct.patch.gz)
+* [attachment: trac_11376-setuppy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-setuppy.patch.gz)
+* [attachment: trac_11376-misc-cythonpy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-misc-cythonpy.patch.gz)
``````




---

archive/issue_comments_114850.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nCan there ever be version numbers like '2.10'?  Choosing the first three characters of the version string seems riskier than removing everything starting from the second dot.",
    "created_at": "2011-06-02T05:06:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114850",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:16" align="right">comment:16</div>

Can there ever be version numbers like '2.10'?  Choosing the first three characters of the version string seems riskier than removing everything starting from the second dot.



---

archive/issue_comments_114851.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@jhpalmieri](#comment%3A16):\n> Can there ever be version numbers like '2.10'?  Choosing the first three characters of the version string seems riskier than removing everything starting from the second dot.\n\n2.10 in particular no. But your general point is valid. I will address this. Thanks for pointing this out.",
    "created_at": "2011-06-02T05:16:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114851",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@jhpalmieri](#comment%3A16):
> Can there ever be version numbers like '2.10'?  Choosing the first three characters of the version string seems riskier than removing everything starting from the second dot.

2.10 in particular no. But your general point is valid. I will address this. Thanks for pointing this out.



---

archive/issue_comments_114852.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nIt also looks like I made a big typo in the placement of a % in one of the patch as well. I'll get to it ASAP (about 4hours from now).",
    "created_at": "2011-06-02T05:27:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114852",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:18" align="right">comment:18</div>

It also looks like I made a big typo in the placement of a % in one of the patch as well. I'll get to it ASAP (about 4hours from now).



---

archive/issue_comments_114853.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,4 +13,4 @@\n Apply:\n * [attachment: trac_11376-SConstruct.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-SConstruct.patch.gz)\n * [attachment: trac_11376-setuppy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-setuppy.patch.gz)\n-* [attachment: trac_11376-misc-cythonpy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-misc-cythonpy.patch.gz)\n+* [attachment: trac_11376-misc_cythonpy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-misc_cythonpy.patch.gz)\n``````\n",
    "created_at": "2011-06-02T12:47:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114853",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,4 +13,4 @@
 Apply:
 * [attachment: trac_11376-SConstruct.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-SConstruct.patch.gz)
 * [attachment: trac_11376-setuppy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-setuppy.patch.gz)
-* [attachment: trac_11376-misc-cythonpy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-misc-cythonpy.patch.gz)
+* [attachment: trac_11376-misc_cythonpy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-misc_cythonpy.patch.gz)
``````




---

archive/issue_comments_114854.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nPatch updated to use .rstrip('.', 1)[0] as it was the quickest thing to do. Fixed the syntax errors in the setup.py patch as well.",
    "created_at": "2011-06-02T12:47:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114854",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:19" align="right">comment:19</div>

Patch updated to use .rstrip('.', 1)[0] as it was the quickest thing to do. Fixed the syntax errors in the setup.py patch as well.



---

archive/issue_comments_114855.json:
```json
{
    "body": "updated  20110603 #2",
    "created_at": "2011-06-02T19:42:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114855",
    "user": "https://github.com/kiwifb"
}
```

updated  20110603 #2



---

archive/issue_comments_114856.json:
```json
{
    "body": "Attachment: **[trac_11376-SConstruct.patch.gz](https://github.com/sagemath/sage/files/ticket11376/trac_11376-SConstruct.patch.gz)**\n\nAttachment: **[trac_11376-setuppy.patch.gz](https://github.com/sagemath/sage/files/ticket11376/trac_11376-setuppy.patch.gz)**\n\nupdated  20110603 take 2",
    "created_at": "2011-06-02T19:43:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114856",
    "user": "https://github.com/kiwifb"
}
```

Attachment: **[trac_11376-SConstruct.patch.gz](https://github.com/sagemath/sage/files/ticket11376/trac_11376-SConstruct.patch.gz)**

Attachment: **[trac_11376-setuppy.patch.gz](https://github.com/sagemath/sage/files/ticket11376/trac_11376-setuppy.patch.gz)**

updated  20110603 take 2



---

archive/issue_comments_114857.json:
```json
{
    "body": "updated  20110603 take 2",
    "created_at": "2011-06-02T19:44:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114857",
    "user": "https://github.com/kiwifb"
}
```

updated  20110603 take 2



---

archive/issue_comments_114858.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nAttachment: **[trac_11376-msic_cythonpy.patch.gz](https://github.com/sagemath/sage/files/ticket11376/trac_11376-msic_cythonpy.patch.gz)**\n\nOK so I should have tested what John said before adopting it, even at half past midnight. He meant rsplit not rstrip.",
    "created_at": "2011-06-02T19:46:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114858",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:20" align="right">comment:20</div>

Attachment: **[trac_11376-msic_cythonpy.patch.gz](https://github.com/sagemath/sage/files/ticket11376/trac_11376-msic_cythonpy.patch.gz)**

OK so I should have tested what John said before adopting it, even at half past midnight. He meant rsplit not rstrip.



---

archive/issue_comments_114859.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,4 +13,4 @@\n Apply:\n * [attachment: trac_11376-SConstruct.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-SConstruct.patch.gz)\n * [attachment: trac_11376-setuppy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-setuppy.patch.gz)\n-* [attachment: trac_11376-misc_cythonpy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-misc_cythonpy.patch.gz)\n+* [attachment: trac_11376-msic_cythonpy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-msic_cythonpy.patch.gz)\n``````\n",
    "created_at": "2011-06-02T19:46:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114859",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,4 +13,4 @@
 Apply:
 * [attachment: trac_11376-SConstruct.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-SConstruct.patch.gz)
 * [attachment: trac_11376-setuppy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-setuppy.patch.gz)
-* [attachment: trac_11376-misc_cythonpy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-misc_cythonpy.patch.gz)
+* [attachment: trac_11376-msic_cythonpy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-msic_cythonpy.patch.gz)
``````




---

archive/issue_comments_114860.json:
```json
{
    "body": "Dependencies: **#11373**",
    "created_at": "2011-06-09T12:28:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114860",
    "user": "https://github.com/kiwifb"
}
```

Dependencies: **#11373**



---

archive/issue_events_149776.json:
```json
{
    "actor": "https://github.com/sagetrac-mariah",
    "created_at": "2011-06-14T13:10:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149776"
}
```



---

archive/issue_events_149777.json:
```json
{
    "actor": "https://github.com/sagetrac-mariah",
    "created_at": "2011-06-14T13:10:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149777"
}
```



---

archive/issue_comments_114861.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nOn skynet/eno (x86_64-Linux-core2-fc), I applied the three patches to sage-4.7.1.alpha2, did 'sage -b', then 'make testlong'.  I got the following failure:\n\n```\neno% ./sage -t  -long -force_lib \"devel/sage/sage/misc/cython.py\"\nsage -t -long -force_lib \"devel/sage/sage/misc/cython.py\"   \n**********************************************************************\nFile \"/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/misc/cython.py\", line 146:\n    sage: pyx_preparse(\"\")\nExpected:\n    ('\\ninclude \"interrupt.pxi\"  # ctrl-c interrupt block support\\ninclude \"stdsage.pxi\"  # ctrl-c interrupt block support\\n\\ninclude \"cdefs.pxi\"\\n',\n    ['mpfr',\n    'gmp',\n    'gmpxx',\n    'stdc++',\n    'pari',\n    'm',\n    'curvesntl',\n    'g0nntl',\n    'jcntl',\n    'rankntl',\n    'gsl',\n    '...blas',\n    ...,\n    'ntl',\n    'csage'],\n    ['.../local/include/csage/',\n    '.../local/include/',\n    '.../local/include/python2.6/',\n    '.../devel/sage/sage/ext/',\n    '.../devel/sage/',\n    '.../devel/sage/sage/gsl/'],\n    'c',\n    [])\nGot:\n    ('\\ninclude \"interrupt.pxi\"  # ctrl-c interrupt block support\\ninclude \"stdsage.pxi\"  # ctrl-c interrupt block support\\n\\ninclude \"cdefs.pxi\"\\n', ['mpfr', 'gmp', 'gmpxx', 'stdc++', 'pari', 'm', 'curvesntl', 'g0nntl', 'jcntl', 'rankntl', 'gsl', 'gslcblas', 'atlas', 'ntl', 'csage'], ['/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/csage/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/python2.6/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//lib/python2.6/site-packages/numpy/core/include', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/ext/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/gsl/'], 'c', [])\n**********************************************************************\nFile \"/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/misc/cython.py\", line 188:\n    sage: inc\nExpected:\n    ['bar',\n    '.../local/include/csage/',\n    '.../local/include/',\n    '.../local/include/python2.6/',\n    '.../devel/sage/sage/ext/',\n    '.../devel/sage/',\n    '.../devel/sage/sage/gsl/']\nGot:\n    ['bar', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/csage/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/python2.6/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//lib/python2.6/site-packages/numpy/core/include', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/ext/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/gsl/']\n**********************************************************************\n1 items had failures:\n   2 of  10 in __main__.example_2\n```",
    "created_at": "2011-06-14T13:10:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114861",
    "user": "https://github.com/sagetrac-mariah"
}
```

<div id="comment:22" align="right">comment:22</div>

On skynet/eno (x86_64-Linux-core2-fc), I applied the three patches to sage-4.7.1.alpha2, did 'sage -b', then 'make testlong'.  I got the following failure:

```
eno% ./sage -t  -long -force_lib "devel/sage/sage/misc/cython.py"
sage -t -long -force_lib "devel/sage/sage/misc/cython.py"   
**********************************************************************
File "/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/misc/cython.py", line 146:
    sage: pyx_preparse("")
Expected:
    ('\ninclude "interrupt.pxi"  # ctrl-c interrupt block support\ninclude "stdsage.pxi"  # ctrl-c interrupt block support\n\ninclude "cdefs.pxi"\n',
    ['mpfr',
    'gmp',
    'gmpxx',
    'stdc++',
    'pari',
    'm',
    'curvesntl',
    'g0nntl',
    'jcntl',
    'rankntl',
    'gsl',
    '...blas',
    ...,
    'ntl',
    'csage'],
    ['.../local/include/csage/',
    '.../local/include/',
    '.../local/include/python2.6/',
    '.../devel/sage/sage/ext/',
    '.../devel/sage/',
    '.../devel/sage/sage/gsl/'],
    'c',
    [])
Got:
    ('\ninclude "interrupt.pxi"  # ctrl-c interrupt block support\ninclude "stdsage.pxi"  # ctrl-c interrupt block support\n\ninclude "cdefs.pxi"\n', ['mpfr', 'gmp', 'gmpxx', 'stdc++', 'pari', 'm', 'curvesntl', 'g0nntl', 'jcntl', 'rankntl', 'gsl', 'gslcblas', 'atlas', 'ntl', 'csage'], ['/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/csage/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/python2.6/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//lib/python2.6/site-packages/numpy/core/include', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/ext/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/gsl/'], 'c', [])
**********************************************************************
File "/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/misc/cython.py", line 188:
    sage: inc
Expected:
    ['bar',
    '.../local/include/csage/',
    '.../local/include/',
    '.../local/include/python2.6/',
    '.../devel/sage/sage/ext/',
    '.../devel/sage/',
    '.../devel/sage/sage/gsl/']
Got:
    ['bar', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/csage/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/python2.6/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//lib/python2.6/site-packages/numpy/core/include', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/ext/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/gsl/']
**********************************************************************
1 items had failures:
   2 of  10 in __main__.example_2
```



---

archive/issue_comments_114862.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nHi Mariah,\n\nI fixed this test as part of #9958 in [https://github.com/sagemath/sage/files/ticket9958/trac_9958-fix-misc_cythonpy.patch.gz](https://github.com/sagemath/sage/files/ticket9958/trac_9958-fix-misc_cythonpy.patch.gz) I thought it was appearing because of python-2.7.\n\nIf it shows up for you with python-2.6 it is strange that it didn't before the patch.\n\nIn any case if it shows up for you the above patch will have to be split and moved to this ticket. Just a few minutes.",
    "created_at": "2011-06-14T13:20:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114862",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:23" align="right">comment:23</div>

Hi Mariah,

I fixed this test as part of #9958 in [https://github.com/sagemath/sage/files/ticket9958/trac_9958-fix-misc_cythonpy.patch.gz](https://github.com/sagemath/sage/files/ticket9958/trac_9958-fix-misc_cythonpy.patch.gz) I thought it was appearing because of python-2.7.

If it shows up for you with python-2.6 it is strange that it didn't before the patch.

In any case if it shows up for you the above patch will have to be split and moved to this ticket. Just a few minutes.



---

archive/issue_comments_114863.json:
```json
{
    "body": "Attachment: **[trac_11376-fix_cythonpy_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket11376/trac_11376-fix_cythonpy_doctest.patch.gz)**\n\nfix the cython.py doctest for the appearance on numpy",
    "created_at": "2011-06-14T13:28:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114863",
    "user": "https://github.com/kiwifb"
}
```

Attachment: **[trac_11376-fix_cythonpy_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket11376/trac_11376-fix_cythonpy_doctest.patch.gz)**

fix the cython.py doctest for the appearance on numpy



---

archive/issue_events_149778.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2011-06-14T13:29:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149778"
}
```



---

archive/issue_events_149779.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2011-06-14T13:29:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149779"
}
```



---

archive/issue_comments_114864.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nOK new patch added.",
    "created_at": "2011-06-14T13:29:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114864",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:24" align="right">comment:24</div>

OK new patch added.



---

archive/issue_comments_114865.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,3 +14,4 @@\n * [attachment: trac_11376-SConstruct.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-SConstruct.patch.gz)\n * [attachment: trac_11376-setuppy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-setuppy.patch.gz)\n * [attachment: trac_11376-msic_cythonpy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-msic_cythonpy.patch.gz)\n+* [attachment: trac_11376-fix_cythonpy_doctest.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-fix_cythonpy_doctest.patch.gz)\n``````\n",
    "created_at": "2011-06-14T13:29:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114865",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,3 +14,4 @@
 * [attachment: trac_11376-SConstruct.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-SConstruct.patch.gz)
 * [attachment: trac_11376-setuppy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-setuppy.patch.gz)
 * [attachment: trac_11376-msic_cythonpy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-msic_cythonpy.patch.gz)
+* [attachment: trac_11376-fix_cythonpy_doctest.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-fix_cythonpy_doctest.patch.gz)
``````




---

archive/issue_comments_114866.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nWhat about the\u00a0\n\n/local//include/ \u00a0and \u00a0/local//lib/\n\nin the returned results? Could this also cause a failure? I'm seeing this also in failure of the cython.py test when the patches of\u00a0#9958\u00a0are applied. And the numpy fix is already in those patches.",
    "created_at": "2011-06-14T15:46:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114866",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:25" align="right">comment:25</div>

What about the 

/local//include/  and  /local//lib/

in the returned results? Could this also cause a failure? I'm seeing this also in failure of the cython.py test when the patches of #9958 are applied. And the numpy fix is already in those patches.



---

archive/issue_events_149780.json:
```json
{
    "actor": "https://github.com/sagetrac-mariah",
    "created_at": "2011-06-14T17:12:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149780"
}
```



---

archive/issue_events_149781.json:
```json
{
    "actor": "https://github.com/sagetrac-mariah",
    "created_at": "2011-06-14T17:12:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149781"
}
```



---

archive/issue_comments_114867.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nOn skynet/eno (x86_64-Linux-core2-fc), I applied all four patches to sage-4.7.1.alpha1, did 'sage -b', but I still get the error \n\n```\nsage -t -long -force_lib \"devel/sage/sage/misc/cython.py\"   \n**********************************************************************\nFile \"/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/misc/cython.py\", line 146:\n    sage: pyx_preparse(\"\")\nExpected:\n    ('\\ninclude \"interrupt.pxi\"  # ctrl-c interrupt block support\\ninclude \"stdsage.pxi\"  # ctrl-c interrupt block support\\n\\ninclude \"cdefs.pxi\"\\n',\n    ['mpfr',\n    'gmp',\n    'gmpxx',\n    'stdc++',\n    'pari',\n    'm',\n    'curvesntl',\n    'g0nntl',\n    'jcntl',\n    'rankntl',\n    'gsl',\n    '...blas',\n    ...,\n    'ntl',\n    'csage'],\n    ['.../local/include/csage/',\n    '.../local/include/',\n    '.../local/include/python2.6/',\n    '.../local/lib/python2.6/site-packages/numpy/core/include',\n    '.../devel/sage/sage/ext/',\n    '.../devel/sage/',\n    '.../devel/sage/sage/gsl/'],\n    'c',\n    [])\nGot:\n    ('\\ninclude \"interrupt.pxi\"  # ctrl-c interrupt block support\\ninclude \"stdsage.pxi\"  # ctrl-c interrupt block support\\n\\ninclude \"cdefs.pxi\"\\n', ['mpfr', 'gmp', 'gmpxx', 'stdc++', 'pari', 'm', 'curvesntl', 'g0nntl', 'jcntl', 'rankntl', 'gsl', 'gslcblas', 'atlas', 'ntl', 'csage'], ['/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/csage/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/python2.6/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//lib/python2.6/site-packages/numpy/core/include', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/ext/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/gsl/'], 'c', [])\n**********************************************************************\nFile \"/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/misc/cython.py\", line 189:\n    sage: inc\nExpected:\n    ['bar',\n    '.../local/include/csage/',\n    '.../local/include/',\n    '.../local/include/python2.6/',\n    '.../local/lib/python2.6/site-packages/numpy/core/include',\n    '.../devel/sage/sage/ext/',\n    '.../devel/sage/',\n    '.../devel/sage/sage/gsl/']\nGot:\n    ['bar', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/csage/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/python2.6/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//lib/python2.6/site-packages/numpy/core/include', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/ext/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/gsl/']\n**********************************************************************\n1 items had failures:\n   2 of  10 in __main__.example_2\n***Test Failed*** 2 failures.\nFor whitespace errors, see the file /home/mariah/.sage//tmp/.doctest_cython.py\n         [4.7 s]\n \n----------------------------------------------------------------------\nThe following tests failed:\n```",
    "created_at": "2011-06-14T17:12:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114867",
    "user": "https://github.com/sagetrac-mariah"
}
```

<div id="comment:26" align="right">comment:26</div>

On skynet/eno (x86_64-Linux-core2-fc), I applied all four patches to sage-4.7.1.alpha1, did 'sage -b', but I still get the error 

```
sage -t -long -force_lib "devel/sage/sage/misc/cython.py"   
**********************************************************************
File "/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/misc/cython.py", line 146:
    sage: pyx_preparse("")
Expected:
    ('\ninclude "interrupt.pxi"  # ctrl-c interrupt block support\ninclude "stdsage.pxi"  # ctrl-c interrupt block support\n\ninclude "cdefs.pxi"\n',
    ['mpfr',
    'gmp',
    'gmpxx',
    'stdc++',
    'pari',
    'm',
    'curvesntl',
    'g0nntl',
    'jcntl',
    'rankntl',
    'gsl',
    '...blas',
    ...,
    'ntl',
    'csage'],
    ['.../local/include/csage/',
    '.../local/include/',
    '.../local/include/python2.6/',
    '.../local/lib/python2.6/site-packages/numpy/core/include',
    '.../devel/sage/sage/ext/',
    '.../devel/sage/',
    '.../devel/sage/sage/gsl/'],
    'c',
    [])
Got:
    ('\ninclude "interrupt.pxi"  # ctrl-c interrupt block support\ninclude "stdsage.pxi"  # ctrl-c interrupt block support\n\ninclude "cdefs.pxi"\n', ['mpfr', 'gmp', 'gmpxx', 'stdc++', 'pari', 'm', 'curvesntl', 'g0nntl', 'jcntl', 'rankntl', 'gsl', 'gslcblas', 'atlas', 'ntl', 'csage'], ['/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/csage/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/python2.6/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//lib/python2.6/site-packages/numpy/core/include', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/ext/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/gsl/'], 'c', [])
**********************************************************************
File "/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/misc/cython.py", line 189:
    sage: inc
Expected:
    ['bar',
    '.../local/include/csage/',
    '.../local/include/',
    '.../local/include/python2.6/',
    '.../local/lib/python2.6/site-packages/numpy/core/include',
    '.../devel/sage/sage/ext/',
    '.../devel/sage/',
    '.../devel/sage/sage/gsl/']
Got:
    ['bar', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/csage/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//include/python2.6/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/local//lib/python2.6/site-packages/numpy/core/include', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/ext/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/', '/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc-review-11376/devel/sage/sage/gsl/']
**********************************************************************
1 items had failures:
   2 of  10 in __main__.example_2
***Test Failed*** 2 failures.
For whitespace errors, see the file /home/mariah/.sage//tmp/.doctest_cython.py
         [4.7 s]
 
----------------------------------------------------------------------
The following tests failed:
```



---

archive/issue_comments_114868.json:
```json
{
    "body": "Attachment: **[trac_11376-msic_cythonpy-p2.patch.gz](https://github.com/sagemath/sage/files/ticket11376/trac_11376-msic_cythonpy-p2.patch.gz)**\n\nPatch to misc/cython.py with the right number of slashes",
    "created_at": "2011-06-14T19:10:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114868",
    "user": "https://github.com/kiwifb"
}
```

Attachment: **[trac_11376-msic_cythonpy-p2.patch.gz](https://github.com/sagemath/sage/files/ticket11376/trac_11376-msic_cythonpy-p2.patch.gz)**

Patch to misc/cython.py with the right number of slashes



---

archive/issue_comments_114869.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,5 +13,5 @@\n Apply:\n * [attachment: trac_11376-SConstruct.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-SConstruct.patch.gz)\n * [attachment: trac_11376-setuppy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-setuppy.patch.gz)\n-* [attachment: trac_11376-msic_cythonpy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-msic_cythonpy.patch.gz)\n+* [attachment: trac_11376-msic_cythonpy-p2.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-msic_cythonpy-p2.patch.gz)\n * [attachment: trac_11376-fix_cythonpy_doctest.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-fix_cythonpy_doctest.patch.gz)\n``````\n",
    "created_at": "2011-06-14T19:12:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114869",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,5 +13,5 @@
 Apply:
 * [attachment: trac_11376-SConstruct.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-SConstruct.patch.gz)
 * [attachment: trac_11376-setuppy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-setuppy.patch.gz)
-* [attachment: trac_11376-msic_cythonpy.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-msic_cythonpy.patch.gz)
+* [attachment: trac_11376-msic_cythonpy-p2.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-msic_cythonpy-p2.patch.gz)
 * [attachment: trac_11376-fix_cythonpy_doctest.patch](https://github.com/sagemath/sage/files/ticket11376/trac_11376-fix_cythonpy_doctest.patch.gz)
``````




---

archive/issue_comments_114870.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nThanks for pointing it out Steve I had missed it completely. We should have a uniform definition of SAGE_LOCAL, sometimes it has a final \"/\" and sometimes it doesn't. So I updated the misc_cythonpy patch to -p2. Hope we got everything now.",
    "created_at": "2011-06-14T19:12:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114870",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:27" align="right">comment:27</div>

Thanks for pointing it out Steve I had missed it completely. We should have a uniform definition of SAGE_LOCAL, sometimes it has a final "/" and sometimes it doesn't. So I updated the misc_cythonpy patch to -p2. Hope we got everything now.



---

archive/issue_events_149782.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2011-06-14T19:12:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149782"
}
```



---

archive/issue_events_149783.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2011-06-14T19:12:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149783"
}
```



---

archive/issue_events_149784.json:
```json
{
    "actor": "https://github.com/sagetrac-mariah",
    "created_at": "2011-06-16T13:22:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149784"
}
```



---

archive/issue_events_149785.json:
```json
{
    "actor": "https://github.com/sagetrac-mariah",
    "created_at": "2011-06-16T13:22:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149785"
}
```



---

archive/issue_comments_114871.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nApplied all patches to sage-4.7.1.alpha2, did 'sage -b', and 'make testlong'.  All tests passed.  Positive review!  (finally!)",
    "created_at": "2011-06-16T13:22:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114871",
    "user": "https://github.com/sagetrac-mariah"
}
```

<div id="comment:28" align="right">comment:28</div>

Applied all patches to sage-4.7.1.alpha2, did 'sage -b', and 'make testlong'.  All tests passed.  Positive review!  (finally!)



---

archive/issue_comments_114872.json:
```json
{
    "body": "Reviewer: **Mariah Lenox**",
    "created_at": "2011-06-16T13:22:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114872",
    "user": "https://github.com/sagetrac-mariah"
}
```

Reviewer: **Mariah Lenox**



---

archive/issue_events_149786.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-06-16T21:31:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "milestone_number": null,
    "milestone_title": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149786"
}
```



---

archive/issue_events_149787.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-06-16T21:31:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "milestone_number": null,
    "milestone_title": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149787"
}
```



---

archive/issue_comments_114873.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nA little word of thanks, in the right bug this time (note to self don't do this again at 1:30am):\n\nThank you Mariah for the review. Thank you John for the suggestion to make it better. Thank you Steve for pointing the obvious.\n\nThank you all for making this reach this stage. Hopefully this will be in 4.7.2.alpha0.",
    "created_at": "2011-06-16T23:21:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114873",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:30" align="right">comment:30</div>

A little word of thanks, in the right bug this time (note to self don't do this again at 1:30am):

Thank you Mariah for the review. Thank you John for the suggestion to make it better. Thank you Steve for pointing the obvious.

Thank you all for making this reach this stage. Hopefully this will be in 4.7.2.alpha0.



---

archive/issue_comments_114874.json:
```json
{
    "body": "Merged: **sage-4.7.2.alpha0**",
    "created_at": "2011-07-24T11:16:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11376#issuecomment-114874",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.7.2.alpha0**



---

archive/issue_events_149788.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-07-24T11:16:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149788"
}
```



---

archive/issue_events_149789.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-07-24T11:16:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11376",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11376#event-149789"
}
```
