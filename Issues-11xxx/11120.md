# Issue 11120: Autodetect installed 3-way merge programs (invalidates #4434)

archive/issues_010981.json:
```json
{
    "assignees": [],
    "body": "Depends on #10594, which already incorporates the patch to the Mercurial spkg (trac_11120-re-fix-trac_4434.mercurial-spkg.patch) attached here.\n\n---\nIn Mercurial versions earlier than 1.0, a script called `hgmerge` was installed to the system when you installed mercurial. This script called whatever 3-way merge programs you had installed in order to manually intervene in Mercurial's merging process when it couldn't figure out how to resolve a conflict.\n\nThis was deprecated in version 1.0, and now Mercurial calls 3-way merge programs directly instead of relying on an `hgmerge` script. In order to make this work properly, one should set the proper configuration variables to help Mercurial find any installed 3-way merge programs.\n\nThere is a file, `contrib/mergetools.rc`, in the Mercurial source distribution which provides exactly these configuration variables, though the upstream installer script does not actually install it anywhere.\n\nThe problem reported at trac #4434 was caused, I guess, by the fact that `hgmerge` was deprecated and we sage people didn't notice, so the patch there simply caused our distribution of Mercurial to continue using `hgmerge`. The patch also did this only on the OS X platform, though as far as I can tell the same fundamental problem actually appears on Linux as well (see comments below).\n\nA better way to fix the problem on trac #4434, and fix it for Linux too, would be to use the `contrib/mergetools.rc` file as it was designed to be used.\n\n---\n\nApply only [attachment: trac_11120-no-hgmerge.patch.gz](https://github.com/sagemath/sage/files/ticket11120/trac_11120-no-hgmerge.patch.gz) to the Sage scripts repository.\n\n\nDepends on #4434\nDepends on #10594\n\nKeywords: **mercurial osx sd31**\n\nAuthor: **Keshav Kini, John Palmieri**\n\nReviewer: **John Palmieri, Keshav Kini**\n\nMerged: **sage-4.7.2.alpha3**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11120_\n\n",
    "closed_at": "2011-09-13T10:59:44Z",
    "created_at": "2011-04-04T08:37:12Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20scripts",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.7.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Autodetect installed 3-way merge programs (invalidates #4434)",
    "type": "issue",
    "updated_at": "2011-09-13T10:59:44Z",
    "url": "https://github.com/sagemath/sage/issues/11120",
    "user": "https://github.com/kini"
}
```
Depends on #10594, which already incorporates the patch to the Mercurial spkg (trac_11120-re-fix-trac_4434.mercurial-spkg.patch) attached here.

---
In Mercurial versions earlier than 1.0, a script called `hgmerge` was installed to the system when you installed mercurial. This script called whatever 3-way merge programs you had installed in order to manually intervene in Mercurial's merging process when it couldn't figure out how to resolve a conflict.

This was deprecated in version 1.0, and now Mercurial calls 3-way merge programs directly instead of relying on an `hgmerge` script. In order to make this work properly, one should set the proper configuration variables to help Mercurial find any installed 3-way merge programs.

There is a file, `contrib/mergetools.rc`, in the Mercurial source distribution which provides exactly these configuration variables, though the upstream installer script does not actually install it anywhere.

The problem reported at trac #4434 was caused, I guess, by the fact that `hgmerge` was deprecated and we sage people didn't notice, so the patch there simply caused our distribution of Mercurial to continue using `hgmerge`. The patch also did this only on the OS X platform, though as far as I can tell the same fundamental problem actually appears on Linux as well (see comments below).

A better way to fix the problem on trac #4434, and fix it for Linux too, would be to use the `contrib/mergetools.rc` file as it was designed to be used.

---

Apply only [attachment: trac_11120-no-hgmerge.patch.gz](https://github.com/sagemath/sage/files/ticket11120/trac_11120-no-hgmerge.patch.gz) to the Sage scripts repository.


Depends on #4434
Depends on #10594

Keywords: **mercurial osx sd31**

Author: **Keshav Kini, John Palmieri**

Reviewer: **John Palmieri, Keshav Kini**

Merged: **sage-4.7.2.alpha3**

_Issue created by migration from https://trac.sagemath.org/ticket/11120_





---

archive/issue_events_134574.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-04-04T08:37:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "milestone_number": null,
    "milestone_title": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134574"
}
```



---

archive/issue_events_134575.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-04-04T08:37:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages",
    "label_color": "000080",
    "label_name": "component: packages",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134575"
}
```



---

archive/issue_events_134576.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-04-04T08:37:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134576"
}
```



---

archive/issue_events_134577.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-04-04T08:37:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134577"
}
```



---

archive/issue_comments_112480.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nhmm, how does one check that removing hgmerge does not break things?\nreading #4434 says it's about a 3-way graphical thing, of which I am clueless...",
    "created_at": "2011-04-04T14:05:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112480",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:1'>Comment 1:</a>
hmm, how does one check that removing hgmerge does not break things?
reading #4434 says it's about a 3-way graphical thing, of which I am clueless...



---

archive/issue_comments_112481.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nAs we talked about in person, I guess the way to test it would be to try using `sage -hg` to merge files which cannot be automatically merged. I created [this minimal example of such a repository and such a file](http://sage.math.washington.edu/home/keshav/temp/hgmerge-test/), which you then pulled and tried out, using `sage -hg` with `$SAGE_ROOT/bin/hgmerge` removed. This worked just as well as it works on my Linux machine:\n\n```\nkeshav@esterhazy ~/temp/hgmerge-test $ sage -hg log --style=compact\n2[tip]:0   212fc073ffa9   2011-04-04 08:10 -0700   kini\n  Three\n\n1   478fc08a9390   2011-04-04 08:09 -0700   kini\n  Two\n\n0   a8cccf400996   2011-04-04 08:08 -0700   kini\n  One\n\nkeshav@esterhazy ~/temp/hgmerge-test $ sage -hg merge\nmerging somefile\nwarning: conflicts during merge.\nmerging somefile failed!\n0 files updated, 0 files merged, 0 files removed, 1 files unresolved\nuse 'hg resolve' to retry unresolved file merges or 'hg update -C' to abandon\nkeshav@esterhazy ~/temp/hgmerge-test $ \n```\n\nNote that this is not really an *error* - it's just the lack of a default merge program being installed. Could it be possible that the problem that occasioned #4474 is present on Linux as well?\n\nThere is actually a sort of \"merge tool autodect script\" (actually just some configuration entries making mercurial smarter about where to find a range of common merging tools) which is provided but not installed by the upstream distribution of Mercurial, and which lies in the file `src/contrib/mergetools.rc` within the spkg's root directory. Putting this in `$SAGE_LOCAL/etc/mercurial/hgrc.d/` should cause merge program problems to go away. I'll write a patch...",
    "created_at": "2011-04-04T16:37:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112481",
    "user": "https://github.com/kini"
}
```

<a id='comment:2'>Comment 2:</a>
As we talked about in person, I guess the way to test it would be to try using `sage -hg` to merge files which cannot be automatically merged. I created [this minimal example of such a repository and such a file](http://sage.math.washington.edu/home/keshav/temp/hgmerge-test/), which you then pulled and tried out, using `sage -hg` with `$SAGE_ROOT/bin/hgmerge` removed. This worked just as well as it works on my Linux machine:

```
keshav@esterhazy ~/temp/hgmerge-test $ sage -hg log --style=compact
2[tip]:0   212fc073ffa9   2011-04-04 08:10 -0700   kini
  Three

1   478fc08a9390   2011-04-04 08:09 -0700   kini
  Two

0   a8cccf400996   2011-04-04 08:08 -0700   kini
  One

keshav@esterhazy ~/temp/hgmerge-test $ sage -hg merge
merging somefile
warning: conflicts during merge.
merging somefile failed!
0 files updated, 0 files merged, 0 files removed, 1 files unresolved
use 'hg resolve' to retry unresolved file merges or 'hg update -C' to abandon
keshav@esterhazy ~/temp/hgmerge-test $ 
```

Note that this is not really an *error* - it's just the lack of a default merge program being installed. Could it be possible that the problem that occasioned #4474 is present on Linux as well?

There is actually a sort of "merge tool autodect script" (actually just some configuration entries making mercurial smarter about where to find a range of common merging tools) which is provided but not installed by the upstream distribution of Mercurial, and which lies in the file `src/contrib/mergetools.rc` within the spkg's root directory. Putting this in `$SAGE_LOCAL/etc/mercurial/hgrc.d/` should cause merge program problems to go away. I'll write a patch...



---

archive/issue_comments_112482.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,3 +5,5 @@\n >Before Mercurial 1.0, a script named hgmerge was installed by default. As of Mercurial 1.0, hgmerge is no longer installed (and it should not be distributed with Mercurial), but hg still uses it, if it's present on the system and no other merge tools are configured. See [MergeToolConfiguration](http://mercurial.selenic.com/wiki/MergeToolConfiguration) for the new mechanism.\n \n Hopefully removing this hgmerge file will simply work on OS X - otherwise, a solution should be made using hgrc as described at [MergeToolConfiguration](http://mercurial.selenic.com/wiki/MergeToolConfiguration).\n+\n+Apply trac_11120-re-fix-trac_4434.mercurial-spkg.patch to mercurial spkg base repository\n``````\n",
    "created_at": "2011-04-04T17:32:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112482",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,3 +5,5 @@
 >Before Mercurial 1.0, a script named hgmerge was installed by default. As of Mercurial 1.0, hgmerge is no longer installed (and it should not be distributed with Mercurial), but hg still uses it, if it's present on the system and no other merge tools are configured. See [MergeToolConfiguration](http://mercurial.selenic.com/wiki/MergeToolConfiguration) for the new mechanism.
 
 Hopefully removing this hgmerge file will simply work on OS X - otherwise, a solution should be made using hgrc as described at [MergeToolConfiguration](http://mercurial.selenic.com/wiki/MergeToolConfiguration).
+
+Apply trac_11120-re-fix-trac_4434.mercurial-spkg.patch to mercurial spkg base repository
``````




---

archive/issue_comments_112483.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,9 +1,13 @@\n-#4434 should be backed out and fixed (if even still necessary) in a more modern fashion. In the newer versions of Mercurial currently shipped with sage, hgmerge is obsolete (and in fact has been since 1.0, which might explain why no script at all was being copied over, as mentioned in the description of #4434). It's not a good idea to rely on outdated functionality.\n+In Mercurial versions earlier than 1.0, a script called `hgmerge` was installed to the system when you installed mercurial. This script called whatever 3-way merge programs you had installed in order to manually intervene in Mercurial's merging process when it couldn't figure out how to resolve a conflict.\n \n-See http://mercurial.selenic.com/wiki/hgmerge :\n+This was deprecated in version 1.0, and now Mercurial calls 3-way merge programs directly instead of relying on an `hgmerge` script. In order to make this work properly, one should set the proper configuration variables to help Mercurial find any installed 3-way merge programs.\n \n->Before Mercurial 1.0, a script named hgmerge was installed by default. As of Mercurial 1.0, hgmerge is no longer installed (and it should not be distributed with Mercurial), but hg still uses it, if it's present on the system and no other merge tools are configured. See [MergeToolConfiguration](http://mercurial.selenic.com/wiki/MergeToolConfiguration) for the new mechanism.\n+There is a file, `contrib/mergetools.rc`, in the Mercurial source distribution which provides exactly these configuration variables, though the upstream installer script does not actually install it anywhere.\n \n-Hopefully removing this hgmerge file will simply work on OS X - otherwise, a solution should be made using hgrc as described at [MergeToolConfiguration](http://mercurial.selenic.com/wiki/MergeToolConfiguration).\n+The problem reported at trac #4434 was caused, I guess, by the fact that `hgmerge` was deprecated and we sage people didn't notice, so the patch there simply caused our distribution of Mercurial to continue using `hgmerge`. The patch also did this only on the OS X platform, though as far as I can tell the same fundamental problem actually appears on Linux as well (see comments below).\n+\n+A better way to fix the problem on trac #4434, and fix it for Linux too, would be to use the `contrib/mergetools.rc` file as it was designed to be used.\n \n Apply trac_11120-re-fix-trac_4434.mercurial-spkg.patch to mercurial spkg base repository\n+\n+Depends on #11121\n``````\n",
    "created_at": "2011-04-05T10:19:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112483",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,9 +1,13 @@
-#4434 should be backed out and fixed (if even still necessary) in a more modern fashion. In the newer versions of Mercurial currently shipped with sage, hgmerge is obsolete (and in fact has been since 1.0, which might explain why no script at all was being copied over, as mentioned in the description of #4434). It's not a good idea to rely on outdated functionality.
+In Mercurial versions earlier than 1.0, a script called `hgmerge` was installed to the system when you installed mercurial. This script called whatever 3-way merge programs you had installed in order to manually intervene in Mercurial's merging process when it couldn't figure out how to resolve a conflict.
 
-See http://mercurial.selenic.com/wiki/hgmerge :
+This was deprecated in version 1.0, and now Mercurial calls 3-way merge programs directly instead of relying on an `hgmerge` script. In order to make this work properly, one should set the proper configuration variables to help Mercurial find any installed 3-way merge programs.
 
->Before Mercurial 1.0, a script named hgmerge was installed by default. As of Mercurial 1.0, hgmerge is no longer installed (and it should not be distributed with Mercurial), but hg still uses it, if it's present on the system and no other merge tools are configured. See [MergeToolConfiguration](http://mercurial.selenic.com/wiki/MergeToolConfiguration) for the new mechanism.
+There is a file, `contrib/mergetools.rc`, in the Mercurial source distribution which provides exactly these configuration variables, though the upstream installer script does not actually install it anywhere.
 
-Hopefully removing this hgmerge file will simply work on OS X - otherwise, a solution should be made using hgrc as described at [MergeToolConfiguration](http://mercurial.selenic.com/wiki/MergeToolConfiguration).
+The problem reported at trac #4434 was caused, I guess, by the fact that `hgmerge` was deprecated and we sage people didn't notice, so the patch there simply caused our distribution of Mercurial to continue using `hgmerge`. The patch also did this only on the OS X platform, though as far as I can tell the same fundamental problem actually appears on Linux as well (see comments below).
+
+A better way to fix the problem on trac #4434, and fix it for Linux too, would be to use the `contrib/mergetools.rc` file as it was designed to be used.
 
 Apply trac_11120-re-fix-trac_4434.mercurial-spkg.patch to mercurial spkg base repository
+
+Depends on #11121
``````




---

archive/issue_events_134578.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-04-05T10:19:45Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "title_is": "Autodetect installed 3-way merge programs (invalidates #4434)",
    "title_was": "Re-fix #4434 (merging broken on OS X) using MergeToolConfiguration in Mercurial 1.x",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134578"
}
```



---

archive/issue_events_134579.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-04-05T10:19:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134579"
}
```



---

archive/issue_events_134580.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2011-04-05T10:47:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134580"
}
```



---

archive/issue_events_134581.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2011-04-05T10:47:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134581"
}
```



---

archive/issue_comments_112484.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nReplying to [@kini](#comment%3A4):\n\n```\napplying trac_11120-re-fix-trac_4434.mercurial-spkg.patch\npatching file spkg-install\nHunk #1 succeeded at 37 with fuzz 1 (offset -30 lines).\nnow at: trac_11120-re-fix-trac_4434.mercurial-spkg.patch\n```\nwhy do I see fuzz? I'm applying it to the mercurial spkg that comes with sage- 4.7.alpha3\n\nAs well, it seems that your patch either wasn't tested, or was tested against a diffrent spkg. Indeed, I get:\n\n```\n...\nriting /usr/local/src/sage/sage-4.7.alpha3/local/lib/python/mercurial-1.6.4-py2.6.egg-info\ncp: contrib/mergetools.rc: No such file or directory\nError installing mergetools.rc\nDeleting dead links\n...\n```\nat the end of the sage -f mecurial....\nindeed, it should be \"src/contrib/\" rather than just \"contrib/\" in the argument of \"cp\".",
    "created_at": "2011-04-05T10:47:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112484",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'>Comment 5:</a>
Replying to [@kini](#comment%3A4):

```
applying trac_11120-re-fix-trac_4434.mercurial-spkg.patch
patching file spkg-install
Hunk #1 succeeded at 37 with fuzz 1 (offset -30 lines).
now at: trac_11120-re-fix-trac_4434.mercurial-spkg.patch
```
why do I see fuzz? I'm applying it to the mercurial spkg that comes with sage- 4.7.alpha3

As well, it seems that your patch either wasn't tested, or was tested against a diffrent spkg. Indeed, I get:

```
...
riting /usr/local/src/sage/sage-4.7.alpha3/local/lib/python/mercurial-1.6.4-py2.6.egg-info
cp: contrib/mergetools.rc: No such file or directory
Error installing mergetools.rc
Deleting dead links
...
```
at the end of the sage -f mecurial....
indeed, it should be "src/contrib/" rather than just "contrib/" in the argument of "cp".



---

archive/issue_comments_112485.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nReplying to [@dimpase](#comment%3A5):\n\nOK, this depends on #11121, which isn't ready yet. Oops...",
    "created_at": "2011-04-05T11:01:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112485",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'>Comment 6:</a>
Replying to [@dimpase](#comment%3A5):

OK, this depends on #11121, which isn't ready yet. Oops...



---

archive/issue_comments_112486.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,6 @@\n+Depends on #11121 ; Apply trac_11120-re-fix-trac_4434.mercurial-spkg.patch to mercurial spkg base repository\n+\n+---\n In Mercurial versions earlier than 1.0, a script called `hgmerge` was installed to the system when you installed mercurial. This script called whatever 3-way merge programs you had installed in order to manually intervene in Mercurial's merging process when it couldn't figure out how to resolve a conflict.\n \n This was deprecated in version 1.0, and now Mercurial calls 3-way merge programs directly instead of relying on an `hgmerge` script. In order to make this work properly, one should set the proper configuration variables to help Mercurial find any installed 3-way merge programs.\n@@ -7,7 +10,3 @@\n The problem reported at trac #4434 was caused, I guess, by the fact that `hgmerge` was deprecated and we sage people didn't notice, so the patch there simply caused our distribution of Mercurial to continue using `hgmerge`. The patch also did this only on the OS X platform, though as far as I can tell the same fundamental problem actually appears on Linux as well (see comments below).\n \n A better way to fix the problem on trac #4434, and fix it for Linux too, would be to use the `contrib/mergetools.rc` file as it was designed to be used.\n-\n-Apply trac_11120-re-fix-trac_4434.mercurial-spkg.patch to mercurial spkg base repository\n-\n-Depends on #11121\n``````\n",
    "created_at": "2011-04-05T12:38:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112486",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,6 @@
+Depends on #11121 ; Apply trac_11120-re-fix-trac_4434.mercurial-spkg.patch to mercurial spkg base repository
+
+---
 In Mercurial versions earlier than 1.0, a script called `hgmerge` was installed to the system when you installed mercurial. This script called whatever 3-way merge programs you had installed in order to manually intervene in Mercurial's merging process when it couldn't figure out how to resolve a conflict.
 
 This was deprecated in version 1.0, and now Mercurial calls 3-way merge programs directly instead of relying on an `hgmerge` script. In order to make this work properly, one should set the proper configuration variables to help Mercurial find any installed 3-way merge programs.
@@ -7,7 +10,3 @@
 The problem reported at trac #4434 was caused, I guess, by the fact that `hgmerge` was deprecated and we sage people didn't notice, so the patch there simply caused our distribution of Mercurial to continue using `hgmerge`. The patch also did this only on the OS X platform, though as far as I can tell the same fundamental problem actually appears on Linux as well (see comments below).
 
 A better way to fix the problem on trac #4434, and fix it for Linux too, would be to use the `contrib/mergetools.rc` file as it was designed to be used.
-
-Apply trac_11120-re-fix-trac_4434.mercurial-spkg.patch to mercurial spkg base repository
-
-Depends on #11121
``````




---

archive/issue_comments_112487.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nYes, you're right, it depends on #11121 (specifically on the patch there which applies to the mercurial spkg). Sorry, I'll make that more prominent in the ticket description. As for the error actually copying the file, it's actually because the filename is wrong. It still needs to be called `mergetools.rc` (or at least something`.rc`) in order to work, but in the vanilla Mercurial source distribution it is actually called `contrib/mergetools.hgrc` for some reason. It needs to be renamed during the copy over. I think I had renamed it in my sandbox by mistake at some point when trying to fiddle with it to test different diff viewers - stupid oversight on my part. I'll fix it. Sorry for the inconvenience.",
    "created_at": "2011-04-05T12:38:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112487",
    "user": "https://github.com/kini"
}
```

<a id='comment:7'>Comment 7:</a>
Yes, you're right, it depends on #11121 (specifically on the patch there which applies to the mercurial spkg). Sorry, I'll make that more prominent in the ticket description. As for the error actually copying the file, it's actually because the filename is wrong. It still needs to be called `mergetools.rc` (or at least something`.rc`) in order to work, but in the vanilla Mercurial source distribution it is actually called `contrib/mergetools.hgrc` for some reason. It needs to be renamed during the copy over. I think I had renamed it in my sandbox by mistake at some point when trying to fiddle with it to test different diff viewers - stupid oversight on my part. I'll fix it. Sorry for the inconvenience.



---

archive/issue_events_134582.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-04-06T14:18:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134582"
}
```



---

archive/issue_events_134583.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-04-06T14:18:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134583"
}
```



---

archive/issue_comments_112488.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n Depends on #11121 ; Apply trac_11120-re-fix-trac_4434.mercurial-spkg.patch to mercurial spkg base repository\n+\n+Or, just use [this SPKG](http://sage.math.washington.edu/home/keshav/files/mercurial-1.6.4.p1.spkg) which fixes both #11120 and #11121.\n \n ---\n In Mercurial versions earlier than 1.0, a script called `hgmerge` was installed to the system when you installed mercurial. This script called whatever 3-way merge programs you had installed in order to manually intervene in Mercurial's merging process when it couldn't figure out how to resolve a conflict.\n``````\n",
    "created_at": "2011-04-06T14:18:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112488",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
 Depends on #11121 ; Apply trac_11120-re-fix-trac_4434.mercurial-spkg.patch to mercurial spkg base repository
+
+Or, just use [this SPKG](http://sage.math.washington.edu/home/keshav/files/mercurial-1.6.4.p1.spkg) which fixes both #11120 and #11121.
 
 ---
 In Mercurial versions earlier than 1.0, a script called `hgmerge` was installed to the system when you installed mercurial. This script called whatever 3-way merge programs you had installed in order to manually intervene in Mercurial's merging process when it couldn't figure out how to resolve a conflict.
``````




---

archive/issue_comments_112489.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nNow that I've upgraded to and rebuilt alpha3 I can confirm that the spkg installs nicely and does what it's supposed to do after applying the patch. Marking as needs_review . Should I upload a new spkg file to sage.math.washington.edu, or does the release manager make the new spkg by applying a patch I upload to trac? I'll do both for now.\n\nReplying to [@kini](#comment%3A2):\n> Note that this is not really an *error* - it's just the lack of a default merge program being installed. Could it be possible that the problem that occasioned #4474 is present on Linux as well?\n\nI of course meant #4434 here -- oops.",
    "created_at": "2011-04-06T14:18:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112489",
    "user": "https://github.com/kini"
}
```

<a id='comment:8'>Comment 8:</a>
Now that I've upgraded to and rebuilt alpha3 I can confirm that the spkg installs nicely and does what it's supposed to do after applying the patch. Marking as needs_review . Should I upload a new spkg file to sage.math.washington.edu, or does the release manager make the new spkg by applying a patch I upload to trac? I'll do both for now.

Replying to [@kini](#comment%3A2):
> Note that this is not really an *error* - it's just the lack of a default merge program being installed. Could it be possible that the problem that occasioned #4474 is present on Linux as well?

I of course meant #4434 here -- oops.



---

archive/issue_comments_112490.json:
```json
{
    "body": "apply to mercurial spkg's repository",
    "created_at": "2011-04-06T14:19:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112490",
    "user": "https://github.com/kini"
}
```

apply to mercurial spkg's repository



---

archive/issue_comments_112491.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nAttachment: **[trac_11120-re-fix-trac_4434.mercurial-spkg.patch.gz](https://github.com/sagemath/sage/files/ticket11120/trac_11120-re-fix-trac_4434.mercurial-spkg.patch.gz)**\n\nKeshav: a request: while you're working on mercurial issues on OS X, could you also take a look at #10171?",
    "created_at": "2011-04-06T16:17:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112491",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'>Comment 9:</a>
Attachment: **[trac_11120-re-fix-trac_4434.mercurial-spkg.patch.gz](https://github.com/sagemath/sage/files/ticket11120/trac_11120-re-fix-trac_4434.mercurial-spkg.patch.gz)**

Keshav: a request: while you're working on mercurial issues on OS X, could you also take a look at #10171?



---

archive/issue_comments_112492.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nJohn: I only made this ticket because I happened across the patch of #4434 while trying to fix #11121 :) I'm running Debian Wheezy and don't have a Mac... I see that Dmitrii is on the case, however.",
    "created_at": "2011-04-06T18:07:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112492",
    "user": "https://github.com/kini"
}
```

<a id='comment:10'>Comment 10:</a>
John: I only made this ticket because I happened across the patch of #4434 while trying to fix #11121 :) I'm running Debian Wheezy and don't have a Mac... I see that Dmitrii is on the case, however.



---

archive/issue_comments_112493.json:
```json
{
    "body": "Dependencies: **#11121**",
    "created_at": "2011-04-22T11:25:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112493",
    "user": "https://github.com/kini"
}
```

Dependencies: **#11121**



---

archive/issue_comments_112494.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\n(testing #10966)",
    "created_at": "2011-04-22T11:25:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112494",
    "user": "https://github.com/kini"
}
```

<a id='comment:11'>Comment 11:</a>
(testing #10966)



---

archive/issue_comments_112495.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nI'll fix this along with #10594, hopefully.",
    "created_at": "2011-06-14T02:46:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112495",
    "user": "https://github.com/kini"
}
```

<a id='comment:12'>Comment 12:</a>
I'll fix this along with #10594, hopefully.



---

archive/issue_comments_112496.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,4 @@\n Depends on #11121 ; Apply trac_11120-re-fix-trac_4434.mercurial-spkg.patch to mercurial spkg base repository\n-\n-Or, just use [this SPKG](http://sage.math.washington.edu/home/keshav/files/mercurial-1.6.4.p1.spkg) which fixes both #11120 and #11121.\n \n ---\n In Mercurial versions earlier than 1.0, a script called `hgmerge` was installed to the system when you installed mercurial. This script called whatever 3-way merge programs you had installed in order to manually intervene in Mercurial's merging process when it couldn't figure out how to resolve a conflict.\n``````\n",
    "created_at": "2011-06-14T02:46:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112496",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,4 @@
 Depends on #11121 ; Apply trac_11120-re-fix-trac_4434.mercurial-spkg.patch to mercurial spkg base repository
-
-Or, just use [this SPKG](http://sage.math.washington.edu/home/keshav/files/mercurial-1.6.4.p1.spkg) which fixes both #11120 and #11121.
 
 ---
 In Mercurial versions earlier than 1.0, a script called `hgmerge` was installed to the system when you installed mercurial. This script called whatever 3-way merge programs you had installed in order to manually intervene in Mercurial's merging process when it couldn't figure out how to resolve a conflict.
``````




---

archive/issue_events_134584.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-06-14T02:46:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134584"
}
```



---

archive/issue_events_134585.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-06-14T02:46:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134585"
}
```



---

archive/issue_comments_112497.json:
```json
{
    "body": "Changed keywords from **mercurial, os x** to **mercurial osx sd31**",
    "created_at": "2011-06-14T06:30:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112497",
    "user": "https://github.com/kini"
}
```

Changed keywords from **mercurial, os x** to **mercurial osx sd31**



---

archive/issue_comments_112498.json:
```json
{
    "body": "Author: **Keshav Kini**",
    "created_at": "2011-06-14T06:30:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112498",
    "user": "https://github.com/kini"
}
```

Author: **Keshav Kini**



---

archive/issue_comments_112499.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nThis should be fixed by [this spkg](http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg). Please review!",
    "created_at": "2011-06-14T06:30:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112499",
    "user": "https://github.com/kini"
}
```

<a id='comment:13'>Comment 13:</a>
This should be fixed by [this spkg](http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg). Please review!



---

archive/issue_events_134586.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-06-14T06:30:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134586"
}
```



---

archive/issue_events_134587.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-06-14T06:30:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134587"
}
```



---

archive/issue_comments_112500.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Depends on #11121 ; Apply trac_11120-re-fix-trac_4434.mercurial-spkg.patch to mercurial spkg base repository\n+Depends on #11121 ; Install [http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg](http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg)\n \n ---\n In Mercurial versions earlier than 1.0, a script called `hgmerge` was installed to the system when you installed mercurial. This script called whatever 3-way merge programs you had installed in order to manually intervene in Mercurial's merging process when it couldn't figure out how to resolve a conflict.\n``````\n",
    "created_at": "2011-06-14T06:30:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112500",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Depends on #11121 ; Apply trac_11120-re-fix-trac_4434.mercurial-spkg.patch to mercurial spkg base repository
+Depends on #11121 ; Install [http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg](http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg)
 
 ---
 In Mercurial versions earlier than 1.0, a script called `hgmerge` was installed to the system when you installed mercurial. This script called whatever 3-way merge programs you had installed in order to manually intervene in Mercurial's merging process when it couldn't figure out how to resolve a conflict.
``````




---

archive/issue_comments_112501.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nTwo things: first, I'm not sure how to test this.  Second, during an upgrade on OS X, the file hgmerge is still present in SAGE_LOCAL/bin.  Is that going to be a problem, or will the settings in hgrc.d/mergetools.rc override it?",
    "created_at": "2011-06-22T00:01:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112501",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:14'>Comment 14:</a>
Two things: first, I'm not sure how to test this.  Second, during an upgrade on OS X, the file hgmerge is still present in SAGE_LOCAL/bin.  Is that going to be a problem, or will the settings in hgrc.d/mergetools.rc override it?



---

archive/issue_comments_112502.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\n`hgmerge` remaining in SAGE_LOCAL/bin is not a problem; `mergetools.rc` overrides it. I guess the best way to test this is to try to replicate #4434 with the new spkg installed - it should be impossible.\n\nBy the way, I guess I should also eradicate `sage -hgmerge` - I'll submit a patch (not to the Mercurial spkg but to Sage) in a bit.",
    "created_at": "2011-06-22T01:17:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112502",
    "user": "https://github.com/kini"
}
```

<a id='comment:15'>Comment 15:</a>
`hgmerge` remaining in SAGE_LOCAL/bin is not a problem; `mergetools.rc` overrides it. I guess the best way to test this is to try to replicate #4434 with the new spkg installed - it should be impossible.

By the way, I guess I should also eradicate `sage -hgmerge` - I'll submit a patch (not to the Mercurial spkg but to Sage) in a bit.



---

archive/issue_comments_112503.json:
```json
{
    "body": "Reviewer: **John Palmieri**",
    "created_at": "2011-07-01T18:21:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112503",
    "user": "https://github.com/jhpalmieri"
}
```

Reviewer: **John Palmieri**



---

archive/issue_comments_112504.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nOkay, if you can patch the scripts repo to get rid of \"sage -hgmerge\", then I think this can get a positive review.",
    "created_at": "2011-07-01T18:21:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112504",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:16'>Comment 16:</a>
Okay, if you can patch the scripts repo to get rid of "sage -hgmerge", then I think this can get a positive review.



---

archive/issue_comments_112505.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nHere's a patch to the scripts repo to remove the \"sage -hgmerge\" command.",
    "created_at": "2011-08-03T22:20:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112505",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:17'>Comment 17:</a>
Here's a patch to the scripts repo to remove the "sage -hgmerge" command.



---

archive/issue_comments_112506.json:
```json
{
    "body": "Changed author from **Keshav Kini** to **Keshav Kini, John Palmieri**",
    "created_at": "2011-08-03T22:20:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112506",
    "user": "https://github.com/jhpalmieri"
}
```

Changed author from **Keshav Kini** to **Keshav Kini, John Palmieri**



---

archive/issue_comments_112507.json:
```json
{
    "body": "Attachment: **[trac_11120-no-hgmerge.patch.gz](https://github.com/sagemath/sage/files/ticket11120/trac_11120-no-hgmerge.patch.gz)**\n\napply to scripts repo",
    "created_at": "2011-08-03T22:21:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112507",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_11120-no-hgmerge.patch.gz](https://github.com/sagemath/sage/files/ticket11120/trac_11120-no-hgmerge.patch.gz)**

apply to scripts repo



---

archive/issue_comments_112508.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,3 +10,8 @@\n The problem reported at trac #4434 was caused, I guess, by the fact that `hgmerge` was deprecated and we sage people didn't notice, so the patch there simply caused our distribution of Mercurial to continue using `hgmerge`. The patch also did this only on the OS X platform, though as far as I can tell the same fundamental problem actually appears on Linux as well (see comments below).\n \n A better way to fix the problem on trac #4434, and fix it for Linux too, would be to use the `contrib/mergetools.rc` file as it was designed to be used.\n+\n+---\n+\n+Apply [attachment: trac_11120-no-hgmerge.patch.gz](https://github.com/sagemath/sage/files/ticket11120/trac_11120-no-hgmerge.patch.gz) to the Sage scripts repository.\n+\n``````\n",
    "created_at": "2011-08-03T22:22:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112508",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,3 +10,8 @@
 The problem reported at trac #4434 was caused, I guess, by the fact that `hgmerge` was deprecated and we sage people didn't notice, so the patch there simply caused our distribution of Mercurial to continue using `hgmerge`. The patch also did this only on the OS X platform, though as far as I can tell the same fundamental problem actually appears on Linux as well (see comments below).
 
 A better way to fix the problem on trac #4434, and fix it for Linux too, would be to use the `contrib/mergetools.rc` file as it was designed to be used.
+
+---
+
+Apply [attachment: trac_11120-no-hgmerge.patch.gz](https://github.com/sagemath/sage/files/ticket11120/trac_11120-no-hgmerge.patch.gz) to the Sage scripts repository.
+
``````




---

archive/issue_comments_112509.json:
```json
{
    "body": "Changed dependencies from **#11121** to **#10594**",
    "created_at": "2011-08-03T22:22:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112509",
    "user": "https://github.com/jhpalmieri"
}
```

Changed dependencies from **#11121** to **#10594**



---

archive/issue_comments_112510.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Depends on #11121 ; Install [http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg](http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg)\n+Depends on #10594, which already incorporates the [patch here](https://github.com/sagemath/sage/files/ticket11120/trac_11120-re-fix-trac_4434.mercurial-spkg.patch.gz) to the Mercurial spkg.\n \n ---\n In Mercurial versions earlier than 1.0, a script called `hgmerge` was installed to the system when you installed mercurial. This script called whatever 3-way merge programs you had installed in order to manually intervene in Mercurial's merging process when it couldn't figure out how to resolve a conflict.\n``````\n",
    "created_at": "2011-08-10T19:20:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112510",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Depends on #11121 ; Install [http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg](http://sage.math.washington.edu/home/keshav/files/mercurial-1.8.4.spkg)
+Depends on #10594, which already incorporates the [patch here](https://github.com/sagemath/sage/files/ticket11120/trac_11120-re-fix-trac_4434.mercurial-spkg.patch.gz) to the Mercurial spkg.
 
 ---
 In Mercurial versions earlier than 1.0, a script called `hgmerge` was installed to the system when you installed mercurial. This script called whatever 3-way merge programs you had installed in order to manually intervene in Mercurial's merging process when it couldn't figure out how to resolve a conflict.
``````




---

archive/issue_comments_112511.json:
```json
{
    "body": "Changed dependencies from **#10594** to **#4434, #10594**",
    "created_at": "2011-09-11T08:48:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112511",
    "user": "https://github.com/kini"
}
```

Changed dependencies from **#10594** to **#4434, #10594**



---

archive/issue_comments_112512.json:
```json
{
    "body": "Changed reviewer from **John Palmieri** to **John Palmieri, Keshav Kini**",
    "created_at": "2011-09-11T08:48:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112512",
    "user": "https://github.com/kini"
}
```

Changed reviewer from **John Palmieri** to **John Palmieri, Keshav Kini**



---

archive/issue_events_134588.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-09-11T08:48:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134588"
}
```



---

archive/issue_events_134589.json:
```json
{
    "actor": "https://github.com/kini",
    "created_at": "2011-09-11T08:48:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134589"
}
```



---

archive/issue_comments_112513.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nLooks fine. All doctests pass (though I doubt `hgmerge` was doctested anyway...). Grepping for \"hgmerge\" doesn't find anything significant. Eradication successful! Positive review from me.",
    "created_at": "2011-09-11T08:48:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112513",
    "user": "https://github.com/kini"
}
```

<a id='comment:20'>Comment 20:</a>
Looks fine. All doctests pass (though I doubt `hgmerge` was doctested anyway...). Grepping for "hgmerge" doesn't find anything significant. Eradication successful! Positive review from me.



---

archive/issue_comments_112514.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nReplying to [@kini](#comment%3A20):\n> Looks fine. All doctests pass (though I doubt `hgmerge` was doctested anyway...). Grepping for \"hgmerge\" doesn't find anything significant. Eradication successful! Positive review from me.\n\nwould be good to state clearly in the ticket description  which patches should be applied, and which should not be applied.\nI.e, is trac_11120-re-fix-trac_4434.mercurial-spkg.patch needed?",
    "created_at": "2011-09-11T09:29:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112514",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:21'>Comment 21:</a>
Replying to [@kini](#comment%3A20):
> Looks fine. All doctests pass (though I doubt `hgmerge` was doctested anyway...). Grepping for "hgmerge" doesn't find anything significant. Eradication successful! Positive review from me.

would be good to state clearly in the ticket description  which patches should be applied, and which should not be applied.
I.e, is trac_11120-re-fix-trac_4434.mercurial-spkg.patch needed?



---

archive/issue_comments_112515.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nIt is clearly stated in the ticket description is it not? Read the bottom. No, that patch is not needed.",
    "created_at": "2011-09-11T09:40:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112515",
    "user": "https://github.com/kini"
}
```

<a id='comment:22'>Comment 22:</a>
It is clearly stated in the ticket description is it not? Read the bottom. No, that patch is not needed.



---

archive/issue_comments_112516.json:
```json
{
    "body": "Changed dependencies from **#4434, #10594** to **#4434 #10594**",
    "created_at": "2011-09-12T20:45:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112516",
    "user": "https://github.com/nexttime"
}
```

Changed dependencies from **#4434, #10594** to **#4434 #10594**



---

archive/issue_comments_112517.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Depends on #10594, which already incorporates the [patch here](https://github.com/sagemath/sage/files/ticket11120/trac_11120-re-fix-trac_4434.mercurial-spkg.patch.gz) to the Mercurial spkg.\n+Depends on #10594, which already incorporates the patch to the Mercurial spkg (trac_11120-re-fix-trac_4434.mercurial-spkg.patch) attached here.\n \n ---\n In Mercurial versions earlier than 1.0, a script called `hgmerge` was installed to the system when you installed mercurial. This script called whatever 3-way merge programs you had installed in order to manually intervene in Mercurial's merging process when it couldn't figure out how to resolve a conflict.\n@@ -13,5 +13,5 @@\n \n ---\n \n-Apply [attachment: trac_11120-no-hgmerge.patch.gz](https://github.com/sagemath/sage/files/ticket11120/trac_11120-no-hgmerge.patch.gz) to the Sage scripts repository.\n+Apply only [attachment: trac_11120-no-hgmerge.patch.gz](https://github.com/sagemath/sage/files/ticket11120/trac_11120-no-hgmerge.patch.gz) to the Sage scripts repository.\n \n``````\n",
    "created_at": "2011-09-13T10:47:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112517",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Depends on #10594, which already incorporates the [patch here](https://github.com/sagemath/sage/files/ticket11120/trac_11120-re-fix-trac_4434.mercurial-spkg.patch.gz) to the Mercurial spkg.
+Depends on #10594, which already incorporates the patch to the Mercurial spkg (trac_11120-re-fix-trac_4434.mercurial-spkg.patch) attached here.
 
 ---
 In Mercurial versions earlier than 1.0, a script called `hgmerge` was installed to the system when you installed mercurial. This script called whatever 3-way merge programs you had installed in order to manually intervene in Mercurial's merging process when it couldn't figure out how to resolve a conflict.
@@ -13,5 +13,5 @@
 
 ---
 
-Apply [attachment: trac_11120-no-hgmerge.patch.gz](https://github.com/sagemath/sage/files/ticket11120/trac_11120-no-hgmerge.patch.gz) to the Sage scripts repository.
+Apply only [attachment: trac_11120-no-hgmerge.patch.gz](https://github.com/sagemath/sage/files/ticket11120/trac_11120-no-hgmerge.patch.gz) to the Sage scripts repository.
 
``````




---

archive/issue_events_134590.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-13T10:59:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages",
    "label_color": "000080",
    "label_name": "component: packages",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134590"
}
```



---

archive/issue_events_134591.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-13T10:59:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20scripts",
    "label_color": "000080",
    "label_name": "component: scripts",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134591"
}
```



---

archive/issue_events_134592.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-13T10:59:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134592"
}
```



---

archive/issue_events_134593.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-13T10:59:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11120#event-134593"
}
```



---

archive/issue_comments_112518.json:
```json
{
    "body": "Merged: **sage-4.7.2.alpha3**",
    "created_at": "2011-09-13T10:59:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11120",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11120#issuecomment-112518",
    "user": "https://github.com/nexttime"
}
```

Merged: **sage-4.7.2.alpha3**
