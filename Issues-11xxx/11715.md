# Issue 11715: Upgrade matrix set_row() and set_column()

archive/issues_011543.json:
```json
{
    "body": "I thought the previous error message for `set_row()` about lists of entries being the wrong length was a bit vague, since it just referenced \"v\", which does not even need to be a vector.\n\nSo while changing that I upgaded the documentation and error-checking for both `set_row()` and `set_column()`.  Attempting to use the `set_unsafe()` method resulted in a boatload of errors, so I backed off from that.\n\n---\n\nApply only [attachment:trac_11715_matrix_set_row_column_docs_fixed.patch].\n\n**Assignee:** @jasongrout, @williamstein\n\n**CC:**  @jasongrout hds\n\n**Keywords:** sd32\n\n**Reviewer:** Karl-Dieter Crisman, David Loeffler, Hayden Stainsby\n\n**Author:** Rob Beezer, Hayden Stainsby\n\n**Merged:** sage-5.9.beta1\n\nIssue created by migration from https://trac.sagemath.org/ticket/11715\n\n",
    "closed_at": "2013-03-20T14:43:29Z",
    "created_at": "2011-08-22T19:23:00Z",
    "labels": [
        "component: linear algebra",
        "minor",
        "enhancement",
        "good first issue"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.9",
    "title": "Upgrade matrix set_row() and set_column()",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11715",
    "user": "https://github.com/rbeezer"
}
```
I thought the previous error message for `set_row()` about lists of entries being the wrong length was a bit vague, since it just referenced "v", which does not even need to be a vector.

So while changing that I upgaded the documentation and error-checking for both `set_row()` and `set_column()`.  Attempting to use the `set_unsafe()` method resulted in a boatload of errors, so I backed off from that.

---

Apply only [attachment:trac_11715_matrix_set_row_column_docs_fixed.patch].

**Assignee:** @jasongrout, @williamstein

**CC:**  @jasongrout hds

**Keywords:** sd32

**Reviewer:** Karl-Dieter Crisman, David Loeffler, Hayden Stainsby

**Author:** Rob Beezer, Hayden Stainsby

**Merged:** sage-5.9.beta1

Issue created by migration from https://trac.sagemath.org/ticket/11715





---

archive/issue_events_095738.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-08-22T19:27:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "label": "good first issue",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11715#event-95738"
}
```



---

archive/issue_comments_125378.json:
```json
{
    "body": "**Author:** Rob Beezer",
    "created_at": "2011-08-22T19:27:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125378",
    "user": "https://github.com/rbeezer"
}
```

**Author:** Rob Beezer



---

archive/issue_events_095739.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2011-08-22T19:27:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11715#event-95739"
}
```



---

archive/issue_comments_125379.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"sd32\".",
    "created_at": "2011-08-25T19:02:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125379",
    "user": "https://github.com/rbeezer"
}
```

**Changing keywords** from "" to "sd32".



---

archive/issue_events_095740.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2012-03-25T15:11:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11715#event-95740"
}
```



---

archive/issue_events_095741.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2012-03-25T15:11:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11715#event-95741"
}
```



---

archive/issue_comments_125380.json:
```json
{
    "body": "**Work_Issues:** doc formatting",
    "created_at": "2012-03-25T15:11:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125380",
    "user": "https://github.com/loefflerd"
}
```

**Work_Issues:** doc formatting



---

archive/issue_comments_125381.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe following extract from the patch isn't valid Sphinx formatting (the first :: should be a single :)\n\n```\n1617\t1626\t        EXAMPLES:: \n \t1627\t         \n \t1628\t        New entries may be contained in a vector.  :: \n```\n\nThere are a couple of these in the patch, see the output of \"plugins.docbuild\" in the patchbot logs.",
    "created_at": "2012-03-25T15:11:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125381",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:4'></a>
The following extract from the patch isn't valid Sphinx formatting (the first :: should be a single :)

```
1617	1626	        EXAMPLES:: 
 	1627	         
 	1628	        New entries may be contained in a vector.  :: 
```

There are a couple of these in the patch, see the output of "plugins.docbuild" in the patchbot logs.



---

archive/issue_comments_125382.json:
```json
{
    "body": "<a id='comment:5'></a>\nI've updated Rob's patch file to fix the doc errors (I'm pretty sure there were just two). You only need to apply the new patch.",
    "created_at": "2013-02-12T13:04:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125382",
    "user": "https://trac.sagemath.org/admin/accounts/users/hds"
}
```

<a id='comment:5'></a>
I've updated Rob's patch file to fix the doc errors (I'm pretty sure there were just two). You only need to apply the new patch.



---

archive/issue_events_095742.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/hds",
    "created_at": "2013-02-12T13:04:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11715#event-95742"
}
```



---

archive/issue_events_095743.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/hds",
    "created_at": "2013-02-12T13:04:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11715#event-95743"
}
```



---

archive/issue_comments_125383.json:
```json
{
    "body": "<a id='comment:6'></a>\nWell, here is the punishment for these good deeds.\n\nNamely, if we're going to upgrade this documentation, we should probably also upgrade it to have tests for other things.  Before there was no excuse, but now we should just do it all.\n\n```\nsage: A = matrix([[1, 2], [3, 4]]); A\n[1 2]\n[3 4]\nsage: A.set_row(1,[.1,3])\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<snip>\nTypeError: Attempt to coerce non-integral RealNumber to Integer\n```\nEtc.  \n\nWe should catch such errors and return a slightly more informative error message, just as we do with the wrong length list or wrong index, e.g. `TypeError: new row must have all elements in original ring.`  Unless we want to allow this and do an implicit `change_ring`?  Probably we should have an error message like in the doc for `A.set_col_to_multiple_of_col?`.\n\n\n---\n\nMinor comment - `TESTS:` needs two colons.",
    "created_at": "2013-02-12T16:47:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125383",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'></a>
Well, here is the punishment for these good deeds.

Namely, if we're going to upgrade this documentation, we should probably also upgrade it to have tests for other things.  Before there was no excuse, but now we should just do it all.

```
sage: A = matrix([[1, 2], [3, 4]]); A
[1 2]
[3 4]
sage: A.set_row(1,[.1,3])
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<snip>
TypeError: Attempt to coerce non-integral RealNumber to Integer
```
Etc.  

We should catch such errors and return a slightly more informative error message, just as we do with the wrong length list or wrong index, e.g. `TypeError: new row must have all elements in original ring.`  Unless we want to allow this and do an implicit `change_ring`?  Probably we should have an error message like in the doc for `A.set_col_to_multiple_of_col?`.


---

Minor comment - `TESTS:` needs two colons.



---

archive/issue_comments_125384.json:
```json
{
    "body": "**Reviewer:** Karl-Dieter Crisman, David Loeffler",
    "created_at": "2013-02-12T16:48:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125384",
    "user": "https://github.com/kcrisman"
}
```

**Reviewer:** Karl-Dieter Crisman, David Loeffler



---

archive/issue_events_095744.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-02-12T16:48:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11715#event-95744"
}
```



---

archive/issue_events_095745.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-02-12T16:48:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11715#event-95745"
}
```



---

archive/issue_comments_125385.json:
```json
{
    "body": "<a id='comment:7'></a>\nhds - can you put your real name under reviewers?  You don't show up on the list at [the main Trac page](http://trac.sagemath.org/sage_trac/).",
    "created_at": "2013-02-12T16:48:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125385",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:7'></a>
hds - can you put your real name under reviewers?  You don't show up on the list at [the main Trac page](http://trac.sagemath.org/sage_trac/).



---

archive/issue_comments_125386.json:
```json
{
    "body": "**Changing reviewer** from \"Karl-Dieter Crisman, David Loeffler\" to \"Karl-Dieter Crisman, David Loeffler, Hayden Stainsby\".",
    "created_at": "2013-02-12T18:22:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125386",
    "user": "https://trac.sagemath.org/admin/accounts/users/hds"
}
```

**Changing reviewer** from "Karl-Dieter Crisman, David Loeffler" to "Karl-Dieter Crisman, David Loeffler, Hayden Stainsby".



---

archive/issue_comments_125387.json:
```json
{
    "body": "<a id='comment:8'></a>\nI added my name under reviewers, and on the main Trac page (hadn't done that yet as I only got the trac account today). Meanwhile, I'll look at some more informative errors for these coercion cases and such.",
    "created_at": "2013-02-12T18:22:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125387",
    "user": "https://trac.sagemath.org/admin/accounts/users/hds"
}
```

<a id='comment:8'></a>
I added my name under reviewers, and on the main Trac page (hadn't done that yet as I only got the trac account today). Meanwhile, I'll look at some more informative errors for these coercion cases and such.



---

archive/issue_comments_125388.json:
```json
{
    "body": "Updated set_row() and set_column for better error handling / reporting",
    "created_at": "2013-02-13T11:07:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125388",
    "user": "https://trac.sagemath.org/admin/accounts/users/hds"
}
```

Updated set_row() and set_column for better error handling / reporting



---

archive/issue_events_095746.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/hds",
    "created_at": "2013-02-13T11:10:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11715#event-95746"
}
```



---

archive/issue_events_095747.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/hds",
    "created_at": "2013-02-13T11:10:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11715#event-95747"
}
```



---

archive/attachments_015510.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_11715_matrix_set_row_column_docs_fixed.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket11715/trac_11715_matrix_set_row_column_docs_fixed.patch",
    "created_at": "2013-02-13T11:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/hds"
}
```



---

archive/issue_comments_125389.json:
```json
{
    "body": "<a id='comment:9'></a>\nI've added error handling for TypeErrors that gives a more useful exception, suggesting that change_ring be used on the matrix first if the user wishes to set a row or column with elements from another ring.\n\n```\nsage: A = matrix(2, [1, 2, 3, 4])\nsage: A.set_row(0, [1/3, 1]); A\nTraceback (most recent call last):\n...\nTypeError: Cannot set row with Rational Field elements over Integer Ring, use change_ring first.\n```",
    "created_at": "2013-02-13T11:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125389",
    "user": "https://trac.sagemath.org/admin/accounts/users/hds"
}
```

<a id='comment:9'></a>
I've added error handling for TypeErrors that gives a more useful exception, suggesting that change_ring be used on the matrix first if the user wishes to set a row or column with elements from another ring.

```
sage: A = matrix(2, [1, 2, 3, 4])
sage: A.set_row(0, [1/3, 1]); A
Traceback (most recent call last):
...
TypeError: Cannot set row with Rational Field elements over Integer Ring, use change_ring first.
```



---

archive/issue_comments_125390.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,3 +2,6 @@\n \n So while changing that I upgaded the documentation and error-checking for both `set_row()` and `set_column()`.  Attempting to use the `set_unsafe()` method resulted in a boatload of errors, so I backed off from that.\n \n+---\n+\n+Apply only [attachment:trac_11715_matrix_set_row_column_docs_fixed.patch].\n``````\n",
    "created_at": "2013-03-13T14:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125390",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,3 +2,6 @@
 
 So while changing that I upgaded the documentation and error-checking for both `set_row()` and `set_column()`.  Attempting to use the `set_unsafe()` method resulted in a boatload of errors, so I backed off from that.
 
+---
+
+Apply only [attachment:trac_11715_matrix_set_row_column_docs_fixed.patch].
``````




---

archive/issue_comments_125391.json:
```json
{
    "body": "<a id='comment:10'></a>\nPatchbot, apply trac_11715_matrix_set_row_column_docs_fixed.patch",
    "created_at": "2013-03-13T14:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125391",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:10'></a>
Patchbot, apply trac_11715_matrix_set_row_column_docs_fixed.patch



---

archive/issue_comments_125392.json:
```json
{
    "body": "**Changing author** from \"Rob Beezer\" to \"Rob Beezer, Hayden Stainsby\".",
    "created_at": "2013-03-13T14:11:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125392",
    "user": "https://github.com/kcrisman"
}
```

**Changing author** from "Rob Beezer" to "Rob Beezer, Hayden Stainsby".



---

archive/issue_comments_125393.json:
```json
{
    "body": "<a id='comment:11'></a>\nThis looks pretty good and good work using Python 3 formatting :-)\n\nJust waiting on the patchbot to make sure we're okay with respect to 5.8.beta4 or whatever the latest one is.",
    "created_at": "2013-03-13T14:11:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125393",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:11'></a>
This looks pretty good and good work using Python 3 formatting :-)

Just waiting on the patchbot to make sure we're okay with respect to 5.8.beta4 or whatever the latest one is.



---

archive/issue_comments_125394.json:
```json
{
    "body": "<a id='comment:12'></a>\nI can't figure out how to reset patchbot and get it to test...\n\nPatchbot, apply only trac_11715_matrix_set_row_column_docs_fixed.patch",
    "created_at": "2013-03-14T19:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125394",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:12'></a>
I can't figure out how to reset patchbot and get it to test...

Patchbot, apply only trac_11715_matrix_set_row_column_docs_fixed.patch



---

archive/issue_events_095748.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-03-15T18:55:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11715#event-95748"
}
```



---

archive/issue_events_095749.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-03-15T18:55:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11715#event-95749"
}
```



---

archive/issue_comments_125395.json:
```json
{
    "body": "<a id='comment:13'></a>\nPatchbot never did anything, but I checked on 5.8.rc0 and it's fine.",
    "created_at": "2013-03-15T18:55:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125395",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:13'></a>
Patchbot never did anything, but I checked on 5.8.rc0 and it's fine.



---

archive/issue_comments_125396.json:
```json
{
    "body": "**Changing work_issues** from \"doc formatting\" to \"\".",
    "created_at": "2013-03-18T15:43:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125396",
    "user": "https://github.com/jdemeyer"
}
```

**Changing work_issues** from "doc formatting" to "".



---

archive/issue_comments_125397.json:
```json
{
    "body": "**Merged:** sage-5.9.beta1",
    "created_at": "2013-03-20T14:43:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-125397",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.9.beta1



---

archive/issue_events_095750.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-20T14:43:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11715#event-95750"
}
```



---

archive/issue_events_095751.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-20T14:43:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11715#event-95751"
}
```
