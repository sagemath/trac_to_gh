# Issue 11715: Upgrade matrix set_row() and set_column()

archive/issues_011543.json:
```json
{
    "body": "Assignee: jason, was\n\nCC:  @jasongrout hds\n\nKeywords: beginner, sd32\n\nI thought the previous error message for `set_row()` about lists of entries being the wrong length was a bit vague, since it just referenced \"v\", which does not even need to be a vector.\n\nSo while changing that I upgaded the documentation and error-checking for both `set_row()` and `set_column()`.  Attempting to use the `set_unsafe()` method resulted in a boatload of errors, so I backed off from that.\n\n---\n\nApply only [attachment:trac_11715_matrix_set_row_column_docs_fixed.patch].\n\nIssue created by migration from https://trac.sagemath.org/ticket/11715\n\n",
    "closed_at": "2013-03-20T14:43:29Z",
    "created_at": "2011-08-22T19:23:00Z",
    "labels": [
        "component: linear algebra",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.9",
    "title": "Upgrade matrix set_row() and set_column()",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11715",
    "user": "https://github.com/rbeezer"
}
```
Assignee: jason, was

CC:  @jasongrout hds

Keywords: beginner, sd32

I thought the previous error message for `set_row()` about lists of entries being the wrong length was a bit vague, since it just referenced "v", which does not even need to be a vector.

So while changing that I upgaded the documentation and error-checking for both `set_row()` and `set_column()`.  Attempting to use the `set_unsafe()` method resulted in a boatload of errors, so I backed off from that.

---

Apply only [attachment:trac_11715_matrix_set_row_column_docs_fixed.patch].

Issue created by migration from https://trac.sagemath.org/ticket/11715





---

archive/issue_comments_129575.json:
```json
{
    "body": "Changing keywords from \"\" to \"beginner\".",
    "created_at": "2011-08-22T19:27:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129575",
    "user": "https://github.com/rbeezer"
}
```

Changing keywords from "" to "beginner".



---

archive/issue_comments_129576.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-08-22T19:27:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129576",
    "user": "https://github.com/rbeezer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_129577.json:
```json
{
    "body": "Changing keywords from \"beginner\" to \"beginner, sd32\".",
    "created_at": "2011-08-25T19:02:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129577",
    "user": "https://github.com/rbeezer"
}
```

Changing keywords from "beginner" to "beginner, sd32".



---

archive/issue_comments_129578.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-03-25T15:11:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129578",
    "user": "https://github.com/loefflerd"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_129579.json:
```json
{
    "body": "The following extract from the patch isn't valid Sphinx formatting (the first :: should be a single :)\n\n```\n1617\t1626\t        EXAMPLES:: \n \t1627\t         \n \t1628\t        New entries may be contained in a vector.  :: \n```\n\nThere are a couple of these in the patch, see the output of \"plugins.docbuild\" in the patchbot logs.",
    "created_at": "2012-03-25T15:11:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129579",
    "user": "https://github.com/loefflerd"
}
```

The following extract from the patch isn't valid Sphinx formatting (the first :: should be a single :)

```
1617	1626	        EXAMPLES:: 
 	1627	         
 	1628	        New entries may be contained in a vector.  :: 
```

There are a couple of these in the patch, see the output of "plugins.docbuild" in the patchbot logs.



---

archive/issue_comments_129580.json:
```json
{
    "body": "I've updated Rob's patch file to fix the doc errors (I'm pretty sure there were just two). You only need to apply the new patch.",
    "created_at": "2013-02-12T13:04:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129580",
    "user": "https://trac.sagemath.org/admin/accounts/users/hds"
}
```

I've updated Rob's patch file to fix the doc errors (I'm pretty sure there were just two). You only need to apply the new patch.



---

archive/issue_comments_129581.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-02-12T13:04:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129581",
    "user": "https://trac.sagemath.org/admin/accounts/users/hds"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_129582.json:
```json
{
    "body": "Well, here is the punishment for these good deeds.\n\nNamely, if we're going to upgrade this documentation, we should probably also upgrade it to have tests for other things.  Before there was no excuse, but now we should just do it all.\n\n```\nsage: A = matrix([[1, 2], [3, 4]]); A\n[1 2]\n[3 4]\nsage: A.set_row(1,[.1,3])\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<snip>\nTypeError: Attempt to coerce non-integral RealNumber to Integer\n```\nEtc.  \n\nWe should catch such errors and return a slightly more informative error message, just as we do with the wrong length list or wrong index, e.g. `TypeError: new row must have all elements in original ring.`  Unless we want to allow this and do an implicit `change_ring`?  Probably we should have an error message like in the doc for `A.set_col_to_multiple_of_col?`.\n\n\n---\n\nMinor comment - `TESTS:` needs two colons.",
    "created_at": "2013-02-12T16:47:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129582",
    "user": "https://github.com/kcrisman"
}
```

Well, here is the punishment for these good deeds.

Namely, if we're going to upgrade this documentation, we should probably also upgrade it to have tests for other things.  Before there was no excuse, but now we should just do it all.

```
sage: A = matrix([[1, 2], [3, 4]]); A
[1 2]
[3 4]
sage: A.set_row(1,[.1,3])
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<snip>
TypeError: Attempt to coerce non-integral RealNumber to Integer
```
Etc.  

We should catch such errors and return a slightly more informative error message, just as we do with the wrong length list or wrong index, e.g. `TypeError: new row must have all elements in original ring.`  Unless we want to allow this and do an implicit `change_ring`?  Probably we should have an error message like in the doc for `A.set_col_to_multiple_of_col?`.


---

Minor comment - `TESTS:` needs two colons.



---

archive/issue_comments_129583.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-02-12T16:48:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129583",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_129584.json:
```json
{
    "body": "hds - can you put your real name under reviewers?  You don't show up on the list at [the main Trac page](http://trac.sagemath.org/sage_trac/).",
    "created_at": "2013-02-12T16:48:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129584",
    "user": "https://github.com/kcrisman"
}
```

hds - can you put your real name under reviewers?  You don't show up on the list at [the main Trac page](http://trac.sagemath.org/sage_trac/).



---

archive/issue_comments_129585.json:
```json
{
    "body": "I added my name under reviewers, and on the main Trac page (hadn't done that yet as I only got the trac account today). Meanwhile, I'll look at some more informative errors for these coercion cases and such.",
    "created_at": "2013-02-12T18:22:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129585",
    "user": "https://trac.sagemath.org/admin/accounts/users/hds"
}
```

I added my name under reviewers, and on the main Trac page (hadn't done that yet as I only got the trac account today). Meanwhile, I'll look at some more informative errors for these coercion cases and such.



---

archive/issue_comments_129586.json:
```json
{
    "body": "Updated set_row() and set_column for better error handling / reporting",
    "created_at": "2013-02-13T11:07:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129586",
    "user": "https://trac.sagemath.org/admin/accounts/users/hds"
}
```

Updated set_row() and set_column for better error handling / reporting



---

archive/issue_comments_129587.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-02-13T11:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129587",
    "user": "https://trac.sagemath.org/admin/accounts/users/hds"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_129588.json:
```json
{
    "body": "Attachment [trac_11715_matrix_set_row_column_docs_fixed.patch](tarball://root/attachments/some-uuid/ticket11715/trac_11715_matrix_set_row_column_docs_fixed.patch) by hds created at 2013-02-13 11:10:22\n\nI've added error handling for TypeErrors that gives a more useful exception, suggesting that change_ring be used on the matrix first if the user wishes to set a row or column with elements from another ring.\n\n```\nsage: A = matrix(2, [1, 2, 3, 4])\nsage: A.set_row(0, [1/3, 1]); A\nTraceback (most recent call last):\n...\nTypeError: Cannot set row with Rational Field elements over Integer Ring, use change_ring first.\n```",
    "created_at": "2013-02-13T11:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129588",
    "user": "https://trac.sagemath.org/admin/accounts/users/hds"
}
```

Attachment [trac_11715_matrix_set_row_column_docs_fixed.patch](tarball://root/attachments/some-uuid/ticket11715/trac_11715_matrix_set_row_column_docs_fixed.patch) by hds created at 2013-02-13 11:10:22

I've added error handling for TypeErrors that gives a more useful exception, suggesting that change_ring be used on the matrix first if the user wishes to set a row or column with elements from another ring.

```
sage: A = matrix(2, [1, 2, 3, 4])
sage: A.set_row(0, [1/3, 1]); A
Traceback (most recent call last):
...
TypeError: Cannot set row with Rational Field elements over Integer Ring, use change_ring first.
```



---

archive/issue_comments_129589.json:
```json
{
    "body": "Patchbot, apply trac_11715_matrix_set_row_column_docs_fixed.patch",
    "created_at": "2013-03-13T14:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129589",
    "user": "https://github.com/kcrisman"
}
```

Patchbot, apply trac_11715_matrix_set_row_column_docs_fixed.patch



---

archive/issue_comments_129590.json:
```json
{
    "body": "This looks pretty good and good work using Python 3 formatting :-)\n\nJust waiting on the patchbot to make sure we're okay with respect to 5.8.beta4 or whatever the latest one is.",
    "created_at": "2013-03-13T14:11:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129590",
    "user": "https://github.com/kcrisman"
}
```

This looks pretty good and good work using Python 3 formatting :-)

Just waiting on the patchbot to make sure we're okay with respect to 5.8.beta4 or whatever the latest one is.



---

archive/issue_comments_129591.json:
```json
{
    "body": "I can't figure out how to reset patchbot and get it to test...\n\nPatchbot, apply only trac_11715_matrix_set_row_column_docs_fixed.patch",
    "created_at": "2013-03-14T19:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129591",
    "user": "https://github.com/kcrisman"
}
```

I can't figure out how to reset patchbot and get it to test...

Patchbot, apply only trac_11715_matrix_set_row_column_docs_fixed.patch



---

archive/issue_comments_129592.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-03-15T18:55:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129592",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_129593.json:
```json
{
    "body": "Patchbot never did anything, but I checked on 5.8.rc0 and it's fine.",
    "created_at": "2013-03-15T18:55:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129593",
    "user": "https://github.com/kcrisman"
}
```

Patchbot never did anything, but I checked on 5.8.rc0 and it's fine.



---

archive/issue_comments_129594.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-03-20T14:43:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11715#issuecomment-129594",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_030802.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-20T14:43:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11715",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11715#event-30802"
}
```
