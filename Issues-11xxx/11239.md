# Issue 11239: Incorrect coercion of polynomials over finite fields

archive/issues_011067.json:
```json
{
    "body": "Trying to coerce a polynomial over a finite field into a polynomial ring over a bigger field gives a bogus result:\n\n```\nsage: Fq.<a> = GF(5^2)\nsage: Fqq.<b> = GF(5^4)\nsage: f = Fq['x'].random_element(); f\n3*x^2 + (a + 4)*x + 2*a + 4\nsage: Fqq['y'](f)\n3*y^2 + (b + 4)*y + 2*b + 4\n```\nIn this example, Sage simply replaces every \u2018a\u2019 with \u2018b\u2019, but a is not b.  If we coerce directly from Fq to Fqq, we get a `NotImplementedError`, which is unfortunate but in any case not incorrect. ;).\n\n```\nsage: Fqq(a)\n\u2026\n/usr/local/share/sage/sage/local/lib/python2.6/site-packages/sage/rings/finite_rings/finite_field_givaro.pyc in _coerce_map_from_(self, R)\n    348                 elif self.degree() % R.degree() == 0:\n    349                     # This is where we *would* do coercion from one nontrivial finite field to another...\n--> 350                     raise NotImplementedError\n    351 \n    352     def gen(self, n=0):\n\nNotImplementedError:\n```\n\nUse git branch.\n\n\nAssignee: @robertwb\n\nCC:  jpflori\n\nKeywords: finite fields, polynomials, coercion, sd53\n\nBranch/Commit: 61c565b7beccc1466bdac4d17fab755cbf5f9c9c\n\nReviewer: Jean-Pierre Flori\n\nAuthor: Peter Bruin\n\nDependencies: #8335\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/11239\n\n",
    "closed_at": "2014-03-05T09:36:26Z",
    "created_at": "2011-04-22T16:45:45Z",
    "labels": [
        "component: coercion",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "Incorrect coercion of polynomials over finite fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11239",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```
Trying to coerce a polynomial over a finite field into a polynomial ring over a bigger field gives a bogus result:

```
sage: Fq.<a> = GF(5^2)
sage: Fqq.<b> = GF(5^4)
sage: f = Fq['x'].random_element(); f
3*x^2 + (a + 4)*x + 2*a + 4
sage: Fqq['y'](f)
3*y^2 + (b + 4)*y + 2*b + 4
```
In this example, Sage simply replaces every ‘a’ with ‘b’, but a is not b.  If we coerce directly from Fq to Fqq, we get a `NotImplementedError`, which is unfortunate but in any case not incorrect. ;).

```
sage: Fqq(a)
…
/usr/local/share/sage/sage/local/lib/python2.6/site-packages/sage/rings/finite_rings/finite_field_givaro.pyc in _coerce_map_from_(self, R)
    348                 elif self.degree() % R.degree() == 0:
    349                     # This is where we *would* do coercion from one nontrivial finite field to another...
--> 350                     raise NotImplementedError
    351 
    352     def gen(self, n=0):

NotImplementedError:
```

Use git branch.


Assignee: @robertwb

CC:  jpflori

Keywords: finite fields, polynomials, coercion, sd53

Branch/Commit: 61c565b7beccc1466bdac4d17fab755cbf5f9c9c

Reviewer: Jean-Pierre Flori

Author: Peter Bruin

Dependencies: #8335

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/11239





---

archive/issue_comments_126883.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,5 +1,3 @@\n-Incorrect coercion of polynomials over finite fields\n-\n Trying to coerce a polynomial over a finite field into a polynomial ring over a bigger field gives a bogus result:\n \n ```\n@@ -25,8 +23,6 @@\n NotImplementedError:\n ```\n \n-Keywords: finite fields, polynomials, coercion\n-\n Comment: 1\n \n Issue created by migration from https://trac.sagemath.org/ticket/11239\n```\n",
    "created_at": "2011-04-22T16:47:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126883",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,5 +1,3 @@
-Incorrect coercion of polynomials over finite fields
-
 Trying to coerce a polynomial over a finite field into a polynomial ring over a bigger field gives a bogus result:
 
 ```
@@ -25,8 +23,6 @@
 NotImplementedError:
 ```
 
-Keywords: finite fields, polynomials, coercion
-
 Comment: 1
 
 Issue created by migration from https://trac.sagemath.org/ticket/11239
```




---

archive/issue_comments_126884.json:
```json
{
    "body": "<a id='comment:2'></a>> If we coerce directly from Fq to Fqq, we get a `NotImplementedError`, which is unfortunate ...\n\n\nIt is, however, difficult to see how this could be done, because there are, in this case, two embeddings of the smaller field in the larger, neither of which can be distinguished from the other:\n\n```\nsage: Fq.<a> = GF(5^2); Fqq.<b> = GF(5^4)\nsage: Hom(Fq, Fqq).list()\n[\nRing morphism:\n  From: Finite Field in a of size 5^2\n  To:   Finite Field in b of size 5^4\n  Defn: a |--> 4*b^3 + 4*b^2 + 4*b + 3,\nRing morphism:\n  From: Finite Field in a of size 5^2\n  To:   Finite Field in b of size 5^4\n  Defn: a |--> b^3 + b^2 + b + 3\n]\n```\nsince\n\n```\nsage: a.minimal_polynomial().roots(ring=F625, multiplicities=False)\n[4*b^3 + 4*b^2 + 4*b + 3, b^3 + b^2 + b + 3]\n```\nAs for the polynomial coercion, this is seriously damaged.  Bogus results are produced even when the characteristics are different.  I have tracked the problem down to the following, but haven't been able to get further.\n\n```\nsage: Fq.<a> = GF(2^4); Fqq.<b> = GF(3^7)\nsage: PFq.<x> = Fq[]; PFqq.<y> = Fqq[]\nsage: f = x^3 + (a^3 + 1)*x\nsage: sage.rings.polynomial.polynomial_zz_pex.Polynomial_ZZ_pEX(PFqq, f)\ny^3 + (b^3 + 1)*y\n```",
    "created_at": "2011-04-23T08:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126884",
    "user": "https://trac.sagemath.org/admin/accounts/users/fwclarke"
}
```

<a id='comment:2'></a>> If we coerce directly from Fq to Fqq, we get a `NotImplementedError`, which is unfortunate ...


It is, however, difficult to see how this could be done, because there are, in this case, two embeddings of the smaller field in the larger, neither of which can be distinguished from the other:

```
sage: Fq.<a> = GF(5^2); Fqq.<b> = GF(5^4)
sage: Hom(Fq, Fqq).list()
[
Ring morphism:
  From: Finite Field in a of size 5^2
  To:   Finite Field in b of size 5^4
  Defn: a |--> 4*b^3 + 4*b^2 + 4*b + 3,
Ring morphism:
  From: Finite Field in a of size 5^2
  To:   Finite Field in b of size 5^4
  Defn: a |--> b^3 + b^2 + b + 3
]
```
since

```
sage: a.minimal_polynomial().roots(ring=F625, multiplicities=False)
[4*b^3 + 4*b^2 + 4*b + 3, b^3 + b^2 + b + 3]
```
As for the polynomial coercion, this is seriously damaged.  Bogus results are produced even when the characteristics are different.  I have tracked the problem down to the following, but haven't been able to get further.

```
sage: Fq.<a> = GF(2^4); Fqq.<b> = GF(3^7)
sage: PFq.<x> = Fq[]; PFqq.<y> = Fqq[]
sage: f = x^3 + (a^3 + 1)*x
sage: sage.rings.polynomial.polynomial_zz_pex.Polynomial_ZZ_pEX(PFqq, f)
y^3 + (b^3 + 1)*y
```



---

archive/issue_comments_126885.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,27 @@\n+Trying to coerce a polynomial over a finite field into a polynomial ring over a bigger field gives a bogus result:\n \n+```\n+sage: Fq.<a> = GF(5^2)\n+sage: Fqq.<b> = GF(5^4)\n+sage: f = Fq['x'].random_element(); f\n+3*x^2 + (a + 4)*x + 2*a + 4\n+sage: Fqq['y'](f)\n+3*y^2 + (b + 4)*y + 2*b + 4\n+```\n+In this example, Sage simply replaces every \u2018a\u2019 with \u2018b\u2019, but a is not b.  If we coerce directly from Fq to Fqq, we get a `NotImplementedError`, which is unfortunate but in any case not incorrect. ;).\n+\n+```\n+sage: Fqq(a)\n+\u2026\n+/usr/local/share/sage/sage/local/lib/python2.6/site-packages/sage/rings/finite_rings/finite_field_givaro.pyc in _coerce_map_from_(self, R)\n+    348                 elif self.degree() % R.degree() == 0:\n+    349                     # This is where we *would* do coercion from one nontrivial finite field to another...\n+--> 350                     raise NotImplementedError\n+    351 \n+    352     def gen(self, n=0):\n+\n+NotImplementedError:\n+```\n \n Comment: 1\n \n```\n",
    "created_at": "2011-04-23T08:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126885",
    "user": "https://trac.sagemath.org/admin/accounts/users/fwclarke"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,27 @@
+Trying to coerce a polynomial over a finite field into a polynomial ring over a bigger field gives a bogus result:
 
+```
+sage: Fq.<a> = GF(5^2)
+sage: Fqq.<b> = GF(5^4)
+sage: f = Fq['x'].random_element(); f
+3*x^2 + (a + 4)*x + 2*a + 4
+sage: Fqq['y'](f)
+3*y^2 + (b + 4)*y + 2*b + 4
+```
+In this example, Sage simply replaces every ‘a’ with ‘b’, but a is not b.  If we coerce directly from Fq to Fqq, we get a `NotImplementedError`, which is unfortunate but in any case not incorrect. ;).
+
+```
+sage: Fqq(a)
+…
+/usr/local/share/sage/sage/local/lib/python2.6/site-packages/sage/rings/finite_rings/finite_field_givaro.pyc in _coerce_map_from_(self, R)
+    348                 elif self.degree() % R.degree() == 0:
+    349                     # This is where we *would* do coercion from one nontrivial finite field to another...
+--> 350                     raise NotImplementedError
+    351 
+    352     def gen(self, n=0):
+
+NotImplementedError:
+```
 
 Comment: 1
 
```




---

archive/issue_comments_126886.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2011-10-19T08:56:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126886",
    "user": "https://github.com/dkrenn"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_126887.json:
```json
{
    "body": "<a id='comment:3'></a>It seems that everything that can be represented as polynomial is converted in that way. The phenomenon also appears with quotient rings:\n\n```\nsage: R.<x> = ZZ[]\nsage: A.<a> = R.quotient(x^3+2); PA.<s> = A[]\nsage: B.<b> = R.quotient(x^5+3); PB.<t> = B[]\nsage: f = a*s^3 + a^2*s; f\na*s^3 + a^2*s\nsage: PB(f)\nb*t^3 + b^2*t\n```\nOne way to solve this problem would be to check whether the coefficients of one polynomial rings can be converted (coerced) to the other...",
    "created_at": "2011-10-19T08:56:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126887",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:3'></a>It seems that everything that can be represented as polynomial is converted in that way. The phenomenon also appears with quotient rings:

```
sage: R.<x> = ZZ[]
sage: A.<a> = R.quotient(x^3+2); PA.<s> = A[]
sage: B.<b> = R.quotient(x^5+3); PB.<t> = B[]
sage: f = a*s^3 + a^2*s; f
a*s^3 + a^2*s
sage: PB(f)
b*t^3 + b^2*t
```
One way to solve this problem would be to check whether the coefficients of one polynomial rings can be converted (coerced) to the other...



---

archive/issue_comments_126888.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [comment:3 dkrenn]:\n> One way to solve this problem would be to check whether the coefficients of one polynomial rings can be converted (coerced) to the other...\n\n\nI would strongly advice against the attempt to solve it on the level of conversion.\n\nI know that at least some classes of polynomial rings are still following the old coercion model, and am preparing a patch that is supposed to fix that. According to the new model, there should be a method `_element_constructor_` that does the conversion, and a separate `_coerce_map_from_`, that determines whether there is a coercion (not just a conversion).\n\nI think that it is ok to have that bogus conversion - as long as it is not used as a coercion. One could, of course, try to throw an error when doing a conversion in the case that there is no fixed embedding of the base rings. However, testing it *repeatedly*, that's to say testing it *for each individual polynomial to be converted*, sounds like a waste of computation time to me.",
    "created_at": "2011-10-24T11:03:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126888",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:4'></a>Replying to [comment:3 dkrenn]:
> One way to solve this problem would be to check whether the coefficients of one polynomial rings can be converted (coerced) to the other...


I would strongly advice against the attempt to solve it on the level of conversion.

I know that at least some classes of polynomial rings are still following the old coercion model, and am preparing a patch that is supposed to fix that. According to the new model, there should be a method `_element_constructor_` that does the conversion, and a separate `_coerce_map_from_`, that determines whether there is a coercion (not just a conversion).

I think that it is ok to have that bogus conversion - as long as it is not used as a coercion. One could, of course, try to throw an error when doing a conversion in the case that there is no fixed embedding of the base rings. However, testing it *repeatedly*, that's to say testing it *for each individual polynomial to be converted*, sounds like a waste of computation time to me.



---

archive/issue_comments_126889.json:
```json
{
    "body": "<a id='comment:6'></a>If in the example in the ticket description, one replaces\n\n```\nsage: Fqq['y'](f)\n```\nby\n\n```\nsage: Fqq['y']._coerce_(f)\n```\none at least gets a sensible error:\n\n```\nTypeError: no canonical coercion from Univariate Polynomial Ring in x over Finite Field in a of size 5^2 to Univariate Polynomial Ring in y over Finite Field in b of size 5^4\n```\n\nI tried the same example using the compatible finite fields from #8335.  The problem (that the coefficients are converted in the stupid way) persists, both for conversion and for coercion.  This is surprising, because in that case there *is* a coercion map between the finite fields.",
    "created_at": "2013-08-05T16:19:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126889",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:6'></a>If in the example in the ticket description, one replaces

```
sage: Fqq['y'](f)
```
by

```
sage: Fqq['y']._coerce_(f)
```
one at least gets a sensible error:

```
TypeError: no canonical coercion from Univariate Polynomial Ring in x over Finite Field in a of size 5^2 to Univariate Polynomial Ring in y over Finite Field in b of size 5^4
```

I tried the same example using the compatible finite fields from #8335.  The problem (that the coefficients are converted in the stupid way) persists, both for conversion and for coercion.  This is surprising, because in that case there *is* a coercion map between the finite fields.



---

archive/issue_comments_126890.json:
```json
{
    "body": "<a id='comment:7'></a>The problem lies in the *NTL implementation* of polynomials over finite fields.  (Edit: this was already discovered in comment:2 above.)  This is the default implementation for polynomials over finite fields, even though the fields themselves are only implemented via NTL in characteristic 2, and via Givaro or PARI otherwise.\n\nThe following example demonstrates this (after applying #8335 plus a patch that I will upload shortly):\n\n```\nsage: K.<a> = GF(5^2, conway=True, prefix='z')\nsage: L.<b> = GF(5^4, conway=True, prefix='z')\nsage: type(K)\n<class 'sage.rings.finite_rings.finite_field_givaro.FiniteField_givaro_with_category'>\nsage: R = PolynomialRing(K, 'x', implementation='NTL')\nsage: S = PolynomialRing(L, 'x', implementation='NTL')\nsage: f = R.gen() + a; f\nx + a\nsage: type(f)\n<type 'sage.rings.polynomial.polynomial_zz_pex.Polynomial_ZZ_pEX'>\nsage: S(f)\nx + b\nsage: R = PolynomialRing(K, 'x', implementation='generic')\nsage: S = PolynomialRing(L, 'x', implementation='generic')\nsage: f = R.gen() + a; f\nx + a\nsage: type(f)\n<class 'sage.rings.polynomial.polynomial_element_generic.Polynomial_generic_dense_field'>\nsage: S(f)\nx + b^3 + b^2 + b + 3\n```",
    "created_at": "2013-08-05T17:51:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126890",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:7'></a>The problem lies in the *NTL implementation* of polynomials over finite fields.  (Edit: this was already discovered in comment:2 above.)  This is the default implementation for polynomials over finite fields, even though the fields themselves are only implemented via NTL in characteristic 2, and via Givaro or PARI otherwise.

The following example demonstrates this (after applying #8335 plus a patch that I will upload shortly):

```
sage: K.<a> = GF(5^2, conway=True, prefix='z')
sage: L.<b> = GF(5^4, conway=True, prefix='z')
sage: type(K)
<class 'sage.rings.finite_rings.finite_field_givaro.FiniteField_givaro_with_category'>
sage: R = PolynomialRing(K, 'x', implementation='NTL')
sage: S = PolynomialRing(L, 'x', implementation='NTL')
sage: f = R.gen() + a; f
x + a
sage: type(f)
<type 'sage.rings.polynomial.polynomial_zz_pex.Polynomial_ZZ_pEX'>
sage: S(f)
x + b
sage: R = PolynomialRing(K, 'x', implementation='generic')
sage: S = PolynomialRing(L, 'x', implementation='generic')
sage: f = R.gen() + a; f
x + a
sage: type(f)
<class 'sage.rings.polynomial.polynomial_element_generic.Polynomial_generic_dense_field'>
sage: S(f)
x + b^3 + b^2 + b + 3
```



---

archive/issue_comments_126891.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2013-08-05T17:56:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126891",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_126892.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,29 @@\n+Trying to coerce a polynomial over a finite field into a polynomial ring over a bigger field gives a bogus result:\n+\n+```\n+sage: Fq.<a> = GF(5^2)\n+sage: Fqq.<b> = GF(5^4)\n+sage: f = Fq['x'].random_element(); f\n+3*x^2 + (a + 4)*x + 2*a + 4\n+sage: Fqq['y'](f)\n+3*y^2 + (b + 4)*y + 2*b + 4\n+```\n+In this example, Sage simply replaces every \u2018a\u2019 with \u2018b\u2019, but a is not b.  If we coerce directly from Fq to Fqq, we get a `NotImplementedError`, which is unfortunate but in any case not incorrect. ;).\n+\n+```\n+sage: Fqq(a)\n+\u2026\n+/usr/local/share/sage/sage/local/lib/python2.6/site-packages/sage/rings/finite_rings/finite_field_givaro.pyc in _coerce_map_from_(self, R)\n+    348                 elif self.degree() % R.degree() == 0:\n+    349                     # This is where we *would* do coercion from one nontrivial finite field to another...\n+--> 350                     raise NotImplementedError\n+    351 \n+    352     def gen(self, n=0):\n+\n+NotImplementedError:\n+```\n+\n+Apply: [attachment:trac_11239-polynomial_coercion_preliminary.patch]\n \n \n Comment: 1\n```\n",
    "created_at": "2013-08-05T17:56:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126892",
    "user": "https://github.com/pjbruin"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,29 @@
+Trying to coerce a polynomial over a finite field into a polynomial ring over a bigger field gives a bogus result:
+
+```
+sage: Fq.<a> = GF(5^2)
+sage: Fqq.<b> = GF(5^4)
+sage: f = Fq['x'].random_element(); f
+3*x^2 + (a + 4)*x + 2*a + 4
+sage: Fqq['y'](f)
+3*y^2 + (b + 4)*y + 2*b + 4
+```
+In this example, Sage simply replaces every ‘a’ with ‘b’, but a is not b.  If we coerce directly from Fq to Fqq, we get a `NotImplementedError`, which is unfortunate but in any case not incorrect. ;).
+
+```
+sage: Fqq(a)
+…
+/usr/local/share/sage/sage/local/lib/python2.6/site-packages/sage/rings/finite_rings/finite_field_givaro.pyc in _coerce_map_from_(self, R)
+    348                 elif self.degree() % R.degree() == 0:
+    349                     # This is where we *would* do coercion from one nontrivial finite field to another...
+--> 350                     raise NotImplementedError
+    351 
+    352     def gen(self, n=0):
+
+NotImplementedError:
+```
+
+Apply: [attachment:trac_11239-polynomial_coercion_preliminary.patch]
 
 
 Comment: 1
```




---

archive/issue_comments_126893.json:
```json
{
    "body": "<a id='comment:9'></a>At this point there are two possible solutions:\n- either fix the NTL polynomial constructor,\n- or make the generic polynomial constructor coerce the coefficients if necessary, and make the NTL polynomial constructor raise an error if it is given a polynomial over a smaller finite field.\nThe first solution would be preferable in principle, but certainly harder and maybe even unreasonable, since the NTL polynomial constructor is a lower-level thing that should not have to care about maps between non-trivial finite fields.",
    "created_at": "2013-08-05T18:05:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126893",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:9'></a>At this point there are two possible solutions:
- either fix the NTL polynomial constructor,
- or make the generic polynomial constructor coerce the coefficients if necessary, and make the NTL polynomial constructor raise an error if it is given a polynomial over a smaller finite field.
The first solution would be preferable in principle, but certainly harder and maybe even unreasonable, since the NTL polynomial constructor is a lower-level thing that should not have to care about maps between non-trivial finite fields.



---

archive/issue_comments_126894.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:3 dkrenn]:\n> It seems that everything that can be represented as polynomial is converted in that way. The phenomenon also appears with quotient rings:\n> \n> \n> ```\n> sage: R.<x> = ZZ[]\n> sage: A.<a> = R.quotient(x^3+2); PA.<s> = A[]\n> sage: B.<b> = R.quotient(x^5+3); PB.<t> = B[]\n> sage: f = a*s^3 + a^2*s; f\n> a*s^3 + a^2*s\n> sage: PB(f)\n> b*t^3 + b^2*t\n> ```\n\nDebatable as it may seem, this is the behaviour currently described in the documentation of `PolynomialQuotientRing_generic._element_constructor_()`.  Attempting a coercion (`PB.coerce(f)`) instead of a conversion (`PB(f)`) does lead to\n\n```\nTypeError: no canonical coercion from Univariate Polynomial Ring in s over Univariate Quotient Polynomial Ring in a over Integer Ring with modulus x^3 + 2 to Univariate Polynomial Ring in t over Univariate Quotient Polynomial Ring in b over Integer Ring with modulus x^5 + 3\n```\nas expected.",
    "created_at": "2013-08-05T19:55:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126894",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:10'></a>Replying to [comment:3 dkrenn]:
> It seems that everything that can be represented as polynomial is converted in that way. The phenomenon also appears with quotient rings:
> 
> 
> ```
> sage: R.<x> = ZZ[]
> sage: A.<a> = R.quotient(x^3+2); PA.<s> = A[]
> sage: B.<b> = R.quotient(x^5+3); PB.<t> = B[]
> sage: f = a*s^3 + a^2*s; f
> a*s^3 + a^2*s
> sage: PB(f)
> b*t^3 + b^2*t
> ```

Debatable as it may seem, this is the behaviour currently described in the documentation of `PolynomialQuotientRing_generic._element_constructor_()`.  Attempting a coercion (`PB.coerce(f)`) instead of a conversion (`PB(f)`) does lead to

```
TypeError: no canonical coercion from Univariate Polynomial Ring in s over Univariate Quotient Polynomial Ring in a over Integer Ring with modulus x^3 + 2 to Univariate Polynomial Ring in t over Univariate Quotient Polynomial Ring in b over Integer Ring with modulus x^5 + 3
```
as expected.



---

archive/issue_comments_126895.json:
```json
{
    "body": "Attachment [trac_11239-polynomial_zz_pex.patch](tarball://root/attachments/some-uuid/ticket11239/trac_11239-polynomial_zz_pex.patch) by @pjbruin created at 2013-08-05 23:30:41\n\nfix coercion of polynomials over finite fields",
    "created_at": "2013-08-05T23:30:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126895",
    "user": "https://github.com/pjbruin"
}
```

Attachment [trac_11239-polynomial_zz_pex.patch](tarball://root/attachments/some-uuid/ticket11239/trac_11239-polynomial_zz_pex.patch) by @pjbruin created at 2013-08-05 23:30:41

fix coercion of polynomials over finite fields



---

archive/issue_comments_126896.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,29 @@\n+Trying to coerce a polynomial over a finite field into a polynomial ring over a bigger field gives a bogus result:\n+\n+```\n+sage: Fq.<a> = GF(5^2)\n+sage: Fqq.<b> = GF(5^4)\n+sage: f = Fq['x'].random_element(); f\n+3*x^2 + (a + 4)*x + 2*a + 4\n+sage: Fqq['y'](f)\n+3*y^2 + (b + 4)*y + 2*b + 4\n+```\n+In this example, Sage simply replaces every \u2018a\u2019 with \u2018b\u2019, but a is not b.  If we coerce directly from Fq to Fqq, we get a `NotImplementedError`, which is unfortunate but in any case not incorrect. ;).\n+\n+```\n+sage: Fqq(a)\n+\u2026\n+/usr/local/share/sage/sage/local/lib/python2.6/site-packages/sage/rings/finite_rings/finite_field_givaro.pyc in _coerce_map_from_(self, R)\n+    348                 elif self.degree() % R.degree() == 0:\n+    349                     # This is where we *would* do coercion from one nontrivial finite field to another...\n+--> 350                     raise NotImplementedError\n+    351 \n+    352     def gen(self, n=0):\n+\n+NotImplementedError:\n+```\n+\n+Apply: [attachment:trac_11239-polynomial_coercion_preliminary.patch], [attachment:trac_11239-polynomial_zz_pex.patch]\n \n \n Comment: 1\n```\n",
    "created_at": "2013-08-05T23:37:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126896",
    "user": "https://github.com/pjbruin"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,29 @@
+Trying to coerce a polynomial over a finite field into a polynomial ring over a bigger field gives a bogus result:
+
+```
+sage: Fq.<a> = GF(5^2)
+sage: Fqq.<b> = GF(5^4)
+sage: f = Fq['x'].random_element(); f
+3*x^2 + (a + 4)*x + 2*a + 4
+sage: Fqq['y'](f)
+3*y^2 + (b + 4)*y + 2*b + 4
+```
+In this example, Sage simply replaces every ‘a’ with ‘b’, but a is not b.  If we coerce directly from Fq to Fqq, we get a `NotImplementedError`, which is unfortunate but in any case not incorrect. ;).
+
+```
+sage: Fqq(a)
+…
+/usr/local/share/sage/sage/local/lib/python2.6/site-packages/sage/rings/finite_rings/finite_field_givaro.pyc in _coerce_map_from_(self, R)
+    348                 elif self.degree() % R.degree() == 0:
+    349                     # This is where we *would* do coercion from one nontrivial finite field to another...
+--> 350                     raise NotImplementedError
+    351 
+    352     def gen(self, n=0):
+
+NotImplementedError:
+```
+
+Apply: [attachment:trac_11239-polynomial_coercion_preliminary.patch], [attachment:trac_11239-polynomial_zz_pex.patch]
 
 
 Comment: 1
```




---

archive/issue_comments_126897.json:
```json
{
    "body": "<a id='comment:11'></a>Fixing the NTL polynomial constructor turned out to be easy.  With the second patch, polynomials over compatible finite fields (#8335) coerce correctly, and trying to convert polynomials over non-compatible finite fields raises a `TypeError`, as it should.",
    "created_at": "2013-08-05T23:37:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126897",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:11'></a>Fixing the NTL polynomial constructor turned out to be easy.  With the second patch, polynomials over compatible finite fields (#8335) coerce correctly, and trying to convert polynomials over non-compatible finite fields raises a `TypeError`, as it should.



---

archive/issue_comments_126898.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-08-05T23:37:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126898",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_029105.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11239#event-29105"
}
```



---

archive/issue_comments_126899.json:
```json
{
    "body": "Changing keywords from \"finite fields, polynomials, coercion\" to \"finite fields, polynomials, coercion, sd53\".",
    "created_at": "2013-09-26T18:04:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126899",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing keywords from "finite fields, polynomials, coercion" to "finite fields, polynomials, coercion, sd53".



---

archive/issue_comments_126900.json:
```json
{
    "body": "<a id='comment:14'></a>Just stumbled upon that bug while playing with finite fields.\nThis is really a nice bug.",
    "created_at": "2013-09-26T18:04:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126900",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:14'></a>Just stumbled upon that bug while playing with finite fields.
This is really a nice bug.



---

archive/issue_comments_126901.json:
```json
{
    "body": "Attachment [trac_11239-polynomial_coercion_preliminary.patch](tarball://root/attachments/some-uuid/ticket11239/trac_11239-polynomial_coercion_preliminary.patch) by @pjbruin created at 2013-11-02 19:24:12\n\nupdate (old version had bogus doctest fix)",
    "created_at": "2013-11-02T19:24:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126901",
    "user": "https://github.com/pjbruin"
}
```

Attachment [trac_11239-polynomial_coercion_preliminary.patch](tarball://root/attachments/some-uuid/ticket11239/trac_11239-polynomial_coercion_preliminary.patch) by @pjbruin created at 2013-11-02 19:24:12

update (old version had bogus doctest fix)



---

archive/issue_comments_126902.json:
```json
{
    "body": "<a id='comment:15'></a>Peter, have you considered the impact of using has_coerce_map on the level of conversion? memory and time consumption.",
    "created_at": "2013-12-21T12:54:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126902",
    "user": "https://github.com/lftabera"
}
```

<a id='comment:15'></a>Peter, have you considered the impact of using has_coerce_map on the level of conversion? memory and time consumption.



---

archive/issue_comments_126903.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:15 lftabera]:\n> Peter, have you considered the impact of using has_coerce_map on the level of conversion? memory and time consumption.\n\nNot really; my first priority was to get correct behaviour, preferably in a clean way.  The cause of this bug appears to be precisely that the conversion currently doesn't check if a coercion exists.  Do you have an example in which this patch is too inefficient?",
    "created_at": "2013-12-21T14:58:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126903",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:16'></a>Replying to [comment:15 lftabera]:
> Peter, have you considered the impact of using has_coerce_map on the level of conversion? memory and time consumption.

Not really; my first priority was to get correct behaviour, preferably in a clean way.  The cause of this bug appears to be precisely that the conversion currently doesn't check if a coercion exists.  Do you have an example in which this patch is too inefficient?



---

archive/issue_comments_126904.json:
```json
{
    "body": "<a id='comment:17'></a>I agree with Peter.\nLet's get somethig correct first.\nThe current behavior is just non sense and prone to horrible errors in computations.\nWe can speed it up later rather than let this bitrot forever.",
    "created_at": "2013-12-25T15:53:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126904",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:17'></a>I agree with Peter.
Let's get somethig correct first.
The current behavior is just non sense and prone to horrible errors in computations.
We can speed it up later rather than let this bitrot forever.



---

archive/issue_comments_126905.json:
```json
{
    "body": "<a id='comment:18'></a>Anyway, the coercion framework is already called in the previous test so efficiency is already potentially screwed up.\n\nI've just made a git branch from the patch.\nOtherwise looks good to me, positive review.\n\n---\nNew commits:",
    "created_at": "2013-12-31T10:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126905",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:18'></a>Anyway, the coercion framework is already called in the previous test so efficiency is already potentially screwed up.

I've just made a git branch from the patch.
Otherwise looks good to me, positive review.

---
New commits:



---

archive/issue_comments_126906.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-12-31T10:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126906",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_126907.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,29 @@\n+Trying to coerce a polynomial over a finite field into a polynomial ring over a bigger field gives a bogus result:\n+\n+```\n+sage: Fq.<a> = GF(5^2)\n+sage: Fqq.<b> = GF(5^4)\n+sage: f = Fq['x'].random_element(); f\n+3*x^2 + (a + 4)*x + 2*a + 4\n+sage: Fqq['y'](f)\n+3*y^2 + (b + 4)*y + 2*b + 4\n+```\n+In this example, Sage simply replaces every \u2018a\u2019 with \u2018b\u2019, but a is not b.  If we coerce directly from Fq to Fqq, we get a `NotImplementedError`, which is unfortunate but in any case not incorrect. ;).\n+\n+```\n+sage: Fqq(a)\n+\u2026\n+/usr/local/share/sage/sage/local/lib/python2.6/site-packages/sage/rings/finite_rings/finite_field_givaro.pyc in _coerce_map_from_(self, R)\n+    348                 elif self.degree() % R.degree() == 0:\n+    349                     # This is where we *would* do coercion from one nontrivial finite field to another...\n+--> 350                     raise NotImplementedError\n+    351 \n+    352     def gen(self, n=0):\n+\n+NotImplementedError:\n+```\n+\n+Use git branch.\n \n \n Comment: 1\n```\n",
    "created_at": "2013-12-31T10:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126907",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,29 @@
+Trying to coerce a polynomial over a finite field into a polynomial ring over a bigger field gives a bogus result:
+
+```
+sage: Fq.<a> = GF(5^2)
+sage: Fqq.<b> = GF(5^4)
+sage: f = Fq['x'].random_element(); f
+3*x^2 + (a + 4)*x + 2*a + 4
+sage: Fqq['y'](f)
+3*y^2 + (b + 4)*y + 2*b + 4
+```
+In this example, Sage simply replaces every ‘a’ with ‘b’, but a is not b.  If we coerce directly from Fq to Fqq, we get a `NotImplementedError`, which is unfortunate but in any case not incorrect. ;).
+
+```
+sage: Fqq(a)
+…
+/usr/local/share/sage/sage/local/lib/python2.6/site-packages/sage/rings/finite_rings/finite_field_givaro.pyc in _coerce_map_from_(self, R)
+    348                 elif self.degree() % R.degree() == 0:
+    349                     # This is where we *would* do coercion from one nontrivial finite field to another...
+--> 350                     raise NotImplementedError
+    351 
+    352     def gen(self, n=0):
+
+NotImplementedError:
+```
+
+Use git branch.
 
 
 Comment: 1
```




---

archive/issue_comments_126908.json:
```json
{
    "body": "<a id='comment:19'></a>In the doc about the coercion framework, it's written that a conversion is not supposed to make mathematical sense, but in this case I feel it's really conterintuitive and prone to errors to let L(f) just replace the generator of a finite field with another one, especially when another conversion/coercion makes sense, whence the need for this ticket...\n\nIf someone thinks the solution is overkill and goes against the coercion model philosophy, feel free to put the ticket back to another status.",
    "created_at": "2013-12-31T10:51:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126908",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:19'></a>In the doc about the coercion framework, it's written that a conversion is not supposed to make mathematical sense, but in this case I feel it's really conterintuitive and prone to errors to let L(f) just replace the generator of a finite field with another one, especially when another conversion/coercion makes sense, whence the need for this ticket...

If someone thinks the solution is overkill and goes against the coercion model philosophy, feel free to put the ticket back to another status.



---

archive/issue_comments_126909.json:
```json
{
    "body": "<a id='comment:20'></a>Not sure what to think about the quotients of univariate polynomial rings, except that it really feel akward.",
    "created_at": "2013-12-31T10:52:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126909",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:20'></a>Not sure what to think about the quotients of univariate polynomial rings, except that it really feel akward.



---

archive/issue_comments_126910.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2013-12-31T11:48:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126910",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_126911.json:
```json
{
    "body": "<a id='comment:21'></a>Maybe this is worth a broader discussion on sage-devel...\n\nEspecially, should we let the stupid conversion in when there is no coercion (as it seems to fit Sage's philosophy and it is in place for quotients)?",
    "created_at": "2013-12-31T11:48:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126911",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:21'></a>Maybe this is worth a broader discussion on sage-devel...

Especially, should we let the stupid conversion in when there is no coercion (as it seems to fit Sage's philosophy and it is in place for quotients)?



---

archive/issue_comments_126912.json:
```json
{
    "body": "<a id='comment:22'></a>Here you go:\n* https://groups.google.com/d/msg/sage-devel/Z4iNgVMFoms/HxIZ98edPk0J",
    "created_at": "2013-12-31T11:59:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126912",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:22'></a>Here you go:
* https://groups.google.com/d/msg/sage-devel/Z4iNgVMFoms/HxIZ98edPk0J



---

archive/issue_comments_126913.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:21 jpflori]:\n> Maybe this is worth a broader discussion on sage-devel...\n\nI think it is worth thinking about whether the \"stupid\" conversion should be allowed between different quotients of a polynomial ring.  However, for the problem addressed in this ticket, there is really only one sensible thing to do, namely applying the canonical map between the base rings.\n\n> Especially, should we let the stupid conversion in when there is no coercion (as it seems to fit Sage's philosophy and it is in place for quotients)?\n\nI personally think that allowing `Fqq['y'](f)` to 'desperately' apply any available conversion, however nonsensical it may be, to the coefficients is a bad idea.  I don't see what is gained by permitting this notation; it seems to make it far too easy for the user to unwittingy introduce mysterious errors in this way.  If someone really wants this behaviour, it is much better to require explicitly lifting the finite field elements to **Z**[*x*] or another suitable ring.\n\nI would be in favour of a less permissive approach for conversions between different polynomial ring quotients as well, but again, this ticket is not the place to decide that.",
    "created_at": "2013-12-31T12:35:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126913",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:23'></a>Replying to [comment:21 jpflori]:
> Maybe this is worth a broader discussion on sage-devel...

I think it is worth thinking about whether the "stupid" conversion should be allowed between different quotients of a polynomial ring.  However, for the problem addressed in this ticket, there is really only one sensible thing to do, namely applying the canonical map between the base rings.

> Especially, should we let the stupid conversion in when there is no coercion (as it seems to fit Sage's philosophy and it is in place for quotients)?

I personally think that allowing `Fqq['y'](f)` to 'desperately' apply any available conversion, however nonsensical it may be, to the coefficients is a bad idea.  I don't see what is gained by permitting this notation; it seems to make it far too easy for the user to unwittingy introduce mysterious errors in this way.  If someone really wants this behaviour, it is much better to require explicitly lifting the finite field elements to **Z**[*x*] or another suitable ring.

I would be in favour of a less permissive approach for conversions between different polynomial ring quotients as well, but again, this ticket is not the place to decide that.



---

archive/issue_comments_126914.json:
```json
{
    "body": "<a id='comment:24'></a>Replying to [comment:23 pbruin]:\n> Replying to [comment:21 jpflori]:\n> > Maybe this is worth a broader discussion on sage-devel...\n\n> I think it is worth thinking about whether the \"stupid\" conversion should be allowed between different quotients of a polynomial ring.  However, for the problem addressed in this ticket, there is really only one sensible thing to do, namely applying the canonical map between the base rings.\n> \n\nI agree.\n\n> > Especially, should we let the stupid conversion in when there is no coercion (as it seems to fit Sage's philosophy and it is in place for quotients)?\n\n> I personally think that allowing `Fqq['y'](f)` to 'desperately' apply any available conversion, however nonsensical it may be, to the coefficients is a bad idea.  I don't see what is gained by permitting this notation; it seems to make it far too easy for the user to unwittingy introduce mysterious errors in this way.  If someone really wants this behaviour, it is much better to require explicitly lifting the finite field elements to **Z**[*x*] or another suitable ring.\nI completely agree, whence my previous positive review.\nBut the doc for coercion kind of make me think, humm, maybe some people want the stupid behavior as well...\n\n> \n> I would be in favour of a less permissive approach for conversions between different polynomial ring quotients as well, but again, this ticket is not the place to decide that.\n\nI agree as well, I was just menitoning it because it's already mentioned here :)\n\nAnyway, if nobody gives a strong opinion of why to keep conversions without any mathematical sense and confusing for naive users on sage-devel, then I'll put this back to positive review quickly as I think that the situation with this ticket is far better.\nNote that maybe some efficiency could be gained by replacing the has_coerce_map_from by something else but I have no idea what to do now and no time to think about it, I'd just like to remove the stupid conversion unless someone convinces me to keep them of course.",
    "created_at": "2013-12-31T12:45:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126914",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:24'></a>Replying to [comment:23 pbruin]:
> Replying to [comment:21 jpflori]:
> > Maybe this is worth a broader discussion on sage-devel...

> I think it is worth thinking about whether the "stupid" conversion should be allowed between different quotients of a polynomial ring.  However, for the problem addressed in this ticket, there is really only one sensible thing to do, namely applying the canonical map between the base rings.
> 

I agree.

> > Especially, should we let the stupid conversion in when there is no coercion (as it seems to fit Sage's philosophy and it is in place for quotients)?

> I personally think that allowing `Fqq['y'](f)` to 'desperately' apply any available conversion, however nonsensical it may be, to the coefficients is a bad idea.  I don't see what is gained by permitting this notation; it seems to make it far too easy for the user to unwittingy introduce mysterious errors in this way.  If someone really wants this behaviour, it is much better to require explicitly lifting the finite field elements to **Z**[*x*] or another suitable ring.
I completely agree, whence my previous positive review.
But the doc for coercion kind of make me think, humm, maybe some people want the stupid behavior as well...

> 
> I would be in favour of a less permissive approach for conversions between different polynomial ring quotients as well, but again, this ticket is not the place to decide that.

I agree as well, I was just menitoning it because it's already mentioned here :)

Anyway, if nobody gives a strong opinion of why to keep conversions without any mathematical sense and confusing for naive users on sage-devel, then I'll put this back to positive review quickly as I think that the situation with this ticket is far better.
Note that maybe some efficiency could be gained by replacing the has_coerce_map_from by something else but I have no idea what to do now and no time to think about it, I'd just like to remove the stupid conversion unless someone convinces me to keep them of course.



---

archive/issue_comments_126915.json:
```json
{
    "body": "<a id='comment:25'></a>See my answer on sage-devel. In a nutshell: I would recommend against doing expensive tests when talking about conversion, and I would be rather permissive in conversions.\n\nConversions have no defined properties, and thus there is nothing that one could test. They don't need to be composable. They aren't even maps (only partially defined). It is perfectly fine to have a conversion for all elements of a ring R1 into a ring R2 and of all elements of a ring R2 into a ring R3, but only some elements (e.g.: polynomials of degree zero) of R1 convert into R3 without raising an error.\n\nPlease clearly distinguish between coercion and conversion. Coercions are morphisms. They are unique (for any pair of parents). They can be composed. The identity is a morphism (which together with the uniqueness and composability can imply the non-existence of certain coercions).\n\nI only know of one rule for conversion: If there is a coercion then conversion must coincide with it. And since the rules for conversions are so relaxed, I don't see why one should do expensive tests before applying a conversion (in particular when one thinks that conversions are not defined parent-by-parent, but element-by-element).",
    "created_at": "2013-12-31T17:21:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126915",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:25'></a>See my answer on sage-devel. In a nutshell: I would recommend against doing expensive tests when talking about conversion, and I would be rather permissive in conversions.

Conversions have no defined properties, and thus there is nothing that one could test. They don't need to be composable. They aren't even maps (only partially defined). It is perfectly fine to have a conversion for all elements of a ring R1 into a ring R2 and of all elements of a ring R2 into a ring R3, but only some elements (e.g.: polynomials of degree zero) of R1 convert into R3 without raising an error.

Please clearly distinguish between coercion and conversion. Coercions are morphisms. They are unique (for any pair of parents). They can be composed. The identity is a morphism (which together with the uniqueness and composability can imply the non-existence of certain coercions).

I only know of one rule for conversion: If there is a coercion then conversion must coincide with it. And since the rules for conversions are so relaxed, I don't see why one should do expensive tests before applying a conversion (in particular when one thinks that conversions are not defined parent-by-parent, but element-by-element).



---

archive/issue_comments_126916.json:
```json
{
    "body": "<a id='comment:26'></a>Replying to [comment:25 SimonKing]:\n> See my answer on sage-devel. In a nutshell: I would recommend against doing expensive tests when talking about conversion, and I would be rather permissive in conversions.\n> \n> Conversions have no defined properties, and thus there is nothing that one could test.\n\n\nGiven that a conversion needs to coincide with the coercion if the latter exists, one must check for a coercion before applying the \"stupid\" conversion (assuming the \"stupid\" conversion is desired at all).\n\nIn the situation of this ticket, there is a coercion map between the polynomial rings (assuming the finite fields know that they are compatible; see the doctests, not the ticket description).  The problem was that the element constructor didn't check for this and always applied the \"stupid\" conversion.  (The same problem arises when using `R.coerce(f)`, because the coercion map just defers to a conversion using the element constructor.)\n\nI think the point in the above discussion was whether my solution of calling `has_coerce_map_from()` is expensive; I guess not, but even if it is, it is still necessary to guarantee compatibility of conversion and coercion.\n\n> They don't need to be composable. They aren't even maps (only partially defined). It is perfectly fine to have a conversion for all elements of a ring R1 into a ring R2 and of all elements of a ring R2 into a ring R3, but only some elements (e.g.: polynomials of degree zero) of R1 convert into R3 without raising an error.\n\n\nThat is actually what I was trying to say on sage-devel in the context of polynomial ring quotients, but I wasn't very clear.  I agree that the existence of coercion doesn't have to be transitive, or to satisfy any rules; in the context of this ticket, I think it is perfectly fine if the \"stupid\" conversion is not used at all.",
    "created_at": "2013-12-31T18:11:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126916",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:26'></a>Replying to [comment:25 SimonKing]:
> See my answer on sage-devel. In a nutshell: I would recommend against doing expensive tests when talking about conversion, and I would be rather permissive in conversions.
> 
> Conversions have no defined properties, and thus there is nothing that one could test.


Given that a conversion needs to coincide with the coercion if the latter exists, one must check for a coercion before applying the "stupid" conversion (assuming the "stupid" conversion is desired at all).

In the situation of this ticket, there is a coercion map between the polynomial rings (assuming the finite fields know that they are compatible; see the doctests, not the ticket description).  The problem was that the element constructor didn't check for this and always applied the "stupid" conversion.  (The same problem arises when using `R.coerce(f)`, because the coercion map just defers to a conversion using the element constructor.)

I think the point in the above discussion was whether my solution of calling `has_coerce_map_from()` is expensive; I guess not, but even if it is, it is still necessary to guarantee compatibility of conversion and coercion.

> They don't need to be composable. They aren't even maps (only partially defined). It is perfectly fine to have a conversion for all elements of a ring R1 into a ring R2 and of all elements of a ring R2 into a ring R3, but only some elements (e.g.: polynomials of degree zero) of R1 convert into R3 without raising an error.


That is actually what I was trying to say on sage-devel in the context of polynomial ring quotients, but I wasn't very clear.  I agree that the existence of coercion doesn't have to be transitive, or to satisfy any rules; in the context of this ticket, I think it is perfectly fine if the "stupid" conversion is not used at all.



---

archive/issue_comments_126917.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:26 pbruin]:\n> Replying to [comment:25 SimonKing]:\n> > See my answer on sage-devel. In a nutshell: I would recommend against doing expensive tests when talking about conversion, and I would be rather permissive in conversions.\n> > \n> > Conversions have no defined properties, and thus there is nothing that one could test.\n\n> \n> Given that a conversion needs to coincide with the coercion if the latter exists, one must check for a coercion before applying the \"stupid\" conversion (assuming the \"stupid\" conversion is desired at all).\n\n\nNo!! It is just the other way around! Ideally, you have a fast cheap stupid conversion, and then a potentially expensive tests tells you whether this conversion qualifies as a coercion. This, by the way, is exactly what happens when `R._coerce_map_from_(S)` returns True: The return value asserts that the conversion qualifies as a coercion.\n\n> That is actually what I was trying to say on sage-devel in the context of polynomial ring quotients, but I wasn't very clear.  I agree that the existence of coercion doesn't have to be transitive, or to satisfy any rules; \n\n\nYou mean, conversion, not coercion? Coercion must be transitive. That's one of the axioms.",
    "created_at": "2013-12-31T19:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126917",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:27'></a>Replying to [comment:26 pbruin]:
> Replying to [comment:25 SimonKing]:
> > See my answer on sage-devel. In a nutshell: I would recommend against doing expensive tests when talking about conversion, and I would be rather permissive in conversions.
> > 
> > Conversions have no defined properties, and thus there is nothing that one could test.

> 
> Given that a conversion needs to coincide with the coercion if the latter exists, one must check for a coercion before applying the "stupid" conversion (assuming the "stupid" conversion is desired at all).


No!! It is just the other way around! Ideally, you have a fast cheap stupid conversion, and then a potentially expensive tests tells you whether this conversion qualifies as a coercion. This, by the way, is exactly what happens when `R._coerce_map_from_(S)` returns True: The return value asserts that the conversion qualifies as a coercion.

> That is actually what I was trying to say on sage-devel in the context of polynomial ring quotients, but I wasn't very clear.  I agree that the existence of coercion doesn't have to be transitive, or to satisfy any rules; 


You mean, conversion, not coercion? Coercion must be transitive. That's one of the axioms.



---

archive/issue_comments_126918.json:
```json
{
    "body": "<a id='comment:28'></a>Replying to [comment:27 SimonKing]:\n> > Given that a conversion needs to coincide with the coercion if the latter exists, one must check for a coercion before applying the \"stupid\" conversion (assuming the \"stupid\" conversion is desired at all).\n\n> \n> No!! It is just the other way around!\n\n\nI think I see what you mean, but am still not sure.  Are you suggesting that also the existing\n\n```python\nelif self.base_ring().has_coerce_map_from(P):\n    return C(self, [x], check=True, is_gen=False,\n    construct=construct)\n```\nin `PolynomialRing._element_constructor_()` should go away and that there should be custom coercion maps to replace this check and the similar one added by my patch?\n\n> You mean, conversion, not coercion? Coercion must be transitive. That's one of the axioms.\n\nYes, I meant conversion.",
    "created_at": "2013-12-31T21:44:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126918",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:28'></a>Replying to [comment:27 SimonKing]:
> > Given that a conversion needs to coincide with the coercion if the latter exists, one must check for a coercion before applying the "stupid" conversion (assuming the "stupid" conversion is desired at all).

> 
> No!! It is just the other way around!


I think I see what you mean, but am still not sure.  Are you suggesting that also the existing

```python
elif self.base_ring().has_coerce_map_from(P):
    return C(self, [x], check=True, is_gen=False,
    construct=construct)
```
in `PolynomialRing._element_constructor_()` should go away and that there should be custom coercion maps to replace this check and the similar one added by my patch?

> You mean, conversion, not coercion? Coercion must be transitive. That's one of the axioms.

Yes, I meant conversion.



---

archive/issue_comments_126919.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:27 SimonKing]:\n> No!! It is just the other way around! Ideally, you have a fast cheap stupid conversion, and then a potentially expensive tests tells you whether this conversion qualifies as a coercion. This, by the way, is exactly what happens when `R._coerce_map_from_(S)` returns True: The return value asserts that the conversion qualifies as a coercion.\n\n\nActually, that is something I wondered about before. From an efficiency point of view this is a really bad idea: we have just established that between two very specific parents S and R there exists a coercion and to actually perform it we boot back to completely generic code that has to figure out exactly what conversion to apply, doing all kinds of type checks again. It would seem much better to refactor such code to immediately call the special case that the conversion code is going to arrive at anyway.",
    "created_at": "2013-12-31T22:56:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126919",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:29'></a>Replying to [comment:27 SimonKing]:
> No!! It is just the other way around! Ideally, you have a fast cheap stupid conversion, and then a potentially expensive tests tells you whether this conversion qualifies as a coercion. This, by the way, is exactly what happens when `R._coerce_map_from_(S)` returns True: The return value asserts that the conversion qualifies as a coercion.


Actually, that is something I wondered about before. From an efficiency point of view this is a really bad idea: we have just established that between two very specific parents S and R there exists a coercion and to actually perform it we boot back to completely generic code that has to figure out exactly what conversion to apply, doing all kinds of type checks again. It would seem much better to refactor such code to immediately call the special case that the conversion code is going to arrive at anyway.



---

archive/issue_comments_126920.json:
```json
{
    "body": "<a id='comment:30'></a>Here is the way in which I think this bug should be solved conceptually.  It is motivated by the fact that if *A* is a commutative ring, the object *A*[*x*] in the category of *A*-algebras represents the forgetful functor to the category of sets.\n- Implement a class `PolynomialRingMorphism` modelling ring homomorphisms *f*: *A*[*x*] -> *C*, where *A* and *C* are commutative rings.  Note that *C* is not required to be a polynomial ring.  Such ring homomorphisms correspond bijectively to pairs (*g*, *c*), where *g*: *A* -> *C* is a ring homomorphism and *c* is an element of *C*, where the bijection is given by *g* = *f*|<sub>A</sub> and *c* = *f*(*x*); cf. the above motivation.\n- Have optimised code for the following special case: *C* = *B*[*y*] where *B* is an *A*-algebra (or: has a coercion map from *A*), *g* is the composition of the obvious maps *A* -> *B* -> *C*, and *c* = *y*. In this case, *f* is the map *A*[*x*] -> *C*[*y*] that we will declare as the coercion map.  Given an element *p* of *A*[*x*], the `PolynomialRingMorphism` in this special case should just take the list of coefficients of *p*, map them to *B* and hence construct the desired element *f*(*p*) of *B*[*y*].\n- If *C* = *B*[*y*], where *B* has a coercion map from *A*, let `C._coerce_map_from_(A['x'])` return the `PolynomialRingMorphism` for the above special case.\n- A general `PolynomialRingMorphism` could be implemented either in terms of this special case or independently from it.  The first approach would work as follows: given a general *f*: *A*[*x*] -> *C* as in the first point, represented by a pair (*g*, *c*), applying *f* to a polynomial *p* in *A*[*x*] can be implemented by first mapping *p* to *C*[*y*] (applying *g* to the coefficients as in the special case) and then substituting *c* for *y*.\nThis is probably not very difficult to implement.  This ticket could function as a temporary solution for the bug it fixes, until we have the real solution.\n\nP.S. The current `_coerce_map_from_()`, in the case of univariate polynomial rings where there exists a coercion between the base rings, returns `False` unless the variable name is the same.  In the above, I chose the different letters *x* and *y* to clearly distinguish between the polynomial rings; they are not meant as Sage variable names.\n\nP.P.S. It turns out that the special case already exists (in more generality) as `RingHomomorphism_from_base`.  In the above notation, it applies *g* elementwise to the `dict` of coefficients; for univariate dense polynomials a `list` would probaby be faster, but it looks like a good starting point.",
    "created_at": "2014-01-03T23:53:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126920",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:30'></a>Here is the way in which I think this bug should be solved conceptually.  It is motivated by the fact that if *A* is a commutative ring, the object *A*[*x*] in the category of *A*-algebras represents the forgetful functor to the category of sets.
- Implement a class `PolynomialRingMorphism` modelling ring homomorphisms *f*: *A*[*x*] -> *C*, where *A* and *C* are commutative rings.  Note that *C* is not required to be a polynomial ring.  Such ring homomorphisms correspond bijectively to pairs (*g*, *c*), where *g*: *A* -> *C* is a ring homomorphism and *c* is an element of *C*, where the bijection is given by *g* = *f*|<sub>A</sub> and *c* = *f*(*x*); cf. the above motivation.
- Have optimised code for the following special case: *C* = *B*[*y*] where *B* is an *A*-algebra (or: has a coercion map from *A*), *g* is the composition of the obvious maps *A* -> *B* -> *C*, and *c* = *y*. In this case, *f* is the map *A*[*x*] -> *C*[*y*] that we will declare as the coercion map.  Given an element *p* of *A*[*x*], the `PolynomialRingMorphism` in this special case should just take the list of coefficients of *p*, map them to *B* and hence construct the desired element *f*(*p*) of *B*[*y*].
- If *C* = *B*[*y*], where *B* has a coercion map from *A*, let `C._coerce_map_from_(A['x'])` return the `PolynomialRingMorphism` for the above special case.
- A general `PolynomialRingMorphism` could be implemented either in terms of this special case or independently from it.  The first approach would work as follows: given a general *f*: *A*[*x*] -> *C* as in the first point, represented by a pair (*g*, *c*), applying *f* to a polynomial *p* in *A*[*x*] can be implemented by first mapping *p* to *C*[*y*] (applying *g* to the coefficients as in the special case) and then substituting *c* for *y*.
This is probably not very difficult to implement.  This ticket could function as a temporary solution for the bug it fixes, until we have the real solution.

P.S. The current `_coerce_map_from_()`, in the case of univariate polynomial rings where there exists a coercion between the base rings, returns `False` unless the variable name is the same.  In the above, I chose the different letters *x* and *y* to clearly distinguish between the polynomial rings; they are not meant as Sage variable names.

P.P.S. It turns out that the special case already exists (in more generality) as `RingHomomorphism_from_base`.  In the above notation, it applies *g* elementwise to the `dict` of coefficients; for univariate dense polynomials a `list` would probaby be faster, but it looks like a good starting point.



---

archive/issue_events_029106.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11239#event-29106"
}
```



---

archive/issue_events_029107.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11239#event-29107"
}
```



---

archive/issue_comments_126921.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-03-02T23:47:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126921",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_126922.json:
```json
{
    "body": "<a id='comment:32'></a>Here is a fix based on the existing one and the \"P.P.S\" from comment:30.  This gets rid of the test for coercion maps in the polynomial constructor.",
    "created_at": "2014-03-02T23:47:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126922",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:32'></a>Here is a fix based on the existing one and the "P.P.S" from comment:30.  This gets rid of the test for coercion maps in the polynomial constructor.



---

archive/issue_comments_126923.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-03-03T13:09:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126923",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_126924.json:
```json
{
    "body": "<a id='comment:33'></a>Looks good enough for me and passes tests.",
    "created_at": "2014-03-03T13:09:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126924",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:33'></a>Looks good enough for me and passes tests.



---

archive/issue_comments_126925.json:
```json
{
    "body": "<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2014-03-03T13:29:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126925",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_126926.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2014-03-03T13:29:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126926",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_126927.json:
```json
{
    "body": "<a id='comment:35'></a>I trust this latest change is OK too.  (I started implementing a class `PolynomialRingHomomorphism` as in comment:30, but didn't include it in the branch since it isn't finished and isn't needed to fix this bug; I should have removed the declaration too.)",
    "created_at": "2014-03-03T13:32:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126927",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:35'></a>I trust this latest change is OK too.  (I started implementing a class `PolynomialRingHomomorphism` as in comment:30, but didn't include it in the branch since it isn't finished and isn't needed to fix this bug; I should have removed the declaration too.)



---

archive/issue_comments_126928.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-03-03T13:32:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126928",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_126929.json:
```json
{
    "body": "<a id='comment:36'></a>The latest change is ok with me as it just removes something unused.",
    "created_at": "2014-03-03T13:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126929",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:36'></a>The latest change is ok with me as it just removes something unused.



---

archive/issue_comments_126930.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2014-03-03T15:14:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126930",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_126931.json:
```json
{
    "body": "<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2014-03-03T15:14:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126931",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_126932.json:
```json
{
    "body": "<a id='comment:38'></a>Sorry, I realised the patch didn't take sparse polynomial rings into account.  There was also a minor mistake in two existing doctests.",
    "created_at": "2014-03-03T15:16:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126932",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:38'></a>Sorry, I realised the patch didn't take sparse polynomial rings into account.  There was also a minor mistake in two existing doctests.



---

archive/issue_comments_126933.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-03-03T15:22:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126933",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_126934.json:
```json
{
    "body": "<a id='comment:39'></a>I should be the one being sorry... I should have seen the error in the doctest.\nAnyway, it looks better now and I wasn't aware that we have saprse polynomials!",
    "created_at": "2014-03-03T15:22:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126934",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:39'></a>I should be the one being sorry... I should have seen the error in the doctest.
Anyway, it looks better now and I wasn't aware that we have saprse polynomials!



---

archive/issue_comments_126935.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-03-05T09:36:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11239#issuecomment-126935",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_029108.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-03-05T09:36:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11239",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11239#event-29108"
}
```
