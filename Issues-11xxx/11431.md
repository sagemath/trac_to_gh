# Issue 11431: Conversion from Singular to Sage

archive/issues_011259.json:
```json
{
    "assignees": [
        "https://github.com/williamstein"
    ],
    "body": "<div id=\"comment:0\"></div>\n\nOn [sage-devel](http://groups.google.com/group/sage-support/browse_thread/thread/f35e6064434dacdc), Francisco Botana complained about some shortcomings of the conversion from Singular (pexpect interface) to Sage.\n\nI think the conversions provided by this patch are quite thorough. \n\nFirst of all, the patch provides a conversion of base rings, even with minpoly, with complicated block, matrix and weighted orders (note that one needs #11316) and even quotient rings:\n\n```\nsage: singular.eval('ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp)')\n'ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp);'\nsage: R = singular('r1').sage_basering()\nsage: R\nMultivariate Polynomial Ring in a, b, c, d, e, f over Finite Field in x of size 3^2\nsage: R.term_order()\nBlock term order with blocks:\n(Matrix term order with matrix\n[1 2]\n[3 0],\n Weighted degree reverse lexicographic term order with weights (2, 3),\n Lexicographic term order of length 2)\n\nsage: singular.eval('ring r3 = (3,z),(a,b,c),dp')\n'ring r3 = (3,z),(a,b,c),dp;'\nsage: singular.eval('minpoly = 1+z+z2+z3+z4')\n'minpoly = 1+z+z2+z3+z4;'\nsage: singular('r3').sage_basering()\nMultivariate Polynomial Ring in a, b, c over Univariate Quotient Polynomial Ring in z over Finite Field of size 3 with modulus z^4 + z^3 + z^2 + z + 1\n\nsage: singular.eval('ring r5 = (9,a), (x,y,z),lp') \n'ring r5 = (9,a), (x,y,z),lp;'\nsage: Q = singular('std(ideal(x^2,x+y^2+z^3))', type='qring')\nsage: Q.sage_basering()\nQuotient of Multivariate Polynomial Ring in x, y, z over Finite Field in a of size 3^2 by the ideal (y^4 - y^2*z^3 + z^6, x + y^2 + z^3)\n```\n\nBy consequence, it is now straight forward to convert polynomials or ideals to sage:\n\n```\nsage: singular.eval('ring R = integer, (x,y,z),lp') \n'// ** You are using coefficient rings which are not fields...'\nsage: I = singular.ideal(['x^2','y*z','z+x']) \nsage: I.sage()  # indirect doctest\nIdeal (x^2, y*z, x + z) of Multivariate Polynomial Ring in x, y, z over Integer Ring\n\n# Note that conversion of a Singular string to a Sage string was missing\nsage: singular('ringlist(basering)').sage()\n[['integer'], ['x', 'y', 'z'], [['lp', (1, 1, 1)], ['C', (0)]], Ideal (0) of Multivariate Polynomial Ring in x, y, z over Integer Ring]\n\nsage: singular.eval('ring r10 = (9,a), (x,y,z),lp')\n'ring r10 = (9,a), (x,y,z),lp;'\nsage: Q = singular('std(ideal(x^2,x+y^2+z^3))', type='qring')\nsage: Q.sage()\nQuotient of Multivariate Polynomial Ring in x, y, z over Finite Field in a of size 3^2 by the ideal (y^4 - y^2*z^3 + z^6, x + y^2 + z^3)\nsage: singular('x^2+y').sage()\nx^2 + y\nsage: singular('x^2+y').sage().parent()\nQuotient of Multivariate Polynomial Ring in x, y, z over Finite Field in a of size 3^2 by the ideal (y^4 - y^2*z^3 + z^6, x + y^2 + z^3)\n```\n\n---\n\nApply\n1. [attachment: trac11431_singular_sage_conversion.patch](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_conversion.patch.gz)\n2. [attachment: trac11431_singular_sage_documentation.patch](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_documentation.patch.gz)\nto the Sage library.\n\n\nDepends on #11316\nDepends on #11645\n\nUpstream: **None of the above - read trac for reasoning.**\n\nCC:  @malb\n\nComponent: **interfaces**\n\nAuthor: **Simon King**\n\nReviewer: **Martin Albrecht**\n\nMerged: **sage-4.7.2.alpha3**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/11431_\n\n",
    "closed_at": "2011-09-12T19:27:57Z",
    "created_at": "2011-06-06T09:36:11Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.7.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Conversion from Singular to Sage",
    "type": "issue",
    "updated_at": "2011-09-12T19:27:57Z",
    "url": "https://github.com/sagemath/sage/issues/11431",
    "user": "https://github.com/simon-king-jena"
}
```
<div id="comment:0"></div>

On [sage-devel](http://groups.google.com/group/sage-support/browse_thread/thread/f35e6064434dacdc), Francisco Botana complained about some shortcomings of the conversion from Singular (pexpect interface) to Sage.

I think the conversions provided by this patch are quite thorough. 

First of all, the patch provides a conversion of base rings, even with minpoly, with complicated block, matrix and weighted orders (note that one needs #11316) and even quotient rings:

```
sage: singular.eval('ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp)')
'ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp);'
sage: R = singular('r1').sage_basering()
sage: R
Multivariate Polynomial Ring in a, b, c, d, e, f over Finite Field in x of size 3^2
sage: R.term_order()
Block term order with blocks:
(Matrix term order with matrix
[1 2]
[3 0],
 Weighted degree reverse lexicographic term order with weights (2, 3),
 Lexicographic term order of length 2)

sage: singular.eval('ring r3 = (3,z),(a,b,c),dp')
'ring r3 = (3,z),(a,b,c),dp;'
sage: singular.eval('minpoly = 1+z+z2+z3+z4')
'minpoly = 1+z+z2+z3+z4;'
sage: singular('r3').sage_basering()
Multivariate Polynomial Ring in a, b, c over Univariate Quotient Polynomial Ring in z over Finite Field of size 3 with modulus z^4 + z^3 + z^2 + z + 1

sage: singular.eval('ring r5 = (9,a), (x,y,z),lp') 
'ring r5 = (9,a), (x,y,z),lp;'
sage: Q = singular('std(ideal(x^2,x+y^2+z^3))', type='qring')
sage: Q.sage_basering()
Quotient of Multivariate Polynomial Ring in x, y, z over Finite Field in a of size 3^2 by the ideal (y^4 - y^2*z^3 + z^6, x + y^2 + z^3)
```

By consequence, it is now straight forward to convert polynomials or ideals to sage:

```
sage: singular.eval('ring R = integer, (x,y,z),lp') 
'// ** You are using coefficient rings which are not fields...'
sage: I = singular.ideal(['x^2','y*z','z+x']) 
sage: I.sage()  # indirect doctest
Ideal (x^2, y*z, x + z) of Multivariate Polynomial Ring in x, y, z over Integer Ring

# Note that conversion of a Singular string to a Sage string was missing
sage: singular('ringlist(basering)').sage()
[['integer'], ['x', 'y', 'z'], [['lp', (1, 1, 1)], ['C', (0)]], Ideal (0) of Multivariate Polynomial Ring in x, y, z over Integer Ring]

sage: singular.eval('ring r10 = (9,a), (x,y,z),lp')
'ring r10 = (9,a), (x,y,z),lp;'
sage: Q = singular('std(ideal(x^2,x+y^2+z^3))', type='qring')
sage: Q.sage()
Quotient of Multivariate Polynomial Ring in x, y, z over Finite Field in a of size 3^2 by the ideal (y^4 - y^2*z^3 + z^6, x + y^2 + z^3)
sage: singular('x^2+y').sage()
x^2 + y
sage: singular('x^2+y').sage().parent()
Quotient of Multivariate Polynomial Ring in x, y, z over Finite Field in a of size 3^2 by the ideal (y^4 - y^2*z^3 + z^6, x + y^2 + z^3)
```

---

Apply
1. [attachment: trac11431_singular_sage_conversion.patch](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_conversion.patch.gz)
2. [attachment: trac11431_singular_sage_documentation.patch](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_documentation.patch.gz)
to the Sage library.


Depends on #11316
Depends on #11645

Upstream: **None of the above - read trac for reasoning.**

CC:  @malb

Component: **interfaces**

Author: **Simon King**

Reviewer: **Martin Albrecht**

Merged: **sage-4.7.2.alpha3**

_Issue created by migration from https://trac.sagemath.org/ticket/11431_





---

archive/issue_events_150651.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-06-06T09:36:11Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "milestone_number": null,
    "milestone_title": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150651"
}
```



---

archive/issue_events_150652.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-06-06T09:36:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
    "label_color": "0000ff",
    "label_name": "c: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150652"
}
```



---

archive/issue_events_150653.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-06-06T09:36:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150653"
}
```



---

archive/issue_events_150654.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-06-06T09:36:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150654"
}
```



---

archive/issue_events_150655.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2011-06-06T09:36:11Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "subject": "https://github.com/simon-king-jena",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150655"
}
```



---

archive/issue_comments_115671.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nNote to the reviewer: I did not check whether the doc strings look nice in html.",
    "created_at": "2011-06-06T09:42:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115671",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:1" align="right">comment:1</div>

Note to the reviewer: I did not check whether the doc strings look nice in html.



---

archive/issue_events_150656.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-06-06T09:42:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150656"
}
```



---

archive/issue_comments_115672.json:
```json
{
    "body": "Conversion Singular -> Sage",
    "created_at": "2011-06-06T11:22:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115672",
    "user": "https://github.com/simon-king-jena"
}
```

Conversion Singular -> Sage



---

archive/issue_comments_115673.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nAttachment: **[trac11431_singular_sage_conversion.patch.gz](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_conversion.patch.gz)**\n\nSo far, the method `sage()` has not been mentioned at all in the documentation of `sage.interfaces.singular`! Therefore I added a second patch, providing some use cases of `.sage()` in the short tutorial of `sage.interfaces.singular`.\n\nThe examples that are visible in the html version of the documentation still do not cover all features (quotient rings etc.), but I guess if a user knows about the existence of `sage()` (s)he will guess its correct usage.",
    "created_at": "2011-06-06T11:40:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115673",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:2" align="right">comment:2</div>

Attachment: **[trac11431_singular_sage_conversion.patch.gz](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_conversion.patch.gz)**

So far, the method `sage()` has not been mentioned at all in the documentation of `sage.interfaces.singular`! Therefore I added a second patch, providing some use cases of `.sage()` in the short tutorial of `sage.interfaces.singular`.

The examples that are visible in the html version of the documentation still do not cover all features (quotient rings etc.), but I guess if a user knows about the existence of `sage()` (s)he will guess its correct usage.



---

archive/issue_comments_115674.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\n* can we rename `sage_basering` to `sage_global_ring`. In Sage `base_ring` has a special meaning which is not meant in your patch. I think global ring captures it.\n  * don't real fields also have a precision in Singular?\n  * Previously, we enforced and assumed `not short`, but it's good you're taking it into account.\n  * Can you also fix \"If it is provided, then you *must* take care OFF it.\"?\n  * shouldn't `TermOrder_from_Singular` be lower-case since it's a function? Or were you aiming for upper-case because it's a constructor?\n  * In \"Invalid termorder in Singular\" shouldn't it be term order, i.e. with a space?",
    "created_at": "2011-06-07T14:16:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115674",
    "user": "https://github.com/malb"
}
```

<div id="comment:3" align="right">comment:3</div>

* can we rename `sage_basering` to `sage_global_ring`. In Sage `base_ring` has a special meaning which is not meant in your patch. I think global ring captures it.
  * don't real fields also have a precision in Singular?
  * Previously, we enforced and assumed `not short`, but it's good you're taking it into account.
  * Can you also fix "If it is provided, then you *must* take care OFF it."?
  * shouldn't `TermOrder_from_Singular` be lower-case since it's a function? Or were you aiming for upper-case because it's a constructor?
  * In "Invalid termorder in Singular" shouldn't it be term order, i.e. with a space?



---

archive/issue_events_150657.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-06-07T14:16:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150657"
}
```



---

archive/issue_events_150658.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-06-07T14:16:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150658"
}
```



---

archive/issue_comments_115675.json:
```json
{
    "body": "Reviewer: **Martin Albrecht**",
    "created_at": "2011-06-07T14:16:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115675",
    "user": "https://github.com/malb"
}
```

Reviewer: **Martin Albrecht**



---

archive/issue_comments_115676.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nHi Martin!\n\nReplying to [@malb](#comment%3A3):\n> * can we rename `sage_basering` to `sage_global_ring`. In Sage `base_ring` has a special meaning which is not meant in your patch. I think global ring captures it.\n\nSounds fine to me. Obviously I took the name `sage_basering` from Singular, but you are right that it might be confusing for people who know the notion `base ring` only from Sage.\n\n> * don't real fields also have a precision in Singular?\n\nRight, that should be taken care of as well.\n\n> * Can you also fix \"If it is provided, then you *must* take care OFF it.\"?\n\nWhy \"off\"? With two f?\n\nWouldn't it be correct English to say \"If it is provided, then you must take care that it matches the current ring in Singular\"? (i.e., I forgot the \"that\" in my patch)\n\n> * shouldn't `TermOrder_from_Singular` be lower-case since it's a function? Or were you aiming for upper-case because it's a constructor?\n\nI made it upper case because it returns a `TermOrder` (that is how the class is called). But actually I was ignorant to the convention that functions are lower-case. So I'll change it.\n\n> * In \"Invalid termorder in Singular\" shouldn't it be term order, i.e. with a space?\n\nYep!",
    "created_at": "2011-06-07T18:37:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115676",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:4" align="right">comment:4</div>

Hi Martin!

Replying to [@malb](#comment%3A3):
> * can we rename `sage_basering` to `sage_global_ring`. In Sage `base_ring` has a special meaning which is not meant in your patch. I think global ring captures it.

Sounds fine to me. Obviously I took the name `sage_basering` from Singular, but you are right that it might be confusing for people who know the notion `base ring` only from Sage.

> * don't real fields also have a precision in Singular?

Right, that should be taken care of as well.

> * Can you also fix "If it is provided, then you *must* take care OFF it."?

Why "off"? With two f?

Wouldn't it be correct English to say "If it is provided, then you must take care that it matches the current ring in Singular"? (i.e., I forgot the "that" in my patch)

> * shouldn't `TermOrder_from_Singular` be lower-case since it's a function? Or were you aiming for upper-case because it's a constructor?

I made it upper case because it returns a `TermOrder` (that is how the class is called). But actually I was ignorant to the convention that functions are lower-case. So I'll change it.

> * In "Invalid termorder in Singular" shouldn't it be term order, i.e. with a space?

Yep!



---

archive/issue_comments_115677.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@simon-king-jena](#comment%3A4):\n> ... \n> >    * Can you also fix \"If it is provided, then you *must* take care OFF it.\"?\n> \n> \n> Why \"off\"? With two f?\n> \n> Wouldn't it be correct English to say \"If it is provided, then you must take care that it matches the current ring in Singular\"? (i.e., I forgot the \"that\" in my patch)\n\nPerhaps not. But \"If it is provided, then you have to make sure that it matches...\" is fine, isn't it?\n\n> > * shouldn't `TermOrder_from_Singular` be lower-case since it's a function? Or were you aiming for upper-case because it's a constructor?\n> \n> \n> I made it upper case because it returns a `TermOrder` (that is how the class is called). But actually I was ignorant to the convention that functions are lower-case. So I'll change it.\n> \n> > * In \"Invalid termorder in Singular\" shouldn't it be term order, i.e. with a space?\n> \n> \n> Yep!\n>\n>",
    "created_at": "2011-06-07T18:40:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115677",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@simon-king-jena](#comment%3A4):
> ... 
> >    * Can you also fix "If it is provided, then you *must* take care OFF it."?
> 
> 
> Why "off"? With two f?
> 
> Wouldn't it be correct English to say "If it is provided, then you must take care that it matches the current ring in Singular"? (i.e., I forgot the "that" in my patch)

Perhaps not. But "If it is provided, then you have to make sure that it matches..." is fine, isn't it?

> > * shouldn't `TermOrder_from_Singular` be lower-case since it's a function? Or were you aiming for upper-case because it's a constructor?
> 
> 
> I made it upper case because it returns a `TermOrder` (that is how the class is called). But actually I was ignorant to the convention that functions are lower-case. So I'll change it.
> 
> > * In "Invalid termorder in Singular" shouldn't it be term order, i.e. with a space?
> 
> 
> Yep!
>
>



---

archive/issue_comments_115678.json:
```json
{
    "body": "Show examples of .sage() to the singular interface tutorial. Fix some details of the previous patch.",
    "created_at": "2011-06-08T06:17:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115678",
    "user": "https://github.com/simon-king-jena"
}
```

Show examples of .sage() to the singular interface tutorial. Fix some details of the previous patch.



---

archive/issue_events_150659.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-06-08T06:20:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150659"
}
```



---

archive/issue_events_150660.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-06-08T06:20:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150660"
}
```



---

archive/issue_comments_115679.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nAttachment: **[trac11431_singular_sage_documentation.patch.gz](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_documentation.patch.gz)**\n\nI've put my changes into the second patch, so, please replace that when you test it.\n\n*Names*: I changed `sage_basering` into `sage_global_ring` and `TermOrder_from_Singular` into `termorder_from_singular`.\n\n*Precision*: Singular does not tell the precision of a real field in `charstr()`, it does so only for complex fields. But the precision both of real and complex fields is part of `ringlist()`. So, both in the real and the complex case, I take the precision from there, not from `charstr()`.\n\n*Grammar*: It is now \"Invalid term order\" (not \"termorder\") and \"If it is provided, then you have to make sure that it matches...\" (not \"If it is provided, then you *must* take care it matches...\")\n\n*Tests*: Of course I added a test showing that the precision of real fields is taken care of. And it turned out that one doctest needed a fix, because when I created it I used a different term order (so that the same polynomial was printed in a different way).",
    "created_at": "2011-06-08T06:20:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115679",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:6" align="right">comment:6</div>

Attachment: **[trac11431_singular_sage_documentation.patch.gz](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_documentation.patch.gz)**

I've put my changes into the second patch, so, please replace that when you test it.

*Names*: I changed `sage_basering` into `sage_global_ring` and `TermOrder_from_Singular` into `termorder_from_singular`.

*Precision*: Singular does not tell the precision of a real field in `charstr()`, it does so only for complex fields. But the precision both of real and complex fields is part of `ringlist()`. So, both in the real and the complex case, I take the precision from there, not from `charstr()`.

*Grammar*: It is now "Invalid term order" (not "termorder") and "If it is provided, then you have to make sure that it matches..." (not "If it is provided, then you *must* take care it matches...")

*Tests*: Of course I added a test showing that the precision of real fields is taken care of. And it turned out that one doctest needed a fix, because when I created it I used a different term order (so that the same polynomial was printed in a different way).



---

archive/issue_comments_115680.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI'll give this a positive review: I agree with Simon's fixes (and the patchbot can take care of any doctest failures etc.)",
    "created_at": "2011-06-08T09:32:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115680",
    "user": "https://github.com/malb"
}
```

<div id="comment:7" align="right">comment:7</div>

I'll give this a positive review: I agree with Simon's fixes (and the patchbot can take care of any doctest failures etc.)



---

archive/issue_events_150661.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-06-08T09:32:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150661"
}
```



---

archive/issue_events_150662.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-06-08T09:32:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150662"
}
```



---

archive/issue_comments_115681.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThank you! And the patchbot actually says that the doctests pass...",
    "created_at": "2011-06-08T10:16:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115681",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:8" align="right">comment:8</div>

Thank you! And the patchbot actually says that the doctests pass...



---

archive/issue_comments_115682.json:
```json
{
    "body": "Merged: **sage-4.7.1.alpha3**",
    "created_at": "2011-06-09T07:43:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115682",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.7.1.alpha3**



---

archive/issue_events_150663.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-06-09T07:43:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150663"
}
```



---

archive/issue_events_150664.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-06-09T07:43:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150664"
}
```



---

archive/issue_comments_115683.json:
```json
{
    "body": "Changed merged from **sage-4.7.1.alpha3** to none",
    "created_at": "2011-06-14T19:33:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115683",
    "user": "https://github.com/jdemeyer"
}
```

Changed merged from **sage-4.7.1.alpha3** to none



---

archive/issue_events_150665.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-06-14T19:33:12Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150665"
}
```



---

archive/issue_comments_115684.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nThere are some issues on Solaris.  On the \"marks\" and \"t2\" buildbots, I get the following error (identical on both systems):\n\n```\nsage -t -long  -force_lib devel/sage/sage/rings/polynomial/term_order.py\n**********************************************************************\nFile \"/scratch/buildbot/sage/t2-1/t2_full/build/sage-4.7.1.alpha3/devel/sage-main/sage/rings/polynomial/term_order.py\", line 1878:\n    sage: singular.eval('ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp)')\nException raised:\n    Traceback (most recent call last):\n      File \"/scratch/buildbot/sage/t2-1/t2_full/build/sage-4.7.1.alpha3/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/scratch/buildbot/sage/t2-1/t2_full/build/sage-4.7.1.alpha3/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/scratch/buildbot/sage/t2-1/t2_full/build/sage-4.7.1.alpha3/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_64[2]>\", line 1, in <module>\n        singular.eval('ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp)')###line 1878:\n    sage: singular.eval('ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp)')\n      File \"/scratch/buildbot/sage/t2-1/t2_full/build/sage-4.7.1.alpha3/local/lib/python/site-packages/sage/interfaces/singular.py\", line 567, in eval\n        raise RuntimeError, 'Singular error:\\n%s'%s\n    RuntimeError: Singular error:\n       ? cannot open `gftables/9`\n       ? cannot make ring\n       ? error occurred in or before STDIN line 33: `ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp);`\n       ? expected ring-expression. type 'help ring;'\n**********************************************************************\nFile \"/scratch/buildbot/sage/t2-1/t2_full/build/sage-4.7.1.alpha3/devel/sage-main/sage/rings/polynomial/term_order.py\", line 1881:\n    sage: termorder_from_singular(singular)\nExpected:\n    Block term order with blocks:\n    (Matrix term order with matrix\n    [1 2]\n    [3 0],\n     Weighted degree reverse lexicographic term order with weights (2, 3),\n     Lexicographic term order of length 2)\nGot:\n    Block term order with blocks:\n    (Lexicographic term order of length 3,\n     Degree lexicographic term order of length 5,\n     Lexicographic term order of length 2)\n**********************************************************************\n```",
    "created_at": "2011-06-14T19:33:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115684",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:10" align="right">comment:10</div>

There are some issues on Solaris.  On the "marks" and "t2" buildbots, I get the following error (identical on both systems):

```
sage -t -long  -force_lib devel/sage/sage/rings/polynomial/term_order.py
**********************************************************************
File "/scratch/buildbot/sage/t2-1/t2_full/build/sage-4.7.1.alpha3/devel/sage-main/sage/rings/polynomial/term_order.py", line 1878:
    sage: singular.eval('ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp)')
Exception raised:
    Traceback (most recent call last):
      File "/scratch/buildbot/sage/t2-1/t2_full/build/sage-4.7.1.alpha3/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/scratch/buildbot/sage/t2-1/t2_full/build/sage-4.7.1.alpha3/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/scratch/buildbot/sage/t2-1/t2_full/build/sage-4.7.1.alpha3/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_64[2]>", line 1, in <module>
        singular.eval('ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp)')###line 1878:
    sage: singular.eval('ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp)')
      File "/scratch/buildbot/sage/t2-1/t2_full/build/sage-4.7.1.alpha3/local/lib/python/site-packages/sage/interfaces/singular.py", line 567, in eval
        raise RuntimeError, 'Singular error:\n%s'%s
    RuntimeError: Singular error:
       ? cannot open `gftables/9`
       ? cannot make ring
       ? error occurred in or before STDIN line 33: `ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp);`
       ? expected ring-expression. type 'help ring;'
**********************************************************************
File "/scratch/buildbot/sage/t2-1/t2_full/build/sage-4.7.1.alpha3/devel/sage-main/sage/rings/polynomial/term_order.py", line 1881:
    sage: termorder_from_singular(singular)
Expected:
    Block term order with blocks:
    (Matrix term order with matrix
    [1 2]
    [3 0],
     Weighted degree reverse lexicographic term order with weights (2, 3),
     Lexicographic term order of length 2)
Got:
    Block term order with blocks:
    (Lexicographic term order of length 3,
     Degree lexicographic term order of length 5,
     Lexicographic term order of length 2)
**********************************************************************
```



---

archive/issue_comments_115685.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nHi Jeroen,\n\nReplying to [@jdemeyer](#comment%3A10):\n>     sage: singular.eval('ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp)')\n> ...\n>     RuntimeError: Singular error:\n>        ? cannot open `gftables/9`\n>        ? cannot make ring\n>        ? error occurred in or before STDIN line 33: `ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp);`\n>        ? expected ring-expression. type 'help ring;'\n> **********************************************************************\n\nThat is very strange. I can not imagine that my patch introduced that bug: It changes the conversion from Singular to Sage, but it should not change Singular itself (and what you get in your example is an error from Singular, not from the interface).\n\nHence, I wonder whether my patch has *introduced* or *uncovered* that bug.\n\nCan you test on marks and t2 with unpatched Sage whether the line\n\n```\nsage: singular.eval('ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp)')\n```\nfails?",
    "created_at": "2011-06-15T06:28:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115685",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:11" align="right">comment:11</div>

Hi Jeroen,

Replying to [@jdemeyer](#comment%3A10):
>     sage: singular.eval('ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp)')
> ...
>     RuntimeError: Singular error:
>        ? cannot open `gftables/9`
>        ? cannot make ring
>        ? error occurred in or before STDIN line 33: `ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp);`
>        ? expected ring-expression. type 'help ring;'
> **********************************************************************

That is very strange. I can not imagine that my patch introduced that bug: It changes the conversion from Singular to Sage, but it should not change Singular itself (and what you get in your example is an error from Singular, not from the interface).

Hence, I wonder whether my patch has *introduced* or *uncovered* that bug.

Can you test on marks and t2 with unpatched Sage whether the line

```
sage: singular.eval('ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp)')
```
fails?



---

archive/issue_comments_115686.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@simon-king-jena](#comment%3A11):\n> Can you test on marks and t2 with unpatched Sage whether the line\n> \n> ```\n> sage: singular.eval('ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp)')\n> ```\n> fails?\n\nUnfortunately, I cannot.  I am not able to compile Sage on marks and I do not have an account on t2.",
    "created_at": "2011-07-27T13:55:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115686",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@simon-king-jena](#comment%3A11):
> Can you test on marks and t2 with unpatched Sage whether the line
> 
> ```
> sage: singular.eval('ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp)')
> ```
> fails?

Unfortunately, I cannot.  I am not able to compile Sage on marks and I do not have an account on t2.



---

archive/issue_events_150666.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-07-27T13:55:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150666"
}
```



---

archive/issue_comments_115687.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nI was able to build sage-4.7.1.rc1 on mark (which is supposed to be identical with mark2). It turns out that the bug was not *introduced* but *revealed* by my patch.\n\nWith the freshly built Sage-on-mark, I get\n\n```\nsage: singular.eval('ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp)')\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n\n/home/simonking/SAGE/sage-4.7.1.rc1mark/<ipython console> in <module>()\n\n/home/simonking/SAGE/sage-4.7.1.rc1mark/local/lib/python2.6/site-packages/sage/interfaces/singular.pyc in eval(self, x, allow_semicolon, strip, **kwds)\n    548\n    549         if s.find(\"error\") != -1 or s.find(\"Segment fault\") != -1:\n--> 550             raise RuntimeError, 'Singular error:\\n%s'%s\n    551\n    552         if get_verbose() > 0:\n\nRuntimeError: Singular error:\n   ? cannot open `gftables/9`\n   ? cannot make ring\n   ? error occurred in or before STDIN line 25: `ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp);`\n   ? expected ring-expression. type 'help ring;'\n```\n\nThe question is: How shall we proceed? Removing that particular test would be a shame, since it shows that my patch can manage to parse pretty complicated stuff. Perhaps it is  possible to simplify it, so that it is still complicated, but works on mark and t2.\n\nIn either case, I will report on sage-solaris, and probably will file a bug report to the Singular team as well.",
    "created_at": "2011-08-03T18:36:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115687",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:13" align="right">comment:13</div>

I was able to build sage-4.7.1.rc1 on mark (which is supposed to be identical with mark2). It turns out that the bug was not *introduced* but *revealed* by my patch.

With the freshly built Sage-on-mark, I get

```
sage: singular.eval('ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp)')
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)

/home/simonking/SAGE/sage-4.7.1.rc1mark/<ipython console> in <module>()

/home/simonking/SAGE/sage-4.7.1.rc1mark/local/lib/python2.6/site-packages/sage/interfaces/singular.pyc in eval(self, x, allow_semicolon, strip, **kwds)
    548
    549         if s.find("error") != -1 or s.find("Segment fault") != -1:
--> 550             raise RuntimeError, 'Singular error:\n%s'%s
    551
    552         if get_verbose() > 0:

RuntimeError: Singular error:
   ? cannot open `gftables/9`
   ? cannot make ring
   ? error occurred in or before STDIN line 25: `ring r1 = (9,x),(a,b,c,d,e,f),(M((1,2,3,0)),wp(2,3),lp);`
   ? expected ring-expression. type 'help ring;'
```

The question is: How shall we proceed? Removing that particular test would be a shame, since it shows that my patch can manage to parse pretty complicated stuff. Perhaps it is  possible to simplify it, so that it is still complicated, but works on mark and t2.

In either case, I will report on sage-solaris, and probably will file a bug report to the Singular team as well.



---

archive/issue_comments_115688.json:
```json
{
    "body": "Upstream: **Reported upstream. Little or no feedback.**",
    "created_at": "2011-08-03T18:50:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115688",
    "user": "https://github.com/simon-king-jena"
}
```

Upstream: **Reported upstream. Little or no feedback.**



---

archive/issue_comments_115689.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nFor the record: I reported the problem on the [singular trac](http://www.singular.uni-kl.de:8002/trac/ticket/352).",
    "created_at": "2011-08-03T18:50:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115689",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:14" align="right">comment:14</div>

For the record: I reported the problem on the [singular trac](http://www.singular.uni-kl.de:8002/trac/ticket/352).



---

archive/issue_comments_115690.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@simon-king-jena](#comment%3A14):\n> For the record: I reported the problem on the [singular trac](http://www.singular.uni-kl.de:8002/trac/ticket/352).\n\n... and I opened #11645.",
    "created_at": "2011-08-03T19:29:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115690",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@simon-king-jena](#comment%3A14):
> For the record: I reported the problem on the [singular trac](http://www.singular.uni-kl.de:8002/trac/ticket/352).

... and I opened #11645.



---

archive/issue_comments_115691.json:
```json
{
    "body": "Work Issues: **Singular trouble on Solaris**",
    "created_at": "2011-08-06T09:38:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115691",
    "user": "https://github.com/simon-king-jena"
}
```

Work Issues: **Singular trouble on Solaris**



---

archive/issue_comments_115692.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nAs I have indicated on #11645, there is a potential work around for the missing gftables: If one has a polynomial ring over a finite non-prime field in Sage and converts it into Singular, then the missing gftable is created. Hence, one could ensure that the problematic doc test passes by repending that test with another one that converts a ring from Sage into Singular.\n\nThat would be a nasty work-around, but at least it would mean that my patch could be used.",
    "created_at": "2011-08-06T09:38:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115692",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:16" align="right">comment:16</div>

As I have indicated on #11645, there is a potential work around for the missing gftables: If one has a polynomial ring over a finite non-prime field in Sage and converts it into Singular, then the missing gftable is created. Hence, one could ensure that the problematic doc test passes by repending that test with another one that converts a ring from Sage into Singular.

That would be a nasty work-around, but at least it would mean that my patch could be used.



---

archive/issue_comments_115693.json:
```json
{
    "body": "Work around a bug on Solaris revealed by the first patch",
    "created_at": "2011-08-06T12:25:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115693",
    "user": "https://github.com/simon-king-jena"
}
```

Work around a bug on Solaris revealed by the first patch



---

archive/issue_events_150667.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-08-06T12:30:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150667"
}
```



---

archive/issue_events_150668.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2011-08-06T12:30:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150668"
}
```



---

archive/issue_comments_115694.json:
```json
{
    "body": "Changed upstream from **Reported upstream. Little or no feedback.** to **None of the above - read trac for reasoning.**",
    "created_at": "2011-08-06T12:30:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115694",
    "user": "https://github.com/simon-king-jena"
}
```

Changed upstream from **Reported upstream. Little or no feedback.** to **None of the above - read trac for reasoning.**



---

archive/issue_comments_115695.json:
```json
{
    "body": "Changed work issues from **Singular trouble on Solaris** to none",
    "created_at": "2011-08-06T12:30:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115695",
    "user": "https://github.com/simon-king-jena"
}
```

Changed work issues from **Singular trouble on Solaris** to none



---

archive/issue_comments_115696.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -56,3 +56,4 @@\n Quotient of Multivariate Polynomial Ring in x, y, z over Finite Field in a of size 3^2 by the ideal (y^4 - y^2*z^3 + z^6, x + y^2 + z^3)\n ```\n \n+Apply all patches\n``````\n",
    "created_at": "2011-08-06T12:30:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115696",
    "user": "https://github.com/simon-king-jena"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -56,3 +56,4 @@
 Quotient of Multivariate Polynomial Ring in x, y, z over Finite Field in a of size 3^2 by the ideal (y^4 - y^2*z^3 + z^6, x + y^2 + z^3)
 ```
 
+Apply all patches
``````




---

archive/issue_comments_115697.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nAttachment: **[trac11431_solaris_workaround.patch.gz](https://github.com/sagemath/sage/files/ticket11431/trac11431_solaris_workaround.patch.gz)**\n\nI provided a third patch that uses - as a workaround - the fact that libsingular is able to create missing gftables files.\n\nOn Singular trac, Hannes said \"No, gftables are parts of the sources and will be copied during installation, but usually not computed (the program for that, a part of factory, will not be build during a standard compilation and installation). \n\nSo, I wonder why the files aren't copied on Solaris and how libsingular is able to create them. But I think the third patch (that isn't tested, yet) should suffice to make the doc tests of the first two patches work on solaris.\n\nBack to \"needs review\" - I hope that someone can doctest on Solaris.",
    "created_at": "2011-08-06T12:30:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115697",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:17" align="right">comment:17</div>

Attachment: **[trac11431_solaris_workaround.patch.gz](https://github.com/sagemath/sage/files/ticket11431/trac11431_solaris_workaround.patch.gz)**

I provided a third patch that uses - as a workaround - the fact that libsingular is able to create missing gftables files.

On Singular trac, Hannes said "No, gftables are parts of the sources and will be copied during installation, but usually not computed (the program for that, a part of factory, will not be build during a standard compilation and installation). 

So, I wonder why the files aren't copied on Solaris and how libsingular is able to create them. But I think the third patch (that isn't tested, yet) should suffice to make the doc tests of the first two patches work on solaris.

Back to "needs review" - I hope that someone can doctest on Solaris.



---

archive/issue_comments_115698.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nNote that #11645 also fixes the problem with the new doc test.\n\nSo, if someone would like to review my patches, I see two ways to make things work:\n\nEither\n\n1. get #11645 and [attachment: trac11431_singular_sage_conversion.patch](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_conversion.patch.gz) and [attachment: trac11431_singular_sage_documentation.patch](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_documentation.patch.gz)\n\nor\n\n2. get [attachment: trac11431_singular_sage_conversion.patch](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_conversion.patch.gz), [attachment: trac11431_singular_sage_documentation.patch](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_documentation.patch.gz) and [attachment: trac11431_solaris_workaround.patch](https://github.com/sagemath/sage/files/ticket11431/trac11431_solaris_workaround.patch.gz).",
    "created_at": "2011-08-10T16:54:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115698",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:18" align="right">comment:18</div>

Note that #11645 also fixes the problem with the new doc test.

So, if someone would like to review my patches, I see two ways to make things work:

Either

1. get #11645 and [attachment: trac11431_singular_sage_conversion.patch](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_conversion.patch.gz) and [attachment: trac11431_singular_sage_documentation.patch](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_documentation.patch.gz)

or

2. get [attachment: trac11431_singular_sage_conversion.patch](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_conversion.patch.gz), [attachment: trac11431_singular_sage_documentation.patch](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_documentation.patch.gz) and [attachment: trac11431_solaris_workaround.patch](https://github.com/sagemath/sage/files/ticket11431/trac11431_solaris_workaround.patch.gz).



---

archive/issue_comments_115699.json:
```json
{
    "body": "Changed dependencies from **#11316** to **#11316, #11645**",
    "created_at": "2011-08-22T09:59:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115699",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#11316** to **#11316, #11645**



---

archive/issue_comments_115700.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nWhat's the status of this ticket now?  Since #11645 has been merged in sage-4.7.1, we can assume that as prerequisite.  Which patches should be applied then?\n\nIf somebody can give these patches a \"tentative positive review\" (without testing on Solaris), I can test them on the buildbot machines, including Solaris.",
    "created_at": "2011-08-22T09:59:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115700",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">comment:19</div>

What's the status of this ticket now?  Since #11645 has been merged in sage-4.7.1, we can assume that as prerequisite.  Which patches should be applied then?

If somebody can give these patches a "tentative positive review" (without testing on Solaris), I can test them on the buildbot machines, including Solaris.



---

archive/issue_comments_115701.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@jdemeyer](#comment%3A19):\n> If somebody can give these patches a \"tentative positive review\" (without testing on Solaris), I can test them on the buildbot machines, including Solaris.\n\nTo the reviewer: if you do give such a \"tentative positive review\", you can set the status to \"positive review\" (even if it has not been tested properly).",
    "created_at": "2011-08-22T10:05:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115701",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@jdemeyer](#comment%3A19):
> If somebody can give these patches a "tentative positive review" (without testing on Solaris), I can test them on the buildbot machines, including Solaris.

To the reviewer: if you do give such a "tentative positive review", you can set the status to "positive review" (even if it has not been tested properly).



---

archive/issue_comments_115702.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nSimon, can you rebase your patches to 4.7.1?",
    "created_at": "2011-08-22T18:12:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115702",
    "user": "https://github.com/malb"
}
```

<div id="comment:21" align="right">comment:21</div>

Simon, can you rebase your patches to 4.7.1?



---

archive/issue_comments_115703.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@malb](#comment%3A21):\n> Simon, can you rebase your patches to 4.7.1?\n\nSince #11645 got fixed, I have only applied the first two patches, to sage-4.7.2.alpha1. They applied without fuzz. Why is it needed to rebase them?",
    "created_at": "2011-08-23T18:48:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115703",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@malb](#comment%3A21):
> Simon, can you rebase your patches to 4.7.1?

Since #11645 got fixed, I have only applied the first two patches, to sage-4.7.2.alpha1. They applied without fuzz. Why is it needed to rebase them?



---

archive/issue_comments_115704.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nHi, I get this:\n\n```\nSAGE_ROOT=/mnt/usb1/scratch/malb/sage-4.7.2.alpha0\n(sage subshell) sage:sage malb$ hg qimport https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_conversion.patch.gz && hg qpush\nadding trac11431_singular_sage_conversion.patch to series file\napplying trac11431_singular_sage_conversion.patch\npatching file sage/rings/polynomial/term_order.py\nHunk #1 FAILED at 1857\n1 out of 1 hunks FAILED -- saving rejects to file sage/rings/polynomial/term_order.py.rej\npatch failed, unable to continue (try -v)\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh trac11431_singular_sage_conversion.patch\nSAGE_ROOT=/mnt/usb1/scratch/malb/sage-4.7.2.alpha0\n```",
    "created_at": "2011-08-23T19:01:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115704",
    "user": "https://github.com/malb"
}
```

<div id="comment:23" align="right">comment:23</div>

Hi, I get this:

```
SAGE_ROOT=/mnt/usb1/scratch/malb/sage-4.7.2.alpha0
(sage subshell) sage:sage malb$ hg qimport https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_conversion.patch.gz && hg qpush
adding trac11431_singular_sage_conversion.patch to series file
applying trac11431_singular_sage_conversion.patch
patching file sage/rings/polynomial/term_order.py
Hunk #1 FAILED at 1857
1 out of 1 hunks FAILED -- saving rejects to file sage/rings/polynomial/term_order.py.rej
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
errors during apply, please fix and refresh trac11431_singular_sage_conversion.patch
SAGE_ROOT=/mnt/usb1/scratch/malb/sage-4.7.2.alpha0
```



---

archive/issue_comments_115705.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nHi Martin,\n\nyou forgot the other dependency: #11316 was only merged in sage-4.7.2.alpha1, but you started with alpha0.",
    "created_at": "2011-08-23T19:12:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115705",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:24" align="right">comment:24</div>

Hi Martin,

you forgot the other dependency: #11316 was only merged in sage-4.7.2.alpha1, but you started with alpha0.



---

archive/issue_comments_115706.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nRight, now it applies!",
    "created_at": "2011-08-23T19:56:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115706",
    "user": "https://github.com/malb"
}
```

<div id="comment:25" align="right">comment:25</div>

Right, now it applies!



---

archive/issue_comments_115707.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\napplies & doctests pass. I read the patch a while ago so positive review it is.",
    "created_at": "2011-08-23T21:01:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115707",
    "user": "https://github.com/malb"
}
```

<div id="comment:26" align="right">comment:26</div>

applies & doctests pass. I read the patch a while ago so positive review it is.



---

archive/issue_events_150669.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-08-23T21:01:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150669"
}
```



---

archive/issue_events_150670.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2011-08-23T21:01:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150670"
}
```



---

archive/issue_comments_115708.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -56,4 +56,10 @@\n Quotient of Multivariate Polynomial Ring in x, y, z over Finite Field in a of size 3^2 by the ideal (y^4 - y^2*z^3 + z^6, x + y^2 + z^3)\n ```\n \n-Apply all patches\n+---\n+\n+Apply\n+1. [attachment: trac11431_singular_sage_conversion.patch](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_conversion.patch.gz)\n+2. [attachment: trac11431_singular_sage_documentation.patch](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_documentation.patch.gz)\n+to the Sage library.\n+\n``````\n",
    "created_at": "2011-09-08T15:32:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115708",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -56,4 +56,10 @@
 Quotient of Multivariate Polynomial Ring in x, y, z over Finite Field in a of size 3^2 by the ideal (y^4 - y^2*z^3 + z^6, x + y^2 + z^3)
 ```
 
-Apply all patches
+---
+
+Apply
+1. [attachment: trac11431_singular_sage_conversion.patch](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_conversion.patch.gz)
+2. [attachment: trac11431_singular_sage_documentation.patch](https://github.com/sagemath/sage/files/ticket11431/trac11431_singular_sage_documentation.patch.gz)
+to the Sage library.
+
``````




---

archive/issue_comments_115709.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nSimon, are you ok with dropping the (IMHO obsolete) Solaris patch?",
    "created_at": "2011-09-08T15:32:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115709",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:27" align="right">comment:27</div>

Simon, are you ok with dropping the (IMHO obsolete) Solaris patch?



---

archive/issue_comments_115710.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@nexttime](#comment%3A27):\n> Simon, are you ok with dropping the (IMHO obsolete) Solaris patch?\n\nYes, it can be dropped, since that problem has been successfully dealt with on a different ticket.",
    "created_at": "2011-09-08T17:19:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115710",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@nexttime](#comment%3A27):
> Simon, are you ok with dropping the (IMHO obsolete) Solaris patch?

Yes, it can be dropped, since that problem has been successfully dealt with on a different ticket.



---

archive/issue_comments_115711.json:
```json
{
    "body": "Changed dependencies from **#11316, #11645** to **#11316 #11645**",
    "created_at": "2011-09-12T12:48:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115711",
    "user": "https://github.com/nexttime"
}
```

Changed dependencies from **#11316, #11645** to **#11316 #11645**



---

archive/issue_comments_115712.json:
```json
{
    "body": "Merged: **sage-4.7.2.alpha3**",
    "created_at": "2011-09-12T19:27:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/11431#issuecomment-115712",
    "user": "https://github.com/nexttime"
}
```

Merged: **sage-4.7.2.alpha3**



---

archive/issue_events_150671.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-12T19:27:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150671"
}
```



---

archive/issue_events_150672.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-12T19:27:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/11431",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/11431#event-150672"
}
```
