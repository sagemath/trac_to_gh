# Issue 11229: Rational maps attached to elliptic curve isogeny are incorrect

archive/issues_011057.json:
```json
{
    "body": "```\nsage: E = EllipticCurve([1,2,3,4,5])\nsage: Eshort = E.short_weierstrass_model()\nsage: phi = E.isogeny(E(0), Eshort)\nsage: phiX, phiY = phi.rational_maps()\nsage: phi(E(1,2))\n(63 : 864 : 1)\nsage: phiX(1,2), phiY(1,2)\n(63, 7560)\n```\n\nAssignee: @JohnCremona\n\nKeywords: elliptic curves, isogeny\n\nResolution: fixed\n\nAuthor: Johan Bosman\n\nReviewer: John Cremona\n\nMerged: sage-4.7.1.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/11229\n\n",
    "closed_at": "2011-05-04T06:51:10Z",
    "created_at": "2011-04-21T07:12:27Z",
    "labels": [
        "component: elliptic curves",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7.1",
    "title": "Rational maps attached to elliptic curve isogeny are incorrect",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11229",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```
```
sage: E = EllipticCurve([1,2,3,4,5])
sage: Eshort = E.short_weierstrass_model()
sage: phi = E.isogeny(E(0), Eshort)
sage: phiX, phiY = phi.rational_maps()
sage: phi(E(1,2))
(63 : 864 : 1)
sage: phiX(1,2), phiY(1,2)
(63, 7560)
```

Assignee: @JohnCremona

Keywords: elliptic curves, isogeny

Resolution: fixed

Author: Johan Bosman

Reviewer: John Cremona

Merged: sage-4.7.1.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/11229





---

archive/issue_comments_146663.json:
```json
{
    "body": "<a id='comment:1'></a>Maybe the case of degree 1 isogenies has not been tested properly.\n\nYou can use E.isomorphism_to(Eshort) instead in this case.  The Weierstrass isomorphisms were implemented long before isogenies, and have a completely different type (though obviously one should be able to create a degree 1 isogeny from an isomorphism, and vice versa).",
    "created_at": "2011-04-21T08:55:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11229#issuecomment-146663",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:1'></a>Maybe the case of degree 1 isogenies has not been tested properly.

You can use E.isomorphism_to(Eshort) instead in this case.  The Weierstrass isomorphisms were implemented long before isogenies, and have a completely different type (though obviously one should be able to create a degree 1 isogeny from an isomorphism, and vice versa).



---

archive/issue_comments_146664.json:
```json
{
    "body": "<a id='comment:2'></a>Hi John,\n\nThe only reason why I used a degree 1 isogeny in the example was to keep the example simple; it goes wrong in more general cases as well.\n\nBut I've already found in the code where it goes wrong.  I will upload a patch shortly.\n\nJohan",
    "created_at": "2011-04-21T09:03:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11229#issuecomment-146664",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```

<a id='comment:2'></a>Hi John,

The only reason why I used a degree 1 isogeny in the example was to keep the example simple; it goes wrong in more general cases as well.

But I've already found in the code where it goes wrong.  I will upload a patch shortly.

Johan



---

archive/issue_comments_146665.json:
```json
{
    "body": "Changing author from \"\" to \"Johan Bosman\"",
    "created_at": "2011-04-21T09:03:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11229#issuecomment-146665",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```

Changing author from "" to "Johan Bosman"



---

archive/issue_comments_146666.json:
```json
{
    "body": "<a id='comment:3'></a>Replying to [comment:2 johanbosman]:\n> Hi John,\n> \n> The only reason why I used a degree 1 isogeny in the example was to keep the example simple; it goes wrong in more general cases as well.\n> \n> But I've already found in the code where it goes wrong.  I will upload a patch shortly.\n> \n\n\nExcellent!\n\nI think there was a similar bug recently reported for isogenies -- could you look for that to see if your patch corrects that too?  I don't remember the number.\n\n> Johan",
    "created_at": "2011-04-21T09:06:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11229#issuecomment-146666",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:3'></a>Replying to [comment:2 johanbosman]:
> Hi John,
> 
> The only reason why I used a degree 1 isogeny in the example was to keep the example simple; it goes wrong in more general cases as well.
> 
> But I've already found in the code where it goes wrong.  I will upload a patch shortly.
> 


Excellent!

I think there was a similar bug recently reported for isogenies -- could you look for that to see if your patch corrects that too?  I don't remember the number.

> Johan



---

archive/issue_comments_146667.json:
```json
{
    "body": "<a id='comment:4'></a>Do you mean #10888?  That bug is unrelated to this one. ;).",
    "created_at": "2011-04-21T09:24:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11229#issuecomment-146667",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```

<a id='comment:4'></a>Do you mean #10888?  That bug is unrelated to this one. ;).



---

archive/issue_comments_146668.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-04-21T09:43:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11229#issuecomment-146668",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_146669.json:
```json
{
    "body": "Attachment [trac_11229_isogeny_rational_function.patch](tarball://root/attachments/some-uuid/ticket11229/trac_11229_isogeny_rational_function.patch) by johanbosman created at 2011-04-21 10:11:53",
    "created_at": "2011-04-21T10:11:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11229#issuecomment-146669",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```

Attachment [trac_11229_isogeny_rational_function.patch](tarball://root/attachments/some-uuid/ticket11229/trac_11229_isogeny_rational_function.patch) by johanbosman created at 2011-04-21 10:11:53



---

archive/issue_comments_146670.json:
```json
{
    "body": "<a id='comment:6'></a>Comment: the only difference between the two patches is the compulsory \"Trac\" line.",
    "created_at": "2011-04-21T10:14:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11229#issuecomment-146670",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```

<a id='comment:6'></a>Comment: the only difference between the two patches is the compulsory "Trac" line.



---

archive/issue_comments_146671.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:4 johanbosman]:\n> Do you mean #10888?  That bug is unrelated to this one. ;).\n\n\nToo  bad.\n\nI have no time now but will review at some point, unless someone else gets there first.",
    "created_at": "2011-04-21T10:32:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11229#issuecomment-146671",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:7'></a>Replying to [comment:4 johanbosman]:
> Do you mean #10888?  That bug is unrelated to this one. ;).


Too  bad.

I have no time now but will review at some point, unless someone else gets there first.



---

archive/issue_comments_146672.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-04-22T15:04:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11229#issuecomment-146672",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_146673.json:
```json
{
    "body": "<a id='comment:8'></a>The patch looks good to me, applies to 4.7.alpha5, and all tests in elliptic_curves pass.",
    "created_at": "2011-04-22T15:04:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11229#issuecomment-146673",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:8'></a>The patch looks good to me, applies to 4.7.alpha5, and all tests in elliptic_curves pass.



---

archive/issue_comments_146674.json:
```json
{
    "body": "Changing reviewer from \"\" to \"John Cremona\"",
    "created_at": "2011-04-22T15:04:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11229#issuecomment-146674",
    "user": "https://github.com/JohnCremona"
}
```

Changing reviewer from "" to "John Cremona"



---

archive/issue_events_029082.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-04-22T15:52:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11229",
    "milestone": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11229#event-29082"
}
```



---

archive/issue_comments_146675.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-4.7.1.alpha0\"",
    "created_at": "2011-05-04T06:51:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11229#issuecomment-146675",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-4.7.1.alpha0"



---

archive/issue_comments_146676.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-05-04T06:51:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11229#issuecomment-146676",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_029083.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-05-04T06:51:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11229",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11229#event-29083"
}
```
